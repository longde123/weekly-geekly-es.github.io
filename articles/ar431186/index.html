<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧒🏼 🤽🏾 🚐 التصميم حسب الأنواع: كيفية جعل الحالات غير الصالحة غير قابلة للتعبير عنها في C # 🔭 🧠 👸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="عادةً ، تحتوي المقالات حول تصميم الكتابة على أمثلة باللغات الوظيفية - Haskell و F # وغيرها. قد لا يبدو أن هذا المفهوم ينطبق على اللغات الموجهة للكائنا...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>التصميم حسب الأنواع: كيفية جعل الحالات غير الصالحة غير قابلة للتعبير عنها في C #</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431186/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  عادةً ، تحتوي المقالات حول تصميم الكتابة على أمثلة باللغات الوظيفية - Haskell و F # وغيرها.  قد لا يبدو أن هذا المفهوم ينطبق على اللغات الموجهة للكائنات ، ولكنه ليس كذلك. </p><br><p style=";text-align:right;direction:rtl">  في هذه المقالة ، <abbr title="سكوت ولاشين">سأترجم</abbr> أمثلة من مقالة كتبها <abbr title="سكوت ولاشين">سكوت فلاشين نوع</abbr> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">التصميم: كيفية جعل الحالات غير الصالحة غير</a> <abbr title="سكوت ولاشين">قابلة للتعبير</abbr> في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">لغة</a> C # <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الاصطلاحية</a> .  سأحاول أيضًا إظهار أن هذا النهج قابل للتطبيق ليس فقط كتجربة ، ولكن أيضًا في كود العمل. </p><a name="habracut"></a><br><h1 id="sozdayom-domennye-tipy" style=";text-align:right;direction:rtl">  إنشاء أنواع المجال </h1><br><p style=";text-align:right;direction:rtl">  تحتاج أولاً إلى نقل الأنواع من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المقالة السابقة في السلسلة</a> ، والتي يتم استخدامها في الأمثلة في F #. </p><br><h2 id="oborachivaem-primitivnye-tipy-v-domennye" style=";text-align:right;direction:rtl">  التفاف الأنواع البدائية في المجال </h2><br><p style=";text-align:right;direction:rtl">  تستخدم الأمثلة F # أنواع النطاق بدلاً من الأساسيات لعنوان البريد الإلكتروني والرمز البريدي للولايات المتحدة ورمز الولاية.  دعونا نحاول لف نوع بدائي في C #: </p><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailAddress</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Value { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmailAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Regex.IsMatch(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-string"><span class="hljs-string">@"^\S+@\S+\.\S+$"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentException(<span class="hljs-string"><span class="hljs-string">"Email address must contain an @ sign"</span></span>); } Value = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; Value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> =&gt; obj <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> EmailAddress otherEmailAddress &amp;&amp; Value.Equals(otherEmailAddress.Value); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetHashCode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; Value.GetHashCode(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">implicit</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">operator</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EmailAddress address</span></span></span><span class="hljs-function">)</span></span> =&gt; address?.Value; }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailAddress(<span class="hljs-string"><span class="hljs-string">"a@example.com"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailAddress(<span class="hljs-string"><span class="hljs-string">"b@example.com"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> receiverList = String.Join(<span class="hljs-string"><span class="hljs-string">";"</span></span>, a, b);</code> </pre> <br><p style=";text-align:right;direction:rtl">  لقد قمت بنقل التحقق من العنوان من وظيفة المصنع إلى المُنشئ ، لأن هذا التنفيذ أكثر شيوعًا لـ C #.  كان علينا أيضًا تنفيذ مقارنة وتحويل إلى سلسلة ، والتي على F # سيتم إجراؤها بواسطة المترجم. </p><br><p style=";text-align:right;direction:rtl">  من ناحية ، يبدو التنفيذ ضخمًا جدًا.  من ناحية أخرى ، يتم التعبير عن خصوصية عنوان البريد الإلكتروني هنا فقط عن طريق الشيكات في المنشئ ، وربما عن طريق منطق المقارنة.  معظم هذا هو رمز البنية التحتية ، والذي ، علاوة على ذلك ، من غير المرجح أن يتغير.  لذلك ، يمكنك إما <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إنشاء</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قالب</a> ، أو ، في أسوأ الأحوال ، نسخ الرمز العام من فئة إلى أخرى. </p><br><p style=";text-align:right;direction:rtl">  وتجدر الإشارة إلى أن إنشاء أنواع المجال من القيم البدائية ليس خصوصية البرمجة الوظيفية.  على العكس من ذلك ، يعتبر استخدام الأنواع البدائية علامة على وجود <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">رمز سيئ في OOP</a> .  يمكنك أن ترى أمثلة على هذه الأغلفة ، على سبيل المثال ، <a href="">في NLog</a> و <a href="">NBitcoin</a> ، والنوع القياسي من TimeSpan هو في الواقع غلاف فوق عدد علامات التجزئة. </p><br><h2 id="sozdayom-obekty-znacheniya" style=";text-align:right;direction:rtl">  إنشاء كائنات القيمة </h2><br><p style=";text-align:right;direction:rtl">  الآن نحن بحاجة إلى إنشاء تناظرية <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">للدخول</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailContactInfo</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> EmailAddress EmailAddress { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsEmailVerified { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmailContactInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EmailAddress emailAddress, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isEmailVerified</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emailAddress == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(emailAddress)); } EmailAddress = emailAddress; IsEmailVerified = isEmailVerified; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{EmailAddress}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{(IsEmailVerified ? </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">"verified"</span></span></span></span><span class="hljs-string"><span class="hljs-subst"> : </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">"not verified"</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">"</span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  مرة أخرى ، استغرق الأمر كودًا أكثر من F # ، ولكن يمكن إنجاز معظم العمل من خلال <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إعادة الهيكلة في IDE</a> . </p><br><p style=";text-align:right;direction:rtl">  مثل <code>EmailAddress</code> ، <code>EmailContactInfo</code> هو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">كائن قيم</a> (بمعنى <abbr title="التصميم الموجه نحو الموضوع">DDD</abbr> ، وليس <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أنواع القيم في .NET</a> ) ، معروف منذ فترة طويلة ويستخدم في نمذجة الكائن. </p><br><p style=";text-align:right;direction:rtl">  يتم نقل الأنواع الأخرى - <code>StateCode</code> و <code>ZipCode</code> و <code>PostalAddress</code> و <code>PersonalName</code> إلى C # بطريقة مماثلة. </p><br><h1 id="sozdayom-kontakt" style=";text-align:right;direction:rtl">  إنشاء جهة اتصال </h1><br><p style=";text-align:right;direction:rtl">  لذا ، يجب أن تعبر الشفرة عن القاعدة "يجب أن تحتوي جهة الاتصال على عنوان بريد إلكتروني أو عنوان بريدي (أو كلا العنوانين)."  مطلوب للتعبير عن هذه القاعدة بحيث تكون صحة الحالة مرئية من تعريف النوع والتحقق من قبل المترجم. </p><br><h2 id="vyrazhaem-razlichnye-sostoyaniya-kontakta" style=";text-align:right;direction:rtl">  التعبير عن حالات الاتصال المختلفة </h2><br><p style=";text-align:right;direction:rtl">  وهذا يعني أن جهة الاتصال هي كائن يحتوي على اسم الشخص وعنوان بريد إلكتروني أو عنوان بريدي أو كليهما.  من الواضح أنه لا يمكن أن تحتوي فئة واحدة على ثلاث مجموعات مختلفة من الخصائص ؛ وبالتالي ، يجب تحديد ثلاث فئات مختلفة.  يجب أن تحتوي جميع الفصول الثلاثة على اسم جهة الاتصال وفي نفس الوقت يجب أن يكون من الممكن معالجة جهات الاتصال من أنواع مختلفة بنفس الطريقة ، دون معرفة العناوين التي تحتويها جهة الاتصال.  لذلك ، سيتم تمثيل جهة الاتصال بفئة أساسية مجردة تحتوي على اسم جهة الاتصال ، وثلاثة تطبيقات مع مجموعة مختلفة من الحقول. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> PersonalName Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Contact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (name == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(name)); } Name = name; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PostOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> PostalContactInfo post_; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PostOnlyContact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, PostalContactInfo post</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (post == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(post)); } post_ = post; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> EmailContactInfo email_; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmailOnlyContact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, EmailContactInfo email</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (email == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(email)); } email_ = email; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailAndPostContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> EmailContactInfo email_; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> PostalContactInfo post_; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmailAndPostContact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, EmailContactInfo email, PostalContactInfo post</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (email == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(email)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (post == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(post)); } email_ = email; post_ = post; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  يمكنك القول أنه <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">يجب عليك استخدام التكوين</a> ، وليس الميراث ، وعمومًا تحتاج إلى وراثة السلوك ، وليس البيانات.  الملاحظات عادلة ، لكن في رأيي ، فإن استخدام التسلسل الهرمي للصف له ما يبرره هنا.  أولاً ، الفئات الفرعية لا تمثل فقط حالات خاصة من الفئة الأساسية ، فالتسلسل الهرمي بأكمله هو مفهوم واحد - الاتصال.  تعكس ثلاثة تطبيقات اتصال بدقة بالغة الحالات الثلاث المنصوص عليها في قاعدة العمل.  ثانياً ، يمكن تتبع علاقة الطبقة الأساسية وورثتها وتقسيم المسؤوليات بينهما بسهولة.  ثالثًا ، إذا أصبح التسلسل الهرمي مشكلة بالفعل ، يمكنك فصل حالة الاتصال إلى تسلسل هرمي منفصل ، كما حدث في المثال الأصلي.  في F # ، يكون وراثة السجلات مستحيلا ، ولكن يتم الإعلان عن أنواع جديدة بكل بساطة ، لذلك تم إجراء التقسيم على الفور.  في C # ، يكون الحل الأكثر طبيعية هو وضع حقول الاسم في الفئة الأساسية. </p><br><h2 id="sozdanie-kontakta" style=";text-align:right;direction:rtl">  إنشاء جهة اتصال </h2><br><p style=";text-align:right;direction:rtl">  إنشاء جهة اتصال أمر بسيط للغاية. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Contact </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FromEmail</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> emailStr</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> email = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailAddress(emailStr); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emailContactInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailContactInfo(email, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailOnlyContact(name, emailContactInfo); } }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PersonalName(<span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> contact = Contact.FromEmail(name, <span class="hljs-string"><span class="hljs-string">"abc@example.com"</span></span>);</code> </pre> <br><p style=";text-align:right;direction:rtl">  إذا كان عنوان البريد الإلكتروني غير صحيح ، فسيؤدي هذا الرمز إلى استثناء ، والذي يمكن اعتباره تناظريًا لإرجاع <code>None</code> في المثال الأصلي. </p><br><h2 id="obnovlenie-kontakta" style=";text-align:right;direction:rtl">  تحديث الاتصال </h2><br><p style=";text-align:right;direction:rtl">  يعد تحديث جهة الاتصال أمرًا مباشرًا أيضًا - ما عليك سوى إضافة طريقة مجردة إلى نوع <code>Contact</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> Contact </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdatePostalAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PostalContactInfo newPostalAddress</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Contact </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdatePostalAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PostalContactInfo newPostalAddress</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailAndPostContact(Name, email_, newPostalAddress); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PostOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Contact </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdatePostalAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PostalContactInfo newPostalAddress</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PostOnlyContact(Name, newPostalAddress); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailAndPostContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Contact </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdatePostalAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PostalContactInfo newPostalAddress</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailAndPostContact(Name, email_, newPostalAddress); }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StateCode(<span class="hljs-string"><span class="hljs-string">"CA"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> zip = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ZipCode(<span class="hljs-string"><span class="hljs-string">"97210"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newPostalAddress = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PostalAddress(<span class="hljs-string"><span class="hljs-string">"123 Main"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"Beverly Hills"</span></span>, state, zip); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newPostalContactInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PostalContactInfo(newPostalAddress, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newContact = contact.UpdatePostalAddress(newPostalContactInfo);</code> </pre> <br><p style=";text-align:right;direction:rtl">  كما هو الحال مع option.Value في F # ، من الممكن طرح استثناء من المنشئين إذا كان عنوان البريد الإلكتروني أو الرمز البريدي أو الحالة غير صحيح ، ولكن بالنسبة لـ C # فهذه ممارسة شائعة.  بالطبع ، يجب توفير رمز الاستثناء في رمز العمل هنا أو في مكان ما في رمز الاتصال. </p><br><h2 id="obrabotka-kontaktov-vne-ierarhii" style=";text-align:right;direction:rtl">  معالجة جهات الاتصال خارج التسلسل الهرمي </h2><br><p style=";text-align:right;direction:rtl">  من المنطقي وضع منطق لتحديث جهة اتصال في التسلسل الهرمي لجهة <code>Contact</code> نفسها.  ولكن ماذا لو كنت تريد تحقيق شيء لا يتناسب مع مجال مسؤوليتها؟  افترض أنك تريد عرض جهات الاتصال على واجهة المستخدم. </p><br><p style=";text-align:right;direction:rtl">  يمكنك بالطبع إضافة الطريقة المجردة إلى الفئة الأساسية مرة أخرى والاستمرار في إضافة طريقة جديدة في كل مرة تحتاج فيها إلى معالجة جهات الاتصال بطريقة أو بأخرى.  ولكن بعد ذلك سيتم انتهاك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مبدأ المسؤولية الوحيدة</a> ، وسيتم تشويش التسلسل الهرمي لجهة <code>Contact</code> وسوف يتم تعتيم منطق المعالجة بين عمليات تنفيذ جهات <code>Contact</code> والأماكن المسؤولة في الواقع عن معالجة جهات الاتصال.  لم يكن هناك مثل هذه المشكلة في F # ، وأود أن يكون رمز C # ليس أسوأ! </p><br><p style=";text-align:right;direction:rtl">  أقرب ما يعادل مطابقة النمط في C # هو تكوين التبديل.  يمكننا إضافة خاصية نوع تعداد إلى <code>Contact</code> التي تسمح لنا بتحديد نوع الاتصال الفعلي وإجراء التحويل.  سيكون من الممكن أيضًا استخدام الميزات الأحدث لـ C # وإجراء تبديل كمثيل لجهة <code>Contact</code> .  لكننا أردنا من المحول البرمجي أن يطالب نفسه عند إضافة حالات <code>Contact</code> جديدة صحيحة ، حيث لا توجد معالجة كافية للحالات الجديدة ، والتبديل لا يضمن معالجة جميع الحالات المحتملة. </p><br><p style=";text-align:right;direction:rtl">  لكن OOP لديه أيضًا آلية أكثر ملاءمة لاختيار المنطق اعتمادًا على النوع ، وقد استخدمناه للتو عند تحديث جهة اتصال.  وبما أن الاختيار يعتمد الآن على نوع الاستدعاء ، فيجب أن يكون متعدد الأشكال أيضًا.  الحل هو قالب الزائر.  يسمح لك بتحديد معالج اعتمادًا على تنفيذ <code>Contact</code> ، ويفصل طرق معالجة جهات الاتصال من التسلسل الهرمي الخاص بهم ، وإذا تمت إضافة نوع جديد من جهات الاتصال ، وبالتالي ، طريقة جديدة في واجهة الزائر ، ستحتاج إلى كتابتها في جميع تطبيقات الواجهة.  يتم استيفاء جميع المتطلبات! </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptVisitor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IContactVisitor visitor</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IContactVisitor</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Visit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, EmailContactInfo email</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Visit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, PostalContactInfo post</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Visit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, EmailContactInfo email, PostalContactInfo post</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptVisitor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IContactVisitor visitor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visitor == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(visitor)); } visitor.Visit(Name, email_); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PostOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptVisitor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IContactVisitor visitor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visitor == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(visitor)); } visitor.Visit(Name, post_); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailAndPostContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptVisitor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IContactVisitor visitor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (visitor == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(visitor)); } visitor.Visit(Name, email_, post_); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  الآن يمكنك كتابة رمز لعرض جهات الاتصال.  من أجل البساطة ، سأستخدم واجهة وحدة التحكم. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ContactUi</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Visitor</span></span> : <span class="hljs-title"><span class="hljs-title">IContactVisitor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> IContactVisitor.Visit(PersonalName name, EmailContactInfo email) { Console.WriteLine(name); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"* Email: {0}"</span></span>, email); } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> IContactVisitor.Visit(PersonalName name, PostalContactInfo post) { Console.WriteLine(name); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"* Postal address: {0}"</span></span>, post); } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> IContactVisitor.Visit(PersonalName name, EmailContactInfo email, PostalContactInfo post) { Console.WriteLine(name); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"* Email: {0}"</span></span>, email); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"* Postal address: {0}"</span></span>, post); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Display</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Contact contact</span></span></span><span class="hljs-function">)</span></span> =&gt; contact.AcceptVisitor(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Visitor()); }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ui = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ContactUi(); ui.Display(newContact);</code> </pre> <br><h2 id="dalneyshie-uluchsheniya" style=";text-align:right;direction:rtl">  مزيد من التحسينات </h2><br><p style=";text-align:right;direction:rtl">  إذا <code>Contact</code> الإعلان عن <code>Contact</code> في المكتبة وكان ظهور الورثة الجدد في عملاء المكتبة أمرًا غير مرغوب فيه ، يمكنك تغيير نطاق مُنشئ <code>Contact</code> إلى <code>internal</code> ، أو حتى جعل ورثتها متداخلين ، وإعلان رؤية عمليات التنفيذ والمنشئ <code>private</code> ، وإنشاء مثيلات من خلال طرق المصنع الثابتة فقط. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmailOnlyContact</span></span> : <span class="hljs-title"><span class="hljs-title">Contact</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmailOnlyContact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, EmailContactInfo email</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span> { } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Contact</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Contact </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmailOnly</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PersonalName name, EmailContactInfo email</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmailOnlyContact(name, email); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  وبالتالي ، من الممكن إعادة إنتاج عدم توسيع نطاق النوع ، على الرغم من ذلك ، كقاعدة عامة ، هذا غير مطلوب. </p><br><h1 id="zaklyuchenie" style=";text-align:right;direction:rtl">  الخاتمة </h1><br><p style=";text-align:right;direction:rtl">  آمل أن أكون قد تمكنت من إظهار كيفية تحديد الحالة الصحيحة لمنطق الأعمال باستخدام الأنواع باستخدام أدوات OOP.  تبين أن الرمز أكبر حجمًا من F #.  في مكان ما هذا يرجع إلى الإرهاق النسبي لقرارات OOP ، في مكان ما بسبب لغوية اللغة ، ولكن لا يمكن أن تسمى الحلول غير عملية. </p><br><p style=";text-align:right;direction:rtl">  ومن المثير للاهتمام ، بدءًا من حل وظيفي بحت ، توصلنا إلى توصية البرمجة الموجهة للموضوع وأنماط OOP.  في الواقع ، هذا ليس مفاجئًا ، لأن التشابه بين أنواع المبالغ ونمط الزائر <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">معروف منذ</a> بعض <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الوقت</a> .  لم يكن الغرض من هذه المقالة إظهار حيلة ملموسة بقدر ما هو إثبات مدى قابلية تطبيق الأفكار من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"برج العاج"</a> في البرمجة الحتمية.  بالطبع ، لا يمكن نقل كل شيء بهذه السهولة ، ولكن مع ظهور المزيد والمزيد من الوظائف في لغات البرمجة السائدة ، ستتوسع حدود التطبيق المعمول به. </p><br><hr><br><p style=";text-align:right;direction:rtl">  → يتوفر نموذج التعليمات البرمجية على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GitHub</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar431186/">https://habr.com/ru/post/ar431186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar431174/index.html">نظرية المحاكاة: علاقة الحسابات الكيميائية الكمية والواقع</a></li>
<li><a href="../ar431176/index.html">الخدمات المصغرة ، واجهات برمجة التطبيقات والابتكارات: قوة واجهات برمجة التطبيقات</a></li>
<li><a href="../ar431178/index.html">الكلمات الطفيلية في اللغة الإنجليزية</a></li>
<li><a href="../ar431180/index.html">Ext JS على الخادم</a></li>
<li><a href="../ar431184/index.html">شبكات WIFI متعددة الشبكات باستخدام تقنية Mesh Connex</a></li>
<li><a href="../ar431188/index.html">الجوانب التقنية لحجب الإنترنت في روسيا. التحديات والآفاق</a></li>
<li><a href="../ar431190/index.html">كيفية تقييم مستوى شركة SEO دون إبرام اتفاق معها</a></li>
<li><a href="../ar431192/index.html">يقدم AWC Firecracker - الظاهرية الدقيقة لنظام Linux</a></li>
<li><a href="../ar431194/index.html">المتشددين أنبوب دافئ. كيف كان DotNext 2018 موسكو</a></li>
<li><a href="../ar431196/index.html">كيف يتنبأ Yandex.Taxi بوقت تسليم السيارة باستخدام التعلم الآلي</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>