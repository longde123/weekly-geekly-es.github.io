<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê° üë®‚Äçüíª ‚óæÔ∏è Wi-Fi et de nombreuses autres abr√©viations. Comment obtenir des donn√©es sur des n≈ìuds Wi-Fi dans une application Android et ne pas gonfler üë©üèª‚Äçü§ù‚Äçüë®üèø üî¶ üíö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une fois, j'avais besoin de num√©riser les applications du r√©seau Wi-Fi depuis Android et d'obtenir un calcul d√©taill√© des donn√©es sur les points d'acc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wi-Fi et de nombreuses autres abr√©viations. Comment obtenir des donn√©es sur des n≈ìuds Wi-Fi dans une application Android et ne pas gonfler</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467765/"> Une fois, j'avais besoin de num√©riser les applications du r√©seau Wi-Fi depuis Android et d'obtenir un calcul d√©taill√© des donn√©es sur les points d'acc√®s. <br><a name="habracut"></a><br>  Ici, j'ai d√ª faire face √† plusieurs difficult√©s: dans la non <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-documentation d'Android, de</a> nombreuses classes d√©crites sont devenues obsol√®tes (niveau API&gt; 26), ce qui ne s'y refl√©tait pas;  la description de certaines choses dans la documentation est minime (par exemple, le champ des capacit√©s de la classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ScanResult</a> n'√©tait pas du tout d√©crit au moment de la r√©daction, bien qu'il contienne beaucoup de donn√©es importantes).  La troisi√®me difficult√© peut √™tre que lorsque vous vous approchez pour la premi√®re fois du Wi-Fi, ce qui est diff√©rent de la lecture de la th√©orie et de la configuration du routeur pour l'h√¥te local, vous devez traiter un certain nombre d'abr√©viations qui semblent √™tre claires s√©par√©ment.  Mais il peut ne pas √™tre √©vident de savoir comment les relier et les structurer (le jugement est subjectif et d√©pend de l'exp√©rience ant√©rieure). <br><br>  Cet article explique comment obtenir des donn√©es compl√®tes sur les environnements Wi-Fi √† partir de code Android sans NDK, sans piratage, mais uniquement en utilisant l'API Android et comment les interpr√©ter. <br><br>  Nous ne tirerons pas et ne commencerons pas √† √©crire du code. <br><br><h3>  1. Cr√©ez un projet </h3><br>  La note est con√ßue pour ceux qui ont cr√©√© le projet Android plus d'une fois, donc nous omettons les d√©tails de cet article.  Le code ci-dessous sera pr√©sent√© dans le langage Kotlin, minSdkVersion = 23. <br><br><h3>  2. Autorisations d'acc√®s </h3><br>  Pour travailler avec le Wi-Fi depuis l'application, vous devrez obtenir plusieurs autorisations de l'utilisateur.  Selon la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> , afin d'analyser le r√©seau sur des appareils avec des versions de syst√®me d'exploitation apr√®s 8.0, en plus d'acc√©der √† l'√©tat de l'environnement r√©seau, vous devez avoir acc√®s pour modifier l'√©tat du module Wi-Fi de l'appareil ou acc√©der aux coordonn√©es (approximatives ou exactes).  √Ä partir de la version 9.0, vous devez demander √† l'utilisateur √† la fois ceci et cela, et en m√™me temps demander explicitement √† l'utilisateur d'activer le service de localisation.  N'oubliez pas d'expliquer galamment √† l'utilisateur qu'il s'agit d'un caprice de Google, et non de notre envie de l'espionner :) <br><br>  Total, dans AndroidManifest.xml, ajoutez: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  Et dans le code qui a un lien vers l'activit√© en cours: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.location.LocationManager <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> androidx.core.app.ActivityCompat .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.O) { ActivityCompat.requestPermissions( activity, arrayOf(Manifest.permission.ACCESS_FINE_LOCATION, Manifest.permission.CHANGE_WIFI_STATE), <span class="hljs-number"><span class="hljs-number">1</span></span> ) makeEnableLocationServices(activity.applicationContext) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ActivityCompat.requestPermissions( activity, arrayOf(Manifest.permission.CHANGE_WIFI_STATE), <span class="hljs-number"><span class="hljs-number">1</span></span> ) } <span class="hljs-comment"><span class="hljs-comment">/*        */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeEnableLocationServices</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment">       ,      val lm: LocationManager = context.applicationContext.getSystemService(Context.LOCATION_SERVICE) as LocationManager val gpsEnabled: Boolean = lm.isProviderEnabled(LocationManager.GPS_PROVIDER); val networkEnabled: Boolean = lm.isProviderEnabled(LocationManager.NETWORK_PROVIDER); if (!gpsEnabled &amp;&amp; !networkEnabled) { context.startActivity(Intent(ACTION_LOCATION_SOURCE_SETTINGS)); } }</span></span></code> </pre><br><h3>  3. Cr√©ez BroadcastReceiver et abonnez-vous pour mettre √† jour les √©v√©nements sur l'analyse de l'environnement du r√©seau Wi-Fi </h3><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wifiManager = context.getSystemService(Context.WIFI_SERVICE) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> WifiManager <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wifiScanReceiver = <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : BroadcastReceiver() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">, intent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Intent</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> success = intent.getBooleanExtra(WifiManager.EXTRA_RESULTS_UPDATED, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (success) { scanSuccess() } } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> intentFilter = IntentFilter() <span class="hljs-comment"><span class="hljs-comment">/*         */</span></span> intentFilter.addAction(WifiManager.SCAN_RESULTS_AVAILABLE_ACTION) context.registerReceiver(wifiScanReceiver, intentFilter) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> success = wifiManager.startScan() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!success) { <span class="hljs-comment"><span class="hljs-comment">/* -     ,    */</span></span> } .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scanSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">/*  ,   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> results: List&lt;ScanResult&gt; = wifiManager.scanResults }</code> </pre><br>  La m√©thode WiFiManager.startScan dans la documentation est marqu√©e comme priv√©e de l'API version 28, mais d√©sactiv√©e.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">guide</a> sugg√®re de l'utiliser. <br><br>  Au total, nous avons re√ßu une liste d'objets <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ScanResult</a> . <br><br><h3>  4. Nous examinons ScanResult et comprenons les termes </h3><br>  Regardons quelques champs de cette classe et d√©crivons ce qu'ils signifient: <br><br>  <b>SSID</b> - Service Set Identifier est le nom du r√©seau. <br><br>  <b>BSSID</b> - Basic Service Set Identifier - Adresse MAC de la carte r√©seau (point Wi-Fi) <br><br>  <b>niveau</b> - Indicateur de force du signal re√ßu [dBm (dBm russe) - D√©cibel, puissance de r√©f√©rence 1 mW.] - Indicateur du niveau du signal re√ßu.  Il prend une valeur de 0 √† -100, plus loin de 0, plus la puissance du signal est perdue en cours de route du point Wi-Fi √† votre appareil.  Plus de d√©tails peuvent √™tre trouv√©s, par exemple, sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wikipedia</a> .  Ici, je vais vous dire qu'en utilisant la classe Android <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WifiManager,</a> vous pouvez calibrer le niveau du signal sur une √©chelle excellente √† terrible avec l'√©tape que vous avez s√©lectionn√©e: <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wifiManager = context.applicationContext.getSystemService(Context.WIFI_SERVICE) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> WifiManager <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numberOfLevels = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> level = WifiManager.calculateSignalLevel(level, numberOfLevels)</code> </pre><br>  <b>fr√©quence</b> - la fr√©quence du point Wi-Fi [Hz].  En plus de la fr√©quence elle-m√™me, vous pouvez √™tre int√©ress√© par ce que l'on appelle le canal.  Chaque point a sa propre propret√© de travail.  Au moment de la r√©daction du pr√©sent document, la plage de points Wi-Fi la plus populaire est de 2,4 GHz.  Mais, pour √™tre plus pr√©cis, le point transf√®re des informations sur votre t√©l√©phone √† une fr√©quence num√©rot√©e proche de celle indiqu√©e.  Le nombre de canaux et les valeurs des fr√©quences correspondantes sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">standardis√©s</a> .  Ceci est fait de sorte que les points voisins fonctionnent √† des fr√©quences diff√©rentes, n'interf√©rant ainsi pas entre eux et ne r√©duisant pas mutuellement la vitesse et la qualit√© de la transmission.  Dans le m√™me temps, les points ne fonctionnent pas sur la m√™me fr√©quence, mais sur la plage de fr√©quences ( <b>param√®tre</b> channelWidth), appel√©e largeur de canal.  C'est-√†-dire que les points op√©rant sur les canaux voisins (et pas seulement sur les canaux voisins, mais m√™me sur 3 d'eux-m√™mes) cr√©ent des interf√©rences les uns avec les autres.  Ce code simple peut vous √™tre utile, ce qui vous permet de calculer le num√©ro de canal par la valeur de fr√©quence pour les points avec une fr√©quence de 2,4 et 5 Ghz: <br><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> channel: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (frequency <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">2412</span></span>..<span class="hljs-number"><span class="hljs-number">2484</span></span>) { (frequency - <span class="hljs-number"><span class="hljs-number">2412</span></span>) / <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (frequency <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">5170</span></span>..<span class="hljs-number"><span class="hljs-number">5825</span></span>) { (frequency - <span class="hljs-number"><span class="hljs-number">5170</span></span>) / <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">34</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { -<span class="hljs-number"><span class="hljs-number">1</span></span> } }</code> </pre><br>  <b>capacit√©s</b> est le domaine d'analyse le plus int√©ressant, ce qui a pris beaucoup de temps √† travailler.  Ici, les "capacit√©s" du point sont √©crites sur la ligne.  Dans le m√™me temps, vous ne pouvez pas rechercher des d√©tails d'interpr√©tation de la cha√Æne dans la documentation.  Voici quelques exemples de ce qui pourrait se trouver sur cette ligne: <br><br><pre> <code class="bash hljs">[WPA-PSK-TKIP+CCMP][WPA2-PSK-TKIP+CCMP][WPS][ESS] [WPA2-PSK-CCMP][ESS] [WPA2-PSK-CCMP+TKIP][ESS] [WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][ESS] [ESS][WPS]</code> </pre><br><h3>  5. Comprendre les abr√©viations et les capacit√©s d'analyse </h3><br>  Il convient de mentionner que les classes du package android.net.wifi. * Utilise l'utilitaire linux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">wpa_supplicant</a> sous le capot, et la sortie dans le champ des capacit√©s est une copie du champ des drapeaux pendant l'analyse. <br><br>  Nous agirons s√©quentiellement.  Tout d'abord, consid√©rez la sortie d'un format dans lequel les √©l√©ments √† l'int√©rieur des crochets sont s√©par√©s par un "-": <br><br><pre> <code class="bash hljs">[WPA-PSK-TKIP+CCMP] [WPA2-PSK-CCMP]</code> </pre><br>  La premi√®re valeur d√©crit le soi-disant  <b>m√©thode d'authentification</b>  C'est-√†-dire, quelle s√©quence d'actions doit √™tre effectu√©e par l'appareil et le point d'acc√®s pour que le point d'acc√®s se permette d'√™tre utilis√© et comment crypter la charge utile.  Au moment de la r√©daction de cet article, les options les plus courantes sont WPA et WPA2, dans lesquelles chaque appareil connect√© directement ou via ce qu'on appelle.  Le serveur RADIUS (WPA-Enterprice) fournit un mot de passe sur un canal crypt√©.  Tr√®s probablement, √† votre domicile, le point d'acc√®s fournit une connexion selon ce sch√©ma.  La diff√©rence entre la deuxi√®me version et la premi√®re dans un chiffrement plus robuste: AES contre TKIP non s√©curis√©.  Le WPA3, plus complexe et avanc√©, est √©galement progressivement introduit.  Th√©oriquement, il peut y avoir une option avec la solution enterprice CCKM (Cisco Centralized Key Managment), mais je ne l'ai jamais rencontr√©e. <br><br>  Le point d'acc√®s peut √™tre configur√© pour l'authentification par adresse MAC.  Ou, si le point d'acc√®s fournit des donn√©es √† l'aide de l'algorithme WEP obsol√®te, il n'y a pratiquement pas d'authentification (la cl√© secr√®te ici est la cl√© de chiffrement).  Ces options sont class√©es comme AUTRES. <br>  Il existe √©galement une m√©thode pr√©f√©r√©e dans le Wi-Fi public avec d√©tection de portail captif cach√© - une demande d'authentification via un navigateur.  Ces points d'acc√®s semblent ouverts au scanner (ce qu'ils sont du point de vue de la connexion physique).  Par cons√©quent, nous les classons comme OUVERTS. <br><br>  La deuxi√®me valeur peut √™tre d√©sign√©e comme <b>l'algorithme de gestion des cl√©s</b> .  Il s'agit d'un param√®tre de la m√©thode d'authentification d√©crite ci-dessus.  Explique comment l'√©change de cl√©s de chiffrement se produit exactement.  Examinons les options possibles.  EAP - utilis√© dans le WPA-Enterprice susmentionn√©, utilise une base de donn√©es pour v√©rifier les donn√©es d'authentification entr√©es.  SAE - utilis√© en WPA3 avanc√©, plus r√©sistant √† l'√©clatement.  PSK est l'option la plus courante, elle implique la saisie du mot de passe et sa transmission sous forme crypt√©e.  IEEE8021X - selon la norme internationale (autre que celle prise en charge par la famille WPA).  OWE (Opportunistic Wireless Encryption) est une extension de la norme IEEE 802.11, pour les points que nous avons class√©s comme OUVERTS.  OWE assure la s√©curit√© des donn√©es transmises sur un r√©seau non s√©curis√© en les chiffrant.  Une variante est √©galement possible lorsqu'il n'y a pas de cl√© d'acc√®s; appelons cette option AUCUNE. <br><br>  Le troisi√®me param√®tre est le soi-disant  <b>m√©thode de chiffrement (sch√©mas de chiffrement)</b> - comment exactement le chiffrement est-il utilis√© pour prot√©ger les donn√©es transmises.  Nous listons les options.  WEP - utilise un chiffrement de flux RC4, la cl√© secr√®te est une cl√© de chiffrement, ce qui est consid√©r√© comme inacceptable dans le monde de la cryptographie moderne.  TKIP - utilis√© dans WPA, CKIP - dans WPA2.  TKIP + CKIP - peut √™tre sp√©cifi√© √† des points capables de WPA et WPA2 pour une compatibilit√© descendante. <br><br>  Au lieu de trois √©l√©ments, vous pouvez trouver une seule marque WEP: <br><br><pre> <code class="bash hljs">[WEP]</code> </pre><br>  Comme nous l'avons vu ci-dessus, cela suffit pour ne pas sp√©cifier l'algorithme d'utilisation des cl√©s, qui n'est pas l√†, et la m√©thode de cryptage, qui est une par d√©faut. <br><br>  Consid√©rez maintenant ce support: <br><br><pre> <code class="bash hljs">[ESS]</code> </pre><br>  Il s'agit <b>du mode de fonctionnement Wi-Fi</b> ou de la <b>topologie des r√©seaux Wi-Fi</b> .  Vous pouvez rencontrer le mode BSS (Basic Service Set) - lorsqu'il y a un point d'acc√®s par lequel les appareils connect√©s communiquent.  Peut √™tre trouv√© sur les r√©seaux locaux.  En r√®gle g√©n√©rale, des points d'acc√®s sont n√©cessaires pour connecter des p√©riph√©riques de diff√©rents r√©seaux locaux, ils font donc partie des ensembles de services √©tendus - ESS.  Le type d'IBSS (Independent Basic Service Sets) indique que le p√©riph√©rique fait partie d'un r√©seau peer-to-peer. <br><br>  Le drapeau WPS peut √©galement tomber: <br><br><pre> <code class="bash hljs">[WPS]</code> </pre><br>  WPS (Wi-Fi Protected Setup) - un protocole pour l'initialisation semi-automatique d'un r√©seau Wi-Fi.  Pour initialiser, l'utilisateur entre un mot de passe √† 8 caract√®res ou serre un bouton sur le routeur.  Si votre point d'acc√®s est du premier type et que cet indicateur est mis en surbrillance en face du nom de votre point d'acc√®s, il est fortement recommand√© d'aller dans le panneau d'administration et de d√©sactiver l'acc√®s via WPS.  Le fait est que souvent un code PIN √† 8 chiffres peut √™tre reconnu par l'adresse MAC, ou tri√© dans les d√©lais pr√©visibles, dont une personne impure peut profiter. <br><br><h3>  6. Cr√©ez un mod√®le et une fonction d'analyse </h3><br>  Sur la base de ce que nous avons d√©couvert ci-dessus, nous d√©crivons avec des classes de donn√©es ce qui s'est pass√©: <br><br><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthMethod</span></span></span><span class="hljs-class"> </span></span>{ WPA3, WPA2, WPA, <span class="hljs-comment"><span class="hljs-comment">// Wi-Fi Protected Access OTHER, //    Shared Key Authentication  .  mac-address-based  WEP CCKM, // Cisco OPEN // Open Authentication.     Captive Portal Detection -     } /*    */ enum class KeyManagementAlgorithm { IEEE8021X, //   EAP, // Extensible Authentication Protocol,    PSK, // Pre-Shared Key ‚Äî         WEP, //  WEP     (No auth key) SAE, // Simultaneous Authentication of Equals -    WPA3 OWE, // Opportunistic Wireless Encryption -    ,    OPEN NONE //      OPEN, OTHER } /*   */ enum class CipherMethod { WEP, // Wired Equivalent Privacy,       TKIP, // Temporal Key Integrity Protocol CCMP, // Counter Mode with Cipher Block Chaining Message Authentication Code Protocol, //              //   AES NONE //      OPEN, OTHER } /*     ,      */ data class Capability( var authScheme: AuthMethod? = null, var keyManagementAlgorithm: KeyManagementAlgorithm? = null, var cipherMethod: CipherMethod? = null ) /*   WiFi (   WiFi) */ enum class TopologyMode { IBSS, //   (Ad-Hoc  IBSS ‚Äì Independent Basic Service Set). BSS, //    Basic Service Set (BSS)  Infrastructure Mode. ESS //    ESS ‚Äì Extended Service Set. }</span></span></code> </pre><br>  Nous allons maintenant √©crire une fonction qui analysera le champ des capacit√©s: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseCapabilities</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capabilitiesString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List &lt; Capability &gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> capabilities: List &lt; Capability &gt; = capabilitiesString .splitByBrackets() .filter { !it.isTopology() &amp;&amp; !it.isWps() } .flatMap { parseCapability(it) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!capabilities.isEmpty()) { capabilities } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { listOf(Capability(AuthMethod.OPEN, KeyManagementAlgorithm.NONE, CipherMethod.NONE)) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseCapability</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(part: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List &lt; Capability &gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"WEP"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> listOf(Capability( AuthMethod.OTHER, KeyManagementAlgorithm.WEP, CipherMethod.WEP )) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> authScheme = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { part.contains(<span class="hljs-string"><span class="hljs-string">"WPA3"</span></span>) - &gt; AuthMethod.WPA3 part.contains(<span class="hljs-string"><span class="hljs-string">"WPA2"</span></span>) - &gt; AuthMethod.WPA2 part.contains(<span class="hljs-string"><span class="hljs-string">"WPA"</span></span>) - &gt; AuthMethod.WPA <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> - &gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> keyManagementAlgorithm = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { part.contains(<span class="hljs-string"><span class="hljs-string">"OWE"</span></span>) - &gt; KeyManagementAlgorithm.OWE part.contains(<span class="hljs-string"><span class="hljs-string">"SAE"</span></span>) - &gt; KeyManagementAlgorithm.SAE part.contains(<span class="hljs-string"><span class="hljs-string">"IEEE802.1X"</span></span>) - &gt; KeyManagementAlgorithm.IEEE8021X part.contains(<span class="hljs-string"><span class="hljs-string">"EAP"</span></span>) - &gt; KeyManagementAlgorithm.EAP part.contains(<span class="hljs-string"><span class="hljs-string">"PSK"</span></span>) - &gt; KeyManagementAlgorithm.PSK <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> - &gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> capabilities = ArrayList &lt; Capability &gt; () <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"TKIP"</span></span>) || part.contains(<span class="hljs-string"><span class="hljs-string">"CCMP"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"TKIP"</span></span>)) { capabilities.add(Capability( authScheme ? : AuthMethod.OPEN, keyManagementAlgorithm ? : KeyManagementAlgorithm.NONE, CipherMethod.TKIP )) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (part.contains(<span class="hljs-string"><span class="hljs-string">"CCMP"</span></span>)) { capabilities.add(Capability( authScheme ? : AuthMethod.OPEN, keyManagementAlgorithm ? : KeyManagementAlgorithm.NONE, CipherMethod.CCMP )) } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (authScheme != <span class="hljs-literal"><span class="hljs-literal">null</span></span> || keyManagementAlgorithm != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { capabilities.add(Capability( authScheme ? : AuthMethod.OPEN, keyManagementAlgorithm ? : KeyManagementAlgorithm.NONE, CipherMethod.NONE )) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> capabilities } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseTopologyMode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capabilitiesString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: TopologyMode ? { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> capabilitiesString .splitByBrackets() .mapNotNull { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> { it.contains(<span class="hljs-string"><span class="hljs-string">"ESS"</span></span>) - &gt; TopologyMode.ESS it.contains(<span class="hljs-string"><span class="hljs-string">"BSS"</span></span>) - &gt; TopologyMode.BSS it.contains(<span class="hljs-string"><span class="hljs-string">"IBSS"</span></span>) - &gt; TopologyMode.IBSS <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> - &gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> } } .firstOrNull() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseWPSAvailable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(capabilitiesString: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> capabilitiesString .splitByBrackets() .any { it.isWps() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> String.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">splitByBrackets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: List &lt; String &gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> m = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"\\[(.*?)\\]"</span></span>).matcher(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> parts = ArrayList &lt; String &gt; () <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (m.find()) { parts.add(m.group().replace(<span class="hljs-string"><span class="hljs-string">"["</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-string"><span class="hljs-string">"]"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parts } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> String.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isTopology</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TopologyMode.values().any { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == it.name } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> String.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isWps</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == <span class="hljs-string"><span class="hljs-string">"WPS"</span></span> }</code> </pre><br><h3>  8. Nous regardons le r√©sultat </h3><br>  Je vais scanner le r√©seau et montrer ce qui s'est pass√©.  Affichage des r√©sultats d'une sortie simple via Log.d: <br><br><pre> <code class="plaintext hljs">Capability of Home-Home [WPA2-PSK-CCMP][ESS][WPS] ... capabilities=[Capability(authScheme=WPA2, keyManagementAlgorithm=PSK, cipherMethod=CCMP)], topologyMode=ESS, availableWps=true</code> </pre><br>  La question de la connexion au r√©seau √† partir du code d'application est rest√©e √©teinte.  Je peux seulement dire que pour lire les mots de passe du syst√®me d'exploitation enregistr√©s d'un appareil mobile, vous avez besoin des droits root et d'une volont√© de fouiller dans le syst√®me de fichiers pour lire wpa_supplicant.conf.  Si la logique d'application implique la saisie d'un mot de passe de l'ext√©rieur, la connexion peut √™tre √©tablie via la classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">android.net.wifi.WifiManager</a> . <br><br>  Merci √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Egor Ponomarev</a> pour ses pr√©cieux ajouts. <br><br>  Si vous pensez que vous devez ajouter ou corriger quelque chose, √©crivez dans les commentaires :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467765/">https://habr.com/ru/post/fr467765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467753/index.html">Record du monde pour la transmission de donn√©es sans fil: 40 Gb / s par 11 kilom√®tres</a></li>
<li><a href="../fr467755/index.html">Prions, calcium, microbiote, hormones alimentaires et Alzheimer</a></li>
<li><a href="../fr467759/index.html">Conception de syst√®me d'exploitation de type Unix - Espace d'adressage virtuel (6)</a></li>
<li><a href="../fr467761/index.html">√ânergie, chaleur et eau, troisi√®me partie: allez √† la radio</a></li>
<li><a href="../fr467763/index.html">Toute la v√©rit√© sur RTOS. Article # 33. Utilisation du syst√®me d'exploitation en temps r√©el Nucleus SE</a></li>
<li><a href="../fr467767/index.html">Plus d'√©quipements pour les abonn√©s JSON-RPC</a></li>
<li><a href="../fr467771/index.html">Comme un auto-rechargeur vert junior a √©crit son <s> hot </s>. Partie 2. CSS</a></li>
<li><a href="../fr467775/index.html">5 mythes sur les affaires: pourquoi le client a tort et comment d√©passer Apple</a></li>
<li><a href="../fr467779/index.html">√Ä propos de Godot, GLSL et WebGL, shaders utilis√©s dans le mini-jeu</a></li>
<li><a href="../fr467781/index.html">Cours C ++ au centre CS, premi√®re partie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>