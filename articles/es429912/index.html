<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø üßùüèæ üöÖ Desarrollo de bibliotecas: de API a lanzamiento p√∫blico üë®üèΩ‚Äçüè´ üé± ‚öîÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Miremos las bibliotecas no desde el lado que nos es m√°s familiar, es decir, desde el usuario, sino desde el punto de vista del desarrollador de la bib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de bibliotecas: de API a lanzamiento p√∫blico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/429912/">  Miremos las bibliotecas no desde el lado que nos es m√°s familiar, es decir, desde el usuario, sino desde el punto de vista del desarrollador de la biblioteca de desarrollo m√≥vil.  Hablemos sobre los enfoques que se deben seguir al desarrollar su biblioteca.  Comenzamos, por supuesto, dise√±ando una API tal que usted mismo quisiera usar, lo cual ser√≠a conveniente.  Pensaremos en lo que debe tenerse en cuenta para hacer no solo un c√≥digo que funcione, sino una biblioteca realmente buena, y llegaremos al punto de lanzar un lanzamiento p√∫blico real para adultos.  <strong>Asya Sviridenko</strong> nos ayudar√° en esto, quien compartir√° su considerable experiencia en el desarrollo de la biblioteca m√≥vil SpeechKit en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yandex</a> . <br><br>  El material ser√° √∫til no solo para aquellos involucrados en el desarrollo de una biblioteca o marco, sino tambi√©n para aquellos que desean separar una parte de su aplicaci√≥n en un m√≥dulo separado y luego reutilizarla o, por ejemplo, compartir su c√≥digo con el resto de la comunidad de desarrolladores al publicarlo en acceso publico. <br><br>  Para todos los dem√°s, la historia estar√° llena de historias genuinas de la vida del equipo m√≥vil SpeechKit, por lo que deber√≠a ser divertido. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/uvx060VepYo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h3>  Contenido <br></h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SpeechKit minuto</a> . <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dise√±ando una</a> API conveniente y comprensible que quieras usar. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollo</a> .  Qu√© agregar al c√≥digo para que no solo funcione y realice funciones, sino que tambi√©n ayude a sus usuarios. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lanzamiento</a> : lo que no debe olvidar cuando lanza el lanzamiento. <br></li></ul><br><a name="speechkit"></a><br><h2>  SpeechKit minuto </h2><br>  No le preguntar√© si escuch√≥ sobre SpeechKit, porque incluso dentro de Yandex, no todos saben lo que es. <br><br>  <strong>SpeechKit es la puerta a todas las tecnolog√≠as de voz de Yandex</strong> .  Con esta biblioteca, puede integrar tecnolog√≠as de voz en su aplicaci√≥n: reconocimiento y s√≠ntesis de voz, activaci√≥n por voz. <br><br>  Probablemente escuchaste sobre la asistente de voz Alice, ella solo trabaja sobre la base de SpeechKit.  SpeechKit en s√≠ no incluye reconocimiento o s√≠ntesis, sucede en el servidor.  Pero es a trav√©s de nuestra biblioteca que todo se puede integrar en la aplicaci√≥n. <br><br>  La siguiente pregunta suele ser: si sucede todo en el servidor, ¬øqu√© hace la biblioteca?  ¬øPor qu√© es necesario? <br><br>  La biblioteca hace mucho: <br><br><ol><li>  <strong>Sincronizaci√≥n de todos los procesos.</strong>  Por ejemplo, al usar un asistente de voz, un usuario hace clic en un bot√≥n, dice algo, interrumpe al asistente, hace solicitudes, todo pasa por la biblioteca.  Para el usuario de nuestra biblioteca esto es transparente, no deben preocuparse por todo esto. </li><li> <strong>Redes</strong>  Como todo sucede en el servidor, debe obtener datos desde all√≠, procesarlos y entreg√°rselos al usuario.  SpeechKit ahora puede ir a varios servidores diferentes dentro de la misma conexi√≥n de red: uno est√° dedicado al reconocimiento, el otro est√° en la asignaci√≥n de significado, el tercero est√° en el reconocimiento de m√∫sica, etc.  Todo esto est√° oculto dentro de la biblioteca, los usuarios no necesitan preocuparse por ello. </li><li>  <strong>Trabaja con fuentes de audio.</strong>  Estamos tratando con el habla humana, y el trabajo con audio tambi√©n ocurre dentro de SpeechKit.  Adem√°s, no solo podemos escribir desde un dispositivo est√°ndar, sino tambi√©n recibir datos desde cualquier lugar.  Puede ser un archivo o una secuencia; podemos trabajar con todo esto. </li></ol><br>  SpeechKit se usa en equipos internos.  Ahora ha sido integrado por 16 equipos de Yandex.  E incluso sabemos sobre varios equipos externos que tambi√©n hicieron esto. <br><a name="disain"></a><br><h2>  Dise√±o </h2><br>  Pensemos en lo que queremos decir con una aplicaci√≥n conveniente.  Por lo general, esta es una experiencia de usuario reflexiva y comprensible, la soluci√≥n a nuestros problemas, operaci√≥n estable, etc. <br><br>  Cuando decimos que una biblioteca es conveniente, en primer lugar queremos decir que tiene una API que es f√°cil de usar.  ¬øC√≥mo lograr esto? <br><br><h3>  Principios b√°sicos <br></h3><br>  Estos son algunos de los aspectos que he aprendido de mi experiencia con SpeechKit. <br><br><ul><li>  <strong>En primer lugar, recuerde que sus usuarios son desarrolladores</strong> . <br></li></ul><br>  Por un lado, es bueno, porque no explicas a los usuarios comunes: "Ver√°s, el backend est√° con nosotros y, por lo tanto, nada funciona, ¬°y estamos bien!"  Puede explic√°rselo a los desarrolladores, ¬°puede explicarles mucho a los desarrolladores! <br><br>  Por otro lado, obtienes esos usuarios que definitivamente aprovechar√°n la oportunidad de encontrar un agujero y romper algo si lo dejas.  Todos usamos bibliotecas e intentamos aprovecharlas al m√°ximo.  Afirman que solo est√°n haciendo esto, esto y esto, y estamos pensando: "No, ahora jugaremos una peque√±a broma aqu√≠, la pasaremos y todo ser√° como deber√≠a". <br><br>  Adem√°s, el hecho de que los usuarios sean desarrolladores significa que siempre tendr√° una monta√±a de consejos y trucos sobre c√≥mo desarrollar y c√≥mo mejorar todo. <br><br>  El segundo punto importante es totalmente consistente con el primero. <br><br><ul><li>  <strong>Todo lo que no est√© permitido en su biblioteca debe estar prohibido,</strong> <strong><br></strong>  <strong>para que no haya lagunas no deseadas.</strong> <br></li></ul><br>  Si sus usuarios comienzan a hacer algo con la biblioteca que no esperaba, esta es una ruta directa a los errores y aquellos que son dif√≠ciles de depurar.  Trate de usar todo lo que el lenguaje le da y la tecnolog√≠a que usa: p√∫blico / privado, final, obsoleto, de solo lectura.  Reduzca el alcance, proh√≠ba la herencia y el uso de algunos m√©todos, marque las propiedades que no se pueden cambiar: proporcione todo lo posible para evitar algo para lo que su biblioteca simplemente no est√° dise√±ada. <br><br><ul><li>  <strong>No permita ambig√ºedades en la interpretaci√≥n de la API de su biblioteca.</strong> <br></li></ul><br>  Si esta clase particular se puede crear de una manera, niegue todas las dem√°s.  Si esta propiedad no puede ser nula, especif√≠quela expl√≠citamente.  En iOS hay un inicializador designado nulo / no nulo, lo mismo ocurre en Java y Android.  Use todo esto para que el usuario abra el archivo, abra su clase, lo revise e inmediatamente comprenda qu√© se puede hacer y qu√© no se puede hacer. <br><br><h3>  Case SpeechKit API <br></h3><br>  Usando SpeechKit como ejemplo, le dir√© c√≥mo refactorizamos la versi√≥n 2 a la versi√≥n 3. Cambiamos mucho la API e intentamos usar todos estos principios. <br><br>  La necesidad surgi√≥ porque la <strong>API era compleja y "te√≥rica"</strong> .  Hab√≠a componentes globales que deb√≠an llamarse primero, no llamarse, no todo funcion√≥.  Se establecieron configuraciones muy extra√±as.  La API era bastante "te√≥rica", porque SpeechKit era originalmente parte del navegador, y luego esta pieza fue llevada a la biblioteca.  La API esencialmente funcion√≥ con los casos utilizados en Navigator. <br><br>  Poco a poco, el n√∫mero de usuarios creci√≥ y comenzamos a comprender lo que realmente necesitaban: qu√© m√©todos, devoluciones de llamada, par√°metros.  Nos llegaron con solicitudes que la API no permiti√≥ implementar.  Esto se repiti√≥ una y otra vez, y qued√≥ claro que la API no estaba a la altura.  Entonces nos involucramos en la refactorizaci√≥n. <br><br>  <strong>El proceso de refactorizaci√≥n fue largo (medio a√±o) y doloroso (todos estaban descontentos)</strong> .  La principal dificultad era no tomar una monta√±a de c√≥digo y reescribirla.  Era imposible simplemente refactorizar, pero era necesario admitir todas las versiones activas que estaban en uso.  No podr√≠amos simplemente decirles a nuestros usuarios: "Chicos, s√≠, no funciona para ustedes, s√≠, necesitan esta funci√≥n: haremos todo en la versi√≥n 3, ¬°esperen seis meses!" <br><br>  Como resultado, la refactorizaci√≥n tom√≥ mucho tiempo, y el proceso fue doloroso, y tambi√©n para los usuarios.  Porque al final, cambiamos la API sin compatibilidad con versiones anteriores.  Se acercaron a ellos y dijeron: "Aqu√≠ hay un nuevo y hermoso SpeechKit, ¬°t√≥malo!"  - respondieron: "No, no tenemos planes de actualizar a su versi√≥n 3.0 en absoluto".  Por ejemplo, tuvimos un equipo que cambi√≥ a esta versi√≥n dentro de un a√±o.  Por lo tanto, durante todo un a√±o apoyamos la versi√≥n anterior para ellos. <br><br>  Pero el resultado vali√≥ la pena.  Obtuvimos <strong>una integraci√≥n simple y menos errores</strong> .  Esto es lo que mencion√© en los principios b√°sicos de dise√±o de la API.  Si est√° seguro de que su API se est√° utilizando correctamente, definitivamente no hay problemas en esta parte: todas las clases se llaman correctamente, todos los par√°metros son correctos.  Encontrar errores es mucho m√°s f√°cil, menos casos en los que algo puede salir mal. <br><br>  A continuaci√≥n se muestra un ejemplo de c√≥mo se ve√≠a la clase principal que se ocupa del reconocimiento antes de refactorizar. <br><br><pre><code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">// SpeechKit v2 @interface YSKRecognizer: NSObject @property (nonatomic, strong, readonly, getter=getModel) NSString* model; @property (nonatomic, assign, getter=isVADEnabled) BOOL VADEnabled; - (instancetype)initWithLanguage:(NSString *)language model:(NSString *)m; - (void)start; - (void)cancel; - (void)cancelSync; @end @interface YSKInitializer: NSObject - (instancetype)init; - (void)dealloc; - (void)start; + (BOOL)isInitializationCompleted; @end extern NSString *const YSKInactiveTimeout; extern NSString *const YSKVADEnabled; @interface YSKSpeechKit: NSObject + (instancetype)sharedInstance; ‚Äì (void)setParameter:(NSString *)name withValue:(NSString *)value; @end</span></span></code> </pre> <br>  Esta es una clase regular que hereda de NSObject.  Consideremos cada uno de sus detalles por separado.  Est√° claro que podemos heredar de √©l, redefinir algunos m√©todos en √©l, todo lo que se puede hacer con NSObject. <br><br>  Luego, al crear, se le pasan dos l√≠neas (lenguaje y modelo).  ¬øQu√© son estas l√≠neas?  Si pasa el idioma "Hola, mundo", entonces la salida ser√° una traducci√≥n, ¬øo qu√©?  No muy claro. <br><br>  Adem√°s, dado que este es el sucesor de NSObject, podemos llamar a init, new, etc.  Que va a pasar  ¬øFuncionar√° o esperar√° algunos par√°metros? <br><br>  Por supuesto, s√© las respuestas a estas preguntas, conozco este c√≥digo.  Pero las personas que miran esto por primera vez no entienden por qu√© esto es todo.  Incluso los m√©todos con setter y getter no miran en absoluto c√≥mo podr√≠a ser en iOS.  Los m√©todos start, cancel, cancelSync (y el que simplemente cancela, ¬øes aSync?), ¬øQu√© suceder√° si se convocan juntos?  Muchas preguntas a este c√≥digo. <br><br>  Luego viene el objeto del que habl√© (YSKInitializer), que debe iniciarse para que todo funcione, generalmente es alg√∫n tipo de magia.  Se puede ver que este c√≥digo fue escrito por desarrolladores que no escriben para iOS, pero est√°n comprometidos con C ++. <br><br>  Adem√°s, la configuraci√≥n de este reconocedor se estableci√≥ a trav√©s de componentes globales que se transfirieron a otro objeto global, y de hecho fue imposible crear dos reconocedores diferentes con diferentes conjuntos de par√°metros.  Y este fue probablemente uno de los casos m√°s populares que no admit√≠a la API. <br><br><h3>  Que v3 es mejor que v2 <br></h3><br>  ¬øQu√© obtuvimos cuando reestructuramos y cambiamos a la versi√≥n 3? <br><br><ul><li>  <strong>API completamente nativa.</strong> <br></li></ul><br>  Ahora nuestra API de iOS se parec√≠a a la API de iOS, la API de Android se parec√≠a a Android. <br><br><blockquote>  Un punto importante que no nos dimos cuenta de inmediato es que las pautas de la plataforma son mucho m√°s importantes que la uniformidad de la API de su biblioteca. <br></blockquote><br>  Por ejemplo, las clases para Android se crean utilizando constructores, porque este es un patr√≥n muy comprensible para los desarrolladores de Android.  En iOS, esto no es tan popular, por lo que se utiliza un enfoque diferente: creamos objetos con una clase especial de configuraciones. <br><br>  Recuerdo c√≥mo discutimos durante mucho tiempo sobre este tema.  Nos pareci√≥ importante que el desarrollador tomara nuestro c√≥digo en iOS o Android, y la coincidencia ser√≠a del 99%.  Pero esto no es as√≠.  Mejor, el c√≥digo ser√° similar a la plataforma para la cual se est√° desarrollando. <br><br><ul><li>  <strong>Inicializaci√≥n simple e intuitiva</strong> . <br></li></ul><br>  Este objeto es necesario: aqu√≠ est√°n sus configuraciones, cr√©elos, transfi√©ralos: ¬°obtenga ganancias!  Es decir, no hay configuraciones globales ocultas que deban transferirse a alguna parte. <br><br><ul><li>  <strong>Falta de componentes globales.</strong> <br></li></ul><br>  Descartamos componentes globales que confundieron, asustaron y causaron muchas preguntas incluso entre los desarrolladores de esta biblioteca, no solo los usuarios. <br><br>  Ahora la misma clase en la nueva versi√≥n se ve as√≠ (sigue siendo Objective-C, entonces no puedes cambiar a Swift). <br><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">// SpeechKit v3 NS_ASSUME_NONNULL_BEGIN __attribute__((objc_subclassing_restricted)) @interface YSKOnlineRecognizer: NSObject&lt;YSKRecognizing&gt; @property (nonatomic, copy, readonly) YSKOnlineRecognizerSettings *settings; - (instancetype)initWithSettings:(YSKOnlineRecognizerSettings *)s audioSource:(id&lt;YSKAudioSource&gt;)as NS_DESIGNATED_INITIALIZER; + (instancetype)new __attribute__((unavailable("Use designated initializer."))); - (instancetype)init __attribute__((unavailable("Use designated initializer."))); @end NS_ASSUME_NONNULL_END @protocol YSKRecognizing &lt;NSObject&gt; - (void)prepare; - (void)startRecording; - (void)cancel; @end @interface YSKOnlineRecognizerSettings: NSObject&lt;NSCopying&gt; @property (nonatomic, copy, readonly) YSKLanguage *language; @property (nonatomic, copy, readonly) YSKOnlineModel *model; @property (nonatomic, assign) BOOL enableVAD; - (instancetype)initWithLanguage:(YSKLanguage *)l model:(YSKOnlineModel *)m NS_DESIGNATED_INITIALIZER; @end @interface YSKLanguage: YSKSetting + (instancetype)russian; + (instancetype)english; @end</span></span></code> </pre><br>  Este es el sucesor de NSObject, pero ahora estamos hablando claramente del hecho de que no puede heredar de √©l.  Todos los m√©todos que son caracter√≠sticos de este objeto se transfieren a un protocolo especial.  Se crea usando la configuraci√≥n y audioSource.  Ahora todas las configuraciones est√°n encapsuladas en un solo objeto, que se transfiere espec√≠ficamente aqu√≠ para establecer las configuraciones para un reconocedor espec√≠fico. <br><br>  Adem√°s, eliminamos el trabajo con audio de aqu√≠, es decir, el explorador ahora no es el componente que escribe audio.  Este componente trata los problemas de reconocimiento, y cualquier fuente puede transferirse aqu√≠. <br><br>  Se proh√≠ben otros m√©todos de creaci√≥n a trav√©s de new o init, porque esta clase necesita una configuraci√≥n predeterminada.  Por favor, si desea usarlo, cree al menos algunas configuraciones predeterminadas. <br><br>  Lo principal es que las configuraciones que se transfieren aqu√≠ son inmutables, es decir, no puede cambiarlas en el proceso.  No es necesario intentar, cuando se reconoce algo, reemplazar el modelo o el idioma.  En consecuencia, no les damos a los usuarios la oportunidad de cambiar el objeto con la configuraci√≥n que ya se ha transferido. <br><br>  Macros NS_ASSUME_NONNULL_BEGIN / NS_ASSUME_NONNULL_END para enfatizar que esta configuraci√≥n no puede ser nula: audioSource no puede ser nulo; todo debe tener alg√∫n valor espec√≠fico para que funcione. <br><br>  Como dije, los m√©todos de inicio y cancelaci√≥n (cancelSync a la izquierda) se trasladaron a un protocolo separado.  Hay lugares en la biblioteca donde puede usar no nuestro explorador, sino cualquier otro.  Por ejemplo, utilizamos el nativo de Apple, que implementa este protocolo y al cual puede transferir nuestros componentes. <br><br>  La configuraci√≥n aqu√≠ es NSCopying para que podamos copiarla y no se puedan cambiar en el proceso.  En init, los par√°metros requeridos son idioma, modelo y NS_DESIGNATED_INITIALIZER.  Este no es un c√≥digo id√©ntico a los m√©todos obsoletos, pero la idea es clara.  Estos son par√°metros obligatorios con los que se crean las configuraciones.  Deben ser y no deben ser cero. <br><br>  El resto del conjunto es de aproximadamente 20 configuraciones del reconocedor que se establecen aqu√≠.  Incluso la configuraci√≥n de un idioma o modelo tambi√©n son clases separadas que no nos permiten transmitir algo abstracto, con el que no podemos trabajar.  Es decir, decimos claramente: ‚ÄúPor favor, no nos des algo con lo que no sabemos c√≥mo trabajar.  El compilador no te permitir√° hacer esto ". <br><br>  Entonces, hablamos sobre lo que puede hacer con la API.  El desarrollo tambi√©n tiene sus propios matices. <br><a name="develop"></a><br><h2>  Desarrollo </h2><br>  En primer lugar, la biblioteca debe hacer lo que usted escribi√≥ para realizar bien su funcionalidad.  Pero puede hacer que su c√≥digo sea una biblioteca realmente buena.  Propongo varios comentarios que recopil√© durante el desarrollo de SpeechKit. <br><br><h3>  El c√≥digo no es solo para ti <br></h3><br>  <strong>Es</strong> absolutamente necesario <strong>recopilar informaci√≥n de depuraci√≥n</strong> , ya que no desea que los usuarios digan que su servicio no funciona debido a su biblioteca. <br><br>  IOS tiene un nivel de informaci√≥n de depuraci√≥n que muestra qu√© informaci√≥n debe recopilarse.  Por defecto, recopilar√° absolutamente todo lo que pueda encontrar: todas las llamadas, todos los valores.  Esto es genial, pero es una gran cantidad de datos.  Establecer -gline-tables-only le permite recopilar informaci√≥n sobre llamadas a funciones.  Esto es m√°s que suficiente para encontrar un problema y solucionarlo. <br><br>  Esto se incluye en la configuraci√≥n de Xcode (Configuraci√≥n de compilaci√≥n) y se denomina nivel de informaci√≥n de depuraci√≥n.  Por ejemplo, al activar esta configuraci√≥n, redujimos el tama√±o del archivo binario SpeechKit de 600 MB a 90 MB.  Esta informaci√≥n no es muy necesaria y la descartamos. <br><br>  La segunda cosa importante es <strong>ocultar personajes privados</strong> .  Todos saben que cada vez que carga una biblioteca en iTunes, corre el riesgo de recibir una nueva advertencia de que est√° usando algo incorrecto, no agregando algo.  Por lo tanto, si usa bibliotecas que Apple considera privadas, aseg√∫rese de ocultarlas.  Esto no significa nada para usted, tambi√©n puede trabajar con ellos, pero tan pronto como sus usuarios intenten cargar la aplicaci√≥n con su biblioteca en iTunes, recibir√°n un error.  No todos le pedir√°n que lo arregle; la mayor√≠a simplemente se negar√° a usar su soluci√≥n. <br><br>  <strong>Evite conflictos de caracteres</strong> : agregue prefijos a todo lo que tenga, a sus clases, a categor√≠as.  Si la biblioteca tiene una categor√≠a UIColor + HEX, aseg√∫rese de que sus usuarios tengan exactamente la misma categor√≠a, y cuando integren su biblioteca, recibir√°n conflictos de caracteres.  Y nuevamente, no todos querr√°n dec√≠rtelo y decirlo. <br><br>  Otra pregunta es cuando usted mismo utiliza bibliotecas de terceros en su biblioteca.  Hay un par de matices que vale la pena recordar.  En primer lugar, si usa algo que apareci√≥ en una versi√≥n anterior a su biblioteca, no olvide usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Vinculaci√≥n d√©bil</a> (Xcode -&gt; Fases de compilaci√≥n -&gt; Enlace binario con bibliotecas -&gt; El estado est√° activado).  Esto le permite no caerse si de repente esta biblioteca no lo es. <br><br>  La documentaci√≥n de Apple detalla c√≥mo funciona esto.  Pero un enlace d√©bil no significa que la biblioteca no se cargar√° si no se usa.  Es decir, si la hora de inicio de la aplicaci√≥n es importante para sus usuarios, y es posible que no necesite la parte de su biblioteca que utiliza una biblioteca de terceros y toma tiempo para comenzar, los enlaces d√©biles no lo ayudar√°n.  Con √©l, la biblioteca a√∫n se carga si se usa o no. <br><br>  Si desea cargar en tiempo de ejecuci√≥n, esto ayudar√° a deshacerse del problema del enlace al inicio, entonces debe usar dlopen y carga din√°mica.  Esto requiere mucho alboroto, y primero debes entender si esto tiene sentido.  Facebook tiene un <a href="">c√≥digo</a> bastante <a href="">interesante para un</a> ejemplo de c√≥mo se vincularon din√°micamente. <br><br>  Por √∫ltimo, <strong>intente no utilizar entidades globales dentro</strong> .  Cada plataforma tiene algunos componentes globales.  Es recomendable no arrastrarlos a su biblioteca.  Esto parece obvio porque es un objeto global, y los usuarios de su biblioteca pueden tomarlo y configurarlo como quieran.  Lo usa en su biblioteca, necesita guardar de alguna manera su estado, reconfigurarlo y luego restaurarlo.  Hay muchos matices y hay d√≥nde cometer un error.  Recuerda esto y trata de evitarlo. <br><br>  Por ejemplo, en SpeechKit, antes de la tercera versi√≥n, trabajamos con audio dentro de la biblioteca, y configuramos y activamos expl√≠citamente la sesi√≥n de audio.  Una sesi√≥n de audio en iOS es algo que todas las aplicaciones tienen, no digas que no tienes una.  Se crea al principio, es responsable de la interacci√≥n de la aplicaci√≥n y el demonio de medios del sistema, y ‚Äã‚Äãdice lo que su aplicaci√≥n quiere hacer con el audio.  Este es un objeto singleton en el verdadero sentido de la palabra.  Lo tomamos con calma, lo configuramos como lo necesit√°bamos, pero esto llev√≥ al hecho de que los usuarios ten√≠an problemas menores como cambiar el volumen del sonido.  Otro m√©todo de sesiones de audio, que se encarga de establecer la configuraci√≥n, es bastante largo.  Tarda unos 200 ms, y esta es una desaceleraci√≥n notable en la activaci√≥n o desactivaci√≥n. <br><br>  En la tercera versi√≥n, alegremente saqu√© una sesi√≥n de audio de la biblioteca.  Despu√©s de eso, casi todos los usuarios de todos los servicios que ten√≠an integrado SpeechKit dijeron que estaban terriblemente descontentos.  Ahora deber√≠an saber que hay alg√∫n tipo de sesi√≥n de audio que debe configurarse especialmente para nuestro SpeechKit. <br><br><blockquote>  La conclusi√≥n de esto es esta: de todos modos, trate de no usar entidades globales, pero est√© preparado para el hecho de que sus usuarios no siempre estar√°n contentos con sus decisiones. <br></blockquote><br><h3>  Lo hacemos conveniente para los usuarios. <br></h3><br>  ¬øDe qu√© otra forma puedes ayudar a tus usuarios? <br><br><ul><li>  <strong>Agregar registros: diferentes niveles, inclusi√≥n din√°mica</strong> . <br></li></ul><br>  La forma m√°s f√°cil es adjuntar un archivo, para cuya presencia se inicia un modo de mega depuraci√≥n.  Realmente ayuda a hacer la depuraci√≥n en una situaci√≥n en la que sus usuarios tienen usuarios que tienen un error, y necesita comprender qu√© sucedi√≥ exactamente. <br><br><ul><li>  <strong>Admite todas las versiones del sistema operativo del usuario.</strong> <br></li></ul><br>  Recuerde que cuando habla del soporte de versiones en una biblioteca, no es lo mismo que el soporte de versiones en una aplicaci√≥n normal.  En una aplicaci√≥n normal, observamos estad√≠sticas que, por ejemplo, solo el 2% de nuestros usuarios usan iOS 8, y eso significa que puede dejar de admitir iOS 8. En la biblioteca, no es as√≠, aqu√≠ rechazar la versi√≥n del sistema operativo significa abandonar completamente a su usuario y a todos sus usuarios.  Esto puede ser la mitad de sus usuarios en principio. <br><br>  Por lo tanto, debe controlar qu√© versiones utilizan las aplicaciones que usan su biblioteca y, bas√°ndose en esto, ya debe concluir si admite algo o no.  No abandonamos iOS 7 durante mucho tiempo. Me parece que ya hab√≠a personas que abandonaron iOS 8 y estaban listas para abandonar iOS 9. Todav√≠a admit√≠amos iOS 7 porque ten√≠amos un navegador que hasta el √∫ltimo manten√≠a a todos los usuarios y trabajamos estrechamente con √©l y no pudimos dejarlo en tal situaci√≥n. <br><br>  Una vez m√°s, sus usuarios no dir√°n: "Desactivemos esta funcionalidad en la versi√≥n que no lo admite", no, simplemente eliminar√°n su biblioteca y encontrar√°n una que sea compatible con toda la serie de versiones. <br><br><ul><li>  <strong>Agregue un incremento m√≠nimo en nuevas versiones.</strong> </li></ul><br>  Esto es muy "no muy" para los desarrolladores de bibliotecas.  Quiero lanzar todo lo que est√° listo para el lanzamiento.  Realiz√≥ funciones, corrigi√≥ errores: ahora colocaremos todo el paquete y lo lanzaremos al lanzamiento.  La liberaci√≥n tambi√©n es un proceso.  Esto no es as√≠ para sus usuarios.  Cuando est√°n en el proceso de probar su producto y prepararlo para su lanzamiento, no quieren recibir de usted un conjunto con nuevas caracter√≠sticas que necesitan pruebas adicionales. <br><br>  Realmente tuvimos casos en los que retrocedimos algunos lanzamientos, los dividimos en partes y los desplegamos en pedazos.  Entonces, los equipos para los que implementamos cambios podr√≠an tomar exactamente la versi√≥n en la que hay peque√±os cambios, y no todos a la vez. <br><br><blockquote>  Esto realmente no es muy conveniente para el desarrollo, pero el incremento m√≠nimo en las versiones har√° que sus usuarios est√©n un poco m√°s felices. <br></blockquote><br><h3>  Nunca hay demasiadas pruebas <br></h3><br>  Esto es cierto tanto para una aplicaci√≥n regular como para una biblioteca.  Pero en el caso de la biblioteca nuevamente, hay caracter√≠sticas. <br><img src="https://habrastorage.org/webt/jk/1n/gb/jk1ngbzjsq3q-9vrkndir038u2w.jpeg"><br>  <strong>Las pruebas autom√°ticas</strong> , por supuesto, son necesarias, pero adem√°s de ellas es genial tener una <strong>aplicaci√≥n de prueba</strong> para su biblioteca.  Le ayudar√° a integrar lo que escribi√≥ usted mismo y comprender qu√© problemas o dificultades pueden surgir.  Puedes sentir por ti mismo cu√°les son tus usuarios. <br><br>  Si su biblioteca de alguna manera interact√∫a con la red, incluye cifrado, hay al menos algo relacionado con los datos y la seguridad, d√©selo a <strong>los</strong> guardias de <strong>seguridad</strong> para su <strong>verificaci√≥n</strong> .  Absolutamente no quieres ser la biblioteca en la que encuentran la vulnerabilidad, es un estigma para la vida.  Casi todas las grandes empresas tienen un departamento completo que se ocupa de verificar la seguridad de los productos, d√°rselos.  Si no tiene uno, hay <strong>una auditor√≠a externa</strong> .  Si no puede pagar lo externo, busque las pruebas en la red, ejec√∫telas y aseg√∫rese de que su biblioteca no permita la fuga de datos de los usuarios. <br><br>  Lo √∫ltimo que es muy importante en las pruebas es, desde el principio, intentar agregar <strong>medidas de todo lo que sea posible</strong> : tiempo, consumo de energ√≠a, todo lo que es t√≠pico de su biblioteca en particular.  Todav√≠a tiene que hacer esto al final, entonces, ¬øpor qu√© no pensar en las mediciones desde el principio? <br><br>  Esto no protege contra cambios y la necesidad de acelerar la biblioteca, pero ayuda a descubrir qu√© sali√≥ mal.  Si tiene gr√°ficos, esto ayudar√° en el monitoreo en tiempo real de qu√© funcionalidad agrega demoras o aumenta el consumo de energ√≠a. <br><br>  Casi nunca hay tiempo para esto, porque esta no es la funcionalidad de la biblioteca, no es para lo que la est√° desarrollando.  Pero esto es lo que le ayuda a mantenerlo en buenas condiciones y de buena calidad. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aqu√≠</a> puede leer c√≥mo nosotros, en Yandex, medimos el consumo de energ√≠a de los dispositivos m√≥viles.  Sobre las mediciones de tiempo fue una historia divertida.  Como desarrolladores de bibliotecas, es dif√≠cil para nosotros medir el comportamiento en casos espec√≠ficos, porque no todos los scripts de SpeechKit son utilizados por todos los equipos.  Hasta el momento, utilizamos nuestra aplicaci√≥n de prueba.  Se escribieron casos especiales de uso, por ejemplo, un reconocedor o componentes para la s√≠ntesis de voz, se grab√≥ cada paso y se guardaron registros, y como resultado, se construyeron gr√°ficos geniales. <br><br>  Todo estar√≠a bien, pero trabajamos con audio, y para verificarlo todo, en ciertos casos la pista de audio realmente se reproduce.  Adem√°s, es necesario hacer muchas mediciones, por lo que dejaron la prueba por la noche: coloque los altavoces, coloque alg√∫n tipo de dispositivo al lado e inici√≥ los archivos de audio.  Por la ma√±ana todo se apag√≥, la noche siguiente se repiti√≥, y luego otra vez.  No se trataba en absoluto de algunas criaturas m√°gicas que caminaban por la oficina, solo los limpiadores estaban asustados.  Realmente hab√≠a un texto muy extra√±o que se le√≠a a intervalos. <br><br>  Como resultado, se decidi√≥ hacer un banco de pruebas local, al que llamamos Gabinete.  Este es un gabinete natural, solo insonorizado.  Contiene muchos dispositivos, toda una granja con dispositivos, cada uno de los cuales se puede lanzar muchas veces durante la jornada laboral, porque no da√±ar√° a nadie. <br><a name="deploy"></a><br><h2>  Lanzamiento </h2><br>  Finalmente llegamos a la √∫ltima parte importante: este es el lanzamiento.  El c√≥digo est√° escrito, una buena API est√° dise√±ada para que sea conveniente para los usuarios.  C√≥mo ahora lanzar todo esto en libertad. <br><br>  Comenzar√© con lanzamientos locales para usuarios dentro de Yandex.  El esquema aqu√≠ es el mismo que en el desarrollo de una aplicaci√≥n regular: lanzamientos regulares, mensuales o semanales. <br><img src="https://habrastorage.org/webt/by/kz/vj/bykzvjvcxhseq5viva1mcy8gwno.jpeg"><br>  El proceso consta de las etapas habituales, pero al desarrollar una biblioteca, cada uno de estos puntos tiene sus propias caracter√≠sticas. <br><br><h3>  Planificacion <br></h3><br>  Para m√≠, esta es la parte m√°s dolorosa, porque la biblioteca tiene varios equipos de productos.  En una aplicaci√≥n normal, hay un gerente de producto que establece tareas que el equipo prioriza y comienza a hacer una a la vez. <br><br>  Si hay varios equipos de productos, cada uno de ellos recibe solicitudes que deben procesarse en tiempo real.  Dar√© un consejo: si hay una persona que sabe c√≥mo hacer frente a una multitud de tareas en un momento, trate de recogerlo en su equipo.  Porque debe haber alguien entre todos los gerentes externos y el desarrollo, el que asumir√° la funcionalidad para priorizar las tareas. <br><br>       SpeechKit ,        , , .  ,    ,  -         .       ,       ‚Äî   .    ,      n .        ,      .          ,         ,    -   . <br><br><h3>  <br></h3><br> ,    ,     :   , ,      .     Agile-      . <br><br>  ,     ,  ,    ‚Äî .    ,       .     ! <br><br>     <strong>Scrum</strong> .   ,      ,  ,   .           .   ¬´ ¬ª,          . <br><br> Scrum  ,    ,  ,  ‚Äî      ‚Äî       , .     .      ‚Äî      ,        - . ,     ?  ,      : ¬´,         ,    ,         ¬ª.  ,       ,   - ,      ,  Scrum  .    ! ,       . <br><br>       .    ,     ,      .   ,      .     ,    , ,     ,       .      ,       .     . <br><br><h3>  <br></h3><br>  ,      ‚Äî     ,      -   . ,  ,      ,      ,    .  ,       .      : ¬´     4,     3 ‚Äî    ¬ª.     ,     .    -    , ,    ,  <strong>    </strong> ,   . <br><br>     ‚Äî <strong>     </strong> .  Continuous Integration ,              ,   ,   <strong>  </strong> . <br><br><h3>   <br></h3><br>   ,       .    . <br><br> 1. <strong> .</strong> <br><br>    ‚Äî       <strong>  </strong> .     -      -  ,  , ,      .      . <br><br> <strong>   </strong>      .      ,   ‚Äî  , , , ,  .     ,    ,    -  . <br><br> 2. <strong> .</strong> <br><br>       ,  ,   ,   ‚Äî ,      ,  ,    ,    ,    ! <br><br>    .  , <strong>   </strong> .        ,  ,    -,     . <br><br>        ‚Äî <strong>   </strong> .       SpeechKit   .  ,  ,    ‚Äî ,   - .      ‚Äî   ,   -     . <br><br>  , <strong>    </strong> .     ,    4    2, ,        .         ,     -,      ,     . <br><br>  ‚Äî <strong>   </strong> .   ,  ,    ,     . <br><br><h2> . .  <br></h2><br>   ,     -,     .    <strong>  </strong> .      ,    , ,  help  ,    . <br><img src="https://habrastorage.org/webt/a8/ip/yi/a8ipyiozxkbcgk_-fr0fuk8a9hi.jpeg"><br>  <strong> </strong> .     :  -,     GitHub,    , .  ‚Äî ,   ‚Äî  .          ,       ,   . <br><br>    <strong> </strong> ,    ,   -       ,    ,   .. <br><br><h2>   <br></h2><br>  ,     ,    : <br><br><ul><li> <strong>.</strong>    ,        .   -   ,    ,    . <br></li><li> <strong></strong> .      ,      .      ,  OpenSource ,  ,    ,    ,      . </li><li> <strong>.</strong> ,       .        ,   ,     .    .     SpeechKit      . <br></li></ul><br><h1>  Resumen <br></h1><br><ul><li>      ,     API. <br></li><li>  ,     ,       . <br></li><li>        . <br></li><li>   ,      -    :)    - ,     . <br></li></ul><br> Yandex.SpeachKit  GitHub  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">iOS</a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Android</a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> Mobile SDK. <br><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">AppsConf</a> ‚Äî       ‚Äî    <b>22  23  2019 </b> ,      ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>  . <br><br>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  . , ,     . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es429912/">https://habr.com/ru/post/es429912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429898/index.html">DMS (Sistema de gesti√≥n de concesionarios): implementaci√≥n de los ecosistemas de informaci√≥n para la gesti√≥n de redes de concesionarios</a></li>
<li><a href="../es429902/index.html">Page Rank en la era de la Web 2.0 - Parte 1</a></li>
<li><a href="../es429904/index.html">Historias divertidas y tristes sobre el desarrollo de juegos de computadora</a></li>
<li><a href="../es429908/index.html">C√≥mo usar corutinas en la comida y dormir tranquilo por la noche</a></li>
<li><a href="../es429910/index.html">AppsConf Rises</a></li>
<li><a href="../es429914/index.html">OpenSceneGraph: Gr√°fico de escena y punteros inteligentes</a></li>
<li><a href="../es429916/index.html">C√≥mo construir y construir</a></li>
<li><a href="../es429918/index.html">Mundo virtual Intel. Parte 2: SMP</a></li>
<li><a href="../es429920/index.html">Tragicomedia en actos de NaN: c√≥mo creamos un juego en JS y lo lanzamos en Steam</a></li>
<li><a href="../es429922/index.html">C√≥mo convertir un proyecto simple en una construcci√≥n a largo plazo o cortar todo lo innecesario</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>