<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–‡ï¸ â˜ï¸ ğŸ–•ğŸ½ Pelaporan mudah dalam C / C ++ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ¾ ğŸ“‹ ğŸ‘¨â€âš–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jika Anda mengembangkan C / C ++ perangkat lunak apa pun untuk operator (administrator) rumah sakit, toko, layanan penyewaan skuter gyro, layanan perb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pelaporan mudah dalam C / C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456102/"> Jika Anda mengembangkan C / C ++ perangkat lunak apa pun untuk operator (administrator) rumah sakit, toko, layanan penyewaan skuter gyro, layanan perbaikan ponsel, maka Anda mungkin menghadapi tugas membuat laporan untuk mencetaknya di printer, atau setidaknya dalam PDF.  Ada banyak paket pihak ketiga untuk Embarcadero RAD Studio yang memungkinkan Anda melakukan ini.  Seperti FastReport, QuickReport, Crystal Reports, dll.  Namun menurut saya, semua paket ini membutuhkan pemahaman yang mendalam tentang mekanisme dan antarmuka mereka.  Diperlukan banyak waktu untuk mempelajarinya, dan yang paling penting, kode untuk menghasilkan bahkan laporan paling sederhana pun akan terdiri dari sejumlah besar baris.  Ketika saya pertama kali menghadapi tugas menghasilkan laporan di bawah C / C ++, saya mulai dengan FastReport dan menyadari bahwa saya benar-benar tidak menyukai alat ini. <br><br>  Pada saat itu, sebuah pemikiran indah muncul di benak saya: betapa kerennya mengambil file EXCEL sederhana, menambahkan informasi statis ke dalamnya dan memformatnya sesuai dengan kebutuhan Anda.  Program hanya akan membuka file ini, mengisinya dengan data dinamis dan menyimpan atau mengirim untuk mencetak!  Ini berfungsi sebagai titik awal untuk studi saya tentang mekanisme OLE untuk bekerja dengan file MS Office dari program yang dikembangkan di Embarcadero RAD Studio. <br><a name="habracut"></a><br>  Dalam perjalanan pekerjaan saya, saya berhasil menggali topik dengan cukup dalam dan sekarang saya dapat mengatakan dengan yakin bahwa semua alat yang disediakan MS Office dan OLE menyediakan yang mencakup semua kebutuhan pelaporan saya.  Nah, jika demikian, maka mungkin untuk pengembang lain itu akan menjadi alat mandiri, sederhana dan nyaman.  Oleh karena itu, diputuskan untuk menulis DLL dan memasukkan ke dalamnya daftar semua fungsi MS Excel yang umum digunakan yang Anda temui selama pembuatan dokumen Excel.  Ini sangat nyaman, karena untuk membuat laporan, Anda tidak perlu mempelajari banyak manual atau OLE.  Yang diperlukan hanyalah memuat DLL dan fungsinya.  Yah, banyak yang bisa bekerja dengan DLL. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Inilah situs proyek itu sendiri</a> . <br><br>  Di situs proyek, mekanisme untuk bekerja dengan DLL dijelaskan secara cukup terperinci, ada contoh dan deskripsi semua fungsi. <br><br>  DLL datang tanpa file header dan tanpa perpustakaan LIB statis.  Dengan demikian, DLL harus terhubung secara dinamis menggunakan fungsi LoadLibrary.  Arsip ZIP dengan perpustakaan termasuk file-file berikut: <br><br><ul><li>  " <i>light_report.dll</i> " - pustaka DLL itu sendiri; </li><li>  " <i>DLLTest.cpp</i> " - contoh menggunakan perpustakaan; </li><li>  " <i>LPDLL.h</i> " - file header untuk contoh menggunakan perpustakaan (ini bukan file header DLL); </li><li>  " <i>Report.xlsx</i> " - Dokumen MS EXCEL untuk contoh penggunaan perpustakaan. </li></ul><br>  File header untuk contoh penggunaan perpustakaan <i>LPDLL.h</i> berisi deklarasi berikut: <br><br><ul><li>  enumerasi yang digunakan sebagai argumen untuk fungsi DLL; </li><li>  jenis fungsi DLL; </li><li>  Instance fungsi DLL </li><li>  Deskriptor unduhan DLL (" <i>HINSTANCE DLL_Handle;</i> "); </li><li>  function <i>LoadLightReportDLL</i> , yang secara dinamis memuat DLL dan semua fungsinya; </li><li>  Fungsi <i>FreeLightReportDLL</i> yang membongkar DLL. </li></ul><br>  File <i>LPDLL.h</i> sudah berisi semua yang Anda butuhkan untuk bekerja dengan DLL dan fungsinya.  Tetapi Anda juga dapat mengeditnya atau hanya mengambil yang paling penting untuk proyek Anda. <br><br>  Bayangkan Anda baru saja menghubungkan file header <i>"LPDLL.h"</i> ke proyek Anda. <br><br>  Maka dalam proyek itu sendiri Anda hanya perlu: <br><br>  1) Nyatakan pegangan variabel ke laporan Anda: <br><br><pre><code class="cpp hljs">Variant report;</code> </pre> <br>  2) Secara dinamis memuat DLL dan semua fungsinya: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!LoadLightReportDLL(<span class="hljs-string"><span class="hljs-string">"C:\\LightReport\\light_report.dll"</span></span>))<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;</code> </pre> <br>  3) Selanjutnya, dalam konstruk coba-coba, buka templat laporan yang disiapkan (file MS Excel): <br><br><pre> <code class="cpp hljs">report=OpenReport(<span class="hljs-string"><span class="hljs-string">"C:\\LightReport\\Report.xlsx"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre> <br>  4) Tambahkan beberapa data ke laporan: <br><br><pre> <code class="cpp hljs">WriteCell(report, <span class="hljs-string"><span class="hljs-string">"Sheet1"</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello world!"</span></span>);</code> </pre> <br>  ... <br>  5) Simpan file atau cetak: <br><br><pre> <code class="cpp hljs">Save(report); SaveAs(report, <span class="hljs-string"><span class="hljs-string">"C:\\LightReport\\Report copy.xlsx"</span></span>); ExportToPDF(report, <span class="hljs-string"><span class="hljs-string">"C:\\LightReport\\Report.pdf"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); PrintOut(report);</code> </pre> <br>  6) Tutup file: <br><br><pre> <code class="cpp hljs">CloseReport(report);</code> </pre> <br>  7) Bongkar pustaka DLL: <br><br><pre> <code class="cpp hljs">FreeLightReportDLL();</code> </pre> <br>  Dan itu dia!  Sama sekali tidak lebih!  Hanya ada satu peringatan, tetapi bahkan itu, itu muncul hanya selama debugging.  Dalam aplikasi yang berfungsi, semuanya akan bekerja dengan baik.  Maksud saya situasi di mana ada beberapa jenis kesalahan saat bekerja dengan laporan.  Faktanya adalah bahwa mekanisme OLE untuk bekerja dengan dokumen hanya melibatkan melempar pengecualian ketika kesalahan terjadi.  Itu sebabnya ketika bekerja dengan fungsi DLL, Anda harus menggunakan konstruk try-catch.  Di blok tangkap, Anda harus menutup laporan tanpa menyimpan: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(...){CloseReport(report);}</code> </pre>  . <br>  Saat debugging, ketika kesalahan terjadi, Anda dapat menghentikan program.  Dalam hal ini, proses MS Excel akan tetap berjalan, dan akan mungkin untuk menutupnya hanya melalui task manager.  Oleh karena itu, ketika debugging aplikasi beberapa kali, beberapa contoh proses MS Excel dapat diluncurkan, tergantung pada seberapa sering Anda menangguhkan program ketika kesalahan terjadi, tanpa menunggu kode untuk dieksekusi dalam tangkapan.  Ini harus dipantau. <br><br>  Dalam rilis, jika terjadi kesalahan, kode yang ditentukan dalam blok tangkap pasti akan berfungsi, laporan akan ditutup, dan proses MS Excel akan selesai.  Tidak ada proses MS Excel yang tergantung pada sistem yang akan diamati.  Tapi tetap saja mereka mencoba menulis kode bebas kesalahan, jadi saya harap Anda tidak mengalami situasi ini dalam aplikasi yang sedang berjalan. <br><br>  Akhirnya, Anda perlu menambahkan: <br><br><ol><li>  DLL menggunakan tipe data platform-independen, seperti <i>pendek</i> <i>unsigned</i> , <i>unsigned long,</i> dan <i>char</i> .  Ini bisa dimengerti kenapa. </li><li>  Contoh ini ditulis dalam lingkungan Embarcadero Builder C ++ 10. Dengan demikian, semua kode terkait dengan lingkungan ini dan, mungkin, Anda perlu membuat beberapa perubahan pada kode contoh untuk membuat semuanya berfungsi di lingkungan Anda. </li><li>  Hambatan DLL ini adalah penggunaan deskriptor file laporan dalam format <i>Variant</i> .  Ini adalah format yang agak spesifik dan saya menduga mungkin sulit untuk menggunakan perpustakaan di luar Embarcadero RAD Studio.  Jujur, saya tidak memeriksa. </li></ol><br>  Oleh karena itu, untuk masa depan direncanakan untuk mengemas semua fungsionalitas ke dalam kelas dan menyembunyikan format <i>Varian</i> ini di dalam kelas sehingga hanya format C / C ++ yang diterima secara umum yang diberikan kepada pengguna.  Saya belum pernah mencoba mengemas kelas menjadi DLL, saya membaca bahwa kesulitan akan muncul dengan ini.  Namun demikian, kami akan mengerti!  Sementara itu, terima kasih atas perhatian Anda, saya akan sangat senang jika artikel ini dan DLL membantu seseorang. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tautan ke proyek</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id456102/">https://habr.com/ru/post/id456102/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id456090/index.html">Pengantar Unit Testing in Unity</a></li>
<li><a href="../id456092/index.html">Tujuh tanda yang merisaukan bahwa Anda bergantung pada cuaca, meskipun Anda tidak mengira begitu</a></li>
<li><a href="../id456094/index.html">Kami membaca lembar data 2: SPI pada STM32; Pengatur waktu PWM dan interupsi pada STM8</a></li>
<li><a href="../id456096/index.html">Apa yang pembaca geektimes rata-rata lakukan sambil melayang di awan</a></li>
<li><a href="../id456100/index.html">Sekarang dalam kemasan baru - Kingston A400 dalam format M.2 bergegas ke pasar</a></li>
<li><a href="../id456104/index.html">Ezblock Pi - pemrograman tanpa pemrograman, kali ini untuk penggemar Raspberry Pi</a></li>
<li><a href="../id456108/index.html">Habr Weekly # 5 / Dark topik ada di mana-mana, pabrik-pabrik Cina di Federasi Rusia, di mana bank telah mengalir, Pixel 4, ML mencemari atmosfer</a></li>
<li><a href="../id456110/index.html">Seperti apa bentuk teks Anda?</a></li>
<li><a href="../id456112/index.html">Mengatasi Hukum Moore: Cara Mengganti Transistor Planar Tradisional</a></li>
<li><a href="../id456114/index.html">Apa yang Baru dalam Pengembangan Mamba</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>