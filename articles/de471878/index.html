<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛂 👩🏽‍🏫 🕵️ Wie schreibe ich einen intelligenten Vertrag für WebAssembly in einem Ontology-Netzwerk? Teil 1: Rost 🦀 🥉 🥢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Ontology Wasm-Technologie reduziert die Kosten für die Übertragung von dApp-Smart-Verträgen mit komplexer Geschäftslogik in die Blockchain und ber...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie schreibe ich einen intelligenten Vertrag für WebAssembly in einem Ontology-Netzwerk? Teil 1: Rost</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471878/"><img src="https://habrastorage.org/getpro/habr/post_images/3e1/ec5/4dd/3e1ec54ddc0f1d35cad05f7f2b6e600e.png" alt="Bild"><br><br>  Die Ontology Wasm-Technologie reduziert die Kosten für die Übertragung von dApp-Smart-Verträgen mit komplexer Geschäftslogik in die Blockchain und bereichert so das dApp-Ökosystem erheblich. <br><br>  Derzeit unterstützt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ontology Wasm</a> gleichzeitig die Entwicklung von Rust und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">C ++</a> .  Rust unterstützt Wasm besser und der generierte Bytecode ist einfacher, wodurch die Kosten für Vertragsanrufe weiter gesenkt werden können.  <b>Wie kann man Rust verwenden, um einen Vertrag im Ontology-Netzwerk zu entwickeln?</b> <br><a name="habracut"></a><br><h2>  WASM-Vertragsentwicklung mit Rust </h2><br><h3>  Vertragserstellung </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cargo</a> ist ein gutes Tool zum Erstellen von Projekten und Verwalten von Paketen bei der Entwicklung von Programmen in Rust, mit dem Entwickler die Interaktion von Code und Bibliotheken von Drittanbietern besser organisieren können.  Führen Sie zum Erstellen eines neuen Ontology Wasm-Vertrags einfach den folgenden Befehl aus: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab2/30f/1a0/ab230f1a0f2c39f8ba0829ff7416c1b3.png" alt="Bild"><br><br>  Die Struktur des Projekts, das es generiert: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e72/8ca/909/e728ca9098009f22039d43cd7785ccaa.png" alt="Bild"><br><br>  Die Datei Cargo.toml wird verwendet, um grundlegende Projektinformationen und abhängige Bibliotheksinformationen zu konfigurieren.  Der Abschnitt [lib] in der Datei muss auf crate-type = [“cdylib”] gesetzt sein.  Die lib.rs-Datei wird zum Schreiben von Vertragslogikcode verwendet.  Darüber hinaus müssen Sie dem Abschnitt [Abhängigkeiten] der Konfigurationsdatei Cargo.toml Abhängigkeitsparameter hinzufügen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b06/c9d/b21/b06c9db2102d48e696b547c032223721.png" alt="Bild"><br><br>  Mit dieser Abhängigkeit können Entwickler Schnittstellen aufrufen, die mit der Ontologie-Blockchain interagieren, sowie Tools wie den Serialisierungsparameter. <br><br><h2>  Vertragserfassungsfunktion </h2><br>  Jedes Programm hat eine Eingabefunktion, wie z. B. eine Hauptfunktion, die wir normalerweise sehen, aber der Vertrag hat keine Hauptfunktion.  Wenn ein Wasm-Vertrag mit Rust entwickelt wird, wird der Aufruf standardmäßig als Eingabefunktion für die Verwendung des Vertrags verwendet.  Ein Funktionsname in Rust ist nicht klar, wenn Rust-Quellcode in Bytecode kompiliert wird, den eine virtuelle Maschine ausführen kann.  Um den Compiler davor zu warnen, redundanten Code zu generieren und die Vertragsgröße zu verringern, fügt die Aufruffunktion die Annotation # [no_mangle] hinzu. <br><br><h3>  Wie ruft der Aufruf Parameter ab, um eine Transaktion auszuführen? </h3><br>  Die Bibliothek ontio_std bietet die Funktion runtime :: input (), um die Parameter für die Transaktion abzurufen.  Entwickler können ZeroCopySource verwenden, um das resultierende Byte-Array zu deserialisieren.  Dabei ist das erste gelesene Byte-Array der Name der aufgerufenen Methode, gefolgt von den Methodenparametern. <br><br><h3>  Wie ist das Ergebnis des Vertrages? </h3><br>  Die Funktion runtime :: ret, die von der Bibliothek ontio_std bereitgestellt wird, gibt das Ergebnis der Methode zurück. <br><br>  Die fertige Aufruffunktion lautet wie folgt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d76/bc2/456/d76bc2456bd288211e88c2801a7c1f18.png" alt="Bild"><br><br><h2>  Serialisierung und Deserialisierung von Vertragsdaten </h2><br>  Bei der Entwicklung von Verträgen treten Entwickler immer wieder auf Probleme bei der Serialisierung und Deserialisierung auf, insbesondere beim Speichern des Strukturtyps der Daten in der Datenbank und beim Byte-Array-Lesen von Bytes aus der Datenbank zum Deserialisieren, um den Strukturtyp der Daten zu erhalten. <br><br>  Die Bibliothek ontio_std bietet Decoder- und Encoder-Schnittstellen zum Serialisieren und Deserialisieren von Daten.  Die Felder der Strukturstruktur implementieren auch die Schnittstellen des Decoders und des Codierers, so dass die Struktur serialisiert und deserialisiert werden kann.  Sink-Instanzen sind erforderlich, wenn verschiedene Datentypen serialisiert werden.  Eine Instanz der Sink-Klasse verfügt über ein Set-Type-Feld-Buf, in dem die Bytetypdaten gespeichert sind, und alle serialisierten Daten werden in Buf gespeichert. <br><blockquote>  Bei Daten mit fester Länge (z. B. Byte, U16, U32, U64 usw.) werden die Daten direkt in ein Array von Bytes konvertiert und dann in Buf gespeichert.  Für Daten mit nicht fester Länge müssen Sie zuerst die Länge und dann D \ data serialisieren (z. B. vorzeichenlose Ganzzahlen unbekannter Größe, einschließlich u16, u32 oder u64 usw.). <br></blockquote><br>  Deserialisierung ist genau das Gegenteil.  Für jede Serialisierungsmethode gibt es eine entsprechende Deserialisierungsmethode.  Die Deserialisierung erfordert die Verwendung von Instanzen der Source-Klasse.  Diese Klasseninstanz hat zwei Felder buf und pos.  Buf wird verwendet, um zu deserialisierende Daten zu speichern, und pos wird verwendet, um die aktuelle Leseposition zu speichern.  Wenn ein bestimmter Datentyp gelesen wird und Sie seine Länge kennen, können Sie ihn direkt für Daten unbekannter Länge lesen. Lesen Sie zuerst die Länge und dann den Inhalt. <br><br><h2>  Zugriff auf und Aktualisierung von Daten in der Kette </h2><br>  <b>Ontology-wasm-cdt-rust</b> - hat eine betriebliche Methode zum Arbeiten mit Daten in einer Kette zusammengefasst, mit der Entwickler Vorgänge wie das Hinzufügen, Löschen, Ändern und Abfragen von Daten in einer Kette wie folgt implementieren können: <br><br><ul><li>  <b>database :: get (key)</b> - wird verwendet, um Daten von der Kette anzufordern, und key fordert die Implementierung der AsRef-Schnittstelle an. </li><li>  <b>database :: put (Schlüssel, Wert)</b> - wird zum Speichern von Daten im Netzwerk verwendet.  Ausführung der AsRef-Schnittstelle für Schlüsselanforderungen und Implementierung der Encoder-Schnittstelle für Wertanforderungen; </li><li>  <b>database :: delete (Schlüssel)</b> - wird verwendet, um Daten aus der Kette zu entfernen, und der Schlüssel fordert die Implementierung der AsRef-Schnittstelle an. </li></ul><br><h2>  Vertragstests </h2><br>  Wenn die Vertragsmethoden implementiert sind, benötigen wir Zugriff auf die Daten in der Verbindung und die entsprechende virtuelle Maschine, um den Bytecode des Vertrags auszuführen. Daher müssen wir den Vertrag in der Regel zum Testen in der Kette bereitstellen.  Eine solche Testmethode ist jedoch problematisch.  Um Entwicklern das Testen von Verträgen zu erleichtern, bietet die Bibliothek ontio_std ein Scheinmodul zum Testen.  Dieses Modul bietet die Simulation von Daten in einer Schaltung und erleichtert Entwicklern das Testen von Methoden in einem Vertrag.  Spezifische Beispiele finden Sie <a href="">hier</a> . <br><br><h2>  Vertrags-Debugging </h2><br>  console :: debug (msg) druckt Debugging-Informationen beim Debuggen eines Vertrags.  Die Nachrichteninformationen werden in die Knotenprotokolldatei eingegeben.  Voraussetzung ist, dass die Ebene der Protokolldatei im Debug-Modus festgelegt wird, wenn der lokale Ontologie-Testknoten ausgeführt wird. <br><br>  runtime :: notify (msg) zeigt beim Debuggen des Vertrags die entsprechenden Debugging-Informationen an.  Diese Methode speichert die eingegebenen Informationen in der Schaltung und kann mit der Methode getSmartCodeEvent von der Schaltung angefordert werden. <br><br><hr><br><blockquote>  Der Artikel wurde von Hashrate &amp; Shares speziell für OntologyRussia übersetzt.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klicken Sie auf</a> </blockquote><br>  Bist du ein Entwickler?  Treten Sie unserer Tech-Community auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Discord bei</a> .  Besuchen Sie außerdem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das Developer Center</a> auf unserer Website, wo Sie Entwicklertools, Dokumentation und vieles mehr finden. <br><br><h4>  Ontologie </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ontologie-Website</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zwietracht</a> </li><li>  Telegramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Englisch</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Russisch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Twitter</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reddit</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471878/">https://habr.com/ru/post/de471878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471868/index.html">Genetik der Liebe: Konflikt zwischen den Geschlechtern als Grundlage für die Zusammenarbeit bei Paaren monogamer Vögel</a></li>
<li><a href="../de471870/index.html">Effektive Nutzung von libdispatch</a></li>
<li><a href="../de471872/index.html">Schnittstellen in C # 8: Gefährliche Annahmen in der Standardimplementierung</a></li>
<li><a href="../de471874/index.html">Wie wir die Überprüfungsrichtlinien umgangen und einen Server auf dem Telefon gestartet haben</a></li>
<li><a href="../de471876/index.html">PDU und All-All-All: Rack-Stromverteilung</a></li>
<li><a href="../de471884/index.html">10 kostenlose ApexSQL-Dienstprogramme zum Verwalten von Microsoft SQL Server-Datenbanken</a></li>
<li><a href="../de471886/index.html">VMmanager 6: Einführung in die Box und Vergleich mit der vorherigen Generation</a></li>
<li><a href="../de471890/index.html">Variationsinferenz - was ist das und was isst es?</a></li>
<li><a href="../de471892/index.html">6 praktische Geschichten von unseren SRE-Wochentagen</a></li>
<li><a href="../de471896/index.html">Das Inside Playbook. Netzwerkfunktionen in der neuen Ansible Engine 2.9</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>