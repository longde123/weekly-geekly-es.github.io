<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüåæ üê¢ ‚úåüèæ Automatisierung gegen Chaos üíå üë´ üí¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die moderne Entwicklung von IT-Technologien hat es m√∂glich gemacht, den enormen Datenfluss einzud√§mmen. 
 Das Unternehmen verf√ºgt √ºber verschiedene To...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung gegen Chaos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421705/"><img src="https://habrastorage.org/webt/qz/sq/j9/qzsqj9kwc7g4xeaponeocm3phxy.jpeg"><br><br>  Die moderne Entwicklung von IT-Technologien hat es m√∂glich gemacht, den enormen Datenfluss einzud√§mmen. <br>  Das Unternehmen verf√ºgt √ºber verschiedene Tools: CRM, ERP, BPM, Buchhaltungssysteme oder im Extremfall nur Excel und Word. <br><br>  Unternehmen sind auch anders.  Einige bestehen aus vielen getrennten Zweigen.  In diesem Fall hat das Unternehmen ein Problem mit der Datensynchronisation im Zoo von IT-Systemen.  Dar√ºber hinaus unterscheiden sich Branchen in Anbietern oder Softwareversionen.  Und h√§ufige √Ñnderungen der Berichtspflichten der Verwaltungsgesellschaft verursachen unkontrollierte ‚ÄûFreude‚Äú vor Ort. <br><br>  Diese Geschichte handelt von einem Projekt, in dem ich auf Chaos stie√ü, das systematisiert und automatisiert werden musste.  Ein bescheidenes Budget und enge Fristen schr√§nkten den Einsatz der meisten industriellen L√∂sungen ein, er√∂ffneten jedoch Raum f√ºr Kreativit√§t. <br><a name="habracut"></a><br><h2>  Universelles Format </h2><br>  Der Kunde hat es sich zur Aufgabe gemacht, Daten f√ºr Berichte aus allen Unternehmensbereichen zu sammeln.  Um das Ausma√ü der Katastrophe zu verstehen, gibt es Dutzende von Systemen, darunter selbstgemachte und Monster wie SAP und nat√ºrlich 1C - wo ohne. <br><br>  In einem Bericht k√∂nnten sich Daten von: Buchhaltung, Mechanikern, PR-Spezialisten, dem Notfallministerium und Meteorologen √ºberschneiden. <br><br>  Vor Projektbeginn wurde der Gro√üteil der Daten per E-Mail in Form von Word / Excel-Anh√§ngen an die Muttergesellschaft gesendet.  Au√üerdem √§hnelte der Prozess manuell einem Sonnenuntergang: Die Daten wurden von speziell geschulten Personen verarbeitet und in einige Systeme eingegeben.  Das Ergebnis der Arbeit waren Dutzende von Berichten, auf deren Grundlage Managemententscheidungen getroffen wurden. <br><br>  Die Wahl des Ansatzes wurde durch das Format der √ºbertragenen Dateien, n√§mlich xlsx / docx, veranlasst.  Sogar die ‚Äûalten‚Äú Systeme in den Filialen unterst√ºtzten das Hochladen von Daten in diese Formate. In extremen F√§llen hat niemand das Kopieren und Einf√ºgen abgebrochen. <br><br>  Unser hartn√§ckiger Plan war: <br><br><ol><li>  Beschreiben Sie die Struktur jedes Berichts und die Regeln f√ºr seine √úbermittlung. </li><li>  Wir senken die Anforderungen f√ºr die Einrichtung von Systemen zum Versenden von Dokumenten per E-Mail gem√§√ü den Vorschriften an die Filialen.  Wo es keine Systeme gibt - nach wie vor per Hand senden; </li><li>  Wir entwickeln ein Programm, das: <br><ul><li>  w√§hlt bestimmte Dokumente aus eingehenden E-Mails aus; </li><li>  extrahiert Daten aus ihnen; </li><li>  schreibt die extrahierten Daten in die Datenbank und "schl√§gt" die Verst√∂√üe gegen die Vorschriften. </li></ul><br></li></ol><br><img src="https://habrastorage.org/webt/6b/na/ev/6bnaevbsj113vtojoryl6pkxt2s.png"><br><br><h2>  Implementierung </h2><br><h3>  Organisatorische Angelegenheiten </h3><br>  Bei der Erhebung und Formalisierung der Anforderungen an die Struktur und Regulierung der Daten√ºbertragung stellte sich heraus, dass die Struktur der Berichte √ºberhaupt nicht beschrieben wurde.  Alles wurde in den K√∂pfen einiger Mitarbeiter gespeichert und m√ºndlich als russische Volksm√§rchen √ºbermittelt.  Die eigentlichen Probleme begannen jedoch sp√§ter - beim Einrichten des Datenaustauschs. <br><br><h4>  Problem eins </h4><br>  Der Unterschied zwischen der Struktur von Dokumenten von der Referenz und der Datenqualit√§t.  In den Berichten konvergierten die Betr√§ge manchmal nicht, die Spalten waren verwechselt oder hatten falsche Namen.  Das Problem wurde haupts√§chlich in Zweigen beobachtet, in denen Daten manuell eingegeben wurden. <br><br>  Die L√∂sung ist die Implementierung einer dreistufigen √úberpr√ºfung: <br><br><ol><li>  Erstellen von Excel-Referenzdokumenten mit einer starren Struktur unter Verwendung von Excel selbst.  In solchen Dokumenten waren nur Dateneingabezellen verf√ºgbar.  Welche zus√§tzlichen Kontrollen wurden durchgef√ºhrt: Art, Konvergenz der Betr√§ge usw. </li><li>  √úberpr√ºft beim Extrahieren von Daten aus dem Bericht.  Zum Beispiel ein Vergleich des aktuellen Datums und des Datums in einem Absatz eines Word-Dokuments oder eine arithmetische √úberpr√ºfung auf Daten aus einem Excel-Dokument (wenn diese nicht im Dokument selbst angegeben werden k√∂nnen). </li><li>  Tiefe Datenanalyse nach der Erfassung.  Zum Beispiel die Feststellung signifikanter Abweichungen bei Schl√ºsselindikatoren im Vergleich zu fr√ºheren Perioden. </li></ol><br><h4>  Zweites Problem </h4><br>  Ein systematischer Versto√ü gegen den Daten√ºbertragungsplan oder skrupellose Sabotageversuche: "Im Allgemeinen haben wir nie Daten an jemanden gesendet, aber hier sind Sie mit meinen eigenen ...", "Ja, ich habe alles p√ºnktlich gesendet, dies ist wahrscheinlich ein schlechter Ping." <br><br>  Die L√∂sung ist Feedback.  Das System benachrichtigt automatisch die Verantwortlichen in der Filiale bei einem Zeitplanversto√ü.  Sp√§ter wurde das Feedback-Subsystem mit dem Qualit√§tskontrollsystem f√ºr Eingabedaten und dem endg√ºltigen Berichtssystem verschraubt, sodass die Zweigstelle sofort einen Datensatz und einen Vergleich mit den ‚ÄûNachbarn‚Äú erhalten w√ºrde.  <s>Um klar zu machen, warum er harkt.</s> <br><br><h3>  Entwickelte Subsysteme </h3><br><br><ol><li>  Konfigurator von Dokumenttypen mit Daten, in denen Sie schnell beschreiben k√∂nnen: <br><ul><li>  Zeichen zur Identifizierung des Dokuments; </li><li>  √úbertragungsvorschriften; </li><li>  Datenextraktionsalgorithmus; </li><li>  andere Attribute wie der Pfad zum Code, der die Daten validiert und speichert. </li></ul><br></li><li>  Ein E-Mail-Empf√§nger, der Anh√§nge in einen isolierten Speicher (Sandbox) verschiebt und zugeh√∂rige Informationen zum Brief speichert. </li><li>  Ein Anhangsparser, der Dokumenttypen definiert und Daten daraus extrahiert. </li></ol><br><img src="https://habrastorage.org/webt/7s/bp/ef/7sbpefc8oczlxcc6xyrauq4309y.png"><br><br><h4>  Konfigurator </h4><br>  Historisch gesehen kommen alle Dokumente mit Daten an die allgemeine Post, wo sie voller anderer wichtiger und nicht so wichtiger Briefe ist.  Wir brauchen Zeichen, anhand derer die notwendigen Unterlagen ermittelt werden.  Der Name des Dokuments oder der Text im Text der E-Mail ist f√ºr den Absender unzuverl√§ssig und unpraktisch.  Daher wurde beschlossen, dass die Mitgliedschaft im Bericht nur durch den Inhalt des Dokuments bestimmt wird.  Dar√ºber hinaus m√ºssen Sie eindeutig bestimmen, welche Art von Bericht das Dokument enth√§lt. <br><br>  Sie kamen mit einem Brainstorming Meerrettich wei√ü, wie viele Zeichen ein Dokument zu identifizieren: Textfarbe in einer Zelle, Schriftart usw.  Am korrektesten war jedoch das Vorzeichen eines Teilstrings in einem bestimmten Zellen- ‚ÄûSlot‚Äú oder eines Arrays von Zellen f√ºr Excel und eines Absatzes oder einer √úberschrift f√ºr Word.  F√ºr den ‚ÄûSteckplatz‚Äú wurde eine einfache formale Logik hinzugef√ºgt: ‚Äûgleich‚Äú, ‚Äûungleich‚Äú, ‚Äûmehr‚Äú, ‚Äûweniger‚Äú usw. Beispiel f√ºr Excel: Im Bereich A2-E4 sollte der Text der Zelle gleich ‚ÄûT√§gliche Zusammenfassung der Ger√§tebelastung‚Äú sein. <br><br><img src="https://habrastorage.org/webt/km/aj/ea/kmajeaf8og5y17cnfronq3x2wmq.png"><br><br>  Der Dokumentbereich, in dem Sie nach Anfang und Ende der Daten suchen m√∂chten, wird auf √§hnliche Weise konfiguriert (ca. Bedingungen zum Auffinden des Endes: 2 Leerzeilen in einer Reihe). <br><br><img src="https://habrastorage.org/webt/u1/9t/hh/u19thhrwphi6bbdfifx1bt6tk84.png"><br><br>  Weitere n√ºtzliche Einstellungen sind eine Liste aufgel√∂ster Absender, ein Dokumenttyp (Excel / Word) und ein Pfad zum Exportieren von Daten. <br><br>  Bei der Ausgabe erhalten wir eine JSON-Struktur (Vorlage), die den Bericht beschreibt. <br><br><h4>  E-Mail-Empf√§nger </h4><br>  Ein E-Mail-Reader, der alle Dokumente aus Anh√§ngen in die Sandbox legt, die Attribute des Briefes speichert und die Dokumente in die Warteschlange der Aufgaben zum Parsen stellt. <br><br>  Es gibt 2 Sicherheitsfragen: <br><br><ol><li>  Was ist, wenn die Daten an eine andere Zweigstelle gesendet werden? </li><li>  Was ist, wenn die Daten von Angreifern gesendet werden? </li></ol><br>  Das erste Problem wird behoben, indem die E-Mail-Adresse des sendenden Zweigs und der im Berichtstext angegebenen Zweig abgeglichen werden. <br><br>  Der zweite verwendet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SPF</a> . <br><br><h4>  Anhang Parser </h4><br>  Fast alle Bibliotheken zum Parsen von Word und Excel unterliegen schwerwiegenden Einschr√§nkungen der unterst√ºtzten Versionen. Daher muss das Dokument zun√§chst konvertiert werden.  Libre Office l√∂st dieses Problem um f√ºnf. <br><br>  Nach der Konvertierung: <br><br><ol><li>  Wir filtern ein Array von Vorlagen nach grundlegenden Merkmalen aus dem Konfigurator heraus (Word / Excel, Absender ...). </li><li>  F√ºhren Sie das Dokument mit den verbleibenden Vorlagen aus. </li><li>  Wenn die Vorlage gefunden wird, extrahieren wir die Daten und √ºbertragen sie in das Repository. </li></ol><br><h2>  Zusammenfassung </h2><br>  Wir haben es geschafft! <br>  Nach zwei Monaten sorgf√§ltiger Arbeit erhielt die Zentrale regelm√§√üig Daten f√ºr Berichte aus allen Niederlassungen.  Dar√ºber hinaus war die Qualit√§t und Vollst√§ndigkeit der Daten beispiellos anders als zuvor, und die freigegebenen Humanressourcen machten die Kosten des Projekts bis Ende des Jahres wieder wett. <br><br>  F√ºr uns selbst haben wir gelernt, dass Integration nicht immer schmerzhaft ist, und die Hauptaspekte des Erfolgs hervorgehoben: <br><br><ol><li>  Wir sind nicht in Systeme in Filialen gelangt. </li><li>  eine einheitliche Struktur von Berichten und Vorschriften f√ºr deren √úbermittlung formalisiert und genehmigt; </li><li>  erstellte Vorlagen f√ºr Ausgabeformate, die allgemein f√ºr alle Systeme in Form von Excel- und Word-Dokumenten verf√ºgbar sind; </li><li>  w√§hlte die h√§ufigste Methode zur Daten√ºbermittlung - E-Mail. </li></ol><br>  Und zwei Hauptnachteile: <br><br><ul><li>  Niedrige Daten√ºbertragungsgeschwindigkeit. </li><li>  Die Gr√∂√üe des Datenpakets sollte die Gr√∂√üe eines normalen E-Mail-Anhangs nicht √ºberschreiten. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de421705/">https://habr.com/ru/post/de421705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de421693/index.html">Die Geschichte einer API: Wie wir Frankenstein in gutaussehend verwandelt haben</a></li>
<li><a href="../de421695/index.html">[Nicht] konventionelle Netzwerke: Wie man Wasser in einer Tasche mithilfe von Wi-Fi erkennt</a></li>
<li><a href="../de421699/index.html">So beseitigen Sie Fehler mit Active Object-Tabellen beim Wiederherstellen von Jira aus der Sicherung</a></li>
<li><a href="../de421701/index.html">Python Learning Sandbox und Spickzettel</a></li>
<li><a href="../de421703/index.html">Linux zu Hause oder ...</a></li>
<li><a href="../de421707/index.html">FB2D - 2D Framework f√ºr Linux Frame Buffer (Rust)</a></li>
<li><a href="../de421709/index.html">Neue (und alte) CSS-Einheiten, von denen Sie kaum geh√∂rt haben</a></li>
<li><a href="../de421711/index.html">Analyse von Serviceanfragen mittels maschinellem Lernen</a></li>
<li><a href="../de421713/index.html">So finden Sie Bots auf YouTube: Interaktionsmuster f√ºr externe Kommentatoren</a></li>
<li><a href="../de421717/index.html">Wo studieren Analysten?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>