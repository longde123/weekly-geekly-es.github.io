<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🌾 🐢 ✌🏾 Automatisierung gegen Chaos 💌 👫 💦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die moderne Entwicklung von IT-Technologien hat es möglich gemacht, den enormen Datenfluss einzudämmen. 
 Das Unternehmen verfügt über verschiedene To...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung gegen Chaos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421705/"><img src="https://habrastorage.org/webt/qz/sq/j9/qzsqj9kwc7g4xeaponeocm3phxy.jpeg"><br><br>  Die moderne Entwicklung von IT-Technologien hat es möglich gemacht, den enormen Datenfluss einzudämmen. <br>  Das Unternehmen verfügt über verschiedene Tools: CRM, ERP, BPM, Buchhaltungssysteme oder im Extremfall nur Excel und Word. <br><br>  Unternehmen sind auch anders.  Einige bestehen aus vielen getrennten Zweigen.  In diesem Fall hat das Unternehmen ein Problem mit der Datensynchronisation im Zoo von IT-Systemen.  Darüber hinaus unterscheiden sich Branchen in Anbietern oder Softwareversionen.  Und häufige Änderungen der Berichtspflichten der Verwaltungsgesellschaft verursachen unkontrollierte „Freude“ vor Ort. <br><br>  Diese Geschichte handelt von einem Projekt, in dem ich auf Chaos stieß, das systematisiert und automatisiert werden musste.  Ein bescheidenes Budget und enge Fristen schränkten den Einsatz der meisten industriellen Lösungen ein, eröffneten jedoch Raum für Kreativität. <br><a name="habracut"></a><br><h2>  Universelles Format </h2><br>  Der Kunde hat es sich zur Aufgabe gemacht, Daten für Berichte aus allen Unternehmensbereichen zu sammeln.  Um das Ausmaß der Katastrophe zu verstehen, gibt es Dutzende von Systemen, darunter selbstgemachte und Monster wie SAP und natürlich 1C - wo ohne. <br><br>  In einem Bericht könnten sich Daten von: Buchhaltung, Mechanikern, PR-Spezialisten, dem Notfallministerium und Meteorologen überschneiden. <br><br>  Vor Projektbeginn wurde der Großteil der Daten per E-Mail in Form von Word / Excel-Anhängen an die Muttergesellschaft gesendet.  Außerdem ähnelte der Prozess manuell einem Sonnenuntergang: Die Daten wurden von speziell geschulten Personen verarbeitet und in einige Systeme eingegeben.  Das Ergebnis der Arbeit waren Dutzende von Berichten, auf deren Grundlage Managemententscheidungen getroffen wurden. <br><br>  Die Wahl des Ansatzes wurde durch das Format der übertragenen Dateien, nämlich xlsx / docx, veranlasst.  Sogar die „alten“ Systeme in den Filialen unterstützten das Hochladen von Daten in diese Formate. In extremen Fällen hat niemand das Kopieren und Einfügen abgebrochen. <br><br>  Unser hartnäckiger Plan war: <br><br><ol><li>  Beschreiben Sie die Struktur jedes Berichts und die Regeln für seine Übermittlung. </li><li>  Wir senken die Anforderungen für die Einrichtung von Systemen zum Versenden von Dokumenten per E-Mail gemäß den Vorschriften an die Filialen.  Wo es keine Systeme gibt - nach wie vor per Hand senden; </li><li>  Wir entwickeln ein Programm, das: <br><ul><li>  wählt bestimmte Dokumente aus eingehenden E-Mails aus; </li><li>  extrahiert Daten aus ihnen; </li><li>  schreibt die extrahierten Daten in die Datenbank und "schlägt" die Verstöße gegen die Vorschriften. </li></ul><br></li></ol><br><img src="https://habrastorage.org/webt/6b/na/ev/6bnaevbsj113vtojoryl6pkxt2s.png"><br><br><h2>  Implementierung </h2><br><h3>  Organisatorische Angelegenheiten </h3><br>  Bei der Erhebung und Formalisierung der Anforderungen an die Struktur und Regulierung der Datenübertragung stellte sich heraus, dass die Struktur der Berichte überhaupt nicht beschrieben wurde.  Alles wurde in den Köpfen einiger Mitarbeiter gespeichert und mündlich als russische Volksmärchen übermittelt.  Die eigentlichen Probleme begannen jedoch später - beim Einrichten des Datenaustauschs. <br><br><h4>  Problem eins </h4><br>  Der Unterschied zwischen der Struktur von Dokumenten von der Referenz und der Datenqualität.  In den Berichten konvergierten die Beträge manchmal nicht, die Spalten waren verwechselt oder hatten falsche Namen.  Das Problem wurde hauptsächlich in Zweigen beobachtet, in denen Daten manuell eingegeben wurden. <br><br>  Die Lösung ist die Implementierung einer dreistufigen Überprüfung: <br><br><ol><li>  Erstellen von Excel-Referenzdokumenten mit einer starren Struktur unter Verwendung von Excel selbst.  In solchen Dokumenten waren nur Dateneingabezellen verfügbar.  Welche zusätzlichen Kontrollen wurden durchgeführt: Art, Konvergenz der Beträge usw. </li><li>  Überprüft beim Extrahieren von Daten aus dem Bericht.  Zum Beispiel ein Vergleich des aktuellen Datums und des Datums in einem Absatz eines Word-Dokuments oder eine arithmetische Überprüfung auf Daten aus einem Excel-Dokument (wenn diese nicht im Dokument selbst angegeben werden können). </li><li>  Tiefe Datenanalyse nach der Erfassung.  Zum Beispiel die Feststellung signifikanter Abweichungen bei Schlüsselindikatoren im Vergleich zu früheren Perioden. </li></ol><br><h4>  Zweites Problem </h4><br>  Ein systematischer Verstoß gegen den Datenübertragungsplan oder skrupellose Sabotageversuche: "Im Allgemeinen haben wir nie Daten an jemanden gesendet, aber hier sind Sie mit meinen eigenen ...", "Ja, ich habe alles pünktlich gesendet, dies ist wahrscheinlich ein schlechter Ping." <br><br>  Die Lösung ist Feedback.  Das System benachrichtigt automatisch die Verantwortlichen in der Filiale bei einem Zeitplanverstoß.  Später wurde das Feedback-Subsystem mit dem Qualitätskontrollsystem für Eingabedaten und dem endgültigen Berichtssystem verschraubt, sodass die Zweigstelle sofort einen Datensatz und einen Vergleich mit den „Nachbarn“ erhalten würde.  <s>Um klar zu machen, warum er harkt.</s> <br><br><h3>  Entwickelte Subsysteme </h3><br><br><ol><li>  Konfigurator von Dokumenttypen mit Daten, in denen Sie schnell beschreiben können: <br><ul><li>  Zeichen zur Identifizierung des Dokuments; </li><li>  Übertragungsvorschriften; </li><li>  Datenextraktionsalgorithmus; </li><li>  andere Attribute wie der Pfad zum Code, der die Daten validiert und speichert. </li></ul><br></li><li>  Ein E-Mail-Empfänger, der Anhänge in einen isolierten Speicher (Sandbox) verschiebt und zugehörige Informationen zum Brief speichert. </li><li>  Ein Anhangsparser, der Dokumenttypen definiert und Daten daraus extrahiert. </li></ol><br><img src="https://habrastorage.org/webt/7s/bp/ef/7sbpefc8oczlxcc6xyrauq4309y.png"><br><br><h4>  Konfigurator </h4><br>  Historisch gesehen kommen alle Dokumente mit Daten an die allgemeine Post, wo sie voller anderer wichtiger und nicht so wichtiger Briefe ist.  Wir brauchen Zeichen, anhand derer die notwendigen Unterlagen ermittelt werden.  Der Name des Dokuments oder der Text im Text der E-Mail ist für den Absender unzuverlässig und unpraktisch.  Daher wurde beschlossen, dass die Mitgliedschaft im Bericht nur durch den Inhalt des Dokuments bestimmt wird.  Darüber hinaus müssen Sie eindeutig bestimmen, welche Art von Bericht das Dokument enthält. <br><br>  Sie kamen mit einem Brainstorming Meerrettich weiß, wie viele Zeichen ein Dokument zu identifizieren: Textfarbe in einer Zelle, Schriftart usw.  Am korrektesten war jedoch das Vorzeichen eines Teilstrings in einem bestimmten Zellen- „Slot“ oder eines Arrays von Zellen für Excel und eines Absatzes oder einer Überschrift für Word.  Für den „Steckplatz“ wurde eine einfache formale Logik hinzugefügt: „gleich“, „ungleich“, „mehr“, „weniger“ usw. Beispiel für Excel: Im Bereich A2-E4 sollte der Text der Zelle gleich „Tägliche Zusammenfassung der Gerätebelastung“ sein. <br><br><img src="https://habrastorage.org/webt/km/aj/ea/kmajeaf8og5y17cnfronq3x2wmq.png"><br><br>  Der Dokumentbereich, in dem Sie nach Anfang und Ende der Daten suchen möchten, wird auf ähnliche Weise konfiguriert (ca. Bedingungen zum Auffinden des Endes: 2 Leerzeilen in einer Reihe). <br><br><img src="https://habrastorage.org/webt/u1/9t/hh/u19thhrwphi6bbdfifx1bt6tk84.png"><br><br>  Weitere nützliche Einstellungen sind eine Liste aufgelöster Absender, ein Dokumenttyp (Excel / Word) und ein Pfad zum Exportieren von Daten. <br><br>  Bei der Ausgabe erhalten wir eine JSON-Struktur (Vorlage), die den Bericht beschreibt. <br><br><h4>  E-Mail-Empfänger </h4><br>  Ein E-Mail-Reader, der alle Dokumente aus Anhängen in die Sandbox legt, die Attribute des Briefes speichert und die Dokumente in die Warteschlange der Aufgaben zum Parsen stellt. <br><br>  Es gibt 2 Sicherheitsfragen: <br><br><ol><li>  Was ist, wenn die Daten an eine andere Zweigstelle gesendet werden? </li><li>  Was ist, wenn die Daten von Angreifern gesendet werden? </li></ol><br>  Das erste Problem wird behoben, indem die E-Mail-Adresse des sendenden Zweigs und der im Berichtstext angegebenen Zweig abgeglichen werden. <br><br>  Der zweite verwendet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SPF</a> . <br><br><h4>  Anhang Parser </h4><br>  Fast alle Bibliotheken zum Parsen von Word und Excel unterliegen schwerwiegenden Einschränkungen der unterstützten Versionen. Daher muss das Dokument zunächst konvertiert werden.  Libre Office löst dieses Problem um fünf. <br><br>  Nach der Konvertierung: <br><br><ol><li>  Wir filtern ein Array von Vorlagen nach grundlegenden Merkmalen aus dem Konfigurator heraus (Word / Excel, Absender ...). </li><li>  Führen Sie das Dokument mit den verbleibenden Vorlagen aus. </li><li>  Wenn die Vorlage gefunden wird, extrahieren wir die Daten und übertragen sie in das Repository. </li></ol><br><h2>  Zusammenfassung </h2><br>  Wir haben es geschafft! <br>  Nach zwei Monaten sorgfältiger Arbeit erhielt die Zentrale regelmäßig Daten für Berichte aus allen Niederlassungen.  Darüber hinaus war die Qualität und Vollständigkeit der Daten beispiellos anders als zuvor, und die freigegebenen Humanressourcen machten die Kosten des Projekts bis Ende des Jahres wieder wett. <br><br>  Für uns selbst haben wir gelernt, dass Integration nicht immer schmerzhaft ist, und die Hauptaspekte des Erfolgs hervorgehoben: <br><br><ol><li>  Wir sind nicht in Systeme in Filialen gelangt. </li><li>  eine einheitliche Struktur von Berichten und Vorschriften für deren Übermittlung formalisiert und genehmigt; </li><li>  erstellte Vorlagen für Ausgabeformate, die allgemein für alle Systeme in Form von Excel- und Word-Dokumenten verfügbar sind; </li><li>  wählte die häufigste Methode zur Datenübermittlung - E-Mail. </li></ol><br>  Und zwei Hauptnachteile: <br><br><ul><li>  Niedrige Datenübertragungsgeschwindigkeit. </li><li>  Die Größe des Datenpakets sollte die Größe eines normalen E-Mail-Anhangs nicht überschreiten. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de421705/">https://habr.com/ru/post/de421705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de421693/index.html">Die Geschichte einer API: Wie wir Frankenstein in gutaussehend verwandelt haben</a></li>
<li><a href="../de421695/index.html">[Nicht] konventionelle Netzwerke: Wie man Wasser in einer Tasche mithilfe von Wi-Fi erkennt</a></li>
<li><a href="../de421699/index.html">So beseitigen Sie Fehler mit Active Object-Tabellen beim Wiederherstellen von Jira aus der Sicherung</a></li>
<li><a href="../de421701/index.html">Python Learning Sandbox und Spickzettel</a></li>
<li><a href="../de421703/index.html">Linux zu Hause oder ...</a></li>
<li><a href="../de421707/index.html">FB2D - 2D Framework für Linux Frame Buffer (Rust)</a></li>
<li><a href="../de421709/index.html">Neue (und alte) CSS-Einheiten, von denen Sie kaum gehört haben</a></li>
<li><a href="../de421711/index.html">Analyse von Serviceanfragen mittels maschinellem Lernen</a></li>
<li><a href="../de421713/index.html">So finden Sie Bots auf YouTube: Interaktionsmuster für externe Kommentatoren</a></li>
<li><a href="../de421717/index.html">Wo studieren Analysten?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>