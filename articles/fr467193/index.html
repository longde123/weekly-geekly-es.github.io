<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÄ üêª ‚èèÔ∏è Virus mineur avec ¬´Heaven's Gate¬ª üì´ ü•å ü§¥üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! En pr√©vision du d√©marrage d'une nouvelle fili√®re au cours de reverse engineering, nous partageons avec vous la traduction d'un mat√©rie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Virus mineur avec ¬´Heaven's Gate¬ª</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/467193/">  Bonjour √† tous!  En pr√©vision du d√©marrage d'une nouvelle fili√®re au cours de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">reverse engineering, nous</a> partageons avec vous la traduction d'un mat√©riel tr√®s int√©ressant.  Bonne lecture <br><br><img src="https://habrastorage.org/webt/ob/ex/ue/obexuezayzkv5cwefrnqwi2j7_8.png"><br><hr><br>  Les deux derni√®res ann√©es peuvent √™tre appel√©es des ann√©es de hackers de ransomwares.  Les ransomwares sont sans aucun doute le type de malware le plus populaire.  Cependant, √† la fin des derni√®res ann√©es, nous avons commenc√© √† observer leur baisse de popularit√© et son augmentation en faveur des mineurs.  Il est possible qu'en 2018, cette tendance ne fera que cro√Ætre. <a name="habracut"></a><br><br>  Du point de vue de la victime, c'est un soulagement, car les mineurs ne sont pas aussi dangereux que les ransomwares.  Oui, ils ralentissent le syst√®me, mais d√®s que vous vous en d√©barrassez, vous pouvez continuer √† utiliser votre ordinateur comme avant.  Vos donn√©es ne sont ni vol√©es ni perdues, comme c'est le cas avec le virus ransomware. <br><br>  Du point de vue d'un chercheur de logiciels malveillants, les mineurs sont d√©cevants.  Ils ne fournissent pas suffisamment de nouveaux mat√©riaux pour une analyse plus approfondie, principalement parce qu'ils sont bas√©s sur des composants open source bien connus avec peu ou pas de confusion ou de furtivit√©. <br><br>  Cependant, de temps en temps, nous trouvons des mineurs utilisant des astuces int√©ressantes.  Nous avons r√©cemment observ√© une technique appel√©e ¬´Heaven's Gate¬ª, qui permet des injections dans des processus 64 bits √† partir de chargeurs de d√©marrage 32 bits.  Cette id√©e n'est pas nouvelle, sa premi√®re impl√©mentation remonte √† 2009, mais il est int√©ressant de voir comment elle a √©t√© impl√©ment√©e sous une nouvelle forme, obtenue directement ¬´√† l'√©tat sauvage¬ª. <br><br>  Les d√©butants en analyse de virus peuvent lire un guide sur ce qu'est Heaven's Gate et comment aborder son analyse. <br><br><h3>  Mat√©riel d'analyse </h3><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7b3491e0028d443f11989efaeb0fbec2</a> - le premier compte-gouttes; </li></ul><br>  Ce mod√®le a √©t√© trouv√© dans la suite de la campagne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ngay</a> (plus √† ce sujet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ).  La v√©rification de la biographie de ces √©chantillons m'a conduit √† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@_qaz_qaz</a> , qui d√©crit une campagne ant√©rieure avec un √©chantillon similaire.  Cependant, son analyse n'a pas inclus la technologie Heaven's Gate. <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ed575ba72ea8b41ac2c31c8c39ce303b</a> - le deuxi√®me compte-gouttes; </li><li>  ca54fa2cf8a7e3e2cd457811f336de44 - chargeur de d√©marrage 32 bits. </li></ul><br><h3>  Analyse comportementale </h3><br>  Pour voir l'injection mentionn√©e, nous devons ex√©cuter l'exemple sur un syst√®me 64 bits.  Nous voyons qu'il lance l'essence du portable, avec les param√®tres sp√©cifiques √† l'extraction de crypto-monnaie: <br><br><img src="https://habrastorage.org/webt/j8/2m/wu/j82mwua73429bcc1dxa1krt7g6g.png"><br><br>  En regardant les lignes en m√©moire dans ProcessExplorer, nous voyons que ce n'est pas un vrai portable, mais le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mineur XMRig</a> Monero. <br><br><img src="https://habrastorage.org/webt/xj/st/jn/xjstjnrjz3pq90ujlsn1iulrsmu.png"><br><br>  Donc, pour le moment, nous sommes s√ªrs que l'image de l'ordinateur portable en m√©moire a probablement √©t√© remplac√©e par la m√©thode RunPE (Process Hollowing). <br><br>  Le compte-gouttes principal est de 32 bits, mais d√©place la charge utile vers un ordinateur portable 64 bits: <br><br><img src="https://habrastorage.org/webt/ks/tq/3f/kstq3f74qii0rguaotcf4ng0hls.png"><br><br>  Plus int√©ressant, ce type d'injection n'est pas pris en charge par l'API Windows officielle.  Nous pouvons lire / √©crire dans la m√©moire des processus 32 bits √† partir d'une application 64 bits (en utilisant l'API WoW64), mais pas l'inverse. <br><br>  Cependant, il existe des solutions non officielles, comme une technique appel√©e ¬´Heaven's Gate¬ª. <br><br><h3>  Critique de Heaven's Gate </h3><br>  La technique Heaven's Gate a √©t√© d√©crite pour la premi√®re fois en 2009 par un hacker avec le surnom de Roy G. Biv.  Plus tard, de nombreuses impl√©mentations ont √©t√© cr√©√©es, par exemple, la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wow64ext</a> ou, sur cette base, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">W64oWoW64</a> .  Dans son blog de 2015, Alex Ionescu a d√©crit les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mesures de lutte contre cette technique</a> . <br>  Voyons comment cela fonctionne. <br><br><h3>  Ex√©cution de processus 32 bits sur Windows 64 bits </h3><br>  Chaque processus 32 bits ex√©cut√© sur une version 64 bits de Windows s'ex√©cute sur un sous-syst√®me sp√©cial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WoW64</a> qui √©mule un environnement 32 bits.  Vous pouvez tracer une analogie avec un sandbox 32 bits cr√©√© dans un processus 64 bits.  Tout d'abord, un environnement de processus 64 bits est cr√©√©.  Et d√©j√† √† l'int√©rieur, un environnement 32 bits est cr√©√©.  L'application s'ex√©cute dans cet environnement 32 bits, mais n'a pas acc√®s √† sa partie 64 bits. <br><br>  Si nous analysons un processus 32 bits de l'ext√©rieur √† l'aide d'un scanner 64 bits, nous verrons qu'il contient √† la fois des DLL 32 et 64 bits.  Plus important encore, il a deux versions de NTDLL: 32 bits (charg√© √† partir du r√©pertoire SysWow64) et 64 bits (charg√© √† partir du r√©pertoire System32): <br><br><img src="https://habrastorage.org/webt/jp/kq/im/jpkqimhiu4fa-y1w1uwwq1up6ga.png"><br><br>  Cependant, le processus 32 bits lui-m√™me ne voit pas la partie 64 bits et se limite √† l'utilisation de DLL 32 bits.  Pour injecter dans un processus 64 bits, vous devez utiliser les versions 64 bits des fonctions correspondantes. <br><br><h3>  Segments de code </h3><br>  Pour acc√©der √† la partie restreinte de l'environnement, nous devons comprendre comment l'isolement se fait.  Il s'av√®re que tout est assez simple.  L'ex√©cution de code 32 bits et 64 bits est disponible via une adresse de segment de code diff√©rente: 32 bits - 0x23 et 64 bits - 0x33. <br><br>  Si nous appelons l'adresse de la mani√®re habituelle, le mode utilis√© pour l'interpr√©ter est d√©fini par d√©faut.  Cependant, nous pouvons explicitement demander une modification √† l'aide du code assembleur. <br><br><h3>  √Ä l'int√©rieur du mineur: mise en ≈ìuvre de Heaven's Gate </h3><br>  Je ne proc√©derai pas √† une analyse compl√®te de ce mineur, comme il a d√©j√† √©t√© d√©crit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Allons directement √† l'endroit o√π le plaisir commence.  Le programme malveillant v√©rifie son environnement et s'il d√©tecte qu'il s'ex√©cute sur un syst√®me 64 bits, il utilise une m√©thode diff√©rente pour injecter dans le processus 64 bits: <br><br><img src="https://habrastorage.org/webt/gz/kw/ll/gzkwlluwayyv5qawjrd6bngp0-o.png"><br><br>  Apr√®s quelques v√©rifications anti-analyse, il cr√©e un nouveau processus 64 bits suspendu (dans ce cas, un bloc-notes): <br><br><img src="https://habrastorage.org/webt/ey/ne/fj/eynefjkyabjcaqfkrwqc3hm9qe4.png"><br><br>  Il s'agit de la cible dans laquelle la charge malveillante sera impl√©ment√©e. <br>  Comme nous l'avons appris pr√©c√©demment, afin d'int√©grer la charge utile dans un processus 64 bits, nous devons utiliser les fonctions 64 bits appropri√©es. <br><br>  Tout d'abord, le chargeur de d√©marrage passe le traitement NTDLL 64 bits: <br><br><img src="https://habrastorage.org/webt/mo/jj/bw/mojjbw2ddkok1n4weobjayjx4zu.png"><br><br>  Ce qui se passe √† l'int√©rieur de la fonction <code>get_ntdll</code> n√©cessite une explication plus d√©taill√©e.  √Ä titre d'explication, nous pouvons √©galement jeter un ≈ìil √† un <a href="">code</a> similaire dans la biblioth√®que ReWolf. <br><br>  Pour acc√©der √† la partie 64 bits de l'environnement de processus, nous devons travailler avec des s√©lecteurs de segments.  Voyons comment le malware passe en mode 64 bits. <br><br><img src="https://habrastorage.org/webt/yh/hw/7m/yhhw7mgp_g2ub-y4nqnabhj4vb8.png"><br><br>  Il semble que ce code ait √©t√© copi√© directement √† partir de la biblioth√®que ouverte: <a href="">https://github.com/rwfpl/rewolf-wow64ext/blob/master/src/internal.h#L26</a> <br><br>  Le s√©lecteur de segment 0x33 est pouss√© sur la pile.  Ensuite, le malware appelle la ligne suivante: (de cette mani√®re, l'adresse de la ligne suivante est √©galement pouss√©e sur la pile.) <br><br><img src="https://habrastorage.org/webt/6o/bk/dl/6obkdlrqkdlurnpfrfzlc9axvdw.png"><br><br>  L'adresse qui a √©t√© <code>retf</code> pile est fix√©e en ajoutant 5 octets et est d√©finie apr√®s <code>retf</code> : <br><br><img src="https://habrastorage.org/webt/zk/8t/5h/zk8t5hpbn68ngyilrkgldw5gv-g.png"><br><br>  √Ä la fin, l'instruction RETF est appel√©e.  RETF est un ¬´retour lointain¬ª et, contrairement au RET normal, il vous permet de sp√©cifier non seulement l'adresse √† partir de laquelle vous souhaitez continuer l'ex√©cution, mais √©galement un segment.  Comme arguments, il prend deux DWORD de la pile.  Ainsi, lorsque RETF est ex√©cut√©, l'adresse de retour de retour devient: <br><br>  <b>0x33: 0x402A50</b> <br><br>  Gr√¢ce au segment modifi√©, le code commen√ßant √† l'adresse sp√©cifi√©e est interpr√©t√© comme 64 bits.  Ainsi, le code que le d√©bogueur voit est 32 bits ... <br><br><img src="https://habrastorage.org/webt/kw/h8/7t/kwh87tqwggznnqzoxjf8elqt9ds.png"><br><br>  ... en fait 64 bits. <br><br>  Pour changer rapidement de vue, j'utilise la fonction PE-bear: <br><br><img src="https://habrastorage.org/webt/t0/7o/_w/t07o_w2ib83ptd1gfnldc0cposg.png"><br><br>  Et voici √† quoi ressemble ce morceau de code s'il est interpr√©t√© comme 64 bits: <br><br><img src="https://habrastorage.org/webt/c8/a2/1d/c8a21dbp7ot9hzx3ipb5-jkwhfo.png"><br><br>  Ainsi, le code qui est ex√©cut√© ici est responsable du d√©placement du contenu du registre R12 vers une variable de la pile, puis repasse en mode 32 bits.  Ceci est fait afin d'obtenir le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bloc d'informations sur les threads (TEB)</a> 64 bits, √† partir duquel nous obtenons le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bloc d'environnement de processus (PEB)</a> 64 bits √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partir d'ici</a> - nous examinons un <a href="">code similaire</a> . <br><br>  Un PEB 64 bits est utilis√© comme point de d√©part pour rechercher une version 64 bits de NTDLL.  Cette partie est impl√©ment√©e de mani√®re assez <a href="">triviale</a> (une impl√©mentation ¬´vanille¬ª de cette m√©thode peut √™tre trouv√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ), en utilisant un pointeur vers les biblioth√®ques charg√©es, qui sont l'un des champs de la structure PEB.  Donc, de PEB, nous obtenons un champ appel√© <i>Ldr</i> : <br><br><img src="https://habrastorage.org/webt/y-/fi/v-/y-fiv-utn-eenbgynck30v3rxp4.png"><br><br>  <b><i>Ldr</i></b> est une structure de type <code>_PEB_LDR_DATA</code> .  Il contient une entr√©e appel√©e <code>InMemoryOrderModuleList</code> : <br><br><img src="https://habrastorage.org/webt/ri/oi/hk/rioihkllxtn7jcj_rs0i39jpegs.png"><br><br>  Cette liste contient toutes les biblioth√®ques charg√©es qui sont pr√©sentes dans la m√©moire du processus √† l'√©tude.  Nous parcourons la liste jusqu'√† ce que nous trouvions la biblioth√®que qui nous int√©resse, dans notre cas c'est NTDLL.  C'est exactement ce que fait la fonction <code>get_ntdll</code> ci-dessus.  Pour trouver un nom appropri√©, il appelle la fonction suivante, d√©sign√©e <code>is_ntdll_lib</code> , qui v√©rifie le nom de la biblioth√®que par rapport √† ntdll.dll par caract√®res.  L'√©quivalent de <a href="">ce</a> code s'av√®re. <br><br><img src="https://habrastorage.org/webt/se/zc/e9/sezce9ivnb5hccvl5gahlmnveqg.png"><br><br>  Si les noms correspondent, l'adresse de la biblioth√®que est renvoy√©e dans deux registres: <br><br><img src="https://habrastorage.org/webt/as/_r/mo/as_rmojmqloqtgrbwwoh7cnafpi.png"><br><br>  Une fois que nous avons trouv√© NTDLL, nous avons juste besoin d'obtenir les adresses des fonctions correspondantes.  Nous pouvons le faire en regardant la table d'exportation de la biblioth√®que: <br><br><img src="https://habrastorage.org/webt/jl/oa/mm/jloamm2asyt0a3-xbwqnpawmwic.png"><br><br>  Les fonctions suivantes sont r√©cup√©r√©es: <br><br><ul><li>  <i>NttUnmapViewOfSection</i> </li><li>  <i>NtGetContextThread</i> </li><li>  <i>NtAllocateVirtualMemory</i> </li><li>  <i>NtReadVirtualMemory</i> </li><li>  <i>NtWriteVirtualMemory</i> </li><li>  <i>NtSetContextThread.</i> </li></ul><br>  Comme nous le savons, ces fonctions sont typiques de la technique RunPE.  Tout d'abord, NtUnmapViewOfSection est utilis√© pour d√©mapper le fichier PE d'origine.  Ensuite, dans le processus distant, la m√©moire est allou√©e et un nouveau PE est √©crit.  √Ä la fin, le contexte du processus est modifi√© de sorte que l'ex√©cution commence √† partir du module int√©gr√©. <br><br>  Les adresses de fonction sont stock√©es et appel√©es ult√©rieurement (de mani√®re similaire √† <a href="">ce</a> code) pour contr√¥ler le processus distant. <br><br><h3>  Conclusion </h3><br>  Jusqu'√† pr√©sent, les auteurs de mineurs n'ont pas fait preuve de beaucoup de cr√©ativit√©.  Ils atteignent leurs objectifs en s'appuyant sur des composants open source.  Le cas d√©crit refl√®te bien cette tendance, car une mise en ≈ìuvre pr√™te √† l'emploi a √©t√© utilis√©e. <br><br>  Heaven's Gate existe depuis plusieurs ann√©es.  Certains programmes malveillants l'utilisent pour augmenter la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">furtivit√©</a> .  Mais dans le cas de ce mineur, les auteurs ont probablement cherch√© plut√¥t √† maximiser les performances en utilisant la charge utile qui correspond le mieux √† l'architecture cible. <br><br>  C‚Äôest tout.  Vous pouvez en savoir plus sur notre cours <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467193/">https://habr.com/ru/post/fr467193/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467183/index.html">√âtude des 50 meilleures plateformes de chat bot et assistants virtuels en 2019</a></li>
<li><a href="../fr467185/index.html">Descente en pente</a></li>
<li><a href="../fr467187/index.html">Cr√©er la derni√®re biblioth√®que technologique</a></li>
<li><a href="../fr467189/index.html">√âchantillonnage de temp√©rature</a></li>
<li><a href="../fr467191/index.html">Comment nous avons cr√©√© Vivaldi pour Android</a></li>
<li><a href="../fr467197/index.html">Comment le polymorphisme est impl√©ment√© dans la JVM</a></li>
<li><a href="../fr467199/index.html">Journal de Tom Hunter: Le chien des Baskerville</a></li>
<li><a href="../fr467201/index.html">Exp√©rience CacheBrowser: Contournement d'un pare-feu chinois sans proxy √† l'aide de la mise en cache de contenu</a></li>
<li><a href="../fr467203/index.html">Juste la division, ou comment cr√©er une th√©orie math√©matique et y gagner 400 000 $. Deuxi√®me s√©rie, avant-derni√®re</a></li>
<li><a href="../fr467205/index.html">Nous d√©veloppons une application qui envoie des donn√©es vers d'autres applications (application √©cosyst√®me)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>