<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè© üßëüèæ‚Äçü§ù‚Äçüßëüèº ‚û∞ ActionViews ou como eu n√£o gosto de clich√™ desde a inf√¢ncia üë©üèΩ‚Äçü§ù‚Äçüë®üèø üë®üèø‚Äç‚öïÔ∏è üê¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Neste artigo, quero compartilhar a experi√™ncia de criar meu pr√≥prio mecanismo para automatizar a exibi√ß√£o de v√°rios tipos de exibi√ß√£o: Conte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ActionViews ou como eu n√£o gosto de clich√™ desde a inf√¢ncia</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/e-Legion/blog/414773/"><p>  Ol√° Habr!  Neste artigo, quero compartilhar a experi√™ncia de criar meu pr√≥prio mecanismo para automatizar a exibi√ß√£o de v√°rios tipos de exibi√ß√£o: ContentView, LoadingView, NoInternetView, EmptyContentView, ErrorView. </p><br><img src="https://habrastorage.org/webt/ir/qr/we/irqrwe-ha4rx0zfqirxm1vhtlem.jpeg"><a name="habracut"></a><br><hr><br><p>  Foi um longo caminho.  O caminho da tentativa e erro, enumera√ß√£o de m√©todos e op√ß√µes, noites sem dormir e experi√™ncia inestim√°vel que quero compartilhar e ouvir cr√≠ticas, as quais definitivamente irei levar em considera√ß√£o. </p><br><p>  Eu direi imediatamente que considerarei trabalhar no RxJava, pois para as corotinas n√£o fiz esse mecanismo - minhas m√£os n√£o alcan√ßaram.  E para outras ferramentas semelhantes (Loaders, AsyncTask, etc.), n√£o faz sentido usar meu mecanismo, pois na maioria das vezes s√£o RxJava ou coroutines que s√£o usados. </p><br><h3 id="actionviews">  Actionviews </h3><br><p>  Um colega meu disse que era imposs√≠vel padronizar o comportamento do View, mas eu ainda tentei faz√™-lo.  E fez isso. </p><br><p>  A tela padr√£o do aplicativo, cujos dados s√£o retirados do servidor, deve processar pelo menos 5 estados: </p><br><ul><li>  Exibi√ß√£o de dados </li><li>  A carregar </li><li>  Erro - qualquer erro n√£o descrito abaixo </li><li>  Falta de internet √© um erro global </li><li>  Tela em branco - solicita√ß√£o aprovada, mas nenhum dado </li><li><del>  Outro estado √© que os dados foram carregados do cache, mas a solicita√ß√£o de atualiza√ß√£o retornou com um erro, ou seja, mostrando dados desatualizados (melhor que nada) </del>  - A biblioteca n√£o suporta isso. </li></ul><br><p>  Consequentemente, para cada um desses estados deve haver sua pr√≥pria vis√£o. </p><br><p>  Eu os chamo de View - <strong>ActionViews</strong> , porque eles respondem a algum tipo de a√ß√£o.  De fato, se voc√™ pode determinar exatamente em que ponto sua exibi√ß√£o deve ser exibida e quando ocultar, tamb√©m pode ser um ActionView. </p><br><p> Existe uma (ou talvez n√£o) uma maneira padr√£o de trabalhar com essa Visualiza√ß√£o. </p><br><p>  Nos m√©todos que cont√™m o trabalho com o RxJava, voc√™ precisa adicionar argumentos de entrada para todos os tipos de ActionViews e adicionar alguma l√≥gica a essas chamadas para mostrar e ocultar os ActionViews, como √© feito aqui: </p><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSomeData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LoadingView loadingView, ErrorView errorView, NoInternetView noInternetView, EmptyContentView emptyContentView)</span></span></span><span class="hljs-function"> </span></span>{ mApi.getProjects() .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .doOnSubscribe(disposable -&gt; { loadingView.show(); noInternetView.hide(); emptyContentView.hide(); }) .doFinally(loadingView::hide) .flatMap(projectResponse -&gt; { <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> }) .subscribe( response -&gt; {<span class="hljs-comment"><span class="hljs-comment">/*   */</span></span>}, throwable -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ApiUtils.NETWORK_EXCEPTIONS .contains(throwable.getClass())) noInternetView.show(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> errorView.show(throwable.getMessage()); } ); }</code> </pre> <br><p>  Mas esse m√©todo cont√©m uma quantidade <strong>enorme</strong> de clich√™, e por padr√£o n√£o gostamos.  E ent√£o comecei a trabalhar na redu√ß√£o do c√≥digo de rotina. </p><br><h3 id="level-up">  Subir de n√≠vel </h3><br><p>  A primeira etapa na atualiza√ß√£o da maneira padr√£o de trabalhar com o ActionViews foi reduzir o padr√£o, colocando a l√≥gica nas classes de utilit√°rio.  O c√≥digo abaixo n√£o foi inventado por mim.  Sou pl√°gio e espiei isso em um colega sensato.  Obrigado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Arutar</a> </p><br><p>  Agora, nosso c√≥digo fica assim: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSomeData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LoadingView loadingView, ErrorView errorView, NoInternetView noInternetView, EmptyContentView emptyContentView)</span></span></span><span class="hljs-function"> </span></span>{ mApi.getProjects() .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .compose(RxUtil::loading(loadingView)) .compose(RxUtil::emptyContent(emptyContentView)) .compose(RxUtil::noInternet(errorView, noInternetView)) .subscribe(response -&gt; { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> }, RxUtil::error(errorView)); }</code> </pre> <br><p>  O c√≥digo que vemos acima, embora desprovido de um c√≥digo padr√£o, ainda n√£o causa um prazer t√£o encantador.  J√° ficou muito melhor, mas continua a haver o problema de passar links para o ActionViews em todos os m√©todos em que h√° trabalho com o Rx.  E pode haver um n√∫mero infinito desses m√©todos em um projeto.  Escreva tamb√©m estas composi√ß√µes constantemente.  Buueee.  Quem precisa disso?  Apenas pessoas trabalhadoras, teimosas e n√£o pregui√ßosas.  Eu n√£o sou assim.  Sou f√£ da pregui√ßa e sou f√£ de escrever c√≥digos bonitos e convenientes, por isso foi tomada uma decis√£o importante - simplificar o c√≥digo de qualquer maneira. </p><br><h3 id="tochka-proryva">  Ponto de avan√ßo </h3><br><p>  Ap√≥s in√∫meras reescritas do mecanismo, cheguei a esta op√ß√£o: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSomeData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ execute(() -&gt; mApi.getProjects(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BaseSubscriber&lt;&gt;(response -&gt; { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> })); }</code> </pre> <br><p>  Reescrevi meu mecanismo cerca de 10 a 15 vezes e, a cada vez, era muito diferente da vers√£o anterior.  N√£o vou mostrar todas as vers√µes, vamos nos concentrar nas duas finais.  O primeiro que voc√™ acabou de ver. </p><br><p>  Concordo, parece bonito?  Eu diria mesmo muito bonita.  Eu lutei por essas decis√µes.  E absolutamente todas as nossas ActionViews funcionar√£o corretamente no momento em que precisamos.  Consegui fazer isso escrevendo uma quantidade enorme de c√≥digos n√£o t√£o bonitos.  As classes que permitem esse mecanismo cont√™m muita l√≥gica complexa, e eu n√£o gostei.  Em uma palavra - querida, que √© um monstro sob o cap√¥. </p><br><img src="https://habrastorage.org/webt/4z/eu/kd/4zeukd8fsc87mpezaq5buigjvvs.jpeg"><br><hr><br><p>  Esse c√≥digo no futuro ser√° cada vez mais dif√≠cil de manter, e ele pr√≥prio cont√©m desvantagens e problemas bastante s√©rios, cr√≠ticos: </p><br><ul><li>  O que acontece se voc√™ precisar exibir v√°rios LoadingViews na tela?  Como separ√°-los?  Como entender qual LoadingView deve ser exibido quando? </li><li>  Viola√ß√£o do conceito de Rx - tudo deve estar em um fluxo (fluxo).  Este n√£o √© o caso aqui. </li><li>  A complexidade da personaliza√ß√£o.  O comportamento e a l√≥gica descritos s√£o muito dif√≠ceis de mudar para o usu√°rio final e, portanto, √© dif√≠cil adicionar novos comportamentos. </li><li>  Voc√™ deve usar o modo de exibi√ß√£o personalizado para que o mecanismo funcione.  Isso √© necess√°rio para que o mecanismo entenda qual ActionView pertence a qual tipo.  Por exemplo, se voc√™ quiser usar o ProgressBar, ele dever√° conter os implementos LoadingView. </li><li>  O ID do nosso ActionView deve corresponder ao especificado nas classes base para se livrar do padr√£o.  Isso n√£o √© muito conveniente, embora voc√™ possa aceitar isso. </li><li>  Reflex√£o  Sim, ela estava aqui e, por causa dela, o mecanismo claramente exigia otimiza√ß√£o. </li></ul><br><p>  Obviamente, eu tinha solu√ß√µes para esses problemas, mas todas essas solu√ß√µes deram origem a outros problemas.  Tentei me livrar do mais cr√≠tico poss√≠vel e, como resultado, apenas os requisitos necess√°rios para o uso da biblioteca permaneceram. </p><br><h3 id="do-svidaniya-java">  Adeus Java! </h3><br><p>  Depois de algum tempo, eu estava sentado em casa, <del>  envolvido em </del>  Eu estava brincando e de repente percebi que tinha que experimentar o Kotlin e maximizar extens√µes, valores padr√£o, lambdas e delegados. </p><br><p>  No come√ßo, ele n√£o parecia muito.  Mas agora ele est√° privado de quase todas as defici√™ncias que, em princ√≠pio, podem ser. </p><br><p>  Aqui est√° o nosso c√≥digo anterior, mas na vers√£o final: </p><br><pre> <code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSomeData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { api.getProjects() .withActionViews(view) .execute(onComplete = { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> }) }</code> </pre> <br><p>  Gra√ßas ao Extensions, pude fazer todo o trabalho em um thread sem violar o conceito b√°sico de programa√ß√£o reativa.  Tamb√©m deixei a oportunidade de personalizar o comportamento.  Se voc√™ deseja alterar a a√ß√£o no in√≠cio ou no final do programa, basta passar a fun√ß√£o para o m√©todo, e tudo funcionar√°: </p><br><pre> <code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSomeData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { api.getProjects() .withActionViews( view, doOnLoadStart = { <span class="hljs-comment"><span class="hljs-comment">/* */</span></span> }, doOnLoadEnd = { <span class="hljs-comment"><span class="hljs-comment">/* */</span></span> }) .execute(onComplete = { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> }) }</code> </pre> <br><p>  Altera√ß√µes comportamentais tamb√©m est√£o dispon√≠veis para outros ActionViews.  Se voc√™ deseja usar o comportamento padr√£o, mas n√£o possui ActionViews padr√£o, pode simplesmente especificar qual View deve substituir nosso ActionView: </p><br><pre> <code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSomeData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(projectLoadingView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LoadingView</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { mApi.getPosts(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) .withActionViews( view, loadingView = projectLoadingView ) .execute(onComplete = { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> }) }</code> </pre> <br><p>  Eu mostrei a voc√™ mesmo esse mecanismo, mas tamb√©m tem seu pr√≥prio pre√ßo. <br>  Primeiro, voc√™ precisar√° criar CustomViews para que isso funcione: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SwipeRefreshLayout</span></span></span><span class="hljs-class"> : android.support.v4.widget.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SwipeRefreshLayout</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LoadingView</span></span></span><span class="hljs-class"> { constructor(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Context</span></span></span><span class="hljs-class">) : super(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">) constructor(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Context</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attrs</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AttributeSet</span></span></span><span class="hljs-class">) : super(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attrs</span></span></span><span class="hljs-class">) }</span></span></code> </pre> <br><p>  Pode nem ser necess√°rio faz√™-lo.  No momento, estou coletando coment√°rios e aceitando sugest√µes para melhorar esse mecanismo.  O principal motivo pelo qual precisamos usar o CustomViews √© herdar de uma interface que informa a qual tipo de ActionView ele pertence.  Isso √© por seguran√ßa, pois voc√™ pode cometer um erro acidental ao especificar o tipo de exibi√ß√£o no m√©todo withActionsViews. </p><br><p>  √â assim que o m√©todo withActionsViews se parece: </p><br><pre> <code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function"> Observable</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withActionViews</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ActionsView</span></span></span></span><span class="hljs-function"><span class="hljs-params">, contentView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params"> = view.contentActionView, loadingView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LoadingView</span></span></span></span><span class="hljs-function"><span class="hljs-params">? = view.loadingActionView, noInternetView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">NoInternetView</span></span></span></span><span class="hljs-function"><span class="hljs-params">? = view.noInternetActionView, emptyContentView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EmptyContentView</span></span></span></span><span class="hljs-function"><span class="hljs-params">? = view.emptyContentActionView, errorView: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ErrorView</span></span></span></span><span class="hljs-function"><span class="hljs-params"> = view.errorActionView, doOnLoadStart: ()</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnLoadSubscribe(contentView, loadingView) }, doOnLoadEnd: () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnLoadComplete(contentView, loadingView) }, doOnStartNoInternet: () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnNoInternetSubscribe(contentView, noInternetView) }, doOnNoInternet: (Throwable) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnNoInternet(contentView, errorView, noInternetView) }, doOnStartEmptyContent: () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnEmptyContentSubscribe(contentView, emptyContentView) }, doOnEmptyContent: () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnEmptyContent(contentView, errorView, emptyContentView) }, doOnError: (Throwable) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> = { doOnError(errorView, it) } ) { <span class="hljs-comment"><span class="hljs-comment">/**/</span></span> }</code> </pre> <br><p>  Parece assustador, mas conveniente e r√°pido!  Como voc√™ pode ver, nos par√¢metros de entrada ele aceita loadingView: LoadingView? .. Isso protege contra erros com o tipo ActionView. </p><br><p>  Portanto, para que o mecanismo funcione, voc√™ precisa executar algumas etapas simples: </p><br><ul><li>  Adicione ao nosso layout nossos ActionViews, que s√£o personalizados.  Eu j√° fiz alguns deles, e voc√™ pode apenas us√°-los. </li><li>  Implemente a interface HasActionsView e substitua as vari√°veis ‚Äã‚Äãpadr√£o respons√°veis ‚Äã‚Äãpor ActionViews no c√≥digo: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> contentActionView: View <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { recyclerView } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loadingActionView: LoadingView? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { swipeRefreshLayout } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> noInternetActionView: NoInternetView? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { noInternetView } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emptyContentActionView: EmptyContentView? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { emptyContentView } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> errorActionView: ErrorView <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { ToastView(baseActivity) }</code> </pre> </li><li><p>  Ou herdar de uma classe na qual nossos ActionViews j√° foram substitu√≠dos.  Nesse caso, voc√™ precisar√° usar o ID estritamente especificado em seu layout: </p><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionsFragment</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fragment</span></span></span></span>(), HasActionsView { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> contentActionView: View <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { findViewById&lt;View&gt;(R.id.contentView) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loadingActionView: LoadingView? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { findViewByIdNullable&lt;View&gt;(R.id.loadingView) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> LoadingView? } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> noInternetActionView: NoInternetView? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { findViewByIdNullable&lt;View&gt;(R.id.noInternetView) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> NoInternetView? } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emptyContentActionView: EmptyContentView? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { findViewByIdNullable&lt;View&gt;(R.id.emptyContentView) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EmptyContentView? } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> errorActionView: ErrorView <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mutableLazy { ToastView(baseActivity) } }</code> </pre> <br></li><li>  Aproveite o trabalho sem um clich√™! </li></ul><br><p>  Se voc√™ usar as extens√µes Kotlin, n√£o esque√ßa que pode renomear a importa√ß√£o para um nome conveniente: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">import</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">kotlinx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.android</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.synthetic</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.main</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.fr_gifts</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.contentView</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">as</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">recyclerView</span></span></code> </pre> <br><h3 id="chto-dalshe">  O que vem a seguir? </h3><br><p>  Quando comecei a trabalhar nesse mecanismo, n√£o pensei no que seria uma biblioteca.  Mas aconteceu que eu queria compartilhar minha cria√ß√£o, e agora o mais legal est√° me esperando - publicar a biblioteca, coletar problemas, receber feedback, adicionar / melhorar a funcionalidade e corrigir bugs. </p><br><h3 id="poka-ya-pisal-statyu">  Enquanto escrevia um artigo ... </h3><br><p>  Eu consegui organizar tudo na forma de bibliotecas: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ActionViews-ViewModel</a> - para MVVM </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ActionViews-MVP</a> - para MVP </li></ul><br><p>  A biblioteca e o pr√≥prio mecanismo n√£o afirmam ser obrigat√≥rios em seu projeto.  Eu s√≥ queria compartilhar minha ideia, ouvir cr√≠ticas, coment√°rios e melhorar meu mecanismo para que ele se torne mais conveniente, usado e pr√°tico.  Talvez voc√™ possa fazer esse mecanismo melhor do que eu.  Eu ficarei feliz apenas.  Espero sinceramente que meu artigo tenha inspirado voc√™ a criar algo pr√≥prio, talvez at√© semelhante e mais conciso. </p><br><p>  Se voc√™ tiver alguma sugest√£o e recomenda√ß√£o para melhorar a funcionalidade e a opera√ß√£o do pr√≥prio mecanismo, ficarei feliz em ouvi-las.  Bem-vindo aos coment√°rios e, apenas por precau√ß√£o, ao meu telegrama: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@tanchuev</a> </p><br><p>  <strong>PS:</strong> Gostei muito de criar algo √∫til com minhas pr√≥prias m√£os.  Talvez o ActionViews n√£o seja uma demanda, mas a experi√™ncia e o zumbido disso n√£o ser√£o levados a lugar algum. </p><br><p>  <strong>PPS</strong> Para que o ActionViews se transforme em uma biblioteca usada completa, voc√™ precisa coletar feedback e, possivelmente, refinar a funcionalidade ou alterar fundamentalmente a abordagem em si, se tudo der errado. </p><br><p>  <strong>PPPS</strong> Se voc√™ estiver interessado no meu trabalho, poderemos discuti-lo pessoalmente em 28 de setembro em Moscou na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MBLT DEV 2018</a> International Mobile Developers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conference</a> .  A prop√≥sito, os ingressos para madrugadores j√° est√£o acabando! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414773/">https://habr.com/ru/post/pt414773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414761/index.html">5 sites de not√≠cias criativas em ingl√™s</a></li>
<li><a href="../pt414763/index.html">Quatro tipos de erros do gerente de produto que podem (e devem) ser evitados</a></li>
<li><a href="../pt414767/index.html">Implemente o IdM. Quem devo ir para resolver problemas?</a></li>
<li><a href="../pt414769/index.html">Inicie o redirecionamento m√≥vel com o Appsflyer: configura√ß√µes, relat√≥rios e links</a></li>
<li><a href="../pt414771/index.html">DevOps no HightLoad ++ Siberia: desmistificando mitos e discutindo ferramentas</a></li>
<li><a href="../pt414775/index.html">Anatomia da plataforma de hospedagem Huawei FusionServer RUVDS</a></li>
<li><a href="../pt414777/index.html">Entrar nas principais listas de reprodu√ß√£o do Spotify traz compositores dezenas e centenas de milhares de d√≥lares</a></li>
<li><a href="../pt414779/index.html">Vertex Impress Nero review: metal + tela 18: 9 + bateria de 3300 mAh por 6.990 rublos</a></li>
<li><a href="../pt414785/index.html">Visualiza√ß√£o de dados com Angular e D3</a></li>
<li><a href="../pt414787/index.html">Novo Android RAT usa protocolo Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>