<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèß üêè üë®‚Äçüéì Automatisiertes Testmanagement mit Telegramm üë®üèª‚Äçüöí üïµüèæ üåû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als QS-Ingenieur habe ich ein Selbsttestsystem entwickelt. Konnte mit einer Reihe von Problemen konfrontiert: 



- F√ºr jede Art von Test musste ich m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisiertes Testmanagement mit Telegramm</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471364/">  Als QS-Ingenieur habe ich ein Selbsttestsystem entwickelt.  Konnte mit einer Reihe von Problemen konfrontiert: <br><br><ul><li>  F√ºr jede Art von Test musste ich meine eigenen Jobs in CI erstellen und von Hand ausf√ºhren. </li><li>  Die Entwickler weigerten sich, Selbsttestf√§lle auszuf√ºhren. </li><li>  Die Unf√§higkeit, Autotests von √ºberall auf dem Ger√§t auszuf√ºhren. </li><li>  QA manuelle Testingenieure konnten selbst keine Autotests durchf√ºhren. </li></ul><br>  Aus diesem Grund habe ich beschlossen, einen kleinen Prototyp des Bots zu erstellen, um automatisierte Tests durchzuf√ºhren, die die meisten der oben beschriebenen Probleme abdecken. <br><br>  <b>Beschreibung der Idee:</b> <br><br>  Der Benutzer sendet die erforderlichen Befehle an den Chat und startet den Build im CI-System gem√§√ü den in der Konfiguration angegebenen Regeln.  CI f√ºhrt Autotests mit Pytest-Markierungen durch.  Nach der Ausf√ºhrung empf√§ngt das Skript im Test-Repository Informationen zum Erstellungsstatus, sammelt Protokolle und sendet sie im Telegramm-Chat an den Benutzer zur√ºck. <br><a name="habracut"></a><br>  <b>Werkzeuge:</b> <br><br><div class="spoiler">  <b class="spoiler_title">Die Werkzeuge</b> <div class="spoiler_text"><ul><li>  Programmiersprache - Python </li><li>  Test Framework - Pytest </li><li>  HTTP-Client - Anfragen </li><li>  Datenbank - SQLite3 </li><li>  ORM - Peewee </li><li>  CI-System - Travis CI </li></ul><br></div></div><br><br>  <b>Inhalt</b> <br><br><ol><li>  Vorbereitung </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bot Registrierung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorbereiten eines Test-Repositorys</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tests und Protokollierung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Berichterstellung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konfigurieren Sie Travis CI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bot-Setup</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Prinzipien des Bots</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bereitstellung auf Heroku</a> </li></ol><br><a name="1"></a><br><h3>  <b>Bot Registrierung</b> </h3><br>  Zun√§chst m√ºssen wir das Telegramm des Bots registrieren und seine eindeutige ID erhalten, die ein Token ist.  Schreiben Sie dazu die Nachricht / start in den @ BotFather-Bot. <br>  Unser Hauptteam ist / newbot, durch Eingabe geben wir den Namen des Bots ein. <br>  Aber es gibt eine Regel - der Name muss mit bot enden.  BotFather nimmt den Namen des Bots und gibt Ihren Token zur√ºck.  Aktivieren Sie den Bot, indem Sie mit dem Chatten beginnen.  Als N√§chstes m√ºssen Sie eine API-Anforderung an die Methode getUpdates senden. <br><br><pre><code class="python hljs">https://api.telegram.org/bot{_}/getUpdates</code> </pre> <br>  Erinnere dich an die empfangene hat_id. <br><br><a name="2"></a><br><h3>  <b>Vorbereiten eines Test-Repositorys</b> </h3><br>  Als N√§chstes m√ºssen Sie ein Repository mit Tests organisieren oder einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorbereiteten</a> Artikel verwenden. <br><br><a name="3"></a><br>  <i>Tests und Protokollierung</i> <br><br>  Erstellen Sie Testfunktionen und markieren Sie diese mit dem Pytest-Zeichen - voll, Rauch und Vogel. <br><br>  Es ist wichtig, die Protokollierung zu unseren Tests hinzuzuf√ºgen, indem Sie die Datei pytest.ini erstellen und die Aufrufe der Infomethode aus der Protokollierungsbibliothek in den Testfunktionen hinzuf√ºgen. <br>  Die Datei pytest.ini enth√§lt Vorlagen f√ºr Live-Protokolle und eine Protokolldatei. <br><br><div class="spoiler">  <b class="spoiler_title">Testbeispiel</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging @pytest.mark.full @pytest.mark.smoke <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_cat_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"cat"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span> @pytest.mark.full @pytest.mark.smoke <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_dog_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"dog"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span> @pytest.mark.full <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_horse_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"horse"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span> @pytest.mark.bird <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_bird_facts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> query = {<span class="hljs-string"><span class="hljs-string">"animal_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"bird"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>} response = requests.get(<span class="hljs-string"><span class="hljs-string">"https://cat-fact.herokuapp.com/facts/random"</span></span>, params=query) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request url: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.url}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.request.body}</span></span></span><span class="hljs-string">"</span></span>) logging.info(<span class="hljs-string"><span class="hljs-string">f"Request status: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">, body: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.text}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span></code> </pre> <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">pytest.ini</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">[pytest] markers = smoke: for smoking testing full: for regression testing bird: facts only bird log_cli = 1 log_cli_level=INFO log_cli_format = %(asctime)s [%(levelname)8s] %(message)s log_cli_date_format='%Y-%m-%d %H:%M:%S' log_file = test_log.log log_file_level=INFO log_file_format= %(asctime)s [%(levelname)8s] %(message)s log_file_date_format='%Y-%m-%d %H:%M:%S'</code> </pre> <br></div></div><br><br><a name="4"></a><br>  <i>Berichterstellung</i> <br><br>  Wir erstellen ein Skript, das nach Abschluss der Assembly Informationen aus dem CI-System sammelt und diese zusammen mit den Protokollen an den Telegramm-Chat sendet. <br>  Innerhalb des Skripts m√ºssen Sie die Werte TELEGRAM_BOT und CHAT_ID durch die zuvor erhaltenen Werte ersetzen. <br><br><div class="spoiler">  <b class="spoiler_title">Skriptcode</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os TRAVIS_TEST_RESULT = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_TEST_RESULT"</span></span>) TRAVIS_REPO_SLUG = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_REPO_SLUG"</span></span>) TRAVIS_BRANCH = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_BRANCH"</span></span>) TRAVIS_JOB_WEB_URL = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_JOB_WEB_URL"</span></span>) TRAVIS_COMMIT_MESSAGE = os.environ.get(<span class="hljs-string"><span class="hljs-string">"TRAVIS_COMMIT_MESSAGE"</span></span>) TELEGRAM_TOKEN = <span class="hljs-string"><span class="hljs-string">"808619876:GHrtj9zs-KvKhhtWyu1YoxjtIikUYMGVjD8g"</span></span> CHAT_ID = <span class="hljs-string"><span class="hljs-string">"272560060"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> TRAVIS_TEST_RESULT != <span class="hljs-number"><span class="hljs-number">0</span></span>: build_status = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: build_status = <span class="hljs-string"><span class="hljs-string">""</span></span> TEXT = <span class="hljs-string"><span class="hljs-string">f" : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{build_status}</span></span></span><span class="hljs-string"> \n : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_REPO_SLUG}</span></span></span><span class="hljs-string"> \n : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_BRANCH}</span></span></span><span class="hljs-string"> \n Commit : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_COMMIT_MESSAGE}</span></span></span><span class="hljs-string"> \n -: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TRAVIS_JOB_WEB_URL}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> URL = <span class="hljs-string"><span class="hljs-string">f"https://api.telegram.org/bot</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TELEGRAM_TOKEN}</span></span></span><span class="hljs-string">/sendMessage"</span></span> body = {<span class="hljs-string"><span class="hljs-string">'chat_id'</span></span>: CHAT_ID, <span class="hljs-string"><span class="hljs-string">'text'</span></span>: TEXT} response = requests.post(url=URL, json=body) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> URL = <span class="hljs-string"><span class="hljs-string">f"https://api.telegram.org/bot</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{TELEGRAM_TOKEN}</span></span></span><span class="hljs-string">/sendDocument"</span></span> body = {<span class="hljs-string"><span class="hljs-string">'chat_id'</span></span>: CHAT_ID} file = {<span class="hljs-string"><span class="hljs-string">"document"</span></span>: open(<span class="hljs-string"><span class="hljs-string">"test_log.log"</span></span>)} response = requests.post(url=URL, data=body, files=file) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response send_message() send_file()</code> </pre> <br></div></div><br>  Das Skript verwendet Systemvariablen und empf√§ngt Werte von Travis CI. <br><br>  Wenn der Wert von TRAVIS_TEST_RESULT nicht gleich Null ist, wird der Wert auf "Erfolgreich" gesetzt. Zuerst wird die Funktion send_message verarbeitet, die Assembly-Informationen an den Chat sendet (Repository-Name, ausgew√§hlter Zweig, Name des verwendeten Commits, Link zum Webprotokoll) und dann die send_file-Funktion Protokolldatei. <br><br>  F√ºgen Sie im Test-Repository die Konfigurationsdatei travis.yml hinzu.  Im Inneren beschreiben wir die Pipeline, √ºber die die Baugruppe arbeiten wird. <br><br><div class="spoiler">  <b class="spoiler_title">travis.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">language: python python: - "3.7" install: - pip install -r requirements.txt script: pytest -m smoke after_script: - python tg_command.py</code> </pre> <br></div></div><br>  Als N√§chstes m√ºssen wir das Repository auf GitHub bereitstellen, um es Travis CI hinzuzuf√ºgen. <br><br><a name="5"></a><br><h3>  <b>Einstellen von TRAVIS_CI</b> </h3><br>  Wir gehen zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Seite</a> . <br>  Melden Sie sich mit Ihrem GitHub-Konto an.  Wechseln Sie zur Registerkarte Dashboard.  Nachdem Sie zuvor DevTools (Netzwerk) ge√∂ffnet haben, verschieben Sie den Schieberegler auf der Unterregisterkarte Repositorys auf der Site gegen√ºber dem Test-Repository. Aktivieren Sie die Assembly.  Auf der Registerkarte Netzwerk (DevTools) kommt eine aktive Anfrage an, in deren Vorschau Informationen zur ID des Repositorys enthalten sind. Die Nummer muss gespeichert werden (Kopieren / Schreiben).  Wechseln zur Site auf der Registerkarte Einstellungen.  Wir kopieren oder erinnern uns an das Token - wir brauchen es. <br><br><a name="6"></a><br><h3>  <b>Bot-Setup</b> </h3><br>  In diesem Artikel werden wir uns nicht mit der Analyse des Codes befassen, Sie k√∂nnen ihn im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repository sehen</a> .  Jetzt ist es wichtig, dass wir die Grundlagen des Themas verstehen. Fahren wir also mit der Einrichtung unseres Bots fort: <br><br>  Im Repository befinden sich die Dateien: <br><br><ol><li>  main.py - Bot-Skript; </li><li>  models.py - Datei mit Modellen f√ºr ORM; </li><li>  conf.ini - Datei mit Konfigurationsvariablen; </li><li>  runtime.txt - feste Python-Versionswerte f√ºr Travis CI; </li><li>  procfile - Einstellung f√ºr Gunicorn; </li><li>  wsgi.py - Anwendungsstartdatei mit Gunicorn. </li></ol><br>  Damit Ihr Bot funktioniert, m√ºssen Sie die Daten in conf.ini ersetzen, n√§mlich: <br><br><ul><li>  travis_token - zeigt Travis CI das empfangene Token an; </li><li>  travis_base_url - Geben Sie die Adresse der Travis CI-API an. </li><li>  travis_repository_id - Geben Sie die ID des Repositorys mit Autotests in Travis CI an. </li><li>  telegram_chat_id - Geben Sie die Chat-ID des Telegramms an, an das Nachrichten vom Bot gesendet werden sollen. </li><li>  telegram_bot_url - Geben Sie die URL zum Bot an. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Conf.ini Beispiel</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">[travis] travis_token = token HkjhkjgGKJhjgFGfdgd travis_base_url = https://api.travis-ci.org travis_repository_id = 10898384 [telegram] telegram_chat_id = 24234234 telegram_bot_url = https://api.telegram.org/bot87543366:AAHtj9zs-Kv4zGWyu1eTXegikUYMGVjD8g/</code> </pre> <br></div></div><br><a name="7"></a><br>  <i>Die Prinzipien des Bots</i> <br><br>  Es ist wichtig, dass jede Anforderung einen Antwortstatus von 200 aufweist. Andernfalls beginnt das Telegramm, Anforderungen zyklisch zu senden, bis es eine g√ºltige Antwort erh√§lt. <br><br>  Der Bot hat eine Reihe von Befehlen: <br><br>  Das Trennzeichen kann ein beliebiges Sonderzeichen au√üer dem Unterstrich sein. <br><br><ul><li>  add_m - F√ºge ein Testkit hinzu (Python-Markierungen). <br>  Vorlage: * Befehl * {Kitbeschreibung} {Trennzeichen} {Namensmarke}. <br>  Beispiel: add_m V√∂gel / Vogel testen. </li><li>  add_b - F√ºge einen Zweig zum Testen hinzu. <br>  Vorlage: * Befehl * {Beschreibung des Zweigs} {Trennzeichen} {Name des Zweigs von git}. <br>  Beispiel: add_b Master. </li><li>  select - Mit dieser Option k√∂nnen Sie standardm√§√üig einen Zweig zum Testen ausw√§hlen. <br>  Vorlage: * Befehl *. <br>  Beispiel: Nach Eingabe des Befehls select werden Schaltfl√§chen zum Ausw√§hlen von Zweigen angezeigt, die mit dem Befehl add_b zur Datenbank hinzugef√ºgt wurden. </li><li>  run - Der Befehl zum Starten der Assembly. <br>  Vorlage: * Befehl *. <br>  Beispiel: Nach Eingabe des Befehls run werden die Schaltfl√§chen zum Ausw√§hlen der Autotests angezeigt, die mit dem Befehl add_m zur Datenbank hinzugef√ºgt wurden.  Beim Start wird automatisch der durch den Befehl select angegebene Zweig ausgew√§hlt. </li><li>  del_m - Entfernt eine Reihe von Tests. <br>  Vorlage: * Befehl * {Namensmarken}. <br>  Beispiel: del_m Vogel. </li><li>  del_b - l√∂scht die in der Datenbank eingegebenen Zweige. <br>  Vorlage: * Befehl * {Zweig von Git}. <br>  Beispiel: del_b master. </li></ul><br>  <i>Wie funktioniert der Bot?</i> <br><br>  <b>1. Der</b> Benutzer f√ºgt eine Testsuite (add_m) hinzu: <br>  Der Befehl teilt die Benutzerdaten in zwei Teile auf - die Beschreibung und den Namen des Zweigs in git.  Der Name wird in die Spalte mark_name in der Datenbank und die Beschreibung in die Spalte mark_description geschrieben. <br><br>  <b>2. Der</b> Benutzer f√ºgt Zweige hinzu (add_b): <br>  Der Befehl teilt die Benutzerdaten in zwei Teile auf - die Beschreibung und den Namen des Zweigs in git.  Der Name wird in die Spalte branch_name in der Datenbank und die Beschreibung in die Spalte branch_description geschrieben. <br><br>  <b>3. Der</b> Benutzer w√§hlt den Standardzweig aus (ausw√§hlen): <br>  Der Benutzer erh√§lt im Chat Schaltfl√§chen, die sich aus den Daten aus den Tabellen branch_description und branch_name ergeben.  Der Benutzer w√§hlt eine Schaltfl√§che mit dem gew√ºnschten Zweig.  Es wird in die Tabelle favor_branch geschrieben. <br><br>  <b>4. Der</b> Benutzer startet die Build-Initialisierung (Ausf√ºhren): <br>  Der Benutzer erh√§lt im Chat Schaltfl√§chen, die sich nach den Daten aus den Tabellen richten <br>  mark_description und mark_name.  Der Benutzer w√§hlt eine Schaltfl√§che mit einem Kit aus, um Autotests auszuf√ºhren. <br><br>  Basierend auf den vom Benutzer ausgew√§hlten Daten generiert der Bot eine Anforderung in der Triggermethode in der TravisCI-Klasse und sendet sie zur Ausf√ºhrung an Travis.  Innerhalb des Travis-Systems ist der Ausl√∂ser eine Build-Option aktiviert.  Diese Option √ºberschreibt die Datei travis.yml und √§ndert den Skriptabschnitt in vom Benutzer ausgew√§hlte Daten. <br><br><a name="8"></a><br><h3>  <b>Bereitstellung auf HEROKU</b> </h3><br>  Damit der Bot funktioniert, muss er auf dem Hosting bereitgestellt werden.  Ich empfehle die Verwendung von Heroku, da diese Plattform einen kostenlosen Tarif hat, der die notwendige Leistung f√ºr das Funktionieren des Bots bietet. <br><br>  <i>Wie stelle ich einen Bot bereit?</i> <br><br>  Um den gesamten Prozess nicht zu beschreiben, werde ich zun√§chst einen Link zur offiziellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> hinterlassen: <br><br>  Wenn Sie mit Heroku √ºber die GUI arbeiten m√∂chten, geben Sie den Code auf Github ein.  Sie m√ºssen sich √ºber die Heroku-Weboberfl√§che registrieren.  Klicken Sie nach der Registrierung auf Neu -&gt; Neue App erstellen -&gt; Geben Sie den Namen der App ein und w√§hlen Sie eine Region aus.  Wechseln Sie zur Registerkarte Bereitstellen, und w√§hlen Sie die Integration mit Github in der Bereitstellungsmethode aus. <br><br>  Vor uns erscheint ein Block zum Durchsuchen des Repositorys.  Geben Sie den Namen des Repositorys ein und klicken Sie auf die Schaltfl√§che Suchen.  Klicken Sie in den Suchergebnissen neben dem Repository-Namen auf die Schaltfl√§che Verbinden.  W√§hlen Sie im Block Manuelle Bereitstellung den Zweig aus und klicken Sie auf "Bereitstellen". <br><br>  Letzter Moment - Sie m√ºssen Webhooks mithilfe einer GET-Anfrage aktivieren: <br><pre> <code class="python hljs">https://api.telegram.org/bot{id_}/setWebhook?url=https://{_}.herokuapp.com/bot</code> </pre> <br><br>  Der Bot kann verwendet werden.  Wir √ºberpr√ºfen, ob alles f√ºr uns geklappt hat: <br><br><img src="https://cdn1.radikalno.ru/uploads/2019/10/13/7d55521afbcfd87833197fc0a3ad0c82-full.jpg" alt="Bild"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471364/">https://habr.com/ru/post/de471364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471348/index.html">Full-Stack-TypeScript-Apps</a></li>
<li><a href="../de471350/index.html">Reverse Engineering von rauscharmen Operationsverst√§rkern von einem analogen Computer im Jahr 1969</a></li>
<li><a href="../de471352/index.html">Pr√§sentationen in LaTeX schreiben</a></li>
<li><a href="../de471358/index.html">Wie schreibe ich einen intelligenten Vertrag mit Python √ºber Ontologie? Teil 4: Native API</a></li>
<li><a href="../de471360/index.html">Vervielf√§ltigungsmethode. 11 Beispiele aus dem Design von ICE</a></li>
<li><a href="../de471366/index.html">Das EU-Gericht lehnt Cookies standardm√§√üig ab - es sollten keine vorab aktivierten Kontrollk√§stchen vorhanden sein</a></li>
<li><a href="../de471372/index.html">Warum sollten Unternehmen Mitarbeiter-Smartphones verwalten?</a></li>
<li><a href="../de471374/index.html">Wir laden Sie zu NIXMultiConf # 3 in Kharkov ein</a></li>
<li><a href="../de471378/index.html">Wo beginnt die Programmierung?</a></li>
<li><a href="../de471380/index.html">Pentester an der Spitze der Cybersicherheit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>