<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï¥üèº üë®üèæ‚Äçü§ù‚Äçüë®üèΩ üíí Convirtiendo FunC en FunCtional con Haskell: c√≥mo Serokell gan√≥ la competencia Telegram Blockchain üõÄüèæ üå∂Ô∏è ü¶Ñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Probablemente haya escuchado que Telegram lanzar√° la plataforma de cadena de bloques Ton . Pero podr√≠a perderse la noticia de que no hace mucho Telegr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Convirtiendo FunC en FunCtional con Haskell: c√≥mo Serokell gan√≥ la competencia Telegram Blockchain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476756/"><p>  Probablemente haya escuchado que Telegram <a href="https://vc.ru/finance/88457-telegram-predlozhil-investoram-podozhdat-zapuska-ton-do-aprelya-2020-goda-ili-vernut-77-ot-summy-vlozheniy-v-proekt">lanzar√° la plataforma de cadena de bloques Ton</a> .  Pero podr√≠a perderse la noticia de que no hace mucho Telegram <a href="https://habr.com/ru/news/t/468755/">anunci√≥ una competencia</a> para la implementaci√≥n de uno o m√°s contratos inteligentes para esta plataforma. </p><br><p>  El equipo de Serokell con una rica experiencia en el desarrollo de grandes proyectos de blockchain no pudo mantenerse alejado.  Delegamos a cinco empleados al concurso, y dos semanas despu√©s ocuparon el primer lugar bajo el apodo aleatorio (des) modesto Sexy Chameleon.  En este art√≠culo hablar√© sobre c√≥mo tuvieron √©xito.  Esperamos que en los pr√≥ximos diez minutos al menos lea una historia interesante y, como m√°ximo, encuentre algo √∫til que pueda aplicar en su trabajo. </p><br><p>  Pero comencemos con una peque√±a inmersi√≥n en el contexto. </p><a name="habracut"></a><br>
<h2 id="konkurs-i-ego-usloviya">  La competencia y sus condiciones. </h2><br><p>  Por lo tanto, las tareas principales de los participantes fueron la implementaci√≥n de uno o m√°s de los contratos inteligentes propuestos, as√≠ como tambi√©n hacer propuestas para mejorar el ecosistema TON.  La competencia se llev√≥ a cabo del 24 de septiembre al 15 de octubre, y los resultados se anunciaron solo el 15 de noviembre.  Durante mucho tiempo, dado que durante este tiempo Telegram logr√≥ realizar y anunciar los resultados de concursos sobre dise√±o y desarrollo de aplicaciones en C ++ para probar y evaluar la calidad de las llamadas VoIP en Telegram. </p><br><p>  Seleccionamos dos contratos inteligentes de la lista propuesta por los organizadores.  Para uno de ellos, utilizamos herramientas distribuidas con TON, y el segundo lo implementamos en un nuevo lenguaje desarrollado por nuestros ingenieros espec√≠ficamente para TON e integrado en Haskell. </p><br><p>  La elecci√≥n de un lenguaje de programaci√≥n funcional no es accidental.  En nuestro <a href="https://serokell.io/blog">blog corporativo, a</a> menudo hablamos de por qu√© consideramos que la complejidad de los lenguajes funcionales es una gran exageraci√≥n y por qu√© generalmente preferimos que est√©n orientados a objetos.  Por cierto, tambi√©n contiene el <a href="https://serokell.io/blog/ton-blockchain-competition">original de este art√≠culo</a> . </p><br><h2 id="pochemu-my-voobsche-reshili-uchastvovat">  ¬øPor qu√© decidimos participar? </h2><br><p>  En resumen, porque nuestra especializaci√≥n son proyectos complejos y no est√°ndar que requieren habilidades especiales y que a menudo son de valor cient√≠fico para la comunidad de TI.  Apoyamos calurosamente el desarrollo de c√≥digo abierto y participamos en su popularizaci√≥n, as√≠ como cooperamos con las principales universidades de Rusia en el campo de la inform√°tica y las matem√°ticas. </p><br><p>  Las interesantes tareas del concurso y la participaci√≥n en el proyecto Telegram, que tanto amamos, fueron en s√≠ mismas una excelente motivaci√≥n, pero el fondo de premios se convirti√≥ en un incentivo adicional.  :) </p><br><h2 id="issledovanie-blokcheyna-ton">  TON Blockchain Research </h2><br><p>  Monitoreamos de cerca los nuevos desarrollos en la cadena de bloques, la inteligencia artificial y el aprendizaje autom√°tico e intentamos no perder una sola versi√≥n significativa en cada una de las √°reas en las que trabajamos.  Por lo tanto, para cuando comenz√≥ la competencia, nuestro equipo ya estaba familiarizado con las ideas del <a href="https://test.ton.org/ton.pdf">informe t√©cnico</a> de <a href="https://test.ton.org/ton.pdf">TON</a> .  Sin embargo, antes de comenzar a trabajar con TON, no analizamos la documentaci√≥n t√©cnica y el c√≥digo fuente real de la plataforma, por lo que el primer paso fue bastante obvio: un estudio exhaustivo de la documentaci√≥n oficial en el <a href="https://test.ton.org/">sitio web</a> y en <a href="https://github.com/ton-blockchain/ton/tree/master/doc">el repositorio del proyecto</a> . </p><br><p>  Al comienzo del concurso, el c√≥digo ya hab√≠a sido publicado, por lo que para ahorrar tiempo, decidimos buscar una gu√≠a o un apret√≥n escrito por los <em>usuarios</em> .  Desafortunadamente, esto no dio un resultado, aparte de las instrucciones para construir la plataforma en Ubuntu, no encontramos otros materiales. </p><br><p>  La documentaci√≥n en s√≠ se desarroll√≥ a fondo, pero fue dif√≠cil de leer en algunos puntos.  Muy a menudo, tuvimos que volver a ciertos puntos y cambiar de descripciones de alto nivel de ideas abstractas a detalles de implementaci√≥n de bajo nivel. </p><br><p>  Ser√≠a m√°s f√°cil si la especificaci√≥n no tuviera una descripci√≥n detallada de la implementaci√≥n.  La informaci√≥n sobre c√≥mo la m√°quina virtual presenta su stack es m√°s molesta para los desarrolladores que crean contratos inteligentes para la plataforma TON que para ayudarlos. </p><br><h2 id="nix-sobiraem-proekt">  Nix: construyendo un proyecto </h2><br><p>  En Serokell, somos grandes admiradores de <a href="https://nixos.org/nix">Nix</a> .  Recopilamos nuestros proyectos para ellos y los implementamos usando <a href="https://nixos.org/nixops">NixOps</a> , y <a href="https://nixos.org/">NixOS est√°</a> instalado en todos nuestros servidores.  Gracias a esto, todas nuestras compilaciones son reproducibles y funcionan en cualquier sistema operativo en el que se pueda instalar Nix. </p><br><p>  Entonces comenzamos creando <a href="">Nix overlay con una expresi√≥n para construir TON</a> .  Usarlo para compilar TON es lo m√°s simple posible: </p><br><pre><code class="plaintext hljs">$ cd ~/.config/nixpkgs/overlays &amp;&amp; git clone https://github.com/serokell/ton.nix $ cd /path/to/ton/repo &amp;&amp; nix-shell [nix-shell]$ cmakeConfigurePhase &amp;&amp; make</code> </pre> <br><p>  Tenga en cuenta que no necesita instalar ninguna dependencia.  Nix har√° m√°gicamente todo por ti, ya sea que uses NixOS, Ubuntu o macOS. </p><br><h2 id="programmirovanie-dlya-ton">  Programaci√≥n para TON </h2><br><p>  El c√≥digo de contrato inteligente de la red TON se ejecuta en la m√°quina virtual TON (TVM).  TVM es m√°s complicado que la mayor√≠a de las otras m√°quinas virtuales y tiene una funcionalidad muy interesante, por ejemplo, puede funcionar con <em>continuaciones</em> y <em>enlaces a datos</em> . </p><br><p>  Adem√°s, los chicos de TON crearon tres nuevos lenguajes de programaci√≥n: </p><br><p>  <strong>Fift</strong> es un lenguaje de programaci√≥n de pila universal que recuerda a <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D1%2582_(%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)">Forth</a> .  Su s√∫per habilidad es la habilidad de interactuar con TVM. </p><br><p>  <strong>FunC</strong> es un lenguaje de programaci√≥n de contrato inteligente que es similar a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8_(%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)">C</a> y compilado en otro lenguaje: Fift Assembler. </p><br><p>  <strong>Fift Assembler</strong> : biblioteca Fift para generar c√≥digo binario ejecutable para TVM.  Fift Assembler carece de un compilador.  Es un <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA">lenguaje incrustado espec√≠fico del dominio (eDSL)</a> . </p><br><h2 id="nashi-konkursnye-raboty">  Nuestros trabajos competitivos </h2><br><p>  Finalmente, es hora de ver los resultados de nuestros esfuerzos. </p><br><h3 id="asinhronnyy-platezhnyy-kanal">  <strong>Canal de pago asincr√≥nico</strong> </h3><br><p>  Canal de pago: un contrato inteligente que permite a dos usuarios enviar pagos fuera de la cadena de bloques.  Como resultado, no solo se ahorra dinero (no hay comisi√≥n), sino tambi√©n tiempo (no tiene que esperar hasta que se procese el siguiente bloque).  Los pagos pueden ser arbitrariamente peque√±os y ocurrir con la frecuencia que se requiera.  Al mismo tiempo, las partes no necesitan confiar entre s√≠, ya que la equidad del acuerdo final est√° garantizada por un contrato inteligente. </p><br><p>  Encontramos una soluci√≥n bastante simple al problema.  Dos partes pueden intercambiar mensajes firmados, cada uno de los cuales contiene dos n√∫meros: el monto total pagado por cada uno de los participantes.  Estos dos n√∫meros funcionan como <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25BD%25D1%258B%25D0%25B5_%25D1%2587%25D0%25B0%25D1%2581%25D1%258B">relojes de vectores</a> en los sistemas distribuidos tradicionales y establecen el orden "sucedido antes" en las transacciones.  Con estos datos, el contrato podr√° resolver cualquier posible conflicto. </p><br><p>  De hecho, para implementar esta idea, un n√∫mero es suficiente, pero dejamos ambos, ya que pudimos hacer una interfaz de usuario m√°s conveniente.  Adem√°s, decidimos incluir un monto de pago en cada mensaje.  Sin √©l, si el mensaje se pierde por alg√∫n motivo, entonces, aunque todas las cantidades y el c√°lculo final ser√°n correctos, el usuario puede no notar la p√©rdida. </p><br><p>  Para probar nuestra idea, buscamos ejemplos del uso de un protocolo de canal de pago tan simple y conciso.  Sorprendentemente, encontramos solo dos: </p><br><ol><li>  <a href="https://medium.com/%40matthewdif/ethereum-payment-channel-in-50-lines-of-code-a94fad2704bc">Descripci√≥n de un</a> enfoque similar, solo para el caso de un canal unidireccional. </li><li>  <a href="https://programtheblockchain.com/posts/2018/02/23/writing-a-simple-payment-channel/">Un tutorial</a> que describe la misma idea que la nuestra, pero sin explicar muchos detalles importantes, como la correcci√≥n general y el procedimiento para resolver conflictos. </li></ol><br><p>  Qued√≥ claro que tiene sentido describir nuestro protocolo en detalle, prestando especial atenci√≥n a su correcci√≥n.  Despu√©s de varias iteraciones, la especificaci√≥n estaba lista, y ahora usted tambi√©n puede <a href="">verla</a> . </p><br><p>  Implementamos un contrato para FunC, y escribimos la utilidad de l√≠nea de comandos para interactuar con nuestro contrato en Fift, como recomendaron los organizadores.  Podr√≠amos elegir cualquier otro idioma para nuestra CLI, pero fue interesante para nosotros probar Fift para ver c√≥mo se muestra en acci√≥n. </p><br><p>  Honestamente, despu√©s de haber trabajado con Fift, no vimos una buena raz√≥n para preferir este lenguaje a los populares y utilizados activamente con herramientas y bibliotecas desarrolladas.  La programaci√≥n en el lenguaje de pila es bastante desagradable, porque hay que tener en cuenta constantemente lo que est√° en la pila, y el compilador no ayuda. </p><br><p>  Por lo tanto, la √∫nica, en nuestra opini√≥n, la justificaci√≥n de la existencia de Fift es su papel como idioma anfitri√≥n para el ensamblador de Fift.  Pero, ¬øno ser√≠a mejor incrustar el ensamblador de TVM en alg√∫n lenguaje existente y no crear uno nuevo para esto, esencialmente el √∫nico prop√≥sito? </p><br><h3 id="tvm-haskell-edsl">  <strong>TVM Haskell eDSL</strong> </h3><br><p>  Ahora es el momento de hablar sobre nuestro segundo contrato inteligente.  Decidimos desarrollar una billetera con varias firmas, pero escribir otro contrato inteligente en FunC ser√≠a demasiado aburrido.  Quer√≠amos agregar algo de entusiasmo, y se convirti√≥ en nuestro propio lenguaje ensamblador para TVM. </p><br><p>  Al igual que Fift Assembler, nuestro nuevo lenguaje es integrable, pero en lugar de Fift elegimos a Haskell como el host, lo que nos permiti√≥ utilizar completamente su sistema de tipos avanzado.  Cuando se trabaja con contratos inteligentes, donde el precio de incluso un peque√±o error puede ser muy alto, la escritura est√°tica, en nuestra opini√≥n, es una gran ventaja. </p><br><p>  Para demostrar c√≥mo se ve el ensamblador TVM integrado en Haskell, implementamos una billetera est√°ndar.  Aqu√≠ hay algunas cosas a tener en cuenta: </p><br><ul><li>  Este contrato consta de una funci√≥n, pero puede usar tanto como desee.  Cuando define una nueva funci√≥n en el idioma del host (es decir, en Haskell), nuestro eDSL le permite elegir si desea que se convierta en un subprograma separado en TVM o simplemente en el lugar de la llamada. </li><li>  Al igual que Haskell, las funciones tienen tipos que se verifican en tiempo de compilaci√≥n.  En nuestro eDSL, el tipo de entrada de la funci√≥n es el tipo de pila que la funci√≥n espera, y el tipo de resultado es el tipo de pila que se obtendr√° despu√©s de la llamada. </li><li>  El c√≥digo tiene anotaciones de tipo stack que describen el tipo esperado de stack en el dial peer.  En el contrato de billetera original, estos fueron solo comentarios, pero en nuestro eDSL son en realidad parte del c√≥digo y se verifican en el momento de la compilaci√≥n.  Pueden servir como documentaci√≥n o declaraciones que ayudan al desarrollador a encontrar el problema si el tipo de pila cambia a medida que cambia el c√≥digo.  Por supuesto, tales anotaciones no afectan el rendimiento del tiempo de ejecuci√≥n, ya que no se genera ning√∫n c√≥digo TVM para ellas. </li><li>  Este todav√≠a es un prototipo escrito en dos semanas, queda mucho trabajo por hacer en el proyecto.  Por ejemplo, todas las instancias de clase que ve en el c√≥digo a continuaci√≥n deben generarse autom√°ticamente. </li></ul><br><p>  As√≠ es como se ve la implementaci√≥n de billetera multigrado en nuestro eDSL: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">main</span></span> :: <span class="hljs-type"><span class="hljs-type">IO</span></span> () main = putText $ pretty $ declProgram procedures methods <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> procedures = [ (<span class="hljs-string"><span class="hljs-string">"recv_external"</span></span>, decl recvExternal) , (<span class="hljs-string"><span class="hljs-string">"recv_internal"</span></span>, decl recvInternal) ] methods = [ (<span class="hljs-string"><span class="hljs-string">"seqno"</span></span>, declMethod getSeqno) ] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sCnt</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sPubKey</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class"> } instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DecodeSlice</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DecodeSliceFields</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> = [</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class">] decodeFromSliceImpl = do decodeFromSliceImpl @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> decodeFromSliceImpl @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EncodeBuilder</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> where encodeToBuilder = do encodeToBuilder @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> encodeToBuilder @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WalletError</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeqNoMismatch</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SignatureMismatch</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Eq</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ord</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Generic</span></span></span><span class="hljs-class">) instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WalletError</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Enum</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WalletError</span></span></span><span class="hljs-class"> where toEnum 33 = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeqNoMismatch</span></span></span><span class="hljs-class"> toEnum 34 = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SignatureMismatch</span></span></span><span class="hljs-class"> toEnum _ = error "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Uknown</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MultiSigError</span></span></span><span class="hljs-class"> id" fromEnum </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeqNoMismatch</span></span></span><span class="hljs-class"> = 33 fromEnum </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SignatureMismatch</span></span></span><span class="hljs-class"> = 34 recvInternal :: '[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Slice</span></span></span><span class="hljs-class">] :-&gt; '[] recvInternal = drop recvExternal :: '[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Slice</span></span></span><span class="hljs-class">] :-&gt; '[] recvExternal = do decodeFromSlice @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Signature</span></span></span><span class="hljs-class"> dup preloadFromSlice @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> stacktype @[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Slice</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Signature</span></span></span><span class="hljs-class">] </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">-- cnt cs sign pushRoot decodeFromCell @Storage stacktype @[PublicKey, Word32, Word32, Slice, Signature] -- pk cnt' cnt cs sign xcpu @1 @2 stacktype @[Word32, Word32, PublicKey, Word32, Slice, Signature] -- cnt cnt' pk cnt cs sign equalInt &gt;&gt; throwIfNot SeqNoMismatch push @2 sliceHash stacktype @[Hash Slice, PublicKey, Word32, Slice, Signature] -- hash pk cnt cs sign xc2pu @0 @4 @4 stacktype @[PublicKey, Signature, Hash Slice, Word32, Slice, PublicKey] -- pubk sign hash cnt cs pubk chkSignU stacktype @[Bool, Word32, Slice, PublicKey] -- ? cnt cs pubk throwIfNot SignatureMismatch accept swap decodeFromSlice @Word32 nip dup srefs @Word8 pushInt 0 if IsEq then ignore else do decodeFromSlice @Word8 decodeFromSlice @(Cell MessageObject) stacktype @[Slice, Cell MessageObject, Word8, Word32, PublicKey] xchg @2 sendRawMsg stacktype @[Slice, Word32, PublicKey] endS inc encodeToCell @Storage popRoot getSeqno :: '[] :-&gt; '[Word32] getSeqno = do pushRoot cToS preloadFromSlice @Word32</span></span></span></span></code> </pre> <br><p>  El c√≥digo fuente completo de nuestro eDSL y el contrato de billetera con firma m√∫ltiple se pueden encontrar en <a href="https://github.com/serokell/fift-asm-dsl">este repositorio.</a>  Y con m√°s <a href="https://serokell.io/blog/parsing-typed-edsl">detalle,</a> nuestro colega George Agapov <a href="https://serokell.io/blog/parsing-typed-edsl">habl√≥</a> sobre los idiomas incorporados. </p><br><h2 id="vyvody-o-konkurse-i-ton">  Conclusiones sobre la competencia y TON </h2><br><p>  En total, nuestro trabajo tom√≥ 380 horas (junto con el conocimiento de la documentaci√≥n, las reuniones y el desarrollo en s√≠).  Cinco desarrolladores participaron en la competencia: STO, l√≠der del equipo, especialistas en plataformas blockchain y desarrolladores de software Haskell. </p><br><p>  Encontramos los recursos para participar en el concurso sin dificultad, ya que el esp√≠ritu del hackathon, el trabajo en equipo cercano, la necesidad de inmersi√≥n r√°pida en aspectos de las nuevas tecnolog√≠as siempre son emocionantes.  Unas pocas noches de insomnio para lograr los m√°ximos resultados en condiciones de recursos limitados se compensan con una experiencia invaluable y excelentes recuerdos.  Adem√°s, trabajar en tales tareas es siempre una buena prueba de los procesos de la empresa, ya que es extremadamente dif√≠cil lograr resultados verdaderamente decentes sin una interacci√≥n interna excelentemente ajustada. </p><br><p>  Aparte de la letra: nos impresion√≥ la cantidad de trabajo realizado por el equipo de TON.  Se las arreglaron para construir un sistema complejo, hermoso y, lo m√°s importante, de trabajo.  TON demostr√≥ ser una plataforma con gran potencial.  Sin embargo, para que este ecosistema se desarrolle, se necesita hacer mucho m√°s, tanto en t√©rminos de su uso en proyectos de blockchain como en t√©rminos de mejorar las herramientas de desarrollo.  Estamos orgullosos de ser parte de este proceso ahora. </p><br><p>  Si despu√©s de leer este art√≠culo todav√≠a tiene alguna pregunta o idea sobre c√≥mo aplicar TON para resolver sus problemas, <a href="https://serokell.io/">escr√≠banos</a> , estaremos encantados de compartir nuestra experiencia. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/476756/">https://habr.com/ru/post/476756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../476740/index.html">Explore la actividad del cibergrupo del equipo Donot</a></li>
<li><a href="../476742/index.html">C√≥mo cambiamos el estado de "siempre en contacto" para evitar el agotamiento profesional</a></li>
<li><a href="../476748/index.html">tecnolog√≠a aprox .: QATOK</a></li>
<li><a href="../476752/index.html">C√≥mo el futuro panorama de TI ayudar√° a conectar a los consumidores, proveedores de TI y T&D juntos</a></li>
<li><a href="../476754/index.html">C√≥mo enviar una cuenta para usar los servicios de Yandex Maps API a un vecino, o por qu√© un gigante de TI necesita control de calidad</a></li>
<li><a href="../476758/index.html">¬øC√≥mo elegir el filamento de impresi√≥n 3D correcto?</a></li>
<li><a href="../476760/index.html">Algunas palabras sobre los beneficios de leer</a></li>
<li><a href="../476770/index.html">"Oriole 2.0": el tren en el que viajar√° a lo largo del WDC</a></li>
<li><a href="../476772/index.html">DeepPavlov para desarrolladores: configuraci√≥n e implementaci√≥n n. ¬∞ 2</a></li>
<li><a href="../476774/index.html">Playme TAU DVR Review: soporte magn√©tico, barato</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>