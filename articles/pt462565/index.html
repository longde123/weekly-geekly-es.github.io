<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîú üöß üóØÔ∏è Como preparar dados para o SAP Process Mining by Celonis üßîüèΩ üë´ üôéüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Usando dados de um sistema de gerenciamento de servi√ßos de TI (ITSM) como exemplo. 

 Em um artigo anterior sobre o SAP Process Mining ou sobre como e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como preparar dados para o SAP Process Mining by Celonis</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sap/blog/462565/">  Usando dados de um sistema de gerenciamento de servi√ßos de TI (ITSM) como exemplo. <br><br>  Em um artigo anterior sobre o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SAP Process Mining ou sobre como entender nossos processos de neg√≥cios,</a> falamos sobre o Process Mining e sua aplica√ß√£o em um ambiente corporativo.  Hoje queremos falar mais sobre o modelo de dados e o processo de sua prepara√ß√£o.  Examinaremos os componentes, como eles est√£o interconectados, qual formato de dados solicitar dos propriet√°rios dos dados e qual a abordagem para gerar uma tabela de eventos para o SAP Process Mining by Celonis. <br><a name="habracut"></a><br><h3>  Modelo de dados no SAP PROCESS MINING by CELONIS </h3><br>  A estrutura de dados na ferramenta SAP Process Mining by Celonis √© bastante simples: <br><br><ul><li>  "Tabela de eventos".  Esta √© uma parte necess√°ria do modelo de dados.  Essa tabela pode ser apenas uma em cada modelo de dados individual.  Um gr√°fico de processo √© gerado automaticamente nele.  Veja a figura 1. </li><li>  Diret√≥rios s√£o quaisquer outras tabelas que expandem a "tabela de eventos" com informa√ß√µes anal√≠ticas adicionais.  Ao contr√°rio dela, as informa√ß√µes de refer√™ncia n√£o mudam com o tempo.  Mais precisamente, n√£o deve mudar no intervalo de tempo que analisamos.  Por exemplo, pode ser uma tabela com uma descri√ß√£o das propriedades de contratos, itens de compras, pedidos de algo, funcion√°rios, regulamentos, contratados e outros objetos que de alguma forma est√£o envolvidos no processo.  Nesse caso, o diret√≥rio descrever√° todos os tipos de propriedades est√°ticas desses objetos (quantidades, tipos, nomes, nomes, tamanhos, departamentos, endere√ßos e outros tipos de atributos).  Diret√≥rios s√£o opcionais.  Voc√™ pode executar o modelo de dados sem eles.  Simplesmente analisar esse processo ser√° menos interessante. </li></ul><br><img src="https://habrastorage.org/webt/12/_k/_x/12_k_xejzbntkhaiom6fpnpmgge.png" alt="imagem"><br>  <i>Figura 1. Modelo de dados no Proces Mining: uma tabela de eventos e uma refer√™ncia √†s inst√¢ncias do processo</i> <br><br>  Uma tabela de eventos √© uma tabela padr√£o (armazenamento f√≠sico, ao contr√°rio de tabelas l√≥gicas) na plataforma de mem√≥ria do SAP HANA.  Os diret√≥rios podem ser apresentados como tabelas padr√£o (armazenamento f√≠sico) e tabelas de c√°lculo (vistas de c√°lculo).  Com raras exce√ß√µes, pode ser necess√°rio adicionar uma pequena refer√™ncia na forma de CSV ou XLSX ao modelo de dados existente.  Esse recurso existe diretamente na interface gr√°fica. <br><br>  Abaixo, examinaremos mais de perto esses dois componentes do modelo de dados. <br><br>  Uma "tabela de eventos" (tamb√©m conhecida como "log de eventos") cont√©m pelo menos tr√™s colunas obrigat√≥rias: <br><br><ol><li>  Um identificador de processo √© uma chave exclusiva para cada inst√¢ncia do processo (por exemplo, refer√™ncia, incidente ou n√∫mero da tarefa).  No exemplo da Figura 2, esta √© a coluna "CASE_ID". </li><li> Atividade.  Esse √© o nome da etapa do processo - algum tipo de evento no qual estamos interessados.  √â a partir das atividades que o gr√°fico do processo ser√° composto (coluna "EVENTO"). </li><li>  Registro de data e hora do evento (coluna "TIMESTAMP"). </li></ol><br><img src="https://habrastorage.org/webt/sm/sz/pg/smszpglecovhwhmfwaytfpi0wme.png" alt="imagem"><br>  <i>Figura 2. Exemplo de tabela de eventos</i> <br><br>  A vers√£o atual do SAP Process Mining by Celonis suporta at√© 1000 eventos exclusivos em um √∫nico modelo de dados.  Ou seja, o n√∫mero de valores exclusivos na coluna "EVENT" no exemplo acima (na sua tabela de eventos pode ser chamada de forma diferente) n√£o deve ser superior a 1000. E os pr√≥prios eventos (ou seja, as linhas nesta tabela) podem ser bastante.  Vimos exemplos de centenas de milh√µes de eventos em um modelo de dados. <br><br>  Um registro de data e hora pode ser representado por uma coluna e, em seguida, √© sua tarefa determinar o que isso significa - o in√≠cio ou o final de uma etapa ou duas colunas, como na Figura 3, quando o in√≠cio e o final de uma etapa s√£o explicitamente indicados.  A diferen√ßa fundamental entre a vers√£o de duas colunas √© que o sistema poder√° reconhecer automaticamente as etapas executadas em paralelo.  Isso √© visto ao comparar os hor√°rios de in√≠cio e t√©rmino das v√°rias etapas. <br><br><img src="https://habrastorage.org/webt/dc/6s/uv/dc6suvxtb50cenruxd4on-rmva8.png" alt="imagem"><br>  <i>Figura 3. Tabela de eventos de exemplo com dois registros de data e hora</i> <br><br>  Todas as outras colunas nesta tabela s√£o opcionais.  O gr√°fico do processo tamb√©m pode ser restaurado com √™xito usando as tr√™s colunas necess√°rias, mas ser√° dif√≠cil livrar-se da sensa√ß√£o de que algo est√° faltando.  Portanto, √© altamente recomend√°vel que voc√™ n√£o se limite apenas a um conjunto m√≠nimo de alto-falantes. <br><br>  Colunas adicionais s√£o todas as informa√ß√µes que lhe interessam, que s√£o alteradas durante o processo ou est√£o associadas a um evento espec√≠fico.  Por exemplo, o nome do funcion√°rio que fez o evento, o grupo de trabalho, a prioridade atual do aplicativo.  A √™nfase na depend√™ncia do tempo n√£o √© acidental aqui.  √â recomend√°vel que voc√™ deixe apenas dados mut√°veis ‚Äã‚Äãna tabela de eventos.  Todas as outras informa√ß√µes est√°ticas s√£o melhor colocadas em diret√≥rios separados.  Em outras palavras, o log de eventos deve ser normalizado, se poss√≠vel.  Isso √© feito n√£o tanto para reduzir a quantidade de dados, mas para facilitar o trabalho adicional com express√µes PQL no est√°gio de cria√ß√£o de relat√≥rios anal√≠ticos. <br><br>  <i>Deixe tudo estar no lugar</i> <br><br>  O que acontece se voc√™ adicionar uma coluna com informa√ß√µes de refer√™ncia √† "tabela de eventos"?  Em geral, nada de terr√≠vel vai acontecer, pelo menos a princ√≠pio.  E para testes r√°pidos de qualquer ideia, essa op√ß√£o √© bastante adequada.  S√≥ pode haver duas consequ√™ncias negativas: reprodu√ß√£o desnecess√°ria de c√≥pias de dados e dificuldades adicionais em algumas f√≥rmulas anal√≠ticas.  Essas dificuldades poderiam ter sido evitadas se todos os dados adicionais tivessem sido enviados ao diret√≥rio.  Em geral, √© melhor faz√™-lo imediatamente. <br><br>  <i>Um pouco sobre licenciamento</i> <br><br>  A tabela de eventos est√° associada ao licenciamento do SAP Process Mining by Celonis.  Um modelo de dados = 1 licen√ßa = 1 log de eventos.  Com uma certa reserva, podemos dizer que 1 log de eventos = 1 processo de neg√≥cios.  A ressalva ser√° a seguinte: situa√ß√µes podem surgir quando v√°rios processos se encaixam em um log de eventos e vice-versa - v√°rios logs de eventos s√£o criados intencionalmente para um processo.  Al√©m disso, o termo ‚Äúprocesso de neg√≥cios‚Äù pode ser interpretado do ponto de vista dos dados de maneira bastante ampla.  Portanto, para fins de licenciamento, pelo crit√©rio √≥bvio, o n√∫mero de logs de eventos foi selecionado.  √â nesse crit√©rio que se deve confiar. <br><br>  <i>Diret√≥rios</i> <br><br>  Diret√≥rios s√£o opcionais, adicion√°-los ao modelo de dados √© opcional.  Eles cont√™m informa√ß√µes adicionais que podem ser √∫teis para a an√°lise do processo.  Mas, diferentemente da tabela de eventos, as informa√ß√µes nos diret√≥rios s√£o est√°ticas, n√£o dependem da hora em que o evento ocorreu. <br><br>  Um caso em particular deve ser mencionado aqui.  Quando se trata dos dados do usu√°rio executando as etapas do processo de neg√≥cios, surge a pergunta: essa informa√ß√£o √© refer√™ncia?  Por um lado, sim - s√£o dados est√°ticos.  Seria bom deixar na tabela de eventos apenas um determinado "USER_ID", segundo o qual o nome completo, cargo e departamento do usu√°rio, participa√ß√£o no grupo de trabalho etc.  Mas, por outro lado, vamos imaginar que analisamos um processo de neg√≥cios em um per√≠odo de 2 a 3 anos.  Durante esse per√≠odo, o usu√°rio pode alterar v√°rias postagens e alternar entre departamentos ou grupos de trabalho.  Acontece que esta √© uma informa√ß√£o que j√° est√° mudando ao longo do tempo.  E, nesse caso, ele deve ser deixado na tabela de eventos, o que, por sua vez, levar√° ao fato de que, al√©m de "USER_ID" no log de eventos, aparecer√£o colunas como "grupo de trabalho", "posi√ß√£o", "departamento" e at√© mesmo "nome completo" (sobrenome tamb√©m pode mudar durante esse per√≠odo).  Em geral, a quest√£o de normalizar ou n√£o as informa√ß√µes do usu√°rio permanece a crit√©rio do cliente. <br>  Os diret√≥rios podem ser adicionados a um modelo de dados existente a qualquer momento. <br><br>  Para fazer isso √© bastante simples: <br><br><ol><li>  Uma tabela √© criada no SAP HANA. </li><li>  A tabela √© adicionada ao modelo de dados geral usando o bot√£o "Importar dados". <br><br><img src="https://habrastorage.org/webt/-h/dt/un/-hdtunkocklfpgs_m4u1sd6y0ca.png" alt="imagem"><br>  <i>Figura 4. Importar uma tabela ou arquivo para um modelo de dados existente</i> </li><li>  A chave (ou chaves) √© indicada na interface gr√°fica, pela qual o novo diret√≥rio √© associado √† tabela de eventos e / ou a outros diret√≥rios.  Para fazer isso, basta clicar no √≠cone <img src="https://habrastorage.org/webt/m8/mk/8x/m8mk8x955o54qbv_gm2ewx3lx68.png" alt="imagem">  em uma tabela e depois no correspondente <img src="https://habrastorage.org/webt/m8/mk/8x/m8mk8x955o54qbv_gm2ewx3lx68.png" alt="imagem">  em outra mesa. <br><br><img src="https://habrastorage.org/webt/xw/xg/vw/xwxgvwuaonmge2ddo8y0-5jwvx8.png" alt="imagem"><br>  <i>Figura 5. Vinculando tabelas em um modelo de dados por um campo arbitr√°rio (neste caso, CASE_ID)</i> </li><li>  No menu "Status", clique no bot√£o "Recarregar da fonte".  Esse processo geralmente leva alguns segundos. <br><br><img src="https://habrastorage.org/webt/g3/80/78/g38078xq1yrpi9yvthhk336aovo.jpeg" alt="imagem">  <i>Figura 6. Recarregando o modelo de dados da origem</i> </li></ol><br>  Depois de concluir essas etapas, voc√™ pode usar imediatamente novas an√°lises, tanto em novos relat√≥rios quanto em existentes.  O enriquecimento do modelo de dados n√£o prejudica o trabalho atual dos analistas de forma alguma: todos os relat√≥rios criados continuam funcionando, eles n√£o precisam ser refeitos ou alterados de alguma forma. <br><br>  Para diret√≥rios relativamente pequenos, h√° mais uma possibilidade: n√£o uma vers√£o completamente industrial, √© claro, mas tamb√©m pode ser √∫til.  Trata-se de carregar arquivos CSV, XLSX, DBF por meio de uma interface gr√°fica diretamente no modelo de dados.  O procedimento permanece exatamente igual ao descrito acima; somente, em vez das tabelas do banco de dados, √© usado um arquivo preparado previamente, carregado com o bot√£o Importar Dados. <br><br>  <i>Tabela da CA: Refer√™ncia da inst√¢ncia do processo</i> <br><br>  A conversa anterior sobre livros de refer√™ncia come√ßou com o fato de serem opcionais.  Eles podem ser omitidos completamente do modelo de dados e limitados a uma tabela de eventos.  Isso √© quase verdade. <br>  Existe uma refer√™ncia obrigat√≥ria.  Essa deve ser uma tabela marcada com o status "Tabela da CA".  CAs s√£o cadeias de eventos.  E, voc√™ adivinhou, a chave neste diret√≥rio ser√° "CASE_ID" - o identificador exclusivo da inst√¢ncia do processo.  Essa refer√™ncia descreve as propriedades est√°ticas de inst√¢ncias de processos individuais.  Um exemplo do ITSM: o autor da apela√ß√£o, um servi√ßo comercial, a data de fechamento ou o funcion√°rio que resolveu o incidente com sucesso, um sinal de car√°ter em massa etc. <br><br><img src="https://habrastorage.org/webt/7d/lf/-t/7dlf-t9r6snfbvw83qujkd1sfio.png" alt="imagem"><br>  <i>Figura 7. Tabela CA de exemplo</i> <br><br>  E, no entanto, n√£o te enganei muito.  Se, por algum motivo, voc√™ decidir n√£o incluir o diret√≥rio necess√°rio no modelo de dados, o sistema o gerar√°.  O resultado de seu trabalho pode ser visto na guia Status: se sua tabela de eventos for chamada, digamos, "ITSM_EVENTS", a tabela "ITSM_EVENTS_CASES" ser√° gerada em conjunto com ela, como na Figura 8. <br><br><img src="https://habrastorage.org/webt/g3/80/78/g38078xq1yrpi9yvthhk336aovo.jpeg" alt="imagem"><br>  <i>Figura 8. Tabela da cadeia de eventos gerada automaticamente</i> <br><br>  Uma tabela de CA gerada automaticamente ser√° uma descri√ß√£o muito simples das inst√¢ncias do processo: chave, n√∫mero de eventos, dura√ß√£o do processo (como se voc√™ agrupasse uma tabela de eventos por um identificador de processo, calculasse o n√∫mero de linhas e a diferen√ßa entre a hora da primeira e da √∫ltima etapa).  Portanto, faz sentido criar sua pr√≥pria vers√£o mais interessante da tabela da CA.  Ele pode ser adicionado ao modelo de dados a qualquer momento.  Ao mesmo tempo, assim que voc√™ adicionar sua tabela CA ao modelo, o diret√≥rio gerado pelo sistema (no nosso caso, √© "ITSM_EVENTS_CASES") ser√° exclu√≠do automaticamente do modelo de dados. <br><br>  Por que a ‚ÄúTabela CA‚Äù √© interessante?  √â ela quem √© exibida na interface gr√°fica como um detalhe do processo.  Se o analista, enquanto trabalhava com o modelo de dados, encontrou algo interessante no processo e quis ir para exemplos espec√≠ficos individuais, ele usar√° o relat√≥rio "Visualizar CA", ou seja, detalhando.  Depois de abrir esse relat√≥rio, voc√™ encontrar√° nele um diret√≥rio do processo (combinado com uma tabela de eventos, √© claro).  Portanto, adicione √† "Tabela CA" tudo o que o analista pode usar para entender as propriedades do processo e as condi√ß√µes de seu curso. <br><br><img src="https://habrastorage.org/webt/zv/_i/xb/zv_ixbz0ebqsvjugcoqrwxtxtzi.png" alt="imagem"><br><img src="https://habrastorage.org/webt/jq/ga/zu/jqgazus0ddp1ab-nad7pf9xsek4.png" alt="imagem"><br>  <i>Figura 9. Relat√≥rio de exemplo sint√©tico ‚ÄúView CA‚Äù</i> <br><br>  Como adicionar sua refer√™ncia de processo ao modelo de dados: <br><br><ol><li>  Uma tabela √© criada no SAP HANA. </li><li>  A tabela √© adicionada ao modelo de dados geral usando o bot√£o "Importar dados". </li><li>  Na interface gr√°fica, nas propriedades da tabela, voc√™ precisa definir a fun√ß√£o "Tabela com CA". <br><br><img src="https://habrastorage.org/webt/mx/u-/q3/mxu-q36e_tfs0bdgj19yq82vld4.png" alt="imagem"><br>  <i>Figura 10. A fun√ß√£o de "Tabela com CA" para indicar o diret√≥rio de inst√¢ncias do processo</i> </li><li>  Na GUI, associe a tabela CA √† tabela de eventos pelo ID do processo.  Esta etapa √© executada da mesma maneira que no caso de um diret√≥rio regular - com a tecla do s√≠mbolo de chave ( <img src="https://habrastorage.org/webt/m8/mk/8x/m8mk8x955o54qbv_gm2ewx3lx68.png" alt="imagem">  ) oposto ao campo correspondente. </li><li>  No menu "Status", clique no bot√£o "Recarregar da fonte". </li></ol><br>  <b>Nota importante: a</b> coluna ‚ÄúCASE_ID‚Äù (em cada caso, pode ser chamada de outra forma) na tabela CA, que cont√©m o identificador do processo e √© usada para associar √† tabela de eventos, deve conter apenas valores exclusivos.  Isso √© bastante l√≥gico.  E se, por algum motivo, n√£o for assim, ao carregar o modelo de dados na etapa (5), o erro correspondente ser√° gerado (sobre a impossibilidade de executar a opera√ß√£o "JOIN" na tabela de eventos e na tabela CA). <br><br><h3>  Criando um modelo de dados a partir do hist√≥rico de altera√ß√µes </h3><br>  Na pr√°tica, encontramos fontes de dados muito diferentes para a Minera√ß√£o de Processos.  Sua composi√ß√£o √© determinada pelo processo de neg√≥cios selecionado e pelos padr√µes adotados pelo cliente. <br>  Um dos casos mais comuns s√£o os dados do sistema de gerenciamento de servi√ßos de TI (ITSM, IT Service Management), por isso decidimos analisar este exemplo primeiro.  De fato, n√£o h√° uma liga√ß√£o restrita especificamente ao ITSM nessa abordagem.  Pode ser aplicado em outros processos de neg√≥cios, nos quais a fonte de dados √© um hist√≥rico de altera√ß√µes ou um log de auditoria. <br><br>  <i>O que perguntar da TI?</i> <br><br>  Se voc√™ n√£o √© um funcion√°rio de TI ou o especialista que presta servi√ßos de base ao ITSM, esteja preparado para o fato de ser solicitado a formular uma resposta exata para a pergunta "o que voc√™ descarrega?"  ou "o que voc√™ quer de n√≥s?" <br><br>  E isso nem sempre √© conhecido - o que exatamente √© necess√°rio.  A an√°lise do processo de neg√≥cios √© um estudo, uma pesquisa de padr√µes e a busca por "insights".  Se soub√©ssemos antecipadamente que tipo de ‚Äúinsight‚Äù estamos procurando, ent√£o esse n√£o seria mais um ‚Äúinsight‚Äù.  Na verdade, eu gostaria de obter "tudo": atributos, relacionamentos, mudan√ßas.  Mas, como mostra a pr√°tica, nunca foi poss√≠vel obter uma boa resposta precisa a uma pergunta muito geral. <br><br>  Existem duas respostas poss√≠veis para a pergunta "o que voc√™ descarrega". <br><br>  A op√ß√£o est√° errada: pe√ßa √† base para descarregar todas as altera√ß√µes nos status do aplicativo, al√©m de um conjunto de atributos √≥bvios (por exemplo, prioridade, artista, grupo de trabalho etc.).  Em primeiro lugar, voc√™ recebe um conjunto limitado de analistas: voc√™ j√° sabe o que medir√° no processo (√© da√≠ que veio o conjunto de atributos); portanto, a Process Mining se tornar√° uma ferramenta para calcular o KPI do processo (√© muito conveniente, devo dizer, uma ferramenta; mas ainda quero mais). <br><br>  Em segundo lugar, cada departamento de TI individual interpreta de maneira diferente a solicita√ß√£o para adicionar atributos de solicita√ß√£o adicionais ao upload.  Por exemplo, tenha prioridade: ele pode mudar durante o trabalho em uma chamada.  O recurso √© registrado com uma prioridade; o especialista do grupo de trabalho o altera e fecha com um status diferente.  E agora a pergunta √©: na descarga solicitada por voc√™, que momento corresponde √† prioridade?  Inicialmente, parece que o valor da prioridade deve corresponder √† coluna "Data e hora do evento".  Mas, na realidade, muitas vezes acontece que apenas o status da solicita√ß√£o corresponde √† data e hora especificadas e todas as outras colunas s√£o os valores no momento do descarregamento ou no momento do fechamento da solicita√ß√£o.  E voc√™ n√£o saber√° sobre isso de uma s√≥ vez. <br><br>  Parece-me que existe uma op√ß√£o melhor.  Voc√™ pode solicitar dados no formato da tabela a seguir: <br><br><ol><li>  O n√∫mero da apela√ß√£o, incidente, tarefa (SD *, IM *, RT *, ...) √© o identificador do objeto no sistema ITSM (NVARCHAR) </li><li>  Registro de data e hora (TIMESTAMP) </li><li>  Nome do atributo (NVARCHAR) </li><li>  Valor antigo (NVARCHAR) </li><li>  Novo valor (NVARCHAR) </li><li>  Quem mudou (NVARCHAR) </li></ol><br>  De fato, isso nada mais √© do que um hist√≥rico de altera√ß√µes em quaisquer atributos.  Nas interfaces dos sistemas ITSM, voc√™ pode ver essa tabela nas guias com o nome "Hist√≥rico" ou "Di√°rio". <br><br>  As vantagens dessa abordagem s√£o √≥bvias: <br><br><ol><li>  Formato de upload simples e claro.  Ele conhece os profissionais de TI na interface gr√°fica do pr√≥prio sistema.  N√£o deve causar perguntas a partir da base. </li><li>  N√≥s obtemos uma lista de todos os atributos poss√≠veis com todos os valores poss√≠veis.  Sim, haver√° muitos deles, provavelmente v√°rias centenas.  Mas filtrar o desnecess√°rio e o desinteressante √© muito simples, mas sempre que solicitar descarregamentos adicionais nem sempre √© simples e sempre longo (especialmente quando voc√™ n√£o sabe quais atributos est√£o presentes no sistema). </li><li>  Este √© um modelo de dados confi√°vel.  √â dif√≠cil estrag√°-lo, a menos que voc√™ fa√ßa informa√ß√µes falsas intencionalmente. </li><li>  Sabemos exatamente o que cada atributo tinha a cada momento no tempo.  Isso √© importante porque testamos a n√≥s mesmos e garantimos que o modelo esteja correto.  E durante a an√°lise, podemos adicionar etapas intermedi√°rias ao modelo ("ampliar") e determinar os valores de atributo corretos em todos os pontos adicionais no tempo. </li></ol><br>  As desvantagens da segunda op√ß√£o tamb√©m s√£o claras.  E eles, ao que me parece, podem ser resolvidos (em oposi√ß√£o ao problema de dados incompletos): <br><br><ol><li>  O script SQL para preparar os dados se torna um pouco mais complicado - comparado √† op√ß√£o quando a equipe de base de TI faz a prepara√ß√£o parcial dos dados para voc√™ (consulte a primeira vers√£o da consulta acima), sem suspeitar disso.  Sim, ele (o roteiro) √© mais complicado, mas ele est√° sozinho.  Eu acho que seria uma m√° id√©ia compartilhar a prepara√ß√£o de dados entre a equipe de ITSM e a equipe de Minera√ß√£o de Processos.  Idealmente, toda a transforma√ß√£o deve ser transferida para a equipe do Process Mining, para que eles entendam exatamente o que est√° acontecendo com os dados e para minimizar a interfer√™ncia com os dados no lado da fonte.  Um formato simples de troca de dados ajuda a atingir esse objetivo. </li><li>  O volume de descarga √© grande.  O pedido pode ser o seguinte: 10 a 30 GB / ano para uma grande empresa.  Mas carregar esse volume no HANA n√£o √© um problema e nem sequer √© considerado uma tarefa.  Al√©m disso, falamos sobre "upload" apenas durante o projeto piloto, enquanto a integra√ß√£o ETL / ELT entre a fonte de dados e o HANA (por exemplo, HANA Smart Data Integration) ser√° usada na opera√ß√£o industrial, e esse item deixar√° de ser importante. </li></ol><br>  Eu n√£o gostaria de dizer que esta √© a √∫nica maneira correta de obter dados do sistema ITSM para tarefas de Minera√ß√£o de Processos.  Mas, atualmente, estou inclinado a acreditar que este √© o formato mais conveniente para esta tarefa.  Provavelmente existem abordagens muito mais interessantes, e ficarei muito feliz em discutir id√©ias alternativas, se voc√™ as compartilhar comigo. <br><br><h3>  Gera√ß√£o de tabela de eventos </h3><br>  Portanto, na sa√≠da, temos um hist√≥rico de altera√ß√µes nos atributos de solicita√ß√µes, incidentes, chamadas, tarefas e outros objetos ITSM.  A partir dessa tabela, √© poss√≠vel gerar os dois principais componentes do modelo de dados do Process Mining: uma tabela de eventos e uma tabela de CA. <br><br>  Para gerar eventos com base no hist√≥rico de altera√ß√µes, fa√ßa o seguinte: <br><br><ol><li>  No hist√≥rico de altera√ß√µes, colete todos os valores exclusivos da coluna (condicionalmente) "nome do atributo". </li><li>  Determine a mudan√ßa nos atributos que voc√™ gostaria de ver no gr√°fico do processo.  O que √© um "evento" para n√≥s? </li><li>  Crie uma exibi√ß√£o de c√°lculo apropriada ou escreva um script SQL que filtre as linhas selecionadas do hist√≥rico de altera√ß√µes e gere uma tabela de eventos. </li></ol><br>  Suponha que a tabela de altera√ß√µes seja a seguinte: <br><br><pre><code class="plaintext hljs">CREATE COLUMN TABLE "SAP_PM"."ITSM_HISTORY" ( "CASE_ID" NVARCHAR(256), "ATTRIBUTE" NVARCHAR(256), "VALUE_OLD" NVARCHAR(1024), "VALUE_NEW" NVARCHAR(1024), "TS" TIMESTAMP, "USER" NVARCHAR(256) );</code> </pre> <br>  Primeiro, veja a lista de todos os atributos presentes.  Isso pode ser feito no menu "Abrir visualiza√ß√£o de dados" ou com uma simples consulta SQL como esta: <br><br><pre> <code class="plaintext hljs">SELECT DISTINCT "ATTRIBUTE" FROM "SAP_PM"."ITSM_HISTORY";</code> </pre> <br><img src="https://habrastorage.org/webt/cg/vy/cz/cgvyczucqvufw0twxxeuvsn9izq.png" alt="imagem"><br>  <i>Figura 11. Menu de contexto com o comando Open Data Preview no SAP HANA Studio</i> <br><br>  Em seguida, determinamos a composi√ß√£o dos atributos, cuja mudan√ßa √© para n√≥s um evento no processo.  Aqui est√° uma lista de candidatos √≥bvios para essa lista: <br><br><ul><li>  Status </li><li>  Foi levado para o trabalho </li><li>  Categoria foi alterada </li><li>  Prazo violado </li><li>  O tempo de rea√ß√£o √© violado </li><li>  A solicita√ß√£o foi retornada para revis√£o. </li><li>  Erro na 1¬™ linha </li><li>  Grupo de trabalho </li><li>  Prioridade </li></ul><br>  Os principais eventos aqui, √© claro, s√£o as transi√ß√µes entre os status da apela√ß√£o / incidente \ aplicativo \ tarefa.  O valor do atributo "Status" (VALUE_NEW) ser√° o nome da etapa do processo para n√≥s.  Por conseguinte, a cria√ß√£o de uma tabela de eventos como primeira aproxima√ß√£o pode ser assim: <br><br><pre> <code class="plaintext hljs">CREATE COLUMN TABLE "SAP_PM"."ITSM_EVENTS" ( "CASE_ID" NVARCHAR(256) ,"EVENT" NVARCHAR(1024) ,"TS" TIMESTAMP ,"USER" NVARCHAR(256) ,"VALUE_OLD" NVARCHAR(1024) ,"VALUE_NEW" NVARCHAR(1024) ); INSERT INTO "SAP_PM"."ITSM_EVENTS" SELECT "CASE_ID" ,"VALUE_NEW" AS "EVENT" ,"TS" ,"USER" ,"VALUE_OLD" ,"VALUE_NEW" FROM "SAP_PM"."ITSM_HISTORY" WHERE "ATTRIBUTE" = '' ;</code> </pre> <br>  Alterar o restante dos atributos s√£o nossas etapas adicionais que tornam a pesquisa do processo ainda mais interessante.  Sua composi√ß√£o √© determinada pela solicita√ß√£o de um analista de neg√≥cios e pode mudar √† medida que a pr√°tica da Process Mining na empresa se desenvolve. <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_EVENTS" SELECT "CASE_ID" ,"ATTRIBUTE" AS "EVENT" ,"TS" ,"USER" ,"VALUE_OLD" ,"VALUE_NEW" FROM "SAP_PM"."ITSM_HISTORY" WHERE "VALUE_OLD" IS NOT NULL AND "ATTRIBUTE" IN ( '   ' ,'  ' ,'  ' ,'  ' ,'    ' ,' 1- ' ,' ' ,'') );</code> </pre> <br>  Expandindo a lista de atributos no filtro WHERE "ATTRIBUTE" IN (.....), voc√™ aumenta a variedade de etapas exibidas no gr√°fico do processo.  Vale a pena notar que uma grande variedade de etapas nem sempre √© uma b√™n√ß√£o.  √Äs vezes, detalhes muito detalhados dificultam a compreens√£o do processo.  Penso que ap√≥s a primeira itera√ß√£o, voc√™ determinar√° quais etapas s√£o necess√°rias e quais devem ser exclu√≠das do modelo de dados (e a liberdade de tomar essas decis√µes e se adaptar rapidamente a elas √© outro argumento a favor da transfer√™ncia do trabalho de transforma√ß√£o de dados para o lado da equipe do Process Mining) . <br><br>  O filtro "VALUE_OLD" N√ÉO √â NULL, provavelmente voc√™ o substituir√° por algo mais adequado √†s suas condi√ß√µes e aos atributos selecionados.  Vou tentar explicar o significado desse filtro.  Em algumas implementa√ß√µes populares de sistemas ITSM, no momento do registro (abertura) de uma apela√ß√£o, s√£o inseridas no di√°rio informa√ß√µes sobre a inicializa√ß√£o de todos os atributos do objeto.  Ou seja, todos os campos s√£o marcados com alguns valores padr√£o.  Nesse momento, VALUE_NEW conter√° o mesmo valor de inicializa√ß√£o e VALUE_OLD n√£o conter√° nada - afinal, n√£o havia hist√≥rico at√© o momento.  N√≥s absolutamente n√£o precisamos desses registros no processo.  Eles devem ser removidos com um filtro apropriado √†s suas condi√ß√µes espec√≠ficas.  Esse filtro pode ser: <br><br><ul><li>  "VALUE_OLD" N√ÉO √â NULL </li><li>  "VALUE_NEW" = 'sim' </li><li>  Voc√™ pode se concentrar no carimbo de data / hora (fa√ßa apenas os eventos que ocorreram ap√≥s o registro do objeto). </li><li>  Voc√™ pode se concentrar no campo "USU√ÅRIO" se a conta do sistema estiver inicializando. </li><li>  Quaisquer outras condi√ß√µes apresentadas. </li></ul><br><h3>  Gera√ß√£o de tabela CA </h3><br>  O mesmo hist√≥rico de altera√ß√µes que nos serviu como fonte de eventos tamb√©m ser√° √∫til para criar um diret√≥rio de inst√¢ncias de processo (Tabelas da CA).  Algoritmo semelhante: <br><br>  1. Defina uma lista de atributos que: <br><br>  a.  N√£o altere durante o trabalho no aplicativo, por exemplo, o autor do recurso e seu departamento, a classifica√ß√£o do usu√°rio com base nos resultados do trabalho, a bandeira da viola√ß√£o do prazo. <br><br>  b.  Eles podem mudar, mas estamos interessados ‚Äã‚Äãapenas nos valores em determinados momentos: no momento do registro, fechamento, contrata√ß√£o, transfer√™ncia da 2¬™ linha para a 1¬™, etc. <br><br>  c.  Eles podem mudar, mas estamos interessados ‚Äã‚Äãapenas em valores agregados (m√°ximo, m√≠nimo, quantidade etc.) <br><br>  2. Crie uma tabela diagonal com o conjunto de colunas desejado.  Cada atributo que nos interessa gerar√° seu pr√≥prio conjunto de linhas (de acordo com o n√∫mero de inst√¢ncias do processo), nas quais apenas uma coluna ter√° um valor e todo o restante ficar√° vazio (NULL). <br><br>  3. Recolhemos a tabela diagonal no diret√≥rio final usando o agrupamento por identificador de processo. <br><br>  Exemplos de atributos que faz sentido colocar na tabela da CA (na pr√°tica, esta lista pode ser muito mais longa): <br><br><ul><li>  Servi√ßo </li><li>  Sistema de TI </li><li>  O autor </li><li>  Organiza√ß√£o do autor </li><li>  Classifica√ß√£o do usu√°rio da qualidade da solu√ß√£o </li><li>  N√∫mero de retornos ao trabalho </li><li>  Quando foi levado para o trabalho </li><li>  Criado por </li><li>  Quem fechou </li><li>  Resolvido pela linha 1 </li><li>  Classifica√ß√£o / roteamento inv√°lido </li><li>  Prazo </li><li>  Viola√ß√£o de prazo </li></ul><br>  Um e o mesmo atributo pode ser uma fonte de um evento em um processo ou uma propriedade de uma inst√¢ncia de processo.  Por exemplo, o atributo "Prioridade".  Por um lado, estamos interessados ‚Äã‚Äãem sua import√¢ncia no momento do registro do recurso e, por outro lado, todos os fatos de altera√ß√µes nesse atributo podem ser submetidos ao gr√°fico do processo como etapas independentes. <br><br>  Outro exemplo √© o prazo.  Essa √© uma propriedade de refer√™ncia √≥bvia do processo, mas voc√™ pode fazer uma etapa virtual no gr√°fico do processo: uma opera√ß√£o como o "Prazo final" n√£o existe no processo, mas se adicionarmos a entrada correspondente √† Tabela de Eventos, a criaremos artificialmente e poderemos visualizar o local em rela√ß√£o a tempo de execu√ß√£o de outras etapas diretamente no gr√°fico do processo.  Isso √© conveniente para an√°lise r√°pida. <br><br>  Em geral, quando criamos propriedades do processo com base no hist√≥rico de altera√ß√µes de atributos, a fonte de informa√ß√µes √∫teis para n√≥s pode ser: <br><br><ul><li>  Valor do atributo em si (exemplo: "Classifica√ß√£o do usu√°rio") </li><li>  Usu√°rio que mudou </li><li>  Mudar tempo </li><li>  O hor√°rio em que o atributo assumiu um determinado valor (exemplo: o atributo "Prazo violado" n√£o est√° interessado no pr√≥prio valor do atributo, mas no momento em que ele muda para o equivalente da bandeira levantada - por exemplo, 'yes' ou 1) </li><li>  O fato de o atributo estar presente no hist√≥rico (exemplo: ‚ÄúIncidente em massa‚Äù com o valor 'yes') </li></ul><br>  Esta lista, √© claro, pode ser continuada com outras id√©ias para o uso de atributos e tudo o que est√° relacionado a eles. <br><br>  Agora que j√° decidimos a lista de propriedades de interesse, vejamos um dos cen√°rios poss√≠veis para gerar a tabela de CA.  Primeiro, crie a pr√≥pria tabela com o conjunto de colunas que definimos acima para n√≥s mesmos: <br><br><pre> <code class="plaintext hljs">CREATE COLUMN TABLE "SAP_PM"."ITSM_CASES" ( "CASE_ID" NVARCHAR(256) NOT NULL ,"CATEGORY" NVARCHAR(256) DEFAULT NULL ,"AUTHOR" NVARCHAR(256) DEFAULT NULL ,"RESOLVER" NVARCHAR(256) DEFAULT NULL ,"RAITING" INTEGER DEFAULT NULL ,"OPEN_TIME" TIMESTAMP DEFAULT NULL ,"START_TIME" TIMESTAMP DEFAULT NULL ,"DEADLINE" TIMESTAMP DEFAULT NULL );</code> </pre> <br>  Tamb√©m precisaremos de uma tabela tempor√°ria ‚ÄúITSM_CASES_STAGING‚Äù, que nos permitir√° classificar uma lista simples de atributos para as colunas de propriedades necess√°rias no diret√≥rio de inst√¢ncias do processo: <br><br><pre> <code class="plaintext hljs">CREATE COLUMN TABLE "SAP_PM"."ITSM_CASES_STAGING" LIKE "SAP_PM"."ITSM_CASES" WITH NO DATA;</code> </pre> <br>  Essa ser√° uma tabela diagonal - em cada linha, apenas dois campos t√™m um valor: "CASE_ID", ou seja,  identificador de processo e um √∫nico campo com uma propriedade de processo.  Os campos restantes na linha estar√£o vazios (NULL).  No est√°gio final, recolhemos facilmente as diagonais em linhas por agrega√ß√£o simples e, assim, obtemos a tabela de CAs necess√°rias. <br><br>  Um exemplo para uma categoria de tratamento: <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "CATEGORY") SELECT "CASE_ID", LAST_VALUE("VALUE_NEW" ORDER BY "TS") FROM "SAP_PM"."ITSM_HISTORY" WHERE "ATTRIBUTE" = '' GROUP BY "CASE_ID" ;</code> </pre> <br>  Suponha que o autor seja o primeiro usu√°rio que n√£o seja do sistema no hist√≥rico do recurso que registra recursos (no seu caso particular, o crit√©rio pode ser mais preciso): <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "AUTHOR") SELECT "CASE_ID", FIRST_VALUE("USER" ORDER BY "TS") FROM "SAP_PM"."ITSM_HISTORY" WHERE "USER" != 'SYSTEM' GROUP BY "CASE_ID" ;</code> </pre> <br>  Se acreditarmos que o manipulador que colocou o √∫ltimo status "Solu√ß√£o proposta" (e a solu√ß√£o pudesse ser oferecida repetidamente, mas apenas a √∫ltima foi corrigida) resolveu o problema com √™xito, essa propriedade da inst√¢ncia do processo pode ser formulada da seguinte maneira: <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "RESOLVER") SELECT "CASE_ID", LAST_VALUE("USER" ORDER BY "TS") FROM "SAP_PM"."ITSM_HISTORY" WHERE "ATTRIBUTE" = '' AND "VALUE_NEW" = ' ' GROUP BY "CASE_ID" ;</code> </pre> <br>  Classifica√ß√£o do usu√°rio (sua satisfa√ß√£o com a decis√£o): <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "RAITING") SELECT "CASE_ID", TO_INTEGER(LAST_VALUE("VALUE_NEW" ORDER BY "TS")) FROM "SAP_PM"."ITSM_HISTORY" WHERE "ATTRIBUTE" = ' ' AND "VALUE_NEW" IS NOT NULL GROUP BY "CASE_ID" ;</code> </pre> <br>  O momento do registro (cria√ß√£o) √© simplesmente o registro mais antigo da hist√≥ria da circula√ß√£o: <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "OPEN_TIME") SELECT "CASE_ID", MIN("TS") FROM "SAP_PM"."ITSM_HISTORY" GROUP BY "CASE_ID" ;</code> </pre> <br>  O tempo de rea√ß√£o √© uma caracter√≠stica importante da qualidade dos servi√ßos.  Para calcul√°-lo, voc√™ precisa saber quando a bandeira "Foi levada ao trabalho" foi levantada pela primeira vez: <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "START_TIME") SELECT "CASE_ID", MIN("TS") FROM "SAP_PM"."ITSM_HISTORY" WHERE "ATTRIBUTE" = '   ' AND 'VALUE_NEW' = '' GROUP BY "CASE_ID" ;</code> </pre> <br>  O prazo √© usado para calcular KPIs para respostas oportunas a recursos ou resolu√ß√£o de incidentes.  No processo, o prazo pode mudar repetidamente.  Para calcular KPIs, precisamos conhecer a vers√£o mais recente desse atributo.  Se quisermos controlar explicitamente como o prazo mudou, ou seja, para exibir esses casos no gr√°fico do processo, tamb√©m devemos usar esse atributo para gerar uma entrada na tabela de eventos.  Este √© um exemplo de atributo, que serve simultaneamente como uma propriedade do processo e a fonte do evento. <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES_STAGING" ("CASE_ID", "DEADLINE") SELECT "CASE_ID", MAX(TO_DATE("VALUE_NEW")) FROM "SAP_PM"."ITSM_HISTORY" WHERE "ATTRIBUTE" = ' ' AND 'VALUE_NEW' IS NOT NULL GROUP BY "CASE_ID" ;</code> </pre> <br>  Todos os exemplos acima s√£o do mesmo tipo.  Por analogia com eles, a tabela CA pode ser expandida com quaisquer atributos que lhe interessam.  Al√©m disso, isso j√° pode ser feito ap√≥s o in√≠cio do projeto, o sistema permite expandir o modelo de dados durante sua opera√ß√£o. <br><br>  Quando nossa tabela diagonal tempor√°ria √© preenchida com as propriedades das inst√¢ncias do processo, tudo o que resta √© fazer a agrega√ß√£o e obter a tabela CA final: <br><br><pre> <code class="plaintext hljs">INSERT INTO "SAP_PM"."ITSM_CASES" SELECT "CASE_ID" ,MAX("CATEGORY") ,MAX("AUTHOR") ,MAX("RESOLVER") ,MAX("RAITING") ,MAX("OPEN_TIME") ,MAX("START_TIME") ,MAX("DEADLINE") FROM "SAP_PM"."ITSM_CASES_STAGING" GROUP BY "CASE_ID" ;</code> </pre> <br>  Depois disso, n√£o precisamos mais dos dados na tabela tempor√°ria.  A tabela em si pode ser deixada para continuar repetindo o processo acima regularmente para atualizar o modelo de dados no Process Mining: <br><br><pre> <code class="plaintext hljs">DELETE FROM "SAP_PM"."ITSM_CASES_STAGING";</code> </pre> <br><h3>  Dicas para preparar e limpar arquivos CSV para um projeto piloto </h3><br>  Voc√™ provavelmente come√ßar√° a conhecer a disciplina Process Mining com um projeto piloto.  Nesse caso, n√£o √© poss√≠vel obter acesso direto √† fonte de dados; os funcion√°rios de TI e os respons√°veis ‚Äã‚Äãpela seguran√ßa da informa√ß√£o resistir√£o a isso.  Isso significa que, como parte do projeto piloto, teremos que trabalhar com a exporta√ß√£o de dados de sistemas corporativos para arquivos CSV e depois import√°-los para o SAP HANA para criar um modelo de dados. <br><br>  Em uma instala√ß√£o industrial, n√£o haver√° exporta√ß√µes para CSV.  Em vez disso, ser√£o utilizadas as ferramentas de integra√ß√£o do SAP HANA, em particular: SDI (Smart Data Integration), SDA (Smart Data Access) ou SLT (SLT).  Por√©m, para testar e familiarizar-se com a tecnologia, exportar para arquivos de texto CSV √© um m√©todo organizacional mais simples.  Portanto, ser√° √∫til compartilhar com voc√™ algumas dicas para preparar dados em CSV para importa√ß√£o r√°pida e bem-sucedida no banco de dados. <br><br>  Requisitos de formato recomendados para o pr√≥prio arquivo ao exportar: <br><br><ol><li>  Formato de arquivo: CSV </li><li>  Codifica√ß√£o: UTF8 </li><li>  Separador de campo: qualquer caractere conveniente para voc√™.  Por exemplo, "|"  ou "^" ou "~".  A l√≥gica da escolha √© simples - devemos tentar evitar a situa√ß√£o em que a ‚Äúdivis√£o‚Äù est√° contida nos pr√≥prios dados. </li><li>  √â necess√°rio remover o separador dos valores do campo.  Sim, voc√™ pode dizer que, para isso, de fato, existem aspas.  Mas, como mostra a experi√™ncia, entre aspas tamb√©m surgem muitos problemas.  Em geral, vamos remover (ou substituir) o caractere separador dos valores do campo.  Seu projeto piloto n√£o sofrer√° muito com essa imprecis√£o, mas o tempo para a prepara√ß√£o dos dados √© notavelmente economizado. </li><li>  Aspas: remova todas as aspas do valor do campo.  As aspas s√£o frequentemente encontradas nos nomes das empresas - por exemplo, Kalinka LLC.  Mas existem essas op√ß√µes: MPZ Kalinka LLC.  E agora esta √© uma grande dificuldade.  As aspas nos valores do campo devem ser acompanhadas pelo s√≠mbolo "\" ou removidas, substitu√≠das por outra coisa.  √â mais confi√°vel simplesmente remov√™-lo.  O valor do campo n√£o sofrer√° muito com isso. </li><li>  Transfer√™ncias de carro: remova todos os caracteres CHAR (10) e CHAR (13) dos valores do campo.  Caso contr√°rio, a importa√ß√£o do CSV ser√° imposs√≠vel. </li></ol><br>  Se considerarmos os pontos (4) + (5) + (6), faz sentido usar a seguinte constru√ß√£o na sele√ß√£o: <br><br><pre> <code class="plaintext hljs">REPLACE(REPLACE(REPLACE(REPLACE("COLUMN", '|', ';'), '"', ''), CHAR(13), ' '), CHAR(10), ' ') as "COLUMN"</code> </pre> <br>  Al√©m disso, quando os arquivos CSV estiverem prontos, eles precisar√£o ser copiados para o servidor HANA em uma pasta declarada segura para a importa√ß√£o de arquivos (por exemplo, / usr / sap / HDB / import).  A importa√ß√£o de dados no HANA de um arquivo CSV local √© um procedimento bastante r√°pido, desde que o arquivo esteja "limpo": <br><br><ul><li>  cada linha da tabela futura est√° em uma e apenas uma linha do arquivo; </li><li>  o n√∫mero de colunas em todas as linhas √© o mesmo; </li><li>  as aspas est√£o emparelhadas ou ausentes; </li><li>  aspas nos valores do campo acompanham o s√≠mbolo "escape" "\" ou est√£o ausentes; </li><li>  Codifica√ß√£o UTF-8 (e n√£o UTF8-BOM, como acontece ao exportar para sistemas Windows). </li></ul><br>  Para verificar os arquivos CSV antes de import√°-los e encontrar √°reas problem√°ticas, se elas existirem (e com uma probabilidade de 99%), voc√™ pode usar os seguintes comandos: <br><br>  <b>1.</b> Verifique o caractere da lista t√©cnica no in√≠cio do arquivo: <br><br>  <b>arquivo</b> data.csv <br><br>  Se o resultado do comando for assim: ‚ÄúTexto UTF-8 Unicode (com BOM)‚Äù, significa que a codifica√ß√£o √© UTF8-BOM e voc√™ precisar√° remover o caractere BOM do arquivo.  Voc√™ pode remov√™-lo da seguinte maneira: <br><br>  <b>sed -i '1s / ^ \ xEF \ xBB \ xBF //'</b> data.csv <br><br>  <b>2.</b> O n√∫mero de colunas deve ser o mesmo para cada linha do arquivo: <br><br>  <b>cat</b> data.csv <b>|</b>  <b>awk -F ¬ª;" '{print NF}' | sort | uniq</b> <br><br>  ou assim: <br><br>  <b>para i em $ (ls * .csv);</b>  <b>ecoam $ i;</b>  <b>gato $ i |</b>  <b>awk -F ';'</b>  <b>'{print NF}' |</b>  <b>classificar |</b>  <b>uniq -c;</b>  <b>eco;</b>  <b>feito;</b> <br><br>  Alterar ';'  no par√¢metro F, qual √© o separador de campos no seu caso. <br>  Como resultado desses comandos, voc√™ obt√©m a distribui√ß√£o das linhas pelo n√∫mero de colunas em cada linha.  Idealmente, voc√™ deve obter algo parecido com isto: <br><br>  EKKO.csv <br>  79536 200 <br><br>  Aqui, o arquivo cont√©m 79536 linhas e todas elas cont√™m 200 colunas.  N√£o h√° linhas com um n√∫mero diferente de colunas.  Deveria ser assim. <br><br>  E aqui est√° um exemplo de resultado incorreto: <br><br>  LFA1.csv <br>  73636 180 <br>  7 181 <br><br>  Aqui vemos que a maioria das linhas cont√©m 180 colunas (e, provavelmente, este √© o n√∫mero correto de colunas), mas h√° linhas com a 181¬™ coluna.  Ou seja, um dos campos cont√©m um sinal separador em seu valor.  Tivemos sorte e existem apenas 7 partes dessas linhas - elas podem ser facilmente visualizadas manualmente e de alguma forma corrigidas.  Voc√™ pode ver as linhas nas quais o n√∫mero de colunas n√£o √© igual a 180, assim: <br><br>  <b>cat</b> data.csv <b>|</b>  <b>awk -F ";"</b>  <b>'{if (NF! = 180) {print $ 0}}'</b> <br><br>  Uma observa√ß√£o sobre o uso dos comandos acima.  Esses comandos n√£o prestar√£o aten√ß√£o √†s aspas.  Se o sinal do separador estiver contido no campo entre aspas (e isso significa que tudo est√° bem aqui do ponto de vista da importa√ß√£o para o banco de dados), a verifica√ß√£o com esse m√©todo mostrar√° um problema falso (colunas extras) - isso tamb√©m deve ser levado em considera√ß√£o na an√°lise dos resultados. <br><br>  <b>3.</b> Se as aspas n√£o estiverem emparelhadas e n√£o puderem resolver esse problema, voc√™ poder√° excluir todas as aspas do arquivo: <br><br>  <b>sed -i 's / "// g'</b> data.csv <br><br>  O perigo dessa abordagem √© que, se os valores do campo contiverem um caractere separador, o n√∫mero de colunas na linha ser√° alterado.  Portanto, os caracteres separadores devem ser removidos dos valores do campo no est√°gio de exporta√ß√£o (exclua ou substitua por outro caractere). <br><br>  <b>4.</b> Campos vazios <br><br>  Diante de uma situa√ß√£o em que a importa√ß√£o bem-sucedida de dados foi impedida por valores de campos vazios neste formul√°rio: <br><br>  ; "" <br><br>  Onde ";"  √â o sinal do separador de campos neste caso.  Ou seja, o campo tem duas aspas duplas (sequ√™ncia vazia).  Se de repente voc√™ n√£o conseguir importar os dados e suspeitar que o problema possa estar em campos vazios, tente substituir "" por NULL <br><br>  <b>sed -i 's /; ‚Äù‚Äù /; NULL / g'</b> data.csv <br><br>  (substitua ";" pela sua op√ß√£o de separador) <br><br>  <b>5.</b> Pode ser √∫til procurar formatos de n√∫mero "sujos" nos dados: <br><br>  <b>; "0"</b> (o n√∫mero cont√©m um espa√ßo) <br>  <b>; ‚Äú100.10-‚Äù</b> (o sinal ‚Äú-‚Äú ap√≥s o n√∫mero) <br>  <b>O guindaste Bugatti 3/4 "300</b> - uma dimens√£o em polegadas √© indicada por aspas duplas - e isso automaticamente leva ao problema de aspas n√£o pareadas na exporta√ß√£o. <br><br>  Infelizmente, essa n√£o √© uma lista exaustiva de poss√≠veis problemas com formatos de dados inconvenientes para importa√ß√£o no banco de dados.  Seria √≥timo conhecer suas op√ß√µes da pr√°tica: que erros curiosos voc√™ encontrou?  Como voc√™ os detectou e eliminou.  Compartilhe nos coment√°rios. <br><br><h3>  Conclus√£o </h3><br>  Em geral, o modelo de dados para Process Mining √© muito simples: uma tabela de eventos mais, opcionalmente, livros de refer√™ncia adicionais.  Mas, como geralmente acontece, s√≥ come√ßa a parecer simples quando pelo menos um ciclo completo de tarefas foi conclu√≠do - todo o processo √© vis√≠vel na sua totalidade e o plano de trabalho √© claro.  Espero que este artigo o ajude a entender a prepara√ß√£o de dados para seu primeiro projeto de Process Mining.  Em geral, o processo de prepara√ß√£o √© assim: <br><br><ol><li>  Solicitando um hist√≥rico de altera√ß√µes do propriet√°rio dos dados </li><li>  Verificando e limpando o upload (prepara√ß√£o de arquivos CSV) </li><li>  Importar para SAP HANA </li><li>  Constru√ß√£o de mesa de eventos </li><li>  Construindo uma tabela de CA (refer√™ncia do processo) </li></ol><br>  E, de fato, √© aqui que a prepara√ß√£o do modelo de dados come√ßa e a parte mais interessante come√ßa - Process Mining.  Se voc√™ tiver alguma d√∫vida durante a implementa√ß√£o do projeto de Minera√ß√£o de Processos, sinta-se √† vontade para escrever nos coment√°rios, terei prazer em ajudar.  Boa sorte <br><br>  <i>Fedor Pavlov, especialista em plataforma SAP CIS</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462565/">https://habr.com/ru/post/pt462565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462549/index.html">Blockchain de quorum: integra√ß√£o ao c√≥digo Java</a></li>
<li><a href="../pt462551/index.html">Perguntas populares do desenvolvedor sobre testes</a></li>
<li><a href="../pt462553/index.html">Um pouco sobre simples. Projeto de teste. Parte 1</a></li>
<li><a href="../pt462555/index.html">Discuss√£o: e se trabalhar sem cookies - informamos quais s√£o as alternativas</a></li>
<li><a href="../pt462563/index.html">Webinar "Como sobreviver √† conformidade?" A melhor abordagem para atender aos requisitos regulat√≥rios ‚Äù</a></li>
<li><a href="../pt462567/index.html">Sodinokibi Ransomware: um estudo detalhado</a></li>
<li><a href="../pt462569/index.html">O sistema de transporte conosco e com eles ou "Esta√ß√µes de √¥nibus contra agregadores 2"</a></li>
<li><a href="../pt462571/index.html">As aventuras dos indescrit√≠veis Malvari: defesa vers√°til (pensamentos finais)</a></li>
<li><a href="../pt462573/index.html">Concursos em projetos: o que, por que e por qu√™?</a></li>
<li><a href="../pt462575/index.html">Semana 32 de seguran√ßa: falha no iMessage, privacidade da entrada de voz</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>