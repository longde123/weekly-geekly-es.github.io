<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖐️ 🤘🏿 👨‍👨‍👦‍👦 麻省理工学院的课程“计算机系统安全”。 讲座7：本机客户端沙箱第2部分 👨‍👩‍👧‍👧 🎺 🚣🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="麻省理工学院。 讲座课程＃6.858。 “计算机系统的安全性。” Nikolai Zeldovich，James Mickens。 2014年 
 计算机系统安全是一门有关开发和实施安全计算机系统的课程。 讲座涵盖了威胁模型，危害安全性的攻击以及基于最新科学研究的安全技术。 主题包括操作系统（OS）...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>麻省理工学院的课程“计算机系统安全”。 讲座7：本机客户端沙箱第2部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418225/"><h3> 麻省理工学院。 讲座课程＃6.858。  “计算机系统的安全性。”  Nikolai Zeldovich，James Mickens。  2014年 </h3><br> 计算机系统安全是一门有关开发和实施安全计算机系统的课程。 讲座涵盖了威胁模型，危害安全性的攻击以及基于最新科学研究的安全技术。 主题包括操作系统（OS）安全性，功能，信息流管理，语言安全性，网络协议，硬件安全性和Web应用程序安全性。 <br><br> 第1课：“简介：威胁模型” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 第2课：“控制黑客攻击”， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 第3讲：“缓冲区溢出：漏洞利用和保护” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 讲座4：“特权分离”， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 讲座5：“安全系统从何而来？” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分</a> <br> 讲座6：“机会” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <br> 讲座7：“本地客户端沙箱” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">部分</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第3部分</a> <a name="habracut"></a><br><br>  <b>听众：</b>为什么地址范围存储容量范围应从头开始？ <br><br>  <b>教授：</b>因为在性能方面，如果您知道有效地址是从零开始的连续地址集，则使用目标跳转会更有效。 因此，您可以使用单个<b>AND</b>掩码来执行此操作，其中所有高位均为1，而只有一对低位为零。 <br><br>  <b>观众：</b>我认为<b>AND</b>遮罩应该可以对齐。 <br><br>  <b>教授：</b>对，面罩可以对齐，但是为什么要从头开始呢？ 我认为他们依靠<b>细分硬件</b>细分硬件。 因此，基本上，他们可以使用它来按线性空间向上移动区域。 或者，可能与应用程序“看到”此范围的方式有关。 实际上，您可以将其放置在虚拟地址空间中的不同偏移处。 这将允许您使用分段硬件执行某些技巧，以在同一地址空间中运行多个模块。 <br><br><img src="https://habrastorage.org/webt/_r/ef/sc/_refscc89wngsofm0ajoa0eflym.jpeg"><br><br>  <b>受众：</b>也许是因为他们想“捕获”空指针的接收点？ <br><br>  <b>教授：</b>是的，因为他们想抓住所有接待点。 但是您有办法做到。 因为空指针指向正在访问的段。 并且，如果移动该段，则可以在每个段的开头显示未使用的零页。 因此，这将有助于制作一些模块。 <br><br> 我认为做出此决定的原因之一-从0开始-是因为他们希望将其程序移植到<b>x64</b>平台上，该平台的设计略有不同。 但是他们的文章没有这么说。 在64位设计中，设备本身摆脱了一些分段硬件，出于效率考虑，它们依赖于这些分段硬件，因此必须提供一种面向软件的方法。 但是，对于<b>x32，</b>这仍然不是空间从头开始的好理由。 <br><br> 因此，我们继续提出主要问题-从安全的角度来看，我们要确保什么。 让我们以某种“天真”的方式处理此问题，看看如何破坏一切，然后尝试解决它。 <br><br> 我相信天真的计划是通过从头到尾简单地扫描可执行文件来查找禁止的指令。 那么如何发现这些说明呢？ 您可以简单地获取程序代码并将其放在从0到256 MB的巨型行中，具体取决于代码的大小，然后开始搜索。 <br><br><img src="https://habrastorage.org/webt/nl/vt/rv/nlvtrvk-s3z8c_yhuugx0zqaxyc.jpeg"><br><br> 该行可能首先包含<b>NOP</b>指令模块，然后包含<b>ADD</b>指令模块<b>NOT</b> ， <b>JUMP</b>等。 您只是搜索，如果发现错误的指令，则说这是一个错误的模块并丢弃它。 而且，如果您看不到对该指令的任何系统调用，则可以启用该模块的启动，并执行0-256范围内的所有操作。 您认为这行得通吗？ 他们担心什么？ 为什么这么难？ <br><br>  <b>观众：</b>他们担心指示的大小吗？ <br><br>  <b>教授：</b>是的，事实是<b>x86</b>平台具有可变长度的指令。 这意味着指令的确切大小取决于该指令的前几个字节。 实际上，您可以查看第一个字节以表明指令将大得多，然后您可能不得不查看另外两个字节，然后确定所需的大小。 诸如<b>Spark</b> ， <b>ARM</b> ， <b>MIPS之</b>类的某些体系结构具有更多固定长度的指令。  <b>ARM</b>有两个指令长度-2或4个字节。 但是在<b>x86</b>平台上<b>，</b>指令<b>的</b>长度可以是1、5和10字节，如果尝试，甚至可以得到15字节的相当长的指令。 但是，这些是复杂的指令。 <br><br> 结果，可能出现问题。 如果您线性扫描这行代码，一切都会好起来的。 但是也许在运行时您会进入某种指令的中间，例如<b>NOT</b> 。 <br><br><img src="https://habrastorage.org/webt/ob/rv/lj/obrvlj58uew5ji8-9mev7cxwb04.jpeg"><br><br> 这可能是一条多字节指令，如果您从第二个字节开始对其进行解释，则它看起来将完全不同。 <br><br> 另一个示例，我们将“玩”汇编程序。 假设我们有一条指令<b>25 CD 80 00 00</b> 。 看完第2个字节后，您将其解释为5个字节的指令，也就是说，您将不得不向前看5个字节，然后看到它后面是<b>AND％EAX</b>指令<b>0x00 00 80 CD</b> ，从<b>EAX</b>寄存器的<b>AND</b>运算符开始，定义的常量，例如<b>00 00 80 CD</b> 。 这是本<b>机客户端</b>应通过检查二进制指令的第一条规则简单地允许的安全指令之一。 但是，如果在程序执行期间， <b>CPU</b>决定应开始执行<b>CD中</b>的代码，则我将用箭头标记该指令的此位置，则实际上是4字节指令的<b>％EAX，0x00 00 80 CD</b>指令将意味着执行<b>INT $ 0x80</b> ，这是在<b>Linux</b>上进行系统调用的一种方法。 <br><br><img src="https://habrastorage.org/webt/ib/3a/zp/ib3azp3oe9zmfedweosbecx9fto.jpeg"><br><br> 因此，如果您错过了这个事实，那么就让不可靠的模块“跳入”内核并进行系统调用，即执行您想防止的事情。 我们如何避免这种情况？ <br><br> 也许我们应该尝试查看每个字节的偏移量。 因为x86只能以字节（而不是位）边界开始解释一条指令。 因此，您必须查看每个字节的偏移量以查看指令的开始位置。 您认为这是可行的计划吗？ <br><br>  <b>受众：</b>我认为，如果有人实际使用<b>AND</b> ，则处理器不会跳到这个位置，而只是允许程序运行。 <br><br>  <b>教授：</b>是的，因为基本上他不容易出现误报。 现在，如果您确实想要它，可以稍微更改代码以某种方式避免它。 如果您确切知道测试设备在寻找什么，则可以更改这些说明。 也许首先为一条指令设置<b>AND</b> ，然后在另一条指令上使用掩码。 避免这些可疑的字节排列要容易得多，尽管这似乎很不方便。 <br><br> 该体系结构可能包括编译器更改。 基本上，它们具有某种实际需要正确编译代码的组件。 您不能只是“摘下” <b>GCC</b>并为<b>Native Client</b>编译代码。 所以基本上这是可行的。 但是很可能，他们只是认为这会引起太多麻烦，不会是可靠或高性能的解决方案，等等。 另外，有一些<b>x86</b>指令被禁止，或者应该被认为是不安全的，因此应该被禁止。 但是在大多数情况下，它们只有一个字节大小，因此很难找到或过滤掉它们。 <br><br> 因此，如果他们不能仅收集和分类不安全的说明并希望获得最好的效果，则他们需要使用其他计划以可靠的方式分解计划。 那么， <b>Native Client如何做</b>以确保他们不会“迷住”这种可变长度编码？ <br><br> 从某种意义上说，如果我们真的从左到右扫描可执行文件并查找所有可能的不正确代码，并且如果这就是代码运行的方式，那么我们就处于良好状态。 即使有一些奇怪的指令和一些偏见，处理器仍然不会“跳到”那里，它将以扫描指令的相同顺序（即从左到右）执行程序。 <br><br><img src="https://habrastorage.org/webt/kh/v0/ea/khv0ea7apzgmwqnx1pbaj8k1fgy.jpeg"><br><br> 因此，由于在应用程序中某处可能存在“跳动”这一事实，出现了可靠拆卸的问题。 如果处理器对从左向右扫描时未注意到的某些代码指令进行“跳转”，则处理器可能会失败。 因此，这是迄今为止正在开发的可靠拆卸的问题。 主要计划是检查所有“跳跃”的位置。 实际上，它在某种程度上很简单。 我们将在一秒钟内考虑一堆规则，但是大概的计划是，如果您看到“跳转”指令，则需要确保“跳转”的目的已在早期注意到。 实际上，要做到这一点，从左到右扫描就足够了，也就是我们在幼稚的方法中描述的过程。 <br><br> 在这种情况下，如果看到任何“跳转”指令和该指令指向的地址，则必须确保该地址与您在从左向右反汇编时已经看到的地址相同。 <br><br> 如果找到了此CD字节的跳转指令，则应将该跳转标记为无效，因为我们从未见过以CD字节开头的指令，而是看到了另一个以数字25开头的指令。但是，如果所有跳转指令命令转到说明的开头，在本例中为25，则一切与我们保持一致。 清楚吗？ <br><br> 唯一的问题是您无法检查程序中每个跳转的目标，因为可能存在间接跳转。 例如，在<b>x86中，</b>您可能会跳转到该<b>EAX</b>寄存器的值。 这对于实现函数指针非常有用。 <br><br><img src="https://habrastorage.org/webt/uf/gh/bl/ufghbl_dd-pofxnrp7fy-ne3ee0.jpeg"><br><br> 也就是说，函数指针位于内存中的某个位置，将其保存在某个寄存器中，然后转到移动寄存器中的任何地址。 <br><br> 那么这些家伙如何应对间接跳跃？ 因为，实际上，我不知道这将是字节<b>CD</b>还是字节25的“跳转”。在这种情况下，它们会做什么？ <br><br>  <b>受众：</b>使用工具吗？ <br><br>  <b>教授：</b>是的，使用仪器是他们的主要窍门。 因此，每当他们看到编译器已准备好执行生成操作时，就可以证明此跳转不会引起麻烦。 为此，他们需要确保所有跳转均以32字节的多重性执行。 他们是如何做到的？ 他们将所有跳转指令更改为所谓的“伪指令”。 这些是相同的指令，但带前缀，可清除<b>EAX</b>寄存器中的5个低位。 指令清除5个低位的事实意味着它导致给定值是32的倍数，从2到5，然后已经执行到该值的跳转。 <br><br><img src="https://habrastorage.org/webt/r3/sf/nq/r3sfnqlxz3egqe8q-0ret79kwzu.jpeg"><br><br> 如果您在验证期间查看此内容，请确保该说明性“对”仅以32字节的多重性“跳跃”。 然后，为了确保没有“跳入”某些奇怪指令的可能性，请应用一条附加规则。 它包含以下事实：在反汇编期间，当您从左到右查看指令时，请确保每个有效指令的开头也应为32字节的倍数。 <br><br> 因此，除了此工具包外，还要验证32的倍数的每个代码是否正确。 所谓有效指令，是指从左向右反汇编的指令。 <br><br>  <b>观众：</b>为什么选择32号？ <br><br>  <b>教授：</b>是的，为什么他们选择32而不是1000或5？ 为什么5不好？ <br><br>  <b>观众：</b>因为数字必须是2的幂。 <br><br>  <b>教授：</b>是的，这就是原因。 因为否则，要确保使用5的倍数，将需要其他指令，从而导致开销。 那八点呢？ 八个数字够用吗？ <br><br>  <b>受众：</b>您的指令长度可能超过八位。 <br><br>  <b>教授：</b>是的，这可能是x86平台上允许的最长指令。 如果我们有10字节的指令，并且所有内容都应为8的倍数，则我们将无法在任何位置插入它。 因此，该长度应足以应付所有情况，因为我看到的最大指令长度为15个字节。 因此32个字节就足够了。 <br><br> 如果要修改说明以进入或退出流程服务环境，则可能需要在一个32字节的插槽中添加一些平凡的代码。 例如，为31个字节，因为1个字节包含一条指令。 应该更大吗？ 我们应该使它等于1024个字节吗？ 如果您有许多函数指针或许多间接跳转，那么每次您要创建要跳转的位置时，无论其值如何，都必须将其继续到下一个边界。 因此，如果使用32位，则相当正常。 在最坏的情况下，如果您需要快速到达下一个边界，则只会丢失31个字节。 但是，如果您的大小是1024字节的倍数，则可能会浪费整个千字节的内存以进行间接跳转。 如果您有短函数或许多函数指针，那么“跳转”长度的倍数如此之大将导致内存的大量浪费。 <br><br> 我不认为数字32是<b>Native Client</b>的绊脚石。 某些块可以使用16位（某些64位或128位）的多样性，这并不重要。 在他们看来，只有32位是最可接受的最佳值。 <br><br> 因此，让我们制定可靠的拆卸计划。 因此，在将<b>C</b>或<b>C ++代码</b>编译为<b>Native Client</b>二进制文件时，编译器应格外小心，并遵守以下规则。 <br><br><img src="https://habrastorage.org/webt/c0/nh/kc/c0nhkc4izpqqyrj_rtr2gg-eytu.jpeg"><br><br> 因此，每当他有跳跃动作时（如第一行所示），他都必须添加最后两行中给出的这些附加说明。 并且不管他创建了要“跳转”到的函数的事实，我们的指令都会跳转为<b>附加值AND $ 0xffffffe0，％eax</b>表示。 而且它不能仅用零进行补码，因为所有这些都必须具有正确的代码。 因此，为了确保所有可能的指令均有效，必须进行加法运算。 而且，幸运的是，在<b>x86</b>平台上，没有单个字节描述一个<b>noop</b>函数，或者至少没有一个字节大小的单个<b>noop</b> 。 因此，您始终可以将事物添加到常量的值。 <br><br> 那么，这对我们有什么保证？ 确保我们始终看到将要遵循的指令术语中发生的情况。 这条规则为我们提供了-保证不会偶然发生系统调用。 这适用于跳跃，但是收益呢？ 他们如何处理退货？ 我们可以<b>返回</b> <b>Native Client中</b>的功能吗？ 如果运行红热代码会怎样？ <br><br>  <b>受众：</b>它可能会使堆栈溢出。 <br><br>  <b>教授：</b>确实，它突然出现在堆栈上。 但是事实是，本<b>机客户端</b>模块使用的堆栈实际上包含一些内部数据。 因此，在处理<b>Native Client时，</b>您不必担心堆栈溢出。 <br><br>  <b>听众：</b>等等，但是您可以将任何东西放在堆栈上。 当您进行间接跳跃时。 <br><br>  <b>教授：</b>是的。 返回看起来几乎是从位于堆栈顶部的内存中某个位置间接跳转。 因此，我认为他们可以为<b>return</b>函数做的一件事就是以与上一次检查相同的方式设置前缀。 并且此前缀检查在堆栈顶部弹出的内容。 您检查这是否有效，并在编写或使用<b>AND</b>运算符时检查堆栈顶部的内容。 由于数据的不断变化，这似乎有点不可靠。 因为例如，如果您查看堆栈的顶部并确保所有内容都正确，然后再写一些内容，则同一模块中的数据流可能会修改堆栈顶部的内容，之后您将引用错误的内容地址 <br><br>  <b>观众：</b>这不适用于同样程度的跳跃吗？ <br><br>  <b>教授：</b>是的，那么跳在那里会发生什么？ 我们的比赛条件会以某种方式使这项测试无效吗？ <br><br>  <b>观众：</b>但是代码不是可写的吗？ <br><br>  <b>教授：</b>是的，代码无法编写，这是事实。 因此，您不能修改AND。 但是是否有其他流不能改变这两条指令之间跳转的目的？ <br><br>  <b>观众：</b>这是在登记册中，所以... <br><br>  <b>教授：</b>是的，这很酷。 因为如果流修改了内存中的内容或从<b>EAX</b>加载的内容（本身，您是在下载之前进行了修改），在这种情况下，此<b>EAX</b>将处于错误状态，但随后将清除错误的位。 或者，当指针已经在<b>EAX中时</b> ，他可以在之后更改内存，因此它不会更改从中加载<b>EAX</b>寄存器的内存的位置。 <br><br> 实际上，线程不共享寄存器集。 因此，如果另一个线程更改了<b>EAX</b>寄存器，则不会影响该线程的<b>EAX</b>寄存器。 因此，其他线程不能使此指令序列无效。 <br><br> 还有另一个有趣的问题。 我们可以绕开这个<b>AND</b>吗？ 我可以跳转到该地址空间中的任何位置。      ,       <b>AND</b>  . <br><br><img src="https://habrastorage.org/webt/4p/vf/nk/4pvfnkoa0kmui9vdd5wn2o-jbk0.jpeg"><br><br>       ,      ,   ,    ,  ,        <b>AND</b> .    .     <b>jmp</b> ,      . <br><br><img src="https://habrastorage.org/webt/kg/mf/cu/kgmfcuyc42v0rtkdtzt1ptm1ty4.jpeg"><br><br> ,      ,    -  ,    1237.     ,     32.  <b>Native Client</b>       ,     ,      ,     .          ,   ,      1237      ? <br><br><img src="https://habrastorage.org/webt/dn/_-/_r/dn_-_r-vi7p_qx7nxwwkqmroh-w.jpeg"><br><br>    -  <b>EAX</b> ,   , ,        ,      .  ,    ?     ? <br><br> <b>:</b> <b>NaCl</b>   ,      . <br><br> <b>:</b> ,       .      <b>x86</b>    ,    ,   <b>NaCl</b>   ,  2          .       ,    ,  : «,    ,    !»,              <b>25 CD 80 00 00</b> .     .         ,     <b>x86</b> . <br><br>   ,   <b>Native Client</b>      . ,       ,   ,    ,          <b>NaCl</b> . ,     . <br><br> <b>:</b> ,        ,     .     ,         .  ,      ,     ,       ,     . <br><br><img src="https://habrastorage.org/webt/sq/hd/pl/sqhdplwnbsfj55r8qmp6trwxk5y.jpeg"><br><br> <b>:</b> ,  .     ,   . ,       ,      ,   <b>EAX</b> .           ,   -  .        <b>EAX</b> ,  <b>EBX</b>   .           ,       .          <b>EAX</b>  <b>EBX</b>  <b>AND</b>   .     ,  ,      <b>EAX</b> ,         .         ,   -   <b>64</b>  .    <b>Jmp *% eax</b>   <b>AND</b>   . <br><br><img src="https://habrastorage.org/webt/qz/nf/zt/qznfzt9lqpfreshgcc76zygs8cq.jpeg"><br><br> ,   , ,   ,   .   <b>Intel</b> ,        ,  ,   ,      .       ,   ,             .       <b>AND</b>    ,   <b>EAX</b>  ,    «» . <br><br> ,       ,           .     ,       .     ,    ,   ,   .      ,  ,   ,    . <br> ,     ,  <b>C1</b>  <b>C7</b> . <br><br> <b>C1</b>   ,       ,            .     ,     «»     .   ,       ,      .   ,       ,     - .  ,    . <br> <b>2</b> ,     0   <b>64</b> .     ,     ,        .        ,      ,      . <br><br>  <b>3</b> ,  ,  ,   .        ,  ,         . <br><br> <b>4</b>   ,         <b>hlt</b> .             <b>halt</b> ?     ,  <b>C4</b> .   ,   ,      -  ,      . <br><br>     ,  ,          ? ,          ,      -  . <br>     ,     ,  ,       ,       .    ,       ,     ,  ,           .         . <br><br><img src="https://habrastorage.org/webt/9i/1f/yj/9i1fyjdue4tun6jsa8gnnzkue9c.jpeg"><br><br> 55:20  <br><br> : <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">麻省理工学院的课程“计算机系统安全”。</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> 7: « Native Client»,  3</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/I0Psvvky-44" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . <br><br> ,    . 你喜欢我们的文章吗？ 想看更多有趣的资料吗？ 通过下订单或将其推荐给您的朋友来支持我们，为我们为您开发<b>的入门级​​服务器的独特模拟，为Habr用户</b>提供<b>30％的折扣：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于VPS（KVM）E5-2650 v4（6核）的全部真相10GB DDR4 240GB SSD 1Gbps从$ 20还是如何划分服务器？</a>  （RAID1和RAID10提供选件，最多24个内核和最大40GB DDR4）。 <br><br> <b>3  </b>    Dell R630     — <b>2  Intel Deca-Core Xeon E5-2630 v4 / 128GB DDR4 / 41TB HDD  2240GB SSD / 1Gbps 10 TB —  $99,33 </b> ,    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . <br><br>  <b>戴尔R730xd便宜2倍？</b> 仅<b>在荷兰和美国，</b>我们有<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2台Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100电视（249美元起）</a> ！</b> 阅读有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何构建基础架构大厦的信息。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用价格为9000欧元的Dell R730xd E5-2650 v4服务器的上等课程？</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN418225/">https://habr.com/ru/post/zh-CN418225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN418215/index.html">麻省理工学院的课程“计算机系统安全”。 讲座5：“安全系统错误来自哪里”，第2部分</a></li>
<li><a href="../zh-CN418217/index.html">麻省理工学院的课程“计算机系统安全”。 讲座6：“机会”，第1部分</a></li>
<li><a href="../zh-CN418219/index.html">麻省理工学院的课程“计算机系统安全”。 讲座6：机会，第2部分</a></li>
<li><a href="../zh-CN418221/index.html">麻省理工学院的课程“计算机系统安全”。 讲座6：“机会”，第3部分</a></li>
<li><a href="../zh-CN418223/index.html">麻省理工学院的课程“计算机系统安全”。 讲座7：本机客户端沙盒，第1部分</a></li>
<li><a href="../zh-CN418227/index.html">麻省理工学院的课程“计算机系统安全”。 讲座7：本机客户端沙盒，第3部分</a></li>
<li><a href="../zh-CN418229/index.html">麻省理工学院的课程“计算机系统安全”。 讲座8：网络安全模型，第1部分</a></li>
<li><a href="../zh-CN418233/index.html">BMW助记符用于查找边界值</a></li>
<li><a href="../zh-CN418235/index.html">编排的传奇故事或如何根据服务模式使用数据库建立服务中的业务交易</a></li>
<li><a href="../zh-CN418237/index.html">在Neo中的SAP Cloud平台上开发多租户应用程序，第2部分：授权和身份验证</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>