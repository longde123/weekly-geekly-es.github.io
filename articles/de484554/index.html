<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔟 💆🏿 🧜🏼 Erstellen Sie eine Schaltfläche mit Ripple-Effekt für die XMars-Benutzeroberfläche 🤵🏻 👨🏻 🥉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits, heute werde ich euch erzählen, wie ich die Schaltfläche für das XMars-UI- Projekt entwickelt habe. Oh ja, es ist eine Kleinigkeit, a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen Sie eine Schaltfläche mit Ripple-Effekt für die XMars-Benutzeroberfläche</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484554/"><p><img src="https://habrastorage.org/webt/qb/fw/za/qbfwzabrpaxjd5t8yzbqojymgwg.jpeg"></p><br><p> Hallo allerseits, heute werde ich euch erzählen, wie ich die Schaltfläche für das <a href="http://bit.ly/2RAsroW" rel="nofollow">XMars-UI-</a> Projekt entwickelt habe.  Oh ja, es ist eine Kleinigkeit, aber es gibt etwas zu erzählen.  Ich werde die Details weglassen, die mit dem Hinzufügen einer neuen Komponente zum Open Source-Projekt verbunden sind.  Im Detail werde ich in einem separaten Artikel über das Projekt sprechen. </p><br><h3 id="vvedenie">  Einleitung </h3><br><p>  <a href="http://bit.ly/2RbfuDn" rel="nofollow">Die XMars-Benutzeroberfläche</a> ist eines meiner neuen Open Source-Projekte.  Eine einfache Bibliothek von UI-Komponenten für HTML / CSS und React.  In Zukunft plane ich, Vue zu unterstützen.  Bisher hat es nur einen Button und Icons :) </p><br><p>  Das Projekt entstand als Idee im Rahmen des Telegrammwettbewerbs, dessen Kern die Entwicklung einer Webversion des Kunden war.  Gemeinsam mit einem Kollegen haben wir beschlossen, warum wir nicht daran teilnehmen.  Die Rollen wurden geteilt, sodass ich ein Layout habe. Wenn ein Kollege die Berechtigung versteht, verbinde ich mich, um Komponenten zu schreiben.  Alles wäre in Ordnung, aber sich in das Telegramm einzuloggen ist nicht so einfach.  Infolgedessen haben wir nichts gesendet, aber ich habe alles eingeholt, und es stellte sich heraus, dass dies vergeblich war.  Aber wie Varlamov sagt, ist Ihr Projekt schon etwas wert, da Sie Ihre Zeit damit verbracht haben.  Es ist schwierig, dem zu widersprechen, denn wenn Sie auf Stunden und Geld umsteigen, ist es nicht mehr kostenlos, Webpack gleich zu Beginn des Projekts einzurichten.  Angesichts all dieser Schande beschloss ich, es irgendwie auf Open Source zu werfen.  Welcher einzelne Bootstrap soll verwendet werden?  Ich möchte ein eigenes UI-Framework für meine anderen Projekte. </p><a name="habracut"></a><br><h3 id="the-button">  Der Knopf </h3><br><p>  Die Schaltfläche in der Benutzeroberfläche ist möglicherweise das Hauptelement, mit dem der Benutzer mit der Anwendung interagiert.  Daher ist dies eine der ersten Komponenten eines UI-Frameworks / einer UI-Bibliothek. </p><br><p>  In der Gestaltung von Telegram gibt es nicht viele Variationen von Schaltflächen: </p><br><p><img src="https://habrastorage.org/webt/6h/g7/t6/6hg7t6irtlvoinmtwbgu7t1zezu.png"></p><br><p>  Ich habe 3 Haupt- (Standard, Akzent, Haupt), runde mit einem Symbol und grün markiert.  Es ist immer noch halbtransparent, aber lass es runter.  Bei der Entwicklung der <a href="http://bit.ly/2tr72a0" rel="nofollow">XMars-Benutzeroberfläche habe</a> ich größtenteils nicht herausgefunden, wo die transparente Schaltfläche benötigt wird. </p><br><p> Der Bibliotheksbenutzer sollte mit CSS-Klassen vertraut sein.  Ich bin kein Fan von solchen Benennungssystemen wie BEM.  Ich mag es, wie Bootstrap Klassen benennt.  Aber ich würde ein bisschen mehr vereinfachen.  Anstelle von <code>.btn .btn-primary</code> nur <code>.btn .primary</code> .  Und im Fall der React-Komponente sieht das so aus: </p><br><pre> <code class="javascript hljs">&lt;Button primary&gt;Hey&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt;</span></span></code> </pre> <br><p>  Die gleiche taste aber welligkeit wirkung: </p><br><pre> <code class="javascript hljs">&lt;Button primary ripple&gt;Hey&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt;</span></span></code> </pre> <br><h3 id="html--css">  HTML / CSS </h3><br><p>  Die UI-Bibliothek sollte nicht an ein UI-Framework gebunden sein.  In Zukunft plane ich, das Layout für <code>Vue</code> Komponenten zu erweitern.  Beginnen wir mit einfachem HTML / CSS. </p><br><p>  Unter der Haube des <a href="http://bit.ly/364UK4g" rel="nofollow">Tailwindcss-</a> Projekts handelt es sich um ein Utility-First-CSS-Framework, dh ein Framework, das Ihnen Dienstprogramme statt vollwertiger Komponenten zur Verfügung stellt. </p><br><p><img src="https://habrastorage.org/webt/by/c_/rk/byc_rkdkrpk4-igmro0h4wnbkli.png"></p><br><p>  Neben Tailwindcss wird PostCSS für <a href="https://github.com/postcss/postcss-mixins" rel="nofollow">Mixins</a> , <a href="https://github.com/postcss/postcss-custom-properties" rel="nofollow">Variablen</a> und <a href="https://github.com/postcss/postcss-nested" rel="nofollow">verschachtelte Stile verwendet.</a> </p><br><p>  Ausführlicher über die Verwendung eines solchen Frameworks und wie das Projekt konfiguriert ist, werde ich in einem separaten Artikel erzählen.  Zum jetzigen Zeitpunkt reicht es aus, dass wir über ein so leistungsfähiges Toolkit verfügen und die Komponenten, mit denen es arbeitet, voll ausnutzen. </p><br><p>  Das <code>&lt;button&gt;</code> verfügt über eine Reihe von Standardstilen, die entweder entfernt oder neu definiert werden müssen. </p><br><p><img src="https://habrastorage.org/webt/rq/uw/ad/rquwad-pftcaam8vqie3bwhsmew.png"></p><br><p>  Im Fall von Tailwindcss hat das Button-Tag diesen Stil: </p><br><p><img src="https://habrastorage.org/webt/ok/c9/2c/okc92cjctwgo5v8nf0qes8_dcvu.png"></p><br><p>  Alle unnötigen standardmäßig entfernt.  Sie können gestalten, was Sie möchten, ohne befürchten zu müssen, dass ein Standardrahmen in einem bestimmten Zustand abfällt.  Hier ist jedoch eine Einschränkung: Die Standardkontur muss noch festgelegt werden: </p><br><p><img src="https://habrastorage.org/webt/6d/7w/d7/6d7wd77y15peye0xdl8luutiscq.png"></p><br><p>  Eine Schaltfläche in der <a href="http://bit.ly/30yxc6C" rel="nofollow">XMars-Benutzeroberfläche</a> hat eine <code>.btn</code> Klasse: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn"</span></span></span><span class="hljs-tag">&gt;</span></span>Button<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Füge diese Klasse zu unseren Styles hinzu: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.btn</span></span> { @apply text-black text-base leading-snug; @apply py-3 px-4 border-none rounded-lg; @apply inline-block cursor-pointer no-underline; &amp;:focus { @apply outline-none; } }</code> </pre> <br><p>  Neben der Tatsache, dass Tailwindcss Klassen zur Verfügung stellt, die Sie verwenden können, bietet es eine Art <code>mixins</code> .  <code>@apply</code> ist kein SCSS oder eine Art Plugin für PostCSS.  Dies ist die Syntax von Tailwindcss.  Angewendete Stile werden im Allgemeinen anhand des Namens semantisch deutlich.  <code>py-3</code> und <code>px-4</code> alleine können zu Fragen führen.  Das erste ist das Auffüllen entlang y, <code>padding-top: 0.75rem;</code> vertikal, nämlich <code>padding-top: 0.75rem;</code> <code>padding-bottom: 0.75rem;</code>  .  Folglich ist das <code>px-4</code> horizontal <code>padding-right: 1rem;</code>  <code>padding-left: 1rem;</code>  . </p><br><p>  Das Design, das Telegram zur Verfügung stellte, um es sanft auszudrücken, ist schlecht dokumentiert, und Dinge wie Schaltflächen mit Rahmenradius müssen mit einem Lineal direkt vom Bild aus aufgenommen werden.  Haben Sie sich jemals gefragt, was genau die Mittelwerte im <code>border-radius</code> ? </p><br><p><img src="https://habrastorage.org/webt/t1/61/sp/t161sp5vhq_sw2hwtb56ibfylgs.gif"></p><br><p>  Dies ist buchstäblich der Radius des resultierenden Kreises in der Ecke.  Wenn die kollektive Farm, dann können Sie das Lineal wie im Bild oben gezeigt ändern.  Also habe ich rechteckige Auswahl in Gimp verwendet. </p><br><p><img src="https://habrastorage.org/webt/9b/-x/bk/9b-xbkbj3mbmrmsgttlhpzx2nbc.png"></p><br><p>  <code>border-radius</code> Rahmenradius der Buttons im Design ist 10px, leider gibt es keine solche Klasse aus der Box in Tailwindcss, aber ich hatte visuell <code>8px</code> <code>rounded-lg</code> was <code>8px</code> für die Standardschriftgröße (rem) ist. </p><br><p>  Folgendes ist im Moment passiert: Ich habe den Knopf grau angestrichen, damit die Kanten sichtbar sind: </p><br><p><img src="https://habrastorage.org/webt/a2/tz/z-/a2tzz-khw1guvggfgjz0vjecfnm.png"></p><br><p>  Als nächstes müssen wir einen Effekt erzielen auf <code>:hover</code> .  Dann beschlossen die Designer von Telegram, etwas Licht ins Dunkel zu bringen und gaben die Farbe als 0,08% von <code>#707579</code> .  Ich sehe zwei Möglichkeiten, nehme einfach die Farbe mit der Pipette oder mache es wie dokumentiert.  Die erste Option ist einfacher, aber in Zukunft ist sie nicht die beste.  Tatsache ist, dass wenn sich der Hintergrund von Weiß unterscheidet: Wenn Sie mit der <code>:hover</code> über eine bestimmte Farbe fahren, verlieren Sie die Helligkeit und Transparenz der Schaltfläche.  Dazu ist es besser, der Dokumentation zu folgen und Alpha zu legen <del>  männlich </del>  der Kanal.  Dies kann auf unzählige Arten geschehen, beispielsweise mit den SCSS-Farbfunktionen.  Das Projekt enthält jedoch kein SCSS. Aufgrund der gleichen Farbe möchte ich kein Plug-In mit PostCSS verbinden. Wir werden alles sehr einfach gestalten.  In Chrome gibt es einen Colopaker, mit dem Sie Farben in verschiedene Systeme umwandeln, HEX-Farben <code>#707579</code> , in <code>rgba</code> übersetzen und den Alphakanal einstellen können - 0,08%. </p><br><p><img src="https://habrastorage.org/webt/tx/oe/hv/txoehvpf_ams30-5kvkur8q-2bc.png"></p><br><p>  Voila!  Etwas scharf blitzte mein Bild: </p><br><p><img src="https://habrastorage.org/webt/9g/nc/7b/9gnc7bjgm-uljw_rwbxn8cve71c.png"></p><br><p>  Wir <code>rgba(112, 117, 121, 0.08)</code> - <code>rgba(112, 117, 121, 0.08)</code> . </p><br><p><img src="https://habrastorage.org/webt/vn/hc/kh/vnhckhj8plbr9_rmbvr0ug9eawm.png"><br>  (: schweben) </p><br><p>  Noch langweiliger und ohne viel Aufwand fügte ich den Rest des Staates hinzu: </p><br><pre> <code class="css hljs"> &amp;<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--grey04); } &amp;<span class="hljs-selector-class"><span class="hljs-selector-class">.accent</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--blue01); } &amp;<span class="hljs-selector-class"><span class="hljs-selector-class">.primary</span></span> { @apply text-white; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--blue01); &amp;:hover { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--blue02); } }</code> </pre> <br><h3 id="react-komponent">  Komponente reagieren lassen </h3><br><p>  Ursprünglich war der Button für den Telegrammwettbewerb vorgesehen und es war unmöglich, ein Framework zu verwenden.  Ich musste den Ripple-Effekt für reines JS implementieren.  Das möchte ich wirklich so bleiben, aber während Sie das Projekt alleine machen, müssen Sie etwas opfern. </p><br><p>  Komponenten, die eine Art Logik erfordern, z. B. der Ripple-Effekt, werden implementiert und sind nur als React-Komponenten verfügbar. </p><br><p>  Wickeln Sie die Schaltfläche in React-Komponente ist nicht schwierig: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { FunctionComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps { } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Button: FunctionComponent&lt;ButtonProps&gt; = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"btn"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">props.children</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> Button;</code> </pre> <br><p>  Diese Schaltfläche wird im angegebenen Stil angezeigt, ist jedoch in Wirklichkeit wenig hilfreich.  Der Benutzer muss in die Lage versetzt werden, die Schaltfläche anzupassen, benutzerdefinierte Stile hinzuzufügen, Ereignishandler zu hängen usw. </p><br><p>  Damit der Benutzer alles Notwendige übertragen kann, müssen Sie zuerst Typescript überwinden, da Sie sonst selbst mit <code>onClick</code> keine <code>onClick</code> Übertragung durchführen können.  <code>ButtonProps</code> leichtes Bearbeiten der <code>ButtonProps</code> Oberfläche lösen wir das Problem: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps extends ButtonHTMLAttributes&lt;HTMLButtonElement&gt;</code> </pre> <br><p>  Danach können wir sicher <code>props</code> zerstören: </p><br><pre> <code class="javascript hljs">&lt;button className=<span class="hljs-string"><span class="hljs-string">"btn"</span></span> {...props}&gt;props.children&lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt;</span></span></code> </pre> <br><p>  Eine ähnliche Verwendung der Schaltfläche verhält sich wie erwartet: </p><br><pre> <code class="javascript hljs">&lt;Button onClick={() =&gt; alert()}&gt;Hey&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt;</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/-_/aq/qb/-_aqqbmdkzkmdf2sr8lodd_wy-o.png"></p><br><p>  Als Nächstes fügen wir die Schaltflächenstile und die Möglichkeit hinzu, eine benutzerdefinierte Klasse (die plötzlich jemand benötigt) zu registrieren.  Das Paket npm <a href="https://www.npmjs.com/package/classnames" rel="nofollow">classnames</a> ist perfekt für diese Zwecke. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps extends ButtonHTMLAttributes&lt;HTMLButtonElement&gt; { primary?: boolean, accent?: boolean, additionalClass?: string, } ... const classNames = classnames( <span class="hljs-string"><span class="hljs-string">'btn'</span></span>, { primary }, { accent }, additionalClass ); ... &lt;button className={classNames} {...props}&gt;props.children&lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt;</span></span></code> </pre> <br><p>  Die <code>btn</code> Klasse ist immer gesetzt, aber <code>primary</code> und <code>accent</code> nur, wenn sie <code>true</code> .  Classnames fügt eine Klasse hinzu, wenn sie einen logischen Wert <code>true</code> hat. Mit der Abkürzung ES6 erhalten wir einen einfachen Eintrag <code>{ primary }</code> anstelle von <code>{ primary: true }</code> . </p><br><p>  <code>additionalClass</code> ist ein String, und wenn er leer oder undefiniert ist, spielt er für uns keine besondere Rolle. Es wird lediglich nichts zum Element hinzugefügt. </p><br><p>  Zuerst habe ich <code>props</code> wie folgt zugewiesen: </p><br><pre> <code class="javascript hljs">{...omit(props, [<span class="hljs-string"><span class="hljs-string">'additionalClass'</span></span>, <span class="hljs-string"><span class="hljs-string">'primary'</span></span>])}</code> </pre> <br><p>  Alles weglassen, was nicht für die <code>props</code> des Schaltflächenelements gilt, aber dies ist nicht erforderlich, da React nicht zu viel rendert. </p><br><h3 id="ripple-effect">  Welligkeitseffekt </h3><br><p><img src="https://habrastorage.org/webt/36/ys/8w/36ys8wseofyhctlp1cm5r5kiwqo.gif"></p><br><p>  Eigentlich sieht es so aus, aber es ist wünschenswert, dass die „Welle“ von der Stelle des Klicks abweicht. <br>  Es gibt unzählige Möglichkeiten, eine solche Animation zu erstellen. Es ist wie ein Witz über das <a href="https://css-tricks.com/blue-box/" rel="nofollow">blaue Quadrat</a> . </p><br><p>  Bei Google wurde jedoch anhand der Beispiele für Codepen deutlich, dass in den meisten Fällen eine „Welle“ durch ein untergeordnetes Element realisiert wird, das sich ausdehnt und verschwindet. </p><br><p>  Es wird entsprechend den Koordinaten des Klicks innerhalb der Schaltfläche positioniert.  In der <a href="http://bit.ly/2RbcVRD" rel="nofollow">XMars-Benutzeroberfläche habe</a> ich mich derzeit entschieden, diesen Effekt <code>onPress</code> wie in der Material-Benutzeroberfläche in <code>onPress</code> zu implementieren, sondern in Zukunft zu <code>onPress</code> .  Bisher nur <code>onClick</code> . </p><br><p><img src="https://habrastorage.org/webt/dr/rr/wy/drrrwydtouv_xhq3fi6pyahyaye.png"></p><br><p>  Das Bild oben ist alles Magie.  Ein Klick erzeugt ein untergeordnetes Schaltflächenelement, es wird absolut in der Mitte des Klicks positioniert und erweitert.  Die Eigenschaft <code>overflow: hidden</code> Welle über die Schaltfläche hinausgeht.  Das Element muss am Ende der Animation gelöscht werden. </p><br><p>  Zunächst definieren wir die Stile, in denen wir sie verwenden können, indem wir Tailwindcss verwenden: </p><br><pre> <code class="plaintext hljs">.with-ripple { @apply relative overflow-hidden; @keyframes ripple { to { @apply opacity-0; transform: scale(2.5); } } .ripple { @apply absolute; z-index: 1; border-radius: 50%; background-color: var(--grey04); transform: scale(0); animation: ripple 0.6s linear; } &amp;.primary { .ripple { background-color: var(--black02); } } }</code> </pre> <br><p>  Dem für den Effekt verantwortlichen Element wird die Klasse <code>.ripple</code> zugewiesen. <code>border-radius: 50%;</code>  entspricht einem Kreis (50% Verrundung in einem Winkel * 2), die Schaltfläche hat eine relative Position, die <code>.ripple</code> Schaltfläche hat eine absolute Position.  Die Animation ist sehr einfach, zunehmende Wellen werden in 0,6 Sekunden transparent.  Die Hintergrundfarbe ist dieselbe wie <code>:hover</code> und Falten, zwei transparente Wellenfarben und Schaltflächen ergeben das gewünschte Ergebnis.  Auf der blauen Schaltfläche <code>.primary</code> ist dies nicht so wichtig, und dort können Sie eine nicht transparente Farbe verwenden. </p><br><p>  Beim Klicken müssen Sie das Element "wave" erstellen.  Aus diesem Grund erstellen wir einen Status für dieses Unternehmen und fügen der Schaltfläche den entsprechenden Klick-Handler hinzu, jedoch so, dass der benutzerdefinierte onClick nicht beeinträchtigt wird. </p><br><pre> <code class="javascript hljs">... const [rippleElements, setRippleElements] = useState&lt;JSX.Element[]&gt;<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">); ... </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">renderRippleElements</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElements</span></span></span><span class="hljs-function">; } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;button className={classNames} {...props} onClick={(event</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.onClick) { props.onClick(event); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ripple) { onRippleClick(event); } }} &gt; {children} {renderRippleElements()} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; );</span></span></code> </pre> <br><p>  <code>rippleElements</code> - ein Array von JSX-Elementen. Die Render-Funktion hier mag redundant erscheinen, dies ist jedoch eher eine Frage des Stils und der Integration für die Zukunft. </p><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRippleClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event: React.MouseEvent&lt;HTMLButtonElement, MouseEvent&gt;</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rect = event.currentTarget.getBoundingClientRect(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> d = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(event.currentTarget.clientWidth, event.currentTarget.clientHeight); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> left = event.clientX - rect.left - d/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> top = event.clientY - rect.top - d/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rippleElement = newRippleElement(d, left, top); setRippleElements([...rippleElements, rippleElement]); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newRippleElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d: number, left: string, top: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> key = uuid(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div key={key} className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ripple"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style={{width: d, height: d, left, top}} onAnimationEnd={(</span></span></span><span class="hljs-function">) =&gt;</span></span> onAnimationEnd(key)} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br><p>  <code>onRippleClick</code> Handler, der "Wellen" erzeugt.  Durch Klicken auf die Schaltfläche ermitteln wir die Größe der Schaltfläche, mit der der Kreis korrekt positioniert wird. <code>newRippleElement</code> alles Notwendige an die Funktion <code>newRippleElement</code> die wiederum einfach ein <code>div</code> Element mit der <code>ripple</code> Klasse erstellt und die für die Positionierung erforderlichen Stile erstellt. </p><br><p>  Von den wichtigsten Dingen, die es wert sind, <code>onAnimationEnd</code> hervorgehoben zu <code>onAnimationEnd</code> .  Wir benötigen dieses Ereignis, um das DOM von bereits verwendeten Elementen zu löschen. </p><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onAnimationEnd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key: string</span></span></span><span class="hljs-function">) </span></span>{ setRippleElements(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElements</span></span></span><span class="hljs-function"> =&gt;</span></span> rippleElements.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">element</span></span></span><span class="hljs-function"> =&gt;</span></span> element.key !== key)); }</code> </pre> <br><p>  Es ist sehr wichtig, nicht zu vergessen, die aktuellen <code>rippleElements</code> in Argumente zu übergeben, sonst können Sie ein Array mit alten Werten erhalten, und alles wird nicht wie beabsichtigt funktionieren. </p><br><p>  Vollständiger Tastencode: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { FunctionComponent, ButtonHTMLAttributes, useState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uuid <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'uuid/v4'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> classnames <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'classnames'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps extends ButtonHTMLAttributes&lt;HTMLButtonElement&gt; { primary?: boolean, accent?: boolean, circle?: boolean, ripple?: boolean, additionalClass?: string, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Button: FunctionComponent&lt;ButtonProps&gt; = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [rippleElements, setRippleElements] = useState&lt;JSX.Element[]&gt;<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> {</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">primary</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">accent</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">circle</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ripple</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">additionalClass</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">} = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">classNames</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">classnames</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'btn'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, { primary }, { </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'with-ripple'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: ripple }, { circle }, { accent }, additionalClass </span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onAnimationEnd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key: string</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">setRippleElements</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElements =&gt; rippleElements.filter(element =&gt; element.key !== key</span></span></span><span class="hljs-function">)); } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onRippleClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event: React.MouseEvent&lt;HTMLButtonElement, MouseEvent&gt;</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">var</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rect</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">currentTarget</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">getBoundingClientRect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Math</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">max</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event.currentTarget.clientWidth, event.currentTarget.clientHeight</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">left</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">clientX</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rect</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">left</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function">/2 + '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">px</span></span></span><span class="hljs-function">'; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">top</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">clientY</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rect</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">top</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function">/2 + '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">px</span></span></span><span class="hljs-function">'; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElement</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newRippleElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d, left, top</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">setRippleElements</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[...rippleElements, rippleElement]</span></span></span><span class="hljs-function">); } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newRippleElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d: number, left: string, top: string</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">uuid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div key={key} className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ripple"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style={{width: d, height: d, left, top}} onAnimationEnd={(</span></span></span><span class="hljs-function">) =&gt;</span></span> onAnimationEnd(key)} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderRippleElements</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rippleElements; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;button className={classNames} {...props} onClick={(event</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.onClick) { props.onClick(event); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ripple) { onRippleClick(event); } }} &gt; {children} {renderRippleElements()} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; ); } export default Button;</span></span></code> </pre> <br><p>  Das Endergebnis kann hier gemeldet <a href="https://ui.xmars.io/docs/components/buttons" rel="nofollow">werden.</a> </p><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>  Es wurde eine Menge weggelassen, zum Beispiel, wie das Projekt aufgebaut wurde, wie die Dokumentation geschrieben wurde und wie eine neue Komponente im Projekt getestet wurde.  Ich werde versuchen, diese Themen in separaten Publikationen zu behandeln. </p><br><p>  <a href="http://bit.ly/36dT1JM" rel="nofollow">XMars UI Github-Repository</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de484554/">https://habr.com/ru/post/de484554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de484544/index.html">Einige interessante Methoden für Konsolenobjekte</a></li>
<li><a href="../de484546/index.html">10 beliebte TypeScript-Interviewfragen (mit kurzen Antworten)</a></li>
<li><a href="../de484548/index.html">Wie kritische Sicherheitsanfälligkeit in Citrix NetScaler CVE-2019-19781 ausgeblendete Probleme der IT-Branche aufgedeckt hat</a></li>
<li><a href="../de484550/index.html">Wird in einem IT-Unternehmen Holacracy benötigt: Vor- und Nachteile?</a></li>
<li><a href="../de484552/index.html">Lesen für einen Geek: 10 Materialien zur Audiotechnik - wie Musiktitel, HD-Aufnahmen und 8D-Sound angeordnet sind</a></li>
<li><a href="../de484556/index.html">Also wann ist es noch möglich zu nutzen! Wichtig?</a></li>
<li><a href="../de484564/index.html">Wir schreiben einen Treiber für einen Laptop, um Spaß zu haben und Gewinn zu machen, oder wie man sich auf den Kernel einlässt, selbst wenn man ein Idiot ist</a></li>
<li><a href="../de484568/index.html">Hack The Box - Walkthrough-Spieler. FFmpeg Exploit, JWT und diverse Weblisten</a></li>
<li><a href="../de484572/index.html">Mein Zeit- / Aufgabenmanagement-Ansatz mit VSCode</a></li>
<li><a href="../de484574/index.html">Keine Zecken! Pflanzen gegen Lyme-Borreliose-Vektor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>