<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè© üèùÔ∏è ‚úçÔ∏è Analysieren von CTF-Aufgaben üë®üèø‚Äçüç≥ üéì üîê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anfang Dezember veranstalteten wir einen Teamwettbewerb im Bereich Informationssicherheit. Veranstalter der Veranstaltung f√ºr die ‚Äûwei√üen Hacker‚Äú ware...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analysieren von CTF-Aufgaben</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/482538/">  <i>Anfang Dezember veranstalteten wir einen <a href="https://habr.com/ru/news/t/476892/">Teamwettbewerb</a> im Bereich Informationssicherheit.</i>  <i>Veranstalter der Veranstaltung f√ºr die ‚Äûwei√üen Hacker‚Äú waren neben <a href="https://otus.pw/q7Ro/">OTUS</a> <a href="https://volgactf.ru/">Volga CTF</a> und <a href="https://ctf.moscow/">CTF.Moscow</a> .</i>  <i>Vielleicht ist es an der Zeit, die Aufgaben zusammenzufassen und ausf√ºhrlich zu besprechen.</i> <i><a name="habracut"></a></i> <br><br>  <b>Erstens war die Veranstaltung erfolgreich:</b> <br><br><ul><li>  Es wurden 9 Aufgaben in drei Bereichen vorbereitet: Pentest, Reverse Engineering, Linux-Sicherheit und sichere Entwicklung; </li><li>  217 Teams nahmen teil; </li><li>  √úber 800 Versuche, Flaggen zu √ºbergeben, wurden registriert. </li><li>  Es wurden mehr als 300 Flaggen registriert. </li></ul><br><img src="https://habrastorage.org/webt/wz/hb/ul/wzhbulaaw9vhnblzhk4w9jzpche.png"><br><br>  <b>Zweitens</b> waren die Aufgaben unterschiedlich komplex, sodass nicht jeder das Problem l√∂sen konnte: <br><br><img src="https://habrastorage.org/webt/2e/uh/v3/2euhv3gwoznv4womber0-o-513w.png"><br><br>  <b>Drittens</b> haben wir unmittelbar nach Abschluss des Online-Marathons <b>drei Webinare</b> abgehalten, in denen wir √ºber die Gewinner gesprochen, die richtigen Antworten gegeben und die endg√ºltigen Ergebnisse bekannt gegeben haben: <br><br>  - CTF-Ergebnisse: ‚ÄûLinux-Sicherheit und sichere Entwicklung‚Äú; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/5tt8xsAhYBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - CTF-Ergebnisse: Pentest; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/6Dm-gk86yJk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - die Ergebnisse von CTF: "Reverse Engineering". <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Cx-ALK8laXI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Viertens</b> bieten wir Ihnen die <b>Bedingungen der Aufgaben und textuelle Beschreibungen ihrer L√∂sungen</b> .  Bitte beachten Sie, dass einige Aufgaben Dateien enthalten. <br><br><h3>  Richtung 1: Pentest </h3><br>  <b>Aufgabe 1 - Datenbanken</b> <br><br>  <i>100</i> <i><br><br></i>  <i>Die Site verwendet aktiv Datenbanken.</i>  <i>Versuchen Sie, SQL-Injektionen durchzuf√ºhren.</i> <i><br></i>  <i>Link zur Website: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>L√∂sung:</b> <br><br>  Wir gehen zum Hauptbereich des Ladens / shop / products / und finden, nachdem wir im Suchfeld stecken geblieben sind, SQL Injection. <br><br>  Wir geben 1 "ODER" 1 "=" 1 "- ein, scrollen nach unten und sehen das vorher fehlende Produkt, die Flagge ist in seiner Beschreibung. <br><br>  <b><i>Flag: flag {5ql_1nject10n_15_t00_51mpl3_f0r_y0u}</i></b> <br><br>  <b>Aufgabe 2 - Cookies</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Mein Freund hat eine Online-Shop-Plattform entwickelt.</i>  <i>Er bat um einen Blackbox-Test.</i>  <i>√úberpr√ºfen Sie die Cookie-Sicherheit. M√∂glicherweise k√∂nnen Sie Administratorrechte erhalten.</i> <i><br><br></i>  <i>Link zur Website: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>L√∂sung:</b> <br><br>  Loggen Sie sich ein, schauen Sie sich die Cookies an und sehen Sie sich die geheimen Cookies an: <br><br>  ¬´MTExMTAxMSAxMDAwMTAgMTExMDEwMSAxMTEwMDExIDExMDAxMDEgMTExMDAxMCAxMTAxMTEwIDExMDAwMDEgMTEwMTEwMSAxMTAwMTAxIDEwMDAxMCAxMTEwMTAgMTAwMDEwIDExMTAxMDEgMTExMDAxMSAxMTAwMTAxIDExMTAwMTAgMTAwMDEwIDEwMTEwMCAxMDAwMDAgMTAwMDEwIDExMDEwMDEgMTExMDAxMSAxMDExMTExIDExMDAwMDEgMTEwMDEwMCAxMTAxMTAxIDExMDEwMDEgMTEwMTExMCAxMDAwMTAgMTExMDEwIDEwMDAxMCAxMDAwMTEwIDExMDAwMDEgMTEwMTEwMCAxMTEwMDExIDExMDAxMDEgMTAwMDEwIDExMTExMDE =¬ª <br><br>  Decode base64, erhalten wir die bin√§ren Daten: 1111011 100010 1110101 1110011 1100101 1110010 1101110 1100001 1101101 1100101 100010 111010 100010 1110101 1110011 1100101 1110010 100010 101100 100000 100010 1101001 1110011 1011111 1100001 1100100 1101101 1101001 1101110 100010 111010 100010 1000110 1100001 1101100 1110011 1100101 100010 1111101 <br><br>  Wir √ºbersetzen in Text und erhalten: <code>{"username":"user", "is_admin":"False"}</code> , √§ndern False in True und dekodieren ihn zur√ºck: <br><br>  01111011 00100010 01110101 01110011 01100101 01110010 01101110 01100001 01101101 01100101 00100010 00111010 00100010 01110101 01110011 01100101 01110010 00100010 00101100 00100000 00100010 01101001 01110011 01011111 01100001 01100100 01101101 01101001 01101110 00100010 00111010 00100010 01010100 01110010 01110101 01100101 00100010 01111101 <br><br>  ¬´MDExMTEwMTEgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDExMDExMTAgMDExMDAwMDEgMDExMDExMDEgMDExMDAxMDEgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDAxMDAwMTAgMDAxMDExMDAgMDAxMDAwMDAgMDAxMDAwMTAgMDExMDEwMDEgMDExMTAwMTEgMDEwMTExMTEgMDExMDAwMDEgMDExMDAxMDAgMDExMDExMDEgMDExMDEwMDEgMDExMDExMTAgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDEwMTAxMDAgMDExMTAwMTAgMDExMTAxMDEgMDExMDAxMDEgMDAxMDAwMTAgMDExMTExMDE =¬ª <br><br>  √Ñndern Sie den Wert von Cookies in einen neuen und wechseln Sie zum Benutzerprofil. <br>  <i><b>Flag: flag {d0_y0u_l1k3_c00k13s}</b></i> <br><br>  <b>Aufgabe 3 - Lesen von Dateien</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Oft sto√üen wir auf undichte Quellen und seltsame Logik der Arbeit.</i>  <i>M√∂gliche Angriffsvektoren werden normalerweise durch Fuzzing gefunden.</i>  <i>Ich schlage vor, Sie tun dies.</i> <i><br><br></i>  <i>Link zur Website: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>L√∂sung:</b> <br><br>  Wir starten dirb (normales common.txt reicht), wir finden pages <code>/shop/_source/</code> und <code>/shop/files/</code> . <br><br>  Nachdem wir uns mit der Quelle <code>_source</code> vertraut <code>_source</code> wir, dass wir die Path Traversal-Schwachstelle und einige einfache Filter haben. <br><br>  Um das Flag zu erhalten, m√ºssen Sie eine POST-Anforderung an <code>/shop/files/</code> mit dem Parameter "file" senden, dessen Wert <code>%2E%2E/%2E%2E/flag</code> . <br><br>  Als Antwort auf die Anfrage wird eine Flagge angezeigt. <br><br>  <i><b>Flag: flag {y0u_g0t_0ur_s3cr3t}</b></i> <br><br><h3>  Anweisung 2: "Linux-Sicherheit und sichere Entwicklung" </h3><br>  <b>Aufgabe 1 - VCS</b> <br><br>  50 <br><br>  <i>Aber hat uns der Kunde etwas √úberfl√ºssiges gegeben?</i> <i><br></i>  <i>Das Archiv enth√§lt den Quellcode f√ºr einen Teil der Site.</i> <i><br></i>  <i>Link zur Website: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Anlage: task.7z</i> <br><br>  <b>L√∂sung:</b> <br><br>  Wir haben Zugriff auf den Quellcode.  Wie sich herausstellte, haben die Entwickler auch ein Git-Repository erstellt.  Wir schauen uns git log an und sehen Commit mit Fixes.  Wir benutzen git show &lt;hash commit&gt;, wir sehen die ge√§nderten Dateien und ihren Inhalt, ein Flag ist in einer der Zeilen gespeichert. <br><br>  <i><b>flag {22717297f6a3603608d260c9e5f69e0a}</b></i> <br><br>  <b>Aufgabe 2 - Algo</b> <br><br>  <i>50</i> <i><br><br></i>  <i>Wir haben eine neue Herausforderung.</i>  <i>F√ºhren Sie eine sichere Entwicklungspr√ºfung durch.</i>  <i>Der Kunde stellte ein Archiv mit dem offenen Teil der zu entwickelnden Site zur Verf√ºgung.</i>  <i>Um seinen Hash-Algorithmus zu testen, stellte er einen Hash bereit: 666c61677b32646733326473323334327d.</i>  <i>√úberpr√ºfen Sie den Algorithmus auf die M√∂glichkeit einer inversen Transformation.</i> <i><br><br></i>  <i>Das Archiv enth√§lt den Quellcode f√ºr einen Teil der Site.</i> <i><br></i>  <i>Link zur Website: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Anlage: task.7z</i> <br><br>  <b>L√∂sung:</b> <br><br>  Der Quellcode hat einen Passwort-Hashing-Algorithmus.  Tats√§chlich handelt es sich nicht um einen Hashing-Algorithmus, sondern lediglich um die Konvertierung von Daten aus einem Zeichenfolgenformat in hexadezimal. <br><br>  Wir benutzen Python: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> binascii binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">"666c61677b32646733326473323334327d"</span></span>)</code> </pre> <br>  Wir <i><b>bekommen die</b></i> Flagge: <i><b>flag {2dg32ds2342}</b></i> <br><br>  <b>Aufgabe 3 - Files files files</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Beenden wir das Audit.</i>  <i>Sehen Sie diese Sicherheitsanf√§lligkeit auch?</i>  <i>Gro√üartig.</i>  <i>So ist es f√ºr Sie einfach, eine geheime Datei zu erhalten.</i> <i><br></i>  <i>Das Archiv enth√§lt den Quellcode f√ºr einen Teil der Site.</i> <i><br></i>  <i>Link zur Website: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Anlage: task.7z</i> <br><br>  <b>L√∂sung:</b> <br><br>  Im Quellcode des Hauptmoduls des Programms k√∂nnen Sie den Leser von Dateien bemerken (dies ist die Hauptanwendung dieses Dienstes).  Die Funktion zum √úberpr√ºfen des Vorhandenseins einer Datei sucht in keiner Weise nach Sonderzeichen und verkettet einfach zwei Zeilen =&gt; Sicherheitsanf√§lligkeit durch Pfad√ºberquerung. <br><br>  Au√üerdem k√∂nnen Sie in Dockerfile, docker-compose.yml, die Dateizuordnungen und die Struktur des Ladens in den Container sehen.  Mit diesem Wissen erzeugen wir eine Nutzlast: <br><br><pre> <code class="plaintext hljs">http://193.41.142.9:8002/files?password=qgzc6!78zxcbkj123fdgd234&amp;filename=../../../../../../src/secret_files/flag.txt</code> </pre> <br>  <i><b>flag {a0a7c3fff21f2aea3cfa1d0316dd816c}</b></i> <i><b><br></b></i> <br><h3>  Richtung 3: "Reverse Engineering" </h3><br>  <b>Aufgabe 1 - Schlange</b> <br>  <i>100</i> <i><br><br></i>  <i>Unser Unternehmen ist stets bem√ºht, jeglichen Softwareschutz zu umgehen.</i>  <i>Helfen Sie uns, dieses Mal mit Python fertig zu werden.</i> <i><br></i>  <i>Angeh√§ngte Datei: task.pyc</i> <br><br>  <b>L√∂sung:</b> <br><br>  Wir verwenden den Python-Bytecode, der vom uncompyle6-Modul dekompiliert wurde: <br>  uncompyle6 task.pyc. <br>  Wir dekompilieren, wir bekommen eine Flagge: <br><br>  <i><b>flag {w3l1_pyth0n}</b></i> <i><b><br></b></i> <br>  <b>Aufgabe 2 - Roboter</b> <br>  <i>150</i> <i><br><br></i>  <i>Dieses Mal sind wir auf eine seltsame Anwendung gesto√üen. Hilf mir, das Passwort f√ºr die Eingabe zu finden.</i> <i><br></i>  <i>Anhang: app.apk</i> <br><br>  <b>L√∂sung:</b> <br><br>  Die Anwendung ist auf Android, laden Sie sie also einfach in einen statischen Analysator wie BytecodeViewer und sehen Sie den wiederhergestellten Quellcode des Programms.  Beachten Sie, dass dies Kotiln ist und wie in diesem Fall h√§ufig funktionale Programmierung verwendet.  In einer der dekompilierten anonymen Funktionen finden wir die Flag-Pr√ºfung, die Pr√ºfung selbst: <br><br><pre> <code class="kotlin hljs">(String)paramFunction1.invoke(<span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>.valueOf(Arrays.equals(paramString, h)));  invoke: ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">"flag{"</span></span>); ((StringBuilder)localObject).append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$m); ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">'}'</span></span>);</code> </pre> <br>  Variable h: {102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50, 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55}; <br><br>  Wir sehen, dass es wie codierte gedruckte Zeichen aussieht.  Wir benutzen Python: <br><br>  '' .join (chr (x) f√ºr x in [102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50 , 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55]) <br><br>  Wir bekommen die Flagge: <br><br>  <i><b>flag {fa2bf646e49ab5e56f2b74480ba61017}</b></i> <i><b><br></b></i> <br>  <b>Quest 3 - Bin</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Diesmal sind wir auf eine Bin√§rdatei gesto√üen.</i>  <i>Die Aufgabe ist die gleiche, holen Sie sich das geheime Passwort.</i> <i><br></i>  <i>Anlage: Aufgabe</i> <br><br>  <b>L√∂sung:</b> <br>  Es wird eine Bin√§rdatei angegeben.  Wir laden in den Disassembler und sehen sechs in C ++ geschriebene Validierungsfunktionen. <br><br>  Sie werden identisch ausgef√ºhrt und ineinander aufgerufen, wobei das Flag in 5er-St√ºcken gepr√ºft wird. <br><br>  Wir stellen es schrittweise mit Informationen aus dem Disassembler wieder her.  Wir bekommen die Flagge in Teilen: <br><br>  0) L√§ngenpr√ºfung <br>  1) flag { <br>  2) feefa <br>  3) _172a <br>  4) k14sc <br>  5) _eee} <br><br>  Kombiniere und erhalte die Flagge: <br><br>  <i><b>flag {feefa_172ak14sc_eee}</b></i> <br><br>  Das ist alles, Kollegen!  Vielen Dank f√ºr Ihre Teilnahme, k√ºmmern Sie sich um sich selbst, Ihre Lieben und Ihre Daten!  Frohes neues Jahr! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482538/">https://habr.com/ru/post/de482538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482526/index.html">Jubil√§umsvortrag von Donald Knuth "Am Weihnachtsbaum"</a></li>
<li><a href="../de482530/index.html">Gewidmet: Technologie, die 2019 starb</a></li>
<li><a href="../de482532/index.html">Sprint Puls: Aufbau einer effektiven Arbeit in einem gro√üen Team</a></li>
<li><a href="../de482534/index.html">Nochmals zur Komplexit√§t der Architektur und der Eintrittsschwelle</a></li>
<li><a href="../de482536/index.html">Pixelkunst f√ºr Anf√§nger: Gebrauchsanweisung</a></li>
<li><a href="../de482540/index.html">Software VS Hardware: Was ist im Trend und wer ist die Zukunft?</a></li>
<li><a href="../de482544/index.html">Ein Startup-Team mit ‚Äû0‚Äú zusammenstellen - Schritt-f√ºr-Schritt-Anleitung f√ºr die Kleinsten</a></li>
<li><a href="../de482546/index.html">VK Tech: Ein Jahr der Entwicklung in Git-Zahlen</a></li>
<li><a href="../de482548/index.html">Sicherheitswoche 52 + 1: Nicht-Standard-Top-3-Nachrichten des Jahres</a></li>
<li><a href="../de482550/index.html">Das mysteri√∂se LyX-Programm. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>