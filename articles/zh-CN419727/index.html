<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🔧 🖐🏻 👌🏿 港口-开箱即用的Docker容器的注册表 ♟️ 👨🏾 〰️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="7月31日，CNCF 宣布在其沙盒（即最早的支持阶段）中采用了一个新的开源项目，称为“云本机注册表”。 他们在他的网站上向我们解释说，该产品是为了在安全的环境中管理Docker容器的映像而创建的。 



 似乎已经有一个Docker Registry（或者说是CoreOS的Quay），但是很明显，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>港口-开箱即用的Docker容器的注册表</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/419727/">  7月31日，CNCF <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">宣布</a>在其沙盒（即最早的支持阶段）中采用了一个新的开源项目，称为“云本机注册表”。 他们在他的网站上向我们解释说，该产品是为了在安全的环境中管理Docker容器的映像而创建的。 <br><br><img src="https://habrastorage.org/webt/to/ed/6i/toed6ijlvl_n0r90t6rgvmzbixa.png"><br><br> 似乎已经有一个Docker Registry（或者说是CoreOS的Quay），但是很明显，新的解决方案没有出现并且没有像这样成熟到生产使用-尤其是开源解决方案...甚至更多， CNCF。 这篇评论文章旨在阐明Harbor出现的原因，其主要特征和功能。 <a name="habracut"></a><br><br><h2> 港湾的首要重点：网络和企业 </h2><br> 该项目的历史始于2016年，3月首次公开发布-0.1.0。  <b>VMware</b>工程师支持该项目的创建，后者将该项目描述为“企业级注册表服务器”，它基于Docker的发展，“通过添加企业中通常需要的更多功能来扩展Docker Registry的功能”。 <br><br> 当时，重点更多地放在公司内部使用此注册表的可能性上，特别是通过将映像存储在公司网络上来潜在地提高生产力：“ [Harbor]对于没有良好Internet连接的容器用户非常有用。 例如，Harbour消除了从公共Internet下载图像的麻烦” <i>（从<a href="">README到Harbor 0.1.0</a> ）</i> ，从而提高了中国开发人员的生产力。 <br><br>  <i><b>注意</b> ：从最初的发行版开始就已经存在适当的本地化，这证实了Harbour面向中国的方向并非偶然：该项目的创建是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">由公司</a>的中国部门（VMware China R＆D） <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发起的</a> 。</i> <br><br> 在原生云环境中，Harbor从一开始就使用<b>Go语言编写，</b>并根据Apache License 2.0的条款获得许可。 如果我们谈论项目的功能，那么在第一个版本中，作者到目前为止已经列出了一些相关功能，例如： <br><br><ul><li> 基于角色的访问控制（ <b>RBAC</b> ，它使您可以将用户和存储库组织为“项目”，并对这些项目中的图像赋予不同的权限），以及用于用户身份验证的LDAP和AD支持； </li><li>  <b>基于Web的用户界面，</b>用于查看存储库，搜索存储库，管理项目； </li><li>  <b>审核</b>所有操作； </li><li>  <b>REST API</b>进行管理。 </li></ul><br><img src="https://habrastorage.org/webt/jj/jw/gx/jjjwgxrboqn0rq3tpcut7_ydbqc.png"><br>  <i>Harbor Web UI中的项目管理</i> <br><br><h2> 港口演变：安全 </h2><br>  2017年，VMware在其新项目中找到了合乎逻辑的应用程序-与其他公司的容器解决方案集成。 特别是，不是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>集成的</b></a> PaaS（平台即服务）或CaaS（容器即服务）的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>vSphere Integrated Container</b></a> （VIC）正在积极开发中，为使用容器提供了某种基础。 如今，例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">vSphere Integrated Containers Engine</a> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">vSphere</a>的容器运行时）已经从中脱颖而出。 这是VMware（Nate Reid）解决方案工程师当时对VIC的描述： <br><br><blockquote>  <i>“ VIC采用单个Docker主机的框架，并将其扩展到多个ESXi主机。</i>  <i>他提出的业务流程架构类似于Swarm，Kubernetes（K8s）和Mesos。</i>  <i>但是，有一些细微差别，因此没有取代所有这些产品的任务。</i>  <i>VIC提供了用于容器的网络，允许您获取容器的名称，提供RBAC，HTML5控制面板（海军上将；在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker的GUI审查中</a>了解有关此内容的更多信息<b>-Transl。</b> ），企业级注册表（Harbor），许多类似的Docker命令，与vSphere工具集成。</i>  <i>[..]</i> <i><br><br></i>  <i>如果您需要Kubernetes编排支持和/或VMware的基于VMware IaaS的CI / CD功能，则应查看VMware PKS和/或Pivotal Cloud Foundry。</i>  <i>这些已经是CaaS和PaaS解决方案。”</i> </blockquote><br> 同时<b>，Docker映像</b>的<b>安全性</b>问题变得越来越重要。 在2018年初，VMware公司Pivotal的“兄弟”工程师<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">引用</a>了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一项研究</a> ，该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">研究表明</a> ，即使在Docker Hub上发布的最新版本的映像（来自社区和官方）也包含众多漏洞（每个映像平均70个）。 <br><br> 那时，Harbour出现了其以安全为导向的新使命，并且已经在上述的CaaS的“基础”上–在<b>Pivotal Container Service（PKS）中</b> ： <br><br><blockquote>  <i>“ [[Docker映像中的漏洞和其他安全问题]是我们包含如此众多有用的附加组件的原因，这些附加组件使PKS可靠且安全！”</i>  <i>[..]</i> <i><br><br></i>  <i>由于仅Kubernetes不能解决此类问题（安全映像管理），所以我们与VMware的朋友一起将Harbor纳入PKS。”</i> </blockquote><br> 除了在项目中已经实施的RBAC和审核之外，对Harbour而言，有什么安全的补充？ 指出了两个主要方向： <br><br><ol><li>  <b>漏洞扫描</b> 为此，Harbor从知名数据库（NIST NVD，Ubuntu CVE Tracker，Red Hat Security Data等）实现CVE，并在执行推和拉操作时自动扫描每个容器映像是否存在。 如果发现漏洞，则将根据安全设置取消操作，并标记图像本身，这对于注册表管理员来说是可见的。 为了实现这一机会，Harbour与CoreOS的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>Clair</b></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">集成</a> 。 </li><li>  <b>图像的签名</b> 。 它还使用了另一个项目的成就<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>-Notary</b></a> <i>（我们在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">本文中</a>提到过）</i> ，该项目在推送图像时进行签名，然后在每次拉动时验证此类签名。 </li></ol><br>  Harbour在PKS中的一般应用如下： <br><br><img src="https://habrastorage.org/webt/va/2s/cz/va2sczdfs6gzhomzofl4gb3mioi.png"><br><br><h2> 今日港 </h2><br> 因此，通过提供用于本地使用的容器映像的注册表并在与它们一起使用的各个方面提供安全性，如今Harbor已发展为以下架构，该架构显然结合了其他开源项目的功能： <br><br><img src="https://habrastorage.org/webt/5w/5i/lx/5w5ilxohbp2zf-6l5suz8fdieec.png"><br><br> 除了已经提到的实现了Harbor关键功能的Docker Registry，Clair和Notary之外，您还可以在此方案中看到两个DBMS： <br><br><ol><li>  PostgreSQL（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">以前是</a> MySQL / MariaDB），用于存储有关项目，用户及其角色，图像的元数据； </li><li>  Redis-用于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">存储会话</a> 。 </li></ol><br><img src="https://habrastorage.org/webt/gt/zm/lx/gtzmlxpeuwevt1bugxmhqa4s2h4.jpeg"><br>  <i>港口建筑中的数据库</i> <br><br> 您还<i>可以</i>从此<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Wiki页面上</a> <i>找到</i>有关通用Harbor内部设备的<i>一些详细信息</i> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">该页面</a>链接到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">该</a>项目的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">官方文档</a> <i>（但是，怀疑该体系结构的某些详细信息在某些地方可能已过时）</i> 。 在这里，您还可以找到指向<a href="">Harbour安装</a>说明并将其<a href="">部署到Kubernetes的链接</a> 。 但是，后者被宣布已作废（基于旧版本，不支持Clair和Notary），而是建议使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Helm-chart</a> 。 <br><br>  Harbor的当前版本是<a href="">v1.5.2</a> ，已于7月下旬发布。 安装最新注册表版本的Linux机器的要求是Docker版本17.03.0-ce（或更高版本）和Docker Compose 1.10.0+，以及Python和OpenSSL。 <br><br>  <b>支持Helm图表</b>对于未来的Harbor版本（已经发布了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">v1.6.0-rc1</a> ）来说似乎是一个非常有趣的创新：“从1.6.0版本开始，Harbor将会成为一个复合云原生注册表，同时支持图像管理和图表管理” 。 其他<a href="">开发计划</a>包括OAuth 2.0支持用户身份验证，能够部署到多个站点以实现容错和负载平衡，收集存储库统计信息以及用于迁移到Harbor的实用程序的能力。 <br><br><h2> 而不是结论 </h2><br>  Harbor是现代云世界中一个成功项目的一个示例，该项目设法找到了自己的优势并建立了自己，同时集成了其他开源工具的功能。 他成功的证据不仅是将CNCF包含在项目列表中，还包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub上的</a> 5000颗星，以及一个相当活跃的开发者社区。 <br><br><h2> 聚苯乙烯 </h2><br> 另请参阅我们的博客： <br><br><ul><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CNCF云原生开源解决方案指南（及更多）</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OPA和SPIFFE-CNCF的两个用于云应用程序安全性的新项目</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">四个CNCF在KubeCon 2017上发布了有关Kubernetes的1.0版和重要公告</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubernetes的程序包经理-Helm：过去，现在，将来</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CNCF为DevOps /微服务的开源项目提供了免费的云</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker Hub上映像中基本操作系统的统计信息</a> 。” </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN419727/">https://habr.com/ru/post/zh-CN419727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN419715/index.html">您不知道如何进行交易</a></li>
<li><a href="../zh-CN419717/index.html">设计嵌入式应用程序架构</a></li>
<li><a href="../zh-CN419719/index.html">[书签]保护Node.js应用程序的23条建议</a></li>
<li><a href="../zh-CN419721/index.html">衰老的生物标志物。 面板脆弱。 第一部分</a></li>
<li><a href="../zh-CN419725/index.html">飞镖，骰子和硬币：离散分布算法</a></li>
<li><a href="../zh-CN419729/index.html">慈善活动“为孩子们展翅高飞”</a></li>
<li><a href="../zh-CN419731/index.html">牙科光敏聚合物3D打印机MoonRay S的迷你回顾</a></li>
<li><a href="../zh-CN419733/index.html">Git发生了！ 6个常见的Git错误以及如何修复</a></li>
<li><a href="../zh-CN419735/index.html">使用Adobe Audition使用SDR检查I / Q信号</a></li>
<li><a href="../zh-CN419743/index.html">流行文章告诉我foo比bar快怎么办？</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>