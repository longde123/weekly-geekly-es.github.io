<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏨 👅 🚋 在Unity中创建简单的C＃AI 📰 💑 📂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="几乎任何游戏都需要与用户互动的人工智能（AI），通常以对玩家不利的力量形式出现。 在某些情况下，AI应该帮助玩家，而在另一些情况下，AI应当与之战斗，但是计算机控制的所有角色都有一些相似之处。 根据项目的要求，AI可以使用简单或复杂的行为。 这些要求可能是与其他玩家进行外交交流，或者是在平台上来回徘...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在Unity中创建简单的C＃AI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419641/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f53/d1b/432/f53d1b43283124f71239cc56289eabfb.jpg" alt="图片"></div><br> 几乎任何游戏都需要与用户互动的人工智能（AI），通常以对玩家不利的力量形式出现。 在某些情况下，AI应该帮助玩家，而在另一些情况下，AI应当与之战斗，但是计算机控制的所有角色都有一些相似之处。 根据项目的要求，AI可以使用简单或复杂的行为。 这些要求可能是与其他玩家进行外交交流，或者是在平台上来回徘徊。 尽管如此，有必要确保AI有效地完成其工作。 <br><br> 在这个项目中，我将演示一个非常简单的人工智能。 假设我们创建了一个游戏，其中玩家必须潜入敌方总部附近。 当监控摄像头注意到玩家时，会在附近制造敌人并在短时间内追赶该玩家。 这就是我们在项目中最简单的实现。 项目完成后，您将收到一个受控的玩家对象，一个用作敌方相机的圆圈，以及一个敌人的对象，当相机的对象告知其存在时，该对象会追赶玩家。 <br><a name="habracut"></a><br><h2> 准备工作 </h2><br> 首先，我们需要创建一个3D项目。 启动Unity之后，单击窗口顶部的<em>New</em>按钮，如图1所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c16/bbf/df1/c16bbfdf150bec53113bc7955f901e64.jpg"></div><br>  <i>图1：创建一个新项目</i> <br><br> 为您的<em>AI</em>项目命名，并确保它是3D项目。 在计算机上选择一个存储项目的位置之后，单击底部的<em>Create Project</em>按钮，如图2所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3b/f46/c21/a3bf46c21915b44510b6052688e4f3c0.jpg"></div><br>  <i>图2：项目设置屏幕</i> <br><br> 创建项目后，我们要做的第一件事是在“ <em>资产”</em>窗口中设置文件夹以组织我们的工作。 右键单击<em>Assets</em>窗口，然后选择<em>Create→Folder</em>创建一个新文件夹。 将此文件夹命名为<em>Materials</em> 。 然后创建第二个文件夹，并将其命名为<em>Scripts</em> 。 图3显示了它的外观。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db9/68a/709/db968a709778fc5f679ea8dcfd525222.jpg"></div><br>  <i>图3：创建一个新文件夹</i> <br><br> 完成所有这些操作后，“ <em>资产”</em>窗口应类似于图4所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed8/a95/6f8/ed8a956f80044386ef356d0877931184.jpg"></div><br>  <i>图4：“ <em>资产”</em>窗口。</i> <br><br> 接下来，创建一个所有对象都将站立的地板。 在“ <em>层次结构”</em>窗口中，选择“ <em>创建”→“ 3D对象”→“平面”</em>以创建将用作地板的平面对象。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e95/770/adc/e95770adc4bcf7c49f6398634cfb7dcc.jpg"></div><br>  <i>图5：创建平面对象。</i> <br><br> 命名此<em>Floor</em>对象，并将其<em>X Scale</em>值更改为7，将<em>Z Scale</em>值更改为3。之后，带有所选<em>Floor</em>对象的<em>Inspector</em>窗口应如图6所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/428/36f/88a/42836f88a4e028e07aa3d8d63e8c90c6.jpg"></div><br>  <i>图6：设置<em>Floor</em>对象的属性。</i> <br><br> 现在，我们需要为<em>地板</em>创建一个新的材质，以将其与将要放置在场景中的其余对象区分开。 在“ <em>资产”</em>窗口的“ <em>材料”</em>文件夹中，右键单击“ <em>资产”</em>窗口，然后选择“ <em>创建”→“材料”</em> ，以创建新<em>材料</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/790/e22/47c/790e2247cd0c57040bc20f46d2df93d0.jpg"></div><br>  <i>图7：创建新材料</i> <br><br> 完成后，将物料命名为<em>Floor</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb7/3fc/092/bb73fc09241585429e335997e0cc0ac4.jpg"></div><br>  <i>图8： <em>地板</em>材料。</i> <br><br> 在选择了“ <em>地板”</em>的“ <em>检查器”</em>窗口的顶部，选择一个颜色选择器。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a98/e7e/211/a98e7e21145de32f77d8ba0346f36587.jpg"></div><br> 图9：选择一个颜色选择器。 <br><br> 当然，您可以为地板选择任何颜色，但是在此示例中，我选择了红棕色，如图10所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ec/bed/360/3ecbed3607552e16d2dc9973c35cdceb.jpg"></div><br> 图10：颜色选择器。 <br><br> 在“ <em>层次结构”</em>窗口中选择“ <em>地板”</em>对象，然后在“ <em>网格渲染器”</em>组件中，选择“ <em>材质”</em>旁边的小箭头。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/061/3f6/545/0613f6545880f95c917b481336c2589a.jpg"></div><br>  <i>图11：准备材料更改。</i> <br><br> 将<em>地板</em>材料从“ <em>资源”</em>窗口拖动到“ <em>检查器”</em>窗口中“ <em>网格渲染器”</em>组件的“ <em>元素0”</em>字段。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/3fe/247/e7d3fe24725c026b1d95f823ecd6832c.jpg"></div><br>  <i>图12：将<em>Floor</em>材质定义为<em>Floor</em>对象的材质。</i> <br><br> 完成了<em>地板</em>对象后，我们需要围绕墙壁区域进行创建，以使播放器不会掉落边缘。 返回<em>创建→3D对象→平面</em>以创建一个新平面。 我们称该<em>墙为</em>平面，并将其设置为与<em>Floor</em>相同的尺寸，即<em>X Scale</em>的值为7， <em>Z Scale</em>的值为3。然后再创建三个墙，选择一个对象，然后按Ctrl + D 3次。性别与表格中的数据一致。 <br><br><table><tbody><tr><td>  <strong>职称</strong> <br></td><td>  <strong>位置X</strong> <br></td><td>  <strong>位置Y</strong> <br></td><td>  <strong>位置z</strong> <br></td><td>  <strong>旋转x</strong> <br></td><td>  <strong>旋转z</strong> <br></td></tr><tr><td> 墙 <br></td><td>  -35 <br></td><td>  21 <br></td><td>  0 <br></td><td>  0 <br></td><td>  -90 <br></td></tr><tr><td> 墙（1） </td><td>  -1 <br></td><td>  11 <br></td><td>  -15 <br></td><td>  90 <br></td><td>  0 <br></td></tr><tr><td> 墙（2） <br></td><td>  -1 <br></td><td>  11 <br></td><td>  13.5 <br></td><td>  -90 <br></td><td>  0 <br></td></tr><tr><td> 墙（3） <br></td><td>  34 <br></td><td>  21 <br></td><td>  0 <br></td><td>  0 <br></td><td>  90 </td></tr></tbody></table><br> 表1：所有<em>Wall</em>对象的位置和旋转。 <br><br> 完成所有这些操作后，您需要更改摄像头的位置，以使其从上方看向地面。 选择<em>主摄像机</em>对象，然后将“ <em>Y位置”</em>设置为30，将“ <em>Z位置”设置</em>为0，将“ <em>X旋转”设置</em>为80。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e3b/794/765/e3b794765d6fcb079014a487f435bf24.jpg"></div><br>  <i>图13：设置相机对象。</i> <br><br> 场景已经准备好了，是时候创建玩家角色了。 在“ <em>层次结构”</em>窗口中，单击<em>创建→3D对象→球体</em>以创建球体对象。 将该对象命名为<em>Player</em> ，然后单击“ <em>检查器”</em>窗口底部的“ <em>添加组件”</em>按钮。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/247/713/079/24771307910b2c0aaf9f19d2c74b6d9a.jpg"></div><br>  <i>图14：添加一个新组件。</i> <br><br> 现在找到<em>刚体</em> 。 之后，从列表中选择<em>Rigidbody</em>组件并将<em>Rigidbody</em>添加到<em>Player</em>对象。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f3f/01e/f41/f3f01ef412da352b4131c02be07535df.jpg"></div><br>  <i>图15：添加<em>刚体</em>组件。</i> <br><br> 接下来，您需要为玩家分配一个标签，该标签稍后会在代码中派上用场。 单击<em>检查器</em>窗口左上角的“ <em>标签”</em>下拉菜单，然后选择“ <em>播放器”</em>标签。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c35/764/224/c35764224a4bb55b3e725c29aa597e19.jpg"></div><br>  <i>图16：定义新标签。</i> <br><br> 我们需要设置玩家的位置，使其不在<em>地板</em>对象下方。 在示例中，我将播放器放置在左上角，其中<em>X位置</em>等于26， <em>Y位置</em>等于1， <em>Z位置</em>等于-9。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b0/a09/4bf/2b0a094bf170d2d2fb3bb11fd54a5ab1.jpg"></div><br>  <i>图17：球员位置。</i> <br><br> 为了使将来的代码正常工作，我们当然需要将其附加到对象上。 返回到“ <em>层次结构”</em>窗口，这次选择“ <em>创建”→“ 3D对象”→“多维数据集”</em> 。 调用此<em>Guard</em>多维数据集，使用“ <em>检查器”</em>窗口中的“ <em>添加组件”</em>按钮向其中添加<em>Rigidbody</em>组件和<em>NavMesh Agent</em>组件。 接下来，将其放置在场景的左上角。 之后， <em>Guard</em>对象的<em>Inspector</em>窗口将如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/698/d9e/79d/698d9e79d24de65f2586482ed3ffa03b.jpg"></div><br>  <i>图18：“ <em>检查器”</em>窗口中的<em>Guard</em>对象。</i> <br><br> 这个对象应该位于这样的位置： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/873/202/f6c/873202f6c470ad2b5b2233dd2fbe7a7f.jpg"></div><br>  <i>图19： <em>Guard</em>对象的位置。</i> <br><br> 最后，我们需要一个用作<em>守卫</em>对象“眼睛”的对象，它将通知<em>守卫</em>玩家正在触摸它。 上一次，进入“ <em>层次结构”</em>窗口，然后选择“ <em>创建”→“ 3D对象”→“球体”</em>以创建另一个球体对象。 将此对象命名为<em>Looker</em> 。 这次我们不需要添加任何其他组件。 但是，我们将调整对象的大小。 选择<em>Looker之后</em> ，在“ <em>检查器”</em>窗口中更改以下“ <em>变换”</em>组件变量。 <br><br><ul><li>  <em>X缩放</em>为9。 </li><li> 以0.5 <em>缩放Y。</em> </li><li>  <em>Z标尺</em>为9。 </li></ul><br> 然后，将<em>Looker</em>放置在地板的中间上部，如图20所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/021/427/aea/021427aea8c433f0d4beb49dcacf75ac.jpg"></div><br>  <i>图20：查找器的位置。</i> <br><br> 现在是为<em>Looker提供</em>独特材料的正确时机，这样您就可以避免使用它。 在“ <em>资源”</em>窗口的“ <em>材料”</em>文件夹中，右键单击并创建一个新材料。 将其命名为<em>Looker</em>并为其赋予明亮的红色。 之后，将此材质指定为<em>Looker</em>对象的材质以更改其颜色。 之后，场景应如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fd4/252/185/fd42521851c8f10540156ddd8678ce21.jpg"></div><br>  <i>图21：具有新材质的<em>Looker</em>对象。</i> <br><br> 我们剩下的唯一事情就是为<em>Guard</em>创建一个导航网格，它可以在上面移动。  Unity编辑器顶部有一个<em>Window</em>菜单。 选择“ <em>窗口”→“导航”</em>以打开“ <em>导航”</em>窗口，如图22所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc8/f06/7b1/dc8f067b1f605af22531520c1de2f28f.jpg"></div><br>  <i>图22： <em>导航</em>窗口。</i> <br><br> 在“ <em>层次结构”中</em>选择<em>Floor</em>对象，然后在“ <em>导航”</em>窗口中，选中“ <em>导航静态”</em>复选框。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f67/62e/b41/f6762eb4161c64a5388901e73909f1fc.jpg"></div><br>  <i>图23： <em>静态导航</em> 。</i> <br><br> 接下来，选择窗口顶部的“ <em>烘烤”</em>选项。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/025/7d0/dce/0257d0dce38af90396512cb4bd205316.jpg"></div><br>  <i>图24：切换到“ <em>烘烤”</em>菜单。</i> <br><br> 将打开“ <em>烘焙”</em>菜单，您可以在其中更改将要创建的导航网格的属性。 在我们的示例中，无需进行任何更改。 只需单击右下角的“ <em>烘焙”</em>按钮。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddd/ec7/6b8/dddec76b89364a5f66168b3cbd0c6fbb.jpg"></div><br>  <i>图25：创建一个新的导航网格。</i> <br><br> 此时，Unity将要求您保存场景。 保存它，之后将创建导航网格。 现在，场景将如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f53/d1b/432/f53d1b43283124f71239cc56289eabfb.jpg"></div><br>  <i>图26：当前场景以及添加的导航网格。</i> <br><br> 现在，Unity中的所有内容都已配置完毕，现在该创建创建项目所需的脚本了。 在<em>Assets</em>窗口中，右键单击并选择<em>Create→C＃Script</em> 。 将此脚本命名为<em>Player</em> 。 再重复两次此操作，创建名称为<em>Guard</em>和<em>Looker的</em>脚本。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/12e/fb2/26b/12efb226b1de229b7c9b13eb69f0f483.jpg"></div><br>  <i>图27：创建一个新脚本。</i> <br><br> 之后，“ <em>资产”</em>窗口中的“ <em>脚本”</em>文件夹将如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/a2f/2a5/e7da2f2a5c94ee8683aed4179721e9bb.jpg"></div><br>  <i>图28： <em>脚本</em>文件夹。</i> <br><br> 首先，我们将开始编写<em>Player</em>脚本代码。 在<em>Assets</em>窗口中双击<em>Player</em>脚本以打开Visual Studio并开始创建代码。 <br><br><h2> 代号 </h2><br>  <em>Player</em>脚本非常简单，它所要做的就是让用户移动球对象。 在类声明下，我们需要获取到先前在项目中创建的<em>Rigidbody</em>组件的链接。 <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rigidbody rb;</code> </pre> <br> 之后，在<strong>Start</strong>函数中，我们命令Unity将<em>Player</em>对象的当前<em>Rigidbody</em>组件设置为<em>rb</em> 。 <br><br><pre> <code class="cs hljs">rb = GetComponent&lt;Rigidbody&gt;();</code> </pre> <br> 之后， <em>播放器</em>脚本将如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/017/686/297/017686297368cffbd3ea3980b6036181.jpg"></div><br>  <i>图29：目前的<em>播放器</em>脚本。</i> <br><br> 现在已分配了<em>rb</em>值，我们需要在按下箭头键时让<em>Player</em>对象移动。 为了移动对象，我们将使用物理方法，当用户按下箭头键时向对象施加力。 为此，只需将以下代码添加到<em>Update</em>函数： <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.UpArrow)) rb.AddForce(Vector3.forward * <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.DownArrow)) rb.AddForce(Vector3.back * <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftArrow)) rb.AddForce(Vector3.left * <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.RightArrow)) rb.AddForce(Vector3.right * <span class="hljs-number"><span class="hljs-number">20</span></span>);</code> </pre> <br> 至此，我们完成了<em>Player</em>脚本。 完成的脚本如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/82e/fc6/3cf82efc6aaef7dc0e7c8c6f21b503ff.jpg"></div><br>  <i>图30：完成的<em>Player</em>脚本。</i> <br><br> 保存您的工作并返回Unity。 这次，在<em>Assets</em>窗口中选择<em>Guard</em>脚本。 为了使<em>Guard</em>代码正常工作，您需要在脚本顶部添加using结构。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.AI;</code> </pre> <br> 接下来，在类声明之后立即声明以下变量。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject player; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NavMeshAgent navmesh;</code> </pre> <br>  <strong>Player</strong>对象用作<em>Guard</em>对象的<strong>player</strong>变量的值。 稍后，当我们命令<em>Guard</em>对象追逐玩家时，它将派上用场。 然后， <strong>声明navmesh</strong>变量以接收对象的<em>NavMeshAgent</em>组件。 当<em>守卫</em>得知玩家正在触摸<em>Looker</em>对象后，我们开始追逐玩家时，我们将使用它。 在<strong>启动</strong>功能中，我们需要将<em>navmesh</em>变量的值设置<em>为</em>对象<em>的</em>组件<em>NavMesh Agent</em> ： <br><br><pre> <code class="cs hljs">navmesh = GetComponent&lt;NavMeshAgent&gt;();</code> </pre> <br> 然后，在<em>Update</em>函数中，添加一行代码： <br><br><pre> <code class="cs hljs">navmesh.destination = player.transform.position;</code> </pre> <br> 此行设置<em>Guard</em>对象的目标。 在我们的例子中，它将采用<em>Player</em>对象的当前位置并移至这一点。 操作后，物体将不断追随玩家。 问题是，响应过程如何执行？ 它不会在<em>Guard</em>脚本中编码，但会在<em>Looker</em>脚本中编码。 在转到Looker脚本之前，请查看图31验证<em>Guard</em>脚本代码。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dfb/412/a11/dfb412a11448f070d31932d6c9e4c6c1.jpg"></div><br>  <i>图31：完成的<em>Guard</em>脚本。</i> <br><br> 在<em>Looker</em>内部<em>，</em>我们再次需要声明以下变量： <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject guard; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> reset = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> movingDown;</code> </pre> <br> 之后，我们对<em>Start</em>函数进行注释，此脚本中不需要此函数。 让我们继续执行<em>Update</em>函数并添加以下代码： <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (movingDown == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) transform.position -= <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> transform.position += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transform.position.z &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>) movingDown = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transform.position.z &lt; <span class="hljs-number"><span class="hljs-number">-10</span></span>) movingDown = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; reset -= Time.deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reset &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { guard.GetComponent&lt;Guard&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; GetComponent&lt;SphereCollider&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br> 这是项目主要动作发生的地方，因此让我们分析代码。 首先，根据布尔变量<strong>movingDown</strong>的值，此脚本所附加的对象将向上或向下移动。 一旦到达某个点，他就会改变方向。 接下来， <em>Looker</em>将基于实时降低重置值。 一旦计时器小于零，他将从<em>Guard</em>对象中获取<em>Guard</em>脚本并将其禁用，此后， <em>Guard</em>对象将开始移动到玩家最后一次知道的位置，然后再停止。  <em>Looker</em>还会再次打开其对撞机，以便整个过程可以重新开始。 现在，我们的脚本如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ac9/dfc/7ec/ac9dfc7ec347c3422151e55b43682c3e.jpg"></div><br>  <i>图32： <em>Looker</em>脚本。</i> <br><br> 说到对撞机：是时候创建一个冲突代码来重置<em>Looker</em>计时器并包括<em>Guard</em>脚本了。 在<em>更新</em>功能中，创建以下代码： <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCollisionEnter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Collision collision</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (collision.gameObject.tag == <span class="hljs-string"><span class="hljs-string">"Player"</span></span>) { guard.GetComponent&lt;Guard&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; reset = <span class="hljs-number"><span class="hljs-number">5</span></span>; GetComponent&lt;SphereCollider&gt;().enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br>  <em>OnCollisionEnter</em> Unity自动将其识别为冲突代码，因此在与另一个对象发生冲突时执行该代码。 在我们的例子中，它首先检查碰撞对象是否具有<em>Player</em>标签。 如果不是，它将忽略其余代码。 否则，它将打开<em>Guard</em>脚本，将<em>重置</em>计时器设置为5（即五秒），并禁用其对撞机，以便玩家仍然可以在对象中移动并且不会意外卡在<em>Looker</em>对象中。 该功能如图33所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ad/11c/5ce/5ad11c5cee401f612207f76322f6afc1.jpg"></div><br>  <i>图33：</i> Looker的<i>冲突代码</i> 。 <br><br> 这就是项目代码的全部准备好了！ 在完成项目之前，您可以做几件事。 保存所有工作并返回Unity。 <br><br><h2> 项目完成 </h2><br> 要完成项目，我们只需要将脚本附加到相应的对象并设置几个变量即可。 首先，从“ <em>导航”</em>窗口转到“ <em>检查器”</em>窗口： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b1/4a4/a83/5b14a4a8305887f6ce685516c0490724.jpg"></div><br>  <i>图34：过渡到“</i>检查器” <i>窗口</i> 。 <br><br> 之后，让我们从<em>Player</em>对象开始。 在“ <em>层次结构”</em>窗口中选择它，然后在“ <em>检查器”</em>窗口的底部单击“ <em>添加组件”</em>按钮并添加“ <em>播放器”</em>脚本。 这样就完成了<em>Player</em>对象。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d03/fb6/745/d03fb67452e138ccd4a2b3a838e53615.jpg"></div><br>  <i>图35：</i>播放器<i>脚本组件</i> 。 <br><br> 接下来，选择<em>Guard</em>对象。 和以前一样，将<em>Guard</em>脚本附加到对象。 这次我们需要告诉<em>守卫</em>球员是谁。 为此，将<em>Player</em>对象从<em>Hierarchy中</em>拖动到<em>Guard</em>脚本组件的<em>Player</em>字段中，如图36所示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fae/14a/6f7/fae14a6f76221641adcdeca2d5993f84.jpg"></div><br>  <i>图36：使<em>Player</em>对象成为<em>Player</em>字段的值。</i> <br><br> 我们还需要禁用<em>Guard</em>脚本。 在我们的项目中， <em>Guard</em>将在打开脚本后追逐玩家。 仅当播放器触摸<em>Looker</em>对象后，才应包含此<em>Guard</em>脚本。 您需要做的就是取消选中组件中<em>Guard（脚本）</em>文本旁边的框： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed2/ee4/093/ed2ee40931919ee69fa013f005e4a8b5.jpg"></div><br>  <i>图37：禁用<em>Guard</em>脚本。</i> <br><br> 最后，让我们转到<em>Looker</em>对象，并将<em>Looker</em>脚本附加到该对象。 这次， <em>Looker</em>对象将需要一个<em>Guard</em>对象作为其<em>Guard</em>变量的值。 正如我们将<em>Player</em>对象分配给<em>Guard</em>脚本的<em>Player</em>变量一样，我们将对<em>Guard</em>对象和<em>Looker</em>脚本执行相同的操作。 将<em>Guard</em>从<em>层次结构</em>拖到<em>Looker</em>脚本的<em>Guard</em>字段中。 并且项目完成了！ 单击Unity编辑器顶部的“播放”按钮以测试您的项目。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5b/272/4ed/d5b2724edf53e1bc2e2c06951ef38cdc.jpg"></div><br>  <i>图38：测试项目。</i> <br><br> 尝试将<em>Player</em>对象移动到<em>Looker</em>对象（请记住，移动是通过箭头完成的！）。 请注意，此后， <em>Guard</em>对象将开始追逐玩家。 他将继续追求约5秒钟，然后他将放弃。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf2/4ba/729/bf24ba729b9457d0c038c4c50c5464a1.jpg"></div><br>  <i>图39：一个完全完成的项目正在实施。</i> <br><br><h2> 结论 </h2><br> 该AI非常简单，但可以轻松扩展。 假设，如果我们假设<em>Looker</em>对象是一台相机，而后卫则通过它寻找来找到您，那么让<em>Guard</em>对象拥有自己的双眼是合乎逻辑的。 玩家可以靠近摄像机，但必须考虑到警卫的眼睛。 您也可以将该项目与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">寻找路径</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">概念</a>结合起来：为后卫提供他将要遵循的路径，从而为玩家创造一个更加有趣的环境。 <br><br> 可以通过许多不同的方式来开发这种简单的AI。 您可能不想做上述任何事情，并决定自己做某事。 我建议您尝试一下，也许您会想到一个有趣的项目的想法，这值得结束。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN419641/">https://habr.com/ru/post/zh-CN419641/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN419625/index.html">我最喜欢的PHP7功能概述</a></li>
<li><a href="../zh-CN419627/index.html">我们正在寻找莫斯科数据科学专业的演讲者</a></li>
<li><a href="../zh-CN419633/index.html">现在，所有主要根证书列表都被“让我们加密”信任</a></li>
<li><a href="../zh-CN419635/index.html">发布Dart 2.0和Dart Web平台的稳定版本</a></li>
<li><a href="../zh-CN419637/index.html">[翻译] Graal的方式-Java JVM JVM编译器</a></li>
<li><a href="../zh-CN419643/index.html">明斯克EPAM软件工程大会：将其变为现实</a></li>
<li><a href="../zh-CN419647/index.html">研讨会“电子商务中的黑色星期五。 生存的秘密，8月16日，莫斯科</a></li>
<li><a href="../zh-CN419649/index.html">关于猫的一些知识，或者我们为同步播客选择的猫</a></li>
<li><a href="../zh-CN419651/index.html">GA和YM都没有。 我们如何制作自己的点击流</a></li>
<li><a href="../zh-CN419653/index.html">如何在没有React + RxJS 6 + Recompose的情况下在GitHub上进行用户搜索</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>