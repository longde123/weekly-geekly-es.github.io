<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèì üë¥üèø ‚ùóÔ∏è Gim Ular untuk FPGA Cyclone IV (dengan VGA & SPI joystick) ‚úä üëä üëßüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendahuluan 


 Apakah Anda ingat permainan ular sejak kecil, di mana seekor ular berlari di layar mencoba makan apel? Artikel ini menjelaskan impleme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gim Ular untuk FPGA Cyclone IV (dengan VGA & SPI joystick)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431226/"><h2 id="introduction">  Pendahuluan </h2><br><p>  Apakah Anda ingat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">permainan ular</a> sejak kecil, di mana seekor ular berlari di layar mencoba makan apel?  Artikel ini menjelaskan implementasi game kami pada FPGA <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1</a></sup> . </p><br><p><img src="https://github.com/Sitiritis/SnakeGame_FPGA/blob/master/text/img/gameplay.gif?raw=true" alt="Gameplay.gif"><br>  <strong>Gambar 1.</strong> Gameplay </p><a name="habracut"></a><br><p>  Pertama, mari kita perkenalkan diri kita sendiri dan jelaskan alasan mengapa kita mengerjakan proyek ini.  Ada 3 dari kita: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tymur Lysenko</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Daniil Manakovskiy</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sergey Makarov</a> .  Sebagai mahasiswa tahun pertama dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Innopolis University</a> , kami memiliki kursus "Arsitektur Komputer", yang diajarkan secara profesional dan memungkinkan pelajar untuk memahami struktur komputer tingkat rendah.  Pada titik tertentu selama kursus, instruktur memberi kami kesempatan untuk mengembangkan proyek untuk FPGA untuk poin tambahan dalam kursus.  Motivasi kami bukan hanya tingkat, tetapi minat kami untuk mendapatkan lebih banyak pengalaman dalam desain perangkat keras, berbagi hasil, dan akhirnya, memiliki permainan yang menyenangkan. </p><br><p>  Sekarang, mari kita masuk ke detail gelap yang dalam. </p><br><h2 id="project-overview">  Tinjauan proyek </h2><br><p>  Untuk proyek kami, kami memilih game yang mudah diimplementasikan dan menyenangkan, yaitu "Snake".  Struktur implementasinya berjalan sebagai berikut: pertama, input diambil dari joystick SPI, kemudian diproses, dan akhirnya, gambar dihasilkan ke monitor VGA dan skor ditampilkan pada layar 7-segmen (dalam hex).  Meskipun logika permainannya intuitif dan mudah, VGA dan joystick merupakan tantangan yang menarik dan implementasinya telah menghasilkan pengalaman bermain game yang bagus. </p><br><p>  Gim ini memiliki aturan berikut.  Seorang pemain mulai dengan kepala ular tunggal.  Tujuannya adalah memakan apel, yang dihasilkan secara acak di layar setelah yang sebelumnya dimakan.  Selanjutnya, ular itu diperpanjang 1 ekor setelah memuaskan rasa lapar.  Ekor bergerak satu demi satu, mengikuti kepala.  Ular itu selalu bergerak.  Jika batas layar tercapai, ular dipindahkan ke sisi lain layar.  Jika kepala menyentuh ekor, permainan berakhir. </p><br><h2 id="tools-used">  Alat yang digunakan </h2><br><ul><li>  Altera Cyclone IV (EP4CE6E22C8N) dengan 6272 elemen logis, onboard 50 MHz clock, VGA warna 3-bit, tampilan 7-segmen 8 digit.  FPGA tidak dapat mengambil input analog ke pinnya. </li><li>  SPI Joystick (KY-023) </li><li>  Monitor VGA yang mendukung kecepatan refresh 60 Hz </li><li>  Quartus Prime Lite Edition 18.0.0 Build 614 </li><li>  Verilog HDL IEEE 1364-2001 </li><li>  Papan tempat memotong roti </li><li>  Elemen listrik: <br><ul><li>  8 konektor pria-wanita </li><li>  1 konektor perempuan-perempuan </li><li>  1 konektor pria-pria </li><li>  4 resistor (4,7 KŒ©) </li></ul></li></ul><br><h2 id="architecture-overview">  Tinjauan arsitektur </h2><br><p>  Arsitektur proyek merupakan faktor penting untuk dipertimbangkan.  Gambar 2 menunjukkan arsitektur ini dari sudut pandang tingkat atas: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c92/2a4/4b2/c922a44b20cdc085b7061e7b5c5f8cd4.png" alt="Design.png"><br>  <strong>Gambar 2.</strong> Tampilan desain tingkat atas ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pdf</a> ) </p><br><p>  Seperti yang Anda lihat, ada banyak input, output, dan beberapa modul.  Bagian ini akan menjelaskan arti setiap elemen dan menentukan pin mana yang digunakan pada papan untuk port. </p><br><h3 id="main-inputs">  Input utama </h3><br><p>  Input utama yang diperlukan untuk implementasi adalah <em>res_x_one</em> , <em>res_x_two</em> , <em>res_y_one</em> , <em>res_y_two</em> , yang digunakan untuk menerima arah joystick saat ini.  Gambar 3 menunjukkan pemetaan antara nilai-nilai mereka dan arah. </p><br><table><thead><tr><th>  Masukan </th><th>  Kiri </th><th>  Benar </th><th>  Naik </th><th>  Turun </th><th>  Tidak ada perubahan arah </th></tr></thead><tbody><tr><td>  res_x_one (PIN_30) </td><td>  1 </td><td>  0 </td><td>  x </td><td>  x </td><td>  1 </td></tr><tr><td>  res_x_two (PIN_52) </td><td>  1 </td><td>  0 </td><td>  x </td><td>  x </td><td>  0 </td></tr><tr><td>  res_y_one (PIN_39) </td><td>  x </td><td>  x </td><td>  1 </td><td>  0 </td><td>  1 </td></tr><tr><td>  res_y_two (PIN_44) </td><td>  x </td><td>  x </td><td>  1 </td><td>  0 </td><td>  0 </td></tr></tbody></table><br><p>  <strong>Gambar 3.</strong> Pemetaan input dan arah joystick </p><br><h3 id="other-inputs">  Masukan lainnya </h3><br><ul><li>  <em>clk</em> - jam papan (PIN_23) </li><li>  <em>setel ulang</em> - sinyal untuk menyetel ulang game dan berhenti mencetak (PIN_58) </li><li>  <em>warna</em> - ketika 1, semua warna yang mungkin dihasilkan ke layar dan hanya digunakan untuk tujuan demonstrasi (PIN_68) </li></ul><br><h3 id="main-modules">  Modul utama </h3><br><h4 id="joystick_input">  joystick_input </h4><br><p>  <em>joystick_input</em> digunakan untuk menghasilkan kode arah berdasarkan input dari joystick. </p><br><h4 id="game_logic">  game_logic </h4><br><p>  <em>game_logic</em> berisi semua logika yang diperlukan untuk memainkan game.  Modul ini menggerakkan ular ke arah tertentu.  Selain itu, ini bertanggung jawab untuk makan apel dan deteksi tabrakan.  Selain itu, ia menerima koordinat x dan y saat ini dari piksel pada layar dan mengembalikan entitas yang ditempatkan pada posisi. </p><br><h4 id="vga_draw">  VGA_Draw </h4><br><p>  Laci menetapkan warna piksel ke nilai tertentu berdasarkan posisi saat ini ( <em>iVGA_X, iVGA_Y</em> ) dan entitas saat ini ( <em>ent</em> ). </p><br><h4 id="vga_ctrl">  VGA_Ctrl </h4><br><p>  Menghasilkan bitstream kontrol ke output VGA ( <em>V_Sync, H_Sync, R, G, B</em> ). </p><br><h4 id="sseg_displaysup22sup">  SSEG_Display <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2</a></sup> </h4><br><p>  <em>SSEG_Display</em> adalah driver untuk menampilkan skor saat ini pada tampilan 7-segmen. </p><br><h4 id="vga_clk">  Vga_clk </h4><br><p>  <em>VGA_clk</em> menerima clock 50MHz dan memotongnya menjadi 25.175 MHz. </p><br><h4 id="game_upd_clk">  game_upd_clk </h4><br><p>  <em>game_upd_clk</em> adalah modul yang menghasilkan jam khusus yang memicu pembaruan keadaan permainan. </p><br><h3 id="outputs">  Keluaran </h3><br><ul><li>  <em>VGA_B</em> - pin biru VGA (PIN_144) </li><li>  <em>VGA_G</em> - pin hijau VGA (PIN_1) </li><li>  <em>VGA_R</em> - pin merah VGA (PIN_2) </li><li>  <em>VGA_HS</em> - Sinkronisasi horizontal VGA (PIN_142) </li><li>  <em>VGA_VS</em> - Sinkronisasi vertikal VGA (PIN_143) </li><li>  <em>sseg_a_to_dp</em> - menentukan yang mana dari 8 segmen yang menyala (PIN_115, PIN_119, PIN_120, PIN_121, PIN_124, PIN_125, PIN_126, PIN_126, PIN_127) </li><li>  <em>sseg_an</em> - menentukan tampilan dari 4 7 segmen mana yang akan digunakan (PIN_128, PIN_129, PIN_132, PIN_133) </li></ul><br><h2 id="implementation">  Implementasi </h2><br><h3 id="input-with-spi-joystick">  Masukan dengan SPI joystick </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e3f/4ab/fc4/e3f4abfc45c5a87151db34738e9c3a92.jpg" alt="stick.jpg"></p><br><p>  <strong>Gambar 4.</strong> SPI Joystick (KY-023) </p><br><p>  Saat menerapkan modul input, kami menemukan bahwa tongkat menghasilkan sinyal analog.  Joystick memiliki 3 posisi untuk setiap sumbu: </p><br><ul><li>  top - ~ output 5V </li><li>  pertengahan - output 2.5V </li><li>  rendah - ~ keluaran 0V </li></ul><br><p> Inputnya sangat mirip dengan sistem ternary: untuk sumbu-X, kita memiliki <code>true</code> (kiri), <code>false</code> (kanan) dan state yang <code>undetermined</code> , di mana joystick tidak di kiri atau di kanan.  Masalahnya adalah bahwa papan FPGA hanya dapat memproses input digital.  Karenanya kita tidak dapat mengubah logika terner ini menjadi biner hanya dengan menulis beberapa kode.  Solusi pertama yang disarankan adalah menemukan konverter Analog-Digital, tetapi kemudian kami memutuskan untuk menggunakan pengetahuan sekolah kami tentang fisika dan menerapkan pembagi tegangan <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3</a></sup> .  Untuk mendefinisikan tiga status, kita membutuhkan dua bit: 00 <code>false</code> , 01 tidak <code>undefined</code> dan 11 <code>true</code> .  Setelah beberapa pengukuran, kami menemukan bahwa di papan kami, batas antara nol dan satu adalah sekitar 1,7V.  Jadi, kami membangun skema berikut (gambar dibuat menggunakan circuitlab <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4</a></sup> ): </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/009/36c/a43/00936ca435f219d64f7078bec64e9b8c.png" alt="Stick_connection.png"></p><br><p>  <strong>Gambar 5.</strong> Sirkuit untuk ADC untuk joystick </p><br><p>  Implementasi fisik dibangun menggunakan item kit Arduino, dan terlihat sebagai berikut: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/3eb/34b/c9e/3eb34bc9e0210b8f336a7fd8ba89f1a9.jpg" alt="stick_imp"></p><br><p>  <strong>Gambar 6.</strong> Implementasi ADC </p><br><p>  Rangkaian kami mengambil satu input untuk setiap sumbu dan menghasilkan dua output: yang pertama datang langsung dari tongkat dan menjadi nol hanya jika joystick menghasilkan <code>zero</code> .  Yang kedua adalah 0 pada kondisi yang <code>undetermined</code> , tetapi masih 1 pada <code>true</code> .  Ini adalah hasil tepat yang kami harapkan. </p><br><p>  Logika modul input adalah: </p><br><ol><li>  Kami menerjemahkan logika ternary kami ke kabel biner sederhana untuk setiap arah; </li><li>  Pada setiap siklus jam, kami memeriksa apakah hanya satu arah yang <code>true</code> (ular tidak dapat bergerak secara diagonal); </li><li>  Kami membandingkan arah baru kami dengan yang sebelumnya untuk mencegah ular makan sendiri dengan tidak membiarkan pemain mengubah arah menjadi sebaliknya. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Bagian dari kode modul input</b> <div class="spoiler_text"><pre> <code class="vhdl hljs">reg left, right, up, down; initial <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> direction = `TOP_DIR; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> always @(posedge clk) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> //<span class="hljs-number"><span class="hljs-number">1</span></span> left = two_resistors_x; right = ~one_resistor_x; up = two_resistors_y; down = ~one_resistor_y; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (left + right + up + down == <span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b001</span></span>) //<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (left &amp;&amp; (direction != `RIGHT_DIR)) //<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> direction = `LEFT_DIR; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> //same code <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> other directions <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </div></div><br><h3 id="output-to-vga">  Output ke VGA </h3><br><p>  Kami memutuskan untuk membuat output dengan resolusi 640x480 pada layar 60Hz yang berjalan pada 60 FPS. </p><br><p>  Modul VGA terdiri dari 2 bagian utama: <strong>driver</strong> dan <strong>laci</strong> .  Driver menghasilkan bitstream yang terdiri dari sinyal sinkronisasi vertikal, horizontal, dan warna yang diberikan ke output VGA.  Artikel <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">5 yang</a></sup> ditulis oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@SlavikMIPT</a> menjelaskan prinsip-prinsip dasar bekerja dengan VGA.  Kami telah mengadaptasi driver dari artikel ke board kami. </p><br><p>  Kami memutuskan untuk memecah layar menjadi kisi elemen 40x30, yang terdiri dari kuadrat 16x16 piksel.  Setiap elemen mewakili 1 entitas permainan: baik apel, kepala ular, ekor atau tidak sama sekali. </p><br><p>  Langkah selanjutnya dalam implementasi kami adalah membuat sprite untuk entitas. </p><br><p>  Siklon IV hanya memiliki 3 bit untuk mewakili warna pada VGA (1 untuk Merah, 1 untuk Hijau, dan 1 untuk Biru).  Karena keterbatasan seperti itu, kami perlu menerapkan konverter agar sesuai dengan warna gambar ke yang tersedia.  Untuk tujuan itu, kami membuat skrip python yang membagi nilai RGB dari setiap piksel dengan 128. </p><br><div class="spoiler">  <b class="spoiler_title">Skrip python</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image, ImageDraw filename = <span class="hljs-string"><span class="hljs-string">"snake_head"</span></span> index = <span class="hljs-number"><span class="hljs-number">1</span></span> im = Image.open(filename + <span class="hljs-string"><span class="hljs-string">".png"</span></span>) n = Image.new(<span class="hljs-string"><span class="hljs-string">'RGB'</span></span>, (<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>)) d = ImageDraw.Draw(n) pix = im.load() size = im.size data = [] code = <span class="hljs-string"><span class="hljs-string">"sp["</span></span> + str(index) + <span class="hljs-string"><span class="hljs-string">"][{i}][{j}] = 3'b{RGB};\\\n"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">"code_"</span></span> + filename + <span class="hljs-string"><span class="hljs-string">".txt"</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(size[<span class="hljs-number"><span class="hljs-number">0</span></span>]): tmp = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(size[<span class="hljs-number"><span class="hljs-number">1</span></span>]): clr = im.getpixel((i, j)) vg = <span class="hljs-string"><span class="hljs-string">"{0}{1}{2}"</span></span>.format(int(clr[<span class="hljs-number"><span class="hljs-number">0</span></span>] / <span class="hljs-number"><span class="hljs-number">128</span></span>), <span class="hljs-comment"><span class="hljs-comment"># an array representation for pixel int(clr[1] / 128), # since clr[*] in range [0, 255], int(clr[2] / 128)) # clr[*]/128 is either 0 or 1 tmp.append(vg) f.write(code.format(i=i, j=j, RGB=vg)) # Verilog code to initialization d.point((i, j), tuple([int(vg[0]) * 255, int(vg[1]) * 255, int(vg[2]) * 255])) # Visualize final image data.append(tmp) n.save(filename + "_3bit.png") for el in data: print(" ".join(el))</span></span></code> </pre></div></div><br><table><tbody><tr><td align="center">  Asli </td><td align="center">  Setelah skrip </td></tr><tr><td align="center" width="150"><img src="https://habrastorage.org/getpro/habr/post_images/720/34d/b40/72034db4092a25711654562bc4523661.png" width="128" height="128"><br></td><td align="center" width="150"><img src="https://habrastorage.org/getpro/habr/post_images/529/254/02e/52925402e158986901bc6278d7d0bb28.png" width="128" height="128"><br></td></tr></tbody></table><br><p>  <strong>Gambar 7.</strong> Perbandingan antara input dan output </p><br><p>  Tujuan utama laci adalah untuk mengirim warna piksel ke VGA berdasarkan posisi saat ini ( <em>iVGA_X, iVGA_Y</em> ) dan entitas saat ini ( <em>ent</em> ).  Semua sprite dikode keras tetapi dapat dengan mudah diubah dengan membuat kode baru menggunakan skrip di atas. </p><br><div class="spoiler">  <b class="spoiler_title">Logika laci</b> <div class="spoiler_text"><pre> <code class="vhdl hljs">always @(posedge iVGA_CLK <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> posedge reset) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(reset) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> oRed &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; oGreen &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; oBlue &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> // DRAW CURRENT STATE <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ent == `ENT_NOTHING) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> oRed &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; oGreen &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; oBlue &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> // Drawing a particular pixel from sprite oRed &lt;= sp[ent][iVGA_X % `H_SQUARE][iVGA_Y % `V_SQUARE][<span class="hljs-number"><span class="hljs-number">0</span></span>]; oGreen &lt;= sp[ent][iVGA_X % `H_SQUARE][iVGA_Y % `V_SQUARE][<span class="hljs-number"><span class="hljs-number">1</span></span>]; oBlue &lt;= sp[ent][iVGA_X % `H_SQUARE][iVGA_Y % `V_SQUARE][<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </div></div><br><h3 id="output-to-the-7-segment-display">  Output ke tampilan 7-segmen </h3><br><p>  Untuk memungkinkan pemain melihat skor mereka, kami memutuskan untuk menampilkan skor game ke tampilan 7-segmen.  Karena kekurangan waktu, kami menggunakan kode dari EP4CE6 Starter Board Documentation <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2</a></sup> .  Modul ini menampilkan angka heksadesimal ke layar. </p><br><h3 id="game-logic">  Logika game </h3><br><p>  Selama pengembangan, kami mencoba beberapa pendekatan, namun, kami berakhir dengan pendekatan yang membutuhkan jumlah memori minimal, mudah diimplementasikan dalam perangkat keras, dan dapat mengambil manfaat dari komputasi paralel. </p><br><p>  Modul ini menjalankan beberapa fungsi.  Ketika VGA menggambar piksel pada setiap siklus jam mulai dari kiri atas bergerak ke kanan bawah, modul VGA_Draw, yang bertanggung jawab untuk menghasilkan warna untuk piksel, perlu mengidentifikasi warna yang digunakan untuk koordinat saat ini.  Itulah yang harus dihasilkan modul logika permainan - kode entitas untuk koordinat yang diberikan. <br>  Selain itu, ia harus memperbarui status permainan hanya setelah layar penuh ditarik.  Sinyal yang dihasilkan oleh modul <em>game_upd_clk</em> digunakan untuk menentukan kapan harus memperbarui. </p><br><h4 id="game-state">  Status permainan </h4><br><p>  Status permainan terdiri dari: </p><br><ul><li>  Koordinat kepala ular </li><li>  Susunan koordinat ekor ular.  Array dibatasi oleh 128 elemen dalam implementasi kami </li><li>  Jumlah ekor </li><li>  Koordinat apel </li><li>  Game over flag </li><li>  Game memenangkan bendera </li></ul><br><p>  Pembaruan status permainan mencakup beberapa tahap: </p><br><ol><li>  Gerakkan kepala ular ke koordinat baru, berdasarkan arah yang diberikan.  Jika ternyata koordinat berada di tepinya dan perlu diubah lebih lanjut, maka kepala harus melompat ke tepi layar yang lain.  Misalnya, arah ditetapkan ke kiri, dan koordinat X saat ini adalah 0. Oleh karena itu, koordinat X baru harus menjadi sama dengan alamat horizontal terakhir. </li><li>  Koordinat baru dari kepala ular diuji terhadap koordinat apel: <br>  2.1.  Jika mereka sama dan array tidak penuh, tambahkan ekor baru ke array dan tambahkan counter ekor.  Ketika penghitung mencapai nilai tertinggi (128 dalam kasus kami), permainan memenangkan bendera sedang disiapkan dan itu berarti, ular itu tidak dapat tumbuh lagi, dan permainan masih berlanjut.  Ekor baru ditempatkan pada koordinat sebelumnya dari kepala ular.  Koordinat acak untuk X dan Y harus diambil untuk menempatkan apel di sana. <br>  2.2.  Dalam hal mereka tidak sama, bertukar koordinat secara berurutan dari ekor yang berdekatan.  (n +1) - ekor ke-9 harus menerima koordinat ke-n, jika ekor ke-n ditambahkan sebelum (n +1)-ke-ke-3.  Ekor pertama menerima koordinat lama kepala. </li><li>  Periksa, apakah koordinat baru kepala ular bertepatan dengan koordinat ekor mana pun.  Jika itu masalahnya, game over flag dinaikkan dan game berhenti. </li></ol><br><h4 id="random-coordinate-generation">  Pembuatan koordinat acak </h4><br><p>  Angka acak dihasilkan dengan mengambil bit acak yang dihasilkan oleh <em>register shift</em> bergilir <em>linier umpan balik</em> 6-bit <em>(LFSR)</em> <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">6</a></sup> .  Untuk memasukkan angka-angka ke dalam layar, mereka dibagi dengan dimensi kotak permainan dan sisanya diambil. </p><br><h2 id="conclusion">  Kesimpulan </h2><br><p>  Setelah 8 minggu bekerja, proyek ini berhasil dilaksanakan.  Kami telah memiliki pengalaman dalam pengembangan game dan berakhir dengan versi menyenangkan dari game "Snake" untuk FPGA.  Gim ini dapat dimainkan, dan keterampilan kami dalam pemrograman, merancang arsitektur, dan soft-skill telah meningkat. </p><br><h2 id="acknowledgments">  Segmen yang diakui </h2><br><p>  Kami ingin menyampaikan terima kasih dan terima kasih khusus kami kepada para profesor kami <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Muhammad Fahim</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Alexander Tormasov yang</a> telah memberi kami pengetahuan mendalam dan kesempatan untuk mempraktikkannya.  Kami dengan tulus berterima kasih kepada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Vladislav Ostankovich</a> karena telah menyediakan perangkat keras penting yang digunakan dalam proyek ini dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Temur Kholmatov</a> untuk membantu debugging.  Kami tidak akan lupa untuk mengingat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anastassiya Boiko</a> menggambar sprite indah untuk permainan.  Kami juga ingin menyampaikan pendapat kami yang tulus kepada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Rabab Marouf</a> untuk mengoreksi dan mengedit artikel ini. </p><br><p>  Terima kasih untuk semua yang telah membantu kami menguji permainan dan mencoba membuat rekor.  Semoga Anda menikmati bermain itu! </p><br><h2 id="references">  Referensi </h2><br><p>  [1]: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proyek di Github</a> <br>  [2]: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[FPGA] EP4CE6 Dokumentasi Papan Pemula</a> <br>  [3]: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pembagi tegangan</a> <br>  [4]: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Alat untuk memodelkan sirkuit</a> <br>  [5]: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Adaptor VGA untuk FPGA Altera Cyclone III</a> <br>  [6]: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Register pergeseran linier-umpan balik (LFSR) di Wikipedia</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LFSR dalam Kode FPGA - VHDL &amp; Verilog</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tekstur apel</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ide untuk menghasilkan angka acak</a> <br>  Palnitkar, S. (2003).  <em>Verilog HDL: Panduan untuk Desain dan Sintesis Digital, Edisi Kedua.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id431226/">https://habr.com/ru/post/id431226/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id431212/index.html">Caching Pagination di Android</a></li>
<li><a href="../id431216/index.html">Ulasan Telepon IP Snom D345</a></li>
<li><a href="../id431218/index.html">Bagaimana saya membuat game komik Lovecraft</a></li>
<li><a href="../id431220/index.html">Pandangan seorang ahli biologi tentang akar penuaan kita</a></li>
<li><a href="../id431222/index.html">Pengarsipan Situs Web</a></li>
<li><a href="../id431228/index.html">Rintangan Jalankan untuk Cahaya: Kristal Cair untuk Membantu</a></li>
<li><a href="../id431230/index.html">Penyimpanan untuk Infrastruktur HPC, atau Cara Kami Mengumpulkan Penyimpanan 65 PB di Pusat Penelitian RIKEN Jepang</a></li>
<li><a href="../id431232/index.html">Kami menghasilkan placeholder SVG yang indah di Node.js</a></li>
<li><a href="../id431234/index.html">11 Desember, Moskow - Alfa JS MeetUp</a></li>
<li><a href="../id431236/index.html">Cara menulis di Objective-C pada tahun 2018. Bagian 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>