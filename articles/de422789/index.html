<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèüÔ∏è ü§¶üèø üéµ @ Pythonetc Aug 2018 üßòüèΩ üôèüèø ‚ôåÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist die dritte Sammlung von Python-Tipps und -Programmierungen aus meinem @ pythonetc-Feed . 

 Vorherige Auswahl: 



- Juli 2018 
- Juni 2018 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>@ Pythonetc Aug 2018</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/422789/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/815/5df/0ab/8155df0ab68e69c1e5863edec2315486.png" width="400"></div><br><br>  Dies ist die dritte Sammlung von Python-Tipps und -Programmierungen aus meinem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@ pythonetc-Feed</a> . <br><br>  Vorherige Auswahl: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Juli 2018</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Juni 2018</a> <br></li></ul><br><a name="habracut"></a><br><h2>  Fabrikmethode </h2><br>  Wenn Sie neue Objekte in <code>__init__</code> , ist es zweckm√§√üiger, sie als Argumente zu √ºbergeben und das Objekt mit der Factory-Methode zu erstellen.  Dadurch wird die Gesch√§ftslogik von der technischen Implementierung der Erstellung von Objekten getrennt. <br><br>  In diesem Beispiel akzeptiert <code>__init__</code> <code>host</code> und <code>port</code> als Argumente zum Erstellen einer Datenbankverbindung: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Query</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, host, port)</span></span></span><span class="hljs-function">:</span></span> self._connection = Connection(host, port)</code> </pre> <br>  Refactoring-Option: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Query</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, connection)</span></span></span><span class="hljs-function">:</span></span> self._connection = connection @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, host, port)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cls(Connection(host, port))</code> </pre> <br>  Dieser Ansatz hat mindestens die folgenden Vorteile: <br><br><ul><li>  Die Bereitstellung ist einfach.  In Tests k√∂nnen Sie eine <code>Query(FakeConnection())</code> . </li><li>  Eine Klasse kann so viele Factory-Methoden haben, wie Sie m√∂chten.  Sie k√∂nnen eine Verbindung nicht nur √ºber <code>host</code> und <code>port</code> erstellen, sondern auch eine andere Verbindung klonen, die Konfigurationsdatei lesen, die Standardverbindung verwenden usw. </li><li>  √Ñhnliche Factory-Methoden k√∂nnen in asynchrone Funktionen umgewandelt werden, was mit <code>__init__</code> absolut unm√∂glich ist. </li></ul><br><h2>  super oder weiter </h2><br>  Mit der Funktion <code>super()</code> k√∂nnen Sie auf die Basisklasse verweisen.  Dies kann sehr n√ºtzlich sein, wenn die abgeleitete Klasse der Implementierung der Methode etwas hinzuf√ºgen m√∂chte, anstatt sie vollst√§ndig zu √ºberschreiben. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseTestCase</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TestCase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self._db = create_db() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserTestCase</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseTestCase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().setUp() self._user = create_user()</code> </pre> <br>  Der Name Super bedeutet nichts ‚ÄûSuper‚Äú.  In diesem Zusammenhang bedeutet es "h√∂her in der Hierarchie" (zum Beispiel wie im Wort "Superintendent").  Gleichzeitig verweist <code>super()</code> nicht immer auf die Basisklasse, sondern kann leicht eine untergeordnete Klasse zur√ºckgeben.  Es w√§re also korrekter, den Namen <code>next()</code> , da die n√§chste Klasse gem√§√ü dem MRO zur√ºckgegeben wird. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Top</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'top'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Left</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Top)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().foo() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Right</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Top)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'right'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bottom</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Left, Right)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-comment"><span class="hljs-comment"># prints 'right' print(Bottom().foo())</span></span></code> </pre> <br>  Denken Sie daran, dass <code>super()</code> unterschiedliche Ergebnisse liefern kann, je nachdem, woher die Methode urspr√ºnglich aufgerufen wurde. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>Bottom().foo() <span class="hljs-string"><span class="hljs-string">'right'</span></span> &gt;&gt;&gt; Left().foo() <span class="hljs-string"><span class="hljs-string">'top'</span></span></code> </pre> <br><br><h2>  Benutzerdefinierter Namespace zum Erstellen einer Klasse </h2><br>  Eine Klasse wird in zwei gro√üen Schritten erstellt.  Zun√§chst wird der Hauptteil der Klasse wie der Hauptteil einer Funktion ausgef√ºhrt.  Im zweiten Schritt wird der resultierende Namespace (der von <code>locals()</code> ) von der Metaklasse verwendet (der Standardwert ist <code>type</code> ), um ein Objekt der Klasse zu erstellen. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(type)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(meta, name, bases, ns)</span></span></span><span class="hljs-function">:</span></span> print(ns) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__new__( meta, name, bases, ns ) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(metaclass=Meta)</span></span></span><span class="hljs-class">:</span></span> B = <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  Dieser Code zeigt <code>{'__module__': '__main__', '__qualname__':'Foo', 'B': 3}</code> . <br><br>  Offensichtlich, wenn Sie etwas wie <code>B = 2; B = 3</code> einf√ºhren <code>B = 2; B = 3</code>  <code>B = 2; B = 3</code> , dann sieht die Metaklasse nur <code>B = 3</code> , da nur dieser Wert in <code>ns</code> .  Diese Einschr√§nkung ergibt sich aus der Tatsache, dass die Metaklasse erst nach Ausf√ºhrung des K√∂rpers zu arbeiten beginnt. <br><br>  Sie k√∂nnen jedoch in die Ausf√ºhrungsprozedur eingreifen, indem Sie Ihren eigenen Namespace verschieben.  Standardm√§√üig wird ein einfaches W√∂rterbuch verwendet. Sie k√∂nnen jedoch ein eigenes Objekt bereitstellen, das einem W√∂rterbuch √§hnelt, wenn Sie die Methode <code>__prepare__</code> aus der Metaklasse verwenden. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomNamespace</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(dict)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__setitem__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, key, value)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{key}</span></span></span><span class="hljs-string"> -&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{value}</span></span></span><span class="hljs-string">'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__setitem__(key, value) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meta</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(type)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(meta, name, bases, ns)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__new__( meta, name, bases, ns ) @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__prepare__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(metacls, cls, bases)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CustomNamespace() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(metaclass=Meta)</span></span></span><span class="hljs-class">:</span></span> B = <span class="hljs-number"><span class="hljs-number">2</span></span> B = <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Ergebnis der Codeausf√ºhrung: <br><br><pre> <code class="python hljs">__module__ -&gt; __main__ __qualname__ -&gt; Foo B -&gt; <span class="hljs-number"><span class="hljs-number">2</span></span> B -&gt; <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Somit ist <code>enum.Enum</code> vor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vervielf√§ltigung</a> gesch√ºtzt. <br><br><h2>  matplotlib </h2><br>  <code>matplotlib</code> ist eine komplexe und flexible Python-Bibliothek f√ºr Diagramme.  Viele Produkte unterst√ºtzen dies, einschlie√ülich Jupyter und Pycharm.  Hier ist ein Beispiel f√ºr das Rendern eines einfachen Fraktals mit <code>matplotlib</code> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://repl.it/@VadimPushtaev/myplotlib</a> (siehe Titelbild dieser Ver√∂ffentlichung). <br><br><h2>  Zeitzonenunterst√ºtzung </h2><br>  Python bietet eine leistungsstarke <code>datetime</code> zum Arbeiten mit Datums- und <code>datetime</code> .  Es ist merkw√ºrdig, dass <code>datetime</code> Objekte eine spezielle Schnittstelle zur Unterst√ºtzung von Zeitzonen haben (n√§mlich das <code>tzinfo</code> Attribut), aber dieses Modul unterst√ºtzt die erw√§hnte Schnittstelle nur begrenzt, sodass ein Teil der Arbeit anderen Modulen zugewiesen wird. <br><br>  Der beliebteste von ihnen ist <code>pytz</code> .  Tatsache ist jedoch, dass <code>pytz</code> die <code>tzinfo</code> Schnittstelle nicht vollst√§ndig <code>tzinfo</code> .  Dies steht ganz am Anfang der <code>pytz</code> Dokumentation: ‚ÄûDiese Bibliothek unterscheidet sich von der dokumentierten Python-API f√ºr tzinfo-Implementierungen.‚Äú <br><br>  Sie k√∂nnen keine <code>pytz</code> als <code>tzinfo</code> .  Wenn Sie dies versuchen, riskieren Sie ein v√∂llig verr√ºcktes Ergebnis: <br><br><pre> <code class="python hljs">In : paris = pytz.timezone(<span class="hljs-string"><span class="hljs-string">'Europe/Paris'</span></span>) In : str(datetime(<span class="hljs-number"><span class="hljs-number">2017</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, tzinfo=paris)) Out: <span class="hljs-string"><span class="hljs-string">'2017-01-01 00:00:00+00:09'</span></span></code> </pre> <br>  Beachten Sie den Offset +00: 09.  Pytz sollte wie folgt verwendet werden: <br><br><pre> <code class="python hljs">In : str(paris.localize(datetime(<span class="hljs-number"><span class="hljs-number">2017</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))) Out: <span class="hljs-string"><span class="hljs-string">'2017-01-01 00:00:00+01:00'</span></span></code> </pre> <br>  Dar√ºber hinaus m√ºssen Sie nach arithmetischen Operationen eine <code>normalize</code> auf Ihre <code>datetime</code> Objekte <code>datetime</code> , um zu vermeiden, dass sich Offsets √§ndern (z. B. am Rand der Sommerzeit). <br><br><pre> <code class="python hljs">In : new_time = time + timedelta(days=<span class="hljs-number"><span class="hljs-number">2</span></span>) In : str(new_time) Out: <span class="hljs-string"><span class="hljs-string">'2018-03-27 00:00:00+01:00'</span></span> In : str(paris.normalize(new_time)) Out: <span class="hljs-string"><span class="hljs-string">'2018-03-27 01:00:00+02:00'</span></span></code> </pre> <br>  Wenn Sie Python 3.6 haben, wird in der Dokumentation empfohlen, <code>dateutil.tz</code> anstelle von <code>pytz</code> .  Diese Bibliothek ist vollst√§ndig kompatibel mit <code>tzinfo</code> . Sie kann als Attribut √ºbergeben werden und Sie m√ºssen <code>normalize</code> nicht verwenden.  Es stimmt, es funktioniert langsamer. <br><br>  Wenn Sie wissen m√∂chten, warum <code>pytz</code> die <code>datetime</code> API nicht unterst√ºtzt, oder weitere Beispiele <code>datetime</code> m√∂chten, lesen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesen</a> Artikel. <br><br><h2>  Magic StopIteration </h2><br>  Bei jedem Aufruf von <code>next(x)</code> ein neuer Wert vom Iterator <code>x</code> bis eine Ausnahme ausgel√∂st wird.  Wenn sich herausstellt, dass es sich um <code>StopIteration</code> , ist der Iterator ersch√∂pft und kann keine Werte mehr bereitstellen.  Wenn der Generator iteriert wird, wird am Ende des K√∂rpers automatisch <code>StopIteration</code> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one_two</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ... &gt;&gt;&gt; i = one_two() &gt;&gt;&gt; next(i) <span class="hljs-number"><span class="hljs-number">1</span></span> &gt;&gt;&gt; next(i) <span class="hljs-number"><span class="hljs-number">2</span></span> &gt;&gt;&gt; next(i) Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; StopIteration</code> </pre> <br>  <code>StopIteration</code> kann automatisch von Tools verarbeitet werden, die <code>next</code> aufrufen: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>list(one_two()) [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]</code> </pre> <br>  Das Problem ist jedoch, dass jede offensichtlich nicht erwartete StopIteration, die im Generatork√∂rper aufgetreten ist, stillschweigend als Zeichen f√ºr das Ende des Generators akzeptiert wird und nicht wie jede andere Ausnahme als Fehler: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one_two</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">one_two_repeat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n): i = one_two() <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> next(i) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> next(i) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> next(i) print(list(one_two_repeat(<span class="hljs-number"><span class="hljs-number">3</span></span>)))</code> </pre> <br>  Hier ist die letzte <code>yield</code> ein Fehler: Eine ausgel√∂ste <code>StopIteration</code> Ausnahme stoppt die Iteration der <code>list(...)</code> .  Wir erhalten das Ergebnis <code>[1, 2]</code> .  In Python 3.7 hat sich dieses Verhalten jedoch ge√§ndert.  Alien <code>StopIteration</code> durch <code>StopIteration</code> ersetzt: <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"test.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> one_two_repeat <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> next(i) StopIteration The above exception was the direct cause of the following exception: Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"test.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; print(list(one_two_repeat(<span class="hljs-number"><span class="hljs-number">3</span></span>))) RuntimeError: generator raised StopIteration</code> </pre> <br>  Sie k√∂nnen <code>__future__ import generator_stop</code> , um dasselbe Verhalten seit Python 3.5 zu aktivieren. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422789/">https://habr.com/ru/post/de422789/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422777/index.html">Eine einfache Einf√ºhrung in ALU f√ºr neuronale Netze: Erkl√§rung, physikalische Bedeutung und Implementierung</a></li>
<li><a href="../de422781/index.html">Fintech Digest: SWIFT wird weiterhin in der Russischen F√∂deration arbeiten. Mit VISA k√∂nnen Sie Geld per Telefonnummer und teuren biometrischen Daten √ºberweisen</a></li>
<li><a href="../de422783/index.html">Besser, schneller, leistungsf√§higer: Styled-Components v4</a></li>
<li><a href="../de422785/index.html">Werksdigitalisierung: Ein Blick nach vorne</a></li>
<li><a href="../de422787/index.html">Wesentliche √Ñnderungen in f√ºhrenden Chip-Architekturen</a></li>
<li><a href="../de422791/index.html">Wie man NICHT Englisch lernt: H√§ufige Fehler</a></li>
<li><a href="../de422793/index.html">DEFCON-Konferenz 22. Andrew "Zoz" Brooks. Nicht vermasseln! Teil 2</a></li>
<li><a href="../de422795/index.html">Technologie und Wirtschaft: Ein neues Modell der Zusammenarbeit mit Zyxel in Russland</a></li>
<li><a href="../de422797/index.html">Wie wir aus einer normalen IP-Kamera einen kleinen Cloud-Videorecorder gemacht haben</a></li>
<li><a href="../de422799/index.html">Wie Microsoft den gesamten Server versteckt hat und wie man ihn findet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>