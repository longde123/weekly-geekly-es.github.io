<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔝 🐠 🚥 Deuda técnica que conduce a una crisis empresarial. 💺 🍭 🎇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Acumular deudas técnicas puede llevar a su empresa a una crisis. Pero también puede convertirse en un poderoso impulsor de cambios masivos de procesos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Deuda técnica que conduce a una crisis empresarial.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dodopizzadev/blog/447154/">  Acumular deudas técnicas puede llevar a su empresa a una crisis.  Pero también puede convertirse en un poderoso impulsor de cambios masivos de procesos y ayudar con la adopción de prácticas de ingeniería.  Te lo contaré en mi propio ejemplo. <br><br><img src="https://habrastorage.org/webt/vo/nt/1m/vont1m1pxmp9xt_l6ifnysa-og0.png"><br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El equipo de TI de Dodo Pizza</a> creció de 2 desarrolladores que sirven a un país a 60 personas que atienden a 12 países en el transcurso de 7 años.  Como Scrum Master y XP Coach, ayudé a los equipos a establecer procesos y adoptar prácticas de ingeniería, pero esta adopción fue demasiado lenta.  Para mí fue un desafío hacer que los equipos mantuvieran una alta calidad de código cuando varios equipos trabajan en un solo producto.  Caímos en la trampa de la preferencia por las características comerciales sobre la excelencia técnica y acumulamos demasiadas deudas técnicas arquitectónicas.  Cuando el marketing lanzó una campaña publicitaria masiva en 2018, no pudimos soportar la carga y caímos.  Fue una pena.  Pero durante la crisis, nos dimos cuenta de que podemos trabajar muchas veces de manera más eficiente.  La crisis nos ha empujado hacia cambios revolucionarios en los procesos y la rápida introducción de las prácticas de ingeniería más conocidas. <br><br><h2>  Antecedentes </h2><br>  Puede pensar que Dodo Pizza es una red de pizzerías normal.  Pero en realidad <b>Dodo Pizza es una compañía de TI que vende pizza</b> .  Nuestro negocio se basa en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dodo IS</a> , una plataforma basada en la nube, que gestiona todos los procesos comerciales, comenzando desde la toma del pedido, luego cocinando y terminando hasta la gestión de inventario, la gestión de personas y la toma de decisiones.  En solo 7 años hemos crecido de 2 desarrolladores que sirven a una sola pizzería a más de 70 desarrolladores que sirven a 470+ pizzerías en 12 países. <br><br>  Cuando me uní a la compañía hace dos años, teníamos 6 equipos y unos 30 desarrolladores.  La base de código Dodo IS tenía aproximadamente 1 millón de líneas de código.  Tenía una arquitectura monolítica y muy poca cobertura de pruebas unitarias.  No teníamos pruebas de API / UI para entonces.  La calidad del código del sistema fue decepcionante.  Lo sabíamos y soñamos con un futuro brillante cuando dividimos el monolito en una docena de servicios y reescribimos las partes más horribles del sistema.  Incluso dibujamos el diagrama de "ser arquitectura", pero honestamente no hicimos casi nada hacia el estado futuro.  <b>Mi objetivo principal era enseñar a los desarrolladores prácticas de ingeniería y construir un proceso de desarrollo, haciendo que 6 equipos trabajen en un solo producto</b> . <br><br>  A medida que el equipo creció, sufrimos la falta de procesos claros y prácticas de ingeniería más.  Nuestros lanzamientos se hicieron más grandes y más largos porque cada vez más desarrolladores contribuyeron al sistema, pero no teníamos pruebas de regresión automatizadas y, por lo tanto, perdimos más tiempo en la regresión manual con cada lanzamiento.  Sufrimos muchos cambios realizados por 6 equipos en sucursales separadas.  Cuando un equipo fusionó sus cambios en una sola rama antes del lanzamiento, a veces solíamos perder hasta 4 horas resolviendo conflictos de fusión. <br><br><blockquote><h4>  Mierda pasa </h4><br>  En 2018, Marketing lanzó <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuestra primera campaña publicitaria federal en televisión</a> .  Fue un gran evento para nosotros.  Gastamos 100 millones de rublos ($ 1.5 millones) financiando la campaña, una cantidad bastante significativa para nosotros.  El equipo de TI también se preparó para la campaña.  Automatizamos y simplificamos nuestra implementación: ahora con un solo botón en TeamCity podríamos implementar el monolito en 12 países.  Investigamos pruebas de rendimiento y realizamos análisis de vulnerabilidad.  Hicimos nuestro mejor esfuerzo pero encontramos problemas inesperados. <br><br>  La campaña publicitaria fue excelente.  Pasamos de 100 a 300 pedidos / minuto.  Esta fue una buena noticia.  La mala noticia es que Dodo IS no pudo soportar tal carga y murió.  Alcanzamos nuestros límites de escala vertical y ya no podíamos manejar pedidos.  <b>El sistema se reinicia cada 3 horas.</b>  <b>Cada minuto de tiempo de inactividad nos cuesta millones de dinero, así como la pérdida de respeto de los clientes furiosos.</b> </blockquote><br>  Cuando llegué a Dodo hace 2 años como Chief Agile Officer, tenía un gran deseo de hacer de nuestro pequeño equipo, unas 12 personas, un equipo de ensueño.  Inmediatamente comencé a introducir prácticas de ingeniería.  La mayoría de los equipos adoptaron programación de pares, pruebas de unidades y DDD muy pronto.  Pero no todo fue fácil.  Tuve que superar la resistencia de los desarrolladores, el propietario del producto y el equipo de soporte. <br><br>  A diferencia de las prácticas de ingeniería, no todos favorecían la idea de equipos de características.  Los desarrolladores estaban acostumbrados a pensar que un equipo centrado en un componente está escribiendo un mejor código.  No estaba claro cómo combinar el rápido desarrollo de las características comerciales con la refactorización masiva de un sistema complejo.  Un flujo continuo de errores también requiere atención constante.  El equipo de soporte estuvo a favor de tener su propio equipo enfocado únicamente en la corrección de errores.  Muchos equipos estaban acostumbrados a trabajar en sucursales separadas y tenían miedo de integrarse con frecuencia.  Lanzamos no más de una vez por semana, y cada lanzamiento tomó bastante tiempo, requirió una gran cantidad de regresión manual y soporte de pruebas de IU.  Traté de arreglarlo, pero los cambios en mi proceso fueron demasiado lentos y fragmentados. <br><br><h2>  La historia de caída y ascenso </h2><br><h4>  Estado inicial: arquitectura monolítica </h4><br>  En pos de la velocidad de desarrollo de las características comerciales, no siempre hemos pensado bien en las soluciones técnicas.  La falta de experiencia también nos afectó.  Al principio, la compañía no podía permitirse contratar a los mejores desarrolladores.  Trabajamos con entusiastas que aceptaron ayudar con la creación de Dodo IS, creyeron en el fundador de la compañía, Fedor, y trabajaron casi por comida (pizza, por supuesto).  Los desarrolladores que se unieron al equipo luego siguieron la arquitectura establecida, que quedó obsoleta.  Así que teníamos una aplicación monolítica con una sola base de datos, que contenía todos los datos de todos los componentes en un solo lugar.  Rastreador, pago, sitio, API para páginas de destino: todos los componentes del sistema funcionaron con una sola base de datos, que se convirtió en un cuello de botella.  Nuestra arquitectura monolítica creó problemas monolíticos.  Una sola publicación en el blog provocó la interrupción del pago de un restaurante. <br><blockquote><h4>  Historia verdadera </h4><br>  Para ilustrar cuán frágil es la arquitectura monolítica, daré solo un ejemplo.  <b>Una vez que todos nuestros restaurantes en Rusia dejaron de aceptar pedidos debido a una publicación de blog.</b>  <b>¿Cómo puede pasar esto?</b> <br><br>  Un día, nuestro CEO, Fedor, publicó una publicación en su blog.  Esta publicación ganó popularidad rápidamente.  Hay un mostrador en el sitio web del blog de Fedor que muestra una serie de pizzerías en nuestra cadena y los ingresos totales de todas las pizzerías.  Cada vez que alguien lee el blog de Fedor, el servidor web envía una solicitud a la base de datos maestra para calcular los ingresos.  Estas solicitudes sobrecargaron la base de datos y dejaron de atender solicitudes de la caja del restaurante.  Entonces, una publicación de blog popular interrumpió el trabajo de toda la cadena de restaurantes.  Solucionamos rápidamente el problema, pero fue una señal clara (entre muchas otras) de que nuestra arquitectura no puede satisfacer las necesidades comerciales y debe ser rediseñada.  Pero ignoramos estos signos.  Implementamos soluciones rápidas y fáciles (como agregar una réplica de solo lectura de la base de datos maestra), pero no teníamos ninguna hoja de ruta de rediseño técnico. </blockquote><br>  La arquitectura monolítica es buena para comenzar porque es simple.  Pero no puede soportar que la alta carga sea un solo punto de falla. <br><br><h4>  Fallas tempranas en 2017 </h4><br>  <b>El 14 de febrero es un día de San Valentín</b> .  Todos aman estas vacaciones.  Para que los amantes se feliciten, el 14 de febrero hacemos una pizza especial: pepperoni en forma de corazón.  Recordaré el 14 de febrero de 2017 para siempre, porque en este día, cuando todas las pizzerías estaban funcionando a plena carga, Dodo IS comenzó a caer.  En cada pizzería tenemos de 4 a 5 tabletas para rastrear el orden en el que un fabricante de pizza hace masa, pone ingredientes, hornea o envía a la entrega.  El número de pizzerías alcanzó más de 300, cada tableta actualizó su estado varias veces por minuto.  Todas estas solicitudes crearon una carga tan masiva en la base de datos que el servidor SQL dejó de resistir y la base de datos comenzó a fallar.  Dodo se establece en el momento más inapropiado, durante el pico de las ventas.  Había una temporada festiva muy ocupada: el 23 de febrero (Día del Ejército y la Armada), el 8 de marzo (Día Internacional de la Mujer), el 1 de mayo (Día de la Solidaridad Internacional de los Trabajadores) y el 9 de mayo (Día de la Victoria en la Segunda Guerra Mundial).  Durante estas vacaciones, esperábamos un crecimiento de pedidos aún mayor. <br><br>  <b>El día en que morirás</b> .  Conociendo nuestros planes de crecimiento y el límite de la carga que podemos soportar, descubrimos cuánto tiempo podemos permanecer con vida, es decir, cuando la carga máxima de hoy se vuelve regular.  La fecha estimada de Armagedón se espera en unos seis meses, en agosto o septiembre.  ¿Cómo se siente vivir, sabiendo la fecha de tu muerte? <br><br>  <b>Detener el desarrollo de funciones por un año</b> .  Junto con el CEO Fedor, tuvimos que tomar una decisión ardua.  Quizás una de las decisiones más difíciles en la historia de la empresa.  Detuvimos el desarrollo de características comerciales.  Pensamos que nos detendríamos por 3 meses, pero pronto nos dimos cuenta de que el volumen de la deuda técnica era tan grande que 3 meses no serían suficientes y tenemos que seguir trabajando en problemas técnicos y posponer la cartera de pedidos del negocio.  De hecho, con 6 equipos hemos hecho una sola característica comercial durante el próximo año.  El resto del tiempo, los equipos se dedicaron al reembolso de la deuda técnica.  Esta deuda nos costó mucho, más de $ 1.5 millones. <br><br><h4>  Algunas mejoras después de un año. </h4><br>  Durante el año, tuvimos estos logros notables: <br><ul><li>  Hemos automatizado y acelerado nuestro proceso de implementación.  Anteriormente, el despliegue era semi-manual.  Nos desplegamos en 10 países en aproximadamente 2 horas. </li><li>  Comenzó a partir un monolito.  La parte más cargada del sistema, el rastreador, se dividió en un servicio separado, con su propia base de datos.  Ahora el rastreador se comunica con el resto del sistema a través de una cola de eventos. </li><li>  Comenzamos a separar el Cajero de entrega, el segundo componente que crea una gran carga. </li><li>  Reescribió el sistema de autenticación de usuarios y dispositivos. </li></ul><br>  Nuestro arquitecto gestionó el atraso técnico.  Utilizamos los cambios arquitectónicos para impulsar el trabajo atrasado.  Cada equipo tenía la libertad de hacer lo correcto para crear una arquitectura útil.  Para el año con los sextos equipos, creamos para el negocio solo una característica valiosa.  El resto del tiempo, los equipos trabajaron en deuda técnica.  Parece que podemos estar orgullosos de nosotros mismos.  Pero delante de nosotros hubo una gran decepción. <br><br>  Falla durante la campaña de marketing federal.  La segunda crisis de confianza. <br><br>  La deuda técnica es fácil de acumular, pero muy difícil de pagar.  Es poco probable que pueda comprender de antemano cuánto le costará. <br><br>  A pesar del hecho de que pasamos todo un año luchando contra la deuda técnica, no estábamos listos para una campaña de marketing masiva y nos equivocamos frente a nuestro negocio.  Ganas confianza en las gotas, lo pierdes en cubos.  Y tuvimos que ganarlo de nuevo. <br><br>  Perdimos el momento en que era necesario reducir la velocidad del desarrollo de las características comerciales y abordar la deuda técnica.  Era demasiado tarde cuando nos dimos cuenta.  Nos acostamos bajo carga de nuevo.  El sistema se bloqueó y reinició cada 3 horas.  Nuestro negocio perdió decenas de millones de rublos. <br><br><img src="https://habrastorage.org/webt/dc/e4/r5/dce4r5zrxw4mk9xhri2qvbora0c.jpeg"><br><br>  Pero gracias a la crisis, vimos que en condiciones extremas podemos trabajar muchas veces de manera más eficiente.  Lanzamos 20 veces al día.  Todos trabajaron como un solo equipo, centrándose en un solo objetivo.  Durante dos semanas de crisis, hemos hecho lo que temíamos comenzar antes porque creíamos que tomaría meses de trabajo.  El orden asincrónico, las pruebas de rendimiento y los registros claros son solo una pequeña parte de lo que hicimos.  Estábamos ansiosos por seguir trabajando con la misma eficacia, pero sin horas extras y sin estrés. <br><br><h2>  Lecciones aprendidas </h2><br>  Después de la retrospectiva, reestructuramos completamente nuestros procesos.  Tomamos el marco LeSS y lo complementamos con prácticas de ingeniería.  En los próximos meses, hicimos un gran avance en la adopción de prácticas de ingeniería.  Basado en el marco de LeSS, hemos implementado y seguimos utilizando: <br><ul><li>  sola cartera de pedidos; </li><li>  equipos de funciones completamente funcionales y de componentes cruzados; </li><li>  programación de pares; </li><li>  Probar la programación de la mafia. </li><li>  Integración continua genuina, lo que significa múltiples integraciones de código de 9 equipos en una sola rama; </li><li>  gestión de configuración simplificada con desarrollo basado en troncales; </li><li>  lanzamientos frecuentes: Despliegue continuo para microservicios, lanzamientos múltiples por día para monolitos; </li><li>  no hay un equipo de control de calidad separado, los expertos en control de calidad forman parte de los equipos de desarrollo. </li></ul><br><h4>  6 prácticas que elegimos después de la crisis </h4><br>  <b>1. El poder del enfoque</b> .  Antes de la crisis, cada equipo trabajaba en su propia cartera de pedidos y se especializaba en su dominio.  En el trabajo atrasado, hubo tareas finamente descompuestas, el equipo seleccionó varias tareas para un sprint.  Pero durante la crisis, trabajamos de manera bastante diferente.  Los equipos no tenían tareas específicas, sino que tenían un gran objetivo desafiante.  Por ejemplo, una aplicación móvil y una API deben manejar 300 pedidos por minuto, pase lo que pase.  Depende del equipo cómo lograr el objetivo.  Los equipos mismos formulan hipótesis, las verifican rápidamente en Producción y las tiran.  Y esto es exactamente lo que queríamos seguir haciendo.  Los equipos no quieren ser codificadores tontos, quieren resolver problemas. <br><br>  El poder del enfoque se manifestó en la resolución de problemas complejos.  Por ejemplo, durante la crisis, creamos un conjunto de pruebas de rendimiento a pesar de que no teníamos experiencia.  También hicimos la lógica de recibir una orden asincrónica.  Lo hemos pensado y hablado durante mucho tiempo, y nos pareció que esta es una tarea muy difícil y larga.  Pero resultó que el equipo es bastante capaz de hacerlo en 2 semanas, si no está distraído y completamente enfocado en el problema. <br><br>  <b>2. Hackatones regulares</b> .  Nos gustaba trabajar en el modo cuando todos los equipos apuntaban a un objetivo y decidimos a veces organizar tales "hackatones".  No se puede decir que los llevemos a cabo regularmente, pero hubo un par de veces.  Por ejemplo, hubo un hackathon de 500 errores cuando todos los equipos limpiaron los registros y eliminaron las causas de los 500 errores en el sitio y en la API.  El objetivo era mantener limpios los registros.  Cuando los registros están limpios, los nuevos errores son claramente visibles, puede configurar fácilmente los valores de umbral para las alertas.  Es similar a las pruebas unitarias: no pueden ser un poco rojas. <br><br>  Otro ejemplo de un hackathon son los errores.  Solíamos tener una gran acumulación de errores, algunos de los errores habían estado en la cartera durante años.  Parecía que nunca terminarían.  Y cada día había nuevos.  Tienes que combinar de alguna manera el trabajo en errores y en elementos regulares de la cartera de pedidos. <br><br><div class="spoiler">  <b class="spoiler_title">Introdujimos la política #zerobugspolicy en 4 pasos.</b> <div class="spoiler_text"><ol><li>  Limpieza inicial de errores basada en la fecha.  Si el error está en la cartera de pedidos durante más de 3 meses, simplemente elimínelo.  Lo más probable es que estuvo allí por años. </li><li>  Ahora, clasifique los defectos restantes según cómo afectan a los clientes.  Seleccionamos cuidadosamente los errores restantes.  Solo conservamos defectos que dificultan la vida de un gran grupo de usuarios.  Si esto es solo algo que causa inconvenientes, pero puede lidiar con eso, elimine sin piedad.  Entonces redujimos el número de errores a 25, lo cual es aceptable. </li><li>  Hackathon  Todos los equipos pululan y arreglan todos los errores.  Hicimos esto en unos pocos sprints.  Cada sprint cada equipo tomó varios errores y lo arregló.  Después de 2-3 sprints tuvimos una acumulación de errores clara.  Ahora puede ingresar #zerobugspolicy. </li><li>  #zerobugspolicy.  Cada nuevo error ahora tiene solo dos formas.  Éter se cae en la cartera de pedidos, o no.  Si entra en el backlog, lo arreglamos primero.  Cualquier error en el backlog tiene mayor prioridad que cualquier otro elemento del backlog.  Pero para entrar en la cartera de pedidos, el error debe ser grave.  O causa un daño irreparable o afecta a un gran número de usuarios. </li></ol><br></div></div><br>  <b>3. Equipos de proyectos temporales a equipos de características estables</b> .  Hubo una historia divertida con los equipos del proyecto.  Durante la crisis, formamos equipos de tigres de personas que estaban mejor capacitadas para la tarea.  Después de que terminó la crisis, los equipos decidieron continuar esta práctica y disolver los equipos.  A pesar de que no me gustó esta idea, les dejé probar.  En solo 2 semanas (un sprint), en la próxima retrospectiva, los equipos abandonaron esta práctica (esta decisión me hizo extremadamente feliz).  Intentaron y entendieron por qué es mucho más cómodo trabajar en un equipo estable.  Incluso si el equipo carece de algunas habilidades, pueden aprender gradualmente.  Pero el espíritu de equipo, el apoyo y la asistencia mutua se forman durante mucho tiempo, lleva meses.  Los equipos de proyectos a corto plazo están constantemente en fase de formación y tormenta.  Puedes soportarlo durante un par de semanas, pero no puedes trabajar así todo el tiempo.  Es bueno que los equipos hayan intentado y entendido los beneficios de los equipos con características estables. <br><br>  <b>4. Deshágase de la regresión manual</b> .  Antes de la crisis, lanzamos una vez por semana, y durante la crisis, docenas de veces al día.  Nos encantó nuestra capacidad de liberar a menudo.  Apreciamos lo conveniente que era hacer un pequeño cambio, implementarlo rápidamente e inmediatamente recibir comentarios de la producción.  Por lo tanto, cambiamos nuestro enfoque hacia los lanzamientos, y esto afectó el enfoque hacia la programación y el diseño.  Ahora lanzamos continuamente, cada 1-2 días.  Todo en la rama de desarrollo entra en producción.  Incluso si algunas funciones no están listas, esta no es razón para no publicar el código.  Si no queremos mostrar a los usuarios algunas características que aún no están listas, las ocultamos con alternancia de funciones.  Este enfoque nos ayudó a desarrollarnos en pequeños pasos. <br><br>  Fijamos una meta para deshacernos de las regresiones manuales.  Nos llevó 1,5 años alcanzarlo.  Pero tener un objetivo ambicioso a largo plazo te hace pensar en los pasos que conducen al objetivo. <br><br><div class="spoiler">  <b class="spoiler_title">Lo hicimos en 3 pasos.</b> <div class="spoiler_text"><ol><li>  Automatiza la ruta crítica.  En junio de 2017, formamos el equipo de control de calidad.  La tarea del equipo era automatizar la regresión del funcional más crítico de Dodo IS: la toma de pedidos y la producción.  Durante los próximos 6 meses, un nuevo equipo de control de calidad de 4 personas cubrió todo el camino crítico.  Los desarrolladores de equipos de funciones los ayudaron activamente.  Juntos escribimos un lenguaje específico de dominio (DSL) hermoso y comprensible, que era legible incluso para los clientes.  Paralelamente a las pruebas de extremo a extremo, los desarrolladores cubrieron el código con pruebas unitarias.  Algunos componentes nuevos fueron rediseñados con TDD.  Después de eso, disolvimos el equipo de control de calidad.  Los antiguos miembros del equipo de control de calidad se unieron a equipos de funciones para compartir experiencia sobre cómo apoyar y mantener las pruebas automáticas. </li><li>  Modo de sombra.  Al tener pruebas automáticas, durante 5 lanzamientos hicimos regresiones manuales en modo sombra.  Los equipos confiaron solo en el conjunto de pruebas automatizadas, pero cuando el equipo decidió "Estamos listos para lanzar", ejecutamos una regresión manual para verificar si nuestras pruebas automáticas fallan.  Rastreamos cuántos errores fueron detectados manualmente y no detectados por las pruebas automáticas.  Después de 5 lanzamientos, revisamos los datos y decidimos que podemos confiar en nuestras pruebas automáticas.  No se perdieron errores importantes. </li><li>  Eliminar regresiones manuales.  Cuando tuvimos suficientes pruebas para comenzar a confiar en ellas, abandonamos por completo las pruebas manuales.  Cuanto más ejecutamos nuestras pruebas, más confiamos en ellas.  Pero esto sucedió solo 1.5 años después de que comenzamos a automatizar las pruebas de regresión. </li></ol><br></div></div><br>  <b>5. Prueba de rendimiento es parte de la prueba de regresión</b> .  Durante la crisis, creamos un conjunto de pruebas de rendimiento.  Era un área completamente nueva para nosotros.  Sin embargo, en solo 2 semanas, logramos crear algunas pruebas de rendimiento utilizando las herramientas de Visual Studio.  Estas pruebas nos ayudaron no solo a detectar la degradación del rendimiento.  Los usamos para agregar carga sintética al servidor de producción para identificar los límites de rendimiento.  Por ejemplo, si la carga de producción orgánica es de 100 pedidos / min y agregamos 50 más pedidos / min con la ayuda de nuestras pruebas de rendimiento, podemos ver si los servidores de Producción pueden manejar el aumento de carga.  Tan pronto como notamos excepciones o aumento de la latencia, detenemos la prueba.  Al realizar estos experimentos, descubrimos la carga máxima que nuestros servidores de producción pueden manejar y cuál será el punto de acceso. <br><br>  El año que viene superamos las pruebas de rendimiento al equipo experimentado de PerformanceLab.  Se reunieron con nuestros desarrolladores y personal de infraestructura, y nos ayudaron a crear un conjunto robusto de pruebas de rendimiento.  Ahora ejecutamos estas pruebas semanalmente y proporcionamos comentarios rápidos a los equipos de desarrollo si el rendimiento se ve afectado. <br><br>  Algunas de las prácticas de ingeniería fueron refinadas iterativamente.  Por ejemplo, lanzamientos frecuentes.  Comenzamos con ciclos de lanzamiento semanales, compatibles con pruebas manuales lentas y frágiles.  Desarrollamos funciones durante una semana y probamos durante otra semana.  Pero fue difícil mantener los cambios realizados por múltiples durante una semana.  Luego probamos lanzamientos de equipos aislados, cuando solo se lanzaron los cambios realizados por un solo equipo.  Pero este proceso falló porque cada equipo tuvo que esperar en la cola durante varias semanas.  Luego, los equipos aprendieron los beneficios de la integración frecuente y comenzamos a practicar lanzamientos conjuntos de cambios de equipos múltiples.  Los desarrolladores comenzaron a experimentar con la función de alternancia de funciones y a pasar a funciones sin terminar de producción.  Finalmente, llegamos a Integración continua y múltiples versiones por día para monolitos e Implementación continua para microservicios. <br><br><img src="https://habrastorage.org/webt/ce/yd/ay/ceyday2plzigxpfvhdmldzhpav4.jpeg"><br><br>  Otro caso interesante es con nuestro departamento de control de calidad.  Antes no teníamos un equipo de control de calidad, sino que teníamos probadores manuales.  Al darse cuenta de la necesidad de la automatización de pruebas, formamos un equipo de control de calidad, pero desde el primer día este equipo sabía que algún día se disolvería.  Después de 6 meses, el equipo automatizó nuestros escenarios comerciales clave y, con la ayuda de los desarrolladores, escribió un lenguaje específico de dominio (DSL) conveniente para escribir pruebas.  El equipo se separó y los ingenieros de calidad se unieron a los equipos de características.  Ahora los propios equipos desarrollan y mantienen autotest. <br><br>  Hoy tenemos una única cartera de pedidos en la que están trabajando 9 equipos de características.  Los equipos de características son equipos estables, multifuncionales y de componentes cruzados.  La mayoría de nuestros equipos son equipos de características. <br><br>  <b>6. Centrarse en las prácticas de ingeniería</b> .  Todos nuestros equipos usan programación en pares.  Considero que la programación de pares es una de las prácticas más simples pero poderosas que ayuda a implementar otras prácticas de ingeniería.  Si no sabe qué práctica de ingeniería comenzar, le recomiendo programar la pareja. <br><br><h2>  Resultados </h2><br>  El principal resultado que nos dio la crisis es una sacudida.  Nos despertamos y comenzamos a actuar.  La crisis nos ha ayudado a ver el máximo de nuestras oportunidades.  Vimos que podemos trabajar muchas veces de manera más eficiente y alcanzar rápidamente nuestros objetivos.  Pero esto requiere cambiar la forma habitual de trabajar.  Hemos dejado de tener miedo de hacer experimentos audaces.  Como resultado de estos experimentos, durante el año pasado hemos mejorado significativamente la calidad y la estabilidad de Dodo IS.  Si durante las vacaciones de primavera en 2018 nuestras pizzerías no pudieron funcionar debido a Dodo IS, entonces en 2019, con un crecimiento de 300 a 450 pizzerías, Dodo IS funcionó a la perfección.  En silencio, experimentamos el pico de ventas en el Año Nuevo, durante la segunda Campaña de Marketing y las vacaciones de primavera.  Por primera vez en mucho tiempo, confiamos en la calidad del sistema y dormimos bien por la noche.  Este es el resultado del uso constante de las prácticas de ingeniería y el enfoque en la excelencia técnica. <br><br><h4>  Resultados para empresas </h4><br>  Las prácticas de ingeniería no son necesarias por sí mismas si no benefician a su negocio.  Como resultado del enfoque en la excelencia técnica, mejoramos la calidad del código y desarrollamos características comerciales con una velocidad predecible.  Los lanzamientos se han convertido en un evento regular para nosotros.  Lanzamos el monolito cada 2 días y servicios más pequeños cada pocos minutos.  Esto significa que podemos ofrecer rápidamente valor comercial a nuestros usuarios y recopilar comentarios más rápido.  Gracias a la flexibilidad de los equipos de características, obtenemos una alta velocidad de desarrollo. <br><br><blockquote>  Hoy tenemos 480 pizzerías en línea, 400 de las cuales están en Rusia.  Durante las vacaciones de mayo de este año, hubo problemas con el procesamiento de pedidos en nuestras pizzerías nuevamente.  Pero esta vez el cuello de botella fue el servicio al cliente en las pizzerías.  Dodo IS funcionaba como un reloj, a pesar del creciente número de pizzerías y pedidos. </blockquote><br><h4>  Resultados para los equipos </h4><br>  Hoy utilizamos una amplia gama de prácticas de ingeniería: <br><ol><li>  Equipos con funciones totalmente funcionales y de componentes cruzados. </li><li>  Programación en pareja / Programación de mobs. </li><li>  Integración continua genuina, lo que significa múltiples integraciones de código de 9 equipos en una sola rama. </li><li>  Gestión de configuración simplificada con desarrollo basado en troncales. </li><li>  Objetivo común para múltiples equipos. </li><li>  El experto en la materia está en el equipo. </li><li>  No hay un equipo de control de calidad separado, los expertos en control de calidad son parte de los equipos de desarrollo. </li><li>  Reemplazo manual de regresión manual con autotest. </li><li>  Política de cero errores. </li><li>  Retraso técnico de la deuda. </li><li>  Detenga la línea como un controlador para la aceleración de la tubería de implementación. </li></ol><br>  Ayudan a 9 equipos a trabajar en un código común y un único producto que incluye docenas de componentes: un sitio móvil y de escritorio, una aplicación móvil en iOS y Android, y un back office gigante con caja registradora, seguimiento, exhibición de restaurantes, cuenta personal , análisis y pronósticos. <br><br><h4>  Que puede ser mejor </h4><br>  Puede parecer que ya hemos hecho un buen progreso en las prácticas de ingeniería, pero solo estamos al principio, todavía tenemos espacio para crecer.  Por ejemplo, intentamos, pero hasta ahora de manera poco sistemática, la programación de la mafia.  Estudiamos el enfoque de escritura de prueba BDD.  Todavía tenemos espacio para crecer en CI, entendemos que la integración, incluso una vez al día, no es suficiente.  Y cuando crezcamos hasta 30 equipos, será necesario integrarnos más a menudo.  Todavía estamos en progreso de la transición de TDD a ATDD.  Tenemos que crear un proceso de toma de decisiones arquitectónicas sostenible y escalable. <br>  Lo más importante es que nos dirigimos hacia el fortalecimiento de la Excelencia Técnica. <br><br>  Debido al hecho de que los 9 equipos están trabajando en una cartera de pedidos común y en un producto, los equipos tienen un fuerte deseo de cooperar entre sí.  Aprendieron a tomar decisiones fuertes ellos mismos. <br><br><div class="spoiler">  <b class="spoiler_title">Por ejemplo, las siguientes prácticas han sido propuestas e implementadas por los propios equipos.</b> <div class="spoiler_text"><ol><li>  Detenga la línea como un controlador para la aceleración de la tubería de implementación (consulte el informe de mi experiencia "Detenga la línea para racionalizar su tubería de implementación"). </li><li>  Reemplace las pruebas de IU con pruebas de API. </li><li>  Implementación automatizada con un solo clic. </li><li>  Anfitrión de Kubernetes. </li><li>  El equipo de desarrollo se implementa en producción. </li></ol><br></div></div><br><br>  Algunos equipos mostraron su deseo de usar las 12 prácticas de XP y me pidieron ayuda como XP Coach y Scrum Master. <br><br><h2>  Lo que aprendimos </h2><br>  Desearía no dejar que la crisis suceda.  Como desarrollador, sentí la responsabilidad personal de acumular una deuda técnica demasiado grande y no levantar una bandera roja antes: <br><ul><li>  Las prácticas de ingeniería protegen a las empresas de las crisis. </li><li>  No acumule deuda técnica.  Puede ser demasiado tarde y costar demasiado. </li><li>  Los cambios evolutivos tardan varias veces más que los revolucionarios. </li><li>  La crisis no siempre es algo malo.  Utiliza la crisis para revolucionar los procesos. </li><li>  Sin embargo, se requiere una larga preparación evolutiva de antemano. </li><li>  No implementes ciegamente todas las prácticas que te gustan.  Algunas prácticas están esperando en las alas, y cuando él venga, los equipos las usarán sin resistencia.  Espera el momento correcto. </li><li>  Refina y adapta las prácticas a tu contexto. </li><li>  Con el tiempo, los propios equipos comienzan a tomar decisiones firmes y a implementarlas.  Bríndeles un ambiente seguro para probar, fallar y aprender sobre los errores. </li></ul><br><br>  La deuda técnica nos lleva a la crisis.  Pero de la crisis, tanto los desarrolladores como las personas de negocios aprendieron la importancia del enfoque en la excelencia técnica y las prácticas de ingeniería.  Utilizamos la crisis como un desencadenante para el cambio masivo de organización y procesos. <br><hr><br><h4>  <i>Agradecimientos</i> </h4> <i><br></i>  <i>Me gustaría dar las gracias a todas las personas que me ayudaron en mi viaje desde la crisis hasta la transformación de LeSS.</i>  <i>Constantemente siento tu apoyo.</i> <i><br><br></i>  <i>Muchas gracias a nuestro CEO, Fedor Ovchinnikov por la confianza.</i>  <i>Eres el verdadero líder de la empresa con una cultura ágil genuina.</i> <i><br><br></i>  <i>Muchas gracias a Dmitry Pavlov, nuestro Product Owner, mi viejo amigo y co-entrenador.</i> <i><br><br></i>  <i>Gracias Alex Andronov y Andrey Morevsky por apoyarme en mi papel.</i> <i><br><br></i>  <i>Muchas gracias a Dasha Bayanova, nuestro primer Scrum Master a tiempo completo, que me creyó y siempre me ayuda y apoya con toda nuestra iniciativa.</i>  <i>Su ayuda es difícil de sobreestimar.</i> <i><br><br></i>  <i>Muchas gracias a Johanna Rothman, quien me ayudó a escribir este informe en cualquier condición: estar de vacaciones, recuperarse después de una enfermedad.</i>  <i>Johanna, fue un placer trabajar contigo.</i>  <i>Su ayuda, consejo, atención a los detalles y diligencia son muy apreciados.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447154/">https://habr.com/ru/post/447154/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447144/index.html">Cómo organicé el almacenamiento de fotos</a></li>
<li><a href="../447146/index.html">Interruptores industriales no administrados EKI</a></li>
<li><a href="../447148/index.html">La aplicación (des) oficial de Habr - HabrApp 2.0: acceso</a></li>
<li><a href="../447150/index.html">Chat en el sitio y en la emisión de Yandex</a></li>
<li><a href="../447152/index.html">Lanzamiento del kit de herramientas multiplataforma .NET UI AvaloniaUI 0.8</a></li>
<li><a href="../447156/index.html">Wireshark 3.x: análisis de código bajo macOS y revisión de errores</a></li>
<li><a href="../447158/index.html">Wireshark 3.x: análisis de código de macOS y revisión de errores</a></li>
<li><a href="../447160/index.html">Espacio para niños. Algunas ideas para el día de la cosmonáutica</a></li>
<li><a href="../447162/index.html">No compre ERP</a></li>
<li><a href="../447164/index.html">¿Cómo combinar las ventajas de una computadora portátil y una computadora de escritorio? Análisis de problemas y soluciones (Parte 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>