<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚Äçüßëüèª üê™ üôãüèæ Automatizaci√≥n de la obtenci√≥n de informaci√≥n de USRLE usando Freepascal üë©üèΩ‚Äçüíª üêö ü§¶üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En mi trabajo (legal), estoy listo para automatizar todo lo que solo se presta a esto. Pero hasta que los robots bombeados por las redes neuronales de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatizaci√≥n de la obtenci√≥n de informaci√≥n de USRLE usando Freepascal</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419063/"><img src="https://habrastorage.org/webt/xp/n2/lb/xpn2lbf3yf9_ryhoprada0ehl5i.jpeg"><br><br><p>  En mi trabajo (legal), estoy listo para automatizar todo lo que solo se presta a esto.  Pero hasta que los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">robots</a> bombeados por las redes neuronales <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de la utop√≠a del alem√°n Gref</a> no aparecieran y no tomaran todo el trabajo de los abogados ordinarios, la rutina seguir√° siendo nuestro principal compa√±ero durante mucho tiempo.  La automatizaci√≥n de esta rutina es algo que he estado haciendo peri√≥dicamente durante los √∫ltimos a√±os, ya sea numerosas tablas en Excel con un mont√≥n de f√≥rmulas que le permiten imprimir r√°pidamente cien de los mismos documentos de correo en Word, o bien, informes generados autom√°ticamente.  Pero hay cosas que no puedes hacer con simples f√≥rmulas y sustituciones.  Aqu√≠ es donde la programaci√≥n viene al rescate, lo que me ha gustado desde la infancia, y sucedi√≥ que comenz√≥ con Delphi.  Ahora es m√°s f√°cil para m√≠ que en C # o Python, que comenc√© a aprender recientemente, hacer r√°pidamente alg√∫n tipo de proyecto en el entorno de Lazarus usando Freepascal.  Y s√≠, creo seriamente que las capacidades de este entorno son m√°s que suficientes.  Por lo tanto, automatizar el USRLE, lo has adivinado, debe hacerse usando pascal. <br><a name="habracut"></a><br></p><p>  Un abogado de una oficina de consultor√≠a que realiza negocios de docenas de entidades legales, un abogado de pan corporativo y cualquier otro abogado que se enfrente a garantizar las actividades de las organizaciones: todos saben c√≥mo docenas y cientos de nombres diferentes, n√∫meros TIN, PSRN se mezclan en su cabeza, c√≥mo es f√°cil olvidar qui√©n es el gerente, y cuando su plazo de renovaci√≥n es apropiado, ¬øhay alg√∫n problema con las acciones de la LLC y con el pago de su capital social?  Bueno, la necesidad de hacer r√°pidamente alg√∫n tipo de documento, que incluye muchos detalles que cambian constantemente, implica errores peri√≥dicos y errores tipogr√°ficos.  Para automatizar esos procesos, necesitaba una soluci√≥n de base de datos que me permitiera crear documentos usando plantillas, mantener varios registros, rastrear cambios y no perder ning√∫n plazo.  Bueno, una de las simplificaciones necesarias de la vida es la recepci√≥n r√°pida de un archivo nuevo con informaci√≥n de la USRLE del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio web del Servicio de Impuestos Federales</a> .  Por supuesto, nadie dice que usar el sitio directamente es largo y dif√≠cil, pero est√° de acuerdo en que hacer clic en un bot√≥n sin salir de la aplicaci√≥n es mucho m√°s divertido, y puede hacerlo sin interrumpir la llamada telef√≥nica (o una taza de caf√©). <br><br></p><p>  Entonces, para empezar, decidiremos qu√© queremos obtener.  El sitio le permite buscar en el <abbr title="En este caso, la oficialidad de la fuente de informaci√≥n es importante, ya que los extractos de la USRLE recibidos de forma completamente gratuita de esta manera son aceptados incluso por los tribunales como evidencia">registro oficial de la</abbr> USRLE un n√∫mero OGRN o TIN √∫nico y dar un resultado relevante en forma de una breve informaci√≥n sobre la persona y un enlace para descargar el archivo pdf con un extracto.  Adem√°s, la b√∫squeda puede ser difusa por nombre con un filtro adicional por regi√≥n (tema de la Federaci√≥n de Rusia).  Y en este caso, el sitio emite una tabla con todas las personas adecuadas y con el mismo conjunto de datos, incluidos enlaces a pdf. <br><br></p><p>  Por lo tanto, en un caso particular, la funci√≥n preparada debe devolver pdf en forma de archivo (o, mejor, una secuencia), que tiene un OGRN o TIN en la entrada.  Pero para la universalizaci√≥n y la posibilidad de una mayor expansi√≥n, no descuidaremos todas las caracter√≠sticas del sitio y tampoco realizaremos una funci√≥n de b√∫squeda difusa con el retorno de un conjunto de datos encontrados por el nombre de la organizaci√≥n, teniendo en cuenta el filtro por regi√≥n o sin √©l.  Intentemos describir las interfaces de estas funciones: <br><br></p><pre><code class="delphi hljs">IEGRULstreamer = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; ; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsListByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Region: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; ; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LegalsList: TCollection)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br>  Para entender cu√°l es el misterioso par√°metro X y la colecci√≥n de la cual regresar√° la segunda funci√≥n, veremos c√≥mo el sitio ejecuta la solicitud. <br><br><p>  1. El sitio tiene un formulario con campos de entrada para identificadores para buscar y verificar captcha: <br><br><img src="https://habrastorage.org/webt/ua/vn/gf/uavngfdababogkh8q7yexvfx-nw.jpeg"><br><br></p><p>  2. Captcha se genera utilizando un campo oculto pregenerado con el nombre captchaToken, que utiliza un script Java para generar una imagen captcha para este token. <br><br></p><p>  3. Despu√©s de hacer clic en el bot√≥n "buscar", se env√≠a una solicitud POST al servidor, en cuyos resultados de procesamiento se devuelve JSON con una matriz de objetos.  Esta respuesta JSON utiliza otro script Java para completar la tabla que vemos en los resultados de b√∫squeda. <br><br>  Entonces, el primer inconveniente es la verificaci√≥n de captcha.  Para no sobrecargar nuestros m√©todos de interacci√≥n con el sitio con exceso de funcionalidad, tomaremos medidas para procesar captcha como una funci√≥n separada.  Y en X, tendremos un par√°metro para el m√©todo de devoluci√≥n de llamada, que tiene una imagen captcha en la entrada y una cadena con captcha reconocido en la salida: <br><br></p><pre> <code class="delphi hljs">TCapthcaRecognizeFunc = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Captha: TStream)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>; ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span></code> </pre><br>  La funci√≥n que procesa el captcha puede hacerlo a su gusto: permita que el usuario lo ingrese manualmente, env√≠e la imagen a un servidor de pago para su reconocimiento autom√°tico, de manera independiente, h√°galo mediante el conocimiento √∫nico del algoritmo.  Para simplificar la imagen, y dado que en mi caso no se espera un flujo de captcha a escala industrial, seleccionamos la primera opci√≥n: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TForm1</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RecognizeFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(captcha: TStream)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> CaptchaImg.Picture.LoadFromStream(captcha); Result := InputBox(<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">'    '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><p>  La segunda pregunta es el contenido de la respuesta JSON del servidor.  Aqu√≠ hay un ejemplo de lo que viene en √©l: <br><br></p><div class="spoiler">  <b class="spoiler_title">Respuesta con formato JSON</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: {<span class="hljs-attr"><span class="hljs-attr">"captcha"</span></span>:<span class="hljs-string"><span class="hljs-string">"382915"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ogrninnfl"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fam"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nam"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"otch"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"region"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ogrninnul"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"namul"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"regionul"</span></span>:<span class="hljs-string"><span class="hljs-string">"73"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>:<span class="hljs-string"><span class="hljs-string">"ul"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ul"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"searchByOgrn"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nameEq"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"searchByOgrnip"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}, <span class="hljs-attr"><span class="hljs-attr">"rows"</span></span>: [ {<span class="hljs-attr"><span class="hljs-attr">"T"</span></span>:<span class="hljs-string"><span class="hljs-string">"ED346E713D4A1AC851F9B589C6D2AECD1D809D5B6B5D1B98E697B6E0FD873E137B828AC59A60D159BB2894F11D00AB5639E2ACEE4E2ED5B7AC7A6EFE28FD987BC288B93C4D3D3EC1008DA0F128BA7E5E"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"INN"</span></span>:<span class="hljs-string"><span class="hljs-string">"7325001144"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NAME"</span></span>:<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"OGRN"</span></span>:<span class="hljs-string"><span class="hljs-string">"1027301175110"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ADRESTEXT"</span></span>:<span class="hljs-string"><span class="hljs-string">"432017,  ,  ,  , 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"CNT"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"DTREG"</span></span>:<span class="hljs-string"><span class="hljs-string">"03.12.2002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"KPP"</span></span>:<span class="hljs-string"><span class="hljs-string">"732501001"</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">"T"</span></span>:<span class="hljs-string"><span class="hljs-string">"2ECB284C7682E5F1D1129AA3074FABB4B74BB28EA426AF79C091CEDEA0D9E391CA26FF405A7C9742466E19C78FBE5A59BDCBCD21268FFD8AFD3A8509CCA84541"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"INN"</span></span>:<span class="hljs-string"><span class="hljs-string">"7303007375"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NAME"</span></span>:<span class="hljs-string"><span class="hljs-string">"      \"   \""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"OGRN"</span></span>:<span class="hljs-string"><span class="hljs-string">"1027301173283"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ADRESTEXT"</span></span>:<span class="hljs-string"><span class="hljs-string">"432063,  ,  ,   , 7"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"CNT"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"DTREG"</span></span>:<span class="hljs-string"><span class="hljs-string">"27.11.2002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"KPP"</span></span>:<span class="hljs-string"><span class="hljs-string">"732501001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"DTEND"</span></span>:<span class="hljs-string"><span class="hljs-string">"01.09.2010"</span></span>}, ] }</code> </pre><br></div></div><br>  Como puede ver, el resultado devuelve un objeto de consulta que contiene los par√°metros de b√∫squeda iniciales (para que permanezcan en los campos del formulario para su reutilizaci√≥n) y una matriz de filas.  El enlace al archivo pdf se combina con un script java usando la expresi√≥n: <pre>  "https://egrul.nalog.ru/download/" </pre>  y el valor clave "T" del objeto.  La vida √∫til del archivo pdf generado es de unos minutos. <br><br><p>  Las dos dificultades principales que encontr√© al crear la solicitud http son los valores de encabezado correctos y la combinaci√≥n de la cadena con los par√°metros de la solicitud POST.  Pero un simple an√°lisis de la p√°gina utilizando las herramientas integradas del navegador (en Chrome se llama presionando F12) le dio todo lo que necesita.  Aqu√≠ hay un ejemplo de encabezados con los que el servidor da la respuesta correcta en lugar de 400 Solicitud incorrecta: <br><br></p><pre> <code class="hljs powershell">POST / HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: egrul.nalog.ru Connection: keep<span class="hljs-literal"><span class="hljs-literal">-alive</span></span> Accept: application/json, text/javascript, */*; q=<span class="hljs-number"><span class="hljs-number">0.01</span></span> Origin: https://egrul.nalog.ru X<span class="hljs-literal"><span class="hljs-literal">-Requested</span></span><span class="hljs-literal"><span class="hljs-literal">-With</span></span>: XMLHttpRequest User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: Chrome/<span class="hljs-number"><span class="hljs-number">67.0</span></span>.<span class="hljs-number"><span class="hljs-number">3396.99</span></span> Safari/<span class="hljs-number"><span class="hljs-number">537.36</span></span> Content<span class="hljs-literal"><span class="hljs-literal">-Type</span></span>: application/x<span class="hljs-literal"><span class="hljs-literal">-www</span></span><span class="hljs-literal"><span class="hljs-literal">-form</span></span><span class="hljs-literal"><span class="hljs-literal">-urlencoded</span></span> Referer: https://egrul.nalog.ru/ Accept<span class="hljs-literal"><span class="hljs-literal">-Encoding</span></span>: gzip, deflate, br Accept<span class="hljs-literal"><span class="hljs-literal">-Language</span></span>: ru<span class="hljs-literal"><span class="hljs-literal">-RU</span></span>,ru;q=<span class="hljs-number"><span class="hljs-number">0.9</span></span>,en<span class="hljs-literal"><span class="hljs-literal">-US</span></span>;q=<span class="hljs-number"><span class="hljs-number">0.8</span></span>,en;q=<span class="hljs-number"><span class="hljs-number">0.7</span></span></code> </pre><br>  Y aqu√≠ est√° la l√≠nea con los par√°metros: <br><br><pre> <code class="hljs perl">kind=ul&amp;srchUl=name&amp;ogrninnul=<span class="hljs-number"><span class="hljs-number">7716819629</span></span>&amp;namul=%D0%BF%D1%80%D0%B0%D0%B2% D<span class="hljs-number"><span class="hljs-number">0</span></span>%B8%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D1%82%D0%B2%D0%BE&amp;regionul=<span class="hljs-number"><span class="hljs-number">73</span></span> &amp;srchFl=ogrn&amp;ogrninnfl=&amp;fam=&amp;nam=&amp;otch=&amp;region=&amp;captcha=<span class="hljs-number"><span class="hljs-number">449023</span></span>&amp;captchaToken=DAEDA <span class="hljs-number"><span class="hljs-number">7504</span></span>CACAC82CF09E08319B68DF5F9BD62B2F44D33DD679DDE55B5CF58B17FEC84E78CEEB9639 <span class="hljs-number"><span class="hljs-number">84</span></span>D2B2BD8C3AA15</code> </pre> <br><p>  Armados con estos datos iniciales, procedemos a la implementaci√≥n de la tarea.  Usar√© las siguientes bibliotecas para freepascal: <br><br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Synapse</a> es una biblioteca muy conveniente con la funci√≥n m√°s simplificada (para uso) de enviar solicitudes http al servidor, tambi√©n funciona con SSL, pero esto requiere la <abbr title="Tengo suficientes bibliotecas libeay32.dll y ssleay32.dll en la plataforma win32">presencia de bibliotecas openSSL</abbr> en la carpeta o sistema del proyecto, as√≠ como la conexi√≥n de un m√≥dulo adicional.  Es suficiente conectar los siguientes m√≥dulos de biblioteca a nuestro proyecto: httpsend, ssl_openssl, synautil. <br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La biblioteca incorporada fcl-json</a> - los m√≥dulos necesarios: fpjson y fpjsonrtti - para la m√°xima conveniencia de procesar objetos devueltos a JSON. <br><br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">M√≥dulos separados de la biblioteca incorporada fcl-xml</a> : para algunas funciones, deber√° trabajar con partes de HTML como objetos DOM, por lo que conectaremos los m√≥dulos SAX_HTML, DOM_HTML, DOM. <br><br>  Describamos los tipos y clases de objetos que finalmente resultaron: <br><br></p><pre> <code class="delphi hljs"><span class="hljs-title"><span class="hljs-title">TEGRULItem</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TCollectionItem) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> fT, fINN, fNAME, fOGRN, fADRESTEXT, fCNT, fDTREG, fDTEND, fKPP: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPdfLink</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">published</span></span> <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> T: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fT <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fT; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> INN: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fINN <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fINN; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fNAME <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fNAME; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> OGRN: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fOGRN <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fOGRN; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> ADRESTEXT: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fADRESTEXT <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fADRESTEXT; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> CNT: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fCNT <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fCNT; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> DTREG: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fDTREG <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fDTREG; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> DTEND: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fDTEND <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fDTEND; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> KPP: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fKPP <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fKPP; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><p>  En esta clase empacaremos objetos que se devolver√°n en la matriz de filas en la respuesta JSON del servidor.  Los leeremos usando JSONToCollection, pero para esto necesitamos hacer de cada objeto un elemento de la colecci√≥n y declarar todas las propiedades relacionadas como se publican.  Las funciones RTTI en freepascal (as√≠ como en delphi) obtienen acceso a los nombres de propiedad solo cuando se declaran en este √°mbito.  Y la funci√≥n JSONToCollection del m√≥dulo fpjsonrtti es solo una funci√≥n RTTI que compara los nombres de las claves del objeto JSON con los nombres de las propiedades de la clase. <br></p><blockquote>  Tambi√©n hay una funci√≥n GetPdfLink en la interfaz de clase, que devuelve un enlace para descargar un archivo pdf con informaci√≥n de la USRLE mediante la concatenaci√≥n de la direcci√≥n web y el valor de la propiedad "T". </blockquote><br><br><p>  La clase principal que implementa la interfaz declarada anteriormente ser√° as√≠: <br><br></p><pre> <code class="delphi hljs"> <span class="hljs-title"><span class="hljs-title">TEGRULStreamer</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, IEGRULStreamer) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HTTPSender: THTTPSend; Doc: THTMLDocument; Inputs: TDOMNodeList; captchaURL, captchaToken, captcha, Params: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCaptchaToken</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsList</span></span></span><span class="hljs-function">:</span></span> TCollection; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareHeaders</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessCaptcha</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CaptchaFunc: TCapthcaRecognizeFunc)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsListByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Region: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LegalsList: TCollection)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">destructor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Destroy</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><br><p>  Como puede ver, adem√°s de la implementaci√≥n de las dos funciones principales de la interfaz, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">todas las dem√°s propiedades y m√©todos de la clase estar√°n ocultos</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ser√°n</a> necesarios solo para la implementaci√≥n interna.  En general, podr√≠an incluirse dentro de los m√©todos principales, pero ya hemos revisado las lecciones sobre c√≥digo duplicado, visualizaci√≥n y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">refactorizaci√≥n</a> en general. <br></p><p>  Dada la encapsulaci√≥n de acciones preparatorias, los m√©todos principales generalmente diferir√°n solo formando una cadena de par√°metros de solicitud http y el tipo de datos devuelto. <br><br></p><div class="spoiler">  <b class="spoiler_title">c√≥digo de m√©todo TEGRULStreamer.GetExtractByOGRN</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TEGRULStreamer</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ProcessCaptcha(CaptchaFunc); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isLegal <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Params := <span class="hljs-string"><span class="hljs-string">'kind=ul'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Params := <span class="hljs-string"><span class="hljs-string">'kind=fl'</span></span>; Params += <span class="hljs-string"><span class="hljs-string">'&amp;srchUl=ogrn&amp;srchFl=ogrn&amp;ogrninnul='</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isLegal <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Params += OGRN; Params += <span class="hljs-string"><span class="hljs-string">'&amp;namul=&amp;regionul=&amp;ogrninnfl='</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> isLegal <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Params += OGRN; Params += <span class="hljs-string"><span class="hljs-string">'&amp;fam=&amp;nam=&amp;otch=&amp;region&amp;captcha='</span></span> + captcha + <span class="hljs-string"><span class="hljs-string">'&amp;captchaToken='</span></span> + captchaToken; WriteStrToStream(HTTPSender.Document, Params); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> HTTPSender.HTTPMethod(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, EGRUL_URL) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception.Create(<span class="hljs-string"><span class="hljs-string">'   '</span></span>); HTTPSender.Headers.Clear; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> HTTPSender.HTTPMethod(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, TEGRULItem(GetLegalsList.Items[<span class="hljs-number"><span class="hljs-number">0</span></span>]).GetPdfLink) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Extract := HTTPSender.Document <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Extract := <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>;</code> </pre><br></div></div><br><p>  Aqu√≠, como podemos ver, el m√©todo tambi√©n utiliza el par√°metro booleano isLegal, y si no se establece en verdadero, la b√∫squeda pasa por la base de datos de empresarios en lugar de entidades legales. <br><br></p><div class="spoiler">  <b class="spoiler_title">c√≥digo de m√©todo TEGRULStreamer.GetLegalsListByName</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TEGRULStreamer</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsListByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Region: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LegalsList: TCollection)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ProcessCaptcha(CaptchaFunc); Params := <span class="hljs-string"><span class="hljs-string">'kind=ul&amp;srchUl=name&amp;srchFl=ogrn&amp;ogrninnul=&amp;namul='</span></span>; Params += <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> + <span class="hljs-string"><span class="hljs-string">'&amp;regionul='</span></span> + Region + <span class="hljs-string"><span class="hljs-string">'&amp;ogrninnfl=&amp;fam=&amp;nam=&amp;otch=&amp;region'</span></span>; Params += <span class="hljs-string"><span class="hljs-string">'&amp;captcha='</span></span> + captcha + <span class="hljs-string"><span class="hljs-string">'&amp;captchaToken='</span></span> + captchaToken; WriteStrToStream(HTTPSender.Document, Params); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> HTTPSender.HTTPMethod(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, EGRUL_URL) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception.Create(<span class="hljs-string"><span class="hljs-string">'   '</span></span>); LegalsList := GetLegalsList; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br></div></div><br><p>  El papel de los m√©todos de utilidad es el siguiente: <br><br>  <b>ProcessCaptcha</b> : descarga la p√°gina html inicial del Servicio de Impuestos Federales, busca un token de captcha, descarga una imagen generada por este token y lo redirige a un m√©todo de devoluci√≥n de llamada para el reconocimiento de captcha.  Al final, el m√©todo tambi√©n establece los encabezados correctos para la solicitud POST posterior. <br><br>  <b>GetCaptchaToken</b> : carga todos los campos de entrada de la p√°gina en la estructura DOM, busca un campo oculto con el identificador capthcaToken y devuelve su valor. <br><br>  <b>GetLegalsList</b> : el uso de la funci√≥n RTTI JSONToCollection devuelve una colecci√≥n de objetos de tipo TEGRULItem descritos anteriormente. <br><br>  <s><b><abbr title="funci√≥n transferida a la implementaci√≥n de la clase TEGRULItem">GetPdfLink</abbr></b></s> : para buscar por OGRN o TIN, en el caso correcto, siempre se devolver√° un solo resultado, por lo tanto, en GetExtractByOGRN se llama a la funci√≥n para el primer elemento de la colecci√≥n. <br><br></p><p>  Como esta es mi primera experiencia con una red en freepascal, estoy muy contento de que todo haya salido exactamente como lo pretend√≠a.  En una forma de trabajo, la biblioteca se hizo en menos de un d√≠a (gracias a los usuarios del foro de freepascal.ru, que hablaron sobre la sinapsis). <br><br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un archivo con una prueba de la biblioteca resultante y su c√≥digo est√° aqu√≠</a> . <br><br></p><p>  Como siempre, me complacer√° cualquier cr√≠tica constructiva tanto sobre el proyecto como sobre la implementaci√≥n.  Entiendo que hay muchos factores que a√∫n pueden tenerse en cuenta: la demora en responder a la solicitud http, como resultado de lo cual la aplicaci√≥n se congelar√°;  Respuestas http incorrectas y otras situaciones. <br><br></p><p>  En el futuro, planeo conectar una biblioteca en l√≠nea con la base de datos de direcciones FIAS y darme cuenta de la capacidad de generar plantillas de aplicaciones completas, que generalmente se editan en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el Programa de preparaci√≥n de documentos para el registro estatal</a> . <br><br><img src="https://habrastorage.org/webt/pu/a0/qm/pua0qmeomu83os45u7on8e9picm.gif" align="right"><br>  <i>PD: Lo siento, Sberbank, por el papel del conejo experimental y cientos de veces el extracto descargado.</i>  <i>Todo en nombre de la ciencia, por supuesto.</i> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419063/">https://habr.com/ru/post/es419063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419049/index.html">GeekBrains lanza el marat√≥n educativo en l√≠nea gratuito "Find Yourself in Digital"</a></li>
<li><a href="../es419051/index.html">C√≥mo Flant ayuda a los principiantes</a></li>
<li><a href="../es419053/index.html">Prueba de la tecnolog√≠a de cach√© RAID Adaptec</a></li>
<li><a href="../es419055/index.html">En la teor√≠a de cuerdas, puedes sobrevivir con significativamente menos universos.</a></li>
<li><a href="../es419061/index.html">Novedades de GoLand 2018.2</a></li>
<li><a href="../es419065/index.html">Mundo virtual Intel. Practica</a></li>
<li><a href="../es419067/index.html">C√≥mo vender datos personales o por qu√© es dif√≠cil poner un precio a la informaci√≥n</a></li>
<li><a href="../es419069/index.html">El calentamiento global har√° que nuestro mundo sea m√°s verde, pero no se regocije</a></li>
<li><a href="../es419071/index.html">Siguiendo el truco tp-link</a></li>
<li><a href="../es419075/index.html">Sobre la formaci√≥n de secuencias en la hip√≥tesis de Collatz (3n + 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>