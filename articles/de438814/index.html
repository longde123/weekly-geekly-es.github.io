<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåè ‚è´ üßëüèø‚Äçü§ù‚Äçüßëüèæ Ein n√ºchterner Blick auf Helm 2: "Das ist es ..." ‚èØÔ∏è üìâ üíí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie jede andere L√∂sung hat Helm - der Paketmanager f√ºr Kubernetes - Vor-, Nachteile und Anwendungsbereiche. Wenn Sie ihn verwenden, sollten Sie Ihre E...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ein n√ºchterner Blick auf Helm 2: "Das ist es ..."</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/438814/">  Wie jede andere L√∂sung hat Helm - der Paketmanager f√ºr Kubernetes - Vor-, Nachteile und Anwendungsbereiche. Wenn Sie ihn verwenden, sollten Sie Ihre Erwartungen richtig einsch√§tzen ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ix/5j/fm/ix5jfmapr_v4yignapctr-x7_jc.jpeg"></div><br>  Wir verwenden Helm in unserem Arsenal an Strangwalzwerkzeugen.  Zum Zeitpunkt des Schreibens befinden sich <b>mehr als tausend Anwendungen</b> in unseren Clustern und etwa 4000 Installationen dieser Anwendungen in verschiedenen Variationen.  In regelm√§√üigen Abst√§nden treten Probleme auf, aber im Allgemeinen sind wir mit der L√∂sung zufrieden. Wir haben keine Ausfallzeiten und Datenverluste. <br><br>  Das Hauptmotiv f√ºr das Schreiben dieses Artikels besteht darin, dem Benutzer eine <b>objektive Bewertung der</b> Hauptprobleme von Helm 2 ohne endg√ºltige Schlussfolgerungen sowie den Wunsch nach Erfahrungsaustausch und unseren L√∂sungen zu geben. <a name="habracut"></a><br><br><h2>  [BUG] Nach dem Rollout entspricht der Status der Release-Ressourcen im Cluster nicht dem beschriebenen Helm-Diagramm </h2><br>  Bei der Arbeit ber√ºcksichtigt Helm nicht den Status der Freigaberessourcen im Cluster.  Bei der Neuinstallation wird das Ergebnis nur durch die aktuelle und die gespeicherte Konfiguration bestimmt.  Daher ist der Status der Ressource im Cluster und in der Helm-Registrierung unterschiedlich, und Helm ber√ºcksichtigt dies nicht. <br><br>  √úberlegen Sie, wie sich dieses Problem manifestiert: <br><br><ol><li>  Die Ressourcenvorlage im Diagramm entspricht dem Status X. </li><li>  Der Benutzer installiert das Diagramm (Pinne speichert den Status der Ressource X). </li><li>  Als N√§chstes √§ndert der Benutzer die Ressource im Cluster manuell (der Status √§ndert sich von X zu Y). </li><li>  Ohne √Ñnderungen vorzunehmen, f√ºhrt es ein <code>helm upgrade</code> ... Und die Ressource befindet sich immer noch im Status Y, obwohl der Benutzer X erwartet. </li></ol><br>  Und das ist noch nicht alles.  Irgendwann √§ndert der Benutzer die Ressourcenvorlage im Diagramm (neuer Status W) - dann haben wir nach dem <code>helm upgrade</code> zwei Szenarien: <br><br><ul><li>  Die Anwendung des XW-Patches nimmt ab. </li><li>  Nach dem Anwenden des Patches geht die Ressource in den Zustand Z √ºber, der nicht dem gew√ºnschten entspricht. </li></ul><br>  Um ein solches Problem zu vermeiden, wird vorgeschlagen, die Arbeit mit Releases wie folgt zu organisieren: <b>Niemand sollte Ressourcen manuell √§ndern</b> . Helm ist das einzige Tool f√ºr die Arbeit mit Release-Ressourcen.  Im Idealfall werden Diagramm√§nderungen im Git-Repository versioniert und <b>ausschlie√ülich</b> auf der CD angewendet. <br><br>  Wenn diese Option nicht geeignet ist, k√∂nnen Sie <b>die Synchronisierung der Status der</b> Freigaberessourcen <b>√ºberwachen</b> .  Die manuelle Synchronisierung kann folgenderma√üen aussehen: <br><br><ol><li>  Den Status der Release-Ressourcen erfahren wir √ºber <code>helm get</code> . </li><li>  Den Status der Ressourcen in Kubernetes <code>kubectl get</code> √ºber <code>kubectl get</code> . </li><li>  Wenn die Ressourcen unterschiedlich sind, synchronisieren wir Helm mit Kubernetes: <br><ol><li>  Erstellen Sie einen separaten Zweig. </li><li>  Aktualisieren von Diagrammmanifesten.  Vorlagen m√ºssen mit den Ressourcenzust√§nden in Kubernetes √ºbereinstimmen. </li><li>  Wir f√ºhren die Bereitstellung durch.  Wir synchronisieren den Status in der Helm-Registrierung und im Cluster. </li><li>  Danach kann der Zweig gel√∂scht und die regul√§re Arbeit fortgesetzt werden. </li></ol></li></ol><br>  Beim Anwenden von Patches mit dem <code>kubectl apply</code> wird die sogenannte <b>3-Wege-Zusammenf√ºhrung</b> ausgef√ºhrt, d. H.  Der tats√§chliche Status der aktualisierten Ressource wird ber√ºcksichtigt.  Sie k√∂nnen den Algorithmuscode <a href="">hier sehen</a> und hier dar√ºber lesen. <br><br>  Zum Zeitpunkt des Schreibens suchen Helm-Entwickler nach M√∂glichkeiten, 3-Wege-Zusammenf√ºhrung in Helm 3 zu implementieren. Mit Helm 2 sind die Dinge nicht so rosig: Die Implementierung von 3-Wege-Zusammenf√ºhrung ist nicht geplant, aber es gibt eine PR, um die Art und Weise zu korrigieren, wie Ressourcen erstellt werden - Sie k√∂nnen Details herausfinden oder sogar teilnehmen als Teil der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">relevanten Ausgabe</a> . <br><br><h2>  [BUG] Fehler: Keine RESOURCE mit dem Namen NAME gefunden </h2><br>  Das Problem tritt auf, wenn <b>neue Ressourcen</b> erfolgreich erstellt werden, wenn der Rollout wiederholt wird, und der Rollout selbst letztendlich fehlschl√§gt.  <b>Neue Ressourcen sind</b> diejenigen, die nicht in der letzten Installation des Diagramms enthalten waren. <br><br>  Wenn der Rollout fehlschl√§gt, wird die Version in der mit <b>FAILED</b> gekennzeichneten Registrierung <b>gespeichert</b> . W√§hrend der Installation st√ºtzt sich Helm auf den Status der neuesten <b>DEPLOYED-</b> Version, die in diesem Fall nichts √ºber neue Ressourcen wei√ü.  Infolgedessen versucht Helm, diese Ressourcen neu zu erstellen, und schl√§gt mit dem Fehler "Keine Ressource mit dem Namen NAME gefunden" fehl (der Fehler sagt das Gegenteil aus, aber dies ist das Problem).  Ein Teil des Problems besteht darin, dass Helm beim Erstellen des Patches den Status der Release-Ressourcen im Cluster nicht ber√ºcksichtigt, wie im vorherigen Abschnitt beschrieben. <br><br>  Derzeit besteht die einzige L√∂sung darin, neue Ressourcen manuell zu entfernen. <br><br>  Um einen solchen Status zu vermeiden, k√∂nnen neue Ressourcen, die beim aktuellen Upgrade / Rollback erstellt wurden, automatisch gel√∂scht werden, wenn der Befehl letztendlich fehlschl√§gt.  Nach einer langen Diskussion mit den Entwicklern in Helm wurde f√ºr die <code>--cleanup-on-fail</code> / Rollback-Befehle die Option <code>--cleanup-on-fail</code> hinzugef√ºgt, die die automatische Reinigung aktiviert, wenn der Rollout fehlschl√§gt.  Unsere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PR</a> wird diskutiert und sucht nach der besten L√∂sung. <br><br>  Ab Helm Version 2.13 wird in den <code>--atomic</code> zum <code>helm install/upgrade</code> des <code>--atomic</code> Option <code>--atomic</code> angezeigt, die das Reinigen und Zur√ºcksetzen w√§hrend einer fehlgeschlagenen Installation aktiviert (weitere Informationen finden Sie unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PR</a> ). <br><br><h2>  [BUG] Fehler: Uhr geschlossen vor Bis Timeout </h2><br>  Das Problem kann auftreten, wenn der Helm-Hook zu lange ausgef√ºhrt wird (z. B. w√§hrend Migrationen) - obwohl die angegebenen <code>spec.activeDeadlineSeconds</code> die <code>helm install/upgrade</code> des <code>helm install/upgrade</code> und <code>spec.activeDeadlineSeconds</code> entsprechenden Jobs nicht √ºberschritten werden. <br><br>  Dieser Fehler wird vom Kubernetes-API-Server generiert, w√§hrend auf den Abschluss des Hook-Jobs gewartet wird.  Helm behandelt diesen Fehler nicht und st√ºrzt sofort ab - anstatt die Warteanforderung erneut zu versuchen. <br><br>  Als L√∂sung k√∂nnen Sie das Zeitlimit im API-Server <code>--min-request-timeout=xxx</code> : <code>--min-request-timeout=xxx</code> in der Datei <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> . <br><br><h2>  [BUG] Fehler: UPGRADE FEHLGESCHLAGEN: "foo" hat keine bereitgestellten Releases </h2><br>  Wenn die erste Version √ºber die <code>helm install</code> fehlgeschlagen ist, gibt das nachfolgende <code>helm upgrade</code> einen √§hnlichen Fehler zur√ºck. <br><br>  Es scheint, dass die L√∂sung recht einfach ist: Sie m√ºssen nach einer fehlgeschlagenen Erstinstallation manuell das <code>helm delete --purge</code> durchf√ºhren - <code>helm delete --purge</code> , aber diese manuelle Aktion <code>helm delete --purge</code> die CI / CD-Automatisierung.  Um die Ausf√ºhrung manueller Befehle nicht zu unterbrechen, k√∂nnen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werf-</a> Funktionen zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rollout verwenden</a> .  Bei Verwendung von werf wird die problematische Version bei der Neuinstallation automatisch neu erstellt. <br><br>  <code>helm upgrade --install</code> ab Helm 2.13 in den <code>helm upgrade --install</code> <code>helm install</code> und <code>helm upgrade --install</code> einfach die Option <code>--atomic</code> Nach einer fehlgeschlagenen Installation wird die Version automatisch gel√∂scht (Details siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PR</a> ). <br><br><h2>  Autorollback </h2><br>  In Helm fehlt die Option <code>--autorollback</code> , die sich beim <code>--autorollback</code> an die aktuell erfolgreiche Revision erinnert (wird <code>--autorollback</code> , wenn die letzte Revision nicht erfolgreich ist) und nach einem erfolglosen Bereitstellungsversuch auf die gespeicherte Revision zur√ºckgesetzt wird. <br><br>  Da es wichtig ist, dass das Produkt ohne Unterbrechungen funktioniert, muss nach L√∂sungen gesucht werden. Die Einf√ºhrung sollte vorhersehbar sein.  Um die Wahrscheinlichkeit von Produktausf√§llen zu minimieren, wird h√§ufig ein <b>Ansatz mit mehreren Schaltkreisen</b> (z. B. Staging, QA und Produktion) verwendet, der darin besteht, die Schaltkreise nacheinander auf Schaltkreise auszurollen.  Mit diesem Ansatz werden die meisten Probleme behoben, bevor sie produktiv eingef√ºhrt werden. In Verbindung mit Autorolback k√∂nnen Sie gute Ergebnisse erzielen. <br><br>  Um das Autorollback zu organisieren, k√∂nnen Sie das Helmmonitor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">-</a> Plugin verwenden, mit dem Sie das Rollback an Metriken von Prometheus binden k√∂nnen.  Ein guter Artikel, der diesen Ansatz beschreibt, ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> verf√ºgbar. <br><br>  F√ºr einige unserer Projekte wird ein ziemlich einfacher Ansatz verwendet: <br><br><ol><li>  Vor der Bereitstellung erinnern wir uns an die aktuelle Version (wir glauben, dass die Version in einer normalen Situation, wenn sie vorhanden ist, notwendigerweise im Status DEPLOYED ist): <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _RELEASE_NAME=myrelease <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _LAST_DEPLOYED_RELEASE=$(helm list -adr | \ grep <span class="hljs-variable"><span class="hljs-variable">$_RELEASE_NAME</span></span> | grep DEPLOYED | head -n2 | awk <span class="hljs-string"><span class="hljs-string">'{print $2}'</span></span>)</code> </pre> </li><li>  Installation oder Upgrade ausf√ºhren: <br><br><pre> <code class="bash hljs">helm install/upgrade ... || <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _DEPLOY_FAILED=1</code> </pre> </li><li>  Wir √ºberpr√ºfen den Status der Bereitstellung und f√ºhren einen Rollback auf den gespeicherten Status durch: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_DEPLOY_FAILED</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ] &amp;&amp; [ <span class="hljs-string"><span class="hljs-string">"x</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_LAST_DEPLOYED_RELEASE</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"x"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> helm rollback <span class="hljs-variable"><span class="hljs-variable">$_RELEASE_NAME</span></span> <span class="hljs-variable"><span class="hljs-variable">$_LAST_DEPLOYED_RELEASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> </li><li>  Wir beenden die Pipeline mit einem Fehler, wenn die Bereitstellung nicht erfolgreich war: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_DEPLOY_FAILED</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> 1 ; <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> </li></ol><br>  Ab Helm Version 2.13 reicht es beim Aufrufen des <code>helm upgrade</code> aus, die Option <code>--atomic</code> anzugeben. Nach einem fehlgeschlagenen Installations-Rollback wird automatisch ein Rollback durchgef√ºhrt (Details siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PR</a> ). <br><br><h2>  Warten auf die Verf√ºgbarkeit von Release-Ressourcen und Feedback zum Zeitpunkt des Rollouts </h2><br>  Wie geplant sollte Helm die Ausf√ºhrung der entsprechenden Lebendigkeits- und Bereitschaftstests √ºberwachen, wenn die Option <code>--wait</code> : <br><br><pre> <code class="bash hljs">--<span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>, will <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> until all Pods, PVCs, Services, and minimum number of Pods of a Deployment are <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a ready state before marking the release as successful. It will <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> as long as --timeout</code> </pre> <br>  Diese Funktion funktioniert jetzt nicht richtig: Nicht alle Ressourcen und nicht alle API-Versionen werden unterst√ºtzt.  Und der erkl√§rte Wartevorgang selbst befriedigt unsere Bed√ºrfnisse nicht. <br><br>  Wie bei <code>kubectl wait</code> gibt es keine schnelle R√ºckmeldung und es gibt keine M√∂glichkeit, dieses Verhalten zu regulieren.  Wenn der Rollout fehlschl√§gt, werden wir ihn <b>erst nach einer Zeit√ºberschreitung</b> erfahren.  Im Falle einer problematischen Installation ist es erforderlich, den Rollout-Prozess so fr√ºh wie m√∂glich abzuschlie√üen, die CI / CD-Pipeline umzudrehen, die Version auf die Arbeitsversion zur√ºckzusetzen und mit dem Debuggen fortzufahren. <br><br>  Wenn die problematische Version zur√ºckgesetzt wird und Helm w√§hrend des Rollout-Prozesses keine Informationen zur√ºckgibt, worum geht es dann beim Debuggen ?!  Im Fall von <code>kubectl wait</code> Sie einen separaten Prozess zum Anzeigen von Protokollen organisieren, f√ºr den Release-Ressourcennamen erforderlich sind.  Wie man eine einfache und funktionierende L√∂sung organisiert, ist nicht sofort klar.  Neben Pod-Protokollen k√∂nnen n√ºtzliche Informationen im Rollout-Prozess, Ressourcenereignisse ... enthalten sein. <br><br>  Unser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werf</a> CI / CD-Dienstprogramm kann ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Helmdiagramm</a> bereitstellen, die Verf√ºgbarkeit von Ressourcen √ºberwachen und Informationen zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einf√ºhrung</a> anzeigen.  Alle Daten werden zu einem einzigen Stream zusammengefasst und an das Protokoll ausgegeben. <br><br>  Diese Logik wird in einer separaten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kubedog-</a> L√∂sung erstellt.  Mit dem Dienstprogramm k√∂nnen Sie eine Ressource abonnieren, Ereignisse und Protokolle empfangen sowie rechtzeitig √ºber fehlgeschlagene Rollouts informiert werden.  Das hei√üt,  Als L√∂sung k√∂nnen Sie nach dem Aufruf von <code>helm install/upgrade</code> ohne die Option --wait kubedog f√ºr jede Release-Ressource aufrufen. <br><br>  Wir wollten ein Tool entwickeln, das alle erforderlichen Informationen zum Debuggen in der Ausgabe der CI / CD-Pipeline bereitstellt.  Lesen Sie mehr √ºber das Dienstprogramm in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unserem letzten Artikel</a> . <br><br>  Vielleicht wird eines Tages in Helm 3 eine √§hnliche L√∂sung erscheinen, aber bisher ist unser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Problem</a> in einem suspendierten Zustand. <br><br><h2>  Sicherheit bei Verwendung von helm init standardm√§√üig </h2><br>  Wenn der Befehl <code>helm init</code> ausgef√ºhrt wird, wird die Serverkomponente standardm√§√üig mit √§hnlichen Berechtigungen wie der Superuser im Cluster installiert, was beim Zugriff durch Dritte zu unerw√ºnschten Konsequenzen f√ºhren kann. <br><br>  Um die Sicherheit des Clusters zu gew√§hrleisten, m√ºssen die Funktionen von Tiller eingeschr√§nkt und die Verbindung sichergestellt werden - die Sicherheit des Netzwerks, √ºber das die Kommunikation zwischen Helm-Komponenten stattfindet. <br><br>  Das erste kann durch die Verwendung des Standard-RBAC-Mechanismus von Kubernetes erreicht werden, der die Aktionen der Pinne einschr√§nkt, und das zweite durch Einstellen von SSL.  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen finden Sie</a> in der Helmdokumentation: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sichern Ihrer Helminstallation</a> . <br><br>  <i>Es wird angenommen, dass das Vorhandensein der Serverkomponente - Tiller - ein <b>schwerwiegender architektonischer Fehler ist</b> , buchst√§blich eine fremde Ressource mit Superuser-Rechten im Kubernetes-√ñkosystem.</i>  <i>Zum Teil sind wir uns einig: Die Implementierung ist unvollst√§ndig, aber <b>lassen Sie uns dies von der anderen Seite betrachten</b> .</i>  <i>Wenn Sie den Bereitstellungsprozess unterbrechen und den Helm-Client beenden, bleibt das System nicht in einem undefinierten Zustand, d. H.</i>  <i>Pinne bringt den Freigabestatus auf g√ºltig.</i>  <i>Es ist auch wichtig zu verstehen, dass diese Funktionen trotz der Tatsache, dass Tiller in Helm 3 aufgegeben wird, irgendwie vom CRD-Controller ausgef√ºhrt werden.</i> <br><br><h2>  Martian Go Vorlagen </h2><br>  Go-Vorlagen haben eine gro√üe Einstiegsschwelle, aber die Technologie hat keine Einschr√§nkungen hinsichtlich der Funktionen und Probleme mit DRY.  Die Grundprinzipien, Syntax, Funktionen und Operatoren werden in unserem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorherigen Artikel</a> in der Helm-Reihe erl√§utert. <br><br><h2>  Mangel an Geheimnissen aus der Box </h2><br>  Es ist praktisch, Anwendungscode, Infrastruktur und Rollout-Vorlagen zu speichern und zu verwalten, wenn sie sich an einem Ort befinden.  Und Geheimnisse sind keine Ausnahme. <br><br>  Helm unterst√ºtzt keine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sofort einsatzbereiten</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Geheimnisse. Es</a> ist jedoch das Plugin f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Helmgeheimnisse</a> verf√ºgbar, das im Wesentlichen eine Schicht zwischen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sops</a> , Mozillas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Geheimdienstmanager</a> und Helm darstellt. <br><br>  Bei der Arbeit mit Geheimnissen verwenden wir unsere eigene in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werf</a> implementierte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">L√∂sung</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation zu Geheimnissen</a> ).  Von den Funktionen: <br><br><ul><li>  Einfache Implementierung. </li><li>  Ein Geheimnis in einer Datei bewahren, nicht nur in YAML.  Praktisch beim Speichern von Zertifikaten und Schl√ºsseln. </li><li>  Regeneration von Geheimnissen mit einem neuen Schl√ºssel. </li><li>  Rollout ohne geheimen Schl√ºssel (bei Verwendung von werf).  Dies kann in F√§llen n√ºtzlich sein, in denen der Entwickler nicht √ºber diesen geheimen Schl√ºssel verf√ºgt, jedoch eine Bereitstellung f√ºr einen Test oder eine lokale Verbindung gestartet werden muss. </li></ul><br><h2>  Fazit </h2><br>  Helm 2 ist als stabiles Produkt positioniert, aber gleichzeitig gibt es viele Fehler, die in der Schwebe h√§ngen (einige von ihnen halten mehrere Jahre!).  Anstelle von L√∂sungen oder zumindest Patches werden alle Anstrengungen auf die Entwicklung von Helm 3 gerichtet. <br><br>  Trotz der Tatsache, dass MR und Problem monatelang h√§ngen bleiben k√∂nnen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier ist ein Beispiel daf√ºr,</a> wie wir eine <code>before-hook-creation policy</code> zum <code>before-hook-creation policy</code> von Hooks <code>before-hook-creation policy</code> f√ºr mehrere Monate hinzugef√ºgt haben), k√∂nnen Sie dennoch an der Entwicklung des Projekts teilnehmen.  Jeden Donnerstag findet eine halbst√ºndige Kundgebung von Helm-Entwicklern statt, bei der Sie die Priorit√§ten und aktuellen Richtungen des Teams kennenlernen, Fragen stellen und Ihre eigenen Best Practices erzwingen k√∂nnen.  √úber Mete und andere Kommunikationskan√§le wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ausf√ºhrlich geschrieben. <br><br>  Ob Sie Helm verwenden oder nicht, liegt nat√ºrlich bei Ihnen.  Heute halten wir selbst an einer solchen Position fest, dass Helm trotz der M√§ngel eine akzeptable L√∂sung f√ºr den Einsatz darstellt und es f√ºr die gesamte Community n√ºtzlich ist, an seiner Entwicklung teilzunehmen. <br><br><h2>  PS </h2><br>  Lesen Sie auch in unserem Blog: <br><br><ul><li>  ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen von Paketen f√ºr Kubernetes mit Helm: Diagrammstruktur und Vorlagen</a> ‚Äú; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eine praktische Einf√ºhrung in den Paketmanager f√ºr Kubernetes - Helm</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Paketmanager f√ºr Kubernetes - Helm: Vergangenheit, Gegenwart, Zukunft</a> "; </li><li>  ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úbe mit dapp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Bereitstellen von Docker-Images in Kubernetes mit Helm</a> . " </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de438814/">https://habr.com/ru/post/de438814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de438804/index.html">Warten auf alle beim n√§chsten CocoaHeads Meetup</a></li>
<li><a href="../de438806/index.html">Probleme der literarischen √úbersetzung</a></li>
<li><a href="../de438808/index.html">ModelMapper: Hin- und R√ºckfahrt</a></li>
<li><a href="../de438810/index.html">HTTP / 3: von der Wurzel bis zur Spitze</a></li>
<li><a href="../de438812/index.html">HH-Front-End-Codequalit√§t</a></li>
<li><a href="../de438818/index.html">UDB. Was ist das Teil 5. Datenpfad. N√ºtzliche Kleinigkeiten</a></li>
<li><a href="../de438820/index.html">Wissensmanagement: Welche Dokumente werden ben√∂tigt und was muss in ihnen repariert werden?</a></li>
<li><a href="../de438824/index.html">Remote Management Kurzkurs</a></li>
<li><a href="../de438826/index.html">Versch√§rfen Sie die Englischkenntnisse f√ºr ein Interview - Methodik und Arbeitskosten</a></li>
<li><a href="../de438828/index.html">Lazarus - Schreiben einer Komponente f√ºr Sprite-Animationen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>