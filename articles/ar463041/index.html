<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧒🏼 💅🏾 👩🏽‍🌾 معرف أو غير محدد؟ الفروق الدقيقة في إنشاء المصفوفات في JavaScript 😯 😞 🏴‍☠️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="قبل شهرين ، تعثرت على سؤال مثير للاهتمام حول التدفق stackoverflow ، حيث ، باختصار ، أراد شخص إنشاء مصفوفة 5 × 5 فارغة ، وباستخدام إحدى الطرق التي نجح ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>معرف أو غير محدد؟ الفروق الدقيقة في إنشاء المصفوفات في JavaScript</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463041/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cf/uz/xt/cfuzxt6gszx356ckhbffnh21g9g.jpeg" alt="صورة"></div><br>  قبل شهرين ، تعثرت على سؤال مثير للاهتمام حول <i>التدفق stackoverflow</i> ، حيث ، باختصار ، أراد شخص إنشاء مصفوفة <i>5 × 5</i> فارغة ، وباستخدام إحدى الطرق التي نجح فيها ، ولكن باستخدام الآخر لم ينجح.  في المناقشة التي تلت ذلك ، تم ذكر أفكار مثيرة للاهتمام حول هذا الموضوع. <br><br>  صحيح أن الشخص الذي طرح السؤال ، وكذلك الأشخاص الذين أجابوا عليه ، لم ينتبه إلى حقيقة أنه في الواقع لا يمكن إنشاء المصفوفة ، وكانت نتيجة الحساب غير صحيحة.  كل هذا اهتم بي ، وقررت أن أعمق قليلاً ، ثم توصل إلى استنتاجات مثيرة للاهتمام ، والتي سأطلعكم عليها الآن. <br><a name="habracut"></a><br>  <i>ملاحظة: أجبت أيضًا في إطار تلك المناقشة ، تحت اسم <i>AndreyGS</i> - هناك أجبت باختصار إلى حد ما ، وهنا سأحاول تغطية المشكلة بالكامل.</i> <br><br>  بشكل عام ، التحدي هو إنشاء مجموعة.  كيف سنفعل هذا؟  من الغريب أن هناك خيارات مختلفة ، اعتمادًا على ما نريد الحصول عليه. <br><br>  نحن نعلم أن الوظائف في JavaScript لها طريقتان داخليتان ، <i>Call</i> and <i>Construct</i> .  إذا استخدمنا الكلمة الأساسية <i>الجديدة</i> ، فسيتم استخدام طريقة Construct ، التي تنشئ مثيلًا جديدًا للكائن ، وتعين <i>هذه</i> الإشارة <i>إليها</i> ، ثم تقوم بتنفيذ نص الوظيفة.  ليس لكل الوظائف هذه الطريقة ، لكن بالنسبة لنا هذه ليست مهمة في الوقت الحالي. <br><br>  عند إنشاء المصفوفات ، هناك خصوصية واحدة: لا يهم إذا استخدمنا <i>المصفوفة (...)</i> أو <i>المصفوفة الجديدة (...)</i> - مواصفات <i>ECMAScript</i> لا تميز بينهما ، علاوة على ذلك ، تعتبرها متكافئة. <br><br><pre style=";text-align:right;direction:rtl"><code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> The Array Constructor The Array constructor is the <span class="hljs-variable"><span class="hljs-variable">%Array%</span></span> intrinsic object and the initial value of the Array property of the global object. When called as a constructor it creates and initializes a new exotic Array object. When Array is called as a function rather than as a constructor, it also creates and initializes a new Array object. Thus the function <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> Array(…) is equivalent to the object creation expression new Array(…) with the same arguments.</code> </pre> <br>  لذلك ، لن أفلسف بشكل سيء ، وفي الأمثلة <i>سأستخدم</i> بنية <i>Array (...) الجديدة</i> فقط ، حتى لا أربك أي شخص. <br><br>  لنبدأ. <br><br>  إنشاء مجموعة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>);</code> </pre> <br>  ماذا حصلنا عليه؟ <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ &lt;5 empty slots&gt; ] console.log(arr[0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr,"0")); // undefined</span></span></code> </pre> <br>  حسنًا ... حسنًا ، من حيث المبدأ ، يجب أن يكون الأمر كذلك - لقد حددنا الطول وحصلنا على خمس خلايا فارغة ، مع عدم تحديد القيمة ، والتي يمكن العمل عليها بشكل أكبر ، أليس كذلك؟  صحيح ، هناك بضع نقاط تربكني.  دعونا التحقق من ذلك. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>).map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>); }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ &lt;5 empty slots&gt; ] console.log(arr[0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr,"0")); // undefined console.log(arr[0][0]); // TypeError: arr[0] is undefined</span></span></code> </pre> <br>  كيف أنه ، بعد كل شيء ، كان علينا الحصول على مصفوفة ، وفي كل خلية ، وفقًا لذلك ، يجب أن يكون هناك مجموعة من 5 عناصر ... <br><br>  دعنا ننتقل مرة أخرى إلى وثائق <i>ECMAScript</i> ونرى ما هو مكتوب فيها فيما يتعلق بطريقة إنشاء المصفوفات بحجة واحدة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> Array (len) This description applies <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> and only <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the Array constructor is called with exactly one argument. <span class="hljs-number"><span class="hljs-number">1</span></span>. Let numberOfArgs be the number of arguments passed to this function <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>. <span class="hljs-number"><span class="hljs-number">2</span></span>. Assert: numberOfArgs = <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">3</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> NewTarget is undefined, let newTarget be the active function object, <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> let newTarget be NewTarget. <span class="hljs-number"><span class="hljs-number">4</span></span>. Let proto be GetPrototypeFromConstructor(newTarget, "<span class="hljs-variable"><span class="hljs-variable">%ArrayPrototype%</span></span>"). <span class="hljs-number"><span class="hljs-number">5</span></span>. ReturnIfAbrupt(proto). <span class="hljs-number"><span class="hljs-number">6</span></span>. Let array be ArrayCreate(<span class="hljs-number"><span class="hljs-number">0</span></span>, proto). <span class="hljs-number"><span class="hljs-number">7</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Type</span></span>(len) is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> Number, then <span class="hljs-number"><span class="hljs-number">1</span></span>. Let defineStatus be CreateDataProperty(array, "<span class="hljs-number"><span class="hljs-number">0</span></span>", len). <span class="hljs-number"><span class="hljs-number">2</span></span>. Assert: defineStatus is true. <span class="hljs-number"><span class="hljs-number">3</span></span>. Let intLen be <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">8</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>. Let intLen be ToUint32(len). <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> intLen ≠ len, throw a RangeError exception. <span class="hljs-number"><span class="hljs-number">9</span></span>. Let setStatus be <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span>(array, "length", intLen, true). <span class="hljs-number"><span class="hljs-number">10</span></span>. Assert: setStatus is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> an abrupt completion. <span class="hljs-number"><span class="hljs-number">11</span></span>. Return array.</code> </pre> <br>  وما نراه ، اتضح أنه تم إنشاء الكائن ، ويتم إنشاء خاصية <i>الطول</i> في إجراء ArrayCreate (النقطة 6) ، ويتم تعيين القيمة في خاصية <i>الطول</i> (النقطة 9) ، وماذا عن الخلايا؟  بصرف النظر عن الحالة الخاصة عندما تكون الوسيطة التي تم تمريرها ليست رقمًا ، ويتم إنشاء صفيف بخلية مفردة "0" بالقيمة المقابلة (النقطة 7) ، لا توجد كلمة عنها ... وهذا يعني ، = = 5 طول ، لكن لا توجد خمس خلايا.  نعم ، إن المترجم يربكنا عندما نحاول الوصول إلى خلية واحدة ، فهو يفسر أن قيمتها غير <i>محددة</i> ، في حين أنها ليست كذلك. <br><br>  هنا ، للمقارنة ، طريقة إنشاء المصفوفات بعدة وسيطات يتم إرسالها إلى المُنشئ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> Array (...items ) This description applies <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> and only <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the Array constructor is called with <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> least two arguments. When the Array function is called the following steps are taken: <span class="hljs-number"><span class="hljs-number">1</span></span>. Let numberOfArgs be the number of arguments passed to this function <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>. <span class="hljs-number"><span class="hljs-number">2</span></span>. Assert: numberOfArgs ≥ <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-number"><span class="hljs-number">3</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> NewTarget is undefined, let newTarget be the active function object, <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> let newTarget be NewTarget. <span class="hljs-number"><span class="hljs-number">4</span></span>. Let proto be GetPrototypeFromConstructor(newTarget, "<span class="hljs-variable"><span class="hljs-variable">%ArrayPrototype%</span></span>"). <span class="hljs-number"><span class="hljs-number">5</span></span>. ReturnIfAbrupt(proto). <span class="hljs-number"><span class="hljs-number">6</span></span>. Let array be ArrayCreate(numberOfArgs, proto). <span class="hljs-number"><span class="hljs-number">7</span></span>. ReturnIfAbrupt(array). <span class="hljs-number"><span class="hljs-number">8</span></span>. Let k be <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-number"><span class="hljs-number">9</span></span>. Let items be a zero-origined List containing the argument items <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> order. <span class="hljs-number"><span class="hljs-number">10</span></span>. Repeat, while k &lt; numberOfArgs <span class="hljs-number"><span class="hljs-number">1</span></span>. Let Pk be ToString(k). <span class="hljs-number"><span class="hljs-number">2</span></span>. Let itemK be items[k]. <span class="hljs-number"><span class="hljs-number">3</span></span>. Let defineStatus be CreateDataProperty(array, Pk, itemK). <span class="hljs-number"><span class="hljs-number">4</span></span>. Assert: defineStatus is true. <span class="hljs-number"><span class="hljs-number">5</span></span>. Increase k by <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">11</span></span>. Assert: the value of array's length property is numberOfArgs. <span class="hljs-number"><span class="hljs-number">12</span></span>. Return array.</code> </pre> <br>  هنا ، من فضلك - 10 نقطة ، وإنشاء تلك الخلايا نفسها. <br><br>  والآن ، ماذا يفعل <i>Array.prototype.map ()</i> بعد ذلك؟ <br><br><pre style=";text-align:right;direction:rtl"> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">15</span></span> Array.prototype.map ( callbackfn [ , thisArg ] ) <span class="hljs-number"><span class="hljs-number">1</span></span>. Let O be ToObject(this value). <span class="hljs-number"><span class="hljs-number">2</span></span>. ReturnIfAbrupt(O). <span class="hljs-number"><span class="hljs-number">3</span></span>. Let len be ToLength(Get(O, "length")). <span class="hljs-number"><span class="hljs-number">4</span></span>. ReturnIfAbrupt(len). <span class="hljs-number"><span class="hljs-number">5</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> IsCallable(callbackfn) is false, throw a TypeError exception. <span class="hljs-number"><span class="hljs-number">6</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> thisArg was supplied, let T be thisArg; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> let T be undefined. <span class="hljs-number"><span class="hljs-number">7</span></span>. Let A be ArraySpeciesCreate(O, len). <span class="hljs-number"><span class="hljs-number">8</span></span>. ReturnIfAbrupt(A). <span class="hljs-number"><span class="hljs-number">9</span></span>. Let k be <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-number"><span class="hljs-number">10</span></span>. Repeat, while k &lt; len <span class="hljs-number"><span class="hljs-number">1</span></span>. Let Pk be ToString(k). <span class="hljs-number"><span class="hljs-number">2</span></span>. Let kPresent be HasProperty(O, Pk). <span class="hljs-number"><span class="hljs-number">3</span></span>. ReturnIfAbrupt(kPresent). <span class="hljs-number"><span class="hljs-number">4</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> kPresent is true, then <span class="hljs-number"><span class="hljs-number">1</span></span>. Let kValue be Get(O, Pk). <span class="hljs-number"><span class="hljs-number">2</span></span>. ReturnIfAbrupt(kValue). <span class="hljs-number"><span class="hljs-number">3</span></span>. Let mappedValue be <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>(callbackfn, T, «kValue, k, O»). <span class="hljs-number"><span class="hljs-number">4</span></span>. ReturnIfAbrupt(mappedValue). <span class="hljs-number"><span class="hljs-number">5</span></span>. Let status be CreateDataPropertyOrThrow (A, Pk, mappedValue). <span class="hljs-number"><span class="hljs-number">6</span></span>. ReturnIfAbrupt(status). <span class="hljs-number"><span class="hljs-number">5</span></span>. Increase k by <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">11</span></span>. Return A.</code> </pre> <br>  الفقرة 7 - يتم إنشاء نسخة من المصفوفة الأصلية ، في الفقرة 10 يتم تنفيذ التكرار على عناصرها ، وعلى وجه الخصوص ، يتحقق البند 10.2 لمعرفة ما إذا كانت هناك خلية محددة في المصفوفة المصدر ، بحيث ، إذا نجحت ، خريطة (10.4) و إنشاء الخلية المناسبة في النسخة - 10.4.5.  بما أن الرقم 10.2 يعطي <i>خطأ</i> لكل من التمريرات <i>الخمسة</i> ، فلن يتم إنشاء خلية واحدة في النسخة التي تم إرجاعها للصفيف أيضًا. <br><br>  لذلك ، كيف <i>نجح</i> مُنشئ الصفيف وأسلوب <i>Array.prototype.map () في العمل ،</i> لكننا اكتشفنا ذلك ، لكن المهمة ظلت كما كانت من قبل ، لأنه لم يتم بناء المصفوفة.  <i>Function.prototype.apply ()</i> سيأتي لإنقاذ! <br>  دعونا التحقق من ذلك في العمل على الفور: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ undefined, undefined, undefined, undefined, undefined ] console.log(arr[0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr,"0")); // Object { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre> <br>  يا هلا ، لوحظ بوضوح أن جميع الخلايا الخمس هنا ، وكذلك الخلية الأولى ، التي تحتوي على رقم <i>"0"</i> تحتوي على واصف. <br><br>  في هذه الحالة ، عمل البرنامج على النحو التالي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>استدعينا</i> طريقة <i>Function.prototype.apply ()</i> وقمنا بتمرير السياق <i>الفارغ</i> إليها ، وكصفيف <i>صفيف جديد (5)</i> . </li><li style=";text-align:right;direction:rtl">  <i>إنشاء صفيف جديد (5)</i> مجموعة بدون خلايا ، ولكن بطول <i>5</i> . </li><li style=";text-align:right;direction:rtl">  استخدم <i>Function.prototype.apply ()</i> الطريقة الداخلية لتقسيم الصفيف إلى وسيطات منفصلة ، ونتيجة لذلك ، قام بتمرير خمس وسيطات ذات قيم <i>غير محددة</i> إلى مُنشئ <i>Array</i> . </li><li style=";text-align:right;direction:rtl">  تلقى <i>صفيف</i> <i>5</i> وسيطات مع قيم <i>غير محددة</i> ، إضافتها إلى الخلايا المقابلة. </li></ol><br>  يبدو أن كل شيء واضح ، باستثناء ما هي هذه الطريقة الداخلية لـ <i>Function.prototype.apply ()</i> ، والتي تجعل <i>5</i> وسيطات من لا شيء - أقترح مرة أخرى أن ننظر إلى وثائق <i>ECMAScript</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">19</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Function.prototype.apply <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> IsCallable(func) is false, throw a TypeError exception. <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> argArray is null or undefined, then Return <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>(func, thisArg). <span class="hljs-number"><span class="hljs-number">3</span></span>. Let argList be CreateListFromArrayLike(argArray). <span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">17</span></span> CreateListFromArrayLike (obj [, elementTypes] ) <span class="hljs-number"><span class="hljs-number">1</span></span>. ReturnIfAbrupt(obj). <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> elementTypes was <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> passed, let elementTypes be (Undefined, Null, Boolean, String, Symbol, Number, Object). <span class="hljs-number"><span class="hljs-number">3</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Type</span></span>(obj) is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> Object, throw a TypeError exception. <span class="hljs-number"><span class="hljs-number">4</span></span>. Let len be ToLength(Get(obj, "length")). <span class="hljs-number"><span class="hljs-number">5</span></span>. ReturnIfAbrupt(len). <span class="hljs-number"><span class="hljs-number">6</span></span>. Let list be an empty List. <span class="hljs-number"><span class="hljs-number">7</span></span>. Let index be <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-number"><span class="hljs-number">8</span></span>. Repeat while index &lt; len a. Let indexName be ToString(index). b. Let next be Get(obj, indexName). c. ReturnIfAbrupt(next). d. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Type</span></span>(next) is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> an element of elementTypes, throw a TypeError exception. e. <span class="hljs-built_in"><span class="hljs-built_in">Append</span></span> next as the last element of list. f. <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span> index to index + <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">9</span></span>. Return list.</code> </pre> <br>  نحن ننظر إلى النقاط الأكثر إثارة للاهتمام: <br><br>  19.2.3.1 - الفقرة 3: إنشاء قائمة بالوسيطات من كائن مشابه للصفيف (كما نذكر ، يجب أن يكون لهذه الكائنات خاصية طول). <br><br>  7.3.17 - طريقة إنشاء قائمة نفسها.  يتحقق ما إذا كان الكائن هو أو لا ، وإذا كان الأمر كذلك ، طلب لحقل <i>الطول</i> (الفقرة 4).  ثم يتم إنشاء فهرس يساوي <i>"0"</i> (الفقرة 7).  يتم إنشاء حلقة مع زيادة الفهرس إلى القيمة مأخوذة من حقل <i>الطول</i> (الفقرة 8).  في هذه الدورة ، نشير إلى قيم خلايا المصفوفة المرسلة مع الفهارس المقابلة (الفقرتان 8 أ و 8 ب).  وكما نتذكر ، عند الوصول إلى قيمة خلية واحدة في صفيف لا توجد فيها خلايا بالفعل ، فإنها لا تزال تعطي قيمة - <i>غير محددة</i> .  تتم إضافة القيمة الناتجة إلى نهاية قائمة الوسائط (الفقرة 8e). <br><br>  حسنًا ، بعد أن أصبح كل شيء في مكانه الصحيح ، يمكنك بناء المصفوفة الفارغة بأمان. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)).map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)); }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ (5) […], (5) […], (5) […], (5) […], (5) […] ] console.log(arr[0]); // Array(5) [ undefined, undefined, undefined, undefined, undefined ] console.log(Object.getOwnPropertyDescriptor(arr,"0")); // Object { value: (5) […], writable: true, enumerable: true, configurable: true } console.log(arr[0][0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr[0],"0")); // Object { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre> <br>  الآن ، كما ترون ، كل شيء يتلاقى ويبدو بسيطًا للغاية: نحن ، بالطريقة التي نعرفها بالفعل ، نقوم بإنشاء مجموعة <i>Array.apply</i> فارغة <i>(صفرية ، جديدة صفيف (5))</i> ثم <i>ننقلها</i> إلى طريقة الخريطة ، والتي تنشئ نفس الصفيف في كل من الخلايا. <br><br>  بالإضافة إلى ذلك ، يمكنك جعله أسهل.  ظهر عامل <i>الانتشار</i> - <i>...</i> في <i>ECMAScript6</i> ، وهو نموذجي ، كما أنه يعمل بشكل خاص مع المصفوفات.  لذلك ، يمكننا ببساطة القيادة في: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...new <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...new <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)));</code> </pre> <br>  أو سنبسطها تمامًا ، على الرغم من أنني وعدت سابقًا بعدم لمس ... <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...Array(<span class="hljs-number"><span class="hljs-number">5</span></span>)).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...Array(<span class="hljs-number"><span class="hljs-number">5</span></span>)));</code> </pre>  <i>ملاحظة: هنا استخدمنا أيضًا وظائف السهم ، حيث أننا ما زلنا نتعامل مع عامل فروق الذي ظهر في نفس المواصفات مثلهم.</i> <br><br>  لن ندخل في مبدأ مشغل <i>السبريد</i> ، ولكن من أجل التطوير العام ، أعتقد أن هذا المثال كان مفيدًا أيضًا. <br><br>  بالإضافة إلى ذلك ، يمكننا بالطبع بناء وظائفنا ، والتي ، باستخدام الفرز <i>Function.prototype.apply ()</i> ، ستنشئ مصفوفات طبيعية لنا بخلايا فارغة ، ومع ذلك ، نفهم المبادئ الداخلية لجافا سكريبت ، وبالتالي الاستخدام الصحيح والكافي المدمج في وظائف ، هو أساس لإتقان والتي هي أولوية.  حسنًا ، وبطبيعة الحال ، الأمر بسيط جدًا بشكل أسرع وأكثر ملاءمة. <br><br>  وأخيرًا ، بالعودة إلى نفس السؤال حول <i>تدفق stackoverflow</i> - أذكر أن الشخص اعتبر خطأً أن الطريقة التي تلقاها أدت إلى الإجابة الصحيحة ، وأنه حصل على مصفوفة <i>5 × 5</i> ، لكن خطأً بسيطًا تسلل إلى هناك. <br><br>  قاد في: <br><br> <code>Array.apply(null, new Array(5)).map(function(){ <br> return new Array(5); <br> });</code> <br> <br>  ما رأيك النتيجة الفعلية ستكون هنا؟ <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">الجواب</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  console.log (arr) ؛  // صفيف (5) [(5) [...] ، (5) [...] ، (5) [...] ، (5) [...] ، (5) [...]] <br>  console.log (arr [0]) ؛  // Array (5) [&lt;5 فتحات فارغة&gt;] <br>  console.log (Object.getOwnPropertyDescriptor (arr، "0"))؛  // كائن {value: (5) [...] ، قابل للكتابة: صواب ، قابل للتعداد: صواب ، قابل للتكوين: صواب} <br>  console.log (arr [0] [0]) ؛  // غير محدد <br>  console.log (Object.getOwnPropertyDescriptor (arr [0]، "0"))؛  // غير محدد <br></div></div><br>  أليس كذلك ، هذا ليس هو ما يريده ... <br><br>  المراجع: <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ECMAScript 2015 لغة المواصفات</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ما هو Array.apply القيام به في الواقع</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar463041/">https://habr.com/ru/post/ar463041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar463027/index.html">مراجعة مستقلة لـ PVS-Studio (Linux، C ++)</a></li>
<li><a href="../ar463031/index.html">عش وتعلم. الجزء 3. التعليم المستمر أو سن الطالب الأبدي</a></li>
<li><a href="../ar463035/index.html">أخبار من خريطة الشارع المفتوح رقم 471 (07.23.2019-29.07.2019)</a></li>
<li><a href="../ar463037/index.html">تبحث عن الإلهام ، أو كيفية الخروج من F</a></li>
<li><a href="../ar463039/index.html">افعل ذلك بنفسك مكنسة كهربائية مانيكير</a></li>
<li><a href="../ar463045/index.html">اكتشاف العواطف تلقائيًا في المحادثات النصية باستخدام الشبكات العصبية</a></li>
<li><a href="../ar463055/index.html">حول مدراء ، devops ، والارتباك لا نهاية لها وتحول DevOps داخل الشركة</a></li>
<li><a href="../ar463057/index.html">يي إطار 2 حقوق مخصصة</a></li>
<li><a href="../ar463059/index.html">ثلاثة يعيشون في تكنولوجيا المعلومات وليس فقط</a></li>
<li><a href="../ar463061/index.html">قواعد لإعداد تخطيطات في Figma</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>