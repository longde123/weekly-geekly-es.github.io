<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèæ üå´Ô∏è üëÉüèª Java n'est pas seulement une entreprise sanglante, mais aussi des applications sensibles √† la latence rapide üë©üèæ‚Äçüé§ üïµüèΩ üè†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je fais du trading algorithmique √† Raiffeisenbank. Il s'agit d'un domaine assez sp√©cifique du secteur bancaire. Nous cr√©ons une plateforme de trading ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Java n'est pas seulement une entreprise sanglante, mais aussi des applications sensibles √† la latence rapide</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/453688/">  Je fais du trading algorithmique √† Raiffeisenbank.  Il s'agit d'un domaine assez sp√©cifique du secteur bancaire.  Nous cr√©ons une plateforme de trading qui fonctionne avec des retards faibles et pr√©visibles.  Le succ√®s de l'application d√©pend, entre autres, de la vitesse de l'application, nous devons donc traiter toute la pile impliqu√©e dans le trading: canaux de r√©seau priv√©, mat√©riel sp√©cial, param√®tres du syst√®me d'exploitation et une machine virtuelle Java sp√©ciale, et, bien s√ªr, l'application elle-m√™me.  Nous ne pouvons pas arr√™ter d'optimiser exclusivement l'application elle-m√™me - les param√®tres du syst√®me d'exploitation ou du r√©seau ne sont pas moins importants.  Cela n√©cessite une expertise technique et une √©rudition pour comprendre comment les donn√©es circulent √† travers la pile enti√®re et o√π il peut y avoir un retard. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/ff/7v/b8ff7vpvqcp4qpvadbihv_uztq0.jpeg"></div><a name="habracut"></a><br>  Toutes les organisations / banques ne peuvent pas se permettre le d√©veloppement de cette classe de logiciels.  Mais j'ai eu la chance qu'un tel projet ait √©t√© lanc√© dans les murs de Raiffeisenbank, et j'avais une sp√©cialisation appropri√©e - je me suis sp√©cialis√© dans les performances de code au Intel Moscow Compiler Laboratory.  Nous avons fait des compilateurs pour C, C ++ et Fortran.  Chez Raiffeisenbank, je suis pass√© √† Java.  Si auparavant j'ai cr√©√© une sorte d'outil que beaucoup de gens utilisaient alors, maintenant je suis pass√© de l'autre c√¥t√© des barricades et je suis engag√© dans une analyse appliqu√©e des performances non seulement du code, mais de la pile d'application enti√®re.  R√©guli√®rement, le moyen de rechercher un probl√®me de performances se situe bien au-del√† du code, par exemple dans les param√®tres du noyau ou du r√©seau. <br><br><h3>  <b>Java n'est pas pour la surcharge?</b> </h3><br>  Il est largement admis que Java n'est pas tr√®s adapt√© au d√©veloppement de syst√®mes tr√®s charg√©s. <br>  Cela ne peut √™tre que partiellement accept√©.  Java est beau √† bien des √©gards.  Si nous le comparons avec un langage comme C ++, alors son surco√ªt potentiel peut √™tre plus √©lev√©, mais parfois des solutions fonctionnellement similaires en C ++ peuvent fonctionner plus lentement.  Il existe des optimisations qui fonctionnent automatiquement en Java, mais ne fonctionnent pas en C ++, et vice versa.  En regardant la qualit√© du code qui vient apr√®s le compilateur Java JIT, je veux croire que les performances seront inf√©rieures √† ce que je pourrais atteindre en pointe, pas plus de plusieurs fois.  Mais en m√™me temps, je re√ßois un d√©veloppement tr√®s rapide, d'excellents outils et une large s√©lection de composants pr√™ts √† l'emploi. <br><br>  Avouons-le: dans le monde C ++, les environnements de d√©veloppement (IDE) sont consid√©rablement derri√®re IntelliJ et Eclipse.  Si un d√©veloppeur utilise l'un de ces environnements, la vitesse de d√©bogage, la recherche de bogues et l'√©criture d'une logique complexe sont d'un ordre de grandeur plus √©lev√©.  En cons√©quence, il s'av√®re qu'il est plus facile de classer Java aux bons endroits afin qu'il fonctionne assez rapidement que de tout faire √† partir de z√©ro et pendant tr√®s longtemps en C ++.  La chose la plus dr√¥le est que lors de l'√©criture de code concurrentiel, les approches de synchronisation √† la fois en Java et en C ++ sont tr√®s similaires: ce sont des primitives au niveau du syst√®me d'exploitation (par exemple, <i>synchronized / std :: mutex</i> ) ou des primitives de fer ( <i>Atomic * / std :: atomic &lt;*&gt;</i> ) .  Et il est tr√®s important de voir cette similitude. <br><br>  En g√©n√©ral, nous d√©veloppons une application sans surcharge)) <br><br><h3>  <b>Quelle est la diff√©rence entre une application √† charge √©lev√©e et √† faible latence?</b> <br></h3><br>  Le terme haute charge ne refl√®te pas pleinement les sp√©cificit√©s de notre travail - nous sommes engag√©s dans <i>des syst√®mes sensibles</i> √† la <i>latence</i> .  Quelle est la diff√©rence?  Pour les syst√®mes fortement charg√©s, il est important de travailler en moyenne assez rapidement, en utilisant pleinement les ressources mat√©rielles.  En pratique, cela signifie que chaque centi√®me / milli√®me /../th millioni√®me requ√™te au syst√®me peut potentiellement fonctionner tr√®s lentement, car nous nous concentrons sur les valeurs moyennes et ne tenons pas toujours compte du fait que nos utilisateurs souffrent consid√©rablement des freins. <br><br>  Nous sommes engag√©s dans des syst√®mes pour lesquels le niveau de retard est critique.  Notre t√¢che est de nous assurer que le syst√®me a toujours une r√©ponse pr√©visible.  Les <i>syst√®mes</i> potentiellement <i>sensibles √† la latence</i> peuvent ne pas √™tre lourdement charg√©s si les √©v√©nements se produisent assez rarement, mais un temps de r√©ponse garanti est requis.  Et cela ne facilite pas leur d√©veloppement.  Bien au contraire!  Les dangers guettent partout.  L'√©crasante majorit√© des composants du mat√©riel et des logiciels modernes sont orient√©s vers le bon travail "en moyenne", c'est-√†-dire  pour le <i>d√©bit</i> . <br><br>  Prenez au moins des structures de donn√©es.  Nous utilisons des tables de hachage, et si un nouveau hachage de la structure de donn√©es enti√®re se produit sur un chemin critique, cela peut conduire √† des freins tangibles pour un utilisateur sp√©cifique sur une seule demande.  Ou compilateur JIT - optimise le mod√®le de code le plus fr√©quemment ex√©cut√©, en pessimisant le mod√®le de code rarement ex√©cut√©.  Mais la vitesse de ce cas rare particulier peut √™tre tr√®s importante pour nous! <br><br>  Peut-√™tre que ce code traite un type rare de commandes?  Ou une situation de march√© inhabituelle qui n√©cessite une r√©ponse rapide?  Nous essayons de nous assurer que la r√©action de notre syst√®me √† ces √©v√©nements potentiellement rares prend un certain temps pr√©visible et, de pr√©f√©rence, tr√®s court. <br><br><h3>  <b>Comment obtenir un temps de r√©action pr√©visible?</b> </h3><br>  On ne peut pas r√©pondre √† cette question en deux phrases.  Dans une premi√®re approximation, il est important de comprendre s'il existe un type de synchronisation - <i>synchronis√©, reentrantlock</i> ou quelque chose de <i>java.util.concurrent</i> .  Souvent, vous devez utiliser la synchronisation sur le spin -ah occup√©.  L'utilisation d'une primitive de synchronisation est toujours un compromis.  Et il est important de comprendre comment ces primitives de synchronisation fonctionnent et quels compromis elles entra√Ænent.  Il est √©galement important d'√©valuer la quantit√© de d√©chets g√©n√©r√©s par un morceau de code particulier.  La meilleure fa√ßon de lutter contre le ramasse-miettes est de ne pas le d√©clencher.  Moins nous g√©n√©rerons de d√©chets, moins nous ex√©cuterons un ramasse-miettes et plus le syst√®me fonctionnera sans son intervention. <br><br>  Nous utilisons √©galement un large √©ventail d'outils diff√©rents qui nous permettent d'analyser non seulement des indicateurs moyens.  Nous devons analyser tr√®s attentivement la vitesse √† laquelle le syst√®me fonctionne chaque centi√®me, chaque milli√®me fois.  √âvidemment, ces indicateurs seront pires que la m√©diane ou la moyenne.  Mais il est tr√®s important pour nous de savoir combien.  Et des outils tels que <i>Grafana</i> , <i>Prom√©th√©e</i> , les <i>histogrammes HDR</i> et <i>JMH</i> aident √† le montrer. <br><br><h3>  <b>Puis-je supprimer Unsafe?</b> <b><br></b> </h3><br>  Souvent, vous devez utiliser ce que les apologistes appellent une API non document√©e.  Je parle du fameux Unsafe.  Je crois que dangereux est devenu de facto une partie de l'API publique des machines Java.  Cela n'a aucun sens de le nier.  Unsafe utilise de nombreux projets que nous utilisons tous activement.  Et si nous le refusons, qu'adviendra-t-il de ces projets?  Soit ils vivront sur l'ancienne version de Java, soit ils devront encore d√©penser beaucoup d'√©nergie pour r√©√©crire tout cela.  La communaut√© est-elle pr√™te pour cela?  Est-il pr√™t √† perdre potentiellement des dizaines de pour cent de productivit√©?  Et surtout, en √©change de quoi? <br><br>  Indirectement, mon opinion confirme une <i>suppression tr√®s soign√©e des</i> m√©thodes de Unsafe - en Java11, les m√©thodes les plus inutiles de Unsafe ont √©t√© supprim√©es.  Je pense que jusqu'√† ce qu'au moins la moiti√© de tous les projets utilisant Unsafe passent √† autre chose, Unsafe sera disponible sous une forme ou une autre. <br><br><h3>  <b>Il y a une opinion: Banque + Java = entreprise sanglante ossifi√©e?</b> <br></h3><br>  Notre √©quipe n'a pas de telles horreurs.  Au printemps, nous avons probablement √©crit dix lignes, et par moi)) Nous essayons de ne pas utiliser de grosses technologies.  Nous pr√©f√©rons faire petit, soign√© et rapide, afin de pouvoir le r√©aliser, le contr√¥ler et, si n√©cessaire, le modifier.  Ce dernier est tr√®s important pour les syst√®mes (comme le n√¥tre), qui ont des exigences non standard, qui peuvent diff√©rer des exigences de 90% des utilisateurs du framework.  Et dans le cas de l'utilisation d'un grand cadre, nous ne serons pas en mesure de transmettre nos besoins √† la communaut√© ou de corriger ind√©pendamment le comportement. <br><br>  √Ä mon avis, les d√©veloppeurs devraient toujours pouvoir utiliser tous les outils disponibles.  Je suis venu dans le monde Java √† partir de C ++ et je suis tr√®s frapp√© par la division de la communaut√© en ceux qui d√©veloppent le <i>runtime de la</i> machine / compilateur virtuel ou de la machine virtuelle elle-m√™me et en d√©veloppeurs d'applications.  Cela se voit clairement dans le code de classe JDK standard.  Les auteurs JDK utilisent souvent une API diff√©rente.  Potentiellement, cela signifie que nous ne pouvons pas atteindre des performances de pointe.  En g√©n√©ral, je pense que l'utilisation de la m√™me API pour √©crire √† la fois la biblioth√®que standard et le code d'application est un excellent indicateur de la maturit√© de la plateforme. <br><br><h3>  <b>Encore une chose</b> </h3><br>  Je pense qu'il est tr√®s important pour tous les d√©veloppeurs de savoir comment, sinon toute la pile, alors au moins la moiti√© fonctionne: code Java, code octet, composants internes du runtime et assembleur de la machine virtuelle, mat√©riel, syst√®me d'exploitation, r√©seau.  Cela permet une vision plus large des probl√®mes. <br>  La performance m√©rite √©galement d'√™tre mentionn√©e.  Il est tr√®s important de ne pas se concentrer sur la moyenne et de toujours regarder les centiles m√©dian et √©lev√© (le pire des mesures 10/100/1000 / ...). <br><br>  Je parlerai de tout cela lors d'une <b>r√©union du groupe d'utilisateurs Java le 30 mai</b> √† Saint-P√©tersbourg.  Rencontre avec Sergei Melnikov, c'est juste moi)) Vous pouvez vous inscrire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  <b>De quoi allons-nous parler?</b> <br><br><ol><li>  √Ä propos du profilage et de l'utilisation du profileur Linux et perf standard: comment vivre avec eux, ce qu'ils mesurent et comment interpr√©ter leurs r√©sultats.  Ce sera une introduction au profilage g√©n√©ral, avec des conseils, des astuces de vie, comment tirer tout ce qui est possible des profileurs afin qu'ils profilent avec une pr√©cision et une fr√©quence maximales. </li><li>  √Ä propos des fonctionnalit√©s de l'√©quipement pour obtenir un profil encore plus d√©taill√© et afficher le profil des √©v√©nements rares.  Par exemple, lorsque votre code s'ex√©cute 10 fois plus lentement toutes les centi√®mes fois.  Aucun profileur ne le dira.  Nous allons √©crire notre petit profileur en utilisant le m√©canisme standard du noyau Linux et essayer de voir le profil d'un √©v√©nement rare. </li></ol><br>  Venez √† la r√©union, ce sera une grande soir√©e, il y aura beaucoup d'histoires int√©ressantes sur notre plateforme et sur notre langue pr√©f√©r√©e. <br><br>  A plus tard;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453688/">https://habr.com/ru/post/fr453688/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr453672/index.html">CardInfo - API pour d√©terminer le logo, les couleurs de la banque et d'autres choses par num√©ro de carte</a></li>
<li><a href="../fr453676/index.html">Connexion √† Windows via SSH comme sous Linux</a></li>
<li><a href="../fr453678/index.html">Comment voir la r√©verb√©ration ou la transmission vid√©o par le son dans l'eau - 2</a></li>
<li><a href="../fr453682/index.html">D√©veloppement du ¬´firmware¬ª le plus simple pour les FPGA install√©s dans Redd. Partie 2. Code de programme</a></li>
<li><a href="../fr453686/index.html">Semaine de la s√©curit√© 22: statistiques sur les menaces, chevaux de Troie bancaires et exploits populaires</a></li>
<li><a href="../fr453692/index.html">Shaders de jeu 3D pour d√©butants: Effets</a></li>
<li><a href="../fr453694/index.html">Connectez-vous √† Windows via SSH comme sous Linux</a></li>
<li><a href="../fr453696/index.html">Reliure angulaire bidirectionnelle, un peu plus de compr√©hension</a></li>
<li><a href="../fr453698/index.html">L'information quantique dans la conscience quantique</a></li>
<li><a href="../fr453700/index.html">Le√ßons sur SDL 2: Le√ßon 1 - Bonjour, SDL 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>