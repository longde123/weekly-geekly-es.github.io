<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍🎓 🍵 👨🏿‍🤝‍👨🏻 Bagaimana saya menambahkan perangkat baru ke SmartThings Hub, bagian 1 🍁 ✌🏼 👩🏿‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini saya ingin berbicara tentang pengalaman saya dalam mengembangkan apa yang disebut Device Handler for SmartThings. Tugasnya adalah men...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana saya menambahkan perangkat baru ke SmartThings Hub, bagian 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427923/">  Pada artikel ini saya ingin berbicara tentang pengalaman saya dalam mengembangkan apa yang disebut Device Handler for SmartThings.  Tugasnya adalah menambahkan perangkat universal berdasarkan protokol Z-Wave - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Uno</a> , serta pemrosesan perangkat anak yang terhubung dengannya. <br><br><img src="https://habrastorage.org/webt/z7/oy/id/z7oyidfngexle4mupi8hhkxjmbg.png"><br><a name="habracut"></a><br>  Pengantar pengembangan membutuhkan banyak waktu, tetapi setelah <s>mencerahkan</s> studi yang cermat tentang sebagian besar dokumentasi, pengembangan lebih lanjut tidak lagi membutuhkan banyak usaha.  Sebagai akibatnya, diputuskan untuk menulis artikel ini untuk memfasilitasi pekerjaan pengguna berbahasa Rusia. <br><br>  Seluruh proses pengembangan berlangsung dalam aplikasi web SmartTings IDE bahasa GroThy.  Pengujian lebih mudah dilakukan dari perangkat seluler, namun, dimungkinkan untuk membuat simulator perangkat di lingkungan pengembangan yang sama.  Dalam hal menguji shell grafis, sudah ada kebutuhan untuk menggunakan aplikasi seluler SmartThings Classic ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Android</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">iOS</a> ). <br><br>  Perangkat plug-in adalah papan yang memungkinkan Anda menambahkan kontrol ke hampir semua perangkat di Z-Wave.  Selain itu, perangkat yang terhubung dapat berupa nomor yang berbeda (hingga 32 pcs.).  Dengan demikian, pada tingkat perangkat lunak, semua jenis perangkat yang terhubung juga harus diproses dan mengontrol output ke aplikasi. <br><br>  Daftar jenis yang diproses: <br><br><ul><li>  Switch Binary - perangkat dengan hanya dua posisi: on / off </li><li>  Switch Multilevel - perangkat yang dapat dimatikan atau dihidupkan dengan makna yang berbeda.  Misalnya, dimer. </li><li>  Sensor Multilevel - sensor yang mengirim nilai non-biner.  Misalnya, sensor suhu. </li><li>  Meter - perangkat seperti penghitung </li><li>  Pemberitahuan - sensor biner akan dari jenis ini.  Misalnya, saklar buluh. </li><li>  Thermostat - kelas terpisah dari tim yang bertanggung jawab untuk bekerja dengan thermostat </li></ul><br><br><h3>  Struktur dokumen </h3><br>  Dua blok logis dapat dibedakan: <br><br><ul><li> Deskripsi dan informasi meta tentang penangan.  Ini termasuk informasi tentang perangkat, bagaimana UI dan informasi lainnya harus diambil.  Ini dialokasikan dengan metode <code>metadata()</code> . <br><br><img width="300" src="https://habrastorage.org/webt/pv/lc/wr/pvlcwrzmhfhltg1s2vvhp5zdx64.jpeg"><br></li><li>  Metode handler adalah logika handler.  Mereka bertanggung jawab atas "komunikasi" dengan perangkat. <br><br>  Secara terpisah, kita dapat membedakan metode parse (), yang menafsirkan perintah yang diterima dari perangkat. </li></ul><br>  Saya akan menjelaskan secara lebih rinci tujuan dan isi setiap blok selama serangkaian artikel. <br><br><h2>  Metadata </h2><br>  Seperti yang Anda lihat dari nama metode, ini mengandung meta-informasi. <br><br>  Mari pertimbangkan apa yang termasuk dalam blok ini: <br><br><h3>  Definisi () </h3><br>  Dalam metode ini, argumen menunjukkan tiga hal, masing-masing: nama pawang, namespace, dan nama penulis. <br><br><ul><li>  Nama pawang akan digunakan di masa depan saat menerbitkan dan saat membuat perangkat anak. </li><li>  Namespace digunakan ketika mencari penangan dengan nama untuk memastikan bahwa yang benar ditemukan, misalnya, di antara penangan dengan nama yang sama.  SmartThings merekomendasikan penggunaan nama panggilan Anda di github. </li><li>  Nama penulis diisi dengan nama Anda. </li></ul><br><pre> <code class="hljs pgsql"> definition(<span class="hljs-type"><span class="hljs-type">name</span></span>: "Your device", namespace: "yournamespace", author: "your name") {}</code> </pre><br>  Variabel berikut dapat dideklarasikan di tubuh metode: <code>attribute, capability, command, fingerprint</code> .  Selanjutnya kami akan mempertimbangkan secara lebih rinci apa itu dan kapan diterapkan. <br><br><h3>  Koneksi dan sidik jari </h3><br>  Kami menghubungkan perangkat kami.  Dalam kasus kami, SmartThings V2 Hub dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Z-Uno</a> akan digunakan. <br><br>  Pada saat menambahkan perangkat Z-Wave atau ZigBee baru, hub akan mencoba mengenali jenis perangkat yang mereka coba sambungkan dan mulai mencari penangan yang paling relevan.  Dia akan memilihnya dengan "Sidik Jari".  Jika hub tidak menemukan kecocokan pada penangan khusus, ia akan mencoba menggunakan salah satu templat standar terdekat. <br><br>  "Sidik jari" diatur dalam handler itu sendiri untuk menunjukkan jenis perangkat apa yang didukungnya.  Dokumentasi resmi mengatakan bahwa mereka akan berbeda untuk perangkat Z-Wave dan perangkat ZigBee, kami akan mempertimbangkan implementasi untuk Z-Wave. <br><br>  Perangkat protokol Z-Wave menyimpan informasi tentang pabrikan, tipe perangkat, kemampuannya, dll.  Selama apa yang disebut "wawancara" dengan perangkat, ST mengumpulkan informasi ini dalam deskripsi mentah Z-Wave.  Contoh garis seperti itu: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">zw</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:Ss</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">type</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:2101</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mfr</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:0086</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">prod</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:0102</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">model</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:0064</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:1.04</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">zwv</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:4.05</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lib</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:03</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:5E</span></span>,86,72,98,84 <span class="hljs-selector-tag"><span class="hljs-selector-tag">ccOut</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:5A</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sec</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:59</span></span>,85,73,71,80,30,31,70,7<span class="hljs-selector-tag"><span class="hljs-selector-tag">A</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">role</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:06</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ff</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:8C07</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ui</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:8C07</span></span></code> </pre><br>  Nilai setiap tombol digunakan untuk mengisi "sidik jari".  Deskripsi terperinci dari setiap item dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a>  Kami akan mempertimbangkan yang akan digunakan dalam penangan kami. <br><br>  Untuk menemukan baris ini dengan informasi, Anda harus pergi ke tab 'Perangkat Saya' dan klik perangkat yang kami minati (sebelum itu, perangkat harus ditambahkan ke jaringan). <br><br><img src="https://habrastorage.org/webt/ix/uc/yg/ixucyg3owvrk2usf5brdg-zriyw.png"><br><br>  <b>mfr</b> adalah nilai 16-bit yang mengandung ID Pabrikan.  Daftar pabrikan dan ID mereka dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  <b>prod</b> - nilai 16-bit yang mengandung ID Jenis Produk - ID jenis perangkat unik. <br><br>  <b>model</b> adalah nilai 16-bit yang berisi ID Produk. <br><br>  <b>inClusters</b> - Nilai 8-bit yang menetapkan kebutuhan untuk Kelas Perintah tertentu.  Misalnya, jika kami perlu menunjukkan bahwa pawang kami akan bekerja dengan MultiChannel CC, Anda perlu menulis kode 0x60.  Daftar yang tersedia untuk SmartThings <abbr title="Kelas perintah">CC</abbr> dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Keempat tombol ini cukup bagi hub untuk memahami dengan tepat perangkat yang dimiliki oleh pawang ini.  Contoh bagaimana mereka digunakan dengan saya: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">fingerprint</span></span> mfr: <span class="hljs-string"><span class="hljs-string">"0115"</span></span>, prod: <span class="hljs-string"><span class="hljs-string">"0110"</span></span>, model: <span class="hljs-string"><span class="hljs-string">"0001"</span></span>, inClusters: <span class="hljs-string"><span class="hljs-string">"0x60"</span></span> fingerprint mfr: <span class="hljs-string"><span class="hljs-string">"0115"</span></span>, prod: <span class="hljs-string"><span class="hljs-string">"0111"</span></span>, inClusters: <span class="hljs-string"><span class="hljs-string">"0x60"</span></span></code> </pre><br>  Suatu perangkat dapat memiliki jumlah parameter yang lebih besar, dalam hal ini ia dapat berhasil terhubung ke penangan ini, namun, jika setidaknya salah satu dari mereka tidak cocok dengan sidik jari yang dinyatakan, perangkat akan mengabaikan penangan ini. <br><br>  Smartthings merekomendasikan menambahkan informasi tentang pabrikan (mfr) dan model (prod, model) dalam sidik jari, untuk mengecualikan kasus ketika pilihan prosesor tidak akan jelas.  Misalnya, ketika sidik jari salah satu templat atau contoh yang digunakan secara default akan cocok dengan milik Anda. <br><br>  Lokasi dalam kode <br><pre> <code class="hljs objectivec">metadata { definition(...) { ... fingerprint mfr: <span class="hljs-string"><span class="hljs-string">"0115"</span></span>, prod: <span class="hljs-string"><span class="hljs-string">"0110"</span></span>, model: <span class="hljs-string"><span class="hljs-string">"0001"</span></span>, inClusters: <span class="hljs-string"><span class="hljs-string">"0x60"</span></span> fingerprint mfr: <span class="hljs-string"><span class="hljs-string">"0115"</span></span>, prod: <span class="hljs-string"><span class="hljs-string">"0111"</span></span>, inClusters: <span class="hljs-string"><span class="hljs-string">"0x60"</span></span> } ... }</code> </pre><br><br>  Siklus penuh artikel direncanakan, hingga rilis.  Saya harap informasi ini akan membantu Anda dalam pengembangan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id427923/">https://habr.com/ru/post/id427923/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id427913/index.html">Menghibur prolog # 2</a></li>
<li><a href="../id427915/index.html">Anggapan kebodohan</a></li>
<li><a href="../id427917/index.html">Membalas posting Presumption of the Mind</a></li>
<li><a href="../id427919/index.html">Porting COM ke Linux</a></li>
<li><a href="../id427921/index.html">4 video tentang penundaan</a></li>
<li><a href="../id427925/index.html">Migrasi tanpa korban: daftar periksa teknis untuk memindahkan situs ke domain baru</a></li>
<li><a href="../id427927/index.html">B - Kebrutalan. Situs resmi Federasi Tenis Meja Republik Bashkortostan (FTN RB)</a></li>
<li><a href="../id427929/index.html">Kementerian Tenaga Kerja: tugas uji adalah hubungan kerja</a></li>
<li><a href="../id427931/index.html">Arsitektur Informasi Internet Bagian 4</a></li>
<li><a href="../id427933/index.html">Opini Pengembang Steam: Pendapatan Maksimum dan Tanggung Jawab Rendah untuk Valve</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>