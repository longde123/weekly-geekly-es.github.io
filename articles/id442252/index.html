<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüé§ üñ§ ‚ìÇÔ∏è Siklus Hidup Kode Python - Model Runtime CPython üßôüèæ ‚úçÔ∏è ü§¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! Musim semi telah tiba, yang berarti bahwa kurang dari satu bulan tersisa sebelum dimulainya kursus Pengembang Python . Untuk kursus ini...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Siklus Hidup Kode Python - Model Runtime CPython</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/442252/">  Halo semuanya!  Musim semi telah tiba, yang berarti bahwa kurang dari satu bulan tersisa sebelum dimulainya kursus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengembang Python</a> .  Untuk kursus ini publikasi kami hari ini akan dikhususkan. <br><br><img src="https://habrastorage.org/webt/8-/3n/pk/8-3npkdv_2mpp742_k0zytidc_k.png"><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/9g/fe/cn/9gfecnorojbyoxcczknx1pyf--g.png"><br><br>  <i><b>Tugas:</b></i> <br><br>  - Pelajari tentang struktur internal Python; <br>  - Memahami prinsip-prinsip membangun pohon sintaksis abstrak (AST); <br>  - Tulis kode yang lebih efisien dalam waktu dan memori. <br><br>  <i><b>Rekomendasi awal:</b></i> <br><br>  - Pemahaman dasar juru bahasa (AST, token, dll.). <br>  - Pengetahuan tentang Python. <br>  - Pengetahuan dasar C. <br><br><pre><code class="python hljs">batuhan@arch-pc ÓÇ∞ ~/blogs/cpython/exec_model ÓÇ∞ python --version Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br>  <b>Model Eksekusi CPython</b> <br><br>  Python adalah bahasa yang dikompilasi dan ditafsirkan.  Dengan demikian, kompiler Python menghasilkan bytecodes, dan interpreter mengeksekusinya.  Selama artikel kami akan mempertimbangkan masalah-masalah berikut: <br><br><ul><li>  Parsing dan tokenization: </li><li>  Transformasi dalam AST; </li><li>  Grafik Alir Kontrol (CFG); </li><li>  Bytecode </li><li>  Berjalan di mesin virtual CPython. </li></ul><br>  <b>Parsing dan tokenization.</b> <b><br></b>  <b>Tata bahasa.</b> <br><br>  Grammar mendefinisikan semantik bahasa Python.  Ini juga berguna dalam menunjukkan cara pengurai harus menafsirkan bahasa.  Tata bahasa Python menggunakan sintaksis yang mirip dengan bentuk Backus-Naur yang diperluas.  Ini memiliki tata bahasa sendiri untuk penerjemah dari bahasa sumber.  Anda dapat menemukan file tata bahasa di direktori "cpython / Grammar / Grammar". <br><br>  Berikut ini adalah contoh tata bahasa, <br><br><pre> <code class="python hljs">batuhan@arch-pc ÓÇ∞ ~/cpython/Grammar ÓÇ∞ ÓÇ† master ÓÇ∞ grep <span class="hljs-string"><span class="hljs-string">"simple_stmt"</span></span> Grammar | head -n3 | tail -n1 simple_stmt: small_stmt (<span class="hljs-string"><span class="hljs-string">';'</span></span> small_stmt)* [<span class="hljs-string"><span class="hljs-string">';'</span></span>] NEWLINE</code> </pre> <br>  Ekspresi sederhana berisi ekspresi kecil dan tanda kurung, dan perintah berakhir dengan baris baru.  Ekspresi kecil terlihat seperti daftar ekspresi yang mengimpor ... <br>  Beberapa ungkapan lain :) <br><br><pre> <code class="python hljs">small_stmt: (expr_stmt | del_stmt | pass_stmt | flow_stmt | import_stmt | global_stmt | nonlocal_stmt | assert_stmt) ... del_stmt: <span class="hljs-string"><span class="hljs-string">'del'</span></span> exprlist pass_stmt: <span class="hljs-string"><span class="hljs-string">'pass'</span></span> flow_stmt: break_stmt | continue_stmt | return_stmt | raise_stmt | yield_stmt break_stmt: <span class="hljs-string"><span class="hljs-string">'break'</span></span> continue_stmt: <span class="hljs-string"><span class="hljs-string">'continue'</span></span></code> </pre> <br>  <b>Tokenisasi (Penggabungan)</b> <br><br>  Tokenisasi adalah proses memperoleh aliran data teks dan membelah menjadi token kata-kata penting (untuk penerjemah) dengan metadata tambahan (misalnya, di mana token dimulai dan berakhir, dan berapa nilai string dari token ini). <br><br>  <b>Token</b> <br><br>  Token adalah file header yang berisi definisi semua token.  Ada 59 jenis token di Python (Sertakan / token.h). <br><br>  Di bawah ini adalah contoh dari beberapa di antaranya, <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#define NAME 1 #define NUMBER 2 #define STRING 3 #define NEWLINE 4 #define INDENT 5 #define DEDENT 6</span></span></code> </pre> <br>  Anda melihat mereka jika Anda memecah beberapa kode Python menjadi token. <br><br>  <b>Tokenisasi dengan CLI</b> <br><br>  Ini file tests.py <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">greetings</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: str)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">f"Hello </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{name}</span></span></span><span class="hljs-string">"</span></span>) greetings(<span class="hljs-string"><span class="hljs-string">"Batuhan"</span></span>)</code> </pre> <br>  Kemudian kita tokenize menggunakan perintah python -m tokenize dan berikut ini adalah output: <br><br><pre> <code class="python hljs">batuhan@arch-pc ÓÇ∞ ~/blogs/cpython/exec_model ÓÇ∞ python -m tokenize tests.py <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>: ENCODING <span class="hljs-string"><span class="hljs-string">'utf-8'</span></span> ... <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>: INDENT <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>: NAME <span class="hljs-string"><span class="hljs-string">'print'</span></span> ... <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>: DEDENT <span class="hljs-string"><span class="hljs-string">''</span></span> ... <span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>: ENDMARKER <span class="hljs-string"><span class="hljs-string">''</span></span></code> </pre><br>  Di sini angka (misalnya, 1.4-1.13) menunjukkan di mana token dimulai dan di mana berakhir.  Token penyandian selalu merupakan token pertama yang kami terima.  Ini memberikan informasi tentang penyandian file sumber, dan jika ada masalah dengan itu, penerjemah melempar pengecualian. <br><br>  <b>Tokenisasi dengan <i>tokenize.tokenize</i></b> <br><br>  Jika Anda perlu tokenize file dari kode Anda, Anda dapat menggunakan modul <i><b>tokenize</b></i> dari <i>stdlib</i> . <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'tests.py'</span></span>, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: ... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tokenize.tokenize(f.readline): ... print(token) ... TokenInfo(type=<span class="hljs-number"><span class="hljs-number">57</span></span> (ENCODING), string=<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>, start=(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), end=(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), line=<span class="hljs-string"><span class="hljs-string">''</span></span>) ... TokenInfo(type=<span class="hljs-number"><span class="hljs-number">1</span></span> (NAME), string=<span class="hljs-string"><span class="hljs-string">'greetings'</span></span>, start=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), end=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>), line=<span class="hljs-string"><span class="hljs-string">'def greetings(name: str):\n'</span></span>) ... TokenInfo(type=<span class="hljs-number"><span class="hljs-number">53</span></span> (OP), string=<span class="hljs-string"><span class="hljs-string">':'</span></span>, start=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>), end=(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>), line=<span class="hljs-string"><span class="hljs-string">'def greetings(name: str):\n'</span></span>) ...</code> </pre> <br>  Jenis token adalah id di file header <i>token.h.</i>  String adalah nilai token.  Mulai dan Akhir menunjukkan di mana token dimulai dan berakhir, masing-masing. <br><br>  Dalam bahasa lain, blok ditunjukkan oleh tanda kurung atau pernyataan awal / akhir, tetapi Python menggunakan indentasi dan level yang berbeda.  INDEN dan DENEN dan menunjukkan indentasi.  Token ini diperlukan untuk membangun pohon parsing relasional dan / atau pohon sintaksis abstrak. <br><br>  <b>Generasi Parser</b> <br><br>  Generasi Parser - proses yang menghasilkan parser sesuai dengan tata bahasa yang diberikan.  Generator Parser dikenal sebagai PGen.  Cpython memiliki dua generator parser.  Satu adalah asli ( <code>Parser/pgen</code> ) dan satu ditulis ulang dengan python ( <code>/Lib/lib2to3/pgen2</code> ). <br><br>  <i>"Generator asli adalah kode pertama yang saya tulis untuk Python"</i> <i><br></i>  <i>-Guido</i> <br><br>  Dari kutipan di atas, menjadi jelas bahwa <i>pgen</i> adalah hal yang paling penting dalam bahasa pemrograman.  Ketika Anda memanggil pgen (dalam <i>Parser / pgen</i> ) itu menghasilkan file header dan file-C (pengurai itu sendiri).  Jika Anda melihat kode C yang dihasilkan, itu mungkin tampak tidak berguna, karena penampilannya yang bermakna adalah opsional.  Ini berisi banyak data dan struktur statis.  Selanjutnya, kami akan mencoba menjelaskan komponen utamanya. <br><br>  <b>DFA (Mesin Defined State)</b> <br><br>  Parser mendefinisikan satu DFA untuk setiap nonterminal.  Setiap DFA didefinisikan sebagai susunan status. <br><br><pre> <code class="bash hljs">static dfa dfas[87] = { {256, <span class="hljs-string"><span class="hljs-string">"single_input"</span></span>, 0, 3, states_0, <span class="hljs-string"><span class="hljs-string">"\004\050\340\000\002\000\000\000\012\076\011\007\262\004\020\002\000\300\220\050\037\202\000"</span></span>}, ... {342, <span class="hljs-string"><span class="hljs-string">"yield_arg"</span></span>, 0, 3, states_86, <span class="hljs-string"><span class="hljs-string">"\000\040\200\000\002\000\000\000\000\040\010\000\000\000\020\002\000\300\220\050\037\000\000"</span></span>}, };</code> </pre> <br>  Untuk setiap DFA, ada starter kit yang menunjukkan token mana yang bukan terminal bisa dimulai. <br><br>  <b>Ketentuan</b> <br><br>  Setiap negara ditentukan oleh array transisi / tepi (busur). <br><br><pre> <code class="python hljs">static state states_86[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">2</span></span>, arcs_86_0}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_86_1}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_86_2}, };</code> </pre> <br>  <b>Transisi (busur)</b> <br><br>  Setiap larik transisi memiliki dua angka.  Nomor pertama adalah nama transisi (label busur), ini mengacu pada nomor simbol.  Angka kedua adalah tujuannya. <br><br><pre> <code class="python hljs">static arc arcs_86_0[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">77</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">47</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_86_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_86_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, };</code> </pre><br>  <b>Nama (label)</b> <br><br>  Ini adalah tabel khusus yang memetakan id karakter ke nama transisi. <br><br><pre> <code class="python hljs">static label labels[<span class="hljs-number"><span class="hljs-number">177</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"EMPTY"</span></span>}, {<span class="hljs-number"><span class="hljs-number">256</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, {<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, ... {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"async"</span></span>}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"def"</span></span>}, ... {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"yield"</span></span>}, {<span class="hljs-number"><span class="hljs-number">342</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, };</code> </pre> <br>  Angka 1 sesuai dengan semua pengidentifikasi.  Dengan demikian, masing-masing mendapat nama transisi yang berbeda, bahkan jika mereka semua memiliki karakter id yang sama. <br><br>  <i><b>Contoh sederhana:</b></i> <br><br>  Misalkan kita memiliki kode yang menampilkan "Hai" jika 1 - true: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Hi'</span></span>)</code> </pre> <br>  Parser menganggap kode ini sebagai single_input. <br><br><pre> <code class="python hljs">single_input: NEWLINE | simple_stmt | compound_stmt NEWLINE</code> </pre> <br>  Kemudian pohon parsing kita mulai pada simpul akar dari input satu kali. <br><br><img src="https://habrastorage.org/webt/xm/nl/r2/xmnlr287d0_vdkigdsqvtvpwhmi.png"><br><br>  Dan nilai DFA kami (single_input) adalah 0. <br><br><pre> <code class="python hljs">static dfa dfas[<span class="hljs-number"><span class="hljs-number">87</span></span>] = { {<span class="hljs-number"><span class="hljs-number">256</span></span>, <span class="hljs-string"><span class="hljs-string">"single_input"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, states_0, <span class="hljs-string"><span class="hljs-string">"\004\050\340\000\002\000\000\000\012\076\011\007\262\004\020\002\000\300\220\050\037\202\000"</span></span>} ... }</code> </pre><br>  Ini akan terlihat seperti ini: <br><br><pre> <code class="python hljs">static arc arcs_0_0[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_0_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static arc arcs_0_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static state states_0[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">3</span></span>, arcs_0_0}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_0_1}, {<span class="hljs-number"><span class="hljs-number">1</span></span>,</code> </pre>  arcs_0_2}, <br>  }; <br><br>  Di sini <code>arc_0_0</code> terdiri dari tiga elemen.  Yang pertama adalah <code>NEWLINE</code> , yang kedua adalah <code>simple_stmt</code> , dan yang terakhir adalah <code>compound_stmt</code> . <br><br>  Dengan set awal <code>simple_stmt</code> kita dapat menyimpulkan bahwa <code>simple_stmt</code> tidak dapat dimulai dengan <code>if</code> .  Namun, meskipun jika bukan baris baru, maka <code>compound_stmt</code> masih dapat dimulai dengan <code>if</code> .  Jadi, kita beralih ke <code>arc ({4;2})</code> terakhir <code>arc ({4;2})</code> dan menambahkan node <code>compound_stmt</code> ke parsing tree dan beralih ke DFA baru sebelum melanjutkan ke nomor 2.  Kami mendapatkan pohon parsing yang diperbarui: <br><br><img src="https://habrastorage.org/webt/fv/lc/ac/fvlcacpcaci0gacypn7mwu7ldkm.png"><br><br>  DFA baru mem-parsing pernyataan majemuk. <br><br><pre> <code class="python hljs">compound_stmt: if_stmt | while_stmt | for_stmt | try_stmt | with_stmt | funcdef | classdef | decorated | async_stmt</code> </pre> <br>  Dan kami mendapatkan yang berikut: <br><br><pre> <code class="python hljs">static arc arcs_39_0[<span class="hljs-number"><span class="hljs-number">9</span></span>] = { {<span class="hljs-number"><span class="hljs-number">91</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">92</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">93</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">94</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">95</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">96</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static arc arcs_39_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static state states_39[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { {<span class="hljs-number"><span class="hljs-number">9</span></span>, arcs_39_0}, {<span class="hljs-number"><span class="hljs-number">1</span></span>, arcs_39_1}, };</code> </pre><br>  Hanya lompatan pertama yang bisa dimulai dengan <code>if</code> .  Kami mendapatkan pohon parsing yang diperbarui. <br><br><img src="https://habrastorage.org/webt/kh/q2/ru/khq2rutapnl3op6estdsfaznvwo.png"><br><br>  Kemudian kita kembali mengubah DFA dan ifs DFA berikutnya. <br><br><pre> <code class="python hljs">if_stmt: <span class="hljs-string"><span class="hljs-string">'if'</span></span> test <span class="hljs-string"><span class="hljs-string">':'</span></span> suite (<span class="hljs-string"><span class="hljs-string">'elif'</span></span> test <span class="hljs-string"><span class="hljs-string">':'</span></span> suite)* [<span class="hljs-string"><span class="hljs-string">'else'</span></span> <span class="hljs-string"><span class="hljs-string">':'</span></span> suite]</code> </pre> <br>  Akibatnya, kami mendapatkan satu-satunya transisi dengan penunjukan 97. Ini bertepatan dengan token <code>if</code> . <br><br><pre> <code class="python hljs">static arc arcs_41_0[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">97</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, }; static arc arcs_41_1[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}, }; static arc arcs_41_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}, }; static arc arcs_41_3[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>}, }; static arc arcs_41_4[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { {<span class="hljs-number"><span class="hljs-number">98</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>}, {<span class="hljs-number"><span class="hljs-number">99</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>}, {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>}, }; static arc arcs_41_5[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>}, }; static arc arcs_41_6[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { {<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>}, }; ...</code> </pre> <br>  Saat kami beralih ke status berikutnya, tetap dalam DFA yang sama, arcs_41_1 berikutnya juga hanya memiliki satu transisi.  Ini berlaku untuk terminal uji.  Itu harus dimulai dengan angka (misalnya, 1). <br><br><img src="https://habrastorage.org/webt/f9/my/mh/f9mymh7fay4vovofermpmyfxegi.png"><br><br>  Hanya ada satu transisi di arc_41_2 yang mendapat token titik dua (:). <br><br><img src="https://habrastorage.org/webt/-f/qf/gn/-fqfgnvebdfvjez63wlbowzihdm.png"><br><br>  Jadi kita mendapatkan satu set yang bisa dimulai dengan nilai cetak.  Akhirnya, buka arcs_41_4.  Transisi pertama dalam set adalah ekspresi elif, yang kedua adalah yang lain, dan yang ketiga adalah untuk keadaan terakhir.  Dan kita mendapatkan tampilan akhir dari pohon parsing. <br><br><img src="https://habrastorage.org/webt/oj/_l/ye/oj_lyeqesfzsqv_iohr2yiunnqq.png"><br><br>  <b>Antarmuka Python untuk parser.</b> <b><br></b> <br><br>  Python memungkinkan Anda untuk mengedit pohon parsing untuk ekspresi menggunakan modul yang disebut parser. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> parser &gt;&gt;&gt; code = <span class="hljs-string"><span class="hljs-string">"if 1: print('Hi')"</span></span></code> </pre> <br>  Anda dapat menghasilkan pohon sintaksis tertentu (Sintaksis Beton Pohon, CST) menggunakan parser.suite. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>parser.suite(code).tolist() [<span class="hljs-number"><span class="hljs-number">257</span></span>, [<span class="hljs-number"><span class="hljs-number">269</span></span>, [<span class="hljs-number"><span class="hljs-number">295</span></span>, [<span class="hljs-number"><span class="hljs-number">297</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'if'</span></span>], [<span class="hljs-number"><span class="hljs-number">305</span></span>, [<span class="hljs-number"><span class="hljs-number">309</span></span>, [<span class="hljs-number"><span class="hljs-number">310</span></span>, [<span class="hljs-number"><span class="hljs-number">311</span></span>, [<span class="hljs-number"><span class="hljs-number">312</span></span>, [<span class="hljs-number"><span class="hljs-number">315</span></span>, [<span class="hljs-number"><span class="hljs-number">316</span></span>, [<span class="hljs-number"><span class="hljs-number">317</span></span>, [<span class="hljs-number"><span class="hljs-number">318</span></span>, [<span class="hljs-number"><span class="hljs-number">319</span></span>, [<span class="hljs-number"><span class="hljs-number">320</span></span>, [<span class="hljs-number"><span class="hljs-number">321</span></span>, [<span class="hljs-number"><span class="hljs-number">322</span></span>, [<span class="hljs-number"><span class="hljs-number">323</span></span>, [<span class="hljs-number"><span class="hljs-number">324</span></span>, [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>]]]]]]]]]]]]]]]], [<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-string"><span class="hljs-string">':'</span></span>], [<span class="hljs-number"><span class="hljs-number">304</span></span>, [<span class="hljs-number"><span class="hljs-number">270</span></span>, [<span class="hljs-number"><span class="hljs-number">271</span></span>, [<span class="hljs-number"><span class="hljs-number">272</span></span>, [<span class="hljs-number"><span class="hljs-number">274</span></span>, [<span class="hljs-number"><span class="hljs-number">305</span></span>, [<span class="hljs-number"><span class="hljs-number">309</span></span>, [<span class="hljs-number"><span class="hljs-number">310</span></span>, [<span class="hljs-number"><span class="hljs-number">311</span></span>, [<span class="hljs-number"><span class="hljs-number">312</span></span>, [<span class="hljs-number"><span class="hljs-number">315</span></span>, [<span class="hljs-number"><span class="hljs-number">316</span></span>, [<span class="hljs-number"><span class="hljs-number">317</span></span>, [<span class="hljs-number"><span class="hljs-number">318</span></span>, [<span class="hljs-number"><span class="hljs-number">319</span></span>, [<span class="hljs-number"><span class="hljs-number">320</span></span>, [<span class="hljs-number"><span class="hljs-number">321</span></span>, [<span class="hljs-number"><span class="hljs-number">322</span></span>, [<span class="hljs-number"><span class="hljs-number">323</span></span>, [<span class="hljs-number"><span class="hljs-number">324</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'print'</span></span>]], [<span class="hljs-number"><span class="hljs-number">326</span></span>, [<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-string"><span class="hljs-string">'('</span></span>], [<span class="hljs-number"><span class="hljs-number">334</span></span>, [<span class="hljs-number"><span class="hljs-number">335</span></span>, [<span class="hljs-number"><span class="hljs-number">305</span></span>, [<span class="hljs-number"><span class="hljs-number">309</span></span>, [<span class="hljs-number"><span class="hljs-number">310</span></span>, [<span class="hljs-number"><span class="hljs-number">311</span></span>, [<span class="hljs-number"><span class="hljs-number">312</span></span>, [<span class="hljs-number"><span class="hljs-number">315</span></span>, [<span class="hljs-number"><span class="hljs-number">316</span></span>, [<span class="hljs-number"><span class="hljs-number">317</span></span>, [<span class="hljs-number"><span class="hljs-number">318</span></span>, [<span class="hljs-number"><span class="hljs-number">319</span></span>, [<span class="hljs-number"><span class="hljs-number">320</span></span>, [<span class="hljs-number"><span class="hljs-number">321</span></span>, [<span class="hljs-number"><span class="hljs-number">322</span></span>, [<span class="hljs-number"><span class="hljs-number">323</span></span>, [<span class="hljs-number"><span class="hljs-number">324</span></span>, [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"'Hi'"</span></span>]]]]]]]]]]]]]]]]]], [<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-string"><span class="hljs-string">')'</span></span>]]]]]]]]]]]]]]]]]]], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]]]]]], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]]</code> </pre> <br>  Nilai output akan menjadi daftar bersarang.  Setiap daftar dalam struktur memiliki 2 elemen.  Yang pertama adalah id karakter (0-256 - terminal, 256+ - non-terminal) dan yang kedua adalah string token untuk terminal. <br><br>  <b>Pohon sintaksis abstrak</b> <br><br>  Bahkan, pohon sintaksis abstrak (AST) adalah representasi struktural dari kode sumber dalam bentuk pohon, di mana setiap simpul menunjukkan berbagai jenis konstruksi bahasa (ekspresi, variabel, operator, dll.) <br><br>  <b>Apa itu pohon?</b> <br><br>  Pohon adalah struktur data yang memiliki simpul akar sebagai titik awal.  Simpul akar diturunkan oleh cabang (transisi) ke simpul lain.  Setiap simpul, kecuali root, memiliki satu simpul induk unik. <br><br>  Ada perbedaan tertentu antara pohon sintaksis abstrak dan pohon parsing. <br><br><img src="https://habrastorage.org/webt/2o/ws/eb/2owsebsx9fqewbfmyxexaid5hm8.png"><br><br>  Di sebelah kanan adalah pohon penguraian untuk ekspresi 2 * 7 + 3.  Ini secara harfiah adalah gambar satu-ke-satu dari kode sumber dalam bentuk pohon.  Semua ekspresi, istilah, dan nilai terlihat di sana.  Namun, gambar seperti itu terlalu rumit untuk sepotong kode sederhana, jadi kita bisa menghapus semua ekspresi sintaksis yang harus kita tentukan dalam kode untuk perhitungan. <br><br>  Pohon yang disederhanakan seperti itu disebut pohon sintaksis abstrak (AST).  Di sebelah kiri pada gambar ditampilkan persis untuk kode yang sama.  Semua ekspresi sintaksis telah dibuang untuk memudahkan pemahaman, tetapi ingat bahwa informasi tertentu telah hilang. <br><br>  <b>Contoh</b> <b><br></b> <br>  Python menawarkan modul AST bawaan untuk bekerja dengan AST.  Untuk menghasilkan kode dari pohon AST, Anda dapat menggunakan modul pihak ketiga, misalnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Astor</a> . <br><br>  Misalnya, pertimbangkan kode yang sama seperti sebelumnya. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ast &gt;&gt;&gt; code = <span class="hljs-string"><span class="hljs-string">"if 1: print('Hi')"</span></span></code> </pre> <br>  Untuk mendapatkan AST, kami menggunakan metode ast.parse. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>tree = ast.parse(code) &gt;&gt;&gt; tree &lt;_ast.Module object at <span class="hljs-number"><span class="hljs-number">0x7f37651d76d8</span></span>&gt;</code> </pre> <br>  Coba gunakan metode <code>ast.dump</code> untuk mendapatkan pohon sintaksis abstrak yang lebih mudah dibaca. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>ast.dump(tree) <span class="hljs-string"><span class="hljs-string">"Module(body=[If(test=Num(n=1), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='Hi')], keywords=[]))], orelse=[])])"</span></span></code> </pre> <br>  AST umumnya dianggap lebih visual dan mudah dipahami daripada pohon parsing. <br><br>  <b>Control Flow Graf (CFG)</b> <br><br>  Grafik aliran kendali adalah grafik arah yang memodelkan aliran suatu program menggunakan blok-blok dasar yang berisi representasi perantara. <br><br>  Biasanya, CFG adalah langkah sebelumnya sebelum mendapatkan nilai kode output.  Kode dihasilkan langsung dari blok dasar menggunakan pencarian kedalaman mundur di CFG, mulai dari atas. <br><br>  <b>Bytecode</b> <br><br>  Bytecode Python adalah seperangkat instruksi antara yang bekerja di mesin virtual Python.  Ketika Anda menjalankan kode sumber, Python membuat direktori bernama __pycache__.  Ini menyimpan kode yang dikompilasi untuk menghemat waktu jika memulai kembali kompilasi. <br><br>  Pertimbangkan fungsi Python sederhana di func.py. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">say_hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name: str)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">"Hello"</span></span>, name) print(<span class="hljs-string"><span class="hljs-string">f"How are you </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{name}</span></span></span><span class="hljs-string">?"</span></span>)</code> </pre> <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> func <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> say_hello &gt;&gt;&gt; say_hello(<span class="hljs-string"><span class="hljs-string">"Batuhan"</span></span>) Hello Batuhan How are you Batuhan?</code> </pre> <br>  <code>say_hello</code> objek <code>say_hello</code> adalah fungsi. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>type(say_hello) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class">'&gt;</span></span></code> </pre> <br>  Ini memiliki atribut <code>__code__</code> . <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>say_hello.__code__ &lt;code object say_hello at <span class="hljs-number"><span class="hljs-number">0x7f13777d9150</span></span>, file <span class="hljs-string"><span class="hljs-string">"/home/batuhan/blogs/cpython/exec_model/func.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;</code> </pre> <br>  <b>Objek Kode</b> <br><br>  Objek kode adalah struktur data yang tidak dapat diubah yang berisi instruksi atau metadata yang diperlukan untuk menjalankan kode.  Sederhananya, ini adalah representasi dari kode Python.  Anda juga bisa mendapatkan objek kode dengan mengkompilasi pohon sintaksis abstrak menggunakan metode <i>kompilasi</i> . <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ast &gt;&gt;&gt; code = <span class="hljs-string"><span class="hljs-string">""" ... def say_hello(name: str): ... print("Hello", name) ... print(f"How are you {name}?") ... say_hello("Batuhan") ... """</span></span> &gt;&gt;&gt; tree = ast.parse(code, mode=<span class="hljs-string"><span class="hljs-string">'exec'</span></span>) &gt;&gt;&gt; code = compile(tree, <span class="hljs-string"><span class="hljs-string">'&lt;string&gt;'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'exec'</span></span>) &gt;&gt;&gt; type(code) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">code</span></span></span><span class="hljs-class">'&gt;</span></span></code> </pre> <br>  Setiap objek kode memiliki atribut yang berisi informasi tertentu (diawali dengan co_).  Di sini kami hanya menyebutkan beberapa saja. <br><br>  <i><b>co_name</b></i> <br><br>  Untuk memulai - sebuah nama.  Jika suatu fungsi ada, maka itu harus memiliki nama, masing-masing, nama ini akan menjadi nama fungsi, situasi yang mirip dengan kelas.  Dalam contoh AST, kami menggunakan modul, dan kami dapat memberi tahu kompiler apa yang ingin kami beri nama.  Biarkan mereka menjadi <code>module</code> . <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>code.co_name <span class="hljs-string"><span class="hljs-string">'&lt;module&gt;'</span></span> &gt;&gt;&gt; say_hello.__code__.co_name <span class="hljs-string"><span class="hljs-string">'say_hello'</span></span></code> </pre> <br>  <i><b>co_varnames</b></i> <br><br>  Ini adalah tuple yang berisi semua variabel lokal, termasuk argumen. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>say_hello.__code__.co_varnames (<span class="hljs-string"><span class="hljs-string">'name'</span></span>,)</code> </pre> <br>  <i><b>co_conts</b></i> <br><br>  Sebuah tuple yang berisi semua nilai literal dan konstan yang kami akses di tubuh fungsi.  Perlu dicatat nilai Tidak Ada.  Kami tidak memasukkan Tidak Ada di tubuh fungsi, bagaimanapun, Python menunjukkannya, karena jika fungsi mulai mengeksekusi dan kemudian berakhir tanpa menerima nilai kembali, itu akan mengembalikan Tidak ada. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>say_hello.__code__.co_consts (<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'Hello'</span></span>, <span class="hljs-string"><span class="hljs-string">'How are you '</span></span>, <span class="hljs-string"><span class="hljs-string">'?'</span></span>)</code> </pre> <br>  <b>Bytecode (co_code)</b> <br><br>  Berikut ini adalah bytecode dari fungsi kami. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>bytecode = say_hello.__code__.co_code &gt;&gt;&gt; bytecode <span class="hljs-string"><span class="hljs-string">b't\x00d\x01|\x00\x83\x02\x01\x00t\x00d\x02|\x00\x9b\x00d\x03\x9d\x03\x83\x01\x01\x00d\x00S\x00'</span></span></code> </pre> <br>  Ini bukan string, ini adalah objek byte, yaitu urutan byte. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>type(bytecode) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bytes</span></span></span><span class="hljs-class">'&gt;</span></span></code> </pre> <br>  Karakter pertama yang dicetak adalah "t".  Jika kami meminta nilai numeriknya, kami mendapatkan yang berikut ini. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>ord(<span class="hljs-string"><span class="hljs-string">'t'</span></span>) <span class="hljs-number"><span class="hljs-number">116</span></span></code> </pre> <br>  116 sama dengan bytecode [0]. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bytecode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == ord(<span class="hljs-string"><span class="hljs-string">'t'</span></span>)</code> </pre><br>  Bagi kami, nilai 116 tidak berarti apa-apa.  Untungnya, Python menyediakan perpustakaan standar yang disebut dis (from disassembly).  Ini berguna saat bekerja dengan daftar opname.  Ini adalah daftar semua instruksi bytecode, di mana setiap indeks adalah nama instruksi. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.opname[ord(<span class="hljs-string"><span class="hljs-string">'t'</span></span>)] <span class="hljs-string"><span class="hljs-string">'LOAD_GLOBAL'</span></span></code> </pre> <br>  Mari kita buat fungsi lain yang lebih kompleks. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">multiple_it</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: int)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> a % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a * <span class="hljs-number"><span class="hljs-number">2</span></span> ... &gt;&gt;&gt; multiple_it(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt; multiple_it(<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-number"><span class="hljs-number">14</span></span> &gt;&gt;&gt; bytecode = multiple_it.__code__.co_code</code> </pre> <br>  Dan kami menemukan instruksi pertama dalam bytecode. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.opname[bytecode[<span class="hljs-number"><span class="hljs-number">0</span></span>]] <span class="hljs-string"><span class="hljs-string">'LOAD_FAST</span></span></code> </pre> <br>  Pernyataan LOAD_FAST terdiri dari dua elemen. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.opname[bytecode[<span class="hljs-number"><span class="hljs-number">0</span></span>]] + <span class="hljs-string"><span class="hljs-string">' '</span></span> + dis.opname[bytecode[<span class="hljs-number"><span class="hljs-number">1</span></span>]] <span class="hljs-string"><span class="hljs-string">'LOAD_FAST &lt;0&gt;'</span></span></code> </pre> <br>  Instruksi Loadfast 0 terjadi untuk mencari nama variabel dalam sebuah tuple dan mendorong elemen dengan indeks nol ke dalam tuple dalam tumpukan eksekusi. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>multiple_it.__code__.co_varnames[bytecode[<span class="hljs-number"><span class="hljs-number">1</span></span>]] <span class="hljs-string"><span class="hljs-string">'a'</span></span></code> </pre> <br>  Kode kami dapat dibongkar menggunakan dis.dis dan mengonversi bytecode ke tampilan yang sudah dikenal.  Di sini angka (2,3,4) adalah nomor baris.  Setiap baris kode dalam Python diperluas sebagai seperangkat instruksi. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dis.dis(multiple_it) <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">0</span></span> (a) <span class="hljs-number"><span class="hljs-number">2</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span> BINARY_MODULO <span class="hljs-number"><span class="hljs-number">6</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">2</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">8</span></span> COMPARE_OP <span class="hljs-number"><span class="hljs-number">2</span></span> (==) <span class="hljs-number"><span class="hljs-number">10</span></span> POP_JUMP_IF_FALSE <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">2</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">14</span></span> RETURN_VALUE <span class="hljs-number"><span class="hljs-number">4</span></span> &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">0</span></span> (a) <span class="hljs-number"><span class="hljs-number">18</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">20</span></span> BINARY_MULTIPLY <span class="hljs-number"><span class="hljs-number">22</span></span> RETURN_VALUE</code> </pre> <br>  <b>Lead time</b> <br><br>  CPython adalah mesin virtual yang berorientasi pada tumpukan, bukan kumpulan register.  Ini berarti bahwa kode Python dikompilasi untuk mesin virtual dengan arsitektur stack. <br><br>  Saat memanggil fungsi, Python menggunakan dua tumpukan bersamaan.  Yang pertama adalah tumpukan eksekusi, dan yang kedua adalah tumpukan blok.  Sebagian besar panggilan terjadi pada tumpukan eksekusi;  tumpukan blok melacak berapa banyak blok yang aktif saat ini, serta parameter lain yang terkait dengan blok dan cakupan. <br><br>  Kami menantikan komentar Anda tentang materi dan mengundang Anda ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">webinar terbuka</a> tentang topik: "Lepaskan: aspek praktis dari merilis perangkat lunak yang dapat diandalkan", yang akan dilakukan oleh guru kami, pemrogram sistem iklan di Mail.Ru, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Stanislav Stupnikov</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442252/">https://habr.com/ru/post/id442252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442238/index.html">Menggunakan Akun Smart Waves: Dari Lelang ke Program Bonus</a></li>
<li><a href="../id442242/index.html">Breaking News: Pabrik sel surya terbesar di belahan bumi Barat diluncurkan</a></li>
<li><a href="../id442244/index.html">Rust 1.33 Rilis</a></li>
<li><a href="../id442248/index.html">NASA menyetujui peluncuran uji tak berawak Dragon-2</a></li>
<li><a href="../id442250/index.html">Bereaksi dan Vue: Kekuatan</a></li>
<li><a href="../id442256/index.html">Pertahanan digital dari dunia plastik regulator Internet domestik</a></li>
<li><a href="../id442258/index.html">Pengikisan web untuk pengembang web: ringkasan singkat</a></li>
<li><a href="../id442260/index.html">10 Perintah Git Yang Harus Diketahui Pengembang</a></li>
<li><a href="../id442262/index.html">Rahasia firmware</a></li>
<li><a href="../id442264/index.html">Menghilangkan peluang untuk pembajakan lalu lintas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>