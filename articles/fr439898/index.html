<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë©‚Äçüëß üé£ üë®üèΩ‚Äç‚úàÔ∏è VBA et Python pour Excel et MS Office Automation üåΩ üåä üôÖüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La raison de cette note √©tait un article sur Habr√©, dans lequel l'auteur d√©crivait comment il avait r√©solu en Python la t√¢che de collecter et d'analys...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VBA et Python pour Excel et MS Office Automation</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439898/"><p>  La raison de cette note √©tait un article sur Habr√©, dans lequel l'auteur d√©crivait <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comment il avait r√©solu en Python la t√¢che de collecter et d'analyser des m√©tadonn√©es √† partir de fichiers Excel</a> . </p><br><p>  Cette note r√©v√®le plus en d√©tail la th√®se bien connue: <strong>Pour une t√¢che sp√©cifique, vous devez choisir l'outil le plus appropri√©</strong> applicable √† la bureautique. </p><br><h2 id="vba-i-python">  VBA et Python </h2><br><p>  <strong>VBA (Visual Basic pour Applications)</strong> , de facto, le langage le plus populaire pour automatiser Microsoft Office.  Disponible depuis la bo√Æte, en plus d'Excel, il fonctionne dans PowerPoint, Outlook, Access, Project et d'autres applications. </p><br><p>  Si vous posez la question: ¬´Quel langage de programmation choisir en premier¬ª, alors quelque part dans 90% des cas, <strong>Python</strong> sera propos√©.  Dans la pratique, il peut y avoir n'importe quelle autre langue, mais, en fonction de la popularit√© de la langue et de mon exp√©rience, je vais comparer avec elle. </p><br><p>  En g√©n√©ral, vous pouvez d√©crire la situation √† travers un calendrier similaire: </p><br><p><img src="https://habrastorage.org/webt/2h/aa/jd/2haajdadetskoq8fatfts8tmmfm.png"></p><a name="habracut"></a><br><p>  Il n'y aura pas de comparaison d√©taill√©e, consid√©rez les principales caract√©ristiques de tueur dans une situation o√π un programmeur junior / employ√© de bureau veut automatiser quelque chose li√© √† MS Office, et il a la possibilit√© de choisir entre les langues. </p><br><p>  Si, pour diverses raisons, il n'y a pas de choix, il n'y a rien √† comparer. </p><br><h2 id="v-polzu-vba">  En faveur de VBA </h2><br><p><img src="https://habrastorage.org/webt/24/en/7t/24en7tgsjs2fjinoerx18pjnlhw.png"></p><br><ul><li>  <strong>Excellent travail avec le mod√®le objet d'Excel et d'autres applications MS Office</strong> .  L'√©criture de code VBA pour la plupart des op√©rations internes est triviale.  En Python, par rapport √† VBA, la prise en charge du mod√®le d'objet Office est tr√®s faible. </li><li>  <strong>Prise en charge de divers formats de MS Office.</strong>  Le plus gros probl√®me pour les langues externes est de travailler avec diff√©rents formats de fichiers MS Office.  Par exemple, les fichiers xls, xlsx, xlsm peuvent n√©cessiter des biblioth√®ques diff√©rentes, car chacune ne fonctionne bien qu'avec son propre format de fichier.  Pour VBA, tout cela est un "fichier Excel" qui fonctionne aussi bien en g√©n√©ral. </li><li>  <strong>Travailler avec MS Exchange.</strong>  S'il est n√©cessaire de fournir du travail avec le courrier / calendrier d'entreprise sur Exchange, toutes les langues ne disposent pas d'une biblioth√®que normale pour travailler avec le protocole Exchange.  Dans VBA, cela est r√©solu relativement simplement gr√¢ce √† l'utilisation du mod√®le d'objet MS Outlook dans une macro. </li><li>  <strong>Installation et distribution faciles.</strong>  Il n'est pas n√©cessaire d'installer quoi que ce soit dans un bureau d√©j√† install√©.  Pour qu'un coll√®gue utilise le programme, il suffit de lui transf√©rer un fichier avec une macro.  Il est facile d'ajouter un compl√©ment qui vous permet ¬´d'installer¬ª un mod√®le de macro en arri√®re-plan du bureau. </li><li>  <strong>Interactivit√© dans les applications MS Office.</strong>  Dans les programmes de bureau, vous pouvez simplement mettre des boutons de lancement de macro et (un peu plus compliqu√©) cr√©er une interface utilisateur enti√®rement distincte.  Cela inclut √©galement l'√©criture de vos formules dans Excel et le fait que les macros peuvent affecter les objets dans les documents Office en temps r√©el. </li><li>  <strong>Enregistrement de macro.</strong>  Un outil pratique qui vous permet d'enregistrer les actions d'une personne dans le code fini, pour une utilisation d'√©dition ult√©rieure. </li></ul><br><h2 id="v-polzu-python-i-drugih-vneshnih-yazykov-programmirovaniya">  En faveur de Python (et d'autres langages de programmation externes) </h2><br><p><img src="https://habrastorage.org/webt/v_/em/lj/v_emljdiuncy8dk-xxzawv4eyq4.png"></p><br><ul><li>  <strong>Belle syntaxe et sucre syntaxique.</strong>  En bref, VBA n'est pas expressif et pratique.  C'est une question de go√ªt personnel, mais Python est beaucoup plus pratique pour moi. </li><li>  <strong>Un riche √©cosyst√®me de biblioth√®ques.</strong>  Une vaste s√©lection de biblioth√®ques pr√™tes √† l'emploi pour travailler avec le monde ext√©rieur.  Essayer de cr√©er un programme sur VBA qui interagit avec une API externe est toujours un probl√®me.  Il est int√©ressant de noter que juste pour travailler avec des fichiers Office de la biblioth√®que du m√™me Python - franchement "dans le C". </li><li>  <strong>De bons outils de d√©veloppement.</strong>  Vous pouvez choisir parmi une vaste s√©lection de programmes qui facilitent le processus de d√©veloppement.  L'√©diteur VBA standard d'Office offre des fonctionnalit√©s tr√®s m√©diocres et, par rapport aux alternatives du monde Python, est franchement g√™nant.  √âcrire du code VBA dans un √©diteur externe, puis le copier √† l'int√©rieur du bureau pour le d√©bogage, est √©galement g√™nant. </li><li>  <strong>Vitesse de travail.</strong>  Je n'ai pas v√©rifi√© la vitesse du travail monothread, mais je suppose que dans le cas du travail monothread, Python aura un avantage.  Dans tous les cas, le traitement multithread des donn√©es / fichiers est assez trivialement organis√©, ce qui vous permet de parler √† une vitesse plus √©lev√©e et r√©alisable. </li></ul><br><h2 id="keysy">  √âtuis </h2><br><p><img src="https://habrastorage.org/webt/xu/1t/yw/xu1tywsboyqon2cw3j8ivenwdqs.jpeg"></p><br><p>  Les t√¢ches suivantes sont des t√¢ches sp√©cifiques que j'ai moi-m√™me r√©solues ou automatis√©es, et lorsque j'ai d√ª choisir une pile: VBA ou Python.  Pour chaque t√¢che, la pile s√©lectionn√©e est indiqu√©e et des explications sont donn√©es pour expliquer pourquoi: </p><br><ul><li>  <strong>T√¢che: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un programme pour v√©rifier tous les fichiers Excel dans un r√©pertoire pour les feuilles cach√©es</a></strong> <br><ul><li>  Mon choix: <strong>VBA</strong> .  Motifs: simplicit√© de travail avec diff√©rents formats de fichiers Excel et absence d'interactions externes. </li></ul></li><li>  <strong>Objectif: Un service qui √©tait cens√© permettre √† un utilisateur de convertir des fichiers PowerPoint en PDF √† partir d'un appareil mobile pour les visualiser</strong> <br><ul><li>  Le service a √©t√© impl√©ment√© comme un bot de messagerie, √† l'adresse √† laquelle l'utilisateur peut envoyer des fichiers Office, et une r√©ponse avec des fichiers PDF est envoy√©e √† l'utilisateur par courrier. </li><li>  Mon choix: <strong>logique VBA + Python pour la surveillance</strong> <br><ul><li>  Premi√®rement, les fonctions internes sont garanties pour pr√©server un PDF authentique pour un fichier PowerPoint (les biblioth√®ques externes fonctionnent mal avec le rendu PowerPoint). </li><li>  Deuxi√®mement, l'impl√©mentation du bot de messagerie en tant que macro dans MS Outlook a r√©solu les probl√®mes de travail avec le courrier Exchange d'entreprise.  Donc, en Python, il n'y a pas de biblioth√®que normale pour travailler avec MS Exchange. </li><li>  Python a √©t√© utilis√© pour organiser la surveillance du service et la notification d'√©ventuels probl√®mes. </li></ul></li></ul></li><li>  <strong>T√¢che: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un programme pour combiner des fichiers Powerpoint avec "interlin√©aire" (texte du locuteur) dans un fichier d'impression</a></strong> <br><ul><li>  Mon choix: <strong>VBA</strong> .  Le probl√®me a √©t√© r√©solu en convertissant deux fichiers au format PDF et en les combinant avec Riffle Shuffle.  √âtant donn√© que la qualit√© de la conversion au format PDF est importante, les fonctions de bureau int√©gr√©es ont √©t√© utilis√©es pour exporter au format PDF. </li></ul></li><li>  <strong>T√¢che: √† partir d'une base de donn√©es d'entreprises du secteur sous forme de fiches, s√©parer les fichiers html qui doivent √™tre filtr√©s et combin√©s en 1 fichier Excel pour calculer un certain nombre d'indicateurs.</strong> <br><ul><li>  Mon choix: <strong>Python</strong> . <br><ul><li>  Pour extraire des donn√©es de cartes html, une biblioth√®que pour analyser html BeautifulSoup √©tait utile. </li><li>  Le programme cr√©e le fichier Excel, afin que nous puissions nous-m√™mes d√©cider quelles analyses y calculer, et lesquelles au stade de la pr√©paration des donn√©es en Python. </li></ul></li></ul></li><li>  <strong>T√¢che: traduire tout le texte d'une pr√©sentation PowerPoint dans une autre langue par un traducteur automatique</strong> <br><ul><li>  Mon choix: <strong>VBA</strong> .  Il √©tait important de travailler soigneusement avec le texte dans les objets internes du fichier PowerPoint.  L'API Yandex a √©t√© utilis√©e pour la traduction, car elle est gratuite pour les petits volumes et facile √† connecter.  Par exemple, je n'ai pas pu faire fonctionner l'API du traducteur Bing dans VBA, car j'ai besoin d'OAuth avec mes probl√®mes pour fonctionner.  Si je devais travailler avec Bing, je ferais probablement un interm√©diaire de service en Python. </li></ul></li><li>  <strong>T√¢che: pour des titres boursiers donn√©s, prendre des donn√©es de l'API avec des indicateurs financiers (l'API √©met un fichier CSV g√©n√©r√© √† la demande) et lire un certain nombre de r√©f√©rences pour l'analyse sur leur base</strong> <br><ul><li>  Mon choix: <strong>Python</strong> .  Bien que l'API soit simple (elle ne n√©cessite aucune signature de demandes ou d'autorisation) et g√©n√®re des donn√©es vers CSV, Python est s√©lectionn√©, car il n'y a aucune raison de choisir VBA, et il est plus pratique d'√©crire en Python. </li></ul></li><li>  <strong>T√¢che: maintenir une base d'instructions, envoyer des notifications aux artistes interpr√®tes ou ex√©cutants, g√©n√©rer un rapport pour l'impression</strong> <br><ul><li>  Ici, j'ai choisi pendant tr√®s longtemps, car il existe de nombreuses alternatives: <br><ul><li>  Syst√®me de commande pr√™t √† l'emploi tiers </li><li>  Base de donn√©es avec une sorte de gestionnaire </li><li>  Acc√®s </li><li>  Excel </li></ul></li><li>  Mon choix: <strong>VBA</strong> <br><ul><li>  Premi√®rement, Excel lui-m√™me est une interface utilisateur pr√™te √† l'emploi. </li><li>  Deuxi√®mement, VBA r√©sout le probl√®me de travailler avec Corporate Exchange via une connexion MS Outlook. </li><li>  Troisi√®mement, cette d√©cision a √©t√© prise en tenant compte des coll√®gues, qu'Excel √©tait plus clair que tout ce qui √©tait compl√®tement nouveau. </li></ul></li></ul></li></ul><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  J'esp√®re que pour quelqu'un, la note sera utile et permettra de gagner du temps sur le choix d'une pile pour r√©soudre leurs probl√®mes. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439898/">https://habr.com/ru/post/fr439898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439886/index.html">Comment j'ai enseign√© √† un r√©seau de neurones √† impl√©menter la fonction d'√©valuation de position lors du Russian AI Cup CodeBall 2018</a></li>
<li><a href="../fr439890/index.html">Les comp√©tences sont de 100% ou moins.</a></li>
<li><a href="../fr439892/index.html">Comment planifier pour un an. Etude de cas d'une entreprise informatique 120 personnes et deux cabinets pour petites √©quipes</a></li>
<li><a href="../fr439894/index.html">Comment contr√¥ler simplement l'√©tat du site</a></li>
<li><a href="../fr439896/index.html">√âthique des contributions automatiques</a></li>
<li><a href="../fr439900/index.html">Julia et la m√©thode de descente de coordonn√©es</a></li>
<li><a href="../fr439902/index.html">Explication de la nature physique du ph√©nom√®ne de ¬´Lift Force of the Wing¬ª sans utiliser l'√©quation de Bernoulli. 2e partie</a></li>
<li><a href="../fr439906/index.html">Vuln√©rabilit√© critique dans les produits antivirus Zemana et plus</a></li>
<li><a href="../fr439908/index.html">Kohl, merde ... Coaxial</a></li>
<li><a href="../fr439910/index.html">Le Digital Rights Center invite √† la Journ√©e de la confidentialit√© 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>