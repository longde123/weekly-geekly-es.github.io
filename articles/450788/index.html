<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤟🏽 👗 ♣️ Inyección de dependencia con DITranquillity 👩🏼‍💻 👦🏾 ✏️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La inyección de dependencias es un patrón bastante popular que le permite configurar de manera flexible el sistema y construir correctamente las depen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Inyección de dependencia con DITranquillity</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450788/"><p> La inyección de dependencias es un patrón bastante popular que le permite configurar de manera flexible el sistema y construir correctamente las dependencias de los componentes de este sistema entre sí.  Gracias a la escritura, Swift le permite usar marcos convenientes con los que puede describir muy brevemente el gráfico de dependencia.  Hoy quiero hablar un poco sobre uno de estos marcos: <code>DITranquillity</code> . </p><a name="habracut"></a><br><p>  Este tutorial cubrirá las siguientes características de la biblioteca: </p><br><ul><li>  Registro de tipo </li><li>  Implementación de inicialización </li><li>  Incrustar en una variable </li><li>  Dependencias cíclicas de los componentes. </li><li>  Usando la biblioteca con <code>UIStoryboard</code> </li></ul><br><h3 id="opisanie-komponentov">  Descripción del componente </h3><br><p>  La aplicación constará de los siguientes componentes principales: <code>ViewController</code> , <code>Router</code> , <code>Presenter</code> , <code>Networking</code> : estos son componentes bastante comunes en cualquier aplicación de iOS. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w-/pn/ro/w-pnroiey2c8xri9o3erqm9er_0.gif" alt="Estructura componente"></div><br><p>  <code>ViewController</code> y <code>Router</code> se introducirán entre sí cíclicamente. </p><br><h3 id="podgotovka">  Preparación </h3><br><p>  Primero, cree una aplicación de vista única en Xcode, agregue DITranquillity usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CocoaPods</a> .  Cree la jerarquía de archivos necesaria, luego agregue un segundo controlador a Main.storyboard y conéctelo usando <code>StoryboardSegue</code> .  Como resultado, se debe obtener la siguiente estructura de archivos: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jw/li/s8/jwlis8txyhuzn1m5swacqvrixe4.png" alt="Estructura de archivo"></div><br><p>  Cree dependencias en las clases de la siguiente manera: </p><br><div class="spoiler">  <b class="spoiler_title">Declaración de componente</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Int)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyPresenter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> networking: <span class="hljs-type"><span class="hljs-type">Networking</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(networking: <span class="hljs-type"><span class="hljs-type">Networking</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.networking = networking } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Int)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Networking</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Result&lt;Int, Error&gt;)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyNetworking</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Networking</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Result&lt;Int, Error&gt;)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Router</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentNewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyRouter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Router</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> viewController: <span class="hljs-type"><span class="hljs-type">ViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(viewController: <span class="hljs-type"><span class="hljs-type">ViewController</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewController = viewController } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentNewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> presenter: <span class="hljs-type"><span class="hljs-type">Presenter!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> router: <span class="hljs-type"><span class="hljs-type">Router!</span></span> }</code> </pre> </div></div><br><h4 id="ogranicheniya">  Limitaciones </h4><br><p>  A diferencia de otras clases, <code>ViewController</code> es creado no por nosotros, sino por la biblioteca UIKit dentro de la implementación <code>UIStoryboard.instantiateViewController</code> , por lo tanto, usando el guión gráfico, no podemos inyectar dependencias en los herederos del <code>UIViewController</code> usando el inicializador.  Así <code>UIView</code> con los herederos de <code>UIView</code> y <code>UITableViewCell</code> . </p><br><p>  Tenga en cuenta que los objetos ocultos detrás de los protocolos están integrados en todas las clases.  Esta es una de las tareas principales de implementar dependencias: hacer dependencias no de implementaciones, sino de interfaces.  Esto ayudará en el futuro a proporcionar diferentes implementaciones de protocolo para reutilizar o probar componentes. </p><br><h3 id="vnedrenie-zavisimostey">  Inyección de dependencia </h3><br><p>  Después de crear todos los componentes del sistema, procedemos a la conexión de objetos entre ellos.  En DITranquillity, el punto de partida es <code>DIContainer</code> , que agrega el registro utilizando el método <code>container.register(...)</code> .  Para separar las dependencias en partes, <code>DIPart</code> <code>DIFramework</code> y <code>DIPart</code> , que deben implementarse.  Por conveniencia, crearemos una sola clase de <code>ApplicationDependency</code> que implementará <code>DIFramework</code> y servirá como lugar de registro para todas las dependencias.  La interfaz <code>DIFramework</code> requiere que implemente solo un método: <code>load(container:)</code> . </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationDependency</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DIFramework</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container: DIContainer)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// registrations will be placed here } }</span></span></code> </pre> <br><p>  Comencemos con el registro más simple que no tiene dependencias - <code>MyNetworking</code> </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">MyNetworking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  Este registro utiliza la implementación a través del inicializador.  A pesar de que el componente en sí no tiene dependencias, se debe proporcionar el inicializador para que la biblioteca tenga claro cómo crear el componente. </p><br><p>  Del mismo modo, registre <code>MyPresenter</code> y <code>MyRouter</code> . </p><br><pre> <code class="swift hljs">container.register1(<span class="hljs-type"><span class="hljs-type">MyPresenter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) container.register1(<span class="hljs-type"><span class="hljs-type">MyRouter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  <strong>Nota:</strong> Tenga en cuenta que no se utiliza el <code>register1</code> , sino el <code>register1</code> .  Desafortunadamente, esto es necesario para indicar si el objeto tiene una y solo una dependencia en el inicializador.  Es decir, si hay 0 o dos o más dependencias, solo necesita usar el <code>register</code> .  Esta restricción es un error de Swift versión 4.0 y superior. </p><br><p>  Es hora de registrar nuestro <code>ViewController</code> .  Inyecta objetos no a través del inicializador, sino directamente en la variable, por lo que la descripción del registro resultará un poco más. </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">ViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(cycle: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, \.router) .injection(\.presenter)</code> </pre> <br><p>  La sintaxis del formulario <code>\.presenter</code> es SwiftKeyPath, gracias a la cual es posible implementar dependencias de manera concisa.  Dado que <code>Router</code> y <code>ViewController</code> dependen cíclicamente entre sí, debe indicarlo explícitamente usando <code>cycle: true</code> .  La biblioteca en sí misma puede resolver estas dependencias sin una indicación explícita, pero este requisito se introdujo para que la persona que lee el gráfico entendiera de inmediato que hay ciclos en la cadena de dependencia.  También tenga en cuenta que <strong>NO</strong> <code>ViewController.init</code> <code>ViewController.self</code> , <strong>sino</strong> <code>ViewController.self</code> .  Esto se describió anteriormente en la sección <em>Limitaciones</em> . </p><br><p>  También es necesario registrar el <code>UIStoryboard</code> usando un método especial. </p><br><pre> <code class="swift hljs">container.registerStoryboard(name: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>)</code> </pre> <br><p>  Ahora hemos descrito todo el gráfico de dependencia para una pantalla.  Pero todavía no hay acceso a este gráfico.  Debe crear un <code>DIContainer</code> que le permita acceder a los objetos que <code>DIContainer</code> . </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> container: <span class="hljs-type"><span class="hljs-type">DIContainer</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> container = <span class="hljs-type"><span class="hljs-type">DIContainer</span></span>() <span class="hljs-comment"><span class="hljs-comment">// 1 container.append(framework: ApplicationDependency.self) // 2 assert(container.validate(checkGraphCycles: true)) // 3 return container }()</span></span></code> </pre> <br><ol><li>  Inicializa el contenedor </li><li>  Agregue una descripción del gráfico. </li><li>  Verificamos que hicimos todo bien.  Si se comete un error, la aplicación se bloqueará no durante la resolución de dependencias, sino inmediatamente al crear un gráfico </li></ol><br><p>  Luego debe hacer que el contenedor sea el punto de partida de la aplicación.  Para hacer esto, implementamos el método <code>didFinishLaunchingWithOptions</code> en <code>didFinishLaunchingWithOptions</code> en lugar de especificar <code>Main.storyboard</code> como el punto de inicio en la configuración del proyecto. </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">]?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { window = <span class="hljs-type"><span class="hljs-type">UIWindow</span></span>(frame: <span class="hljs-type"><span class="hljs-type">UIScreen</span></span>.main.bounds) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> storyboard: <span class="hljs-type"><span class="hljs-type">UIStoryboard</span></span> = <span class="hljs-type"><span class="hljs-type">ApplicationDependency</span></span>.container.resolve() window?.rootViewController = storyboard.instantiateInitialViewController() window?.makeKeyAndVisible() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br><h3 id="zapusk">  Lanzamiento </h3><br><p>  En el primer inicio, se producirá una caída y la validación fallará por los siguientes motivos: </p><br><ul><li>  El contenedor no encontrará los tipos <code>Router</code> , <code>Presenter</code> , <code>Networking</code> , porque registramos solo objetos.  Si queremos dar acceso no a implementaciones, sino a interfaces, debemos especificar explícitamente las interfaces </li><li>  El contenedor no comprende cómo resolver la dependencia cíclica, porque es necesario indicar explícitamente qué objetos no deben recrearse cada vez que se resuelve el gráfico. </li></ul><br><p>  Es fácil corregir el primer error: hay un método especial que le permite especificar bajo qué protocolos está disponible el método en el contenedor. </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">MyNetworking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>(check: <span class="hljs-type"><span class="hljs-type">Networking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {$<span class="hljs-number"><span class="hljs-number">0</span></span>}</code> </pre> <br><p>  Al describir el registro de la siguiente manera, decimos: el objeto <code>MyNetworking</code> es accesible a través del protocolo de <code>Networking</code> .  Esto debe hacerse para todos los objetos ocultos bajo los protocolos.  <code>{$0}</code> agregamos para la verificación correcta de los tipos por parte del compilador. </p><br><p>  El segundo error es un poco más complicado.  Es necesario utilizar el llamado <code>scope</code> , que describe con qué frecuencia se crea el objeto y cuánto vive.  Para cada registro que participe en una dependencia circular, debe especificar un <code>scope</code> igual a <code>objectGraph</code> .  Esto dejará claro al contenedor que durante la resolución es necesario reutilizar los mismos objetos creados, en lugar de crear cada vez.  Por lo tanto, resulta: </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">ViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(cycle: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, \.router) .injection(\.presenter) .lifetime(.objectGraph) container.register1(<span class="hljs-type"><span class="hljs-type">MyRouter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>(check: <span class="hljs-type"><span class="hljs-type">Router</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {$<span class="hljs-number"><span class="hljs-number">0</span></span>} .lifetime(.objectGraph)</code> </pre> <br><p>  Después de reiniciar, el contenedor pasa la validación con éxito y nuestro ViewController se abre con las dependencias creadas.  Puede poner un punto de interrupción en <code>viewDidLoad</code> y asegurarse. </p><br><h3 id="perehod-mezhdu-ekranami">  Transición entre pantallas </h3><br><p>  A continuación, cree dos clases pequeñas, <code>SecondViewController</code> y <code>SecondPresenter</code> , agregue <code>SecondViewController</code> al guión gráfico y cree un <code>Segue</code> entre ellas con el identificador <code>"RouteToSecond"</code> , que le permite abrir el segundo controlador desde el primero. </p><br><p>  Agregue dos registros más a nuestra <code>ApplicationDependency</code> para cada una de las nuevas clases: </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">SecondViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(\.secondPresenter) container.register(<span class="hljs-type"><span class="hljs-type">SecondPresenter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  <code>.as</code> necesario especificar <code>.as</code> , porque no <code>SecondPresenter</code> detrás del protocolo, sino que utilizamos la implementación directamente.  Luego, en el método <code>viewDidAppear</code> del primer controlador, llamamos a <code>performSegue(withIdentifier: "RouteToSecond", sender: self)</code> , start, se abre el segundo controlador, en el que debe fijarse la dependencia <code>secondPresenter</code> .  Como puede ver, el contenedor vio la creación de un segundo controlador desde <code>UIStoryboard</code> y <code>UIStoryboard</code> éxito las dependencias. </p><br><h3 id="zaklyuchenie">  Conclusión </h3><br><p>  Esta biblioteca le permite trabajar convenientemente con dependencias cíclicas, guiones gráficos y utiliza completamente la inferencia de tipos automática en Swift, que proporciona una sintaxis muy corta y flexible para describir el gráfico de dependencia. </p><br><h4 id="ssylki">  Referencias </h4><br><p>  Código de muestra completo en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">biblioteca github</a> </p><br><p>  DITranquillity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en github</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Artículo en inglés</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/450788/">https://habr.com/ru/post/450788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450776/index.html">¡Feliz día de radio y comunicación! Postal corta sobre</a></li>
<li><a href="../450780/index.html">Simplicidad ciega</a></li>
<li><a href="../450782/index.html">La pseudoaleatoriedad nos ayudará: una selección de herramientas para generar activos para el juego</a></li>
<li><a href="../450784/index.html">¿Cómo gestiona Netflix a sus espectadores tan bien?</a></li>
<li><a href="../450786/index.html">Diferencias entre fluido y gettext</a></li>
<li><a href="../450790/index.html">Hidrogel, arándanos y una pizca de cúrcuma: sistema vascular artificial</a></li>
<li><a href="../450794/index.html">La elección es malvada</a></li>
<li><a href="../450796/index.html">Cómo Tesla enseña al piloto automático</a></li>
<li><a href="../450798/index.html">Aprendizaje automático en el desarrollo móvil: perspectivas y descentralización</a></li>
<li><a href="../450800/index.html">Desarrollo de microservicios con BDD e IOD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>