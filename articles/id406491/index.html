<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•µğŸ¿ ğŸ¤°ğŸ¾ ğŸ´ Kami memompa interkom dengan protokol MQTT untuk mengontrol dari telepon ğŸš ğŸš« ğŸš´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Saya akan ceritakan sedikit tentang interworking terakhir saya - penyelesaian interkom dengan modul WiFi NodeMCU. Saya minta maaf sebel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami memompa interkom dengan protokol MQTT untuk mengontrol dari telepon</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/406491/"><img src="https://habrastorage.org/web/4da/a19/2c9/4daa192c94284fc7b405761187ed7caa.JPG" align="left" width="350">  Halo semuanya.  Saya akan ceritakan sedikit tentang interworking terakhir saya - penyelesaian interkom dengan modul WiFi NodeMCU.  Saya minta maaf sebelumnya untuk pilihan modul - semua orang mungkin sudah mendapatkan ESP'shka ini ... <br><br>  Tentu saja, kerja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ClusterM dengan mesin penjawabnya</a> tidak dapat dilampaui oleh siapa pun, tetapi saya menganggap fungsi ini tidak perlu.  Dengan kelahiran putri saya, saya hanya perlu membuka interkom secara diam-diam untuk para tamu agar tidak berdiri di handset dan tidak menunggu panggilan masuk yang mungkin akan membangunkan yang kecil.  Ya, dan kadang-kadang lebih mudah bagi Anda untuk membuka pintu dari telepon daripada memanjat kunci dan meletakkan tablet bolak-balik agar berfungsi (panel saya di pintu masuk sangat membosankan).  Proyek itu ternyata kecil, jadi artikelnya juga tidak punya banyak surat, tapi ada foto. <br><a name="habracut"></a><br>  <b>Besi</b> <br><br>  Saya memiliki beberapa modul NodeMCU yang tersedia, jadi, setelah mendorongnya ke handset interkom, saya memutuskan untuk memasangnya tanpa masalah, saya hanya perlu membuat kartu ekspansi.  Saya selalu berkembang biak di EagleCad, saya memesan papan baik dari Cina atau dari Taman OSH Amerika.  Lebih murah di OSH Park jika area papannya kecil, tetapi Anda hanya mendapatkan 3 papan, bukan 10 bahasa Cina, tetapi untuk proyek sepotong tidak masalah.  Relai PE014005 berdiri dengan sempurna di papan, tepat di antara pin NodeMCU. <br><br><img src="https://habrastorage.org/web/1bc/779/1cd/1bc7791cd723414f9c3251651962d14a.JPG"><br><br>  Bukan pilihan termurah, tapi saya punya mereka dalam stok.  Jadi Anda dapat menempatkan bahasa Mandarin termurah, HUI KE misalnya (ini bukan kutukan, ini adalah perusahaan - mereka memiliki serangkaian gulungan HK4100F).  Saya juga menggunakan dua optocoupler 4N35S, satu di input - untuk menangkap panggilan masuk, yang kedua di penutupan tombol doorphone terbuka. <br><br>  Sirkuit dan topologi papan yang dihasilkan di sini (semuanya ada di repositori, tautan di akhir artikel): <br><br><img src="https://habrastorage.org/web/0c0/7e7/b71/0c07e7b711094570b5538256cda4ba58.jpg"><br><br><img src="https://habrastorage.org/web/e29/13c/344/e2913c3442c8411c89839bab96cb0112.jpg"><br><br>  Papan dari produksi. <br><br><img src="https://habrastorage.org/web/3e2/b2d/370/3e2b2d370eac485182a3188201729774.JPG"><br><br>  <b>Beberapa foto</b> <br><br><img src="https://habrastorage.org/web/479/66c/b8d/47966cb8d69a4c7eb06314555cb4c60e.jpg"><br><br><img src="https://habrastorage.org/web/32e/d3f/b99/32ed3fb9947d479f8365dc963aacab27.JPG"><br><br><img src="https://habrastorage.org/web/356/569/5f5/3565695f54a54098993294df1df5ffc9.JPG"><br><br>  <b>Deskripsi tabung</b> <br><br>  Pertama, sedikit pada prinsip tabung itu sendiri - Saya punya Digital KL-2.  Berikut adalah diagram dari situs resmi. <br><br><img src="https://habrastorage.org/web/7b1/fdd/96c/7b1fdd96c1394734b67b6e4df3b5ffc8.jpg"><br><br>  Pada diagram: <b>1,2</b> - kontak yang menghubungkan saluran interkom (memiliki polaritas, jika ada yang tidak tahu);  <b>SW2</b> - saklar suara tabung (di bawah - suara mati, di atas - suara menyala);  <b>SW1</b> - tuas tabung pengeras suara (di bawah - gagang gagang telepon, di atas - gagang telepon lepas);  <b>SB1</b> - tombol untuk membuka pintu;  <b>BA1</b> - tabung speaker;  <b>BM1</b> - mikrofon tabung, <b>HL1</b> - LED. <br><br>  Ketika panel akses membuat panggilan, amplitudo berliku-liku dari <b>12V</b> memasuki saluran.  Resistansi dalam garis harus <b>50 Ohm</b> , dalam hal lain, kesalahan akan ditampilkan pada panel.  Jika sakelar <b>SW2</b> berada di posisi bawah (suara pada handset mati), maka resistor <b>50 Ohm</b> terhubung ke saluran - LED akan berkedip, tetapi kami tidak akan mendengar suara.  Jika sakelar <b>SW2 ada</b> di posisi atas (suara menyala), dan sakelar <b>SW1 ada</b> di posisi bawah (handset hang), maka impedansi speaker <b>BA1</b> masih sama <b>50 Ohm</b> , cukup berliku-liku memukulnya dan kami mendengar suaranya.  Setelah mengangkat handset, <b>SW1</b> beralih ke posisi atas dan satu output speaker terlepas dari tanah, sekarang akan ada sinyal bicara analog dan volume yang dapat diterima untuk telinga, daripada panggilan untuk seratus desibel.  Jika Anda memutuskan untuk membuka pintu untuk tamu, maka tekan tombol <b>SB1</b> , yang mengunci transistor dan hambatan pada saluran meningkat tajam - sehingga panel mengerti bahwa perlu untuk membuka pintu. <br><br>  <b>Sekarang tentang perbaikan</b> <br><br><img src="https://habrastorage.org/webt/59/d4/a7/59d4a70ca4c6b561220490.jpeg"><br><br>  <b>Relay1</b> - kami mengambil kontrol suara pada diri kami (kami menganggap bahwa saklar asli tabung <b>SW2 berada</b> di posisi atas, jika tidak akan ada bubur);  <b>Input</b> - optocoupler berkedut selama panggilan (terhubung sebelum <b>Relay1</b> untuk melihat panggilan dalam mode diam);  <b>Relay2</b> - mensimulasikan penghapusan tabung;  <b>Buka</b> - menutup tombol untuk membuka pintu.  Saya menarik perhatian Anda pada kenyataan bahwa gulungan disolder oleh kontak yang biasanya tertutup ke dalam celah.  Ini berarti bahwa setiap saat Anda dapat memutuskan interkom dari jaringan (jika tiba-tiba lampu padam atau Internet menghilang) dan itu akan tetap beroperasi, ini penting. <br><br>  <b>Firmware</b> <br><br>  Saya menulis firmware di PlatformIO (plug-in untuk editor Atom) di perpustakaan Arduino.  Tautkan ke repositori di akhir artikel.  Ini, dengan izin Anda, IDE akan lebih nyaman daripada Arduino asli - siapa pun yang belum mencobanya, pastikan untuk mencobanya.  Sebagai klien MQTT di telepon, IoTmanager digunakan (selanjutnya - hanya klien).  Saya tidak akan memberi tahu banyak tentang program (mereka yang ingin melihat kode), saya hanya akan menjelaskan apa yang dia tahu: <br><br><ul><li>  terhubung ke broker MQTT </li><li>  mempublikasikan topik dengan pengaturan untuk klien </li><li>  berlangganan topik untuk reaksi beralih di klien </li><li>  mengirim pemberitahuan push ke telepon saat ada panggilan masuk </li><li>  mempublikasikan pengaturan yang diubah pada panggilan (untuk melihat status di klien) </li><li>  membisukan interkom atas perintah klien </li><li>  buka pintu satu kali </li><li>  buka beberapa kali tanpa batas </li><li>  tutup telepon saja </li></ul><br>  <b>Formulir layar aplikasi</b> (dapat diklik) <br><br> <a href=""><img src="https://habrastorage.org/web/d4f/be6/958/d4fbe695884946f79b763df887f443fe.jpg"></a> <br><br>  Fitur dari program IoTmanager adalah bahwa semua pengaturan disimpan dalam topik, dan hanya menampilkan apa yang dipublikasikan.  Arti protokol MQTT yang ringan sedikit hilang, tapi saya suka implementasi ini.  Jika diinginkan, Anda dapat mengulanginya untuk klien MQTT lain. <br><br>  Tentu saja, semua ini (dan bahkan dengan dua relay elektromekanis) memerlukan daya eksternal dan saya akan berpikir tentang kemanfaatan pesawat, jika saya perlu memulai daya 5V dari outlet ... Tapi saya memiliki meter di dalam apartemen, dan interkomnya menggantung sangat dekat.  Saya baru saja memesan modul din rail 220AC / 5VDC pada Ali dan menyalakan interkom darinya.  Dalam foto itu terbalik untuk kenyamanan pemasangan internal. <br><br><img src="https://habrastorage.org/web/ffc/9ca/5d7/ffc9ca5d711048b7a0d27d6e9fa5c173.JPG"><br><br>  Terima kasih atas perhatiannya.  Saya mengundang Anda untuk berkomentar. <br><br>  <b>Versi kedua perangkat dikembangkan, yang saya bicarakan di sini</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Modifikasi interkom dengan protokol MQTT untuk kontrol dari telepon (versi 2.0)</a> . <br><br>  <b>Tautan yang bermanfaat:</b> <br><br>  1. <a href="">Repositori proyek ini di GitHub</a> - ada diagram, kabel, kode sumber. <br>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membuat interkom pintar dengan mesin penjawab dan koneksi Internet</a> adalah artikel oleh Kamerad ClusterM yang disebutkan di awal. <br>  3. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagaimana saya menghubungkan interkom Vizit ke mqtt</a> - interkom dengan Arduino dan Ethernet shield. <br>  4. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Esp8266 Kontrol internet melalui protokol MQTT</a> - artikel tentang MQTT dan ESP8266. <br>  5. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Remote control intercom</a> - artikel lain tentang topik tersebut. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id406491/">https://habr.com/ru/post/id406491/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id406473/index.html">50 warna tunggul *. Mikrokontroler dalam mengalihkan catu daya. Bagian 3</a></li>
<li><a href="../id406475/index.html">Para ilmuwan telah mengembangkan arsitektur untuk robot humanoid terbang</a></li>
<li><a href="../id406481/index.html">Di dekat pusat Bimasakti ditemukan lubang hitam supermasif</a></li>
<li><a href="../id406483/index.html">China Today: kacamata tidak lagi nnnada</a></li>
<li><a href="../id406487/index.html">Pertemuan yang tidak terduga. Bab 13</a></li>
<li><a href="../id406493/index.html">Evolusi jam tangan: teknologi apa yang telah mengajari mereka</a></li>
<li><a href="../id406495/index.html">[KASUS] Mencetak 3D dalam arsitektur menggunakan Setl City sebagai contoh</a></li>
<li><a href="../id406497/index.html">MOBA</a></li>
<li><a href="../id406499/index.html">IFA 2017: Panduan Berita Lenovo & Motorola</a></li>
<li><a href="../id406501/index.html">Durov berbicara tentang upaya FBI untuk mendapatkan akses ke data pengguna Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>