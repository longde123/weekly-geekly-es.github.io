<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§πüèΩ üèáüèæ ‚û∞ Programando com PyUSB 1.0 üßëüèø üîÜ üë®‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do tradutor : 
 Esta √© uma tradu√ß√£o do manual Programming with PyUSB 1.0 
 Este guia foi escrito pelos desenvolvedores do PyUSB, mas rapidamente execu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programando com PyUSB 1.0</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430528/">  <i><b>Do tradutor</b> :</i> <i><br></i>  <i>Esta √© uma tradu√ß√£o do <a href="">manual Programming with PyUSB 1.0</a></i> <i><br></i>  <i>Este guia foi escrito pelos desenvolvedores do PyUSB, mas rapidamente executando os commits, acredito que walac √© o autor principal.</i> <br><br><h2>  Deixe-me me apresentar </h2><br>  <b>PyUSB 1.0</b> √© uma biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Python</a> que fornece f√°cil acesso ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">USB</a> .  O PyUSB fornece v√°rias fun√ß√µes: <br><br><ul><li>  <i><b>100% escrito em Python:</b></i> <br>  Diferentemente das vers√µes 0.x que foram escritas em C, a vers√£o 1.0 √© escrita em Python.  Isso permite que programadores Python sem experi√™ncia em C entendam melhor como o PyUSB funciona. </li><li> <i><b>Neutralidade da plataforma:</b></i> <br>  A vers√£o 1.0 inclui um esquema de back-end de front-end.  Ele isola a API dos detalhes de implementa√ß√£o espec√≠ficos do sistema.  A interface do <u>IBackend</u> conecta essas duas camadas.  O PyUSB vem com backends internos para o libusb 0.1, libusb 1.0 e OpenUSB.  Voc√™ pode escrever seu back-end, se quiser. </li><li>  <i><b>Portabilidade:</b></i> <br>  O PyUSB deve ser executado em qualquer plataforma com Python&gt; = 2.4, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ctypes</a> e pelo menos um dos back-ends internos suportados. </li><li>  <i><b>Simplicidade:</b></i> <br>  A intera√ß√£o com um dispositivo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">USB</a> nunca foi t√£o f√°cil!  O USB √© um protocolo complexo e o PyUSB possui boas predefini√ß√µes para as configura√ß√µes mais comuns. </li><li>  <i><b>Suporte de engrenagem is√≥crona:</b></i> <br>  O PyUSB suporta transfer√™ncias is√≥cronas se o back-end subjacente as suportar. </li></ul><br>  Embora o PyUSB torne a programa√ß√£o USB menos dolorosa, este tutorial pressup√µe que voc√™ tenha um conhecimento m√≠nimo do protocolo USB.  Se voc√™ n√£o sabe nada sobre USB, recomendo <b>o excelente</b> livro <b>USB Complete de</b> Jan Axelson. <br><a name="habracut"></a><br><h2>  Chega de conversa, vamos escrever o c√≥digo! </h2><br><h3>  Quem √© quem </h3><br>  Para come√ßar, vamos dar uma descri√ß√£o dos m√≥dulos PyUSB.  Todos os m√≥dulos PyUSB est√£o sob <u>usb</u> , com os seguintes m√≥dulos: <br><table><tbody><tr><th>  M√≥dulo </th><th>  Descri√ß√£o do produto </th></tr><tr><td>  n√∫cleo </td><td>  O principal m√≥dulo USB. </td></tr><tr><td>  util </td><td>  Fun√ß√µes auxiliares. </td></tr><tr><td>  controlar </td><td>  Solicita√ß√µes de gerenciamento padr√£o. </td></tr><tr><td>  legado </td><td>  Camada de compatibilidade da vers√£o 0.x. </td></tr><tr><td>  back-end </td><td>  Um subpacote contendo back-end internos. </td></tr></tbody></table><br>  Por exemplo, para importar um m√≥dulo <u>principal</u> , digite o seguinte: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core &gt;&gt;&gt; dev = usb.core.find()</code> </pre> <br><h3>  Bem, vamos come√ßar </h3><br>  A seguir, um programa simples que envia a string 'test' para a primeira fonte de dados encontrada (ponto de extremidade OUT): <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util <span class="hljs-comment"><span class="hljs-comment">#    dev = usb.core.find(idVendor=0xfffe, idProduct=0x0001) #   ? if dev is None: raise ValueError('Device not found') #   .  ,   #    dev.set_configuration() #    cfg = dev.get_active_configuration() intf = cfg[(0,0)] ep = usb.util.find_descriptor( intf, #     custom_match = \ lambda e: \ usb.util.endpoint_direction(e.bEndpointAddress) == \ usb.util.ENDPOINT_OUT) assert ep is not None #   ep.write('test')</span></span></code> </pre><br>  As duas primeiras linhas importam os m√≥dulos do pacote PyUSB.  <u>usb.core</u> √© o m√≥dulo principal e <u>usb.util</u> cont√©m fun√ß√µes auxiliares.  O comando a seguir procura nosso dispositivo e retorna uma inst√¢ncia do objeto, se encontrar.  Caso contr√°rio, retorna <u>Nenhum</u> .  Em seguida, definimos a configura√ß√£o que usaremos.  Nota: a aus√™ncia de argumentos significa que a configura√ß√£o desejada foi definida por padr√£o.  Como voc√™ ver√°, muitos recursos do PyUSB t√™m configura√ß√µes padr√£o para os dispositivos mais comuns.  Nesse caso, a primeira configura√ß√£o encontrada √© definida. <br><br>  Em seguida, procuramos o ponto final no qual estamos interessados.  Estamos procurando dentro da primeira interface que temos.  Depois de encontrarmos esse ponto, enviamos dados para ele. <br><br>  Se soubermos o endere√ßo do terminal com anteced√™ncia, podemos simplesmente chamar a fun√ß√£o de <u>grava√ß√£o</u> do objeto do dispositivo: <br><br><pre> <code class="python hljs">dev.write(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>)</code> </pre><br>  Aqui, escrevemos a string 'test' no ponto de interrup√ß√£o no endere√ßo <i>1</i> .  Todas essas fun√ß√µes ser√£o discutidas melhor nas se√ß√µes a seguir. <br><br><h3>  O que est√° errado? </h3><br>  Cada fun√ß√£o no PyUSB lan√ßa uma exce√ß√£o em caso de erro.  Al√©m das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exce√ß√µes padr√£o do Python</a> , o PyUSB define <u>usb.core.USBError</u> para erros relacionados ao USB. <br><br>  Voc√™ tamb√©m pode usar as fun√ß√µes de log do PyUSB.  Ele usa o m√≥dulo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">log</a> .  Para us√°-lo, defina a <u>vari√°vel de</u> ambiente <u>PYUSB_DEBUG</u> com um dos seguintes n√≠veis de log: <u>cr√≠tico</u> , <u>erro</u> , <u>aviso</u> , <u>informa√ß√µes</u> ou <u>depura√ß√£o</u> . <br><br>  Por padr√£o, as mensagens s√£o enviadas para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sys.stderr</a> .  Se desejar, voc√™ pode redirecionar as mensagens de log para um arquivo, definindo a vari√°vel de ambiente <u>PYUSB_LOG_FILENAME</u> .  Se o seu valor for o caminho correto para o arquivo, as mensagens ser√£o gravadas nele, caso contr√°rio, ser√£o enviadas para <u>sys.stderr</u> . <br><br><h3>  Onde voce esta </h3><br>  A fun√ß√£o <u>find ()</u> no m√≥dulo <u>principal</u> √© usada para localizar e numerar dispositivos conectados ao sistema.  Por exemplo, digamos que nosso dispositivo tenha um ID de fornecedor com o valor 0xfffe e um ID de produto 0x0001.  Se precisarmos encontrar este dispositivo, faremos o seguinte: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core dev = usb.core.find(idVendor=<span class="hljs-number"><span class="hljs-number">0xfffe</span></span>, idProduct=<span class="hljs-number"><span class="hljs-number">0x0001</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dev <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> ValueError(<span class="hljs-string"><span class="hljs-string">'Our device is not connected'</span></span>)</code> </pre><br>  Isso √© tudo, a fun√ß√£o retornar√° o objeto <u>usb.core.Device</u> que representa nosso dispositivo.  Se o dispositivo n√£o for encontrado, ele retornar√° <u>Nenhum</u> .  De fato, voc√™ pode usar qualquer campo da classe do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Descritor de</a> Dispositivos que desejar.  Por exemplo, e se quisermos descobrir se h√° uma impressora USB conectada ao sistema?  √â muito f√°cil: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      ,   if usb.core.find(bDeviceClass=7) is None: raise ValueError('No printer found')</span></span></code> </pre><br>  7 √© o c√≥digo para a classe de impressora de acordo com a especifica√ß√£o USB.  Ah, espere, e se eu quiser numerar todas as impressoras dispon√≠veis?  N√£o tem problema: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     ... printers = usb.core.find(find_all=True, bDeviceClass=7) # Python 2, Python 3,     import sys sys.stdout.write('There are ' + len(printers) + ' in the system\n.')</span></span></code> </pre><br>  O que aconteceu  Bem, √© hora de uma pequena explica√ß√£o ... O <u>find</u> tem um par√¢metro chamado <u>find_all</u> e o padr√£o √© False.  Quando √© falso <a name="orig1"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[1]</a> , o <u>find</u> retornar√° o primeiro dispositivo que corresponder aos crit√©rios especificados (falaremos sobre isso em breve).  Se voc√™ passar um valor <i>verdadeiro</i> para o par√¢metro, o <u>find</u> retornar√° uma lista de todos os dispositivos que correspondem aos crit√©rios.  Isso √© tudo!  Simples, certo? <br><br>  N√≥s terminamos?  N√£o!  Ainda n√£o contei tudo: muitos dispositivos colocam suas informa√ß√µes de classe no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descritor de</a> interface, em vez de no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descritor</a> de dispositivos.  Portanto, para encontrar realmente todas as impressoras conectadas ao sistema, precisaremos passar por todas as configura√ß√µes, assim como todas as interfaces, e verificar se uma delas est√° definida como bInterfaceClass 7. Se voc√™ √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">programador</a> como eu, pode se perguntar: existe alguma maneira mais f√°cil com a qual isso pode ser implementado.  Resposta: sim, ele √©.  Para come√ßar, vejamos o c√≥digo pronto para encontrar todas as impressoras conectadas: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_class</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, class_)</span></span></span><span class="hljs-function">:</span></span> self._class = class_ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, device)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#  ,   if device.bDeviceClass == self._class: return True # ,   ,   # ,     for cfg in device: # find_descriptor:  ? intf = usb.util.find_descriptor( cfg, bInterfaceClass=self._class ) if intf is not None: return True return False printers = usb.core.find(find_all=1, custom_match=find_class(7))</span></span></code> </pre><br>  O par√¢metro <u>custom_match</u> aceita qualquer objeto chamado que recebe o objeto do dispositivo.  Ele deve retornar verdadeiro para um dispositivo adequado e falso para um inapropriado.  Voc√™ tamb√©m pode combinar <u>custom_match</u> com os campos do dispositivo, se desejar: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,    : printers = usb.core.find(find_all=1, custom_match=find_class(7), idVendor=0xfffe)</span></span></code> </pre><br>  Aqui estamos interessados ‚Äã‚Äãnas impressoras do fornecedor 0xfffe. <br><br><h3>  Descreva-se </h3><br>  Ok, encontramos nosso dispositivo, mas antes de interagir com ele, gostar√≠amos de saber mais sobre ele.  Bem, voc√™ sabe, configura√ß√µes, interfaces, terminais, tipos de fluxos de dados ... <br>  Se voc√™ tiver um dispositivo, poder√° acessar qualquer campo do descritor de dispositivo como propriedades do objeto: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.bLength &gt;&gt;&gt; dev.bNumConfigurations &gt;&gt;&gt; dev.bDeviceClass &gt;&gt;&gt; <span class="hljs-comment"><span class="hljs-comment"># ...</span></span></code> </pre><br>  Para acessar as configura√ß√µes dispon√≠veis no dispositivo, voc√™ pode iterar o dispositivo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cfg <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev: sys.stdout.write(str(cfg.bConfigurationValue) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre><br>  Da mesma maneira, voc√™ pode iterar a configura√ß√£o para acessar as interfaces, bem como iterar as interfaces para acessar seus pontos de controle.  Cada tipo de objeto possui campos do descritor correspondente como atributos.  Veja um exemplo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cfg <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev: sys.stdout.write(str(cfg.bConfigurationValue) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> intf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cfg: sys.stdout.write(<span class="hljs-string"><span class="hljs-string">'\t'</span></span> + \ str(intf.bInterfaceNumber) + \ <span class="hljs-string"><span class="hljs-string">','</span></span> + \ str(intf.bAlternateSetting) + \ <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ep <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> intf: sys.stdout.write(<span class="hljs-string"><span class="hljs-string">'\t\t'</span></span> + \ str(ep.bEndpointAddress) + \ <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre><br>  Voc√™ tamb√©m pode usar √≠ndices para acesso aleat√≥rio aos descritores, como aqui: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt;&gt; cfg = dev[1] &gt;&gt;&gt; #      &gt;&gt;&gt; intf = cfg[(0,0)] &gt;&gt;&gt; #    &gt;&gt;&gt; ep = intf[2]</span></span></code> </pre><br>  Como voc√™ pode ver, os √≠ndices s√£o contados a partir de 0. Mas espere!  H√° algo de estranho na maneira como obtenho acesso √† interface ... Sim, voc√™ est√° certo, o √≠ndice para Configura√ß√£o usa uma s√©rie de dois valores, dos quais o primeiro √© o √≠ndice da Interface e o segundo √© uma configura√ß√£o alternativa.  Em geral, para acessar a primeira interface, mas com a segunda configura√ß√£o, escreveremos <u>cfg [(0,1)]</u> . <br><br>  Agora √© a hora de aprender uma maneira poderosa de procurar descritores - uma fun√ß√£o √∫til <u>find_descriptor</u> .  J√° vimos isso no exemplo de pesquisa da impressora.  <u>O find_descriptor</u> funciona quase da mesma forma que o <u>find</u> , com duas exce√ß√µes: <br><br><ul><li>  <u>O find_descriptor</u> recebe como primeiro par√¢metro o descritor de origem que voc√™ pesquisar√°. </li><li>  N√£o h√° par√¢metro de <u>back-end</u> nele <a name="orig2"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[2]</a> </li></ul><br>  Por exemplo, se tivermos um descritor de configura√ß√£o <u>cfg</u> e desejarmos encontrar todas as configura√ß√µes alternativas para a interface 1, faremos isso: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util alt = usb.util.find_descriptor(cfg, find_all=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, bInterfaceNumber=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  Observe que o <u>find_descriptor</u> est√° no m√≥dulo <u>usb.util</u> .  Ele tamb√©m aceita o par√¢metro <u>custom_match</u> descrito anteriormente. <br><br>  <b>Lidamos com v√°rios dispositivos id√™nticos</b> <br><br>  √Äs vezes, voc√™ pode ter dois dispositivos id√™nticos conectados ao computador.  Como voc√™ pode distinguir entre eles?  <u>Os</u> objetos de <u>dispositivo</u> v√™m com dois atributos adicionais que n√£o fazem parte da especifica√ß√£o USB, mas s√£o muito √∫teis: os atributos de <u>barramento</u> e <u>endere√ßo</u> .  Antes de tudo, vale a pena dizer que esses atributos s√£o provenientes do back-end, e o back-end pode n√£o suport√°-los - nesse caso, eles est√£o definidos como <u>Nenhum</u> .  No entanto, esses atributos representam o n√∫mero e o endere√ßo do barramento do dispositivo e, como voc√™ deve ter adivinhado, podem ser usados ‚Äã‚Äãpara distinguir entre dois dispositivos com os mesmos valores de atributo <u>idVendor</u> e <u>idProduct</u> . <br><br><h3>  Como devo trabalhar? </h3><br>  Ap√≥s a conex√£o, os dispositivos USB devem ser configurados usando algumas consultas padr√£o.  Quando comecei a estudar a especifica√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">USB</a> , fiquei desanimado com os descritores, configura√ß√µes, interfaces, configura√ß√µes alternativas, tipos de transfer√™ncia e tudo mais ... E o pior de tudo, voc√™ n√£o pode simplesmente ignor√°-las: o dispositivo n√£o funciona sem definir a configura√ß√£o, mesmo que seja uma!  O PyUSB est√° tentando tornar sua vida o mais simples poss√≠vel.  Por exemplo, depois de receber o objeto do seu dispositivo, antes de tudo, antes de interagir com ele, voc√™ precisa enviar uma solicita√ß√£o de <u>configura√ß√£o_configura√ß√£o</u> .  O par√¢metro de configura√ß√£o para esta consulta que lhe interessa √© <u>bConfigurationValue</u> .  A maioria dos dispositivos n√£o tem mais de uma configura√ß√£o, e o rastreamento do valor da configura√ß√£o a ser usado √© irritante (embora a maior parte do c√≥digo que eu vi tenha codificado isso).  Portanto, no PyUSB, voc√™ pode simplesmente enviar uma solicita√ß√£o <u>set_configuration</u> sem argumentos.  Nesse caso, ele instalar√° a primeira configura√ß√£o encontrada (se o seu dispositivo tiver apenas uma, voc√™ n√£o precisar√° se preocupar com o valor da configura√ß√£o).  Por exemplo, suponha que voc√™ tenha um dispositivo com um descritor de configura√ß√£o e seu campo bConfigurationValue seja 5 <a name="orig3"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[3]</a> , as consultas subsequentes funcionar√£o da mesma maneira: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.set_configuration(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  &gt;&gt;&gt; dev.set_configuration() #  ,   5 -  #  &gt;&gt;&gt; cfg = util.find_descriptor(dev, bConfigurationValue=5) &gt;&gt;&gt; cfg.set() #  &gt;&gt;&gt; cfg = util.find_descriptor(dev, bConfigurationValue=5) &gt;&gt;&gt; dev.set_configuration(cfg)</span></span></code> </pre><br>  Uau!  Voc√™ pode usar o objeto <u>Configuration</u> como um par√¢metro para <u>set_configuration</u> !  Sim, ele tamb√©m possui um m√©todo <u>definido</u> para se configurar na configura√ß√£o atual. <br><br>  Outra op√ß√£o que voc√™ precisa ou n√£o precisa configurar √© a op√ß√£o de alterar interfaces.  Cada dispositivo pode ter apenas uma configura√ß√£o ativada por vez, e cada configura√ß√£o pode ter mais de uma interface e voc√™ pode usar todas as interfaces ao mesmo tempo.  Voc√™ entende melhor esse conceito se pensar na interface como um dispositivo l√≥gico.  Por exemplo, vamos imaginar uma impressora multifuncional, que ao mesmo tempo √© uma impressora e um scanner.  Para n√£o complicar (ou pelo menos torn√°-lo o mais simples poss√≠vel), vamos supor que ele tenha apenas uma configura√ß√£o.  Porque  temos uma impressora e um scanner, a configura√ß√£o possui 2 interfaces: uma para a impressora e outra para o scanner.  Um dispositivo com mais de uma interface √© chamado de dispositivo composto.  Quando voc√™ conecta sua impressora multifuncional ao computador, o sistema operacional carrega dois drivers diferentes: um para cada dispositivo perif√©rico ‚Äúl√≥gico‚Äù que voc√™ possui <a name="orig4"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[4]</a> <br><br>  E as configura√ß√µes de interface alternativas?  Que bom que voc√™ perguntou.  Uma interface possui uma ou mais configura√ß√µes alternativas.  Uma interface com apenas uma configura√ß√£o alternativa √© considerada sem configura√ß√µes alternativas <a name="orig5"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[5]</a>  Configura√ß√µes alternativas para interfaces como uma configura√ß√£o para dispositivos, ou seja, para cada interface, voc√™ pode ter apenas uma configura√ß√£o alternativa ativa.  Por exemplo, a especifica√ß√£o USB sugere que um dispositivo n√£o pode ter um ponto de verifica√ß√£o is√≥crono em sua configura√ß√£o alternativa prim√°ria <a name="orig6"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[6]</a> , para que o dispositivo de streaming tenha pelo menos duas configura√ß√µes alternativas, com uma segunda configura√ß√£o com um ponto de verifica√ß√£o is√≥crono.  Por√©m, diferentemente das configura√ß√µes, as interfaces com apenas uma configura√ß√£o alternativa n√£o precisam ser configuradas <a name="orig7"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[7]</a>  Voc√™ seleciona uma configura√ß√£o de interface alternativa usando a fun√ß√£o <u>set_interface_altsetting</u> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.set_interface_altsetting(interface = <span class="hljs-number"><span class="hljs-number">0</span></span>, alternate_setting = <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br>  <b>Advert√™ncia</b> <br><br>  A especifica√ß√£o USB diz que o dispositivo pode retornar um erro se receber uma solicita√ß√£o SET_INTERFACE para uma interface que n√£o possui configura√ß√µes alternativas adicionais.  Portanto, se voc√™ n√£o tiver certeza de que a interface possui mais de uma configura√ß√£o alternativa ou se aceita a solicita√ß√£o SET_INTERFACE, o m√©todo mais seguro √© chamar <u>set_interface_altsetting</u> dentro do bloco try-except, como aqui: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: dev.set_interface_altsetting(...) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> USBError: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Voc√™ tamb√©m pode usar o objeto <u>Interface</u> como um par√¢metro de fun√ß√£o, os par√¢metros <u>interface</u> e <u>alternate_setting</u> s√£o herdados automaticamente dos <u>campos bInterfaceNumber</u> e <u>bAlternateSetting</u> .  Um exemplo: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>intf = find_descriptor(...) &gt;&gt;&gt; dev.set_interface_altsetting(intf) &gt;&gt;&gt; intf.set_altsetting() <span class="hljs-comment"><span class="hljs-comment"># !       </span></span></code> </pre><br>  <b>Advert√™ncia</b> <br><br>  O objeto <u>Interface</u> deve pertencer ao descritor de configura√ß√£o ativo. <br><br><h3>  Fale comigo querida </h3><br>  E agora √© hora de entender como interagir com dispositivos USB.  O USB possui quatro tipos de fluxos de dados: transfer√™ncia em massa, transfer√™ncia por interrup√ß√£o, transfer√™ncia is√≥crona e transfer√™ncia de controle.  N√£o pretendo explicar o objetivo de cada segmento e as diferen√ßas entre eles.  Portanto, presumo que voc√™ tenha pelo menos conhecimento b√°sico de fluxos de dados USB. <br><br>  O fluxo de dados de controle √© o √∫nico fluxo cuja estrutura √© descrita na especifica√ß√£o; o restante simplesmente envia e recebe dados brutos do ponto de vista USB.  Portanto, voc√™ tem v√°rias fun√ß√µes para trabalhar com fluxos de controle e o restante dos fluxos √© processado pelas mesmas fun√ß√µes. <br><br>  Voc√™ pode acessar o fluxo de dados de controle usando o m√©todo <u>ctrl_transfer</u> .  √â usado para fluxos de sa√≠da (OUT) e de entrada (IN).  A dire√ß√£o do fluxo √© determinada pelo par√¢metro <u>bmRequestType</u> . <br><br>  Os par√¢metros <u>ctrl_transfer</u> quase coincidem com a estrutura da solicita√ß√£o de controle.  A seguir, √© apresentado um exemplo de como organizar um fluxo de dados de controle. <a name="orig8"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[8]</a> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>msg = <span class="hljs-string"><span class="hljs-string">'test'</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> dev.ctrl_transfer(<span class="hljs-number"><span class="hljs-number">0x40</span></span>, CTRL_LOOPBACK_WRITE, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, msg) == len(msg) &gt;&gt;&gt; ret = dev.ctrl_transfer(<span class="hljs-number"><span class="hljs-number">0xC0</span></span>, CTRL_LOOPBACK_READ, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, len(msg)) &gt;&gt;&gt; sret = <span class="hljs-string"><span class="hljs-string">''</span></span>.join([chr(x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ret]) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sret == msg</code> </pre><br>  Este exemplo assume que nosso dispositivo inclui duas solicita√ß√µes de controle de usu√°rio que agem como um pipe de loopback.  O que voc√™ escreve com a mensagem <u>CTRL_LOOPBACK_WRITE</u> , pode ler com a mensagem <u>CTRL_LOOPBACK_READ</u> . <br><br>  Os quatro primeiros par√¢metros - <u>bmRequestType</u> , <u>bmRequest</u> , <u>wValue</u> e <u>wIndex</u> - s√£o os campos da estrutura padr√£o do fluxo de controle.  O quinto par√¢metro √© os dados que est√£o sendo transferidos para o fluxo de dados de sa√≠da ou o n√∫mero de dados que est√£o sendo lidos no fluxo de entrada.  Os dados transmitidos podem ser qualquer tipo de sequ√™ncia, que pode ser alimentada como par√¢metro para a entrada do m√©todo <u>__init__</u> para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">matriz</a> .  Se n√£o houver dados sendo transferidos, o par√¢metro dever√° ser definido como <u>Nenhum</u> (ou 0 no caso de um fluxo de dados de entrada).  H√° outro par√¢metro opcional indicando o tempo limite da opera√ß√£o.  Se voc√™ n√£o passar, o tempo limite padr√£o ser√° usado (mais sobre isso mais tarde).  No fluxo de dados de sa√≠da, o valor retornado √© o n√∫mero de bytes realmente enviados ao dispositivo.  No fluxo de entrada, o valor de retorno √© uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">matriz</a> com os dados lidos. <br><br>  Para outros fluxos, voc√™ pode usar os m√©todos de <u>grava√ß√£o</u> e <u>leitura</u> , respectivamente, para gravar e ler dados.  Voc√™ n√£o precisa se preocupar com o tipo de fluxo - ele √© detectado automaticamente pelo endere√ßo do ponto de verifica√ß√£o.  Aqui est√° nosso exemplo de loopback, desde que tenhamos um canal de loopback no ponto de interrup√ß√£o 1: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>msg = <span class="hljs-string"><span class="hljs-string">'test'</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> len(dev.write(<span class="hljs-number"><span class="hljs-number">1</span></span>, msg, <span class="hljs-number"><span class="hljs-number">100</span></span>)) == len(msg) &gt;&gt;&gt; ret = dev.read(<span class="hljs-number"><span class="hljs-number">0x81</span></span>, len(msg), <span class="hljs-number"><span class="hljs-number">100</span></span>) &gt;&gt;&gt; sret = <span class="hljs-string"><span class="hljs-string">''</span></span>.join([chr(x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ret]) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sret == msg</code> </pre><br>  O primeiro e o terceiro par√¢metros s√£o os mesmos para os dois m√©todos - este √© o endere√ßo do ponto de verifica√ß√£o e o tempo limite, respectivamente.  O segundo par√¢metro s√£o os dados transmitidos (grava√ß√£o) ou o n√∫mero de bytes a serem lidos (lidos).  Os dados retornados ser√£o uma inst√¢ncia de um objeto de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">matriz</a> para o m√©todo de <u>leitura</u> ou o n√∫mero de bytes gravados para o m√©todo de <u>grava√ß√£o</u> . <br><br>  <u>Nas</u> vers√µes beta 2, em vez do n√∫mero de bytes, voc√™ pode passar para <u>read</u> ou <u>ctrl_transfer</u> um objeto de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">matriz</a> no qual os dados ser√£o lidos.  Nesse caso, o n√∫mero de bytes a serem lidos ser√° o comprimento da matriz vezes o valor de <u>array.itemsize</u> . <br><br>  No <u>ctrl_transfer</u> , o par√¢metro <u>timeout</u> √© opcional.  Quando o <u>tempo limite √©</u> omitido, a propriedade <u>Device.default_timeout</u> √© <u>usada</u> como tempo limite operacional. <br><br><h3>  Controle-se </h3><br>  Al√©m das fun√ß√µes de <u>fluxo de</u> dados, o m√≥dulo <u>usb.control</u> fornece fun√ß√µes que incluem solicita√ß√µes de controle USB padr√£o e o m√≥dulo <u>usb.util</u> possui uma conveniente fun√ß√£o <u>get_string que</u> exibe especificamente os descritores de linha. <br><br><h2>  T√≥picos adicionais </h2><br><h3>  Por tr√°s de toda grande abstra√ß√£o h√° uma grande realiza√ß√£o </h3><br>  Anteriormente, havia apenas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">libusb</a> .  Depois veio o libusb 1.0 e tivemos o libusb 0.1 e 1.0.  Depois disso, criamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenUSB</a> e agora moramos na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Torre de Babel da</a> Biblioteca USB <a name="orig9"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[9]</a>  Como o PyUSB lida com isso?  Bem, PyUSB √© uma biblioteca democr√°tica, voc√™ pode escolher qual biblioteca deseja.  De fato, voc√™ pode escrever sua pr√≥pria biblioteca USB do zero e pedir ao PyUSB para us√°-la. <br><br>  A fun√ß√£o <u>find</u> possui outro par√¢metro, sobre o qual n√£o falei.  Este √© o par√¢metro de <u>back</u> - <u>end</u> .  Se voc√™ n√£o transferi-lo, um dos back-ends internos ser√° usado.  Um back-end √© um objeto herdado de <u>usb.backend.IBackend</u> , respons√°vel pela introdu√ß√£o de lixo USB espec√≠fico do sistema operacional.  Como voc√™ deve ter adivinhado, o libusb 0.1 embutido, o libusb 1.0 e o OpenUSB s√£o back-end. <br><br>  Voc√™ pode escrever seu pr√≥prio back-end e us√°-lo.  Apenas herde do <u>IBackend</u> e ative os m√©todos necess√°rios.  Pode ser necess√°rio consultar a documenta√ß√£o do <u>usb.backend</u> para entender como isso √© feito. <br><br><h3>  N√£o seja ego√≠sta </h3><br>  Python tem o que chamamos de <i>gerenciamento autom√°tico de mem√≥ria</i> .  Isso significa que a m√°quina virtual decidir√° quando descarregar objetos da mem√≥ria.  Sob o cap√¥, o PyUSB gerencia todos os recursos de baixo n√≠vel com os quais voc√™ precisa trabalhar (aprova√ß√£o da interface, ajuste do dispositivo etc.) e a maioria dos usu√°rios n√£o precisa se preocupar com isso.  Por√©m, devido √† natureza indefinida da destrui√ß√£o autom√°tica de objetos pelo Python, os usu√°rios n√£o podem prever quando os recursos alocados ser√£o liberados.  Alguns aplicativos precisam alocar e liberar recursos deterministicamente.  Para tais aplicativos, o m√≥dulo <u>usb.util</u> fornece fun√ß√µes para interagir com o gerenciamento de recursos. <br><br>  Se voc√™ desejar solicitar e liberar interfaces manualmente, poder√° usar as <u>fun√ß√µes</u> <u>claim_interface</u> e <u>release_interface</u> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A fun√ß√£o </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Claim_interface</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> solicitar√° a interface especificada se o dispositivo ainda n√£o o fez. Se o dispositivo j√° solicitou uma interface, ele n√£o faz nada. Apenas </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">release_interface</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vai lan√ßar a interface especificada, se for solicitado. Se a interface n√£o for solicitada, ela n√£o far√° nada. Voc√™ pode usar a consulta manual da interface para resolver o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">problema de sele√ß√£o de configura√ß√£o</font></a><font style="vertical-align: inherit;"> descrito na documenta√ß√£o do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Se voc√™ quiser liberar todos os recursos alocados pelo objeto do dispositivo (incluindo as interfaces solicitadas), poder√° usar a fun√ß√£o </font><u><font style="vertical-align: inherit;">dispose_resources</font></u></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ele libera todos os recursos alocados e coloca o objeto do dispositivo (mas n√£o no hardware do pr√≥prio dispositivo) no estado em que foi retornado ap√≥s o uso da fun√ß√£o </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Defini√ß√£o manual da biblioteca </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, um back-end √© um inv√≥lucro de uma biblioteca compartilhada que implementa uma API para acessar o USB. Por padr√£o, o back-end usa a </font><font style="vertical-align: inherit;">fun√ß√£o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ctypes </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find_library ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No Linux e outros sistemas operacionais do tipo Unix, o </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find_library</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tenta executar programas externos (como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sbin / ldconfig</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objdump</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) para localizar o arquivo da biblioteca. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nos sistemas em que esses programas est√£o ausentes e / ou o cache da biblioteca est√° desativado, esta fun√ß√£o n√£o pode ser usada. Para superar as limita√ß√µes, o PyUSB permite enviar a fun√ß√£o personalizada find_library () para o back-end. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um exemplo desse cen√°rio seria:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.backend.libusb1 &gt;&gt;&gt; &gt;&gt;&gt; backend = usb.backend.libusb1.get_backend(find_library=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: <span class="hljs-string"><span class="hljs-string">"/usr/lib/libusb-1.0.so"</span></span>) &gt;&gt;&gt; dev = usb.core.find(..., backend=backend)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Observe que find_library √© um argumento para a fun√ß√£o get_backend () na qual voc√™ fornece a fun√ß√£o respons√°vel por encontrar a biblioteca certa para o back-end. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Regras da velha escola </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ estiver escrevendo um aplicativo usando as antigas APIs do PyUSB (0. alguma coisa l√°), pode estar se perguntando se precisa atualizar seu c√≥digo para usar a nova API. </font><font style="vertical-align: inherit;">Bem, voc√™ deve faz√™-lo, mas n√£o √© necess√°rio. </font><font style="vertical-align: inherit;">O PyUSB 1.0 vem com o </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m√≥dulo de</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compatibilidade </font><u><font style="vertical-align: inherit;">usb.legacy</font></u><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Inclui a API antiga com base na nova API. </font><font style="vertical-align: inherit;">‚ÄúBem, devo substituir minha linha de </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importa√ß√£o usb</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">import usb.legacy como usb</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para fazer meu aplicativo funcionar?‚Äù, Voc√™ pergunta. </font><font style="vertical-align: inherit;">A resposta √© sim, funcionar√°, mas n√£o √© necess√°rio. </font><font style="vertical-align: inherit;">Se voc√™ executar o aplicativo sem altera√ß√µes, ele funcionar√° porque a linha de </font><font style="vertical-align: inherit;">importa√ß√£o </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usb</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> importa todos os s√≠mbolos p√∫blicos de </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usb.legacy</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Se voc√™ encontrar um problema - provavelmente voc√™ encontrou um bug.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Me ajude por favor </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se precisar de ajuda, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o me escreva um e-mail</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , h√° uma lista de </font><b><font style="vertical-align: inherit;">e-mails</font></b><font style="vertical-align: inherit;"> para isso. </font><font style="vertical-align: inherit;">As instru√ß√µes de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inscri√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> podem ser encontradas no site do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">PyUSB</font></a><font style="vertical-align: inherit;"> .</font></font><br><br><a name="prim"></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Quando escrevo True ou False (com letra mai√∫scula), quero dizer os valores correspondentes da linguagem Python. E quando digo verdadeiro (verdadeiro) ou falso (falso), quero dizer qualquer express√£o Python que seja considerada verdadeira ou falsa. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Essa semelhan√ßa ocorreu no original e ajuda a entender os conceitos de verdadeiro e falso na tradu√ß√£o. - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Consulte a documenta√ß√£o espec√≠fica do back-end. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A especifica√ß√£o USB n√£o imp√µe nenhum valor espec√≠fico ao valor da configura√ß√£o. O mesmo vale para n√∫meros de interface e configura√ß√µes alternativas. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Na verdade, tudo √© um pouco mais complicado, mas isso √© apenas uma explica√ß√£o para n√≥s. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[5]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eu sei que isso parece estranho.</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Isso ocorre porque, se n√£o houver largura de banda para fluxos de dados is√≥cronos durante a configura√ß√£o do dispositivo, ele poder√° ser numerado com sucesso. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[7]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Isso n√£o acontece na configura√ß√£o porque o dispositivo pode estar em um estado n√£o configurado. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[8]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No PyUSB, os fluxos de dados de controle acessam o ponto de controle 0. Muito, muito, muito raramente, um dispositivo possui um ponto de controle de controle alternativo (nunca conheci esse dispositivo). </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[9]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Isso √© apenas uma piada, n√£o leve a s√©rio. </font><font style="vertical-align: inherit;">√ìtimas op√ß√µes s√£o melhores que nenhuma escolha.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt430528/">https://habr.com/ru/post/pt430528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt430518/index.html">Como renderizar o quadro da Terra M√©dia: Sombra de Mordor</a></li>
<li><a href="../pt430520/index.html">Apresentando o Spring Data MongoDB</a></li>
<li><a href="../pt430522/index.html">Voc√™ precisa de uma cultura corporativa em TI? Confiss√£o do gerente de marca do est√∫dio Krasnodar Plarium</a></li>
<li><a href="../pt430524/index.html">Arquitetura de rede neural</a></li>
<li><a href="../pt430526/index.html">M√°quinas ca√ßa-n√≠queis: de onde eles vieram na URSS e como est√£o organizados</a></li>
<li><a href="../pt430530/index.html">Servidor simulado para automa√ß√£o de teste m√≥vel</a></li>
<li><a href="../pt430532/index.html">Seguran√ßa em aplicativos iOS</a></li>
<li><a href="../pt430534/index.html">Criando um modelo para o Zabbix usando o DVR Trassir SDK como exemplo</a></li>
<li><a href="../pt430536/index.html">Projetar fun√ß√µes da janela resumidas em uma unidade com um determinado n√≠vel de sobreposi√ß√£o</a></li>
<li><a href="../pt430538/index.html">Voc√™ l√™ o Scaladoc para m√©todos de coleta "√≥bvios"? Ou por que a pregui√ßa nem sempre √© boa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>