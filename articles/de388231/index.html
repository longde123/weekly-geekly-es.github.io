<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✌🏿 🕗 👨🏼‍✈️ MQTT-Protokoll und MQTT öffnen Client-Projekt auf Delphi 🍯 👡 🤚🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das MQTT- Protokoll wird für Nachrichten im Internet der Dinge verwendet. Erstens ist es interessant, weil es von den größten Anbietern von Cloud-Dien...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MQTT-Protokoll und MQTT öffnen Client-Projekt auf Delphi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/388231/"><img align="left" src="https://habrastorage.org/files/335/d26/6d4/335d266d4c4943fcb2b3dd3c3aec0cef.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MQTT-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Protokoll </font><font style="vertical-align: inherit;">wird für Nachrichten im Internet der Dinge verwendet. </font><font style="vertical-align: inherit;">Erstens ist es interessant, weil es von den größten Anbietern von Cloud-Diensten wie IBM, Microsoft und Amazon unterstützt wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie können kostenlos ein Konto bei diesen Diensten einrichten, dort einen Dienst zum Empfangen von MQTT-Nachrichten einrichten und über diese Dienste die Lebensdauer Ihrer Geräte überwachen, z. B. in einem Smart Home. </font><font style="vertical-align: inherit;">Über diese Dienste können Geräte auch miteinander kommunizieren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Demonstration der Clientverbindung zum MQTT-Service der IBM Bluemix-Cloud ist enthalten.</font></font><br>
<br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kurzbeschreibung.</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MQTT ist äußerst primitiv: Mit einem kurzen Header ohne Integritätskontrolle werden Struktur, Codierung oder Datenschema nicht eingeschränkt. </font><font style="vertical-align: inherit;">Die einzige Datenanforderung in jedem Paket besteht darin, dass sie von einer Kennung für den Informationskanal begleitet werden müssen. </font><font style="vertical-align: inherit;">Diese Kennung in der Spezifikation wird als Themenname oder als einfacheres Thema bezeichnet. </font><font style="vertical-align: inherit;">Daten werden über TCP an Pakete übertragen. </font><font style="vertical-align: inherit;">Die Datenmenge in einem Paket kann zwischen einem Byte und 268.435.455 Byte liegen. </font><font style="vertical-align: inherit;">Sehr flexibel! </font><font style="vertical-align: inherit;">Obwohl öffentliche Cloud-Dienste strengere Beschränkungen auferlegen, bis zu mehreren Kilobyte.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das MQTT-Protokoll erfordert einen Datenbroker. </font><font style="vertical-align: inherit;">Dies ist die zentrale Idee der Technologie. </font><font style="vertical-align: inherit;">Alle Geräte senden nur Daten an den Broker und empfangen auch nur Daten von ihm. </font><font style="vertical-align: inherit;">Ein Broker ist ein Programm, das als TCP-Server mit einer dynamischen Datenbank fungiert.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Insbesondere die Broker-Datenbank enthält eine Tabelle mit allen empfangenen Paketen mit Indizierung nach Themen dieser Pakete. </font><font style="vertical-align: inherit;">Nach Erhalt des Pakets sendet der Broker es entsprechend seinem Abonnement an alle Geräte im Netzwerk. </font><font style="vertical-align: inherit;">Damit das Gerät etwas vom Broker erhält, muss es das Thema abonnieren. </font><font style="vertical-align: inherit;">Themen entstehen dynamisch beim Abonnement oder beim Eintreffen eines Pakets mit diesem Thema. </font><font style="vertical-align: inherit;">Sie können sich auch vom Thema abmelden. </font><font style="vertical-align: inherit;">Themen sind daher ein praktischer Mechanismus zum Organisieren von Beziehungen verschiedener Art: eins zu viele, viele zu eins und viele zu viele. </font><font style="vertical-align: inherit;">Wenn das Paket keinen Abonnenten hat, wird es verworfen. </font><font style="vertical-align: inherit;">Wenn der Abonnent nicht verbunden ist, wird das Paket entweder sofort in der Datenbank des Brokers gelöscht oder es wartet darauf, dass der Abonnent für eine in der Konfiguration angegebene Zeit eine Verbindung herstellt. </font><font style="vertical-align: inherit;">Das Verhalten wird durch das QoS-Attribut des Pakets bestimmt.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist hier noch wichtig?</font></font></h1> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Geräte stellen als erste den Kontakt zu einem Broker her. Das heißt, Geräte befinden sich möglicherweise hinter NATs (Network Address Translators) und haben möglicherweise keine statischen IP-Adressen. Dies beeinträchtigt die Kommunikation nicht. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• SSL kann zum Verschlüsseln des Datenverkehrs verwendet werden. Sie können jedoch auch mit IBM Services ohne SSL arbeiten, was das Debuggen erleichtert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• In äußerst schwierigen Fällen können Sie mit MQTT-Brokern über das WebSocket-Protokoll an Port 80 eine Verbindung zu ihnen herstellen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Der Port des Standard-MQTT-Protokolls kann auch beliebig geändert werden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Sowohl der Client / die Clients mit einer grafischen Benutzeroberfläche als auch der Broker können sich auf demselben Computer befinden. Das heißt, Die Lösung kann absolut lokal sein und mit einem Klick auf global skaliert werden.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Verschiedene Broker können sich miteinander verbinden, indem sie Nachrichten voneinander abonnieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• Das Themenkonzept passt gut zur NoSQL-Datenbanktechnologie. </font><font style="vertical-align: inherit;">Aus dem gleichen Grund ermutigen Cloud-Dienste Benutzer, die JSON-Datencodierung zu verwenden.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projekte öffnen</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Auswahl an MQTT-Brokern ist ziemlich groß. Seltsamerweise gibt es unter Windows praktisch keine praktischen Clients mit einer Windows-Benutzeroberfläche. Und ein Kunde wie dieser zur Beherrschung des MQTT-Protokolls ist einfach notwendig, da es viele praktische Nuancen der Arbeit der Makler gibt, die über die Spezifikationen hinausgehen, und alle müssen irgendwie untersucht und getestet werden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wurde beschlossen, den MQTT-Client auf Delphi zu implementieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google for Delphi kann nur die TMQTTClient-Komponente anbieten. Dies ist jedoch eine alte und nicht funktionierende Komponente. Die meisten anderen in Java, Erlang, Haskell und Javscript in Delphi geschriebenen Clients sind sehr schwer zu integrieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fand das einzig geeignete Projekt - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Geschrieben in reinem C-i. </font><font style="vertical-align: inherit;">Es wird für verschiedene Betriebssysteme kompiliert. </font><font style="vertical-align: inherit;">Es verfügt über Projektgenerierungsskripte für Visual Studio. </font><font style="vertical-align: inherit;">Beim Beenden unter Windows erhalten wir DLL-Dateien mit der Implementierung von Client- und Broker-Funktionen. </font><font style="vertical-align: inherit;">Die Verwendung von C ist in Bezug auf die Geschwindigkeit ermutigend. </font><font style="vertical-align: inherit;">In C geschriebene dynamische Bibliotheken lassen sich problemlos mit Delphi-Programmen verbinden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delphi selbst, vertreten durch Embarcadero RAD Studio XE8, ist ein sehr leistungsfähiges Tool zum Erstellen flexibler und praktischer Benutzeroberflächen für Windows, insbesondere wenn es mit DevExpress, TeeChart, RxLib, FireDAC usw. ausgestattet ist.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notwendige Werkzeuge</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir benötigen die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS Visual Studio 2015-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entwicklungsumgebung </font><font style="vertical-align: inherit;">. Es wird das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Projekt </font><font style="vertical-align: inherit;">und alle unterstützenden Projekte zusammenstellen, von denen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abhängt </font><font style="vertical-align: inherit;">. Alternativ kann </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cygwin-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket kompiliert werden </font><font style="vertical-align: inherit;">, Visual Studio schien jedoch praktischer zu sein. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um Visual Studio-Projektdateien zu generieren, müssen Sie das </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmake-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstprogramm herunterladen und installieren </font><font style="vertical-align: inherit;">. Quelle </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmake.org</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Und natürlich benötigen Sie </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAD Studio XE8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Darüber hinaus muss RAD Studio installiert sein Paket von Komponenten </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevExpress VCL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spätere Version </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.2.2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Obwohl dies nicht von grundlegender Bedeutung ist, kann das Design der Benutzeroberfläche für Standard-RAD Studio-Komponenten problemlos neu erstellt werden.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verfahren zur Softwareinstallation</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mosquitto hängt von mehreren Projekten von </font><b><font style="vertical-align: inherit;">Drittanbietern ab</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dies sind: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
• </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL v 1.0.2e</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Quelle - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://slproweb.com/download/Win32OpenSSL-1_0_2e.exe</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
• </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pthreads v 2.9.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Quelle - </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ftp://sourceware.org/pub/pthreads-win32/pthreads-w32-2-9-1-release.zip</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
• </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Libwebsockets v 1.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Quelle - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/warmcat/libwebsockets</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Laden Sie diese Projekte herunter. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kompilieren </font><b><font style="vertical-align: inherit;">OpenSSL nicht</font></b><font style="vertical-align: inherit;"> , sondern nehmen sofort die beiden erforderlichen Dateien von dort: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libeay32.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssleay32.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verzeichnis </font><font style="vertical-align: inherit;">. Es kommt häufig vor, dass sie bereits aus anderen Projekten auf dem Computer installiert sind. Dies muss überprüft werden. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pthreads</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir kompilieren auch nicht, sondern nehmen die bereits kompilierte Datei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pthreadVC2.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aus dem Verzeichnis </font><b><font style="vertical-align: inherit;">dll </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ x86</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Libwebsockets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wird ohne vorkompilierte Dateien und ohne Projekt für Visual Studio </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geliefert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , verfügt jedoch über eine Konfigurationsdatei </font><b><font style="vertical-align: inherit;">CMakeLists.txt</font></b><font style="vertical-align: inherit;"> . In diesem Fall </font><font style="vertical-align: inherit;">generieren </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem Dienstprogramm </font><b><font style="vertical-align: inherit;">Cmake</font></b><font style="vertical-align: inherit;"> die Visual Studio-Projektdatei in einem separaten Verzeichnis (libwebsockets_VS_proj-Verzeichnis). Öffnen Sie anschließend die generierte Projektdatei in Visual Studio, das wir kompilieren. Wir </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erhalten die</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font><b><font style="vertical-align: inherit;">websockets.dll, die</font></b><font style="vertical-align: inherit;"> wir </font><b><font style="vertical-align: inherit;">benötigen</font></b><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach allen vorherigen Schritten können Sie das </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Mosquitto-</font></a><font style="vertical-align: inherit;"> Projekt kompilieren</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Hier müssen Sie auch zuerst die Visual Studio-Projektdatei (Mosquitto_VS_proj-Verzeichnis) aus der angehängten Konfigurationsdatei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMakeLists.txt generieren</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Das generierte Projekt funktioniert nicht ganz. Sie müssen die Pfade zu einigen externen Header-Dateien und -Bibliotheken ändern, einige Makros in das Projekt aufnehmen und den Quellcode etwas ändern. Als Ergebnis erhalten wir die Datei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Einfachheit halber sind alle Dateien und die Verzeichnisstruktur mit den genannten Projekten in der Archivdatei enthalten, die dem Artikel beigefügt ist. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusammen mit der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clientbibliothek erhalten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wir beim </font><font style="vertical-align: inherit;">Kompilieren des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Mosquitto-</font></a><font style="vertical-align: inherit;"> Projekts </font><font style="vertical-align: inherit;">die ausführbare Datei des MQTT-Brokers - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit erhalten wir sofort sowohl den Kunden als auch den MQTT-Broker, d.h. </font><font style="vertical-align: inherit;">Fast alles, was Sie brauchen, um ein effektives Internet der Dinge zu organisieren.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen eines MQTT-Client-Projekts in Delphi</font></font></h1><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Bibliothek </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Delphi zu integrieren, müssen </font><b><font style="vertical-align: inherit;">Sie</font></b><font style="vertical-align: inherit;"> ein Modul für </font><font style="vertical-align: inherit;">Bibliotheksfunktionsdeklarationen in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object Pascal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> erstellen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Um dies zu tun, wird die Datei Konvertierung durchgeführt wurde </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MOSQUITTO.PAS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Client-Projekt ist sehr einfach und besteht aus nur 4 Quelldateien. </font><font style="vertical-align: inherit;">Der Client zeigt die Verbindung und Trennung, die Bildung des Willen ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Will</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), Datenpaket - </font><font style="vertical-align: inherit;">Sende </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLISH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> broker, Empfangen von </font><font style="vertical-align: inherit;">Datenpaketen </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLISH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von einem Broker - </font><font style="vertical-align: inherit;">Abonnement und Abmelden.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Programm speichert alle Verbindungsattribute, auf die sich der Begriff Profil bezieht, in der auf der Festplatte gespeicherten Profiltabelle. </font><font style="vertical-align: inherit;">Die Protokolle der empfangenen und gesendeten </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLISH-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pakete werden ebenfalls separat auf der Festplatte gespeichert </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kundennutzungsmethode</font></font></h1><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Führen Sie die Datei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMQTTC.exe aus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um jemanden zu haben , </font><font style="vertical-align: inherit;">den Testlauf Broker Team zu kommunizieren </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Run_mosquitto.cmd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im Verzeichnis </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto_1_4_5_bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Der Broker ist so konfiguriert, dass eine Verbindung ohne </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und Kennwortüberprüfung hergestellt werden kann. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Füllen Sie die Felder wie im Screenshot aus. </font></font><br>
<br>
<img width="1000" src="https://habrastorage.org/files/6df/303/805/6df303805cb246feb6acc16236e0277a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passwort und Benutzername sind optional. Klicken Sie im Navigator auf die Schaltfläche Festschreiben, um die Daten in der Tabelle zu speichern. Klicken Sie dann auf die Schaltfläche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verbinden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Verbindung werden Veröffentlichungs- und Abonnementbefehle verfügbar. Befehle </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PING</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Client </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> generiert automatisch.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit der Client etwas erhält, sollten Sie das Programm </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMQTTC.exe erneut</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit einer anderen Client- </font><b><font style="vertical-align: inherit;">ID ausführen</font></b><font style="vertical-align: inherit;"> und einen Client abonnieren, um Daten von einem anderen zu empfangen.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie eine Verbindung zu IBM Bluemix her</font></font></h1><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das erste, was Sie tun müssen, ist, ein Konto in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix zu erstellen.</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Nachdem Sie ein Konto erhalten haben, gehen wir zu unserem Control Panel auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hier müssen Sie sofort in die Region </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Süd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font><b><font style="vertical-align: inherit;">USA</font></b><font style="vertical-align: inherit;"> wechseln </font><font style="vertical-align: inherit;">. Klicken Sie dazu auf das Kontosymbol in der oberen rechten Ecke und ändern Sie den Wert im Feld </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Region</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Insgesamt gibt es drei Regionen, aber der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Süden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> der </font><b><font style="vertical-align: inherit;">USA</font></b><font style="vertical-align: inherit;"> bietet die Möglichkeit, die meisten Dienstleistungen zu nutzen. Erstellen Sie als Nächstes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Space</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Der Bildschirm sollte unten wie ein Crinshot aussehen. Hier werden die Organisation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INDEMSYS</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Space </font></font></b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INDEMSYS SPACE erstellt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<img width="800" src="https://habrastorage.org/files/e8e/a9d/daf/e8ea9ddaf89c47b299f6766b5012948c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Klicken Sie nun </font><font style="vertical-align: inherit;">im oberen Menü </font><font style="vertical-align: inherit;">auf </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KATALOG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wir gehen nach unten und wählen</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet der Dinge-Stiftung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<img width="800" src="https://habrastorage.org/files/b34/edd/4d1/b34edd4d15b848cb9a70d5b53a218538.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir ändern die vorgeschlagenen Felder nicht standardmäßig und klicken auf </font><b><font style="vertical-align: inherit;">Internet of Things Foundation </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erstellen.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies ist ein Dienst, der den </font><b><font style="vertical-align: inherit;">MQTT-</font></b><font style="vertical-align: inherit;"> Broker </font><font style="vertical-align: inherit;">und die </font><b><font style="vertical-align: inherit;">dazugehörige</font></b><font style="vertical-align: inherit;"> Benutzeroberfläche enthält. </font><font style="vertical-align: inherit;">
Klicken Sie nach dem Erstellen im angezeigten Fenster auf die Schaltfläche </font><b><font style="vertical-align: inherit;">Dashboard starten</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Dies ist ein IoT-Bedienfeld. Jetzt müssen wir Geräte erstellen. Klicken </font><b><font style="vertical-align: inherit;">Sie auf Gerät hinzufügen</font></b><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">Erstellen Sie in den angezeigten</font></b><font style="vertical-align: inherit;"> Dialogfeldern </font><font style="vertical-align: inherit;">einen Gerätetyp ( </font><b><font style="vertical-align: inherit;">Gerätetyp erstellen</font></b><font style="vertical-align: inherit;"> ). Geben Sie ihm den Namen Typ1, und füllen Sie die verbleibenden Felder der Einfachheit halber nicht aus. Klicken Sie auf Weiter -&gt; Weiter -&gt; Erstellen -&gt; Weiter. Geben Sie dem Gerät Device1 den Namen. Weiter Weiter -&gt; Weiter -&gt; Weiter -&gt; Hinzufügen. Als Ergebnis erhalten wir das folgende Fenster:</font></font><br>
<img width="800" src="https://habrastorage.org/files/615/b4f/d12/615b4fd125b44adebeba93ec77725d8e.png"><br>
<br>
<b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<br>
<img width="800" src="https://habrastorage.org/files/b9e/00f/6e1/b9e00f6e1f7d4381ab7d95220998f722.png"><br>
<br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br>
<img width="800" src="https://habrastorage.org/files/ce8/dcc/0b2/ce8dcc0b2a7f41d39f1545be3a0ee014.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier haben wir alle Details zum Anschließen unseres ersten Geräts an den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MQTT-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Broker </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir werden testen, ob unser Client eine Verbindung herstellen kann. Geben Sie die Details in das Client-Fenster ein. </font></font><br>
<img width="1000" src="https://habrastorage.org/files/23e/469/94b/23e46994b94b4621b8aeb93a17fd5c5e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie Sie sehen, hat der Client erfolgreich eine Verbindung zu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix hergestellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hier sollten Sie auf den Hostnamen achten. Es beginnt mit der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisations-ID,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die beim Erstellen der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet of Things Foundation erhalten wurde</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Das Feld </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzer-ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist </font><font style="vertical-align: inherit;">ebenfalls zusammengesetzt und wird wie folgt codiert: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Organisations-ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;: &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerätetyp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;: &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerät-ID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Feld </font><b><font style="vertical-align: inherit;">Benutzername</font></b><font style="vertical-align: inherit;"> enthält eine feste Zeichenfolge</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use-token-auth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachrichtenthemen für den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Broker dürfen </font><font style="vertical-align: inherit;">im Gegensatz zum </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Broker </font><font style="vertical-align: inherit;">keine beliebigen Daten enthalten. </font><font style="vertical-align: inherit;">Sie werden nach bestimmten Regeln codiert. </font><font style="vertical-align: inherit;">Diese Regeln sollten in der Dokumentation der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet of Things Foundation untersucht werden</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Der Screenshot zeigt eines der möglichen gültigen Themen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Projekt-Repository: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Indemsys/Delphi_MQTT_mosquitto</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de388231/">https://habr.com/ru/post/de388231/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de388221/index.html">Seagate: Winchesters bleiben noch 20 Jahre bei uns</a></li>
<li><a href="../de388223/index.html">Erinnerungen eines untermenschlichen Roboters, Kapitel 1-2, zweiter Versuch</a></li>
<li><a href="../de388225/index.html">Was ist evolutionäre Kristallographie und warum steckt die Zukunft dahinter? Fast kompliziert</a></li>
<li><a href="../de388227/index.html">Infografik-Recherche: Neujahrs-E-Shop online</a></li>
<li><a href="../de388229/index.html">Verwendung von iRidium zur Steuerung von Automatisierungssystemen basierend auf dem Z-Wave-Protokoll</a></li>
<li><a href="../de388233/index.html">Reisen durch das mikroelektronische Russland (akademischer Teil)</a></li>
<li><a href="../de388235/index.html">Volkswagen schlug Korrekturmaßnahmen für Dieselmotoren vor, die von europäischen Beamten verabschiedet wurden</a></li>
<li><a href="../de388237/index.html">Die britische Polizei gründete eine „Karaoke-Bande“ aus drei älteren Karaoke-Enthusiasten</a></li>
<li><a href="../de388241/index.html">Warum führen Unternehmen IPOs durch: Vor- und Nachteile</a></li>
<li><a href="../de388243/index.html">Hausüberwachung und Fernüberwachung über das Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>