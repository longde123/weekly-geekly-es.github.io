<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïë üêÑ ‚è∫Ô∏è So f√ºhren Sie eine BTC-Transaktion durch, ohne kleine M√ºnzen einzuzahlen ‚ôªÔ∏è ‚¨õÔ∏è üèÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Viele Bitcoin-Geldb√∂rsen bevorzugen bei der Auswahl der zu sendenden M√ºnzen die Verwendung einer gro√üen M√ºnze, deren Kontostand gr√∂√üer ist als der ges...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So f√ºhren Sie eine BTC-Transaktion durch, ohne kleine M√ºnzen einzuzahlen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465041/"><p><img src="https://habrastorage.org/webt/fn/ez/kn/fnezknn373mov5izqcr1u0nppfk.png" alt="Ziel: Packen Sie so viele wertvolle Gegenst√§nde wie m√∂glich in einen Rucksack, vorausgesetzt, der Rucksack hat eine begrenzte Kapazit√§t"></p><br><p> Viele Bitcoin-Geldb√∂rsen bevorzugen bei der Auswahl der zu sendenden M√ºnzen die Verwendung einer gro√üen M√ºnze, deren Kontostand gr√∂√üer ist als der gesendete Betrag.  Nach jeder solchen Transaktion wird eine Wechselm√ºnze gebildet.  Nach einiger Zeit ist die gesamte Brieftasche mit solchen M√ºnzen in der Gr√∂√üenordnung von 0,001 (derzeit ~ 10 US-Dollar) bewachsen, f√ºr die es bereits nichts mehr gibt.  Als ich erneut eine Transaktion durchf√ºhren musste, kam mir der Gedanke, ob es m√∂glich war, die Transaktion so zusammenzustellen, dass sich nichts √§nderte.  Die Brieftasche bot hartn√§ckig an, eine weitere gr√∂√üere M√ºnze zu "schneiden", und so beschloss ich, mit meinen H√§nden M√ºnzen zu pfl√ºcken, um den erforderlichen Betrag zu sammeln.  Dies stellte sich jedoch als nicht so einfach heraus: Die Summe war entweder kleiner als der gew√ºnschte Wert oder √ºberschritt ihn zu sehr.  Aus diesem Grund habe ich beschlossen, dass es einen Algorithmus geben sollte, mit dem Sie den gew√ºnschten Betrag aus M√ºnzen oder etwas mehr sammeln k√∂nnen.  Es stellte sich heraus, dass dies nicht nur m√∂glich ist, sondern auch so gut funktioniert, dass ich diesen Artikel geschrieben habe.  Aber das Wichtigste zuerst. </p><a name="habracut"></a><br><h2 id="zadacha-o-ryukzake">  Rucksackproblem </h2><br><p>  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rucksackproblem ist</a> allgemein bekannt: so viele wertvolle Dinge wie m√∂glich in einen Rucksack zu packen, vorausgesetzt, die Kapazit√§t des Rucksacks ist begrenzt.  In diesem Fall haben wir den Fall <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">des 0-1-Rucksackproblems</a> , da jeder Artikel (M√ºnze) nur einmal zum Packen im Rucksack verf√ºgbar ist.  Dar√ºber hinaus stimmt das Gewicht jedes ‚ÄûElements‚Äú mit seinem Wert √ºberein, sodass es sich um einen noch spezielleren Fall handelt, das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Problem der Summe der Teilmengen</a> .  Wikipedia schl√§gt die Verwendung eines genetischen Algorithmus vor, aber ich habe mich entschlossen, mithilfe der dynamischen Programmierung nach einer genauen L√∂sung zu suchen, da dies in Bezug auf Ressourcen durchaus erreichbar ist und einfach aussieht. </p><br><p>  Um das Problem der Auswahl von M√ºnzen auf die Aufgabe eines Rucksacks zu reduzieren, m√ºssen Sie eine kleine Konvertierung der Eingabedaten vornehmen.  Tatsache ist, dass die L√∂sung des Rucksackproblems (genauer gesagt die Summe der Teilmengen) eine Teilmenge der urspr√ºnglichen Menge ergibt, deren maximale Menge den Parameter (Rucksacktragf√§higkeit) nicht √ºberschreitet.  Wir sind jedoch nicht zufrieden mit der Kombination von M√ºnzen, da der Betrag geringer ist als der Betrag, den wir senden m√∂chten.  Wir f√ºhlen uns jedoch mit Kombinationen wohl, die etwas √ºberlegen sind.  Wenn wir beispielsweise 0,005 Bitcoins senden m√ºssen und eine Kombination gefunden haben, die 0,00499 ergibt, ist dies f√ºr uns nutzlos, da es weniger ist als der vom Verk√§ufer gew√ºnschte Betrag.  Wenn wir jedoch 0,005001 finden, ist das richtig.  Zus√§tzliches Satoshiki kann als Provision verwendet werden (wir werden weiter unten ausf√ºhrlich darauf eingehen) oder es dem Verk√§ufer geben, wenn er das Senden eines gr√∂√üeren Betrags zul√§sst.  Daher m√ºssen wir mit Hilfe des Rucksackproblems nicht die M√ºnzen ausw√§hlen <strong>,</strong> die <strong>gesendet werden m√ºssen</strong> , sondern diejenigen, die zur√ºckgelassen werden m√ºssen.  Dann wird der maximale "Mangel" in Bezug auf das urspr√ºngliche Problem zu einer "Pleite". </p><br><p><img src="https://habrastorage.org/webt/ew/3q/su/ew3qsuzkpbzdy68chuyleel8vrm.png" alt="Automatische und manuelle Auswahl der zu sendenden M√ºnzen"></p><br><p>  Ein Beispiel.  Angenommen, wir haben solche M√ºnzen: 0,1 BTC, 0,002 BTC, 0,00832423 BTC.  Und wir m√ºssen 0,01 BTC senden.  Wir werden solche M√ºnzen finden, deren Summe maximal ist, aber kleiner oder gleich dem Gesamtbetrag unserer M√ºnzen abz√ºglich des gesendeten Betrags, dh einer solchen Zahl: 0,1 + 0,002 + 0,00832423 - 0,01 = 0,10032423.  In diesem Fall stellt eine einfache Suche fest, dass es sich um eine 0,1-M√ºnze handelt.  Wir verlassen es, was bedeutet, dass wir den Rest senden: 0,002 BTC und 0,00832423 BTC, was insgesamt 0,01032423 BTC ergibt, was mehr als 0,01 BTC ist und zu uns passt.  (Die Provision belief sich zwar auf 3 US-Dollar, aber sagen wir, das Netzwerk ist ausgelastet und wir m√∂chten das Senden so schnell wie m√∂glich gestalten.) </p><br><h2 id="komissii">  Provisionen </h2><br><p>  Um die Transaktionsgeb√ºhren zu ber√ºcksichtigen, habe ich jede Eingabem√ºnze ge√§ndert und ihr Guthaben um den Betrag reduziert, der f√ºr die Aufnahme in die Transaktion als Eingabe gezahlt werden m√ºsste.  Dies kann erreicht werden, indem die Gr√∂√üe der Eingabe und die Provision bekannt sind (z. B. 2 Satoshi pro Byte).  Au√üerdem habe ich den zu sendenden Betrag ge√§ndert und den Preis des Teils der Transaktion hinzugef√ºgt, der nicht von den ausgew√§hlten M√ºnzen abh√§ngt: √úberschrift und Ausgang (e).  Der Benutzer kann alle diese Parameter mithilfe von Flags angeben.  Sie k√∂nnen die Anpassung f√ºr Provisionen im Allgemeinen auch deaktivieren, indem Sie eine Provision von 0 Satoshi pro Byte angeben. </p><br><p>  Ich habe Informationen √ºber die Gr√∂√üe der Ein- und Ausg√§nge in verschiedenen Adressversionen (klassisches, verpacktes Segwit und natives Segwit) von hier abgerufen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://bitcoin.stackexchange.com/a/84006</a> </p><br><h2 id="algoritmy-i-realizaciya">  Algorithmen und Implementierung </h2><br><p>  Ich habe den genetischen Algorithmus sofort fallen lassen, vielleicht vergebens.  Konzentriert sich auf genaue Algorithmen.  Mein erster Versuch war es, durch umfassende Suche aller Kombinationen zu realisieren, aber selbst bei 40 M√ºnzen funktionierte es stundenlang und musste es aufgeben.  Dann habe ich die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf Wikipedia vorgeschlagene</a> dynamische Programmierung ausprobiert.  Darin k√∂nnen Sie nicht die gesamte Matrix speichern, sondern nur die aktuellen und vorherigen Zeilen.  Au√üerdem m√ºssen wir den Wert nicht speichern, da er mit dem Gewicht √ºbereinstimmt und die Spaltennummer ist.  Aber wir m√ºssen uns an die Kombination erinnern - ich habe beschlossen, sie in Form eines Bitsets zu speichern.  Dar√ºber hinaus k√∂nnen Sie nur eine Zeile speichern und die n√§chste Zeile direkt daraus erstellen.  Jeder Zeilendatensatz ungleich Null bleibt an seiner Stelle und wird (unter Hinzuf√ºgung des entsprechenden Bits) eine bestimmte Anzahl von Zellen rechts in eine andere Zelle kopiert (falls er dort zuvor leer war).  Wenn Sie in umgekehrter Reihenfolge die Zelle sortieren, in die der "Sprung" geht, k√∂nnen Sie alles richtig f√ºllen: </p><br><p><img src="https://habrastorage.org/webt/fa/qb/ts/faqbtspntkfkjgzwy6koiubabvi.png" alt="Illustration des √úbergangs zur n√§chsten Zeile, dh Hinzuf√ºgen einer weiteren M√ºnze zur dynamischen Programmierung"><br>  <em>Jede Zelle ungleich Null in der aktuellen Zeile wird in der n√§chsten Zeile selbst und eine weitere Zelle f√ºr eine bestimmte Anzahl von Zellen (gleich dem Wert der hinzugef√ºgten M√ºnze) rechts generiert.</em>  <em>Wenn diese Zelle bereits einen Wert hat, ‚Äûgewinnt‚Äú die Option mit der gr√∂√üten Anzahl ausgew√§hlter (dh nicht in der Transaktion enthaltener) M√ºnzen, da wir so wenige M√ºnzen wie m√∂glich senden m√∂chten, wobei andere Dinge gleich sind.</em> </p><br><p>  F√ºr eine Zelle gebe ich 8 Bytes f√ºr ein Bitset aus, und die Anzahl der Zellen entspricht der m√∂glichen Anzahl von Guthaben von 0 bis zur Anzahl der M√ºnzen abz√ºglich der gesendeten Menge.  Wenn sich beispielsweise nur 1 Bitcoin in der Brieftasche befindet und 0,1 gesendet wird, gibt es 100'000'000-10'000'000 = 90'000'000 Zellen mit jeweils 8 Bytes, dh 720 Megabyte - ein wenig f√ºr einen modernen Computer.  Wenn die Anzahl der M√ºnzen weniger als 32 betr√§gt, k√∂nnen 4 Bytes pro M√ºnze verwendet werden, aber ich habe sie nicht optimiert.  Wenn mehr als 64 M√ºnzen vorhanden sind, funktioniert das Programm nicht - dies m√ºsste auch behoben werden, indem ein Bit-Set beliebiger L√§nge erstellt wird.  Schlie√ülich k√∂nnen Sie das letzte Zeichen in den Salden verwerfen, wobei Sie ein wenig an Genauigkeit verlieren, aber 10 Mal im Speicher gewinnen.  Aber soweit wird es reichen. </p><br><p> Ich habe das <strong>Programm</strong> unver√§nderlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgerufen</a> und auf dem Gitlab abgelegt: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gitlab.com/starius/changeless</a> .  Es ist in Go geschrieben und wird wie gewohnt mit <code>go get</code> .  In CI gesammelte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bin√§rdateien f√ºr Linux, Windows, Mac</a> sind verf√ºgbar. </p><br><p>  Als ich das Programm mit echten M√ºnzen startete, war ich erstaunt, wie genau sie die notwendige Kombination aufnahm.  Wenn die Anzahl der M√ºnzen gro√ü ist, kann fast jeder Betrag, der dem Guthaben der M√ºnzen entspricht, mit Genauigkeit bis hinunter zu Satoshi ausgew√§hlt werden!  Sie √§ndern den erforderlichen Betrag f√ºr 1 Satoshi und das Programm bietet genau f√ºr diesen Betrag eine v√∂llig andere Kombination von M√ºnzen.  Unten sehen Sie ein Beispiel f√ºr die Arbeit an 50 zuf√§lligen M√ºnzen mit einem Guthaben von 0 bis 1 Bitcoin. </p><br><pre> <code class="plaintext hljs">$ cat coins50.txt 0.01331611 0.03906237 0.04847086 0.08453118 0.09748168 0.10395389 0.10619825 0.12156721 0.12923149 0.13587973 0.14798976 0.16053788 0.19011834 0.21570038 0.21946913 0.31861430 0.33435508 0.33718842 0.33789473 0.35976748 0.37360122 0.44944553 0.47572926 0.49927495 0.50992142 0.53062326 0.53079433 0.53542072 0.54715225 0.55019714 0.55313907 0.56656642 0.56673333 0.65879650 0.66228482 0.68424322 0.70436496 0.75638055 0.79095597 0.82438005 0.83684407 0.85151564 0.86862948 0.90054250 0.90239402 0.91636213 0.93087757 0.93579251 0.97207439 0.98248384 $ changeless -amount 10.00000000 -coins coins50.txt Processing item 50/50. 0.09748168 + 0.33435508 + 0.47572926 + 0.53542072 + 0.66228482 + 0.70436496 + 0.75638055 + 0.82438005 + 0.9005425 + 0.90239402 + 0.91636213 + 0.93579251 + 0.97207439 + 0.98248384 = 10.00004651 Tx size: 2118 vBytes. Total fees: 0.00004651 BTC (2.2 sats/vByte). $ changeless -amount 10.00000001 -coins coins50.txt Processing item 50/50. 0.01331611 + 0.09748168 + 0.53079433 + 0.56656642 + 0.70436496 + 0.75638055 + 0.82438005 + 0.86862948 + 0.9005425 + 0.91636213 + 0.93087757 + 0.93579251 + 0.97207439 + 0.98248384 = 10.00004652 Tx size: 2118 vBytes. Total fees: 0.00004651 BTC (2.2 sats/vByte).</code> </pre> <br><p>  Das Programm hat es geschafft, Kombinationen von M√ºnzen aufzunehmen, um genau 10 Bitcoins und genau 10.00000001 Bitcoins (10 Bitcoins und 1 Satoshi) zu senden.  Um dies zu sehen, m√ºssen Sie die Provision von der Anzahl der M√ºnzen abziehen: 10.00004651 - 0.00004651 = 10, 10.00004652 - 0.00004651 = 10.00000001. </p><br><h2 id="kak-poluchit-spisok-balansov-monet">  So erhalten Sie eine Liste der M√ºnzguthaben </h2><br><p>  F√ºr das Electrum-Programm habe ich diesen Weg gefunden (Konsolenbefehl): </p><br><pre> <code class="plaintext hljs">' '.join((x["value"]) for x in listunspent())</code> </pre> <br><p>  Wenn Sie bestimmte M√ºnzen ausschlie√üen m√∂chten, beispielsweise an einer bestimmten Adresse, k√∂nnen Sie dies folgenderma√üen tun: </p><br><pre> <code class="plaintext hljs">' '.join((x["value"]) for x in listunspent() if x["address"] != "bad address")</code> </pre> <br><p>  F√ºr andere Geldb√∂rsen fand ich keinen so einfachen Weg und musste ihn mit meinen H√§nden erneut eingeben. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465041/">https://habr.com/ru/post/de465041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465027/index.html">10 naive aber wichtige Fragen zu CRM</a></li>
<li><a href="../de465029/index.html">[M√ñGLICH] SORM entschl√ºsselt den HTTPS-Verkehr zu Mail.ru und ICQ</a></li>
<li><a href="../de465031/index.html">Innenansicht: RFID in der modernen Welt. Teil 2: Chinesisches RFID</a></li>
<li><a href="../de465033/index.html">Lassen Sie sich die Powercheck-Technologie einfallen</a></li>
<li><a href="../de465039/index.html">Sicherheitswoche 35: Statistiken √ºber durchgesickerte Passw√∂rter und Angriffe √ºber Google Drive</a></li>
<li><a href="../de465045/index.html">Kali Linux NetHunter f√ºr Android: Warum und wie installieren?</a></li>
<li><a href="../de465047/index.html">Unit-Tests in DBMS - wie wir es in Sportmaster machen, Teil zwei</a></li>
<li><a href="../de465049/index.html">10 B√ºcher √ºber agiles Projektmanagement, die es wert sind, 2020 mitgenommen zu werden</a></li>
<li><a href="../de465055/index.html">Sechs F√§higkeiten, um Ihre Data Science-Karriere auf die n√§chste Stufe zu bringen.</a></li>
<li><a href="../de465057/index.html">Container und Windows. Von Hello World zu Kubernetes. Erster Teil, Einf√ºhrung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>