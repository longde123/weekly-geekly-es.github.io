<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äç‚öñÔ∏è üêã ü¶ä Cree un bot√≥n con efecto domin√≥ para la interfaz de usuario de XMars ‚èØÔ∏è üèáüèª üö£üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos, hoy les contar√© c√≥mo desarroll√© el bot√≥n para el proyecto XMars UI . Oh s√≠, es un poco, pero hay algo que contar. Omitir√© los detalles a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cree un bot√≥n con efecto domin√≥ para la interfaz de usuario de XMars</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484554/"><p><img src="https://habrastorage.org/webt/qb/fw/za/qbfwzabrpaxjd5t8yzbqojymgwg.jpeg"></p><br><p> Hola a todos, hoy les contar√© c√≥mo desarroll√© el bot√≥n para el proyecto <a href="http://bit.ly/2RAsroW" rel="nofollow">XMars UI</a> .  Oh s√≠, es un poco, pero hay algo que contar.  Omitir√© los detalles asociados con la adici√≥n de un nuevo componente al proyecto de c√≥digo abierto.  Con m√°s detalle hablar√© sobre el proyecto en un art√≠culo separado. </p><br><h3 id="vvedenie">  Introduccion </h3><br><p>  <a href="http://bit.ly/2RbfuDn" rel="nofollow">XMars UI</a> es uno de mis nuevos proyectos de c√≥digo abierto.  Una biblioteca simple de componentes de UI para HTML / CSS y React.  En el futuro planeo apoyar a Vue.  Hasta ahora, solo tiene un bot√≥n e √≠conos :) </p><br><p>  El proyecto naci√≥ como una idea en el marco del Concurso Telegram, cuya esencia era desarrollar una versi√≥n web del cliente.  Junto con un colega, decidimos por qu√© no participar en esto.  Los roles se compartieron para que yo tenga un dise√±o, y cuando un colega entiende la autorizaci√≥n, me conectar√© para escribir componentes.  Todo estar√≠a bien, pero iniciar sesi√≥n en Telegram no es tan simple.  Como resultado, no enviamos nada, pero me encontr√© con un mont√≥n de todo y result√≥, en vano.  Pero como dice Varlamov, su proyecto ya vale algo, ya que pas√≥ su tiempo en √©l.  Es dif√≠cil estar en desacuerdo con esto, porque si se transfiere a horas y dinero, simplemente configurar Webpack al comienzo del proyecto ya no es gratuito.  Mirando toda esta desgracia, decid√≠ que ten√≠a que arrojarla de alguna manera en c√≥digo abierto.  ¬øQu√© arranque √∫nico usar?  Quiero mi propio marco de IU para mis otros proyectos. </p><a name="habracut"></a><br><h3 id="the-button">  El bot√≥n </h3><br><p>  El bot√≥n en la interfaz es quiz√°s el elemento principal con el que el usuario interact√∫a con la aplicaci√≥n.  Por lo tanto, este es uno de los primeros componentes de cualquier marco / biblioteca de interfaz de usuario. </p><br><p>  En el dise√±o de Telegram, no hay muchas variaciones de botones: </p><br><p><img src="https://habrastorage.org/webt/6h/g7/t6/6hg7t6irtlvoinmtwbgu7t1zezu.png"></p><br><p>  Destaqu√© 3 principales (predeterminado, acento, primario), redondo con un icono y verde.  Todav√≠a hay semitransparente, pero decepciona.  En su mayor parte, al desarrollar la <a href="http://bit.ly/2tr72a0" rel="nofollow">interfaz de usuario de XMars</a> , trato de responder a las necesidades, no he descubierto d√≥nde se necesitar√≠a el bot√≥n transparente. </p><br><p> El usuario de la biblioteca deber√≠a sentirse c√≥modo usando clases de CSS.  No soy fan√°tico de sistemas de nombres como BEM.  Me gusta la forma en que Bootstrap nombra las clases.  Pero simplificar√≠a un poco m√°s.  En lugar de <code>.btn .btn-primary</code> , solo <code>.btn .primary</code> .  Y en el caso del componente React, se ver√° as√≠: </p><br><pre> <code class="javascript hljs">&lt;Button primary&gt;Hey&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt;</span></span></code> </pre> <br><p>  El mismo bot√≥n pero efecto domin√≥: </p><br><pre> <code class="javascript hljs">&lt;Button primary ripple&gt;Hey&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt;</span></span></code> </pre> <br><h3 id="html--css">  HTML / CSS </h3><br><p>  La biblioteca de IU no debe estar vinculada a ning√∫n marco de IU.  En el futuro planeo estirar el dise√±o en los componentes <code>Vue</code> .  Comencemos con HTML / CSS simple. </p><br><p>  Bajo el cap√≥ del proyecto <a href="http://bit.ly/364UK4g" rel="nofollow">Tailwindcss</a> , este es un marco CSS de primera utilidad, es decir, un marco que le proporciona utilidades, en lugar de componentes completos. </p><br><p><img src="https://habrastorage.org/webt/by/c_/rk/byc_rkdkrpk4-igmro0h4wnbkli.png"></p><br><p>  Adem√°s de Tailwindcss, PostCSS se usa para <a href="https://github.com/postcss/postcss-mixins" rel="nofollow">mixins</a> , <a href="https://github.com/postcss/postcss-custom-properties" rel="nofollow">variables</a> y <a href="https://github.com/postcss/postcss-nested" rel="nofollow">estilos anidados.</a> </p><br><p>  Con m√°s detalle sobre el uso de dicho marco y c√≥mo se configura el proyecto, lo contar√© en un art√≠culo separado.  En esta etapa, es suficiente que tengamos un kit de herramientas tan poderoso y que los componentes se utilicen al m√°ximo. </p><br><p>  La <code>&lt;button&gt;</code> tiene una serie de estilos predeterminados que necesitamos eliminar o redefinir. </p><br><p><img src="https://habrastorage.org/webt/rq/uw/ad/rquwad-pftcaam8vqie3bwhsmew.png"></p><br><p>  En el caso de Tailwindcss, la etiqueta del bot√≥n tiene este estilo: </p><br><p><img src="https://habrastorage.org/webt/ok/c9/2c/okc92cjctwgo5v8nf0qes8_dcvu.png"></p><br><p>  Todo innecesario por defecto eliminado.  Puede esculpir lo que quiera sin temor a que un borde predeterminado se caiga en alg√∫n estado.  Pero aqu√≠ hay una advertencia, el <code>outline</code> predeterminado a√∫n necesita ser clavado: </p><br><p><img src="https://habrastorage.org/webt/6d/7w/d7/6d7wd77y15peye0xdl8luutiscq.png"></p><br><p>  Un bot√≥n en <a href="http://bit.ly/30yxc6C" rel="nofollow">XMars UI</a> tiene una clase <code>.btn</code> : </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn"</span></span></span><span class="hljs-tag">&gt;</span></span>Button<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Agregue esta clase a nuestros estilos: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.btn</span></span> { @apply text-black text-base leading-snug; @apply py-3 px-4 border-none rounded-lg; @apply inline-block cursor-pointer no-underline; &amp;:focus { @apply outline-none; } }</code> </pre> <br><p>  Adem√°s del hecho de que Tailwindcss proporciona clases que puedes usar, proporciona una especie de <code>mixins</code> .  <code>@apply</code> no es SCSS o alg√∫n tipo de complemento para PostCSS.  Esta es la sintaxis de Tailwindcss en s√≠.  Los estilos que se aplican generalmente se eliminan sem√°nticamente del nombre.  <code>py-3</code> y <code>px-4</code> solo pueden causar preguntas.  El primero es el relleno a lo largo de y, es decir, verticalmente, a saber, <code>padding-top: 0.75rem;</code> <code>padding-bottom: 0.75rem;</code>  .  En consecuencia, el <code>px-4</code> horizontalmente es <code>padding-right: 1rem;</code>  , <code>padding-left: 1rem;</code>  . </p><br><p>  El dise√±o que proporcion√≥ Telegram para decirlo suavemente no est√° bien documentado y cosas como <code>border-radius</code> botones de <code>border-radius</code> deben tomarse con una regla directamente desde la imagen.  ¬øAlguna vez se pregunt√≥ qu√© significan exactamente los valores en <code>border-radius</code> ? </p><br><p><img src="https://habrastorage.org/webt/t1/61/sp/t161sp5vhq_sw2hwtb56ibfylgs.gif"></p><br><p>  Este es literalmente el radio del c√≠rculo resultante en la esquina.  Si la granja colectiva, puede cambiar la regla como se muestra en la imagen de arriba.  Entonces lo hice usando la selecci√≥n rectangular en Gimp. </p><br><p><img src="https://habrastorage.org/webt/9b/-x/bk/9b-xbkbj3mbmrmsgttlhpzx2nbc.png"></p><br><p>  <code>border-radius</code> los botones en el dise√±o es de 10px, desafortunadamente no existe tal clase desde el cuadro en Tailwindcss, pero visualmente ten√≠a <code>rounded-lg</code> que es <code>8px</code> para el tama√±o de fuente predeterminado (rem). </p><br><p>  Esto es lo que sucedi√≥ en este momento: pint√© el bot√≥n en gris para que se pudieran ver los bordes: </p><br><p><img src="https://habrastorage.org/webt/a2/tz/z-/a2tzz-khw1guvggfgjz0vjecfnm.png"></p><br><p>  A continuaci√≥n, necesitamos hacer un efecto en <code>:hover</code> .  Luego, los dise√±adores de Telegram decidieron arrojar algo de luz e indicaron el color como 0.08% de <code>#707579</code> .  Veo dos opciones, solo toma el color con el cuentagotas o hazlo como est√° documentado.  La primera opci√≥n es m√°s simple, pero en el futuro no es la mejor.  El hecho es que si el fondo es diferente del blanco, entonces <code>:hover</code> , obtendremos un color espec√≠fico, perderemos la "claridad" y la transparencia del bot√≥n.  Para esto es mejor seguir la documentaci√≥n y establecer alfa <del>  hombre </del>  El canal.  Esto se puede hacer de innumerables maneras, por ejemplo, utilizando las funciones de color SCSS.  Pero no hay SCSS en el proyecto y, debido al mismo color, no quiero conectar ning√∫n complemento a PostCSS, haremos todo muy simple.  En Chrome, hay un colopaker que le permite transformar colores en diferentes sistemas, conducir colores HEX <code>#707579</code> , traducirlos a <code>rgba</code> y configurar el canal alfa - 0.08%. </p><br><p><img src="https://habrastorage.org/webt/tx/oe/hv/txoehvpf_ams30-5kvkur8q-2bc.png"></p><br><p>  Voila!  Algo brill√≥ bruscamente en mi foto: </p><br><p><img src="https://habrastorage.org/webt/9g/nc/7b/9gnc7bjgm-uljw_rwbxn8cve71c.png"></p><br><p>  Obtenemos - <code>rgba(112, 117, 121, 0.08)</code> . </p><br><p><img src="https://habrastorage.org/webt/vn/hc/kh/vnhckhj8plbr9_rmbvr0ug9eawm.png"><br>  (: desplazarse) </p><br><p>  M√°s aburrido y sin mucho esfuerzo, agregu√© los estados restantes: </p><br><pre> <code class="css hljs"> &amp;<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--grey04); } &amp;<span class="hljs-selector-class"><span class="hljs-selector-class">.accent</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--blue01); } &amp;<span class="hljs-selector-class"><span class="hljs-selector-class">.primary</span></span> { @apply text-white; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--blue01); &amp;:hover { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">var</span></span>(--blue02); } }</code> </pre> <br><h3 id="react-komponent">  Componente de reacci√≥n </h3><br><p>  Inicialmente, el bot√≥n fue creado para el concurso de Telegram y era imposible usar ning√∫n marco.  Tuve que implementar el efecto domin√≥ en JS puro.  Realmente me gustar√≠a que siga siendo as√≠, pero mientras haces el proyecto solo, tienes que sacrificar algo. </p><br><p>  Los componentes que requieren alg√∫n tipo de l√≥gica, como el efecto domin√≥, se implementar√°n y estar√°n disponibles solo como componentes React. </p><br><p>  Ajustar el bot√≥n en React componente no es dif√≠cil: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { FunctionComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps { } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Button: FunctionComponent&lt;ButtonProps&gt; = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"btn"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">props.children</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> Button;</code> </pre> <br><p>  Este bot√≥n se mostrar√° en el estilo especificado, pero de hecho es de poca utilidad.  Necesitamos permitir que el usuario personalice el bot√≥n, agregue estilos personalizados, cuelgue controladores de eventos, etc. </p><br><p>  Para que el usuario pueda transferir todo lo necesario, primero debe superar Typecript, de lo contrario, incluso <code>onClick</code> no le permitir√° transferir normalmente.  <code>ButtonProps</code> editar ligeramente la interfaz <code>ButtonProps</code> , resolvemos el problema: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps extends ButtonHTMLAttributes&lt;HTMLButtonElement&gt;</code> </pre> <br><p>  despu√©s de lo cual podemos hacer con seguridad la destrucci√≥n de los <code>props</code> : </p><br><pre> <code class="javascript hljs">&lt;button className=<span class="hljs-string"><span class="hljs-string">"btn"</span></span> {...props}&gt;props.children&lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt;</span></span></code> </pre> <br><p>  El uso similar del bot√≥n se comportar√° como se esperaba: </p><br><pre> <code class="javascript hljs">&lt;Button onClick={() =&gt; alert()}&gt;Hey&lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt;</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/-_/aq/qb/-_aqqbmdkzkmdf2sr8lodd_wy-o.png"></p><br><p>  A continuaci√≥n, agregamos los estilos de bot√≥n y la capacidad de registrar una clase personalizada (de repente alguien necesitar√°).  El paquete npm <a href="https://www.npmjs.com/package/classnames" rel="nofollow">classnames</a> es perfecto para estos fines. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps extends ButtonHTMLAttributes&lt;HTMLButtonElement&gt; { primary?: boolean, accent?: boolean, additionalClass?: string, } ... const classNames = classnames( <span class="hljs-string"><span class="hljs-string">'btn'</span></span>, { primary }, { accent }, additionalClass ); ... &lt;button className={classNames} {...props}&gt;props.children&lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt;</span></span></code> </pre> <br><p>  La clase <code>btn</code> siempre se establece, pero <code>primary</code> y <code>accent</code> solo si es <code>true</code> .  Classnames agrega una clase si tiene un valor <code>true</code> l√≥gico, usando la abreviatura ES6 obtenemos una entrada simple <code>{ primary }</code> lugar de <code>{ primary: true }</code> . </p><br><p>  <code>additionalClass</code> es una cadena, y si est√° vac√≠a o indefinida, no juega un papel especial para nosotros, simplemente no se agregar√° nada al elemento. </p><br><p>  Al principio, asign√© <code>props</code> siguiente manera: </p><br><pre> <code class="javascript hljs">{...omit(props, [<span class="hljs-string"><span class="hljs-string">'additionalClass'</span></span>, <span class="hljs-string"><span class="hljs-string">'primary'</span></span>])}</code> </pre> <br><p>  Omitir todo lo que no se aplica a los <code>props</code> del elemento del bot√≥n, pero esto no es necesario ya que React no generar√° demasiado. </p><br><h3 id="ripple-effect">  Efecto domin√≥ </h3><br><p><img src="https://habrastorage.org/webt/36/ys/8w/36ys8wseofyhctlp1cm5r5kiwqo.gif"></p><br><p>  En realidad, as√≠ es como se ve, pero es deseable que la "ola" diverja del lugar del clic. <br>  Hay innumerables formas de hacer tal animaci√≥n, es como una broma sobre el <a href="https://css-tricks.com/blue-box/" rel="nofollow">cuadrado azul</a> . </p><br><p>  Pero google, al observar los ejemplos en codepen, qued√≥ claro que en la mayor√≠a de los casos, una "ola" se realiza a trav√©s de un elemento hijo, que se expande y desaparece. </p><br><p>  Se coloca dentro del bot√≥n de acuerdo con las coordenadas del clic.  En <a href="http://bit.ly/2RbcVRD" rel="nofollow">XMars UI</a> , en este momento decid√≠ no implementar este efecto en <code>onPress</code> como lo hace la UI de material, pero planeo <code>onPress</code> en el futuro.  Hasta ahora, solo en <code>onClick</code> . </p><br><p><img src="https://habrastorage.org/webt/dr/rr/wy/drrrwydtouv_xhq3fi6pyahyaye.png"></p><br><p>  La imagen de arriba es m√°gica.  Un clic crea un elemento de bot√≥n secundario, se posiciona absolutamente, en el centro del clic y se expande.  El <code>overflow: hidden</code> propiedad <code>overflow: hidden</code> ola vaya m√°s all√° del bot√≥n.  El elemento debe eliminarse al final de la animaci√≥n. </p><br><p>  Primero, definiremos los estilos donde podamos, usando Tailwindcss tanto como sea posible: </p><br><pre> <code class="plaintext hljs">.with-ripple { @apply relative overflow-hidden; @keyframes ripple { to { @apply opacity-0; transform: scale(2.5); } } .ripple { @apply absolute; z-index: 1; border-radius: 50%; background-color: var(--grey04); transform: scale(0); animation: ripple 0.6s linear; } &amp;.primary { .ripple { background-color: var(--black02); } } }</code> </pre> <br><p>  Al elemento responsable del efecto se le asignar√° la clase <code>.ripple</code> . <code>border-radius: 50%;</code>  es igual a un c√≠rculo (50% de filete en √°ngulo * 2), el bot√≥n tiene una posici√≥n relativa, el bot√≥n <code>.ripple</code> tiene una posici√≥n absoluta.  La animaci√≥n es muy simple, el aumento de la onda se vuelve transparente en 0.6 segundos.  El color de fondo es el mismo que <code>:hover</code> y plegarse, dos colores y botones transparentes de "onda" nos dan el resultado deseado.  En el bot√≥n azul <code>.primary</code> , esto no es tan importante y all√≠ puede usar un color no transparente. </p><br><p>  Al hacer clic, debe crear el elemento "ola".  Por lo tanto, creamos un estado para este negocio y agregamos el controlador de clic apropiado al bot√≥n, pero de tal manera que no interfiera con el onClick personalizado. </p><br><pre> <code class="javascript hljs">... const [rippleElements, setRippleElements] = useState&lt;JSX.Element[]&gt;<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">); ... </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">renderRippleElements</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElements</span></span></span><span class="hljs-function">; } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;button className={classNames} {...props} onClick={(event</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.onClick) { props.onClick(event); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ripple) { onRippleClick(event); } }} &gt; {children} {renderRippleElements()} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; );</span></span></code> </pre> <br><p>  <code>rippleElements</code> : una matriz de elementos JSX, la funci√≥n de renderizado aqu√≠ puede parecer redundante, pero esto es m√°s una cuesti√≥n de estilo e incorporaci√≥n para el futuro. </p><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRippleClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event: React.MouseEvent&lt;HTMLButtonElement, MouseEvent&gt;</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rect = event.currentTarget.getBoundingClientRect(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> d = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(event.currentTarget.clientWidth, event.currentTarget.clientHeight); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> left = event.clientX - rect.left - d/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> top = event.clientY - rect.top - d/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-string"><span class="hljs-string">'px'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rippleElement = newRippleElement(d, left, top); setRippleElements([...rippleElements, rippleElement]); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newRippleElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d: number, left: string, top: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> key = uuid(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div key={key} className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ripple"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style={{width: d, height: d, left, top}} onAnimationEnd={(</span></span></span><span class="hljs-function">) =&gt;</span></span> onAnimationEnd(key)} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br><p>  controlador <code>onRippleClick</code> que crea "ondas".  Al hacer clic en el bot√≥n, descubrimos el tama√±o del bot√≥n que se utiliza para colocar el c√≠rculo correctamente, despu√©s de lo cual todo lo necesario se pasa a la <code>newRippleElement</code> funci√≥n <code>newRippleElement</code> que a su vez simplemente crea un elemento <code>div</code> con la clase de <code>ripple</code> , creando los estilos necesarios para el posicionamiento. </p><br><p>  De las cosas principales que vale la pena destacar en <code>onAnimationEnd</code> .  Necesitamos este evento para borrar el DOM de elementos ya utilizados. </p><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onAnimationEnd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key: string</span></span></span><span class="hljs-function">) </span></span>{ setRippleElements(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElements</span></span></span><span class="hljs-function"> =&gt;</span></span> rippleElements.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">element</span></span></span><span class="hljs-function"> =&gt;</span></span> element.key !== key)); }</code> </pre> <br><p>  Es muy importante no olvidar, pasar los <code>rippleElements</code> actuales a argumentos, de lo contrario, puede obtener una matriz con valores antiguos, y todo no funcionar√° seg√∫n lo previsto. </p><br><p>  C√≥digo de bot√≥n completo: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { FunctionComponent, ButtonHTMLAttributes, useState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uuid <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'uuid/v4'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> classnames <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'classnames'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface ButtonProps extends ButtonHTMLAttributes&lt;HTMLButtonElement&gt; { primary?: boolean, accent?: boolean, circle?: boolean, ripple?: boolean, additionalClass?: string, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Button: FunctionComponent&lt;ButtonProps&gt; = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [rippleElements, setRippleElements] = useState&lt;JSX.Element[]&gt;<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> {</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">primary</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">accent</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">circle</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ripple</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">additionalClass</span></span></span><span class="hljs-function">, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children</span></span></span><span class="hljs-function">} = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">classNames</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">classnames</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'btn'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, { primary }, { </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'with-ripple'</span></span></span></span><span class="hljs-function"><span class="hljs-params">: ripple }, { circle }, { accent }, additionalClass </span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onAnimationEnd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key: string</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">setRippleElements</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElements =&gt; rippleElements.filter(element =&gt; element.key !== key</span></span></span><span class="hljs-function">)); } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">onRippleClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event: React.MouseEvent&lt;HTMLButtonElement, MouseEvent&gt;</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">var</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rect</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">currentTarget</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">getBoundingClientRect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Math</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">max</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event.currentTarget.clientWidth, event.currentTarget.clientHeight</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">left</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">clientX</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rect</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">left</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function">/2 + '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">px</span></span></span><span class="hljs-function">'; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">top</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">clientY</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rect</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">top</span></span></span><span class="hljs-function"> - </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function">/2 + '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">px</span></span></span><span class="hljs-function">'; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rippleElement</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newRippleElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d, left, top</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">setRippleElements</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[...rippleElements, rippleElement]</span></span></span><span class="hljs-function">); } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newRippleElement</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d: number, left: string, top: string</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">uuid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div key={key} className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ripple"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style={{width: d, height: d, left, top}} onAnimationEnd={(</span></span></span><span class="hljs-function">) =&gt;</span></span> onAnimationEnd(key)} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderRippleElements</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rippleElements; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;button className={classNames} {...props} onClick={(event</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.onClick) { props.onClick(event); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ripple) { onRippleClick(event); } }} &gt; {children} {renderRippleElements()} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt; ); } export default Button;</span></span></code> </pre> <br><p>  El resultado final se puede informar <a href="https://ui.xmars.io/docs/components/buttons" rel="nofollow">aqu√≠.</a> </p><br><h3 id="zaklyuchenie">  Conclusi√≥n </h3><br><p>  Se omiti√≥ mucho, por ejemplo, c√≥mo se configur√≥ el proyecto, c√≥mo se escribe la documentaci√≥n, las pruebas de un nuevo componente en el proyecto.  Tratar√© de cubrir estos temas con publicaciones separadas. </p><br><p>  <a href="http://bit.ly/36dT1JM" rel="nofollow">Repositorio de XMars UI Github</a> </p></div></div><p>Source: <a href="https://habr.com/ru/post/484554/">https://habr.com/ru/post/484554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../484544/index.html">Un par de m√©todos interesantes de objetos de consola</a></li>
<li><a href="../484546/index.html">10 preguntas populares de entrevistas de TypeScript (con respuestas cortas)</a></li>
<li><a href="../484548/index.html">C√≥mo Citrix NetScaler CVE-2019-19781 Vulnerabilidad cr√≠tica expuso problemas ocultos de la industria de TI</a></li>
<li><a href="../484550/index.html">¬øSe necesita la holocracia en una empresa de TI? Pros y contras</a></li>
<li><a href="../484552/index.html">Lectura para un geek: 10 materiales sobre tecnolog√≠a de audio: c√≥mo se organizan las pistas de m√∫sica, los registros HD y el sonido 8D</a></li>
<li><a href="../484556/index.html">Entonces, ¬øcu√°ndo es posible usarlo? ¬øImportante?</a></li>
<li><a href="../484564/index.html">Escribimos un controlador para una computadora port√°til por diversi√≥n y ganancias, o c√≥mo comprometerse con el kernel incluso si es un tonto</a></li>
<li><a href="../484568/index.html">Hack The Box - Tutorial del jugador. FFmpeg exploit, JWT y varios listados web</a></li>
<li><a href="../484572/index.html">Mi enfoque de gesti√≥n de tiempo / tareas usando VSCode</a></li>
<li><a href="../484574/index.html">No hay garrapatas! Vector de plantas contra la enfermedad de Lyme</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>