<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💟 🤰🏿 🗡️ Lignes directrices pour mettre "à l'état" un clone du mini-routeur chinois populaire Hame A15, alias "A5-V11 sans marque" 👨‍👧‍👧 📈 💔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si je voyais au-delà des autres, c'est parce que je me tenais sur les épaules de géants. 
 Newton 


 Je pense que beaucoup de gens connaissent le pet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lignes directrices pour mettre "à l'état" un clone du mini-routeur chinois populaire Hame A15, alias "A5-V11 sans marque"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425281/"><p>  <i>Si je voyais au-delà des autres, c'est parce que je me tenais sur les épaules de géants.</i> <i><br></i>  <i><b>Newton</b></i> </p><br><p>  Je pense que beaucoup de gens connaissent le petit routeur chinois Hame A15 (lui, ou plutôt ses copies massives, avec TTX amélioré par rapport à l'original, est également bien recherché par les mots-clés <b>routeur 3g / 4g</b> sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ebay</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">aliexpress</a> ).  Aujourd'hui, je voulais dire comment je pensais à un routeur à 6,5 $ et que j'y ai dépensé 20 $.  Pourquoi?  Et pour à peu près la même raison pour laquelle les bracelets sont faits de perles - afin de former la micromotrice et la vue (les corps des composants sont principalement 0402 :) Principalement pour des raisons sportives, bien qu'il soit important que ce routeur soit de loin ma base préférée pour divers (même en dépit de la difficulté d'accès au GPIO), au lieu des "populaires" NEXX WT3020F, TP-Link TL-MR3020, TP-Link TL-WR703N et autres.  La raison en est principalement sa taille et la forme de la carte de circuit imprimé, pratique pour une intégration n'importe où (sur la photo, vous pouvez estimer la taille).  À l'avenir, pour éviter toute confusion de terminologie, je <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">nommerai</a> l'appareil ci-dessous comme il est appelé par le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">wiki openwrt</a> - <b>A5-V11</b> . </p><br><img src="https://habrastorage.org/webt/xq/rw/n3/xqrwn3a7h_npbxhgw0xfajvcjh8.jpeg"><a name="habracut"></a><br><p>  Le cœur de cet appareil est le SoC Ralink RT5350F à 360 MHz, à bord il y a un hôte USB complet, 4 Mo de mémoire flash et 32 ​​Mo de SDRAM avec une fréquence de 166 MHz (ce qui est d'ailleurs étrange, car même l'ancien D-link DIR-320 à bord avait un DDR plus rapide).  Certains clones clones ont 16 Mo de mémoire et ne conviennent pas sans augmenter la RAM pour les manipulations décrites dans cet article. </p><br><p>  Comme d'habitude, l'image ci-dessous montre le routeur Hame A15 d'origine. </p><br><div class="spoiler">  <b class="spoiler_title">Original Hame A15</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/c51/593/bb2/c51593bb22f95c58a5bfbc7cbe9fe93b.jpg" alt="image"></div></div><br><p>  Et voici sa copie chinoise améliorée (à la fin de l'article, vous pouvez voir une autre copie de la copie, mais 10 fois plus chère :). </p><br><div class="spoiler">  <b class="spoiler_title">Clone chinois Hame A15</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/b4c/a9b/96b/b4ca9b96b4217413d40e6fc99a4b0f91.jpg" alt="image"></div></div><br><p>  Les internes du firmware étaient déjà <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">éclairés</a> sur le hub, donc je ne m'attarderai pas sur les fonctionnalités du balisage.  Les détails des problèmes et des solutions sont décrits sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">w3bsit3-dns.com</a> .  Il y a beaucoup d'informations, mais elles sont incroyablement dispersées.  J'espère recueillir des points clés dans cet article, sur la base de l'expérience des gars - «géants de la production de routeurs» :) <br>  La réponse à la question "pourquoi ce (routeur) a-t-il besoin d'un utilisateur inexpérimenté" cite l'utilisateur <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ded1971</a></b> : </p><br><blockquote>  Propriétés grand public - routeur 3G-WiFi compact et polyvalent.  Il est pratique de faire des voyages, de connecter un modem 3G / 4G, d'organiser votre réseau WiFi ou de l'utiliser comme répéteur pour améliorer le WiFi, de connecter Internet à une Smart TV s'il n'y a pas de WiFi intégré.  En général, un tas de fonctionnalités utiles pour de l'argent ridicule. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Eh bien, une comparaison avec l'ES8266 omniprésent et populaire</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zi/e4/fu/zie4fug9lfi3y2pvxuvtubvfyga.jpeg"></div></div><br><h2>  <b>Première partie, préparatoire</b> </h2><br><p>  Pendant que le routeur était sur le courrier, il était temps d'étudier les critiques des heureux propriétaires.  Les principaux problèmes rencontrés par la majorité sont les problèmes de surchauffe du routeur (et, par conséquent, de la «lame de puce») et l'instabilité de l'alimentation, lorsque le routeur ne peut pas démarrer pendant longtemps («indicateur» - deux LED sont faiblement allumées, il est impossible de se connecter à l'appareil via Ethernet). <br>  Pour lutter contre le premier problème, il a été décidé d'installer un radiateur sur la puce.  Pour ce faire, j'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">commandé de</a> petits radiateurs en aluminium de taille 12x12x3 mm (exactement la taille de la puce).  La hauteur de 3 mm a été choisie parce que je voulais que le radiateur en saillie ne colle pas aux objets (dans un sac, par exemple) et que la toupie puisse reposer de manière stable sur la table. </p><br><div class="spoiler">  <b class="spoiler_title">Voilà à quoi ressemblent les placers de radiateurs ...</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hv/ut/of/hvutofqkpygjf6z584zuogpo1h8.jpeg"></div></div><br><p>  Pour fixer le radiateur, j'ai décidé d'utiliser un adhésif thermofusible.  Parmi les produits disponibles dans notre région, il n'y avait qu'un Alsil-5 «unique», ce qui, malgré la conductivité thermique assez bonne, ne signifie pas du tout un stockage à long terme.  Il sèche en quelques jours (et si vous avez de la chance, vous pouvez acheter déjà séché).  Par conséquent, sur le même aliexpress, deux types d'adhésifs thermofusibles ont été commandés pour les radiateurs LED haute puissance - <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Halnziye HY910</a></b> et <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Hcbonyx HC-910</a></b> . </p><br><div class="spoiler">  <b class="spoiler_title">Adhésif thermofusible chinois vigoureux</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/t8/oz/3c/t8oz3cxfsxxdgescpbxqrixahea.jpeg"></div></div><br><p>  Les critiques à leur sujet dans les forums spécialisés ne sont pas mauvaises, bien que les experts recommandent toujours d'utiliser des adhésifs époxy thermofusibles à deux composants, tels que <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Thermopox 85CT,</a></b> pour les tâches sérieuses.  Mais allez le trouver encore ... <br>  Juste au cas où, je donnerai ci-dessous les caractéristiques comparatives des conductivités thermiques de la matière fondue chaude que j'ai utilisée, trouvées sur Internet. </p><br><blockquote>  Thermofusible Halnziye HY910 - Conductivité thermique 0,975 W / mK <br>  Adhésif thermofusible Alsil-5 - conductivité thermique 1,4-1,6 W / mK <br>  Adhésif thermofusible HCBonyx HC-910 - conductivité thermique 1,7 W / mK </blockquote><br><div class="spoiler">  <b class="spoiler_title">Et la photo générale :)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dx/yn/w5/dxynw5hmybwxmhld-w_vnw9jjim.jpeg"></div></div><br><p>  Afin d'installer le radiateur, j'ai dû couper le boîtier (y compris pour améliorer le transfert de chaleur).  Pour tout faire aussi précisément que possible, la première chose que j'ai faite a été de dessiner les dimensions du carton sur du papier épais, de découper un trou pour la puce, puis de mettre ce gabarit en carton dans le boîtier.  Ensuite, tout est simple - dessinez les contours du trou avec un crayon, coupez-le avec un couteau de bureau et broyez la lime. </p><br><img src="https://habrastorage.org/webt/9q/o-/nl/9qo-nlm0e9vzad5o_sfsifzcjh8.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Marquage et rognage du boîtier en plastique pour le radiateur 12x12</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/eh/1g/c-/eh1gc-i_lgdpe2tqwgqirx3re58.jpeg"><br><img src="https://habrastorage.org/webt/83/zi/i5/83zii5m42wo-pk-y8ieffpyqy4o.jpeg"><br><img src="https://habrastorage.org/webt/ps/im/5p/psim5pqhpvvxwdrqhayszjckn-k.jpeg"></div></div><br><p>  Parallèlement à l'installation du radiateur, <u>il est nécessaire de</u> souder le condensateur SMD céramique <b>10 uF 6,3 V</b> manquant au routeur dans le circuit convertisseur 3,3V.  (sur les conseils de l'utilisateur <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">return1</a></b> ).  L'emplacement d'installation est indiqué dans l'image: </p><br><img src="https://habrastorage.org/webt/el/nl/kq/elnlkqdn_wmebw8rhecg8pxdwqk.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Et voici une carte avec un condensateur 10 microfarad 6,3 V déjà installé</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_h/zi/bw/_hzibwbg-ou98na-zzxksay1j2k.jpeg"></div></div><br><p>  Selon les avis, la consommation actuelle de l'appareil diminue et devient plus stable.  Vraisemblablement, dans le convertisseur 3,3 V, des ondulations apparaissent sur la sortie qui désactivent le processeur.  Le condensateur atténue ces ondulations. </p><br><p>  <b>Important!</b>  <u>Essayez d'installer le radiateur et de souder le condensateur AVANT de démarrer et d'utiliser le routeur.</u>  Sinon, il se peut que Borjomi soit trop tard pour boire ... </p><br><p>  Les gens résolvent le problème de l'alimentation en installant des puces de moniteur d'alimentation spécialisées, au lieu de la chaîne RC standard du routeur, par exemple, <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">KR1171SP28</a></b> , <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">DS1816</a></b> ou <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MAX809TTR</a></b> .  J'ai tout de suite aimé l'option d'utiliser les superviseurs de puissance Maxim.  Les deux tâches principales que les superviseurs peuvent résoudre sont de maintenir le contrôleur dans l'état de réinitialisation jusqu'à ce que la tension d'alimentation atteigne la valeur définie et se stabilise, ou de réinitialiser le contrôleur lorsque la tension d'alimentation tombe en dessous d'un niveau critique ou lorsque la tension chute soudainement.  Parmi les avantages de ce type de superviseur, on peut noter qu'aucun composant supplémentaire n'est requis pour installer le microcircuit, et en termes de taille, ce dispositif semi-conducteur tombe à la place des éléments retirés (oui, vous devez d'abord supprimer les résistances et condensateurs inutiles, puis passer en revue tresse sur coussinets). </p><br><img src="https://habrastorage.org/webt/am/hn/he/amhnhetbzfafmcqmfgi_o6glivu.jpeg"><br><p>  La recherche sur aliexpress n'a rien donné, mais elle a fait une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">recherche</a> dans le catalogue CHIPiDIP, où les <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">shapers d'</a></b> impulsions <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MAX809TEUR + T</a></b> (avec une tension de réinitialisation de 3,08 volts) ont été trouvés, dont l'un a été soudé avec succès au routeur. </p><br><img src="https://habrastorage.org/webt/tf/gh/jo/tfghjovrvng4-1fhq2zcvxdolym.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Réglage du shaper d'impulsion (reset) MAX809TEUR + T</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wx/mz/v8/wxmzv8tumrwenm-8dwdbzv7yss0.jpeg"><br><img src="https://habrastorage.org/webt/is/zf/es/iszfeso0wlsatspn29hw_bgc6ei.jpeg"><br><img src="https://habrastorage.org/webt/2s/mu/fb/2smufbcg314dg5sjpjgmd_r3p2e.jpeg"></div></div><br><p>  Soit dit en passant, je ne peux m'empêcher de mentionner le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">fer à souder USB</a> chinois, sans lequel je n'aurais jamais tourné cette procédure (même avec un micro-ondes loué ...). <br>  Afin de ne pas gaspiller un fer à souder, j'ai en même temps décidé de souder un bloc de contact aux plots de contact de la console UART (talons) pour simplifier la connexion avec les fils dupont des designers Arduino.  Pads pads idéalement assortis avec un pas de contact de 2 mm (les standards répandus de 2,54 mm sont déjà larges).  Ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sont</a> , par exemple.  Pour le rendre plus pratique à souder, à l'aide d'une pince à épiler, j'ai plié les extrémités des contacts avec la lettre G et étamé les taches sur la carte du routeur. </p><br><div class="spoiler">  <b class="spoiler_title">Préparation de la console UART</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5h/6z/qy/5h6zqycmpexzy4qouhlmy3rx8qu.jpeg"></div></div><br><p>  Il suffisait ensuite d'installer le bloc sur les talons et de réchauffer légèrement la jonction jusqu'à ce que la soudure fonde.  Il est important de ne pas en faire trop (ce qui est facile à faire avec un fer à souder puissant), sinon les porcelets peuvent simplement tomber d'une surchauffe.  Dans ce cas, l'image montre les points de test de sauvegarde où vous pouvez souder. </p><br><img src="https://habrastorage.org/webt/gz/6i/ib/gz6iibr3eakny3pr1sacg2kcxl0.jpeg"><br><p>  Au fait, vous pouvez souder les contacts avec une autre méthode, mais le boîtier ne peut pas être fermé comme ça. </p><br><img src="https://habrastorage.org/getpro/habr/post_images/5e7/b7c/02a/5e7b7c02ac8b291e046e30f39983fb6b.jpg" alt="Soudage alternatif des contacts UART"><br><p>  Sur ce, la partie préparatoire s'est terminée et la partie principale a commencé. </p><br><h2>  <b>Deuxième partie, "Programmeur"</b> </h2><br><p>  Comme je l'ai mentionné au début de l'article, le routeur a peu de mémoire, seulement 4 Mo.  Bien sûr, quelqu'un peut se rappeler que "640 Ko devraient suffire à tout le monde".  Mais après avoir passé une semaine à essayer de mettre tous les packages nécessaires (et il y a 8 Mo (!)) Dans l'openwrt auto-assemblé pour D-Link DIR-320, je sais maintenant que cela ne vaut pas la peine d'économiser sur la mémoire.  Par conséquent, il a été décidé de changer le flash pour un plus spacieux et en même temps d'avoir un coût raisonnable (afin de ne pas être plus cher que le routeur lui-même).  Des puces avec une fréquence effective (fréquence d'horloge SPI) d'au moins 100 MHz et une tension d'alimentation de 3,3 V sont nécessaires pour le remplacement. Des fabricants - Winbond ou tout autre (En = Eon, Mx = Macronix, Pm = PMC, At = Atmel).  D'après ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">que</a> conseille <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">openwrt.org</a></b> , <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">W25Q128BV</a></b> , MX25L128 (35F), S25FL128P, S25FL129P, GD25Q128C, GD25Q128CSIG.  Le chiffre 128 dans le marquage nous indique que le volume du lecteur flash est de 16 Mo (128 Mo = 16 Mo).  Le choix de la taille nominale est dû au fait qu'un programmeur chinois bon marché de puces de mémoire 24/25 CH341A (à ce sujet ci-dessous) peut fonctionner avec un tel volume sans danser avec un tambourin.  Pour les fans, je peux dire que 32 Mo peuvent être soudés (par exemple, W25Q256FV, MX25L25635F, N25Q256A, MX25L25645GM2I-10G et même 64 Mo (MX25L51245G, MT25QL512AB). Cependant, je voudrais noter que les étiquettes de prix pour la mémoire sont loin d'être humaines pour les modules de 64 Mo. Je noterai qu'en parlant de puces de mémoire UNIQUEMENT dans le package SOP8, qui est le plus pratique pour le soudage, vous pouvez bien sûr prendre des puces dans des cas <a href="" rel="nofollow">WSON8</a> avec des plots de contact au lieu de pattes, mais le soudage prend trop de temps et le résultat peut ne pas répondre aux attentes. <br>  Vous pouvez flasher une puce mémoire de différentes manières, selon ce qui est disponible: <br>  <b>a)</b> Il y a une diode / condensateur et un port parallèle (le programmeur le plus simple) - nous regardons les instructions du firmware sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">site tchèque</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">en russe</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Donc, ce programmeur le plus simple à partir d'un connecteur LPT et de quelques détails ressemble à la vie</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/0b3/75b/184/0b375b184a2556dc41d71edc6567a01a.jpg" alt="image"></div></div><br><p>  <b>b)</b> Il y a des Arduino (Pro, Micro, Nano, etc.) - nous préparerons d'eux un programmeur pour nos lecteurs flash SPI selon la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">recette</a> suivante. <br>  <b>c)</b> S'il y a un Raspberry Pi - regardez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> <br>  <b>d)</b> Il y a un programmeur USBASP "populaire" (qui a déjà été <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">écrit</a> sur Habré) - nous le préparons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">selon la recette n ° 2</a> . <br>  <b>e)</b> Il n'y a qu'un désir et un peu d'argent - nous achetons sur aliexpress un programmateur chinois CH341A pour flash 24/25 SPI et commençons tranquillement à travailler. </p><br><p>  Le lecteur flash lui-même est connecté au (x) programmeur (s) comme suit: </p><br><div class="spoiler">  <b class="spoiler_title">Brochage de la puce mémoire</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/dca/bff/40e/dcabff40e2b61ec33aa98f88f0409b42.jpg" alt="image"></div></div><br><p>  Le lecteur flash peut être soudé et connecté aux pads / adaptateurs du programmateur, ou vous pouvez y souder les fils dupont déjà mentionnés d'Arduino, et connecter les fils au programmeur déjà.  Le "fonctionnement" du flash sont les contacts <b>MISO</b> , <b>MOSI</b> , <b>CLK</b> , <b>CS</b> , <b>VCC</b> et <b>GND</b> .  Si la programmation est effectuée sans retirer le microcircuit de la carte, il est préférable de dessouder et de soulever légèrement le contact VCC sur le plan de la carte pendant un certain temps.  Après avoir terminé le travail, appuyez le pied sur la planche et soudez-le. <br>  Comme je n'avais pas envie de chercher un port LPT, j'ai décidé de suivre la dernière option e) et d'acheter une pièce de fer supplémentaire dans mon parc.  Cette chose s'appelle <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">CH341A</a></b> et, étrangement, est un programmeur basé sur la puce CH341, derrière la création de la mégacorporation chinoise "largement connue" <i>Jiangsu QinHeng Ltd.</i>  :) </p><br><div class="spoiler">  <b class="spoiler_title">Schéma du circuit du programmeur</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/f08/a0a/cfc/f08a0acfc6a62d2da36c2cb6ef343f75.png" alt="image"></div></div><br><p>  Lorsque vous commandez <u>uniquement un</u> programmateur, je vous recommande fortement d'acheter en plus un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">adaptateur</a> des boîtiers SOP8 / SOIC8 aux boîtiers DIP et un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">clip-clip</a> pour travailler avec des microcircuits. </p><br><div class="spoiler">  <b class="spoiler_title">Adaptateur et clip</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ue/_x/to/ue_xtorv84tzvamgbymbnqro7xs.jpeg"><br><img src="https://habrastorage.org/webt/oz/il/un/ozilun0uq6m46zsevdh1lrqkchs.jpeg"></div></div><br><p>  Vous ne pouvez pas rechercher des économies limitées, mais achetez immédiatement un kit prêt à l'emploi, composé d'un programmateur et de tous les adaptateurs nécessaires, puis en plus des deux adaptateurs mentionnés ci-dessus, vous obtiendrez également un adaptateur pour programmer des puces 1,8 V. </p><br><div class="spoiler">  <b class="spoiler_title">Cela ressemble à un kit prêt à l'emploi</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yh/jk/tm/yhjktmqetzttqjomgedd3ntzi84.jpeg"></div></div><br><p>  D'après ma propre expérience, je dirai que le clip de la pince à linge fonctionne une fois sur deux et que la puce devra probablement être non soudée et insérée dans l'adaptateur SOP8-DIP ou même soudée aux tampons du programmateur lui-même. </p><br><p>  <u>Addition</u> : enfin mon adaptateur est venu, ou comme on l'appelle correctement l' <b>adaptateur ZIF SOP8-DIP8 150 mil</b> .  Cet adaptateur convient aux microcircuits avec une largeur de boîtier de 150mil, un pas de broches de 1,27 mm.  En plus de 150 mil, il peut y avoir 200 mil, il est donc important de faire attention à cela lors de la commande aux enchères (j'ai des puces et les mêmes, donc il y a deux adaptateurs). </p><br><div class="spoiler">  <b class="spoiler_title">Comment distinguer visuellement l'adaptateur ZIF 150 et 200 mil</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/i0/3r/e7/i03re7tib25lkpzkodmp_qantwg.jpeg"></div></div><br><p>  La pièce est incroyablement pratique, le microcircuit se serre facilement, naturellement et très clairement (le système ressemble à une pince).  Pour ce faire, cliquez simplement sur la partie supérieure élastique du boîtier, placez la puce sur les zones exposées et relâchez cette partie du boîtier.  Les contacts supérieurs à ressort s'étendent lorsqu'ils sont libérés et le microcircuit se serre automatiquement (photo pour plus de clarté, car le microcircuit de 200 mil se trouve dans l'adaptateur de 150 mil, donc je ne l'ai pas frappé, je l'ai coincé à portée de main).  Ensuite, nous l'installons dans le programmateur, en regardant où nous avons le pied 1 (un cercle sur la puce).  Il se présente comme ceci: </p><br><img src="https://habrastorage.org/webt/nx/3g/ft/nx3gftuwoq2chvdsrzsv_fbeyrw.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Plus belles photos de SOIC8 SOP8 sur l'adaptateur DIP8</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tc/ex/za/tcexzaa6jeafqpqnot33s8uhz58.jpeg"><br><img src="https://habrastorage.org/webt/pk/cu/fx/pkcufxejj7qt1yile91pfcj1-fa.jpeg"><br><img src="https://habrastorage.org/webt/ti/m7/0r/tim70ro7wotbs7fqn4qxttbkeew.jpeg"><br><img src="https://habrastorage.org/webt/lv/rp/rj/lvrprjzm16nwaqssjls2hhz2use.jpeg"></div></div><br><p>  J'ai tiré une puce de mémoire native à l'aide d'une station de soudage à air chaud, et pour ceux qui ne disposent pas d'un tel équipement, je recommande fortement d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">utiliser la méthode de l'alliage Rose</a> .  Après le travail, assurez-vous d'enlever les restes de l'alliage Rose avec une tresse de la carte et des microcircuits, loin du péché. <br>  Nous connectons le microcircuit retiré au programmeur (pour qui comment et comment cela se passe).  J'étais trop paresseux pour souder, j'ai honnêtement essayé de pincer le clip, par conséquent, les jambes étaient très aplaties par le ressort du clip.  Mais je n'avais pas l'intention de souder le flash de 4 Mo, mais un bon contact devrait assurer une lecture fluide.  Et c'est arrivé.  Nota bene pour ceux qui soudent le microcircuit - regardez attentivement les numéros sur les cartes adaptatrices et soudez conformément à ceux-ci.  Dans le cas d'un clip, le fil rouge sur le porte-clés se trouve sur le pied numéro 1. </p><br><img src="https://habrastorage.org/webt/l4/cr/g9/l4crg92dn4etg-xkngb70iewduy.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Capturé et réussi à partir de ...</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/78/jt/hu/78jthurktjxlqllhydakdoxr5yw.jpeg"><br><img src="https://habrastorage.org/webt/ff/9l/os/ff9losgpei2qnttiqayqdwx8y-y.jpeg"><br><img src="https://habrastorage.org/webt/rv/wy/cc/rvwyccyq1zt2jzdccw9wihwl4je.jpeg"><br><img src="https://habrastorage.org/webt/gc/nj/wm/gcnjwmaue1x9hw3wb1nv_jdcofs.jpeg"></div></div><br><p> Après avoir traité du fer, vous devez vous occuper des logiciels.  Comme je l'ai déjà écrit, sur un hub, ce programmeur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">apparaît</a> périodiquement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans les articles</a> .  Il est clair que cela fonctionne sans problème avec tous les systèmes d'exploitation modernes (par exemple, dans Windows 10, les pilotes sont automatiquement extraits du réseau, et sous Linux, ils sont dans le noyau depuis plusieurs années).  Mais, mais vous ne savez jamais ce qui se passe, vous pouvez trouver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> des pilotes (pour le mode série / parallèle) sous forme de fichiers séparés au cas où.  Pour la programmation sous Windows, la paternité du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">logiciel chinois</a> d'un certain SkyGz est le plus souvent utilisée.  Pour Linux, il existe des projets ouverts <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ch341prog</a> (SPI) et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ch341eepromtool</a> (I2C), vous pouvez utiliser le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">flashrom</a> "folk".  Étant donné que j'utilise Windows et que les critiques sur le "programme chinois" pour la plupart des utilisateurs ne sont pas très positives (en particulier sur les nouvelles versions 1.28 ... 1.30), afin que le destin ne soit pas tenté, la puce a été lue à l'aide d'un programmeur <i>russe</i> <b>AsProgrammer</b> simple et fiable. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">version 1.4.0</a> .  Soit dit en passant, si quelque chose n'a soudainement pas aimé quelque chose / ce n'est pas clair, ou par exemple, vous devez ajouter un nouveau microcircuit, vous pouvez facilement écrire dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">rubrique "support technique"</a> et obtenir des commentaires rapides. </p><br><div class="spoiler">  <b class="spoiler_title">Pourquoi ne vaut-il PAS la peine d'acheter une mémoire flash de plus de 16 Mo</b> <div class="spoiler_text"><p>  Je vais me permettre une légère digression et expliquer ma réticence à installer un lecteur flash de 32 Mo (la différence de prix par rapport à 16 Mo n'est pas critique).  Le fait est que ni dans les programmes chinois (versions 1.29 ou 1.30), ni dans le support AsProgrammer mentionné pour les micropuces ala W25Q256FV, MX25L25635F, N25Q256A, MX25L25645GM2I-10G.  La raison en est peut-être que pour un flash SPI, la quantité maximale est de 128 Mo (le maximum qui peut être adressé avec le mode d'adressage à 3 octets adopté par JEDEC).  Et ici, il n'y a pas tant d'options.  Par exemple, vous pouvez écrire en utilisant le flashrom modifié la première moitié de la puce w25q256 (taille 16 Mo), comme la puce w25q128 familière à ce programme 16 Mo et mettre le chargeur de démarrage correct (Race, par exemple) et les sections d'usine avec des informations de "service" dans ce volume (mac Adresse du routeur, étalonnage Wi-Fi, etc.).  Et après avoir déjà démarré en mode bootloader (en cas de reconnaissance réussie par lui de tout le volume du microcircuit) - il serait possible d'en flasher un firmware pré-compilé.  Vous pouvez généralement acheter des lecteurs flash pour l'avenir et attendre que la prise en charge de ces volumes apparaisse dans les versions cassées du logiciel chinois pour ch341a ou lorsque le flashrom est terminé.  Pour résumer, il vaut mieux prendre 16 Mo :) car "fatigué de tendre la main vers les étoiles, ramassez ce qui se trouve sous vos pieds". </p></div></div><br><p>  Travailler avec AsProgrammer est extrêmement simple, sélectionnez d'abord votre puce dans le menu "Puce", puis cliquez sur le bouton "Lire".  Quelques minutes et une décharge dans notre poche :) </p><br><div class="spoiler">  <b class="spoiler_title">Lecture du vidage de la puce d'usine de 4 Mo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/fx/dr/wq/fxdrwq3lxdmgv1ckg3t_77njosu.jpeg"></div></div><br><p>  Flash complet en usine comprend un chargeur de démarrage, une paire de sections pour stocker différents paramètres et le firmware lui-même. </p><br><div class="spoiler">  <b class="spoiler_title">Structure du firmware d'usine de 4 Mo</b> <div class="spoiler_text"><p>  0x00000000-0x00030000: "Bootloader" <br>  0x00030000-0x00040000: "Config" <br>  0x00040000-0x00050000: "Usine" <br>  0x00050000-0x0011282a: "Kernel" </p></div></div><br><p>  Le fichier de vidage enregistré doit être ouvert dans n'importe quel éditeur HEX (j'ai l'habitude d'utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">WinHex</a> ) et à l'adresse <b>105720</b> (l'adresse en décimal, en hexadécimal ce sera 00019CF8) nous changeons <b>40 00</b> en <b>00 01</b> pour 16 Mo de flash (enfin, ou <b>80 00</b> si tout à coup, vous décidez d'économiser un centime et d'acheter une puce de 8 Mo).  Nous enregistrons le firmware modifié pour une utilisation future.  Soit dit en passant, l'adresse 105720 n'est pas le point d'une sorte de pièce jointe et d'autres numéros peuvent bien y être localisés, surtout si vous avez déjà essayé de déverrouiller le chargeur de démarrage pour le micrologiciel openwrt, etc. Par conséquent, si rien ne se passe, et le cher «40 00 "à l'adresse 105720 n'est pas visible, nous recherchons dans le menu de l'éditeur hexadécimal une recherche par valeurs HEX et y pilotons la combinaison d'octets" <b>00 00 16 40</b> ".  Cela conduira aux numéros / adresses souhaités. </p><br><div class="spoiler">  <b class="spoiler_title">Trouver la combinaison convoitée 00 00 16 40</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_c/js/3s/_cjs3slpz9l3l-pdbdo-m5uswnk.jpeg"></div></div><br><p>  Pourquoi était-ce nécessaire?  Et puis, pour que le chargeur de démarrage modifié vous permette de flasher le routeur via UART via TFTP, en utilisant un firmware plus grand. <br>  Ensuite, remplissez le micrologiciel enregistré dans un lecteur flash plus grand pré-acheté à partir de l'adresse 0 (depuis le début).  En cas de programmation réussie, soudez la puce de mémoire en place et passez à l'étape suivante.  Au fait, lors de la programmation d'un microcircuit acheté, je me suis senti désolé de le pincer avec un clip et j'ai dû le souder au bloc :) </p><br><div class="spoiler">  <b class="spoiler_title">Téléchargement du firmware</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/cd/ju/nz/cdjunzkbafv25r_ejw8u8eigpkk.jpeg"></div></div><br><h2>  <b>Troisième partie, openwrt-shnaya</b> </h2><br><p>  L'étape suivante consiste à créer votre propre version d'Openwrt.  Si je n'avais pas besoin de packages spécifiques qui ne peuvent pas être trouvés dans le firmware sysupgrade officiel existant (et «des passionnés»), alors vous pouvez simplement télécharger la première version disponible du firmware pour votre modèle de routeur et le charger via de grandes puces de mémoire modifiées ALREADY bootloader ou à l'ancienne pour utiliser le programmeur ci-dessus.  Mais j'ai besoin d'incorporer des packages inhabituels dans le firmware de mon routeur, j'ai donc dû aller plus loin et créer openwrt pour moi-même.  Cette procédure est assez bien décrite pour de nombreux modèles de routeurs (par exemple, pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tp-Link TL-WR741ND</a> sur Habré, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Tp-Link TL-MR3020</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">D-Link DIR320A1</a> , des milliers d'entre eux ...), je me limiterai donc à une brève liste des principales étapes (plus de détails peuvent être regardez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> ). </p><br><p>  S'il n'y a pas de machine * nix à la maison, alors la première chose que nous installons sur la VirtualBox est Ubuntu x64 (ou quelque chose). </p><br><p>  Mise à jour des informations sur les packages installés <br>  <i>mise à jour sudo apt-get</i> <br>  Installez le nécessaire.  Pour Ubuntu 16.04 LTS, cela ressemble à ceci: <br>  <i>sudo apt-get install build-essential subversion mercurial libncurses5-dev zlib1g-dev gawk gcc-multilib flex git-core gettext libssl-dev unzip</i> </p><br><p>  Copiez le code source du micrologiciel sélectionné sur votre ordinateur à l'aide de la commande <i>git clone</i> .  Sous le spoiler - liens vers les sources des différentes versions d'Openwrt. </p><br><div class="spoiler">  <b class="spoiler_title">Référentiels Git des projets OpenWrt et LEDE</b> <div class="spoiler_text"><p>  18/06/1 <br>  git clone git: //github.com/openwrt/openwrt.git -b v18.06.1 <br>  18/06/0 <br>  git clone git: //github.com/openwrt/openwrt.git -b v18.06.0 <br>  1 / 17,5 <br>  git clone git: //github.com/openwrt/openwrt.git -b v17.01.5 <br>  17/01/4 <br>  git clone git: //github.com/openwrt/openwrt.git -b v17.01.4 <br>  17/01/3 <br>  git clone git: //github.com/openwrt/openwrt.git -b v17.01.3 <br>  17/01/2 <br>  git clone git: //github.com/openwrt/openwrt.git -b v17.01.2 <br>  17/01/1 <br>  git clone git: //github.com/openwrt/openwrt.git -b v17.01.1 <br>  17/01 <br>  git clone git: //github.com/openwrt/openwrt.git -b v17.01.0 <br>  15/05/1 <br>  git clone git: //github.com/openwrt/archive.git -b v15.05.1 <br>  15.05 <br>  git clone git: //github.com/openwrt/archive.git -b v15.05 <br>  07/14 <br>  git clone git: //github.com/openwrt/archive.git -b v14.07 <br>  12.09 <br>  git clone git: //github.com/openwrt/archive.git -b v12.09 </p></div></div><br><p>  Le bien téléchargé sera déployé dans le répertoire openwrt.  Nous y allons avec la <i>commande cd</i> , échangeons et mettons à jour des composants supplémentaires avec la commande <br>  <i>./scripts/feeds update -a &amp;&amp; ./scripts/feeds install –a</i> <br>  Il est maintenant temps de corriger les "fichiers importants" afin que le compilateur puisse correctement assembler le firmware de notre lecteur flash agrandi, et ne pas caler s'il dépasse soudainement les 4 Mo <s>prescrits</s> .  Pour ce faire, procédez comme suit.  Dans le répertoire téléchargé avec les sources openwrt dans le fichier target / linux / ramips / dts / A5-V11.dts nous remplaçons par les valeurs indiquées dans l'image ci-dessous (j'ai utilisé l'éditeur nano, c'est aussi possible via F4 en mc). </p><br><img src="https://habrastorage.org/webt/qp/c0/hj/qpc0hjzebofk0k71mxd1ojj-jae.jpeg" alt="Modification du fichier * .dts pour une mémoire accum (pour le 15/05/1)"><br><p>  Enregistrez le fichier, exécutez dans la console <br>  <i>faire defconfig</i> <br>  et appliquez les paramètres standard pour le profil, puis <i>faites menuconfig</i> .  Ici, le principal point clé est de choisir le bon profil: </p><br><blockquote>  Système cible: Ralink RT288x / RT3xxx <br>  Sous-cible: cartes basées sur RT3x5x / RT5350 <br>  Profil cible: A5-V11 </blockquote><p>  puis - par analogie avec l'assembly openwrt pour les autres routeurs (j'ai donné les liens ci-dessus), nous modifions l'ensemble des packages de la manière dont nous avons besoin et enregistrons la configuration (dans le fichier <i>.config</i> ).  Soit dit en passant, si vous prévoyez de modifier fréquemment les configurations, vous pouvez effectuer une sauvegarde à chaque fois avec la commande <i>scripts / diffconfig.sh&gt; mydiffconfig</i> , nous enregistrons donc à chaque fois nos modifications de configuration dans le fichier mydiffconfig.  Après avoir fait la configuration nécessaire (et sélectionné tous les packages nécessaires), nous commençons la construction avec la commande <i>make</i> . <br>  En raison de l'auto-compilation du noyau, vous pouvez constater que de nombreux packages provenant de référentiels officiels ne conviennent pas à l'installation.  Ceci doit être pris en compte et plus souvent positionner le drapeau «M» devant le package souhaité.  Ensuite, ces packages peuvent être trouvés dans le dossier openwrt / bin / ramips / packages et téléchargés sur un serveur HTTP pour créer votre propre référentiel de <s>blackjack</s> personnel <s>et ...</s> pour OpenWRT :). <br>  Soit dit en passant, je me suis souvenu qu'il était très pratique d'exécuter la commande <i>make</i> sous la forme suivante: <br>  <i>faire V = 99 2&gt; &amp; 1 |</i>  <i>tee build.log |</i>  <i>erreur grep -i</i> <br>  Dans ce cas, le compilateur enregistre une copie détaillée complète des informations de débogage sur l'assembly dans le fichier build.log dans le répertoire openwrt et affiche uniquement les erreurs à l'écran.  Ensuite, ce journal est commodément attaché aux forums pour trouver la cause de l'erreur ou poser une question.  En outre, il est idéal pour identifier les packages sur lesquels le compilateur cesse de fonctionner.  Vous pouvez trouver le texte mentionné dans le journal en recherchant le répertoire à l'aide de la commande <br>  <i>grep –Hr "TEXT" &lt;chemin d'accès au répertoire de recherche&gt; |</i>  <i>cut –d: -f1 |</i>  <i>trier -u</i> <br>  Mais j'espère sincèrement que la compilation sera réussie et qu'il n'est pas nécessaire de rechercher des erreurs.  Une fois le processus terminé, vous pouvez trouver les fichiers du firmware dans le dossier <i>bin du</i> répertoire openwrt, quelque chose comme <b>openwrt-ramips-rt305x-a5-v11-squashfs-sysupgrade.bin</b> .  Nous prenons ce fichier et passons à l'étape finale. </p><br><h2>  <b>Quatrième partie, console</b> </h2><br><p>  Une fois le firmware collecté dans les entrailles de la machine virtuelle, il ne reste plus qu'à le déposer dans le routeur.  J'aime l'option avec UART (ce n'est pas pour rien que j'ai soudé le tampon aux contacts nickels).  Pour vous connecter, vous avez besoin soit d'un adaptateur USB vers TTL UART, soit au moins d'un câble de données d'un ancien Siemens.  Heureusement, j'avais un tel adaptateur sur la puce FT232 (CP2102 et l'omniprésent CH340 conviennent également).  Le brochage est indiqué sur la photo. </p><br><img src="https://habrastorage.org/webt/pf/he/uh/pfheuh5510zu26jo5vu5mdfhi4k.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Brochages principal et de secours pour la console UART</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gz/6i/ib/gz6iibr3eakny3pr1sacg2kcxl0.jpeg"></div></div><br><p>  Nous connectons les contacts à l'adaptateur comme suit: </p><br><blockquote>  Routeur GND → Adaptateur GND <br>  Routeur RX → Résistance 470 Ohm-1 kOhm → Adaptateur TX <br>  Routeur TX → Adaptateur RX </blockquote><p>  Je vais expliquer pourquoi une résistance est nécessaire.  Lorsque j'ai allumé le routeur connecté à l'adaptateur, il s'est bloqué et a commencé à chauffer. </p><br><div class="spoiler">  <b class="spoiler_title">Alors tout est connecté ...</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ix/fc/ft/ixfcfttwh9-gsniex1hagvq4zys.jpeg"></div></div><br><p>  En même temps, quelque chose comme </p><br><blockquote>  ϟr▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒1▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒A▒▒ (0▒▒▒▒▒ <br>  ? ▒▒▒ {▒F▒▒▒▒▒ ^ ▒▒B▒▒▒KӉSP @ ▒ (Y &lt;0▒0▒ $ ▒ @ ▒▒▒ ▒▒▒ 怘 ▒▒ff▒▒▒▒▒`▒▒ ▒▒▒▒▒▒▒▒▒x▒▒x▒▒▒▒▒x ~ `▒▒ 怘 ▒▒▒▒▒x▒▒f▒▒▒▒▒f▒▒`ff▒▒▒▒▒▒▒ ▒▒fx▒▒▒f ~ f▒f▒▒`fxf▒▒▒▒`fx▒▒ ~ ▒x▒f▒▒f ~ f▒`▒f▒fx▒ ~ ▒f▒xf▒ ~ ▒▒fx ▒▒x▒▒▒xx▒▒▒▒xx▒▒▒▒x▒▒▒xf▒▒`x▒▒▒▒▒▒fxf▒x▒▒`▒▒▒f▒▒f▒▒f▒fxx▒ x▒ 枘 ▒x▒f▒▒ </blockquote><p>  La résistance (vous pouvez en connecter n'importe quel, dans la plage de 470 Ohms à 1 kOhm) a tout fixé.  Et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> , par exemple, l'auteur recommande généralement d'utiliser la puce d'isolateur de signal numérique <b>AduM1201</b> pour se connecter à l'UART pour le découplage.  Mais la résistance me suffisait, ce que je vous souhaite aussi. </p><br><div class="spoiler">  <b class="spoiler_title">UART et AduM1201</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/d5a/baf/390/d5abaf39038d0ddff09cd9d1323a7130.png" alt="image"></div></div><br><p>  Nous recevons le signal du routeur en utilisant le programme du terminal sur le PC.  D'une certaine manière, je n'ai pas réussi avec le favori de Putty, et j'utilise l'excellent programme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Terminal</a> .  Sélectionnez le port COM virtuel souhaité (sur lequel se trouve notre USB-UART), définissez les paramètres: </p><br><blockquote>  Vitesse: 57600 <br>  Bits de données: 8 <br>  Parité: aucune <br>  Stop Bits: 1 </blockquote><p>  Et cliquez sur Connecter.  Maintenant, lorsque l'alimentation est fournie au routeur, nous verrons les journaux du chargeur dans la console: </p><br><div class="spoiler">  <b class="spoiler_title">Bootloader enregistre A5-V11 tel quel</b> <div class="spoiler_text"><p>  U-Boot 1.1.3 (11 avril 2013 - 00:10:51) <br>  Carte: Ralink APSoC DRAM: 32 Mo <br>  relocate_code Pointer at: 81fb4000 <br>  spi_wait_nsec: 42 <br>  identifiant de périphérique spi: ef 40 18 0 0 (40180000) <br>  Attention: ID de puce non reconnu, veuillez mettre à jour le chargeur de démarrage! <br>  raspi_read: de: 30000 len: 1000 <br>  . *** Avertissement - mauvais CRC, en utilisant l'environnement par défaut <br>  ============================================== <br>  Version Ralink UBoot: 3.6.0.0 </p><br><hr><br><p>  ASIC 5350_MP (Port5 &lt;-&gt; Aucun) <br>  DRAM_CONF_FROM: Boot-Strapping <br>  DRAM_TYPE: SDRAM <br>  DRAM_SIZE: 256 Mbits <br>  DRAM_WIDTH: 16 bits <br>  DRAM_TOTAL_WIDTH: 16 bits <br>  TOTAL_MEMORY_SIZE: 32 Mo <br>  Composant Flash: SPI Flash <br>  Date: 11 avril 2013 Heure: 00: 10: 51 <br>  ============================================== <br>  icache: sets: 256, voies: 4, linesz: 32, total: 32768 <br>  dcache: sets: 128, voies: 4, linesz: 32, total: 16384 </p><br><h5 id="the-cpu-freq--360-mhz">  La fréquence du processeur = 360 MHz </h5><br><p>  estimation de la taille de la mémoire = 32 Mo <br>  Veuillez choisir l'opération: <br>  1: Charger le code système sur SDRAM via TFTP. <br>  2: Chargez le code système puis écrivez sur Flash via TFTP. <br>  3: démarrage du code système via Flash (par défaut). <br>  4: Interface de ligne de commande de démarrage Entr. <br>  7: Chargez le code du chargeur de démarrage puis écrivez dans Flash via Serial. <br>  9: Chargez le code du chargeur de démarrage puis écrivez dans Flash via TFTP. <br>  4 3 2 1 <br>  Vous en avez choisi 3 <br>  0 <br>  3: Code système de démarrage du système via Flash. </p><br><h2 id="booting-image-at-bc050000-">  Démarrage de l'image sur bc050000 ... </h2><br><p>  raspi_read: à partir de: 50 000 len: 40 <br>  .  Nom de l'image: MIPS OpenWrt Linux-3.7.5 <br>  Créé: 2013-04-11 14:41:22 UTC <br>  Type d'image: Image du noyau Linux MIPS (compressé lzma) <br>  Taille des données: 915849 octets = 894,4 ko <br>  Adresse de chargement: 80000000 <br>  Point d'entrée: 80 000 000 <br>  raspi_read: à partir de: 50040 len: df989 <br>  ... Vérification de la somme de contrôle ... OK <br>  Décompression de l'image du noyau ... OK <br>  Pas d'initrd </p><br><h2 id="transferring-control-to-linux-at-address-80000000-">  Transfert du contrôle vers Linux (à l'adresse 80000000) ... </h2><br><h2 id="giving-linux-memsize-in-mb-32">  Donner Linux memsize en Mo, 32 </h2><br><p>  Démarrage du noyau ... <br>  [0.000000] Linux version 3.7.5 (lich @ lich-pc) (gcc version 4.6.4 20121210 (version préliminaire) (Linaro GCC 4.6-2012.12)) # 2 Thu Apr 11 22:41:02 CST 2013 <br>  [0.000000] bootconsole [early0] activé <br>  [0.000000] La révision du processeur est: 0001964c (MIPS 24KEc) <br>  [0.000000] Ralink RT5350 id: 1 rev: 3 fonctionnant à 360,00 MHz <br>  [0.000000] Carte RAM physique déterminée: <br>  [0.000000] mémoire: 02000000 @ 00000000 (utilisable) <br>  [0.000000] Carte RAM physique définie par l'utilisateur: <br>  [0.000000] mémoire: 02000000 @ 00000000 (utilisable) <br>  [0.000000] Initrd introuvable ou vide - désactivation de initrd <br>  [0.000000] Plages de zones: <br>  [0.000000] Normal [mem 0x00000000-0x01ffffff] <br>  [0.000000] Début de la zone mobile pour chaque nœud <br>  [0.000000] Premières plages de nœuds de mémoire <br>  [0.000000] noeud 0: [mem 0x00000000-0x01ffffff] <br>  [0.000000] Cache d'instruction primaire 32 Ko, VIPT, 4 voies, taille de ligne 32 octets. <br>  [0.000000] Cache de données primaire 16 Ko, 4 voies, VIPT, pas d'alias, taille de ligne 32 octets <br>  [0.000000] Construction de 1 zones dans l'ordre des zones, regroupement de mobilité activé.  Nombre total de pages: 8128 <br>  [0.000000] Ligne de commande du noyau: board = MPR-A1 console = ttyS1,57600 mtdparts = spi0.0: 192k (u-boot) ro, 64k (u-boot-env) ro, 64k (factory) ro, 896k (kernel ), 2880k (rootfs), 3776k @ 0x50000 (firmware) rootfstype = squashfs, jffs2 mem = 32M <br>  [0.000000] Entrées de table de hachage PID: 128 (ordre: -3, 512 octets) <br>  [0.000000] Entrées de la table de hachage du cache Dentry: 4096 (commande: 2, 16384 octets) <br>  [0.000000] Entrées de table de hachage de cache d'inode: 2048 (ordre: 1, 8192 octets) <br>  [0.000000] __ex_table déjà trié, sautant le tri <br>  [0.000000] Écriture du registre ErrCtl = 00023ff6 <br>  [0.000000] Registre ErrCtl de relecture = 00023ff6 <br>  [0.000000] Mémoire: 29632k / 32768k disponibles (code du noyau 1969k, 3136k réservés, 473k données, 180k init, 0k highmem) <br>  [0.000000] SLUB: Genslabs = 9, HWalign = 32, Order = 0-3, MinObjects = 0, CPU = 1, Nodes = 1 <br>  [0.000000] NR_IRQS: 48 <br>  [0.000000] console [ttyS1] activée, console de démarrage désactivée <br>  [0.000000] console [ttyS1] activée, console de démarrage désactivée <br>  [0.010000] Calibration de la boucle de retard ... 239.61 BogoMIPS (lpj = 1198080) <br>  [0.080000] pid_max: par défaut: 32768 minimum: 301 <br>  [0.080000] Entrées de table de hachage de montage-cache: 512 <br>  [0.090000] NET: famille de protocoles enregistrés 16 <br>  [0.100000] MIPS: la machine est HAME MPR-A1 <br>  [0.130000] bio: créer la dalle &lt;bio-0&gt; à 0 <br>  [0.140000] Passage à la source d'horloge MIPS <br>  [0.150000] NET: famille de protocoles enregistrée 2 <br>  [0.160000] Entrées de table de hachage TCP établies: 1024 (ordre: 1, 8192 octets) <br>  [0.180000] Entrées de table de hachage de liaison TCP: 1024 (ordre: 0, 4096 octets) <br>  [0.190000] TCP: tables de hachage configurées (liaison 1024 établie 1024) <br>  [0.200000] TCP: enregistrement enregistré <br>  [0.210000] Entrées de table de hachage UDP: 256 (ordre: 0, 4096 octets) <br>  [0.220000] Entrées de table de hachage UDP-Lite: 256 (ordre: 0, 4096 octets) <br>  [0.230000] NET: famille de protocoles enregistrée 1 <br>  [0.280000] squashfs: version 4.0 (31/01/2009) Phillip Lougher <br>  [0.290000] jffs2: version 2.2 (NAND) (SOMMAIRE) (LZMA) (RTIME) (CMODE_PRIORITY) © 2001-2006 Red Hat, Inc. <br>  [0.320000] msgmni a été défini sur 57 <br>  [0.320000] io ordonnanceur noop enregistré <br>  [0.330000] Date limite du programmateur io enregistrée (par défaut) <br>  [0.340000] Série: pilote 8250/16550, 2 ports, partage IRQ désactivé <br>  [0.360000] serial8250: ttyS0 à MMIO 0x10000500 (irq = 13) est un 16550A <br>  [0.370000] serial8250: ttyS1 à MMIO 0x10000c00 (irq = 20) est un 16550A <br>  [0.390000] ramips-spi ramips-spi.0: le maître n'est pas mis en file d'attente, c'est obsolète <br>  [0.410000] m25p80 spi0.0: trouvé w25q128, pm25lq032 attendu <br>  [0.420000] m25p80 spi0.0: w25q128 (16384 Ko) <br>  [0.430000] 6 partitions cmdlinepart trouvées sur le périphérique MTD spi0.0 <br>  [0.440000] Création de 6 partitions MTD sur "spi0.0": <br>  [0.450000] 0x000000000000-0x000000030000: "u-boot" <br>  [0.460000] 0x000000030000-0x000000040000: "u-boot-env" <br>  [0.480000] 0x000000040000-0x000000050000: "usine" <br>  [0.490000] 0x000000050000-0x000000130000: "noyau" <br>  [0.500000] 0x000000130000-0x000000400000: "rootfs" <br>  [0.520000] mtd: la partition "rootfs" est définie comme étant le système de fichiers racine <br>  [0.530000] mtd: partition "rootfs_data" créée automatiquement, ofs = 380000, len = 80000 <br>  [0.550000] 0x000000380000-0x000000400000: "rootfs_data" <br>  [0.560000] 0x000000050000-0x000000400000: "firmware" <br>  [0.580000] ramips-wdt ramips-wdt: la valeur du délai d'attente doit être 0 &lt;délai d'attente &lt;= 35, en utilisant 35 <br>  [0.600000] TCP: cube enregistré <br>  [0.610000] NET: famille de protocoles enregistrés 17 <br>  [0.620000] 8021q: prise en charge de VLAN 802.1Q v1.8 <br>  [0.650000] VFS: racine montée (système de fichiers squashfs) en lecture seule sur le périphérique 31: 4. <br>  [0.660000] Libération de la mémoire du noyau inutilisée: 180 Ko libérés <br>  [5.100000] entrée: gpio-keys-polled as / devices / platform / gpio-keys-polled / input / input0 <br>  [5.210000] Button Driver Hotplug version 0.4.1 </p><br><ul><li>  preinit - Appuyez sur la touche [f] et appuyez sur [entrée] pour passer en mode de sécurité intégrée </li></ul></div></div><br><p>  Lors de la lecture et de la lecture des journaux, il est important de ne pas manquer l'instant et quand il y aura une telle ligne: </p><br><blockquote>  Veuillez choisir l'opération: <br>  1: Charger le code système sur SDRAM via TFTP. <br>  <b>2: Chargez le code système puis écrivez sur Flash via TFTP.</b> <br>  3: démarrage du code système via Flash (par défaut). <br>  4: Interface de ligne de commande de démarrage Entr. <br>  7: Chargez le code du chargeur de démarrage puis écrivez dans Flash via Serial. <br>  9: Chargez le code du chargeur de démarrage puis écrivez dans Flash via TFTP. </blockquote><p>  Vous devez rapidement avoir le temps d'appuyer sur le chiffre "2".  Ensuite, nous verrons ce qui suit: </p><br><blockquote>  Vous en avez choisi 2 <br>  2: chargez le noyau Linux puis écrivez sur Flash via TFTP. <br>  Attention !!!  Effacez Linux dans Flash puis gravez-en un nouveau.  Êtes-vous sûr? (O / N) <br>  Veuillez en saisir de nouveaux / ou Ctrl-C pour les éliminer <br>  IP du périphérique d'entrée (10.10.10.123) ==: 10.10.10.123 <br>  IP du serveur d'entrée (10.10.10.3) ==: 10.10.10.3 <br>  Entrez le nom de fichier du noyau Linux () ==: openwrt-ramips-rt305x-a5-v11-squashfs-sysupgrade.bin </blockquote><p>  Appuyez sur "Y" séquentiellement, entrez, entrez, "openwrt-ramips-rt305x-a5-v11-squashfs-sysupgrade.bin".  Dans ce dernier cas, il sera nécessaire d'enregistrer manuellement le nom de notre firmware, qui devra être téléchargé sur le serveur tftp précédemment lancé.  J'ai utilisé le programme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">TFTPD64</a> à cet effet.  Après avoir activé le téléchargement du firmware de la console, vous devez connecter notre A5-V11 à un ordinateur dont l'adresse IP correspond à celle spécifiée dans la console.  Au fait, pour me connecter directement (ala "clé USB"), je me suis fait les adaptateurs RJ45-RJ45.  Ils sont très pratiques à porter avec une toupie. </p><br><img src="https://habrastorage.org/webt/f0/w_/po/f0w_pobzhotseudg1x6xlvni1cm.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Adaptateurs RJ45-RJ45 et leur circuit</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/0k/t6/uo/0kt6uox6egepzraoly-dheq5tgk.jpeg"></div></div><br><p>  Le routeur sera cousu et après le redémarrage sera prêt à effectuer de nouvelles missions de combat.  Soit dit en passant, s'il n'était pas possible de flasher avec la console, nous revenons à la partie "programme" de l'article et <i>flashons le firmware openwrt-ramips-rt305x-a5-v11-squashfs-sysupgrade.bin</i> via le bon vieux AsProgrammer, mais pas à partir de l'adresse 0, mais à partir de l' <b>adresse 327680</b> ( !). </p><br><p>  Addition: vous ne pouvez pas bricoler avec la recherche d'octets et modifier le firmware natif, mais remplissez le programmeur avec une puce chinoise Breed d'un ami Hackpascal dans la nouvelle puce, pour notre V5 la dernière option trouvée est <a href="" rel="nofollow">race-rt5350-hame-a5-r1163.bin</a> .  Et déjà de ce meilleur (à mon humble avis) à ce jour, le chargeur de démarrage pour flasher tout ce dont vous avez besoin.  Il y a encore toutes sortes de goodies dignes d'un article séparé, MAIS, mais putain le firmware est absolument sans localisation, en chinois nu.  Il semble que les termes techniques soient clairs ... Mais les "sédiments sont restés".  Les Chinois, en principe, ne prennent pas contact :( </p><br><h2>  <b>Cinquième partie, Informations («Note»)</b> </h2><br><p>  À la fin de l'histoire, je voudrais dire quelques mots sur les appareils qui rendent l'utilisation de notre A5-V11 plus confortable. <br>  Tout d'abord, il s'agit d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">adaptateur en</a> forme de U à un port USB.  Un appareil indispensable, lors du partage d'un routeur avec un lecteur flash USB / lecteur de carte / modem 3G-4g / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">tuner SDR</a> enfin :) </p><br><img src="https://habrastorage.org/webt/bg/ap/5l/bgap5lzqe9lrpemvh0idnmjxvfk.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Les adaptateurs ont donc l'air en direct</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vv/f2/m2/vvf2m2qxfwjs8l9bt80r33am0su.jpeg"><br><img src="https://habrastorage.org/webt/ic/kh/ew/ickhewb9t5zk5hitjvwsm2pyha0.jpeg"><br><img src="https://habrastorage.org/webt/fl/s_/dn/fls_dnlec6lr9jvzox7zhvo75nc.jpeg"></div></div><br><p>  Le deuxième «jalon» important lorsque vous travaillez avec le mini-routeur décrit est un concentrateur USB.  Oui, avec une disposition très compliquée des ports USB.  L' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">agencement</a> vertical <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">de ce hub passif</a> pousse à l'achat de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">champignon</a> " Bluetooth sur certains <b>CSR8510</b> .  Depuis mon enfance, j'aime le concept des PC industriels d'Octagon - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MicroPC</a> - et leurs « <a href="" rel="nofollow">sandwichs</a> » PC / 104 verticaux.  Avec le hub mentionné, il est possible de faire quelque chose de similaire (en passant, si l'un des lecteurs a trouvé quelque chose de similaire intéressant sur les étendues des enchères en ligne - veuillez partager dans les commentaires). </p><br><img src="https://habrastorage.org/webt/rs/ae/hb/rsaehbkntj8po2vaekbtbck1s3i.jpeg"><br><p>  Carte à puce Genesys Logic Inc. GL8506 </p><br><img src="https://habrastorage.org/webt/ur/vv/ih/urvvihyci_7_ijtg72uh2d5ouxi.jpeg"><br><p>  En principe, au lieu d'un port USB vertical, il est tout à fait possible de placer le petit trousseau USB-Bluetooth décrit ci-dessus ou un <a href="" rel="nofollow">lecteur de carte microSD miniature</a> . </p><br><img src="https://habrastorage.org/webt/ls/z0/zn/lsz0znl2rw0uduejkp2o5gxduw8.jpeg"><br><p>  Et cela ressemble à un "sandwich micro-routeur" prêt à l'emploi :) </p><br><img src="https://habrastorage.org/webt/j2/wa/8i/j2wa8icidwqctodv-1w9583ugfk.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Plus de micro-habr-sandwichs</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zs/ym/x0/zsymx0wxkbikcbpni875i18rlhq.jpeg"><br><img src="https://habrastorage.org/webt/cf/bo/gw/cfbogwlqtzkcyfvdp_vz1grduvs.jpeg"><br><img src="https://habrastorage.org/webt/kd/vr/fr/kdvrfrwe3g40asb4rnsnsjsuhzc.jpeg"><br><img src="https://habrastorage.org/webt/4w/s1/2m/4ws12mhhgwlzecini07eq2qkmdy.jpeg"><br><img src="https://habrastorage.org/webt/v8/2b/ld/v82blds9z3lvqocypuoxp53yiwa.jpeg"><br><img src="https://habrastorage.org/webt/9e/am/rx/9eamrxfi3uexeuwp_qmwc1mwhyu.jpeg"></div></div><br><p>  Et enfin, le plus délicieux.  Il existe un tel bureau néo-zélandais <b>CloudStore dans le monde</b> qui est connu pour ses produits sous la marque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Airconsole</a> .  Ces appareils sont bons, entre autres, et le fait qu'ils sont les seuls en toute légalité et à un prix raisonnable à connecter toutes sortes d'enregistreurs RS232 à iOS.    ,         ,   RS232.       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . <br>         :) </p><br><blockquote>        COM/USB ,           Moxa*, Perle*  Opengear*? AirConsole            ,       . </blockquote><p>  ,  .    .   " 10 " :) </p><br><div class="spoiler"> <b class="spoiler_title"> Airconsole Mini (69$)  Hame A15 (6.9$)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_e/pu/8h/_epu8hgth9ljk2cxyasyeacupsg.png"><br><img src="https://img.tttcdn.com/product/xy/2000/2000/p/gu1/C/C1653B/C1653B-2-2ca5.jpg" alt="image"></div></div><br><div class="spoiler"> <b class="spoiler_title"> Airconsole Standart (79$)  Hame MPR-A1 (7.9$)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ov/7s/7q/ov7s7qphmxr9hoqlfjcd89ofmka.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/d5a/e07/9af/d5ae079af5f964aae4761175678f615c.jpg" alt="image"></div></div><br><div class="spoiler"> <b class="spoiler_title"> Airconsole XL (139$)  Hame MPR-A3 (13.9$)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tn/zt/ct/tnztctmox0g_ninvh8fnmvklwdg.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/f71/488/a87/f71488a8733c9dc21cab501d272c16a5.jpg" alt="image"></div></div><br><p>   ,            ,    .      :)    .     " <i>  .       .       ,       .   .   </i> ". </p><br><p>       "  A5-V11    Airconsole".  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"></a>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://go.mysku.ru/%3Fr%3D" rel="nofollow"></a>    Ham  6$  Airconsole  69$.  ,  Zyxel Keenetic 4G II   . </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Soit dit en passant, si tout à coup parmi les lecteurs il y a des propriétaires de l'AirConsol d'origine qui les ont déjà ouverts, je serai ravi d'accepter des tableaux photo en cadeau et de compléter l'article :) </font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, en principe, tout ce que je voulais dire. </font><font style="vertical-align: inherit;">Une grande partie de ce qui est écrit ici est applicable à d'autres matériels (compacts) et j'espère que cela sera utile au "large public" :)</font></font></p><br><p></p><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><img src="https://habrastorage.org/webt/s3/5l/vm/s35lvmfuuc9jd67i9gvfk5s67n0.jpeg"></a> </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ps Pour les propriétaires des NEXX WT3020F, TP-Link TL-MR3020, TP-Link TL-WR703N (c'est-à-dire tous les routeurs avec un boîtier assez spacieux) mentionnés au début de l'article, un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">concentrateur à</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> faible coût </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">sur la puce HS8836</font></a><font style="vertical-align: inherit;"> illustré ci-dessous </font><font style="vertical-align: inherit;">peut être une option très pratique pour l'intégration </font><font style="vertical-align: inherit;">:</font></font><p></p><br><img src="https://habrastorage.org/webt/lo/lu/gx/lolugxzv2bc1rsiwmf5zqlmywfw.jpeg"><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au cas où, le circuit trouvé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici est</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> montré sous le spoiler.</font></font></p><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schéma d'un hub chinois à 3 ports sur le HS8836</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/p1/2k/vc/p12kvcaidomhqn1ebmdpkqmgozq.png"></div></div><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le principal avantage, à mon avis, en plus de la taille miniature et du minimum de pièces, est le montage de la carte avec le contrôleur et les ports USB via des fils. </font><font style="vertical-align: inherit;">Pour une intégration dans le routeur - un minimum de mouvements du corps, bien que vous puissiez toujours installer une plaque de radiateur en aluminium sur la puce.</font></font></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ri/is/cg/riiscgsvp47h89tva4u-zsyc-aq.jpeg"></div><br><p> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise à jour de 2019</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : nous avons mis la main sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">refroidissement walti</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Détails sous le spoiler</font></font></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ap/0z/xz/ap0zxzmjdld3vt7c5k9j0xmwtww.jpeg"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plaque de refroidissement externe</font></font></b> <div class="spoiler_text"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tout d'abord, j'ai trouvé et découpé une plaque en aluminium adaptée d'une épaisseur de 1 mm </font></font></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hj/x4/ob/hjx4obx6spy6wcwbggecbg_vipo.jpeg"></div><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> J'ai percé des trous pour les vis M1 et coupé le filetage dans la plaque (j'attendais spécialement le taraud sur le M1) </font></font></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cq/v4/dc/cqv4dcflobaax_7mb0lptzdtune.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/z1/nq/kc/z1nqkcsteyk6fxkhth4gmjsoxfw.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cq/tz/j9/cqtzj9ko1ei5ibzyh-ljkg_qws0.jpeg"></div><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai essayé de resserrer davantage les écrous M1. </font><font style="vertical-align: inherit;">Accroché à ma poche, je n'aimais pas ça, alors j'ai refusé cette idée et j'ai simplement aiguisé les extrémités saillantes des vis.</font></font></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k8/on/zw/k8onzwkf21gc-aqcyfa8kumk6_a.jpeg"></div><br><p>      (  )     1,5    . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0w/dr/av/0wdravnl7ywqj7grbomcgc1lqdy.jpeg"></div><br><p>       —      </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gs/nv/bc/gsnvbcfktsoobwumeeqyztrftpo.jpeg"></div><br><p>        (  -  )   . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4-/cr/pg/4-crpg09gmggmcswvsudmnugy1g.jpeg"></div><br><p>    —  :). </p></div></div><br><p> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajout d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artem_kramov</font></font></a></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> concernant le wifi cassé lors du remplacement du flash. </font><font style="vertical-align: inherit;">Moral - garder un vidage complet et transférer la section de configuration avec les paramètres du module wifi</font></font></p><br><div class="spoiler">  <b class="spoiler_title">Plus de détails</b> <div class="spoiler_text"><blockquote> <strong></strong> :   -  Wi-Fi     .  4  ,  ,   8   Wi-Fi ( ).  ,    ,    . <br> <strong></strong> :  ,       Config (    ),        Wi-Fi.       Breed,    .  ,  Ethernet,   Config    Wi-Fi  .        -  ,     ,   -        . </blockquote></div></div><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Emplacement GPIO sur le routeur (extrait </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d'ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></p><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPIO A5-V11 (photo cliquable)</font></font></b> <div class="spoiler_text"><blockquote> Câblage GPIO sur A5-V11 <br><br>  Un exemple: <br>  22- - GPIO 22 est lié à Gnd <br>  25+ - GPIO 25 est lié à + 3,3 V <br><br>  sda, scl est préférable d'utiliser sur 21 et 26 (remplacer les résistances par Gnd, mettre 10kΩ).  Seulement sur ces derniers, lorsque le LCD 1602, 2004 est connecté et que l'alimentation est fournie, le routeur démarre normalement, sur les autres gpio, il est nécessaire de connecter l'alimentation du module un peu plus tard, sinon le routeur ne démarre pas. <br><br>  À 25 (w1), utilisez le capteur ds1820, car  il est déjà lié à + 3,3 V à 4,7 kOhm. <br><br>  Gpio 21 a d'abord calculé qu'il sortait sur le piston, soudé au piston (nano), mais il s'est avéré qu'il était assis sur le sol après 1kΩ pour une raison quelconque.  Puis il est allé à ce fil et l'a remplacé par gpio 26 avec 10kOhm. </blockquote><p></p><div style="text-align:center;"> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/zm/wr/jl/zmwrjlxicxzohywv_5vjrnvhgyo.jpeg"></a> </div><br><div style="text-align:center;"> <a href="" rel="nofollow"><img src="https://habrastorage.org/webt/jq/rl/hm/jqrlhmcjevpxpkvvcs4crfsfqgi.jpeg"></a> </div><p></p></div></div><br><hr><br><div class="spoiler">  <b class="spoiler_title">Sources utilisées</b> <div class="spoiler_text"><ul><li>  http://skproj.ru/hame-mpr-a1-proshivka-openwrt-i-apgrejd-fleshki-na-16-ili-8-megabajt/?doing_wp_cron=1472313516.0620179176330566406250 </li><li>  http://w3bsit3-dns.com/forum/index.php?showtopic=884713&amp; </li><li>  https://github.com/nofeletru/UsbAsp-flash/releases/ </li><li>  http://forum.easyelectronics.ru/viewtopic.php?f=17&amp;t=10947 </li><li>  http://my-embedded.blogspot.com/2013/12/mini-4g-router-rt5350f.html </li><li>  http://eko.one.pl/?p=openwrt-gpio2 </li><li>  https://habr.com/post/238713/ </li><li>  https://nm-projects.de/2017/09/analysis-of-mini-3g4g-wifi-wireless-router-a5-v11/ </li><li>  https://tuxotronic.org/wiki/tools/flashrom/ </li><li>  http://srr.cherkessk.ru/owrt/help-owrt.html </li><li>  https://tuxotronic.org/wiki/openwrt/rt5350/build-firmware/ </li><li>  https://mysku.ru/blog/aliexpress/27796.html </li><li>  https://habr.com/post/247513/ </li></ul></div></div><br><p>  <u>Important!</u>  Toutes les mises à jour et notes provisoires à partir desquelles les habr-articles sont correctement formés peuvent maintenant être vues dans mon <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">laboratoire de</a></b> télégramme66.  Abonnez-vous pour ne pas vous attendre au prochain article, mais pour être immédiatement au courant de toutes les recherches :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425281/">https://habr.com/ru/post/fr425281/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425269/index.html">Hackathon GAZ - comment toucher le géant de l'automobile</a></li>
<li><a href="../fr425271/index.html">WPA3 pourrait être plus sûr: avis d'expert</a></li>
<li><a href="../fr425273/index.html">Une autre façon d'utiliser Docker-compose</a></li>
<li><a href="../fr425275/index.html">12 conseils pour mettre à l'échelle Node.js</a></li>
<li><a href="../fr425279/index.html">Comment interviewer Google: quoi être, quoi ne pas passer</a></li>
<li><a href="../fr425283/index.html">Localisation infinie, ou comment nous traduisons une carte en temps réel</a></li>
<li><a href="../fr425285/index.html">Si vous n'embauchez pas le Jones, alors vous ne méritez pas les seigneurs</a></li>
<li><a href="../fr425287/index.html">Maisons FIAS dans PostgreSQL</a></li>
<li><a href="../fr425289/index.html">Orientation d'entreprise</a></li>
<li><a href="../fr425291/index.html">Les résultats du stage d'été 2018: ils ont balayé cinq cents pita shawarma. Et a survécu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>