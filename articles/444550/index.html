<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ùî üï∫üèæ ü•â A la cuesti√≥n de la divisi√≥n üë©üèæ‚Äçüåæ üöõ ü§±üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tuvimos la oportunidad de realizar un ejercicio t√°ctico peque√±o pero extremadamente interesante. 
 En el proceso de investigaci√≥n de un nuevo MK de un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A la cuesti√≥n de la divisi√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444550/"><h3>  Tuvimos la oportunidad de realizar un ejercicio t√°ctico peque√±o pero extremadamente interesante. </h3><br>  En el proceso de investigaci√≥n de un nuevo MK de una empresa conocida basada en la arquitectura Cortex-M4 (definitivamente escribir√© sobre esto m√°s adelante), surgi√≥ la pregunta de qu√© tan r√°pido puede funcionar la operaci√≥n de divisi√≥n entera en la implementaci√≥n de hardware.  El experimento a gran escala dio un resultado algo inesperado: dividir un n√∫mero de 32 bits por un n√∫mero de 32 bits se realiza en 3 ciclos de reloj de la frecuencia del procesador, bueno, no importa lo r√°pido que sea.  Result√≥ que esto ocurre solo con ciertos operandos, pero estudios posteriores han demostrado que nunca el tiempo para completar la divisi√≥n no excede las 7 medidas.  Los resultados obtenidos causaron un ligero apuro ("y esta no es una determinada forma de hablar, que no sabe lo que significa, sino un verbo muy espec√≠fico" - Divov, como siempre, es incomparable). <br><br>  Bueno, no puedes simplemente tomar y dividir r√°pidamente n√∫meros tan largos, es extra√±o as√≠, pero los hechos son obstinados.  Me imagin√© la imagen de que el presidente de la Federaci√≥n de Rusia me llamar√≠a a √©l ma√±ana y me planteaba la tarea de hacer que MK no fuera peor que la de ARM (estoy de acuerdo en que la imagen es delirante, pero no sucede en el mundo), pero lo miro desconcertado y entiendo que No podr√© hacer una divisi√≥n de tales n√∫meros en ese tiempo, y no cumplir√© con las expectativas que se me imponen (bueno, de hecho, siempre puedo comprar una licencia silenciosamente de ARM y pretender que invent√© todo yo mismo, muchos lo hacen, pero El PIB espera algo completamente diferente de m√≠, y luego, puedo enga√±arlo, pero es poco probable que lo haga). <br><a name="habracut"></a><br>  Y estaba triste porque los muchachos de ARM son mucho m√°s inteligentes que yo, y busqu√© ansiosamente en Internet para ver c√≥mo lo hacen.  No encontr√© ninguna informaci√≥n sobre el tiempo de ejecuci√≥n en el sitio web de ARM, en uno de los materiales en STM32 se indic√≥ que la divisi√≥n toma de 2 a 7 ciclos de reloj, que corresponde a las observaciones, pero no hay informaci√≥n sobre c√≥mo se hace esto. <br><br>  En general, el Internet omnipotente no ayud√≥ mucho, hay trucos con divisi√≥n por constante, escrib√≠ sobre ellos en una de las publicaciones, pero tenemos una situaci√≥n diferente, existe el algoritmo de Newton y su versi√≥n acelerada, pero claramente este no es el caso, hay un algoritmo basado en Transformada de Fourier, pero esto es para n√∫meros muy grandes y es poco probable que se complete en 7 ciclos incluso en la arquitectura ARM.  Tuve que idearlo yo mismo y se encontr√≥ una soluci√≥n, tan simple y obvia que se vuelve un poco vergonzoso el hecho de que esto no se hizo inmediatamente despu√©s de que se formul√≥ la tarea. <br><br>  Antes de ver mi decisi√≥n, le sugiero que encuentre la suya y luego la compare con la m√≠a, y si difieren, los espero en los comentarios. <br><br>  Entonces, ¬øc√≥mo dividimos r√°pidamente (en no m√°s de 7 ciclos) dos n√∫meros de 32 bits para obtener un resultado de 32 bits. <br><br>  Para empezar, recordamos c√≥mo la divisi√≥n en aritm√©tica binaria se lleva a cabo generalmente en <br>  forma cl√°sica  El algoritmo es bastante simple y directo: restamos el divisor del dividendo.  Si el resultado no es negativo (dividimos los n√∫meros sin signo), entonces hacemos que el siguiente d√≠gito del resultado sea igual a uno y consideremos el resultado como el pr√≥ximo dividendo; de lo contrario, el siguiente bit del resultado es 0. Antes de la siguiente medida, dividimos a la mitad el divisor (ya sea desplaz√°ndolo hacia la derecha o desplazar el dividendo a la izquierda) y reducir el peso de la broca en 2 veces (por cambios similares).  Por lo tanto, obtenemos un bit del resultado en un ciclo de reloj y toda la operaci√≥n durar√° 32 ciclos de reloj.  Todav√≠a hay un cambio inicial en este proceso, pero no afecta la evaluaci√≥n de la situaci√≥n en su conjunto.  Vamos a acelerar, pero ¬øc√≥mo? <br><br>  Observamos que el algoritmo resultante se parece mucho al funcionamiento de un ADC con una aproximaci√≥n secuencial y recordamos que existen otros m√©todos de conversi√≥n, mucho m√°s r√°pidos: conversi√≥n paralela.  ¬øY si ... <br><br>  Restaremos del divisor no solo el dividendo, sino el dividendo * 2 y el dividendo * 3 (al mismo tiempo, en tres sumadores), luego obtendremos tres bits (signos de resultados) de la informaci√≥n, que toman 4 valores diferentes, por lo que puede extraer 2 bits de ellos a la vez resultado.  A continuaci√≥n, extrapolamos un enfoque similar para 3.4.5 bits del resultado. <br>  Para obtener 5 bits de informaci√≥n por ciclo, necesitamos 31 sumadores, en cada uno de los cuales se realizar√° la operaci√≥n Dividend-Divisor * n (1-31), los signos del resultado se pasan a trav√©s del codificador e inmediatamente recibiremos 5 bits del resultado.  Luego cambiamos el dividendo por 5 d√≠gitos a la izquierda y repetimos hasta que est√© listo.  Entonces necesitamos 32/5 = 6.4 =&gt; 7 medidas para completar la operaci√≥n. <br><br>  Para trabajar, necesitamos 31 + x sumadores, parece ser mucho, pero ya los tenemos, porque tenemos una operaci√≥n de multiplicaci√≥n de 32 * 32 por ciclo, y para implementarlo no podemos prescindir de 32 sumadores (bueno, creo que s√≠ ... ), para que ya tengamos el equipo necesario, la √∫nica pregunta es construir un circuito de control y un mont√≥n de multiplexores para realizar un cambio r√°pido, pero esto es completamente solucionable. <br><br>  Entonces, la tarea de dividir en 7 pasos se ha resuelto, la pregunta sigue siendo: ¬øc√≥mo puede reducirse este tiempo? Porque en el MK estudiado puede ser menor que 7. La soluci√≥n es determinar el n√∫mero del d√≠gito m√°s significativo del dividendo (C) y el divisor (C) en la etapa de preparaci√≥n del algoritmo. inmediatamente quedar√° claro cu√°ntos bits altos del cociente son iguales a cero, de modo que podamos omitir la primera o varias fases del algoritmo.  Por ejemplo, si C &lt;3, entonces el resultado es inmediatamente cero y completamos la operaci√≥n, seguro que puede derivar una f√≥rmula para el n√∫mero de medidas, pero ya estaba aburrido. <br><br>  Curiosamente, la operaci√≥n udiv solo da el cociente, aunque el resto obviamente permanece en alg√∫n lugar dentro.  En principio, no es dif√≠cil obtenerlo en dos pasos, que se realiz√≥ en el fragmento estudiado del c√≥digo de la m√°quina ejecutando el divisor Divisible-Private * de pseudoc√≥digo, pero esto es para cualquier 2 pasos, ¬øpor qu√© no darlo inmediatamente en el par de registro? No s√© la respuesta a esto. una pregunta <br><br>  En general, conozca el PIB, d√≠gale que definitivamente haremos la divisi√≥n en MK si a√∫n le interesa. <br><br>  PD: Por cierto, cuando estaba buscando KDPV (como notaron, no lo encontr√©), not√© uno con la inscripci√≥n francamente incorrecta "No debe dividir por cero".  Debo decir con certeza que es posible dividir por cero, no se puede dividir.  Pero en serio, en diferentes arquitecturas se dividen entre cero de manera diferente, en x86 obtenemos una excepci√≥n (este es un error inolvidable 200), en algunos obtenemos un dividendo o cero, pero nunca he visto el n√∫mero entero m√°ximo.  En ARM n / 0 = 0/0 y resulta 0. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444550/">https://habr.com/ru/post/444550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444540/index.html">Intel est√° listo para comenzar la producci√≥n de memoria MRAM</a></li>
<li><a href="../444542/index.html">Transmisi√≥n en vivo y calendario de conferencias para SmartMail Conf: Machine Learning</a></li>
<li><a href="../444544/index.html">Algo sobre centros de datos distribuidos para empresas</a></li>
<li><a href="../444546/index.html">¬øC√≥mo y por qu√© trabajar m√°s lento? El m√©todo de Sergey Korolev</a></li>
<li><a href="../444548/index.html">Experiencia personal: c√≥mo participamos en la promoci√≥n de startups hispanas en Am√©rica Latina</a></li>
<li><a href="../444552/index.html">TDMS Fairway. Trabaja con experiencia</a></li>
<li><a href="../444554/index.html">La API RESTful JSON m√°s simple en Elixir</a></li>
<li><a href="../444556/index.html">El color de la luna y el sol desde el espacio en los valores de RGB y temperatura de color.</a></li>
<li><a href="../444558/index.html">¬øQu√© hay de nuevo en CUBA 7?</a></li>
<li><a href="../444560/index.html">Te invitamos a la conferencia "Nubes. Tendencias de la moda ‚Äù26 de marzo de 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>