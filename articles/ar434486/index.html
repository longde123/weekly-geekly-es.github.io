<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐พ ๐ซ ๐ช๏ธ ุจุทุงูุงุช ุงูููุงุก. Google Pay API for Passes in ASP.NET ๐จ๐ฟโ๐ฌ ๐ธ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฏุฎูุช ุชุทุจููุงุช ุชุฎุฒูู ุงูุจุทุงูุงุช ุงููุตุฑููุฉ ุญูุงุชูุง ุจุณุฑุนุฉ ุจูุถู Apple Wallet ู Google Pay. ุชุชูุญ ูู ููุชุง ุงูููุตุชูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฎุฏูุงุช ุงููุตุฑููุฉ ุ ุงูุนูู ูุน ุฃูู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจุทุงูุงุช ุงูููุงุก. Google Pay API for Passes in ASP.NET</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434486/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุฏุฎูุช ุชุทุจููุงุช ุชุฎุฒูู ุงูุจุทุงูุงุช ุงููุตุฑููุฉ ุญูุงุชูุง ุจุณุฑุนุฉ ุจูุถู Apple Wallet ู Google Pay.  ุชุชูุญ ูู ููุชุง ุงูููุตุชูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฎุฏูุงุช ุงููุตุฑููุฉ ุ ุงูุนูู ูุน ุฃููุงุน ุฃุฎุฑู ูู ุงูุจุทุงูุงุช - ุจุทุงูุงุช ุงูููุงุก ุ ุจุทุงูุงุช ุงููุฏุงูุง ุ ุชุฐุงูุฑ ุงูุฃุญุฏุงุซ ุ ุจุทุงูุงุช ุงูุตุนูุฏ ุฅูู ุงูุทุงุฆุฑุฉ ุ ุฅูุฎ. <br></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ga/ng/rq/gangrq7tlqwob2cmgxa1dydoasu.png"><br></p><br><p style=";text-align:right;direction:rtl">  ุฃุซูุงุก ุงูุนูู ูุฏู ุดุฑูุฉ ุชูุฏู ุฎุฏูุงุช ุดุจูุฉ ูุจูุนุงุช ูุจูุฑุฉ ุฅูู ุญุฏ ูุง ุ ุงุถุทุฑุฑุช ุฅูู ุฏูุฌ ุจุทุงูุงุช ุงูููุงุก ููุฐู ุงูุดุจูุฉ ูู Apple Wallet ู Google Pay.  ูุฅุฐุง ููุช ูุถุทุฑูุง ุฅูู ุงูุนุจุซ ูู Apple Wallet ููุฌุฑุฏ ุฃู ุทุจูุฉ ุงูุชูุงูู ูุชุนุฏุฏุฉ ุงููุธุงุฆู ุชูุงููุง ุ ููุน Google Pay ุชู ุจุฐู ูุนุธู ุงูุฌูุฏ ูุชู ุฅููุงู ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูู ูุญุงููุฉ ููุนุฑูุฉ ุงููุซุงุฆู ูุงูุนุซูุฑ ุนูู ุงูุฃุฏูุงุช ุงูููุงุณุจุฉ ูุชุทููุฑ ุงูุฏููู ุงูุฃูู ููููููู.  ุนูู ุงูุฑุบู ูู ุฃู ุจููุฉ ุงูุนูู ุจุดูู ุนุงู ูุงู ุฃุณุฑุน ุจูุซูุฑ ูู Apple Wallet ุ ููุฏ ูุถูุช ููููุง ูู ุงูุชุดุงู ููููุฉ ุจุฏุก ุงูุฎุฏูุฉ ุ ูุฐูู ูุง ุฃูุงูุน ุฅุฐุง ูุชุจ ุดุฎุต ูุง ููุงููุง ูุดุงุจููุง ูุจูู. <br><a name="habracut"></a><br></p><h2 style=";text-align:right;direction:rtl">  1. ุงูุนุชุงุฏ </h2><br>  ูุชู ุชูุซูู ุจุทุงูุงุช ุงูููุงุก ุจุงุณุชุฎุฏุงู ููุงููู - ูุฆุฉ ุงูููุงุก ููุงุฆู ุงูููุงุก. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>ูุฆุฉ ุงูููุงุก</i> ูู ููุน ูู ุงูููุงูุจ ูุฌููุน ุจุทุงูุงุช ุงูููุงุก.  ูุญุชูู ุนูู ุญููู ุดุงุฆุนุฉ ูู ุฌููุน ุงูุฎุฑุงุฆุท ุ ูุซู ููู ุงูุฎุท ุ ูุฑูุงุจุท ุฃุตูู ุงูุฑูุฒ ุ ูุงูุฎูููุงุช ุ ูุญููู ุงููุต ุ ููุง ุฅูู ุฐูู ุ ููููู ุงูุงุทูุงุน ุนูู ูุตู ูุงูู ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Loyaltyclass</a> <br></li><li style=";text-align:right;direction:rtl">  <i>ูุงุฆู ุงูููุงุก</i> - ูุซูู ูู LoyaltyClass.  ููุง ุฃูู ูุญุชูู ุนูู ุจูุงูุงุช ุจุทุงูุฉ ูุนููุฉ ูุนููู ูุนูู - ุฑูู ุงูุจุทุงูุฉ ูุงูุงุณู ูุงูุญููู ุงููุตูุฉ ุงูุฅุถุงููุฉ.  ุงููุตู ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Loyaltyobject</a> <br></li></ul><br>  ูู ุฃุฌู ุงูุญุตูู ุนูู ุจุทุงูุฉ ุ ูุฌุจ ุนูู ุงููุณุชุฎุฏู ุงุชุจุงุน ุฑุงุจุท ุงูุชูุณูู <br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">www.android.com/payapp/savetoandroidpay</a> <b>/ {JWT}</b></i> ุ ุญูุซ JWT ูู ุฑูุฒ ูููุฒ ูุญูู JSON ูุน ุจูุงูุงุช LoyaltyClass.  ูููู ูุธุฑูุง ูุฃู ุทูู ุนููุงู URL ูู ูููุฏ ุ ููู ุงููุณุชุญุณู ุฃู ุชูุดุฆ ุฃููุงู ูุฆุฉ ููุงุก ุฅุฐุง ูุงู ูููููุง ูุญุชูู ุนูู ุงูุนุฏูุฏ ูู ุงูุฃุญุฑู. <br><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุชุญุฏูุซ ุงูุฎุฑูุทุฉ ุจุณุจุจ ุชุบููุฑ ูู ุงููุงูุจ ุฃู ุงูุฃููุงุท ุฃู ุงูุญุงุฌุฉ ุฅูู ุฅุถุงูุฉ ุฃู ุชุบููุฑ ุญููู ูุตูุฉ ุ ููููู ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช.  ูู ุงูุถุฑูุฑู ููุท ุชูุจูุฉ ุทูุจ POST ุจุงุณุชุฎุฏุงู ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ ูู ุงูุฎุฑูุทุฉ ุ ุญูุซ ุชููู ุฎุฏูุงุช Google ุจูุฒุงููุฉ ุฌููุน ุชุทุจููุงุช ุงููุณุชุฎุฏููู ุงูุฐูู ูุฏููู ูุฐู ุงูุฎุฑูุทุฉ. <br></p><br><h2 style=";text-align:right;direction:rtl">  2. ุงูุฃุฏูุงุช ูุงููุซุงุฆู </h2><br><p style=";text-align:right;direction:rtl">  ุชุจูู ุฃู ุงููุดููุฉ ุชููู ูู ุฃู ุฌููุน ุงูุฃูุซูุฉ ุงููุงุฑุฏุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฎุงุตุฉ ุจูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Google Pay for Passes</a> ูุงูุช ูุฎุตุตุฉ ุญุตุฑููุง ููู ูู Java ู PHP ู Python ุ ููุฏ ุฃูุตุช ุงููุซุงุฆู ููุณูุง ุจุดุฏุฉ "ุจุงุณุชุฎุฏุงู ููุชุจุงุช ุงูุนููุงุก ูุชุจุณูุท ุนูููุฉ" ุงูุนูู ูุน API. <br></p><br><p style=";text-align:right;direction:rtl">  ุจุงุชุจุงุน ูุฐู ุงููุตูุญุฉ ุ ุฐูุจุช ุจุณุฑูุฑ ุฅูู nuget ุ ููู ููุชุจุฉ Google Pay ูู ุชูู ููุฌูุฏุฉ.  ูุงู Glory to Brin ุ ุงูุณุทุฑ ุงูุฃูู ูู Google ุจู "google pay for passes dotnet" ุ ุจุฅุฑุฌุงุน ุตูุญุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุจุงุช ุชุทุจููุงุช Google Pay API ูู Passes</a> ุ ุงูุชู ุนุซุฑุช ุนูู ูุง ุฃุญุชุงุฌ ุฅููู ุ ุนูู ุงูุฑุบู ูู ุชูุณูู ุฃุฑุดูู ZIP ุ ุญูุซ ูุงู ููุงู ูุดุฑูุน .net ูุน ูุฆุฉ ุชู ุฅูุดุงุคูุง ุ ููู ุนุจุงุฑุฉ ุนู ุบูุงู ูุจุฑูุงูุฌ Google Pay API - <a href="">Google Pay API for Passes Client Library</a> . <br></p><br><p style=";text-align:right;direction:rtl">  ุงุณุชูุงุฏุง ุฅูู ูุฌูุฏ ููู <i>Google.Apis.Walletobjects.v1.1.9.2.00.nuspec</i> ูู ุงููุดุฑูุน ุ ูุงู ูุดุฑ ุญุฒูุฉ nuget ูุง ูุฒุงู ุฌุฒุกูุง ูู ุฎุทุท ูุฑูู Google.  ุจุนุฏ ุฃู ูุชุญุช ูุฐุง ุงูููู ุจุญุซูุง ุนู ุงููุซุงุฆู ุ ูู ุฃุฌุฏ ุฃู ุดูุก ููููุณ ุ ูุชู ุฅุฑุณุงู ุจุนุถ ุงูุฑูุงุจุท ุงูุชู ูุงูุช ููุฌูุฏุฉ ูู ูุณู ุงููุตู ุฅูู ุตูุญุงุช ุบูุฑ ููุฌูุฏุฉ ุนูู ุงูุฅุทูุงู. <br><br></p><h2 style=";text-align:right;direction:rtl">  3. ุงูุญุตูู ุนูู ุฑูุฒ ุงููุตูู </h2><br><p style=";text-align:right;direction:rtl">  ูุจุฏุก ุงูุนูู ูุจุงุดุฑุฉ ูุน Google Pay API for Passes ุ ุชุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุฑูุฒ ูุตูู ุ ููุฐุง ุชุญุชุงุฌ: <br><br></p><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุญุตู ุนูู ุญุณุงุจ Google Merchant ุ ูุงูุฐู ููููู ุงูุญุตูู ุนููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> <br></li><li style=";text-align:right;direction:rtl">  ุฃูุดุฆ ุญุณุงุจ ุฎุฏูุฉ ุ ูุงุญุตู ุนูู ููู ุจู ุจูุงูุงุช ุงุนุชูุงุฏ - ูุณุชูุฏ json ุจู ุชูุงุตูู ุญุณุงุจ ุฎุฏูุฉ ุ ุจูุง ูู ุฐูู ุงููุนุฑู ุ ูุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุ ูุงูููุชุงุญ ุงูุฎุงุต ุ ุฅูุฎ.  ููุง ุชูุตู ุงููุซุงุฆู ุ ุชุญุชุงุฌ ุฅูู ุชุฎุฒูู ูุฐุง ุงูููู ูู ููุงู ุขูู. <br></li><li style=";text-align:right;direction:rtl">  ุฑุจุท ุญุณุงุจ ุงูุชุงุฌุฑ ูุญุณุงุจ ุงูุฎุฏูุฉ ูู Google Merchant Center <br></li></ol><br>  ุจุงุณุชุฎุฏุงู ูุฐุง ุงูููู ุ ููููู ุชุณุฌูู ุงูุฏุฎูู ุจุงุณุชุฎุฏุงู ููุชุจุฉ <i>Google.Apis.Auth.OAuth2</i> : <br><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">await</span></span></span><span class="hljs-function"> Task&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOAuthToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {         <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> serviceAccountFile = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty;         serviceAccountFile = ConfigurationManager.AppSettings[<span class="hljs-string"><span class="hljs-string">"GooglePayServiceAccountConfigPath"</span></span>];        <span class="hljs-comment"><span class="hljs-comment">/*              Credential, GoogleCredential              Service Account,   ,      scopes API,             */</span></span>         <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> credential = GoogleCredential.FromFile(serviceAccountFile)                            .CreateScoped(WalletobjectsService.Scope.WalletObjectIssuer);        <span class="hljs-comment"><span class="hljs-comment">/*        Access token        ,   GetAccessTokenForRequestAsync         ,               */</span></span>         <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> token = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> credential.UnderlyingCredential.GetAccessTokenForRequestAsync();         <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> token; }</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  4. ุฅูุดุงุก ุฎุฑูุทุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ุจุทุงูุฉ ููุงุก ุ ูุฌุจ ุนููู ุฃููุงู ุฅูุดุงุก ูุฆุฉ ููุงุก.  ูููู ุฅูุดุงุก ูุฆุฉ ุงูููุงุก ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ูุงุณุชุฎุฏุงู ูุงุฌูุฉ ุงูููุจ ุงูุฎุงุตุฉ ุจู Google Merchant Center.  ูุฌุจ ุฅููุงุก ุงูุงูุชูุงู ูุงุณู ุงููุฆุฉ ุ ุญูุซ ูุฌุจ ุฃู ูููู ูุฐุง ุงูุงุณู ูุฑูุฏูุง ูู ุจููุฉ Google Pay ุงูุฃุณุงุณูุฉ. <br><br>  ุจุนุฏ ุฅูุดุงุก ูุฆุฉ ุงูููุงุก ุ ููููู ุฅูุดุงุก ูุงุฆู ุงูููุงุก.  ููููุงู ุจุฐูู ุ ุณุชุญุชุงุฌ ุจุงููุนู ุฅูู ุงูููุชุจุฉ ุงูุชู ุฃุถููุงูุง ุฅูู ุงููุดุฑูุน ูุณุจููุง: ุฅูุดุงุก ูุงุฆู ุทูุจ ุ ูุชุญุฏูุฏ ุฑูุฒ OAuth ุ ูููู ูุงุฆู LoyaltyObject ุงูุฐู ุชู ุฅูุดุงุคู ุ ูุชูููุฐ ุงูุทูุจ: <br><br></p><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GooglePayApiService</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ,    Merchant Account IssuerId = ConfigurationManager.AppSettings["GooglePayIssuerId"]; _wobService = new WalletobjectsService(); } private async Task&lt;LoyaltyObject&gt; ConvertLoyaltyObjectFromTemplate(GooglePayPassTemplate template) { string id = $"{IssuerId}.{template.SerialNumber}"; string loyaltyClassName = ConfigurationManager.AppSettings["GooglePayStoreCardClassName"];     var loyaltyClass = await GetLoyaltyClass(loyaltyClassName); var result =  new LoyaltyObject { Id = id, AccountName = template.AccountName,          Barcode = new Barcode          {          AlternateText = template.BarcodeText,               Value = template.SerialNumber,               Type = "pdf417"          },          Kind = "walletObject#loyaltyObject",          ClassId = loyaltyClass.Id,          ClassReference = loyaltyClass,          State = "active"     };     return result; } private async Task&lt;LoyaltyObject&gt; CreateLoyaltyObject(LoyaltyObject loyaltyObject) { var saveRequest = _wobService.Loyaltyobject.Insert(loyaltyObject); saveRequest.OauthToken = await GetOAuthToken(); var savedObject = await saveRequest.ExecuteAsync(); return savedObject; }</span></span></code> </pre><br>  <i>GooglePayPassTemplate</i> ูู ูุฐุง ุงููุซุงู ูู DTO ุงูุฐู ูุฎุฒู ูุงูุจ ุฎุฑูุทุฉ ูููุณุชุฎุฏู ุ ูุงูุฐู ูุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ุฎุฏูุฉ ูุทูุฑุฉ ูููุตูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  5. ุฎุฑูุทุฉ ุงูุชุญุฏูุซ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ุงููุจุฏุฃ ูู ููุณู ุนูุฏ ุฅูุดุงุก: ูููู ุจุฅูุดุงุก ุทูุจ ุ ูููู ูุงุฆู LoyaltyObject ุงููุญุฏุซ ุ ูุชูููุฐ: <br><br></p><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;LoyaltyObject&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateLoyaltyObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LoyaltyObject loyaltyObject</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> updateRequest = _wobService.Loyaltyobject.Update(loyaltyObject, loyaltyObject.Id);           updateRequest.OauthToken = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GetOAuthToken(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> savedObject = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> updateRequest.ExecuteAsync(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> savedObject; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅููุงู ุงูุทูุจ ุ ุณูุชู ุชุญุฏูุซ ุงูุจุทุงูุฉ ูู ุชุทุจููุงุช ุงููุณุชุฎุฏููู ุงูุฐูู ูุงููุง ุจุชุซุจูุชูุง ุจุนุฏ ุจุถุน ุซูุงูู ุ ุฅุฐุง ูุงู ุงูุฌูุงุฒ ุนูู ุงูุดุจูุฉ ููุฏูู ุงุชุตุงู ุจุงูุฅูุชุฑูุช. </p><br><br><h2 style=";text-align:right;direction:rtl">  6. ุฌูู JWT </h2><br><p style=";text-align:right;direction:rtl">  ูุชุซุจูุช ุงูุจุทุงูุฉ ุ ูุฌุจ ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุชุฎุฏู ุฅูู ุงูุฑุงุจุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">www.android.com/payapp/savetoandroidpay</a> <b>/ {JWT}</b> .  ูููู ุงูุนุซูุฑ ุนูู ูุตู ููุจููุฉ ุงูุฑูุฒูุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูุฑุงุจุท</a> . <br></p><br><p style=";text-align:right;direction:rtl">  ูุชู ุชูููุน ุงูุฑูุฒ ุงููููุฒ ุจูุงุณุทุฉ RSA-SHA256 ูุน ุชูููุน ูููู ุฅูุดุงุคู ุจุงุณุชุฎุฏุงู ููุณ ุงูููู ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ุงุนุชูุงุฏ ุญุณุงุจ ุงูุฎุฏูุฉ: <br><br></p><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">JwtHelper</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateJwtForLoyaltyObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LoyaltyObject loyaltyObject</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*       credential   ,         */</span></span> ServiceAccountCredential credential; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> now = DateTime.UtcNow; DateTime unixEpoch = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">1970</span></span>, <span class="hljs-number"><span class="hljs-number">01</span></span>, <span class="hljs-number"><span class="hljs-number">01</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 1970-01-01 00:00:00 UTC var secondsSinceEpoch = (int)Math.Round((now - unixEpoch).TotalSeconds); string serviceAccountFile = serviceAccountFile = ConfigurationManager.AppSettings["GooglePayServiceAccountConfigPath"]; using (var fs = new FileStream(serviceAccountFile, FileMode.Open, FileAccess.Read, FileShare.Read)) { credential = ServiceAccountCredential.FromServiceAccountData(fs); } /*    JwtPayload,     payload-a  JWT */ var jwtPayload = new JwtPayload { iat = secondsSinceEpoch, iss = credential.Id, payload = new JwtInternalPayload { loyaltyObjects = new[] { new LoyaltyObjectPayload { id = loyaltyObject.Id } } } }; string header = @"{""alg"":""RS256"",""typ"":""JWT""}"; string payload = JsonConverter.SerializeObject(jwtPayload); string base64Header = EscapedBase64(Convert.ToBase64String(Encoding.UTF8.GetBytes(header))); string base64Payload = EscapedBase64(Convert.ToBase64String(Encoding.UTF8.GetBytes(payload))); //        Signature string signature = EscapedBase64(credential.CreateSignature( Encoding.UTF8.GetBytes($"{base64Header}.{base64Payload}") )); var token = $"{base64Header}.{base64Payload}.{signature}"; return token; } private static string EscapedBase64(string base64) { return base64.Replace('+', '-') .Replace('/', '_') .Replace("=", ""); } }</span></span></code> </pre><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุงุชูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูููุงูุฉ ุ ุงุณุชุนุฑุถูุง ุฃุณุงุณูุงุช ุงูุนูู ูุน Google Pay API for Passes: ุฅุนุฏุงุฏ ุงูุญุณุงุจุงุช ุ ูุงูุงุชุตุงู ุจู API ุ ูุฅูุดุงุก ูุฆุฉ ุงูููุงุก ููุงุฆู ุงูููุงุก. <br><br>  ุฅุฐุง ููุช ุชูุถู UFO ุ ูุณุฃุฎุจุฑู ุจุดูู ูููุตู ุนู ููููุฉ ุงูุนูู ูุน Apple Wallet (ูู ุดูุก ุฃูุซุฑ ุตุนูุจุฉ ูููุง ูุชุนูู ุจุงูุชูููุฐ) ุ ูููููุฉ ุชูููู Apple Wallet ูุน Google Pay ูู ุฎุฏูุฉ ููุจ ูุงุญุฏุฉ ูุนุฏู ุงูุดุนูุฑ ุจุงูุฃูู. <br></p><br><p style=";text-align:right;direction:rtl"></p><h3 style=";text-align:right;direction:rtl">  ุฑูุงุจุท ูููุฏุฉ </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุณุฌูู ุญุณุงุจ ุงูุชุงุฌุฑ</a> <br></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Google Pay API for Passes Documentation</a> <br></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุจุงุช ุงูุนููุงุก ููุนูู ูุน Google Pay API for Passes</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar434486/">https://habr.com/ru/post/ar434486/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar434474/index.html">ุงููุท ุงูุฃุฎุถุฑ ุญูู ูุญุชูู ุงููุถุงุก</a></li>
<li><a href="../ar434476/index.html">ุณูู ChatOps ูู GitLab ุชููู ูุชุงุญุฉ ููุฌููุน</a></li>
<li><a href="../ar434478/index.html">ุณุชูุถู ุงูุดูุฑุฉ ุงูุฎุงุทุฆุฉ ุนูู ุงูุจุฑูุฌุฉ ุ ููู ููุนู ุฃู ุดูุก ุญูุงู ุฐูู.</a></li>
<li><a href="../ar434480/index.html">ุงูุนุงู ุงูุฌุฏูุฏ ุ ุงูุฃุฏูุงุช ุ ุงููุงุฑ</a></li>
<li><a href="../ar434482/index.html">ุนุงู ุขุฎุฑ ูู ูุฏููุชูุง: ูุชุงุฆุฌ 2018</a></li>
<li><a href="../ar434490/index.html">ููู ุฑุฃููุง ููุจุฑ ุงูุตูุช ุนู ุทุฑูู ูุทุน ุงุชูุฑุฌูุช</a></li>
<li><a href="../ar434494/index.html">ูุงุฐุง ุชูุฑุฃ. ูุงุฆูุฉ ุงูุฎูุงู ุจุงููุบุฉ ุงูุฑูุณูุฉ ูุนุงูู 2017 ู 2018</a></li>
<li><a href="../ar434496/index.html">ุงูุงูุชุฒุงู ุนูู ูุฑุญูุชูู ููุณุชูุจู ุงููุธู ุงูููุฒุนุฉ</a></li>
<li><a href="../ar434498/index.html">MVP ู Dagger 2 - ุชุทุจูู ุงููููู ุงูุนุธูู ููุธุงู Android - ุงูุฌุฒุก ุงูุฃูู</a></li>
<li><a href="../ar434500/index.html">ุงููุญุชุงู ูุฏุนู ุฌูู ุฃู ุดุงูุฏ ุขุฐุงูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>