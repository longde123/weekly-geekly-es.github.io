<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüè´ ‚ò™Ô∏è üë®üèª‚Äç‚öñÔ∏è Peque√±o, si. Unboxing del petardo microvirtual üêé ‚õπüèΩ üôèüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Graba microvirtuales de petardos. Tomamos dos m√©todos populares para aislar cargas de trabajo multiusuario: m√°quinas virtuales y contenedores. Exprimi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Peque√±o, si. Unboxing del petardo microvirtual</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/464305/">  Graba microvirtuales de petardos.  Tomamos dos m√©todos populares para aislar cargas de trabajo multiusuario: m√°quinas virtuales y contenedores.  Exprimimos lo mejor de ambos enfoques, simplificamos lo m√°s posible, probamos con una carga real.  Como resultado, obtenemos un aislamiento impenetrable de las computadoras virtuales que se pueden iniciar en cientos de milisegundos.  Esta soluci√≥n funciona bajo el cap√≥ de AWS Lambda y Fargate, ejecutando millones de funciones y contenedores sin servidor en la nube cada segundo.  Se llama petardo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rm/ps/oo/rmpsoo1w1jptnyp2qwsaestydsq.png" width="400"></div><br><br>  Esta herramienta de microvirtualizaci√≥n est√° disponible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenSource</a> .  Si sus tareas requieren aislamiento de m√∫ltiples inquilinos (bueno, por ejemplo, decide crear su propia nube), Firecracker es lo que necesita. <br><br>  <strong>Vasily Pantyukhin</strong> , arquitecto de Amazon Web Services, habla sobre la arquitectura Firecracker, c√≥mo la utiliza AWS Lambda, la compara con soluciones alternativas y da ejemplos de integraci√≥n. <br><br>  <em>Descargo de responsabilidad: todo lo que sigue es la opini√≥n personal de Vasily, y puede no coincidir con la posici√≥n de los servicios web de Amazon.</em> <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/cfsICOzt6Do" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Caracter√≠sticas naturales de las nubes p√∫blicas. </h2><br><blockquote>  Una de las propiedades fundamentales de las nubes p√∫blicas es la tenencia m√∫ltiple. </blockquote><br>  Alguien traduce este t√©rmino como "multicliente" o "entorno multiusuario".  Pero desde mi punto de vista, esto no refleja la esencia.  El arrendamiento m√∫ltiple es cuando diferentes usuarios y sus cargas viven en la misma infraestructura f√≠sica, la comparten entre ellos, pero no se conocen entre s√≠.  De las cargas de trabajo de m√∫ltiples usuarios, la tenencia m√∫ltiple se distingue por requisitos fundamentalmente m√°s estrictos para el aislamiento de recursos y el acceso a ellos. <br><br><blockquote>  Otra propiedad inherente a las nubes p√∫blicas es la alta carga. </blockquote><br>  ¬°Cr√©ame, en el caso de AWS, esta es una carga enorme!  La captura de pantalla es un ejemplo de datos reales.  No dir√© durante cu√°nto tiempo y en qu√© regi√≥n se midieron estos millones de "loros", pero este no es un tipo de emergencia, sino el modo de funcionamiento habitual para nosotros. <br><br><img src="https://habrastorage.org/webt/up/dt/qs/updtqsp7dmtqk1czi5f2zuscbkq.png"><br><br>  Resulta una cierta contradicci√≥n.  Por un lado, necesitamos mantener a los usuarios lo m√°s aislados posible.  Por otro lado, debemos garantizar un nivel muy alto de productividad y utilizaci√≥n de recursos.  Mejorar uno a menudo conduce a las limitaciones del otro.  ¬øC√≥mo encontrar un compromiso, y a√∫n mejor, para obtener el m√°ximo en todos los frentes? <br><br><h2>  M√°quinas virtuales o contenedores? </h2><br>  Hay dos enfoques b√°sicos que podr√≠an ayudar.  Estas son m√°quinas virtuales y contenedores.  Cada uno tiene sus pros y sus contras. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dj/hl/ba/djhlbailazcjnfxycokcrv38a64.png" width="400"></div><br><br>  La principal desventaja de las m√°quinas virtuales es que tardan <strong>mucho en cargarse</strong> .  Por lo general, toma decenas de segundos, o incluso minutos, arrancar la m√°quina.  Pero los virtualoks tienen una virtud: <strong>a√≠slan las</strong> cargas de <strong>hormig√≥n</strong> entre s√≠.  Y desde ambos puntos de vista: <br><br><ul><li>  <strong>seguridad</strong> cuando una m√°quina virtual no puede acceder a datos en otra m√°quina; </li><li>  <strong>recursos</strong> , cuando ped√≠ 8 GB de memoria, espero que esta RAM sea m√≠a y nadie pueda reclamar el recurso por el que pagu√©. </li></ul><br>  Lo contrario es el caso de los contenedores: son livianos y, por lo tanto, se <strong>cargan muy r√°pido.</strong>  Se pueden escalar f√°cilmente horizontalmente.  Pero hay una caracter√≠stica con la que nosotros, como proveedor de nube p√∫blica, no podemos vivir.  Utilizan un <strong>n√∫cleo compartido: el n√∫cleo del sistema operativo se comparte entre todos los contenedores</strong> . <br><br><img src="https://habrastorage.org/webt/pa/pz/hm/papzhmvppqzce7pxbezk8bp9owg.png"><br><br>  ¬øSe puede decir que los contenedores son inseguros?  No, a pesar de que existen serias vulnerabilidades. <br><br><blockquote>  Creo que hoy un contenedor debidamente "soldado" proporciona un nivel suficiente de seguridad. </blockquote><br>  El problema es diferente: un n√∫cleo compartido no garantiza fundamentalmente que en el futuro no aparezcan vulnerabilidades que rompan el aislamiento de los inquilinos.  La nube p√∫blica no puede permit√≠rselo ni siquiera en teor√≠a. <br><br>  Hay otra contradicci√≥n m√°s, y se debe buscar una soluci√≥n.  La forma m√°s f√°cil es sacar lo mejor de mam√°, una m√°quina virtual y de pap√°, un contenedor, una cruz y obtener algo <strong>convergente</strong> .  En realidad lo hicimos.  Result√≥ petardo. <br><br>  Petardo ya est√° en producci√≥n.  En la misma gran carga de servicios cr√≠ticos, por ejemplo, AWS Lambda (funciones sin servidor) y AWS Fargate (contenedores sin servidor). <br><br><h3>  Problemas de la antigua AWS Lambda </h3><br>  AWS Lambda es un servicio de caracter√≠sticas sin servidor.  Tomamos la funci√≥n en Java, Go, Python u otro lenguaje, la lanzamos en Lambda y se ejecuta m√°gicamente.  No es necesario asignar y administrar recursos.  ¬øC√≥mo se implement√≥ esto antes? <br><br><img src="https://habrastorage.org/webt/ou/ck/-s/ouck-sm6pjv4ul6t13dwlefxtry.png"><br><br>  Para cada cuenta de AWS, se asignaron una o m√°s m√°quinas virtuales EC2 separadas para aislar funciones que pertenecen a diferentes inquilinos.  Tal m√°quina virtual consume recursos, incluso cuando no hace nada.  Supongamos que ejecutamos una funci√≥n una vez cada 10 minutos, y se ejecuta en 200 ms como un Lambda normal.  Resulta que en una hora la m√°quina EC2 se usa solo unos segundos.  Adem√°s, incluso en tiempo de ejecuci√≥n, no consume todos los recursos disponibles: eliminaci√≥n por debajo de la placa base.  Esto es furiosamente in√∫til. <br><br><img src="https://habrastorage.org/webt/jy/lo/0q/jylo0qlzudppsa5042qv858mfya.png"><br><br><h3>  ¬øC√≥mo resolvi√≥ el problema del reciclaje? </h3><br>  Desarroll√≥ desde cero su propia soluci√≥n de Firecracker.  Esto es obvio por el t√≠tulo del informe :) <br><br>  Para comenzar a desarrollar un nuevo producto, necesita una tarea t√©cnica.  Tiene mucho texto, pero si selecciona solo el significado, obtendr√° lo siguiente. <br><br><ul><li>  <strong>Desarrollado por KVM</strong> como hipervisor.  Quien trabaja con AWS sabe que tenemos dos hipervisores favoritos.  Las m√°quinas virtuales heredadas se ejecutan en Xen.  Desde finales de 2017, KVM ha estado viviendo bajo el cap√≥ de todos los autom√≥viles. </li><li>  <strong>Comienza lo m√°s r√°pido posible.</strong>  En el hardware de referencia, el requisito era una carga completa del microvirtual en 125 ms. </li><li>  <strong>M√≠nima sobrecarga de virtualizaci√≥n</strong> .  En la arquitectura de referencia, una sola m√°quina micro-virtual Firecracker consume adem√°s solo 5 MB de memoria. </li><li>  <strong>La posibilidad del comienzo m√°s denso</strong> .  Par√°metros de dise√±o: carga completa de 5 microvirtuales por n√∫cleo por segundo.  Este requisito es fundamental para servicios como AWS Lambda.  Las funciones deben despegar, trabajar y morir r√°pidamente, liberando recursos para el pr√≥ximo. </li><li>  <strong>La posibilidad de volver a suscribirse</strong> .  Es una oportunidad, no es necesario usarla.  De hecho, esta es la asignaci√≥n de recursos virtuales en mayor medida de lo que est√°n f√≠sicamente disponibles.  Esto significa que el servidor tiene 16 GB de RAM, y simult√°neamente ejecuta 4 m√°quinas virtuales, cada una de las cuales est√° segura de que tiene 8 GB de memoria. </li></ul><br><h3>  AWS Lambda con petardo debajo del cap√≥ </h3><br>  ¬øQu√© ha cambiado en la nueva versi√≥n de AWS Lambda?  Desde el punto de vista del usuario final, nada ha cambiado.  La migraci√≥n a una arquitectura actualizada en producci√≥n fue completamente transparente e invisible para los consumidores.  Las caracter√≠sticas de Lambda son de corta duraci√≥n: fue f√°cil de hacer. <br><br>  ¬øC√≥mo es la arquitectura moderna? <br><br><blockquote>  En el nivel m√°s bajo ahora no hay una m√°quina virtual, sino un f√≠sico f√≠sico. </blockquote><br>  Dichos servidores permiten el uso completo de todas las funciones de la CPU, por ejemplo, Intel VT.  Esto proporciona beneficios adicionales cuando se utiliza la virtualizaci√≥n en niveles superiores. <br><br><img src="https://habrastorage.org/webt/rg/i6/s3/rgi6s36v7vgfuc2onnb-cuahbui.png"><br><br>  Encima de la pieza de hierro se encuentra el <strong>sistema operativo host</strong> con el m√≥dulo KVM en el n√∫cleo.  <strong>Los</strong> microvirtuales <strong>Firecracker</strong> con sus propios <strong>SO invitados</strong> se lanzan arriba.  Bueno, ya implementaron componentes del servicio AWS Lambda. <br><br>  Anteriormente, para cada cliente que usa las caracter√≠sticas de Lambda, asignamos m√°quinas virtuales EC2 separadas con baja utilizaci√≥n.  El nuevo enfoque le permite ejecutar un microvirtual ligero solo cuando realmente lo necesita.  Aislar los recursos de Firecracker entre s√≠ nos permite hacer esto en un hardware com√∫n con la m√°xima densidad.  La utilizaci√≥n de los recursos ha mejorado fundamentalmente. <br><br><h2>  ¬øQu√© hay en la caja? </h2><br>  Promet√≠ un anboxing, as√≠ que repasemos los componentes principales de Firecracker, consideremos cada uno de ellos por separado, y luego p√≥ngalos juntos. <br><br><img src="https://habrastorage.org/webt/o_/by/mq/o_bymqjtw5d6aomlwpmfa7grqgk.jpeg"><br><br><h3>  Principios de dise√±o </h3><br>  Cuando comenzamos a discutir el desarrollo de Firecracker, acordamos adherirnos a dos principios. <br><br>  <strong>Deshazte de todo lo innecesario.</strong>  ¬øPor qu√© las m√°quinas virtuales cl√°sicas se cargan lentamente?  En particular, porque el c√≥digo est√° sobrecargado.  Tienen que soportar una gran cantidad de dispositivos heredados.  Pero, ¬øpor qu√© emular un dispositivo que nadie m√°s usaba hace 10 a√±os?  No hay necesidad, por lo tanto, nos deshacemos de todo lo que es superfluo.  Resolvemos una tarea estrecha espec√≠fica y cualquier funcionalidad que no ayude a resolver este problema se considera innecesaria. <br><br><blockquote>  Desh√°gase de todo lo superfluo y conc√©ntrese en una tarea. </blockquote><br>  <strong>Simplifica lo que queda.</strong>  Incluso lo que queda debe ser lo m√°s simple posible. <br><br><h3>  ¬øSobre qu√© escribieron? </h3><br>  Firecracker est√° escrito en moda Rust porque: <br><br><ul><li>  le permite escribir <strong>c√≥digo</strong> m√°s <strong>seguro</strong> , en particular, en t√©rminos de memoria; </li><li>  <strong>El rendimiento</strong> y la sobrecarga son comparables a los modernos C ++; </li><li>  Rust <strong>se ha utilizado durante mucho tiempo,</strong> desde 2015 ha escrito muchas soluciones geniales de alta carga. </li></ul><br><h3>  Hierro </h3><br>  Repito: Firecracker requiere instalaci√≥n en hardware real.  Como configuraci√≥n de referencia, se eligi√≥ la m√°quina de metal desnudo i3.metal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rg/to/nh/rgtonh5b1jbhgpzizky2wc6bsfk.png" width="400"></div><br>  <em>Nota: el informe fue a principios de abril de 2019. En ese momento, solo se admit√≠a la plataforma Intel.</em>  <em>En mayo, agregaron soporte alfa para AMD, y en junio ARM.</em>  <em>AMD puede ser un poco m√°s barato que Intel, y el soporte ARM ofrece oportunidades interesantes para trabajar con IoT de m√∫ltiples inquilinos.</em> <br><br>  Si solicita una m√°quina i3.metal u otra m√°quina de metal desnudo en AWS, entonces para los experimentos ser√° una configuraci√≥n demasiado potente y costosa.  Por lo tanto, si decide instalar Firecracker en ellos, no olvide pagar estas m√°quinas despu√©s de los experimentos.  De lo contrario, se obtendr√° un puntaje decente a fin de mes. <br><br>  ¬øHay una opci√≥n m√°s barata?  S√≠, puede iniciar Firecracker en un entorno virtual.  Pero ya no est√° en AWS: b√°sicamente no admitimos la virtualizaci√≥n anidada en EC2.  Pero puede hacerlo en GCP, Azure, DigitalOcean o usar Proxmox, Parallels, VMware Fusion.  Todo funcionar√° si cumple con los requisitos, en particular, de acuerdo con la versi√≥n del kernel del sistema operativo invitado. <br><br><h3>  El n√∫cleo </h3><br><blockquote>  El elemento fundamental de la soluci√≥n es el m√≥dulo del n√∫cleo KVM. </blockquote><br>  Por si acaso, describir√© como una digresi√≥n lo que es KVM.  Este no es el hipervisor completo, sino solo una parte de √©l.  Sus tareas principales son <strong>configurar un procesador virtual</strong> (vCPU) e <strong>iniciar una m√°quina virtual</strong> . <br><br><img src="https://habrastorage.org/webt/gp/3l/ee/gp3leep27-zq3yzx9fiiho15pkm.png"><br><br>  Pero esto no es suficiente para un trabajo completo.  Adem√°s del procesador, se necesitan algunos otros dispositivos.  Su emulaci√≥n ocurre en el espacio del usuario. <br><br><h3>  VMM </h3><br>  Para que aparezcan al menos dispositivos b√°sicos, necesita otro componente: Virtual Machine Manager (VMM).  Antes de Firecracker, la opci√≥n principal de VMM era QEMU. <br><br><img src="https://habrastorage.org/webt/kg/s8/kr/kgs8krmluije10ql6x6vtch7f9g.png"><br><br>  Consideramos seriamente la posibilidad de usar QEMU, pero decidimos desarrollar nuestra propia "bicicleta".  Hubo varias razones para esto. <br><br>  <strong>Gesti√≥n del desarrollo</strong> .  QEMU es un producto grande y maduro con m√°s de un mill√≥n de l√≠neas de c√≥digo.  Para realizar cambios, debe ver demasiados c√≥digos fuente.  Mucha gente participa en el desarrollo y la toma de decisiones sobre el desarrollo. <br><br>  <strong>Seguridad</strong>  QEMU puede emular muchos dispositivos.  Es por eso que tiene una superficie de ataque bastante grande.  Nuestra tarea es hacer un microvirtual.  Desde un punto de vista de seguridad, debemos minimizar la superficie de ataque. <br><br>  <strong>La necesidad de implementar nuevas caracter√≠sticas.</strong>  QEMU tiene buen c√≥digo.  Este es un producto maduro en el que todos los errores obvios ya est√°n atrapados.  Pero en su forma actual, la funcionalidad QEMU a√∫n no nos conven√≠a, tendr√≠amos que agregar mucho.  Desde este punto de vista, el nuevo c√≥digo en QEMU y en el nuevo producto tendr√≠a la misma calidad.  Por lo tanto, una victoria especial no funcionar√≠a. <br><br><h3>  Dispositivos </h3><br>  Firecracker implementa VMM, que se utiliza para emular dispositivos.  Emulamos los siguientes dispositivos: <br><br><ul><li>  <strong>Consola</strong>  Una cosa √∫til y necesaria, aunque se puede desactivar. </li><li>  <strong>Teclado</strong>  Creamos un teclado complicado, con solo un bot√≥n "Restablecer".  Simplemente no confiamos en el software "Reset" de aquellos sistemas operativos que potencialmente podr√≠an ejecutarse en Firecracker.  Por lo tanto, hicieron hierro. </li><li>  <strong>Controladores Virtio para disco y red</strong> .  Virtio es un dispositivo muy primitivo.  En esencia, este es un "anillo de amortiguaci√≥n".  El sistema invitado escribi√≥ algo en el b√∫fer, hizo clic en la llamada y el sistema host ley√≥ los datos de este b√∫fer a trav√©s de un archivo. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pv/av/hw/pvavhwc_g42zvrjrg7ftiqmcfda.png" width="500"></div><br><br>  En algunos casos, por ejemplo, para la integraci√≥n con contenedores, todav√≠a necesitamos un dispositivo de red que represente la funcionalidad b√°sica de una tarjeta de red normal.  Virtio no encaja aqu√≠, demasiado simple.  Por lo tanto, para la red usamos otro dispositivo: <strong>Vsock</strong> . <br><br>  Bueno, tambi√©n necesitamos la capacidad de controlar el consumo de recursos.  El <strong>limitador de velocidad</strong> es responsable de esto. <br><br>  Hay dispositivos  Pero, ¬øc√≥mo gestionar y configurar microvirtuales?  La API de gesti√≥n nos ayudar√° aqu√≠. <br><br><h3>  Gesti√≥n </h3><br>  Amazon tiene varios principios fundamentales irrompibles.  Uno de ellos es que cualquier servicio se comunica entre s√≠ solo a trav√©s de la API.  No importa si se trata de servicios externos que utiliza como usuario o nuestros servicios internos.  No sucede que un servicio vaya directamente a la base de datos de otro servicio; est√° prohibido y se castiga.  El hilo API Firecracker solo se usa para acceder a la configuraci√≥n y funcionalidad de los microvirtuales a trav√©s de la API REST. <br><br><img src="https://habrastorage.org/webt/1s/qj/bt/1sqjbtijgutp6qfwscgu_vnq1va.png"><br><br>  Nos adherimos a la especificaci√≥n Open API, por lo que puede usar Swagger. <br><br><h3>  Metadatos </h3><br>  Existe tal maldad: codificaci√≥n dif√≠cil.  Esto es cuando algunos datos se cosen directamente en el c√≥digo, por ejemplo, el inicio de sesi√≥n y la contrase√±a de acceso a otro recurso.  Esto, por supuesto, no est√° permitido.  Peri√≥dicamente, necesitamos transferir algunos datos dentro del microvirtual.  Esto se hace a trav√©s del <strong>servicio de metadatos</strong> . <br><br><img src="https://habrastorage.org/webt/q_/ll/0m/q_ll0msnhoarxu6k5aag0ie2fug.png"><br><br>  Pasamos la informaci√≥n requerida a trav√©s del socket al comercio de metadatos IMDS.  Para obtener esta informaci√≥n dentro del microvirtual, debe solicitar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://169.254.169.254/latest/meta-data</a> utilizando la API REST.  Los usuarios de AWS ya conocen esta IP m√°gica.  Del mismo modo, los microvirtuales pueden obtener informaci√≥n detallada sobre su propia configuraci√≥n. <br><br><h3>  Registros </h3><br>  Es imperativo poder arrojar troncos de microvirtuales al mundo exterior antes de que ella muera.  Esto se hace a trav√©s de un Unix <strong>FIFO</strong> regular. <br><br><img src="https://habrastorage.org/webt/vr/p6/ib/vrp6ibzybyivbp68mi7wt1awobc.png"><br><br><h3>  Aislamiento adicional </h3><br>  La principal ventaja de la m√°quina virtual de forma aislada.  Parece que esto deber√≠a ser suficiente, pero fuimos m√°s all√°.  Por si acaso, para ejecutar la producci√≥n, se recomienda colocar una capa adicional de aislamiento llamada <strong>Jailer</strong> . <br><br><img src="https://habrastorage.org/webt/1o/_2/j6/1o_2j6t6y7_ae7h1cmzk36xqliq.png"><br><br>  Estas son precauciones est√°ndar: <br><br><ul><li>  <strong>cgroups</strong> para limitar los recursos; </li></ul><br><ul><li>  <strong>espacio</strong> de <strong>nombres</strong> para aislar procesos; </li><li>  <strong>seccomp</strong> : un an√°logo del firewall para llamadas al sistema; </li><li>  y, por supuesto, el <strong>chroot</strong> favorito de todos <strong>.</strong> </li></ul><br><h2>  Integraci√≥n con otros servicios. </h2><br>  ¬øHay alguna soluci√≥n preparada basada en Firecracker?  Por supuesto que si. <br><br><h3>  OSV </h3><br>  Este sistema operativo est√° dise√±ado para ejecutar solo una aplicaci√≥n.  Debido a esto, ella simplemente ha organizado el trabajo con memoria y un planificador.  Un sistema operativo potente y f√°cil de administrar ahora <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funciona sobre Firecracker</a> . <br><br><h3>  Contenedor </h3><br>  Tambi√©n hicimos integraci√≥n con containerd.  Si ya trabaja con √©l, necesita un m√≠nimo esfuerzo para lanzar contenedores envueltos en Firecracker para su aislamiento. <br><br><img src="https://habrastorage.org/webt/xm/l3/1n/xml31nghhesczi3x2ul1vagz5xw.png"><br><br>  En lugar de la cu√±a habitual, containerd se refiere a la cu√±a Firecracker.  Ya administra runc, a trav√©s de un agente que est√° instalado dentro del microvirtual.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">A cuadros, funciona</a> . <br><br><h3>  Contenedores Kata </h3><br>  Cuando anunciamos Firecracker por primera vez, una de las preguntas m√°s populares de los clientes fue: <br><br>  <em>- El mecanismo para aislar contenedores ya se ha inventado: se trata de Kata Containers.</em>  <em>¬øPor qu√© no los usaste?</em>  <em>¬øPor qu√© desarrollar el tuyo?</em> <br>  <em>- Kata trabaja con QEMU, pero no queremos trabajar con QEMU.</em>  <em>Por lo tanto, decidimos cocinar la nuestra.</em> <br><br>  Pero result√≥ interesante.  Los desarrolladores de Kata se reunieron con los desarrolladores de Firecracker y acordaron integrarse.  Porque todos ven esto como una gran ventaja.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kata Containers v1.5</a> ya es compatible con QEMU y Firecracker. <br><br>  Resulta que no competimos, sino que nos complementamos armoniosamente.  En Kubernetes con v1.12, puede definir runtimeClassName como Kata FC o Kata QEMU, y ejecutar sus contenedores en el aislamiento adecuado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yt/1-/bn/yt1-bnzwtgnbvhvkkr48gmhsj5o.png" width="500"></div><br><br>  ¬øC√≥mo elegir el aislamiento que se adapte a su aplicaci√≥n: Firecracker o QEMU?  Mi opini√≥n personal es que lo que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">importa es si</a> su aplicaci√≥n es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mascotas o ganado</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/le/yj/vsleyjeqq1hypjljyr3jcjcpsvc.png" width="300"></div><br><br>  Kata con QEMU es una soluci√≥n para mascotas.  QEMU es un sistema grande y multifuncional.  Potencialmente, ofrece m√°s opciones de soporte y tratamiento para sus mascotas favoritas. <br><br>  El petardo es adecuado cuando la carga es ganado.  En el caso de que su aplicaci√≥n sin estado se haya dise√±ado originalmente para un escalado horizontal flexible y la falla de uno o m√°s contenedores no es cr√≠tica.  Proporcionando un aislamiento confiable, le permite cargar r√°pidamente la cantidad requerida de contenedores nuevos para reemplazar los fallidos. <br><br><h2>  Cual es el resultado? </h2><br>  Comenzamos con contradicciones.  Parece que resolver la contradicci√≥n es un enfoque "nuestro y tuyo", algo intermedio que satisfar√° a todos.  Pero la experiencia dice que el compromiso no es necesario. <br><br>  Nos propusimos el objetivo de desarrollar una nueva soluci√≥n en la que no habr√° nada superfluo que no sea necesario para resolver una tarea estrecha.  Tambi√©n era importante simplificar todo lo que usamos tanto como sea posible.  Me gustar√≠a creer que no obtuvimos un compromiso, sino una soluci√≥n s√≥lida que le permite lanzar de forma r√°pida y densa miles de microvirtuales sin sacrificar su aislamiento. <br><br>  Ya usamos Firecracker en la producci√≥n de varios de nuestros servicios.  La principal ventaja que obtuvimos es la mejora de la utilizaci√≥n del servicio.  Esto permiti√≥ ahorrar significativamente.  Parte de este ahorro lo compartimos con los clientes.  Por ejemplo, despu√©s de la introducci√≥n de Firecracker, los precios de los contenedores sin servidor AWS Fargate en enero de 2019 cayeron en un 35-50%.  El beneficio es visible a simple vista, por lo que no hay duda de que continuaremos desarrollando este producto y compartiendo nuestras mejores pr√°cticas con Open Source.  El hecho de que Firecracker ya haya comenzado a integrarse con otras soluciones indica un inter√©s creciente por parte de la comunidad. <br><br>  Si tiene una idea o un producto terminado en cuya descripci√≥n est√°n las palabras "aislamiento multiinquilino", este es un claro indicador de lo que vale la pena experimentar con los microvirtuales Firecracker. <br><br><blockquote>  Este informe ilustra perfectamente el principio al que estamos intentando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">adherirnos</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">las</a> conferencias de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ontiko</a> : recibir experiencia mundial de expertos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habla</a> rusa.  Y el punto no es solo una posible barrera del idioma, sino que en la cultura estamos acostumbrados a compartir detalles t√©cnicos.  En noviembre, Vasily <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">actuar√°</a> nuevamente en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HighLoad ++</a> , y se le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">unir√°</a> , por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Artemy Kolesnikov</a> de Facebook, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Vittorio Cioe</a> de Oracle y, por supuesto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Petr Zaitsev</a> de Percona.  Tambi√©n tendremos informes en ingl√©s, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">suscr√≠base</a> al bolet√≠n informativo: le informaremos cu√°ndo se agregar√°n nuevos a los cuarenta informes aceptados. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/464305/">https://habr.com/ru/post/464305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../464291/index.html">Los 10 lenguajes de programaci√≥n m√°s influyentes de los √∫ltimos 50 a√±os y sus creadores.</a></li>
<li><a href="../464293/index.html">¬øLos ganchos se reemplazan en React Redux?</a></li>
<li><a href="../464295/index.html">Ejemplos de uso de algunas funciones nuevas de JavaScript</a></li>
<li><a href="../464299/index.html">0, 0, 1, 0, 2, 0, 2, 2, 1, 6, 0, 5, 0, 2, 6, 5, 4, 0, 5, 3, 0, 3, 2, 9, 0, 4, 9, 3, 6, 14, 0, 6, 3, 5, 15, 0, 5, 3, 5 ...</a></li>
<li><a href="../464303/index.html">Datos de series de tiempo en un DBMS relacional. Extensiones TimescaleDB y PipelineDB para PostgreSQL</a></li>
<li><a href="../464307/index.html">Pruebas de integraci√≥n de microservicios en Scala</a></li>
<li><a href="../464309/index.html">Bot√≥n de llamada de bricolaje. Raspberry Pi, MajorDoMo, Freeswitch y Linphonec</a></li>
<li><a href="../464315/index.html">La pel√≠cula en la que hab√≠a tierra. Investigaci√≥n de Yandex y una breve historia de b√∫squeda por significado</a></li>
<li><a href="../464317/index.html">Proyecto Konbanwa</a></li>
<li><a href="../464325/index.html">C√≥mo Scrumban une lo mejor de las metodolog√≠as Kanban y Scrum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>