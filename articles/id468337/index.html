<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìà üê∑ üó£Ô∏è Bekerja dengan cron untuk Android dan menambahkan skrip shell ke autorun saat perangkat melakukan booting üéÅ ‚õàÔ∏è üö£üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Karena perangkat seluler telah lama memiliki fungsionalitas yang luas, tugas otomasi dapat dengan mudah ditransfer ke sana. Dan, sebaik mungkin, cron ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bekerja dengan cron untuk Android dan menambahkan skrip shell ke autorun saat perangkat melakukan booting</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468337/"><img src="https://habrastorage.org/webt/t2/ia/uo/t2iauogb45suwvzulewv9wbktr8.jpeg"><br><br>  Karena perangkat seluler telah lama memiliki fungsionalitas yang luas, tugas otomasi dapat dengan mudah ditransfer ke sana.  Dan, sebaik mungkin, cron sama baiknya untuk mengeksekusi mereka.  Tetapi jika cron membutuhkan sedikit waktu dalam sistem Linux "biasa", maka perangkat Android membutuhkan pekerjaan yang lebih rumit untuk mengkonfigurasinya. <br><br>  Jika Anda tertarik pada topik otomatisasi dan Anda ingin skrip shell Anda diluncurkan segera setelah perangkat dinyalakan, dan bahkan dapat dimulai dengan timer - selamat datang di kucing! <br><a name="habracut"></a><br><h2>  Kata Pengantar </h2><br>  Saya terlibat dalam otomatisasi perangkat seluler untuk Android.  Dan selama eksekusi skrip otomatis, banyak situasi tak terduga terjadi, bahkan jika perangkat yang sama digunakan untuk pengujian. <br><br>  Masalah paling populer: <br><br>  0. Skrip otomatisasi tidak melakukan apa yang Anda inginkan. <br>  1. Aplikasi seluler diunduh secara otomatis <br>  2. Reboot telepon otomatis <br>  3. Aplikasi seluler tidak secara otomatis memulai setelah restart <br>  4. Modul Wi-Fi mati secara acak, tidak menemukan jaringan, tidak terhubung ke jaringan <br>  5. Jaringan seluler tiba-tiba menghilang <br>  6. Telepon masuk ke mode tidur <br>  7. Proxy terjatuh atau server itu sendiri atau server mengembalikan respons aneh <br><br>  Karena itu, Anda harus terus-menerus memonitor perangkat dan menangkap situasi yang tidak terduga ini. <br><br><img src="https://habrastorage.org/webt/93/fb/-1/93fb-1wjpwjs3tcpvv4jzg9b2zw.png"><br><br>  Jadi, saya sampai pada kesimpulan bahwa cron dengan skrip "benar" akan memungkinkan Anda untuk melacak kegagalan perangkat lunak dan mengembalikan skrip otomatisasi atau menjalankannya lagi.  Tapi ternyata, meskipun Android mengandung kernel Linux, ada nuansa khusus yang harus saya tangani.  Jadi mari kita mulai menyiapkan! <br><br><h2>  Penyiapan cron </h2><br><h3>  Sesuaikan lingkungan </h3><br><ol><li>  Instal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">adb</a> untuk mengakses perangkat melalui shell menggunakan kabel usb. </li><li>  Kami membuka bagian <b>Untuk pengembang</b> .  Untuk melakukan ini, buka bagian <b>Tentang telepon</b> dan buat beberapa klik pada <b>nomor Build</b> atau yang serupa. </li><li>  Kami pergi ke bagian <b>Untuk pengembang</b> dan menyalakannya.  Kami menghubungkan perangkat ke komputer dan memungkinkan akses di komputer ini ke perangkat ini. </li><li>  Tambahkan <b>root</b> untuk perangkat Anda.  Opsi yang paling umum adalah <b>SuperSu</b> , <b>Magisk,</b> dan <b>Kingroot</b> .  Pergi ke w3bsit3-dns.com dan temukan opsi root untuk perangkat Anda.  Sayangnya, tidak ada root universal. </li><li>  Kami menginstal <b>BusyBox</b> (itu juga di w3bsit3-dns.com, misalnya), karena hanya berisi program cron. </li></ol><br><h3>  Pengaturan mulai manual </h3><br><ol><li>  Kami terhubung ke ponsel menggunakan <b>adb shell</b> (jika adb tidak terdaftar dalam variabel lingkungan Anda, kemudian tambahkan path lengkap. </li><li>  Pergi ke mode root dengan perintah <b>su</b> </li><li>  Kami memeriksa keberadaan program cron dan melihat pengaturan menggunakan perintah <b>crond -h</b> </li></ol><br><div class="spoiler">  <b class="spoiler_title">hasil eksekusi</b> <div class="spoiler_text"><pre><code class="bash hljs">crond: invalid option -- h BusyBox v1.29.2-Stericson (2018-08-12 11:19:12 EDT) multi-call binary. Usage: crond -fbS -l N -d N -L LOGFILE -c DIR -f Foreground -b Background (default) -S Log to syslog (default) -l N Set <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> level. Most verbose 0, default 8 -d N Set <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> level, <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> to stderr -L FILE Log to FILE -c DIR Cron dir. Default:/var/spool/cron/crontabs</code> </pre> <br></div></div><br>  Seperti yang ditunjukkan baris terakhir, instruksi default harus disimpan di direktori <b>/ var / spool / cron / crontab</b> , yang tidak secara otomatis dibuat dan jika kita menjalankan perintah <pre> <code class="bash hljs">crond -b</code> </pre>  dan kemudian periksa apakah proses dimulai <pre> <code class="bash hljs">ps | grep crond</code> </pre>  , maka mungkin tidak ada di sana, karena  dia tidak bisa mendapatkan instruksi apa pun.  Jadi mari kita jalankan perintah <pre> <code class="bash hljs">crond -b -fd0</code> </pre>  dan lihat apa alasannya.  Kemungkinan besar Anda akan memiliki kesalahan yang sama: <br>  <code>crond: can't change directory to '/var/spool/cron/crontabs': No such file or directory</code> .  Dalam hal ini, ini normal, karena  di masa depan, kami sendiri akan menunjukkan jalur ke file executable crontab. <br><br>  4. Buat file crontab sederhana: <br><br><pre> <code class="bash hljs">mkdir /data/crontab <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"*/1 * * * * echo 'text' &gt;&gt; /sdcard/test.txt"</span></span> &gt; /data/crontab/root</code> </pre> <br>  Sekarang kami memiliki tugas yang setiap menit akan menambahkan <i>teks</i> kata ke file <b>/sdcard/test.txt</b> <br>  Kami meluncurkan: <pre> <code class="bash hljs">crond -b -fd0 -c /data/crontab</code> </pre>  dan dapatkan log berikut: <br><br><pre> <code class="bash hljs">crond: crond (busybox 1.29.2-Stericson) started, <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> level 0 crond: ignoring file <span class="hljs-string"><span class="hljs-string">'root'</span></span> (no such user) ...</code> </pre> <br>  Tentu saja, ini sedikit mengejutkan, karena jika kita menjalankan <b>perintah whoami,</b> itu akan mengembalikan <b>root</b> sebagai hasilnya. <br><br>  5. Tambahkan pengguna root, karena crond bertanya: <br><br><pre> <code class="bash hljs">mount -o remount,rw /system; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"root:x:0:0::/system/etc/crontabs:/system/bin/sh"</span></span> &gt;&gt; /system/etc/passwd; mount -o remount,ro /system;</code> </pre> <br>  Karena kurangnya file ini, saya menyadari bahwa dalam sistem Android tidak terlibat sama sekali.  Jika Anda yakin di mana Anda akan menyimpan file crontab Anda, maka Anda dapat mengganti baris <b>/ sistem / etc / crontab</b> dengan yang Anda butuhkan.  Jalankan perintah lagi <br><br><pre> <code class="bash hljs">crond -b -fd0 -c /data/crontab</code> </pre> <br>  Dan kami mendapatkan yang berikut: <br><br><pre> <code class="bash hljs">crond: user:root entry:*/1 * * * * <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt 111111111111111111111111111111111111111111111111111111111111 111111111111111111111111 11111111111111111111111111111111 111111111111 1111111 crond: wakeup dt=16 crond: file root: crond: line <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt crond: job: 0 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt crond: can<span class="hljs-string"><span class="hljs-string">'t change directory to '</span></span>/system/etc/crontabs<span class="hljs-string"><span class="hljs-string">' crond: can'</span></span>t change directory to <span class="hljs-string"><span class="hljs-string">'/var/spool/cron'</span></span>: No such file or directory crond: USER root pid 12849 cmd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt</code> </pre> <br>  Meskipun, menurut log, tugas itu terdaftar di crond, tetapi dalam kasus saya file tersebut tidak dibuat.  Masalahnya dapat diselesaikan dengan sangat sederhana: <br><br><pre> <code class="bash hljs">mkdir -p /system/etc/crontabs</code> </pre> <br>  Yah, dia ingin direktori ada di sana, siapa kita untuk melarangnya!  Kami mulai lagi dan melihat: <br><br><pre> <code class="bash hljs">crond: user:root entry:*/1 * * * * <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt 111111111111111111111111111111111111111111111111111111111111 111111111111111111111111 11111111111111111111111111111111 111111111111 1111111 crond: wakeup dt=12 crond: file root: crond: line <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt crond: job: 0 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt crond: child running /system/bin/sh crond: USER root pid 13033 cmd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span> &gt;&gt; /sdcard/test.txt</code> </pre> <br>  Kesalahan hilang dan baris <b>crond: child running / system / bin / sh muncul</b> .  Akhirnya, cron telah berhasil diselesaikan, dan Anda dapat melanjutkan ke bagian kedua! <br><br><h2>  Unduh skrip shell otomatis </h2><br>  Sistem Linux memiliki direktori <b>init.d</b> yang bertanggung jawab untuk autostart segera setelah sistem melakukan booting, jadi mari kita coba cara ini! <br><br>  1. Periksa apakah direktori ini ada di perangkat Anda (ini adalah <b>/etc/init.d</b> atau <b>/system/etc/init.d</b> - ini adalah partisi yang sama, dll).  Dalam kasus saya, tidak.  Nah, lalu buat: <br><br><pre> <code class="bash hljs">mount -o remount,rw /system mkdir /system/etc/init.d chmod 0755 /system/etc/init.d mount -o remount,ro /system</code> </pre> <br>  Sekarang tambahkan beberapa skrip sederhana di sana, misalnya: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"echo 'Init.d is working !!!' &gt;&gt; /sdcard/init_test.log"</span></span> &gt; /system/etc/init.d/90my_script chmod 777 /system/etc/init.d/90my_script</code> </pre> <br>  Kami me-reboot perangkat dan melihat apakah keajaiban terjadi ... Sayangnya, file saya tidak muncul. <br><br>  Kami memeriksa sistem lebih lanjut dan mencari beberapa file init yang dapat menjalankan skrip setelah diluncurkan.  Saya punya file di <b>/init.rc</b> di perangkat saya.  Baiklah, mari kita coba ubah dan reboot perangkat: <br><br><pre> <code class="bash hljs">mount -o remount,rw / <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"echo 'Init.d is working !!!' &gt;&gt; /sdcard/init_test.log"</span></span> &gt;&gt; /init.rc mount -o remount,ro / reboot</code> </pre> <br>  Tetapi file itu tidak dibuat lagi.  Kami pergi untuk melihat file <b>/init.rc</b> dan catatan kami menghilang dan file sepertinya tidak berubah, karena  tanggal pembuatannya cukup aneh (dalam kasus saya, 1 Januari, 70 05:00). <br><br>  Kami terus memahami, dan ternyata file ini disimpan di <b>boot.img</b> , dan setiap kali ia keluar darinya.  Dan untuk mengubah fungsionalitas file <b>init.rc</b> , <b>Anda</b> harus melakukan semua <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> . <br><br>  Tetapi ada cara yang lebih mudah untuk membantu menyelesaikan masalah ini.  Untuk metode ini, kita dapat menggunakan skrip shell berikut (ucapkan terima kasih kepada Ryuinferno): <br><br><div class="spoiler">  <b class="spoiler_title">Skrip shell</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/system/bin/sh #Script to enable init.d by Ryuinferno @ XDA error_msg(){ echo "You do not need this mod..." sleep 1 echo "If you are reapplying, please delete these files if present:" echo "/system/bin/sysinit" sleep 1 echo "/system/etc/install-recovery.sh" sleep 1 echo "/system/etc/install-recovery-2.sh" sleep 1 echo "And run again..." sleep 1 echo "If init.d is still not working, read the FAQ part in my thread..." sleep 1 echo "Aborting..." mount -o remount,ro -t auto /system echo "" echo "Ryuinferno @ XDA" exit 1 } echo "Init.d Enabler by Ryuinferno @ XDA" echo "" sleep 1 id=`id`; id=`echo ${id#*=}`; id=`echo ${id%%\(*}`; id=`echo ${id%% *}` if [ "$id" != "0" ] &amp;&amp; [ "$id" != "root" ]; then echo "Script NOT running as root!" sleep 1 echo "Superuser access not granted!" sleep 1 echo "Please type 'su' first before running this script..." exit 1 else echo "Hello Supaa User! :P" echo "" sleep 1 fi if [ ! "'which busybox'" ]; then echo "busybox NOT INSTALLED!" sleep 1 echo "Please install busybox first!" exit 1 else echo "busybox found!" sleep 1 fi bbb=0 if [ ! "`which grep`" ]; then bbb=1 echo "grep applet NOT FOUND!" sleep 1 else echo "Awesome! grep found! :D" sleep 1 fi if [ ! "`which run-parts`" ]; then bbb=1 echo "run-parts applet NOT FOUND!" sleep 1 else echo "Good! run-parts found! :)" echo "" sleep 1 fi if [ $bbb -eq 1 ] ; then echo "" echo "Required applets are NOT FOUND!" echo "" sleep 1 echo "Please reinstall busybox!" exit 1 fi echo "Great! Let's proceed..." echo "" sleep 1 echo "Press enter to continue..." read enterKey clear sleep 1 echo "Mounting system as rewritable..." mount -o remount,rw -t auto /system sleep 1 echo "Removing old sysinit file" rm /system/bin/sysinit sleep 1 echo "" echo "Checking for the presence of sysinit in /system/bin..." sleep 1 if [ -e /system/bin/sysinit ]; then echo "sysinit found..." if [ -z "`cat /system/bin/sysinit | grep "init.d"`" ]; then echo "Adding lines to sysinit..." echo "" &gt;&gt; /system/bin/sysinit echo "# init.d support" &gt;&gt; /system/bin/sysinit echo "" &gt;&gt; /system/bin/sysinit echo "export PATH=/sbin:/system/sbin:/system/bin:/system/xbin" &gt;&gt; /system/bin/sysinit echo "run-parts /system/etc/init.d" &gt;&gt; /system/bin/sysinit echo "" &gt;&gt; /system/bin/sysinit else echo "" echo "Your sysinit should already be running the scripts in init.d folder at boot..." error_msg fi else echo "sysinit not found, creating file..." echo "#!/system/bin/sh" &gt; /system/bin/sysinit echo "# init.d support" &gt;&gt; /system/bin/sysinit echo "" &gt;&gt; /system/bin/sysinit echo "export PATH=/sbin:/system/sbin:/system/bin:/system/xbin" &gt;&gt; /system/bin/sysinit echo "run-parts /system/etc/init.d" &gt;&gt; /system/bin/sysinit echo "" &gt;&gt; /system/bin/sysinit fi sleep 1 echo "Setting correct permissions and ownership for sysinit..." chmod 755 /system/bin/sysinit chown 0.2000 /system/bin/sysinit sleep 1 echo "" echo "Checking for the presence of install-recovery.sh..." sleep 1 if [ -f /system/etc/install-recovery.sh ] &amp;&amp; [ -z "`cat /system/etc/install-recovery.sh | grep "daemon"`" ]; then if [ ! -z "`cat /system/etc/install-recovery.sh | grep "init.d"`" ];then echo "Your install-recovery.sh seems to be already modified for init.d..." error_msg fi echo "install-recovery.sh found, renaming it as install-recovery-2.sh..." mv /system/etc/install-recovery.sh /system/etc/install-recovery-2.sh echo "Recreating install-recovery.sh..." echo "#!/system/bin/sh" &gt; /system/etc/install-recovery.sh echo "# init.d support" &gt;&gt; /system/etc/install-recovery.sh echo "" &gt;&gt; /system/etc/install-recovery.sh echo "/system/bin/sysinit" &gt;&gt; /system/etc/install-recovery.sh echo "" &gt;&gt; /system/etc/install-recovery.sh echo "# excecuting extra commands" &gt;&gt; /system/etc/install-recovery.sh echo "/system/etc/install-recovery-2.sh" &gt;&gt; /system/etc/install-recovery.sh echo "" &gt;&gt; /system/etc/install-recovery.sh elif [ -f /system/etc/install-recovery.sh ] &amp;&amp; [ ! -z "`cat /system/etc/install-recovery.sh | grep "daemon"`" ]; then if [ -f /system/etc/install-recovery-2.sh ] &amp;&amp; [ ! -z "`cat /system/etc/install-recovery-2.sh | grep "init.d"`" ];then echo "Your install-recovery-2.sh seems to be already modified for init.d..." error_msg fi echo "install-recovery.sh is used for superuser, using install-recovery-2.sh instead..." if [ -f /system/etc/install-recovery-2.sh ]; then echo "" &gt;&gt; /system/etc/install-recovery-2.sh echo "# init.d support" &gt;&gt; /system/etc/install-recovery-2.sh echo "/system/bin/sysinit" &gt;&gt; /system/etc/install-recovery-2.sh echo "" &gt;&gt; /system/etc/install-recovery-2.sh else echo "#!/system/bin/sh" &gt; /system/etc/install-recovery-2.sh echo "# init.d support" &gt;&gt; /system/etc/install-recovery-2.sh echo "" &gt;&gt; /system/etc/install-recovery-2.sh echo "/system/bin/sysinit" &gt;&gt; /system/etc/install-recovery-2.sh echo "" &gt;&gt; /system/etc/install-recovery-2.sh fi if [ -z "`cat /system/etc/install-recovery.sh | grep "install-recovery-2.sh"`" ]; then echo "" &gt;&gt; /system/etc/install-recovery.sh echo "# extra commands" &gt;&gt; /system/etc/install-recovery.sh echo "/system/etc/install-recovery-2.sh" &gt;&gt; /system/etc/install-recovery.sh echo "" &gt;&gt; /system/etc/install-recovery.sh fi else echo "install-recovery.sh not found, creating it..." echo "#!/system/bin/sh" &gt; /system/etc/install-recovery.sh echo "# init.d support" &gt;&gt; /system/etc/install-recovery.sh echo "" &gt;&gt; /system/etc/install-recovery.sh echo "/system/bin/sysinit" &gt;&gt; /system/etc/install-recovery.sh echo "" &gt;&gt; /system/etc/install-recovery.sh fi sleep 1 echo "Setting the correct permissions and ownership for install-recovery.sh..." echo "Also for install-recovery-2.sh if it exists..." chmod 755 /system/etc/install-recovery.sh chown 0.0 /system/etc/install-recovery.sh if [ -f /system/etc/install-recovery-2.sh ]; then chmod 755 /system/etc/install-recovery-2.sh chown 0.0 /system/etc/install-recovery-2.sh fi sleep 1 echo "" echo "Checking for the presence of the init.d folder..." sleep 1 if [ -d /system/etc/init.d ]; then echo "init.d folder found..." else echo "init.d folder not found, creating the folder..." mkdir /system/etc/init.d fi sleep 1 echo "" echo "Creating basic init.d scripts..." echo "#!/system/bin/sh" &gt; /system/etc/init.d/08setperm echo "#set correct permissions to /system/etc/init.d folder" &gt;&gt; /system/etc/init.d/08setperm echo "" &gt;&gt; /system/etc/init.d/08setperm echo "mount -o remount,rw -t auto /system" &gt;&gt; /system/etc/init.d/08setperm echo "chmod -R 777 /system/etc/init.d" &gt;&gt; /system/etc/init.d/08setperm echo "mount -o remount,ro -t auto /system" &gt;&gt; /system/etc/init.d/08setperm echo "" &gt;&gt; /system/etc/init.d/08setperm echo "#!/system/bin/sh" &gt; /system/etc/init.d/00test echo "#init.d test" &gt;&gt; /system/etc/init.d/00test echo "" &gt;&gt; /system/etc/init.d/00test echo "if [ -f /data/Test.log ]; then" &gt;&gt; /system/etc/init.d/00test echo "rm /data/Test.log" &gt;&gt; /system/etc/init.d/00test echo "fi" &gt;&gt; /system/etc/init.d/00test echo "" &gt;&gt; /system/etc/init.d/00test echo 'echo "Init.d is working !!!" &gt;&gt; /data/Test.log' &gt;&gt; /system/etc/init.d/00test echo 'echo "excecuted on $(date +"%d-%m-%Y %r" )" &gt;&gt; /data/Test.log' &gt;&gt; /system/etc/init.d/00test echo "" &gt;&gt; /system/etc/init.d/00test sleep 1 echo "Creating permissive SELinux script..." sleep 1 echo "#!/system/bin/sh" &gt;&gt; /system/etc/init.d/01permissive echo "#Init.d Permissive SELinux" &gt;&gt; /system/etc/init.d/01permissive echo "" &gt;&gt; /system/etc/init.d/01permissive echo "busybox mount -o remount,rw -t auto /system" &gt;&gt; /system/etc/init.d/01permissive echo "" &gt;&gt; /system/etc/init.d/01permissive echo "setenforce 0" &gt;&gt; /system/etc/init.d/01permissive echo "SELINUX=permissive" &gt;&gt; /system/etc/init.d/01permissive echo "" &gt;&gt; /system/etc/init.d/01permissive sleep 1 echo "Setting correct permissions and ownership for init.d folder and scipts..." chmod 777 /system/etc/init.d chmod 777 /system/etc/init.d/08setperm chmod 777 /system/etc/init.d/00test chmod 777 /system/etc/init.d/01permissive chown 0.0 /system/etc/init.d chown 0.0 /system/etc/init.d/08setperm chown 0.0 /system/etc/init.d/00test chown 0.0 /system/etc/init.d/01permissive sleep 1 echo "" echo "Mounting system as read-only..." mount -o remount,ro -t auto /system sleep 1 echo "" echo "Done!!!" sleep 1 echo "Please reboot at least twice before checking /data..." sleep 1 echo "If init.d is working, you will see a Test.log in /data..." sleep 1 echo "" echo "Enjoy!!! =)" echo "Ryuinferno @ XDA 2013" exit</span></span></code> </pre><br></div></div><br>  Memulai dengan skrip!  Dalam kasus saya, itu akan disebut init.sh. <br>  1. Unduh file ke sdcard perangkat seluler: <br><pre> <code class="bash hljs">adb push /tmp/init.sh /sdcard</code> </pre> <br>  2. Salin ke memori perangkat seluler dan tetapkan hak yang diperlukan: <br><pre> <code class="bash hljs">adb shell su cp /sdcard/init.sh /data/init.sh chmod 777 /data/init.sh</code> </pre> <br>  3. Jalankan untuk eksekusi: <br><pre> <code class="bash hljs">/data/init.sh</code> </pre> <br>  Dan perhatikan log yang ditampilkan.  Ini log saya: <br><div class="spoiler">  <b class="spoiler_title">Jalankan log</b> <div class="spoiler_text"><pre> <code class="bash hljs">Init.d Enabler by Ryuinferno @ XDA Hello Supaa User! :P busybox found! Awesome! grep found! :D Good! run-parts found! :) Great! Let<span class="hljs-string"><span class="hljs-string">'s proceed... Press enter to continue... Mounting system as rewritable... Removing old sysinit file rm: /system/bin/sysinit: No such file or directory Checking for the presence of sysinit in /system/bin... sysinit not found, creating file... Setting correct permissions and ownership for sysinit... Checking for the presence of install-recovery.sh... install-recovery.sh not found, creating it... Setting the correct permissions and ownership for install-recovery.sh... Also for install-recovery-2.sh if it exists... Checking for the presence of the init.d folder... init.d folder found... Creating basic init.d scripts... Creating permissive SELinux script... Setting correct permissions and ownership for init.d folder and scipts... Mounting system as read-only... Done!!! Please reboot at least twice before checking /data... If init.d is working, you will see a Test.log in /data... Enjoy!!! =) Ryuinferno @ XDA 2013</span></span></code> </pre> <br></div></div><br>  Seperti yang dapat Anda lihat dari log, tidak ada kesalahan, jadi silakan reboot perangkat!  Mungkin seseorang sudah bekerja dan Anda dapat menemukan file / data / <b>Test.log</b> , tetapi saya tidak memilikinya.  Periksa direktori <b>/system/etc/init.d</b> menggunakan <b>perintah ls</b> : <br><br><pre> <code class="bash hljs">00test 01permissive 08setperm</code> </pre> <br>  Seperti yang Anda lihat, tugas telah berhasil dibuat.  Anda mungkin masih harus mengubah <b>boot.img</b> , tetapi mari kita periksa di awal, di mana file <b>install-recovery.sh</b> dengan perintah <br><br><pre> <code class="bash hljs">find / -name <span class="hljs-string"><span class="hljs-string">"install-recovery.sh"</span></span> ... /system/bin/install-recovery.sh /system/etc/install-recovery.sh ...</code> </pre> <br>  Seperti yang dapat kita lihat, kita memiliki 2 file yang terletak di tempat yang berbeda.  Pada tanggal pembuatan, kita dapat melihat bahwa skrip tersebut membuat file di direktori <b>/system/etc/install-recovery.sh</b> , walaupun, dalam beberapa kasus, ia harus membuatnya di <b>/ system / dll.</b>  Mari ganti nama file menjadi bin dan salin file dari dll: <br><br><pre> <code class="bash hljs">mount -o remount,rw /system mv /install-recovery.sh /system/bin/install-recovery2.sh cp /install-recovery.sh /system/bin/</code> </pre> <br><br>  <b>UPD</b> : Harap perhatikan bahwa konteks keamanan untuk kedua file harus cocok.  Dan jika Anda tiba-tiba tersesat saat menyalin (walaupun secara teori ini seharusnya tidak), Anda harus mengembalikannya (misalnya, melalui utilitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">chcon</a> ).  Lihat informasi file lengkap dengan <b>ls -lZ</b> : <br><pre> <code class="bash hljs">ls -lZ /system/etc/install-recovery.sh <span class="hljs-comment"><span class="hljs-comment"># -rwxr-xr-x root root u:object_r:system_file:s0 install-recovery.sh</span></span></code> </pre><br>  Di sini <b>u: object_r: system_file: s0</b> adalah konteks keamanan. <br><br>  Dan lagi kita me-reboot perangkat ... Dan sekarang, akhirnya, SUKSES yang telah lama ditunggu-tunggu!  File <b>/data/Test.log telah</b> muncul! <br><br>  Setelah semuanya berfungsi, buka <b>/system/etc/init.d</b> dan buat skrip shell.  Dan di dalamnya, jalankan perintah kami untuk menjalankan: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"#!/system/bin/sh crond -b -L /sdcard/error.log -c /data/crontab"</span></span> &gt; /system/etc/init.d/99cronstart chmod 777 /system/etc/init.d/99cronstart reboot</code> </pre> <br>  Setelah mengunduh, periksa apakah crond sudah mulai: <br><br><pre> <code class="bash hljs">ps | grep crond root 414 1 9532 236 hrtimer_na 000dcf90 S crond</code> </pre> <br>  Dan kita bisa mengakhiri sekarang, tapi mari kita tunggu sebentar dan lihat apakah ada catatan di file kita ... Nah, seperti yang sudah Anda pahami, sekali lagi, tidak ada yang berhasil.  Faktanya adalah bahwa proses ini perlu dijalankan dari pengguna super.  Ubah skrip dalam file <b>99cronstart</b> : <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"#!/system/bin/sh /su/bin/su -c crond -b -L /sdcard/error.log -c /data/crontab"</span></span> &gt; /system/etc/init.d/99cronstart reboot</code> </pre> <br><br>  <b>UPD</b> : Mungkin dalam kasus Anda <b>su</b> akan memiliki jalur yang berbeda, kemudian gunakan perintah <b>yang su</b> dan ganti jalur dengan Anda. <br><br>  Sekarang perangkat Android kami mendukung tugas cron dan mungkin berisi skrip shell untuk peluncuran otomatis! <br><br>  Dan akhirnya, skrip yang akan menjalankan aplikasi kita jika tidak dalam proses dan menyimpan informasi tentang apa yang ada di layar utama sebelum meluncurkan aplikasi kita: <br><br><pre> <code class="bash hljs">proc=$(ps | grep <span class="hljs-string"><span class="hljs-string">"com.test.app"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$proc</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">""</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> dumpsys window | grep CurrentFocus &gt; /sdcard/current_focus.dump sleep 1 am start -n com.test.app/com.test.app.activities.MainActivity <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id468337/">https://habr.com/ru/post/id468337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id468321/index.html">Saya selamat dari kejenuhan, atau Bagaimana cara menghentikan hamster di dalam roda</a></li>
<li><a href="../id468323/index.html">Kebisingan apa yang membantu berkonsentrasi dan bersantai, dan juga mencegah gangguan pendengaran dalam kecelakaan parah</a></li>
<li><a href="../id468327/index.html">Gap - masa depan yang cerah untuk lekukan di Flexbox (seperti di Grid)</a></li>
<li><a href="../id468331/index.html">Momen kehidupan Stephen Wolfram - pencipta Mathematica, Wolfram | Alpha, A New Science Of Science dan banyak lagi</a></li>
<li><a href="../id468333/index.html">Cara debug dan profil file exe apa pun menggunakan Visual Studio</a></li>
<li><a href="../id468339/index.html">Memperkenalkan Tema Gelap untuk Pusat Aplikasi Visual Studio</a></li>
<li><a href="../id468341/index.html">Azure Cloud Shell di Terminal Windows</a></li>
<li><a href="../id468343/index.html">Jeff Bezos: "Pergi ke Luar Angkasa untuk Kebaikan Bumi"</a></li>
<li><a href="../id468345/index.html">GitHub meluncurkan tentakelnya dalam CI / CD dan manajemen artefak</a></li>
<li><a href="../id468347/index.html">MetricKit. Analisis kinerja aplikasi iOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>