<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßíüèø üöö ü§ô Gehen Sie in Hunderttausenden von Zeilen gegen Excel üìΩÔ∏è ü§∂üèæ üñ•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Jahr haben wir bereits auf Habr√© √ºber unser Projekt SmartCalls.io geschrieben - einen visuellen Anrufdesigner , der f√ºr Gesch√§ftsanwender en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gehen Sie in Hunderttausenden von Zeilen gegen Excel</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/Voximplant/blog/424697/">  In diesem Jahr haben wir bereits <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf Habr√©</a> √ºber unser Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SmartCalls.io geschrieben</a> - einen visuellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anrufdesigner</a> , der f√ºr Gesch√§ftsanwender entwickelt wurde.  Das Projekt l√∂st das Gesch√§ftsproblem von Massenkundenanrufen: Ein visuelles Anrufskript wird erstellt, eine Excel-Datei mit Telefonnummern wird geladen und anschlie√üend wird eine Anrufkampagne erstellt.  Die Kampagne wird gestartet - Kundenanrufe beginnen;  Sie k√∂nnen jederzeit Statistiken anzeigen, die Kampagne anhalten und die Einstellungen anpassen.  Die Kunden waren zufrieden, bis klar wurde, dass es manchmal notwendig ist, nicht nur viele Leute anzurufen, sondern SEHR, SEHR viel.  Unter dem Schnitt liegt die Essenz des Problems und wie wir es mit Hilfe einer HYIP-Programmiersprache (nicht unbegr√ºndet) besiegt haben. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fo/uq/tb/fouqtbwyesfm-kepb-dfnpg71ig.png"></div><a name="habracut"></a><br><h3>  Das Problem </h3><br>  Urspr√ºnglich wurde die Dateiverarbeitung in PHP 7.1 implementiert - dies war eine offensichtliche Wahl, da die gesamte SmartCalls-API darauf geschrieben wurde.  Die Arbeit mit Anruflisten hatte eine Einschr√§nkung: Die Datei sollte nicht mehr als 10.000 gef√ºllte Zeilen enthalten.  Diese Einschr√§nkung war bei SmartCalls von Anfang an vorhanden und jedoch nicht kritisch.  Bis zu einem bestimmten Punkt. <br><br>  Eine gro√üe Bank ben√∂tigte sehr gro√üe Telefonkampagnen: Es mussten mehr als 10.000 Benutzer angerufen werden.  Nat√ºrlich hat nichts verhindert, dass gro√üe Dateien in mehrere kleine Dateien aufgeteilt und einzeln heruntergeladen werden, aber es ist nicht unsere Methode, Kunden so leiden zu lassen.  Apropos alternative Downloads - Wenn unser Kunde bereits eine Anrufkampagne gestartet hat und pl√∂tzlich Benutzer hinzuf√ºgen m√∂chte, kann er dies problemlos tun.  Dies ist sehr praktisch, da Sie nicht aufh√∂ren m√ºssen zu telefonieren oder eine separate Kampagne f√ºr neue Benutzer ausf√ºhren m√ºssen.  Sie sollten jedoch verstehen, dass die M√∂glichkeit des erneuten Ladens nicht als M√∂glichkeit gedacht war, gro√üe Dateien manuell in Teilen zu laden. <br><br>  Das Team hatte also die Aufgabe, das Hochladen gro√üer Dateien in die Telefonkampagne zu implementieren. <br><br><h3>  L√∂sung </h3><br>  Wir sind sehr kompetent in der Java-Entwicklung - zum Beispiel ist die Voximplant-API teilweise in dieser Sprache implementiert;  Wir sind auch gut in PHP (siehe das obige Beispiel - Captain Evidence schl√§gt vor).  Das hei√üt, wir k√∂nnten diese Aufgabe mit einer dieser Sprachen schnell schlie√üen, aber wir haben lange dar√ºber nachgedacht, unseren Technologie-Stack zu erweitern, und hier haben wir uns gut an Go erinnert: Es ist schnell genug (funktioniert gut mit Speicher), ist Multithread-f√§hig und ben√∂tigt keine Laufzeit weil  Go kompiliert in eine ausf√ºhrbare Bin√§rdatei.  Dar√ºber hinaus k√∂nnen wir √ºber die Gr√∂√üe der Container sagen, aber dazu sp√§ter mehr ... <br><br>  Aus diesem Grund haben wir einen Microservice in der Sprache Go geschrieben, der gro√üe Bl√§tter (bis zu 300.000 Zeilen getestet) und das Format (xls, xlsx und alle ihre Variationen) akzeptiert.  Jetzt ist die Zeit f√ºr Details. <br><br><h3>  Implementierung </h3><br>  Wenn ein Client eine Datei mit mehr als 10.000 Zeilen in eine SmartCalls-Kampagne hochl√§dt, wird ein Microservice daf√ºr verwendet.  Es werden Eingabezeiger ben√∂tigt: <br><br><ul><li>  in eine Datei, die in den S3-Speicher heruntergeladen wurde; </li><li>  zu der Kampagne, in die diese Datei hochgeladen werden muss. </li></ul><br>  Anschlie√üend durchl√§uft der Microservice die Datei, trifft sie in Bl√∂cken von 10.000 Zeilen (maximal f√ºr die Plattform) und l√§dt jeden Block als <b>CSV-Datei</b> in den S3-Speicher, wobei er in der Datenbank Notizen zu jedem Block macht (Pfad zur Datei, Anzahl der Zeilen).  Jeder Block wird verarbeitet und in einen separaten Stream geladen, was die Ausf√ºhrungsgeschwindigkeit zus√§tzlich erh√∂ht. <br><br>  Zum Lesen von Excel-Dateien werden Open-Source-Bibliotheken aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tealeg</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Extrame verwendet</a> .  Es ist gut, dass sie nicht nur viele Stars haben, sondern auch neue Commits :) <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/tealeg/xlsx"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/extrame/xls"</span></span> <span class="hljs-comment"><span class="hljs-comment">//   )</span></span></code> </pre> <br>  Und alles w√§re gut, aber nicht ohne Nuancen.  W√§hrend der Entwicklung stellte sich heraus, dass xlsx und xls, die in verschiedenen Editoren erstellt wurden, sich in Formaten und Regeln f√ºr die Arbeit mit ihnen sehr unterscheiden.  Ich musste viele Tests durchf√ºhren - OpenOffice, Excel verschiedener Versionen, LibreOffice, Google Sheets, um dem Microservice beizubringen, Dateien in eine einzige Form zu bringen - CSV.  Nachdem der Microservice eine gro√üe Datei ‚Äûgekaut‚Äú und in eine CSV umgewandelt hat, wird die SmartCalls-API aktiviert und funktioniert bereits mit dieser CSV-Datei.  F√ºr den Microservice haben wir ein Limit von 300.000 Leitungen festgelegt, da es die Bed√ºrfnisse der Kunden stark abdeckt und wir √ºberhaupt keine gr√∂√üeren Bed√ºrfnisse festgestellt haben. <br><br>  Infolgedessen zeigte die Implementierung hervorragende Ergebnisse bei Tests und Preprod. Danach haben wir sie in das Produkt eingef√ºhrt. <br><br><h3>  Fazit </h3><br>  Unser Team ist stets bem√ºht, neue Funktionen / Verbesserungen schnell einzuf√ºhren, da wir m√∂chten, dass zufriedene Kunden dies auch bleiben.  Die Aufgabe mit gro√üen Dateien war nicht nur eine weitere Herausforderung f√ºr uns, sondern auch ein guter Grund, Go in das Projekt einzuf√ºhren, das wir uns schon lange angesehen haben.  Neben der schnellen Entwicklung und der schnellen Arbeit gibt uns Go eine Grundlage f√ºr die Zukunft, wenn wir mit der Einf√ºhrung von Containern beginnen (um nahtlose Aktualisierungen vorzunehmen und das ist alles). Diese Sprache ist sehr leicht.  Wir werden separat √ºber Container schreiben, bleiben dran :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de424697/">https://habr.com/ru/post/de424697/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de424687/index.html">Das sind die richtigen Bienen: mechanische Anpassung an dynamische Effekte</a></li>
<li><a href="../de424689/index.html">Die Kontrolle √ºber die Situation macht gl√ºcklich.</a></li>
<li><a href="../de424691/index.html">Wir laden Sie zur Konferenz Azov Developers Meetup 2018 - 13. Oktober in Taganrog ein</a></li>
<li><a href="../de424693/index.html">Hinzuf√ºgen eines Wasserzeichens zu allen Bildern der Site</a></li>
<li><a href="../de424695/index.html">RedSlerm verwandelt sich in eine Kammer und eine einmalige Veranstaltung</a></li>
<li><a href="../de424699/index.html">Willkommen zum praktischen Workshop API Jam</a></li>
<li><a href="../de424701/index.html">Fiktive IT-Geschichten √ºber Betr√ºger und warum diese obskuren Praktiken bei Interviews auftauchten</a></li>
<li><a href="../de424703/index.html">Und wieder √ºber Depersonalisierung</a></li>
<li><a href="../de424709/index.html">Meisterwerke des Welts√§ulenbaus: 225 W RMS f√ºr 28 000 Rubel</a></li>
<li><a href="../de424711/index.html">Vom Hydrogel zum Schweinedarm: ungew√∂hnliche Materialien in der Robotik</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>