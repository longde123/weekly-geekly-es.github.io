<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì£ üê© üêÜ N√≥s olhamos sob o cap√¥ do novo Gmail üëâüèª üöÆ üëåüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seis meses atr√°s, o Google lan√ßou uma vers√£o atualizada do seu servi√ßo de e-mail. Apesar do fato de muitos usu√°rios estarem descontentes com o redesen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>N√≥s olhamos sob o cap√¥ do novo Gmail</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429506/"><p>  Seis meses atr√°s, o Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lan√ßou uma</a> vers√£o atualizada do seu servi√ßo de e-mail.  Apesar do fato de muitos usu√°rios estarem descontentes com o redesenho, inclusive <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no Habr√©</a> , essa agora √© a interface principal para os usu√°rios. </p><br><p>  Entre outras defici√™ncias, as pessoas reclamam da degrada√ß√£o do desempenho da nova vers√£o, especialmente em computadores fracos.  Vamos ver por que isso acontece e o que pode ser t√£o dif√≠cil na interface de email.  Neste artigo, usaremos as ferramentas de desenvolvedor no Google Chrome, portanto, este artigo tamb√©m ser√° um lembrete de quais oportunidades est√£o dispon√≠veis l√°. </p><a name="habracut"></a><br><h2 id="ishodnye-dannye">  Dados de origem </h2><br><p>  Primeiro, voc√™ precisa entender com o que estamos lidando.  O Google Chrome Devtools possui uma ferramenta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">farol</a> integrada que cria um relat√≥rio de desempenho simples e direto para o seu site.  Nele, o Gmail obt√©m um desempenho de desempenho (m√°ximo de 100 pontos!) </p><br><p><img src="https://habrastorage.org/webt/yu/zg/lp/yuzglprkqo7bjwn7ddfbcdxz8k0.png"></p><br><p>  Para ser sincero, esse n√£o √© o resultado que voc√™ espera de um produto do Google.  No entanto, vejamos essa situa√ß√£o com mais detalhes.  Desligue o cache e carregue a interface do Gmail com os devtools ativados.  A guia Rede mostrar√° todos os pedidos feitos para baixar esta p√°gina.  Descobriu-se 6,9 ‚Äã‚ÄãMb.  Esse √© um tamanho impressionante, j√° que at√© o YouTube, outro servi√ßo atualizado recentemente, carrega apenas 2 MB de recursos. </p><br><blockquote>  Vale a pena notar aqui que os servi√ßos modernos, incluindo o Gmail, usam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Service Serviceers</a> para melhorar o cache de recursos.  Portanto, para medi√ß√µes precisas de partida a frio, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">desligar o cache</a> n√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√©</a> suficiente; voc√™ tamb√©m precisa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">redefinir os Trabalhadores em Servi√ßo</a> , que tamb√©m mant√™m recursos.  Somente depois disso, o n√∫mero do download a partir do zero ser√° real. </blockquote><p>  Agora vamos tentar ver a p√°gina carregando em c√¢mera lenta.  A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o do Google Chrome</a> explica como fazer isso.  Temos um conjunto de capturas de tela de diferentes est√°gios do carregamento da p√°gina: </p><br><p><img src="https://habrastorage.org/webt/2j/tw/ao/2jtwaofovrdv_ytxy6vjd6dnzrm.png"></p><br><p>  Aqui voc√™ pode ver que a p√°gina est√° mais ou menos carregada no 9¬∫ segundo. </p><br><p>  Com o recarregamento ao usar o cache, a situa√ß√£o √© melhor.  A p√°gina faz apenas 250 Kb de solicita√ß√µes, mas isso n√£o a torna mais r√°pida, ainda vemos a tela inicial por quase 10 segundos.  O ponto claramente n√£o √© o n√∫mero de solicita√ß√µes; outra coisa torna a p√°gina mais lenta. </p><br><h2 id="blokiruem-resursy">  Bloqueamos recursos </h2><br><p>  Agora veja a lista de scripts para download: </p><br><p><img src="https://habrastorage.org/webt/md/2l/qw/md2lqwcqm3bl9l5frwa4-c3qpqi.png"></p><br><p>  Talvez alguns deles n√£o sejam t√£o necess√°rios para o funcionamento normal da interface?  Vamos tentar desativ√°-los um por um e testar a p√°gina sem eles.  Isso √© feito facilmente usando a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">funcionalidade incorporada</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">devtools</a> . </p><br><p> Empiricamente, as solicita√ß√µes de <code>https://mail.google.com/_/scs/*</code> s√£o cr√≠ticas para o funcionamento da interface, mas as seguintes solicita√ß√µes podem ser bloqueadas: </p><br><ul><li>  <code>www.gstatic.com/og/*</code> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Biblioteca cliente da API do Google</a> , biblioteca para solicita√ß√µes de servi√ßos do Google </li><li>  <code>ssl.gstatic.com/inputtools/*</code> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ferramentas de entrada do Google</a> - widget de teclado na tela </li><li>  <code>hangouts.google.com</code> - respons√°vel pelo widget de folhetos </li></ul><br><blockquote>  Al√©m dessas solicita√ß√µes, meu AdBlock j√° instalou solicita√ß√µes bloqueadas para <code>https://play.google.com/log</code> , n√£o as levamos em considera√ß√£o, pois elas n√£o foram feitas mesmo antes do in√≠cio das experi√™ncias com bloqueios. </blockquote><p>  Adicionamos esses scripts √† lista negra e vemos que a p√°gina come√ßou a carregar em 4 segundos, mas voc√™ ainda pode ler e escrever cartas. </p><br><h2 id="smotrim-v-profayler">  N√≥s olhamos no perfilador </h2><br><p>  Portanto, minimizamos o carregamento de recursos o m√°ximo que pudemos, mas a p√°gina ainda leva muito tempo para carregar.  Precisamos ver o que acontece durante esses 4 segundos.  Aqui, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">criador de perfil incorporado ao Chrome</a> vir√° em nosso aux√≠lio.  Ele nos mostra esta imagem: </p><br><p><img src="https://habrastorage.org/webt/nf/df/5f/nfdf5fyvr7vgproydoxpqjo4zgo.png"></p><br><p>  Aqui voc√™ pode ver que durante todo esse tempo o navegador estava ocupado com a execu√ß√£o de Javascript.  √â interessante que algo t√£o importante e dif√≠cil ocorra neste c√≥digo.  Felizmente, o Javascript carrega no navegador quase inalterado e pode ser lido. </p><br><h2 id="rassmatrivaem-ostavshiysya-kod">  Considere o c√≥digo restante </h2><br><p>  Vamos ler o c√≥digo Javascript dispon√≠vel para n√≥s.  A√≠ vem a oportunidade de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">formatar o c√≥digo compactado</a> para torn√°-lo mais leg√≠vel. </p><br><p>  De acordo com os resultados da visualiza√ß√£o, foi encontrado o seguinte: </p><br><ul><li>  O c√≥digo est√° muito ofuscado.  Provavelmente, o Google Closure Compiler foi usado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modo Avan√ßado</a> .  Ou seja, os desenvolvedores do Gmail aproveitaram ao m√°ximo as modernas tecnologias de minifica√ß√£o. </li><li>  As m√©tricas de desempenho s√£o coletadas no c√≥digo, portanto, os desenvolvedores devem estar cientes da velocidade com que a interface do usu√°rio √© carregada. </li><li>  As fontes cont√™m polyfills para Promise, Map, Set e outras APIs modernas que podem n√£o carregar nos navegadores modernos. </li><li>  C√≥digo do Gmail escrito em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google Closure Libary</a> </li></ul><br><p>  No √∫ltimo ponto, vale a pena parar com mais detalhes.  A Biblioteca de fechamento √© uma estrutura de desenvolvimento de interface que apareceu em 2009 e n√£o mudou muito desde ent√£o.  Por exemplo, o <a href="https://github.com/google/closure-library/blob/master/closure/goog/net/xml">Ajax atrav√©s do ActiveXObject</a> ainda √© suportado <a href="https://github.com/google/closure-library/blob/master/closure/goog/net/xml">l√°</a> : o que √© necess√°rio apenas para o IE6 e inferior, embora o Gmail atual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">suporte oficialmente</a> apenas o IE 10+. </p><br><p>  Al√©m disso, a interface do usu√°rio de fechamento √© baseada em uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hierarquia de classes</a> na "melhor" tradi√ß√£o GWT - uma abordagem com muitas abstra√ß√µes detalhadas que obviamente afetam o desempenho da renderiza√ß√£o.  As estruturas modernas de interface do usu√°rio (React ou Vue, por exemplo) oferecem muito mais abstra√ß√µes leves - componentes - que s√£o muito mais baratas para renderizar. </p><br><p>  Da√≠ a longa inicializa√ß√£o: milhares de classes s√£o criadas no c√≥digo e muitas abstra√ß√µes s√£o inicializadas antes de come√ßar a renderizar a interface do Gmail para n√≥s. </p><br><p>  Portanto, apesar da apar√™ncia atualizada, o Gmail desenha um legado de tecnologias antigas, cuja gravidade n√£o pode ser oculta por tr√°s do shell externo. </p><br><h2 id="vyvody">  Conclus√µes </h2><br><p>  Espero que, ap√≥s esta revis√£o, fique um pouco mais claro por que o Gmail fica mais lento.  Infelizmente, n√£o est√° ao nosso alcance acelerar o Google, mas voc√™ pode pelo menos aprender algumas li√ß√µes para seus aplicativos: </p><br><ul><li>  Projetos herdados geralmente se deparam com c√≥digos desnecess√°rios, como hacks para navegadores herdados.  Revise suas fontes e livre-se daquelas coisas que se tornaram irrelevantes. </li><li>  Abstra√ß√µes n√£o s√£o gratuitas.  Se voc√™ deseja resolver um problema usando um padr√£o arquitetural elegante, primeiro pense se seria uma ferramenta muito pesada, talvez exista uma op√ß√£o mais f√°cil. </li><li>  N√£o fa√ßa upload de elementos secund√°rios para a p√°gina nativamente.  Nesse caso, o widget do Hangouts pode n√£o bloquear o canal, interferindo no carregamento dos principais recursos do Gmail, mas carregar em segundo plano, ap√≥s renderizar a funcionalidade principal. </li><li>  N√£o negligencie a tecnologia moderna.  Eles podem conter solu√ß√µes fundamentalmente novas para suas tarefas, mais produtivas e convenientes.  √â estranho ver em 2018 uma reformula√ß√£o do servi√ßo do Google, que n√£o usa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">componentes da Web</a> , para os quais o Google est√° se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">afogando</a> t√£o ativamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em confer√™ncias</a> . </li><li>  Bem, n√£o se esque√ßa de prestar aten√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√†s medi√ß√µes de desempenho</a> para seus projetos.  Para isso, agora existem muitas ferramentas convenientes, baseadas em navegador e para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lan√ßamento no CI</a> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429506/">https://habr.com/ru/post/pt429506/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429496/index.html">Laser de sabre de luz caseiro: como foi. Parte 2</a></li>
<li><a href="../pt429498/index.html">4 raz√µes para a procrastina√ß√£o (texto)</a></li>
<li><a href="../pt429500/index.html">"Hora de fazer neg√≥cios" finalmente voou</a></li>
<li><a href="../pt429502/index.html">Vale a pena desenvolver compet√™ncias cruzadas</a></li>
<li><a href="../pt429504/index.html">Como chamar m√©todos de √°udio vk</a></li>
<li><a href="../pt429508/index.html">Resumo do relat√≥rio ‚ÄúComo se tornar um especialista legal em banco de dados‚Äù (HL2018, Data Egret, Ilya Kosmodemyansky)</a></li>
<li><a href="../pt429510/index.html">ArduPilot para iniciantes. Instale e configure no BeagleBone Blue</a></li>
<li><a href="../pt429512/index.html">Eventos digitais em Moscou de 12 a 18 de novembro</a></li>
<li><a href="../pt429514/index.html">A Microsoft explicou como resolver o problema de seguran√ßa de dados em SSDs com criptografia de hardware com vazamento</a></li>
<li><a href="../pt429522/index.html">Projetando um rob√¥ de servi√ßo. Declara√ß√£o do problema, arquitetura da solu√ß√£o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>