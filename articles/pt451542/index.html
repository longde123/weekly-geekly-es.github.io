<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßóüèΩ üèª ‚úåüèª Como e por que fizemos o reconhecimento de marcos no Mail.ru Cloud üì´ ü•† üë∏üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Com o advento de c√¢meras de alta qualidade em telefones celulares, estamos fotografando cada vez mais, gravando v√≠deos dos momentos brilhantes e impor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como e por que fizemos o reconhecimento de marcos no Mail.ru Cloud</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/451542/"><img src="https://habrastorage.org/getpro/habr/post_images/a5d/eeb/615/a5deeb615e9a57fb482a1a5464ab6fcc.png"><br><br>  Com o advento de c√¢meras de alta qualidade em telefones celulares, estamos fotografando cada vez mais, gravando v√≠deos dos momentos brilhantes e importantes de nossas vidas.  Muitos de n√≥s t√™m arquivos de fotos que datam de dezenas de anos e milhares de fotografias, nos quais est√° se tornando cada vez mais dif√≠cil navegar.  Lembre-se de quanto tempo levou para encontrar a foto certa h√° v√°rios anos. <br><br>  Um dos objetivos do Mail.ru Cloud √© fornecer o acesso e a pesquisa mais convenientes no seu arquivo de fotos e v√≠deos.  Para isso, n√≥s, a equipe de vis√£o de m√°quina do Mail.ru, criamos e implementamos sistemas inteligentes de processamento de fotos: pesquisa por objetos, cenas, rostos, etc. Outra tecnologia t√£o marcante √© o reconhecimento de pontos tur√≠sticos.  E hoje vou falar sobre como resolvemos esse problema com a ajuda do Deep Learning. <br><a name="habracut"></a><br>  Imagine a situa√ß√£o: voc√™ saiu de f√©rias e trouxe um monte de fotos.  E em uma conversa com os amigos, eles pediram para mostrar como voc√™ visitou um pal√°cio, castelo, pir√¢mide, templo, lago, cachoeira, montanha, etc.  Voc√™ come√ßa a rolar freneticamente pela pasta com fotos, tentando encontrar a correta.  Provavelmente, voc√™ n√£o o encontra entre centenas de imagens e diz que ser√° exibido mais tarde. <br><br>  Resolvemos esse problema agrupando fotos personalizadas em √°lbuns.  Isso facilita encontrar as imagens corretas em apenas alguns cliques.  Agora temos √°lbuns em rostos, objetos e cenas, al√©m de atra√ß√µes. <br><br>  As fotos com pontos de refer√™ncia s√£o importantes porque geralmente exibem momentos significativos de nossas vidas (por exemplo, viagens).  Podem ser fotografias no fundo de alguma estrutura arquitet√¥nica ou um canto da natureza intocado pelo homem.  Portanto, precisamos encontrar essas fotos e oferecer aos usu√°rios acesso f√°cil e r√°pido a elas. <br><br><h1>  Reconhecimento de recursos </h1><br>  Mas h√° uma nuance: voc√™ n√£o pode simplesmente pegar e treinar algum modelo para reconhecer os pontos tur√≠sticos, h√° muitas dificuldades. <br><br><ul><li>  Em primeiro lugar, n√£o podemos descrever claramente o que √© um "marco".  N√£o podemos dizer por que um pr√©dio √© um ponto de refer√™ncia e, ao lado dele, n√£o √©.  Este n√£o √© um conceito formalizado, o que complica a formula√ß√£o do problema de reconhecimento. <br></li><li>  Em segundo lugar, os pontos tur√≠sticos s√£o extremamente diversos.  Pode ser edif√≠cios hist√≥ricos ou culturais - templos, pal√°cios, castelos.  Estes podem ser os monumentos mais diversos.  Pode ser objetos naturais - lagos, desfiladeiros, cachoeiras.  E um modelo deve ser capaz de encontrar todas essas atra√ß√µes. <br></li><li>  Em terceiro lugar, existem muito poucas imagens com vistas, de acordo com nossos c√°lculos, elas s√£o encontradas apenas em 1-3% das fotos dos usu√°rios.  Portanto, n√£o podemos nos permitir erros de reconhecimento, porque se mostrarmos uma foto a uma pessoa sem um ponto de interesse, ela ser√° imediatamente percept√≠vel e causar√° perplexidade e rea√ß√£o negativa.  Ou, pelo contr√°rio, mostramos √† pessoa uma foto com um ponto de refer√™ncia em Nova York, e ele nunca esteve na Am√©rica.  Portanto, o modelo de reconhecimento deve ter um baixo FPR (taxa de falsos positivos). <br></li><li>  Quarto, cerca de 50% dos usu√°rios, ou mais, desativam o armazenamento de informa√ß√µes geogr√°ficas ao fotografar.  Precisamos levar isso em conta e determinar o local apenas a partir da imagem.  A maioria dos servi√ßos que hoje, de alguma forma, conseguem trabalhar com locais de interesse, fazem isso gra√ßas aos dados geogr√°ficos.  Nossos requisitos iniciais eram mais r√≠gidos. <br></li></ul><br>  Vou mostrar agora com exemplos. <br><br>  Aqui est√£o objetos semelhantes, tr√™s catedrais g√≥ticas francesas.  A esquerda √© a Catedral de Amiens, no meio da Catedral de Reims, √† direita √© Notre Dame de Paris. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd4/da6/7f7/bd4da67f77caa21c8afdd344e1e1a05a.png"><br><br>  At√© uma pessoa precisa de algum tempo para olh√°-las e entender que essas s√£o catedrais diferentes, e a m√°quina tamb√©m deve ser capaz de lidar com ela e mais rapidamente do que uma pessoa. <br><br>  E aqui est√° um exemplo de outra dificuldade: as tr√™s fotos no slide s√£o Notre Dame de Paris, tiradas de diferentes √¢ngulos.  As fotos acabaram sendo muito diferentes, mas todas precisam ser reconhecidas e encontradas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/837/0a4/f9b/8370a4f9b8785814cd4cc7368770aac2.png"><br><br>  Objetos naturais s√£o completamente diferentes dos arquitet√¥nicos.  √Ä esquerda, Cesar√©ia, em Israel, √† direita, o Parque Ingl√™s, em Munique. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/55d/632/245/55d632245cf529e935e25a78de40f020.png"><br><br>  Nestas fotografias, h√° muito poucos detalhes caracter√≠sticos para os quais o modelo possa ‚Äúentender‚Äù. <br><br><h1>  Nosso m√©todo </h1><br>  Nosso m√©todo √© completamente baseado em redes neurais convolucionais profundas.  Como abordagem de aprendizado, eles escolheram o chamado aprendizado do curr√≠culo - o aprendizado em v√°rias etapas.  Para trabalhar com mais efici√™ncia tanto na presen√ßa de dados geogr√°ficos quanto na aus√™ncia deles, fizemos uma infer√™ncia especial (conclus√£o).  Vou falar sobre cada uma das etapas com mais detalhes. <br><br><h1>  Datacet </h1><br>  O combust√≠vel para o aprendizado de m√°quina s√£o os dados.  E antes de tudo, precis√°vamos coletar um conjunto de dados para o treinamento do modelo. <br><br>  Dividimos o mundo em quatro regi√µes, cada uma das quais utilizada em diferentes est√°gios do treinamento.  Em seguida, foram tirados pa√≠ses em cada regi√£o, para cada pa√≠s uma lista de cidades foi compilada e um banco de dados de fotografias de suas atra√ß√µes foi compilado.  Exemplos de dados s√£o apresentados abaixo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f6/e54/629/3f6e546299616e59efd6a1a1464b9b65.png"><br><br>  Primeiro, tentamos treinar nosso modelo na base resultante.  Os resultados foram ruins.  Eles come√ßaram a analisar e os dados est√£o muito "sujos".  Cada atra√ß√£o tinha uma grande quantidade de lixo.  O que fazer  Analisar manualmente toda a enorme quantidade de dados √© caro, sombrio e pouco inteligente.  Portanto, fizemos uma limpeza autom√°tica da base, durante a qual o processamento manual √© usado apenas em uma etapa: para cada atra√ß√£o, selecionamos manualmente 3-5 fotografias de refer√™ncia que cont√™m com precis√£o a atra√ß√£o desejada em uma perspectiva mais ou menos correta.  Acontece rapidamente, porque o volume desses dados de refer√™ncia √© pequeno em rela√ß√£o a todo o banco de dados.  Em seguida, a limpeza autom√°tica baseada em redes neurais convolucionais profundas j√° √© executada. <br><br>  Al√©m disso, usarei o termo "incorpora√ß√£o", pelo qual entenderei o seguinte.  Temos uma rede neural convolucional, treinamos para classifica√ß√£o, cortamos a √∫ltima camada de classifica√ß√£o, tiramos algumas imagens, dirigimos pela rede e obtivemos um vetor num√©rico na sa√≠da.  Vou cham√°-lo de incorpora√ß√£o. <br><br>  Como eu disse, nosso treinamento foi realizado em v√°rias etapas, correspondendo a partes de nosso banco de dados.  Portanto, primeiro adotamos uma rede neural do est√°gio anterior ou uma rede de inicializa√ß√£o. <br><br>  Iremos exibir as fotos dos pontos tur√≠sticos pela rede e realizar v√°rias participa√ß√µes.  Agora voc√™ pode limpar a base.  Tiramos todas as fotos do conjunto de dados para esta atra√ß√£o e tamb√©m conduzimos cada foto pela rede.  Temos um monte de casamentos e, para cada um deles, consideramos as dist√¢ncias para a incorpora√ß√£o de padr√µes.  Depois calculamos a dist√¢ncia m√©dia e, se for mais do que um certo limite, que √© o par√¢metro do algoritmo, consideramos que essa n√£o √© uma atra√ß√£o tur√≠stica.  Se a dist√¢ncia m√©dia for menor que o limite, deixamos esta foto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/305/300/a87/305300a8734289229c57e0d1876fa74e.png"><br><br>  Como resultado, obtivemos um banco de dados que cont√©m mais de 11 mil atra√ß√µes de mais de 500 cidades em 70 pa√≠ses do mundo - mais de 2,3 milh√µes de fotos.  Agora √© hora de lembrar que a maioria das fotos n√£o cont√©m atra√ß√µes.  Essas informa√ß√µes precisam ser compartilhadas de alguma forma com nossos modelos.  Portanto, adicionamos 900 mil fotos sem vistas ao nosso banco de dados e treinamos nosso modelo no conjunto de dados resultante. <br><br>  Para medir a qualidade do treinamento, introduzimos um teste offline.  Com base no fato de que as vistas s√£o encontradas apenas em cerca de 1-3% das fotografias, compilamos manualmente um conjunto de 290 fotografias que mostram as vistas.  S√£o fotografias diferentes e bastante complexas, com um grande n√∫mero de objetos tirados de diferentes √¢ngulos, de modo que o teste √© o mais dif√≠cil poss√≠vel para o modelo.  Pelo mesmo princ√≠pio, selecionamos 11 mil fotografias sem pontos tur√≠sticos, que tamb√©m s√£o bastante complexos, e tentamos encontrar objetos muito semelhantes aos pontos tur√≠sticos dispon√≠veis em nosso banco de dados. <br><br>  Para avaliar a qualidade do treinamento, medimos a precis√£o do nosso modelo a partir de fotografias com e sem vistas.  Essas s√£o nossas duas principais m√©tricas. <br><br><h1>  Abordagens existentes </h1><br>  H√° relativamente pouca informa√ß√£o sobre o reconhecimento da vis√£o na literatura cient√≠fica.  A maioria das solu√ß√µes √© baseada em recursos locais.  A id√©ia √© que tenhamos uma certa imagem de solicita√ß√£o e uma imagem do banco de dados.  Nestas figuras, encontramos sinais locais - pontos-chave e os comparamos.  Se o n√∫mero de correspond√™ncias for grande o suficiente, achamos que encontramos um ponto de interesse. <br><br>  At√© o momento, o melhor m√©todo √© o m√©todo proposto pelo Google, DELF (recursos locais profundos), no qual uma compara√ß√£o dos recursos locais √© combinada com o aprendizado profundo.  Ao executar a imagem de entrada atrav√©s da rede de convolu√ß√£o, obtemos alguns sinais DELF. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e17/a2d/803/e17a2d803135ba5a7821842f035b1cf8.png"><br><br>  Como √© o reconhecimento das atra√ß√µes?  Temos um banco de dados de fotos e uma imagem de entrada, e queremos entender se h√° ou n√£o uma atra√ß√£o tur√≠stica.  Executamos todas as imagens atrav√©s do DELF, obtemos os sinais correspondentes para a base e a imagem de entrada.  Em seguida, realizamos uma pesquisa usando o m√©todo dos vizinhos mais pr√≥ximos e, na sa√≠da, obtemos imagens candidatas com sinais.  Comparamos esses sinais com a ajuda da verifica√ß√£o geom√©trica: se eles forem aprovados com √™xito, acreditamos que h√° um ponto de interesse na imagem. <br><br><h1>  Rede Neural Convolucional </h1><br>  Para o Deep Learning, o pr√©-treinamento √© crucial.  Portanto, pegamos a base das cenas e pr√©-treinamos nela nossa rede neural.  Porque assim?  Uma cena √© um objeto complexo que inclui um grande n√∫mero de outros objetos.  E a atra√ß√£o √© um caso especial da cena.  Como modelo de pr√©-treinamento, podemos dar ao modelo uma id√©ia de alguns recursos de baixo n√≠vel que podem ser generalizados para o reconhecimento bem-sucedido das atra√ß√µes. <br><br>  Como modelo, usamos uma rede neural da fam√≠lia de redes Residual.  Sua principal caracter√≠stica √© que eles usam um bloco residual, que inclui uma conex√£o de salto, que permite que o sinal passe livremente sem entrar em camadas com pesos.  Com essa arquitetura, voc√™ pode treinar qualitativamente redes profundas e lidar com o efeito do gradiente de desfoque, o que √© muito importante ao aprender. <br><br>  Nosso modelo √© o Wide ResNet 50-2, uma modifica√ß√£o do ResNet 50, na qual o n√∫mero de convolu√ß√µes no bloco interno de gargalos √© dobrado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/008/a1f/544/008a1f544843103423b5bcdb4c8b1fe5.png"><br><br>  A rede √© muito eficiente.  Realizamos testes em nosso banco de dados de cenas e foi isso que obtivemos: <br><br><div class="scrollable-table"><table><tbody><tr><th>  Modelo <br></th><th>  1 erro principal <br></th><th>  5 principais erros <br></th></tr><tr><td>  ResNet-50 <br></td><td>  46,1% <br></td><td>  15,7% <br></td></tr><tr><td>  ResNet-200 <br></td><td>  42,6% <br></td><td>  12,9% <br></td></tr><tr><td>  SE-ResNext-101 <br></td><td>  42% <br></td><td>  12,1% <br></td></tr><tr><td>  WRN-50-2 (r√°pido!) <br></td><td>  41,8% <br></td><td>  11,8% <br></td></tr></tbody></table></div><br>  O Wide ResNet foi quase o dobro da rede ResNet 200. E a velocidade da opera√ß√£o √© muito importante para a opera√ß√£o.  Com base na totalidade dessas circunst√¢ncias, tomamos o Wide ResNet 50-2 como nossa principal rede neural. <br><br><h2>  Treinamento </h2><br>  Para treinar a rede, precisamos de perda (fun√ß√£o de perda).  Para selecion√°-lo, decidimos usar a abordagem de aprendizado m√©trico: uma rede neural √© treinada para que representantes da mesma classe sejam reunidos em um cluster.  Ao mesmo tempo, clusters para diferentes classes devem estar o mais afastados poss√≠vel.  Para atra√ß√µes, usamos a perda de centro, que re√∫ne pontos da mesma classe para um determinado centro.  Uma caracter√≠stica importante dessa abordagem √© que ela n√£o requer amostragem negativa, o que nas fases posteriores do treinamento √© um procedimento bastante dif√≠cil. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27a/ed1/cfb/27aed1cfbe8d7cffa90bc1a96b578eff.png"><br><br>  Deixe-me lembr√°-lo de que temos n classes de atra√ß√µes e outra classe de ‚Äún√£o atra√ß√µes‚Äù; a perda de centro n√£o √© usada para isso.  Queremos dizer que um ponto de refer√™ncia √© o mesmo objeto, e h√° uma estrutura nele; portanto, √© aconselh√°vel considerar um centro para ele.  Mas nem uma atra√ß√£o tur√≠stica pode ser qualquer coisa, e considerar o centro para ele n√£o √© razo√°vel. <br><br>  Depois juntamos tudo e criamos um modelo para o treinamento.  Consiste em tr√™s partes principais: <br><br><ul><li>  Rede neural convolucional Wide ResNet 50-2, pr√©-treinada com base em cenas; <br></li><li>  Partes de incorpora√ß√£o consistindo em uma camada totalmente conectada e uma camada de norma de lote; <br></li><li>  Um classificador, que √© uma camada totalmente conectada, seguido por um par de perda Softmax e perda Center. <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/6dd/7bf/338/6dd7bf33835ea1d84565a04c5ff1e281.jpg"><br><br>  Como voc√™ se lembra, nossa base √© dividida em 4 partes por regi√£o do mundo.  Usamos essas quatro partes como parte do paradigma de aprendizado do curr√≠culo.  Em cada est√°gio, temos o conjunto de dados atual, adicionamos outra parte do mundo a ele e obtemos um novo conjunto de dados de treinamento. <br><br>  O modelo consiste em tr√™s partes e, para cada uma delas, usamos nossa pr√≥pria taxa de aprendizado no treinamento.  Isso √© necess√°rio para que a rede possa aprender n√£o apenas as vistas da nova parte do conjunto de dados que adicionamos, mas tamb√©m n√£o esquecer os dados j√° aprendidos.  Depois de muitas experi√™ncias, essa abordagem acabou sendo a mais eficaz. <br><br>  Ent√£o, treinamos o modelo.  Voc√™ precisa entender como isso funciona.  Vamos usar o mapa de ativa√ß√£o de classe para ver qual parte da imagem √© mais responsiva √† nossa rede neural.  Na imagem abaixo, na primeira linha, as imagens de entrada e na segunda elas s√£o sobrepostas ao mapa de ativa√ß√£o de classe da grade, que treinamos na etapa anterior. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5aa/4aa/264/5aa4aa26413082931c28f1a393a64b95.png"><br><br>  O mapa de calor mostra em quais partes da imagem a rede presta mais aten√ß√£o.  A partir do mapa de ativa√ß√£o da classe, podemos ver que nossa rede neural aprendeu com sucesso o conceito de atra√ß√£o. <br><br><h2>  Infer√™ncia </h2><br>  Agora voc√™ precisa de alguma forma usar esse conhecimento para obter o resultado.  Como usamos a perda do Center para treinamento, parece bastante l√≥gico inferir tamb√©m calcular o tserot√≥ide para atra√ß√µes. <br><br>  Para isso, participamos das imagens do conjunto de treinamento para algum tipo de atra√ß√£o, por exemplo, para o Cavaleiro de Bronze.  N√≥s os rodamos pela rede, obtemos casamentos, m√©dia e conseguimos um centr√≥ide. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c49/b0f/69e/c49b0f69e33581f30c05985a98702f6f.png"><br><br>  Mas surge a pergunta: quantos centr√≥ides para uma atra√ß√£o faz sentido calcular?  A princ√≠pio, a resposta parece clara e l√≥gica: um centr√≥ide.  Mas isso acabou n√£o sendo bem assim.  No in√≠cio, tamb√©m decidimos fazer um centr√≥ide e obtivemos um resultado muito bom.  Ent√£o, por que voc√™ precisa tomar alguns centr√≥ides? <br><br>  Em primeiro lugar, nossos dados n√£o s√£o totalmente limpos.  Embora tenhamos limpado o conjunto de dados, removemos apenas o lixo definitivo.  E poder√≠amos ter imagens que n√£o poderiam ser consideradas lixo, mas que pioram o resultado. <br><br>  Por exemplo, eu tenho uma aula de refer√™ncia do Pal√°cio de Inverno.  Eu quero contar um centr√≥ide para ele.  Mas o conjunto inclu√≠a v√°rias fotografias na Pra√ßa do Pal√°cio e no arco do Edif√≠cio do Estado Maior.  Se considerarmos o centr√≥ide em todas as imagens, ele n√£o ficar√° muito est√°vel.  √â necess√°rio, de alguma forma, agrupar seus casamentos, obtidos a partir da grade usual, pegar apenas o centr√≥ide respons√°vel pelo Pal√°cio de Inverno e calcular a m√©dia de acordo com esses dados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/000/7b7/8ef/0007b78efb3d15296bab0ebef0cf4dfb.png"><br><br>  Em segundo lugar, as fotografias podem ser tiradas de diferentes √¢ngulos. <br><br>  Vou citar a torre sineira de Belfort, em Bruges, como ilustra√ß√£o desse comportamento.  Dois centr√≥ides s√£o contados para ela.  Na linha superior da imagem est√£o as fotos mais pr√≥ximas do primeiro centr√≥ide e na segunda linha - aquelas que est√£o mais pr√≥ximas do segundo centr√≥ide: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d13/5f4/105/d135f4105f2823a612e458f946e25221.png"><br><br>  O primeiro centr√≥ide √© respons√°vel pelas fotografias em close mais ‚Äúinteligentes‚Äù tiradas da Pra√ßa do Mercado de Bruges.  E o segundo centr√≥ide √© respons√°vel por fotografias tiradas de longe, de ruas adjacentes. <br><br>  Acontece que, calculando v√°rios centr√≥ides por classe de um ponto de interesse, podemos exibir √¢ngulos diferentes desse ponto de interesse em infer√™ncia. <br><br>  Ent√£o, como encontramos esses conjuntos para calcular centr√≥ides?  Aplicamos o cluster hier√°rquico aos conjuntos de dados para cada ponto de interesse - link completo.  Com sua ajuda, encontramos clusters v√°lidos pelos quais calcularemos centr√≥ides.  Por agrupamentos v√°lidos, entendemos aqueles que, como resultado do agrupamento, cont√™m pelo menos 50 fotografias.  Os clusters restantes s√£o descartados.  Como resultado, descobriu-se que cerca de 20% das vistas t√™m mais de um centr√≥ide. <br><br>  Agora infer√™ncia.  N√≥s o calculamos em dois est√°gios: primeiro, executamos a imagem de entrada atrav√©s de nossa rede neural convolucional e obtemos incorpora√ß√£o e, em seguida, usando o produto escalar, comparamos incorpora√ß√£o com centr√≥ides.  Se as imagens contiverem dados geogr√°ficos, restringimos a pesquisa aos centr√≥ides, relacionados √†s atra√ß√µes localizadas em um quadrado de 1 por 1 km a partir do local da grava√ß√£o.  Isso permite pesquisar com mais precis√£o, escolha um limite mais baixo para compara√ß√£o subsequente.  Se a dist√¢ncia obtida for maior que o limite, que √© um par√¢metro do algoritmo, dizemos que na foto existe um ponto de interesse com o valor m√°ximo do produto escalar.  Se menos, ent√£o isso n√£o √© uma atra√ß√£o tur√≠stica. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d01/75c/5a5/d0175c5a5142647bf9446f7d65df0509.png"><br><br>  Suponha que a foto contenha um ponto de refer√™ncia.  Se tivermos dados geogr√°ficos, usamos-os e exibimos a resposta.  Se n√£o houver dados geogr√°ficos, faremos uma verifica√ß√£o adicional.  Quando limpamos o conjunto de dados, fizemos um conjunto de imagens de refer√™ncia para cada classe de atra√ß√µes.  Para eles, podemos contar as incorpora√ß√µes e, em seguida, calculamos a dist√¢ncia m√©dia entre elas e a incorpora√ß√£o da imagem solicitada.  Se for mais do que algum limite, a verifica√ß√£o ser√° aprovada, incluiremos metadados e exibiremos o resultado.  √â importante observar que podemos executar esse procedimento para v√°rias atra√ß√µes encontradas na imagem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/14b/ffe/04f/14bffe04fe6ca1b3d09876432e319e53.png"><br><br><h1>  Resultados do teste </h1><br>  Comparamos nosso modelo com o DELF, para o qual adotamos os par√¢metros nos quais ele apresentou os melhores resultados em nosso teste.  Os resultados foram quase os mesmos. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Modelo <br></th><th>  Vistas <br></th><th>  Sem atra√ß√µes <br></th></tr><tr><td>  Nossa <br></td><td>  80% <br></td><td>  99% <br></td></tr><tr><td>  Delf <br></td><td>  80,1% <br></td><td>  99% <br></td></tr></tbody></table></div><br>       :  ( 100 ),   87 %     ,  .      :  85,3 %.      46 %,     ‚Äî          . <br><br><div class="scrollable-table"><table><tbody><tr><th>  <br></th><th>  <br></th><th>     <br></th></tr><tr><td>  <br></td><td> 85,3 % <br></td><td> 87 % <br></td></tr><tr><td>  <br></td><td> 46 % <br></td><td> 13 % <br></td></tr></tbody></table></div><br>    /B-   .          10 %,       3 %,       13 %. <br><br>       DELF.  GPU DELF  7  ,    7  ,      1 .  CPU DELF             .      CPU   15  .        ,     . <br><br><h1> :    </h1><br>               .  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/72c/df4/52e/72cdf452e2105c18f8e4375a1b69d497.png"><br><br>   ,        .   ¬´¬ª, ¬´¬ª, ¬´¬ª.      ,    .      ,        . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec6/7f8/929/ec67f892964ee568754a86cd48e16b51.png"><br><br>   :   , ,   .       Instagram      ,      ,    ‚Äî     . <br><br><h1>  </h1><br>      . <br><br><ol><li>   .      ,      .           . <br></li><li>        deep metric learning,        . <br></li><li>       curriculum learning ‚Äî   .      .  inference    ,           . <br></li></ol><br>  ,   ‚Äî    .     ,     ,    .         -   .      ! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt451542/">https://habr.com/ru/post/pt451542/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt451528/index.html">"E assim vai": que os provedores de nuvem n√£o concordam com dados pessoais</a></li>
<li><a href="../pt451532/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 459 (30/04/2019 - 06/05/2019)</a></li>
<li><a href="../pt451534/index.html">12 princ√≠pios de anima√ß√£o no desenvolvimento de videogames</a></li>
<li><a href="../pt451538/index.html">Guia de redimensionamento paralelo do Amazon Redshift e resultados de testes</a></li>
<li><a href="../pt451540/index.html">Quantos desenvolvedores precisam criar servi√ßos como o Airbnb</a></li>
<li><a href="../pt451552/index.html">Criamos canais de vendas em rede do gadget DO-RA</a></li>
<li><a href="../pt451556/index.html">Flutter: localiza√ß√£o de aplicativos usando o Android Studio</a></li>
<li><a href="../pt451558/index.html">Um dia na vida da automa√ß√£o de controle de qualidade</a></li>
<li><a href="../pt451560/index.html">Caro cliente, √© por isso que essa mudan√ßa levou tanto tempo.</a></li>
<li><a href="../pt451562/index.html">Como escapar de uma seita?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>