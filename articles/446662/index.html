<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéã üë©üèø‚Äçüè≠ üßïüèΩ Transacciones y mecanismos para su control. ‚ùì ü§òüèª üåª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Transacciones 
 Una transacci√≥n es una secuencia de operaciones en datos que tienen un principio y un final. 
 Una transacci√≥n es una operaci√≥n de lec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Transacciones y mecanismos para su control.</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446662/"><h2>  Transacciones </h2><br><h4>  Una transacci√≥n es una secuencia de operaciones en datos que tienen un principio y un final. </h4><br>  Una transacci√≥n es una operaci√≥n de lectura y escritura secuencial.  El final de una transacci√≥n puede ser guardar cambios (commit, commit) o ‚Äã‚Äãcancelar cambios (rollback, rollback).  En relaci√≥n con la base de datos, una transacci√≥n es una serie de consultas, que se tratan como una sola consulta. <br><br><h4>  Las transacciones deben satisfacer las propiedades de ACID </h4><br>  Atomicidad  Una transacci√≥n se ejecuta completamente o no se realiza en absoluto. <br><br>  Coherencia  Al final de la transacci√≥n, no se deben infringir las restricciones impuestas a los datos (por ejemplo, restricciones en la base de datos).  La consistencia implica que el sistema se transferir√° de un estado correcto a otro correcto. <br><br>  Aislamiento  Las transacciones ejecutadas simult√°neamente no deber√≠an afectarse entre s√≠, por ejemplo, cambiando los datos que utiliza otra transacci√≥n.  El resultado de las transacciones paralelas debe ser como si las transacciones se ejecutaran secuencialmente. <br><br>  Sostenibilidad  Una vez comprometidos, los cambios no deben perderse. <br><a name="habracut"></a><br><h2>  Registro de transacciones </h2><br><h4>  El registro almacena los cambios realizados por las transacciones, garantiza la atomicidad y la estabilidad de los datos en caso de falla del sistema. </h4><br>  El registro contiene los valores que ten√≠an los datos antes y despu√©s de su cambio por la transacci√≥n.  La estrategia de registro de escritura anticipada requiere que agregue al registro un registro de valores anteriores antes del inicio y sobre los valores finales despu√©s de que se complete la transacci√≥n.  En el caso de una parada repentina del sistema, la base de datos lee el registro en el orden inverso y descarta los cambios realizados por las transacciones.  Una vez que se encuentra una transacci√≥n interrumpida, la base de datos la ejecuta y realiza cambios al respecto en el registro.  Estando en el estado en el momento de la falla, la base de datos lee el registro en el orden directo y devuelve los cambios realizados por las transacciones.  Por lo tanto, se preserva la estabilidad de las transacciones que ya se han comprometido y la atomicidad de la transacci√≥n interrumpida. <br><br>  Simplemente volver a ejecutar transacciones err√≥neas no es suficiente para recuperarse. <br><br>  <i>Un ejemplo</i>  <i>El usuario tiene $ 500 en la cuenta y decide retirarlos a trav√©s de un cajero autom√°tico.</i>  <i>Se realizan dos transacciones.</i>  <i>El primero lee el valor del saldo y si hay suficientes fondos en el saldo, le da dinero al usuario.</i>  <i>El segundo resta la cantidad requerida del saldo.</i>  <i>Suponga que un sistema falla y la primera operaci√≥n falla, y la segunda falla.</i>  <i>En este caso, no podemos volver a emitir dinero al usuario sin devolver el sistema a su estado original con un saldo positivo.</i> <br><br><h2>  Niveles de aislamiento </h2><br><h4>  Leer comprometido </h4><br>  El problema con una lectura sucia es que una transacci√≥n puede leer el resultado intermedio de otra transacci√≥n. <br><br>  <i>Un ejemplo</i>  <i>El valor inicial del saldo es $ 0.</i>  <i>T1 agrega $ 50 al saldo.</i>  <i>T2 lee el valor del saldo ($ 50).</i>  <i>T1 cancela los cambios y finaliza.</i>  <i>T2 contin√∫a la ejecuci√≥n con datos de saldo incorrectos.</i> <br><br>  La soluci√≥n es lectura confirmada, que proh√≠be la lectura de datos modificados por una transacci√≥n.  Si la transacci√≥n A ha cambiado alg√∫n conjunto de datos, entonces la transacci√≥n B, al acceder a estos datos, se ve obligada a esperar la transacci√≥n A. <br><br><h4>  Lectura repetible </h4><br>  El problema de los cambios perdidos (Actualizaciones perdidas).  T1 guarda los cambios sobre los cambios en T2. <br><br>  <i>Un ejemplo</i>  <i>El valor del saldo inicial es de $ 0 y dos transacciones reponen simult√°neamente el saldo.</i>  <i>T1 y T2 leen un saldo de $ 0.</i>  <i>Luego, T2 agrega $ 200 a $ 0 y guarda el resultado.</i>  <i>T1 agrega $ 100 a $ 0 y guarda el resultado.</i>  <i>El resultado total es $ 100 en lugar de $ 300.</i> <br><br>  Problema de lectura irrepetible.  La lectura repetida de los mismos datos devuelve valores diferentes. <br><br>  <i>Un ejemplo</i>  <i>T1 lee un valor de saldo de $ 0.</i>  <i>Luego, T2 agrega $ 50 al saldo y finaliza.</i>  <i>T1 lee los datos nuevamente y detecta una discrepancia con el resultado anterior.</i> <br><br>  La lectura repetible asegura que la lectura repetida devolver√° el mismo resultado.  Los datos le√≠dos por una transacci√≥n tienen prohibido cambiar en otros hasta que se complete la transacci√≥n.  Si la transacci√≥n A ha le√≠do alg√∫n conjunto de datos, entonces la transacci√≥n B, al acceder a estos datos, se ve obligada a esperar la transacci√≥n A. <br><br><h4>  Lectura ordenada (serializable) </h4><br>  Lecturas fantasma  Dos consultas que seleccionan datos por alguna condici√≥n devuelven valores diferentes. <br><br>  <i>Un ejemplo</i>  <i>T1 solicita el n√∫mero de todos los usuarios cuyo saldo es mayor que $ 0 pero menor que $ 100.</i>  <i>T2 resta $ 1 de un usuario con un saldo de $ 101.</i>  <i>T1 vuelve a ejecutar la solicitud.</i> <br><br>  Lectura ordenada (serializable).  Las transacciones se realizan como completamente secuenciales.  Est√° prohibido actualizar y agregar registros sujetos a las condiciones de la solicitud.  Si la transacci√≥n A solicit√≥ datos de toda la tabla, entonces toda la tabla se congela para el resto de las transacciones hasta la transacci√≥n A. <br><br><h2>  Programador </h2><br><h4>  Establece el orden en que las operaciones deben realizarse en transacciones paralelas </h4><br>  Proporciona un nivel espec√≠fico de aislamiento.  Si el resultado de las operaciones no depende de su orden, entonces dichas operaciones son conmutables (Permutable).  Los comandos son le√≠dos y las operaciones en diferentes datos.  Las operaciones de lectura-escritura y escritura-escritura no son conmutativas.  La tarea del planificador es alternar las operaciones realizadas por transacciones paralelas para que el resultado de la ejecuci√≥n sea equivalente a la ejecuci√≥n secuencial de las transacciones. <br><br><h2>  Mecanismos de control de concurrencia </h2><br><h4>  Optimista basado en la detecci√≥n y resoluci√≥n de conflictos, pesimista basado en la prevenci√≥n de conflictos </h4><br>  Con un enfoque optimista, varios usuarios tienen a su disposici√≥n copias de los datos.  El primero que complet√≥ la edici√≥n guarda los cambios, el resto debe fusionar los cambios.  Un algoritmo optimista permite que ocurra un conflicto, pero el sistema debe recuperarse del conflicto. <br><br>  Con un enfoque pesimista, el primer usuario que captura datos evita que otros reciban datos.  Si los conflictos son raros, es aconsejable elegir una estrategia optimista, ya que proporciona un mayor nivel de paralelismo. <br><br><h2>  Bloqueo </h2><br><h4>  Si una transacci√≥n ha bloqueado datos, el resto de la transacci√≥n debe acceder a los datos al acceder a los datos. </h4><br>  Un bloque puede superponerse en una base de datos, tabla, fila o atributo.  Shared Lock (Shared Lock) se puede imponer en los mismos datos mediante varias transacciones, permite la lectura de todas las transacciones (incluida la impuesta), proh√≠be el cambio y la captura exclusiva.  El bloqueo exclusivo puede ser impuesto por una sola transacci√≥n, permite cualquier acci√≥n de la transacci√≥n impuesta, proh√≠be cualquier acci√≥n por parte del resto. <br><br><h4>  Un punto muerto es una situaci√≥n en la que las transacciones est√°n en modo de espera y duran indefinidamente </h4><br>  <i>Un ejemplo</i>  <i>La primera transacci√≥n est√° esperando la liberaci√≥n de los datos capturados por la segunda, mientras que la segunda est√° esperando la liberaci√≥n de los datos capturados por la primera.</i> <br><br><h4>  Una soluci√≥n optimista al problema del punto muerto permite que ocurra un punto muerto, pero luego restaura el sistema al deshacer una de las transacciones involucradas en el punto muerto. </h4><br>  Con cierta frecuencia, se realiza una b√∫squeda de puntos muertos.  Uno de los m√©todos de detecci√≥n es a tiempo, es decir, considerar que se produjo un punto muerto si la transacci√≥n lleva demasiado tiempo.  Cuando se encuentra un punto muerto, una de las transacciones se revierte, lo que permite que se completen otras transacciones involucradas en el punto muerto.  La elecci√≥n de la v√≠ctima puede basarse en el valor de las transacciones o su antig√ºedad (esquemas de espera y muerte y espera de heridas). <br><br>  A cada transacci√≥n <b>T se le</b> asigna una marca de tiempo <b>TS que</b> contiene la hora de inicio de la transacci√≥n. <br><br>  Esperar-morir <br><br>  <u>Si <b>TS (Ti)</b> &lt; <b>TS (Tj)</b> , <b>Ti</b> espera, de lo contrario <b>Ti</b> retrocede y comienza de nuevo con la misma marca de tiempo.</u> <br><br>  Si una transacci√≥n joven ha capturado un recurso y una m√°s antigua solicita el mismo recurso, entonces se puede esperar una transacci√≥n m√°s antigua.  Si una transacci√≥n anterior ha capturado un recurso, se revertir√° una transacci√≥n joven que solicite este recurso. <br><br>  Herida de espera. <br><br>  <u>Si <b>TS (Ti)</b> &lt; <b>TS (Tj)</b> , <b>Tj</b> retrocede y comienza de nuevo con la misma marca de tiempo, de lo contrario, <b>Ti</b> espera.</u> <br><br>  Si una transacci√≥n m√°s joven ha capturado un recurso y una transacci√≥n m√°s antigua est√° solicitando el mismo recurso, entonces la transacci√≥n m√°s joven se revertir√°.  Si una transacci√≥n anterior ha capturado el recurso, entonces una transacci√≥n m√°s joven que solicita este recurso puede esperar.  La selecci√≥n de la v√≠ctima basada en la antig√ºedad evita los puntos muertos, pero revierte las transacciones que no est√°n en un estado de enclavamiento.  El problema es que las transacciones pueden revertirse muchas veces porque  Una transacci√≥n anterior puede contener un recurso durante mucho tiempo. <br><br><h4>  Una soluci√≥n pesimista al problema de los puntos muertos no permite que la transacci√≥n comience a ejecutarse si existe el riesgo de un punto muerto </h4><br>  Para detectar puntos muertos, se construye un gr√°fico (un gr√°fico de espera, espera de gr√°fico), cuyos v√©rtices son transacciones, y los bordes se dirigen desde las transacciones que est√°n esperando que se liberen los datos a la transacci√≥n que captur√≥ estos datos.  Se cree que se produjo un punto muerto si el gr√°fico se repite.  Construir un gr√°fico de espera, especialmente en bases de datos distribuidas, es un procedimiento costoso. <br><br><h4>  Bloqueo en dos fases: evita los puntos muertos al capturar todos los recursos utilizados por la transacci√≥n al comienzo de la transacci√≥n y liberarlos al final </h4><br>  Todas las operaciones de bloqueo deben preceder al primer desbloqueo.  Tiene dos fases: la fase de crecimiento en la que se produce la captura de grabs y la fase de contracci√≥n en la que se produce la liberaci√≥n de grabs.  Si es imposible capturar uno de los recursos, la transacci√≥n comienza nuevamente.  Es posible que una transacci√≥n no pueda capturar los recursos necesarios, por ejemplo, si varias transacciones compiten por los mismos recursos. <br><br><h4>  La confirmaci√≥n de dos fases garantiza que la confirmaci√≥n se ejecute en todas las r√©plicas de la base de datos. </h4><br>  Cada base de datos aporta informaci√≥n sobre los datos que se cambiar√°n al registro y corresponde al coordinador OK (Fase de votaci√≥n).  Despu√©s de que todos respondieron bien, el coordinador env√≠a una se√±al obligando a todos a comprometerse.  Despu√©s de confirmar el servidor, responden OK, si al menos uno no respondi√≥ OK, entonces el coordinador env√≠a una se√±al para cancelar los cambios a todos los servidores (Fase de finalizaci√≥n). <br><br><h2>  M√©todo de marca de tiempo </h2><br><h4>  Una transacci√≥n anterior se revierte al intentar acceder a los datos involucrados en una transacci√≥n m√°s joven </h4><br>  A cada transacci√≥n se le asigna una marca de tiempo <b>TS</b> correspondiente a la hora de inicio de la ejecuci√≥n.  Si <b>Ti es</b> anterior a <b>Tj</b> , entonces <b>TS (Ti)</b> &lt; <b>TS (Tj)</b> . <br><br>  Cuando una transacci√≥n se revierte, se le asigna una nueva marca de tiempo.  Cada objeto de datos <b>Q</b> involucrado en la transacci√≥n est√° marcado con dos etiquetas.  <b>W-TS (Q)</b> es la marca de tiempo de la transacci√≥n m√°s joven que escribi√≥ con √©xito a <b>Q.</b>  <b>R-TS (Q)</b> es la marca de tiempo de la transacci√≥n m√°s joven que complet√≥ un registro de lectura sobre <b>Q.</b> <br><br>  Cuando la transacci√≥n <b>T</b> solicita leer datos <b>Q</b> , hay dos opciones posibles. <br><br>  <u>Si <b>TS (T)</b> &lt; <b>W-TS (Q)</b> , es decir, los datos fueron actualizados por una transacci√≥n m√°s joven, entonces la transacci√≥n <b>T</b> retrocede.</u> <br><br>  <u>Si <b>TS (T)</b> &gt; = <b>W-TS (Q)</b> , se realiza la lectura y <b>R-TS (Q) se</b> convierte en <b>MAX (R-TS (Q), TS (T))</b> .</u> <br><br>  Cuando la transacci√≥n <b>T</b> solicita un cambio en los datos <b>Q</b> , son posibles dos opciones. <br><br>  <u>Si <b>TS (T)</b> &lt; <b>R-TS (Q)</b> , es decir, los datos ya han sido le√≠dos por una transacci√≥n m√°s joven y si se realiza un cambio, surgir√° un conflicto.</u>  <u>La transacci√≥n <b>T</b> retrocede.</u> <br><br>  <u>Si <b>TS (T)</b> &lt; <b>W-TS (Q)</b> , es decir, la transacci√≥n intenta sobrescribir el valor m√°s nuevo, la transacci√≥n T retrocede.</u>  <u>En otros casos, el cambio se realiza y <b>W-TS (Q) se</b> vuelve igual a <b>TS (T)</b> .</u> <br><br>  No se requiere una costosa construcci√≥n de gr√°ficos de espera.  Las transacciones m√°s antiguas dependen de las m√°s nuevas, por lo tanto, no hay bucles en la columna de espera.  No hay puntos muertos, porque las transacciones no se esperan, pero se deshacen de inmediato.  Los sobornos en cascada son posibles.  Si <b>Ti</b> retrocedi√≥ y <b>Tj</b> ley√≥ los datos que <b>Ti</b> cambi√≥, entonces <b>Tj</b> tambi√©n deber√≠a retroceder.  Si, al mismo tiempo, Tj ya ha sido comunicado, habr√° una violaci√≥n del principio de estabilidad. <br><br>  Una soluci√≥n a los retrocesos en cascada.  Una transacci√≥n realiza todas las operaciones de escritura al final, y las transacciones restantes deben esperar la finalizaci√≥n de esta operaci√≥n.  Las transacciones est√°n esperando una confirmaci√≥n antes de leer. <br><br><h4>  Regla de escritura de Thomas: una variaci√≥n del m√©todo de marca de tiempo en el que los datos actualizados por una transacci√≥n m√°s joven no pueden ser sobrescritos por una m√°s antigua </h4><br>  La transacci√≥n <b>T</b> solicita un cambio en los datos <b>Q.</b>  Si <b>TS (T)</b> &lt; <b>W-TS (Q)</b> , es decir, la transacci√≥n est√° intentando sobrescribir un valor m√°s nuevo, la transacci√≥n T no se revierte como en el m√©todo de marca de tiempo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/446662/">https://habr.com/ru/post/446662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446648/index.html">Desarrollo de operadores de Kubernetes con Operator Framework</a></li>
<li><a href="../446654/index.html">C√≥mo guardamos la revisi√≥n del c√≥digo</a></li>
<li><a href="../446656/index.html">Codificaci√≥n de voz de 1600 bits / s con codificador de voz neural LPCNet</a></li>
<li><a href="../446658/index.html">Entrevista con Andrei Stankevich sobre programaci√≥n deportiva.</a></li>
<li><a href="../446660/index.html">IA, estudiante y gran premio: c√≥mo hacer aprendizaje autom√°tico en octavo grado</a></li>
<li><a href="../446664/index.html">¬°SAP Forum 2019 est√° a solo 2 semanas! ¬øQu√© habr√° all√≠?</a></li>
<li><a href="../446666/index.html">Exprime al m√°ximo las calculadoras gr√°ficas: juegos en la TI-83</a></li>
<li><a href="../446668/index.html">Python para la web: lo que un junior necesita saber para trabajar y crecer</a></li>
<li><a href="../446674/index.html">Modelamos el algoritmo MUSIC para determinar la direcci√≥n de llegada de una onda electromagn√©tica</a></li>
<li><a href="../446676/index.html">Creaci√≥n de teclas faltantes para el teclado de goma Commodore 116</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>