<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåà üñïüèº üòÉ Revertimos los dispositivos m√≥viles 1 bajo Android. C√≥mo agregar un poco de funcionalidad y deshacerse de algunas noches üéä üíÜüèæ üì¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Debo decir de inmediato que, a pesar del fuerte, como podr√≠a pensar alguien, el t√≠tulo del art√≠culo, no habr√° ning√∫n tipo de hardcore directo. Y tambi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Revertimos los dispositivos m√≥viles 1 bajo Android. C√≥mo agregar un poco de funcionalidad y deshacerse de algunas noches</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475266/"><p>  Debo decir de inmediato que, a pesar del fuerte, como podr√≠a pensar alguien, el t√≠tulo del art√≠culo, no habr√° ning√∫n tipo de hardcore directo.  Y tambi√©n, a pesar del hecho de que la reversi√≥n se asocia con mayor frecuencia con la seguridad de la informaci√≥n, nuevamente no habr√° nada como esto, porque no hubo necesidad de eludir ninguna protecci√≥n (excepto una peque√±a minificaci√≥n).  No hay ninguno de ellos.  Mobile 1s es un producto gratuito en el que no se incluyen controles, protecciones ni funciones pagas. </p><br><p>  Por lo tanto, hago un llamamiento a aquellos que esperan ver el uso de desofuscadores, el uso de Frida / Xposed, otro software complicado: no encontrar√° nada interesante para usted.  Aqu√≠ solo usaremos apktool, baksmali, apksigner, adb, jadx, consola, editor de texto, javac, d8 y todo. </p><br><p> Tambi√©n quiero decepcionar de antemano a aquellos que esperaban un an√°lisis profundo de la plataforma, o su fuerte modificaci√≥n.  Solo se realizar√°n peque√±as ediciones en solo unos pocos archivos, y de hecho, incluso estos pocos archivos que no hice completamente, todo en la parte superior. </p><a name="habracut"></a><br><h1 id="s-chego-vse-nachalos">  Como empez√≥ todo </h1><br><p>  Te contar√© un poco sobre por qu√© de repente tuve la idea de entrar de alguna manera en el tel√©fono m√≥vil durante 1 segundo.  Por el momento, llevo haciendo un desarrollo nativo para Android desde hace un a√±o, pero antes trabaj√© durante 4 a√±os como programador, y durante el √∫ltimo a√±o y medio, a menudo trabajamos espec√≠ficamente con la plataforma m√≥vil.  A pesar de que satisfizo las necesidades b√°sicas, tambi√©n tuvo muchos inconvenientes (adem√°s del lenguaje de programaci√≥n).  En particular, era imposible integrar humanamente una biblioteca externa, al menos por medios regulares y con nuestra reserva de conocimiento.  Tambi√©n todo fue muy triste, por ejemplo, con la funcionalidad de mostrar etiquetas en un mapa.  Toda la posibilidad de su configuraci√≥n era especificar texto para las etiquetas cuando las tocaba.  En ese momento, la √∫nica forma de evitar esto era usar el objeto especial "Campo de documento HTML", pero hab√≠a problemas con √©l.  En el momento de trabajar con 1s, todo mi conocimiento en el desarrollo nativo para Android estaba en un par HelloWorld, por lo que ni siquiera pens√© en revertir el tel√©fono m√≥vil con 1s, o no resolvimos varias preguntas de los clientes sobre la extensi√≥n no est√°ndar de 1s, o vimos unos nativos muy simples. las aplicaciones que se colocaron junto a √©l y que se integraron de forma torcida / oblicua con 1s (y el acuerdo de licencia de 1s parece prohibir las ediciones en la plataforma misma). </p><br><p>  Entonces, la primera raz√≥n para hacer la reversi√≥n 1c fue que me interes√© y qu√© puedo hacer con la base de conocimiento actual.  Debo decir de inmediato que la experiencia del desarrollo nativo no fue para decir lo que se necesita, en el trabajo diario no se encuentra casi nada de lo que se describir√° a continuaci√≥n.  Entonces, en principio, probablemente cualquier 1snik promedio sentado durante varios d√≠as / semanas podr√≠a resolverlo todo. </p><br><p>  La segunda raz√≥n es que solo quer√≠a intentar elegir el apk de otras personas, porque antes me faltaba esta amplia capa de conocimiento, y como ten√≠a que comenzar en alguna parte, se me ocurri√≥ solo 1s. </p><br><h1 id="pervye-shagi">  Primeros pasos </h1><br><p>  Lo primero que hice, incluso cuando la idea de revertir 1s solo vagaba vagamente en mi cabeza, simplemente arrastr√© el archivo apk de la aplicaci√≥n a la ventana de AndroidStudio con el mouse.  Quiero decir de inmediato que me sent√≠ un poco triste, porque la mayor√≠a del c√≥digo 1c est√° escrito en C ++ y se encuentra en las bibliotecas .so, y es m√°s dif√≠cil revertirlos, y no fue interesante.  Pero el archivo classes.dex captur√≥ completamente mi atenci√≥n, especialmente porque su tama√±o modesto me dio la oportunidad de asumir que ser√≠a f√°cil revertirlo.  En general, result√≥ de esa manera.  Por cierto, una consecuencia interesante del hecho de que la mayor√≠a del c√≥digo en C ++ es que muchos m√©todos y clases han evitado el procesamiento con ProGuard.  Es dif√≠cil hacer una interoperabilidad con un c√≥digo minificado;). </p><br><div class="spoiler">  <b class="spoiler_title">Esto es lo que vi en la ventana del estudio (desmont√≥ la versi√≥n x86 para que funcione con el emulador y no con el dispositivo real)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ry/dx/6l/rydx6lnrt7oix0nqa63bftv2-8y.png"></p></div></div><br><p>  Como puede ver en la captura de pantalla anterior, la aplicaci√≥n apenas se minimiz√≥ (en t√©rminos de cambio de nombre de clases y m√©todos).  Adem√°s, puede ver que hay muy poco c√≥digo en Java y, por lo tanto, las bibliotecas ocupan casi todo el espacio. </p><br><p>  Despu√©s de haber empujado la lista de clases durante alg√∫n tiempo, vi una curiosa clase de MapImpl, que arroja sospechas de que era √©l el responsable de una situaci√≥n tan triste con la personalizaci√≥n de la exhibici√≥n de etiquetas. </p><br><div class="spoiler">  <b class="spoiler_title">Estructura MapImpl</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ya/rl/xh/yarlxho_dqjalx6euv2g57bddn8.png"></p></div></div><br><p>  La lista de m√©todos y sus firmas inspiraron la esperanza de que todo fuera muy simple, y decid√≠ analizar el c√≥digo smali, despu√©s de lo cual me puse muy tenso y fui a leer la lista de comandos smali y c√≥mo leerlo / escribirlo.  Sin embargo, fue en este punto que decid√≠ que el asunto promete ser simple y de corta duraci√≥n, y en consecuencia, aqu√≠ est√°, una ocasi√≥n para jugar con la inversi√≥n.  Habiendo decidido dedicar un par de noches a esto (cu√°n cruelmente me equivoqu√©), me fui a la cama con un alma tranquila. </p><br><h1 id="stroyu-plany">  Haciendo planes </h1><br><p>  Al despertarme por la ma√±ana, decid√≠ que, hasta este punto, nunca hab√≠a estado involucrado en la sustituci√≥n de recursos en aplicaciones, no como cambios en la l√≥gica, no ten√≠a nada que estafar de inmediato para reemplazar la actividad con una tarjeta, era mejor abordar la soluci√≥n del problema con peque√±os pasos.  Despu√©s de eso, hice una breve lista de pasos que se supon√≠a que me llevar√≠an al punto final de mi viaje en forma de una plataforma m√≥vil que funciona con mis ediciones.  Esta lista fue la siguiente: </p><br><ol><li>  Prepare la configuraci√≥n 1c para la plataforma m√≥vil, cuya funcionalidad es mostrar dos etiquetas en el mapa. </li><li>  Desempaquete el apk de la plataforma m√≥vil, empaquete sin cambios, aseg√∫rese de que la configuraci√≥n est√© funcionando. </li><li>  Realice peque√±os cambios en los archivos peque√±os que no cambian casi nada, pero que se pueden ver en los registros o cambian la l√≥gica de trabajo, ensamblar y asegurarse de que funciona. </li><li>  Para superar la actividad peque√±a con un mapa en Java, o escribir actividad con la misma interfaz, reemplace la actividad en la aplicaci√≥n sin cambiar la funcionalidad.  Como alternativa, si el primero es demasiado vago o complicado, escriba una clase que haga parte del trabajo para MapImpl y agregue una llamada a sus m√©todos desde smali MapImpl. </li><li>  Escriba este art√≠culo (hace tiempo que quer√≠a escribir algo, pero todav√≠a se me ocurren otras ideas, pero parec√≠a que finalmente este era un tema bastante valioso) </li></ol><br><p>  Bueno, bueno, al menos con el primer p√°rrafo no tuve problemas.  Descargu√© la versi√≥n educativa gratuita de la plataforma, descargu√© la plataforma m√≥vil, la implement√© en mi computadora (1C, ¬øya tienes una versi√≥n de capacitaci√≥n para Linux, solo tengo otro impulso para dejar Windows y ahora tengo que trabajar un poco en ella?).  La configuraci√≥n es muy simple, al inicio llama a la funci√≥n ShowOnMap (), que transmite dos puntos en el mapa.  Eso es todo. </p><br><p>  Pero con el segundo punto, result√≥ m√°s triste debido a mi analfabetismo.  Pero lo que hay, los problemas estaban con todos los puntos, excepto el primero. </p><br><h1 id="perepakovyvayu-prilozhenie-bez-izmeneniy-koda">  Vuelvo a empaquetar la aplicaci√≥n sin cambiar el c√≥digo </h1><br><p>  Google inmediatamente me dijo que existe una herramienta apktool tan excelente que permite literalmente dos comandos para analizar apk a archivos .smali, as√≠ como para ensamblarlos de nuevo.  Decid√≠ usarlo.  Descomprim√≠ apk con el siguiente comando (en adelante, a pesar de que a veces hice parte del trabajo en Linux, dar√© todos los comandos para Windows): </p><br><pre><code class="plaintext hljs">apktool.bat d .\sourceApk\1cem-x86.apk -o .\build\unpacked</code> </pre> <br><p>  y obtuve el directorio desempaquetado en el que se encontraban un mont√≥n de archivos, era trabajar con ellos en el futuro.  APK empaquetado de nuevo con el comando </p><br><pre> <code class="plaintext hljs">apktool.bat b .\build\unpacked -o .\build\1cem-x86.apk</code> </pre> <br><p>  Intentando instalarlo en un emulador </p><br><pre> <code class="plaintext hljs">adb install .\build\1cem-x86.apk</code> </pre> <br><p>  Recib√≠ el siguiente error: </p><br><pre> <code class="plaintext hljs">Performing Streamed Install adb: failed to install .\build\1cem-x86.apk: Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Failed to collect certificates from /data/app/vmdl1115375036.tmp/base.apk: Attempt to get length of null array]</code> </pre> <br><p>  En general, era necesario prestar m√°s atenci√≥n a la base.  Por supuesto, sab√≠a que hay firmas y que se dividen en ventas y lanzamiento, pero no sab√≠a que las aplicaciones no se instalan sin firmas en absoluto.  Decid√≠ usar mi firma de d√©bito y firmar el equipo apk </p><br><pre> <code class="plaintext hljs">apksigner.bat sign --ks C:\Users\neikist\.android\debug.keystore .\build\1cem-x86.apk</code> </pre> <br><p>  Logr√© ejecutar la aplicaci√≥n.  Es cierto que en lugar de un mapa con dos puntos, me estaba esperando una pantalla gris con una firma de Google a continuaci√≥n.  Despu√©s de rascar el nabo, decid√≠ que el hecho es que se usa la clave para los mapas de Google de 1s, que no funciona con mi firma.  Por lo tanto, yendo a la consola del desarrollador en el sitio web de Google, cre√© un nuevo proyecto para trabajar con la API de Google Maps en Android, recib√≠ una clave de API, que especifiqu√© en res / values ‚Äã‚Äã/ strings.xml en la l√≠nea google_maps_key, y tambi√©n agregu√© mi clave compartida a los permisos para el proyecto .  Reempaqu√© y volv√≠ a firmar el apk, lo lanc√© y finalmente todo volvi√≥ a funcionar. </p><br><h1 id="dobavlyayu-svoi-logi">  Agrego mis registros </h1><br><p>  Lo siguiente que quer√≠a hacer era automatizar el lanzamiento de la aplicaci√≥n y agregar la configuraci√≥n 1c a la plataforma.  Manualmente, despu√©s de cada edici√≥n, hacer esto seguir√≠a siendo un desastre. </p><br><p>  Al principio busqu√© en Google e intent√© usar las utilidades jadx o dex2jar, para no molestarme en leer smali, sino para leer el c√≥digo java m√°s familiar, pero por alguna raz√≥n no funcionaron (m√°s tarde, jadx logr√≥ entrar en alg√∫n tipo de chamanismo).  Tuve que desmontar smali, ya que result√≥ no ser tan terrible como ten√≠a miedo. </p><br><p>  Para comprender c√≥mo la plataforma m√≥vil recibe un comando de la plataforma de escritorio para iniciar la configuraci√≥n cuando se conecta a trav√©s de adb, decid√≠ mirar los puntos de entrada a la aplicaci√≥n y agregar la salida a los registros de intentos y otra informaci√≥n √∫til.  Decid√≠ comenzar con la aplicaci√≥n ( <code>com.e1c.mobile.E1cApplication</code> ) y la actividad con <code>android.intent.action.MAIN</code> en intent-filter ( <code>com.e1c.mobile.App</code> ).  Tambi√©n estaba interesado en el receptor <code>com.e1c.mobile.Starter</code> con un filtro de intenci√≥n interesante en <code>com.e1c.mobile.START_TEMPLATE</code> y <code>com.e1c.mobile.START_CMD</code> .  Es muy similar al hecho de que acepta intentos con comandos 1s, y es √©l quien inicia la configuraci√≥n desde la plantilla. </p><br><p>  Desafortunadamente, no pude encontrar nada interesante en <code>E1cApplication</code> , todo lo que sucede all√≠ es instalar su controlador en cach√©s. </p><br><p>  Pero en las otras dos clases, <code>Starter</code> y <code>App</code> , hab√≠a mucha m√°s informaci√≥n y result√≥ ser bastante √∫til.  El <code>App.onCreate(Landroid/os/Bundle;)V</code> es bastante grande, por lo que no lo dar√© en su totalidad, solo dar√© las partes que me interesan. </p><br><div class="spoiler">  <b class="spoiler_title">Aplicaci√≥n onCreate Method Slice</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">invoke-virtual {p0}, Lcom/e1c/mobile/App;-&gt;getIntent()Landroid/content/Intent; #     p1 move-result-object p1 new-instance v0, Ljava/lang/StringBuilder; invoke-direct {v0}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder; const-string v1, ".onCreate() " invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder; invoke-virtual {v0}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String; move-result-object v0 # ,  ? invoke-static {v0}, Lcom/e1c/mobile/Utils;-&gt;V(Ljava/lang/String;)V</code> </pre> </div></div><br><p>  Se puede ver en la secci√≥n de c√≥digo anterior que la aplicaci√≥n recibe la intenci√≥n, coloca un enlace en el registro <code>p1</code> , agrega la <code>StringBuilder</code> al nombre y m√©todo de la clase a trav√©s de <code>StringBuilder</code> y pasa <code>V(Ljava/lang/String;)V</code> de la clase <code>Utils</code> al m√©todo est√°tico.  Al parecer, alg√∫n tipo de su propio registrador.  Despu√©s de eso, se verifica la intenci√≥n para obtener datos adicionales y, si est√° disponible, <code>Uri</code> obtiene <code>Uri</code> , de la cual, a su vez, se obtiene una cadena mediante el m√©todo <code>getQuery()</code> y se pasa a la clase <code>Starter</code> .  <code>onCreate</code> vi m√°s estudios sobre <code>onCreate</code> , <code>onCreate</code> un vistazo y me asegur√© de que las acciones fueran bastante est√°ndar.  A menos que la vista parezca haber sido creada program√°ticamente por una clase completamente diferente, en lugar de usar <code>LayoutInflater</code> , pero no profundic√© mucho, entonces todo es posible y no como pensaba.  La siguiente clase a la que fui es <code>Starter</code> .  Afortunadamente, fue mencionado en activismo y me interes√≥ en el manifiesto. </p><br><p>  Desafortunadamente, el m√©todo que se llam√≥ desde la actividad result√≥ ser nativo ( <code>.method static native startCmd(Ljava/lang/String;)V</code> ), por lo tanto, <code>onRecieve</code> atenci√≥n al m√©todo <code>onRecieve</code> (en el que la aplicaci√≥n acepta los eventos a los que est√° suscrita).  No dar√© el c√≥digo, estaba interesado en que la intenci√≥n tambi√©n se <code>V(Ljava/lang/String;)V</code> utilizando el m√©todo <code>V(Ljava/lang/String;)V</code> de la clase <code>Utils</code> .  Resulta que es suficiente agregar un peque√±o c√≥digo peque√±o a este m√©todo, y adem√°s obtendr√© mis registros en los mismos lugares donde los desarrolladores de la plataforma los destinaron.  Al ir a la clase Utils, inmediatamente vi 2 m√©todos vac√≠os, V y W. Aparentemente est√°n vac√≠os porque al compilar la versi√≥n de lanzamiento se cortaron.  Acabo de agregar un registro de la cadena pasada al est√°ndar <code>android.utils.Log</code> en ellos.  Para hacer esto, cambie el n√∫mero de registros locales requeridos de 0 a 1 (para la l√≠nea de etiqueta), coloque esta misma cadena en el registro <code>v0</code> y tambi√©n registr√≥ la llamada a los m√©todos de <code>Log</code> </p><br><div class="spoiler">  <b class="spoiler_title">Implementaci√≥n de los m√©todos W y V</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> .method public static V(Ljava/lang/String;)V .locals 1 const-string v0, "neikist_V" invoke-static {v0, p0}, Landroid/util/Log;-&gt;v(Ljava/lang/String;Ljava/lang/String;)I return-void .end method .method public static W(Ljava/lang/String;)V .locals 1 const-string v0, "neikist_W" invoke-static {v0, p0}, Landroid/util/Log;-&gt;w(Ljava/lang/String;Ljava/lang/String;)I return-void .end method</code> </pre> </div></div><br><p>  Lanc√© el m√≥vil desde el escritorio 1s y recib√≠ los siguientes registros </p><br><div class="spoiler">  <b class="spoiler_title">Resultados de lanzamiento</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: com.e1c.mobile.Starter@139df1c.onReceive( android.app.ReceiverRestrictedContext@346b725, Intent { act=com.e1c.mobile.START_TEMPLATE flg=0x400010 cmp=com.e1c.mobile/.Starter (has extras) } ) 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: context.getPackageName() = com.e1c.mobile 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: intent.getAction() = com.e1c.mobile.START_TEMPLATE 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: App.sActivity = null 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: templatePath = /sdcard/Download/mobilegeoMA/1cema.xml 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: debugUrl = tcp://127.0.0.1:1560 2019-10-25 19:21:42.216 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App@423609b.onCreate() Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.e1c.mobile/.App bnds=[35,252][237,505] } 2019-10-25 19:21:42.651 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App$4@4c70381.run() adMobAppId = ca-app-pub-3940256099942544~3347511713 2019-10-25 19:21:42.687 29960-30009/com.e1c.mobile V/neikist_V: App.requestPermission() shouldShowRequestPermissionRationale = false 2019-10-25 19:21:46.138 29960-30009/com.e1c.mobile V/neikist_V: App.isLowBattery() sLastBatteryPercent = 1.0</code> </pre> </div></div><br><p>  Como puede ver, existe toda la informaci√≥n necesaria para automatizar el lanzamiento de la aplicaci√≥n a trav√©s de adb.  Es cierto que en este punto atrap√© una palmada doble.  En primer lugar, finalmente recog√≠ las claves con las que jadx dominaba la traducci√≥n en java (est√° claro que de todos modos tendr√≠a que escribir en peque√±o, pero a√∫n as√≠).  Y el segundo facepalm result√≥ ser el hecho de que me di cuenta de que estaba atormentando la plataforma del desarrollador en vano (necesario solo para el desarrollo y la depuraci√≥n de configuraciones), ser√≠a m√°s correcto invertir la compilaci√≥n de lanzamiento de las aplicaciones 1s, y hay proyectos de gradle semi listos para ensamblar, hay un archivo con una lista de dependencias y otros bollos  Estaba un poco triste por esto, y a√∫n as√≠ decid√≠ terminar lo que comenc√©.  De todos modos, por el bien del fan√°tico, estoy haciendo todo esto, pero no por el beneficio pr√°ctico. </p><br><h1 id="zapusk-platformy-cherez-adb">  Lanzamiento de plataforma a trav√©s de adb </h1><br><p>  Decid√≠ automatizar la instalaci√≥n y el lanzamiento a trav√©s de la aplicaci√≥n adb usando gradle.  De todos modos, para ese momento ya ten√≠a una peque√±a lista de shuffles escritos (desempaquetando, copiando recursos modificados y archivos peque√±os en el directorio con la aplicaci√≥n desempaquetada, empaquetado, firma, de hecho todas las tareas son solo corredores para comandos de consola)  A las tareas existentes se agregaron los siguientes comandos </p><br><pre> <code class="plaintext hljs"> adb install ./build/1cem-x86.apk adb shell pm grant com.e1c.mobile android.permission.READ_EXTERNAL_STORAGE adb push src/1cConfiguration /storage/emulated/0/Download adb shell am start -n com.e1c.mobile/.App -a android.intent.action.MAIN -c android.intent.category.LAUNCHER adb shell am broadcast -n com.e1c.mobile/.Starter -a com.e1c.mobile.START_TEMPLATE -e templatepath /storage/emulated/0/Download/1cConfiguration/1cema.xml</code> </pre> <br><p>  Por la secuencia de comandos anterior, instalamos apk, le damos permiso a la aplicaci√≥n instalada para leer el disco, copiamos la configuraci√≥n de 1s en el dispositivo y damos comandos para iniciar 1s y cargar la configuraci√≥n.  Por cierto, esto no funciona en todas las versiones de Android, pero lo prob√© en la API 28 y, en consecuencia, esta secuencia hace todo correctamente.  En versiones m√°s j√≥venes, puede haber problemas con la emisi√≥n de derechos. </p><br><h1 id="vnedryayus-v-obrabotku-dannyh-ot-1s-i-modificiruyu-metki">  Participo en el procesamiento de datos desde 1s y modifico etiquetas </h1><br><p>  Aqu√≠ ten√≠a varias opciones para un mayor desarrollo de eventos. </p><br><ol><li>  Dirijo directamente MapImpl.smali, que prometi√≥ ser una tarea bastante dif√≠cil, teniendo en cuenta que la biblioteca para trabajar con los mapas de Google est√° muy minimada, y que tendr√≠a que escribir todo en la sintaxis peque√±a. </li><li>  Utilizo el archivo MapImpl.java obtenido gracias a jadx, le hago cambios, utilizo las clases que uso para reemplazarlo con stubs, destilarlo en smali, reemplazar el archivo y empacarlo.  La opci√≥n me pareci√≥ tensa, ya que realmente me dol√≠a tener muchos enchufes, adem√°s de que hab√≠a algunos problemas que no quer√≠a elegir. </li><li>  Combino los enfoques 1 y 2, inserto las llamadas de una clase de extensi√≥n especial MapImplExtenstion.java en un c√≥digo peque√±o que extiende una parte de la l√≥gica; como resultado, eleg√≠ esta opci√≥n, simplemente porque es m√°s simple que las opciones primera y segunda, y me pareci√≥ incluso un poco m√°s complicado que la opci√≥n 4, pero menos laborioso (s√≠, sue√±o, ingenuo). </li><li>  En general, reemplace los mapas de Google con algo m√°s, por ejemplo Yandex.  Para hacer todo el trabajo en otro proyecto, simplemente repitiendo las firmas de MapImpl, luego minimice desempaquetar y simplemente suelte los archivos peque√±os terminados antes de empacar la aplicaci√≥n en los lugares apropiados.  No hay problemas con las bibliotecas minimizadas, pero tendr√≠a que registrarme para obtener una clave para las tarjetas, crear un proyecto separado, molestarme con la conexi√≥n de recursos y m√°s. </li><li>  Igual que la opci√≥n 4, pero reemplaza Google con ... Google.  Pero aqu√≠ ten√≠a sospechas de que ser√≠a posible minificar 1 en 1 mapas SDK, y no hab√≠a ning√∫n deseo de experimentar. </li></ol><br><p>  Siguiendo la tercera opci√≥n, cre√© 2 subdirectorios en src: java, para MapImplExtenstion.java y stubJava para archivos que solo son necesarios para la compilaci√≥n.  Como decid√≠ modificar un poco las etiquetas, me interesaron los siguientes dos campos: </p><br><div class="spoiler">  <b class="spoiler_title">Campos Xj: Ljava / util / ArrayList y Xk: Ljava / util / ArrayList</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> .field private final Xj:Ljava/util/ArrayList; .annotation system Ldalvik/annotation/Signature; value = { "Ljava/util/ArrayList&lt;", "Lcom/google/android/gms/maps/model/LatLng;", "&gt;;" } .end annotation .end field .field private Xk:Ljava/util/ArrayList; .annotation system Ldalvik/annotation/Signature; value = { "Ljava/util/ArrayList&lt;", "Lcom/google/android/gms/maps/model/MarkerOptions;", "&gt;;" } .end annotation .end field</code> </pre> </div></div><br><p>  Usando jadx para descompilar en Java, encontr√© en el c√≥digo descompilado un m√©todo responsable de llenarlos </p><br><div class="spoiler">  <b class="spoiler_title">M√©todo KN</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Bundle extras = getIntent().getExtras(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extras != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Sd = extras.getLong(<span class="hljs-string"><span class="hljs-string">"native"</span></span>); String[] stringArray = extras.getStringArray(<span class="hljs-string"><span class="hljs-string">"titles"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] doubleArray = extras.getDoubleArray(<span class="hljs-string"><span class="hljs-string">"coords"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doubleArray != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; doubleArray.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; stringArray.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i2 = i * <span class="hljs-number"><span class="hljs-number">2</span></span>; LatLng latLng = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LatLng(doubleArray[i2], doubleArray[i2 + <span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Xj.add(latLng); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Xk.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions().c(latLng).dS(stringArray[i])); } } } }</code> </pre></div></div><br><p>  En consecuencia, la clase MapImplExtension ha agregado el m√©todo ArrayList [] kN (String [] t√≠tulos, coordenadas dobles []) que en el primer elemento de la matriz devolver√° una lista que deber√° colocarse en Xj, y en el segundo una lista para Xk. </p><br><div class="spoiler">  <b class="spoiler_title">Clase MapImplExtension</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.e1c.mobile; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.maps.model.LatLng; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.maps.model.MarkerOptions; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MapImplExtension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MapImpl mapImpl; MapImplExtension(MapImpl mapImpl){ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mapImpl = mapImpl; } ArrayList[] kN(String[] titles, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] coordinates) { ArrayList[] result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList[<span class="hljs-number"><span class="hljs-number">2</span></span>]; ArrayList&lt;LatLng&gt; xj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); ArrayList&lt;MarkerOptions&gt; xk = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); result[<span class="hljs-number"><span class="hljs-number">0</span></span>] = xj; result[<span class="hljs-number"><span class="hljs-number">1</span></span>] = xk; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> coordinatesOffset; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (coordinates != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; coordinates.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; titles.length; i++) { coordinatesOffset = i * <span class="hljs-number"><span class="hljs-number">2</span></span>; LatLng latlng = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LatLng(coordinates[coordinatesOffset], coordinates[coordinatesOffset + <span class="hljs-number"><span class="hljs-number">1</span></span>]); xj.add(latlng); xk.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions().c(latlng).dS(<span class="hljs-string"><span class="hljs-string">" \n"</span></span> + titles[i])); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre></div></div><br><p>  Compilado con los siguientes comandos, primero en clase, luego en dex, luego descompilado en peque√±os para luego empaquetar junto con el resto de los archivos </p><br><pre> <code class="plaintext hljs"> javac -encoding UTF-8 -d .\build -source 1.8 -target 1.8 -sourcepath .\src\stubJava .\src\java\com\e1c\mobile\MapImplExtenstion.java d8.bat .\build\com\e1c\mobile\MapImplExtension.class --output .\build java -jar C:\Path\to\baksmali\baksmali.jar d .\build\classes.dex -o .\build\unpackedOwn</code> </pre> <br><p>  Se agreg√≥ el campo de extensi√≥n de tipo de nuestra nueva clase a MapImpl.smali y se agreg√≥ su inicializaci√≥n </p><br><div class="spoiler">  <b class="spoiler_title">Agregar un campo</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    .field private extension:Lcom/e1c/mobile/MapImplExtension; #  ,  return-void new-instance v0, Lcom/e1c/mobile/MapImplExtension; invoke-direct {v0, p0}, Lcom/e1c/mobile/MapImplExtension;-&gt;&lt;init&gt;(Lcom/e1c/mobile/MapImpl;)V iput-object v0, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension;</code> </pre> </div></div><br><p>  Y tambi√©n reemplaz√≥ el procesamiento en la clase de datos MapImpl de 1s con el procesamiento en la clase MapImplExtension </p><br><div class="spoiler">  <b class="spoiler_title">Cambios en MapImpl.kN ()</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> # v0 - ; v1 - ; v2 - extension; #  MapImplExtension.kN(...) iget-object v2, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension; invoke-virtual {v2, v1, v0}, Lcom/e1c/mobile/MapImplExtension;-&gt;kN([Ljava/lang/String;[D)[Ljava/util/ArrayList; # v0 -   ; v1 - | ; v2 -    move-result-object v0 const/4 v2, 0x0 aget-object v1, v0, v2 iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xj:Ljava/util/ArrayList; const/4 v2, 0x1 aget-object v1, v0, v2 iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xk:Ljava/util/ArrayList;</code> </pre> </div></div><br><p>  Despu√©s de empacar y lanzar la aplicaci√≥n, alegremente vi que todo estaba funcionando.  Pero por el momento no he hecho nada que ampl√≠e las capacidades de la plataforma m√≥vil.  Acabo de cambiar los encabezados de las marcas en el mapa.  Pero con el deseo de cambiar la imagen de las etiquetas, romp√≠ muy bien y enterr√© bastante tiempo en las fuentes y la documentaci√≥n. </p><br><h1 id="dobavlenie-novoy-funkcionalnosti">  Agregar nueva funcionalidad </h1><br><p>  Primero, una peque√±a explicaci√≥n de c√≥mo se establece el marcador para la etiqueta.  La clase <code>MarkerOptions</code> tiene un m√©todo <code>public MarkerOptions icon (BitmapDescriptor iconDescriptor)</code> al que se <code>public MarkerOptions icon (BitmapDescriptor iconDescriptor)</code> el objeto creado por uno de los m√©todos est√°ticos de la clase <code>BitmapDescriptorFactory</code> . </p><br><p>  Y aqu√≠, de hecho, un fastidio me estaba esperando.  Como 1c no usa este negocio, las clases correspondientes simplemente se cortaron durante la minificaci√≥n.  Tuve que restaurarlos, y fue doloroso y largo.  M√°s precisamente, las clases estaban all√≠, pero fueron renombradas y no conten√≠an los m√©todos necesarios.  Al elegir el tipo de biblioteca completa para trabajar con mapas, mediante firmas y constantes descubr√≠ la correspondencia de las clases de la biblioteca con las clases de aplicaci√≥n, agregu√© los m√©todos y campos necesarios, la reconstru√≠ y me alegr√© de que esta b√∫squeda finalmente terminara, ya que finalmente funcion√≥, aunque no desde el primer intento (varias veces cortado con firmas y clases minimizadas confusas). </p><br><div class="spoiler">  <b class="spoiler_title">El resultado (exteriormente no es muy impresionante).</b>  <b class="spoiler_title">Dos puntos con coordenadas (45; 45) y (46; 46)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pv/cz/lu/pvczlujpmwuu2y2bauzieeszkby.png"></p></div></div><br><p>  Dado que el volumen del c√≥digo modificado es bastante grande, no lo incluir√© en el art√≠culo, solo dar√© los cambios de firma.  Si alguien est√° interesado en todas las ediciones que hice en este paso, puede consultar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este compromiso</a> . </p><br><pre> <code class="java hljs">   Lcom/google/android/gms/maps/model/MarkerOptions -   .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">icon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Lcom/google/android/gms/maps/model/a;)</span></span></span><span class="hljs-function">Lcom/google/android/gms/maps/model/MarkerOptions</span></span>;   com.google.android.gms.internal.fh   : <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>;   com.google.android.gms.internal.fj     h       com.google.android.gms.maps.model.b (BitmapDescriptorFactory)    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromAsset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromPath</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultMarker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultMarker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromBitmap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap)</span></span></span><span class="hljs-function">      MapImplExtension.java   xk.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(new MarkerOptions()</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(latlng)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"  "</span></span></span></span><span class="hljs-function"><span class="hljs-params"> + titles[i])</span></span></span><span class="hljs-function">)</span></span>;     MarkerOptions markerOptions = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions() .c(latlng) .dS(<span class="hljs-string"><span class="hljs-string">"  "</span></span> + titles[i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//      markerOptions.icon(b.defaultMarker(b.HUE_YELLOW)); } xk.add(markerOptions);</span></span></code> </pre><br><p>  Para resumir, la experiencia fue bastante interesante.  Al menos para mi.  Ayud√© a descubrir algunas herramientas, aprend√≠ un poco mejor sobre el trabajo de Android y el formato de bytecode para dalvik / art, la experiencia de elegir c√≥digo minificado tambi√©n ser√≠a √∫til (ya hubo un caso cuando en la versi√≥n de lanzamiento de R8 elimin√© los campos de clase que en realidad se usaron, en ese momento solo por el m√©todo Lo descubr√≠, ahora no causar√≠a problemas). </p><br><p>  Si alguien est√° interesado en repetir todo √©l mismo y posiblemente recogerlo a√∫n m√°s, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publiqu√© en github</a> todas las fuentes junto con un script de gradle torcido que se construye a partir del apk original modificado. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/475266/">https://habr.com/ru/post/475266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../475254/index.html">Arquitectura o caracter√≠sticas de AERODISK vAIR del edificio de cl√∫ster nacional</a></li>
<li><a href="../475258/index.html">Una representaci√≥n visual de las elecciones en San Petersburgo: la magia del ajuste de voz</a></li>
<li><a href="../475260/index.html">La diferencia entre una funci√≥n asincr√≥nica y una funci√≥n que devuelve una promesa</a></li>
<li><a href="../475262/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 388 (4 al 10 de noviembre de 2019)</a></li>
<li><a href="../475264/index.html">Sniffers que podr√≠an: c√≥mo la familia FakeSecurity infect√≥ las tiendas en l√≠nea</a></li>
<li><a href="../475268/index.html">La parametrizaci√≥n incierta como m√©todo universal para construir arquitectura de aplicaciones en C ++ y Java por un m√≠nimo. el precio</a></li>
<li><a href="../475270/index.html">SwiftUI: creaci√≥n de secciones expandibles / plegables en la vista de lista</a></li>
<li><a href="../475272/index.html">Migraci√≥n a infraestructura as√≠ncrona en espera en Rust</a></li>
<li><a href="../475276/index.html">C√≥mo escribir afirmar correctamente</a></li>
<li><a href="../475278/index.html">C√≥mo mirar a un hacker mientras un hacker te mira a ti</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>