<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüíª üìì ‚ò¶Ô∏è Para a quest√£o da divis√£o ‚úçüèΩ üíñ ü§¥üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tivemos a oportunidade de realizar um exerc√≠cio t√°tico pequeno, mas extremamente interessante 
 No processo de pesquisa de um novo MK de uma empresa c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Para a quest√£o da divis√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444550/"><h3>  Tivemos a oportunidade de realizar um exerc√≠cio t√°tico pequeno, mas extremamente interessante </h3><br>  No processo de pesquisa de um novo MK de uma empresa conhecida, baseada na arquitetura Cortex-M4 (eu definitivamente escreverei sobre isso mais tarde), surgiu a quest√£o de qu√£o rapidamente a opera√ß√£o de divis√£o inteira na implementa√ß√£o de hardware pode funcionar.  O experimento em grande escala deu um resultado um tanto inesperado: a divis√£o de um n√∫mero de 32 bits em um n√∫mero de 32 bits √© realizada em 3 ciclos de clock da frequ√™ncia do processador - bem, n√£o importa a rapidez.  Aconteceu que isso ocorre apenas com certos operandos, mas estudos posteriores mostraram que o tempo necess√°rio para concluir uma divis√£o nunca excede 7 medidas.  Os resultados obtidos causaram uma leve correria ("e esta n√£o √© uma figura de linguagem espec√≠fica, que n√£o sabe o que significa, mas um verbo muito espec√≠fico" - Divov, como sempre, √© incompar√°vel). <br><br>  Bem, voc√™ n√£o pode simplesmente pegar e dividir rapidamente n√∫meros t√£o longos, √© estranho assim, mas os fatos s√£o uma coisa teimosa.  Imaginei a imagem que o Presidente da Federa√ß√£o Russa me chama para ele amanh√£ e coloca diante de mim a tarefa de tornar o MK n√£o pior do que o da ARM (eu concordo que a imagem √© ilus√≥ria, mas n√£o acontece no mundo), mas olho para ele confusa e entendo que N√£o poderei fazer essa divis√£o desses n√∫meros em um per√≠odo t√£o longo e n√£o cumprirei as expectativas que me s√£o impostas (bem, na verdade, sempre posso comprar uma licen√ßa da ARM em sil√™ncio e fingir que inventei tudo sozinha, muitas fazem isso, mas O PIB est√° esperando algo completamente diferente de mim, e ent√£o - eu posso engan√°-lo, mas √© improv√°vel). <br><a name="habracut"></a><br>  Fiquei triste por os caras do ARM serem muito mais espertos do que eu, e fiquei olhando ansiosamente a Internet para ver como eles fazem isso.  N√£o encontrei nenhuma informa√ß√£o sobre o tempo de execu√ß√£o no site da ARM; em um dos materiais do STM32, foi indicado que a divis√£o leva de 2 a 7 ciclos de rel√≥gio, o que corresponde √†s observa√ß√µes, mas n√£o h√° informa√ß√µes sobre como isso √© feito. <br><br>  Em geral, a onipotente Internet n√£o ajudou muito, h√° truques com divis√£o por constante, escrevi sobre eles em uma das postagens, mas temos uma situa√ß√£o diferente, existe o algoritmo de Newton e sua vers√£o acelerada, mas esse claramente n√£o √© o caso, existe um algoritmo baseado em Transformada de Fourier, mas isso √© para n√∫meros muito grandes e √© improv√°vel que seja conclu√≠da em 7 ciclos, mesmo na arquitetura ARM.  Eu mesmo tive que criar uma solu√ß√£o e foi encontrada uma solu√ß√£o, t√£o simples e √≥bvia que se torna um pouco embara√ßosa pelo fato de isso n√£o ter sido feito imediatamente ap√≥s a formula√ß√£o da tarefa. <br><br>  Antes de analisar minha decis√£o, sugiro que voc√™ encontre a sua e compare com a minha. Se elas diferirem, estou esperando por voc√™ nos coment√°rios. <br><br>  Ent√£o, como dividimos rapidamente (em n√£o mais de 7 ciclos) dois n√∫meros de 32 bits para obter um resultado de 32 bits. <br><br>  Para come√ßar, lembramos como a divis√£o na aritm√©tica bin√°ria √© geralmente realizada em <br>  forma cl√°ssica.  O algoritmo √© bastante simples e direto - subtra√≠mos o divisor do dividendo.  Se o resultado for n√£o negativo (dividimos os n√∫meros n√£o assinados), fa√ßa o pr√≥ximo d√≠gito do resultado igual a um e considere o resultado como o pr√≥ximo dividendo, caso contr√°rio, o pr√≥ximo bit do resultado ser√° 0. Antes da pr√≥xima medida, reduzimos o divisor pela metade (mova-o para a direita ou desloque o dividendo para a esquerda) e reduza o peso do bit em 2 vezes (em turnos semelhantes).  Assim, obtemos um pouco do resultado em um ciclo de clock e toda a opera√ß√£o durar√° 32 ciclos de clock.  Ainda existe uma mudan√ßa inicial nesse processo, mas isso n√£o afeta a avalia√ß√£o da situa√ß√£o como um todo.  Vamos acelerar, mas como? <br><br>  Observamos que o algoritmo resultante se assemelha fortemente √† opera√ß√£o de um ADC com uma aproxima√ß√£o sequencial e lembramos que existem outros m√©todos de convers√£o, convers√£o paralela muito mais r√°pida.  E se ... <br><br>  Subtrairemos do divisor n√£o apenas o dividendo, mas tamb√©m o dividendo * 2 e o dividendo * 3 (ao mesmo tempo, em tr√™s somadores); em seguida, obteremos tr√™s bits (sinais de resultados) da informa√ß√£o, que recebem 4 valores diferentes, para que voc√™ possa extrair 2 bits ao mesmo tempo. resultado.  Em seguida, extrapolamos uma abordagem semelhante para 3,4,5 bits do resultado. <br>  Para obter 5 bits de informa√ß√£o por ciclo, precisamos de 31 somadores, em cada um dos quais ser√° executada a opera√ß√£o Dividend-Divisor * n (1-31), os sinais do resultado ser√£o passados ‚Äã‚Äãpelo codificador e receberemos imediatamente 5 bits do resultado.  Em seguida, deslocamos o dividendo em 5 d√≠gitos para a esquerda e repetimos at√© estar pronto.  Ent√£o precisamos de 32/5 = 6.4 =&gt; 7 medidas para concluir a opera√ß√£o. <br><br>  Para o trabalho, precisamos de 31 + x somadores, parece ser muito, mas j√° os temos, porque temos uma opera√ß√£o de multiplica√ß√£o 32 * 32 por ciclo e, para implement√°-lo, n√£o podemos prescindir de 32 somadores (bem, acho que sim ... ), para que j√° tenhamos o equipamento necess√°rio, a √∫nica quest√£o √© construir um circuito de controle e um monte de multiplexadores para realizar uma mudan√ßa r√°pida, mas isso √© completamente solucion√°vel. <br><br>  Portanto, a tarefa de dividir em 7 etapas √© resolvida, a quest√£o permanece - como esse tempo pode ser reduzido, porque no MK estudado √© menor que 7. A solu√ß√£o √≥bvia √© determinar o n√∫mero do d√≠gito mais significativo do dividendo (H) e do divisor (3) na fase de prepara√ß√£o do algoritmo ficar√° imediatamente claro quantos bits altos do quociente s√£o iguais a zero, para que possamos pular a primeira ou v√°rias fases do algoritmo.  Por exemplo, se C &lt;3, o resultado √© imediatamente zero e conclu√≠mos a opera√ß√£o, com certeza voc√™ pode derivar uma f√≥rmula para o n√∫mero de medidas, mas eu j√° estava entediado. <br><br>  Curiosamente, a opera√ß√£o udiv fornece apenas o quociente, embora o restante obviamente permane√ßa em algum lugar dentro.  Em princ√≠pio, n√£o √© dif√≠cil obt√™-lo em duas etapas, o que foi feito no fragmento estudado do c√≥digo de m√°quina executando o pseudo-c√≥digo Divisible-Private * Divider, mas isso √© para duas etapas, por que n√£o divulg√°-lo imediatamente no par de registradores - n√£o sei a resposta para isso uma pergunta <br><br>  Em geral, conhe√ßa o PIB, diga a ele que definitivamente faremos a divis√£o em MK, se isso ainda for interessante para ele. <br><br>  PS: A prop√≥sito, quando eu estava procurando por KDPV (como voc√™ notou, n√£o o encontrei), notei uma com a inscri√ß√£o francamente incorreta "Voc√™ n√£o deve dividir por zero".  Devo dizer com certeza que √© poss√≠vel dividir por zero, n√£o pode ser dividido.  Mas, falando s√©rio, em diferentes arquiteturas, elas se dividem por zero de maneira diferente; em x86, obtemos uma exce√ß√£o (este √© um erro inesquec√≠vel 200); em algumas, obtemos um dividendo ou zero, mas nunca vi o n√∫mero m√°ximo m√°ximo.  No ARM n / 0 = 0/0, verifica-se 0. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444550/">https://habr.com/ru/post/pt444550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444540/index.html">Intel est√° pronta para come√ßar a produ√ß√£o de mem√≥ria MRAM</a></li>
<li><a href="../pt444542/index.html">Transmiss√£o ao vivo e programa√ß√£o de confer√™ncias para SmartMail Conf: Machine Learning</a></li>
<li><a href="../pt444544/index.html">Algo sobre data centers distribu√≠dos para empresas</a></li>
<li><a href="../pt444546/index.html">Como e por que trabalhar mais devagar? O m√©todo de Sergey Korolev</a></li>
<li><a href="../pt444548/index.html">Experi√™ncia pessoal: como nos envolvemos na promo√ß√£o de startups hisp√¢nicas na Am√©rica Latina</a></li>
<li><a href="../pt444552/index.html">TDMS Fairway. Trabalhe com experi√™ncia</a></li>
<li><a href="../pt444554/index.html">A API RESTful JSON mais simples do Elixir</a></li>
<li><a href="../pt444556/index.html">A cor da lua e do sol do espa√ßo nos valores de RGB e temperatura de cor</a></li>
<li><a href="../pt444558/index.html">Novidades do CUBA 7</a></li>
<li><a href="../pt444560/index.html">Convidamos voc√™ para a confer√™ncia ‚ÄúClouds. Fashion Trends ‚Äù26 de mar√ßo de 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>