<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà≤ ü•£ üëçüèΩ Nous brisons la protection contre les bots üìî üôéüèº üåΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="R√©cemment, des incapsules ont commenc√© √† appara√Ætre sur de nombreux sites √©trangers - un syst√®me qui augmente la s√©curit√© du site, la vitesse et en m√™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous brisons la protection contre les bots</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429662/"><img src="https://habrastorage.org/webt/kg/it/oe/kgitoeky0eoigux3dhyyhtj9hdy.jpeg"><br><br>  R√©cemment, des <b>incapsules</b> ont commenc√© √† appara√Ætre sur de nombreux sites √©trangers - un syst√®me qui augmente la s√©curit√© du site, la vitesse et en m√™me temps complique consid√©rablement la vie des d√©veloppeurs de logiciels.  L'essence de ce syst√®me est une protection compl√®te √† l'aide de JavaScript, qui, soit dit en passant, de nombreux robots DDOS ont d√©j√† appris √† ex√©cuter et m√™me √† contourner CloudFlare.  Aujourd'hui, nous √©tudierons l'incapsule, r√©digerons un d√©sobfuscateur de script JS et enseignerons √† notre bot <s>DDOS</s> comment le contourner! <br><a name="habracut"></a><br>  Le site dans la capture d'√©cran ci-dessous est pris comme un bon exemple pour un article, ne diff√®re pas des autres, sur les forums de sujets douteux, beaucoup recherchent des brutes pour cela, mais j'ai une autre t√¢che - un logiciel pour automatiser diverses actions avec les sites. <br><br>  Commen√ßons par examiner les requ√™tes, car il n'y en a que 2, et voici la premi√®re: <br><br><img src="https://habrastorage.org/webt/fq/ny/wq/fqnywqsbrzm9ffvjux0t0onl_f0.png"><br><br>  Cette requ√™te charge un script naturellement obscurci: <br><br><img src="https://habrastorage.org/webt/ts/am/ln/tsamlnznbd7aoj5olinfx0vhab8.png"><br><br>  Changer eval en <b>document.write ()</b> donne un code l√©g√®rement plus lisible: <br><br><img src="https://habrastorage.org/webt/dg/bx/qy/dgbxqyaozcow_dfee1vujsaxqd8.png"><br><br>  Je ne sais pas pourquoi, mais les outils automatiques de formatage du code de sortie cassent ce code, j'ai donc d√ª le formater avec mes mains et donner aux variables des noms normaux.  Pour toutes ces manipulations, j'ai utilis√© un simple bloc-notes ++ et une fonction de remplacement de texte.Par cons√©quent, nous pouvons continuer et examiner la premi√®re ligne: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x3a59=[<span class="hljs-string"><span class="hljs-string">'wpgXPQ=='</span></span>,<span class="hljs-string"><span class="hljs-string">'cVjDjw=='</span></span>,<span class="hljs-string"><span class="hljs-string">'Tk/DrFl/'</span></span>,<span class="hljs-string"><span class="hljs-string">'GMOMd8K2w4jCpw=='</span></span>,<span class="hljs-string"><span class="hljs-string">'wpkwwpE='</span></span>,<span class="hljs-string"><span class="hljs-string">'w6zDmmrClMKVHA=='</span></span>, ... ,<span class="hljs-string"><span class="hljs-string">'w4w+w5MGBQI='</span></span>,<span class="hljs-string"><span class="hljs-string">'w6TDr8Obw6TDlTJQaQ=='</span></span>];</code> </pre> <br>  Il s'agit d'un tableau qui contient des noms de fonction chiffr√©s et d'autres cha√Ænes, nous devons donc rechercher une fonction qui d√©chiffre ce tableau, pas besoin d'aller loin: <br><br><div class="spoiler">  <b class="spoiler_title">Code d√©sobfusqu√©</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Decrypt=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">base64_Encoded_Param,Key_Param</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CounterArray=[], CRC=<span class="hljs-number"><span class="hljs-number">0x0</span></span>, TempVar, result=<span class="hljs-string"><span class="hljs-string">''</span></span>, EncodedSTR=<span class="hljs-string"><span class="hljs-string">''</span></span>; base64_Encoded_Param=atob(base64_Encoded_Param); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0</span></span>,input_length=base64_Encoded_Param.length;n&lt;input_length;n++){ EncodedSTR+=<span class="hljs-string"><span class="hljs-string">'%'</span></span>+(<span class="hljs-string"><span class="hljs-string">'00'</span></span>+base64_Encoded_Param.charCodeAt(n).toString(<span class="hljs-number"><span class="hljs-number">0x10</span></span>)).slice(<span class="hljs-number"><span class="hljs-number">-0x2</span></span>); } base64_Encoded_Param=<span class="hljs-built_in"><span class="hljs-built_in">decodeURIComponent</span></span>(EncodedSTR); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;<span class="hljs-number"><span class="hljs-number">0x100</span></span>;n++){ CounterArray[n]=n; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;<span class="hljs-number"><span class="hljs-number">0x100</span></span>;n++){ CRC=(CRC+CounterArray[n]+Key_Param.charCodeAt(n%Key_Param.length))%<span class="hljs-number"><span class="hljs-number">0x100</span></span>; TempVar=CounterArray[n]; CounterArray[n]=CounterArray[CRC]; CounterArray[CRC]=TempVar; } n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>; CRC=<span class="hljs-number"><span class="hljs-number">0x0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;i&lt;base64_Encoded_Param.length;i++){ n=(n+<span class="hljs-number"><span class="hljs-number">0x1</span></span>)%<span class="hljs-number"><span class="hljs-number">0x100</span></span>; CRC=(CRC+CounterArray[n])%<span class="hljs-number"><span class="hljs-number">0x100</span></span>; TempVar=CounterArray[n]; CounterArray[n]=CounterArray[CRC]; CounterArray[CRC]=TempVar; result+=<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCharCode(base64_Encoded_Param.charCodeAt(i)^CounterArray[(CounterArray[n]+CounterArray[CRC])%<span class="hljs-number"><span class="hljs-number">0x100</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; };</code> </pre> <br></div></div><br>  Si nous l'appelons s√©par√©ment: <br><br><pre> <code class="javascript hljs">ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0Et]'</span></span>)</code> </pre> <br>  Ce r√©sultat sera loin de ce que nous attendions.  Et tout est √† bl√¢mer pour une autre fonction: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shift_array=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">number_of_shifts</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(--number_of_shifts){ EncodedParams[<span class="hljs-string"><span class="hljs-string">'push'</span></span>](EncodedParams[<span class="hljs-string"><span class="hljs-string">'shift'</span></span>]()); } };</code> </pre><br>  Ce qui est dans un endroit tr√®s inattendu - dans une fonction qui est appel√©e au tout d√©but et v√©rifie les cookies.  Apparemment, les d√©veloppeurs ont ainsi ¬´prot√©g√©¬ª la suppression du contr√¥le des cookies.  Comme vous pouvez le voir - rien de compliqu√©, la boucle d√©cale simplement le tableau du nombre sp√©cifi√© d'√©l√©ments, dans notre cas 223 √©l√©ments.  D'o√π vient ce nombre magique 223?  J'ai pris ce num√©ro d'un appel √† la fonction de v√©rification des cookies, il ressemble √† 0xdf et suit cette route: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  function(EncodedParams,EncodedParamsShifts); //  (AllParams,0xdf); //0xdf =&gt; 223 //    var _0x5e622e=function(_0x486a40,_0x1de600){_0x486a40(++_0x1de600);}; _0x5e622e(shift_array,EncodedParamsShifts); //     : shift_array(++EncodedParamsShifts);</span></span></code> </pre><br>  Naturellement, cela change √† chaque fois, qui en douterait ... <br><br>  Il ne reste plus qu'√† remplacer tous les appels <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x85e545=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0Et]'</span></span>)];</code> </pre> <br>  sur <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x85e545=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-string"><span class="hljs-string">'window'</span></span>];</code> </pre> <br>  Ou, mieux encore, sur <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ThisWindow=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window;</code> </pre> <br>  J'ai fait la derni√®re conversion en tant que r√©gulier r√©gulier.  Oh oui, ils ont compl√®tement oubli√© de donner les lignes suivantes: <br><br> <code>\x77\x6f\x4a\x33\x58\x68\x6b\x59\x77\x34\x44\x44\x6e\x78\x64\x70</code> <br> <br>  En vue normale.  Il n'y a rien de compliqu√©, c'est un UrlEncode normal, changez \ x en% et d√©codez pour obtenir la ligne suivante: <br><br> <code>woJ3XhkYw4DDnxdp</code> <br> <br>  Puis j'ai commenc√© √† remplacer tous les appels ala <br><br><pre> <code class="javascript hljs">ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0Et]'</span></span>)</code> </pre> <br>  aux lignes d√©j√† d√©chiffr√©es en utilisant une fonction auto-√©crite de mon module.  Oui, le code ne brille pas de beaut√©, les d√©lais br√ªlaient (comme c'√©tait g√©n√©ralement le cas hier) et j'√©tais trop paresseux pour penser <s>parce que j'avais l'habitude de programmer avec la souris</s> , n√©anmoins, √ßa marche bien: <br><br><img src="https://habrastorage.org/webt/bc/29/92/bc29921g6sig2pulkkbovpnu88a.png"><br><br>  J'ai r√©√©crit le code de la source presque 1v1. <br><br>  Ensuite, une autre m√©thode pour brouiller le code a attir√© mon attention.  J'ai d√ª √©crire une fonction assez grande qui recherche de tels appels: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'7'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(_0x30fe16[<span class="hljs-string"><span class="hljs-string">"XNg"</span></span>](_0x13d8ee,_0x5a370d))</code> </pre> <br>  Et en les rempla√ßant par des analogues plus simples: <br><br><div class="spoiler">  <b class="spoiler_title">Grande liste de fonctionnalit√©s</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x30fe16={ <span class="hljs-string"><span class="hljs-string">'XNg'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x19aabd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x425e3c,_0x481cd6</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x425e3c&lt;_0x481cd6;}, <span class="hljs-string"><span class="hljs-string">'sUd'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x320363</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0xa24206,_0x49d66b</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0xa24206&amp;_0x49d66b;}, <span class="hljs-string"><span class="hljs-string">'wMk'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x32974a</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x2cdcf4,_0x250e85</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x2cdcf4&gt;&gt;_0x250e85;}, <span class="hljs-string"><span class="hljs-string">'FnU'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x22ce98</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x2f5577,_0x4feea7</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x2f5577&lt;&lt;_0x4feea7;}, <span class="hljs-string"><span class="hljs-string">'mTe'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x35a8bc</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x11fecf,_0x29718e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x11fecf&amp;_0x29718e;}, <span class="hljs-string"><span class="hljs-string">'doo'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x5ce08b</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x4e5976,_0x4757ea</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x4e5976&gt;&gt;_0x4757ea;}, <span class="hljs-string"><span class="hljs-string">'vmP'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x5d415c</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x39dc96,_0x59022e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x39dc96&lt;&lt;_0x59022e;}, <span class="hljs-string"><span class="hljs-string">'bGL'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0xd49b</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x7e8c9f,_0x301346</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x7e8c9f|_0x301346;}, <span class="hljs-string"><span class="hljs-string">'rXw'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x4dfb4d</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x39d33a,_0x36fd1e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x39d33a&lt;&lt;_0x36fd1e;}, <span class="hljs-string"><span class="hljs-string">'svD'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x387610</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x3cd4f7,_0x58fd9e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x3cd4f7&amp;_0x58fd9e;}, <span class="hljs-string"><span class="hljs-string">'cuj'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x472c54</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x4e473a,_0x26f3fd</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x4e473a==_0x26f3fd;}, <span class="hljs-string"><span class="hljs-string">'OrY'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x3c6e85</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x445d0b,_0x1caacf</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x445d0b|_0x1caacf;}, <span class="hljs-string"><span class="hljs-string">'AKn'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x4dac5b</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x521c05,_0x27b6bd</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x521c05&gt;&gt;_0x27b6bd;}, <span class="hljs-string"><span class="hljs-string">'gtj'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x5416f0</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x3e0965,_0x560062</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x3e0965&amp;_0x560062;} };</code> </pre> <br></div></div><br>  Pour obtenir: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'7'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(_0x13d8ee &lt; _0x5a370d){</code> </pre> <br>  L'algorithme de travail est terriblement simple, en fait, nous substituons juste les variables: <br><br><ol><li>  On retrouve le nom du tableau, dans notre cas: <b>_0x30fe16</b> </li><li>  Param√®tres d'entr√©e Parsim: <b>_0x425e3c, _0x481cd6</b> </li><li>  Corps de la fonction Parsim: <b>_0x425e3c &lt;_0x481cd6</b> </li><li>  Remplacez <b>_0x425e3c</b> par <b>_0x13d8ee</b> </li><li>  Remplacez <b>_0x481cd6</b> par <b>_0x5a370d</b> </li><li>  Nous <b>obtenons</b> : <b>_0x13d8ee &lt;_0x5a370d</b> </li><li>  Remplacez <b>_0x30fe16.XNg (_0x13d8ee, _0x5a370d)</b> par le code ci-dessus </li><li>  R√©p√©ter jusqu'√† la fin des fonctions </li></ol><br>  L'analyse du nom, des param√®tres et du corps de la fonction est effectu√©e par une personne r√©guli√®re.  Bien s√ªr, dans la version finale du module, cette m√©thode n'est pas particuli√®rement n√©cessaire, il n'y a qu'un seul appel qui est l√©g√®rement plus obscurci, mais le client a dit de tout faire et donc l'a fait, en plus, d'autres fonctions sont √©galement devenues plus claires.  Sur d'autres sites, il existe √©galement de tels mod√®les: <br><br><div class="spoiler">  <b class="spoiler_title">Afficher le gros et le mauvais code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x4dc9f4 = { <span class="hljs-string"><span class="hljs-string">'NTSjj'</span></span>: _0x3d6e1f.dEVDh, <span class="hljs-string"><span class="hljs-string">'tZeHx'</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x2a40cd, _0x2faf22</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x3d6e1f.JIehC(_0x2a40cd, _0x2faf22); }, <span class="hljs-string"><span class="hljs-string">'ocgoO'</span></span>: <span class="hljs-string"><span class="hljs-string">"https://site/login"</span></span>, <span class="hljs-string"><span class="hljs-string">'WmiOO'</span></span>: _0x3d6e1f.vsCuf }; <span class="hljs-comment"><span class="hljs-comment">//    ,      : var _0x3d6e1f = { 'dEVDh': "4|0|2|3|5|1", 'JIehC': function(_0x34757f, _0xd344e8) { return _0x34757f != _0xd344e8; }, 'vsCuf': ".countdownGroup", 'awUzV': function(_0x4b3914, _0x1f9e41) { return _0x4b3914 === _0x1f9e41; }, 'smOkd': "NSpHE", 'bvCub': function(_0x208c1d, _0x160d32) { return _0x208c1d(_0x160d32); }, 'PmBNl': function(_0x33524f, _0x29b35a) { return _0x33524f(_0x29b35a); }, 'Fhbrr': "#stopBtn", 'Vkpkf': function(_0x2de6ac, _0x31bb8b) { return _0x2de6ac + _0x31bb8b; }, 'HbSaV': function(_0x429822, _0x1a46e9) { return _0x429822 + _0x1a46e9; }, 'UsdKM': "https://site/register", 'JCXqh': "Timer started. ", 'GBXqx': function(_0x18f912, _0x5829b5) { return _0x18f912 / _0x5829b5; }, 'sSdZf': function(_0x45f64c, _0x152cb4) { return _0x45f64c(_0x152cb4); }, 'AAmKj': ".countdownTimer" };</span></span></code> </pre> </div></div><br>  Comme vous pouvez le voir ici, un param√®tre d'un tableau se r√©f√®re √† un autre.  J'ai r√©solu ce probl√®me simplement: <br><br><ol><li>  Analyser tous les tableaux </li><li>  Nous les nettoyons du code </li><li>  Copiez tous les √©l√©ments dans un tableau associatif (nom, valeur) </li><li>  Dans une boucle par une recherche r√©cursive, nous recherchons toutes les fonctions imbriqu√©es </li><li>  Remplacer les fonctions imbriqu√©es par les actions qu'elles font </li><li>  D√©veloppez tous les liens vers les cha√Ænes de la m√™me mani√®re </li></ol><br>  Apr√®s avoir appliqu√© cette m√©thode de d√©sobfuscation, le code est devenu un peu moins d√©routant.  Vous pouvez imm√©diatement remarquer la fonction base64 de deux mani√®res.  Premier: <br><br><pre> <code class="javascript hljs">CharArray=<span class="hljs-string"><span class="hljs-string">"ABCDE...XYZabcde...xyz0123456789+/"</span></span>;</code> </pre> <br>  Et le second: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>[<span class="hljs-string"><span class="hljs-string">"btoa"</span></span>])<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>[<span class="hljs-string"><span class="hljs-string">"btoa"</span></span>]=_0x386a89;</code> </pre> <br>  Vous ne pouvez plus inverser et passer √† d'autres fonctions plus importantes ou, pour √™tre plus pr√©cis, √† une fonction qui fonctionne avec les cookies.  Je l'ai trouv√© sur la ligne <b>incap_ses_</b> et <b>j'ai</b> remarqu√© une autre puce d'obfuscation - obfuscation de code √† l'aide de boucles: <br><br><div class="spoiler">  <b class="spoiler_title">Afficher le code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x290283=<span class="hljs-string"><span class="hljs-string">"4|2|5|0|3|1"</span></span>[<span class="hljs-string"><span class="hljs-string">"split"</span></span>](<span class="hljs-string"><span class="hljs-string">'|'</span></span>), _0x290611=<span class="hljs-number"><span class="hljs-number">0x0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!![]){ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(_0x290283[_0x290611++]){ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'0'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;CookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>];n++){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x27e53a=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](<span class="hljs-number"><span class="hljs-number">0x0</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x4b4644=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)+<span class="hljs-number"><span class="hljs-number">0x1</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"length"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_0x5ebd6a[<span class="hljs-string"><span class="hljs-string">"test"</span></span>](_0x27e53a)){ResultCookieArray[ResultCookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>]]=_0x4b4644;} } <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'1'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResultCookieArray;<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'2'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x5ebd6a=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.RegExp(<span class="hljs-string"><span class="hljs-string">"^\s?incap_ses_"</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'3'</span></span>:_0x4d5690();<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'4'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ResultCookieArray=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.Array();<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'5'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CookieArray=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.document.cookie[<span class="hljs-string"><span class="hljs-string">"split"</span></span>](<span class="hljs-string"><span class="hljs-string">';'</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br></div></div><br>  Ici, tout est tr√®s simple: nous r√©organisons les lignes selon l'ordre d'ex√©cution: 4 | 2 | 5 | 0 | 3 | 1 et obtenons la fonction d'origine.  Cette m√©thode de d√©sobfuscation n'est √©galement pas n√©cessaire dans la version finale, mais elle n'a pas caus√© de gros probl√®mes, tout est analys√© de mani√®re √©l√©mentaire, la principale chose √† consid√©rer est qu'il peut y avoir des boucles imbriqu√©es et donc je viens de faire une recherche r√©cursive. <br><br><div class="spoiler">  <b class="spoiler_title">Fonction cookies</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x30fe16={ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x2829d5</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ResultCookieArray=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.Array(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x5ebd6a=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.RegExp(<span class="hljs-string"><span class="hljs-string">"^\s?incap_ses_"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CookieArray=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.document.cookie[<span class="hljs-string"><span class="hljs-string">"split"</span></span>](<span class="hljs-string"><span class="hljs-string">';'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;CookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>];n++){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x27e53a=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](<span class="hljs-number"><span class="hljs-number">0x0</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x4b4644=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)+<span class="hljs-number"><span class="hljs-number">0x1</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"length"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_0x5ebd6a[<span class="hljs-string"><span class="hljs-string">"test"</span></span>](_0x27e53a)){ResultCookieArray[ResultCookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>]]=_0x4b4644;} } _0x4d5690(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResultCookieArray; }</code> </pre></div></div><br>  Il <b>stocke</b> simplement <b>les</b> valeurs de tous les cookies qui commencent par <b>incap_ses_</b> dans un <b>tableau</b> , puis une autre m√©thode calcule leur somme de contr√¥le simplement en additionnant les codes ASCII: <br><br><div class="spoiler">  <b class="spoiler_title">Afficher le code</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TIncapsula</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CharCRC</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i, crc:integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> crc:=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i:=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Length(text) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> crc:=crc+ord(text[i]); result:=IntToStr(crc); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TIncapsula</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCookieDigest</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i:integer; res:<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> res:=<span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i:=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> FCookies.Count-<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> res=<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> res:=CharCRC(browserinfo+FCookies[i]) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> res:=res+<span class="hljs-string"><span class="hljs-string">','</span></span>+CharCRC(browserinfo+FCookies[i]); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; result:=res; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br></div></div><br>  Nous aurons besoin d'une somme de contr√¥le un peu plus loin, et voyons maintenant quel type de fonction ce _0x4d5690 est appel√© √† partir de diff√©rents endroits.  Pour ce faire, il suffit de regarder les m√©thodes appel√©es et de leur attribuer les noms appropri√©s: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckDebugger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.Date()[<span class="hljs-string"><span class="hljs-string">"getTime"</span></span>]() - RunTime) &gt; <span class="hljs-number"><span class="hljs-number">0x1f4</span></span>){ FuckDebugger(); } }</code> </pre> <br>  L'auteur de ce script est tr√®s na√Øf :) <br><br>  Un autre point important: <br><br><pre> <code class="javascript hljs">ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x65'</span></span>, <span class="hljs-string"><span class="hljs-string">'\x55\xa9\xf9\x1c\x1a\xd5\xfc\x60'</span></span>) <span class="hljs-comment"><span class="hljs-comment">//result = "ca3XP6zjTSB3w3gEwMl6lqgsdEVDTV9aF4rEDQ==";</span></span></code> </pre><br>  De l√†, nous avons besoin des 5 premi√®res lettres: <b>ca3XP</b> , je vais vous expliquer pourquoi ci-dessous.  Et rappelez-vous, nous calculions les sommes de contr√¥le √† partir des valeurs des cookies?  Maintenant, nous en avons besoin pour obtenir le soi-disant hachage. <br><br><div class="spoiler">  <b class="spoiler_title">Fonction de hachage</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TIncapsula</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDigestHash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Digest: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i:integer; CookieDigest, res:<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> CookieDigest:=GetCookieDigest; <span class="hljs-comment"><span class="hljs-comment">//85530,85722 res:=''; for i:=0 to Length(Digest)-1 do begin res:=res+IntToHex(ord(Digest[i+1]) + ord(CookieDigest[i mod Length(CookieDigest)+1]),1); end; result:=res; end;</span></span></code> </pre><br></div></div><br>  Comparez: <br><br><img src="https://habrastorage.org/webt/fy/qf/3y/fyqf3yx_4fy1vrfubc8z3zl5rqi.png"><br><br>  Super!  La derni√®re √©tape reste - recevoir des cookies pour la r√©ponse: <br><br><pre> <code class="javascript hljs">ResCooka=((((ParamDecryptor(btoa(PluginsInfo),<span class="hljs-string"><span class="hljs-string">"ca3XP"</span></span>)+<span class="hljs-string"><span class="hljs-string">",digest="</span></span>)+DigestArray)+<span class="hljs-string"><span class="hljs-string">",s="</span></span>)+AllDigestHash); Set_Cookies(<span class="hljs-string"><span class="hljs-string">"___utmvc"</span></span>,btoa(ResCooka),<span class="hljs-number"><span class="hljs-number">0x14</span></span>);</code> </pre> <br>  Le code d'origine au d√©but a ajout√© les param√®tres du navigateur encod√©s en base64 √† la fin du tableau AllParams d√©cal√©, les a ¬´chiffr√©s¬ª avec la fonction ParamDecryptor avec la cl√© <b>ca3XP</b> , puis supprim√© l'√©l√©ment ajout√© pr√©c√©demment.  Je peux supposer que cette b√©quille a √©t√© faite √† cause d'une petite fonctionnalit√©: la fonction ParamDecryptor accepte l'index de l'√©l√©ment dans le tableau et la cl√©, ce qui signifie que vous ne pouvez y transf√©rer la cha√Æne que via le tableau.  Pourquoi ne pas le faire correctement?  Programmeurs, monsieur. <br><br>  Eh bien, en fait tout, le cookie est pr√™t, il reste √† l'installer et √† envoyer une demande.  Certes, vous ne l'accepterez pas √† cause d'un petit d√©tail sur lequel je pr√©f√®re rester silencieux. <br><br><h4>  Optimisation </h4><br>  Des morceaux de code dans Delphi ne sont qu'un prototype.  Tout le code du d√©sobfuscateur a √©t√© r√©√©crit dans l'assembleur en raison des exigences du client et sa vitesse d'ex√©cution a √©t√© augment√©e plusieurs fois.  Les √©l√©ments suivants ont √©galement eu un effet positif sur la vitesse: <br><br><ol><li>  Couper les morceaux de code et les tableaux en exc√®s en une seule it√©ration de la boucle.  Cela est n√©cessaire pour r√©duire consid√©rablement la quantit√© de code et acc√©l√©rer la recherche √† l'avenir. </li><li>  √âtant donn√© que les fonctions du code ne sont pas mixtes, nous connaissons leur emplacement approximatif.Par cons√©quent, si la fonction d'installation des cookies est √† la toute fin, vous devez la rechercher au moins √† partir du milieu. </li><li>  Recherchez √† l'avance les fonctionnalit√©s cl√©s.  L'algorithme assembleur les recherche m√™me au moment de nettoyer le code des ordures inutiles. </li><li>  Dans la version finale, je me suis d√©barrass√© d'environ la moiti√© des fonctions du d√©obfuscateur qui √©taient n√©cessaires pour comprendre le code et qui n'√©taient pas n√©cessaires pour le bot car les param√®tres n√©cessaires se sont d√©roul√©s sans probl√®me </li></ol><br><h4>  Conclusion </h4><br>  Lorsque je visite le site, je souhaite qu'il fonctionne rapidement et que le brouillage des scripts JS √† l'aide de cette m√©thode est irrespectueux pour l'utilisateur.  Est-ce que cela aide √† prot√©ger contre les robots?  Non, bien s√ªr, comme vous pouvez le voir, cela co√ªte litt√©ralement au cours de la soir√©e, et seulement quelques sandwichs et quelques tasses de th√© sont le co√ªt. <br><br>  Le but de cet article est de parler du principe de fonctionnement de cette solution et de montrer √† quel point elle est inutile.  Pour des raisons √©videntes, un module pr√™t √† l'emploi pour contourner cette protection ne sera pas publi√© (apr√®s sa fuite, le pauvre game-stop est pass√© √† akamai), qui doit le faire lui-m√™me sur la base de cette √©tude (qui a √©t√© r√©alis√©e il y a environ un an et qui est toujours d'actualit√©), et les √©tudiants qui le souhaitent pour tordre les comptes des autres, allez dans la for√™t.  Si vous avez des questions, je suis toujours pr√™t √† y r√©pondre dans les commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429662/">https://habr.com/ru/post/fr429662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429648/index.html">DNS sur TLS et sur HTTPS maintenant sur iOS / Android et tous les r√©seaux √† la fois [Merci Cloudflare]</a></li>
<li><a href="../fr429652/index.html">Webinaire ouvert "Recrutement en informatique: de l'application √† l'offre"</a></li>
<li><a href="../fr429654/index.html">Am√©liorer la gestion de projet</a></li>
<li><a href="../fr429656/index.html">L'intelligence artificielle se trompe √©galement. Comme Amazon Go nous raccourcit aux √âtats-Unis - un magasin du futur sans caissiers ni vendeurs</a></li>
<li><a href="../fr429658/index.html">Internet par satellite SpaceX Starlink - ¬´Licence d'impression d'argent¬ª</a></li>
<li><a href="../fr429668/index.html">Google PageSpeed ‚Äã‚ÄãInsights a radicalement mis √† jour, qu'est-ce qui va changer?</a></li>
<li><a href="../fr429670/index.html">Script Java! = JavaScript. Cinq javas dans une classe. Nous √©crivons pour nous souvenir pour toujours</a></li>
<li><a href="../fr429676/index.html">Sauvegarde sur bande</a></li>
<li><a href="../fr429678/index.html">Comment nous avons traduit 10 millions de lignes de code C ++ au standard C ++ 14 (puis au C ++ 17)</a></li>
<li><a href="../fr429680/index.html">Cours MIT "S√©curit√© des syst√®mes informatiques". Conf√©rence 17: Authentification des utilisateurs, partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>