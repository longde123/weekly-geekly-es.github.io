<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌆 👐🏼 🚛 Security Week 18: l'attaque de ShadowHammer en détail 👩🏻‍🎤 😂 🤱🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fin mars, Motherboard a publié un article sur un piratage potentiel de l'infrastructure d'Asus. Après avoir obtenu un accès partiel aux ressources de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Security Week 18: l'attaque de ShadowHammer en détail</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/kaspersky/blog/450150/">  Fin mars, Motherboard a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publié</a> un article sur un piratage potentiel de l'infrastructure d'Asus.  Après avoir obtenu un accès partiel aux ressources de l'entreprise, les attaquants ont pu distribuer aux clients qui ont installé l'utilitaire Asus Live Update pour le téléchargement rapide de nouveaux pilotes une version du programme signée avec un certificat officiel avec des fonctionnalités malveillantes.  À propos de cette attaque, découverte par des experts de Kaspersky Lab, nous avons écrit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">début avril</a> . <br><br><img src="https://habrastorage.org/webt/57/ig/oh/57igoh6kswygqz8ulrt6egyrraq.png"><br>  Le 23 avril, Kaspersky Lab a publié un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport détaillé</a> sur ShadowHammer.  Ce document très fascinant, bien que complètement technique, est recommandé pour une lecture dans son intégralité, et dans cet article, il n'y aura qu'une brève description de certaines des découvertes.  La chose la plus intéressante est la connexion potentielle de ShadowHammer avec des copies infectées de pas le meilleur jeu informatique sur les zombies et une attaque coordonnée contre les développeurs de logiciels. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pw/ni/ro/pwniron9btesdogauxvypa7hph4.png"></div><br>  Au total, les experts de Kaspersky Lab ont trouvé 230 échantillons d'un utilitaire infecté pour mettre à jour les pilotes sur les appareils Asus.  Dans tous les cas, sa version originale est datée de 2015, mais plus tard au cours de l'attaque, la méthode d'injection de son propre code exécutable a été modifiée - très probablement pour éviter plus efficacement la détection: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ya/8z/ua/ya8zua8ribf9uwtf9eaxijbydbq.png"></div><br>  La méthode d'introduction de code malveillant a été modifiée entre juillet et décembre 2018.  La date de début de l'attaque n'est pas connue de manière fiable, mais a été découverte en janvier 2019.  Le moyen le plus efficace pour infecter les ordinateurs des utilisateurs et passer inaperçu était d'utiliser des certificats légitimes Asus, qui étaient également utilisés pour signer des utilitaires inoffensifs «officiels» émis par cette société. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/4e/tq/dm4etqyhonkswafn1habxvuzwbq.png"></div><br>  La capture d'écran ci-dessus montre un exemple d'un utilitaire Asus légitime signé avec le même certificat que la version malveillante d'Asus Live Update.  La date de signature est mars 2019, après que le vendeur a reçu des informations sur l'attaque et les certificats utilisés.  Les opérateurs de la campagne ont dû changer la signature numérique des fichiers exécutables modifiés au cours du processus, car le premier certificat volé a expiré en août 2018. <br><br>  À en juger par l'utilisation de l'ancienne version du programme légitime et les différences dans la signature numérique du logiciel officiel et modifié, les organisateurs de l'attaque avaient un accès limité aux ressources internes du vendeur.  Par exemple, il était possible de pirater l'ordinateur de l'un des développeurs, de voler des certificats, mais pas le code source réel de l'utilitaire.  De plus, les attaquants ont eu accès à l'infrastructure pour la livraison de versions mises à jour de l'utilitaire afin de propager la modification malveillante. <br><br>  Une caractéristique clé d'une attaque ShadowHammer est le nombre limité de cibles d'attaque.  Il y a eu beaucoup de victimes potentielles: une version malveillante d'Asus Live Update n'a été détectée que par les outils de Kaspersky Lab chez 57 000 utilisateurs.  Le nombre réel de victimes pourrait être encore plus élevé, mais sur la plupart des ordinateurs, le malware ne faisait rien de clairement illégal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ak/ib/zg/akibzgzr4uep-uafngvrdg5pcxy.png"></div><br>  Dans tous les cas, l'utilitaire modifié a collecté des données sur les adresses MAC de toutes les cartes réseau disponibles et a comparé leurs hachages MD5 avec sa propre liste.  Ce n'est que si l'une des adresses MAC de la liste a été trouvée que la commande a contacté le serveur à partir duquel un autre fichier exécutable a été téléchargé.  Le nombre d'adresses diffère d'un échantillon à l'autre: la liste la plus courte comprend huit adresses MAC, les plus longues sont 307. Au total, plus de 600 identifiants de périphériques réseau ont été identifiés par lesquels les attaquants ont trouvé des systèmes d'intérêt.  Vérifiez vos propres adresses MAC pour la présence dans cette liste <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g7/ln/jl/g7lnjlsldqk8nttka3syzrh9kzs.png"></div><br>  Il est logique que la plupart des adresses MAC de la liste concernent des appareils fabriqués par Asus lui-même.  Mais il existe des adresses couvrant un grand nombre d'utilisateurs, par exemple 00-50-56-C0-00-08 - l'identifiant de la carte réseau virtuelle VMWare.  Cependant, cette coïncidence n'a pas toujours conduit au développement d'une attaque: elle n'a commencé que si l'adresse MAC de la carte réseau physique correspondait également à celle requise. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vb/b-/8p/vbb-8pbj0nb2ilsbjjk-t2j5w0u.png"></div><br>  À quoi cela ressemblait dans la pratique, montre une capture d'écran de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">discussion</a> sur Reddit.  Un utilisateur avec l'utilitaire Asus Live Update installé reçoit une notification concernant une «mise à jour critique», et il est suggéré de télécharger le programme il y a trois ans.  Ce n'est pas un fait que cette discussion porte sur cette attaque particulière (puisqu'il n'y a pas d'identifiant de fichier), mais à en juger par la date de construction du binaire, c'était elle.  Étant donné que la recherche de mentions n'a donné que deux rapports de problèmes potentiels (le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">second n'était</a> pas lié à ShadowHammer à coup sûr), nous pouvons dire que l'attaque est passée inaperçue, malgré un nombre assez élevé de victimes potentielles. <br><br>  Ce qui est arrivé à ceux dont l'adresse MAC figurait sur la liste est inconnu.  Au moment où l'attaque a été détectée en janvier 2019, le serveur de commande était éteint et, jusqu'à présent, les chercheurs n'ont pas pu obtenir de fichiers exécutables téléchargés sur les ordinateurs de vraies victimes. <br><br>  <b>Lien vers d'autres attaques</b> <br>  Et ici, des <i>zombies font</i> irruption dans le poste! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/yp/7a/bbyp7abweayvpbt9vwzxnknv6wk.jpeg"></div><br>  En mars 2019, les experts d'ESET ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">examiné</a> les versions infectées du jeu Infestation: Survivor Stories.  Compte tenu du thème du jeu, cela en soi ressemble à une blague, mais la situation pour le développeur (utilisant probablement les sources du jeu The War Z précédent) n'est pas la plus amusante.  Très probablement, le code malveillant est apparu dans les versions officielles après que les ordinateurs des développeurs aient été compromis.  Dans ce cas, et dans quelques autres incidents liés à des attaques contre des studios de jeux, une méthode similaire à ShadowHammer a été utilisée pour injecter du code malveillant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ta/lk/m4/talkm4605legkwattoemlahih3u.png"></div><br>  D'accord, ce n'est pas une preuve fiable du lien entre les deux incidents.  Mais il y a une coïncidence dans les algorithmes de hachage utilisés pour les données collectées sur les ordinateurs des victimes, et quelques autres caractéristiques techniques communes des attaques.  À en juger par les lignes du code malveillant, on peut supposer que les sources du jeu War Z précédent pourraient être distribuées comme une sorte de cheval de Troie pour les développeurs de jeux qui souhaitent les utiliser.  Les experts de Kaspersky Lab ont également trouvé des signes de réutilisation d'algorithmes de ShadowHammer dans la porte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dérobée</a> PlugX, très probablement développée en Chine. <br><br>  Cette connexion potentielle entre différentes attaques donne à l'histoire de ShadowHammer une nouvelle dimension et constitue un avertissement pour les développeurs.  Les programmeurs peuvent devenir des distributeurs involontaires de code malveillant grâce aux actions coordonnées et cohérentes des attaquants.  De plus, différents outils «d'implémentation» peuvent être utilisés: vol de certificat, inclusion de code malveillant dans les sources, injection dans des fichiers exécutables (par exemple, avant envoi au client).  À en juger par le nombre de zones blanches dans cette enquête et d'autres, les attaquants ont réussi à infiltrer l'infrastructure des développeurs de logiciels, à diffuser le code malveillant à un grand nombre de victimes, tout en sélectionnant soigneusement les cibles afin qu'elles passent inaperçues pendant au moins plusieurs mois (comme c'est le cas avec ShadowHammer) . <br><br>  <i>Avis de non-responsabilité: les opinions exprimées dans ce recueil ne coïncident pas toujours avec la position officielle de Kaspersky Lab.</i>  <i>Chers rédacteurs recommandent généralement de traiter toute opinion avec un scepticisme sain.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450150/">https://habr.com/ru/post/fr450150/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450140/index.html">CAN Driving</a></li>
<li><a href="../fr450142/index.html">En mai: ordonné - de survivre</a></li>
<li><a href="../fr450144/index.html">Comment les nouvelles technologies rapprochent-elles le rêve de l'immortalité?</a></li>
<li><a href="../fr450146/index.html">Mon erreur d'un milliard de dollars</a></li>
<li><a href="../fr450148/index.html">Un Veeam ONE. Renseignements, cartes, agents et bien plus encore - aujourd'hui sur les écrans du pays</a></li>
<li><a href="../fr450152/index.html">Optimisation SEO des fiches produits: instructions pas à pas + hacks de vie</a></li>
<li><a href="../fr450154/index.html">PlayStation nouvelle génération: qu'y a-t-il à l'intérieur?</a></li>
<li><a href="../fr450156/index.html">100GbE: luxe ou besoin immédiat?</a></li>
<li><a href="../fr450158/index.html">Le ravisseur du ROM est-il allé trop loin pour préserver l'héritage d'Atari?</a></li>
<li><a href="../fr450160/index.html">Windows 10 version 1903 - minimum 32 Go d'espace disque</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>