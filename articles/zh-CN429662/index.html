<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§›ğŸ» ğŸ‘©ğŸ½â€ğŸ“ ğŸ•¹ï¸ æˆ‘ä»¬çªç ´äº†æœºå™¨äººçš„ä¿æŠ¤ ğŸ‘¶ğŸ» ğŸ™ğŸ½ ğŸ‚ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ€è¿‘ï¼Œ incapsulaå·²å¼€å§‹å‡ºç°åœ¨è®¸å¤šå¤–å›½ç«™ç‚¹ä¸Šï¼Œè¯¥ç³»ç»Ÿæé«˜äº†ç«™ç‚¹çš„å®‰å…¨æ€§ï¼Œå·¥ä½œé€Ÿåº¦ï¼ŒåŒæ—¶åˆå¤§å¤§å¢åŠ äº†è½¯ä»¶å¼€å‘äººå‘˜çš„ç”Ÿå‘½ã€‚ è¯¥ç³»ç»Ÿçš„æœ¬è´¨æ˜¯ä½¿ç”¨JavaScriptçš„å…¨é¢ä¿æŠ¤ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè®¸å¤šDDOSæœºå™¨äººå·²ç»å­¦ä¼šäº†æ‰§è¡Œç”šè‡³ç»•è¿‡CloudFlareã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å°è£…ï¼Œç¼–å†™JSè„šæœ¬åæ··æ·†å™¨ï¼Œå¹¶...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬çªç ´äº†æœºå™¨äººçš„ä¿æŠ¤</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429662/"><img src="https://habrastorage.org/webt/kg/it/oe/kgitoeky0eoigux3dhyyhtj9hdy.jpeg"><br><br> æœ€è¿‘ï¼Œ <b>incapsula</b>å·²å¼€å§‹å‡ºç°åœ¨è®¸å¤šå¤–å›½ç«™ç‚¹ä¸Šï¼Œè¯¥ç³»ç»Ÿæé«˜äº†ç«™ç‚¹çš„å®‰å…¨æ€§ï¼Œå·¥ä½œé€Ÿåº¦ï¼ŒåŒæ—¶åˆå¤§å¤§å¢åŠ äº†è½¯ä»¶å¼€å‘äººå‘˜çš„ç”Ÿå‘½ã€‚ è¯¥ç³»ç»Ÿçš„æœ¬è´¨æ˜¯ä½¿ç”¨JavaScriptçš„å…¨é¢ä¿æŠ¤ï¼Œé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè®¸å¤šDDOSæœºå™¨äººå·²ç»å­¦ä¼šäº†æ‰§è¡Œç”šè‡³ç»•è¿‡CloudFlareã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å°è£…ï¼Œç¼–å†™JSè„šæœ¬åæ··æ·†å™¨ï¼Œå¹¶æ•™æˆ‘ä»¬çš„<s>DDOS</s>æœºå™¨äººå¦‚ä½•è§£å†³å®ƒï¼ <br><a name="habracut"></a><br> ä¸‹é¢çš„å±å¹•å¿«ç…§ä¸­çš„ç½‘ç«™æ˜¯ä½œä¸ºæ–‡ç« çš„ä¸€ä¸ªå¾ˆå¥½çš„ç¤ºä¾‹ï¼Œåœ¨å¯ç–‘ä¸»é¢˜çš„è®ºå›ä¸Šï¼Œä¸å…¶ä»–ç½‘ç«™å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œè®¸å¤šäººæ­£åœ¨ä¸ºä¹‹å¯»æ‰¾æš´åŠ›æ‰‹æ®µï¼Œä½†æ˜¯æˆ‘è¿˜æœ‰å¦å¤–ä¸€é¡¹ä»»åŠ¡-ç”¨äºè‡ªåŠ¨æ‰§è¡Œç½‘ç«™å„ç§åŠ¨ä½œçš„è½¯ä»¶ã€‚ <br><br> è®©æˆ‘ä»¬ä»æ£€æŸ¥æŸ¥è¯¢å¼€å§‹ï¼Œå› ä¸ºåªæœ‰ä¸¤ä¸ªæŸ¥è¯¢ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªæŸ¥è¯¢ï¼š <br><br><img src="https://habrastorage.org/webt/fq/ny/wq/fqnywqsbrzm9ffvjux0t0onl_f0.png"><br><br> æ­¤è¯·æ±‚å°†åŠ è½½ä¸€ä¸ªè‡ªç„¶æ··æ·†çš„è„šæœ¬ï¼š <br><br><img src="https://habrastorage.org/webt/ts/am/ln/tsamlnznbd7aoj5olinfx0vhab8.png"><br><br> å°†evalæ›´æ”¹ä¸º<b>document.writeï¼ˆï¼‰å¯ä»¥</b>ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ï¼š <br><br><img src="https://habrastorage.org/webt/dg/bx/qy/dgbxqyaozcow_dfee1vujsaxqd8.png"><br><br> æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯ç”¨äºæ ¼å¼åŒ–è¾“å‡ºä»£ç çš„è‡ªåŠ¨å·¥å…·ç ´åäº†æ­¤ä»£ç ï¼Œå› æ­¤æˆ‘ä¸å¾—ä¸ç”¨æ‰‹å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œå¹¶ä¸ºå˜é‡æŒ‡å®šæ™®é€šåç§°ã€‚ å¯¹äºæ‰€æœ‰è¿™äº›æ“ä½œï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„è®°äº‹æœ¬++å’Œä¸€ä¸ªæ–‡æœ¬æ›¿æ¢åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›è¡Œç¬¬ä¸€è¡Œçš„æ£€æŸ¥ï¼š <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x3a59=[<span class="hljs-string"><span class="hljs-string">'wpgXPQ=='</span></span>,<span class="hljs-string"><span class="hljs-string">'cVjDjw=='</span></span>,<span class="hljs-string"><span class="hljs-string">'Tk/DrFl/'</span></span>,<span class="hljs-string"><span class="hljs-string">'GMOMd8K2w4jCpw=='</span></span>,<span class="hljs-string"><span class="hljs-string">'wpkwwpE='</span></span>,<span class="hljs-string"><span class="hljs-string">'w6zDmmrClMKVHA=='</span></span>, ... ,<span class="hljs-string"><span class="hljs-string">'w4w+w5MGBQI='</span></span>,<span class="hljs-string"><span class="hljs-string">'w6TDr8Obw6TDlTJQaQ=='</span></span>];</code> </pre> <br> è¿™æ˜¯ä¸€ä¸ªåŒ…å«åŠ å¯†å‡½æ•°åç§°å’Œå…¶ä»–å­—ç¬¦ä¸²çš„æ•°ç»„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªè§£å¯†è¯¥æ•°ç»„çš„å‡½æ•°ï¼Œæ— éœ€èµ°å¤ªè¿œï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ··æ·†ä»£ç </b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Decrypt=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">base64_Encoded_Param,Key_Param</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CounterArray=[], CRC=<span class="hljs-number"><span class="hljs-number">0x0</span></span>, TempVar, result=<span class="hljs-string"><span class="hljs-string">''</span></span>, EncodedSTR=<span class="hljs-string"><span class="hljs-string">''</span></span>; base64_Encoded_Param=atob(base64_Encoded_Param); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0</span></span>,input_length=base64_Encoded_Param.length;n&lt;input_length;n++){ EncodedSTR+=<span class="hljs-string"><span class="hljs-string">'%'</span></span>+(<span class="hljs-string"><span class="hljs-string">'00'</span></span>+base64_Encoded_Param.charCodeAt(n).toString(<span class="hljs-number"><span class="hljs-number">0x10</span></span>)).slice(<span class="hljs-number"><span class="hljs-number">-0x2</span></span>); } base64_Encoded_Param=<span class="hljs-built_in"><span class="hljs-built_in">decodeURIComponent</span></span>(EncodedSTR); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;<span class="hljs-number"><span class="hljs-number">0x100</span></span>;n++){ CounterArray[n]=n; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;<span class="hljs-number"><span class="hljs-number">0x100</span></span>;n++){ CRC=(CRC+CounterArray[n]+Key_Param.charCodeAt(n%Key_Param.length))%<span class="hljs-number"><span class="hljs-number">0x100</span></span>; TempVar=CounterArray[n]; CounterArray[n]=CounterArray[CRC]; CounterArray[CRC]=TempVar; } n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>; CRC=<span class="hljs-number"><span class="hljs-number">0x0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;i&lt;base64_Encoded_Param.length;i++){ n=(n+<span class="hljs-number"><span class="hljs-number">0x1</span></span>)%<span class="hljs-number"><span class="hljs-number">0x100</span></span>; CRC=(CRC+CounterArray[n])%<span class="hljs-number"><span class="hljs-number">0x100</span></span>; TempVar=CounterArray[n]; CounterArray[n]=CounterArray[CRC]; CounterArray[CRC]=TempVar; result+=<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCharCode(base64_Encoded_Param.charCodeAt(i)^CounterArray[(CounterArray[n]+CounterArray[CRC])%<span class="hljs-number"><span class="hljs-number">0x100</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; };</code> </pre> <br></div></div><br> å¦‚æœæˆ‘ä»¬å•ç‹¬è°ƒç”¨å®ƒï¼š <br><br><pre> <code class="javascript hljs">ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0Et]'</span></span>)</code> </pre> <br> è¿™ä¸ªç»“æœå°†è¿œè¿œè¶…å‡ºæˆ‘ä»¬çš„é¢„æœŸã€‚ å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯è¦æ€ªï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shift_array=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">number_of_shifts</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(--number_of_shifts){ EncodedParams[<span class="hljs-string"><span class="hljs-string">'push'</span></span>](EncodedParams[<span class="hljs-string"><span class="hljs-string">'shift'</span></span>]()); } };</code> </pre><br> è¿™æ˜¯åœ¨ä¸€ä¸ªéå¸¸æ„å¤–çš„åœ°æ–¹-åœ¨å¼€å§‹æ—¶å°±è°ƒç”¨çš„å‡½æ•°ï¼Œå¹¶æ£€æŸ¥cookieã€‚ æ˜¾ç„¶ï¼Œå¼€å‘äººå‘˜å› æ­¤â€œä¿æŠ¤â€äº†cookieæ”¯ç¥¨å…äºè¢«åˆ‡æ‰ã€‚ å¦‚æ‚¨æ‰€è§-æ²¡ä»€ä¹ˆå¤æ‚çš„ï¼Œå¾ªç¯ä»…å°†æ•°ç»„ç§»åŠ¨æŒ‡å®šæ•°é‡çš„å…ƒç´ ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º223ä¸ªå…ƒç´ ã€‚ è¿™ä¸ªé­”æœ¯æ•°å­—223æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿ æˆ‘ä»è°ƒç”¨CookieéªŒè¯åŠŸèƒ½çš„ç”µè¯ä¸­è·å¾—äº†è¿™ä¸ªæ•°å­—ï¼Œå®ƒçœ‹èµ·æ¥åƒ0xdfå¹¶éµå¾ªä»¥ä¸‹è·¯çº¿ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  function(EncodedParams,EncodedParamsShifts); //  (AllParams,0xdf); //0xdf =&gt; 223 //    var _0x5e622e=function(_0x486a40,_0x1de600){_0x486a40(++_0x1de600);}; _0x5e622e(shift_array,EncodedParamsShifts); //     : shift_array(++EncodedParamsShifts);</span></span></code> </pre><br> è‡ªç„¶ï¼Œå®ƒæ¯æ¬¡éƒ½ä¼šæ”¹å˜ï¼Œè°ä¼šæ€€ç–‘... <br><br> ç°åœ¨å‰©ä¸‹çš„å°±æ˜¯æ›¿æ¢æ‰€æœ‰ç”µè¯ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x85e545=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0Et]'</span></span>)];</code> </pre> <br> åœ¨ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x85e545=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-string"><span class="hljs-string">'window'</span></span>];</code> </pre> <br> æˆ–è€…ï¼Œæ›´å¥½çš„æ˜¯ï¼Œ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ThisWindow=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window;</code> </pre> <br> æˆ‘æŒ‰å¸¸è§„è¿›è¡Œäº†æœ€åä¸€æ¬¡è½¬æ¢ã€‚ å“¦ï¼Œæ˜¯çš„ï¼Œä»–ä»¬å®Œå…¨å¿˜è®°äº†ä»¥ä¸‹å‡ è¡Œï¼š <br><br> <code>\x77\x6f\x4a\x33\x58\x68\x6b\x59\x77\x34\x44\x44\x6e\x78\x64\x70</code> <br> <br> åˆ°æ™®é€šè§†å›¾ã€‚ æ²¡ä»€ä¹ˆå¤æ‚çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸è§„çš„UrlEncodeï¼Œå°†\ xæ›´æ”¹ä¸ºï¼…å¹¶è§£ç ä»¥å¾—åˆ°ä»¥ä¸‹è¡Œï¼š <br><br> <code>woJ3XhkYw4DDnxdp</code> <br> <br> ç„¶åæˆ‘å¼€å§‹æ›¿æ¢æ‰€æœ‰ç”µè¯ <br><br><pre> <code class="javascript hljs">ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0Et]'</span></span>)</code> </pre> <br> ä½¿ç”¨æˆ‘æ¨¡å—ä¸­çš„è‡ªå†™å‡½æ•°å°†å·²è§£å¯†çš„è¡Œå¤åˆ¶åˆ° æ˜¯çš„ï¼Œä»£ç å¹¶æ²¡æœ‰é—ªçƒçš„å…‰èŠ’ï¼Œæˆªæ­¢æ—¥æœŸå¾ˆç´§æ€¥ï¼ˆå°±åƒæ˜¨å¤©é€šå¸¸éœ€è¦çš„é‚£æ ·ï¼‰ï¼Œæˆ‘æ‡’å¾—æ€è€ƒï¼Œ <s>å› ä¸ºæˆ‘æ›¾ç»ä½¿ç”¨é¼ æ ‡ç¼–ç¨‹</s> ï¼Œä½†æ˜¯å®ƒä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼š <br><br><img src="https://habrastorage.org/webt/bc/29/92/bc29921g6sig2pulkkbovpnu88a.png"><br><br> æˆ‘ä»æºä»£ç å‡ ä¹1v1é‡å†™äº†ä»£ç ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œå¦ä¸€ç§æ··æ·†ä»£ç çš„æ–¹æ³•å¼•èµ·äº†æˆ‘çš„æ³¨æ„ã€‚ æˆ‘å¿…é¡»ç¼–å†™ä¸€ä¸ªç›¸å½“å¤§çš„å‡½æ•°æ¥æœç´¢æ­¤ç±»è°ƒç”¨ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'7'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(_0x30fe16[<span class="hljs-string"><span class="hljs-string">"XNg"</span></span>](_0x13d8ee,_0x5a370d))</code> </pre> <br> å¹¶ç”¨æ›´ç®€å•çš„ç±»ä¼¼ç‰©ä»£æ›¿å®ƒä»¬ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å¾ˆæ£’çš„åŠŸèƒ½åˆ—è¡¨</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x30fe16={ <span class="hljs-string"><span class="hljs-string">'XNg'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x19aabd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x425e3c,_0x481cd6</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x425e3c&lt;_0x481cd6;}, <span class="hljs-string"><span class="hljs-string">'sUd'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x320363</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0xa24206,_0x49d66b</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0xa24206&amp;_0x49d66b;}, <span class="hljs-string"><span class="hljs-string">'wMk'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x32974a</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x2cdcf4,_0x250e85</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x2cdcf4&gt;&gt;_0x250e85;}, <span class="hljs-string"><span class="hljs-string">'FnU'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x22ce98</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x2f5577,_0x4feea7</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x2f5577&lt;&lt;_0x4feea7;}, <span class="hljs-string"><span class="hljs-string">'mTe'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x35a8bc</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x11fecf,_0x29718e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x11fecf&amp;_0x29718e;}, <span class="hljs-string"><span class="hljs-string">'doo'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x5ce08b</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x4e5976,_0x4757ea</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x4e5976&gt;&gt;_0x4757ea;}, <span class="hljs-string"><span class="hljs-string">'vmP'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x5d415c</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x39dc96,_0x59022e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x39dc96&lt;&lt;_0x59022e;}, <span class="hljs-string"><span class="hljs-string">'bGL'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0xd49b</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x7e8c9f,_0x301346</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x7e8c9f|_0x301346;}, <span class="hljs-string"><span class="hljs-string">'rXw'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x4dfb4d</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x39d33a,_0x36fd1e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x39d33a&lt;&lt;_0x36fd1e;}, <span class="hljs-string"><span class="hljs-string">'svD'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x387610</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x3cd4f7,_0x58fd9e</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x3cd4f7&amp;_0x58fd9e;}, <span class="hljs-string"><span class="hljs-string">'cuj'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x472c54</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x4e473a,_0x26f3fd</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x4e473a==_0x26f3fd;}, <span class="hljs-string"><span class="hljs-string">'OrY'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x3c6e85</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x445d0b,_0x1caacf</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x445d0b|_0x1caacf;}, <span class="hljs-string"><span class="hljs-string">'AKn'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x4dac5b</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x521c05,_0x27b6bd</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x521c05&gt;&gt;_0x27b6bd;}, <span class="hljs-string"><span class="hljs-string">'gtj'</span></span>:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x5416f0</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x3e0965,_0x560062</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x3e0965&amp;_0x560062;} };</code> </pre> <br></div></div><br> è·å¾—ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'7'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(_0x13d8ee &lt; _0x5a370d){</code> </pre> <br> å·¥ä½œçš„ç®—æ³•éå¸¸ç®€å•ï¼Œå®é™…ä¸Šï¼Œæˆ‘ä»¬åªæ˜¯æ›¿æ¢äº†å˜é‡ï¼š <br><br><ol><li> åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ•°ç»„çš„åç§°ï¼š <b>_0x30fe16</b> </li><li>  Parsimè¾“å…¥å‚æ•°ï¼š <b>_0x425e3cï¼Œ_0x481cd6</b> </li><li>  Parsimå‡½æ•°ä¸»ä½“ï¼š <b>_0x425e3c &lt;_0x481cd6</b> </li><li> å°†<b>_0x425e3c</b>æ›¿æ¢ä¸º<b>_0x13d8ee</b> </li><li> å°†<b>_0x481cd6</b>æ›¿æ¢ä¸º<b>_0x5a370d</b> </li><li> æˆ‘ä»¬<b>å¾—åˆ°</b> ï¼š <b>_0x13d8ee &lt;_0x5a370d</b> </li><li> ç”¨ä¸Šé¢çš„ä»£ç æ›¿æ¢<b>_0x30fe16.XNgï¼ˆ_0x13d8eeï¼Œ_0x5a370dï¼‰</b> </li><li> é‡å¤ç›´åˆ°åŠŸèƒ½ç»“æŸ </li></ol><br> è§£æå‡½æ•°çš„åç§°ï¼Œå‚æ•°å’Œä¸»ä½“æ˜¯ç”±ä¸€ä¸ªå¸¸è§„å‡½æ•°å®Œæˆçš„ã€‚ å½“ç„¶ï¼Œåœ¨æ¨¡å—çš„æœ€ç»ˆç‰ˆæœ¬ä¸­ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸æ˜¯ç‰¹åˆ«éœ€è¦ï¼Œåªæœ‰1ä¸ªè°ƒç”¨ç¨å¾®æ¨¡ç³Šäº†ä¸€äº›ï¼Œä½†æ˜¯å®¢æˆ·è¯´è¦åšæ‰€æœ‰äº‹æƒ…ï¼Œå› æ­¤åšåˆ°äº†ï¼Œæ­¤å¤–ï¼Œå…¶ä»–åŠŸèƒ½ä¹Ÿå˜å¾—æ›´åŠ æ¸…æ™°ã€‚ åœ¨å…¶ä»–ç«™ç‚¹ä¸Šä¹Ÿæœ‰è¿™æ ·çš„è®¾è®¡ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ˜¾ç¤ºå¤§å°å†™é”™è¯¯çš„ä»£ç </b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x4dc9f4 = { <span class="hljs-string"><span class="hljs-string">'NTSjj'</span></span>: _0x3d6e1f.dEVDh, <span class="hljs-string"><span class="hljs-string">'tZeHx'</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0x2a40cd, _0x2faf22</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _0x3d6e1f.JIehC(_0x2a40cd, _0x2faf22); }, <span class="hljs-string"><span class="hljs-string">'ocgoO'</span></span>: <span class="hljs-string"><span class="hljs-string">"https://site/login"</span></span>, <span class="hljs-string"><span class="hljs-string">'WmiOO'</span></span>: _0x3d6e1f.vsCuf }; <span class="hljs-comment"><span class="hljs-comment">//    ,      : var _0x3d6e1f = { 'dEVDh': "4|0|2|3|5|1", 'JIehC': function(_0x34757f, _0xd344e8) { return _0x34757f != _0xd344e8; }, 'vsCuf': ".countdownGroup", 'awUzV': function(_0x4b3914, _0x1f9e41) { return _0x4b3914 === _0x1f9e41; }, 'smOkd': "NSpHE", 'bvCub': function(_0x208c1d, _0x160d32) { return _0x208c1d(_0x160d32); }, 'PmBNl': function(_0x33524f, _0x29b35a) { return _0x33524f(_0x29b35a); }, 'Fhbrr': "#stopBtn", 'Vkpkf': function(_0x2de6ac, _0x31bb8b) { return _0x2de6ac + _0x31bb8b; }, 'HbSaV': function(_0x429822, _0x1a46e9) { return _0x429822 + _0x1a46e9; }, 'UsdKM': "https://site/register", 'JCXqh': "Timer started. ", 'GBXqx': function(_0x18f912, _0x5829b5) { return _0x18f912 / _0x5829b5; }, 'sSdZf': function(_0x45f64c, _0x152cb4) { return _0x45f64c(_0x152cb4); }, 'AAmKj': ".countdownTimer" };</span></span></code> </pre> </div></div><br> å¦‚æ‚¨æ‰€è§ï¼Œä¸€ä¸ªæ•°ç»„ä¸­çš„å‚æ•°å¼•ç”¨äº†å¦ä¸€ä¸ªã€‚ æˆ‘ç®€å•åœ°è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š <br><br><ol><li> è§£ææ‰€æœ‰æ•°ç»„ </li><li> æˆ‘ä»¬ä»ä»£ç ä¸­æ¸…é™¤å®ƒä»¬ </li><li> å°†æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°å…³è”æ•°ç»„ï¼ˆåç§°ï¼Œå€¼ï¼‰ </li><li> åœ¨é€’å½’æœç´¢å¾ªç¯ä¸­ï¼Œæˆ‘ä»¬å¯»æ‰¾æ‰€æœ‰åµŒå¥—å‡½æ•° </li><li> ç”¨åµŒå¥—å‡½æ•°æ›¿æ¢åµŒå¥—å‡½æ•° </li><li> ä»¥ç›¸åŒæ–¹å¼å°†æ‰€æœ‰é“¾æ¥æ‰©å±•åˆ°å­—ç¬¦ä¸² </li></ol><br> åº”ç”¨è¿™ç§å»æ··æ·†æ–¹æ³•åï¼Œä»£ç å˜å¾—æœ‰ç‚¹æ··ä¹±äº†ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ç«‹å³æ³¨æ„åˆ°base64å‡½æ•°ã€‚ ç¬¬ä¸€ä¸ªï¼š <br><br><pre> <code class="javascript hljs">CharArray=<span class="hljs-string"><span class="hljs-string">"ABCDE...XYZabcde...xyz0123456789+/"</span></span>;</code> </pre> <br> ç¬¬äºŒä¸ªï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>[<span class="hljs-string"><span class="hljs-string">"btoa"</span></span>])<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>[<span class="hljs-string"><span class="hljs-string">"btoa"</span></span>]=_0x386a89;</code> </pre> <br> æ‚¨ä¸å†å¯ä»¥æ’¤æ¶ˆå¹¶ç»§ç»­ä½¿ç”¨å…¶ä»–æ›´é‡è¦çš„åŠŸèƒ½ï¼Œæˆ–æ›´ç¡®åˆ‡åœ°è¯´ï¼Œè½¬åˆ°ä½¿ç”¨Cookieçš„åŠŸèƒ½ã€‚ æˆ‘åœ¨<b>incap_ses_</b>è¡Œä¸­æ‰¾åˆ°äº†å®ƒï¼Œå¹¶æ³¨æ„åˆ°äº†å¦ä¸€ä¸ªæ··æ·†èŠ¯ç‰‡-ä½¿ç”¨å¾ªç¯çš„ä»£ç æ··æ·†ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ˜¾ç¤ºä»£ç </b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x290283=<span class="hljs-string"><span class="hljs-string">"4|2|5|0|3|1"</span></span>[<span class="hljs-string"><span class="hljs-string">"split"</span></span>](<span class="hljs-string"><span class="hljs-string">'|'</span></span>), _0x290611=<span class="hljs-number"><span class="hljs-number">0x0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!![]){ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(_0x290283[_0x290611++]){ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'0'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;CookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>];n++){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x27e53a=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](<span class="hljs-number"><span class="hljs-number">0x0</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x4b4644=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)+<span class="hljs-number"><span class="hljs-number">0x1</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"length"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_0x5ebd6a[<span class="hljs-string"><span class="hljs-string">"test"</span></span>](_0x27e53a)){ResultCookieArray[ResultCookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>]]=_0x4b4644;} } <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'1'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResultCookieArray;<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'2'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x5ebd6a=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.RegExp(<span class="hljs-string"><span class="hljs-string">"^\s?incap_ses_"</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'3'</span></span>:_0x4d5690();<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'4'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ResultCookieArray=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.Array();<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span><span class="hljs-string"><span class="hljs-string">'5'</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CookieArray=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.document.cookie[<span class="hljs-string"><span class="hljs-string">"split"</span></span>](<span class="hljs-string"><span class="hljs-string">';'</span></span>);<span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br></div></div><br> ä¸€åˆ‡éƒ½éå¸¸ç®€å•ï¼šæˆ‘ä»¬æŒ‰ç…§æ‰§è¡Œé¡ºåºé‡æ–°æ’åˆ—è¡Œï¼š4 | 2 | 5 | 0 | 3 | 1å¹¶è·å¾—åŸå§‹åŠŸèƒ½ã€‚ åœ¨æœ€ç»ˆç‰ˆæœ¬ä¸­ä¹Ÿä¸éœ€è¦è¿™ç§å»æ··æ·†æ–¹æ³•ï¼Œä½†æ˜¯å®ƒä¸ä¼šå¼•èµ·å¤§é—®é¢˜ï¼Œæ‰€æœ‰å†…å®¹éƒ½ä»¥åŸºæœ¬æ–¹å¼è¿›è¡Œè§£æï¼Œä¸»è¦è¦è€ƒè™‘çš„æ˜¯å¯ä»¥å­˜åœ¨åµŒå¥—å¾ªç¯ï¼Œå› æ­¤æˆ‘åªæ˜¯è¿›è¡Œäº†é€’å½’æœç´¢ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">CookiesåŠŸèƒ½</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x30fe16={ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_0x2829d5</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ResultCookieArray=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.Array(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x5ebd6a=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.RegExp(<span class="hljs-string"><span class="hljs-string">"^\s?incap_ses_"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CookieArray=<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.document.cookie[<span class="hljs-string"><span class="hljs-string">"split"</span></span>](<span class="hljs-string"><span class="hljs-string">';'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n=<span class="hljs-number"><span class="hljs-number">0x0</span></span>;n&lt;CookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>];n++){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x27e53a=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](<span class="hljs-number"><span class="hljs-number">0x0</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _0x4b4644=CookieArray[n][<span class="hljs-string"><span class="hljs-string">"substr"</span></span>](CookieArray[n][<span class="hljs-string"><span class="hljs-string">"indexOf"</span></span>](<span class="hljs-string"><span class="hljs-string">'='</span></span>)+<span class="hljs-number"><span class="hljs-number">0x1</span></span>,CookieArray[n][<span class="hljs-string"><span class="hljs-string">"length"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_0x5ebd6a[<span class="hljs-string"><span class="hljs-string">"test"</span></span>](_0x27e53a)){ResultCookieArray[ResultCookieArray[<span class="hljs-string"><span class="hljs-string">"length"</span></span>]]=_0x4b4644;} } _0x4d5690(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResultCookieArray; }</code> </pre></div></div><br> å®ƒåªæ˜¯å°†ä»¥<b>incap_ses_</b>å¼€å¤´çš„æ‰€æœ‰cookie <b>çš„</b>å€¼<b>å­˜å‚¨</b>åœ¨<b>æ•°ç»„ä¸­</b> ï¼Œç„¶åå¦ä¸€ç§æ–¹æ³•ä»…é€šè¿‡å¯¹ASCIIç æ±‚å’Œæ¥è®¡ç®—å…¶æ ¡éªŒå’Œï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ˜¾ç¤ºä»£ç </b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TIncapsula</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CharCRC</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i, crc:integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> crc:=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i:=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Length(text) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> crc:=crc+ord(text[i]); result:=IntToStr(crc); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TIncapsula</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCookieDigest</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i:integer; res:<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> res:=<span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i:=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> FCookies.Count-<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> res=<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> res:=CharCRC(browserinfo+FCookies[i]) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> res:=res+<span class="hljs-string"><span class="hljs-string">','</span></span>+CharCRC(browserinfo+FCookies[i]); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; result:=res; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br></div></div><br> æˆ‘ä»¬å°†éœ€è¦è¿›ä¸€æ­¥çš„æ ¡éªŒå’Œï¼Œç°åœ¨è®©æˆ‘ä»¬å¼„æ¸…æ¥šä»ä¸åŒä½ç½®è°ƒç”¨æ­¤_0x4d5690æ˜¯ä»€ä¹ˆæ ·çš„åŠŸèƒ½ã€‚ ä¸ºæ­¤ï¼Œåªéœ€æŸ¥çœ‹è¢«è°ƒç”¨çš„æ–¹æ³•å¹¶ä¸ºå®ƒä»¬åˆ†é…é€‚å½“çš„åç§°å³å¯ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckDebugger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.window.Date()[<span class="hljs-string"><span class="hljs-string">"getTime"</span></span>]() - RunTime) &gt; <span class="hljs-number"><span class="hljs-number">0x1f4</span></span>){ FuckDebugger(); } }</code> </pre> <br> è¿™ä¸ªè„šæœ¬çš„ä½œè€…å¾ˆå¤©çœŸ:) <br><br> å¦ä¸€ä¸ªè¦ç‚¹ï¼š <br><br><pre> <code class="javascript hljs">ParamDecryptor(<span class="hljs-string"><span class="hljs-string">'0x65'</span></span>, <span class="hljs-string"><span class="hljs-string">'\x55\xa9\xf9\x1c\x1a\xd5\xfc\x60'</span></span>) <span class="hljs-comment"><span class="hljs-comment">//result = "ca3XP6zjTSB3w3gEwMl6lqgsdEVDTV9aF4rEDQ==";</span></span></code> </pre><br> ä»è¿™é‡Œå¼€å§‹ï¼Œæˆ‘ä»¬éœ€è¦å‰5ä¸ªå­—æ¯ï¼š <b>ca3XP</b> ï¼Œä¸‹é¢æˆ‘å°†å‘Šè¯‰æ‚¨åŸå› ã€‚ è®°ä½ï¼Œæˆ‘ä»¬æ˜¯æ ¹æ®Cookieå€¼è®¡ç®—æ ¡éªŒå’Œçš„ï¼Ÿ ç°åœ¨æˆ‘ä»¬éœ€è¦å®ƒä»¬æ¥è·å–æ‰€è°“çš„å“ˆå¸Œã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å“ˆå¸Œå‡½æ•°</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TIncapsula</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDigestHash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Digest: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i:integer; CookieDigest, res:<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> CookieDigest:=GetCookieDigest; <span class="hljs-comment"><span class="hljs-comment">//85530,85722 res:=''; for i:=0 to Length(Digest)-1 do begin res:=res+IntToHex(ord(Digest[i+1]) + ord(CookieDigest[i mod Length(CookieDigest)+1]),1); end; result:=res; end;</span></span></code> </pre><br></div></div><br> æ¯”è¾ƒï¼š <br><br><img src="https://habrastorage.org/webt/fy/qf/3y/fyqf3yx_4fy1vrfubc8z3zl5rqi.png"><br><br> å¤ªå¥½äº†ï¼ æœ€åä¸€æ­¥ä»ç„¶æ˜¯-æ¥æ”¶å“åº”çš„Cookieï¼š <br><br><pre> <code class="javascript hljs">ResCooka=((((ParamDecryptor(btoa(PluginsInfo),<span class="hljs-string"><span class="hljs-string">"ca3XP"</span></span>)+<span class="hljs-string"><span class="hljs-string">",digest="</span></span>)+DigestArray)+<span class="hljs-string"><span class="hljs-string">",s="</span></span>)+AllDigestHash); Set_Cookies(<span class="hljs-string"><span class="hljs-string">"___utmvc"</span></span>,btoa(ResCooka),<span class="hljs-number"><span class="hljs-number">0x14</span></span>);</code> </pre> <br> æœ€åˆçš„åŸå§‹ä»£ç å°†ä»¥base64ç¼–ç çš„æµè§ˆå™¨å‚æ•°æ·»åŠ åˆ°ç§»ä½çš„AllParamsæ•°ç»„çš„æœ«å°¾ï¼Œå¹¶ä½¿ç”¨å¸¦æœ‰<b>ca3XP</b>å¯†é’¥çš„ParamDecryptorå‡½æ•°â€œåŠ å¯†â€äº†å®ƒä»¬ï¼Œç„¶ååˆ é™¤äº†ä¹‹å‰æ·»åŠ çš„å…ƒç´ ã€‚ æˆ‘å¯ä»¥å‡å®šæ­¤æ‹æ–æ˜¯ç”±äºä¸€ä¸ªå°åŠŸèƒ½è€Œåˆ¶æˆçš„ï¼šParamDecryptorå‡½æ•°æ¥å—æ•°ç»„ä¸­å…ƒç´ çš„ç´¢å¼•å’Œå¯†é’¥ï¼Œè¿™æ„å‘³ç€æ‚¨åªèƒ½é€šè¿‡æ•°ç»„åœ¨å…¶ä¸­ä¼ è¾“å­—ç¬¦ä¸²ã€‚ ä¸ºä»€ä¹ˆä¸æ­£ç¡®å‘¢ï¼Ÿ ç¨‹åºå‘˜ï¼Œå…ˆç”Ÿã€‚ <br><br> å¥½å§ï¼Œå®é™…ä¸Šï¼Œä¸€åˆ‡å°±ç»ªï¼Œcookieéƒ½å‡†å¤‡å¥½äº†ï¼Œå®ƒä»ç„¶å¯ä»¥å®‰è£…å¹¶å‘é€è¯·æ±‚ã€‚ æ˜¯çš„ï¼Œæ‚¨ä¸ä¼šæ¥å—å®ƒï¼Œå› ä¸ºæœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘å¸Œæœ›ä¿æŒæ²‰é»˜ã€‚ <br><br><h4> æœ€ä½³åŒ– </h4><br>  Delphiä¸­çš„ä»£ç ç‰‡æ®µåªæ˜¯ä¸€ä¸ªåŸå‹ã€‚ æ ¹æ®å®¢æˆ·çš„è¦æ±‚ï¼Œå»æ··æ·†å™¨çš„æ‰€æœ‰ä»£ç éƒ½å·²åœ¨æ±‡ç¼–å™¨ä¸­é‡å†™ï¼Œå…¶æ‰§è¡Œé€Ÿåº¦æé«˜äº†æ•°å€ã€‚ ä»¥ä¸‹å¯¹é€Ÿåº¦ä¹Ÿæœ‰ç§¯æå½±å“ï¼š <br><br><ol><li> åœ¨å¾ªç¯çš„ä¸€æ¬¡è¿­ä»£ä¸­å‰ªåˆ‡æ‰å¤šä½™çš„ä»£ç å’Œæ•°ç»„ã€‚ è¿™å¯¹äºå¤§å¹…å‡å°‘ä»£ç é‡å¹¶åœ¨å°†æ¥åŠ å¿«æœç´¢é€Ÿåº¦æ˜¯å¿…è¦çš„ã€‚ </li><li> ç”±äºä»£ç ä¸­çš„å‡½æ•°æ²¡æœ‰æ··åˆåœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒä»¬çš„å¤§æ¦‚ä½ç½®ï¼Œå› æ­¤ï¼Œå¦‚æœcookieå®‰è£…å‡½æ•°ä½äºæœ€åï¼Œé‚£ä¹ˆæ‚¨è‡³å°‘éœ€è¦ä»ä¸­é—´æŸ¥æ‰¾å®ƒã€‚ </li><li> é¢„å…ˆæœç´¢å…³é”®åŠŸèƒ½ã€‚ ç”šè‡³åœ¨æ¸…é™¤ä¸å¿…è¦åƒåœ¾ä¸­çš„ä»£ç æ—¶ï¼Œæ±‡ç¼–ç®—æ³•ä¹Ÿä¼šæœç´¢å®ƒä»¬ã€‚ </li><li> åœ¨æœ€ç»ˆç‰ˆæœ¬ä¸­ï¼Œæˆ‘æ‘†è„±äº†å»æ··æ·†å™¨å¤§çº¦ä¸€åŠçš„åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½æ˜¯ç†è§£ä»£ç æ‰€å¿…éœ€çš„ï¼Œè€Œå¯¹äºæœºå™¨äººæ¥è¯´åˆ™ä¸æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºå¿…è¦çš„å‚æ•°æ¯«æ— é—®é¢˜åœ°å¾—åˆ°äº†è§£å†³ã€‚ </li></ol><br><h4> ç»“è®º </h4><br> å½“æˆ‘è®¿é—®è¯¥ç«™ç‚¹æ—¶ï¼Œæˆ‘å¸Œæœ›å®ƒèƒ½å¿«é€Ÿè¿è¡Œï¼Œå¹¶ä¸”ä½¿ç”¨æ­¤æ–¹æ³•æ··æ·†JSè„šæœ¬å¯¹ç”¨æˆ·ä¸æ•¬ã€‚ è¿™æœ‰åŠ©äºé˜²æ­¢æœºå™¨äººæ”»å‡»å—ï¼Ÿ ä¸ï¼Œå½“ç„¶ï¼Œæ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œå®ƒå®é™…ä¸Šæ˜¯åœ¨æ•´ä¸ªæ™šä¸ŠèŠ±è´¹çš„ï¼Œå¹¶ä¸”ä»…èŠ±è´¹å‡ ä¸ªä¸‰æ˜æ²»å’Œå‡ æ¯èŒ¶ã€‚ <br><br> æœ¬æ–‡çš„ç›®çš„æ˜¯è®¨è®ºæ­¤è§£å†³æ–¹æ¡ˆçš„æ“ä½œåŸç†ï¼Œå¹¶è¯´æ˜å…¶æ— ç”¨ä¹‹å¤„ã€‚ å‡ºäºæ˜æ˜¾çš„åŸå› ï¼Œå°†ä¸ä¼šå‘å¸ƒç”¨äºé¿å¼€æ­¤ä¿æŠ¤æªæ–½çš„ç°æˆæ¨¡å—ï¼ˆæ³„æ¼åï¼Œå¯æ€œçš„æ¸¸æˆåœæ­¢è½¬ä¸ºakamaiï¼‰ï¼Œä»–éœ€è¦æ ¹æ®è¿™é¡¹ç ”ç©¶ï¼ˆå¤§çº¦ä¸€å¹´å‰è¿›è¡Œå¹¶ä¸”ä»ç„¶æœ‰æ„ä¹‰ï¼‰äº²è‡ªè¿›è¡Œç ”ç©¶ï¼Œè€Œæƒ³è¦çªƒå–åˆ«äººçš„å¸ç›®å»æ£®æ—ã€‚ å¦‚æœ‰ä»»ä½•ç–‘é—®ï¼Œæˆ‘éšæ—¶å‡†å¤‡åœ¨è¯„è®ºä¸­å›ç­”ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN429662/">https://habr.com/ru/post/zh-CN429662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN429648/index.html">ç°åœ¨å¯ä»¥åŒæ—¶åœ¨iOS / Androidå’Œæ‰€æœ‰ç½‘ç»œä¸Šé€šè¿‡TLSå’ŒHTTPSè¿›è¡ŒDNSè½¬æ¢[æ„Ÿè°¢Cloudflare]</a></li>
<li><a href="../zh-CN429652/index.html">å¼€æ”¾å¼ç½‘ç»œç ”è®¨ä¼šâ€œ ITæ‹›è˜ï¼šä»åº”ç”¨ç¨‹åºåˆ°äº§å“â€</a></li>
<li><a href="../zh-CN429654/index.html">æ”¹å–„é¡¹ç›®ç®¡ç†</a></li>
<li><a href="../zh-CN429656/index.html">äººå·¥æ™ºèƒ½ä¹Ÿæ˜¯é”™è¯¯çš„ã€‚ éšç€Amazon Goåœ¨ç¾å›½ä¸ºæˆ‘ä»¬æä¾›æ·å¾„-å°†æ¥æ²¡æœ‰æ”¶é“¶å‘˜å’Œå–å®¶çš„å•†åº—</a></li>
<li><a href="../zh-CN429658/index.html">SpaceX Starlinkå«æ˜Ÿäº’è”ç½‘-â€œå°åˆ·è´§å¸è®¸å¯è¯â€</a></li>
<li><a href="../zh-CN429668/index.html">Google PageSpeed Insightså·²è¿›è¡Œäº†å½»åº•çš„æ›´æ–°ï¼Œå®ƒå°†å‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿ</a></li>
<li><a href="../zh-CN429670/index.html">Java Scriptï¼= JavaScriptã€‚ ä¸€å ‚è¯¾æœ‰äº”ä¸ªJavaã€‚ æˆ‘ä»¬ç¼–å†™è„šæœ¬ä»¥ä¾¿æˆ‘ä»¬æ°¸è¿œè®°ä½</a></li>
<li><a href="../zh-CN429676/index.html">å¤‡ä»½åˆ°ç£å¸¦</a></li>
<li><a href="../zh-CN429678/index.html">æˆ‘ä»¬å¦‚ä½•å°†1000ä¸‡è¡ŒC ++ä»£ç è½¬æ¢ä¸ºC ++ 14æ ‡å‡†ï¼ˆç„¶åè½¬æ¢ä¸ºC ++ 17ï¼‰</a></li>
<li><a href="../zh-CN429680/index.html">éº»çœç†å·¥å­¦é™¢çš„è¯¾ç¨‹â€œè®¡ç®—æœºç³»ç»Ÿå®‰å…¨â€ã€‚ è®²åº§17ï¼šç”¨æˆ·è®¤è¯ï¼Œç¬¬1éƒ¨åˆ†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>