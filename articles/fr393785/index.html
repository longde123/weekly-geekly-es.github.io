<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖüèø üë®üèª‚Äçüíº üö∂üèº Bouilloire WiFi √† la maison, ou comment rendre une bouilloire ordinaire vraiment intelligente üë®üèΩ‚Äçüíº üò≠ ü§πüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©face
 
 Si vous lisez mon article pr√©c√©dent ( Running line on Arduino ), vous savez probablement d√©j√† que nous avons la possibilit√© de faire des pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bouilloire WiFi √† la maison, ou comment rendre une bouilloire ordinaire vraiment intelligente</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393785/"><img src="https://habrastorage.org/files/13e/789/ac5/13e789ac5ab64c99bb2243540c6188bc.jpg" alt="image"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√©face</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous lisez mon article pr√©c√©dent ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Running line on Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), vous savez probablement d√©j√† que nous avons la possibilit√© de faire des projets de cours sur le mat√©riel dans notre universit√©. </font><font style="vertical-align: inherit;">Et moi, inspir√© par mon travail pr√©c√©dent, j'ai d√©cid√© d'essayer √† nouveau de faire quelque chose de mes propres mains. </font><font style="vertical-align: inherit;">Ce n'est que maintenant que le sujet aurait d√ª √™tre plus s√©rieux. </font><font style="vertical-align: inherit;">Au fait, j'ai commenc√© √† penser √† quoi faire pendant les vacances d'hiver, c'est-√†-dire avant le semestre. </font><font style="vertical-align: inherit;">Je voulais faire quelque chose d'int√©ressant et d'utile √† la fois.</font></font><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher une id√©e</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois, dans une paire sur les principes fondamentaux de la protection de l'information, nous avions un sujet li√© √† la propri√©t√© intellectuelle et aux brevets. L'enseignant nous a donn√© la t√¢che de d√©livrer un brevet pour tout appareil selon toutes les exigences et a cit√© une bouilloire wifi comme exemple. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a dit - et oubli√©. Et tout le monde a oubli√©, mais dans ma t√™te ce sujet est rest√©. Et quand est venu le temps de r√©fl√©chir √† ce qu'il fallait faire comme cours au cours du prochain semestre, je me suis souvenu de cette th√©i√®re. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re chose que j'ai d√©cid√© de voir, c'est ce qui a d√©j√† √©t√© fait. Et quelle a √©t√© ma surprise quand j'ai vu qu'il n'y avait que trois mod√®les de mannequins avec prise en charge du contr√¥le WiFi, et que deux d'entre eux appartiennent √† la m√™me soci√©t√©. Il s'agissait de Smarter iKettle 1.0 et 2.0 et du Russian Polaris PWK 1792CGL.</font></font><br>
<br>
<img src="https://psv4.vk.me/c615220/u9412861/docs/0ad68e7b3b82/imgonline-com-ua-twotoonefP6QyHRwpyGH.jpg?extra=DYIN0iLJbtamO0yymkG01568IjGjd-b5TPTlrxOGOg9GKUkRFG9qAbzX7whoNtLphkadbiiUq9AIz1X7jxfJ5trWX89OM_uDNpnwCw7j1tyXwPGFSsnL" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est int√©ressant de noter que presque toutes les maisons ont des bouilloires √©lectriques ordinaires, et il y en a si peu. </font><font style="vertical-align: inherit;">En comparant les fonctionnalit√©s offertes par iKettle et Polaris, j'ai fait une liste des plus n√©cessaires. </font><font style="vertical-align: inherit;">Voici ce qui s'est pass√©:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allumer / √©teindre √† partir d'un smartphone;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©gler n'importe quelle temp√©rature pour chauffer l'eau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la capacit√© de conna√Ætre la temp√©rature actuelle;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivre le volume actuel d'eau dans la bouilloire;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avertissement et protection contre la mise en marche avec un petit volume d'eau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©glage de l'heure de r√©veil automatique;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avis de pr√©paration;</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela semble r√©el, il est temps de se mettre au travail.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher les composants requis</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisqu'il n'√©tait pas possible de fabriquer une bouilloire compl√®tement nouvelle, il a √©t√© d√©cid√© de modifier une bouilloire √©lectrique ordinaire pr√™te √† l'emploi. Juste √† la maison √©tait une bouilloire orpheline avec un interrupteur cass√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, la fondation est d√©j√† l√†, pensai-je. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je devais commencer √† chercher des composants pour le mat√©riel. Comme il y avait d√©j√† peu d'exp√©rience de travail avec Arduino, j'ai d√©cid√© de tout impl√©menter dessus. De plus, Arduin elle-m√™me et ses modules sont peu co√ªteux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je devais ins√©rer toute la partie du contr√¥le de la bouilloire √† l'int√©rieur de la bouilloire, le choix s'est port√© sur l'Arduino Nano. Il est petit et poss√®de une interface pour connecter un c√¢ble, contrairement au Pro Mini, qui doit √™tre flash√© via UART.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/bd1/d8a/273/bd1d8a273b5189fb42cdd0834246dbc4.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le composant principal d'une bouilloire wifi est, bien s√ªr, un module wifi. La recherche sur Internet de quelque chose de abordable et de nombreux didacticiels a abouti √† l'ESP8266. √Ä savoir, sur la version 01. J'ai regard√© que c'√©tait bon march√© (environ 2 $) et il y avait beaucoup d'instructions pour se connecter. Arr√™t√© dessus. Quant au module lui-m√™me, la phrase ici est bonne: bon march√© et joyeuse. Mais plus √† ce sujet plus tard. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a39/db0/0e5/a39db00e5e05bc51f4c727c9b75ee18a.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contr√¥ler la temp√©rature, nous avions besoin d'une sorte de capteur de temp√©rature √©tanche. J'ai trouv√© une thermistance NTC √©tanche sur aliexpress, qui peut r√©sister √† des temp√©ratures de plus de 100 degr√©s. J'ai √©galement trouv√© un exemple de travail avec lui, alors j'ai d√©cid√© rapidement.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/205/649/1b9/2056491b9c4e3906446017711d069826.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il √©tait n√©cessaire de d√©cider comment allumer la bouilloire √† un moment donn√©, bien s√ªr, vous pouvez faire l'horloge du programme sur Arduino et allumer la bouilloire lorsque l'heure co√Øncide, mais cela fonctionnerait de mani√®re instable, et si le programme √©tait r√©initialis√© accidentellement, tout irait mal. Par cons√©quent, une horloge en temps r√©el est venue √† la rescousse ici. √Ä savoir DS1307. Ils ont une alimentation ind√©pendante (√† partir d'une batterie 3 V), et il y avait √©galement une puce de m√©moire EEPROM 32K bits sur le module sur lequel je m'arr√™tais, que j'ai utilis√© pour √©conomiser √† temps. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f8b/6d4/3e1/f8b6d43e1e1ddcf1ab573ad49bec80f3.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh oui, puisque la bouilloire devrait maintenant s'allumer par programmation, elle avait √©galement besoin d'un relais √† 1 canal. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/be1/f74/46d/be1f7446d29e3cdcc3a226860e31d01d.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quant au capteur de niveau de liquide, il devait √™tre fait manuellement. D√©tails ci-dessous.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du reste, plusieurs r√©sistances de d√©nominations diff√©rentes √©taient encore n√©cessaires, une planche √† pain pour les tests, une carte de circuit imprim√© pour l'installation r√©elle, le c√¢blage, un fer √† souder avec flux et soudure, et la part du lion de la patience.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©but du d√©veloppement</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que le projet est une bouilloire wifi, la premi√®re chose que je voulais et dont j'avais besoin pour g√©rer le module wifi. </font><font style="vertical-align: inherit;">D√®s que le colis est arriv√©, je l'ai imm√©diatement d√©ball√© et j'ai commenc√© √† me connecter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai trouv√© un tas d'exemples sur Internet. </font><font style="vertical-align: inherit;">Tout est comme il se doit, r√©gulateur de tension 3,3 V, diviseurs de tension pour RX et TX. </font><font style="vertical-align: inherit;">J'ai tout rassembl√© par exemple, je le connecte - √ßa n'a pas vol√©! </font><font style="vertical-align: inherit;">Un tas de texte a √©t√© affich√© sur le moniteur du port COM, car il s'est av√©r√© que le module √©tait constamment r√©initialis√©. </font><font style="vertical-align: inherit;">Il ne r√©pond pas aux commandes AT envoy√©es. </font><font style="vertical-align: inherit;">L'auteur de l'article fonctionne, moi non.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelle est la question? J'ai essay√© de rechercher d'autres sch√©mas de connexion, et ainsi de suite, etc., mais le module est toujours r√©initialis√© ou n'affiche rien. Et partout, il est √©crit en police rouge: "Ne vous appliquez pas au module 5 V, sinon il √©chouera." Alors la recherche de solutions a parfois dur√© le soir, je pensais d√©j√† √† acheter un autre module, mais j'ai d√©cid√© de v√©rifier la tension avec un multim√®tre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est av√©r√© que lorsque le module est connect√© √† 3,3 V, la tension chute en dessous de 3,2 V. Il semble que, eh bien, √ßa tombe et tombe. J'ai d√©cid√© de l'alimenter √† partir d'une autre source d'alimentation et il s'est av√©r√© que le module fonctionne normalement avec une tension sup√©rieure √† 3,2 V, et en dessous, cela ne suffit pas et il est constamment r√©initialis√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, √† mes risques et p√©rils, je l'ai connect√© √† 5 V et tout a fonctionn√© et fonctionne toujours bien. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d5d/17e/780/d5d17e7804c34c46a595c059100295e1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y avait pas de tels probl√®mes avec d'autres composants.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir d√©couvert le wifi, j'ai d√ª d√©cider quoi faire avec le capteur de niveau de liquide. Googler, j'ai trouv√© un article dans lequel l'auteur a fait un capteur d'humidit√© du sol. Lorsque le sol s√®che, la r√©sistance du capteur augmente et la tension au port analogique d'Arduino augmente. En d√©tectant un changement de tension, l'apparition d'un liquide peut √™tre d√©tect√©e. Au lieu de deux contacts, 6 ont √©t√© utilis√©s pour d√©terminer le niveau de liquide dans mon projet. L'un d'eux est connect√© √† la sortie 5 V et le reste aux entr√©es analogiques et aux r√©sistances 10 kŒ© √† GND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici des photos des tests. </font></font><br>
<br>
<img src="https://habrastorage.org/files/43c/536/5fd/43c5365fd8464326bf5b4eee5bfbe806.jpg"><br>
<img src="https://habrastorage.org/files/c99/d28/fee/c99d28fee740489a9b3893e4f9fdd418.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quel capteur de niveau est le r√©sultat.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b1e/2bb/10d/b1e2bb10db5f4e7ea647a746bc7e039c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine chose que j'ai test√©e est l'horloge en temps r√©el. </font><font style="vertical-align: inherit;">Mais travailler avec eux est fondamentalement simple. </font><font style="vertical-align: inherit;">Pour r√©gler l'heure et obtenir des informations √† ce sujet, j'ai utilis√© exclusivement des exemples fournis avec la biblioth√®que pour travailler avec DS1307. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, lorsque tout a √©t√© assembl√© sur une planche √† pain, nous avons obtenu un tel croisement entre les fils et les modules. </font><font style="vertical-align: inherit;">Au fait, sur ces photos, il y a un autre capteur de temp√©rature.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2f9/74d/288/2f974d288e8b43b0ab3612641a985f0e.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour commencer</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, tout cela devait √™tre soud√© sur la carte de circuit imprim√©. </font><font style="vertical-align: inherit;">Il n'y a rien de sp√©cial √† commenter, donc seulement une photo. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, un autre bouton a √©t√© ajout√© pour que vous puissiez allumer la bouilloire non seulement √† partir d'un smartphone, mais aussi de la mani√®re habituelle. </font></font><br>
<br>
<img src="https://habrastorage.org/files/98a/ad1/920/98aad19203204e46a644e52c9f905af0.jpg"><br>
<img src="https://habrastorage.org/files/995/592/45e/99559245edb048699172208c2584b689.jpg"><br>
<img src="https://habrastorage.org/files/2dd/594/23c/2dd59423cb0a447295593b52da781dd5.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez tout placer √† l'int√©rieur de la bouilloire. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/50e/bf8/9cb50ebf8d05486babe76682ce68fddf.jpg"><br>
<img src="https://habrastorage.org/files/39d/b11/53b/39db1153b86c4592862b1b2f66531252.jpg"><br>
<img src="https://habrastorage.org/files/605/7db/1e6/6057db1e6ead493c81d399e164b399d4.jpg"><br>
<img src="https://habrastorage.org/files/853/6fc/00e/8536fc00ead6460ab5e581029bbdaf64.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un insert en amiante a √©t√© ajout√© pour prot√©ger tous les int√©rieurs de la surchauffe. </font></font><br>
<br>
<img src="https://habrastorage.org/files/027/99a/f36/02799af362264b6682b3355bae815b9c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certes, le bo√Ætier devait √™tre l√©g√®rement sur√©lev√© avec un insert en plastique suppl√©mentaire.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ec3/06e/ab8/ec306eab83114666a94c62b33f9ce6f2.jpg"><br>
<img src="https://habrastorage.org/files/836/47b/9ac/83647b9ac23a43c7bd39ec57c4b2807c.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passez maintenant √† la partie mobile.</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quant √† l'application, puisqu'elle a √©t√© d√©velopp√©e sous Android OS, il √©tait initialement pr√©vu d'utiliser Android Studio. Mais pour √©tudier les nouvelles technologies, il a √©t√© d√©cid√© d'utiliser une plate-forme pr√™te √† l'emploi pour d√©velopper des programmes dans le domaine de l'Internet des objets. En cons√©quence, le choix s'est port√© sur le produit Evothings - Evothings Studio. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/74f/e14/7b1/74fe147b1a99d6a7fd6dd0b6a01ac2a2.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ses principaux avantages: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Un grand nombre d'exemples standard sur le travail avec diff√©rents modules (Wifi, Bluetooth); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - d√©veloppement d'applications utilisant JS, HTML, CSS, qui vous permet d'√©crire un code qui fonctionnera √©galement sur Android et iOS, c'est-√†-dire la liaison √† une seule plate-forme dispara√Æt;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - facilit√© de test de l'application: une application est install√©e sur le smartphone pour pr√©visualiser son d√©veloppement, et tous les messages de test et les messages d'erreur sont affich√©s dans le programme sur l'ordinateur; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Une grande quantit√© d'informations sur Internet sur le d√©veloppement en utilisant JS, HTML, CSS; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce studio Evothings, il y avait un exemple d'allumer la LED en transmettant une demande d'allumage via l'ESP8266. J'ai d√©cid√© de prendre cet exemple comme base, car il y avait la chose la plus pr√©cieuse pour moi - la communication avec le module WiFi via la prise tcp. Et de la m√™me mani√®re que la demande d'allumage de la LED a √©t√© transmise, j'ai fait une demande pour mettre √† jour les capteurs de la bouilloire, pour r√©gler l'heure de mise en marche, r√©gler la temp√©rature, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, j'ai foir√© les notifications de disponibilit√© et une petite quantit√© d'eau, l'avantage est que tout √† notre √©poque est facilement googl√©. </font><font style="vertical-align: inherit;">Le r√©sultat est une telle application (une bonne chose est de faire l'interface d'application en utilisant CSS):</font></font><br>
<br>
<img src="https://habrastorage.org/files/0b9/985/b2d/0b9985b2d0fb4c97bb36d4ebeb772ab6.jpg"><br>
<img src="https://habrastorage.org/files/431/aaa/445/431aaa44557d42de996527f587d8691f.jpg"><br>
<img src="https://habrastorage.org/files/e3a/f8d/fb1/e3af8dfb13764be2b2b9e9acbad28769.jpg"><br>
<img src="https://habrastorage.org/files/9c0/db4/c6e/9c0db4c6e1b44b0f86f725b5e75a265a.jpg"><br>
<img src="https://habrastorage.org/files/80a/7ff/90f/80a7ff90f43b46e197fdfc3594297e1a.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une br√®ve description de l'interaction du smartphone et de la bouilloire</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La communication entre le serveur et le client s'effectue via le module WiFi. Lorsque vous allumez le module de contr√¥le de la bouilloire, le module WiFi commence √† distribuer un r√©seau appel√© artKettle. Cela se fait √† l'aide des commandes AT c√¥t√© serveur. Ainsi, par exemple, pour mettre le module en mode point d'acc√®s, il doit envoyer la commande AT + CWMODE = 2. Ensuite, √† l'aide de ces commandes, vous devez attribuer des param√®tres r√©seau, autoriser la connexion de plusieurs appareils et obtenir l'adresse IP du wifi lui-m√™me. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du c√¥t√© client, la connexion se fait via un port sp√©cifique et par l'adresse IP du module wifi √† l'aide de chrome.tcp.socket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir connect√© le client au serveur, vous pouvez contr√¥ler la bouilloire depuis votre smartphone. Prenons l'exemple de l'allumage de la bouilloire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous cliquez sur le bouton d'alimentation dans l'application artKettle, la fonction correspondante de l'inclusion de app.kettleOn () est appel√©e. </font><font style="vertical-align: inherit;">A l'int√©rieur de cette fonction, deux lignes sont transf√©r√©es c√¥t√© serveur:</font></font><br>
<br>
<pre><code class="cpp hljs">app.sendString(<span class="hljs-string"><span class="hljs-string">'H'</span></span>);<font></font>
app.sendString(<span class="hljs-string"><span class="hljs-string">'U'</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient ensuite le travail d√©j√† du c√¥t√© d'Arduino. </font><font style="vertical-align: inherit;">Apr√®s que la premi√®re ligne arrive avec le caract√®re ¬´H¬ª, le code suivant est ex√©cut√©:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(message.indexOf(<span class="hljs-string"><span class="hljs-string">"H"</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; waterDetected())  {<font></font>
      digitalWrite(POWER_PIN, LOW); <font></font>
      IS_ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"ON"</span></span>);<font></font>
      sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>); <font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, il v√©rifie s'il y a de l'eau dans la bouilloire en appelant la m√©thode waterDetected (). </font><font style="vertical-align: inherit;">Envisagez l'option lorsque de l'eau est pr√©sente dans la bouilloire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un niveau de basse tension est appliqu√© √† la broche de commande du relais, ce qui correspond √† son inclusion, c'est-√†-dire </font><font style="vertical-align: inherit;">le circuit de puissance se ferme:</font></font><br>
<pre><code class="cpp hljs">digitalWrite(POWER_PIN, LOW); 
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, l'indicateur est d√©fini pour indiquer que la bouilloire est allum√©e et un message sur la sortie vers le moniteur du port s√©rie s'affiche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, une fonction est appel√©e qui transmet un message de r√©ponse au c√¥t√© client que l'inclusion enti√®re a r√©ussi:</font></font><br>
<br>
<pre><code class="cpp hljs">sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C√¥t√© client, apr√®s avoir v√©rifi√© le message entrant, le bouton d'alimentation est r√©gl√© sur l'√©tat On:</font></font><br>
<pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buf.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) == <span class="hljs-string"><span class="hljs-string">"ON"</span></span>) {<font></font>
	app.setButtonOn();<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s cela, le message texte est trait√© avec le caract√®re ¬´U¬ª envoy√© du client au serveur. </font><font style="vertical-align: inherit;">Ici, d'une mani√®re similaire √† l'inclusion, les informations sur la temp√©rature actuelle et le volume de liquide dans la bouilloire sont mises √† jour. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, une communication bidirectionnelle entre le client et le serveur est organis√©e, de sorte que l'un d'eux conna√Æt l'√©tat de l'autre √† un moment donn√©.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä la suite du projet de cours, une modification a √©t√© d√©velopp√©e pour une bouilloire √©lectrique conventionnelle, qui permet de la contr√¥ler √† partir d'un smartphone via wifi. Maintenant, cette th√©i√®re peut √™tre attribu√©e aux repr√©sentants de l'Internet des objets. Nous avons r√©ussi √† impl√©menter pleinement toutes les fonctions, alors maintenant cette bouilloire a les caract√©ristiques suivantes: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - marche / arr√™t √† partir d'un smartphone; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - r√©gler n'importe quelle temp√©rature pour chauffer l'eau; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - la possibilit√© de conna√Ætre la temp√©rature actuelle; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - suivre le volume actuel d'eau dans la bouilloire; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - avertissement et protection contre la mise en marche avec un petit volume d'eau; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - r√©gler l'heure d'activation; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - notification de disponibilit√©;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les avantages du projet mis en ≈ìuvre sont l'accessibilit√© de la base de l'√©l√©ment, car tout ce dont vous avez besoin se trouve dans les magasins de composants √©lectroniques, l'extensibilit√© du projet. √âtant donn√© que la bouilloire poss√®de tous les capteurs n√©cessaires install√©s, elle peut √™tre modifi√©e par programme et pas pire que les analogues. √âtant donn√© la polyvalence du module wifi utilis√©, vous pouvez le connecter √† Internet et organiser le contr√¥le de la bouilloire, n'importe o√π dans le monde, et en utilisant le service en ligne pour le traitement des messages SMS, vous pouvez organiser l'inclusion par SMS. C'est-√†-dire le projet est encore tr√®s extensible, il existe des opportunit√©s pour cela, mais elles n'ont pas √©t√© mises en ≈ìuvre, car elles ne faisaient pas partie des objectifs du projet en cours d'√©laboration.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, le projet pr√©sente des inconv√©nients. </font><font style="vertical-align: inherit;">Le premier est le fonctionnement instable du module Wifi. </font><font style="vertical-align: inherit;">Un module perd parfois son r√©seau, commence √† r√©initialiser les param√®tres ou ne traite tout simplement pas les signaux entrants. </font><font style="vertical-align: inherit;">De plus, ce sont des probl√®mes populaires parmi les utilisateurs de ce module. </font><font style="vertical-align: inherit;">Le deuxi√®me inconv√©nient est l'absence d'arr√™t m√©canique de la bouilloire. </font><font style="vertical-align: inherit;">L'arr√™t est impl√©ment√© dans le logiciel; lorsque le point d'√©bullition est atteint, le circuit se brise √† l'aide d'un relais. </font><font style="vertical-align: inherit;">Si le programme plante soudainement, la bouilloire peut ne pas s'√©teindre. </font><font style="vertical-align: inherit;">Le troisi√®me inconv√©nient est le probl√®me de la surveillance de la temp√©rature de chauffage. </font><font style="vertical-align: inherit;">Ainsi, par exemple, si vous √©teignez la bouilloire √† une temp√©rature de 60 degr√©s, le chauffage dix continuera √† d√©gager de la chaleur, et apr√®s un certain temps, la temp√©rature de l'eau sera d√©j√† d'environ 70 degr√©s. </font><font style="vertical-align: inherit;">Mais cela est corrig√© en faisant des ajustements au programme.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr393785/">https://habr.com/ru/post/fr393785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr393775/index.html">Les dauphins ont d√©couvert les rudiments de la communication linguistique</a></li>
<li><a href="../fr393777/index.html">Passage de Mercure sur le soleil - photo et vid√©o</a></li>
<li><a href="../fr393779/index.html">Les EAU envisagent de cr√©er une montagne artificielle pour augmenter les pr√©cipitations</a></li>
<li><a href="../fr393781/index.html">Les scientifiques de NUST ¬´MISiS¬ª ont prouv√© l'√©chec de la th√©orie classique de la structure de la Terre</a></li>
<li><a href="../fr393783/index.html">La base des √©clipses solaires et lunaires de -1999 √† +3000 ans</a></li>
<li><a href="../fr393787/index.html">Comment r√©parer les r√©acteurs nucl√©aires</a></li>
<li><a href="../fr393791/index.html">Une ville suisse autoris√©e √† payer ses factures de services publics en bitcoins</a></li>
<li><a href="../fr393795/index.html">En raison du r√©chauffement climatique, certaines parties du Moyen-Orient et de l'Afrique du Nord deviendront inhabitables</a></li>
<li><a href="../fr393797/index.html">D√©but des pr√©commandes pour la console de jeu Pyra</a></li>
<li><a href="../fr393799/index.html">En utilisant Amazon Echo, le propri√©taire de Tesla a montr√© √† quel point il est facile de faire sortir une voiture du garage.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>