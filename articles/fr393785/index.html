<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅🏿 👨🏻‍💼 🚶🏼 Bouilloire WiFi à la maison, ou comment rendre une bouilloire ordinaire vraiment intelligente 👨🏽‍💼 😭 🤹🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Préface
 
 Si vous lisez mon article précédent ( Running line on Arduino ), vous savez probablement déjà que nous avons la possibilité de faire des pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bouilloire WiFi à la maison, ou comment rendre une bouilloire ordinaire vraiment intelligente</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393785/"><img src="https://habrastorage.org/files/13e/789/ac5/13e789ac5ab64c99bb2243540c6188bc.jpg" alt="image"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Préface</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous lisez mon article précédent ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Running line on Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), vous savez probablement déjà que nous avons la possibilité de faire des projets de cours sur le matériel dans notre université. </font><font style="vertical-align: inherit;">Et moi, inspiré par mon travail précédent, j'ai décidé d'essayer à nouveau de faire quelque chose de mes propres mains. </font><font style="vertical-align: inherit;">Ce n'est que maintenant que le sujet aurait dû être plus sérieux. </font><font style="vertical-align: inherit;">Au fait, j'ai commencé à penser à quoi faire pendant les vacances d'hiver, c'est-à-dire avant le semestre. </font><font style="vertical-align: inherit;">Je voulais faire quelque chose d'intéressant et d'utile à la fois.</font></font><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher une idée</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois, dans une paire sur les principes fondamentaux de la protection de l'information, nous avions un sujet lié à la propriété intellectuelle et aux brevets. L'enseignant nous a donné la tâche de délivrer un brevet pour tout appareil selon toutes les exigences et a cité une bouilloire wifi comme exemple. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a dit - et oublié. Et tout le monde a oublié, mais dans ma tête ce sujet est resté. Et quand est venu le temps de réfléchir à ce qu'il fallait faire comme cours au cours du prochain semestre, je me suis souvenu de cette théière. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première chose que j'ai décidé de voir, c'est ce qui a déjà été fait. Et quelle a été ma surprise quand j'ai vu qu'il n'y avait que trois modèles de mannequins avec prise en charge du contrôle WiFi, et que deux d'entre eux appartiennent à la même société. Il s'agissait de Smarter iKettle 1.0 et 2.0 et du Russian Polaris PWK 1792CGL.</font></font><br>
<br>
<img src="https://psv4.vk.me/c615220/u9412861/docs/0ad68e7b3b82/imgonline-com-ua-twotoonefP6QyHRwpyGH.jpg?extra=DYIN0iLJbtamO0yymkG01568IjGjd-b5TPTlrxOGOg9GKUkRFG9qAbzX7whoNtLphkadbiiUq9AIz1X7jxfJ5trWX89OM_uDNpnwCw7j1tyXwPGFSsnL" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est intéressant de noter que presque toutes les maisons ont des bouilloires électriques ordinaires, et il y en a si peu. </font><font style="vertical-align: inherit;">En comparant les fonctionnalités offertes par iKettle et Polaris, j'ai fait une liste des plus nécessaires. </font><font style="vertical-align: inherit;">Voici ce qui s'est passé:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allumer / éteindre à partir d'un smartphone;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">régler n'importe quelle température pour chauffer l'eau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la capacité de connaître la température actuelle;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suivre le volume actuel d'eau dans la bouilloire;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avertissement et protection contre la mise en marche avec un petit volume d'eau;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">réglage de l'heure de réveil automatique;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avis de préparation;</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela semble réel, il est temps de se mettre au travail.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher les composants requis</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisqu'il n'était pas possible de fabriquer une bouilloire complètement nouvelle, il a été décidé de modifier une bouilloire électrique ordinaire prête à l'emploi. Juste à la maison était une bouilloire orpheline avec un interrupteur cassé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Donc, la fondation est déjà là, pensai-je. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, je devais commencer à chercher des composants pour le matériel. Comme il y avait déjà peu d'expérience de travail avec Arduino, j'ai décidé de tout implémenter dessus. De plus, Arduin elle-même et ses modules sont peu coûteux. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je devais insérer toute la partie du contrôle de la bouilloire à l'intérieur de la bouilloire, le choix s'est porté sur l'Arduino Nano. Il est petit et possède une interface pour connecter un câble, contrairement au Pro Mini, qui doit être flashé via UART.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/bd1/d8a/273/bd1d8a273b5189fb42cdd0834246dbc4.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le composant principal d'une bouilloire wifi est, bien sûr, un module wifi. La recherche sur Internet de quelque chose de abordable et de nombreux didacticiels a abouti à l'ESP8266. À savoir, sur la version 01. J'ai regardé que c'était bon marché (environ 2 $) et il y avait beaucoup d'instructions pour se connecter. Arrêté dessus. Quant au module lui-même, la phrase ici est bonne: bon marché et joyeuse. Mais plus à ce sujet plus tard. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a39/db0/0e5/a39db00e5e05bc51f4c727c9b75ee18a.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler la température, nous avions besoin d'une sorte de capteur de température étanche. J'ai trouvé une thermistance NTC étanche sur aliexpress, qui peut résister à des températures de plus de 100 degrés. J'ai également trouvé un exemple de travail avec lui, alors j'ai décidé rapidement.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/205/649/1b9/2056491b9c4e3906446017711d069826.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il était nécessaire de décider comment allumer la bouilloire à un moment donné, bien sûr, vous pouvez faire l'horloge du programme sur Arduino et allumer la bouilloire lorsque l'heure coïncide, mais cela fonctionnerait de manière instable, et si le programme était réinitialisé accidentellement, tout irait mal. Par conséquent, une horloge en temps réel est venue à la rescousse ici. À savoir DS1307. Ils ont une alimentation indépendante (à partir d'une batterie 3 V), et il y avait également une puce de mémoire EEPROM 32K bits sur le module sur lequel je m'arrêtais, que j'ai utilisé pour économiser à temps. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f8b/6d4/3e1/f8b6d43e1e1ddcf1ab573ad49bec80f3.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh oui, puisque la bouilloire devrait maintenant s'allumer par programmation, elle avait également besoin d'un relais à 1 canal. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/be1/f74/46d/be1f7446d29e3cdcc3a226860e31d01d.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quant au capteur de niveau de liquide, il devait être fait manuellement. Détails ci-dessous.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du reste, plusieurs résistances de dénominations différentes étaient encore nécessaires, une planche à pain pour les tests, une carte de circuit imprimé pour l'installation réelle, le câblage, un fer à souder avec flux et soudure, et la part du lion de la patience.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Début du développement</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que le projet est une bouilloire wifi, la première chose que je voulais et dont j'avais besoin pour gérer le module wifi. </font><font style="vertical-align: inherit;">Dès que le colis est arrivé, je l'ai immédiatement déballé et j'ai commencé à me connecter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai trouvé un tas d'exemples sur Internet. </font><font style="vertical-align: inherit;">Tout est comme il se doit, régulateur de tension 3,3 V, diviseurs de tension pour RX et TX. </font><font style="vertical-align: inherit;">J'ai tout rassemblé par exemple, je le connecte - ça n'a pas volé! </font><font style="vertical-align: inherit;">Un tas de texte a été affiché sur le moniteur du port COM, car il s'est avéré que le module était constamment réinitialisé. </font><font style="vertical-align: inherit;">Il ne répond pas aux commandes AT envoyées. </font><font style="vertical-align: inherit;">L'auteur de l'article fonctionne, moi non.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quelle est la question? J'ai essayé de rechercher d'autres schémas de connexion, et ainsi de suite, etc., mais le module est toujours réinitialisé ou n'affiche rien. Et partout, il est écrit en police rouge: "Ne vous appliquez pas au module 5 V, sinon il échouera." Alors la recherche de solutions a parfois duré le soir, je pensais déjà à acheter un autre module, mais j'ai décidé de vérifier la tension avec un multimètre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est avéré que lorsque le module est connecté à 3,3 V, la tension chute en dessous de 3,2 V. Il semble que, eh bien, ça tombe et tombe. J'ai décidé de l'alimenter à partir d'une autre source d'alimentation et il s'est avéré que le module fonctionne normalement avec une tension supérieure à 3,2 V, et en dessous, cela ne suffit pas et il est constamment réinitialisé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, à mes risques et périls, je l'ai connecté à 5 V et tout a fonctionné et fonctionne toujours bien. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d5d/17e/780/d5d17e7804c34c46a595c059100295e1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y avait pas de tels problèmes avec d'autres composants.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir découvert le wifi, j'ai dû décider quoi faire avec le capteur de niveau de liquide. Googler, j'ai trouvé un article dans lequel l'auteur a fait un capteur d'humidité du sol. Lorsque le sol sèche, la résistance du capteur augmente et la tension au port analogique d'Arduino augmente. En détectant un changement de tension, l'apparition d'un liquide peut être détectée. Au lieu de deux contacts, 6 ont été utilisés pour déterminer le niveau de liquide dans mon projet. L'un d'eux est connecté à la sortie 5 V et le reste aux entrées analogiques et aux résistances 10 kΩ à GND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici des photos des tests. </font></font><br>
<br>
<img src="https://habrastorage.org/files/43c/536/5fd/43c5365fd8464326bf5b4eee5bfbe806.jpg"><br>
<img src="https://habrastorage.org/files/c99/d28/fee/c99d28fee740489a9b3893e4f9fdd418.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici quel capteur de niveau est le résultat.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b1e/2bb/10d/b1e2bb10db5f4e7ea647a746bc7e039c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine chose que j'ai testée est l'horloge en temps réel. </font><font style="vertical-align: inherit;">Mais travailler avec eux est fondamentalement simple. </font><font style="vertical-align: inherit;">Pour régler l'heure et obtenir des informations à ce sujet, j'ai utilisé exclusivement des exemples fournis avec la bibliothèque pour travailler avec DS1307. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, lorsque tout a été assemblé sur une planche à pain, nous avons obtenu un tel croisement entre les fils et les modules. </font><font style="vertical-align: inherit;">Au fait, sur ces photos, il y a un autre capteur de température.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2f9/74d/288/2f974d288e8b43b0ab3612641a985f0e.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour commencer</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, tout cela devait être soudé sur la carte de circuit imprimé. </font><font style="vertical-align: inherit;">Il n'y a rien de spécial à commenter, donc seulement une photo. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, un autre bouton a été ajouté pour que vous puissiez allumer la bouilloire non seulement à partir d'un smartphone, mais aussi de la manière habituelle. </font></font><br>
<br>
<img src="https://habrastorage.org/files/98a/ad1/920/98aad19203204e46a644e52c9f905af0.jpg"><br>
<img src="https://habrastorage.org/files/995/592/45e/99559245edb048699172208c2584b689.jpg"><br>
<img src="https://habrastorage.org/files/2dd/594/23c/2dd59423cb0a447295593b52da781dd5.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez tout placer à l'intérieur de la bouilloire. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/50e/bf8/9cb50ebf8d05486babe76682ce68fddf.jpg"><br>
<img src="https://habrastorage.org/files/39d/b11/53b/39db1153b86c4592862b1b2f66531252.jpg"><br>
<img src="https://habrastorage.org/files/605/7db/1e6/6057db1e6ead493c81d399e164b399d4.jpg"><br>
<img src="https://habrastorage.org/files/853/6fc/00e/8536fc00ead6460ab5e581029bbdaf64.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un insert en amiante a été ajouté pour protéger tous les intérieurs de la surchauffe. </font></font><br>
<br>
<img src="https://habrastorage.org/files/027/99a/f36/02799af362264b6682b3355bae815b9c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certes, le boîtier devait être légèrement surélevé avec un insert en plastique supplémentaire.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ec3/06e/ab8/ec306eab83114666a94c62b33f9ce6f2.jpg"><br>
<img src="https://habrastorage.org/files/836/47b/9ac/83647b9ac23a43c7bd39ec57c4b2807c.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passez maintenant à la partie mobile.</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quant à l'application, puisqu'elle a été développée sous Android OS, il était initialement prévu d'utiliser Android Studio. Mais pour étudier les nouvelles technologies, il a été décidé d'utiliser une plate-forme prête à l'emploi pour développer des programmes dans le domaine de l'Internet des objets. En conséquence, le choix s'est porté sur le produit Evothings - Evothings Studio. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/74f/e14/7b1/74fe147b1a99d6a7fd6dd0b6a01ac2a2.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici ses principaux avantages: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Un grand nombre d'exemples standard sur le travail avec différents modules (Wifi, Bluetooth); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - développement d'applications utilisant JS, HTML, CSS, qui vous permet d'écrire un code qui fonctionnera également sur Android et iOS, c'est-à-dire la liaison à une seule plate-forme disparaît;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - facilité de test de l'application: une application est installée sur le smartphone pour prévisualiser son développement, et tous les messages de test et les messages d'erreur sont affichés dans le programme sur l'ordinateur; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Une grande quantité d'informations sur Internet sur le développement en utilisant JS, HTML, CSS; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce studio Evothings, il y avait un exemple d'allumer la LED en transmettant une demande d'allumage via l'ESP8266. J'ai décidé de prendre cet exemple comme base, car il y avait la chose la plus précieuse pour moi - la communication avec le module WiFi via la prise tcp. Et de la même manière que la demande d'allumage de la LED a été transmise, j'ai fait une demande pour mettre à jour les capteurs de la bouilloire, pour régler l'heure de mise en marche, régler la température, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, j'ai foiré les notifications de disponibilité et une petite quantité d'eau, l'avantage est que tout à notre époque est facilement googlé. </font><font style="vertical-align: inherit;">Le résultat est une telle application (une bonne chose est de faire l'interface d'application en utilisant CSS):</font></font><br>
<br>
<img src="https://habrastorage.org/files/0b9/985/b2d/0b9985b2d0fb4c97bb36d4ebeb772ab6.jpg"><br>
<img src="https://habrastorage.org/files/431/aaa/445/431aaa44557d42de996527f587d8691f.jpg"><br>
<img src="https://habrastorage.org/files/e3a/f8d/fb1/e3af8dfb13764be2b2b9e9acbad28769.jpg"><br>
<img src="https://habrastorage.org/files/9c0/db4/c6e/9c0db4c6e1b44b0f86f725b5e75a265a.jpg"><br>
<img src="https://habrastorage.org/files/80a/7ff/90f/80a7ff90f43b46e197fdfc3594297e1a.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une brève description de l'interaction du smartphone et de la bouilloire</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La communication entre le serveur et le client s'effectue via le module WiFi. Lorsque vous allumez le module de contrôle de la bouilloire, le module WiFi commence à distribuer un réseau appelé artKettle. Cela se fait à l'aide des commandes AT côté serveur. Ainsi, par exemple, pour mettre le module en mode point d'accès, il doit envoyer la commande AT + CWMODE = 2. Ensuite, à l'aide de ces commandes, vous devez attribuer des paramètres réseau, autoriser la connexion de plusieurs appareils et obtenir l'adresse IP du wifi lui-même. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Du côté client, la connexion se fait via un port spécifique et par l'adresse IP du module wifi à l'aide de chrome.tcp.socket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir connecté le client au serveur, vous pouvez contrôler la bouilloire depuis votre smartphone. Prenons l'exemple de l'allumage de la bouilloire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque vous cliquez sur le bouton d'alimentation dans l'application artKettle, la fonction correspondante de l'inclusion de app.kettleOn () est appelée. </font><font style="vertical-align: inherit;">A l'intérieur de cette fonction, deux lignes sont transférées côté serveur:</font></font><br>
<br>
<pre><code class="cpp hljs">app.sendString(<span class="hljs-string"><span class="hljs-string">'H'</span></span>);<font></font>
app.sendString(<span class="hljs-string"><span class="hljs-string">'U'</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vient ensuite le travail déjà du côté d'Arduino. </font><font style="vertical-align: inherit;">Après que la première ligne arrive avec le caractère «H», le code suivant est exécuté:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(message.indexOf(<span class="hljs-string"><span class="hljs-string">"H"</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; waterDetected())  {<font></font>
      digitalWrite(POWER_PIN, LOW); <font></font>
      IS_ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"ON"</span></span>);<font></font>
      sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>); <font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, il vérifie s'il y a de l'eau dans la bouilloire en appelant la méthode waterDetected (). </font><font style="vertical-align: inherit;">Envisagez l'option lorsque de l'eau est présente dans la bouilloire. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un niveau de basse tension est appliqué à la broche de commande du relais, ce qui correspond à son inclusion, c'est-à-dire </font><font style="vertical-align: inherit;">le circuit de puissance se ferme:</font></font><br>
<pre><code class="cpp hljs">digitalWrite(POWER_PIN, LOW); 
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, l'indicateur est défini pour indiquer que la bouilloire est allumée et un message sur la sortie vers le moniteur du port série s'affiche. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, une fonction est appelée qui transmet un message de réponse au côté client que l'inclusion entière a réussi:</font></font><br>
<br>
<pre><code class="cpp hljs">sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Côté client, après avoir vérifié le message entrant, le bouton d'alimentation est réglé sur l'état On:</font></font><br>
<pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buf.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) == <span class="hljs-string"><span class="hljs-string">"ON"</span></span>) {<font></font>
	app.setButtonOn();<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, le message texte est traité avec le caractère «U» envoyé du client au serveur. </font><font style="vertical-align: inherit;">Ici, d'une manière similaire à l'inclusion, les informations sur la température actuelle et le volume de liquide dans la bouilloire sont mises à jour. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, une communication bidirectionnelle entre le client et le serveur est organisée, de sorte que l'un d'eux connaît l'état de l'autre à un moment donné.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À la suite du projet de cours, une modification a été développée pour une bouilloire électrique conventionnelle, qui permet de la contrôler à partir d'un smartphone via wifi. Maintenant, cette théière peut être attribuée aux représentants de l'Internet des objets. Nous avons réussi à implémenter pleinement toutes les fonctions, alors maintenant cette bouilloire a les caractéristiques suivantes: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - marche / arrêt à partir d'un smartphone; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - régler n'importe quelle température pour chauffer l'eau; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - la possibilité de connaître la température actuelle; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - suivre le volume actuel d'eau dans la bouilloire; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - avertissement et protection contre la mise en marche avec un petit volume d'eau; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - régler l'heure d'activation; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - notification de disponibilité;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les avantages du projet mis en œuvre sont l'accessibilité de la base de l'élément, car tout ce dont vous avez besoin se trouve dans les magasins de composants électroniques, l'extensibilité du projet. Étant donné que la bouilloire possède tous les capteurs nécessaires installés, elle peut être modifiée par programme et pas pire que les analogues. Étant donné la polyvalence du module wifi utilisé, vous pouvez le connecter à Internet et organiser le contrôle de la bouilloire, n'importe où dans le monde, et en utilisant le service en ligne pour le traitement des messages SMS, vous pouvez organiser l'inclusion par SMS. C'est-à-dire le projet est encore très extensible, il existe des opportunités pour cela, mais elles n'ont pas été mises en œuvre, car elles ne faisaient pas partie des objectifs du projet en cours d'élaboration.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, le projet présente des inconvénients. </font><font style="vertical-align: inherit;">Le premier est le fonctionnement instable du module Wifi. </font><font style="vertical-align: inherit;">Un module perd parfois son réseau, commence à réinitialiser les paramètres ou ne traite tout simplement pas les signaux entrants. </font><font style="vertical-align: inherit;">De plus, ce sont des problèmes populaires parmi les utilisateurs de ce module. </font><font style="vertical-align: inherit;">Le deuxième inconvénient est l'absence d'arrêt mécanique de la bouilloire. </font><font style="vertical-align: inherit;">L'arrêt est implémenté dans le logiciel; lorsque le point d'ébullition est atteint, le circuit se brise à l'aide d'un relais. </font><font style="vertical-align: inherit;">Si le programme plante soudainement, la bouilloire peut ne pas s'éteindre. </font><font style="vertical-align: inherit;">Le troisième inconvénient est le problème de la surveillance de la température de chauffage. </font><font style="vertical-align: inherit;">Ainsi, par exemple, si vous éteignez la bouilloire à une température de 60 degrés, le chauffage dix continuera à dégager de la chaleur, et après un certain temps, la température de l'eau sera déjà d'environ 70 degrés. </font><font style="vertical-align: inherit;">Mais cela est corrigé en faisant des ajustements au programme.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr393785/">https://habr.com/ru/post/fr393785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr393775/index.html">Les dauphins ont découvert les rudiments de la communication linguistique</a></li>
<li><a href="../fr393777/index.html">Passage de Mercure sur le soleil - photo et vidéo</a></li>
<li><a href="../fr393779/index.html">Les EAU envisagent de créer une montagne artificielle pour augmenter les précipitations</a></li>
<li><a href="../fr393781/index.html">Les scientifiques de NUST «MISiS» ont prouvé l'échec de la théorie classique de la structure de la Terre</a></li>
<li><a href="../fr393783/index.html">La base des éclipses solaires et lunaires de -1999 à +3000 ans</a></li>
<li><a href="../fr393787/index.html">Comment réparer les réacteurs nucléaires</a></li>
<li><a href="../fr393791/index.html">Une ville suisse autorisée à payer ses factures de services publics en bitcoins</a></li>
<li><a href="../fr393795/index.html">En raison du réchauffement climatique, certaines parties du Moyen-Orient et de l'Afrique du Nord deviendront inhabitables</a></li>
<li><a href="../fr393797/index.html">Début des précommandes pour la console de jeu Pyra</a></li>
<li><a href="../fr393799/index.html">En utilisant Amazon Echo, le propriétaire de Tesla a montré à quel point il est facile de faire sortir une voiture du garage.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>