<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôå üì∑ ‚öúÔ∏è Blockchain: Was sollen wir PoC bauen? üë©üèΩ‚Äçüöí üëÅ‚Äçüó® üë©üèΩ‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Augen haben Angst und die H√§nde jucken! 

 In fr√ºheren Artikeln haben wir herausgefunden, auf welchen Technologien Blockchains basieren (wof√ºr sol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blockchain: Was sollen wir PoC bauen?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466157/">  <i>Die Augen haben Angst und die H√§nde jucken!</i> <br><br>  In fr√ºheren Artikeln haben wir herausgefunden, auf welchen Technologien Blockchains basieren (wof√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sollten wir eine Blockchain erstellen?</a> ) Und welche F√§lle mit ihrer Hilfe implementiert werden k√∂nnen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wof√ºr sollten wir einen Fall erstellen?</a> ).  Es ist Zeit, mit Ihren H√§nden zu arbeiten!  F√ºr die Implementierung von Piloten und PoC (Proof of Concept) bevorzuge ich Clouds, weil  Auf sie kann von √ºberall auf der Welt zugegriffen werden, und oft m√ºssen Sie keine Zeit f√ºr die m√ºhsame Installation der Umgebung aufwenden, weil  Es gibt vordefinierte Konfigurationen.  Machen wir also etwas Einfaches, zum Beispiel ein Netzwerk zum √úbertragen von M√ºnzen zwischen Teilnehmern, und nennen es bescheiden Citcoin.  Dazu verwenden wir die IBM Cloud und die universelle Blockchain Hyperledger Fabric.  Lassen Sie uns zun√§chst sehen, warum Hyperledger Fabric als universelle Blockchain bezeichnet wird. <br><br><img src="https://habrastorage.org/webt/f6/tc/q3/f6tcq3wp6dn1kaity-mtv9xkkik.png" alt="Bild"><br><a name="habracut"></a><br><h2>  Hyperledger Fabric - eine universelle Blockchain </h2><br>  Im Allgemeinen lautet das universelle Informationssystem: <br><br><ul><li>  Eine Reihe von Servern und ein Softwarekern, der die Gesch√§ftslogik ausf√ºhrt. </li><li>  Schnittstellen f√ºr die Interaktion mit dem System; </li><li>  Mittel zur Registrierung, Authentifizierung und Autorisierung von Ger√§ten / Personen; </li><li>  Datenbank zum Speichern von Betriebs- und Archivdaten: </li></ul><br><img src="https://habrastorage.org/webt/ha/dt/cr/hadtcr9siyz1oy-ouwou9gwhyzs.png" alt="Bild"><br><br>  Die offizielle Version von Hyperledger Fabric kann auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Website</a> gelesen werden. Kurz gesagt, Hyperledger Fabric ist eine OpenSource-Plattform, mit der Sie geschlossene Blockchains erstellen und beliebige intelligente Vertr√§ge ausf√ºhren k√∂nnen, die in den Programmiersprachen JS und Go geschrieben sind.  Schauen wir uns die Architektur des Hyperledger Fabric im Detail an und stellen sicher, dass es sich um ein universelles System handelt, das nur die Besonderheiten des Speicherns und Aufzeichnens von Daten aufweist.  Die Besonderheit besteht darin, dass die Daten wie in allen Blockchains nur dann in Bl√∂cken gespeichert werden, die in der Blockchain platziert werden, wenn die Teilnehmer einen Konsens erreicht haben und die Daten nach der Aufzeichnung nicht diskret korrigiert oder gel√∂scht werden k√∂nnen. <br><br><h2>  Hyperledger Fabric-Architektur </h2><br>  Das Diagramm zeigt die Architektur des Hyperledger Fabric: <br><br><img src="https://habrastorage.org/webt/lt/av/n_/ltavn_otc0ix7lspm1wqvvz2zl4.png" alt="Bild"><br><br>  <b>Organisationen</b> - Organisationen enthalten Peers, d. H.  Blockchain existiert aufgrund der Unterst√ºtzung von Organisationen.  Verschiedene Organisationen k√∂nnen Mitglieder desselben Kanals sein. <br><br>  <b>Kanal</b> - eine logische Struktur, die Peers in Gruppen vereint, d. H.  Blockchain ist gesetzt.  Hyperledger Fabric kann gleichzeitig mehrere Blockchains mit unterschiedlicher Gesch√§ftslogik verarbeiten. <br><br>  <b>Der Membership Services Provider (MSP)</b> ist eine Zertifizierungsstelle (Certificate Authority) f√ºr die Ausstellung von Identit√§ten und die Zuweisung von Rollen.  Um einen Knoten zu erstellen, m√ºssen Sie mit MSP interagieren. <br><br>  <b>Peer-Knoten</b> - √úberpr√ºfen Sie Transaktionen, speichern Sie die Blockchain, f√ºhren Sie intelligente Vertr√§ge aus und interagieren Sie mit Anwendungen.  Peers haben eine Identit√§t (digitales Zertifikat), die einen MSP ausstellt.  Im Gegensatz zum Bitcoin- oder Etherium-Netzwerk, in dem alle Knoten gleich sind, spielen die Hyperledger Fabric-Knoten unterschiedliche Rollen: <br><br><ul><li>  Peer kann <b>Peer</b> (EP) unterst√ºtzen und intelligente Vertr√§ge ausf√ºhren. </li><li>  <b>Committing Peer</b> (CP) - Speichern Sie nur Daten in der Blockchain und aktualisieren Sie den ‚ÄûWeltzustand‚Äú. </li><li>  <b>Anchor Peer</b> (AP) - Wenn mehrere Organisationen an der Blockchain teilnehmen, werden Anchor Peers verwendet, um zwischen ihnen zu kommunizieren.  Jede Organisation muss einen oder mehrere Anker-Peers haben.  Mit Hilfe von AP kann jeder Peer in der Organisation Informationen √ºber alle Peers in anderen Organisationen erhalten.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klatschprotokoll wird</a> verwendet, um Informationen zwischen APs zu synchronisieren. </li><li>  <b>Leader Peer</b> - Wenn die Organisation mehrere Peers hat, erh√§lt nur der Peer Leader Bl√∂cke vom Bestellservice und gibt sie an die anderen Peers weiter.  Ein Leiter kann entweder statisch festgelegt oder von Kollegen in einer Organisation dynamisch ausgew√§hlt werden.  Das Klatschprotokoll wird auch verwendet, um F√ºhrungsinformationen zu synchronisieren. </li></ul><br>  <b>Assets</b> sind Wertentit√§ten, die in der Blockchain gespeichert sind.  Dies sind insbesondere Schl√ºsselwertdaten im JSON-Format.  Es sind diese Daten, die in der Blockchain aufgezeichnet werden.  Sie haben eine Geschichte, die in der Blockchain gespeichert ist, und den aktuellen Status, der in der Weltstatusdatenbank gespeichert ist.  Datenstrukturen werden je nach Gesch√§ftsaufgabe zuf√§llig gef√ºllt.  Es gibt keine erforderlichen Felder. Die einzige Empfehlung lautet, dass Verm√∂genswerte einen Eigent√ºmer haben und wertvoll sein sollten. <br><br>  <b>Ledger</b> - besteht aus der Blockchain "Blockchain" und der Datenbank "Word state", in der der aktuelle Status der Assets gespeichert ist.  Der Weltstaat verwendet LevelDB oder CouchDB. <br><br>  <b>Intelligenter Vertrag</b> - Mit intelligenten Vertr√§gen wird die Gesch√§ftslogik des Systems implementiert.  In Hyperledger Fabric werden intelligente Vertr√§ge als Kettencode bezeichnet.  Mit Hilfe von Chaincode werden Assets und Transaktionen dar√ºber definiert.  In technischer Sprache sind Smart Contracts Softwaremodule, die in den Programmiersprachen JS oder Go implementiert sind. <br><br>  <b>Endorsement-Richtlinie</b> - F√ºr jeden Chaincode k√∂nnen Sie angeben, wie viele Richtlinien und von wem Sie Best√§tigungen f√ºr die Transaktion erwarten m√∂chten.  Wenn die Richtlinie nicht festgelegt ist, wird standardm√§√üig Folgendes verwendet: "Die Transaktion muss von jedem Mitglied einer Organisation im Kanal best√§tigt werden."  Beispiele f√ºr Richtlinien: <br><br><ul><li>  Jeder Administrator der Organisation muss die Transaktion best√§tigen. </li><li>  Jedes Mitglied oder jeder Kunde der Organisation muss dies best√§tigen. </li><li>  Muss jede Peer-Organisation best√§tigen. </li></ul><br>  <b>Bestellservice</b> - packt Transaktionen in Bl√∂cke und sendet Peers an den Kanal.  Garantiert die Zustellung von Nachrichten an alle Peers im Netzwerk.  F√ºr industrielle Systeme wird der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kafka Message Broker</a> verwendet, um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Solo</a> zu entwickeln und zu testen. <br><br><h2>  Anrufverlauf </h2><br><img src="https://habrastorage.org/webt/we/9m/wt/we9mwttlva0u7k0-zv2r6998rss.png" alt="Bild"><br><br><ul><li>  Die Anwendung interagiert mit Hyperledger Fabric √ºber das SDK Go, Node.js oder Java. </li><li>  Der Client erstellt eine TX-Transaktion und sendet sie an unterst√ºtzende Peers. </li><li>  Peer √ºberpr√ºft die Signatur des Kunden, schlie√üt die Transaktion ab und sendet die Endorsement-Signatur an den Kunden zur√ºck.  Der Kettencode wird nur auf dem unterst√ºtzenden Peer ausgef√ºhrt, und das Ergebnis seiner Ausf√ºhrung wird an alle Peers gesendet.  Dieser Arbeitsalgorithmus wird als PBFT-Konsens (Practical Byzantine Fault Tolerant) bezeichnet.  Es unterscheidet sich von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">klassischen BFT</a> darin, dass die Nachricht gesendet wird und eine Best√§tigung nicht von allen Teilnehmern erwartet wird, sondern nur von einem bestimmten Satz; </li><li>  Nachdem der Kunde die Anzahl der Antworten erhalten hat, die der Endorsement-Richtlinie entsprechen, sendet er die Transaktion an den Bestellservice. </li><li>  Der Bestellservice bildet einen Block und sendet ihn an alle festschreibenden Peers.  Der Bestellservice erm√∂glicht das sequentielle Schreiben von Bl√∂cken, wobei die sogenannte Hauptbuchgabel ausgeschlossen ist ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">siehe Abschnitt "Gabeln"</a> ). </li><li>  Peers erhalten einen Block, √ºberpr√ºfen die Endorsement-Richtlinie erneut, schreiben den Block in die Blockchain und √§ndern den Status in der Datenbank "World State". </li></ul><br>  Das hei√üt,  Es stellt sich heraus, dass die Rollen zwischen den Knoten getrennt sind.  Dies bietet Skalierbarkeit und Blockchain-Sicherheit: <br><br><ul><li>  Intelligente Vertr√§ge (Chaincode) f√ºhren die Unterst√ºtzung von Peers durch.  Dies gew√§hrleistet die Vertraulichkeit intelligenter Vertr√§ge  Es wird nicht von allen Teilnehmern gespeichert, sondern nur von unterst√ºtzenden Kollegen. </li><li>  Die Bestellung sollte schnell gehen.  Dies wird durch die Tatsache sichergestellt, dass die Bestellung nur einen Block bildet und ihn an eine feste Gruppe von F√ºhrungskollegen sendet. </li><li>  Das Festschreiben von Peers speichert nur die Blockchain - es kann viele von ihnen geben, und sie erfordern nicht viel Leistung und sofortige Arbeit. </li></ul><br>  Weitere Informationen zu den Architekturl√∂sungen von Hyperledger Fabric und warum dies so funktioniert, finden Sie hier: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Urspr√ºnge der Architektur</a> oder hier: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hyperledger Fabric: Ein verteiltes Betriebssystem f√ºr zul√§ssige Blockchains</a> . <br><br>  Hyperledger Fabric ist also ein wirklich universelles System, mit dem Sie: <br><br><ul><li>  Implementieren Sie eine beliebige Gesch√§ftslogik mithilfe des intelligenten Vertragsmechanismus. </li><li>  Schreiben und Empfangen von Daten aus einer Blockchain-Datenbank im JSON-Format; </li><li>  Bereitstellen und √úberpr√ºfen des Zugriffs auf die API mithilfe der Zertifizierungsstelle. </li></ul><br>  Nachdem wir die Besonderheiten des Hyperledger Fabric herausgefunden haben, wollen wir endlich etwas N√ºtzliches tun! <br><br><h2>  Erweitern Sie Blockchain </h2><br><h3>  Erkl√§rung des Problems </h3><br>  Die Aufgabe besteht darin, das Citcoin-Netzwerk mit den folgenden Funktionen zu implementieren: Konto erstellen, Guthaben abrufen, Konto auff√ºllen, M√ºnzen von einem Konto auf ein anderes √ºbertragen.  Zeichnen wir ein Objektmodell, das wir in einem intelligenten Vertrag weiter implementieren werden.  Wir werden also Konten haben, die durch Namen identifiziert werden und einen Saldo und eine Liste von Konten enthalten.  Konten und eine Liste von Konten beziehen sich auf Hyperledger Fabric-Assets.  Dementsprechend haben sie eine Geschichte und einen aktuellen Status.  Ich werde versuchen, es klar zu zeichnen: <br><br><img src="https://habrastorage.org/webt/wj/vx/uc/wjvxuc7wn8q8z8ob7efborjwfeu.png" alt="Bild"><br><br>  Die oberen Zahlen sind der aktuelle Status, der in der World State-Datenbank gespeichert ist.  Darunter befinden sich Abbildungen, die die Geschichte zeigen, die in der Blockchain gespeichert ist.  Der aktuelle Status der Verm√∂genswerte wird durch Transaktionen ge√§ndert.  Das Asset √§ndert sich nur in seiner Gesamtheit. Daher wird infolge der Transaktion ein neues Objekt erstellt und der aktuelle Wert des Assets wird in die Historie aufgenommen. <br><br><h3>  IBM Cloud </h3><br>  Wir erstellen ein Konto in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der IBM Cloud</a> .  Um die Blockchain-Plattform nutzen zu k√∂nnen, m√ºssen Sie sie auf Pay-As-You-Go aktualisieren.  Dieser Vorgang ist m√∂glicherweise nicht schnell, weil  IBM fordert zus√§tzliche Informationen an und √ºberpr√ºft diese manuell.  Positiv kann ich sagen, dass IBM √ºber gute Schulungsmaterialien verf√ºgt, mit denen Sie Hyperledger Fabric in der Cloud bereitstellen k√∂nnen.  Ich mochte die folgende Reihe von Artikeln und Beispielen: <br><br><ul><li>  <a href="">Erstellen Sie mithilfe der Blockchain-Plattform ein grundlegendes Blockchain-Netzwerk</a> </li><li>  <a href="">Erstellen und Ausf√ºhren eines Blockchain-Smart-Vertrags</a> </li><li>  <a href="">Ereignisse von der Blockchain-Plattform ausgeben</a> </li></ul><br>  Im Folgenden finden Sie Screenshots der IBM Blockchain-Plattform.  Dies ist keine Anweisung zum Erstellen einer Blockchain, sondern lediglich eine Demonstration des Umfangs der Aufgabe.  F√ºr unsere Zwecke bilden wir eine Organisation: <br><br><img src="https://habrastorage.org/webt/vw/gr/co/vwgrcodh-v21eslmmfe_1nkruhk.png" alt="Bild"><br><br>  Darin erstellen wir Knoten: Orderer CA, Org1 CA, Orderer Peer: <br><br><img src="https://habrastorage.org/webt/f7/1x/g2/f71xg2fhmy258ihqyaunufjgas4.png" alt="Bild"><br><br>  Wir starten Benutzer: <br><br><img src="https://habrastorage.org/webt/1t/k5/_i/1tk5_ihjhcimki8xaeuxenwszh0.png" alt="Bild"><br><br>  Erstellen Sie einen Kanal und nennen Sie ihn citcoin: <br><br><img src="https://habrastorage.org/webt/hv/y-/av/hvy-av3p4pjrpgonz47bcj0qebq.png" alt="Bild"><br><br>  Im Wesentlichen ist Channel eine Blockchain, daher beginnt es mit einem Nullblock (Genesis-Block): <br><br><img src="https://habrastorage.org/webt/9x/n0/c0/9xn0c0ihpxzmytycm9olkqi6klm.png" alt="Bild"><br><br><h3>  Einen intelligenten Vertrag schreiben </h3><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* * Citcoin smart-contract v1.5 for Hyperledger Fabric * (c) Alexey Sushkov, 2019 */</span></span> <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { Contract } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fabric-contract-api'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> maxAccounts = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CitcoinEvents</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Contract</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> instantiate(ctx) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.info(<span class="hljs-string"><span class="hljs-string">'instantiate'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> emptyList = []; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ctx.stub.putState(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>, Buffer.from(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(emptyList))); } <span class="hljs-comment"><span class="hljs-comment">// Get all accounts async GetAccounts(ctx) { // Get account list: let accounts = '{}' let accountsData = await ctx.stub.getState('accounts'); if (accountsData) { accounts = JSON.parse(accountsData.toString()); } else { throw new Error('accounts not found'); } return accountsData.toString() } // add a account object to the blockchain state identifited by their name async AddAccount(ctx, name, balance) { // this is account data: let account = { name: name, balance: Number(balance), type: 'account', }; // create account: await ctx.stub.putState(name, Buffer.from(JSON.stringify(account))); // Add account to list: let accountsData = await ctx.stub.getState('accounts'); if (accountsData) { let accounts = JSON.parse(accountsData.toString()); if (accounts.length &lt; maxAccounts) { accounts.push(name); await ctx.stub.putState('accounts', Buffer.from(JSON.stringify(accounts))); } else { throw new Error('Max accounts number reached'); } } else { throw new Error('accounts not found'); } // return object return JSON.stringify(account); } // Sends money from Account to Account async SendFrom(ctx, fromAccount, toAccount, value) { // get Account from let fromData = await ctx.stub.getState(fromAccount); let from; if (fromData) { from = JSON.parse(fromData.toString()); if (from.type !== 'account') { throw new Error('wrong from type'); } } else { throw new Error('Accout from not found'); } // get Account to let toData = await ctx.stub.getState(toAccount); let to; if (toData) { to = JSON.parse(toData.toString()); if (to.type !== 'account') { throw new Error('wrong to type'); } } else { throw new Error('Accout to not found'); } // update the balances if ((from.balance - Number(value)) &gt;= 0 ) { from.balance -= Number(value); to.balance += Number(value); } else { throw new Error('From Account: not enought balance'); } await ctx.stub.putState(from.name, Buffer.from(JSON.stringify(from))); await ctx.stub.putState(to.name, Buffer.from(JSON.stringify(to))); // define and set Event let Event = { type: "SendFrom", from: from.name, to: to.name, balanceFrom: from.balance, balanceTo: to.balance, value: value }; await ctx.stub.setEvent('SendFrom', Buffer.from(JSON.stringify(Event))); // return to object return JSON.stringify(from); } // get the state from key async GetState(ctx, key) { let data = await ctx.stub.getState(key); let jsonData = JSON.parse(data.toString()); return JSON.stringify(jsonData); } // GetBalance async GetBalance(ctx, accountName) { let data = await ctx.stub.getState(accountName); let jsonData = JSON.parse(data.toString()); return JSON.stringify(jsonData); } // Refill own balance async RefillBalance(ctx, toAccount, value) { // get Account to let toData = await ctx.stub.getState(toAccount); let to; if (toData) { to = JSON.parse(toData.toString()); if (to.type !== 'account') { throw new Error('wrong to type'); } } else { throw new Error('Accout to not found'); } // update the balance to.balance += Number(value); await ctx.stub.putState(to.name, Buffer.from(JSON.stringify(to))); // define and set Event let Event = { type: "RefillBalance", to: to.name, balanceTo: to.balance, value: value }; await ctx.stub.setEvent('RefillBalance', Buffer.from(JSON.stringify(Event))); // return to object return JSON.stringify(from); } } module.exports = CitcoinEvents;</span></span></code> </pre> <br>  Intuitiv sollte hier alles klar sein: <br><br><ul><li>  Es gibt verschiedene Funktionen (AddAccount, GetAccounts, SendFrom, GetBalance, RefillBalance), die das Demo-Programm mithilfe der Hyperledger Fabric-API aufruft. </li><li>  Die Funktionen SendFrom und RefillBalance generieren Ereignisse (Event), die das Demo-Programm empf√§ngt. </li><li>  Funktion instanziieren - wird einmal w√§hrend der Instanziierung eines intelligenten Vertrags aufgerufen.  Tats√§chlich wird es nicht einmal aufgerufen, sondern jedes Mal, wenn eine Version eines intelligenten Vertrags ge√§ndert wird.  Daher ist es eine schlechte Idee, die Liste mit einem leeren Array zu initialisieren, weil  Wenn Sie jetzt die Version eines Smart-Vertrags √§ndern, verlieren wir die aktuelle Liste.  Aber nichts, ich lerne nur). </li><li>  Konten und eine Liste von Konten (Konten) sind JSON-Datenstrukturen.  F√ºr die Datenmanipulation wird JS verwendet. </li><li>  Sie k√∂nnen den aktuellen Wert eines Assets abrufen, indem Sie die Funktion getState aufrufen und mit putState aktualisieren. </li><li>  Beim Erstellen eines Kontos wird die Funktion AddAccount aufgerufen, bei der die maximale Anzahl von Konten in der Blockchain verglichen wird (maxAccounts = 5).  Und es gibt einen Pfosten (bemerkt?), Der zu einer unendlichen Zunahme der Anzahl der Konten f√ºhrt.  Solche Fehler m√ºssen vermieden werden. </li></ul><br>  Laden Sie als N√§chstes den Smart-Vertrag auf Channel hoch und installieren Sie ihn: <br><br><img src="https://habrastorage.org/webt/ew/3a/ok/ew3aok9gsgrcaadaor-b0xwxllg.png" alt="Bild"><br><br>  Wir sehen uns die Transaktion zur Installation von Smart Contract an: <br><br><img src="https://habrastorage.org/webt/om/m4/x9/omm4x9np0s1i8wjki6guvvyc46o.png" alt="Bild"><br><br>  Wir schauen uns die Details zu unserem Kanal an: <br><br><img src="https://habrastorage.org/webt/tj/bd/eb/tjbdebruoky86aiwhx5t7ayqljq.png" alt="Bild"><br><br>  Als Ergebnis erhalten wir das folgende Blockchain-Netzwerkdiagramm in der IBM Cloud.  Es gibt auch ein Demo-Programm, das in der Amazon Cloud auf einem virtuellen Server ausgef√ºhrt wird (Einzelheiten finden Sie im n√§chsten Abschnitt): <br><br><img src="https://habrastorage.org/webt/bx/sb/1s/bxsb1s6s0c36u_2vh0lmjqmqj9u.png" alt="Bild"><br><br><h2>  Erstellen einer GUI f√ºr Hyperledger Fabric-API-Aufrufe </h2><br>  Hyperledger Fabric verf√ºgt √ºber eine API, mit der: <br><br><ul><li>  Kreationskanal; </li><li>  Peer-Verbindungen zum Kanal; </li><li>  Installation und Instanziierung intelligenter Vertr√§ge im Kanal; </li><li>  Transaktionsaufruf; </li><li>  Informationen zur Blockchain anfordern. </li></ul><br><h3>  Anwendungsentwicklung </h3><br>  In unserem Demo-Programm verwenden wir die API nur, um Transaktionen aufzurufen und Informationen anzufordern, weil  Die restlichen Schritte haben wir bereits mit der IBM Blockchain-Plattform unternommen.  Wir schreiben eine GUI mit einem Standard-Technologie-Stack: Express.js + Vue.js + Node.js.  Sie k√∂nnen einen separaten Artikel dar√ºber schreiben, wie Sie mit der Erstellung moderner Webanwendungen beginnen.  Hier werde ich einen Link zu der Vorlesungsreihe hinterlassen, die mir am besten gefallen hat: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Full Stack Web App mit Vue.js &amp; Express.js</a> .  Das Ergebnis ist eine Client-Server-Anwendung mit einer vertrauten grafischen Oberfl√§che im Stil von Material Design von Google.  Die REST-API zwischen Client und Server besteht aus mehreren Aufrufen: <br><br><ul><li>  HyperledgerDemo / v1 / init - initialisiert die Blockchain; </li><li>  HyperledgerDemo / v1 / accounts / list - Ruft eine Liste aller Konten ab </li><li>  HyperledgerDemo / v1 / account? Name = Bob &amp; balance = 100 - ein Bob-Konto erstellen; </li><li>  HyperledgerDemo / v1 / info? Account = Bob - Informationen zum Bob-Konto abrufen; </li><li>  HyperledgerDemo / v1 / transaction? Von = Bob &amp; zu = Alice &amp; Volumen = 2 - √úbertragen Sie zwei M√ºnzen von Bob zu Alice; </li><li>  HyperledgerDemo / v1 /connect - Schlie√üen Sie die Verbindung zur Blockchain. </li></ul><br>  Ich habe die Beschreibung der API mit Beispielen auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Postman-Website ver√∂ffentlicht</a> , einem bekannten Programm zum Testen der HTTP-API. <br><br><h3>  Amazon Cloud Demo-Anwendung </h3><br>  Die Anwendung wurde auf Amazon hochgeladen, weil  IBM konnte mein Konto bisher nicht aktualisieren und die Erstellung virtueller Server nicht zulassen.  Wie die Kirsche die Domain angeh√§ngt hat: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.citcoin.info</a> .  Ich werde den Server f√ºr eine Weile eingeschaltet lassen und ihn dann ausschalten, weil  Cent f√ºr Miete tropfen, und Citcoin-M√ºnzen sind noch nicht an der B√∂rse notiert.) Ich habe Screenshots der Demo in den Artikel eingef√ºgt, damit die Logik der Arbeit klar ist.  Demo-Anwendung kann: <br><br><ul><li>  Initialisieren Sie die Blockchain. </li><li>  Erstellen Sie ein Konto (erstellen Sie jetzt jedoch kein neues Konto, da die im Smart-Vertrag vorgeschriebene maximale Anzahl von Konten in der Blockchain erreicht wurde). </li><li>  Holen Sie sich eine Liste der Konten; </li><li>  √úbertragen Sie Citcoin-M√ºnzen zwischen Alice, Bob und Alex; </li><li>  Ereignisse empfangen (aber jetzt gibt es keine M√∂glichkeit, Ereignisse anzuzeigen. Der Einfachheit halber gibt die Benutzeroberfl√§che an, dass Ereignisse nicht unterst√ºtzt werden). </li><li>  Aktionen protokollieren. </li></ul><br>  Initialisieren Sie zun√§chst die Blockchain: <br><br><img src="https://habrastorage.org/webt/o8/j5/te/o8j5tev3u9drgclmlfzluoys-e4.png" alt="Bild"><br><br>  Als n√§chstes starten Sie Ihr Konto, spielen Sie nicht mit Guthaben: <br><br><img src="https://habrastorage.org/webt/e1/eo/ck/e1eockzjedclvktadadhnbsgkem.png" alt="Bild"><br><br>  Wir erhalten eine Liste aller verf√ºgbaren Konten: <br><br><img src="https://habrastorage.org/webt/_0/ih/o-/_0iho-vlhsg0v6abggskdshpmow.png" alt="Bild"><br><br>  Wir w√§hlen den Absender und den Empf√§nger aus, wir erhalten deren Guthaben.  Wenn der Absender und der Empf√§nger identisch sind, wird ihr Konto wieder aufgef√ºllt: <br><br><img src="https://habrastorage.org/webt/c7/go/vu/c7govuxmtn4wkcc_4byqz5dzgd8.png" alt="Bild"><br><br>  Im Protokoll √ºberwachen wir die Ausf√ºhrung von Transaktionen: <br><br><img src="https://habrastorage.org/webt/lw/sj/tb/lwsjtbmwe8oplpok_mg8ocvjirq.png" alt="Bild"><br><br>  Mit einem Demo-Programm ist das eigentlich alles.  Als n√§chstes k√∂nnen Sie unsere Transaktion in der Blockchain sehen: <br><br><img src="https://habrastorage.org/webt/cp/cu/ik/cpcuikr02wqi_nwht9liarcpkhk.png" alt="Bild"><br><br>  Und die allgemeine Liste der Transaktionen: <br><br><img src="https://habrastorage.org/webt/_z/1t/ej/_z1tejxfntvmmqugqzf04plkrae.png" alt="Bild"><br><br>  Damit haben wir die Implementierung von PoC zum Aufbau des Citcoin-Netzwerks erfolgreich abgeschlossen.  Was muss noch getan werden, damit Citcoin ein vollwertiges M√ºnztransfer-Netzwerk wird?  Wenig: <br><br><ul><li>  Implementieren Sie beim Erstellen eines Kontos die Generierung eines privaten / √∂ffentlichen Schl√ºssels.  Der private Schl√ºssel muss im Kontonutzer gespeichert sein, √∂ffentlich in der Blockchain. </li><li>  F√ºhren Sie eine M√ºnz√ºbertragung durch, bei der ein √∂ffentlicher Schl√ºssel verwendet wird, um den Benutzer zu identifizieren, nicht ein Name. </li><li>  Verschl√ºsseln Sie Transaktionen, die vom Benutzer zum Server gehen, mit seinem privaten Schl√ºssel. </li></ul><br><h2>  Fazit </h2><br>  Wir haben das Citcoin-Netzwerk mit folgenden Funktionen implementiert: Konto hinzuf√ºgen, Guthaben abrufen, Konto auff√ºllen, M√ºnzen von einem Konto auf ein anderes √ºbertragen.  Was hat uns der Bau von PoC gekostet? <br><br><ul><li>  Wir m√ºssen Blockchain im Allgemeinen und Hyperledger Fabric im Besonderen untersuchen. </li><li>  Erfahren Sie, wie Sie die IBM- oder Amazon-Clouds verwenden. </li><li>  Lernen Sie die Programmiersprache JS und einige Webframeworks. </li><li>  Wenn einige Daten nicht in der Blockchain, sondern in einer separaten Datenbank gespeichert werden m√ºssen, lernen Sie, wie Sie beispielsweise PostgreSQL integrieren. </li><li>  Und zu guter Letzt - ohne Linux-Kenntnisse in der modernen Welt nirgendwo!) </li></ul><br>  Nat√ºrlich keine Raketenwissenschaft, aber man muss schwitzen! <br><br><h3>  GitHub-Quellen </h3><br>  Er hat den Quellcode auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub gestellt</a> .  Eine kurze Beschreibung des Repositorys: <br>  Verzeichnis " <b>Server</b> " - Node.js Server <br>  Verzeichnis " <b>client</b> " - Node.js Client <br>  Das " <b>Blockchain</b> " -Verzeichnis (Parameterwerte und Schl√ºssel sind nat√ºrlich nicht funktionsf√§hig und dienen nur als Beispiel): <br><br><ul><li>  Vertrag - Quelle des intelligenten Vertrags </li><li>  Brieftasche - Benutzerschl√ºssel f√ºr die Verwendung der Hyperledger Fabric-API. </li><li>  * .cds - kompilierte Versionen von Smart Contracts </li><li>  * .json-Dateien - Beispielkonfigurationsdateien f√ºr die Verwendung der Hyperledger Fabric-API </li></ul><br>  <b><font color="#B22222">Es ist nur der Anfang!</font></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466157/">https://habr.com/ru/post/de466157/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466147/index.html">Reactive Data Display Manager. Einf√ºhrung</a></li>
<li><a href="../de466149/index.html">Erstellen eines Konnektorsymbols mit ‚Äûdynamischem‚Äú Text in OrCAD</a></li>
<li><a href="../de466151/index.html">Untersuchung: seltsame Programme im Register der inl√§ndischen Software</a></li>
<li><a href="../de466153/index.html">Erstellen eines Missionsdesign-Dokuments f√ºr ein narratives Spiel am Beispiel von Last of Us</a></li>
<li><a href="../de466155/index.html">Architektur und Funktionen des Tarantool-Datengitters</a></li>
<li><a href="../de466159/index.html">Warum Geschwindigkeit bei einem modernen Austausch wichtig ist und wie man Konkurrenten √ºberholt: 3 praktische M√∂glichkeiten</a></li>
<li><a href="../de466165/index.html">Wie k√ºnstliche Intelligenz bei der Verwaltung von Projekten hilft</a></li>
<li><a href="../de466169/index.html">Sonderangebot f√ºr berufst√§tige Studenten von JetBrains</a></li>
<li><a href="../de466171/index.html">F√ºnf Gr√ºnde f√ºr JUG.EKB</a></li>
<li><a href="../de466179/index.html">fform: React & JSONSchema - maximale Flexibilit√§t</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>