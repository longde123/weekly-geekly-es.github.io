<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèº üõ∞Ô∏è üå°Ô∏è Estamos desenvolvendo um projeto de aprendizado de m√°quina em Python. Parte 1 üßñüèΩ üëä ‚è´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tradu√ß√£o de um passo a passo completo do projeto de aprendizado de m√°quina em Python: parte um . 

 Quando voc√™ l√™ um livro ou ouve um curso de treina...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Estamos desenvolvendo um projeto de aprendizado de m√°quina em Python. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/425253/"><img src="https://habrastorage.org/getpro/habr/post_images/5de/fed/62e/5defed62ea348f6e02365e283415b2fb.png"><br><br>  <i>Tradu√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um passo a passo completo do projeto de aprendizado de m√°quina em Python: parte um</a> .</i> <br><br>  Quando voc√™ l√™ um livro ou ouve um curso de treinamento em an√°lise de dados, geralmente sente que est√° enfrentando partes separadas de uma imagem que n√£o podem ser reunidas.  Voc√™ pode se assustar com a perspectiva de dar o pr√≥ximo passo e resolver completamente um problema com a ajuda do aprendizado de m√°quina, mas com a ajuda desta s√©rie de artigos, voc√™ ganhar√° confian√ßa na capacidade de resolver qualquer problema no campo da ci√™ncia de dados. <br><br>  Para que voc√™ possa finalmente ter uma imagem completa em sua cabe√ßa, sugerimos analisar do in√≠cio ao fim o projeto de uso do aprendizado de m√°quina usando dados reais. <br><a name="habracut"></a><br>  Siga sucessivamente as etapas: <br><br><ol><li>  Limpeza e formata√ß√£o de dados. </li><li>  An√°lise explorat√≥ria de dados. </li><li>  Design e sele√ß√£o de recursos. </li><li>  Compara√ß√£o das m√©tricas de v√°rios modelos de aprendizado de m√°quina. </li><li>  Ajuste hiperparam√©trico do melhor modelo. </li><li>  Avalia√ß√£o do melhor modelo em um conjunto de dados de teste. </li><li>  Interpreta√ß√£o dos resultados do modelo. </li><li>  Conclus√µes e trabalho com documentos. </li></ol><br>  Voc√™ aprender√° como os est√°gios se entrela√ßam e como implement√°-los no Python.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Todo o projeto</a> est√° dispon√≠vel no GitHub, a primeira parte est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui.</a>  Neste artigo, consideraremos os tr√™s primeiros est√°gios. <br><br><h2>  Descri√ß√£o da tarefa </h2><br>  Antes de escrever o c√≥digo, voc√™ precisa entender o problema que est√° sendo resolvido e os dados dispon√≠veis.  Neste projeto, trabalharemos com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dados de efici√™ncia energ√©tica</a> dispon√≠veis ao p√∫blico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">para edif√≠cios</a> em Nova York. <br><br>  Nosso objetivo: usar os dados dispon√≠veis para criar um modelo que preveja o n√∫mero de Energy Star Score para um edif√≠cio em particular e interpretar os resultados para encontrar fatores que influenciam a pontua√ß√£o final. <br><br>  Os dados j√° incluem o Energy Star Score atribu√≠do, portanto, nossa tarefa √© o aprendizado de m√°quina com regress√£o controlada: <br><br><ul><li>  Supervisionado: Conhecemos os sinais e o objetivo, e nossa tarefa √© treinar um modelo que possa comparar o primeiro com o segundo. </li><li>  Regress√£o: O Energy Star Score √© uma vari√°vel cont√≠nua. </li></ul><br>  Nosso modelo deve ser preciso - para que possa prever o valor do Energy Star Score pr√≥ximo ao verdadeiro - e interpret√°vel - para que possamos entender suas previs√µes.  Conhecendo os dados de destino, podemos us√°-los ao tomar decis√µes √† medida que nos aprofundamos nos dados e criamos o modelo. <br><br><h2>  Limpeza de dados </h2><br>  Nem todo conjunto de dados √© um conjunto de observa√ß√µes perfeitamente correspondido, sem anomalias e valores ausentes (uma dica dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conjuntos de dados mtcars</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√≠ris</a> ).  Em dados reais, h√° pouca ordem; portanto, antes de iniciar a an√°lise, √© necess√°rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">limp√°-la e traz√™-la</a> para um formato aceit√°vel.  A limpeza de dados √© um procedimento desagrad√°vel, mas obrigat√≥rio, para solucionar a maioria das tarefas de an√°lise de dados. <br><br>  Primeiro, voc√™ pode carregar os dados como um quadro de dados do Pandas e examin√°-los: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np # <span class="hljs-keyword"><span class="hljs-keyword">Read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> a dataframe data = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/Energy_and_Water_Data_Disclosure_for_Local_Law_84_2017__Data_for_Calendar_Year_2016_.csv'</span></span>) # Display top <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> dataframe data.head()</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/4ac/637/b86/4ac637b8682b2fcacddd155004681a0d.png"><br>  <i>√â assim que os dados reais s√£o exibidos.</i> <br><br>  Este √© um fragmento de uma tabela de 60 colunas.  Mesmo aqui, v√°rios problemas s√£o vis√≠veis: precisamos prever o <code>Energy Star Score</code> , mas n√£o sabemos o que todas essas colunas significam.  Embora isso n√£o seja necessariamente um problema, porque muitas vezes voc√™ pode criar um modelo preciso sem saber nada sobre vari√°veis.  Mas a interpretabilidade √© importante para n√≥s, portanto, precisamos descobrir o significado de pelo menos algumas colunas. <br><br>  Quando recebemos esses dados, n√£o perguntamos sobre os valores, mas analisamos o nome do arquivo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a86/c00/ab2/a86c00ab2d64629e644e7186c78724f7.png"><br><br>  e decidiu procurar a "Lei local 84".  Encontramos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">esta p√°gina</a> , que dizia que era uma lei de Nova York, segundo a qual os propriet√°rios de todos os edif√≠cios de um determinado tamanho deveriam informar sobre o consumo de energia.  Uma pesquisa adicional ajudou a encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">todos os valores da coluna</a> .  Portanto, n√£o negligencie os nomes dos arquivos, eles podem ser um bom ponto de partida.  Al√©m disso, este √© um lembrete de que voc√™ n√£o se apressa e n√£o perde algo importante! <br><br>  N√£o estudaremos todas as colunas, mas definitivamente lidaremos com o Energy Star Score, descrito a seguir: <br><br><blockquote>  A classifica√ß√£o percentual √© de 1 a 100, calculada com base em relat√≥rios anuais sobre o consumo de energia pelos pr√≥prios propriet√°rios do edif√≠cio.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Energy Star Score</a> √© uma medida relativa usada para comparar o desempenho energ√©tico dos edif√≠cios. </blockquote><br>  O primeiro problema foi resolvido, mas o segundo permaneceu - valores ausentes, marcados como "N√£o dispon√≠vel".  Este √© um valor de string no Python, o que significa que mesmo as strings com n√∫meros ser√£o armazenadas como tipos de dados do <code>object</code> , porque se houver alguma string na coluna, o Pandas o converter√° em uma coluna que consiste inteiramente de string.  Os tipos de dados da coluna podem ser encontrados usando o m√©todo <code>dataframe.info()</code> : <br><br><pre> <code class="hljs pgsql"># See the <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> non-missing <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> data.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>()</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/db3/b4d/013/db3b4d013ca25d7e5ac483f0c24fa1e4.png"><br><br>  Certamente algumas colunas que cont√™m explicitamente n√∫meros (como ft¬≤) s√£o armazenadas como objetos.  Como n√£o podemos aplicar a an√°lise num√©rica a valores de string, convertemos-os em tipos de dados num√©ricos (especialmente <code>float</code> )! <br><br>  Esse c√≥digo substitui primeiro todos os "N√£o dispon√≠veis" por <i>n√£o um n√∫mero</i> ( <code>np.nan</code> ), que pode ser interpretado como n√∫meros e, em seguida, converte o conte√∫do de determinadas colunas em um tipo de <code>float</code> : <br><br><pre> <code class="hljs pgsql"># Replace <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> occurrences <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> Available <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> a number data = data.replace({<span class="hljs-string"><span class="hljs-string">'Not Available'</span></span>: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>}) # Iterate through the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> list(data.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>): # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> that should be <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'ft¬≤'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'kBtu'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'Metric Tons CO2e'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'kWh'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'therms'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'gal'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'Score'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col): # Convert the data <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> data[col] = data[col].astype(<span class="hljs-type"><span class="hljs-type">float</span></span>)</code> </pre> <br>  Quando os valores nas colunas correspondentes conosco se tornam n√∫meros, podemos come√ßar a examinar os dados. <br><br><h4>  Dados ausentes e anormais </h4><br>  Juntamente com os tipos de dados incorretos, um dos problemas mais comuns est√° faltando valores.  Eles podem estar ausentes por v√°rios motivos e, antes de treinar o modelo, esses valores devem ser preenchidos ou exclu√≠dos.  Primeiro, vamos descobrir quantos valores temos em cada coluna (o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo est√° aqui</a> ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b0/5da/a40/0b05daa40ba77acca25ed859856759f2.png"><br>  <i>Para criar uma tabela, uma fun√ß√£o de uma ramifica√ß√£o no <u>StackOverflow foi usada</u> .</i> <br><br>  As informa√ß√µes sempre devem ser removidas com cuidado e, se houver muitos valores na coluna, provavelmente n√£o beneficiar√° nosso modelo.  O limite ap√≥s o qual √© melhor descartar as colunas depende da sua tarefa ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui est√° uma discuss√£o</a> ) e, em nosso projeto, excluiremos as colunas que estiverem mais da metade vazias. <br><br>  Tamb√©m nesta fase, √© melhor remover os valores anormais.  Eles podem ocorrer devido a erros de digita√ß√£o ao inserir dados ou devido a erros nas unidades de medida, ou podem estar corretos, mas com valores extremos.  Nesse caso, removeremos os valores "extras", guiados pela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">defini√ß√£o de anomalias extremas</a> : <br><br><ul><li>  Abaixo do primeiro quartil, h√° uma faixa interquartil de 3.. </li><li>  Acima do terceiro quartil + 3 range intervalo interquartil. </li></ul><br>  O c√≥digo que remove colunas e anomalias est√° listado no Bloco de Notas no Github.  Ap√≥s a conclus√£o do processo de limpeza de dados e remo√ß√£o de anomalias, temos mais de 11.000 pr√©dios e 49 placas. <br><br><h2>  An√°lise explorat√≥ria de dados </h2><br>  A fase chata, mas necess√°ria da limpeza dos dados est√° conclu√≠da, voc√™ pode ir para o estudo!  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A an√°lise explorat√≥ria de dados</a> (RAD) √© um processo de tempo ilimitado durante o qual calculamos estat√≠sticas e procuramos tend√™ncias, anomalias, padr√µes ou relacionamentos nos dados. <br><br>  Em suma, o RAD √© uma tentativa de descobrir o que os dados podem nos dizer.  Geralmente, a an√°lise come√ßa com uma revis√£o superficial, depois encontramos fragmentos interessantes e os analisamos com mais detalhes.  As descobertas podem ser interessantes por si s√≥, ou podem contribuir para a escolha do modelo, ajudando a decidir quais recursos usaremos. <br><br><h4>  Gr√°ficos de vari√°vel √∫nica </h4><br>  Nosso objetivo √© prever o valor do Energy Star Score (renomeado para nossa <code>score</code> em nossos dados), portanto, faz sentido come√ßar examinando a distribui√ß√£o dessa vari√°vel.  Um histograma √© uma maneira simples, mas eficaz, de visualizar a distribui√ß√£o de uma √∫nica vari√°vel e pode ser facilmente constru√≠do usando o <code>matplotlib</code> . <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt # Histogram <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the Energy Star Score plt.style.use(<span class="hljs-string"><span class="hljs-string">'fivethirtyeight'</span></span>) plt.hist(data[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].dropna(), bins = <span class="hljs-number"><span class="hljs-number">100</span></span>, edgecolor = <span class="hljs-string"><span class="hljs-string">'k'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Score'</span></span>); plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Number of Buildings'</span></span>); plt.title(<span class="hljs-string"><span class="hljs-string">'Energy Star Score Distribution'</span></span>);</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/f82/bf3/84a/f82bf384af1bd0c407f1e680d0b47263.png"><br><br>  Parece suspeito!  O Energy Star Score √© um percentil, portanto, voc√™ deve esperar uma distribui√ß√£o uniforme quando cada ponto for atribu√≠do ao mesmo n√∫mero de edif√≠cios.  No entanto, um n√∫mero desproporcionalmente grande de edif√≠cios recebeu os resultados mais altos e mais baixos (para o Energy Star Score, quanto maior, melhor). <br><br>  Se olharmos novamente para a defini√ß√£o dessa pontua√ß√£o, veremos que ela √© calculada com base em "relat√≥rios preenchidos independentemente pelos propriet√°rios dos pr√©dios", o que pode explicar o excesso de valores muito grandes.  Pedir aos propriet√°rios dos edif√≠cios que relatem seu consumo de energia √© como pedir aos alunos que relatem suas notas nos exames.  Portanto, esse talvez n√£o seja o crit√©rio mais objetivo para avaliar a efici√™ncia energ√©tica dos im√≥veis. <br><br>  Se tiv√©ssemos um suprimento ilimitado de tempo, poder√≠amos descobrir por que tantos pr√©dios tinham pontos muito altos e muito baixos.  Para fazer isso, ter√≠amos que escolher os edif√≠cios apropriados e analis√°-los cuidadosamente.  Mas precisamos apenas aprender a prever pontua√ß√µes e n√£o desenvolver um m√©todo de avalia√ß√£o mais preciso.  Voc√™ pode marcar a si mesmo que os pontos t√™m uma distribui√ß√£o suspeita, mas vamos nos concentrar na previs√£o. <br><br><h4>  Pesquisa de relacionamento </h4><br>  A parte principal do AHFR √© a busca pela rela√ß√£o entre sinais e nosso objetivo.  Vari√°veis ‚Äã‚Äãcorrelacionadas a ele s√£o √∫teis para uso no modelo, porque podem ser usadas para previs√£o.  Uma maneira de estudar o efeito de uma vari√°vel categ√≥rica (que leva apenas um conjunto limitado de valores) sobre o objetivo √© plotar a densidade usando a biblioteca Seaborn. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O gr√°fico de densidade pode ser considerado um histograma suavizado</a> porque mostra a distribui√ß√£o de uma √∫nica vari√°vel.  Voc√™ pode colorir classes individuais no gr√°fico para ver como uma vari√°vel categ√≥rica altera a distribui√ß√£o.  Este c√≥digo plota o gr√°fico de densidade do Energy Star Score, colorido de acordo com o tipo de edif√≠cio (para uma lista de edif√≠cios com mais de 100 dimens√µes): <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> a list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> buildings <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> more than <span class="hljs-number"><span class="hljs-number">100</span></span> measurements <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = data.dropna(subset=[<span class="hljs-string"><span class="hljs-string">'score'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">types</span></span>[<span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>].value_counts() <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = list(<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) # Plot <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> distribution <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> scores <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building categories figsize(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) # Plot <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> building <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b_type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">types</span></span>: # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the building <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> subset = data[data[<span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>] == b_type] # Density plot <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> Energy Star Scores sns.kdeplot(subset[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].dropna(), label = b_type, shade = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.8</span></span>); # label the plot plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Energy Star Score'</span></span>, size = <span class="hljs-number"><span class="hljs-number">20</span></span>); plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Density'</span></span>, size = <span class="hljs-number"><span class="hljs-number">20</span></span>); plt.title(<span class="hljs-string"><span class="hljs-string">'Density Plot of Energy Star Scores by Building Type'</span></span>, size = <span class="hljs-number"><span class="hljs-number">28</span></span>);</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/23a/718/fd3/23a718fd3139123b609e2521ffe46e3c.png"><br><br>  Como voc√™ pode ver, o tipo de constru√ß√£o afeta muito o n√∫mero de pontos.  Os edif√≠cios de escrit√≥rios costumam ter uma pontua√ß√£o mais alta e os hot√©is mais baixos.  Portanto, voc√™ precisa incluir o tipo de constru√ß√£o no modelo, porque esse sinal afeta nosso objetivo.  Como vari√°vel categ√≥rica, devemos executar a codifica√ß√£o one-hot do tipo de constru√ß√£o. <br><br>  Um gr√°fico semelhante pode ser usado para estimar o Energy Star Score por distrito da cidade: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/224/c69/820/224c69820a5c0362f804e37ae7d5de55.png"><br><br>  A √°rea n√£o afeta a pontua√ß√£o tanto quanto o tipo de constru√ß√£o.  No entanto, vamos inclu√≠-lo no modelo, porque h√° uma pequena diferen√ßa entre as regi√µes. <br><br>  Para calcular o relacionamento entre as vari√°veis, voc√™ pode usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o coeficiente de correla√ß√£o de Pearson</a> .  Esta √© uma medida da intensidade e dire√ß√£o de um relacionamento linear entre duas vari√°veis.  Um valor de +1 significa uma rela√ß√£o positiva perfeitamente linear e -1 significa uma rela√ß√£o negativa perfeitamente linear.  Aqui est√£o alguns exemplos dos valores do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">coeficiente de correla√ß√£o</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pearson</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b3/455/654/0b34556548ab206112024fb0e8f69c01.png"><br><br>  Embora esse coeficiente n√£o possa refletir depend√™ncias n√£o lineares, √© poss√≠vel come√ßar com ele para avaliar os relacionamentos das vari√°veis.  No Pandas, voc√™ pode calcular facilmente as correla√ß√µes entre quaisquer colunas em um dataframe: <br><br><pre> <code class="hljs pgsql"># Find <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> correlations <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the score <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> sort correlations_data = data.corr()[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].sort_values()</code> </pre> <br>  As correla√ß√µes mais negativas com a meta: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b62/181/178/b62181178669962fccf7caa472d9e2e8.png"><br><br>  e o mais positivo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/598/47f/14a/59847f14a4d8afe1ce8ff237c5d3fa36.png"><br><br>  Existem v√°rias correla√ß√µes negativas fortes entre os atributos e a meta, e a maior delas pertence a diferentes categorias da EUI (os m√©todos para calcular esses indicadores diferem ligeiramente).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">EUI (Energy Use Intensity</a> ) √© a quantidade de energia consumida por um edif√≠cio dividido por um p√© quadrado de √°rea.  Esse valor espec√≠fico √© usado para avaliar a efici√™ncia energ√©tica e, quanto menor, melhor.  A l√≥gica sugere que essas correla√ß√µes sejam justificadas: se a EUI aumentar, o Energy Star Score dever√° declinar. <br><br><h4>  Gr√°ficos de duas vari√°veis </h4><br>  Usamos gr√°ficos de dispers√£o para visualizar os relacionamentos entre duas vari√°veis ‚Äã‚Äãcont√≠nuas.  Voc√™ pode adicionar informa√ß√µes adicionais √†s cores dos pontos, por exemplo, uma vari√°vel categ√≥rica.  A rela√ß√£o entre o Energy Star Score e o EUI √© mostrada abaixo; as cores indicam diferentes tipos de edif√≠cios: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/974/204/7de/9742047ded29c74a9a8e6df9bf6396d1.png"><br><br>  Este gr√°fico permite visualizar um coeficiente de correla√ß√£o de -0,7.  √Ä medida que o EUI diminui, o Energy Star Score aumenta, essa rela√ß√£o √© observada em diferentes tipos de edif√≠cios. <br><br>  Nosso gr√°fico de pesquisa mais recente √© chamado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gr√°fico de pares</a> .  Essa √© uma √≥tima ferramenta para ver os relacionamentos entre diferentes pares de vari√°veis ‚Äã‚Äãe a distribui√ß√£o de vari√°veis ‚Äã‚Äã√∫nicas.  Usaremos a biblioteca Seaborn e a fun√ß√£o PairGrid para criar um gr√°fico de pares com um gr√°fico de dispers√£o no tri√¢ngulo superior, com um histograma diagonal, um gr√°fico de densidade de n√∫cleo bidimensional e coeficientes de correla√ß√£o no tri√¢ngulo inferior. <br><br><pre> <code class="hljs pgsql"># Extract the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> plot plot_data = features[[<span class="hljs-string"><span class="hljs-string">'score'</span></span>, <span class="hljs-string"><span class="hljs-string">'Site EUI (kBtu/ft¬≤)'</span></span>, <span class="hljs-string"><span class="hljs-string">'Weather Normalized Source EUI (kBtu/ft¬≤)'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_Total GHG Emissions (Metric Tons CO2e)'</span></span>]] # Replace the inf <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nan</span></span> plot_data = plot_data.replace({np.inf: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>, -np.inf: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>}) # <span class="hljs-keyword"><span class="hljs-keyword">Rename</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> plot_data = plot_data.<span class="hljs-keyword"><span class="hljs-keyword">rename</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> = {<span class="hljs-string"><span class="hljs-string">'Site EUI (kBtu/ft¬≤)'</span></span>: <span class="hljs-string"><span class="hljs-string">'Site EUI'</span></span>, <span class="hljs-string"><span class="hljs-string">'Weather Normalized Source EUI (kBtu/ft¬≤)'</span></span>: <span class="hljs-string"><span class="hljs-string">'Weather Norm EUI'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_Total GHG Emissions (Metric Tons CO2e)'</span></span>: <span class="hljs-string"><span class="hljs-string">'log GHG Emissions'</span></span>}) # <span class="hljs-keyword"><span class="hljs-keyword">Drop</span></span> na <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> plot_data = plot_data.dropna() # <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> calculate correlation coefficient <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> two <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> def corr_func(x, y, **kwargs): r = np.corrcoef(x, y)[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] ax = plt.gca() ax.annotate("r = {:.2f}".format(r), xy=(<span class="hljs-number"><span class="hljs-number">.2</span></span>, <span class="hljs-number"><span class="hljs-number">.8</span></span>), xycoords=ax.transAxes, size = <span class="hljs-number"><span class="hljs-number">20</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> the pairgrid <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> grid = sns.PairGrid(data = plot_data, size = <span class="hljs-number"><span class="hljs-number">3</span></span>) # Upper <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a scatter plot grid.map_upper(plt.scatter, color = <span class="hljs-string"><span class="hljs-string">'red'</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.6</span></span>) # Diagonal <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a histogram grid.map_diag(plt.hist, color = <span class="hljs-string"><span class="hljs-string">'red'</span></span>, edgecolor = <span class="hljs-string"><span class="hljs-string">'black'</span></span>) # Bottom <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> correlation <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> density plot grid.map_lower(corr_func); grid.map_lower(sns.kdeplot, cmap = plt.cm.Reds) # Title <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> entire plot plt.suptitle(<span class="hljs-string"><span class="hljs-string">'Pairs Plot of Energy Data'</span></span>, size = <span class="hljs-number"><span class="hljs-number">36</span></span>, y = <span class="hljs-number"><span class="hljs-number">1.02</span></span>);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/5fa/4cc/94f/5fa4cc94f9b91df5ad4fda37aa3ae1f0.png"><br><br>  Para ver o relacionamento das vari√°veis, procure a interse√ß√£o de linhas e colunas.  Suponha que voc√™ queira examinar a correla√ß√£o entre a <code>Weather Norm EUI</code> e a <code>score</code> ; em seguida, procuraremos a s√©rie <code>Weather Norm EUI</code> e a coluna de <code>score</code> , na interse√ß√£o na qual existe um coeficiente de correla√ß√£o de -0,67.  Esses gr√°ficos n√£o apenas parecem legais, mas tamb√©m ajudam a escolher vari√°veis ‚Äã‚Äãpara o modelo. <br><br><h2>  Design e sele√ß√£o de recursos </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projetar e selecionar recursos</a> geralmente traz o maior retorno em termos de tempo gasto em aprendizado de m√°quina.  Primeiro, damos as defini√ß√µes: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Constru√ß√£o de caracter√≠sticas: o</a> processo de extrair ou criar novas caracter√≠sticas dos dados brutos.  Para usar vari√°veis ‚Äã‚Äãno modelo, pode ser necess√°rio transform√°-las, digamos, pegar o logaritmo natural, extrair a raiz quadrada ou aplicar uma codifica√ß√£o de vari√°veis ‚Äã‚Äãcateg√≥ricas de um s√≥ ponto.  O design de caracter√≠sticas pode ser considerado como a cria√ß√£o de recursos adicionais a partir de dados brutos. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sele√ß√£o de recursos: o</a> processo de sele√ß√£o dos recursos mais relevantes dos dados, durante o qual removemos alguns recursos para ajudar o modelo a generalizar melhor os novos dados, a fim de obter um modelo mais interpret√°vel.  A escolha dos sinais pode ser considerada como a remo√ß√£o de ‚Äúsup√©rfluo‚Äù, de modo que apenas o mais importante permanece. </li></ul><br>  O modelo de aprendizado de m√°quina s√≥ pode aprender com os dados que fornecemos, por isso √© extremamente importante garantir que incluamos todas as informa√ß√µes relevantes para nossa tarefa.  Se voc√™ n√£o fornecer o modelo com os dados corretos, ele n√£o poder√° aprender e n√£o produzir√° previs√µes precisas! <br><br>  Faremos o seguinte: <br><br><ul><li>  Aplic√°vel a vari√°veis ‚Äã‚Äãcateg√≥ricas (trimestre e tipo de propriedade) codifica√ß√£o one-hot. </li><li>  Adicione o logaritmo natural de todas as vari√°veis ‚Äã‚Äãnum√©ricas. </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A codifica√ß√£o one-hot √©</a> necess√°ria para incluir vari√°veis ‚Äã‚Äãcateg√≥ricas no modelo.  O algoritmo de aprendizado de m√°quina n√£o ser√° capaz de entender o tipo de "escrit√≥rio"; portanto, se o pr√©dio for um escrit√≥rio, atribuiremos a ele um sinal de 1 e, se n√£o for um escrit√≥rio, ent√£o 0. <br><br>  A adi√ß√£o de recursos transformados ajudar√° o modelo a aprender sobre relacionamentos n√£o lineares nos dados.  Na an√°lise dos dados, √© pr√°tica comum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">extrair ra√≠zes quadradas, obter logaritmos naturais ou de alguma forma transformar os sinais</a> , isso depende da tarefa espec√≠fica ou do seu conhecimento das melhores t√©cnicas.  Nesse caso, adicionaremos o logaritmo natural de todos os sinais num√©ricos. <br><br>  Esse c√≥digo seleciona sinais num√©ricos, calcula seus logaritmos, seleciona dois sinais categ√≥ricos, aplica codifica√ß√£o one-hot a eles e combina os dois conjuntos em um.  A julgar pela descri√ß√£o, ainda h√° muito trabalho a ser feito, mas no Pandas tudo √© bem simples! <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Copy</span></span> the original data features = data.<span class="hljs-keyword"><span class="hljs-keyword">copy</span></span>() # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> numeric_subset = data.select_dtypes(<span class="hljs-string"><span class="hljs-string">'number'</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> numeric_subset.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>: # Skip the Energy Star Score <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> col == <span class="hljs-string"><span class="hljs-string">'score'</span></span>: next <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: numeric_subset[<span class="hljs-string"><span class="hljs-string">'log_'</span></span> + col] = np.log(numeric_subset[col]) # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the categorical <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> categorical_subset = data[[<span class="hljs-string"><span class="hljs-string">'Borough'</span></span>, <span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>]] # One hot encode categorical_subset = pd.get_dummies(categorical_subset) # <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> the two dataframes <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> concat # Make sure <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> use axis = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">perform</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> bind features = pd.concat([numeric_subset, categorical_subset], axis = <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Agora, temos mais de 11.000 observa√ß√µes (edif√≠cios) com 110 colunas (tags).  Nem todos os sinais ser√£o √∫teis para prever o Energy Star Score, portanto, selecionaremos os sinais e removeremos algumas das vari√°veis. <br><br><h4>  Sele√ß√£o de Recursos </h4><br>  Muitos dos 110 sinais dispon√≠veis s√£o redundantes porque se correlacionam fortemente entre si.  Por exemplo, aqui est√° um gr√°fico do EUI e do Site Normalizado do Tempo EUI, com um coeficiente de correla√ß√£o de 0,997. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ab/c4f/ad8/4abc4fad887ef202d8d40961a8b02c34.png"><br><br>  Sinais que se correlacionam fortemente s√£o chamados de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">colineares</a> .  A remo√ß√£o de uma vari√°vel nesses pares de atributos geralmente ajuda o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">modelo a generalizar e a ser mais interpret√°vel</a> .  Observe que estamos falando sobre a correla√ß√£o de alguns sinais com outros, e n√£o sobre a correla√ß√£o com a meta, o que apenas ajudaria nosso modelo! <br><br>  Existem v√°rios m√©todos para calcular a colinearidade de recursos, e um dos mais populares √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fator de infla√ß√£o</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">varia√ß√£o</a> .  Usaremos o coeficiente de correla√ß√£o b para pesquisar e remover recursos colineares.  Descartamos um par de sinais se o coeficiente de correla√ß√£o entre eles for maior que 0,6.  O c√≥digo est√° no bloco de notas (e em resposta ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estouro de pilha</a> ). <br><br>  Esse valor parece arbitr√°rio, mas, na verdade, tentei limites diferentes, e o exposto acima me permitiu criar o melhor modelo.  O aprendizado de m√°quina √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">emp√≠rico</a> e, muitas vezes, √© necess√°rio experimentar para encontrar a melhor solu√ß√£o.  Ap√≥s a sele√ß√£o, temos 64 atributos e um objetivo. <br><br><pre> <code class="hljs pgsql"># Remove <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> na <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> features = features.dropna(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, how = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) print(features.shape) (<span class="hljs-number"><span class="hljs-number">11319</span></span>, <span class="hljs-number"><span class="hljs-number">65</span></span>)</code> </pre> <br><h2>  Escolha um n√≠vel b√°sico </h2><br>  Limpamos os dados, realizamos uma an√°lise explorat√≥ria e constru√≠mos os sinais.  E antes de prosseguir com a cria√ß√£o do modelo, √© necess√°rio selecionar o n√≠vel base inicial (linha de base ing√™nua) - um tipo de suposi√ß√£o com a qual compararemos os resultados dos modelos.  Se eles ficarem abaixo do n√≠vel b√°sico, assumiremos que o aprendizado de m√°quina n√£o √© aplic√°vel a esta tarefa ou que uma abordagem diferente deve ser tentada. <br><br>  Para tarefas de regress√£o, como n√≠vel b√°sico, √© razo√°vel adivinhar o valor mediano da meta no conjunto de treinamento para todos os exemplos no conjunto de testes.  Esses kits estabelecem uma barreira relativamente baixa para qualquer modelo. <br><br>  Como m√©trica, adotamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">erro absoluto m√©dio (mae)</a> nas previs√µes.  Existem muitas outras m√©tricas para regress√µes, mas eu gosto do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conselho</a> de escolher uma m√©trica e us√°-la para avaliar modelos.  E o erro absoluto m√©dio √© f√°cil de calcular e interpretar. <br><br>  Antes de calcular o n√≠vel b√°sico, √© necess√°rio dividir os dados em conjuntos de treinamento e teste: <br><br><ol><li>  Um conjunto de atributos de treinamento √© o que fornecemos ao nosso modelo, juntamente com as respostas durante o treinamento.  O modelo deve aprender a corresponder √†s caracter√≠sticas da meta. </li><li>  Um conjunto de recursos de teste √© usado para avaliar o modelo treinado.  Quando ela processa o conjunto de testes, ela n√£o v√™ as respostas corretas e deve prever com base apenas nos recursos dispon√≠veis.  Conhecemos as respostas para os dados de teste e podemos comparar os resultados da previs√£o com eles. </li></ol><br>  Para treinamento, usamos 70% dos dados e para teste - 30%: <br><br><pre> <code class="hljs pgsql"># Split <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> <span class="hljs-number"><span class="hljs-number">70</span></span>% training <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span>% testing <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> X, X_test, y, y_test = train_test_split(features, targets, test_size = <span class="hljs-number"><span class="hljs-number">0.3</span></span>, random_state = <span class="hljs-number"><span class="hljs-number">42</span></span>)</code> </pre> <br>  Agora calculamos o indicador para o n√≠vel base inicial: <br><br><pre> <code class="hljs vhdl"># <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> calculate mean absolute <span class="hljs-literal"><span class="hljs-literal">error</span></span> def mae(y_true, y_pred): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.mean(<span class="hljs-keyword"><span class="hljs-keyword">abs</span></span>(y_true - y_pred)) baseline_guess = np.median(y) print(<span class="hljs-symbol"><span class="hljs-symbol">'The</span></span> baseline guess <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a score <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> %<span class="hljs-number"><span class="hljs-number">0.2</span></span>f' % baseline_guess) print(<span class="hljs-string"><span class="hljs-string">"Baseline Performance on the test set: MAE = %0.4f"</span></span> % mae(y_test, baseline_guess))</code> </pre> <br>  <b>O palpite de linha de base √© uma pontua√ß√£o de 66,00</b> <b><br></b>  <b>Desempenho da linha de base no conjunto de testes: MAE = 24.5164</b> <br><br>  O erro absoluto m√©dio no conjunto de testes foi de cerca de 25 pontos.  Como avaliamos no intervalo de 1 a 100, o erro √© de 25% - uma barreira bastante baixa para o modelo! <br><br><h2>  Conclus√£o </h2><br>  Voc√™ neste artigo, passamos pelas tr√™s primeiras etapas da solu√ß√£o de um problema usando o aprendizado de m√°quina.  Depois de definir a tarefa, n√≥s: <br><br><ol><li>  Dados brutos limpos e formatados. </li><li>  Realizou an√°lise explorat√≥ria para estudar os dados dispon√≠veis. </li><li>  Desenvolvemos um conjunto de recursos que usaremos para nossos modelos. </li></ol><br> ,    ,       . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Scikit-Learn</a>    ,        . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt425253/">https://habr.com/ru/post/pt425253/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt425243/index.html">O manual de john willis</a></li>
<li><a href="../pt425245/index.html">An√∫ncio do RamblerFront & # 6</a></li>
<li><a href="../pt425247/index.html">Crowdsourcing em testes</a></li>
<li><a href="../pt425249/index.html">Como √© o conhecimento do LLP na ITMO University: o curso "Programa√ß√£o de baixo n√≠vel"</a></li>
<li><a href="../pt425251/index.html">LoJax: o primeiro rootkit UEFI conhecido usado em uma campanha maliciosa</a></li>
<li><a href="../pt425255/index.html">Algoritmo de compacta√ß√£o sem perdas de Broo e codifica√ß√£o delta, compara√ß√£o com o Xdelta3. Desenvolvimento de projetos residenciais</a></li>
<li><a href="../pt425259/index.html">Fazendo backup do seu site usando git e Makefile</a></li>
<li><a href="../pt425261/index.html">Certificados EV est√£o mortos</a></li>
<li><a href="../pt425263/index.html">O festival iFEST ser√° realizado em N√≠jni Novgorod</a></li>
<li><a href="../pt425265/index.html">Regras de desenvolvimento no Yandex.Health</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>