<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∏ üïî üîÖ Actualizar punto de control de R77.30 a 80.20 üë∏üèø üöà üè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el oto√±o de 2019, Check Point dej√≥ de admitir las versiones R77.XX y necesitaba ser actualizado. Ya se ha dicho mucho sobre la diferencia entre las...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Actualizar punto de control de R77.30 a 80.20</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/484170/"><img src="https://habrastorage.org/webt/iz/bu/-j/izbu-j4fcyoxpsga-spzdz-rujc.png"><br><br>  En el oto√±o de 2019, Check Point dej√≥ de admitir las versiones R77.XX y necesitaba ser actualizado.  Ya se ha dicho mucho sobre la diferencia entre las versiones, los pros y los contras de la transici√≥n al R80.  Hablemos sobre c√≥mo actualizar realmente el Check Point del dispositivo virtual (CloudGuard para VMware ESXi, Hyper-V, KVM Gateway NGTP) y qu√© podr√≠a salir mal. <br><br>  Entonces, ten√≠amos 2 ingenieros de CCSE, m√°s de una docena de cl√∫steres virtuales Check Point R77.30, varias nubes, algunas peque√±as revisiones y un mar entero de varios errores, fallas y todo eso, todos los colores y tama√±os, y tambi√©n plazos muy ajustados.  Vamos! <br><blockquote>  <b>Contenido:</b> <br><br>  <a href="https://habr.com/ru/company/dataline/blog/484170/">Preparaci√≥n</a> <br>  <a href="https://habr.com/ru/company/dataline/blog/484170/">Actualizaci√≥n del servidor de administraci√≥n</a> <br>  <a href="https://habr.com/ru/company/dataline/blog/484170/">Actualizaci√≥n del cl√∫ster</a> <br></blockquote><br><img src="https://habrastorage.org/webt/ng/ow/ye/ngowyegpn17chzucgvdx_afc2ag.png"><br><br>  <i>As√≠ es como se ve una infraestructura de nube de cliente t√≠pica con Check Point virtual</i> <br><a name="habracut"></a><br><a name="ONE"></a><h2>  Preparaci√≥n </h2><br>  En primer lugar, debe verificar la suficiencia de recursos para la actualizaci√≥n.  Los requisitos m√≠nimos recomendados para R80.20 ahora se ven as√≠: <br><br><div class="scrollable-table"><table><tbody><tr><td>  Dispositivo <br></td><td>  CPU <br></td><td>  RAM <br></td><td>  HDD <br></td></tr><tr><td>  Pasarela de seguridad <br></td><td>  2 n√∫cleos <br></td><td>  4 gb <br></td><td>  De 15 GB <br></td></tr><tr><td>  SMS <br></td><td>  2 n√∫cleos <br></td><td>  6 gb <br></td><td>  - </td></tr></tbody></table></div><br>  <i>Las recomendaciones se describen en <a href="https://sc1.checkpoint.com/documents/R80.20_GA/WebAdminGuides/EN/CP_R80.20_RN/html_frameset.htm">CP_R80.20_GA_Release_Notes</a> .</i> <br><br>  Pero seremos realistas.  Si esto es suficiente en la configuraci√≥n m√≠nima, entonces, como muestra la pr√°ctica, generalmente tenemos activada la inspecci√≥n https, SmartEvent funciona para SMS, etc., lo que, por supuesto, requiere capacidades completamente diferentes.  Pero en general no es m√°s grande que para el R77.30. <br><br>  Pero hay matices.  Y se refieren, en primer lugar, a los tama√±os de la memoria f√≠sica.  Muchas operaciones directamente durante el proceso de actualizaci√≥n requerir√°n espacio en el disco duro. <br><br>  Para el servidor de administraci√≥n, la cantidad de espacio libre en disco depender√° en gran medida del volumen de los registros actuales (si queremos guardarlos) y del n√∫mero de revisiones de la base de datos guardadas, aunque no las necesitaremos en grandes cantidades.  Por supuesto, para los nodos del cl√∫ster (a menos que almacene registros localmente tambi√©n), todo esto no importa.  Aqu√≠ le mostramos c√≥mo verificar si tiene el espacio correcto: <br><br><ol><li>  Nos conectamos al Smart Management Server a trav√©s de ssh, ingresamos al modo experto e ingresamos el comando: <br><br>  <b>[Experto @ cp-sms: 0] # df -h</b> </li><li>  En la salida, veremos algo como esta configuraci√≥n: <br><br>  <b>Tama√±o del sistema de archivos utilizado Disponible Uso% montado en</b> <b><br></b>  <b>/ dev / mapper / vg_splat-lv_current 30G 7.4G 21G 27% /</b> <b><br></b>  <b>/ dev / sda1 289M 24M 251M 9% / boot</b> <b><br></b>  <b>tmpfs 2.0G 0 2.0G 0% / dev / shm</b> <b><br></b>  <b>/ dev / mapper / vg_splat-lv_log 243G 177G 53G 78% / var / log</b> </li><li>  Actualmente estamos interesados ‚Äã‚Äãen la secci√≥n <b>/ var / log</b> </li></ol><br>  Tenga en cuenta que, seg√∫n la pol√≠tica de almacenamiento y eliminaci√≥n de archivos de registro antiguos, as√≠ como el tama√±o de la base de datos exportada, es posible que se requiera m√°s espacio.  Si al crear el archivo el espacio libre se reduce a lo indicado en la pol√≠tica para almacenar archivos de registro, el sistema comenzar√° a borrar los registros antiguos y NO los incluir√° en el archivo. <br><br>  Adem√°s, para el proceso de actualizaci√≥n en s√≠, el sistema necesitar√° un m√≠nimo de 13 GB de espacio sin asignar en el disco duro.  Puede verificar su presencia con el comando: <br><br>  <b>[Experto @ cp-sms: 0] # pvs</b> <br><br>  Veremos aproximadamente la siguiente conclusi√≥n: <br><br>  <b>PV VG Fmt Attr PSize PFree</b> <b><br></b>  <b>/ dev / sda3 vg_splat lvm2 a- 141.69G 43.69G</b> <br><br>  En este caso, tenemos 43 GB.  Hay suficientes recursos  Puedes comenzar a actualizar. <br><br><a name="TWO"></a><h2>  Actualizaci√≥n de Check Point SMS Management Server </h2><br>  Antes de comenzar a trabajar, haga lo siguiente: <br><br><ol><li>  Instale el paquete de Herramientas de migraci√≥n en el servidor de administraci√≥n.  Para hacer esto, debe cargar la imagen desde el portal <a href="https://supportcenter.checkpoint.com/supportcenter/portal/role/supportcenterUser/page/default.psml/media-type/html%3Faction%3Dportlets.DCFileAction%255E_%255Eamp%255E_%255EeventSubmit_doGetdcdetails%3D%255E_%255Eamp%255E_%255Efileid%3D72085">Check Point</a> . </li><li>  Descargue el archivo en el servidor de administraci√≥n a trav√©s de WinSCP en la carpeta <b>/var/log/UpgradeR77.30_R80.20</b> (si es necesario, cree primero una carpeta). </li><li>  Nos conectamos al servidor de administraci√≥n a trav√©s de SSH y vamos a la carpeta de archivo: <b>cd /var/log/UpgradeR77.30_R80.20/</b> </li><li>  Descomprima el archivo: <b>tar -zxvf ./ &lt;nombre de archivo&gt; .tgz</b> </li><li>  Lanzamos la utilidad pre_upgrade_verifier con el comando: <b>./pre_upgrade_verifier -p $ FWDIR -c R77 -t R80.20</b> </li><li>  Al completar el comando, se generar√° un informe sobre configuraciones incompatibles.  Est√° disponible en <b>/opt/CPsuite-R77/fw1/log/pre_upgrade_verification_report.(xls, html, txt).</b>  Es m√°s conveniente descargarlo a trav√©s de SCP y mirar a trav√©s del navegador. <br>  Para eliminar todas las configuraciones incompatibles, use <a href="https://supportcenter.checkpoint.com/supportcenter/portal%3FeventSubmit_doGoviewsolutiondetails%3D%255E_%255Eamp%255E_%255Esolutionid%3Dsk117237">SK117237</a> . </li><li>  Luego, vuelva a ejecutar la utilidad pre_upgrade_verifier para verificar que se hayan resuelto todas las causas de incompatibilidad. </li><li>  A continuaci√≥n, recopilamos informaci√≥n sobre las interfaces de red, la tabla de enrutamiento y cargamos la configuraci√≥n de GAIA: <br>  <b>ip a&gt; /var/log/UpgradeR77.30_R80.20/cp-sms-config.txt</b> <b><br></b>  <b>ip r&gt; /var/log/UpgradeR77.30_R80.20/cp-sms-config.txt</b> <b><br></b>  <b>clish -c "mostrar configuraci√≥n"&gt; /var/log/UpgradeR77.30_R80.20/cp-sms-config.txt</b> </li><li>  Cargue el archivo recibido a trav√©s de SCP. </li><li>  Hacemos instant√°neas a nivel de virtualizaci√≥n. </li><li>  Aumentamos el tiempo de espera de la sesi√≥n SSH a 8 horas.  As√≠ de afortunado: dependiendo del tama√±o de la base exportada, puede durar desde varios minutos hasta varias horas.  Para hacer esto: <br>  <b>[Expert @ HostName] # clish -c "mostrar inactividad-tiempo de espera"</b> mira el tiempo de espera actual clish, <br><br>  <b>[Expert @ HostName] # clish -c "set inactivity-timeout 720"</b> especifica un nuevo tiempo de espera clish (en minutos), <br><br>  <b>[Expert @ HostName] # echo $ TMOUT</b> mira el modo experto de tiempo de espera actual, <br><br>  <b>[Expert @ HostName] # export TMOUT = 3600</b> especifique un nuevo modo experto de tiempo de espera (en segundos), si establece el valor en 0, el tiempo de espera se desactivar√°. </li><li>  Cargamos y montamos la imagen de instalaci√≥n de SMS.iso en la m√°quina virtual. <br><br>  Antes del siguiente paso, aseg√∫rese de verificar nuevamente que tenga suficiente espacio sin asignar en su disco duro (le recuerdo que necesita 13 GB). <br></li><li>  Antes de comenzar la exportaci√≥n de la configuraci√≥n, cambiamos el archivo de registro con el comando: <b>fw logswitch</b> </li></ol><br>  <b>Exportar configuraci√≥n y registros</b> <br><br><ol><li>  Ejecute la utilidad migrate_export para descargar la configuraci√≥n.  Para hacer esto, vaya a la carpeta creada anteriormente: <b>cd /var/log/UpgradeR77.30_R80.20/</b> y use el comando: <b>./migrate export -l /var/log/UpgradeR77.30_R80.20/SMS_w_logs_export_r77_r80.tgz</b> <br><br>  cualquiera <br><br>  vaya a la carpeta: <b>cd $ FWDIR / bin / upgrade_tools /</b> y <br>  ejecute el comando desde all√≠: <b>./migrate export -l /var/log/UpgradeR77.30_R80.20/SMS_w_logs_export_r77_r80.tgz</b> <br><br>  Si la base exportada es grande, entonces el procedimiento puede llevar varias horas. <br>  NO DESCONECTE la SESI√ìN SSH durante el procedimiento. <br><br>  En el proceso, GAIA mostrar√° este mensaje: <br><img src="https://habrastorage.org/webt/ca/za/b-/cazab-404a0urgpqe7g1vejfjta.png"><br>  Puede ir a tomar caf√© y almorzar de manera segura. <br><br>  Despu√©s de que veamos un mensaje de error como este: <br><br><img src="https://habrastorage.org/webt/k0/v9/20/k0v920a3j-8z2pciapocj0bzhnk.png"><br><br>  O un mensaje sobre la finalizaci√≥n exitosa de la operaci√≥n: <br><br><img src="https://habrastorage.org/webt/jf/aj/nd/jfajnd1gn41wnuk-ipg2-vitgqe.png"><br><br>  Si el proceso ha estado sucediendo durante un par de horas, puede verificarlo.  Sin desconectar la sesi√≥n actual, configure una sesi√≥n paralela a trav√©s de ssh e ingrese el comando <b>superior.</b>  Entre los procesos, se debe mostrar el proceso de <b>migraci√≥n.</b> <br><br>  Si sin desconectar la sesi√≥n SSH de ninguna manera, use: <b>yes |</b>  <b>nohup ./migrate export -l /var/log/UpgradeR77.30_R80.20/SMS_w_logs_export_r77_r80.tgz</b> <br><br>  En este caso, puede desconectar la sesi√≥n, pero ser√° inconveniente monitorear el progreso: tendr√° que verificar la finalizaci√≥n del proceso con el comando superior, y en caso de un problema no habr√° un mensaje de error.  Por lo tanto, recomendamos esta opci√≥n. </li><li>  Eliminar la suma de comprobaci√≥n del archivo: <b>md5sum /var/log/UpgradeR77.30_R80.20/SMS_w_logs_export_r77_r80.tgz</b> </li><li>  Guardamos el valor recibido en un cuaderno. </li><li>  Nos conectamos a SMS a trav√©s de SCP y cargamos el archivo con la configuraci√≥n a la estaci√≥n de trabajo.  Aseg√∫rese de utilizar la transferencia de archivos en formato binario. </li></ol><br>  <b>Exportar base de datos SmartEvent</b> <br><br>  Aqu√≠ necesitamos una versi√≥n de SMS preinstalada R80.  Cualquier prueba servir√°. <br><br><ol><li>  Desde SMS, necesitamos un script ubicado aqu√≠: <b>$ RTDIR / bin / eva_db_backup.csh</b> </li><li>  A trav√©s de SCP, cargue el script <b>eva_db_backup.csh</b> en la carpeta: <b>/var/log/UpgradeR77.30_R80.20/</b> </li><li>  Nos conectamos a trav√©s de SSH a SMS.  Copie el archivo a la carpeta: <b>cp /var/log/UpgradeR77.30_R80.20/eva_db_backup.csh</b> <b><br></b>  <b>$ RTDIR / bin / eva_db_backup.csh</b> <br></li><li>  <b>Cambie la</b> codificaci√≥n: <b>dos2unix $ RTDIR / bin / eva_db_backup.csh</b> </li><li>  Agregar propietario: <b>chown -v admin: root $ RTDIR / bin / eva_db_backup.csh</b> </li><li>  Agregar permisos: <b>chmod -v 0755 $ RTDIR / bin / eva_db_backup.csh</b> </li><li>  Comenzamos a exportar la base SmartEvent: <b>$ RTDIR / bin / eva_db_backup.csh</b> </li><li>  <b>Cargamos</b> los archivos recibidos a trav√©s de SCP: <b>$ RTDIR / bin / &lt;date&gt; -db-backup.backup</b> y <b>$ RTDIR / bin / eventiaUpgrade.tar</b> a la estaci√≥n de trabajo. </li></ol><br>  <b>Actualizaci√≥n</b> <br><br><ol><li>  Vaya a <b>WebUI GAIA SMS ‚Üí CPUSE ‚Üí Mostrar todos los paquetes.</b> </li><li>  En el caso de que CPUSE genere un error de conexi√≥n en la nube de puntos de conexi√≥n, verificamos la configuraci√≥n de DGW, DNS y Proxy. </li><li>  Si todo es correcto, pero el error persiste, debe actualizar CPUSE manualmente, guiado por <a href="https://supportcenter.checkpoint.com/supportcenter/portal%3FeventSubmit_doGoviewsolutiondetails%3D%255E_%255Eamp%255E_%255Esolutionid%3Dsk92449%255E_%255Eamp%255E_%255Epartition%3DGeneral%255E_%255Eamp%255E_%255Eproduct%3DAll%2522">sk92449</a> . </li><li>  Descarga la imagen y ve a trav√©s de <b>Verifier.</b>  Si es necesario, elimine las inconsistencias. <br><br>  Como resultado, deber√≠a ver este mensaje: <br><br><img src="https://habrastorage.org/webt/w3/ai/_w/w3ai_wdfusghwng1pwxls5l4aek.png"></li><li>  Elija <b>R80.20 Instalaci√≥n nueva y actualizaci√≥n para la gesti√≥n de seguridad.</b> </li><li>  Al instalar la actualizaci√≥n, seleccione Instalaci√≥n limpia.  Despu√©s de la instalaci√≥n, el sistema se reiniciar√°. </li><li>  Pasamos el primer <b>asistente de</b> tiempo <b>.</b> </li><li>  Despu√©s de obtener acceso, verificamos las cuentas. </li><li>  Nos conectamos a SMS a trav√©s de SSH y cambiamos nuestro shell de usuario a / bin / bash /: <br><br>  <b>establecer usuario &lt;nombre de usuario&gt; shell / bin / bash /</b> <br><br>  <b>guardar configuraci√≥n</b> (en caso de que queramos dejar bin / bash / como shell predeterminado y despu√©s de reiniciar). </li><li>  A continuaci√≥n, nos conectamos a SMS a trav√©s de SCP y en modo binario transferimos el archivo con la configuraci√≥n <b>SMS_w_logs_export_r77_r80.tgz</b> a la carpeta <b>/var/log/UpgradeR77.30_R80.20/</b> <b><br></b> </li><li>  Eliminamos la suma de comprobaci√≥n del archivo: <b>md5sum /var/log/UpgradeR77.30_R80.20/SMS_w_logs_export_r77_r80.tgz</b> y la comparamos con el valor anterior.  La suma de control debe coincidir. </li><li>  Aumentamos el tiempo de espera de la sesi√≥n SSH a 8 horas.  Para hacer esto: <br><br>  <b>[Expert @ HostName] # clish -c "mostrar inactividad-tiempo de espera"</b> mira el tiempo de espera actual clish, <br><br>  <b>[Expert @ HostName] # clish -c "set inactivity-timeout 720"</b> especifica un nuevo tiempo de espera clish (en minutos), <br><br>  <b>[Expert @ HostName] # echo $ TMOUT</b> mira el modo experto de tiempo de espera actual, <br><br>  <b>[Expert @ HostName] # export TMOUT = 3600</b> especifica el nuevo modo experto de tiempo de espera (en segundos).  Si establece el valor en 0, el tiempo de espera se desactivar√°. </li><li>  Para importar la configuraci√≥n, ejecute la utilidad de importaci√≥n de migraci√≥n.  Para hacer esto, vaya a la carpeta: <b>cd $ FWDIR / bin / upgrade_tools /</b> y ejecute la importaci√≥n: <b>./migrate imp</b> <b><br></b>  <b>ort -l /var/log/UpgradeR77.30_R80.20/SMS_w_logs_export_r77_r80.tgz</b> </li></ol><br>  Disfruta la vida durante las pr√≥ximas dos horas.  NO DESCONECTE la SESI√ìN SSH durante el procedimiento.  Al final, el proceso de migraci√≥n devolver√° un mensaje de √©xito o un error. <br><br>  <b>Lista de verificaci√≥n despu√©s de las actualizaciones</b> <br><br><ol><li>  Disponibilidad de recursos. </li><li>  SIC con GW. </li><li>  Licencias  Si las licencias se muestran incorrectamente o no se muestran en SMS, ejecute el comando <b>vsec_central_licence</b> para distribuir las licencias. </li><li>  Establecimiento de pol√≠ticas. </li></ol><br>  <b>Importar base de datos SmartEvent</b> <br><br><ol><li>  Habilite SmartEvent Blade. </li><li>  Nos conectamos a trav√©s de WinSCP a SMS y en modo binario transferimos los archivos <b>&lt;date&gt; -db-backup.backup</b> y <b>eventiaUpgrade.tar</b> previamente descargados a la carpeta <b>/var/log/UpgradeR77.30_R80.20/</b> </li><li>  Comenzamos el script con el comando: <b>$ RTDIR / bin / eventiaUpgrade.sh -upgrade /var/log/UpgradeR77.30_R80.20/eventiaUpgrade.tar</b> </li><li>  Comprobaci√≥n del estado: <b>watch -n 10 eventiaUpgrade.sh</b> </li><li>  Verifique los registros en SmartEvent.  <b>SUE√ëO!</b> </li></ol><br><a name="THREE"></a><h2>  Actualizar cluster Check Point GW (Activo / Copia de seguridad) </h2><br>  <b>Antes de comenzar a trabajar</b> <br><br><ol><li>  Guardamos la configuraci√≥n de GAIA de cada nodo del cl√∫ster en un archivo. Para hacer esto, use el comando: <b>clish -c "show configuration"&gt; ./ &lt;File name&gt; .txt</b> </li><li>  Subimos archivos usando WinSCP. </li><li>  Nos conectamos a la WebUI de ambos nodos y vamos a la <b>pesta√±a CPUSE ‚Üí Mostrar todos los paquetes.</b> </li><li>  Encontramos el paquete de servicio para la versi√≥n <b>R80.20 Instalaci√≥n fresca</b> , haga clic en <b>Descargar.</b> </li><li>  Verificamos que el protocolo CCP funciona en modo <b>Broadcast</b> , para esto ingresamos el comando: <b>cphaprob -a if</b> <br>  Si se selecciona el modo <b>Multicast</b> , c√°mbielo con el comando: <b>cphaconf set_ccp broadcast</b> (el comando se ejecuta en cada nodo). </li><li>  Establezca el tiempo de inactividad para los nodos involucrados en su sistema de monitoreo. </li><li>  Verificamos que en el nivel de virtualizaci√≥n, los par√°metros de <b>cambio de direcci√≥n MAC</b> y <b>transmisiones falsificadas</b> para la red de sincronizaci√≥n est√©n habilitados. </li></ol><br>  <b>Actualizaci√≥n</b> <br><br><ol><li>  Nos conectamos a trav√©s de ssh al nodo Activo y ejecutamos el comando para monitorear el estado del cl√∫ster: <b>watch -n 2 cphaprob stat</b> </li><li>  Regresamos a los nodos WebUI Stanby en la pesta√±a <b>CPUSE</b> y ejecutamos <b>Verifier</b> para el paquete <b>R80.20 Fresh Install</b> seleccionado <b>.</b> </li><li>  Analizamos el informe del verificador.  Si la instalaci√≥n est√° permitida, contin√∫e. </li><li>  Seleccione el paquete <b>R80.20 Fresh Install</b> y ejecute <b>Upgrade</b> .  Durante el proceso de actualizaci√≥n, el sistema se reiniciar√°.  La configuraci√≥n de GAIA se guarda.  En el momento del reinicio, monitoreamos el estado del cl√∫ster.  Despu√©s de cargar, el estado del nodo actualizado debe cambiar a LISTO.  En algunos casos, tuvimos un momento en que un nodo a√∫n no actualizado entr√≥ en estado de Atenci√≥n activa y dej√≥ de mostrar el estado del nodo actualizado.  No se alarme: esta opci√≥n tambi√©n es v√°lida. </li><li>  Al finalizar la actualizaci√≥n, abra <b>SmartDashboard.</b> </li><li>  Abra el objeto del cl√∫ster y cambie la versi√≥n del cl√∫ster de R77.30 a R80.20.  Haz clic en Aceptar.  Si se produce un error al guardar los cambios: <br>  <i>Ha ocurrido un error interno.</i>  <i>(C√≥digo: 0x8003001D, no se pudo acceder al archivo para la operaci√≥n de escritura),</i> <br>  siga el <a href="https://supportcenter.checkpoint.com/supportcenter/portal%3FeventSubmit_doGoviewsolutiondetails%3D%255E_%255Eamp%255E_%255Esolutionid%3Dsk119973">SK119973</a> .  Despu√©s de eso, guarde los cambios y haga clic en <b>Instalar pol√≠tica.</b> </li><li>  En la configuraci√≥n, desactive el par√°metro <b>Para los cl√∫steres de puerta de enlace, si falla la instalaci√≥n en un miembro del cl√∫ster, no instale en ese cl√∫ster.</b> </li><li>  Establecemos una pol√≠tica.  El sistema generar√° un error para el nodo Activo, que a√∫n no se ha actualizado. </li><li>  Nos conectamos al nodo actualizado a trav√©s de ssh y ejecutamos el comando para monitorear el estado del cl√∫ster: <b>watch -n 2 cphaprob stat</b> </li><li>  Nos conectamos a los nodos activos de WebUI y vamos a la <b>pesta√±a CPUSE ‚Üí Mostrar todos los paquetes.</b>  Encontramos el paquete de servicio para la versi√≥n <b>R80.20 Instalaci√≥n fresca</b> , haga clic en <b>Descargar.</b> </li><li>  Establezca el tiempo de inactividad para los nodos involucrados en su sistema de monitoreo. </li><li>  Regresamos a los nodos activos de WebUI en la pesta√±a <b>CPUSE</b> y ejecutamos <b>Verifier</b> para el paquete <b>R80.20 Fresh Install</b> seleccionado <b>.</b> </li><li>  Analizamos el informe del verificador.  Si la instalaci√≥n est√° permitida, contin√∫e. </li><li>  Seleccione el paquete <b>R80.20 Fresh Install</b> y ejecute <b>Upgrade.</b>  Durante el proceso de actualizaci√≥n, el sistema se reiniciar√°.  La configuraci√≥n de GAIA se guarda.  En el momento del reinicio, monitoreamos el estado del cl√∫ster en un nodo ya actualizado.  Despu√©s del reinicio, el estado del cl√∫ster en el nodo actualizado cambiar√° de LISTO a ACTIVO. </li><li>  Cuando se complete el proceso de actualizaci√≥n, inicie SmartDashboard e instale la pol√≠tica. </li></ol><br>  <b>Lista de verificaci√≥n despu√©s de las actualizaciones</b> <br><br><ul><li>  Registros de eventos en SmartLog, estado de los t√∫neles VPN. </li><li>  Configuraci√≥n de GAIA. </li><li>  Recuperaci√≥n de cl√∫ster despu√©s de la conmutaci√≥n por error de prueba. </li><li>  Licencias y contratos.  Si las licencias se muestran incorrectamente o no se muestran en SMS, ejecute el comando.  vsec_central_licence para la distribuci√≥n de licencias. </li><li>  CoreXL. </li><li>  SecureXL. </li><li>  Revisi√≥n y CPinfo en dos nodos. </li></ul><br>  <b>Conclusi√≥n</b> <br><br>  En general, en este punto, todo: has actualizado. <br><br>  Todo nuestro proceso tom√≥ un promedio de 6 a 12 horas, dependiendo del tama√±o de las bases de datos exportadas.  El trabajo se llev√≥ a cabo durante dos noches: una para actualizar SMS, la segunda para el cl√∫ster. <br><br>  No hubo tiempo de inactividad del tr√°fico, a pesar del hecho de que verificamos todos los errores anteriores en nosotros mismos. <br><br>  Por supuesto, a veces pueden surgir dificultades completamente nuevas durante el proceso de actualizaci√≥n, pero esto es Check Point y, como todos sabemos, ¬°siempre hay una revisi√≥n! <br><br>  ¬°Buena suerte con tus noches y actualizaciones rosas y rosas! </div></div><p>Source: <a href="https://habr.com/ru/post/484170/">https://habr.com/ru/post/484170/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../484154/index.html">M√©todo para resolver el sistema de ecuaciones diofantinas</a></li>
<li><a href="../484160/index.html">Elusivo talento: Rusia pierde a los mejores profesionales de TI</a></li>
<li><a href="../484164/index.html">La historia de los libros y el futuro de las bibliotecas.</a></li>
<li><a href="../484166/index.html">VVVVVV ??? VVVVVV !!! :)</a></li>
<li><a href="../484168/index.html">Escribimos nuestra estrategia para el desplazamiento virtual desde Angular CDK</a></li>
<li><a href="../484172/index.html">Integraci√≥n continua en Unity: c√≥mo reducir el tiempo de montaje y ahorrar recursos + l√≠nea de pago como regalo</a></li>
<li><a href="../484174/index.html">Castle bebe en condiciones "extremas" o c√≥mo participamos en el espect√°culo "DOZOR"</a></li>
<li><a href="../484176/index.html">Implementaci√≥n de la plantilla de estado en Unity</a></li>
<li><a href="../484178/index.html">Conmutador Ethernet inteligente para el planeta Tierra</a></li>
<li><a href="../484180/index.html">PBX virtual Rostelecom: qu√© y c√≥mo se puede hacer a trav√©s de la API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>