<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ—ºï¸ ğŸ§‘ğŸ¿â€ğŸ¤â€ğŸ§‘ğŸ½ â™ï¸ Total cumulÃ© en SQL ğŸ“ ğŸ¤œğŸ¿ ğŸš¶ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le rÃ©sultat croissant (cumulatif) a longtemps Ã©tÃ© considÃ©rÃ© comme l'un des appels SQL. Ã‰tonnamment, mÃªme aprÃ¨s l'apparition des fonctions de la fenÃªtr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Total cumulÃ© en SQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474458/"> Le rÃ©sultat croissant (cumulatif) a longtemps Ã©tÃ© considÃ©rÃ© comme l'un des appels SQL.  Ã‰tonnamment, mÃªme aprÃ¨s l'apparition des fonctions de la fenÃªtre, il continue d'Ãªtre un Ã©pouvantail (en tout cas, pour les dÃ©butants).  Aujourd'hui, nous examinons la mÃ©canique des 10 solutions les plus intÃ©ressantes Ã  ce problÃ¨me - des fonctions de fenÃªtre aux hacks trÃ¨s spÃ©cifiques. <br><a name="habracut"></a><br>  Dans des feuilles de calcul comme Excel, le total cumulÃ© est calculÃ© trÃ¨s simplement: le rÃ©sultat du premier enregistrement correspond Ã  sa valeur: <br><br><img src="https://habrastorage.org/webt/sz/2b/rj/sz2brjvhpv7k99d4z6pisxsmtgc.png"><br><br>  ... puis nous rÃ©sumons la valeur actuelle et le total prÃ©cÃ©dent. <br><br><img src="https://habrastorage.org/webt/ol/yb/2j/olyb2jjuhlpcljbo5jxk8gvygl0.png"><br><br>  En d'autres termes <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>2</mn></msub><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>3</mn></msub><mspace linebreak=&quot;newline&quot; /><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>s</mi><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mspace linebreak=&quot;newline&quot; /></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="16.515ex" viewBox="0 -780.1 33095.6 7110.7" role="img" focusable="false" style="vertical-align: -14.703ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(12918,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="4167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="4936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="5466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="5764" y="0"></use><g transform="translate(6337,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="659" y="-213"></use></g></g><g transform="translate(10890,-1278)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-32" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="5357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="5718" y="0"></use><g transform="translate(6248,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2B" x="7223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="8223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="8993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="9522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="9821" y="0"></use><g transform="translate(10393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-32" x="659" y="-213"></use></g></g><g transform="translate(10890,-2555)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-33" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="3111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="5357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="5718" y="0"></use><g transform="translate(6248,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-32" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2B" x="7223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="8223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="8993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="9522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="9821" y="0"></use><g transform="translate(10393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-33" x="659" y="-213"></use></g></g><g transform="translate(15353,-3848)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-64" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="1072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="1919" y="0"></use></g><g transform="translate(10332,-5048)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="3181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="5428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="5789" y="0"></use><g transform="translate(6319,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2B" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="9269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="10039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="10568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="10867" y="0"></use><g transform="translate(11439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="659" y="-213"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>3</mn></msub><mspace linebreak="newline"></mspace><mtext>&nbsp;</mtext><mi>l</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>s</mi><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> Total_1 = Value_1 \\ Total_2 = Total_1 + Value_2 \\ Total_3 = Total_2 + Value_3 \\ \ ldots \\ Total_n = Total_ {n-1} + Value_n \\ </script></p><br>  ... ou: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="5.551ex" viewBox="0 -780.1 33095.6 2390.2" role="img" focusable="false" style="vertical-align: -3.74ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9008,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="5645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="6131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="6492" y="0"></use><g transform="translate(7022,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="8052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="9108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="9877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="10407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="10705" y="0"></use><g transform="translate(11278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2C" x="12198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="12644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="13522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="14578" y="0"></use></g><g transform="translate(6626,-1333)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="3181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="5428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="5789" y="0"></use><g transform="translate(6319,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2B" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="9269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="10039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="10568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="10867" y="0"></use><g transform="translate(11439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2C" x="12430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="12875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-67" x="13726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="14206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-71" x="14673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-32" x="15133" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="15884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="16350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-64" x="16951" y="0"></use><g transform="translate(17474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="1899" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&nbsp;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ begin {cases} Total_1 = Value_1, n = 1 \\ Total_n = Total_ {n-1} + Value_n, n \ geq 2 \ end {cases} </script></p><br><br>  L'apparition de deux ou plusieurs groupes dans le tableau complique quelque peu la tÃ¢che: nous comptons maintenant plusieurs rÃ©sultats (pour chaque groupe sÃ©parÃ©ment).  Cependant, ici, la solution se trouve Ã  la surface: Ã  chaque fois, il est nÃ©cessaire de vÃ©rifier Ã  quel groupe appartient l'enregistrement actuel.  <i>Cliquez et faites glisser</i> , et le travail est terminÃ©: <br><br><img src="https://habrastorage.org/webt/bk/gu/_a/bkgu_argpjjzckyu-jciknipjze.png"><br><br>  Comme vous pouvez le voir, le calcul du total cumulÃ© est associÃ© Ã  deux composantes inchangÃ©es: <br>  <b>(a)</b> trier les donnÃ©es par date et <br>  <b>(b) se</b> rÃ©fÃ©rant Ã  la ligne prÃ©cÃ©dente. <br><br>  Mais qu'est-ce que SQL?  Pendant trÃ¨s longtemps, il n'y avait aucune fonctionnalitÃ© nÃ©cessaire.  Un outil nÃ©cessaire - les fonctions de fenÃªtre - n'est apparu pour la premiÃ¨re fois que dans la <i>norme SQL: 2003</i> .  Ã€ ce stade, ils Ã©taient dÃ©jÃ  dans Oracle (version 8i).  Mais l'implÃ©mentation dans d'autres SGBD a Ã©tÃ© retardÃ©e de 5 Ã  10 ans: SQL Server 2012, MySQL 8.0.2 (2018), MariaDB 10.2.0 (2017), PostgreSQL 8.4 (2009), DB2 9 for z / OS (2007 annÃ©e), et mÃªme SQLite 3.25 (2018). <br><br><div class="spoiler">  <b class="spoiler_title">DonnÃ©es de test</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--       -- --   create table test_simple (dt date null, val int null ); --      (  , .  NLS_DATE_FORMAT  Oracle) insert into test_simple (dt, val) values ('2019-11-01', 6); insert into test_simple (dt, val) values ('2019-11-02', 3); insert into test_simple (dt, val) values ('2019-11-03', 3); insert into test_simple (dt, val) values ('2019-11-04', 4); insert into test_simple (dt, val) values ('2019-11-05', 2); insert into test_simple (dt, val) values ('2019-11-06', 4); insert into test_simple (dt, val) values ('2019-11-07', 8); insert into test_simple (dt, val) values ('2019-11-08', 0); insert into test_simple (dt, val) values ('2019-11-09', 6); insert into test_simple (dt, val) values ('2019-11-10', 0); insert into test_simple (dt, val) values ('2019-11-11', 8); insert into test_simple (dt, val) values ('2019-11-12', 8); insert into test_simple (dt, val) values ('2019-11-13', 0); insert into test_simple (dt, val) values ('2019-11-14', 2); insert into test_simple (dt, val) values ('2019-11-15', 8); insert into test_simple (dt, val) values ('2019-11-16', 7); --    create table test_groups (grp varchar null, -- varchar2(1) in Oracle dt date null, val int null ); --      (  , .  NLS_DATE_FORMAT  Oracle) insert into test_groups (grp, dt, val) values ('a', '2019-11-06', 1); insert into test_groups (grp, dt, val) values ('a', '2019-11-07', 3); insert into test_groups (grp, dt, val) values ('a', '2019-11-08', 4); insert into test_groups (grp, dt, val) values ('a', '2019-11-09', 1); insert into test_groups (grp, dt, val) values ('a', '2019-11-10', 7); insert into test_groups (grp, dt, val) values ('b', '2019-11-06', 9); insert into test_groups (grp, dt, val) values ('b', '2019-11-07', 10); insert into test_groups (grp, dt, val) values ('b', '2019-11-08', 9); insert into test_groups (grp, dt, val) values ('b', '2019-11-09', 1); insert into test_groups (grp, dt, val) values ('b', '2019-11-10', 10); insert into test_groups (grp, dt, val) values ('c', '2019-11-06', 4); insert into test_groups (grp, dt, val) values ('c', '2019-11-07', 10); insert into test_groups (grp, dt, val) values ('c', '2019-11-08', 9); insert into test_groups (grp, dt, val) values ('c', '2019-11-09', 4); insert into test_groups (grp, dt, val) values ('c', '2019-11-10', 4); --   -- select * from test_simple order by dt; select * from test_groups order by grp, dt;</span></span></code> </pre> <br></div></div><br><h3>  1. Fonctions de fenÃªtre </h3><br>  Les fonctions de fenÃªtre sont probablement le moyen le plus simple.  Dans le cas de base (tableau sans groupes), nous considÃ©rons les donnÃ©es triÃ©es par date: <br><br><pre> <code class="sql hljs">order by dt</code> </pre> <br>  ... mais nous ne sommes intÃ©ressÃ©s que par les lignes avant la ligne actuelle: <br><br><pre> <code class="sql hljs">rows between unbounded preceding and current row</code> </pre> <br>  En fin de compte, nous avons besoin d'une somme avec ces paramÃ¨tres: <br><br><pre> <code class="sql hljs">sum(val) over (order by dt rows between unbounded preceding and current row)</code> </pre> <br>  Une demande complÃ¨te ressemblerait Ã  ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(s.val) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unbounded</span></span> <span class="hljs-keyword"><span class="hljs-keyword">preceding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre> <br>  Dans le cas d'un total cumulÃ© pour les groupes (champ <code>grp</code> ), nous n'avons besoin que d'une petite modification.  Maintenant, nous considÃ©rons les donnÃ©es comme divisÃ©es en Â«fenÃªtresÂ» basÃ©es sur le groupe: <br><br><img src="https://habrastorage.org/webt/ax/zv/v-/axzvv-dmyetwe7w3t5ugalouw1o.png"><br><br>  Pour tenir compte de cette sÃ©paration, vous devez utiliser la <code>partition by</code> mot-clÃ©: <br><br><pre> <code class="sql hljs">partition by grp</code> </pre> <br>  Et, en consÃ©quence, considÃ©rez le montant de ces fenÃªtres: <br><br><pre> <code class="sql hljs">sum(val) over (partition by grp order by dt rows between unbounded preceding and current row)</code> </pre> <br>  Ensuite, la requÃªte entiÃ¨re est convertie comme ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> tg.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(tg.val) <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tg.grp <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tg.dt <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unbounded</span></span> <span class="hljs-keyword"><span class="hljs-keyword">preceding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups tg <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> tg.grp, tg.dt;</code> </pre> <br>  Les performances des fonctions de fenÃªtre dÃ©pendront des spÃ©cificitÃ©s de votre SGBD (et de sa version!), De la taille de la table et de la disponibilitÃ© des index.  Mais dans la plupart des cas, cette mÃ©thode sera la plus efficace.  Cependant, les fonctions de fenÃªtre ne sont pas disponibles dans les anciennes versions du SGBD (qui sont toujours utilisÃ©es).  De plus, ils ne se trouvent pas dans des SGBD tels que Microsoft Access et SAP / Sybase ASE.  Si une solution indÃ©pendante du fournisseur est nÃ©cessaire, des alternatives doivent Ãªtre envisagÃ©es. <br><br><h3>  2. Sous-requÃªte </h3><br>  Comme mentionnÃ© ci-dessus, les fonctions de fenÃªtre ont Ã©tÃ© introduites trÃ¨s tard dans le SGBD principal.  Ce retard n'est pas surprenant: en thÃ©orie relationnelle, les donnÃ©es ne sont pas ordonnÃ©es.  Beaucoup plus Ã  l'esprit de la thÃ©orie relationnelle correspond Ã  une solution Ã  travers une sous-requÃªte. <br><br>  Une telle sous-requÃªte doit considÃ©rer la somme des valeurs avec une date antÃ©rieure Ã  l'actuelle (et y compris l'actuelle): <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>e</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>q</mi><mi>d</mi><msub><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>u</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>e</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.829ex" height="2.66ex" viewBox="0 -780.1 8968 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-64" x="0" y="0"></use><g transform="translate(523,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-69" x="298" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-67" x="644" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="1124" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="1725" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="2784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="3083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-71" x="3549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-64" x="4010" y="0"></use><g transform="translate(4533,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="0" y="0"></use><g transform="translate(361,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-69" x="298" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-67" x="644" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="1124" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="1725" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="2191" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-63" x="2721" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="3154" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="3516" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="4088" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="4555" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="4853" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="5152" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>e</mi></mrow></msub><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>q</mi><mi>d</mi><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>l</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>e</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>u</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>e</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> dt_ {ligne} \ leq dt_ {ligne actuelle} </script>  . <br><br>  Ã€ quoi ressemble le code: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Une solution lÃ©gÃ¨rement plus efficace sera dans laquelle la sous-requÃªte considÃ¨re le total jusqu'Ã  la date actuelle (mais ne l'inclut pas), puis le rÃ©sume avec la valeur de la ligne: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, s.val + (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt; s.dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Dans le cas d'un rÃ©sultat cumulatif pour plusieurs groupes, nous devons utiliser une sous-requÃªte corrÃ©lÃ©e: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br>  La condition <code>g.grp = t2.grp</code> vÃ©rifie les lignes Ã  inclure dans le groupe (ce qui, en principe, est similaire au travail de <code>partition by grp</code> dans les fonctions de fenÃªtre). <br><br><h3>  3. Connexion interne </h3><br>  Ã‰tant donnÃ© que les sous-requÃªtes et les jointures sont interchangeables, nous pouvons facilement les remplacer les unes par les autres.  Pour ce faire, vous devez utiliser Self Join, en connectant deux instances de la mÃªme table: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t2.dt &lt;= s.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt, s.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Comme vous pouvez le voir, la condition de filtrage dans la sous-requÃªte <code>t2.dt &lt;= s.dt</code> est devenue une condition de jointure.  De plus, pour utiliser la fonction d'agrÃ©gation <code>sum()</code> nous devons regrouper par date et valeur par <code>group by s.dt, s.val</code> . <br><br>  De mÃªme, vous pouvez faire pour le cas avec diffÃ©rents groupes <code>grp</code> : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt, g.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br><h3>  4. Produit cartÃ©sien </h3><br>  Puisque nous avons remplacÃ© la sous-requÃªte par join, pourquoi ne pas essayer le produit cartÃ©sien?  Cette solution ne nÃ©cessitera que des modifications minimales: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s, test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt, s.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  Ou pour les groupes: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g, test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt, g.val <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br>  Les solutions listÃ©es (sous-requÃªte, jointure interne, jointure cartÃ©sienne) correspondent Ã  <i>SQL-92</i> et <i>SQL: 1999</i> , et seront donc disponibles dans presque tous les SGBD.  Le principal problÃ¨me avec toutes ces solutions est une mauvaise performance.  Ce n'est pas un gros problÃ¨me si nous matÃ©rialisons un tableau avec le rÃ©sultat (mais vous voulez quand mÃªme plus de vitesse!).  D'autres mÃ©thodes sont beaucoup plus efficaces (ajustÃ©es pour les spÃ©cificitÃ©s de SGBD spÃ©cifiques et leurs versions dÃ©jÃ  spÃ©cifiÃ©es, la taille de la table, les index). <br><br><h3>  5. Demande rÃ©cursive </h3><br>  L'une des approches les plus spÃ©cifiques est une requÃªte rÃ©cursive dans une expression de table commune.  Pour ce faire, nous avons besoin d'une Â«ancreÂ» - une requÃªte qui renvoie la toute premiÃ¨re ligne: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> dt = (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple)</code> </pre><br>  Ensuite, avec l'aide de <code>union all</code> , les rÃ©sultats d'une requÃªte rÃ©cursive sont ajoutÃ©s Ã  "l'ancre".  Pour ce faire, vous pouvez compter sur le champ date <code>dt</code> , en y ajoutant un jour: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.dt, r.val, cte.total + r.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_simple r <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> r.dt = <span class="hljs-keyword"><span class="hljs-keyword">dateadd</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, cte.dt) <span class="hljs-comment"><span class="hljs-comment">-- + 1   SQL Server</span></span></code> </pre><br>  La partie du code qui ajoute un jour n'est pas universelle.  Par exemple, il s'agit de <code>r.dt = dateadd(day, 1, cte.dt)</code> pour SQL Server, <code>r.dt = cte.dt + 1</code> pour Oracle, etc. <br><br>  En combinant Â«l'ancreÂ» et la demande principale, nous obtenons le rÃ©sultat final: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte (dt, val, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> dt = (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple) <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.dt, r.val, cte.total + r.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_simple r <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> r.dt = <span class="hljs-keyword"><span class="hljs-keyword">dateadd</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, cte.dt) <span class="hljs-comment"><span class="hljs-comment">-- r.dt = cte.dt + 1  Oracle,  .. ) select dt, val, total from cte order by dt;</span></span></code> </pre><br>  La solution pour le cas avec des groupes ne sera pas beaucoup plus compliquÃ©e: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte (dt, grp, val, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.dt, g.grp, g.val, g.val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.dt = (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> grp = g.grp) <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> r.dt, r.grp, r.val, cte.total + r.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> test_groups r <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> r.dt = <span class="hljs-keyword"><span class="hljs-keyword">dateadd</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">day</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, cte.dt) <span class="hljs-comment"><span class="hljs-comment">-- r.dt = cte.dt + 1  Oracle,  .. and cte.grp = r.grp ) select dt, grp, val, total from cte order by grp, dt;</span></span></code> </pre><br><h3>  6. <code>row_number()</code> rÃ©cursive avec la fonction <code>row_number()</code> </h3><br>  La dÃ©cision prÃ©cÃ©dente Ã©tait basÃ©e sur la continuitÃ© du champ de date <code>dt</code> avec une augmentation sÃ©quentielle de 1 jour.  Nous Ã©vitons cela en utilisant la fonction de fenÃªtre <code>row_number()</code> , qui numÃ©rote les lignes.  Bien sÃ»r, cela est injuste - car nous allons envisager des alternatives aux fonctions de fenÃªtre.  Cependant, cette solution peut Ãªtre une sorte de <i>preuve de concept</i> : en pratique, il peut y avoir un champ qui remplace les numÃ©ros de ligne (id d'enregistrement).  De plus, dans SQL Server, la fonction <code>row_number()</code> est apparue avant la prise en charge complÃ¨te des fonctions de fenÃªtre (y compris <code>sum()</code> ). <br><br>  Donc, pour une requÃªte rÃ©cursive avec <code>row_number()</code> nous avons besoin de deux STE.  Dans le premier, nous ne numÃ©rotons que les lignes: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte1 (dt, val, rn) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple)</code> </pre><br>  ... et si le numÃ©ro de ligne est dÃ©jÃ  dans le tableau, vous pouvez vous en passer.  Dans la requÃªte suivante, nous faisons dÃ©jÃ  <code>cte1</code> Ã  <code>cte1</code> : <br><br><pre> <code class="sql hljs">cte2 (dt, val, rn, total) as (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, rn, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> rn = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> cte1.dt, cte1.val, cte1.rn, cte2.total + cte1.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> cte1.rn = cte2.rn + <span class="hljs-number"><span class="hljs-number">1</span></span> )</code> </pre><br>  Et toute la demande ressemble Ã  ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte1 (dt, val, rn) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple), cte2 (dt, val, rn, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, rn, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> rn = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> cte1.dt, cte1.val, cte1.rn, cte2.total + cte1.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> cte1.rn = cte2.rn + <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br>  ... ou pour les groupes: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> cte1 (dt, grp, val, rn) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, grp, val, row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> grp <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups), cte2 (dt, grp, val, rn, total) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, grp, val, rn, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> rn = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> cte1.dt, cte1.grp, cte1.val, cte1.rn, cte2.total + cte1.val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> cte1 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> cte1.grp = cte2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> cte1.rn = cte2.rn + <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, grp, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cte2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> grp, dt;</code> </pre><br><h3>  7. <code>CROSS APPLY</code> / <code>LATERAL</code> </h3><br>  L'un des moyens les plus exotiques de calculer un total cumulÃ© consiste Ã  utiliser l'instruction <code>CROSS APPLY</code> (SQL Server, Oracle) ou son Ã©quivalent <code>LATERAL</code> (MySQL, PostgreSQL).  Ces opÃ©rateurs sont apparus assez tard (par exemple, dans Oracle uniquement Ã  partir de la version 12c).  Et dans certains SGBD (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MariaDB</a> ), ils ne le sont pas du tout.  Par consÃ©quent, cette dÃ©cision est d'un intÃ©rÃªt purement esthÃ©tique. <br><br>  Fonctionnellement, l'utilisation de <code>CROSS APPLY</code> ou <code>LATERAL</code> identique Ã  la sous-requÃªte: nous attachons le rÃ©sultat du calcul Ã  la requÃªte principale: <br><br><pre> <code class="sql hljs">cross apply (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt ) t2</code> </pre><br>  ... qui ressemble Ã  ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.*, t2.total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple s <span class="hljs-keyword"><span class="hljs-keyword">cross</span></span> <span class="hljs-keyword"><span class="hljs-keyword">apply</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> t2.dt &lt;= s.dt ) t2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> s.dt;</code> </pre><br>  La solution pour le cas avec des groupes sera similaire: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> g.*, t2.total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups g <span class="hljs-keyword"><span class="hljs-keyword">cross</span></span> <span class="hljs-keyword"><span class="hljs-keyword">apply</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(t2.val), <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_groups t2 <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> g.grp = t2.grp <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> t2.dt &lt;= g.dt ) t2 <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> g.grp, g.dt;</code> </pre><br>  Total: nous avons examinÃ© les principales solutions indÃ©pendantes de la plateforme.  Mais il existe des solutions spÃ©cifiques Ã  des SGBD spÃ©cifiques!  Puisqu'il y a beaucoup d'options ici, nous allons nous attarder sur quelques-unes des plus intÃ©ressantes. <br><br><h3>  8. <code>MODEL</code> (Oracle) </h3><br>  L'instruction <code>MODEL</code> dans Oracle fournit l'une des solutions les plus Ã©lÃ©gantes.  Au dÃ©but de l'article, nous avons examinÃ© la formule gÃ©nÃ©rale du total cumulÃ©: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak=&quot;newline&quot; /><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="5.551ex" viewBox="0 -780.1 33095.6 2390.2" role="img" focusable="false" style="vertical-align: -3.74ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9008,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="5645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="6131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="6492" y="0"></use><g transform="translate(7022,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="8052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="9108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="9877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="10407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="10705" y="0"></use><g transform="translate(11278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2C" x="12198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="12644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="13522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="14578" y="0"></use></g><g transform="translate(6626,-1333)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="1190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="1551" y="0"></use><g transform="translate(2081,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-3D" x="3181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-54" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6F" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-74" x="5428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="5789" y="0"></use><g transform="translate(6319,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2B" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-56" x="9269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="10039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6C" x="10568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-75" x="10867" y="0"></use><g transform="translate(11439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="659" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-2C" x="12430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="12875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-67" x="13726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="14206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-71" x="14673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMAIN-32" x="15133" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="15884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-6E" x="16350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-64" x="16951" y="0"></use><g transform="translate(17474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/474458/&amp;usg=ALkJrhjp2nne2oB2tTreFOtb1SAETT9Fzw#MJMATHI-73" x="1899" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mn>1</mn></msub><mo>=</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mi>n</mi></msub><mo>=</mo><mi>T</mi><mi>o</mi><mi>t</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>n</mi></msub><mo>,</mo><mi>n</mi><mtext>&nbsp;</mtext><mi>g</mi><mi>e</mi><mi>q</mi><mn>2</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ begin {cases} Total_1 = Value_1, n = 1 \\ Total_n = Total_ {n-1} + Value_n, n \ geq 2 \ end {cases} </script></p><br><br>  <code>MODEL</code> vous permet de mettre en Å“uvre cette formule littÃ©ralement un Ã  un!  Pour ce faire, nous remplissons d'abord le champ <code>total</code> avec les valeurs de la ligne courante <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple</code> </pre><br>  ... puis nous calculons le numÃ©ro de ligne comme <code>row_number() over (order by dt) as rn</code> (ou utilisez le champ fini avec le numÃ©ro, le cas Ã©chÃ©ant).  Et enfin, nous introduisons une rÃ¨gle pour toutes les lignes sauf la premiÃ¨re: <code>total[rn &gt;= 2] = total[cv() - 1] + val[cv()]</code> . <br><br>  La fonction <code>cv()</code> est ici responsable de la valeur de la ligne courante.  Et toute la demande ressemblera Ã  ceci: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, val <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple) t <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dimension</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> (row_number() <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rn) <span class="hljs-keyword"><span class="hljs-keyword">measures</span></span> (dt, val, total) <span class="hljs-keyword"><span class="hljs-keyword">rules</span></span> (total[rn &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>] = total[cv() - <span class="hljs-number"><span class="hljs-number">1</span></span>] + val[cv()]) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br><h3>  9. Curseur (SQL Server) </h3><br>  Un total cumulÃ© est l'un des rares cas oÃ¹ le curseur dans SQL Server est non seulement utile, mais Ã©galement prÃ©fÃ©rable Ã  d'autres solutions (au moins jusqu'Ã  la version 2012, oÃ¹ les fonctions de fenÃªtre sont apparues). <br><br>  L'implÃ©mentation via le curseur est assez banale.  Vous devez d'abord crÃ©er un tableau temporaire et le remplir avec les dates et les valeurs du principal: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-comment"><span class="hljs-comment">#temp (dt date primary key, val int null, total int null ); insert #temp (dt, val) select dt, val from test_simple order by dt;</span></span></code> </pre><br>  Ensuite, nous dÃ©finissons les variables locales Ã  travers lesquelles la mise Ã  jour aura lieu: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @VarTotal <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>, @VarDT <span class="hljs-built_in"><span class="hljs-built_in">date</span></span>, @VarVal <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @VarTotal = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  AprÃ¨s cela, nous mettons Ã  jour la table temporaire via le curseur: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> cur <span class="hljs-keyword"><span class="hljs-keyword">cursor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> read_only forward_only <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-comment"><span class="hljs-comment">#temp order by dt; open cur; fetch cur into @VarDT, @VarVal; while @@fetch_status = 0 begin set @VarTotal = @VarTotal + @VarVal; update #temp set total = @VarTotal where dt = @VarDT; fetch cur into @VarDT, @VarVal; end; close cur; deallocate cur;</span></span></code> </pre><br>  Et enfin, nous obtenons le rÃ©sultat souhaitÃ©: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-comment"><span class="hljs-comment">#temp order by dt; drop table #temp;</span></span></code> </pre><br><h3>  10. Mettre Ã  jour via une variable locale (SQL Server) </h3><br>  La mise Ã  jour via une variable locale dans SQL Server est basÃ©e sur un comportement non documentÃ©, elle ne peut donc pas Ãªtre considÃ©rÃ©e comme fiable.  NÃ©anmoins, c'est peut-Ãªtre la solution la plus rapide, et c'est intÃ©ressant. <br><br>  CrÃ©ons deux variables: une pour les totaux cumulatifs et une variable de table: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @VarTotal <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> @tv <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> (dt <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, val <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, total <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> );</code> </pre><br>  Tout d'abord, remplissez <code>@tv</code> donnÃ©es de la table principale <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> @tv (dt, val, total) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> dt, val, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> total <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> test_simple <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br>  Ensuite, <code>@tv</code> jour la variable de table <code>@tv</code> utilisant <code>@VarTotal</code> : <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> @tv <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> @VarTotal = total = @VarTotal + val <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> @tv;</code> </pre><br>  ... aprÃ¨s quoi nous obtenons le rÃ©sultat final: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> @tv <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt;</code> </pre><br>  RÃ©sumÃ©: Nous avons examinÃ© les 10 meilleures faÃ§ons de calculer les totaux cumulatifs en SQL.  Comme vous pouvez le voir, mÃªme sans fonctions de fenÃªtre, ce problÃ¨me est complÃ¨tement rÃ©soluble et la mÃ©canique de la solution ne peut pas Ãªtre qualifiÃ©e de compliquÃ©e. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474458/">https://habr.com/ru/post/fr474458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474442/index.html">Histoire de l'extension de la vie irlandaise</a></li>
<li><a href="../fr474444/index.html">5 projets de formation plus audacieux pour le dÃ©veloppeur (Layer, Squoosh, Calculator, Website Crawler, Music Player)</a></li>
<li><a href="../fr474448/index.html">Ce que le cerveau d'un Ã©tudiant dans le monde informatique est capable de faire</a></li>
<li><a href="../fr474450/index.html">ArrÃªtez d'utiliser un TTL ridiculement petit pour DNS</a></li>
<li><a href="../fr474452/index.html">Rapport de situation automne Haxe</a></li>
<li><a href="../fr474460/index.html">Description des architectures de processeur dans LLVM utilisant TableGen</a></li>
<li><a href="../fr474462/index.html">Ã‰norme ensemble de donnÃ©es ouvertes de la version russe du discours 1.0</a></li>
<li><a href="../fr474466/index.html">Histoire du premier Diablo</a></li>
<li><a href="../fr474470/index.html">Attaque DDoS sur les services RDP: reconnaÃ®tre et surmonter. ExpÃ©rience rÃ©ussie de Tucha</a></li>
<li><a href="../fr474472/index.html">Liste de contrÃ´le UX en 30 points pour les applications mobiles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>