<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüç≥ üö∂üèΩ ü§òüèø Beneficios de analizar aplicaciones de nivel 7 en firewalls. Parte 2. Seguridad üêÄ üë©üèª‚Äçüéì üë©üèΩ‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La nueva generaci√≥n de firewalls es m√°s conveniente y segura gracias a la nueva arquitectura del motor y la nueva ideolog√≠a de gesti√≥n de flujos de re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Beneficios de analizar aplicaciones de nivel 7 en firewalls. Parte 2. Seguridad</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436836/"><img src="https://habrastorage.org/getpro/habr/post_images/786/9e4/d4e/7869e4d4eac6b07b8bfa763cb3985347.png"><br><br>  La nueva generaci√≥n de firewalls es m√°s conveniente y segura gracias a la nueva arquitectura del motor y la nueva ideolog√≠a de gesti√≥n de flujos de red. <br><br><h3>  ¬øPor qu√© apareci√≥ este art√≠culo? </h3><br><blockquote>  En repetidas ocasiones lleg√≥ a compa√±eros de seguridad que utilizan una nueva generaci√≥n de firewalls y vieron que siguen escribiendo reglas sobre los n√∫meros de puerto.  Ante mi sugerencia de seguir escribiendo por el nombre de las aplicaciones, escuch√© "¬øQu√© pasa si no funciona as√≠?".  Si tambi√©n est√° "asustado" o no est√° claro por qu√© escribir las reglas para las aplicaciones, este art√≠culo es para usted. </blockquote><a name="habracut"></a>  Comienzo del art√≠culo por referencia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1. Conceptos b√°sicos de firewall</a> <br><br><a name="Start"></a><h1>  Parte 2. Impacto de seguridad de L7 FIREWALL </h1><br><h3>  Contenido </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El firewall L7 verifica el contenido del campo de datos, el firewall L4 no</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Las aplicaciones han cambiado: ¬øha cambiado su firewall?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo funciona la detecci√≥n de tr√°fico</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">L7 Firewall es m√°s conveniente</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El firewall L7 es m√°s seguro</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬øQu√© nuevos problemas crean un nuevo enfoque para escribir reglas para L7?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Limitaciones de la tecnolog√≠a de an√°lisis de nivel 7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conclusi√≥n</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Votar</a> <br><br><a name="Data"></a><h2>  El firewall L7 verifica el contenido del campo de datos, el firewall L4 no </h2><br><blockquote>  <b>El principal problema con el que estamos luchando es que ahora los programas se escriben de inmediato para evitar la protecci√≥n del firewall L4.</b> </blockquote>  Si una persona pone Skype, entonces no quiere llamar al administrador del sistema y le ruega que abra el puerto que necesita en el cortafuegos; quiere que Skype se ilumine de inmediato "verde".  Los programadores saben que a menudo hay un proxy HTTP en la red o que el puerto 80 est√° abierto para HTTP, el puerto 53 es para DNS, el puerto 123 es para NTP y, a veces, para empleados de adentro hacia afuera a Internet, todo est√° abierto y puede usar estas conexiones permitidas en consecuencia. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6de/735/726/6de735726e071aab7f3a122cb9e7fd34.png"><br><br>  Los desarrolladores tienen el t√©rmino Experiencia de usuario: despu√©s de la instalaci√≥n, el cliente se incendi√≥ en Skype verde = el cliente est√° contento.  Y el hecho de que Skype pas√≥ ilegalmente el per√≠metro de la compa√±√≠a a trav√©s de una conexi√≥n que estaba abierta para el navegador solo en los puertos TCP / 80 y 443, el firewall L4 ignora, porque no es su tarea mirar el contenido de los paquetes, solo los encabezados son importantes para √©l. <br><br><h3>  Problema de firewall L4: salto de puerto (tunelizaci√≥n) </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/e3e/aa8/502/e3eaa85023c8a83afe2fd9410e866965.png" align="left">  El t√∫nel de aplicaciones no autorizadas dentro de las conexiones permitidas es una imagen est√°ndar en las redes modernas.  Naturalmente, los hackers usan el mismo truco: crean t√∫neles en las conexiones permitidas.  Y los guardias de seguridad ni siquiera lo saben. <br><br><h3>  Ejemplo de t√∫nel TCP sobre DNS </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/30d/c7e/f30/30dc7ef30cfc1ca8c880c9d54ac9f3b7.png"><br><br>  A partir de los paquetes de tr√°fico recopilados en la imagen, est√° claro que hay conexiones en el puerto TCP 53, lo que generalmente se considera como la operaci√≥n del protocolo DNS.  Sin embargo, si observa detenidamente, puede ver que en el campo Texto del protocolo DNS hay alg√∫n tipo de texto cifrado.  Esta es una implementaci√≥n del t√∫nel TCP-Over-DNS, que a menudo veo en las redes corporativas.  A la izquierda hay una lista de otros t√∫neles que pueden usar sus usuarios o hackers.  ¬øEl firewall L4 da esa informaci√≥n?  No  Por lo tanto, si necesita proteger a la empresa de t√∫neles no autorizados, debe analizar el contenido de los datos transmitidos y utilizarlo para analizar qu√© aplicaci√≥n est√° utilizando actualmente esta conexi√≥n TCP. <br><br><a name="App"></a><h2>  Las aplicaciones han cambiado: ¬øha cambiado su firewall? </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/f4d/ee2/573/f4dee257312a6c98e9607812d9976731.png"><br><br>  El mundo ha cambiado y hoy no es suficiente determinar la aplicaci√≥n por n√∫mero de puerto.  S√≠, hace 20 a√±os acordamos que si 80 est√° escrito en el campo Puerto, entonces esto es HTTP, si 53, entonces esto es DNS, ¬°pero ahora no es as√≠! <br><br>  Es necesario analizar el contenido de los datos transmitidos y corresponde a ellos analizar qu√© aplicaci√≥n est√° utilizando actualmente esta conexi√≥n TCP. <br><br>  Vaya a la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">base de datos de la</a> aplicaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">applipedia.paloaltonetworks.com</a> .  Vea cu√°ntas aplicaciones usan los puertos 80 y 443. <br><blockquote>  <b>Un ejemplo</b> <br><br>  Aplicaciones que usan el puerto 80 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/522/b2d/510/522b2d51051df42c0ead70785e0c7e71.png"><br></blockquote><blockquote><h3>  El problema con muchas caracter√≠sticas de seguridad es ignorar las aplicaciones en puertos no est√°ndar. </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/8a9/ece/07d/8a9ece07d27298757b7a0819107f88c8.png" align="left"><br>  Mover una aplicaci√≥n est√°ndar a un puerto no est√°ndar tambi√©n permite que un atacante se salga de control.  Este control restaura solo el dispositivo que analiza el contenido de todo el tr√°fico, y no solo los encabezados. </blockquote><br><a name="Visual"></a><h2>  C√≥mo funciona la detecci√≥n de tr√°fico </h2><br>  Una de las tareas del an√°lisis de aplicaciones es detectar el tr√°fico de aplicaciones que se crean especialmente para que sus conexiones no sean visibles.  Tomemos por ejemplo Skype.  Las personas que han aprendido a distinguir los paquetes UDP cifrados de Skype de otros paquetes UDP cifrados son muy buenos compa√±eros. <br><br>  Tambi√©n hay una clase de dispositivos que pueden hacer esto: inspecci√≥n profunda de paquetes (en adelante DPI).  Dichos dispositivos ahora cuentan con grandes proveedores y le permiten manipular el tr√°fico de aplicaciones: aplique QoS o redirija en la direcci√≥n correcta.  A veces se comparan NGFW y DPI.  Diferencia: DPI est√° dise√±ado para controlar la calidad del tr√°fico y la seguridad de NGFW, aunque NGFW tambi√©n tiene caracter√≠sticas de QoS. <br><br>  Los m√©todos para detectar aplicaciones en el tr√°fico son diferentes. <br><br><ul><li>  Si necesita encontrar una <b>aplicaci√≥n</b> que <b>no se oculte</b> en el tr√°fico, como HTTP, entonces es suficiente para usar las b√∫squedas habituales de los patrones o firmas correspondientes.  Y esto es utilizado activamente por los fabricantes.  Este es el m√°s f√°cil. <br></li><li>  Si necesita encontrar una <b>aplicaci√≥n</b> que <b>se oculte deliberadamente</b> , por ejemplo, TOR, entonces necesita un conjunto de m√©todos para analizar las estad√≠sticas y el comportamiento del paquete.  Esto es dif√≠cil, requiere un laboratorio de investigaci√≥n, que tambi√©n necesita realizar un seguimiento de los cambios en el protocolo a tiempo e implementar nuevos algoritmos de b√∫squeda.  Mis intentos de lograr que al menos un desarrollador diga c√≥mo funcionan estos algoritmos, me encuentro con la respuesta de que todo esto es propiedad intelectual. <br></li></ul><br>  Sucede que la aplicaci√≥n ya ha cambiado el algoritmo de operaci√≥n, y el motor DPI o NGFW a√∫n no ha logrado cambiar.  Por ejemplo, Telegram a veces cambia porque est√° siendo cazado.  Se producen falsos positivos.  Esto es importante para verificar.  En consecuencia, los dispositivos y NGFW y DPI difieren principalmente en el n√∫mero y la calidad de la detecci√≥n de aplicaciones.  Este es el √∫nico m√©todo: ponga NGFW en su tr√°fico y vea.  Si hablamos del per√≠metro, entonces el tr√°fico m√°s complejo que vi conten√≠a 715 aplicaciones diferentes por mes.  En promedio, 200-300 aplicaciones de varios tipos pasan por el per√≠metro.  En esta visualizaci√≥n del tr√°fico de aplicaciones, puede ver esto: pase el mouse sobre cada c√≠rculo: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://researchcenter.paloaltonetworks.com/app-usage-risk-report-visualization/</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br><img src="https://habrastorage.org/getpro/habr/post_images/945/099/048/94509904864c2cfeba02858aabf7127e.png"></a> <br><br>  Hay miles de aplicaciones en la base de datos de aplicaciones, por lo que esencialmente el an√°lisis de los formatos y algoritmos de cada aplicaci√≥n es un trabajo largo y laborioso de los analistas.  Una vez que comprendemos c√≥mo funciona la aplicaci√≥n, los programadores comienzan a trabajar, lo que implementa el descubrimiento de aplicaciones por tr√°fico.  Y estos pocos miles de aplicaciones cambian constantemente.  En consecuencia, el producto debe ser constantemente compatible, aprender nuevas aplicaciones y monitorear los cambios en los antiguos y agregar detectores modificados a la base de datos.  La base de datos de todas las aplicaciones posibles que generan tr√°fico se puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">encontrar aqu√≠</a> . <br><br>  A veces, los proveedores de firewall L7 intentan medir la cantidad de aplicaciones que tienen en la base de datos, pero esto es m√°s como una blasfemia.  Al activar el pensamiento cr√≠tico, comprende que en realidad solo necesita detectar aplicaciones en el per√≠metro (en promedio, en la regi√≥n de 300 aplicaciones diferentes), en el centro de datos (10-15 piezas), en redes ICS / SCADA (2-3 aplicaciones), entre segmentos (tal vez son solo unas pocas docenas).  Y si se le ofrece detectar miles de aplicaciones, esto es solo marketing y la detecci√≥n de algunas aplicaciones desconocidas que nadie usa. <br><br>  <b>Ejemplos de aplicaciones en la red de una empresa:</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/240/186/ad2/240186ad2ca0654136be608ba2238460.png" alt="imagen"><br><br>  La segmentaci√≥n interna dentro de la empresa es un requisito constante de los est√°ndares de seguridad de la informaci√≥n que casi nadie cumple.  Entre los segmentos donde se sientan programadores, financieros, RRHH y contabilidad, tambi√©n se ejecutan aplicaciones.  Como m√≠nimo, debe controlar la red de Windows (protocolo SMB), esto se hizo especialmente claro despu√©s de la epidemia de criptoclocker WannaCry, que se distribuy√≥ a trav√©s de SMB.  Es decir, las redes internas tambi√©n necesitan an√°lisis de aplicaciones de nivel 7 y m√©todos relacionados para buscar c√≥digo malicioso en el sandbox e IPS, y al menos controlar los tipos de archivos transferidos. <br><blockquote>  El problema m√°s com√∫n que se nota en las redes: el firewall es supuestamente el nivel 7, pero en realidad detecta aplicaciones por puerto.  ¬øC√≥mo verificarlo? <br><br><ol><li>  Para la prueba, cuelgue el servidor FTP en el puerto 25.  Si el dispositivo se equivoca y dice que es el protocolo SMTP, entonces este definitivamente no es el firewall L7. </li><li>  O simplemente intente escribir reglas para dos aplicaciones diferentes que usan el mismo puerto.  Haga diferentes reglas para ellos: en un bloque de archivos exe, en el otro, perm√≠tales.  Si resulta que est√° hecho, significa que la verdad es el an√°lisis de la aplicaci√≥n (no el n√∫mero de puerto) primero, y luego trabajar con su contenido: bloqueo de archivos, verificaci√≥n de firmas de virus, verificaci√≥n de firmas IPS, etc. </li><li>  Otra prueba interesante para NGFW es cuando necesita hacer dos aplicaciones L7 personalizadas con diferentes propiedades en la misma direcci√≥n IP.  Esto no puede firewall L4, pero puede firewall L7.  Descripci√≥n completa y prueba aqu√≠: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://basic.ngfw-test.com/</a> </li></ol></blockquote>  En Rusia, sigue siendo importante que los firewalls conozcan el tr√°fico de las aplicaciones rusas: 1C, Odnoklassniki, Yandex.Disk, mail.ru, c√≥mo se ven las actualizaciones de Kaspersky Anti-Virus, etc.  Este tambi√©n es un componente importante de descubrimiento de aplicaciones que necesita para permitir de forma segura estas aplicaciones a sus empleados. <br><br><a name="Comfort"></a><h2>  L7 Firewall es m√°s conveniente </h2><br>  Si observa el proceso de capacitaci√≥n de ingenieros de redes, la mayor√≠a de las veces las personas toman cursos de un conocido fabricante de equipos de redes y esto brinda un buen conocimiento de las tecnolog√≠as de redes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e73/5bc/284/e735bc2844f2258e4d11fe3e702d2fd2.jpg"><br><br>  El autor de estas l√≠neas termin√≥ una buena cantidad de cursos de Cisco en 2003 y, por lo tanto, presenta cu√°les son las caracter√≠sticas de la capacitaci√≥n para ingenieros de redes: como regla general, despu√©s de estudiar el modelo ISO OSI de siete niveles, solo se estudian en detalle los primeros 4 niveles.  Es decir, todas las sutilezas de los ingenieros de redes de seguridad de la informaci√≥n solo se conocen hasta el nivel de TCP / UDP / ICMP.  Solo se consideran unos pocos b√°sicos desde el nivel de la aplicaci√≥n: HTTP, DNS, SSH, Telnet, NTP, FTP.  Cual es el resultado?  ¬°Y el administrador de red siente que administrar la capa de aplicaci√≥n es f√°cil desde la capa de transporte! <br><br>  Puede parecerle a un especialista en redes reci√©n horneado que todo se puede hacer con reglas a nivel de transporte, donde solo necesita permitir el protocolo y el puerto necesarios.  ¬øNecesita permitir un navegador en Internet?  Abrimos TCP / 80.  ¬øNecesitas abrir DNS?  Abra TCP / 53 o UDP / 53.  ¬øNecesitas abrir RDP?  Abra TCP / 3389.  Y escribir reglas en el firewall L4 se est√° convirtiendo en el est√°ndar en la empresa. <br><br>  Debo decir que muchos especialistas de TI son conscientes del concepto de inspecci√≥n completa.  Pero al mismo tiempo, para muchos, es una revelaci√≥n que los diferentes firewalls admiten la inspecci√≥n satefull para un conjunto diferente de aplicaciones.  Tengo ciertas estad√≠sticas porque trabaj√© como profesor de cursos de Firewall en el centro de capacitaci√≥n de la empresa Informzashita.  Que estoy viendo  Alguien piensa que la inspecci√≥n con estado es solo un permiso para aceptar las respuestas del protocolo TCP / UDP / ICMP.  ¬øPero qu√© pasa con las aplicaciones m√°s complejas?  Por ejemplo, ¬øc√≥mo rastrear dos conexiones TCP que hace el protocolo FTP en los puertos 21 y 20? ¬øDependen unas de otras?  All√≠ no solo debe aceptar la respuesta, sino tambi√©n permitir la segunda conexi√≥n, seg√∫n el comando PORT, dentro de la conexi√≥n de control en el puerto 21.  ¬øY cu√°ntas aplicaciones m√°s para abrir nuevas conexiones dentro de ellos dan aplicaciones?  En resumen, las redes ahora usan la lista de acceso habitual, que no entiende el comando PORT dentro del protocolo FTP, y est√° el firewall L4, que desmonta el comando PORT y abre autom√°ticamente el puerto deseado, hay alguien que ha ido m√°s all√° y mira los comandos m√°s complejos del protocolo MS RPC o ICS / Protocolos SCADA.  Pero todas las aplicaciones posibles del firewall L4 no se ven, y estos firewalls tambi√©n difieren generalmente en la cantidad de aplicaciones implementadas dentro del Application Layer Gateway (ALG). <br><br>  ¬øA qu√© estoy llegando?  La convicci√≥n de que solo recordar los principales puertos TCP / UDP no funciona. <br>  Ya existen varios miles de aplicaciones en el mundo y todas ellas utilizan redes inform√°ticas.  Y ning√∫n ingeniero de redes puede recordar todos estos puertos. <br><br>  La revelaci√≥n para los ingenieros de redes es la tarea de abrir puertos para una aplicaci√≥n m√°s compleja, por ejemplo, VNC.  Nadie recuerda qu√© puertos hay y tiene que usar google. <br><blockquote>  Al publicar la primera parte, realic√© una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">encuesta</a> y veo que la gente todav√≠a est√° lista para recordar los n√∫meros de puerto: las opiniones se dividieron entre 50 y 50: alguien respondi√≥ que estaba listo para recordar los 4 puertos de la aplicaci√≥n VNC. <br><br>  Quiz√°s el campe√≥n en el n√∫mero de puertos es Lync (tambi√©n conocido como Skype for Business).  Unos 40 puertos.  ¬øEs realista recordarlos? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/795/133/dad/795133dad8b8ad8e24d78cfba7d8056c.png"></blockquote>  Si <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">observa</a> Microsoft TechNet, que describe qu√© puertos necesita abrir, entonces quiero escribir un permiso para cualquier regla, porque hay alrededor de 40 puertos y algunos de ellos deben abrirse din√°micamente.  Y es desastrosamente inconveniente registrarse en el firewall L4. <br><br>  Resulta que es m√°s conveniente para un ingeniero de redes escribir las reglas de la aplicaci√≥n L7 y es necesario que el firewall abra autom√°ticamente los puertos necesarios. <br><br>  ¬øNecesitas abrir VNC?  Escribe la palabra VNC en la regla y el firewall ya comprende qu√© protocolos subyacentes debe abrir.  Esto es conveniente <br><br>  <b>Un ejemplo</b>  <b>Informe NGFW sobre categor√≠as de tr√°fico seleccionadas.</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d38/cf1/44f/d38cf144fe1b72801cb6665551f246f7.png"><br><br>  En promedio, 200-300 aplicaciones utilizan el acceso a Internet desde una red corporativa.  El firewall de nivel de aplicaci√≥n muestra qu√© aplicaciones es y puede filtrar estas aplicaciones para todos o para usuarios espec√≠ficos y filtrar archivos por tipos o contenido que van a aplicaciones permitidas para todos los usuarios en la red corporativa.  Adem√°s, no olvide que en NGFW, las funciones de seguridad funcionan en paralelo: IPS, antivirus, antispyware, filtro de URL, filtro DNS, Inteligencia de amenazas, etc.  Es decir, no solo permitimos aplicaciones, sino que lo hacemos de forma segura. <br><br><a name="Security"></a><h2>  El firewall L7 es m√°s seguro </h2><br>  Tengo el NGFW de Palo Alto Networks a mano.  Escrib√≠ tres reglas diferentes al respecto.  Veamos en qu√© se diferencian. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/934/f87/9d9/934f879d9fc26ca130016ebcf12d3986.png"><br><br>  Si alguna vez configur√≥ un firewall, ver√° que para diferentes grupos de usuarios: vip, marketing y programadores, habilit√© SSL de tres maneras diferentes. <br><br><ol><li>  <b>Los</b> usuarios <b>VIP</b> podr√°n ir <b>al puerto 443 y podr√°n usar SSL dentro de √©l</b> , ya que es el puerto predeterminado para SSL.  Si intentan ir al puerto 443, por ejemplo, telnet regular, entonces no tendr√°n √©xito: el firewall verificar√° que no sea SSL y lo bloquear√°.  ¬°Y esto es lo que necesitas! </li><li>  <b>el marketing</b> puede ir <b>a cualquier puerto usando SSL</b> , porque en el campo Servicio, donde se indican los puertos, se permite cualquier puerto.  La pregunta es, ¬øquiero que el marketing use SSL en puertos no est√°ndar?  No  Este es un error de configuraci√≥n com√∫n.  Especificar un puerto como cualquiera es l√≥gico si la regla es prohibitiva, es decir, si queremos prohibir SSL en cualquier puerto. </li><li>  <b>los programadores</b> pueden caminar <b>en el puerto 443 con cualquier aplicaci√≥n</b> , lo que en realidad es un agujero, porque originalmente solo quer√≠a abrir SSL.  Y as√≠ es exactamente como funciona el firewall L4: abre el puerto y luego no le importa qu√© hay all√≠ y qu√© aplicaciones usan este puerto.  Cualquier programador en el grupo de programadores puede usar cualquier t√∫nel. </li></ol><br>  Establecer <b>el valor predeterminado de la aplicaci√≥n es</b> muy importante y le permite reducir la cantidad de reglas: puede especificar las aplicaciones necesarias en la columna Aplicaci√≥n en una regla y el firewall abrir√° los puertos necesarios para las aplicaciones necesarias y solo aquellas aplicaciones que deben ir all√≠ pasar√°n por estos puertos.  En consecuencia, necesita una regla para abrir m√∫ltiples aplicaciones. <br><br>  Por ejemplo, para la siguiente regla, donde todos los empleados pueden acceder a Internet solo de manera predeterminada, NGFW comprobar√° constantemente que solo desean el cliente DNS en el puerto 53 y no TCP sobre DNS.  Y, por supuesto, esto aumenta la seguridad, porque no solo permite aplicaciones, sino que controla que solo las aplicaciones que permite pasan a trav√©s de canales abiertos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/268/a16/3c8/268a163c8dc1bb195b9c34e02e18da65.png"><br><br><a name="Issues"></a><h2>  ¬øQu√© nuevos problemas crean un nuevo enfoque para escribir reglas para L7? </h2><br>  Debe comprender que determinar la aplicaci√≥n por el contenido del paquete es muy estresante para el procesador de firewall L7.  Si el firewall L4 habitual verific√≥ solo unos pocos bytes del encabezado del paquete TCP y luego pas√≥ los megabytes restantes del clip flash sin verificar, entonces el firewall L7 deber√≠a leer todo lo que est√° almacenado en el campo de datos TCP / IP y verificar constantemente qu√© contenido est√° dentro de la conexi√≥n TCP / IP, de repente cambiado o representa una amenaza para la empresa.  Por lo tanto, cuando apareci√≥ un an√°lisis funcional como el an√°lisis de contenido, todos los dispositivos comenzaron a disminuir.  Por lo tanto, el an√°lisis de contenido requiere dispositivos m√°s potentes. <br><br><a name="Limitations"></a><h2>  Limitaciones de la tecnolog√≠a de an√°lisis de nivel 7 </h2><br>  El cortafuegos L7 requiere m√°s memoria para almacenar el estado de una conexi√≥n, por lo tanto, el par√°metro "n√∫mero de conexiones simult√°neas" del cortafuegos L7 siempre es menor que el cortafuegos L4 con la misma cantidad de RAM en ambos dispositivos, y significativamente, cada 10 veces. Esto ya se explic√≥ anteriormente en la secci√≥n Statefull Inspecci√≥n  Y este es el precio por la seguridad de sus aplicaciones.  Por lo tanto, si est√° comparando la inspecci√≥n L4 y L7, pregunte al fabricante c√≥mo midi√≥ el par√°metro "n√∫mero de sesiones simult√°neas": con la seguridad habilitada en el nivel 7 o con deshabilitada. <br><br>  Lo mismo con el rendimiento: el procesador del cortafuegos L4 verifica solo unos pocos bytes del encabezado del paquete y luego transfiere los datos en s√≠ mismos a velocidades de enrutamiento sin verificar, y el cortafuegos L7 verifica tanto el encabezado como todos esos megabytes de datos contenidos en los paquetes de conexi√≥n posteriores.  Y este es un trabajo completamente diferente.  Por lo tanto, dicho trabajo debe realizarse en plataformas de hardware especializadas, donde se acelera el an√°lisis de aplicaciones, se acelera la transmisi√≥n de antivirus, se acelera IPS y otras funciones de seguridad.  Lo mejor de todo es que Cavium ha logrado crear chips para acelerar la seguridad, cuyos chips, por ejemplo, son utilizados por Palo Alto Networks.      FPGA()      IPS            FPGA.             ,        ‚Äî   . <br><br><a name="end"></a><h2>  Conclusi√≥n </h2><br> <b>-</b> ,    L7 firewall .          ,   .  :      NGFW             . <br><br> <b>-</b> ,      ,  L7 firewall         -       ,      . <br><br> <b>-</b> ,                  ,    . ,  -   80 . <br><br>  3.  SSL  NGFW. ( ) <br><br>  ! <br><br>   <br> denis@batrankov.ru <a name="vote"></a></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es436836/">https://habr.com/ru/post/es436836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es436798/index.html">Deformaci√≥n profesional del administrador</a></li>
<li><a href="../es436800/index.html">T√©cnica de proyecto de bricolaje. Parte dos</a></li>
<li><a href="../es436822/index.html">Android Robotics hasta 2019: la historia real; en 5 partes; parte 3</a></li>
<li><a href="../es436828/index.html">La transici√≥n a Boost-1.65.1 y los errores que surgieron</a></li>
<li><a href="../es436830/index.html">Android Robotics hasta 2019: la historia real; en 5 partes; parte 5</a></li>
<li><a href="../es436838/index.html">Comprender las redes neuronales convolucionales a trav√©s de visualizaciones en PyTorch</a></li>
<li><a href="../es436840/index.html">El camino del brillo a la neurociencia: un podcast tem√°tico sobre carreras en medios y marketing de contenidos</a></li>
<li><a href="../es436842/index.html">Soluci√≥n Veeam para respaldo y recuperaci√≥n de m√°quinas virtuales en la plataforma Nutanix AHV. Parte 2</a></li>
<li><a href="../es436846/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 348 (14-20 de enero de 2019)</a></li>
<li><a href="../es436848/index.html">NSA anuncia lanzamiento de herramienta interna para ingenier√≠a inversa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>