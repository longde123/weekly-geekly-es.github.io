<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧗🏼 📋 🚴🏽 Pruebas de rendimiento del servidor en la nube con Dwarf Fortress ⛽️ 💭 👉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dwarf Fortress es un juego legendario que simula un mundo de fantasía en detalle, y un jugador (en uno de los modos) puede construir y gestionar un as...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pruebas de rendimiento del servidor en la nube con Dwarf Fortress</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401485/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dwarf Fortress</a> es un juego legendario que simula un mundo de fantasía en detalle, y un jugador (en uno de los modos) puede construir y gestionar un asentamiento (fortaleza) de gnomos (enanos).  Ya se ha escrito lo suficiente sobre el juego, así que no entraré en detalles.  Es importante que, debido al gran tamaño del mundo del juego y los altos detalles de la simulación, el juego requiera bastante recursos, tanto el procesador como la memoria / caché.  El juego es compatible con los tres principales sistemas operativos. <br><br>  Hay un proyecto DFHack para el juego, que se dedica a la ingeniería inversa de las estructuras de datos del juego y le permite crear complementos y scripts en C ++, Lua o Ruby. <br><br>  Soy el autor de la aplicación y el código del servidor que lo acompaña que implementa completamente la interfaz de usuario del juego en dispositivos iOS.  Es decir, el usuario coloca el juego original, el complemento y la aplicación, y puede jugar de forma remota desde un dispositivo móvil con todas las comodidades. <br><br>  El servidor se puede instalar tanto en casa como alquilado de uno de los proveedores de la nube.  Y nació la idea de este estudio: en primer lugar, para averiguar cuál de los servicios en la nube es más adecuado y se puede recomendar a los usuarios en primer lugar, y en segundo lugar, comparar el rendimiento del servidor utilizando algo diferente de los servidores web y utilidades especiales . <br><a name="habracut"></a><br>  Para las pruebas, se utilizó la versión de Dwarf Fortress / DFHack 0.43.03-r1.  Tengo una imagen pública de Docker, incluido el juego en sí y la versión mínima de DFHack (así como el código del servidor en sí para el juego remoto, pero en este caso no se usa).  Se escribió un script en Lua para ejecutar pruebas y enviar los resultados a un servidor web.  También para la automatización, se utilizó el siguiente script, especificado en los datos del usuario al configurar los servidores.  Es decir, solo necesita crear un servidor, esperar hasta que lleguen los resultados y eliminarlo. <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash fallocate -l 4G /swp ; chmod 600 /swp ; mkswap /swp ; swapon /swp ; echo '/swp none swap sw 0 0' &gt;&gt;/etc/fstab apt-get update apt-get install -fy docker.io apt install unzip wget https://github.com/mifki/dfremote-cloud-benchmark/raw/master/benchmark.lua wget http://mifki.com/a/t/gloveloved.zip unzip gloveloved.zip -d save/ docker run --name=df -dt -v $PWD/save:/df_linux/data/save -v $PWD/benchmark.lua:/df_linux/hack/scripts/benchmark.lua mifki/dfremote sleep 5 docker exec df /df_linux/dfhack-run benchmark server_name</span></span></code> </pre> <br>  Se probaron los siguientes proveedores: Digital Ocean, Amazon Lightsail, Amazon EC2, Vultr, Linode, Google Compute Engine y Macbook Pro Late 2013 2Ghz Core i7. <br><br>  Si el servicio en la nube admite la creación de un servidor con Docker con un solo clic, entonces se usó esta característica; de lo contrario, se seleccionó la versión de Ubuntu 16.04.  Por lo tanto, solo Vultr no usó Ubuntu, sino CentOS 7. Para los servidores con más de 2 GB de memoria, no se usó el archivo de intercambio.  Para Google Compute Engine micro y pequeño, se seleccionó una unidad SSD. <br><br>  Se eligieron las opciones de servidor más baratas, en primer lugar, porque son más interesantes para quienes las van a usar para el juego, y en segundo lugar, porque Dwarf Fortress todavía usa solo un núcleo de procesador para la simulación y (en la versión especificada) Aplicación de 32 bits. <br><br><h3>  Pruebas </h3><br>  El proceso de jugar Dwarf Fortress consta de dos partes: la generación del mundo y la historia inicial, en la que puedes especificar el tamaño del mundo y la duración de la historia (y otros parámetros), y el proceso del juego en sí.  Consistentemente, sin reiniciar el juego, se realizaron las siguientes pruebas: <br><br><ol><li>  Generando un mundo de un tamaño muy pequeño con una historia muy larga. </li><li>  Generando un mundo de gran tamaño con una historia corta. </li><li>  Jugabilidad  Usó uno de los "grupos" (cuando muchas personas juegan por turno) guarda - glovedloved (Anethadefíni, 254).  La elección no es tan importante, siempre que haya una fortaleza lo suficientemente grande, y nada que detenga automáticamente el juego no suceda durante la prueba, que duró 20 días en el juego. </li></ol><br>  La última prueba es más importante, en primer lugar, porque es el juego en sí mismo, por lo que sucede todo, y en segundo lugar, se ve menos afectado por el azar que la generación del mundo (en el que civilizaciones, asentamientos, paisajes, eventos y etc.) <br><br><h3>  Resultados </h3><br>  Aquí está el horario.  Tiempo de ejecución en segundos, respectivamente, menos es mejor.  Precios mensuales en dólares estadounidenses. <br><br><img src="https://habrastorage.org/files/d87/d72/2de/d87d722deebd43f48670376da89c58f7.png" alt="imagen"><br><br>  Una propagación no natural en los resultados de la primera prueba es inmediatamente visible, no sé exactamente con qué está conectado.  Creo, en parte con el almacenamiento en caché, en parte con el bajo rendimiento del servidor recién creado por alguna razón.  Por lo tanto, los resultados se ordenan por la última prueba, que, como se señaló, es la más importante.  La segunda prueba también generalmente se correlaciona con los resultados de la tercera. <br><br>  Además del primer lugar esperado en el servidor EC2 c4.large, que está relacionado con el rendimiento optimizado tipo C4, Amazon Lightsail resultó ser el más rápido, lo que, teniendo en cuenta el precio, es una sorpresa bastante agradable.  Le sigue casi el mismo resultado del servidor y la computadora portátil de procesador único de Google.  Además, el previamente desconocido Vultr, Linode, del que esperaba más, resultó ser bueno.  El Premio del Público es para Digital Ocean: más lento, pero el más fácil y rápido de usar.  Los servidores EC2 m3.medium bastante caros son sorprendentemente lentos, y los servidores GCE más baratos son realmente malos incluso con SSD, no obtuve el resultado de probar el servidor de tamaño micro. <br><br>  Por separado, hay que decir sobre las instancias EC2 de tipo T2.  Su característica es que con un servidor simple recibe créditos de procesador (hasta cierto límite), que se gastan bajo carga.  Al gastar préstamos, el servidor se ejecuta a plena capacidad cuando se agota: el rendimiento cae al 20%.  Por un lado, es muy adecuado para nuestros propósitos: las personas, especialmente desde un dispositivo móvil, no juegan continuamente todo el día, además la simulación en el juego se detiene cuando una persona hace algo en el menú, etc., por lo que esta es una buena opción para obtener Alto rendimiento por poco dinero.  Por otro lado, este es un rendimiento "falso", por lo que no incluí instancias de este tipo en las pruebas para no confundir a nadie.  Por experiencia, siempre que haya préstamos, son bastante rápidos, cuando se agotan, muy lentos. <br><br>  Eso es todo </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es401485/">https://habr.com/ru/post/es401485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es401475/index.html">Interpretación de múltiples mundos y multiverso: ¿pueden resultar ser una misma idea?</a></li>
<li><a href="../es401477/index.html">Los investigadores de IBM miden la conductividad térmica a través de un contacto monoatómico</a></li>
<li><a href="../es401479/index.html">Vacante</a></li>
<li><a href="../es401481/index.html">10 tecnologías que deberían estar en un teléfono inteligente moderno</a></li>
<li><a href="../es401483/index.html">Elementos de protección de billetes. Investigación privada</a></li>
<li><a href="../es401487/index.html">La octava generación de Intel Core permanecerá en el proceso de fabricación de 14 nm.</a></li>
<li><a href="../es401489/index.html">Ford está desarrollando su propio sistema autónomo de control de vehículos</a></li>
<li><a href="../es401491/index.html">Ingenieros japoneses han creado un polinizador quadrocopter</a></li>
<li><a href="../es401493/index.html">Los matemáticos arrojan luz sobre una hipótesis minimalista</a></li>
<li><a href="../es401495/index.html">La historia de la tecnología implantable. Audífonos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>