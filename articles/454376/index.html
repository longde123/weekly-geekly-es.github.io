<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌙 🔩 🚤 Varias cosas en MetaPost 🍝 🚼 👛</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¿Cuál es la mejor herramienta para dibujar imágenes vectoriales? Para mí y probablemente para muchos otros, la respuesta es bastante obvia: Illustrato...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varias cosas en MetaPost</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454376/">  ¿Cuál es la mejor herramienta para dibujar imágenes vectoriales?  Para mí y probablemente para muchos otros, la respuesta es bastante obvia: Illustrator o, tal vez, Inkscape.  Al menos eso es lo que pensé cuando me pidieron dibujar unos ochocientos diagramas para un libro de texto de física.  Nada excepcional, solo un montón de ilustraciones en blanco y negro con esferas, resortes, poleas, lentes, etc.  En ese momento ya se sabía que el libro se iba a hacer en LaTeX y me dieron varios documentos de MS Word con imágenes incrustadas.  Algunos de ellos eran imágenes escaneadas de otros libros, algunos eran dibujos a lápiz.  Imaginar días y noches de tintas de este material me hizo sentir mareado, así que pronto me encontré fantaseando con una solución más automatizada.  Por alguna razón, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MetaPost se</a> convirtió en el foco de estas fantasías. <br><br><img src="https://habrastorage.org/webt/nu/e4/zb/nue4zbfxj3ubc7m1cggctnzg7e4.png"><br><br><a name="habracut"></a><br><br>  La principal ventaja de usar la solución MetaPost (o similar) es que cada imagen puede ser una especie de función de varias variables.  Dicha imagen se puede ajustar rápidamente para cualquier circunstancia imprevista del diseño, sin interrumpir las relaciones internas importantes de la ilustración (algo que realmente me preocupaba), que no se logra fácilmente con herramientas más tradicionales.  Además, los elementos recurrentes, todas estas esferas y resortes, pueden hacerse más interesantes visualmente de lo que las herramientas convencionales permitirían con las mismas limitaciones de tiempo. <br><br>  Quería hacer fotos con algún tipo de eclosión, no muy diferente de lo que encuentras en los libros antiguos. <br><br><img src="https://habrastorage.org/webt/uq/2h/ay/uq2hayq7aiptmw1eididz3u3-q0.png"><br><br>  Primero, necesitaba poder producir algunas curvas de grosor variable.  La principal complicación aquí es construir una curva que siga la curva original a una distancia variable.  Probablemente utilicé el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">método de</a> trabajo más primitivo, que se reduce a simplemente cambiar los segmentos de línea que conectan los puntos de control de la curva de Bezier en una distancia dada, excepto que esta distancia varía a lo largo de la curva. <br><br><img src="https://habrastorage.org/webt/vm/jq/ha/vmjqhahvkkwaek72szkggyjoocs.png"><br><br>  En la mayoría de los casos, funcionó bien. <br><br><img src="https://habrastorage.org/webt/pt/vr/gr/ptvrgric1es7mutjptz6oli7w0k.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> De aquí en adelante se supone que la biblioteca se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">descarga</a> y se <code>input fiziko.mp;</code>  está presente en el código MetaPost.  El método más rápido es usar ConTeXt (entonces no necesita <code>beginfig</code> y <code>endfig</code> ): <br><br> <code>\starttext <br> \startMPcode <br> input fiziko.mp; <br> % the code goes here <br> \stopMPcode <br> \stoptext <br></code> <br><br>  o LuaLaTeX: <br><br> <code>\documentclass{article} <br> \usepackage{luamplib} <br> \begin{document} <br> \begin{mplibcode} <br> input fiziko.mp; <br> % the code goes here <br> \end{mplibcode} <br> \end{document} <br></code> <br><br> <code>beginfig(3); <br> path p, q; % MetaPost's syntax is reasonably readable, so I'll comment mostly on my stuff <br> p := (0,-1/4cm){dir(30)}..(5cm, 0)..{dir(30)}(10cm, 1/4cm); <br> q := offsetPath(p)(1cm*sin(offsetPathLength*pi)); % first argument is the path itself, second is a function of the position along this path (offsetPathLength changes from 0 to 1), which determines how far the outline is from the original line <br> draw p; <br> draw q dashed evenly; <br> endfig; <br></code> <br></div></div><br><br>  Se pueden combinar dos contornos para hacer una línea de contorno para un trazo de espesor variable. <br><br><img src="https://habrastorage.org/webt/1k/fn/hl/1kfnhlmi6xbx0ax-iurvsrii6wk.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(4); <br> path p, q[]; <br> p := (0,-1/4cm){dir(30)}..(5cm, 0)..{dir(30)}(10cm, 1/4cm); <br> q1 := offsetPath(p)(1/2pt*(sin(offsetPathLength*pi)**2)); % outline on one side <br> q2 := offsetPath(p)(-1/2pt*(sin(offsetPathLength*pi)**2)); % and on the other <br> fill q1--reverse(q2)--cycle; <br> endfig; <br></code> <br></div></div><br><br>  El grosor de la línea debe tener un límite inferior, de lo contrario, algunas líneas serán demasiado delgadas para imprimirse correctamente y esto no se ve muy bien.  Una de las opciones (la que elegí) es hacer que las líneas sean muy finas, de modo que la cantidad total de tinta por unidad de longitud permanezca aproximadamente igual que en la línea más delgada deseada.  En otras palabras, en lugar de reducir la cantidad de tinta en los lados de la línea, el algoritmo toma algo de tinta de la línea misma. <br><br><img src="https://habrastorage.org/webt/8j/ry/i6/8jryi6otsaqaegxccgrn3ghtzgg.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(5); <br> path p; <br> p := (0,-1/4cm){dir(30)}..(5cm, 0)..{dir(30)}(10cm, 1/4cm); <br> draw brush(p)(1pt*(sin(offsetPathLength*pi)**2)); % the arguments are the same as for the outline <br> endfig; <br></code> <br></div></div><br><br>  Una vez que haya trabajado líneas de grosor variable, puede dibujar esferas.  Una esfera se puede representar como una serie de círculos concéntricos con grosores de línea que varían según la salida de una función que calcula la luminosidad de un punto particular en la esfera. <br><br><img src="https://habrastorage.org/webt/ay/3u/ra/ay3uraynyq4zgxem7aqgfprswz0.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(6); <br> draw sphere.c(1.2cm); <br> draw sphere.c(2.4cm) shifted (2cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Otro bloque de construcción conveniente es un "tubo".  En términos generales, es un cilindro que puedes doblar.  Mientras el diámetro sea constante, es bastante sencillo. <br><br><img src="https://habrastorage.org/webt/xh/-h/vp/xh-hvpqdu7ox-ksq36x8cub5dym.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(7); <br> path p; <br> p := subpath (1,8) of fullcircle scaled 3cm; <br> draw tube.l(p)(1/2cm); % arguments are the path itself and the tube radius <br> endfig; <br></code> <br></div></div><br><br>  Si el diámetro no es constante, las cosas se vuelven más complicadas: la cantidad de golpes debería cambiar de acuerdo con el grosor del tubo para mantener constante la cantidad de tinta por unidad de área antes de tener en cuenta las luces. <br><br><img src="https://habrastorage.org/webt/5m/pp/qu/5mppqukv594bcuynso_nmc7qmjy.gif"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(8); <br> path p; <br> p := pathSubdivide(fullcircle, 2) scaled 3cm; % this thing splits every segment between the points of a path (here—fullcircle) into several parts (here—2) <br> draw tube.l(p)(1/2cm + 1/6cm*sin(offsetPathLength*10pi)); <br> endfig; <br></code> <br></div></div><br><br>  También hay tubos con trama transversal.  El problema de mantener constante la cantidad de tinta resultó ser aún más complicado en este caso, por lo que a menudo estos tubos se ven un poco peludos. <br><br><img src="https://habrastorage.org/webt/1o/bn/es/1obnes-_u_rgin3h_obl3sruomk.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(9); <br> path p; <br> p := pathSubdivide(fullcircle, 2) scaled 3cm; <br> draw tube.t(p)(1/2cm + 1/6cm*sin(offsetPathLength*10pi)); <br> endfig; <br></code> <br></div></div><br><br>  Los tubos se pueden utilizar para construir una amplia gama de objetos: desde conos y cilindros hasta balaustres. <br><br><img src="https://habrastorage.org/webt/45/yv/u3/45yvu3z7g6ers_ftbx8pcsj1shg.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(10); <br> draw tube.l ((0, 0) -- (0, 3cm))((1-offsetPathLength)*1cm) shifted (-3cm, 0); % a very simple cone <br> path p; <br> p := (-1/2cm, 0) {dir(175)} .. {dir(5)} (-1/2cm, 1/8cm) {dir(120)} .. (-2/5cm, 1/3cm) .. (-1/2cm, 3/4cm) {dir(90)} .. {dir(90)}(-1/4cm, 9/4cm){dir(175)} .. {dir(5)}(-1/4cm, 9/4cm + 1/5cm){dir(90)} .. (-2/5cm, 3cm); % baluster's envelope <br> p := pathSubdivide(p, 6); <br> draw p -- reverse(p xscaled -1) -- cycle; <br> tubeGenerateAlt(p, p xscaled -1, p rotated -90); % a more low-level stuff than tube.t, first two arguments are tube's sides and the third is the envelope. The envelope is basically a flattened out version of the outline, with line length along the x axis and the distance to line at the y. In the case of this baluster, it's simply its side rotated 90 degrees. <br> endfig; <br></code> <br></div></div><br><br>  Algunas construcciones que se pueden hacer a partir de estas primitivas se incluyen en la biblioteca.  Por ejemplo, el globo es básicamente una esfera. <br><br><img src="https://habrastorage.org/webt/fz/ie/km/fziekmabaiygkxvyt95ekstjqlw.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(11); <br> draw globe(1cm, -15, 0) shifted (-6/2cm, 0); % radius, west longitude, north latitude, both decimal <br> draw globe(3/2cm, -30.280577, 59.939461); <br> draw globe(4/3cm, -140, -30) shifted (10/3cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Sin embargo, la eclosión aquí es latitudinal y controlar la densidad de la línea es mucho más difícil que en las esferas regulares con eclosión "concéntrica", por lo que es un tipo diferente de esfera. <br><br><img src="https://habrastorage.org/webt/qi/mw/jt/qimwjtr16zlbg_j_v0htivtwe-q.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(12); <br> draw sphere.l(2cm, -60); % diameter and latitude <br> draw sphere.l(3cm, 45) shifted (3cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  Un peso es una construcción simple hecha de tubos de dos tipos. <br><br><img src="https://habrastorage.org/webt/rb/q-/dg/rbq-dgwygbxz4u9bglo1jgeqgkc.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(13); <br> draw weight.s(1cm); % weight height <br> draw weight.s(2cm) shifted (2cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  También hay una herramienta para anudar los tubos. <br><br><img src="https://habrastorage.org/webt/kv/xs/sn/kvxssnbhkpirxvjjg-8mb6f5__g.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b>  <b class="spoiler_title">Por brevedad, solo un nudo.</b> <div class="spoiler_text"> <code>beginfig(14); <br> path p; <br> p := (dir(90)*4/3cm) {dir(0)} .. tension 3/2 ..(dir(90 + 120)*4/3cm){dir(90 + 30)} .. tension 3/2 ..(dir(90 - 120)*4/3cm){dir(-90 - 30)} .. tension 3/2 .. cycle; <br> p := p scaled 6/5; <br> addStrandToKnot (primeOne) (p, 1/4cm, "l", "1, -1, 1"); % first, we add a strand of width 1/4cm going along the path p to the knot named primeOne. its intersections along the path go to layers "1, -1, 1" and the type of tube is going to be "l". <br> draw knotFromStrands (primeOne); % then the knot is drawn. you can add more than one strand. <br> endfig; <br></code> <br></div></div><br><br>  Los tubos en nudos caen sombras entre sí como deberían.  En teoría, esta característica se puede usar en otros contextos, pero como no tenía planes de profundizar en la tercera dimensión, la interfaz de usuario es algo deficiente y las sombras funcionan correctamente solo para algunos objetos. <br><br><img src="https://habrastorage.org/webt/5n/st/h1/5nsth1dhrepzvtzzczn20-gbgdq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(15); <br> path shadowPath[]; <br> boolean shadowsEnabled; <br> numeric numberOfShadows; <br> shadowsEnabled := true; % shadows need to be turned on <br> numberOfShadows := 1; % number of shadows should be specified <br> shadowPath0 := (-1cm, -2cm) -- (-1cm, 2cm) -- (-1cm +1/6cm, 2cm) -- (-1cm + 1/8cm, -2cm) -- cycle; % shadow-dropping object should be a closed path <br> shadowDepth0 := 4/3cm; % it's just this high above the object on which the shadow falls <br> shadowPath1 := shadowPath0 rotated -60; <br> shadowDepth1 := 4/3cm; <br> draw sphere.c(2.4cm); % shadows work ok only with sphere.c and tube.l with constant diameter <br> fill shadowPath0 withcolor white; <br> draw shadowPath0; <br> fill shadowPath1 withcolor white; <br> draw shadowPath1; <br> endfig; <br></code> <br></div></div><br><br>  Ciertamente, necesitará una textura de madera (actualización: desde que se publicó la versión rusa de este artículo, el primer caso de esta biblioteca se usó en un proyecto real que sé que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ha ocurrido</a> , y fue la textura de madera la que vino útil, así que esto no terminó siendo una broma después de todo).  Cómo las ramitas y su crecimiento afectan el patrón de los anillos anuales es un tema de estudio serio.  El modelo de trabajo más simple que se me ocurre es el siguiente: los anillos anuales son superficies planas paralelas, distorsionadas por ramas en crecimiento;  así, la superficie se modifica por una serie de "funciones de ramita" no demasiado complejas en diferentes lugares y las isolinas de la superficie se toman como el patrón de anillo anual. <br><br><img src="https://habrastorage.org/webt/qr/st/oa/qrstoajkhoqywh-ejey6vj6uyqm.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(16); <br> numeric w, b; <br> pair A, B, C, D, A', B', C', D'; <br> w := 4cm; <br> b := 1/2cm; <br> A := (0, 0); <br> A' := (b, b); <br> B := (0, w); <br> B' := (b, wb); <br> C := (w, w); <br> C' := (wb, wb); <br> D := (w, 0); <br> D' := (wb, b); <br> draw woodenThing(A--A'--B'--B--cycle, 0); % a piece of wood inside the A--A'--B'--B--cycle path, with wood grain at 0 degrees <br> draw woodenThing(B--B'--C'--C--cycle, 90); <br> draw woodenThing(C--C'--D'--D--cycle, 0); <br> draw woodenThing(A--A'--D'--D--cycle, 90); <br> eyescale := 2/3cm; % scale for the eye <br> draw eye(150) shifted 1/2[A,C]; % the eye looks in 150 degree direction <br> endfig; <br></code> <br></div></div><br><br>  El ojo de la imagen de arriba se abre de par en par o se entrecierra un poco y su pupila también cambia su tamaño.  Puede que no tenga ningún sentido práctico, pero los ojos mecánicamente similares solo parecen aburridos. <br><br><img src="https://habrastorage.org/webt/xp/e_/wj/xpe_wjoohdkazhkjsnh25ezbidy.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>beginfig(17); <br> eyescale := 2/3cm; % 1/2cm by default <br> draw eye(0) shifted (0cm, 0); <br> draw eye(0) shifted (1cm, 0); <br> draw eye(0) shifted (2cm, 0); <br> draw eye(0) shifted (3cm, 0); <br> draw eye(0) shifted (4cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  La mayoría de las veces las ilustraciones no eran tan complejas, pero un enfoque más riguroso requeriría resolver muchos de los problemas en el libro de texto para ilustrarlos correctamente.  Digamos, el problema de la polea de L'Hôpital (no estaba en ese libro de texto, pero de todos modos): en la cuerda con la longitud <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.057ex" viewBox="0 -780.1 298.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhhCAdNjBojR_V5S-GHL0s_8Uu9DxQ#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> l </script>  suspendido en el punto <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhhCAdNjBojR_V5S-GHL0s_8Uu9DxQ#MJMATHI-41" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> A </script>  cuelga una polea;  está enganchado a otra cuerda, suspendido en el punto <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhhCAdNjBojR_V5S-GHL0s_8Uu9DxQ#MJMATHI-42" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> B </script>  con el peso <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454376/&amp;usg=ALkJrhhCAdNjBojR_V5S-GHL0s_8Uu9DxQ#MJMATHI-43" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> C </script>  en su final  La pregunta es: ¿a dónde va el peso si tanto la polea como las cuerdas no pesan nada?  Sorprendentemente, la solución y la construcción de este problema no son tan simples.  Pero al jugar con varias variables, puede hacer que la imagen se vea bien para la página mientras se mantiene la precisión. <br><br><img src="https://habrastorage.org/webt/qy/fn/ej/qyfnejrodxcjjzcxnzjwhstyjbq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Código de ejemplo</b> <div class="spoiler_text"> <code>vardef lHopitalPulley (expr AB, l, m) = % distance AB between the suspension points of the ropes and their lengths l and m. “Why no units of length?”, you may ask. It's because some calculations inside can cause arithmetic overflow in MetaPost. <br> save A, B, C, D, E, o, a, x, y, d, w, h, support; <br> image( <br> pair A, B, C, D, E, o[]; <br> path support; <br> numeric a, x[], y[], d[], w, h; <br> x1 := (l**2 + abs(l)*((sqrt(8)*AB)++l))/4AB; % the solution <br> y1 := l+-+x1; % second coordinate is trivial <br> y2 := m - ((AB-x1)++y1); % as well as the weight's position <br> A := (0, 0); <br> B := (AB*cm, 0); <br> D := (x1*cm, -y1*cm); <br> C := D shifted (0, -y2*cm); <br> d1 := 2/3cm; d2 := 1cm; d3 := 5/6d1; % diameters of the pulley, weight and the pulley wheel <br> w := 2/3cm; h := 1/3cm; % parameters of the wood block <br> o1 := (unitvector(CD) rotated 90 scaled 1/2d3); <br> o2 := (unitvector(DB) rotated 90 scaled 1/2d3); <br> E := whatever [D shifted o1, C shifted o1] <br> = whatever [D shifted o2, B shifted o2]; % pulley's center <br> a := angle(AD); <br> support := A shifted (-w, 0) -- B shifted (w, 0) -- B shifted (w, h) -- A shifted (-w, h) -- cycle; <br> draw woodenThing(support, 0); % wood block everything is suspended from <br> draw pulley (d1, a - 90) shifted E; % the pulley <br> draw image( <br> draw A -- D -- B withpen thickpen; <br> draw D -- C withpen thickpen; <br> ) maskedWith (pulleyOutline shifted E); % ropes should be covered with the pulley <br> draw sphere.c(d2) shifted C shifted (0, -1/2d2); % sphere as a weight <br> dotlabel.llft(btex $A$ etex, A); <br> dotlabel.lrt(btex $B$ etex, B); <br> dotlabel.ulft(btex $C$ etex, C); <br> label.llft(btex $l$ etex, 1/2[A, D]); <br> ) <br> enddef; <br> beginfig(18); <br> draw lHopitalPulley (6, 2, 11/2); % now you can choose the right parameters <br> draw lHopitalPulley (3, 5/2, 3) shifted (8cm, 0); <br> endfig; <br></code> <br></div></div><br><br>  ¿Y qué hay del libro de texto?  Por desgracia, cuando casi todas las ilustraciones y el diseño estaban listos, algo sucedió y el libro de texto fue cancelado.  Tal vez por eso, decidí reescribir la mayoría de las funciones de la biblioteca original desde cero (elegí no usar ninguno de los códigos originales, que, aunque indirectamente, me pagaron) y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ponerlo en GitHub</a> .  Algunas cosas, presentes en la biblioteca original, como las funciones para dibujar automóviles y tractores, no las incluí allí, se agregaron algunas características nuevas, por ejemplo, nudos. <br><br>  No se ejecuta rápidamente: toma aproximadamente un minuto producir todas las imágenes para este artículo con LuaLaTeX en mi computadora portátil con i5-4200U 1.6 GHz.  Se usa un generador de números pseudoaleatorios aquí y allá, por lo que no hay dos imágenes similares que sean absolutamente idénticas (esa es una característica) y cada ejecución produce imágenes ligeramente diferentes.  Para evitar sorpresas, simplemente puede establecer <code>randomseed := some number</code> y disfrutar de los mismos resultados en cada ejecución. <br><br>  Muchas gracias al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dr. ord</a> y a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mikael Sundqvist</a> por su ayuda con la versión en inglés de este texto. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/454376/">https://habr.com/ru/post/454376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454356/index.html">Habr Weekly # 3 / Runet vs TV, ARM vs Intel, unificación de datos estatales, sin un teléfono inteligente en 2019, sueños soviéticos del futuro</a></li>
<li><a href="../454366/index.html">Victoria en PHDays 9. Compartimos hacks de vida en tres partes. Parte 2</a></li>
<li><a href="../454368/index.html">Competencia de desarrolladores de complementos de TeamCity</a></li>
<li><a href="../454372/index.html">Noticias semanales: Huawei todavía tiene problemas, "teléfono cuántico" en la Federación de Rusia, ARM tiene nuevos procesadores</a></li>
<li><a href="../454374/index.html">La impresora 3D de fotopolímero de un proyector de video doméstico crea objetos sin capas</a></li>
<li><a href="../454378/index.html">Astronautas rusos en la luna para 2030: presentación de Rogozin</a></li>
<li><a href="../454382/index.html">Ivan Uglyansky y Vladimir Sitnikov en jug.msk.ru</a></li>
<li><a href="../454384/index.html">Corrección de la visión con láser: ¿es realmente efectivo el método Smile?</a></li>
<li><a href="../454386/index.html">MessageBox para AvaloniaUI</a></li>
<li><a href="../454388/index.html">ARA: algoritmo para encontrar el número máximo de puntos en una línea recta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>