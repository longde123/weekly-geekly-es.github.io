<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§µüèº üêÄ ü•ú Redes neuronales y aprendizaje profundo, cap√≠tulo 3, parte 1: mejorar la forma en que se entrenan las redes neuronales üë®‚Äçüíª üöÅ ‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Contenido 

- Cap√≠tulo 1: uso de redes neuronales para reconocer n√∫meros escritos a mano 
- Cap√≠tulo 2: c√≥mo funciona el algoritmo de retropropagaci√≥n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Redes neuronales y aprendizaje profundo, cap√≠tulo 3, parte 1: mejorar la forma en que se entrenan las redes neuronales</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458724/"><div class="spoiler">  <b class="spoiler_title">Contenido</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cap√≠tulo 1: uso de redes neuronales para reconocer n√∫meros escritos a mano</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cap√≠tulo 2: c√≥mo funciona el algoritmo de retropropagaci√≥n</a> </li><li>  Cap√≠tulo 3: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1: mejorar el m√©todo de entrenamiento de redes neuronales</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2: ¬øPor qu√© la regularizaci√≥n ayuda a reducir el reciclaje?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3: ¬øc√≥mo elegir hiperpar√°metros de red neuronal?</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cap√≠tulo 4: prueba visual de que las redes neuronales son capaces de calcular cualquier funci√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cap√≠tulo 5: ¬øpor qu√© las redes neuronales profundas son tan dif√≠ciles de entrenar?</a> </li><li>  Cap√≠tulo 6: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1: aprendizaje profundo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2: progreso reciente en el reconocimiento de im√°genes</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ep√≠logo: ¬øexiste un algoritmo simple para crear inteligencia?</a> </li></ul></div></div><br>  Cuando una persona aprende a jugar al golf, generalmente pasa la mayor parte de su tiempo preparando un golpe b√°sico.  Luego se acerca a otros golpes, gradualmente, estudiando estos o esos trucos, bas√°ndose en el golpe b√°sico y desarroll√°ndolo.  Del mismo modo, hasta ahora nos hemos centrado en comprender el algoritmo de retropropagaci√≥n.  Este es nuestro "golpe b√°sico", la base para la capacitaci√≥n de la mayor√≠a del trabajo con redes neuronales (NS).  En este cap√≠tulo, hablar√© sobre un conjunto de t√©cnicas que se pueden utilizar para mejorar nuestra implementaci√≥n m√°s simple de la propagaci√≥n hacia atr√°s y para mejorar la forma de ense√±ar NS. <br><br>  Entre las t√©cnicas que aprenderemos en este cap√≠tulo est√°n: la mejor opci√≥n para el papel de la funci√≥n de costo, a saber, la funci√≥n de costo con entrop√≠a cruzada;  cuatro llamados  m√©todos de regularizaci√≥n (regularizaci√≥n de L1 y L2, exclusi√≥n de neuronas [abandono], extensi√≥n artificial de datos de entrenamiento), que mejoran la generalizaci√≥n de nuestro NS m√°s all√° de los l√≠mites de los datos de entrenamiento;  mejor m√©todo para inicializar pesos de red;  Un conjunto de m√©todos heur√≠sticos para ayudarlo a elegir buenos hiperpar√°metros para la red.  Tambi√©n considerar√© varias otras t√©cnicas, un poco m√°s superficialmente.  En su mayor parte, estas discusiones son independientes entre s√≠, por lo que puede saltar sobre ellas si lo desea.  Tambi√©n implementamos muchas tecnolog√≠as en el c√≥digo de trabajo y las usamos para mejorar los resultados obtenidos para la tarea de clasificar n√∫meros escritos a mano, que se estudi√≥ en el Cap√≠tulo 1. <br><a name="habracut"></a><br>  Por supuesto, consideramos solo una fracci√≥n de la gran cantidad de t√©cnicas desarrolladas para su uso con redes neuronales.  La conclusi√≥n es que la mejor manera de ingresar al mundo de la abundancia de t√©cnicas disponibles es estudiar en detalle algunas de las m√°s importantes.  El dominio de estas t√©cnicas importantes no solo es √∫til en s√≠ mismo, sino que tambi√©n profundizar√° su comprensi√≥n de los problemas que pueden surgir al usar redes neuronales.  Como resultado, estar√° preparado para adaptar r√°pidamente nuevas t√©cnicas seg√∫n sea necesario. <br><br><h2>  Funci√≥n de costo de entrop√≠a cruzada </h2><br>  La mayor√≠a de nosotros odiamos estar equivocados.  Poco despu√©s de comenzar a aprender el piano, ofrec√≠ un peque√±o concierto frente a una audiencia.  Estaba nervioso y comenc√© a tocar una pieza una octava m√°s baja de lo necesario.  Estaba confundido y no pod√≠a continuar hasta que alguien me se√±alara un error.  Estaba muy avergonzado  Sin embargo, aunque esto es desagradable, tambi√©n aprendemos muy r√°pidamente, decidiendo que est√°bamos equivocados.  ¬°Y ciertamente la pr√≥xima vez que habl√© con la audiencia, toqu√© en la octava correcta!  Por el contrario, aprendemos m√°s lentamente cuando nuestros errores no est√°n bien definidos. <br><br>  Idealmente, esperamos que nuestras redes neuronales aprendan r√°pidamente de sus errores.  ¬øEsto sucede en la pr√°ctica?  Para responder a esta pregunta, veamos un ejemplo descabellado.  Implica una neurona con solo una entrada: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/711/536/586/711536586b63bd594c00d3ade2e88580.png"><br><br>  Estamos ense√±ando a esta neurona a hacer algo rid√≠culamente simple: aceptar 1 y dar 0. Por supuesto, podr√≠amos encontrar una soluci√≥n a un problema tan trivial seleccionando manualmente el peso y la compensaci√≥n, sin usar el algoritmo de entrenamiento.  Sin embargo, ser√° bastante √∫til intentar usar el descenso en gradiente para obtener peso y desplazamiento como resultado del entrenamiento.  Veamos c√≥mo se entrena una neurona. <br><br>  Para mayor claridad, elegir√© un peso inicial de 0.6 y un desplazamiento inicial de 0.9.  Estos son algunos valores generales asignados como punto de partida, y no los seleccion√© espec√≠ficamente.  Inicialmente, una neurona de salida produce 0,82, por lo que debemos aprender mucho para acercarnos a la salida deseada de 0,0.  El <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo original</a> tiene un formulario interactivo en el que puede hacer clic en "Ejecutar" y observar el proceso de aprendizaje.  Esta animaci√≥n no est√° pregrabada, el navegador realmente calcula el gradiente y luego lo usa para actualizar el peso y el desplazamiento, y muestra el resultado.  La velocidad de aprendizaje es Œ∑ = 0.15, lo suficientemente lenta como para poder ver lo que est√° sucediendo, pero lo suficientemente r√°pida como para que el aprendizaje tenga lugar en segundos.  La funci√≥n de costo C es cuadr√°tica, presentada en el primer cap√≠tulo.  Pronto te recordar√© su forma exacta, por lo que no es necesario volver y hurgar all√≠.  El entrenamiento se puede iniciar varias veces simplemente haciendo clic en el bot√≥n "Ejecutar". <br><br>  Como puede ver, la neurona aprende r√°pidamente el peso y el sesgo, lo que reduce el costo, y da una producci√≥n de 0.09.  Este no es el resultado deseado de 0.0, pero es bastante bueno.  Supongamos que elegimos un peso inicial y un desplazamiento de 2.0 en su lugar.  En este caso, la salida inicial ser√° 0.98, lo cual es completamente incorrecto.  Veamos c√≥mo en este caso la neurona aprender√° a producir 0. <br><br>  Aunque este ejemplo usa la misma tasa de aprendizaje (Œ∑ = 0.15), vemos que el aprendizaje es m√°s lento.  Alrededor de 150 de las primeras √©pocas, pesos y desplazamientos apenas cambian.  Luego, el entrenamiento se acelera y, casi como en el primer ejemplo, la neurona se mueve r√°pidamente a 0.0.  Este comportamiento es extra√±o, no como aprender una persona.  Como dije al principio, a menudo aprendemos m√°s r√°pido cuando estamos muy equivocados.  Pero acabamos de ver c√≥mo nuestra neurona artificial aprende con gran dificultad, cometiendo muchos errores, mucho m√°s dif√≠cil que cuando cometi√≥ un peque√±o error.  Adem√°s, resulta que tal comportamiento surge no solo en nuestro ejemplo simple, sino tambi√©n en un NS de prop√≥sito m√°s general.  ¬øPor qu√© el aprendizaje es tan lento?  ¬øPuedo encontrar una manera de evitar este problema? <br><br>  Para comprender la fuente del problema, recordamos que nuestra neurona aprende a trav√©s de cambios en el peso y el desplazamiento a una velocidad determinada por las derivadas parciales de la funci√≥n de costo, ‚àÇC / ‚àÇw y ‚àÇC / ‚àÇb.  Entonces decir "aprender es lento" es lo mismo que decir que estas derivadas parciales son peque√±as.  El problema es entender por qu√© son peque√±os.  Para hacer esto, calculemos las derivadas parciales.  Recuerde que usamos la funci√≥n de costo cuadr√°tico, que viene dada por la ecuaci√≥n (6): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;">) </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">2</font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18"><font style="vertical-align: inherit;"> 2</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"> t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24"><font style="vertical-align: inherit;">54</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-4">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-19">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.352ex" height="3.021ex" viewBox="0 -987.6 10915.4 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="1038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="2344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="3346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="3876" y="0"></use><g transform="translate(4309,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="1109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2109" y="0"></use><g transform="translate(2639,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-32" x="550" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-32" x="7792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="8542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="8904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="9433" y="0"></use><g transform="translate(9914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-34" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> C = \ frac {(y-a) ^ 2} {2} \ tag {54} </script></p><br><br>  donde a es la salida de la neurona cuando x = 1 se usa en la entrada, y y = 0 es la salida deseada.  Para escribir esto directamente a trav√©s del peso y el desplazamiento, recuerde que a = œÉ (z), donde z = wx + b.  Usando la regla de la cadena para la diferenciaci√≥n por peso y desplazamiento, obtenemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-25"><span class="MJXp-mtext" id="MJXp-Span-26">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">c</span><span class="MJXp-mrow" id="MJXp-Span-31"><span class="MJXp-mtext" id="MJXp-Span-32">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">C</span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mtext" id="MJXp-Span-42">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">w</span></span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">a</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">y</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">m</span><span class="MJXp-msup" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-64" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">z</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">x</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">a</span><span class="MJXp-mtext" id="MJXp-Span-71">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">m</span><span class="MJXp-msup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-78" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">z</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">g</span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mn" id="MJXp-Span-87">55</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.529ex" height="2.78ex" viewBox="0 -883.9 28644.2 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-43" x="3269" y="0"></use></g><g transform="translate(6245,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-77" x="3269" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="10508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="11565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="11954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="12706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="13707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="14204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="14844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="15313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="15659" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="16139" y="0"></use><g transform="translate(17018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="17842" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="18231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="18700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-78" x="19089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="19940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="20996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="21775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="22245" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="22590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="23071" y="0"></use><g transform="translate(23949,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="24774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="25163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="25632" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="26271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="26633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="27162" y="0"></use><g transform="translate(27643,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ frac {\ partial C} {\ partial w} = (a-y) \ sigma '(z) x = a \ sigma' (z) \ tag {55} </script></p><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-88"><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">c</span><span class="MJXp-mrow" id="MJXp-Span-94"><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">C</span></span><span class="MJXp-mrow" id="MJXp-Span-104"><span class="MJXp-mtext" id="MJXp-Span-105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">b</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">a</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">y</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-120">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">m</span><span class="MJXp-msup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-127" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">z</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">a</span><span class="MJXp-mtext" id="MJXp-Span-133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">m</span><span class="MJXp-msup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-140" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">z</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">g</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-mn" id="MJXp-Span-149">56</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.532ex" height="2.78ex" viewBox="0 -883.9 27784.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-43" x="3269" y="0"></use></g><g transform="translate(6245,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-62" x="3269" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="10221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="11278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="11667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="12419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="13420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="13917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="14557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="15026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="15372" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="15852" y="0"></use><g transform="translate(16731,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="17555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="17944" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="18413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="19080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="20136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="20916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="21385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="21731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="22211" y="0"></use><g transform="translate(23090,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="23914" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="24304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="24772" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="25412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="25773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="26303" y="0"></use><g transform="translate(26783,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-36" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> \ frac {\ partial C} {\ partial b} = (a-y) \ sigma '(z) = a \ sigma' (z) \ tag {56} </script></p><br><br>  donde sustitu√≠ x = 1 e y = 0.  Para comprender el comportamiento de estas expresiones, echemos un vistazo m√°s de cerca al t√©rmino œÉ '(z) a la derecha.  Recordemos la forma de un sigmoide: <br><br><img src="https://habrastorage.org/webt/qp/md/8t/qpmd8tvjtjws0nis2rfaxcv59x8.png"><br><br>  El gr√°fico muestra que cuando la salida de la neurona es cercana a 1, la curva se vuelve muy plana y œÉ '(z) se vuelve peque√±a.  Las ecuaciones (55) y (56) nos dicen que ‚àÇC / ‚àÇw y ‚àÇC / ‚àÇb se vuelven muy peque√±as.  De ah√≠ la desaceleraci√≥n en el aprendizaje.  Adem√°s, como veremos un poco m√°s tarde, la desaceleraci√≥n de la capacitaci√≥n ocurre, de hecho, por la misma raz√≥n y en la Asamblea Nacional de una forma m√°s general, y no solo en nuestro ejemplo m√°s simple. <br><br><h2>  Introducci√≥n de la funci√≥n de costo de entrop√≠a cruzada </h2><br>  ¬øQu√© hacemos con ralentizar el aprendizaje?  Resulta que podemos resolver el problema reemplazando la funci√≥n cuadr√°tica de valor con otra funci√≥n de valor, conocida como entrop√≠a cruzada.  Para entender la entrop√≠a cruzada, nos alejamos de nuestro modelo m√°s simple.  Supongamos que entrenamos una neurona con varios valores de entrada x <sub>1</sub> , x <sub>2</sub> , ... pesos correspondientes w <sub>1</sub> , w <sub>2</sub> , ... y desplazamiento b: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5e/9a8/ddf/a5e9a8ddf40b507400692516269bd632.png"><br><br>  La salida de la neurona, por supuesto, ser√° a = œÉ (z), donde z = ‚àë <sub>j</sub> w <sub>j</sub> x <sub>j</sub> + b es la suma ponderada de las entradas.  Definimos la funci√≥n de costo de entrop√≠a cruzada para una neurona dada como <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">C</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">c</span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mn" id="MJXp-Span-160">1</span></span><span class="MJXp-mrow" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">n</span></span><span class="MJXp-mtext" id="MJXp-Span-163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">u</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-168" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-169">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">t</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">y</span><span class="MJXp-mtext" id="MJXp-Span-176">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">a</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-182">1</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">y</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-186">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">n</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-190">1</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">a</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">t</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">g</span><span class="MJXp-mrow" id="MJXp-Span-205"><span class="MJXp-mn" id="MJXp-Span-206">57</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="62.748ex" height="2.66ex" viewBox="0 -832 27016.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="1038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="2094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="3123" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="3673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="4125" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="4654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="5088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6E" x="5588" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="6439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-75" x="6908" y="0"></use><g transform="translate(7481,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="9114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-65" x="9412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="9879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="10429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-5B" x="10791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="11069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="11817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6E" x="12115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="12716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2B" x="13468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="14468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="14858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="15581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="16581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="17079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="17718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6E" x="18017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="18617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="19007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="19729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="20730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="21260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="21899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="22351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="22696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-68" x="23177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="23753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-5D" x="24115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="24643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="25005" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="25534" y="0"></use><g transform="translate(26015,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-37" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> C = - \ frac {1} {n} \ sum_x \ left [y \ ln a + (1-y) \ ln (1-a) \ right] \ tag {57} </script></p><br><br>  donde n es el n√∫mero total de unidades de datos de entrenamiento, la suma va sobre todos los datos de entrenamiento x, e y es la salida deseada correspondiente. <br><br>  No es obvio que la ecuaci√≥n (57) resuelva el problema de ralentizar el aprendizaje.  Honestamente, ¬°ni siquiera es obvio que tenga sentido llamarlo una funci√≥n de valor!  Antes de pasar a la desaceleraci√≥n en el aprendizaje, veamos en qu√© sentido la entrop√≠a cruzada puede interpretarse como una funci√≥n de valor. <br><br>  Dos propiedades en particular hacen que sea razonable interpretar la entrop√≠a cruzada como una funci√≥n de valor.  En primer lugar, es mayor que cero, es decir, C&gt; 0.  Para ver esto, tenga en cuenta que (a) todos los miembros individuales de la suma en (57) son negativos, ya que ambos logaritmos se toman de n√∫meros en el rango de 0 a 1, y (b) el signo menos est√° delante de la suma. <br><br>  En segundo lugar, si la salida real de la neurona est√° cerca de la salida deseada para todas las entradas de entrenamiento x, entonces la entrop√≠a cruzada estar√° cerca de cero.  Para probar esto, tendremos que suponer que las salidas deseadas y ser√°n 0 o 1. Por lo general, esto sucede al resolver problemas de clasificaci√≥n o al calcular funciones booleanas.  Para comprender qu√© sucede si no hace tal suposici√≥n, consulte los ejercicios al final de la secci√≥n. <br><br>  Para probar esto, imagine que y = 0 y a‚âà0 para alguna entrada x.  As√≠ ser√° cuando la neurona maneje bien esa entrada.  Vemos que el primer t√©rmino de expresi√≥n (57) para el valor desaparece, ya que y = 0, y el segundo ser√° ‚àíln (1 - a) ‚âà0.  Lo mismo es cierto cuando y = 1 y a‚âà1.  Por lo tanto, la contribuci√≥n del valor ser√° peque√±a si la salida real es cercana a la deseada. <br><br>  En resumen, obtenemos que la entrop√≠a cruzada es positiva y tiende a cero cuando la neurona calcula mejor la salida deseada y para todas las entradas de entrenamiento x.  Esperamos la presencia de ambas propiedades en la funci√≥n de costo.  Y, de hecho, ambas propiedades se cumplen mediante el valor cuadr√°tico.  Por lo tanto, para la entrop√≠a cruzada es una buena noticia.  Sin embargo, la funci√≥n de costo de entrop√≠a cruzada tiene una ventaja porque, a diferencia del valor cuadr√°tico, evita el problema de ralentizar el aprendizaje.  Para ver esto, calculemos la derivada parcial del valor con entrop√≠a cruzada en peso.  Sustituya a = œÉ (z) en (57), aplique la regla de la cadena dos veces y obtenga <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-207"><span class="MJXp-mtext" id="MJXp-Span-208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">c</span><span class="MJXp-mrow" id="MJXp-Span-213"><span class="MJXp-mtext" id="MJXp-Span-214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">C</span></span><span class="MJXp-mrow" id="MJXp-Span-223"><span class="MJXp-mtext" id="MJXp-Span-224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">l</span><span class="MJXp-msubsup" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-234" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-237">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">c</span><span class="MJXp-mrow" id="MJXp-Span-242"><span class="MJXp-mn" id="MJXp-Span-243">1</span></span><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">n</span></span><span class="MJXp-mtext" id="MJXp-Span-246">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">u</span><span class="MJXp-msubsup" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-251" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-252">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">t</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">c</span><span class="MJXp-mrow" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">y</span></span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mtext" id="MJXp-Span-266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">a</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">z</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-276">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">c</span><span class="MJXp-mrow" id="MJXp-Span-281"><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-283">1</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">y</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mn" id="MJXp-Span-288">1</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-290">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">a</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">z</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-299">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">t</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">c</span><span class="MJXp-mrow" id="MJXp-Span-311"><span class="MJXp-mtext" id="MJXp-Span-312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">l</span><span class="MJXp-mtext" id="MJXp-Span-320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">a</span></span><span class="MJXp-mrow" id="MJXp-Span-326"><span class="MJXp-mtext" id="MJXp-Span-327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">l</span><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-338">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">g</span><span class="MJXp-mrow" id="MJXp-Span-342"><span class="MJXp-mn" id="MJXp-Span-343">58</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="136.132ex" height="2.78ex" viewBox="0 -832 58612.1 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-43" x="3269" y="0"></use></g><g transform="translate(6245,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><g transform="translate(3269,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6A" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="10900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="11956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="12985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="13535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="13987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="14516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="14950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6E" x="15450" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="16301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-75" x="16770" y="0"></use><g transform="translate(17343,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="18976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-65" x="19275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="19741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="20292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="20653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="21293" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="21843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="22295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="22824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="23258" y="0"></use><g transform="translate(23755,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="3811" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="28178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="29429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="29980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="30431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="30961" y="0"></use><g transform="translate(31394,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="2610" y="0"></use></g><g transform="translate(34394,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="2788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="3268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="4147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="4676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="5066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="5534" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="40568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="41020" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="41365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-68" x="41846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="42422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="42784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="43423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="43974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="44425" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="44955" y="0"></use><g transform="translate(45388,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="3519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="3989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="4334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="4815" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="5693" y="0"></use></g><g transform="translate(51611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="2971" y="0"></use><g transform="translate(3269,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6A" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="56239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="56601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="57130" y="0"></use><g transform="translate(57611,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-38" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ frac {\ partial C} {\ partial w_j} = - \ frac {1} {n} \ sum_x \ left (\ frac {y} {\ sigma (z)} - \ frac {(1-y)} {1- \ sigma (z)} \ right) \ frac {\ partial \ sigma} {\ partial w_j} \ tag {58} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-344"><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-347">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">c</span><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mn" id="MJXp-Span-353">1</span></span><span class="MJXp-mrow" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">n</span></span><span class="MJXp-mtext" id="MJXp-Span-356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">u</span><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-361" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">t</span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-368">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">c</span><span class="MJXp-mrow" id="MJXp-Span-373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">y</span></span><span class="MJXp-mrow" id="MJXp-Span-375"><span class="MJXp-mtext" id="MJXp-Span-376">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">a</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">z</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-386">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">c</span><span class="MJXp-mrow" id="MJXp-Span-391"><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-393">1</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">y</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-397"><span class="MJXp-mn" id="MJXp-Span-398">1</span><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">a</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">z</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-409">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">t</span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-416">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">m</span><span class="MJXp-msup" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-423" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">z</span><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-429" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">g</span><span class="MJXp-mrow" id="MJXp-Span-434"><span class="MJXp-mn" id="MJXp-Span-435">59</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.73ex" height="2.901ex" viewBox="0 -883.9 40355.9 1249" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="1056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="2084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="2635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="3086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="3616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="4049" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6E" x="4550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="5400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-75" x="5870" y="0"></use><g transform="translate(6442,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6C" x="8076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-65" x="8374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="8841" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="9753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="10392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="10943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="11394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="11924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="12357" y="0"></use><g transform="translate(12855,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="3811" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="17278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-66" x="18529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="19079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="19531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-63" x="20060" y="0"></use><g transform="translate(20494,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-79" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="2610" y="0"></use></g><g transform="translate(23493,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2212" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="2442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="2788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="3268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="4147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="4676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="5066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="5534" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-72" x="29668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="30119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="30465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-68" x="30945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="31522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="31883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-73" x="32523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-69" x="32992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="33338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6D" x="33818" y="0"></use><g transform="translate(34697,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-28" x="35521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-7A" x="35911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-29" x="36379" y="0"></use><g transform="translate(36769,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-74" x="37983" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-61" x="38344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMATHI-67" x="38874" y="0"></use><g transform="translate(39354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhgpONCLKPnxNPv95bnS7bc6lvGfmA#MJMAIN-39" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> = - \ frac {1} {n} \ sum_x \ left (\ frac {y} {\ sigma (z)} - \ frac {(1-y)} {1- \ sigma (z)} \ right) \ sigma '(z) x_j \ tag {59} </script></p><br><br>  Reduciendo a un denominador com√∫n y simplificando, obtenemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-436"><span class="MJXp-mtext" id="MJXp-Span-437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">c</span><span class="MJXp-mrow" id="MJXp-Span-442"><span class="MJXp-mtext" id="MJXp-Span-443">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">C</span></span><span class="MJXp-mrow" id="MJXp-Span-452"><span class="MJXp-mtext" id="MJXp-Span-453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">l</span><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-463" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-465">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">c</span><span class="MJXp-mrow" id="MJXp-Span-470"><span class="MJXp-mn" id="MJXp-Span-471">1</span></span><span class="MJXp-mrow" id="MJXp-Span-472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">n</span></span><span class="MJXp-mtext" id="MJXp-Span-474">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">u</span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-479" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-480">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">c</span><span class="MJXp-mrow" id="MJXp-Span-485"><span class="MJXp-mtext" id="MJXp-Span-486">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">m</span><span class="MJXp-msup" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-493" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">z</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-499" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-500"><span class="MJXp-mtext" id="MJXp-Span-501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">a</span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">z</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-511">1</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-513">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">a</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">z</span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-524">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">a</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">z</span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">y</span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">g</span><span class="MJXp-mrow" id="MJXp-Span-541"><span class="MJXp-mn" id="MJXp-Span-542">60</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> \ frac {\ partial C} {\ partial w_j} = \ frac {1} {n} \ sum_x \ frac {\ sigma '(z) x_j} {\ sigma (z) (1- \ sigma (z)) } (\ sigma (z) -y). \ tag {60} </script></p><br><br>  Usando la definici√≥n de sigmoide, œÉ (z) = 1 / (1 + e <sup>‚àíz</sup> ) y un poco de √°lgebra, podemos mostrar que œÉ ‚Ä≤ (z) = œÉ (z) (1 - œÉ (z)).  Le pedir√© que verifique esto m√°s adelante en el ejercicio, pero por ahora, ac√©ptelo como la verdad.  Los t√©rminos œÉ (z) y œÉ (z) (1 - œÉ (z)) se cancelan, y esto lleva a <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-543"><span class="MJXp-mtext" id="MJXp-Span-544">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">c</span><span class="MJXp-mrow" id="MJXp-Span-549"><span class="MJXp-mtext" id="MJXp-Span-550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">C</span></span><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-mtext" id="MJXp-Span-560">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">l</span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-572">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">c</span><span class="MJXp-mrow" id="MJXp-Span-577"><span class="MJXp-mn" id="MJXp-Span-578">1</span></span><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">n</span></span><span class="MJXp-mtext" id="MJXp-Span-581">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">u</span><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-589" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">a</span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">z</span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">y</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">g</span><span class="MJXp-mrow" id="MJXp-Span-608"><span class="MJXp-mn" id="MJXp-Span-609">61</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> \ frac {\ partial C} {\ partial w_j} = \ frac {1} {n} \ sum_x x_j (\ sigma (z) -y). \ tag {61} </script></p><br><br>  Gran expresion.  De esto se deduce que la velocidad con la que se entrenan las pesas est√° controlada por œÉ (z) ‚àíy, es decir, por un error en la salida.  Cuanto mayor es el error, m√°s r√°pido aprende la neurona.  Esto podr√≠a esperarse intuitivamente.  Esta opci√≥n evita la desaceleraci√≥n en el aprendizaje causada por el t√©rmino œÉ '(z) en una ecuaci√≥n de costo cuadr√°tico similar (55).  Cuando usamos entrop√≠a cruzada, el t√©rmino œÉ '(z) se reduce y ya no tenemos que preocuparnos por su peque√±ez.  Esta reducci√≥n es un milagro especial garantizado por la funci√≥n de costo de entrop√≠a cruzada.  De hecho, por supuesto, esto no es un verdadero milagro.  Como veremos m√°s adelante, la entrop√≠a cruzada se eligi√≥ espec√≠ficamente para esta propiedad. <br><br>  Del mismo modo, se puede calcular la derivada parcial para el sesgo.  No volver√© a dar todos los detalles, pero puedes comprobarlo f√°cilmente <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-610"><span class="MJXp-mtext" id="MJXp-Span-611">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">c</span><span class="MJXp-mrow" id="MJXp-Span-616"><span class="MJXp-mtext" id="MJXp-Span-617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">C</span></span><span class="MJXp-mrow" id="MJXp-Span-626"><span class="MJXp-mtext" id="MJXp-Span-627">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">b</span></span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">c</span><span class="MJXp-mrow" id="MJXp-Span-642"><span class="MJXp-mn" id="MJXp-Span-643">1</span></span><span class="MJXp-mrow" id="MJXp-Span-644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">n</span></span><span class="MJXp-mtext" id="MJXp-Span-646">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">u</span><span class="MJXp-msubsup" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-651" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-653">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">a</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">z</span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">y</span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-666">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">g</span><span class="MJXp-mrow" id="MJXp-Span-670"><span class="MJXp-mn" id="MJXp-Span-671">62</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ frac {\ partial C} {\ partial b} = \ frac {1} {n} \ sum_x (\ sigma (z) -y). \ tag {62} </script></p><br><br>  Esto nuevamente ayuda a evitar el retraso del aprendizaje debido al t√©rmino œÉ '(z) en una ecuaci√≥n similar para el valor cuadr√°tico (56). <br><br><h3>  Ejercicio </h3><br><ul><li>  Verifique que œÉ ‚Ä≤ (z) = œÉ (z) (1 - œÉ (z)). </li></ul><br><br>  Volvamos a nuestro ejemplo descabellado con el que jugamos anteriormente y veamos qu√© sucede si usamos entrop√≠a cruzada en lugar del valor cuadr√°tico.  Para sintonizar, comenzamos con el caso en el que el costo cuadr√°tico funcion√≥ perfectamente cuando el peso inicial era 0.6 y el desplazamiento era 0.9.  El art√≠culo original tiene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una forma interactiva</a> en la que puede hacer clic en el bot√≥n Ejecutar y ver qu√© sucede cuando reemplaza el valor cuadr√°tico con entrop√≠a cruzada. <br><br>  No es sorprendente que la neurona en este caso est√© perfectamente entrenada, como antes.  Ahora <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">echemos un vistazo</a> al caso en el que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">neurona se quedaba atascada</a> , con un peso y desplazamiento a partir de 2.0. <br><br><img src="https://habrastorage.org/webt/mg/xt/bb/mgxtbb83sfsoikt345v4hukgpmi.png"><br><br>  √âxito!  Esta vez la neurona aprendi√≥ r√°pidamente, como quer√≠amos.  Si observa detenidamente, puede ver que la pendiente de la curva de costos es inicialmente m√°s pronunciada en comparaci√≥n con la regi√≥n plana de la curva de valor cuadr√°tico correspondiente.  Esta entrop√≠a a campo traviesa nos da esta frialdad, y no nos deja atascarnos donde esperamos el entrenamiento m√°s r√°pido de una neurona cuando comienza con grandes errores. <br><br>  No dije qu√© velocidad de entrenamiento se utiliz√≥ en los √∫ltimos ejemplos.  Anteriormente, con un valor cuadr√°tico, utilizamos Œ∑ = 0.15.  ¬øDeber√≠amos usar la misma velocidad en los nuevos ejemplos?  De hecho, al cambiar la funci√≥n de costo, es imposible decir exactamente qu√© significa usar la "misma" velocidad de aprendizaje;  Ser√° una comparaci√≥n de manzanas con naranjas.  Para ambas funciones de costo, experiment√© buscando una velocidad de aprendizaje que me permitiera ver lo que est√° sucediendo.  Si todav√≠a est√° interesado, en los √∫ltimos ejemplos, Œ∑ = 0.005. <br><br>  Puede argumentar que cambiar la velocidad de aprendizaje hace que los gr√°ficos no tengan sentido.  ¬øA qui√©n le importa qu√© tan r√°pido aprende una neurona si podemos elegir arbitrariamente una velocidad de aprendizaje?  Pero esta objeci√≥n no tiene en cuenta el punto principal.  El significado de los gr√°ficos no est√° en la velocidad absoluta de aprendizaje, sino en c√≥mo cambia esta velocidad.  Cuando se utiliza la funci√≥n cuadr√°tica, el entrenamiento es m√°s lento si la neurona est√° muy equivocada, y luego se acelera cuando la neurona se acerca a la respuesta deseada.  Con la entrop√≠a cruzada, el aprendizaje es m√°s r√°pido cuando una neurona comete un gran error.  Y estas declaraciones no dependen de una velocidad de aprendizaje dada. <br><br>  Examinamos la entrop√≠a cruzada para una neurona.  Sin embargo, esto es f√°cil de generalizar a redes con muchas capas y muchas neuronas.  Suponga que y = y <sub>1</sub> , y <sub>2</sub> , ... son los valores deseados de las neuronas de salida, es decir, las neuronas en la √∫ltima capa, y un <sup>L</sup> <sub>1</sub> , un <sup>L</sup> <sub>2</sub> , ... son los valores de salida en s√≠ mismos.  Entonces, la entrop√≠a cruzada se puede definir como: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">C</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-676">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">c</span><span class="MJXp-mrow" id="MJXp-Span-681"><span class="MJXp-mn" id="MJXp-Span-682">1</span></span><span class="MJXp-mrow" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">n</span></span><span class="MJXp-mtext" id="MJXp-Span-685">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">u</span><span class="MJXp-msubsup" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-690" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-691">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">u</span><span class="MJXp-msubsup" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-696" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-697">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">t</span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-705" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">n</span><span class="MJXp-msubsup" id="MJXp-Span-709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-715">1</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-719" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-721">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">n</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-725">1</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">t</span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-739">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">g</span><span class="MJXp-mrow" id="MJXp-Span-743"><span class="MJXp-mn" id="MJXp-Span-744">63</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> C = - \ frac {1} {n} \ sum_x \ sum_j \ left [y_j \ ln a ^ L_j + (1-y_j) \ ln (1-a ^ L_j) \ right] \ tag {63} </script></p><br><br>  Esto es lo mismo que la ecuaci√≥n (57), solo que ahora nuestro ‚àë <sub>j</sub> suma todas las neuronas de salida.  No analizar√© la derivada en detalle, pero es razonable suponer que usando la expresi√≥n (63) podemos evitar la desaceleraci√≥n en redes con muchas neuronas.  Si est√° interesado, puede tomar la derivada en el siguiente problema. <br><br>  Por cierto, el t√©rmino "entrop√≠a cruzada" que uso confundi√≥ a algunos de los primeros lectores del libro porque contradice otras fuentes.  En particular, a menudo la entrop√≠a cruzada se determina para dos distribuciones de probabilidad, pj <br>  y qj, como ‚àë <sub>j</sub> p <sub>j</sub> lnq <sub>j</sub> .  Esta definici√≥n puede asociarse con (57), si se considera que una neurona sigmoidea emite una distribuci√≥n de probabilidad que consiste en la activaci√≥n de la neurona ay su valor complementario 1-a. <br><br>  Sin embargo, si tenemos muchas neuronas sigmoides en la √∫ltima capa, el vector a <sup>L</sup> <sub>j</sub> generalmente no proporciona una distribuci√≥n de probabilidad.  Como resultado, la definici√≥n del tipo ‚àë <sub>j</sub> p <sub>j</sub> lnq <sub>j no tiene</sub> sentido, ya que no trabajamos con distribuciones de probabilidad.  En cambio (63), uno puede imaginar c√≥mo se resume un conjunto sumado de entrop√≠as cruzadas de cada neurona, donde la activaci√≥n de cada neurona se interpreta como parte de una distribuci√≥n de probabilidad de dos elementos (por supuesto, no hay elementos probabil√≠sticos en nuestras redes, por lo que en realidad no son probabilidades).  En este sentido, (63) ser√° una generalizaci√≥n de la entrop√≠a cruzada para distribuciones de probabilidad. <br><br>  ¬øCu√°ndo usar la entrop√≠a cruzada en lugar del valor cuadr√°tico?  De hecho, la entrop√≠a cruzada casi siempre se usar√° mejor si tiene neuronas de salida sigmoideas.  Para comprender esto, recuerde que al configurar una red, generalmente inicializamos pesos y compensaciones utilizando alg√∫n proceso aleatorio.  Puede suceder que esta elecci√≥n conduzca al hecho de que la red interpretar√° err√≥neamente algunos datos de entrada de entrenamiento; por ejemplo, la neurona de salida tender√° a 1, cuando deber√≠a ir a 0, o viceversa.  Si usamos un valor cuadr√°tico que ralentiza el entrenamiento, no se detendr√° en absoluto, ya que los pesos continuar√°n siendo entrenados en otros ejemplos de entrenamiento, pero esta situaci√≥n es obviamente indeseable. <br><br><h3>  Ejercicios </h3><br><ul><li>  Una trampa de la entrop√≠a cruzada es que al principio puede ser dif√≠cil recordar los roles correspondientes de y y a.  Es f√°cil confundirse, ya que ser√° correcto, - [ylna + (1 - y) ln (1 - a)] o - [alny + (1 - a) ln (1 - y)].  ¬øQu√© pasar√° con la segunda expresi√≥n cuando y = 0 o 1?  ¬øEste problema afecta a la primera expresi√≥n?  Por qu√© </li><li>  En la discusi√≥n de una sola neurona al comienzo de la secci√≥n, dije que la entrop√≠a cruzada es peque√±a si œÉ (z) ‚âày para todos los datos de entrada de entrenamiento.    ,  y  0  1.       ,     (, ) y      0  1. ,      ,  œÉ(z)=y    .   ,     <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-745"><span class="MJXp-mtable" id="MJXp-Span-746"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-747" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-748" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">C</span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-752" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-753">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-755"><span class=""><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-left: 0px;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">y</span><span class="MJXp-mi" id="MJXp-Span-760">ln</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">y</span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-765">1</span><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">y</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-769">ln</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-772">1</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">y</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> C = -\frac{1}{n} \sum_x [y \ln y+(1-y) \ln(1-y)] \tag{64} </script></p>  .  ‚àí[ylny+(1‚àíy)ln(1‚àíy)]    . </li></ul><br><br><h3>  </h3><br><ul><li>     .      ,             <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-777"><span class="MJXp-mtable" id="MJXp-Span-778"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-779" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-780" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-781" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-782">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-784">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-792" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-793">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-795"><span class=""><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">L</span><span class="MJXp-mo" id="MJXp-Span-803">‚àí</span><span class="MJXp-mn" id="MJXp-Span-804">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-813" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-817" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \sigma'(z^L_j) \tag{65} </script></p>  œÉ'(z <sup>L</sup> <sub>j</sub> )   ,      . ,          Œ¥ <sup>L</sup>     x   <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-824"><span class="MJXp-mtable" id="MJXp-Span-825"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-826" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-827" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829" style="margin-right: 0.05em;">Œ¥</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-830" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-834" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">y</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> \delta^L = a^L-y \tag{66} </script></p>   ,  ,           <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-837"><span class="MJXp-mtable" id="MJXp-Span-838"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-839" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-840" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-841" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-842">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-844">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-852" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-853">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-855"><span class=""><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">L</span><span class="MJXp-mo" id="MJXp-Span-863">‚àí</span><span class="MJXp-mn" id="MJXp-Span-864">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-873" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \tag{67} </script></p>  œÉ'(z <sup>L</sup> <sub>j</sub> ) ,       ,       ,          .         .     ,       . </li><li>         . ,       . ,      ,       ,     ,  a <sup>L</sup> <sub>j</sub> = z <sup>L</sup> <sub>j</sub> . ,         Œ¥L     x  <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-875"><span class="MJXp-mtable" id="MJXp-Span-876"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-877" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-878" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880" style="margin-right: 0.05em;">Œ¥</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-881" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-885" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">y</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \delta^L = a^L-y \tag{68} </script></p>     ,   ,  ,           ,  <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-888"><span class="MJXp-mtable" id="MJXp-Span-889"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-890" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-891" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-892" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-893">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-895">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-903" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-904">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-906"><span class=""><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">L</span><span class="MJXp-mo" id="MJXp-Span-914">‚àí</span><span class="MJXp-mn" id="MJXp-Span-915">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-924" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \tag{69} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-926"><span class="MJXp-mtable" id="MJXp-Span-927"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-928" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-929" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-930" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-931">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-933">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">j</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-940" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-941">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-943"><span class=""><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945" style="margin-left: 0px;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-954" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> \frac{\partial C}{\partial b^L_{j}} = \frac{1}{n} \sum_x (a^L_j-y_j) \tag{70} </script></p>  ,     ,          .         . </li></ul><br><br><h2>        MNIST </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La entrop√≠a cruzada es f√°cil de implementar como parte de un programa que ense√±a a la red utilizando el gradiente descendente y la propagaci√≥n inversa. Haremos esto m√°s adelante desarrollando una versi√≥n mejorada de nuestro programa de clasificaci√≥n num√©rica manuscrita inicial de MNIST, network.py. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El nuevo programa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se llama network2.py e incluye no solo la entrop√≠a cruzada, sino tambi√©n varias otras t√©cnicas desarrolladas en este cap√≠tulo. Mientras tanto, veamos qu√© tan bien nuestro nuevo programa clasifica los d√≠gitos MNIST. Como en el Cap√≠tulo 1, utilizaremos una red con 30 neuronas ocultas y un mini paquete de tama√±o 10. Estableceremos la velocidad de aprendizaje Œ∑ = 0.5 y aprenderemos 30 eras.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como ya dije, es imposible decir exactamente qu√© velocidad de entrenamiento es adecuada en ese caso, as√≠ que experiment√© con la selecci√≥n. Es cierto que hay una manera de relacionar de manera muy heur√≠stica la tasa de aprendizaje con la entrop√≠a cruzada y el valor cuadr√°tico. Vimos anteriormente que en los t√©rminos del gradiente para el valor cuadr√°tico hay un t√©rmino adicional œÉ '= œÉ (1-œÉ). Supongamos que promediamos estos valores para œÉ, ‚à´ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dœÉ œÉ (1 - œÉ) = 1/6. Se puede ver que el costo cuadr√°tico (m√°s o menos) en promedio aprende 6 veces m√°s lento para la misma tasa de aprendizaje. Esto sugiere que un buen punto de partida ser√≠a dividir la velocidad de aprendizaje para una funci√≥n cuadr√°tica por 6. Por supuesto, este no es un argumento estricto, y no debe tomarlo demasiado en serio. Pero a veces puede ser √∫til como punto de partida.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interfaz para network2.py es ligeramente diferente de network.py, pero a√∫n debe quedar claro lo que est√° sucediendo. </font><font style="vertical-align: inherit;">La documentaci√≥n en network2.py se puede obtener utilizando el comando de ayuda (network2.Network.SGD) en el shell de Python.</font></font><br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, evaluation_data=test_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br>  Tenga en cuenta, por cierto, que el comando net.large_weight_initializer () se usa para inicializar pesos y compensaciones de la misma manera que se describe en el cap√≠tulo 1. Necesitamos ejecutarlo porque cambiaremos la inicializaci√≥n de pesos por defecto m√°s adelante.  Como resultado, despu√©s de iniciar todos los comandos anteriores, obtenemos una red que funciona con una precisi√≥n del 95,49%.  Esto est√° muy cerca del resultado del primer cap√≠tulo, 95.42%, usando el valor cuadr√°tico. <br><br>  Veamos tambi√©n el caso en el que usamos 100 neuronas ocultas y entrop√≠a cruzada, y dejamos el resto igual.  En este caso, la precisi√≥n es del 96.82%.  Esta es una mejora importante sobre los resultados del primer cap√≠tulo, donde logramos una precisi√≥n del 96.59% utilizando el valor cuadr√°tico.  El cambio puede parecer peque√±o, pero piense que el error cay√≥ del 3.41% al 3.18%.  Es decir, hemos eliminado aproximadamente 1/14 de errores.  Esto es bastante bueno <br><br>  Es bastante bueno que la funci√≥n de costo de entrop√≠a cruzada nos d√© resultados similares o mejores en comparaci√≥n con el valor cuadr√°tico.  Sin embargo, no prueban inequ√≠vocamente que la entrop√≠a cruzada es la mejor opci√≥n.  El hecho es que no intent√© elegir hiperpar√°metros en absoluto: la velocidad del entrenamiento, el tama√±o del mini-paquete, etc.  Para que la mejora sea m√°s convincente, debemos abordar adecuadamente su optimizaci√≥n.  Pero los resultados siguen siendo inspiradores, y nuestros c√°lculos te√≥ricos confirman que la entrop√≠a cruzada es una mejor opci√≥n que la funci√≥n de costo cuadr√°tico. <br><br>  En este sentido, todo este cap√≠tulo y, en principio, el resto del libro pasar√°.  Desarrollaremos nueva tecnolog√≠a, la probaremos y obtendremos "mejores resultados".  Por supuesto, es bueno que veamos estas mejoras.  Pero interpretarlos siempre es dif√≠cil.  Solo ser√° convincente si vemos mejoras despu√©s de un trabajo serio en la optimizaci√≥n de todos los dem√°s hiperpar√°metros.  Y este es un trabajo bastante complicado, que requiere grandes recursos computacionales, y generalmente no trataremos con una investigaci√≥n tan exhaustiva.  En cambio, iremos m√°s lejos en base a pruebas informales, como las enumeradas anteriormente.  Pero debe tener en cuenta que tales pruebas no son evidencia inequ√≠voca, y vigilar cuidadosamente esos casos cuando los argumentos comienzan a fallar. <br><br>  Hasta ahora, hemos estado discutiendo la entrop√≠a cruzada en detalle.  ¬øPor qu√© desperdiciar tanto esfuerzo si da una mejora tan peque√±a en nuestros resultados de MNIST?  M√°s adelante en este cap√≠tulo veremos otras t√©cnicas, en particular la regularizaci√≥n, que ofrecen mejoras mucho m√°s fuertes.  Entonces, ¬øpor qu√© nos centramos en la entrop√≠a cruzada?  En particular, debido a que la entrop√≠a cruzada es una funci√≥n de valor utilizada con frecuencia, por lo que vale la pena entenderlo bien.  Pero la raz√≥n m√°s importante es que la saturaci√≥n de las neuronas es un problema importante en el campo de las redes neuronales, al que volveremos constantemente a lo largo del libro.  Por lo tanto, discut√≠ la entrop√≠a cruzada con tanto detalle, ya que es un buen laboratorio para comenzar a comprender la saturaci√≥n de las neuronas y c√≥mo abordar los enfoques para este problema. <br><br><h2>  ¬øQu√© significa entrop√≠a cruzada?  De donde viene </h2><br>  Nuestra discusi√≥n sobre la entrop√≠a cruzada giraba en torno al an√°lisis algebraico y la implementaci√≥n pr√°ctica.  Esto es √∫til, pero como resultado, las preguntas conceptuales m√°s amplias permanecen sin respuesta, por ejemplo: ¬øqu√© significa entrop√≠a cruzada?  ¬øHay una forma intuitiva de presentarlo?  ¬øC√≥mo podr√≠an las personas llegar a la entrop√≠a cruzada? <br><br>  Comencemos con el √∫ltimo: ¬øqu√© podr√≠a hacernos pensar en la entrop√≠a cruzada?  Supongamos que descubrimos una desaceleraci√≥n del aprendizaje descrita anteriormente y nos dimos cuenta de que fue causada por los t√©rminos œÉ '(z) en las ecuaciones (55) y (56).  Si echamos un vistazo a estas ecuaciones, podr√≠amos pensar si es posible elegir dicha funci√≥n de costo para que el t√©rmino œÉ '(z) desaparezca.  Entonces el costo C = C <sub>x de</sub> un ejemplo de entrenamiento satisfar√≠a las ecuaciones: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-956"><span class="MJXp-mtext" id="MJXp-Span-957">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964"><font style="vertical-align: inherit;">p </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971"><font style="vertical-align: inherit;">C </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974"><font style="vertical-align: inherit;">p </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977"><font style="vertical-align: inherit;">t </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">w </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-983" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"> = </font></span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-987" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991"><font style="vertical-align: inherit;">y </font></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-997"><span class="MJXp-mn" id="MJXp-Span-998"><font style="vertical-align: inherit;">71</font></span></span></font><span class="MJXp-mrow" id="MJXp-Span-962"><span class="MJXp-mtext" id="MJXp-Span-963">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mtext" id="MJXp-Span-973">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-983" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-987" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-993">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-997"><span class="MJXp-mn" id="MJXp-Span-998"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> \ frac {\ partial C} {\ partial w_j} = x_j (a-y) \ tag {71} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-999"><span class="MJXp-mtext" id="MJXp-Span-1000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">c</span><span class="MJXp-mrow" id="MJXp-Span-1005"><span class="MJXp-mtext" id="MJXp-Span-1006">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mtext" id="MJXp-Span-1016">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">b</span></span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">a</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">y</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1031">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">g</span><span class="MJXp-mrow" id="MJXp-Span-1035"><span class="MJXp-mn" id="MJXp-Span-1036">72</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-19"> \ frac {\ partial C} {\ partial b} = (a-y) \ tag {72} </script></p><br><br>  Si elegimos una funci√≥n de valor que los haga verdaderos, preferir√≠an simplemente describir una comprensi√≥n intuitiva de que cuanto mayor es el error inicial, m√°s r√°pido aprende la neurona.  Tambi√©n solucionar√≠an el problema de desaceleraci√≥n.  De hecho, comenzando con estas ecuaciones, mostrar√≠amos que es posible derivar la forma de entrop√≠a cruzada simplemente siguiendo un instinto matem√°tico.  Para ver esto, notamos que, seg√∫n la regla de la cadena, obtenemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1037"><span class="MJXp-mtext" id="MJXp-Span-1038">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">c</span><span class="MJXp-mrow" id="MJXp-Span-1043"><span class="MJXp-mtext" id="MJXp-Span-1044">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1053"><span class="MJXp-mtext" id="MJXp-Span-1054">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">b</span></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1064">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">c</span><span class="MJXp-mrow" id="MJXp-Span-1069"><span class="MJXp-mtext" id="MJXp-Span-1070">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1079"><span class="MJXp-mtext" id="MJXp-Span-1080">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">a</span></span><span class="MJXp-mtext" id="MJXp-Span-1089">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">m</span><span class="MJXp-msup" id="MJXp-Span-1094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1096" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">z</span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1100">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">g</span><span class="MJXp-mrow" id="MJXp-Span-1104"><span class="MJXp-mn" id="MJXp-Span-1105">73</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-20"> \ frac {\ partial C} {\ partial b} = \ frac {\ partial C} {\ partial a} \ sigma '(z) \ tag {73} </script></p><br><br>  Usando en la √∫ltima ecuaci√≥n œÉ ‚Ä≤ (z) = œÉ (z) (1 - œÉ (z)) = a (1 - a), obtenemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1106"><span class="MJXp-mtext" id="MJXp-Span-1107">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">c</span><span class="MJXp-mrow" id="MJXp-Span-1112"><span class="MJXp-mtext" id="MJXp-Span-1113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1122"><span class="MJXp-mtext" id="MJXp-Span-1123">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">b</span></span><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">c</span><span class="MJXp-mrow" id="MJXp-Span-1138"><span class="MJXp-mtext" id="MJXp-Span-1139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1148"><span class="MJXp-mtext" id="MJXp-Span-1149">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">a</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">a</span><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1160">1</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">a</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">g</span><span class="MJXp-mrow" id="MJXp-Span-1168"><span class="MJXp-mn" id="MJXp-Span-1169">74</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-21"> \ frac {\ partial C} {\ partial b} = \ frac {\ partial C} {\ partial a} a (1-a) \ tag {74} </script></p><br><br>  Comparando con la ecuaci√≥n (72), obtenemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1170"><span class="MJXp-mtext" id="MJXp-Span-1171">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">c</span><span class="MJXp-mrow" id="MJXp-Span-1176"><span class="MJXp-mtext" id="MJXp-Span-1177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1186"><span class="MJXp-mtext" id="MJXp-Span-1187">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">a</span></span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">c</span><span class="MJXp-mrow" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">a</span><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">a</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1209">1</span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">a</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-1213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">g</span><span class="MJXp-mrow" id="MJXp-Span-1217"><span class="MJXp-mn" id="MJXp-Span-1218">75</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> \ frac {\ partial C} {\ partial a} = \ frac {a-y} {a (1-a)} \ tag {75} </script></p><br><br>  Al integrar esta expresi√≥n sobre a, obtenemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">C</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">y</span><span class="MJXp-mtext" id="MJXp-Span-1225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">a</span><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1231">1</span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">y</span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1235">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">n</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1239">1</span><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">a</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1245"><span class="MJXp-mtext" id="MJXp-Span-1246">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">e</span></span><span class="MJXp-mtext" id="MJXp-Span-1258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">g</span><span class="MJXp-mrow" id="MJXp-Span-1262"><span class="MJXp-mn" id="MJXp-Span-1263">76</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> C = - [y \ ln a + (1-y) \ ln (1-a)] + {\ rm constante} \ tag {76} </script></p><br><br>  Esta es la contribuci√≥n de un ejemplo de capacitaci√≥n por separado x a la funci√≥n de costo.  Para obtener la funci√≥n de costo total, necesitamos promediar todos los ejemplos de capacitaci√≥n, y llegamos a: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">C</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1268">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">c</span><span class="MJXp-mrow" id="MJXp-Span-1273"><span class="MJXp-mn" id="MJXp-Span-1274">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1277">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">u</span><span class="MJXp-msubsup" id="MJXp-Span-1280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1282" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">y</span><span class="MJXp-mtext" id="MJXp-Span-1285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">a</span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1291">1</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">y</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1295">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">n</span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1299">1</span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">a</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mtext" id="MJXp-Span-1306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">e</span></span><span class="MJXp-mtext" id="MJXp-Span-1318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">g</span><span class="MJXp-mrow" id="MJXp-Span-1322"><span class="MJXp-mn" id="MJXp-Span-1323">77</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-24"> C = - \ frac {1} {n} \ sum_x [y \ ln a + (1-y) \ ln (1-a)] + {\ rm constante} \ tag {77} </script></p><br><br>  La constante aqu√≠ es el promedio de las constantes individuales de cada uno de los ejemplos de entrenamiento.  Como puede ver, las ecuaciones (71) y (72) determinan de forma √∫nica la forma de la entrop√≠a cruzada, carne a constante constante.  La entrop√≠a cruzada no fue m√°gicamente sacada del aire.  Ella podr√≠a ser encontrada de una manera simple y natural. <br><br>  ¬øQu√© pasa con la idea intuitiva de la entrop√≠a cruzada?  ¬øC√≥mo lo imaginamos?  Una explicaci√≥n detallada nos llevar√≠a a adelantar nuestro curso de capacitaci√≥n.  Sin embargo, podemos mencionar la existencia de una forma est√°ndar de interpretar la entrop√≠a cruzada, que se origina en el campo de la teor√≠a de la informaci√≥n.  En t√©rminos generales, la entrop√≠a cruzada es una medida de sorpresa.  Por ejemplo, nuestra neurona est√° tratando de calcular la funci√≥n x ‚Üí y = y (x).  Pero en cambio, cuenta la funci√≥n x ‚Üí a = a (x).  Supongamos que imaginamos a como una estimaci√≥n de la neurona de la probabilidad de que y = 1, y 1-a es la probabilidad de que el valor correcto para y sea 0. Luego, la entrop√≠a cruzada mide cu√°nto estamos "sorprendidos", en promedio, cuando encuentra el verdadero valor de y.  No estamos muy sorprendidos si esperamos una salida, y estamos muy sorprendidos si la salida es inesperada.  Por supuesto, no di una definici√≥n estricta de "sorpresa", por lo que todo esto puede parecer una diatriba vac√≠a.  Pero, de hecho, en la teor√≠a de la informaci√≥n hay una forma exacta de determinar lo inesperado.  Desafortunadamente, no conozco ning√∫n ejemplo de una discusi√≥n buena, corta y autosuficiente de este punto en Internet.  Pero si est√° interesado en profundizar un poco m√°s, entonces el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo de Wikipedia</a> tiene buena informaci√≥n general que lo enviar√° en la direcci√≥n correcta.  Los detalles se pueden encontrar en el Cap√≠tulo 5 sobre la desigualdad de Kraft en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">libro sobre teor√≠a de la informaci√≥n</a> . <br><br><h3>  Desaf√≠o </h3><br><ul><li>  Hemos discutido en detalle la desaceleraci√≥n en el aprendizaje que puede ocurrir cuando las neuronas est√°n saturadas en las redes que utilizan la funci√≥n de costo cuadr√°tico en el aprendizaje.  Otro factor que puede inhibir el aprendizaje es la presencia del t√©rmino x <sub>j</sub> en la ecuaci√≥n (61).  Por eso, cuando la salida x <sub>j se</sub> aproxima a cero, el peso correspondiente w <sub>j</sub> se entrenar√° lentamente.  Explique por qu√© es imposible eliminar el t√©rmino x <sub>j</sub> eligiendo alguna funci√≥n de costo ingeniosa. </li></ul><br><br><h2>  Softmax (funci√≥n m√°xima suave) </h2><br>  En este cap√≠tulo, usaremos principalmente la funci√≥n de costo de entrop√≠a cruzada para resolver los problemas de desaceleraci√≥n del aprendizaje.  Sin embargo, me gustar√≠a discutir brevemente otro enfoque para este problema, basado en el llamado  softmax-capas de neuronas.  No usaremos capas Softmax para el resto de este cap√≠tulo, por lo que si tiene prisa, puede omitir esta secci√≥n.  Sin embargo, todav√≠a vale la pena entender Softmax, en particular porque es interesante en s√≠ mismo, y en particular porque usaremos capas Softmax en el Cap√≠tulo 6, en nuestra discusi√≥n sobre redes neuronales profundas. <br><br>  La idea de Softmax es definir un nuevo tipo de capa de salida para HC.  Comienza de la misma manera que la capa sigmoidea, con la formaci√≥n de entradas ponderadas. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1324"><span class="MJXp-msubsup" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">u</span><span class="MJXp-msubsup" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1335" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">k</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">k</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">L</span><span class="MJXp-mo" id="MJXp-Span-1348">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1349">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">j</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> z ^ L_j = \ sum_ {k} w ^ L_ {jk} a ^ {L-1} _k + b ^ L_j </script>  .  Sin embargo, no utilizamos un sigmoide para obtener una respuesta.  En la capa Softmax, aplicamos la funci√≥n Softmax a z <sup>L</sup> <sub>j</sub> .  Seg√∫n ella, la activaci√≥n a <sup>L</sup> <sub>j de la</sub> neurona de salida No. j es igual a: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1355"><span class="MJXp-msubsup" id="MJXp-Span-1356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1361">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">c</span><span class="MJXp-mrow" id="MJXp-Span-1366"><span class="MJXp-msubsup" id="MJXp-Span-1367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1369" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1374"><span class="MJXp-mtext" id="MJXp-Span-1375">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">u</span><span class="MJXp-msubsup" id="MJXp-Span-1378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1380" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1383" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1388">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">g</span><span class="MJXp-mrow" id="MJXp-Span-1392"><span class="MJXp-mn" id="MJXp-Span-1393">78</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> a ^ L_j = \ frac {e ^ {z ^ L_j}} {\ sum_k e ^ {z ^ L_k}} \ tag {78} </script></p><br><br>  donde en el denominador sumamos todas las neuronas de salida. <br><br>  Si la funci√≥n Softmax no le resulta familiar, la ecuaci√≥n (78) le parecer√° misteriosa.  No es del todo obvio por qu√© deber√≠amos usar tal funci√≥n.  Tampoco es obvio que nos ayudar√° a resolver el problema de ralentizar el aprendizaje.  Para comprender mejor la ecuaci√≥n (78), supongamos que tenemos una red con cuatro neuronas de salida y cuatro entradas ponderadas correspondientes, que designaremos como z <sup>L</sup> <sub>1</sub> , z <sup>L</sup> <sub>2</sub> , z <sup>L</sup> <sub>3</sub> y z <sup>L</sup> <sub>4</sub> .  El <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo original</a> contiene controles deslizantes de ajuste interactivo, a los que se les asignan los valores posibles de las entradas ponderadas y la programaci√≥n de las activaciones de salida correspondientes.  Un buen punto de partida para estudiarlos ser√≠a usar el control deslizante inferior para aumentar z <sup>L</sup> <sub>4</sub> . <br><br><img src="https://habrastorage.org/webt/na/og/gw/naoggwrddhdvbb8oazriohydiy8.png"><br><br><img src="https://habrastorage.org/webt/tz/-7/_4/tz-7_4zl_-vtam3qzx22klosse8.png"><br><br>  Al aumentar z <sup>L</sup> <sub>4</sub> , se puede observar un aumento en la activaci√≥n de salida correspondiente, un <sup>L</sup> <sub>4</sub> y una disminuci√≥n en otras activaciones de salida.  Al disminuir z <sup>L</sup> <sub>4</sub> a <sup>L</sup> <sub>4</sub> disminuir√°, y todas las dem√°s activaciones de salida aumentar√°n.  Despu√©s de mirar de cerca, ver√° que en ambos casos el cambio general en otras activaciones compensa exactamente el cambio que ocurre en un <sup>L</sup> <sub>4</sub> .  La raz√≥n de esto es la garant√≠a de que todas las activaciones de salida en total dan 1, que podemos probar usando la ecuaci√≥n (78) y algo de √°lgebra: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1394"><span class="MJXp-mtext" id="MJXp-Span-1395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">u</span><span class="MJXp-msubsup" id="MJXp-Span-1398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1400" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">c</span><span class="MJXp-mrow" id="MJXp-Span-1411"><span class="MJXp-mtext" id="MJXp-Span-1412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">u</span><span class="MJXp-msubsup" id="MJXp-Span-1415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1417" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1420" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1425"><span class="MJXp-mtext" id="MJXp-Span-1426">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">u</span><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1431" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1434" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1440">1</span><span class="MJXp-mtext" id="MJXp-Span-1441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">g</span><span class="MJXp-mrow" id="MJXp-Span-1445"><span class="MJXp-mn" id="MJXp-Span-1446">79</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> \ sum_j a ^ L_j = \ frac {\ sum_j e ^ {z ^ L_j}} {\ sum_k e ^ {z ^ L_k}} = 1 \ tag {79} </script></p><br><br>  Como resultado, con un aumento de <sup>L</sup> <sub>4</sub> , las activaciones de salida restantes deben disminuir en el mismo valor en total para garantizar que la suma de todas las activaciones de salida sea igual a 1. Y, por supuesto, declaraciones similares ser√°n ciertas para todas las dem√°s activaciones. <br><br>  Tambi√©n se deduce de la ecuaci√≥n (78) que todas las activaciones de salida son positivas, ya que la funci√≥n exponencial es positiva.  Combinando esto con la observaci√≥n de la secci√≥n anterior, encontramos que la salida de la capa Softmax es un conjunto de n√∫meros positivos que dan un total de 1. En otras palabras, la salida de la capa Softmax se puede representar como una distribuci√≥n de probabilidad. <br><br>  El hecho de que la salida de la capa Softmax es una distribuci√≥n de probabilidad es muy agradable.  En muchos problemas, es conveniente poder interpretar las activaciones de salida a <sup>L</sup> <sub>j</sub> como una estimaci√≥n por la red de la probabilidad de que el bulet j sea la opci√≥n correcta.  Entonces, por ejemplo, en el problema de clasificaci√≥n MNIST, podemos interpretar un <sup>L</sup> <sub>j</sub> como una estimaci√≥n por la red de la probabilidad de que j sea la versi√≥n correcta de la clasificaci√≥n de un d√≠gito. <br><br>  Por el contrario, si la capa de salida era sigmoidea, definitivamente no podemos suponer que las activaciones forman una distribuci√≥n de probabilidad.  No probar√© esto estrictamente, pero es razonable suponer que las activaciones de la capa sigmoidea en el caso general no forman una distribuci√≥n de probabilidad.  Por lo tanto, utilizando una capa de salida sigmoidea, no obtendremos una interpretaci√≥n tan simple de las activaciones de salida. <br><br><h3>  Ejercicio </h3><br><ul><li>  Haga un ejemplo que muestre que en una red con una capa de salida sigmoidea, las activaciones de salida a <sup>L</sup> <sub>j</sub> no siempre suman 1. </li></ul><br><br>  Comenzamos a entender un poco sobre las funciones de Softmax y c√≥mo se comportan las capas de Softmax.  Solo para resumir: los exponentes en la ecuaci√≥n (78) aseguran que todas las activaciones de salida sean positivas.  La suma en el denominador de la ecuaci√≥n (78) asegura que Softmax da un total de 1. Por lo tanto, este tipo de ecuaci√≥n ya no parece misteriosa: esta es una forma natural de garantizar que las activaciones de salida formen una distribuci√≥n de probabilidad.  Softmax se puede imaginar como una forma de escalar z <sup>L</sup> <sub>j</sub> y luego comprimirlos para formar una distribuci√≥n de probabilidad. <br><br><h3>  Ejercicios </h3><br><ul><li>  La monoton√≠a de Softmax.  Demuestre que ‚àÇa <sup>L</sup> <sub>j</sub> / ‚àÇz <sup>L</sup> <sub>k es</sub> positivo si j = k, y negativo si j ‚â† k.  Como resultado, <sub>se</sub> garantiza que un aumento en z <sup>L</sup> <sub>j</sub> aumentar√° la activaci√≥n de salida correspondiente a <sup>L</sup> <sub>j</sub> , y disminuir√° todas las dem√°s activaciones de salida.  Ya hemos visto esto emp√≠ricamente usando el ejemplo de controles deslizantes, pero esta prueba ser√° rigurosa. </li><li>  No localidad Softmax.  Una buena caracter√≠stica de las capas sigmoideas es que la salida a <sup>L</sup> <sub>j</sub> es una funci√≥n de la entrada ponderada correspondiente, a <sup>L</sup> <sub>j</sub> = œÉ (z <sup>L</sup> <sub>j</sub> ).  Explique por qu√© este no es el caso con la capa Softmax: cualquier activaci√≥n de salida a <sup>L</sup> <sub>j</sub> depende de todas las entradas ponderadas. </li></ul><br><br><h3>  Desaf√≠o </h3><br><ul><li>  Invierta la capa Softmax.  Supongamos que tenemos un NS con una capa Softmax de salida y las activaciones a <sup>L</sup> <sub>j son</sub> conocidas.  Demuestre que las entradas ponderadas correspondientes tienen la forma z <sup>L</sup> <sub>j</sub> = ln a <sup>L</sup> <sub>j</sub> + C, donde C es una constante independiente de j. </li></ul><br><br><h2>  Problema de desaceleraci√≥n del aprendizaje </h2><br>  Ya nos hemos familiarizado bastante con las capas de neuronas Softmax.  Pero hasta ahora no hemos visto c√≥mo las capas Softmax nos permiten resolver el problema de ralentizar el aprendizaje.  Para comprender esto, definamos una funci√≥n de costo basada en la "probabilidad de registro".  Usaremos x para denotar la entrada de entrenamiento de la red, e y para la salida deseada correspondiente.  Entonces el LPS asociado con esta entrada de capacitaci√≥n ser√°: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">C</span><span class="MJXp-mtext" id="MJXp-Span-1449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">v</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">n</span><span class="MJXp-msubsup" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">y</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">g</span><span class="MJXp-mrow" id="MJXp-Span-1467"><span class="MJXp-mn" id="MJXp-Span-1468">80</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> C \ equiv - \ ln a ^ L_y \ tag {80} </script></p><br><br>  Entonces, si, por ejemplo, estudiamos en im√°genes MNIST, y la imagen 7 entr√≥ en la entrada, entonces el LPS ser√° ‚àíln un <sup>L</sup> <sub>7</sub> .  Para entender esto intuitivamente, consideramos el caso cuando la red maneja bien el reconocimiento, es decir, est√° seguro de que est√° en la entrada 7. En este caso, evaluar√° el valor de la probabilidad correspondiente a <sup>L</sup> <sub>7</sub> como cercano a 1, por lo tanto, el costo ‚àíln a <sup>L</sup> <sub>7</sub> ser√° peque√±o .  Por el contrario, si la red no funciona bien, entonces la probabilidad de un <sup>L</sup> <sub>7</sub> ser√° menor, y el costo ‚àíln un <sup>L</sup> <sub>7</sub> ser√° mayor.  Por lo tanto, LPS se comporta como se espera de una funci√≥n de costo. <br><br>  ¬øQu√© pasa con el problema de desaceleraci√≥n?  Para analizarlo, recordamos que lo principal en la desaceleraci√≥n es el comportamiento de ‚àÇC / ‚àÇw <sup>L</sup> <sub>jk</sub> y ‚àÇC / ‚àÇb <sup>L</sup> <sub>j</sub> .  No describir√© en detalle la captura de la derivada; le pedir√© que haga esto en las tareas, pero utilizando algo de √°lgebra puede demostrar que: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1469"><span class="MJXp-mtext" id="MJXp-Span-1470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">c</span><span class="MJXp-mrow" id="MJXp-Span-1475"><span class="MJXp-mtext" id="MJXp-Span-1476">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1485"><span class="MJXp-mtext" id="MJXp-Span-1486">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">l</span><span class="MJXp-msubsup" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1506" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-1507">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">g</span><span class="MJXp-mrow" id="MJXp-Span-1511"><span class="MJXp-mn" id="MJXp-Span-1512">81</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-29"> \ frac {\ partial C} {\ partial b ^ L_j} = a ^ L_j-y_j \ tag {81} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1513"><span class="MJXp-mtext" id="MJXp-Span-1514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">c</span><span class="MJXp-mrow" id="MJXp-Span-1519"><span class="MJXp-mtext" id="MJXp-Span-1520">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1529"><span class="MJXp-mtext" id="MJXp-Span-1530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">l</span><span class="MJXp-msubsup" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">k</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">L</span><span class="MJXp-mo" id="MJXp-Span-1550">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1551">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1560" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1562">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">g</span><span class="MJXp-mrow" id="MJXp-Span-1566"><span class="MJXp-mn" id="MJXp-Span-1567">82</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-30"> \ frac {\ partial C} {\ partial w ^ L_ {jk}} = a ^ {L-1} _k (a ^ L_j-y_j) \ tag {82} </script></p><br><br>  He jugado un poco con la notaci√≥n aqu√≠, y estoy usando "y" un poco diferente que en el √∫ltimo p√°rrafo.  All√≠ y denota la salida de red deseada, es decir, si la salida es "7", entonces la entrada era la imagen 7. Y en estas ecuaciones, y denota el vector de activaci√≥n de salida correspondiente a 7, es decir, un vector que tiene todos ceros excepto la unidad en 7 th puesto. <br><br>  Estas ecuaciones son las mismas que expresiones similares que obtuvimos en un an√°lisis anterior de entrop√≠a cruzada.  Compare, por ejemplo, las ecuaciones (82) y (67).  Esta es la misma ecuaci√≥n, aunque esta √∫ltima se promedia sobre ejemplos de entrenamiento.  Y, como en el primer caso, estas expresiones garantizan que el aprendizaje no se ralentiza.  Es √∫til imaginar que la capa de Softmax de salida con LPS es bastante similar a la capa con salida sigmoidea y el costo basado en la entrop√≠a cruzada. <br><br>  Dada su similitud, ¬øqu√© se debe usar: salida sigmoidea y entrop√≠a cruzada, o salida Softmax y LPS?  De hecho, en muchos casos ambos enfoques funcionan bien.  Aunque m√°s adelante en este cap√≠tulo usaremos una capa de salida sigmoidea con un costo basado en la entrop√≠a cruzada.  M√°s adelante, en el cap√≠tulo 6, a veces usaremos la salida Softmax y LPS.  La raz√≥n de los cambios es hacer que algunas de las siguientes redes sean m√°s similares a las redes que se encuentran en algunos art√≠culos de investigaci√≥n influyentes.  Desde un punto de vista m√°s general, Softmax y LPS deben usarse cuando necesite interpretar las activaciones de salida como probabilidades.  Esto no siempre es necesario, pero puede ser √∫til en problemas de clasificaci√≥n (como MNIST), que incluyen clases que no se cruzan. <br><br><h3>  Las tareas </h3><br><ul><li>  Derive las ecuaciones (81) y (82). </li><li>  ¬øDe d√≥nde viene el nombre Softmax?  Supongamos que cambiamos la funci√≥n Softmax para que las activaciones de salida est√©n dadas por la ecuaci√≥n <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1568"><span class="MJXp-msubsup" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1574">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">c</span><span class="MJXp-mrow" id="MJXp-Span-1579"><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1582" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">c</span><span class="MJXp-msubsup" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1588"><span class="MJXp-mtext" id="MJXp-Span-1589">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">u</span><span class="MJXp-msubsup" id="MJXp-Span-1592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1594" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1597" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">c</span><span class="MJXp-msubsup" id="MJXp-Span-1599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1603">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">g</span><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-mn" id="MJXp-Span-1608">83</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> a ^ L_j = \ frac {e ^ {c z ^ L_j}} {\ sum_k e ^ {c z ^ L_k}} \ tag {83} </script></p>  donde c es una constante positiva.  Tenga en cuenta que c = 1 corresponde a la funci√≥n est√°ndar de Softmax.  Pero usando un valor diferente de c, obtenemos otra funci√≥n que seguir√° siendo cualitativamente similar a Softmax.  Muestre que las activaciones de salida forman una distribuci√≥n de probabilidad, como es el caso con Softmax regular.  Supongamos que hacemos c muy grande, es decir, c ‚Üí &amp; inf;.  ¬øCu√°l es el valor l√≠mite de las activaciones de salida a <sup>L</sup> <sub>j</sub> ?  Despu√©s de resolver este problema, debe quedar claro por qu√© una funci√≥n con c = 1 se considera una "versi√≥n suavizada" de la funci√≥n m√°xima.  De aqu√≠ proviene el t√©rmino softmax. </li><li>  Propagaci√≥n hacia atr√°s con Softmax y LPS.  En el √∫ltimo cap√≠tulo, derivamos el algoritmo de retropropagaci√≥n para una red que contiene capas sigmoideas.  Para aplicar este algoritmo a las capas de red y Softmax, necesitamos derivar la expresi√≥n para el error Œ¥ <sup>L</sup> <sub>j</sub> ‚â° ‚àÇC / ‚àÇz <sup>L</sup> <sub>j</sub> .  Demuestre que una expresi√≥n adecuada ser√≠a <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1609"><span class="MJXp-mtext" id="MJXp-Span-1610">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1627" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629"><font style="vertical-align: inherit;"> t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-1632"><span class="MJXp-mn" id="MJXp-Span-1633"><font style="vertical-align: inherit;">84</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-1628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-1632"><span class="MJXp-mn" id="MJXp-Span-1633"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ delta ^ L_j = a ^ L_j -y_j \ tag {84} </script></p>  Usando esta expresi√≥n, podemos aplicar el algoritmo de retropropagaci√≥n a la red usando la capa de salida Softmax y LPS. </li></ul><br><br><h2>  Reciclaje y regularizaci√≥n </h2><br>  Una vez se le pidi√≥ al premio Nobel Enrico Fermi una opini√≥n sobre el modelo matem√°tico propuesto por varios colegas para resolver un importante problema f√≠sico no resuelto.  El modelo correspond√≠a perfectamente al experimento, pero Fermi se mostr√≥ esc√©ptico al respecto.  Pregunt√≥ cu√°ntos par√°metros libres se pueden cambiar.  "Cuatro", le dijeron.  Fermi respondi√≥: "Recuerdo que a mi amigo Johnny von Neumann le gustaba decir que con cuatro par√°metros puedes empujar a un elefante all√≠, y con cinco puedes hacer que agite su trompa". <br><br>  El significado de la historia, por supuesto, es que los modelos con una gran cantidad de par√°metros libres pueden describir una gama sorprendentemente amplia de fen√≥menos.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incluso si dicho modelo funciona bien con los datos disponibles, no lo convierte autom√°ticamente en un buen modelo. </font><font style="vertical-align: inherit;">Simplemente podr√≠a significar que el modelo tiene suficiente libertad para describir casi cualquier conjunto de datos de un tama√±o determinado sin revelar la idea principal del fen√≥meno. </font><font style="vertical-align: inherit;">Cuando esto sucede, el modelo funciona bien con los datos existentes, pero no puede generalizar la nueva situaci√≥n. </font><font style="vertical-align: inherit;">Una verdadera prueba de un modelo es su capacidad para hacer predicciones en situaciones que no ha encontrado antes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fermi y von Neumann sospechaban de modelos con cuatro par√°metros. ¬°Nuestro NS con 30 neuronas ocultas para la clasificaci√≥n de d√≠gitos MNIST tiene casi 24,000 par√°metros! Estos son bastantes par√°metros. Nuestro NS con 100 neuronas ocultas tiene casi 80,000 par√°metros, y los NS profundos avanzados de estos par√°metros a veces tienen millones o incluso miles de millones. ¬øPodemos confiar en los resultados de su trabajo?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos a complicar este problema creando una situaci√≥n en la que nuestra red generalice mal una nueva situaci√≥n para ella. Usaremos NS con 30 neuronas ocultas y 23.860 par√°metros. Pero no entrenaremos la red con las 50,000 im√°genes MNIST. En cambio, usamos solo los primeros 1000. El uso de un conjunto limitado har√° que el problema de generalizaci√≥n sea m√°s obvio. Estudiaremos como antes, utilizando la funci√≥n de costo basada en la entrop√≠a cruzada, con una velocidad de aprendizaje de Œ∑ = 0.5 y un tama√±o de mini paquete de 10. Sin embargo, estudiaremos 400 eras, que es un poco m√°s que antes, ya que hay ejemplos de capacitaci√≥n no tenemos mucho Usemos network2 para ver c√≥mo cambia la funci√≥n de costo:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, evaluation_data=test_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando los resultados, podemos construir un gr√°fico del cambio en el costo al entrenar la red (los gr√°ficos se hicieron usando el programa overfitting.py): </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/202/918/ebd/202918ebd6b97ceb7fa451a150c879c1.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">parece alentador, hay una disminuci√≥n suave en el costo, como se esperaba. Tenga en cuenta que solo mostr√© las √©pocas de 200 a 399. Como resultado, vemos a mayor escala las etapas tard√≠as del entrenamiento, en las cuales, como veremos m√°s adelante, suceden todas las cosas m√°s interesantes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora veamos c√≥mo la precisi√≥n de clasificaci√≥n en los datos de verificaci√≥n cambia con el tiempo:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d52/ead/ddb/d52eadddb40981a35b36a852dc346674.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luego volv√≠ a aumentar el horario. En las primeras 200 eras, que no son visibles aqu√≠, la precisi√≥n aumenta a casi el 82%. Luego, el entrenamiento se ralentiza gradualmente. Finalmente, alrededor de la era 280, la precisi√≥n de la clasificaci√≥n deja de mejorar. En √©pocas posteriores, solo se observan peque√±as fluctuaciones estoc√°sticas en torno al valor de precisi√≥n alcanzado en la 280¬™ √©poca. Compare esto con el gr√°fico anterior, donde el costo asociado con los datos de capacitaci√≥n est√° disminuyendo gradualmente. Si estudia solo este costo, parecer√° que el modelo est√° mejorando. Sin embargo, los resultados de trabajar con datos de prueba nos dicen que esta mejora es solo una ilusi√≥n. Como en el modelo que a Fermi no le gust√≥, lo que nuestra red estudia despu√©s de la era 280 ya no se generaliza a los datos de verificaci√≥n. Por lo tanto, este entrenamiento deja de ser √∫til. Decimos que despu√©s de la era 280, la red se est√° volviendo a capacitar,o sobreajuste.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede que se pregunte si no es un problema que est√© estudiando el costo en funci√≥n de los datos de capacitaci√≥n y no en la precisi√≥n de la clasificaci√≥n de los datos de verificaci√≥n. En otras palabras, quiz√°s el problema es que estamos comparando manzanas con naranjas. ¬øQu√© suceder√° si comparamos el costo de los datos de capacitaci√≥n con el costo de la verificaci√≥n, es decir, compararemos medidas comparables? ¬øO tal vez podr√≠amos comparar la precisi√≥n de clasificaci√≥n de los datos de entrenamiento y prueba? De hecho, el mismo fen√≥meno aparece independientemente de c√≥mo se haga la comparaci√≥n. Pero los detalles est√°n cambiando. Por ejemplo, veamos el valor de los datos de verificaci√≥n:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/81e/c1b/01a/81ec1b01a439d1766585dc57587b907c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se puede ver que el costo de los datos de verificaci√≥n mejora hasta alrededor de la 15a era, y luego comienza a deteriorarse por completo, aunque el costo de los datos de capacitaci√≥n contin√∫a mejorando. Esta es otra se√±al de un modelo reentrenado. Sin embargo, surge la pregunta: ¬øen qu√© √©poca deber√≠amos considerar el punto en el que el reciclaje comienza a prevalecer sobre el entrenamiento: 15 o 280? Desde un punto de vista pr√°ctico, sin embargo, estamos interesados ‚Äã‚Äãen mejorar la precisi√≥n de la clasificaci√≥n de los datos de verificaci√≥n, y el costo es solo un mediador de la precisi√≥n de la clasificaci√≥n. Por lo tanto, tiene sentido considerar la era de 280 por punto, despu√©s de lo cual el reciclaje comienza a prevalecer sobre el entrenamiento de nuestra Asamblea Nacional. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otro signo de reciclaje puede verse en la precisi√≥n de la clasificaci√≥n de los datos de entrenamiento:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ff/5f3/dd6/6ff5f3dd69e5182de0ebfc1e54e8db0b.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La precisi√≥n est√° creciendo, llegando al 100%. Es decir, nuestra red clasifica correctamente las 1000 im√°genes de entrenamiento. Mientras tanto, la precisi√≥n de la verificaci√≥n crece a solo 82.27%. Es decir, nuestra red solo estudia las caracter√≠sticas del conjunto de entrenamiento y no aprende a reconocer n√∫meros en absoluto. Parece que la red simplemente recuerda el conjunto de entrenamiento, sin entender los n√∫meros lo suficientemente bien como para generalizar esto al conjunto de prueba. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La reentrenamiento es un problema grave de la Asamblea Nacional. Esto es especialmente cierto para los NS modernos, que generalmente tienen una gran cantidad de pesos y desplazamientos. Para un entrenamiento efectivo, necesitamos una forma de determinar cu√°ndo ocurre el reciclaje para no volver a entrenar. Y tambi√©n nos gustar√≠a poder reducir los efectos del reciclaje.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una forma obvia de detectar el reentrenamiento es utilizar el enfoque anterior, monitorear la precisi√≥n del trabajo con datos de verificaci√≥n durante el entrenamiento en red. Si vemos que la precisi√≥n de los datos de verificaci√≥n ya no mejora, debemos dejar de entrenar. Por supuesto, estrictamente hablando, esto no ser√° necesariamente una se√±al de reciclaje. Quiz√°s la precisi√≥n de trabajar con pruebas y datos de entrenamiento dejar√° de mejorar al mismo tiempo. Sin embargo, la aplicaci√≥n de dicha estrategia evitar√° la reentrenamiento. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y usaremos una peque√±a variaci√≥n de esta estrategia. Recuerde que cuando cargamos datos en MNIST, los dividimos en tres conjuntos:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper()</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasta ahora hemos utilizado training_data y test_data, y hemos ignorado validation_data [confirmando]. Validation_data contiene 10,000 im√°genes, que difieren de las 50,000 im√°genes del conjunto de entrenamiento MNIST y las 10,000 im√°genes del conjunto de validaci√≥n. En lugar de usar test_data para evitar el sobreajuste, usaremos validation_data. Para hacer esto, usaremos casi la misma estrategia que se describi√≥ anteriormente para test_data. Es decir, calcularemos la precisi√≥n de clasificaci√≥n de validation_data al final de cada era. Una vez que la precisi√≥n de clasificaci√≥n de validation_data est√© completa, dejaremos de aprender. Esta estrategia se llama una parada temprana. Por supuesto, en la pr√°ctica, no podremos descubrir de inmediato que la precisi√≥n est√° saciada. En cambio, continuaremos entrenando hasta que nos aseguremos de esto (y decidamoscuando necesita detenerse, no siempre es f√°cil, y puede usar enfoques m√°s o menos agresivos para esto).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPor qu√© usar validation_data para evitar el reentrenamiento en lugar de test_data? Es parte de una estrategia m√°s general usar validation_data para evaluar diferentes opciones para hiperpar√°metros: la cantidad de √©pocas para aprender, la velocidad de aprendizaje, la mejor arquitectura de red, etc. Utilizamos estas estimaciones para encontrar y asignar buenos valores a los hiperpar√°metros. Y aunque todav√≠a no he mencionado esto, fue en parte debido a esto que eleg√≠ los hiperpar√°metros en los ejemplos anteriores del libro.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por supuesto, este comentario no responde a la pregunta de por qu√© usamos validation_data, y no test_data, para evitar el sobreajuste. Simplemente reemplaza la respuesta a una pregunta m√°s general: ¬øpor qu√© usamos validation_data, y no test_data, para seleccionar hiperpar√°metros? Para comprender esto, tenga en cuenta que al elegir hiperpar√°metros, lo m√°s probable es que tengamos que elegir entre una variedad de sus opciones. Si asignamos hiperpar√°metros basados ‚Äã‚Äãen las calificaciones de test_data, probablemente adaptaremos estos datos demasiado espec√≠ficamente para test_data. Es decir, podemos encontrar hiperpar√°metros que se adaptan bien a las caracter√≠sticas espec√≠ficas de datos espec√≠ficos de test_data, sin embargo, el funcionamiento de nuestra red no se generalizar√° a otros conjuntos de datos. Evitamos esto seleccionando hiperpar√°metros usando validation_data. Y luego, habiendo recibido el GP que necesitamos,Realizamos una evaluaci√≥n final de precisi√≥n utilizando test_data. Esto nos da la confianza de que nuestros resultados con test_data son una verdadera medida del grado de generalizaci√≥n del NS. En otras palabras, los datos de respaldo son datos de entrenamiento tan especiales que nos ayudan a aprender un buen GP. Este enfoque para localizar GPs a veces se llama m√©todo de retenci√≥n, ya que validation_data se "mantiene" por separado de training_data.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la pr√°ctica, incluso despu√©s de evaluar la calidad del trabajo en test_data, querremos cambiar de opini√≥n e intentar un enfoque diferente, tal vez una arquitectura de red diferente, que incluir√° b√∫squedas de un nuevo conjunto de GP. En este caso, ¬øexiste el peligro de que nos adaptemos innecesariamente a test_data? ¬øNecesitaremos un n√∫mero potencialmente infinito de conjuntos de datos para poder estar seguros de que nuestros resultados est√°n bien generalizados? En general, este es un problema profundo y complejo. Pero para nuestros prop√≥sitos pr√°cticos, no nos preocuparemos demasiado por esto. Simplemente nos sumergimos de lleno en nuevas investigaciones utilizando un m√©todo de retenci√≥n simple basado en training_data, validation_data y test_data, como se describi√≥ anteriormente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasta ahora, hemos estado considerando la reentrenamiento con 1000 im√°genes de entrenamiento. ¬øQu√© sucede si utilizamos un conjunto completo de capacitaci√≥n de 50,000 im√°genes? Dejaremos los dem√°s par√°metros sin cambios (30 neuronas ocultas, velocidad de aprendizaje 0.5, tama√±o mini-paquete 10), pero estudiaremos 30 eras usando las 50,000 im√°genes. Aqu√≠ hay un gr√°fico que muestra la precisi√≥n de la clasificaci√≥n en datos de entrenamiento y datos de prueba. Tenga en cuenta que aqu√≠ utilic√© datos de validaci√≥n en lugar de datos de validaci√≥n para que sea m√°s f√°cil comparar los resultados con gr√°ficos anteriores.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ac/939/bd9/3ac939bd9760316faf84350fca4cd00d.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se puede ver que los indicadores de precisi√≥n en la prueba y los datos de entrenamiento permanecen m√°s cerca uno del otro que cuando se usan 1000 ejemplos de entrenamiento. </font><font style="vertical-align: inherit;">En particular, la mejor precisi√≥n de clasificaci√≥n, 97.86%, es solo 2.53% mayor que el 95.33% de los datos de verificaci√≥n. </font><font style="vertical-align: inherit;">¬°Compare con un descanso temprano del 17.73%! </font><font style="vertical-align: inherit;">Se est√° llevando a cabo una nueva capacitaci√≥n, pero se ha reducido considerablemente. </font><font style="vertical-align: inherit;">Nuestra red recopila informaci√≥n mucho mejor, pasando de la capacitaci√≥n a los datos de prueba. </font><font style="vertical-align: inherit;">En general, una de las mejores formas de reducir el reciclaje es aumentar la cantidad de datos de entrenamiento. </font><font style="vertical-align: inherit;">Con suficientes datos de entrenamiento, es dif√≠cil volver a capacitar incluso una red muy grande. </font><font style="vertical-align: inherit;">Desafortunadamente, obtener datos de capacitaci√≥n es costoso y / o dif√≠cil, por lo que esta opci√≥n no siempre es pr√°ctica.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Regularizaci√≥n </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aumentar la cantidad de datos de entrenamiento es una forma de reducir el reciclaje. </font><font style="vertical-align: inherit;">¬øHay otras formas de reducir el reciclaje? </font><font style="vertical-align: inherit;">Un posible enfoque es reducir el tama√±o de la red. </font><font style="vertical-align: inherit;">Es cierto que las redes grandes tienen potencial m√°s que las peque√±as, por lo que somos reacios a recurrir a esta opci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afortunadamente, existen otras t√©cnicas que pueden reducir el reciclaje, incluso cuando hemos arreglado el tama√±o de la red y los datos de entrenamiento. </font><font style="vertical-align: inherit;">Se conocen como t√©cnicas de regularizaci√≥n. </font><font style="vertical-align: inherit;">En este cap√≠tulo, describir√© una de las t√©cnicas m√°s populares, a veces llamadas pesas de debilitamiento o regularizaci√≥n de L2. </font><font style="vertical-align: inherit;">Su idea es agregar un miembro adicional llamado miembro de regularizaci√≥n a la funci√≥n de costo. </font><font style="vertical-align: inherit;">Aqu√≠ hay entrop√≠a cruzada con regularizaci√≥n:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1634"><span class="MJXp-mtable" id="MJXp-Span-1635"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1636" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1637" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1641" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1642"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1644"><span class=""><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1646" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1649"><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">[</span></span><span class="MJXp-msubsup" id="MJXp-Span-1651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1653" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mi" id="MJXp-Span-1654">ln</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1662">1</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1666" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1668">ln</span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1671">1</span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-1679" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1680" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">Œª</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1682">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1684"><span class=""><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686" style="margin-left: 0px;">w</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688" style="margin-right: 0.05em;">w</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1689" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> C = -\frac{1}{n} \sum_{xj} \left[ y_j \ln a^L_j+(1-y_j) \ln (1-a^L_j)\right] + \frac{\lambda}{2n} \sum_w w^2 \tag{85} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El primer t√©rmino es una expresi√≥n com√∫n para entrop√≠a cruzada. </font><font style="vertical-align: inherit;">Pero agregamos un segundo, a saber, la suma de los cuadrados de todos los pesos de la red. </font><font style="vertical-align: inherit;">Se escala por el factor Œª / 2n, donde Œª&gt; 0 es el par√°metro de regularizaci√≥n yn, como de costumbre, es el tama√±o del conjunto de entrenamiento. </font><font style="vertical-align: inherit;">Discutiremos c√≥mo elegir Œª. </font><font style="vertical-align: inherit;">Tambi√©n vale la pena se√±alar que los sesgos no est√°n incluidos en el t√©rmino de regularizaci√≥n. </font><font style="vertical-align: inherit;">Sobre esto a continuaci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por supuesto, es posible regularizar otras funciones de costo, por ejemplo, cuadr√°tico. </font><font style="vertical-align: inherit;">Esto se puede hacer de manera similar:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1704"><span class="MJXp-mtable" id="MJXp-Span-1705"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1706" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1707" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1710" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1711"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1712"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1714"><span class=""><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äñ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1722" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1723"><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äñ</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1725" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1727" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1729"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1731"><span class=""><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1736" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> C = \frac{1}{2n} \sum_x \|y-a^L\|^2 + \frac{\lambda}{2n} \sum_w w^2 \tag{86} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En ambos casos, podemos escribir la funci√≥n de costo regularizado como </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1737"><span class="MJXp-mtable" id="MJXp-Span-1738"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1739" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1740" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1745" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1747" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1749"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1751"><span class=""><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1756" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> C = C_0 + \frac{\lambda}{2n} \sum_w w^2 \tag{87} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donde C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es la funci√≥n de costo original sin regularizaci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es intuitivamente claro que el objetivo de la regularizaci√≥n es persuadir a la red para que prefiera pesos m√°s peque√±os, en igualdad de condiciones. </font><font style="vertical-align: inherit;">Los pesos grandes solo ser√°n posibles si mejoran significativamente la primera parte de la funci√≥n de costo. </font><font style="vertical-align: inherit;">En otras palabras, la regularizaci√≥n es una forma de elegir un compromiso entre encontrar pesos peque√±os y minimizar la funci√≥n de costo inicial. </font><font style="vertical-align: inherit;">Es importante que estos dos elementos del compromiso dependan del valor de Œª: cuando Œª es peque√±o, preferimos minimizar la funci√≥n de costo original, y cuando Œª es grande, preferimos pesos peque√±os.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬°No es del todo obvio por qu√© la elecci√≥n de tal compromiso deber√≠a ayudar a reducir el reciclaje! </font><font style="vertical-align: inherit;">Pero resulta que ayuda. </font><font style="vertical-align: inherit;">Averiguaremos por qu√© ayuda en la siguiente secci√≥n. </font><font style="vertical-align: inherit;">Pero primero, trabajemos con un ejemplo que muestre que la regularizaci√≥n reduce el reciclaje. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para construir un ejemplo, primero debemos entender c√≥mo aplicar el algoritmo de entrenamiento con descenso de gradiente estoc√°stico a un NS regularizado. </font><font style="vertical-align: inherit;">En particular, necesitamos saber c√≥mo calcular las derivadas parciales, ‚àÇC / ‚àÇw y ‚àÇC / ‚àÇb para todos los pesos y compensaciones en la red. </font><font style="vertical-align: inherit;">Despu√©s de tomar las derivadas parciales en la ecuaci√≥n (87) obtenemos:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1757"><span class="MJXp-mtable" id="MJXp-Span-1758"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1759" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1760" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1761" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1762"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1764"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1767" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1768"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1771" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1772"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1774" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1775" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> w</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> \frac{\partial C}{\partial w} = \frac{\partial C_0}{\partial w} + \frac{\lambda}{n} w \tag{88} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1779"><span class="MJXp-mtable" id="MJXp-Span-1780"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1781" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1782" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1783" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1784"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1786"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1788" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1789" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1790"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1793" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1794"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \frac{\partial C}{\partial b} = \frac{\partial C_0}{\partial b} \tag{89} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los t√©rminos ‚àÇC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / ‚àÇw y ‚àÇC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / ‚àÇw se pueden calcular a trav√©s del OP, como se describe en el cap√≠tulo anterior. </font><font style="vertical-align: inherit;">Vemos que es f√°cil calcular el gradiente de la funci√≥n de costo regularizado: solo necesita usar el OP como de costumbre y luego agregar Œª / nw a la derivada parcial de todos los t√©rminos de peso. </font><font style="vertical-align: inherit;">Las derivadas parciales con respecto a los desplazamientos no cambian, por lo tanto, la regla de aprendizaje por descenso de gradiente para desplazamientos no difiere de la habitual:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1796"><span class="MJXp-mtable" id="MJXp-Span-1797"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1798" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1799" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1805" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1809" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1810"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> b \rightarrow b -\eta \frac{\partial C_0}{\partial b} \tag{90} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La regla de entrenamiento para pesas se convierte en: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1812"><span class="MJXp-mtable" id="MJXp-Span-1813"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1814" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1815" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1821" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1822"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1825" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1826"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1829" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">n</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">w</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> w \rightarrow w-\eta \frac{\partial C_0}{\partial w}-\frac{\eta \lambda}{n} w \tag{91} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1834"><span class="MJXp-mtable" id="MJXp-Span-1835"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1836" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1837" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1838" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1839"><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1841">1</span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-1843" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">Œ∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">Œª</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">w</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">Œ∑</span><span class="MJXp-mfrac" id="MJXp-Span-1851" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1852">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-1853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1855" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1856">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">w</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> = \left(1-\frac{\eta \lambda}{n}\right) w -\eta \frac{\partial C_0}{\partial w} \tag{92} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todo es igual que en la regla de descenso de gradiente habitual, excepto que primero escalamos el peso w por un factor de 1 - Œ∑Œª / n. Esta escala a veces se llama p√©rdida de peso, ya que reduce el peso. A primera vista, parece que los pesos tienden irresistiblemente a cero. Pero esto no es as√≠, ya que el otro t√©rmino puede conducir a un aumento en los pesos si esto conduce a una disminuci√≥n en la funci√≥n de costo irregular. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, deja que el descenso de gradiente funcione as√≠. ¬øQu√© pasa con el descenso de gradiente estoc√°stico? Bueno, como en la versi√≥n irregular del descenso de gradiente estoc√°stico, podemos estimar ‚àÇC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / ‚àÇw promediando sobre el mini paquete de ejemplos de entrenamiento m. Por lo tanto, la regla de aprendizaje regularizado para el descenso de gradiente estoc√°stico se convierte en (ver ecuaci√≥n (20)):</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1858"><span class="MJXp-mtable" id="MJXp-Span-1859"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1860" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1861" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-1863" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1864"><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-1866"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1868" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mo" id="MJXp-Span-1874" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1875" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1878"><span class=""><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1881" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1882"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1885" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1886"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> w \rightarrow \left(1-\frac{\eta \lambda}{n}\right) w -\frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial w} \tag{93} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donde la suma va para los ejemplos de entrenamiento x en el mini paquete, y C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es el costo irregular para cada ejemplo de entrenamiento. </font><font style="vertical-align: inherit;">Todo es igual que en la regla habitual del descenso de gradiente estoc√°stico, con la excepci√≥n de 1 - Œ∑Œª / n, el factor de p√©rdida de peso. </font><font style="vertical-align: inherit;">Finalmente, para completar la imagen, perm√≠tanme escribir una regla regularizada para las compensaciones. </font><font style="vertical-align: inherit;">Naturalmente, es exactamente lo mismo que en el caso irregular (ver ecuaci√≥n (21)):</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1888"><span class="MJXp-mtable" id="MJXp-Span-1889"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1890" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1891" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1896" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1899"><span class=""><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1902" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1903"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1906" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1907"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> b \rightarrow b - \frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial b} \tag{94} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donde va la cantidad para ejemplos de entrenamiento x en el mini-paquete. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veamos c√≥mo la regularizaci√≥n cambia la efectividad de nuestra Asamblea Nacional. Utilizaremos una red con 30 neuronas ocultas, un mini-paquete de tama√±o 10, una velocidad de aprendizaje de 0.5 y una funci√≥n de costo con entrop√≠a cruzada. Sin embargo, esta vez usamos el par√°metro de regularizaci√≥n Œª = 0.1. En el c√≥digo, llam√© a esta variable lmbda, ya que la palabra lambda est√° reservada en python para cosas que no est√°n relacionadas con nuestro tema. Tambi√©n us√© test_data nuevamente en lugar de validation_data. Pero decid√≠ usar test_data, porque los resultados se pueden comparar directamente con nuestros primeros resultados irregulares. Puede cambiar f√°cilmente el c√≥digo para que use validation_data y asegurarse de que los resultados sean similares.</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, ... evaluation_data=test_data, lmbda = <span class="hljs-number"><span class="hljs-number">0.1</span></span>, ... monitor_evaluation_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ... monitor_training_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El costo de los datos de entrenamiento disminuye constantemente, como en el caso inicial, sin regularizaci√≥n: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a20/73d/9f9/a2073d9f90ed8bc7d861e48a0f8a9c75.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero esta vez, la precisi√≥n en test_data contin√∫a aumentando a lo largo de las 400 eras: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/695/4d8/c1b/6954d8c1ba89251488688d13a4f75613.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, la regularizaci√≥n ha suprimido el reciclaje. Adem√°s, la precisi√≥n ha aumentado significativamente, y la precisi√≥n de clasificaci√≥n de pico alcanza el 87.1%, en comparaci√≥n con el pico de 82.27% alcanzado en el caso sin regularizaci√≥n. En general, es casi seguro que logremos mejores resultados al continuar estudiando despu√©s de 400 eras. Emp√≠ricamente, la regularizaci√≥n parece hacer que nuestra red generalice mejor el conocimiento y reduzca significativamente los efectos del reciclaje.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© sucede si dejamos nuestro entorno artificial, que usa solo 1,000 im√°genes de ense√±anza, y regresamos al conjunto completo de 50,000 im√°genes? </font><font style="vertical-align: inherit;">Por supuesto, ya hemos visto que el reentrenamiento es un problema mucho m√°s peque√±o con un conjunto completo de 50,000 im√°genes. </font><font style="vertical-align: inherit;">¬øLa regularizaci√≥n ayuda a mejorar el resultado? </font><font style="vertical-align: inherit;">Conservemos los valores anteriores de los hiperpar√°metros: 30 √©pocas, velocidad 0.5, tama√±o mini-paquete 10. Sin embargo, necesitamos cambiar el par√°metro de regularizaci√≥n. </font><font style="vertical-align: inherit;">El hecho es que el tama√±o n del conjunto de entrenamiento salt√≥ de 1000 a 50 000, y esto cambia el factor de debilitamiento de los pesos 1 - Œ∑Œª / n. </font><font style="vertical-align: inherit;">Si continuamos usando Œª = 0.1, esto significar√≠a que los pesos se debilitan mucho menos, y como resultado, el efecto de la regularizaci√≥n disminuye. </font><font style="vertical-align: inherit;">Para compensar esto, aceptamos Œª = 5.0.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ok, entrenemos nuestra red reinicializando primero los pesos: </font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, ... evaluation_data=test_data, lmbda = <span class="hljs-number"><span class="hljs-number">5.0</span></span>, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenemos los resultados: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f13/8c6/190/f138c6190ae49d3c90ddeb15b3964011.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todo agradable. En primer lugar, nuestra precisi√≥n de clasificaci√≥n en los datos de verificaci√≥n ha crecido, de 95.49% sin regularizaci√≥n a 96.49% con regularizaci√≥n. Esta es una mejora importante. En segundo lugar, se puede ver que la brecha entre los resultados del trabajo en el entrenamiento y los conjuntos de pruebas es mucho menor que antes, menos del 1%. La brecha a√∫n es decente, pero obviamente hemos logrado un progreso significativo en la reducci√≥n de la capacitaci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalmente, vea qu√© precisi√≥n de clasificaci√≥n obtenemos cuando usamos 100 neuronas ocultas y el par√°metro de regularizaci√≥n &amp; lambda = 5.0. No dar√© un an√°lisis detallado del reentrenamiento, esto es solo por diversi√≥n, para ver cu√°nta precisi√≥n se puede lograr con nuestros nuevos trucos: una funci√≥n de costo con entrop√≠a cruzada y regularizaci√≥n de L2.</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, lmbda=<span class="hljs-number"><span class="hljs-number">5.0</span></span>, ... evaluation_data=validation_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El resultado final es una precisi√≥n de clasificaci√≥n del 97,92% en los datos de respaldo. Un gran salto en comparaci√≥n con el caso de 30 neuronas ocultas. Puede ajustar un poco m√°s, iniciar el proceso durante 60 √©pocas con Œ∑ = 0.1 y Œª = 5.0, y superar la barrera del 98%, alcanzando una precisi√≥n de 98.04 en los datos de soporte. ¬°No est√° mal para 152 l√≠neas de c√≥digo! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Describ√≠ la regularizaci√≥n como una forma de reducir el reciclaje y aumentar la precisi√≥n de la clasificaci√≥n. Pero estas no son sus √∫nicas ventajas. Emp√≠ricamente, despu√©s de haber intentado a trav√©s de muchos lanzamientos nuestra red MNIST, cambiando los pesos cada vez, descubr√≠ que los lanzamientos sin regularizaci√≥n a veces "se atascaron", obviamente, cayendo en el m√≠nimo local de la funci√≥n de costo. Como resultado, diferentes lanzamientos a veces producen resultados muy diferentes. Y la regularizaci√≥n, por el contrario, le permite obtener resultados reproducibles mucho m√°s f√°ciles.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPor qu√© es esto as√≠? </font><font style="vertical-align: inherit;">Heur√≠sticamente, cuando la funci√≥n de costo no tiene regularizaci√≥n, la longitud del vector de pesos probablemente crecer√°, siendo todas las dem√°s cosas iguales. </font><font style="vertical-align: inherit;">Con el tiempo, esto puede conducir a un gran vector de pesos. </font><font style="vertical-align: inherit;">Y debido a esto, el vector de las escalas puede atascarse, mostr√°ndose en aproximadamente la misma direcci√≥n, ya que los cambios debidos al descenso del gradiente solo hacen peque√±os cambios de direcci√≥n con una gran longitud del vector. </font><font style="vertical-align: inherit;">Creo que debido a este fen√≥meno, es muy dif√≠cil para nuestro algoritmo de entrenamiento estudiar adecuadamente el espacio de las pesas y, por lo tanto, es dif√≠cil encontrar un buen m√≠nimo de la funci√≥n de costo.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/458724/">https://habr.com/ru/post/458724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458708/index.html">¬øQuiere <s> perder peso </s> para aprender TI por su cuenta? Preguntame como</a></li>
<li><a href="../458710/index.html">Ofuscador de espacio en blanco para PHP</a></li>
<li><a href="../458716/index.html">Primer vistazo a los UPS Delta Amplon RT</a></li>
<li><a href="../458718/index.html">Gran entrevista con Cliff Click, el padre de la compilaci√≥n JIT en Java</a></li>
<li><a href="../458720/index.html">La escuela de programadores hh.ru por d√©cima vez abre un conjunto de especialistas en TI</a></li>
<li><a href="../458726/index.html">Habr Special // Podcast con el autor de Invasion. Una breve historia de los hackers rusos</a></li>
<li><a href="../458728/index.html">¬øQu√© son las bicicletas el√©ctricas (revisi√≥n grupal de cinco modelos de dos fabricantes), parte 2</a></li>
<li><a href="../458730/index.html">Combatir la complejidad en el desarrollo de software.</a></li>
<li><a href="../458732/index.html">SIG? o no SIG? Esa es la pregunta</a></li>
<li><a href="../458734/index.html">D√≠as laborables del centro de datos: peque√±eces obvias durante 7 a√±os de funcionamiento. Y la continuaci√≥n sobre la rata</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>