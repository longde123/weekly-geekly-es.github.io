<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍱 ☺️ 😂 Winnti: serangan terhadap rantai pasokan - Pengembang game Asia berada di garis depan ⛔️ 🌲 👨🏻‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ini bukan pertama kalinya para penyerang menyerang industri game, mengkompromikan pengembang, menambahkan backdoors ke lingkungan build game, dan kemu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Winnti: serangan terhadap rantai pasokan - Pengembang game Asia berada di garis depan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/443416/"> Ini bukan pertama kalinya para penyerang menyerang industri game, mengkompromikan pengembang, menambahkan backdoors ke lingkungan build game, dan kemudian mendistribusikan malware dengan kedok yang sah.  Pada April 2013, Kaspersky Lab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">melaporkan</a> kejadian serupa.  Serangan ini dikaitkan dengan cybergroup bernama Winnti. <br><br>  Baru-baru ini, para ahli ESET tertarik dengan serangan baru terhadap rantai pasokan.  Dua game dan satu platform game dikompromikan untuk memperkenalkan backdoor.  Serangan-serangan ini menargetkan Asia dan industri game, dengan Winnti lagi di belakang mereka. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/da/mm/9k/damm9kh-fnuiccaivkprl3kc9w0.jpeg"></div><a name="habracut"></a><br><h2>  Tiga kasus, satu pintu belakang </h2><br>  Meskipun konfigurasi malware berbeda, tiga produk perangkat lunak yang dikompromikan termasuk kode backdoor yang sama dan mulai menggunakan mekanisme yang sama.  Sekarang tidak ada jalan belakang dalam dua produk, tetapi satu masih didistribusikan dalam versi trojanized - ironisnya, game ini disebut Infestation, yang dirilis oleh perusahaan Thailand Extreme Extreme.  Kami telah mencoba menghubungi pengembang sejak awal Februari, tetapi sejauh ini tidak berhasil. <br><br>  Kami akan menganalisis bagaimana muatan berbahaya diperkenalkan, dan kemudian mempertimbangkan pintu belakang secara detail. <br><br><h4>  Implementasi Muatan </h4> <br>  Kode payload berjalan selama eksekusi executable trojanized.  Segera setelah titik masuk PE, panggilan inisialisasi Runtime C standar ( <code>__scrt_common_main_seh</code> pada gambar di bawah) dicegat untuk meluncurkan muatan berbahaya sebelum hal lain (Gambar 2).  Ini mungkin menunjukkan bahwa penyerang mengubah konfigurasi perakitan, dan bukan kode sumber itu sendiri. <br><br><img src="https://habrastorage.org/webt/9x/5t/_z/9x5t_zr__dskzxeisuvum2z4at4.png"><br><br>  <i>Gambar 1. Net entry point ke file yang dapat dieksekusi</i> <br><br><img src="https://habrastorage.org/webt/rc/ow/c5/rcowc5sx8hx2mi0our57vhagmea.png"><br><br>  <i>Gambar 2. Titik masuk dari executable yang dikompromikan</i> <br><br>  Kode ditambahkan ke dekripsi yang dapat dieksekusi dan meluncurkan pintu belakang dalam RAM sebelum melanjutkan eksekusi normal dari kode inisialisasi C Runtime dan kode aplikasi host berikutnya.  Payload bawaan memiliki struktur khusus, yang ditunjukkan pada gambar di bawah ini, yang ditafsirkan oleh kode dekompresi yang ditambahkan. <br><br><img src="https://habrastorage.org/webt/uh/cc/_l/uhcc_l8yhoevfiwi71sfvm0fqrw.png"><br><br>  <i>Gambar 3. Struktur payload tertanam</i> <br><br>  Ini berisi kunci RC4 (XOR terenkripsi dengan 0x37), yang digunakan untuk mendekripsi nama file dan file DLL tertanam. <br><br><h2>  Muatan Berbahaya </h2><br>  Muatan berbahaya yang sebenarnya hanya berisi 17 KB kode dan data. <br><br><h4>  Konfigurasi </h4><br>  Data konfigurasi yang ditunjukkan pada gambar di bawah ini adalah daftar garis yang dipisahkan oleh spasi. <br><br><img src="https://habrastorage.org/webt/07/xa/fk/07xafkyspktcwa2ladwz-yqx1aq.png"><br><br>  <i>Gambar 4. Data konfigurasi payload</i> <br><br>  Konfigurasi terdiri dari empat bidang: <br><br><ol><li>  URL dari server C&amp;C yang mengelola. </li><li>  Variabel (t) yang digunakan untuk menentukan batas waktu dalam milidetik sebelum melanjutkan.  Waktu tunggu dipilih dalam kisaran dari 2/3 hingga 5/3 t secara acak. </li><li>  Baris mengidentifikasi kampanye. </li><li>  Daftar nama file yang dapat dieksekusi, dipisahkan oleh tanda titik koma.  Jika salah satu dari mereka berfungsi, pintu belakang menghentikan eksekusi. </li></ol><br>  Kami telah mengidentifikasi lima versi muatan: <br><br><img src="https://habrastorage.org/webt/9h/ni/mi/9hnimigerpgsvcibhsz67pzmtdy.png"><br><br>  Dalam tiga opsi pertama, kode tidak dikompilasi ulang, tetapi data konfigurasi diedit dalam file DLL itu sendiri.  Sisa konten adalah salinan byte. <br><br><h4>  Infrastruktur K&amp;C </h4><br>  Nama domain dipilih sedemikian rupa sehingga menyerupai situs pengembang aplikasi yang disusupi.  Domain tingkat atas dikonfigurasikan untuk mengalihkan ke situs resmi yang sesuai menggunakan layanan Namecheap, sementara subdomain menunjukkan server C&amp;C berbahaya. <br><br><img src="https://habrastorage.org/webt/es/hi/ha/eshihaiupa4riqbqhjva7x3zy0u.png"><br><br>  Pada saat penulisan ini, tidak ada domain yang tersedia, C &amp; C-server tidak merespons. <br><br><h4>  Laporan studi </h4><br>  ID bot dihasilkan dari alamat MAC mesin.  Backdoor mentransmisikan informasi mesin ke server C&amp;C, termasuk nama pengguna, nama komputer, versi Windows dan bahasa sistem, dan kemudian menunggu perintah.  Data dienkripsi dengan XOR menggunakan kunci " <code>*&amp;b0i0rong2Y7un1</code> " dan dikodekan dengan base64.  Data yang diterima dari server C&amp;C dienkripsi menggunakan kunci yang sama. <br><br><h4>  Tim </h4><br>  Backdoor sederhana hanya mendukung empat tim yang dapat digunakan oleh penyerang: <br><br>  - <code>DownUrlFile</code> <br>  - <code>DownRunUrlFile</code> <br>  - <code>RunUrlBinInMem</code> <br>  - <code>UnInstall</code> <br><br>  Nama-nama tim berbicara sendiri.  Mereka memungkinkan penyerang untuk menjalankan executable tambahan dari URL yang diberikan. <br><br>  Mungkin perintah terakhir kurang jelas.  <code>UnInstall</code> tidak menghapus malware dari sistem.  Pada akhirnya, itu tertanam dalam file yang dapat dieksekusi yang sah yang masih akan berjalan.  Alih-alih menghapus sesuatu, perintah menonaktifkan kode jahat dengan menetapkan nilai ke 1 untuk kunci registri: <br><br> <code>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ImageFlag</code> <br> <br>  Setelah memulai payload, nilai dari registri diminta dan, jika ditentukan, eksekusi dibatalkan.  Mungkin penyerang berusaha mengurangi beban di server C&amp;C mereka dengan menghindari panggilan balik dari korban yang tidak tertarik. <br><br><h2>  Tahap kedua </h2><br>  Menurut telemetri, salah satu muatan tahap kedua yang dikirim kepada korban adalah Win64 / Winnti.BN.  Sejauh yang kami tahu, dropper malware ini diunduh melalui <code>api.goallbandungtravel[.]com</code> dari <code>api.goallbandungtravel[.]com</code> .  Kami melihat bahwa itu diinstal sebagai layanan Windows dan sebagai DLL di <code>C:\Windows\System32</code> menggunakan nama file berikut: <br><br>  - cscsrv.dll <br>  - dwmsvc.dll <br>  - iassrv.dll <br>  - mprsvc.dll <br>  - nlasrv.dll <br>  - powfsvc.dll <br>  - racsvc.dll <br>  - slcsvc.dll <br>  - snmpsvc.dll <br>  - sspisvc.dll <br><br>  Sampel yang kami analisis cukup besar - sekitar 60 MB.  Namun, ini hanya visibilitas, karena ukuran aktual atau file PE adalah 63 hingga 72 KB, tergantung pada versinya.  Banyak yang bersih hanya ditambahkan ke file berbahaya.  Ini kemungkinan dilakukan oleh komponen yang me-reset dan menginstal layanan jahat. <br><br>  Setelah memulai layanan, ia menambahkan ekstensi <code>.mui</code> ke <code>.mui</code> DLL dan mendekripsi menggunakan RC5.  File MUI yang didekripsi berisi kode posisi-independen dengan offset 0. Kunci RC5 diperoleh dari nomor seri hard disk dan baris “ <code>f@Ukd!rCto R$.</code>  "  Kami tidak bisa mendapatkan file MUI atau kode yang menginstalnya terlebih dahulu.  Dengan demikian, tujuan pasti dari layanan jahat tidak diketahui oleh kami. <br><br>  Versi malware terbaru mencakup mekanisme pembaruan otomatis menggunakan server C&amp;C <code>http://checkin.travelsanignacio[.]com</code> .  Server ini menyajikan versi terbaru dari file MUI yang dienkripsi dengan kunci statis RC5.  Dalam penelitian kami, server C&amp;C ini tidak merespons. <br><br><h2>  Tujuan </h2><br>  Mari kita mulai dengan mereka yang kampanye <b>tidak</b> ditargetkan secara spesifik.  Di awal payload, malware memeriksa apakah bahasa sistemnya adalah Rusia atau Cina (lihat gambar di bawah).  Jika jawabannya ya, program berhenti bekerja.  Tidak mungkin untuk mengatasi pengecualian ini - penyerang secara fundamental tidak tertarik pada komputer dengan pengaturan bahasa ini. <br><br><img src="https://habrastorage.org/webt/dg/p8/tg/dgp8tgq_fhjjewczstuavcsgo34.png"><br><br>  <i>Gambar 5. Memeriksa bahasa sebelum meluncurkan payload</i> <br><br><h4>  Statistik distribusi </h4><br>  Menurut telemetri, sebagian besar infeksi terjadi di Asia, terutama Thailand.  Mengingat popularitas aplikasi yang dikompromikan, yang masih didistribusikan oleh pengembang, tidak mengherankan jika jumlah korban mencapai puluhan dan ratusan ribu. <br><br><img src="https://habrastorage.org/webt/65/pl/fn/65plfnqbnt3lm1rvbmtt60vwo_c.png"><br><br><h2>  Kesimpulan </h2><br>  Serangan rantai pasokan sulit dideteksi di sisi pengguna.  Tidak mungkin menganalisis semua perangkat lunak yang berjalan, serta semua pembaruan yang disarankan.  Secara default, pengguna mempercayai pengembang dan menganggap bahwa file mereka tidak mengandung kode berbahaya.  Ini mungkin mengapa beberapa cybergroup menargetkan serangan terhadap vendor perangkat lunak - kompromi akan memungkinkan pembuatan botnet, yang ukurannya sebanding dengan popularitas perangkat lunak trojan.  Taktik ini memiliki kelemahan - ketika skema terungkap, penyerang akan kehilangan kendali atas botnet, dan pengguna akan dapat membersihkan sistem dengan menginstal pembaruan berikutnya. <br><br>  Motif dari cybergroup Winnti saat ini tidak diketahui.  Mungkin penyerang mencari keuntungan finansial atau berencana menggunakan botnet sebagai bagian dari operasi yang lebih besar. <br><br>  <i>Produk ESET mendeteksi ancaman sebagai Win32 / HackedApp.Winnti.A, Win32 / HackedApp.Winnti.B, payload sebagai Win32 / Winnti.AG, tahap kedua sebagai Win64 / Winnti.BN.</i> <i><br><br></i>  <i>Indikator kompromi tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id443416/">https://habr.com/ru/post/id443416/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id443404/index.html">Tujuan Baru NASA untuk Pencarian Peradaban Luar Angkasa: Tanda-Tanda Teknologi</a></li>
<li><a href="../id443406/index.html">20 kesalahan teratas saat bekerja dengan multithreading di C ++ dan cara untuk menghindarinya</a></li>
<li><a href="../id443408/index.html">Foton, kuanta, dan keadaan Fock: manipulasi tingkat kuantum dengan resonator frekuensi radio</a></li>
<li><a href="../id443412/index.html">Mengapa programmer terus menggunakan Java verbose, meskipun ada Python ringkas</a></li>
<li><a href="../id443414/index.html">Plang: ketika breakpoints tidak cukup</a></li>
<li><a href="../id443418/index.html">Metode Pengujian Perangkat Lunak</a></li>
<li><a href="../id443422/index.html">Penyimpanan data fleksibel di MySQL (JSON)</a></li>
<li><a href="../id443424/index.html">Menulis ulang test case untuk junior frontend ke TypeScript dan react-hooks</a></li>
<li><a href="../id443426/index.html">Tanda hitam - bagaimana OpenShift melindungi terhadap kerentanan kontainer dengan SELinux</a></li>
<li><a href="../id443428/index.html">Palmer Lucky, "bapak" dari Oculus Rift, sedang mengembangkan sistem medan virtual untuk Pentagon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>