<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¥ ğŸ§›ğŸ¼ ğŸ‘©ğŸ»â€ğŸ”¬ Natas Web. Passage dari platform KKP bertujuan untuk mengeksploitasi kerentanan Web. Bagian 4 ğŸŒ” ğŸ–ğŸ¼ â›³ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, kita akan membahas operasi beberapa identitas WEB menggunakan wargame Natas sebagai contoh. Setiap level memiliki akses ke kata sand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Natas Web. Passage dari platform KKP bertujuan untuk mengeksploitasi kerentanan Web. Bagian 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464863/"><img src="https://habrastorage.org/webt/_-/zf/_u/_-zf_uvvs6ypsybfrqslsnqwx8k.png" alt="gambar"><br><br>  Pada artikel ini, kita akan membahas operasi beberapa identitas WEB menggunakan wargame <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Natas</a> sebagai contoh.  Setiap level memiliki akses ke kata sandi level selanjutnya.  Semua kata sandi juga disimpan di file / etc / natas_webpass /.  Sebagai contoh, kata sandi untuk natas5 disimpan dalam file / etc / natas_webpass / natas5 dan hanya-baca untuk pengguna natas4 dan natas5. <br><br>  Bagian sebelumnya: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 2</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 3</a> . <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Informasi Organisasi</b> <div class="spoiler_text">  Terutama bagi mereka yang ingin mempelajari sesuatu yang baru dan berkembang di bidang informasi dan keamanan komputer, saya akan menulis dan berbicara tentang kategori berikut: <br><br><ul><li>  PWN; </li><li>  kriptografi (Crypto); </li><li>  teknologi jaringan (Jaringan); </li><li>  membalikkan (Reverse Engineering); </li><li>  steganografi (Stegano); </li><li>  pencarian dan eksploitasi kerentanan WEB. </li></ul><br>  Selain itu, saya akan membagikan pengalaman saya dalam forensik komputer, analisis malware dan firmware, serangan pada jaringan nirkabel dan jaringan area lokal, melakukan pentest dan menulis eksploitasi. <br><cut></cut><br>  Agar Anda dapat mengetahui tentang artikel baru, perangkat lunak, dan informasi lainnya, saya membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">grup untuk membahas masalah apa pun</a> di bidang ICD.  Juga, saya pribadi akan mempertimbangkan permintaan pribadi Anda, pertanyaan, saran dan rekomendasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">secara pribadi dan akan menjawab semua orang</a> . <br><cut></cut><br>  Semua informasi disediakan hanya untuk tujuan pendidikan.  Penulis dokumen ini tidak bertanggung jawab atas kerusakan yang disebabkan seseorang sebagai akibat dari menggunakan pengetahuan dan metode yang diperoleh sebagai hasil dari mempelajari dokumen ini. <br></div></div><br><h2>  level 22 </h2><br>  Setelah menganalisis kode sumber, menjadi jelas bahwa kita akan melihat kata sandi jika parameter GET revelio tidak kosong. <br><br><img src="https://habrastorage.org/webt/qt/h2/7d/qth27dcdtjul75hszlw2cvcyzsg.png" alt="gambar"><br><br>  Tetapi pada pemeriksaan pertama, jika sesi admin tidak diinstal, kami diarahkan ke halaman ini tanpa parameter. <br><br><img src="https://habrastorage.org/webt/5r/u3/0h/5ru30hiuygieq26yxphung51ulm.png" alt="gambar"><br><br>  Anda hanya perlu menggunakan agen web bukan browser, misalnya ikal. <br><br><img src="https://habrastorage.org/webt/et/fm/6o/etfm6oitmynlnoijxpllonqov4u.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/d5/tz/p0/d5tzp0aslqz9xhuweeitrt-e3tk.png" alt="gambar"><br><br>  Kami mengambil kata sandi. <br><br><h2>  level 23 </h2><br>  Kami menganalisis kode sumber.  Fungsi strstr (s1, s2) mengembalikan substring dari s1 yang dimulai dengan s2.  Juga php secara otomatis melempar tipe.  Artinya, ketika membandingkannya, itu akan mengarahkan string ke angka dan akan membuang karakter tambahan. <br><br><img src="https://habrastorage.org/webt/gj/yq/4j/gjyq4jlb7vmcj1oxrxwpwk6tc3s.png" alt="gambar"><br><br>  String "11inoveyou" akan cocok untuk kondisi kita.  Pada pemeriksaan pertama, ia mengembalikan "iloveyou", yaitu, Benar.  Pada pemeriksaan kedua, 11&gt; 10, mis. Benar. <br><br><img src="https://habrastorage.org/webt/e_/j1/jo/e_j1jo7sj3k6nblm-prlhwzrlig.png" alt="gambar"><br><br><h2>  level 24 </h2><br>  Level ini juga mengandung kesalahan logis.  Kondisi ini tetap benar jika strcmp mengembalikan FALSE.  Tetapi strcmp akan mengembalikan FALSE meskipun terjadi kesalahan. <br><br><img src="https://habrastorage.org/webt/dl/en/md/dlenmdk6mgztpnckq_uy_89ks90.png" alt="gambar"><br><br>  Meskipun php membuat tipe secara otomatis, php tidak dapat memberikan array ke string.  Untuk melakukan ini, buka kode sumber halaman dan ubah nama bidang dari "passwd" menjadi "passwd []". <br><br><img src="https://habrastorage.org/webt/l3/gg/e0/l3gge0cb1bsjagoz59mc9rkrhbi.png" alt="gambar"><br><br>  Kami mengirim jalur apa pun. <br><br><img src="https://habrastorage.org/webt/pu/yd/py/puydpyhz83who8ph9cynamtt_qm.png" alt="gambar"><br><br>  Kami mengambil kata sandi. <br><br><h2>  level 25 </h2><br>  Saat menganalisis kode sumber, yang paling menarik adalah fungsi logRequest (), yang memproses bidang yang dapat dikontrol pengguna.  Ini adalah header HTTP dari User_Agent dan cookie session_id. <br><br><img src="https://habrastorage.org/webt/5w/lr/cs/5wlrcsv-hltqircjccutifmbzfs.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/z9/gj/wc/z9gjwc_ttjkrp6xtawcgbdgtw0m.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/hp/u6/sq/hpu6sqmspwgypwixjz5vzzyappw.png" alt="gambar"><br><br>  Perlu mempertimbangkan bahwa semua urutan "../" dihapus dari string, tetapi ini dapat dilakukan dengan cara: "... /. /" =&gt; "../". <br><br>  Ide solusi: Karena jalur untuk merekam log tergantung pada session_id, yang dapat kita kontrol, dan dengan memilih bahasa tampilan, jalur pada server dipilih - karena LFI kita dapat membaca file log. <br><br><img src="https://habrastorage.org/webt/lk/dr/te/lkdrtevuv7sbaeelyf1vstsagiq.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/bu/cx/pb/bucxpbzzxagwpkvvnamvk_sap_g.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/8y/dr/u5/8ydru5lvj9cunuxuge0jmz9zpv8.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/zm/be/qk/zmbeqk2m5ssbh9rljmlyzr7zjo8.png" alt="gambar"><br><br>  Sekarang tinggal menulis kata sandi dari /etc/natas_webpass / natas26 ke dalam file log kita.  Karena Agen Web kami pertama kali direkam dan kemudian keluar dari file, kami akan menambahkan kode php ke bidang ini. <br><br><img src="https://habrastorage.org/webt/bp/um/qy/bpumqyyp-jptpd5aqnbv2sooizs.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/cy/ce/a4/cycea4udcst1dildxt50psa9lg4.png" alt="gambar"><br><br>  Kami mendapatkan kata sandi. <br><br><h2>  level 26 </h2><br>  Dalam contoh ini, ada kerentanan yang sangat serius - deserialisasi objek tanpa filter.  Fungsi unserialize () mengambil satu variabel serial dan mengubahnya kembali menjadi objek PHP. <br><br><img src="https://habrastorage.org/webt/45/aq/2t/45aq2tsecnjzewtlbpybi--vcca.png" alt="gambar"><br><br>  Nilai yang dikonversi dikembalikan, yang bisa berupa integer, float, string, array atau objek.  Yaitu  Anda dapat menjalankan kode apa pun.  Kelas Logger, ketika dibuat, menulis informasi tertentu ke file. <br><br><img src="https://habrastorage.org/webt/6r/bb/or/6rbborrkvdmwnvhdrywxmrhe0yo.png" alt="gambar"><br><br>  Idenya adalah sebagai berikut: <br><br><ol><li>  Tulis ulang kelas Logger, di mana alih-alih salah satu pesan, kode php akan berisi yang akan menghasilkan kata sandi. </li><li>  Encode di Base64. </li><li>  Rekatkan dalam cookie. </li><li>  Akses file log. </li><li>  Singkirkan kata sandi. </li></ol><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logger</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $logFile; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $initMsg; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $exitMsg; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($file)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;initMsg=<span class="hljs-string"><span class="hljs-string">"&lt;? passthru('cat /etc/natas_webpass/natas27'); ?&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;exitMsg=<span class="hljs-string"><span class="hljs-string">"&lt;? passthru('cat /etc/natas_webpass/natas27'); ?&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;logFile = <span class="hljs-string"><span class="hljs-string">"img/phpobjinj.php"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($msg)</span></span></span></span>{ ; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__destruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ ; } } $obj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Logger(<span class="hljs-string"><span class="hljs-string">"obj"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> urlencode(base64_encode(serialize($obj))); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/_m/ew/2n/_mew2nh3ozpfmk5cnjxltfn8gvk.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/xh/fc/ms/xhfcmsciwcv2bsirfgm-mol0-re.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/mr/w2/qe/mrw2qegouxyawwhdfme9cgzwhcs.png" alt="gambar"><br><br>  Kami mendapatkan kata sandi. <br><br><h2>  level 27 </h2><br>  Layanan ini menyediakan data pengguna.  Tetapi jika pengguna tidak ada, ia membuatnya dengan nama pengguna dan kata sandi yang ditentukan. <br><br><img src="https://habrastorage.org/webt/qy/w1/nt/qyw1nthdmxbnzi4bnrshl-4rtki.png" alt="gambar"><br><br>  Masalahnya adalah bahwa setelah membuat pengguna, layanan tidak memeriksa kata sandi saat login.  Pada saat yang sama, hanya 64 karakter pertama dari login dan kata sandi setelah penyaringan masuk ke dalam basis data.  Tidak hanya itu, kami tahu nama pengguna: natas28. <br><br><img src="https://habrastorage.org/webt/k1/ie/6e/k1ie6ecolxgi9hamjihcaxy7vkg.png" alt="gambar"><br><br>  Buat pengguna dengan kata sandi dan nama kosong: "natas28_60-spasi_ any-character".  (Jadi, selama verifikasi, tidak akan ada kecocokan dengan pengguna natas28, tetapi selama pembuatan itu akan disaring dan ditambahkan ke database. Artinya, kata sandi tidak akan diperiksa pada panggilan berikutnya). <br><br><img src="https://habrastorage.org/webt/me/nv/aj/menvaj0iqxtzablifx2w2ozfddw.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/kf/hf/xg/kfhfxgjx3vpuz7gdvyfc2ncxrge.png" alt="gambar"><br><br>  Kami menggunakan nama natas28 dan kata sandi kosong.  Kami mendapatkan data pengguna natas28. <br><br>  Untuk dilanjutkan.  Anda dapat bergabung dengan kami di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id464863/">https://habr.com/ru/post/id464863/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id464849/index.html">Penggunaan R untuk tugas utilitas</a></li>
<li><a href="../id464853/index.html">Tempat mendengarkan peralatan audio: budaya lembaga tema untuk penggemar audio - dari Jepang ke Rusia</a></li>
<li><a href="../id464857/index.html">Multitasking Microkernel OS Development - Scheduler</a></li>
<li><a href="../id464859/index.html">Mengontrol beberapa motor stepper Nema 17 secara bersamaan atau NemaStepper</a></li>
<li><a href="../id464861/index.html">Referensi dan Panduan Scrum Mini</a></li>
<li><a href="../id464865/index.html">Telegram sebagai gudang data untuk proyek-proyek TI</a></li>
<li><a href="../id464867/index.html">"Penghapus"</a></li>
<li><a href="../id464869/index.html">Kisah monolit. Bagian 2</a></li>
<li><a href="../id464871/index.html">15 buku pembelajaran mesin untuk pemula</a></li>
<li><a href="../id464873/index.html">Mengapa melakukan operasi dengan mata uang di bursa: 3 skenario praktis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>