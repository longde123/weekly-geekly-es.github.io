<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕥 🚈 😮 Développement d'une banque d'alimentation pour ordinateur portable. De la mise en page au produit fini. Deuxième partie 👰🏾 🤽🏻 🙅🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la dernière partie de l'article sur le développement de PowerBank pour un ordinateur portable, nous nous sommes installés sur une configuration f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Développement d'une banque d'alimentation pour ordinateur portable. De la mise en page au produit fini. Deuxième partie</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/386899/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la dernière partie de l'article sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">développement de PowerBank pour un ordinateur portable,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous nous sommes installés sur une configuration fabriquée, une efficacité mesurée et une compréhension de ce qu'il faut faire ensuite. </font><font style="vertical-align: inherit;">Et puis il a fallu faire revivre le morceau de fer. </font><font style="vertical-align: inherit;">Par conséquent, je présente à votre attention la deuxième partie: la mise en page du logiciel.</font></font><br>
<img src="https://habrastorage.org/files/368/fcc/f59/368fccf5979c4932a392b911139c892b.png"><br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La rupture entre les pièces s'est avérée assez importante - toutes les forces ont été exercées sur le projet d'une batterie externe à charge rapide, qui rassemble désormais un soutien sur le </font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">boomstarter</font></a></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">
Nous allons continuer. </font><font style="vertical-align: inherit;">
Afin de comprendre quels microcircuits nous devrons programmer, nous allons regarder le schéma de principe de la disposition. </font><font style="vertical-align: inherit;">
À partir de là, il est clair que nous devrons écrire un logiciel pour le contrôle MK (STM32F042), ainsi que configurer le système de contrôle de batterie Li-ion + chargeur (BQ40Z60). J'ai commencé par la seconde, car je considérais cette partie comme la plus difficile. </font><font style="vertical-align: inherit;">
Pour programmer le contrôleur BQ40Z60, nous avons besoin de: </font><font style="vertical-align: inherit;">
 - L'adaptateur EV2400 et EV2300 ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">prêt à l'</font></a><font style="vertical-align: inherit;"> emploi ou fait maison). J'ai quitté l'EV2300 de projets passés, je l'ai donc utilisé. </font><font style="vertical-align: inherit;">
 - Programme</font></font><b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a></b><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<img src="https://habrastorage.org/files/87a/3e9/68e/87a3e968e1dc4112a6e96f5375e7b2f8.png"><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Battery Management Studio (bqStudio)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'adaptateur est connecté via SMBus, pour la connexion j'ai laissé des points de soudure sur les lignes SMBD et SMBC. (Pas la solution la plus pratique - alors j'ai réalisé que je devais installer le connecteur). </font></font><br>
<img src="https://habrastorage.org/files/90a/c7d/ddf/90ac7dddfa184d8498d418b786c853fa.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir dansé avec un tambourin, le BQ40Z60 a opté pour Battery Management Studio. La raison en était le mode veille dans lequel le contrôleur entre lorsqu'il n'y a pas de pull-up sur le bus SMBus et aucun accès à celui-ci. Il se réveille lors de la connexion de la mémoire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous allons régler directement la puce BQ40Z60. Dire qu'il a de nombreux registres, c'est ne rien dire. Un million de réglages. La configuration étant un processus long et compliqué (un article séparé est requis pour la description), je vais la décrire brièvement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après le démarrage, la fenêtre principale de Battery Management Studio apparaît.</font></font><br>
<img src="https://habrastorage.org/files/8c5/bb5/610/8c5bb561090943eebcb578c4b6891727.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'onglet Mémoire de données contient un grand nombre de champs dans lesquels nous devons entrer les paramètres de la batterie et les modes de fonctionnement du contrôleur. </font></font><br>
<img src="https://habrastorage.org/files/d9a/b9a/c2a/d9ab9ac2ac5140debab0ccb00a154b92.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'onglet Chimie, vous pouvez essayer de trouver des étalonnages prêts à l'emploi pour les cellules utilisées. </font></font><br>
<img src="https://habrastorage.org/files/fad/140/d49/fad140d49cbd4e4d8837098da6af29f1.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mon YOKU LP 5558115 3500mAh, il n'y avait pas d'étalonnages prêts à l'emploi (au fait, les étalonnages sont constamment </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">jour</font></a><font style="vertical-align: inherit;"> ). Trouvé similaire YOKU LP 656193 4000mAh. Ayant réalisé que je ne sais toujours rien des packages disponibles, j'ai choisi ce profil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, dans l'onglet Mémoire de données, j'ai configuré: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calibration:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> valeurs de calibration pour les voltmètres (cellules, batteries et un adaptateur externe), résistance du capteur de courant, valeurs de calibration pour le capteur de température. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réglages:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inclusion de protections, thermistances, LED, mode veille, configuration de la batterie. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protections:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> réglage des seuils de protection (tension, temps, température), réglage des seuils de tension de l'adaptateur externe. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Échec permanent:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> définition de seuils pour les erreurs irréversibles (de sorte que le fonctionnement de la batterie n'est pas possible). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algorithme de charge avancé:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> réglage du chargeur (courants, tensions pour différentes plages de température, signe de fin de charge, équilibrage). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gas Gauging:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> réglage de l'unité pour déterminer le niveau de charge (capacité de la plaque signalétique / tension de la cellule, résistance du fil, statistiques). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puissance:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> réglage des modes de fonctionnement du contrôleur. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statut PF:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statut du bit d'état d'échec permanent </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Données système:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> champs pour les données du fabricant. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration SBS:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> définition des seuils de déclenchement pour le déclencheur d'alarme, informations de base sur la batterie (numéro de série, date de production, fabricant, nom, composition chimique). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Support LED:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> réglage du mode du voyant LED. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Black Box:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> boîte noire (historique des modifications des bits d'état de protection). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durée de vie:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> statistiques de la batterie. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ra Table: un</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tableau des résistances internes des cellules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant le processus d'installation, je n'ai pas changé tous les champs, mais cela a suffi pour commencer. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette partie du circuit, il n'y avait qu'un seul montant matériel connecté à la sortie du microcircuit 21-AFEFUSE. C'est arrivé comme ça:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je déchirais le circuit de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">carte de débogage, à l'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> exception du microcircuit de protection secondaire et du fusible grillé. Le BQ40Z60 possède 21 broches AFEFUSE pour brûler un fusible (comme je le pensais). J'ai donc regardé la 5ème page de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fiche technique</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> du </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">BQ40Z60.</font></a><font style="vertical-align: inherit;"> J'ai vu le </font></font><br>
<img src="https://habrastorage.org/files/f1c/964/667/f1c964667aa042cdae2a1d63122e9b67.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
type de sortie Output </font><font style="vertical-align: inherit;">dans le tableau </font><font style="vertical-align: inherit;">et, en toute conscience, </font><font style="vertical-align: inherit;">je l'ai </font><font style="vertical-align: inherit;">laissé suspendu dans les airs. Les problèmes sont survenus après avoir soudé la carte: j'ai trié tous les paramètres (et à l'époque, il y avait beaucoup de doutes), mais cela n'a pas fonctionné - les transistors de charge et de décharge ne se sont pas allumés. Après 2 jours de doute / réflexion / essais et erreurs, j'ai remarqué que le bit FUSE_EN n'était pas défini et </font><font style="vertical-align: inherit;">j'ai </font><font style="vertical-align: inherit;">décidé de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«demander aux gens»</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et quand j'ai posté une question, une idée m'est venue</font></font><br>
<img src="https://habrastorage.org/files/13b/a37/caf/13ba37caf5564b55896121eb247369e0.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En regardant le circuit imprimé de la carte de débogage, j'ai suggéré que la broche AFEFUSE peut également être une entrée, ce qui a été confirmé par la section 9.3.2.4 p.24, qui dit que si la broche n'est pas utilisée, elle doit être connectée à la masse. Je l'ai fait avec des pincettes et ça a marché. Après 5 minutes, ils m'ont répondu sur e2e.com - la réponse est claire et correcte, j'ai exprimé mon "phi" sur l'erreur dans le tableau de sortie - ils ont promis de le corriger dans les futures versions de la documentation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mettre fin aux réglages du contrôleur, j'ai effectué 2 cycles d'entraînement charge / décharge complète + relaxation (au total 30 heures). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons maintenant à la programmation du STM32F042. Au stade fictif, ce processeur ne demandait pas grand-chose: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Contrôler le convertisseur de tension, traiter les boutons.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Aller le plus loin possible en veille pour ne pas décharger la batterie. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Lisez les principaux paramètres de la batterie à partir du contrôleur (tension, courant, niveau de charge, température, état actuel, nombre de cycles, temps de charge / décharge complète) et envoyez-les au PC via USART (puisque le convertisseur CP2102 était déjà sur la carte). Bien que le processeur contienne USB à bord, je ne l'ai pas utilisé dans la mise en page, et une mise en page a été faite pour 051 MK, mais je n'ai pas pu l'acheter.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le contrôle du convertisseur a été réduit à deux conclusions (allumage et mode de fonctionnement), alimentant le PWM (avec un filtrage RC ultérieur) à la sortie du paramètre de fréquence de conversion de la puce LTC3780 (en conséquence, réglez la fréquence à un maximum de 400 kHz) et l'entrée de surveillance du signal PowerGood. Mais même ici, j'ai réussi à monter sur le râteau. Le bug flottait et s'est produit lorsque Power Bank s'est allongé pendant une longue période, ce qui s'explique par le fait qu'il ne s'est tout simplement pas allumé. Le problème était que j'avais d'abord activé l'interruption du signal PowerGood du LTC3780, puis allumé la puce elle-même (EN). Il s'est avéré que l'interruption s'est déclenchée avant même le démarrage du convertisseur et l'a éteint. Réorganisé les événements par endroits et ajouté un retard - le problème a disparu. Sinon, cette fonctionnalité était facile.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a été décidé de créer une interface utilisateur avec 1 bouton et 5 (6) LED (bien qu'il y ait 2 boutons et 10 LED sur le tableau de configuration). Il fonctionne comme suit: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appareil est éteint -&gt; appui court (&lt;500 ms) - animation du niveau de charge sur 4 LED. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appareil est éteint -&gt; appui long (&gt; 500 ms) - allumez l'appareil (la 5ème LED s'allume). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appareil est éteint -&gt; connexion de la mémoire -&gt; animation du niveau de charge sur 4 LED jusqu'à la fin du processus de charge. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'appareil est allumé -&gt; appui court - animation du niveau de charge sur 4 LED. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Appareil allumé -&gt; appui long - éteignez l'appareil. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Appareil éteint -&gt; consommation de courant inférieure à 50 mA pendant plus de 3 min. - éteignez l'appareil.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cela a permis de supprimer 27 éléments de l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'avais déjà l'expérience de l'implémentation des modes de veille sur STM32F0xx, donc je ne comptais pas sur un gros rake ici. Pour optimiser la consommation, j'ai d'abord remplacé le LDO 3.3V par mcp1703 par un faible courant de ma propre consommation (il fallait ne pas arracher du débogage, mais l'installer tout de suite). Taille, prix, consommation, kit carrosserie - tous moins que le LP2951. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merci à </font></font></b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardegor d'</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avoir édité LDO pour Li-ion 4. Le Mcp1703 ne peut pas être utilisé en raison d'une faible tension d'entrée. J'ai utilisé LiFePo4 pour la chimie - il n'y a pas un tel problème. Faites attention!!!</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
-Lorsque l'appareil est éteint, le MK est en mode STANDBY et ne répond qu'à la pression d'un bouton ou à la connexion de la mémoire. La consommation dans ce mode est de 108 μA (100 d'entre eux consomment du BQ40Z60). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Lorsque l'appareil est allumé, le processeur la plupart du temps (à l'exception des moments d'indication et d'interrogation du BQ40Z60) est en mode STOP avec une consommation de 1,5 mA (1 mA est une LED). Au moment de l'interrogation et de l'indication, la consommation de courant varie de 4,5 à 9 mA. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
- Lorsqu'un USB MK est connecté en mode RUN 48 MHz, la consommation est de 15 mA. À l'avenir, je vais alimenter le MK dans ce mode à partir de l'USB.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le plus gros problème potentiel était l'enquête BQ40Z60. Je n'ai pas travaillé avec SMBus et jusqu'à ce que le dernier espère que SMBus est I2C 1v1 (c'est en partie parce que le niveau physique est le même pour eux), mais il s'est avéré que le niveau du canal est très différent et cela a créé un certain nombre de difficultés. Ici, je ne décrirai pas les différences entre SMBus et I2C, mais je fournirai un lien vers un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plutôt compétent </font><font style="vertical-align: inherit;">. Au stade de la mise en page, je ne me suis pas impliqué dans la lutte contre SMBus (en passant, en tant que programmeur, je suis beaucoup plus faible qu'un concepteur de circuits) et comme les commandes d'envoi et de réception d'octets dans SMBus et I2C étaient complètement identiques, je les ai utilisées uniquement. En conséquence, j'ai lu SOC, SOH, Current, CellVolt, TimeToFull, TimeToEmpty de BQ40Z60. En fonction des valeurs des registres, le mode de fonctionnement a changé (des avertissements ont été émis, un arrêt s'est produit).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, du côté PC, bien sûr, un programme était nécessaire pour afficher les données lues dans la batterie sous une forme pratique. Comme je ne pouvais utiliser les GUI que dans Borland C ++ Builder et que je l'ai fait pendant longtemps, j'ai demandé au programmeur de dessiner un débogage simple pour moi. Pour un fouet rapide, voici ce qui est sorti:</font></font><br>
<img src="https://habrastorage.org/files/62e/18d/c55/62e18dc550c04870a8d51acb5dda6691.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est tout le travail qui a été réalisé lors de la mise en page. </font><font style="vertical-align: inherit;">Plus loin dans les plans (et puisque je décris les opérations déjà terminées, une partie du travail a déjà été fait), le transfert des spécifications techniques au concepteur pour le développement / fabrication du package PowerBank, correction d'erreur / révision du circuit, altération de la carte pour le boîtier, révision du logiciel. </font><font style="vertical-align: inherit;">Après cela, l'appareil sera similaire à un produit et, une fois terminé, deviendra un produit au sens littéral du terme. </font><font style="vertical-align: inherit;">Dans les parties suivantes de l'article, nous examinerons les étapes et les principales difficultés de la transition d'une mise en page à un produit fini, travaillerons sur l'emballage, considérerons les coûts des différentes solutions et opérations, l'optimisation, et verrons également le résultat final.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr386899/">https://habr.com/ru/post/fr386899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr386883/index.html">Comment nous avons effacé le bord de la réalité</a></li>
<li><a href="../fr386891/index.html">Le clavier UHK est encore meilleur et plus confortable: maintenant avec des modules en option et un repose-mains ergonomique</a></li>
<li><a href="../fr386893/index.html">Une nouvelle technologie de processus réduit le coût du graphène de 100 fois</a></li>
<li><a href="../fr386895/index.html">Pré-réalité - belle, sécurité - rentable</a></li>
<li><a href="../fr386897/index.html">Désherber les mauvaises herbes? Rien de plus simple, chargez-le à Bosch</a></li>
<li><a href="../fr386901/index.html">Énergie naturelle</a></li>
<li><a href="../fr386903/index.html">Le créateur du robot Stormbuddy pour WOW blâme Blizzard pour avoir volé le code source</a></li>
<li><a href="../fr386905/index.html">L'Australie interdit le stockage de fichiers pour l'impression 3D d'armes à feu</a></li>
<li><a href="../fr386911/index.html">Sony Xperia Z5 critique</a></li>
<li><a href="../fr386915/index.html">La différence de temps de réveil entre les jours de la semaine et les week-ends est associée à des problèmes de santé</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>