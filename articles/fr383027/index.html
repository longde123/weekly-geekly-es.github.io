<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëãüèª üë©‚Äç‚úàÔ∏è ü•° L'IoT pour un sou: un guide pratique. Partie 2, logiciel üë¨ üèõÔ∏è ü§¥üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous continuons la s√©rie d'articles de guide dans lesquels nous consid√©rons comment mettre en ≈ìuvre √† partir de z√©ro un appareil IoT contr√¥l√© par le c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'IoT pour un sou: un guide pratique. Partie 2, logiciel</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/383027/"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous continuons la s√©rie d'articles de guide dans lesquels nous consid√©rons comment mettre en ≈ìuvre √† partir de z√©ro un appareil IoT contr√¥l√© par le cloud simple et bon march√© avec un grand potentiel - sans soudure et difficult√©s inutiles. Prenez une micropuce propre ESP8266, installez le firmware depuis DeviceHive, configurez et √©crivez une simple application Web pour acc√©der au serveur cloud. Nous assemblons et connectons un simple appareil √† la puce √©lectronique, qui peut √™tre contr√¥l√© en quelques clics dans le navigateur. Voici la deuxi√®me partie du cycle, qui d√©crit quel logiciel est n√©cessaire, comment le d√©marrer, comment flasher ESP8266 et se lier d'amiti√© avec le serveur.</font></font></i><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/VuReziKXvos%3Ffeature%3Doembed&amp;usg=ALkJrhirfmUMxUQyjZq0tHT9e9rquayxkg" frameborder="0" allowfullscreen=""></iframe><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'auteur de l'article montre ce qui sera discut√© aujourd'hui. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les premiers articles de la s√©rie: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IoT pour un sou, ou ce que DeviceHive peut faire. </font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IoT pour un sou: un guide pratique. </font><font style="vertical-align: inherit;">Partie 1, mat√©riel.</font></font></a><br>
<a name="habracut"></a><br>
<h5><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©er un serveur</font></font></b></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allons de l'avant et utilisons le terrain de jeu gratuit DeviceHive. </font><font style="vertical-align: inherit;">Pour ce faire, rendez-vous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et inscrivez-vous. </font><font style="vertical-align: inherit;">Apr√®s cela, connectez-vous et acc√©dez √† cette page:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/844/419/90d/84441990d53945c1b48f2fae010472ff.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes nos f√©licitations! </font><font style="vertical-align: inherit;">Vous avez maintenant votre propre terrain de jeu sur DeviceHive. </font><font style="vertical-align: inherit;">Pour vous connecter au groupe de jeu de l'ext√©rieur, utilisez le lien API Url. </font><font style="vertical-align: inherit;">Il s'agit de l'adresse que nous utilisons pour acc√©der au serveur depuis ESP8266 et l'application client. </font><font style="vertical-align: inherit;">Pour acc√©der au panneau d'administration (√† Admin Url), utilisez la connexion sp√©cifi√©e (connexion initiale) et le mot de passe (mot de passe initial). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une petite digression: le serveur peut √™tre d√©ploy√© localement ou sur un service cloud. </font><font style="vertical-align: inherit;">Recherchez les instructions d'installation </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous pouvez le rendre plus facile - d√©marrez le serveur en utilisant </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur une seule ligne: </font><font style="vertical-align: inherit;">
regardez </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">ici</font></a><font style="vertical-align: inherit;"> pour une description compl√®te </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">
DeviceHive est un projet enti√®rement open source. </font><font style="vertical-align: inherit;">Cela signifie que le serveur peut √™tre d√©ploy√© √† la maison et dans un service cloud, par exemple, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Azure</font></a></font><br>
<br>
<code>docker run -d --name=devicehive -p 8080:80 -p 9001:9001 devicehive/devicehive-standalone<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br>
<h5><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></b></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est temps de faire le firmware. Pour ce faire, nous devons connecter l'ESP8266 √† l'ordinateur, puis connecter l'adaptateur USB-&gt; UART, l'alimentation et le module ESP8266. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez le pilote de votre adaptateur. Les utilisateurs Linux sont plus faciles ici, car le noyau inclut d√©j√† la plupart de ces pilotes. Mais les utilisateurs de Windows et OS X devront installer le pilote de l'adaptateur eux-m√™mes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liens vers les pages de t√©l√©chargement officielles des puces les plus populaires: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CP210x: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.silabs.com/products/mcu/pages/usbtouartbridgevcpdrivers.aspx</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PL230x: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.prolific.com.tw/US/ShowProduct.aspx?pcid=41</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
FTDI: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www. ftdichip.com/Drivers/VCP.htm</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
CH341: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.wch.cn/index.php?s=/page-search_content-keyword-CH341SER.html</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Connectez l'adaptateur et assurez-vous que le pilote fonctionne correctement. Sous Linux, le p√©riph√©rique doit appara√Ætre sur le syst√®me de fichiers / dev / ttyUSB *, sous OS X /dev/tty.* et sous Windows, un port COM suppl√©mentaire doit appara√Ætre dans le gestionnaire de p√©riph√©riques. Si tout va bien, d√©connectez l'adaptateur de l'ordinateur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, connectez la sortie de l'alimentation (3,3 Volts) √† l'ESP8266 avec deux fils. Pour que le module s'allume, lorsqu'il est sous tension, il doit √™tre autoris√© √† fonctionner en fournissant un niveau √©lev√© √† la sortie de CH_PD. Il est n√©cessaire d'informer le module que nous utiliserons la m√©moire interne, donc lorsqu'il est allum√©, le GPIO15 doit √™tre faible. Et pour entrer en mode de programmation, nous devons appliquer un niveau bas √† GPIO0. Nous n'avons besoin de ce dernier que pendant le firmware. Cela semble effrayant, mais en r√©alit√©, nous avons seulement besoin de connecter les trois fils de CH_PD au plus de l'alimentation, et de connecter GPIO0 et GPIO15 √† la masse (moins) de l'alimentation. Enfin, nous connectons l'adaptateur USB-&gt; UART √† l'aide de trois fils suppl√©mentaires: nous connectons les bornes moins la source (GND) √† la masse de l'adaptateur,la sortie de l'adaptateur RX est connect√©e √† la sortie du module TX de l'ESP8266 et la sortie de l'adaptateur TX √† la sortie du module RX. Nous obtenons le sch√©ma de connexion final pour trois modules standard diff√©rents. Si une sortie manque, elle est probablement d√©j√† connect√©e √† l'int√©rieur du module, le fil violet est la connexion la plus temporaire pour entrer en mode de programmation.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8e1/9f3/512/8e19f3512588495b876d97a3e9ab806f.png"></div><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/c11/6df/510/c116df510f854c09b2e12ea14b5c5d23.png"></div><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8fb/a10/7b3/8fba107b32ee43199ff3d113922f5880.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un exemple de l'ex√©cution d'une telle connexion:</font></font><br>
<div style="text-align:center;"><img width="50%" height="50%" src="https://habrastorage.org/files/482/644/75f/48264475fcfa4d408b58d46b85b38046.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, rien n'√©tait n√©cessaire pour souder, toutes les connexions peuvent √™tre faites avec des connecteurs ordinaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, allumez la source d'alimentation, connectez l'adaptateur √† l'ordinateur et t√©l√©chargez le micrologiciel DeviceHive recompil√© pour ESP8266. </font><font style="vertical-align: inherit;">Au moment de la publication, la premi√®re et derni√®re version est disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De nouvelles versions pr√©compil√©es peuvent toujours √™tre trouv√©es sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Vous pouvez √©galement prendre l'int√©gralit√© du r√©f√©rentiel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , compiler le firmware vous-m√™me et le modifier √† votre guise. </font><font style="vertical-align: inherit;">Tout le code dans le r√©f√©rentiel est sous licence MIT.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D√©compressez l'archive t√©l√©charg√©e √† partir du lien ci-dessus dans un r√©pertoire s√©par√©, ex√©cutez esp-flasher- &lt;votre nom de syst√®me d'exploitation&gt; √† partir de la console (les utilisateurs de Windows peuvent simplement double-cliquer sur esp-flasher-win.exe). Par cons√©quent, vous devriez avoir quelque chose comme ceci:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8e2/0d2/3ab/8e20d23ab58341e595662a60778544af.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus de l'utilitaire inclus pour le firmware ESP8266, vous pouvez utiliser n'importe quel autre, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esptool</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√©licitations - le firmware est install√© et fonctionne d√©j√†! D√©connectez maintenant la masse de la broche GPIO0 (elle ne sera plus n√©cessaire) afin que le module ne revienne pas en mode programmation. Pour vous connecter au terminal ESP8266, ex√©cutez esp-terminal- &lt;votre nom de syst√®me d'exploitation&gt; ou tout autre terminal de port s√©rie qui prend en charge les caract√®res d'√©chappement, par exemple, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PuTTY</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou l''√©cran 'de l'utilitaire GNU. Param√®tres de port: vitesse 115200, 8N1. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux utilitaires inclus sont capables de d√©tecter automatiquement le port auquel l'ESP8266 est connect√©, c'est-√†-dire aucun param√®tre n'est requis au d√©marrage. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©marrage du terminal, nous verrons l'invitation:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/89a/fa8/916/89afa8916b634d60877dabb7ac9ff577.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, il s'agit d'un terminal similaire √† Unix qui prend en charge la saisie semi-automatique (touche Tab) et l'historique (touches haut, bas). </font><font style="vertical-align: inherit;">Mais en fait, il n'y a ni fichier ni syst√®me d'exploitation. </font><font style="vertical-align: inherit;">Une liste des commandes disponibles est disponible dans 'help':</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/3ab/5fe/a19/3ab5fea19fbb4c9cb662c9136c4364e3.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes int√©ress√©s par la commande 'configure'. </font><font style="vertical-align: inherit;">Ex√©cutez-le pour configurer l'appareil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'utilitaire posera cinq questions simples:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le nom de votre r√©seau Wi-Fi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mot de passe de votre r√©seau Wi-Fi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'adresse API de votre serveur.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeviceID de votre appareil.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeviceKey de votre appareil.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l '"URL du serveur DeviceHive", entrez l' "URL de l'API" du serveur. </font><font style="vertical-align: inherit;">Dans ¬´DeviceID¬ª - un identifiant d'appareil unique pour le serveur, c'est avec ce nom que nous distinguerons les appareils sur le serveur. </font><font style="vertical-align: inherit;">¬´DeviceID¬ª peut √™tre en texte brut. </font><font style="vertical-align: inherit;">En particulier, vous pouvez g√©n√©rer un GUID texte en cliquant sur Tab. </font><font style="vertical-align: inherit;">Et √† la derni√®re demande de DeviceKey, entrez le mot de passe s√©lectionn√©. </font><font style="vertical-align: inherit;">Il peut √™tre g√©n√©r√© en appuyant sur la touche Tab. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, il vaut la peine de faire une petite digression. </font><font style="vertical-align: inherit;">ESP8266 utilise l'authentification du serveur par DeviceID. </font><font style="vertical-align: inherit;">D√®s que DeviceID et DeviceKey sont enregistr√©s sur le serveur, aucun autre appareil avec le m√™me DeviceID mais avec un mot de passe diff√©rent ne peut se connecter. </font><font style="vertical-align: inherit;">√Ä l'avenir, un mot de passe DeviceKey peut √™tre requis uniquement si vous souhaitez remplacer le p√©riph√©rique physique par un autre p√©riph√©rique avec le m√™me DeviceID.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici √† quoi ressemble la configuration:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/7f0/f03/fb1/7f0f03fb17254a9aaedfccd4ae78e0b2.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si nous avons tout fait correctement, nous pouvons examiner la sortie de d√©bogage et nous assurer que le p√©riph√©rique s'est correctement connect√© au serveur. Voici la sortie de d√©bogage d'un p√©riph√©rique connect√© avec succ√®s:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/664/ea5/a6e/664ea5a6eccb456c9826c2357cf108e3.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'adaptateur USB-&gt; UART peut maintenant √™tre d√©sactiv√©. Vous pouvez le laisser si vous souhaitez pouvoir consulter la sortie de d√©bogage ou l'√©tat du r√©seau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, dans l'onglet "Appareils" du panneau d'administration, le premier appareil appara√Ætra. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essayons d'envoyer la premi√®re commande √† l'appareil</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour ce faire, acc√©dez au panneau d'administration de la mani√®re suivante: "P√©riph√©riques" -&gt; "ESP" -&gt; "d√©tails" -&gt; "commandes" -&gt; "entrer une nouvelle commande". Dans le champ "nom", sp√©cifiez "gpio / read" et appuyez sur "push". L'√©quipe envoy√©e! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La r√©ponse viendra tr√®s rapidement, mais les r√©sultats des commandes du panneau d'administration ne sont pas automatiquement mis √† jour. Pour cela, il y a un bouton de rafra√Æchissement en face de la commande. Cliquez dessus une ou deux secondes apr√®s l'envoi et vous verrez cet √©cran:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/745/de9/39a/745de939a7a743c99b45cee26b346440.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qu'est-il arriv√©? En appuyant sur le bouton-poussoir, vous avez envoy√© une commande du panneau d'administration (qui dans ce cas est le client du serveur) √† la commande du serveur. ESP8266 l'a r√©cup√©r√©, ex√©cut√© et transmis le r√©sultat au serveur. En cliquant sur le bouton Actualiser, vous avez demand√© au serveur le r√©sultat de la commande: La </font><font style="vertical-align: inherit;">
liste des commandes disponibles se trouve dans le fichier PDF fourni avec le firmware. Il est √©galement disponible </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">ici</font></a><font style="vertical-align: inherit;"> , mais peut ne pas correspondre √† la version de votre firmware.</font></font><br>
<br>
<code>{"0":"1","1":"0","2":"1","3":"0","4":"1","5":"1","12":"0","13":"0","14":"0","15":"0"}<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par une bonne tradition, nous allumerons la LED sur la carte. Dans la plupart des modules ESP8266, la LED est sur une sortie de type TX, et nous nous en occuperons. Il s'allume lorsqu'un niveau bas appara√Æt sur la sortie de la puce. Dans le document, nous verrons que GPIO1 n'est rien d'autre que la m√™me sortie TX, alors d√©finissons un z√©ro logique dessus. Dans ce cas, la LED s'allume sans aucun probl√®me. Apr√®s cela, le terminal du module cessera de fonctionner jusqu'au red√©marrage. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous d√©finissons la commande </font><font style="vertical-align: inherit;">√©galement indiqu√©e dans le document. Dans le champ "nom", nous d√©finissons </font><font style="vertical-align: inherit;">et dans le champ "param√®tres" - </font><font style="vertical-align: inherit;">. Apr√®s avoir ex√©cut√© la commande, la LED sur la carte doit s'allumer, comme sur la photo ci-dessous.</font></font><code>"gpio/write"<br>
</code><font style="vertical-align: inherit;"></font><code>"gpio/write"<br>
</code><font style="vertical-align: inherit;"></font><code>{"1":"0"}<br>
</code><font style="vertical-align: inherit;"></font><br>
<br>
<div style="text-align:center;"><img width="50%" height="50%" src="https://habrastorage.org/files/284/6cd/b84/2846cdb8454e4b48922ea951e8fa832e.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une LED bleue sous quartz, √† c√¥t√© de laquelle une rouge brille toujours, qui indique que la carte est aliment√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir sur la photo, seuls deux fils avec alimentation et deux cavaliers sont connect√©s au module pour allumer le module dans le mode correct. </font><font style="vertical-align: inherit;">Pour d√©sactiver, envoyez une commande avec un param√®tre </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Le format des param√®tres de commande est JSON ordinaire. </font><font style="vertical-align: inherit;">Les champs pouvant √™tre remplis, ainsi que leurs valeurs possibles, sont d√©crits dans le fichier PDF. </font><font style="vertical-align: inherit;">
Aujourd'hui, nous avons d√©couvert comment envoyer les commandes les plus simples du panneau d'administration √† l'appareil. </font><font style="vertical-align: inherit;">Dans le prochain article, nous vous expliquerons comment √©crire une application cliente simple pour le serveur qui vous permet d'acc√©der √† l'appareil, et d'impl√©menter un appareil un peu plus s√©rieux (rappelez-vous le laser du premier article?). </font><font style="vertical-align: inherit;">
Restez √† l'√©coute, ce sera int√©ressant!</font></font><code>{"1":"1"}<br>
</code><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publi√© par Nikolai Khabarov, d√©veloppeur principal embarqu√©.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr383027/">https://habr.com/ru/post/fr383027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr383011/index.html">Des lance-flammes √† main sont apparus en vente aux USA</a></li>
<li><a href="../fr383013/index.html">IBM publie les mainframes LinuxOne et les contrats avec Canonical</a></li>
<li><a href="../fr383017/index.html">L'intelligence artificielle est-elle un g√©nie mauvais ou bon?</a></li>
<li><a href="../fr383023/index.html">Robotique en agriculture</a></li>
<li><a href="../fr383025/index.html">Examen du vrai Android TV sur l'exemple du Sony 55w807c</a></li>
<li><a href="../fr383033/index.html">Le supraconducteur malodorant fonctionne √† -70 ¬∞ C</a></li>
<li><a href="../fr383035/index.html">Alternatives √† Google Play et √† l'App Store ou comment la Chine vit sans Google Play</a></li>
<li><a href="../fr383039/index.html">Labyrinthe de carte postale. Un cadeau qui ne peut √™tre ouvert sans r√©soudre le puzzle</a></li>
<li><a href="../fr383041/index.html">Demandez √† Ethan n ¬∞ 25: o√π aller dans notre galaxie?</a></li>
<li><a href="../fr383045/index.html">Comment Tesla va changer le monde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>