<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ó üöê üë®üèª‚Äç‚öñÔ∏è Analisando tarefas do CTF üß¢ üêô üï∫üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No in√≠cio de dezembro, realizamos uma competi√ß√£o por equipes em seguran√ßa da informa√ß√£o. Al√©m do OTUS , os organizadores do evento para os ‚Äúhackers br...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analisando tarefas do CTF</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/482538/">  <i>No in√≠cio de dezembro, realizamos uma <a href="https://habr.com/ru/news/t/476892/">competi√ß√£o</a> por <a href="https://habr.com/ru/news/t/476892/">equipes</a> em seguran√ßa da informa√ß√£o.</i>  <i>Al√©m do <a href="https://otus.pw/q7Ro/">OTUS</a> , os organizadores do evento para os ‚Äúhackers brancos‚Äù foram o <a href="https://volgactf.ru/">Volga CTF</a> e o <a href="https://ctf.moscow/">CTF.Moscow</a> .</i>  <i>Talvez tenha chegado a hora de resumir e falar detalhadamente sobre as tarefas.</i> <i><a name="habracut"></a></i> <br><br>  <b>Primeiro, o evento teve sucesso:</b> <br><br><ul><li>  9 tarefas foram preparadas em tr√™s √°reas: Pentest, Engenharia Reversa, Seguran√ßa Linux e Desenvolvimento Seguro; </li><li>  Participaram 217 equipes; </li><li>  Mais de 800 tentativas de passar bandeiras foram registradas; </li><li>  mais de 300 bandeiras passadas foram registradas. </li></ul><br><img src="https://habrastorage.org/webt/wz/hb/ul/wzhbulaaw9vhnblzhk4w9jzpche.png"><br><br>  <b>Em segundo lugar</b> , as tarefas eram diferentes em complexidade, para que nem todos pudessem resolver o problema: <br><br><img src="https://habrastorage.org/webt/2e/uh/v3/2euhv3gwoznv4womber0-o-513w.png"><br><br>  <b>Em terceiro lugar</b> , imediatamente ap√≥s a conclus√£o da maratona on-line, realizamos <b>tr√™s semin√°rios</b> on-line nos quais conversamos sobre os vencedores, demos as respostas certas e anunciamos os resultados finais: <br><br>  - Resultados do CTF: ‚ÄúLinux Security and Secure Development‚Äù; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/5tt8xsAhYBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - Resultados do CTF: Pentest; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/6Dm-gk86yJk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - os resultados do CTF: "engenharia reversa". <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Cx-ALK8laXI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Em quarto lugar</b> , oferecemos as <b>condi√ß√µes das tarefas e as descri√ß√µes textuais de suas solu√ß√µes</b> .  Observe que algumas tarefas incluem arquivos. <br><br><h3>  Dire√ß√£o 1: Pentest </h3><br>  <b>Tarefa 1 - Bancos de dados</b> <br><br>  <i>100</i> <i><br><br></i>  <i>O site est√° usando ativamente bancos de dados.</i>  <i>Tente fazer inje√ß√µes de SQL.</i> <i><br></i>  <i>Link para o site: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  Vamos para a se√ß√£o principal da loja / loja / produtos /, tendo ficado preso no campo de pesquisa, encontramos a inje√ß√£o de sql. <br><br>  Digite 1 "OR" 1 "=" 1 "-, role para baixo e veja um produto que estava faltando anteriormente, a bandeira est√° em sua descri√ß√£o. <br><br>  <b><i>Sinalizador: sinalizador {5ql_1nject10n_15_t00_51mpl3_f0r_y0u}</i></b> <br><br>  <b>Tarefa 2 - Cookies</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Meu amigo desenvolveu uma plataforma de loja online.</i>  <i>Ele pediu um teste de caixa preta.</i>  <i>Verifique a seguran√ßa dos cookies, voc√™ poder√° obter direitos de administrador.</i> <i><br><br></i>  <i>Link para o site: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  Fa√ßa login, veja os cookies e veja os cookies secretos: <br><br>  ¬´MTExMTAxMSAxMDAwMTAgMTExMDEwMSAxMTEwMDExIDExMDAxMDEgMTExMDAxMCAxMTAxMTEwIDExMDAwMDEgMTEwMTEwMSAxMTAwMTAxIDEwMDAxMCAxMTEwMTAgMTAwMDEwIDExMTAxMDEgMTExMDAxMSAxMTAwMTAxIDExMTAwMTAgMTAwMDEwIDEwMTEwMCAxMDAwMDAgMTAwMDEwIDExMDEwMDEgMTExMDAxMSAxMDExMTExIDExMDAwMDEgMTEwMDEwMCAxMTAxMTAxIDExMDEwMDEgMTEwMTExMCAxMDAwMTAgMTExMDEwIDEwMDAxMCAxMDAwMTEwIDExMDAwMDEgMTEwMTEwMCAxMTEwMDExIDExMDAxMDEgMTAwMDEwIDExMTExMDE =¬ª <br><br>  base64 Decode, temos os dados bin√°rios: 1111011 100010 1110101 1110011 1100101 1110010 1101110 1100001 1101101 1100101 100010 111010 100010 1110101 1110011 1100101 1110010 100010 101100 100000 100010 1101001 1110011 1011111 1100001 1100100 1101101 1101001 1101110 100010 111010 100010 1000110 1100001 1101100 1110011 1100101 100010 1111101 <br><br>  <code>{"username":"user", "is_admin":"False"}</code> em texto e obtemos: <code>{"username":"user", "is_admin":"False"}</code> , <code>{"username":"user", "is_admin":"False"}</code> False para True e decodificamos de volta: <br><br>  01111011 00100010 01110101 01110011 01100101 01110010 01101110 01100001 01101101 01100101 00100010 00111010 00100010 01110101 01110011 01100101 01110010 00100010 00101100 00100000 00100010 01101001 01110011 01011111 01100001 01100100 01101101 01101001 01101110 00100010 00111010 00100010 01010100 01110010 01110101 01100101 00100010 01111101 <br><br>  ¬´MDExMTEwMTEgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDExMDExMTAgMDExMDAwMDEgMDExMDExMDEgMDExMDAxMDEgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDAxMDAwMTAgMDAxMDExMDAgMDAxMDAwMDAgMDAxMDAwMTAgMDExMDEwMDEgMDExMTAwMTEgMDEwMTExMTEgMDExMDAwMDEgMDExMDAxMDAgMDExMDExMDEgMDExMDEwMDEgMDExMDExMTAgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDEwMTAxMDAgMDExMTAwMTAgMDExMTAxMDEgMDExMDAxMDEgMDAxMDAwMTAgMDExMTExMDE =¬ª <br><br>  Altere o valor dos cookies para um novo e v√° para o perfil do usu√°rio. <br>  <i><b>Sinalizador: sinalizador {d0_y0u_l1k3_c00k13s}</b></i> <br><br>  <b>Tarefa 3 - Leitura de arquivo</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Muitas vezes encontramos fontes vazando e estranha l√≥gica de trabalho.</i>  <i>Os poss√≠veis vetores de ataque geralmente s√£o encontrados por difus√£o.</i>  <i>Eu sugiro que voc√™ fa√ßa isso.</i> <i><br><br></i>  <i>Link para o site: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  Come√ßamos o dirb (o comum common.txt √© suficiente), encontramos as p√°ginas <code>/shop/_source/</code> e <code>/shop/files/</code> . <br><br>  Tendo nos familiarizado com a origem <code>_source</code> entendemos que temos a vulnerabilidade Path Traversal + alguns filtros simples. <br><br>  Para obter o sinalizador, voc√™ precisa fazer uma solicita√ß√£o POST para <code>/shop/files/</code> com o par√¢metro "file", cujo valor deve ser <code>%2E%2E/%2E%2E/flag</code> . <br><br>  Em resposta √† solicita√ß√£o, haver√° uma bandeira. <br><br>  <i><b>Sinalizador: sinalizador {y0u_g0t_0ur_s3cr3t}</b></i> <br><br><h3>  Dire√ß√£o 2: ‚ÄúSeguran√ßa Linux e Desenvolvimento Seguro‚Äù </h3><br>  <b>Tarefa 1 - VCS</b> <br><br>  50. <br><br>  <i>Mas o cliente nos deu algo sup√©rfluo?</i> <i><br></i>  <i>O arquivo cont√©m o c√≥digo fonte de parte do site.</i> <i><br></i>  <i>Link para o site: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Anexo: task.7z</i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  Temos acesso ao c√≥digo fonte.  Como se viu, os desenvolvedores tamb√©m colocaram um reposit√≥rio git.  Observamos o git log, vemos o commit com corre√ß√µes.  Usamos git show &lt;hash commit&gt;, vemos os arquivos modificados e seu conte√∫do, uma flag √© armazenada em uma das linhas. <br><br>  <i><b>sinalizador {22717297f6a3603608d260c9e5f69e0a}</b></i> <br><br>  <b>Tarefa 2 - Algo</b> <br><br>  <i>50.</i> <i><br><br></i>  <i>Temos um novo desafio.</i>  <i>Realize uma verifica√ß√£o de desenvolvimento segura.</i>  <i>O cliente forneceu um arquivo com a parte aberta do site em desenvolvimento.</i>  <i>Para testar seu algoritmo de hash, ele forneceu um hash: 666c61677b32646733326473323334327d.</i>  <i>Verifique o algoritmo quanto √† possibilidade de transforma√ß√£o inversa.</i> <i><br><br></i>  <i>O arquivo cont√©m o c√≥digo fonte de parte do site.</i> <i><br></i>  <i>Link para o site: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Anexo: task.7z</i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  O c√≥digo fonte possui um algoritmo de hash de senha.  Na verdade, esse n√£o √© um algoritmo de hash, mas simplesmente a convers√£o de dados de um formato de string para hexadecimal. <br><br>  Usamos Python: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> binascii binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">"666c61677b32646733326473323334327d"</span></span>)</code> </pre> <br>  Recebemos <i><b>a</b></i> bandeira: <i><b>flag {2dg32ds2342}</b></i> <br><br>  <b>Tarefa 3 - Arquivos Arquivos Arquivos</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Vamos terminar a auditoria.</i>  <i>Voc√™ tamb√©m v√™ essa vulnerabilidade?</i>  <i>√ìtimo.</i>  <i>Portanto, √© f√°cil obter um arquivo secreto.</i> <i><br></i>  <i>O arquivo cont√©m o c√≥digo fonte de parte do site.</i> <i><br></i>  <i>Link para o site: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Anexo: task.7z</i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  No c√≥digo fonte do m√≥dulo principal do programa, voc√™ pode notar o leitor de arquivos (esta √© a principal aplica√ß√£o deste servi√ßo).  A fun√ß√£o para verificar a exist√™ncia de um arquivo n√£o verifica caracteres especiais de forma alguma e simplesmente concatena duas linhas =&gt; vulnerabilidade de percurso / percurso. <br><br>  Tamb√©m no Dockerfile, docker-compose.yml, voc√™ pode ver os mapeamentos de arquivos e a estrutura de carregamento no cont√™iner.  Usando esse conhecimento, geramos uma carga √∫til: <br><br><pre> <code class="plaintext hljs">http://193.41.142.9:8002/files?password=qgzc6!78zxcbkj123fdgd234&amp;filename=../../../../../../src/secret_files/flag.txt</code> </pre> <br>  <i><b>sinalizador {a0a7c3fff21f2aea3cfa1d0316dd816c}</b></i> <i><b><br></b></i> <br><h3>  Dire√ß√£o 3: "engenharia reversa" </h3><br>  <b>Tarefa 1 - Cobra</b> <br>  <i>100</i> <i><br><br></i>  <i>Nossa empresa est√° sempre tentando contornar qualquer prote√ß√£o de software.</i>  <i>Ajude-nos a lidar com o Python desta vez.</i> <i><br></i>  <i>Arquivo anexado: task.pyc</i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  Usamos o bytecode do Python descompilado pelo m√≥dulo uncompyle6: <br>  uncompyle6 task.pyc. <br>  N√≥s descompilamos, obtemos uma bandeira: <br><br>  <i><b>sinalizador {w3l1_pyth0n}</b></i> <i><b><br></b></i> <br>  <b>Tarefa 2 - Rob√¥</b> <br>  <i>150</i> <i><br><br></i>  <i>Desta vez, encontramos um aplicativo estranho, ajuda-me a encontrar a senha para entrar.</i> <i><br></i>  <i>Anexo: app.apk</i> <br><br>  <b>Solu√ß√£o:</b> <br><br>  O aplicativo est√° no Android, portanto, basta carreg√°-lo em um analisador est√°tico, como o BytecodeViewer, e ver o c√≥digo-fonte restaurado do programa.  Note que este √© o Kotiln, e geralmente usa programa√ß√£o funcional, como neste caso.  Em uma das fun√ß√µes an√¥nimas descompiladas, encontramos a verifica√ß√£o de flag, a pr√≥pria verifica√ß√£o: <br><br><pre> <code class="kotlin hljs">(String)paramFunction1.invoke(<span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>.valueOf(Arrays.equals(paramString, h)));  invoke: ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">"flag{"</span></span>); ((StringBuilder)localObject).append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$m); ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">'}'</span></span>);</code> </pre> <br>  vari√°vel h: {102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50, 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55}; <br><br>  Vemos que parece caracteres impressos codificados.  Usamos Python: <br><br>  '' .join (chr (x) para x em [102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50 , 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55]) <br><br>  Temos a bandeira: <br><br>  <i><b>sinalizador {fa2bf646e49ab5e56f2b74480ba61017}</b></i> <i><b><br></b></i> <br>  <b>Miss√£o 3 - Bin</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Desta vez, encontramos um arquivo bin√°rio.</i>  <i>A tarefa √© a mesma, obtenha a senha secreta.</i> <i><br></i>  <i>Anexo: tarefa</i> <br><br>  <b>Solu√ß√£o:</b> <br>  Um arquivo bin√°rio √© fornecido.  Carregamos no desmontador e vemos seis fun√ß√µes de valida√ß√£o escritas em C ++. <br><br>  Eles s√£o executados de forma id√™ntica e s√£o chamados um ao outro, verificando a bandeira em partes de 5 elementos. <br><br>  N√≥s o restauramos em etapas usando as informa√ß√µes do desmontador.  Recebemos a bandeira em partes: <br><br>  0) verifica√ß√£o de comprimento <br>  1) sinalizador { <br>  2) feefa <br>  3) _172a <br>  4) k14sc <br>  5) _eee} <br><br>  Combine e obtenha a bandeira: <br><br>  <i><b>sinalizador {feefa_172ak14sc_eee}</b></i> <br><br>  S√≥ isso, colegas!  Obrigado a todos por participarem, cuidem de si mesmos, de seus entes queridos e de seus dados!  Feliz Ano Novo! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt482538/">https://habr.com/ru/post/pt482538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt482526/index.html">Palestra do Jubileu de Donald Knuth "Na √°rvore de Natal"</a></li>
<li><a href="../pt482530/index.html">Dedicado a: tecnologia que morreu em 2019</a></li>
<li><a href="../pt482532/index.html">Pulso Sprint: construindo um trabalho eficaz dentro de uma grande equipe</a></li>
<li><a href="../pt482534/index.html">Mais uma vez sobre a complexidade da arquitetura e o limiar de entrada</a></li>
<li><a href="../pt482536/index.html">Pixel art para iniciantes: instru√ß√µes de uso</a></li>
<li><a href="../pt482540/index.html">Software VS Hardware: o que est√° na tend√™ncia e quem √© o futuro?</a></li>
<li><a href="../pt482544/index.html">Reunindo uma equipe de inicializa√ß√£o com "0" - instru√ß√µes passo a passo para os menores</a></li>
<li><a href="../pt482546/index.html">VK Tech: um ano de desenvolvimento em n√∫meros Git</a></li>
<li><a href="../pt482550/index.html">O misterioso programa LyX. Parte 2</a></li>
<li><a href="../pt482552/index.html">Registro e autoriza√ß√£o usando o Spring Security usando um aplicativo simples como exemplo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>