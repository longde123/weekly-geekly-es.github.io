<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💥 ➗ 🔙 Eigenschaften RTC M41T56 ⛹🏽 👃🏿 🧑🏿‍🤝‍🧑🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M41T56 ist ein Echtzeituhr-Chip, der ein Analogon zum beliebten DS1307 ist. Und obwohl selbst die Pinbelegung der Mikroschaltung gleich ist, weisen si...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eigenschaften RTC M41T56</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457796/">  M41T56 ist ein Echtzeituhr-Chip, der ein Analogon zum beliebten DS1307 ist.  Und obwohl selbst die Pinbelegung der Mikroschaltung gleich ist, weisen sie erhebliche Unterschiede auf, über die ich zu berichten versuchen werde. <br><a name="habracut"></a><br><h2>  Kurzbeschreibung </h2><br>  Ich werde nicht auf den Betrieb des IIC-Busses eingehen, ich stelle nur fest, dass beide Chips die Adresse 0xd0 haben.  Um mit der Zeit zu arbeiten, enthält die Mikroschaltung sieben Kontoregister und ein Steuerregister.  Kontoregister enthalten Zahlen im binären Dezimalformat, einige Bits haben jedoch eine besondere Bedeutung. <br><br>  <b>Register</b> <br>  xxx - Der Wert des Bits ist nicht definiert. <br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Funktion </th><th rowspan="2">  Index </th><th colspan="8">  Bits </th><th rowspan="2">  mögliche Werte </th></tr><tr><th>  7 </th><th>  6 </th><th>  5 </th><th>  4 </th><th>  3 </th><th>  2 </th><th>  1 </th><th>  0 </th></tr><tr><td>  Sekunden </td><td>  0x00 </td><td>  ST </td><td colspan="3">  Dutzende von Sekunden </td><td colspan="4">  Einheiten von Sekunden </td><td>  0 - 59 </td></tr><tr><td>  Minuten </td><td>  0x01 </td><td>  xxx </td><td colspan="3">  Dutzende Minuten </td><td colspan="4">  Einheiten von Minuten </td><td>  0 - 59 </td></tr><tr><td>  Uhr </td><td>  0x02 </td><td>  Seb </td><td>  SB </td><td colspan="2">  Dutzende von Stunden </td><td colspan="4">  Stunden Einheiten </td><td>  0 - 23 </td></tr><tr><td>  Tag </td><td>  0x03 </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td colspan="3">  Wochentag </td><td>  1 - 7 </td></tr><tr><td>  Tag des Monats </td><td>  0x04 </td><td>  xxx </td><td>  xxx </td><td colspan="2">  Dutzende von Tagen </td><td colspan="4">  Einheiten des Tages </td><td>  1 - (28 | 29 | 30 | 31) </td></tr><tr><td>  Monat </td><td>  0x05 </td><td>  xxx </td><td>  xxx </td><td>  xxx </td><td colspan="1">  des </td><td colspan="4">  Einheiten des Monats </td><td>  1 - 12 </td></tr><tr><td>  Jahr </td><td>  0x06 </td><td colspan="4">  Dutzende von Jahren </td><td colspan="4">  Einheiten des Jahres </td><td>  0 - 99 </td></tr><tr><td>  Steuerregister </td><td>  0x07 </td><td>  OUT </td><td>  FT </td><td>  S. </td><td colspan="5">  Korrekturbetrag </td><td>  - - </td></tr></tbody></table></div><br>  <b>Bits</b> <br>  x - Nach dem Einschalten kann der Status des Bits beliebig sein. <br><div class="scrollable-table"><table><tbody><tr><th>  ein bisschen </th><th>  nach dem Zurücksetzen </th><th>  die Beschreibung </th></tr><tr><td>  ST </td><td>  x </td><td>  Beim Schreiben von 1 in dieses Bit stoppt der Generator </td></tr><tr><td>  CEB </td><td>  x </td><td rowspan="2"> Wenn das CEB-Bit (Century Enable Bit) gesetzt ist und ein neues Jahrhundert erreicht ist, ändert das CB-Bit (Century Bit) den Wert in das Gegenteil. </td></tr><tr><td>  CB </td><td>  x </td></tr><tr><td>  OUT </td><td>  1 </td><td rowspan="2">  Wenn die Bits OUT (OUTput Level) und FT (Frequency Test) gleich Null sind, wird der FT / OUT-Pin auf Masse gedrückt.  Bei FT = 1 beträgt der Ausgang FT / OUT 512 Hz und das OUT-Bit spielt keine Rolle. </td></tr><tr><td>  FT </td><td>  0 </td></tr><tr><td>  S. </td><td>  x </td><td>  RTC-Hub-Kalibrierungsmarkierung. </td></tr></tbody></table></div><br>  Die Unterschiede beginnen in der Zuordnung der Bits 7, 6 und 5 des Taktregisters.  Im M41T56 werden die Bits 7 und 6 verwendet, um den Übergang zum neuen Jahrhundert anzuzeigen, und die Bits 5 und 4 werden verwendet, um mehrere zehn Stunden zu zählen.  Darüber hinaus ist das Zählen von Stunden nur im Modus 24 möglich, der AM / PM-Modus ist nicht verfügbar.  In DS1307 wird Bit 7 nicht verwendet, eine Null in Bit 6 zeigt an, dass der Zählmodus 24 verwendet wird, und in diesem Fall enthalten die Bits 5 und 4 mehrere zehn Stunden.  Wenn Bit 6 eins ist, wird Bit 5 zum AM / PM-Flag, und Bit 4 enthält mehrere zehn Stunden. <br><br>  Signifikante Unterschiede bestehen im Steuerregister, das den Wortkorrekturstrich enthält. <br><br><h2>  Kurskorrektur </h2><br>  Mit M41T56 können Sie den Fehler des Quarzresonators im Bereich von -62 bis +124 ppm kompensieren, was eine Abweichung von nicht mehr als ± 5 Sekunden pro Monat ergibt.  Für die Kompensation sind die sechs niedrigstwertigen Bits des Steuerregisters verantwortlich.  Die Bits 4-0 enthalten eine vorzeichenlose Ganzzahl des Korrekturwerts, und Bit 5 legt die Korrekturrichtung fest.  Wenn Bit 5 Null enthält, verlangsamt sich der Hub in Schritten von 2,034 ppm, andernfalls beschleunigt RTC in Schritten von 4,068 ppm.  Dies ist unpraktisch, daher habe ich einige einfache Funktionen zum Konvertieren von ppm in Korrekturwörter und umgekehrt skizziert. <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/*        . */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MASK_CALIBR ((1 &lt;&lt; 4) | (1 &lt;&lt; 3) | (1 &lt;&lt; 2) | (1 &lt;&lt; 1) | (1 &lt;&lt; 0)) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*        . */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MASK_CALIBR_SIGN (1 &lt;&lt; 5) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/** *    . * @param caliber    RTC. * @return    ppm. */</span></span></span><span class="hljs-meta"> int8_t caliber_to_ppm(uint8_t caliber) { int8_t result = caliber &amp; MASK_CALIBR; result = (uint8_t) result * 2; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ((caliber &amp; MASK_CALIBR_SIGN) != 0) { result = -result; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { result = (uint8_t) result * 2; } return result; } </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/** *   . * @param ppm    ppm. * @return    RTC. */</span></span></span><span class="hljs-meta"> uint8_t ppm_to_caliber(int8_t ppm) { uint8_t result; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (ppm &lt; 0) { result = (uint8_t) (-ppm + 1) / 2; result |= MASK_CALIBR_SIGN; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { result = (uint8_t) (ppm + 2) / 4; } return result; }</span></span></code> </pre> <br><h2>  Fehlererkennung </h2><br>  Weder DS1307 noch M41T56 können Generierungsfehler erkennen, sie garantieren jedoch, dass sich einige Bits beim Einschalten in einem bestimmten Zustand befinden.  Wenn M41T56 im Steuerregister aktiviert ist, ist es 10xxxxxx.  Um Programmabstürze zu verfolgen, können Sie den folgenden Algorithmus verwenden.  Wenn beim Einschalten des Mikrocontrollers das RTC-Steuerregister 10xxxxxx enthält, liegt ein Stromausfall vor und es muss ein Wert in das Register geschrieben werden, dessen hohe Bits nicht gleich 10 sind. Am einfachsten ist es, das Korrekturwort mit den Bits 7 und 6 gleich Null zu schreiben. <br><br><h2>  Literatur </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fact</a> Sheet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">M41T56</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DS1307</a> Datenblatt </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457796/">https://habr.com/ru/post/de457796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457776/index.html">Minen unter Leistung warten in den Flügeln: Teil 2</a></li>
<li><a href="../de457784/index.html">Benutzerdefinierte Eye-Tracker-Kalibrierung</a></li>
<li><a href="../de457786/index.html">Anet A8 Plus aktualisiert. Groß und Metall</a></li>
<li><a href="../de457790/index.html">BuratinoPhone Handy</a></li>
<li><a href="../de457794/index.html">Die Symmetrieeigenschaft der Kointegrationsbeziehung</a></li>
<li><a href="../de457798/index.html">Was machen Open Source-Fonds - über aktuelle OpenStack- und Linux Foundation-Projekte</a></li>
<li><a href="../de457800/index.html">Kritische Sicherheitslücke in MacOS Mojave, die von Cyberkriminellen aktiv ausgenutzt wird</a></li>
<li><a href="../de457804/index.html">ListenIt - Google Chrome-Erweiterung zum automatischen Erstellen von Audioversionen von Artikeln</a></li>
<li><a href="../de457808/index.html">Wärmebildkamera Suchen Sie nach Thermal Compact</a></li>
<li><a href="../de457810/index.html">Engineering-Ansatz für die Softwareentwicklung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>