<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЪТя╕П ЁЯАДя╕П ЁЯСитАНЁЯПн рдПрдХ Automapper рдкрд░рд┐рдкреНрд░реЗрдХреНрд╖реНрдп рдореЗрдВ enum рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ ЁЯСитАНЁЯОи ЁЯд│ЁЯП╛ ЁЯР┤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдереЛрдбрд╝рд╛ рд╢реИрдХреНрд╖рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо 


 рдореИрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдСрдЯреЛрдореИрдкрд░ рдХреЛ рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реВрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕рдХреА рдХреНрд╡реЗрд░реАрдЯреЗрдХреНрд╕реНрдЯреЗрдиреНрд╢рди рдФрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯрдЯреЛ <> рд╡рд┐рдзрд┐ ред рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдпрд╣ рд╡рд┐рдз...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХ Automapper рдкрд░рд┐рдкреНрд░реЗрдХреНрд╖реНрдп рдореЗрдВ enum рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439484/"><h1 id="nemnogo-likbeza">  рдереЛрдбрд╝рд╛ рд╢реИрдХреНрд╖рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо </h1><br><p> рдореИрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдСрдЯреЛрдореИрдкрд░ рдХреЛ</a> рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реВрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕рдХреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреНрд╡реЗрд░реАрдЯреЗрдХреНрд╕реНрдЯреЗрдиреНрд╢рди рдФрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯрдЯреЛ &lt;&gt; рд╡рд┐рдзрд┐</a> ред  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдпрд╣ рд╡рд┐рдзрд┐ SQL рдХреНрд╡реЗрд░реА рдореЗрдВ рд╕реАрдзреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреНрд░рдХреНрд╖реЗрдкрдг рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред  рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ dto рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдпрд╛рдиреА  рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рд╕рднреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рдореЗрдореЛрд░реА рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдВ, <code>Automapper.Map&lt;&gt;</code> рдХрд╛ <code>Automapper.Map&lt;&gt;</code> рдХрд░реЗрдВ, рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдПрдХ рдмрдбрд╝реА рдЦрдкрдд рдФрд░ рдореЗрдореЛрд░реА рдЯреНрд░реИрдлрд╝рд┐рдХ рд╣реБрдЖред </p><a name="habracut"></a><br><h1 id="proekciya-tipa">  рдкреНрд░реЛрдЬреЗрдХреНрд╢рди рдкреНрд░рдХрд╛рд░ </h1><br><p>  Linq рдореЗрдВ рдкреНрд░реЛрдЬреЗрдХреНрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛: </p><br><pre> <code class="plaintext hljs"> from user in dbContext.Users where user.IsActive select new { Name = user.Name, Status = user.IsConnected ? "Connected" : "Disconnected" }</code> </pre> <br><p>  QueryableExtensions рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдЗрд╕ рдХреЛрдб рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдмреЗрд╢рдХ, рдмрд╢рд░реНрддреЗ рдХрд┐ рд░реВрдкрд╛рдВрддрд░рдг рдирд┐рдпрдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ -&gt; UserInfo рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╡рд░реНрдгрд┐рдд рд╣реИрдВ) </p><br><pre> <code class="plaintext hljs">dbContext.Users.Where(x =&gt; x.IsActive).ProjectTo&lt;UserInfo&gt;();</code> </pre> <br><h1 id="enum-i-problemy-s-nim">  Enum рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛рдПрдВ </h1><br><p>  рдкреНрд░реЛрдЬреЗрдХреНрд╢рди рдореЗрдВ рдПрдХ рдЦрд╛рдореА рд╣реИ рдЬрд┐рд╕ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдпрд╣ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд╣реИред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдм рдХреБрдЫ рдПрд╕рдХреНрдпреВрдПрд▓ рдХреНрд╡реЗрд░реА рдореЗрдВ рдЕрдиреБрд╡рд╛рджрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ</a> ред  рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЧрдгрдирд╛ рдкреНрд░рдХрд╛рд░ рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдирдо рд╣реИ </p><br><pre> <code class="plaintext hljs"> public enum FooEnum { [Display(Name = "")] Any, [Display(Name = "")] Open, [Display(Name = "")] Closed }</code> </pre> <br><p>  рдПрдХ рдЗрдХрд╛рдИ рд╣реИ рдЬрд┐рд╕рдореЗрдВ FooEnum рдкреНрд░рдХрд╛рд░ рдХреА рд╕рдВрдкрддреНрддрд┐ рдШреЛрд╖рд┐рдд рдХреА рдЧрдИ рд╣реИред  Dto рдореЗрдВ, рдЖрдкрдХреЛ рд╕реНрд╡рдпрдВ Enum рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ DisplayAttribute рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рдирд╛рдо рдЧреБрдг рдХрд╛ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдкреНрд░рдХреНрд╖реЗрдкрдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпрд╣ рдорд╣рд╕реВрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐  рд╡рд┐рд╢реЗрд╖рддрд╛ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд╛рд╡рд░реНрддрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдПрд╕рдХреНрдпреВрдПрд▓ рдХреЗрд╡рд▓ "рдХреБрдЫ рднреА рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рд╣реИ"ред </p><br><p>  рдирддреАрдЬрддрди, рдЖрдкрдХреЛ рдпрд╛ рддреЛ рд╕рд╛рдорд╛рдиреНрдп <code>Map&lt;&gt;</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рд╕рднреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдпрд╛ рдПрдирдо рдореВрд▓реНрдпреЛрдВ рдФрд░ рдЙрд╕ рдкрд░ рд╡рд┐рджреЗрд╢реА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рддрд╛рд▓рд┐рдХрд╛ рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </p><br><h1 id="reshenie-est---expressions">  рдПрдХ рд╕рдорд╛рдзрд╛рди рд╣реИ - рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпрд╛рдБ </h1><br><p>  рд▓реЗрдХрд┐рди "рдмреВрдврд╝реА рдФрд░рдд рдкрд░ рдПрдХ рдХрд╛рддрд┐рд▓ рд╣реЛрдЧрд╛ред"  рдЖрдЦрд┐рд░рдХрд╛рд░, рдПрдирдо рдХреЗ рд╕рднреА рдореВрд▓реНрдпреЛрдВ рдХреЛ рдЕрдЧреНрд░рд┐рдо рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  SQL рдореЗрдВ рдПрдХ <code>switch</code> рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдкреНрд░рдХреНрд╖реЗрдкрдг рдмрдирд╛рддреЗ рд╕рдордп рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рд░рд╣рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИред  рд╣реИрд╢рдЯреИрдЧ: "рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкреЗрдбрд╝-рд╣рдорд╛рд░рд╛-рд╕рдмред" </p><br><p>  рдСрдЯреЛрдореИрдкрд░, рдЬрдм рдкреНрд░реЛрдЬреЗрдХреНрдЯрд┐рдВрдЧ рдкреНрд░рдХрд╛рд░, рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдПрдВрдЯрд┐рдЯреА рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ рдмрд╛рдж, рд╕рдВрдмрдВрдзрд┐рдд SQL рдХреНрд╡реЗрд░реА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдкреЗрдбрд╝ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдХреНрдп рд░рдЪрдирд╛ рдмреЗрд╣рдж рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рд▓реЗрдХрд┐рди рдХреБрдЫ рдЫреЛрдЯреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд╣рд▓ рдХреЗ рдмрд╛рдж, рд╕рдм рдХреБрдЫ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  Enum рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдореВрд▓реНрдпреЛрдВ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд╢рд░реНрдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдПрдХ рдиреЗрд╕реНрдЯреЗрдб рдЯреНрд░реА рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдХреБрдЫ рдЗрд╕ рддрд░рд╣ </p><br><pre> <code class="plaintext hljs">IF enum=Any THEN RETURN "" ELSE IF enum=Open THEN RETURN "" ELSE enum=Closed THEN RETURN "" ELSE RETURN ""</code> </pre> <br><p>  рд╡рд┐рдзрд┐ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкрд░ рдирд┐рд░реНрдгрдп рд▓реЗрдВред </p><br><pre> <code class="plaintext hljs"> public class FooEntity { public int Id { get; set; } public FooEnum Enum { get; set; } } public class FooDto { public int Id { get; set; } public string Name { get; set; } } //  Automapper CreateMap&lt;FooEntity, FooDto&gt;() .ForMember(x =&gt; x.Enum, options =&gt; options.MapFrom(GetExpression())); private Expression&lt;Func&lt;FooEntity, string&gt;&gt; GetExpression() { }</code> </pre> <br><p>  <code>GetExpression()</code> рд╡рд┐рдзрд┐ рдХреЛ рдПрдХ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдЙрддреНрдкрдиреНрди рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреЛ FooEntity рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рддреА рд╣реИ рдФрд░ <code>Enum</code> рд╕рдВрдкрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд▓реМрдЯрд╛рддреА рд╣реИред <br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЗрдирдкреБрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ рдФрд░ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдореВрд▓реНрдп рд╕реНрд╡рдпрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ </p><br><pre> <code class="plaintext hljs">ParameterExpression value = Expression.Parameter(typeof(FooEntity), "x"); var propertyExpression = Expression.Property(value, "Enum");</code> </pre> <br><p>  рдкреНрд░реЙрдкрд░реНрдЯреА рдиреЗрдо рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдмрдЬрд╛рдп, рдЖрдк <code>nameof(FooEntity.Enum)</code> рдХрдВрдкрд╛рдЗрд▓рд░ <code>nameof(FooEntity.Enum)</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ <code>System.Reflection.PropertyInfo</code> рдкреНрд░реЙрдкрд░реНрдЯреА рдпрд╛ <code>System.Reflection.PropertyInfo</code> рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рд▓рд┐рдП рд╕рдВрдкрддреНрддрд┐ рдХреЗ рдирд╛рдо рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред </p><br><p>  рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд╛рди рдХреЛ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо <code>Expression.Constant</code> рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рд╣рдо рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдмрдирд╛рддреЗ рд╣реИрдВ </p><br><pre> <code class="plaintext hljs"> Expression resultExpression = Expression.Constant(string.Empty);</code> </pre> <br><p>  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдПрдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ "рд▓рдкреЗрдЯ" рдХрд░рддреЗ рд╣реИрдВред </p><br><pre> <code class="plaintext hljs"> resultExpression = Expression.Condition( Expression.Equal(propertyExpression, Expression.Constant(FooEnum.Any)), Expression.Constant(EnumHelper.GetShortName(FooEnum.Any)), resultExpression); resultExpression = Expression.Condition( Expression.Equal(propertyExpression, Expression.Constant(FooEnum.Open)), Expression.Constant(EnumHelper.GetShortName(FooEnum.Open)), resultExpression); resultExpression = Expression.Condition( Expression.Equal(propertyExpression, Expression.Constant(FooEnum.Closed)), Expression.Constant(EnumHelper.GetShortName(FooEnum.Closed)), resultExpression);</code> </pre> <br><pre> <code class="plaintext hljs"> public static class EnumHelper { public static string GetShortName(this Enum enumeration) { return (enumeration .GetType() .GetMember(enumeration.ToString())? .FirstOrDefault()? .GetCustomAttributes(typeof(DisplayAttribute), false)? .FirstOrDefault() as DisplayAttribute)? .ShortName ?? enumeration.ToString(); } }</code> </pre> <br><p>  рдЬреЛ рдХреБрдЫ рднреА рдмрдЪрддрд╛ рд╣реИ, рдЙрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдирд┐рдХрд╛рд▓рдирд╛ рд╣реИ </p><br><pre> <code class="plaintext hljs"> return Expression.Lambda&lt;Func&lt;TEntity, string&gt;&gt;(resultExpression, value);</code> </pre> <br><h1 id="esche-nemnogo-refleksii">  рдереЛрдбрд╝рд╛ рдФрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдм </h1><br><p>  Enum рдХреЗ рд╕рднреА рдореВрд▓реНрдпреЛрдВ рдХреА рдирдХрд▓ рдХрд░рдирд╛ рдЕрддреНрдпрдВрдд рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рдЪрд▓реЛ рдЗрд╕реЗ рдареАрдХ рдХрд░рддреЗ рд╣реИрдВ </p><br><pre> <code class="plaintext hljs"> var enumValues = Enum.GetValues(typeof(FooEnum)).Cast&lt;Enum&gt;(); Expression resultExpression = Expression.Constant(string.Empty); foreach (var enumValue in enumValues) { resultExpression = Expression.Condition( Expression.Equal(propertyExpression, Expression.Constant(enumValue)), Expression.Constant(EnumHelper.GetShortName(enumValue)), resultExpression); }</code> </pre> <br><h1 id="usovershenstvuem-poluchenie-znacheniya-svoystva">  рд╕рдВрдкрддреНрддрд┐ рдХреЗ рдореВрд▓реНрдп рдореЗрдВ рд╕реБрдзрд╛рд░ рд╣реЛрдиреЗ рджреЗрдВ </h1><br><p>  рдКрдкрд░ рджрд┐рдП рдЧрдП рдХреЛрдб рдХрд╛ рдиреБрдХрд╕рд╛рди рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рдЗрдХрд╛рдИ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рддрдВрдЧ рдмрдВрдзрди рд╣реИред  рдпрджрд┐ рдХрд┐рд╕реА рдЕрдиреНрдп рд╡рд░реНрдЧ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдЗрд╕реА рддрд░рд╣ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЯрд╛рдЗрдк рдПрдиреНрдпреВрдорд░реЗрд╢рди рдХреА рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдореВрд▓реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрд░рд╣ рд╕реЗ рдЖрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рддреЛ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред  рд╡рд┐рдзрд┐ рдХреЗ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо рдПрдХ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкрд╛рд╕ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдореВрд▓реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЦреБрдж рдХреЛрдб - рд╣рдо рдмрд╕ рдЗрд╕ рд╕рдВрдкрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдПрдХ рд╕реЗрдЯ рдмрдирд╛рддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реА рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЗрдореНрдкрд▓реЗрдЯ </p><br><pre> <code class="plaintext hljs"> public static Expression&lt;Func&lt;TEntity, string&gt;&gt; CreateEnumShortNameExpression&lt;TEntity, TEnum&gt;(Expression&lt;Func&lt;TEntity, TEnum&gt;&gt; propertyExpression) where TEntity : class where TEnum : struct { var enumValues = Enum.GetValues(typeof(TEnum)).Cast&lt;Enum&gt;(); Expression resultExpression = Expression.Constant(string.Empty); foreach (var enumValue in enumValues) { resultExpression = Expression.Condition( Expression.Equal(propertyExpression.Body, Expression.Constant(enumValue)), Expression.Constant(EnumHelper.GetShortName(enumValue)), resultExpression); } return Expression.Lambda&lt;Func&lt;TEntity, string&gt;&gt;(resultExpression, propertyExpression.Parameters); }</code> </pre> <br><p>  рдХреБрдЫ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдгред  рдХреНрдпреЛрдВрдХрд┐  рд╣рдореЗрдВ рдПрдХ рдФрд░ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдирдкреБрдЯ рдореВрд▓реНрдп рдорд┐рд▓рддрд╛ рд╣реИ, рдлрд┐рд░ рд╣рдореЗрдВ <code>Expression.Parameter</code> рдорд╛рдзреНрдпрдо рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рд╣рдо рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЗрдирдкреБрдЯ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреА рд╕рдВрдкрддреНрддрд┐ рд╕реЗ рд▓реЗрддреЗ рд╣реИрдВ, рдФрд░ рд╕рдВрдкрддреНрддрд┐ рдХреЗ рдореВрд▓реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╢рд░реАрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред <br>  рддреЛ рдЖрдк рдЗрд╕ рддрд░рд╣ рд╕реЗ рдирдИ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs"> CreateMap&lt;FooEntity, FooDto&gt;() .ForMember(x =&gt; x.Enum, options =&gt; options.MapFrom(GetExpression&lt;FooEntity, FooEnum&gt;(x =&gt; x.Enum)));</code> </pre> <br><hr><br><p>  рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкреЗрдбрд╝реЛрдВ рдХреЗ рд╕рднреА рд╕рдлрд▓ рд╡рд┐рдХрд╛рд╕ред </p><br><p>  рдореИрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореИрдХреНрд╕рд┐рдо рдЕрд░реНрд╢рд┐рдиреЛрд╡</a> рдХреЗ рд▓реЗрдЦреЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдЕрддреНрдпрдзрд┐рдХ рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдВред  рд╡рд┐рд╢реЗрд╖ рд░реВрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реЗ рдЙрджреНрдпрдо рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдкреЗрдбрд╝ рдХреЗ</a> рдмрд╛рд░реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЗрдВ</a> ред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi439484/">https://habr.com/ru/post/hi439484/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi439472/index.html">рдХрдВрдкрдиреА рдХреЗ рднреАрддрд░ рд╕реАрдорд╛ рдирд┐рдпрдВрддреНрд░рдг рдХрд╛ рд╕реНрд╡рдЪрд╛рд▓рди</a></li>
<li><a href="../hi439476/index.html">рдХреЙрдХрдиреА рд╕реНрд▓реИрдВрдЧ: рдЖрдзреБрдирд┐рдХ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рд╕рд╛рдорд╛рдЬрд┐рдХ рд╕реНрдерд┐рддрд┐</a></li>
<li><a href="../hi439478/index.html">рдордиреЛрд░рдВрдЬрдХ # рд╕реАред рдХреЙрдлреА рдХреЗ рдкрд╛рдВрдЪ рдЙрджрд╛рд╣рд░рдг рдЯреВрдЯрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi439480/index.html">рд░рд╛рд╕реНрддрд╛ рджреЗрдВ, рдпрд╛ рдЖрдкрдХрд╛ CRM (рдФрд░ CRM) рдзреАрдорд╛ рдХреНрдпреЛрдВ рд╣реЛрддрд╛ рд╣реИ?</a></li>
<li><a href="../hi439482/index.html">devleads - (рдЕрди) рд╡рд┐рддреНрддреАрдп рдкреНрд░реЗрд░рдгрд╛</a></li>
<li><a href="../hi439486/index.html">.NET рд╕рдВрджрд░реНрдн рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдо рдорд╛рди рдкреНрд░рдХрд╛рд░ред рднрд╛рдЧ 1</a></li>
<li><a href="../hi439488/index.html">рдХреНрдпреВрдП рдореАрдЯрдЕрдк рд╡реАрдбрд┐рдпреЛ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ</a></li>
<li><a href="../hi439490/index.html">.NET рд╕рдВрджрд░реНрдн рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдо рдорд╛рди рдкреНрд░рдХрд╛рд░ред рднрд╛рдЧ реи</a></li>
<li><a href="../hi439492/index.html">рдПрдХ рдЕрдЪреНрдЫрд╛ рдЯреЗрдХ рд▓реАрдб рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП 10 рдЯрд┐рдкреНрд╕</a></li>
<li><a href="../hi439496/index.html">рд╡рд╣рд╛рдВ рдмрд┐рд▓рд┐рдВрдЧ рдХреИрд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ: рдЬрдм рдЧреНрд░рд╛рд╣рдХ рдФрд░ рдбреЗрд╡рд▓рдкрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рднрд╛рд╖рд╛рдПрдБ рдмреЛрд▓рддреЗ рд╣реИрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>