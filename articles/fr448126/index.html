<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÆ üë©üèø‚Äçü§ù‚Äçüë©üèº üåú Secrets de l'API des appareils Android. Rapport Yandex ‚ôãÔ∏è üêõ ‚Ü™Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'un des principaux d√©fis du d√©veloppement Android est la fragmentation. Presque tous les fabricants adaptent Android √† leurs besoins. Le d√©veloppeur ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Secrets de l'API des appareils Android. Rapport Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/448126/">  L'un des principaux d√©fis du d√©veloppement Android est la fragmentation.  Presque tous les fabricants adaptent Android √† leurs besoins.  Le d√©veloppeur Andrey Makeev a r√©pertori√© les diff√©rences entre les impl√©mentations des fournisseurs et le projet Open Source Android d'origine.  √Ä partir du rapport, vous pouvez apprendre comment b√©n√©ficier des fonctionnalit√©s individuelles du firmware sur diff√©rents appareils. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/N0KQBUZE78E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - Je programme depuis l'√©cole, je le d√©veloppe pour Android depuis trois ans.  Parmi ceux-ci, j'ai pass√© un an √† Yandex, particip√© √† des projets tels que Launcher et Phone. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/x-/ol/c_/x-olc_qfelylf6-mm3a6vdoxt-y.jpeg"><br><br>  Je veux parler de la fragmentation de l'API des appareils Android - de l'ext√©rieur, du c√¥t√© des d√©veloppeurs d'applications et de l'int√©rieur, du point de vue des d√©veloppeurs de la plate-forme et des t√©l√©phones. <br><br>  Mon rapport se compose de deux parties.  Tout d'abord, parlons de la fa√ßon dont l'API est fragment√©e en externe.  Ensuite, nous passerons en revue le code - nous d√©couvrirons comment la caract√©ristique unique du t√©l√©phone abstrait est r√©alis√©e, comment le d√©veloppement est construit. <br><br>  La fragmentation de l'API est l'un des param√®tres par lesquels vous pouvez fragmenter un p√©riph√©rique.  Le plus √©vident et le plus simple est la fragmentation selon le SDK Android, on la rencontre tous les jours, litt√©ralement d√®s les premiers jours de d√©veloppement pour Android.  Nous savons quoi et dans quelle version de l'API elle est apparue, qu'elle a √©t√© supprim√©e, qu'elle a √©t√© sauvegard√©e, mais qu'elle est toujours disponible et qui a d√©j√† disparu.  En r√®gle g√©n√©rale, nous utilisons diverses biblioth√®ques d'assistance de Google pour simplifier nos vies.  Beaucoup a d√©j√† √©t√© fait pour nous. <br><br><img src="https://habrastorage.org/webt/qf/tq/vh/qftqvhka64nqp6qssqqqa2er6te.jpeg"><br><br><img src="https://habrastorage.org/webt/d0/ig/sx/d0igsx1hnplro-2u-tx9_iln0qo.jpeg"><br><br>  Dans notre code, cela ressemble √† ceci: nous activons certaines fonctionnalit√©s, d√©sactivons certaines - selon la version du SDK dans laquelle nous sommes actuellement.  Si vous en utilisez, ils font g√©n√©ralement la m√™me chose, mais √† l'int√©rieur. <br><br>  Nous ne nous concentrerons pas sur ce type de fragmentation.  Les inconv√©nients sont connus de tous - nous sommes oblig√©s de conserver toute une flotte d'appareils avec diff√©rentes versions afin de tester au moins notre application.  De plus, nous sommes oblig√©s d'√©crire du code suppl√©mentaire.  Cela est particuli√®rement g√™nant lorsque vous venez de commencer √† d√©velopper pour Android et cela se r√©v√®le soudainement: vous devez savoir ce qui √©tait l√† il y a deux ou trois ans afin de prendre en charge certains anciens appareils.  Aspects positifs: l'API se d√©veloppe, la technologie progresse, Android gagne de nouveaux utilisateurs, elle devient plus pratique pour les d√©veloppeurs et les utilisateurs. <br><br>  Comment travaillons-nous avec cela?  Nous utilisons √©galement des biblioth√®ques et sommes tr√®s heureux lorsque nous refusons de prendre en charge les anciennes versions.  Je pense que dans la vie de tous ceux qui font cela depuis plus d'un an, il y a eu un tel moment.  C'est juste du bonheur.  Il s'agit d'une option de fragmentation √©vidente et simple.  Ensuite, la fragmentation de type Android.  Il y en a plusieurs.  Android TV parle de lui-m√™me, Android Auto est principalement destin√© aux autoradios, Android Things - pour l'IoT et les appareils embarqu√©s similaires.  W est Wear OS, l'ancienne montre Android, regardez pour Android.  Nous allons essayer de voir √† quoi cela ressemble du c√¥t√© du d√©veloppeur.  Et, plus int√©ressant, essayons de voir √† quoi cela ressemble de l'int√©rieur. <br><br><img src="https://habrastorage.org/webt/vk/e-/51/vke-51qsyadiojfl-jdhcystsqk.jpeg"><br><br>  Prenez deux exemples de developer.android.com.  Le premier est Wear OS.  De quoi avons-nous besoin pour faire une demande?  Nous ajoutons une d√©pendance compileOnly √† build.gradle et √©crivons deux lignes suppl√©mentaires dans le manifeste: uses-feature android.hardware.type.watch et uses-library, qui correspond au m√™me nom de package que la biblioth√®que que nous avons connect√©e. <br><br><img src="https://habrastorage.org/webt/ny/az/lb/nyazlbzf4abkspkjvz2nrdy0ek8.jpeg"><br><br>  Comment mettons-nous en ≈ìuvre quelque chose?  Nous cr√©ons une activit√©, seulement dans ce cas, nous ne d√©pensons pas une activit√© standard avec laquelle nous sommes habitu√©s √† travailler, et pas m√™me une activit√© composite, mais WearableActivity, et appelons des m√©thodes qui lui sont sp√©cifiques, dans ce cas, setAmbientEnabled ().  Donc, nous avons une d√©pendance compileOnly, c'est-√†-dire qu'elle n'entre pas dans le cours de notre application.  Uses-library, qui, apparemment, oblige le syst√®me d'exploitation √† nous connecter ces classes et ce code lors de l'ex√©cution sur le p√©riph√©rique, et les nouvelles classes que nous utilisons. <br><br><img src="https://habrastorage.org/webt/o4/2d/gn/o42dgn9euh986enbms6qkzbf6za.jpeg"><br><br>  L'API Android Things n'est pratiquement pas diff√©rente.  Nous ne prescrivons pas la fonction uses, seulement la biblioth√®que uses, la d√©pendance compileOnly. <br><br><img src="https://habrastorage.org/webt/b4/_l/ad/b4_ladqetwuszdbbmov1fgrlaxy.jpeg"><br><br>  Nous cr√©ons une activit√©, dans ce cas, elle est unique √† l'API Android Things, la classe PeripheralManager.  Nous sondons le GPIO et essayons de nous engager. <br><br><img src="https://habrastorage.org/webt/ea/i8/yc/eai8yckgovuw0wa7mbz_oc7nxy4.jpeg"><br><br>  Comment une telle application se comportera-t-elle sur votre t√©l√©phone?  Il y a deux options. <br><br><img src="https://habrastorage.org/webt/yr/tz/ei/yrtzeip9jrmya-notrdp4ftvque.jpeg"><br><br>  Si nous avons indiqu√© que uses-library android: required = "true", nous n'avons pas rempli les exigences obligatoires du PackageManager pour installer l'application, et il refuse essentiellement de l'installer.  Si nous avons sp√©cifi√© android: required = ‚Äùfalse‚Äù, l'application sera install√©e, mais lorsque nous essayons d'acc√©der √† la classe PeripheralManager, nous obtenons NoClassDefFoundError, car il n'y a pas une telle classe dans Android standard. <br><br>  Quelles en sont les conclusions?  Nous connectons la d√©pendance compileOnly uniquement afin de la contacter lors de l'assemblage, et les classes que nous utilisons nous attendent sur le p√©riph√©rique, elles sont connect√©es √† l'aide de certaines lignes du manifeste.  Parfois, nous prescrivons une fonctionnalit√© qui est plus souvent n√©cessaire pour distinguer sur Google Play un appareil auquel cette application peut ou ne peut pas √™tre distribu√©e. <br><br>  Je ne pouvais pas distinguer les c√¥t√©s n√©gatifs de ce type de fragmentation.  Seuls ceux qui ont d√©velopp√© raconteront de nombreuses histoires sur la fa√ßon dont ils ont rencontr√© des bugs inconnus compl√®tement incompr√©hensibles qu'ils n'ont pas rencontr√©s au t√©l√©phone.  Le c√¥t√© positif est que ce sont des march√©s suppl√©mentaires, des utilisateurs suppl√©mentaires, une exp√©rience suppl√©mentaire, c'est toujours bon. <br><br>  Comment travailler avec?  √âcrivez plus d'applications.  La recommandation g√©n√©rale est d'√©crire plus d'une version de l'application pour tous les types d'Android, mais toujours d'en faire diff√©rentes.  Il devrait y en avoir moins pour une montre, pour Android Things, pratiquement rien de ce qui est √©crit sur le t√©l√©phone ne convient, etc.  Et utilisez les biblioth√®ques que les d√©veloppeurs Android et, parfois, les d√©veloppeurs d'appareils nous fournissent. <br><br>  Le type de fragmentation suivant le moins √©tudi√© est la fragmentation des producteurs.  Chaque fabricant, apr√®s avoir re√ßu le code source - dans de rares cas c'est AOSP, le plus souvent il est en quelque sorte modifi√© par les d√©veloppeurs de mat√©riel - y apporte des modifications.  En r√®gle g√©n√©rale, nous ne d√©couvrons les effets n√©gatifs de ce type de fragmentation que sur les meilleurs canaux - √† partir de critiques n√©gatives sur Google Play, car quelqu'un a cass√© quelque chose.  Ou nous apprenons cela de l'analyse des plantages, lorsque soudainement quelque chose plante de fa√ßon incompr√©hensible, uniquement sur certains appareils sp√©cifiques.  Dans le meilleur des cas, nous apprenons cela de notre QA, quand quelque chose s'est cass√© pendant leurs tests sur un appareil sp√©cifique. <br><br><img src="https://habrastorage.org/webt/hz/ag/7w/hzag7wj3ekniejprurricmjwvtq.jpeg"><br><br>  Sur ce sujet, j'ai une merveilleuse histoire de notre lanceur de d√©veloppement.  Nous avons re√ßu un rapport de bogue o√π l'activit√© ne s'√©tendait pas en plein √©cran et notre fond d'√©cran par d√©faut pr√©f√©r√© n'√©tait pas du tout affich√©.  Il n'a pas √©t√© d√©cod√©, a montr√© une fen√™tre vide.  Nous n'avions m√™me pas d'appareils pour le reproduire.  En nous √©tirant √† l'√©cran, nous avons toujours pu trouver un appareil bas de gamme sur lequel il ne fonctionnait pas, et tout a √©t√© facilement r√©solu √† l'aide d'Android: resizeableActivity = "true" dans le manifeste.  Avec le papier peint, tout s'est av√©r√© beaucoup plus compliqu√©.  Environ deux jours, nous avons essay√© de tendre la main et d'obtenir des informations plus d√©taill√©es.  √Ä la fin, ils ont d√©couvert que sur un certain nombre d'appareils, le codec de d√©codage jpeg progressif √©tait impl√©ment√© avec des bogues, lorsque plusieurs algorithmes de compression √©taient utilis√©s sur les r√©sultats des autres.  Dans ce cas, nous venons d'√©crire un lint-check, qui √©choue √† la construction lors de la construction de l'application, si nous mettons le papier peint encod√© de mani√®re progressive dans l'apk lui-m√™me.  Recod√© tous les fonds d'√©cran, r√©p√©t√© la situation sur le backend, qui distribue le reste des ensembles de fonds d'√©cran, et tout fonctionne tr√®s bien.  Mais cela nous a co√ªt√© environ deux jours de proc√©dure. <br><br><img src="https://habrastorage.org/webt/qk/bv/cl/qkbvclmcafam7jog_rh9quaybcw.jpeg"><br><br>  Cela ressemble √† ceci dans le code.  D√©sagr√©able, mais malheureusement, comme √ßa.  Habituellement, ces lignes apparaissent apr√®s un long d√©bogage. <br><br><img src="https://habrastorage.org/webt/fs/ph/km/fsphkm8tzz4jyjrdht9bn8yw3a8.jpeg"><br><br>  Quelles garanties Google nous donne-t-il pour garantir que l'API ne soit pas tellement cass√©e que les applications ne fonctionnent pas en principe?  Tout d'abord, il existe un CDD qui d√©crit ce qui est possible et ce qui ne peut pas √™tre chang√©, ce qui est r√©trocompatible et ce qui ne l'est pas.  Il s'agit d'un document de plusieurs dizaines de pages contenant des recommandations g√©n√©rales qui, bien entendu, ne couvriront pas tous les cas.  Pour couvrir plus de cas, il existe CTS, qui doit √™tre rempli pour que le t√©l√©phone re√ßoive la certification de Google et les services Google peuvent √™tre utilis√©s √† partir de celui-ci.  Il s'agit d'un ensemble d'environ 350 000 tests automatis√©s.  Il existe √©galement un v√©rificateur CTS, un fichier APK normal que vous pouvez mettre sur votre t√©l√©phone pour effectuer une s√©rie de v√©rifications.  Soit dit en passant, si vous achetez un t√©l√©phone avec vos mains, vous pouvez le v√©rifier comme √ßa. <br><br>  Avec l'av√®nement de Treble, le projet VTS est apparu, il est plus probable pour les d√©veloppeurs de niveaux inf√©rieurs.  Il v√©rifie les API du pilote qui, √† partir de Project Treble, sont versionn√©es et subissent √©galement des tests similaires.  En outre, les d√©veloppeurs de t√©l√©phones eux-m√™mes sont des personnes en bonne sant√© qui souhaitent que les applications Android fonctionnent correctement pour eux, mais c'est un espoir.  Le c√¥t√© n√©gatif est que nous rencontrons des bugs impr√©vus qui ne peuvent √™tre pr√©dits avant le lancement de l'application sur l'appareil.  Encore une fois, nous sommes oblig√©s d'acheter, en plus du fait que diff√©rentes versions de l'API, il existe √©galement des appareils suppl√©mentaires de diff√©rents fabricants afin de les v√©rifier. <br><br>  Mais il y a des aspects positifs.  Au minimum, les fonctionnalit√©s les plus fr√©quemment impl√©ment√©es par les fabricants rel√®vent d'Android lui-m√™me.  Quelqu'un peut se souvenir que l'API Fingerprint standard est apparue plus tard que les appareils qui pouvaient d√©verrouiller l'√©cran avec une empreinte digitale.  Maintenant, selon les d√©veloppeurs XDA, l'API Android veut √©galement d√©verrouiller en utilisant la cam√©ra en face, mais ce n'est pas encore exact.  Nous allons probablement en savoir plus avec vous. <br><br>  De plus, les d√©veloppeurs d'appareils eux-m√™mes, lorsqu'ils cr√©ent des API non standard, ils peuvent, et de nombreuses biblioth√®ques de publication, travailler avec leur API pour les d√©veloppeurs ordinaires.  Et si vous ne l'avez jamais fait auparavant, je vous conseille de parcourir les statistiques d'utilisation de votre application, de voir quels sont les fabricants les plus populaires, et de regarder les portails d√©veloppeurs de leurs sites.  Je pense que vous serez agr√©ablement surpris que beaucoup aient des API avec des fonctionnalit√©s mat√©rielles int√©ressantes, des fonctionnalit√©s de s√©curit√©, des services cloud ou autre chose d'int√©ressant.  Et √† premi√®re vue, il semble insens√© d'√©crire des fonctionnalit√©s distinctes pour des appareils individuels, mais en plus des appareils, il existe √©galement des fabricants de processeurs, encore plus petits, qui impl√©mentent √©galement leurs API.  Par exemple, Qualcomm a une merveilleuse acc√©l√©ration mat√©rielle pour reconna√Ætre les images de la cam√©ra, que vous pouvez utiliser, ils en ont m√™me une bonne description. <br><br>  Ainsi, n'importe lequel d'entre vous peut b√©n√©ficier de ce type de fragmentation.  Que faisons-nous avec √ßa?  En aucun cas, n'h√©sitez pas √† signaler des bogues et √† envoyer des rapports de bogues aux d√©veloppeurs d'appareils et m√™me aux d√©veloppeurs Android.  Parce que si des API qui valaient la peine d'√©crire le test CTS ont √©t√© cass√©es, alors elles seront √©crites - et il y avait de tels pr√©c√©dents - et apr√®s cela, l'API est devenue plus fiable. <br><br>  Apprenez Android, d√©couvrez ce que les fabricants proposent, ne jurez pas avec eux - travaillez avec eux. <br><br>  √Ä quoi √ßa ressemble de l'int√©rieur?  Comment puis-je impl√©menter une fonctionnalit√© qui sera unique √† notre t√©l√©phone et utiliser cette API √† partir d'une application Android normale? <br><br><img src="https://habrastorage.org/webt/-0/lw/np/-0lwnpd7n_agyjhtdbvtbo-_6gi.jpeg"><br><br>  Un peu de th√©orie.  Comment les d√©veloppeurs Android d√©crivent-ils eux-m√™mes le p√©riph√©rique AOSP interne?  La couche sup√©rieure est une application qui a √©t√© √©crite par vous ou par les d√©veloppeurs du t√©l√©phone lui-m√™me, qui n'a pas de droits √©lev√©s, utilise simplement des API standard.  Ceci est un framework, ce sont des classes qui ne font pas partie de votre application, telles que Activity, Parcelable, Bundle - elles font partie du syst√®me, elles sont appel√©es framework.  Les classes disponibles sur l'appareil.  Viennent ensuite les services syst√®me.  C'est ce qui vous connecte au syst√®me: ActivityManagerService, WindowManagerService, PackageManagerService, qui impl√©mentent le c√¥t√© interne de l'interaction avec le syst√®me. <br><br>  Viennent ensuite la couche d'abstraction mat√©rielle, c'est la couche sup√©rieure des pilotes, qui contient toute la logique d'affichage √† l'√©cran, d'interaction avec Bluetooth et autres.  Le noyau est la couche inf√©rieure des pilotes, la gestion du syst√®me.  Ceux qui savent ce qu'est le noyau et auquel il est confront√© n'ont pas besoin de le dire, mais vous pouvez parler longtemps. <br><br><img src="https://habrastorage.org/webt/fp/lt/l3/fpltl3z44nvcpr9cnhadvf32oik.jpeg"><br><br>  √Ä quoi cela ressemble-t-il sur l'appareil?  Notre application interagit non seulement avec le cadre standard, mais peut √©galement interagir avec le cadre personnalis√© du fabricant.  De plus, gr√¢ce √† ce cadre, il peut communiquer avec des services personnalis√©s.  S'il s'agit de fonctionnalit√©s c√¢bl√©es ou de bas niveau, alors HAL est √©crit pour elles, et m√™me des pilotes au niveau du noyau, si n√©cessaire. <br><br><img src="https://habrastorage.org/webt/ug/rf/un/ugrfunvrkrwxekn0jvxjwiuwdfg.jpeg"><br><br>  Comment √©crivons-nous notre fonctionnalit√©?  Le plan est simple: vous devez √©crire un framework qui n'est pas tr√®s diff√©rent des biblioth√®ques que la plupart des d√©veloppeurs Android ont √©crites, je pense que vous le savez tous.  Vous devez √©crire un service syst√®me, qui est une application ordinaire, uniquement avec un ensemble de droits pas tout √† fait ordinaire dans le syst√®me.  Et si n√©cessaire, vous pouvez √©crire HAL, mais nous omettons cela.  Vous pouvez √©crire vos propres pilotes au niveau du noyau, mais nous ne le consid√©rerons pas non plus.  Et √©crivez une application client qui utilisera tout cela. <br><br><img src="https://habrastorage.org/webt/ox/e9/a3/oxe9a3ty2mwzut11ygakkf3rb3e.jpeg"><br><br>  Pour pouvoir interagir avec le syst√®me, nous devons r√©diger une sorte de contrat, et pour cela il existe d√©j√† un bon m√©canisme pour les interfaces AIDL.  C‚Äôest juste une sorte d‚Äôinterface sur la base de laquelle le syst√®me g√©n√®re une classe suppl√©mentaire que nous pouvons √©tendre, √† travers laquelle la communication interprocessus entre votre application et les services syst√®me est effectu√©e. <br><br><img src="https://habrastorage.org/webt/gq/ya/ao/gqyaaombrkaywxj_naka1edc5fu.jpeg"><br><br>  Ensuite, nous √©crivons un framework, notre biblioth√®que, qui contient l'impl√©mentation de cette interface, et proc√®de par procuration √† tous les appels.  Si vous √™tes int√©ress√©, alors ActivityManager, PackageManager, WindowManager fonctionnent de la m√™me mani√®re.  Il y a un peu plus de logique que ce que nous avons mis en ≈ìuvre ici, mais l'essentiel est juste cela. <br><br><img src="https://habrastorage.org/webt/9m/5h/jn/9m5hjny8quqv2hin-be4cftx_zk.jpeg"><br><br>  Nous avons impl√©ment√© le framework, nous devons √©crire un service syst√®me qui recevra nos donn√©es du c√¥t√© syst√®me, dans ce cas, nous transmettons et lisons un entier.  Nous cr√©ons une classe, elle √©tend √©galement l'interface qui a √©t√© g√©n√©r√©e √† partir d'AIDL sur la diapositive pr√©c√©dente.  Nous cr√©ons un champ dans lequel nous √©crivons des valeurs, lisons, √©crivons un setter, getter.  La seule chose est qu'il n'y a pas assez de verrous, mais ils ne tenaient pas beaucoup sur la glissi√®re, ils devraient √™tre faits. <br><br><img src="https://habrastorage.org/webt/co/wz/no/cowznogjbu9jlrsvhnxxurm6in8.jpeg"><br><br>  De plus, pour que ce service syst√®me soit disponible, nous devons l'enregistrer dans le gestionnaire de services syst√®me, et dans ce cas, c'est la m√™me classe qui n'est pas disponible pour les applications ordinaires.  Il est disponible pr√©cis√©ment pour ceux qui sont dans la plate-forme dans les partitions du syst√®me.  Nous enregistrons le service simplement dans Application.onCreate (), le rendons disponible sous le nom de la classe que nous avons cr√©√©e. <br><br>  De quoi avons-nous besoin pour que onCreate () d√©marre et que notre service soit charg√© en m√©moire?  Nous √©crivons dans le manifeste dans l'application android: persistent = ‚Äùtrue‚Äù.  Cela signifie qu'il s'agit d'un processus persistant, il doit √™tre constamment en m√©moire, car il ex√©cute des fonctions syst√®me. <br><br><img src="https://habrastorage.org/webt/iq/sn/q5/iqsnq5bwcen_faerouvcj9n1qq8.jpeg"><br><br>  Dans le manifeste lui-m√™me, nous pouvons √©galement sp√©cifier android: sharedUserId, dans ce cas, le syst√®me, mais il peut s'agir d'une large gamme d'ID diff√©rents, ils permettent √† l'application d'obtenir des droits plus √©tendus sur le syst√®me, d'interagir avec diverses API et services qui ne sont pas disponibles pour les applications ordinaires. <br><br>  Dans ce cas, par exemple, nous n'avons rien utilis√© de tel. <br><br><img src="https://habrastorage.org/webt/qx/ds/s-/qxdss-ivnge6oagknlzx59wee9u.jpeg"><br><br>  Nous avons √©crit un cadre, √©crit un service syst√®me.  Nous allons omettre les m√©canismes √† l'int√©rieur, c'est un sujet quelque peu compliqu√©, il m√©rite un rapport s√©par√©. <br><br>  Comment fournir le framework aux d√©veloppeurs d'applications?  Deux formats.  Nous pouvons √©mettre des classes √† part enti√®re et cr√©er une biblioth√®que √† part enti√®re que vous compilez dans votre application, et toute la logique fera partie de vos dexes. <br><br>  Ou vous pouvez distribuer le cadre sous la forme de classes de stub, par rapport auxquelles vous ne pouvez lier qu'au moment de la compilation et vous attendre √† ce que ces classes vous attendent de la m√™me mani√®re que les exemples pr√©c√©dents de diff√©rentes versions d'Android sur l'appareil lui-m√™me.  Vous pouvez le distribuer via un r√©f√©rentiel Maven ordinaire que tout le monde conna√Æt ou via Android Studio sdkmanager, de la m√™me mani√®re que vous installez de nouvelles versions du SDK.  Il est difficile de dire quelle m√©thode est la plus pratique.  Il est plus pratique pour moi de connecter Maven personnellement. <br><br><img src="https://habrastorage.org/webt/k_/a5/oo/k_a5ookzluycn3qz3uivbrdepwk.jpeg"><br><br>  Nous √©crivons une application simple.  De mani√®re famili√®re, nous connectons la d√©pendance compileOnly, seulement maintenant c'est notre biblioth√®que.  Nous prescrivons une biblioth√®que d'utilisations que nous avons √©crite et que nous avons mise sur l'appareil.  Nous √©crivons Activity, obtenons l'acc√®s √† ces classes, interagissons avec le syst√®me.  Il serait donc possible de mettre en ≈ìuvre absolument toutes les fonctionnalit√©s: transfert de donn√©es vers certains appareils suppl√©mentaires, fonctionnalit√©s mat√©rielles suppl√©mentaires, etc. <br><br>  Ainsi, tous les d√©veloppeurs mettent des fonctionnalit√©s uniques de l'appareil √† la disposition des d√©veloppeurs.  Parfois, ce sont des API priv√©es qui ne donnent qu'aux partenaires.  Parfois, ils sont publics et ceux que vous pouvez trouver sur les portails de d√©veloppeurs.  Il existe d'autres fa√ßons de mettre en ≈ìuvre de telles choses, mais j'ai d√©crit une m√©thode qui est consid√©r√©e comme la principale de Google et des d√©veloppeurs Android. <br><br>  Vous ne devez pas traiter les d√©veloppeurs d'appareils comme des personnes qui cassent vos applications.  Ce sont les m√™mes d√©veloppeurs, ils √©crivent le m√™me code, √† peu pr√®s au m√™me niveau.  R√©diger des rapports de bugs, ils aident vraiment, je les analyse souvent.  √âcrivez plus d'applications et profitez des opportunit√©s qu'offre Android et l'appareil lui-m√™me.  J'ai tout. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448126/">https://habr.com/ru/post/fr448126/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448116/index.html">Disque hybride Intel Optane Memory H10 - Sp√©cifications des fonctionnalit√©s</a></li>
<li><a href="../fr448118/index.html">SEO et publicit√© contextuelle - conduit pour 175 mille roubles par jour √† Izhevsk</a></li>
<li><a href="../fr448120/index.html">√Ä propos de la proximit√© des sommets</a></li>
<li><a href="../fr448122/index.html">Comment ReactJS fonctionne Forfait React</a></li>
<li><a href="../fr448124/index.html">Mikrotik. Contr√¥le SMS √† l'aide du serveur WEB</a></li>
<li><a href="../fr448128/index.html">9 conseils pour utiliser la biblioth√®que Cats √† Scala</a></li>
<li><a href="../fr448130/index.html">Conception de deckbuilding de jeux vid√©o</a></li>
<li><a href="../fr448136/index.html">Instructions: comment tester les r√¥les ansibles et d√©couvrir les probl√®mes avant la production</a></li>
<li><a href="../fr448140/index.html">SNA Hackathon 2019 - r√©sultats</a></li>
<li><a href="../fr448142/index.html">O√π convergent preuves, faits et imagination</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>