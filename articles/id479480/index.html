<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöê üö£üèΩ ü•¢ SARIF SDK dan Kesalahannya ‚ôäÔ∏è ‚è¨ üë®üèº‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari ini kami memiliki proyek Microsoft lain yang berkualitas tinggi untuk diperiksa, yang dengan gagah hati kami akan mencoba mencari kesalahan denga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SARIF SDK dan Kesalahannya</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/479480/"><p><img src="https://habrastorage.org/getpro/habr/post_images/895/fa2/6ea/895fa26ea315d6cb73f0f5fcd0d569e5.png" alt="Gambar 2" align="left"></p>  Hari ini kami memiliki proyek Microsoft lain yang berkualitas tinggi untuk diperiksa, yang dengan gagah hati kami akan mencoba mencari kesalahan dengan PVS-Studio.  SARIF, akronim untuk Format Interchange Analisis Static, yang merupakan standar (format file), dirancang untuk berinteraksi dan berbagi hasil analisis statis dengan alat lain: IDE, verifikasi kode kompleks dan alat analisis (misalnya SonarQube), sistem integrasi berkelanjutan, dll.  SARIF SDK, masing-masing, berisi alat pengembang .NET untuk mendukung SARIF serta file tambahan. <br><a name="habracut"></a><br>  SARIF berasal dari Microsoft dan sekarang merupakan standar yang dikembangkan oleh OASIS (konsorsium nirlaba yang berhubungan dengan standar terbuka).  SARIF dimaksudkan untuk memberikan tidak hanya hasil analisa, tetapi juga metadata tentang alat, serta data tentang bagaimana alat itu diluncurkan, label waktu, dan sebagainya.  Untuk informasi lebih lanjut, kunjungi situs web <a href="https://www.oasis-open.org/committees/tc_home.php%3Fwg_abbrev%3Dsarif">OASIS</a> .  Kode sumber SARIF SDK dapat diunduh dari repositori di <a href="https://github.com/microsoft/sarif-sdk">GiHub</a> .  Beranda proyek tersedia melalui <a href="http://sarifweb.azurewebsites.net/">tautan</a> . <br><br><h2>  Tentang proyek </h2><br>  Proyek SARIF SDK ternyata berukuran kecil: 799 file .cs (sekitar 98.000 baris kode tidak kosong).  Proyek ini berisi tes yang selalu saya kecualikan dari cek.  Dengan demikian, bagian dari kode yang kami minati adalah 642 file .cs (sekitar 79.000 baris kode tidak kosong).  Itu tentu saja tidak cukup.  Di sisi positifnya, pemeriksaan dan analisisnya mudah dan cepat, antara ini dan kemudian, yang saya coba renungkan pada gambar di awal.  Meskipun demikian, saya berhasil melacak beberapa kasus luar biasa.  Mari kita lihat mereka. <br><br><h2>  Kesalahan </h2><br>  <a href="https://www.viva64.com/en/w/v3070/">V3070</a> [CWE-457] Variabel 'Biner' yang tidak diinisialisasi digunakan ketika menginisialisasi variabel 'Default'.  MimeType.cs 90 <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MimeType</span></span> { .... <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment">The MIME type to use when no better MIME type is known.</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public static readonly string Default = Binary; .... </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment">The MIME type for binaries.</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public static readonly string Binary = "application/octet-stream"; .... }</span></span></code> </pre> <br>  Bidang diinisialisasi dengan nilai bidang lain, yang belum menerima nilai.  Akibatnya, <i>Default</i> akan menerima nilai nol secara default untuk tipe <i>string</i> .  Kemungkinan besar, kesalahan itu tetap tidak diperhatikan, karena bidang <i>Default</i> tidak digunakan di mana pun.  Tetapi berbagai hal dapat berubah, dan kemudian pengembang akan menghadapi hasil yang tidak semestinya atau program macet. <br><br>  <a href="https://www.viva64.com/en/w/v3061/">V3061</a> Parameter 'logicalLocationToIndexMap' selalu ditulis ulang dalam tubuh metode sebelum digunakan.  PrereleaseCompatibilityTransformer.cs 1963 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> JArray </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertLogicalLocationsDictionaryToArray</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> .... Dictionary&lt;LogicalLocation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; logicalLocationToIndexMap, ....</span></span></span><span class="hljs-function">)</span></span> { .... logicalLocationToIndexMap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;LogicalLocation, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(LogicalLocation.ValueComparer); .... }</code> </pre><br>  Penulis kode tidak menggunakan parameter <i>logicalLocationToIndexMap</i> dengan cara apa pun, tetapi menulis nilai yang berbeda di dalamnya.  Anehnya, nilai sebelumnya persis sama dengan kamus kosong, dibuat dalam kode pemanggil: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApplyChangesFromTC25ThroughTC30</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... Dictionary&lt;LogicalLocation, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; logicalLocationToIndexMap = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; .... logicalLocationToIndexMap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;LogicalLocation, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(LogicalLocation.ValueComparer); run[<span class="hljs-string"><span class="hljs-string">"logicalLocations"</span></span>] = ConvertLogicalLocationsDictionaryToArray( ...., logicalLocationToIndexMap, ....); }</code> </pre> <br>  Kode aneh dan mencurigakan. <br><br>  <a href="https://www.viva64.com/en/w/v3008/">V3008</a> [CWE-563] Variabel 'run.Tool' diberi nilai dua kali berturut-turut.  Mungkin ini sebuah kesalahan.  Periksa baris: 116, 114. ExportRulesMetadataCommandBase.cs 116 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Run</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Tool Tool { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } .... } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Tool</span></span> : .... { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Tool</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } .... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OutputSarifRulesMetada</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> run = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Run(); run.Tool = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tool(); run.Tool = Tool.CreateFromAssemblyData(....); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  Properti <i>run.Tool</i> diberi nilai dua kali.  Baik saat membuat objek <i>Alat</i> dan saat menulis nilai di properti <i>Alat</i> , tidak ada pekerjaan tambahan yang diperlukan.  Karena itu, pengalihan bau amis. <br><br>  <a href="https://www.viva64.com/en/w/v3042/">V3042</a> [CWE-476] Kemungkinan NullReferenceException.  '?.'  dan '.'  operator digunakan untuk mengakses anggota objek 'loc' WhereComparer.cs 152 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Uri </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ArtifactUri</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ArtifactLocation loc, Run run</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loc?.Uri ?? loc.Resolve(run)?.Uri; }</code> </pre> <br>  Jika nilai variabel <i>loc</i> adalah <i>null</i> , akan dilakukan upaya untuk mengembalikan nilai dari bagian kanan ??  operator, menghasilkan akses dengan referensi nol. <br><br>  <a href="https://www.viva64.com/en/w/v3042/">V3042</a> [CWE-476] Kemungkinan NullReferenceException.  '?.'  dan '.'  operator digunakan untuk mengakses anggota objek 'formatString' InsertOptionalDataVisitor.cs 194 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> Message </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VisitMessage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Message node</span></span></span><span class="hljs-function">)</span></span> { .... node.Text = node.Arguments?.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(...., formatString.Text, ....) : formatString?.Text; .... }</code> </pre> <br>  Pengembang menggunakan opsi akses tidak aman dan aman dengan referensi <i>formatString yang</i> berpotensi nol di dua cabang paralel dari persyaratan: Operator. <br><br>  <a href="https://www.viva64.com/en/w/v3042/">V3042</a> [CWE-476] Kemungkinan NullReferenceException.  '?.'  dan '.'  operator digunakan untuk mengakses anggota objek 'messageText' FortifyFprConverter.cs 1210 <br><br>  <a href="https://www.viva64.com/en/w/v3042/">V3042</a> [CWE-476] Kemungkinan NullReferenceException.  '?.'  dan '.'  operator digunakan untuk mengakses anggota objek 'messageText' FortifyFprConverter.cs 1216 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddMessagesToResult</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Result result</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> messageText = (rule.ShortDescription ?? rule.FullDescription)?.Text; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { <span class="hljs-comment"><span class="hljs-comment">// Replace the token with an embedded hyperlink. messageText = messageText.Replace(....); } else { // Replace the token with plain text. messageText = messageText.Replace(....); } .... }</span></span></code> </pre> <br>  Di sini analis mengeluarkan dua peringatan tentang kemungkinan akses dengan referensi <i>messageText</i> nol.  Itu terlihat agak tidak mengancam, tapi itu masih kesalahan. <br><br>  <a href="https://www.viva64.com/en/w/v3080/">V3080</a> [CWE-476] Kemungkinan null dereference.  Pertimbangkan untuk memeriksa 'fileDataVersionOne.Uri'.  SarifCurrentToVersionOneVisitor.cs 1030 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> IDictionary&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">, FileDataVersionOne&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFileDataVersionOneDictionary</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... FileDataVersionOne fileDataVersionOne = CreateFileDataVersionOne(v2File); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fileDataVersionOne.Uri.OriginalString.Equals(key)) { .... } .... }</code> </pre> <br>  Analisator curiga bahwa <i>NullReferenceException</i> dimungkinkan ketika bekerja dengan referensi <i>fileDataVersionOne.Uri</i> .  Mari kita lihat dari mana variabel ini berasal dan cari tahu apakah alat analisisnya benar.  Untuk melakukan ini, mari kita melihat dekat tubuh dari metode <i>CreateFileDataVersionOne</i> : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> FileDataVersionOne </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFileDataVersionOne</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Artifact v2FileData</span></span></span><span class="hljs-function">)</span></span> { FileDataVersionOne fileData = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v2FileData != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... fileData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileDataVersionOne { .... Uri = v2FileData.Location?.Uri, .... }; .... } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fileData; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">FileDataVersionOne</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Uri Uri { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } .... }</code> </pre> <br>  Memang, saat membuat objek dari kelas <i>FileDataVersionOne</i> , properti <i>Uri</i> mungkin menerima nilai <i>nol</i> .  Ini adalah contoh yang bagus analisis aliran data dan mekanisme analisis antarproedural yang bekerja bersama. <br><br>  <a href="https://www.viva64.com/en/w/v3080/">V3080</a> [CWE-476] Kemungkinan null dereference.  Pertimbangkan untuk memeriksa '_jsonTextWriter'.  SarifLogger.cs 242 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_closeWriterOnDispose) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_textWriter != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _textWriter.Dispose(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_jsonTextWriter == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _jsonTextWriter.Close(); } <span class="hljs-comment"><span class="hljs-comment">// &lt;= } .... }</span></span></code> </pre> <br>  Ada kesalahan ketik dalam fragmen ini.  Jelas bahwa <i>_jsonTextWriter! = Null</i> harus dalam kondisi blok kedua.  Sepotong kode ini membahayakan karena, kemungkinan besar, itu tidak macet, karena <i>_jsonTextWriter</i> menjadi <i>nonnull</i> .  Selain itu, alirannya tetap terbuka. <br><br>  <a href="https://www.viva64.com/en/w/v3083/">V3083</a> [CWE-367] Doa yang tidak aman dari acara 'RuleRead', NullReferenceException dimungkinkan.  Pertimbangkan menugaskan acara ke variabel lokal sebelum menjalankannya.  FxCopConverter.cs 897 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadRule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RuleRead != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { RuleRead(....); } .... }</code> </pre> <br>  Acara ditangani dengan tidak aman.  Ini adalah bug tidak kritis yang dapat dengan mudah diperbaiki, misalnya, dengan mengikuti tip Visual Studio.  Inilah penggantian yang disarankan oleh IDE: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadRule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... RuleRead?.Invoke(....); .... }</code> </pre> <br>  Hanya perlu beberapa detik untuk memperbaikinya, tetapi penganalisa tidak akan lagi mengeluh tentang hal itu dan IDE tidak akan menyoroti kode.  Kesalahan serupa lainnya. <br><br><ul><li>  V3083 [CWE-367] Doa yang tidak aman dari acara 'ResultRead', NullReferenceException dimungkinkan.  Pertimbangkan menugaskan acara ke variabel lokal sebelum menjalankannya.  FxCopConverter.cs 813 </li></ul><br>  <a href="https://www.viva64.com/en/w/v3095/">V3095</a> [CWE-476] Objek 'v1Location' digunakan sebelum diverifikasi terhadap null.  Periksa baris: 333, 335. SarifVersionOneToCurrentVisitor.cs 333 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> Location </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateLocation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">LocationVersionOne v1Location</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> key = v1Location.LogicalLocationKey ?? v1Location.FullyQualifiedLogicalName; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v1Location != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } .... }</code> </pre> <br>  Penulis berpikir bahwa referensi <i>v1Location</i> mungkin nol dan menambahkan cek yang sesuai.  Sedangkan di atas kita dapat melihat bahwa referensi ini ditangani tanpa pemeriksaan.  Refactoring lalai?  Anda tidak pernah tahu. <br><br>  <a href="https://www.viva64.com/en/w/v3125/">V3125</a> [CWE-476] Objek 'v1StackFrame' digunakan setelah diverifikasi terhadap nol.  Periksa baris: 1182, 1171. SarifVersionOneToCurrentVisitor.cs 1182 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> StackFrame </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateStackFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">StackFrameVersionOne v1StackFrame</span></span></span><span class="hljs-function">)</span></span> { StackFrame stackFrame = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v1StackFrame != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { stackFrame = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StackFrame { .... }; } stackFrame.Location = CreateLocation(v1StackFrame.FullyQualifiedLogicalName, v1StackFrame.LogicalLocationKey, ....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stackFrame; }</code> </pre> <br>  Seperti biasa, inilah kasus sebaliknya.  Pertama referensi <i>v1StackFrame</i> diperiksa untuk <i>null</i> , dan kemudian cek hilang.  Tetapi kasus ini memiliki peringatan penting: variabel <i>v1StackFrame</i> dan <i>stackFrame</i> terkait secara logis.  Lihat, jika <i>v1StackFrame</i> adalah <i>null</i> , objek <i>StackFrame</i> tidak akan dibuat, sedangkan <i>stackFrame</i> akan tetap <i>nol.</i>  Diikuti oleh crash program karena panggilan <i>stackFrame.Location</i> , karena tidak ada pemeriksaan di sini.  Jadi bahkan tidak akan sampai pada penggunaan <i>v1StackFrame yang</i> berbahaya, ditunjukkan oleh penganalisa.  Kode ini hanya berfungsi jika Anda meneruskan nilai v1StackFrame <i>nonnull</i> ke metode <i>CreateStackFrame</i> .  Saya menduga bahwa kode penelepon entah bagaimana mengendalikannya.  Panggilan <i>CreateStackFrame</i> terlihat seperti ini: <br><br><pre> <code class="cs hljs">Frames = v1Stack.Frames?.Select(CreateStackFrame).ToList()</code> </pre> <br>  <i>CreateStackFrame</i> digunakan sebagai pemilih.  Referensi yang lulus tidak dicentang untuk <i>nol di</i> sini.  Mungkin, ketika mengisi koleksi <i>Frames</i> itu (penulisan referensi nol) dikontrol, tapi saya tidak pergi untuk menggali terlalu dalam.  Kesimpulannya sudah jelas - kode membutuhkan perhatian penulis. <br><br><h2>  Kesimpulan </h2><br>  Seperti yang Anda lihat, artikelnya tidak lama tetapi saya harap Anda menikmati bacaan ringan ini :) Untuk berjaga-jaga, Anda selalu dapat <a href="https://www.viva64.com/en/pvs-studio-download/">mengunduh</a> penganalisa kami untuk mencari kesalahan dalam proyek Anda atau seseorang sendiri. <br><br>  Dan akhirnya, sebuah pengumuman kecil: artikel saya berikutnya adalah tentang kesalahan paling menarik yang saya dan kolega saya temukan dalam proyek pada tahun 2019. Ikuti <a href="https://www.viva64.com/en/b/">blog</a> kami.  Sampai jumpa! <br><br>  Untuk mempelajari lebih lanjut tentang posting blog baru, Anda dapat berlangganan ke saluran berikut: <br><br><ul><li>  Twitter: <a href="https://twitter.com/Code_Analysis">@Code_Analysis</a> </li><li>  Fb: <a href="https://www.facebook.com/StaticCodeAnalyzer/">@StaticCodeAnalyzer</a> </li><li>  Telegram: <a href="https://t.me/pvsstudio_en">pvsstudio_en</a> </li><li>  Instagram: <a href="https://www.instagram.com/pvsstudio/%3Fhl">pvs-studio</a> </li><li>  RSS lama yang baik: <a href="http://feeds.feedburner.com/viva64-blog-en">viva64-blog-en</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id479480/">https://habr.com/ru/post/id479480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id479464/index.html">Pipa & Filter. Contoh aplikasi dan implementasi menggunakan Spring</a></li>
<li><a href="../id479466/index.html">Habraiting 2019: statistik dan peringkat artikel terbaik untuk 2019</a></li>
<li><a href="../id479468/index.html">Edge of Honesty dan John Doe</a></li>
<li><a href="../id479474/index.html">Mengapa self-organisasi tim sangat penting dalam Scrum dan mengapa tidak ada manajer di dalamnya</a></li>
<li><a href="../id479478/index.html">Plug-in Java tanpa rasa sakit</a></li>
<li><a href="../id479482/index.html">SARIF SDK dan kesalahannya</a></li>
<li><a href="../id479486/index.html">Pemrograman heterogen dan oneAPI Toolkit. Kuliah pakar improvisasi Intel menjawab pertanyaan Anda</a></li>
<li><a href="../id479488/index.html">Dari laptop - server rumah dengan daya redundan ke router Mikrotik</a></li>
<li><a href="../id479492/index.html">Komputasi tanpa server berdasarkan OpenWhisk, bagian 3</a></li>
<li><a href="../id479496/index.html">Parsing Tugas WTF dalam JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>