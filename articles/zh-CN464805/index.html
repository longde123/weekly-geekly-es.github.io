<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ” â­•ï¸ ğŸŒ• åœ¨ipadä¸Šå†™è›‡ï¼ˆpythonistaï¼‰ ğŸ˜‚ âœï¸ ğŸšµğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="...æˆ–è€…å¦‚ä½•ä½¿ç”¨ipadæ¶ˆç£¨æ—¶é—´ï¼Œä»…æ­¤è€Œå·²... 

 ä½ å¥½ 

 ä½ åœ¨è¯´ä»€ä¹ˆ 
 ä¸å¹¸çš„æ˜¯ï¼Œå¹³æ¿ç”µè„‘å°šæœªå–ä»£è®¡ç®—æœºã€‚ ä½†æ˜¯ä¹˜è½¦/é£è¡Œè‡³å…³é‡è¦ã€‚ å› æ­¤ï¼Œæˆ‘å¯»æ‰¾äº†ipadåº•ä¸‹çš„ä¸œè¥¿ï¼Œå®é™…ä¸Šä»Šå¤©æˆ‘å°†åœ¨Pythonistaä¸Šè¿›è¡Œæ¸¸æˆã€‚ 

 æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ 
 æœ€ç®€å•çš„ç¨‹åºï¼Œä¾‹å¦‚æ™¶ä½“ï¼ˆæ˜¯çš„ï¼Œæ˜¯çš„ï¼Œå°±æ˜¯æ‚¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨ipadä¸Šå†™è›‡ï¼ˆpythonistaï¼‰</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464805/">  <i>...æˆ–è€…å¦‚ä½•ä½¿ç”¨ipadæ¶ˆç£¨æ—¶é—´ï¼Œä»…æ­¤è€Œå·²...</i> <br><br> ä½ å¥½ <br><br><h3> ä½ åœ¨è¯´ä»€ä¹ˆ </h3><br> ä¸å¹¸çš„æ˜¯ï¼Œå¹³æ¿ç”µè„‘å°šæœªå–ä»£è®¡ç®—æœºã€‚ ä½†æ˜¯ä¹˜è½¦/é£è¡Œè‡³å…³é‡è¦ã€‚ å› æ­¤ï¼Œæˆ‘å¯»æ‰¾äº†ipadåº•ä¸‹çš„ä¸œè¥¿ï¼Œå®é™…ä¸Šä»Šå¤©æˆ‘å°†åœ¨Pythonistaä¸Šè¿›è¡Œæ¸¸æˆã€‚ <br><br><h3> æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ </h3><br> æœ€ç®€å•çš„ç¨‹åºï¼Œä¾‹å¦‚æ™¶ä½“ï¼ˆæ˜¯çš„ï¼Œæ˜¯çš„ï¼Œå°±æ˜¯æ‚¨åœ¨åœ°é“ä¸Šç©çš„ç¨‹åºï¼‰ã€‚ ä¿„ç½—æ–¯æ–¹å—ï¼Œè›‡ï¼Œå¡«å……-ä»»ä½•æ–°æ‰‹ï¼Œåªè¦æœ‰ä¸€ç‚¹äº†è§£ï¼Œéƒ½å°†åœ¨30åˆ†é’Ÿå†…å†™å‡ºå®ƒä»¬ã€‚ åœ¨è¿‡åœºåŠ¨ç”»ä¸‹-å±å¹•æˆªå›¾ï¼Œæ•™ç¨‹ï¼Œä»£ç ã€‚ <br><a name="habracut"></a><br> ä»¥ä¸‹æ˜¯æˆ‘æç ¸äº†çš„ä¸€äº›å±å¹•æˆªå›¾ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">è®¸å¤šæˆªå›¾</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/n5/t-/0l/n5t-0lksjmfrqpvj-hphcjrqgv4.png"><br><br><img src="https://habrastorage.org/webt/lv/a0/ay/lva0ay1p6xghjzuh60hbewak8-i.png"><br><br><img src="https://habrastorage.org/webt/az/ow/zh/azowzhphjmi5xju-ynvluvhot48.png"><br><br><img src="https://habrastorage.org/webt/pf/vq/yj/pfvqyj1em0bsun4ozseqvjl6458.png"><br><br><img src="https://habrastorage.org/webt/4k/lo/w9/4klow9qq74gspnkh888hsksgk7c.png"><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">å…è´£å£°æ˜</b> <div class="spoiler_text"> æœ¬æ–‡ä¸ä»…ä¸“é—¨é’ˆå¯¹åˆå­¦è€…ï¼ˆä½†äº†è§£pythonï¼‰ï¼Œå¹¶ä¸”ä¸å…è®¸æ‚¨åœ¨ååˆ†é’Ÿå†…æˆ–ä»»ä½•ç°æˆçš„åº”ç”¨ç¨‹åºä¸­åˆ›å»ºå¦å…‹ä¸–ç•Œï¼Œä½†ä»ç¼–ç¨‹å®—æ•™çš„è§’åº¦å‡ºå‘ï¼Œä½œè€…ä¹Ÿä¸ä¿è¯ç»å¯¹ç¾è§‚ä¸”æ­£ç¡®çš„ä»£ç ï¼ˆå°½ç®¡ä»–å°è¯•è¿‡ï¼‰ ã€‚ è€Œä¸”pythonistaçš„ç¤ºä¾‹å’Œæ–‡æ¡£ä¸­ä¹Ÿæœ‰ä¸€äº›ä¸œè¥¿è¢«ç›—ã€‚ <br></div></div><br>  <i>æ‰€æœ‰ä»£ç å°†åœ¨æœ«å°¾ç»™å‡ºã€‚</i> <br><br><h3> äº†è§£pythonistaä¸­çš„å›¾å½¢ </h3><br><div class="spoiler">  <b class="spoiler_title">æ±‡å…¥</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random</code> </pre> <br></div></div><br> ç«‹å³åˆ›å»ºåœºæ™¯ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.background_color = <span class="hljs-string"><span class="hljs-string">"green"</span></span> run(Game(), LANDSCAPE)</code> </pre><br> å¥½å§ï¼Œè®©æˆ‘ä»¬ç«‹å³å¼€å§‹ã€‚ æ‚¨åº”è¯¥æœ‰ä¸€ä¸ªç»¿å±ã€‚ è®©æˆ‘ä»¬åšä¸€äº›å¾ˆé…·çš„äº‹æƒ…ï¼Œæ–¹æ³•æ˜¯å°†æ›´æ–°æ–¹æ³•ï¼ˆç³»ç»Ÿæœ¬èº«è°ƒç”¨ï¼‰æ·»åŠ åˆ°Gameç±»ä¸­ï¼Œå¹¶ä¸ºå…¶æ›´æ”¹èƒŒæ™¯é¢œè‰²ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def update(self): self.background_color = (1.0, 1.0, (math.sin(self.t) + 1) / 2)</span></span></code> </pre><br> ç°åœ¨ï¼Œæˆ‘ä»¬çš„å±å¹•ä»é»„è‰²å¹³æ»‘è¿‡æ¸¡åˆ°ç™½è‰²ï¼Œåä¹‹äº¦ç„¶ã€‚ <br><br><img src="https://habrastorage.org/webt/-h/h_/vu/-hh_vuqntwuqqpno4h_jtu0944m.png"><br><br> ç°åœ¨åˆ›å»ºä¸€äº›å¯¹è±¡ã€‚ æˆ‘ä»¬è¿˜åœ¨setupæ–¹æ³•ä¸­åˆ›å»ºå®ƒï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.background_color = <span class="hljs-string"><span class="hljs-string">"white"</span></span> mypath = ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) self.obj = ShapeNode(mypath) self.obj.color = <span class="hljs-string"><span class="hljs-string">"purple"</span></span> <span class="hljs-comment"><span class="hljs-comment">#      html,  #FF00FF.   tuple,   (1.0, 0.0, 1.0).       alpha,    self.add_child(self.obj) def update(self): self.obj.position = (500 + 200 * math.sin(self.t), 500 + 200 * math.cos(self.t))</span></span></code> </pre><br> æˆ‘ä»¬è®¾ç½®çº¿ï¼ˆmypathï¼‰ï¼Œåœ¨å…¶ä¸Šåˆ›å»ºä¸€ä¸ªShapeNodeï¼Œå°†å…¶æŒ‡å‘ä¸€ç§é¢œè‰²ï¼Œç„¶åæŒ‡å®šä¸€ä¸ªçˆ¶å¯¹è±¡ï¼ˆæœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„-åœ¨åˆ›å»ºæ—¶æŒ‡å®šä¸€ä¸ªçˆ¶å¯¹è±¡ï¼Œå³ShapeNodeï¼ˆ* ...ï¼Œparent = selfï¼‰æˆ–self.add_child ï¼ˆobjï¼‰ï¼‰ã€‚ <br><br> å¥½å§ï¼Œåœ¨Game.updateï¼ˆï¼‰ä¸­ï¼Œæˆ‘ä»¬æ›´æ”¹å¯¹è±¡ï¼ˆå…ƒç»„ï¼‰çš„ä½ç½®ï¼Œå®ƒä»¥åƒç´ ä¸ºå•ä½ï¼Œä»å·¦ä¸‹è§’å¼€å§‹è®¡æ•°ã€‚ <br><blockquote> è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä¸éœ€è¦é‡æ–°ç»˜åˆ¶åœºæ™¯ï¼ˆå°½ç®¡æœ‰å¯èƒ½ï¼‰ã€‚ å…¶çˆ¶ä½œä¸ºåœºæ™¯çš„å¯¹è±¡å’ŒèŠ‚ç‚¹ï¼ˆæˆ–å…¶æŸäº›å­å¯¹è±¡ï¼‰å°†è‡ªå·±é‡æ–°ç»˜åˆ¶ <br></blockquote> æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­è¦ä»‹ç»çš„æœ€åä¸€ä»¶äº‹æ˜¯touch_beganï¼ˆä»¥åŠtouch_movedå’Œtouch_endedï¼‰ã€‚ å¾ˆå®¹æ˜“çŒœåˆ°ï¼Œè¯¥æ–¹æ³•å¯ä»¥æ•è·å±å¹•ä¸Šçš„ç‚¹å‡»ã€‚ è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touch_began</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> mypath = ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) obj = ShapeNode(mypath) obj.color = (<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) self.add_child(obj) obj.position = touch.location</code> </pre><br><img src="https://habrastorage.org/webt/gp/1m/mu/gp1mmunnpgr5y6_c0ge8hpzqn8q.png"><br><br> æ¯æ¬¡æ‚¨åœ¨å±å¹•ä¸Šå•å‡»æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šåˆ›å»ºä¸€ä¸ªåœ†åœˆï¼Œå•å‡»çš„ä½ç½®æ˜¯touch.locationã€‚ <br><br><h3> å‡†å¤‡å†™ä¸€æ¡è›‡ </h3><br><div class="spoiler">  <b class="spoiler_title">æ¸¸æˆæœºåˆ¶</b> <div class="spoiler_text"> è›‡æ˜¯æ­£æ–¹å½¢çš„é˜µåˆ—ï¼Œå½“å¤´éƒ¨ç§»åŠ¨æ—¶-ç¬¬äºŒå—ç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªï¼Œç¬¬ä¸‰ä¸ªç§»åŠ¨åˆ°ç¬¬äºŒä¸ªï¼Œä¾æ­¤ç±»æ¨ã€‚ä¸ºæ‰¾å‡ºå¤´éƒ¨ä¸å°¾å·´çš„äº¤ç‚¹ï¼Œæˆ‘ä»¬å°†å…¶ä¸æ¯æ¡å°¾å·´è¿›è¡Œæ¯”è¾ƒ <br></div></div><br> æˆ‘ä»¬åˆ é™¤æ‰€æœ‰ä¹¦é¢ä»£ç ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³æˆ–å¤šæˆ–å°‘åœ°åšåˆ°ç¾è§‚ï¼ˆä½†æ˜¯ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¼šéª‘è‡ªè¡Œè½¦ï¼‰ã€‚ <br><br> é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºPhyObjç±»ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhyObj</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path, color, parent)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.position = (x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.graph_obj.position <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.position += (x, y)</code> </pre><br> æˆ‘è®¤ä¸ºè¿™é‡Œçš„ä¸€åˆ‡éƒ½å¾ˆå¾®ä¸è¶³é“ã€‚ åœ¨ç±»æœ¬èº«å†…éƒ¨ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æè¿°äº†ä¸€äº›ä½¿æˆ‘ä»¬çš„ä»£ç æ›´å…·å¯è¯»æ€§çš„æ–¹æ³•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">holivary</b> <div class="spoiler_text"> å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æ›´å–œæ¬¢å…ˆåˆ›å»ºå…·æœ‰è®¸å¤šé‡å¤æ–¹æ³•å’Œå±æ€§çš„ä½çº§ç±»ï¼Œä½†éšåé«˜çº§ç±»ä¸­çš„ä»£ç å°†å˜å¾—éå¸¸æ¼‚äº®ä¸”æ˜“è¯»ã€‚ <br></div></div><br>  PhyObjæ˜¯æˆ‘ä»¬æ¸¸æˆä¸­æœ€ä½çº§åˆ«çš„å¯¹è±¡ï¼Œå®é™…ä¸Šå®ƒæ˜¯æŠ½è±¡çš„ç‰©ç†å¯¹è±¡ã€‚ <br><br><h4> è›‡æè¿° </h4><br> ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æè¿°è¿™æ¡è›‡ï¼Œç”±äºå®ƒæ˜¯ç”±ç¢ç‰‡ç»„æˆçš„ï¼Œå› æ­¤æˆ‘ä»¬å°†é¦–å…ˆæè¿°ä¸€æ¡ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - margin, size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - margin), <span class="hljs-string"><span class="hljs-string">"#66FF66"</span></span>, parent) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.color = <span class="hljs-string"><span class="hljs-string">"red"</span></span></code> </pre><br> åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨ç±»çš„çˆ¶æ–¹æ³•ï¼Œå¹¶ç»™æˆ‘ä»¬è‡ªå·±æŒ‡å®šå½¢çŠ¶å’Œé¢œè‰²ã€‚ éœ€è¦ç•™æœ‰è¾¹è·ï¼Œä»¥ä½¿æ­£æ–¹å½¢ä¸ä¼šç²˜åœ¨ä¸€èµ·å¹¶å½¢æˆæŸç§ç½‘æ ¼ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.tile = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) self.tile.setpos(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre><br> ç»“æœåº”è¯¥æ˜¯ï¼š <br><br><img src="https://habrastorage.org/webt/dg/yl/tf/dgyltfilompjygqnrriiio1mhv8.png"><br><br> ä½†æ˜¯ä¾‹å¦‚ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¿è¯é‡‘ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> tile1 = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) tile1.setpos(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) tile2 = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) tile2.setpos(<span class="hljs-number"><span class="hljs-number">140</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre><br><img src="https://habrastorage.org/webt/0n/p8/i0/0np8i041mbo7udct2rsi3twsj18.png"><br><br> å¥½äº†ï¼Œç°åœ¨æ‚¨éœ€è¦ä»è¿™äº›ç¢ç‰‡ä¸Šç²˜è›‡ã€‚ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•å’Œä¸€ä¸ªç§»åŠ¨æ–¹æ³•ã€‚ <br><br> é¦–å…ˆï¼Œåˆ›å»ºåˆå§‹åŒ–ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, length, width, initpos, parent)</span></span></span><span class="hljs-function">:</span></span> self.width = width <span class="hljs-comment"><span class="hljs-comment">#     self.tiles = [Tile(parent, (width, width)) for i in range(length)] #        for i, tile in enumerate(self.tiles): tile.setpos(initpos[0] + i * self.width, initpos[1]) #       </span></span></code> </pre><br> è®©æˆ‘ä»¬å°è¯•ç«‹å³ç»˜åˆ¶å®ƒï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake = Snake(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self)</code> </pre><br><img src="https://habrastorage.org/webt/gv/kl/gg/gvklgg1stltccf2hxsyyuae_rsu.png"><br><br> å¥½å§ï¼Œæ·»åŠ ç§»åŠ¨æ–¹æ³•ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.tiles) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.tiles[i].setpos(*self.tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].getpos()) self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].move(x * self.width, y * self.width)</code> </pre><br> é¦–å…ˆï¼Œæˆ‘ä»¬å°†æœ€åä¸€ä¸ªç§»åˆ°å€’æ•°ç¬¬äºŒä¸ªï¼Œç„¶åå°†å€’æ•°ç¬¬äºŒä¸ªç§»åˆ°å€’æ•°ç¬¬äºŒä¸ªï¼Œç„¶åå°†ç¬¬äºŒä¸ªç§»åˆ°ç¬¬ä¸€ä¸ªã€‚ ä»¥åŠç¬¬ä¸€ä¸ªï¼ˆxï¼Œyï¼‰ã€‚ <br><br> å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„è›‡ç›´çº¿ç§»åŠ¨å¾—å¾ˆå¥½ã€‚ è®©æˆ‘ä»¬å°è¯•ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(self)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def update(self): self.snake.move(0, 1)</span></span></code> </pre><br> å¦‚æœæ‚¨è®¾æ³•çœ‹åˆ°ï¼Œé‚£ä¹ˆå¥¹åº”è¯¥çˆ¬è¡Œäº†ã€‚ äº‹å®æ˜¯ï¼Œæ›´æ–°è¢«è°ƒç”¨å¾—éå¸¸é¢‘ç¹ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¯ä»¥é€‰æ‹©ä»¥ç›¸åŒçš„é—´éš”ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è€ƒè™‘è‡ªä¸Šæ¬¡è°ƒç”¨ä»¥æ¥å·²ç»ç»è¿‡äº†å¤šå°‘æ—¶é—´ï¼Œå¹¶ç­‰å¾…ç›´åˆ°å…¶â€œç´¯ç§¯â€äº†è¶³å¤Ÿçš„æ—¶é—´ã€‚ <br><br> ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬è¿™æ ·åšï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.last_time = self.t <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_gone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.t - self.last_time &gt; t: res = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.time_reset() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake = Snake(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self) self.time_reset() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.time_gone(<span class="hljs-number"><span class="hljs-number">0.3</span></span>): self.snake.move(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br> å¦‚æœç»è¿‡çš„æ—¶é—´è¶…è¿‡tï¼Œåˆ™time_goneè¿”å›Trueã€‚ ç°åœ¨ï¼Œè›‡å°†æ¯0.3ç§’ç§»åŠ¨ä¸€æ¬¡ã€‚ å¥æ•ˆäº†å—ï¼Ÿ <br><br><img src="https://habrastorage.org/webt/it/ew/cn/itewcnxtf37hx-bkj2-_tnrjnug.png"><br><br><h4> ç®¡ç†å­¦ </h4><br> ç°åœ¨æ‚¨éœ€è¦è¿›è¡Œæ§åˆ¶ï¼Œå³åœ¨æ‰€æœ‰å››ä¸ªæ–¹å‘ä¸Šè½¬å¼¯ï¼š <br><br><img src="https://habrastorage.org/webt/5l/hw/mo/5lhwmoxex5c_lfafmihwivyw1ym.png"><br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): # &lt;...&gt; self.dir = (0, 1) #     def update(self): if self.time_gone(0.3): self.snake.move(*self.dir)</span></span></code> </pre><br> ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œtouch_beganå¤„ç†ä»¥äº†è§£ç”¨æˆ·æ’å…¥çš„åŒºåŸŸã€‚ å®é™…ä¸Šï¼Œç»“æœå¹¶æ²¡æœ‰æˆ‘æƒ³çš„é‚£ä¹ˆæœ‰è¶£ï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨æ­¤å¤„ç®€å•åœ°å¤åˆ¶ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def touch_began(self, touch): ws = touch.location[0] / self.size.w hs = touch.location[1] / self.size.h aws = 1 - ws if ws &gt; hs and aws &gt; hs: self.dir = (0, -1) elif ws &gt; hs and aws &lt;= hs: self.dir = (1, 0) elif ws &lt;= hs and aws &gt; hs: self.dir = (-1, 0) else: self.dir = (0, 1)</span></span></code> </pre><br> å¥½å§ï¼Œç°åœ¨å°è¯•è½¬èº« <br><br><img src="https://habrastorage.org/webt/-a/s5/8p/-as58pqevh1gfcxx4a556pttljo.png"><br><br> åˆ¶å®šäº†ä¸»è¦æœºåˆ¶ï¼Œä»ç„¶éœ€è¦æ£€æŸ¥ç¢°æ’å’Œè‹¹æœã€‚ <br><br><h4> å°¾å·´ç¢°æ’ </h4><br> è®©æˆ‘ä»¬å¼€å§‹æ£€æŸ¥å¹¶å‘è›‡æ·»åŠ find_collisionsæ–¹æ³• <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def find_collisions(self): for i in range(1, len(self.tiles)): if self.tiles[i].getpos() == self.tiles[0].getpos(): return self.tiles[i], self.tiles[0] return False</span></span></code> </pre><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥è·å¾—ä¸€å¯¹ç›¸äº¤çš„ç»†èƒã€‚ æˆ‘æƒ³å°†å®ƒä»¬æ¶‚æˆçº¢è‰²ï¼Œå°†dieæ–¹æ³•æ·»åŠ åˆ°Tileä¸­ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def die(self): self.graph_obj.color = "red"</span></span></code> </pre><br> æ·»åŠ æ£€æŸ¥ä»¥æ›´æ–°å’Œæ›´æ”¹è®¾ç½®ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.snake = Snake(30, 40, (200, 200), self) #   self.time_reset() self.dir = (0, 1) self.game_on = True #   ? def update(self): if not self.game_on: #  ,  return col = self.snake.find_collisions() #  ? if col: for tile in col: tile.die() #     self.game_on = False #   if self.time_gone(0.3): self.snake.move(*self.dir)</span></span></code> </pre><br> æˆ‘æ€ä¹ˆäº†ï¼š <br><br><img src="https://habrastorage.org/webt/zu/gx/n2/zugxn2bxvlbhj6cagawcjy-qsdi.png"><br><br> å®ƒä»ç„¶æ˜¯ç”¨æ¥åšè‹¹æœçš„ã€‚ <br><br><h4> ä¼¸é•¿ç‡å’Œè‹¹æœ </h4><br> æˆ‘ä»¬å°†åŠ é•¿è›‡ï¼Œå¹¶ä½¿å®ƒçœ‹èµ·æ¥æ›´æ¼‚äº®ï¼Œå°†æ ¹æ®åä¸¤ä¸ªæ·»åŠ æ–°çš„é“¾æ¥ï¼Œå³ï¼š <br><br><img src="https://habrastorage.org/webt/kl/sg/uv/klsguvpmusyky4y78dvdmk_nvdu.png"><br><br> å°†æ–¹æ³•æ·»åŠ åˆ°è›‡ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def find_dir(self, x1, y1, x2, y2): if x1 == x2 and y1 &gt; y2: return (0, 1) elif x1 == x2 and y1 &lt; y2: return (0, -1) elif y1 == y2 and x1 &gt; x2: return (1, 0) elif y1 == y2 and x1 &lt; x2: return (-1, 0) else: assert False, "Error!" def append(self): if len(self.tiles) &gt; 1: lastdir = self.find_dir(*self.tiles[-1].getpos(), *self.tiles[-2].getpos()) else: lastdir = (-self.parent.dir[0], -self.parent.dir[1]) self.tiles.append(Tile(self.parent, (self.width, self.width))) x_prev, y_prev = self.tiles[-2].getpos() self.tiles[-1].setpos(x_prev + lastdir[0] * self.width, y_prev + lastdir[1] * self.width)</span></span></code> </pre><br>  find_diræŸ¥æ‰¾å¥³ä¸»äººå…¬çš„å°¾å·´å°–çš„æ–¹å‘ã€‚ è¿½åŠ ï¼Œå¾ˆå®¹æ˜“çŒœåˆ°ï¼Œæ·»åŠ äº†ä¸€ä¸ªå•å…ƒæ ¼ã€‚ åœ¨Gameä¸­æ·»åŠ å¦ä¸€ä¸ªsnake_lengthenæ–¹æ³•ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def snake_lengthen(self): self.snake.append() self.time_reset()</span></span></code> </pre><br> æœ€åä¸€è¡Œæ˜¯éœ€è¦çš„ï¼Œä»¥ä¾¿è›‡ç¨ç­‰ä¸€ä¼šå„¿ï¼Œå¹¶ä¸”ç”¨æˆ·è®¾æ³•çœ‹åˆ°æ·»åŠ äº†é‚£æ¡ã€‚ <br><br> è¦ç¡®å®šæŸæ¡è›‡æ˜¯å¦ä¸æŸæ¡çº¿ç›¸äº¤ï¼Œè¯·å‘è¯¥æ¡è›‡æ·»åŠ ç›¸äº¤æ–¹æ³•ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def getpos(self): return self.tiles[0].getpos() def intersect(self, x, y): return self.getpos() == (x, y)</span></span></code> </pre><br> ä¸‡å²ï¼Œå®ƒä»ç„¶åªæ˜¯åˆ›å»ºä¸€ä¸ªè‹¹æœã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸€å£æ°”æè¿°äº†è‹¹æœï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apple</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, size, parent)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>], size[<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">"#55AAFF"</span></span>, parent) self.parent = parent self.width = width self.dislocate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> a = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.w / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) b = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.h / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) self.setpos(a * self.width, b * self.width)</code> </pre><br> éœ€è¦è¿™ç§å¥‡æ€ªçš„éšæœºæ€§æ¥ä½¿æˆ‘ä»¬çš„é¶å¿ƒé€‚åº”ç½‘æ ¼ã€‚ è¿™æ ·å°±ä¸å¿…å¯»æ‰¾æªå£å’Œè‹¹æœä¹‹é—´çš„è·ç¦»å¹¶æ¯”è¾ƒå…¶pyre-pyrã€‚ å°±åœ¨ifasä¸Šã€‚ è®©æˆ‘ä»¬å»æ›´æ–°å¹¶åœ¨æ­¤å‡½æ•°çš„æœ«å°¾æ·»åŠ éå¸¸ç®€å•çš„è¡Œï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.apple = Apple(40, (50, 50), self) # 40 -  ,       Snake() # &lt;...&gt; def update(self): # &lt;...&gt; if self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate()</span></span></code> </pre><br> å¥½å§ï¼Œä¸€åˆ‡ä¼¼ä¹éƒ½å‘ç”Ÿäº†ï¼Œç°åœ¨å¦‚æœè›‡æ’åˆ°è‹¹æœï¼Œè›‡ä¼šä¼¸é•¿ï¼Œè€Œæ’åˆ°è‹¹æœåˆ™æ­»ã€‚ <br><br><img src="https://habrastorage.org/webt/0r/de/gw/0rdegw0knuwccnbh6jz5oy5hova.png"><br><br><h4> çº¢åˆ© </h4><br> æ‚¨å¯ä»¥åˆ¶ä½œéŸ³æ•ˆï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sound <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def snake_lengthen(self): self.snake.append() self.time_reset() sound.play_effect('arcade:Powerup_1', 0.25, 0.8)</span></span></code> </pre><br> è¿›è¡Œå¹³æ»‘è¿åŠ¨ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.game_on = False self.GLOBAL_TIMING = 0.2 self.GLOBAL_WIDTH = 40 self.apple = Apple(self.GLOBAL_WIDTH, (50, 50), self) self.snake = Snake(10, self.GLOBAL_WIDTH, (200, 200), self) self.time_reset() self.dir = (0, 1) self.game_on = True class Snake: # &lt;...&gt; def move(self, x, y): for i in range(len(self.tiles) - 1, 0, -1): self.tiles[i].setpos(*self.tiles[i - 1].getpos(), self.parent.GLOBAL_TIMING) self.tiles[0].move(x * self.width, y * self.width, self.parent.GLOBAL_TIMING) class PhyObj: def __init__(self, path, color, parent): self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color self.pos = self.graph_obj.position def setpos(self, x, y, t=0.0): self.pos = (x, y) self.graph_obj.run_action(Action.move_to(x, y, t)) #    x, y    t def getpos(self): return self.pos def move(self, x, y, t=0.0): self.pos = (self.pos[0] + x, self.pos[1] + y) self.graph_obj.run_action(Action.move_by(x, y, t))</span></span></code> </pre><br> æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ›´æ”¹äº†ä½ç½®PhyObjçš„é€»è¾‘ã€‚ ä»¥å‰ï¼Œæˆ‘ä»¬ä¸“æ³¨äºå›¾å½¢å…ƒç´ çš„ä½ç½®ï¼Œç°åœ¨æœ‰ä¸€ä¸ªå•ç‹¬çš„é€»è¾‘ä½ç½®å­—æ®µï¼ˆå³ç”¨äºæ¸¸æˆé€»è¾‘çš„å­—æ®µï¼‰ï¼Œå¹¶ä¸”å›¾å½¢å…ƒç´ çš„ä½ç½®ç°åœ¨æ˜¯è‡ªç”±çš„ï¼Œå¯ä»¥ä»¥è‡ªå·±çš„æ–¹å¼æ›´æ”¹ã€‚ å³ï¼Œä½¿ç”¨â€œåŠ¨ä½œâ€ï¼Œæˆ‘ä»¬ä¸ºå¥¹ç•™å‡ºäº†å¹¶è¡Œæµï¼Œå¹¶åœ¨å…¶ä¸­è¿›è¡Œç§»åŠ¨ã€‚ <br><br> è¿™æ ·ä¸€æ¡å…‰æ»‘çš„è›‡ç«Ÿç„¶æ˜¯ï¼š <br><br><img src="https://habrastorage.org/webt/8g/ma/4x/8gma4xndidknidevmnr49pleuyc.png"><br><br> æœ€åï¼ŒåŠ ä¸Šè›‡çš„é•¿åº¦çš„æ ‡ç­¾ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.game_on = False self.GLOBAL_TIMING = 0.2 self.GLOBAL_WIDTH = 40 self.apple = Apple(self.GLOBAL_WIDTH, (50, 50), self) self.snake = Snake(30, self.GLOBAL_WIDTH, (200, 200), self) self.time_reset() self.dir = (0, 1) self.label = LabelNode("", font=("Chalkduster", 20), parent=self, position=(self.size.w / 2, self.size.h - 100)) #    self.update_labels() self.game_on = True def update_labels(self): self.label.text = "Length: " + str(len(self.snake.tiles)) def update(self): if not self.game_on: return col = self.snake.find_collisions() if col: for tile in col: tile.die() self.game_on = False if self.time_gone(self.GLOBAL_TIMING): self.snake.move(*self.dir) if self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate() self.update_labels() # </span></span></code> </pre><br><img src="https://habrastorage.org/webt/pu/vk/s5/puvks5yyrimbzdvzfbt4kwysml4.png"><br><br> æœ‹å‹ä»¬ï¼Œè°¢è°¢æ‚¨çš„å…³æ³¨ï¼ å¦‚æœä¸æ¸…æ¥šï¼Œè¯·è¯¢é—®ã€‚ è€Œä¸”ï¼Œå¦‚æœè¿™å¾ˆæœ‰è¶£-æˆ‘ä¼šç»§ç»­è®²ï¼Œä½†ä»æœ‰ä¸€äº›è¦è¯´çš„ï¼ˆä½†æ˜¯æœ¬æ–‡å·²ç»ç›¸å½“é•¿äº†ï¼‰ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ‰€æœ‰è›‡ç </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sound <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhyObj</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path, color, parent)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color self.pos = self.graph_obj.position <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, t=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pos = (x, y) self.graph_obj.run_action(Action.move_to(x, y, t)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.pos <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, t=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pos = (self.pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y) self.graph_obj.run_action(Action.move_by(x, y, t)) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - margin, size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - margin), <span class="hljs-string"><span class="hljs-string">"#66FF66"</span></span>, parent) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.color = <span class="hljs-string"><span class="hljs-string">"red"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, length, width, initpos, parent)</span></span></span><span class="hljs-function">:</span></span> self.width = width self.tiles = [Tile(parent, (width, width)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(length)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(self.tiles): tile.setpos(initpos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + i * self.width, initpos[<span class="hljs-number"><span class="hljs-number">1</span></span>]) self.parent = parent <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.tiles) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.tiles[i].setpos(*self.tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].getpos(), self.parent.GLOBAL_TIMING) self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].move(x * self.width, y * self.width, self.parent.GLOBAL_TIMING) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_collisions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, len(self.tiles)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.tiles[i].getpos() == self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].getpos(): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.tiles[i], self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_dir</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x1, y1, x2, y2)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x1 == x2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> y1 &gt; y2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> x1 == x2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> y1 &lt; y2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> y1 == y2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x1 &gt; x2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> y1 == y2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x1 &lt; x2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">"Error!"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">append</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.tiles) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: lastdir = self.find_dir(*self.tiles[<span class="hljs-number"><span class="hljs-number">-1</span></span>].getpos(), *self.tiles[<span class="hljs-number"><span class="hljs-number">-2</span></span>].getpos()) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: lastdir = (-self.parent.dir[<span class="hljs-number"><span class="hljs-number">0</span></span>], -self.parent.dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) self.tiles.append(Tile(self.parent, (self.width, self.width))) x_prev, y_prev = self.tiles[<span class="hljs-number"><span class="hljs-number">-2</span></span>].getpos() self.tiles[<span class="hljs-number"><span class="hljs-number">-1</span></span>].setpos(x_prev + lastdir[<span class="hljs-number"><span class="hljs-number">0</span></span>] * self.width, y_prev + lastdir[<span class="hljs-number"><span class="hljs-number">1</span></span>] * self.width) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].getpos() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.getpos() == (x, y) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apple</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, size, parent)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>], size[<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">"#55AAFF"</span></span>, parent) self.parent = parent self.width = width self.dislocate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> a = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.w / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) b = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.h / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) self.setpos(a * self.width, b * self.width) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">snake_lengthen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake.append() self.time_reset() sound.play_effect(<span class="hljs-string"><span class="hljs-string">'arcade:Powerup_1'</span></span>, <span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">0.8</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.last_time = self.t <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_gone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.t - self.last_time &gt; t: res = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.time_reset() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.GLOBAL_TIMING = <span class="hljs-number"><span class="hljs-number">0.2</span></span> self.GLOBAL_WIDTH = <span class="hljs-number"><span class="hljs-number">40</span></span> self.apple = Apple(self.GLOBAL_WIDTH, (<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>), self) self.snake = Snake(<span class="hljs-number"><span class="hljs-number">30</span></span>, self.GLOBAL_WIDTH, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self) self.time_reset() self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) self.label = LabelNode(<span class="hljs-string"><span class="hljs-string">""</span></span>, font=(<span class="hljs-string"><span class="hljs-string">"Chalkduster"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), parent=self, position=(self.size.w / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size.h - <span class="hljs-number"><span class="hljs-number">100</span></span>)) self.update_labels() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_labels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.label.text = <span class="hljs-string"><span class="hljs-string">"Length: "</span></span> + str(len(self.snake.tiles)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> col = self.snake.find_collisions() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> col: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col: tile.die() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.time_gone(self.GLOBAL_TIMING): self.snake.move(*self.dir) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate() self.update_labels() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touch_began</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> ws = touch.location[<span class="hljs-number"><span class="hljs-number">0</span></span>] / self.size.w hs = touch.location[<span class="hljs-number"><span class="hljs-number">1</span></span>] / self.size.h aws = <span class="hljs-number"><span class="hljs-number">1</span></span> - ws <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &lt;= hs: self.dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &lt;= hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: self.dir = (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) run(Game(), LANDSCAPE)</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">æ°´æ™¶ä»£ç WhiteBlackGooseç‰ˆ</b> <div class="spoiler_text"> æœ‰è¶£çš„æ˜¯ï¼Œåœ¨å®Œæˆä¹‹åï¼Œæˆ‘åœ¨pythonistaæœ¬èº«çš„ç¤ºä¾‹ä¸­å‘ç°äº†éå¸¸ç›¸ä¼¼çš„ä¸œè¥¿ã€‚ ä½†æˆ‘è¿˜æœ‰æ›´å¤šåŠŸèƒ½:) <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> math <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pi <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uniform <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rnd, choice, randint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random A = Action sys.setrecursionlimit(<span class="hljs-number"><span class="hljs-number">1000000</span></span>) colors = [<span class="hljs-string"><span class="hljs-string">'pzl:Green5'</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Red5"</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Blue5"</span></span>] + [<span class="hljs-string"><span class="hljs-string">"pzl:Purple5"</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Button2"</span></span>] + [<span class="hljs-string"><span class="hljs-string">"plf:Item_CoinGold"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> inited inited = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Explosion</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Node)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, brick, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> Node.__init__(self, *args, **kwargs) self.position = brick.position <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> dx, dy <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ((<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)): p = SpriteNode(brick.texture, scale=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, parent=self) p.position = brick.size.w/<span class="hljs-number"><span class="hljs-number">4</span></span> * dx, brick.size.h/<span class="hljs-number"><span class="hljs-number">4</span></span> * dy p.size = brick.size d = <span class="hljs-number"><span class="hljs-number">0.6</span></span> r = <span class="hljs-number"><span class="hljs-number">30</span></span> p.run_action(A.move_to(rnd(-r, r), rnd(-r, r), d)) p.run_action(A.scale_to(<span class="hljs-number"><span class="hljs-number">0</span></span>, d)) p.run_action(A.rotate_to(rnd(-pi/<span class="hljs-number"><span class="hljs-number">2</span></span>, pi/<span class="hljs-number"><span class="hljs-number">2</span></span>), d)) self.run_action(A.sequence(A.wait(d), A.remove())) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Brick</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SpriteNode)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, brick_type, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> img = colors[brick_type] SpriteNode.__init__(self, img, *args, **kwargs) self.brick_type = brick_type self.is_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.enabled = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.remove_from_parent() self.is_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">demark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">brickgetpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, i, j)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (self.Woff + j * self.W, self.Hoff + i * self.H) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">brick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, ty, i, j)</span></span></span><span class="hljs-function">:</span></span> b = Brick(ty, size=(self.W, self.H), position=self.brickgetpos(i, j), parent=self.game_node) b.rotation = random.random() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_brick_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; <span class="hljs-number"><span class="hljs-number">0.992</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; <span class="hljs-number"><span class="hljs-number">0.8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> FONT = (<span class="hljs-string"><span class="hljs-string">'Chalkduster'</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) self.score_label = LabelNode(<span class="hljs-string"><span class="hljs-string">'Score: 0'</span></span>, font=FONT, position=(self.size.w/<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-100</span></span>, self.size.h<span class="hljs-number"><span class="hljs-number">-40</span></span>), parent=self) self.score = <span class="hljs-number"><span class="hljs-number">0</span></span> self.last_score_label = LabelNode(<span class="hljs-string"><span class="hljs-string">'Delta: +0'</span></span>, font=FONT, position=(self.size.w/<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-300</span></span>, self.size.h<span class="hljs-number"><span class="hljs-number">-40</span></span>), parent=self) self.last_score = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">#self.avg_label = LabelNode('Speed: +0/s', font=FONT, position=(self.size.w/2+100, self.size.h-40), parent=self) #self.max_label = LabelNode('Peak: +0/s', font=FONT, position=(self.size.w/2+300, self.size.h-40), parent=self) #self.max_speed = 0 self.game_time = 120 self.timel = LabelNode('Time: ' + str(self.game_time) + "s", font=FONT, position=(self.size.w/2+300, self.size.h-40), parent=self) self.gems = [0 for i in colors] self.effect_node = EffectNode(parent=self) self.game_node = Node(parent=self.effect_node) self.l = [0 for i in colors] self.lt = [0 for i in colors] for i in range(len(colors)): R = 50 if i == 6 else 35 self.l[i] = Brick(i, size=(R, R), position=(40, self.size.h-100-i*40), parent=self.game_node) self.lt[i] = LabelNode(": 0", font=FONT, position=(self.l[i].position[0] + 40, self.l[i].position[1]), parent=self) self.WB = 30 self.HB = 30 self.W = 900 // self.WB self.H = 900 // self.HB self.colcount = 4 self.Woff = (int(self.size.w) - self.W * self.WB + self.W) // 2 self.Hoff = self.H + 10 self.net = [[self.brick(self.random_brick_type(), i, j) for i in range(self.HB)] for j in range(self.WB)] #self.touch_moved = self.touch_began self.start_time = self.t self.game_on = True global inited inited = True def demark(self): for bricks in self.net: for brick in bricks: brick.demark() def howfar(self, x, y): alt = 0 for i in range(y): if not self.net[x][i].is_on: alt += 1 return alt def update(self): global inited if not inited: return self.game_on = self.t - self.start_time &lt; self.game_time if self.game_on: self.timel.text = "Time: " + str(round(self.game_time - (self.t - self.start_time))) + "s" else: self.timel.text = "Game over" #if speed &gt; self.max_speed: # self.max_speed = speed # self.max_label.text = "Peak: +" + str(round(self.max_speed)) + "/s" def gravity(self, x, y): alt = self.howfar(x, y) if alt == 0: return self.net[x][y].destroy() self.net[x][y - alt] = self.brick(self.net[x][y].brick_type, y, x) self.net[x][y - alt].position = self.net[x][y].position self.net[x][y - alt].rotation = self.net[x][y].rotation self.net[x][y - alt].enabled = False self.net[x][y - alt].run_action(A.sequence(A.move_to(*self.brickgetpos(y - alt, x), 0.2 * alt ** 0.5, TIMING_EASE_IN_2), A.call(lambda: self.enable_cell(x, y - alt)))) def enable_cell(self, x, y): self.net[x][y].enabled = True def fall(self): for x in range(self.WB): for y in range(self.HB): if self.net[x][y].is_on: self.gravity(x, y) def update_scores(self): self.score += self.last_score self.score_label.text = "Score: " + str(self.score) self.last_score_label.text = "Delta: +" + str(self.last_score) self.last_score = 0 def update_cells(self): for i in range(self.WB): for j in range(self.HB): if not self.net[i][j].is_on: self.net[i][j] = self.brick(self.random_brick_type(), j + self.HB, i) self.net[i][j].enabled = True self.net[i][j].run_action(A.sequence(A.move_to(*self.brickgetpos(j, i), 0.2 * self.HB ** 0.5, TIMING_EASE_IN_2), A.call(lambda: self.enable_cell(i, j)))) def inbounds(self, x, y): return (x &gt;= 0) and (y &gt;= 0) and (x &lt; self.WB) and (y &lt; self.HB) def bomb(self, x, y, radius): score = 0 bc = 0 for i in range(round(4 * radius ** 2)): rad = random.random() * radius ang = random.random() * 2 * pi xp, yp = x + sin(ang) * rad, y + cos(ang) * rad xp, yp = int(xp), int(yp) if self.inbounds(xp, yp): score += self.explode(xp, yp) self.fall() self.give_score(round(score / 1.7), self.brickgetpos(y, x)) def laser(self, x, y): score = 0 coords = [] for i in range(self.HB): for j in range(-1, 1 + 1, 1): coords.append((x + j, i)) for i in range(self.WB): coords.append((i, y)) for i in range(-self.HB, self.HB): coords.append((x + i, y + i)) for i in range(-self.WB, self.WB): coords.append((x - i, y + i)) bc = 0 for x, y in coords: if not self.inbounds(x, y): continue score += self.explode(x, y) self.fall() self.give_score(score, self.brickgetpos(y, x)) def getty(self, x, y): if not self.inbounds(x, y) or not self.net[x][y].is_on: return -1 else: return self.net[x][y].brick_type def popupt(self, text, position_, font_=("Arial", 30), color_="white"): label = LabelNode(text, font=font_, color=color_, parent=self, position=position_) label.run_action(A.sequence(A.wait(1), A.call(label.remove_from_parent))) def give_score(self, count, xy): self.last_score = int(count ** 2.5) size = 10 if self.last_score &gt; 50000: size = 60 elif self.last_score &gt; 20000: size = 40 elif self.last_score &gt; 10000: size = 30 elif self.last_score &gt; 5000: size = 25 elif self.last_score &gt; 2000: size = 20 elif self.last_score &gt; 1000: size = 15 if self.last_score &gt; 0: self.popupt("+" + str(self.last_score), xy, font_=("Chalkduster", int(size * 1.5))) self.update_scores() def touch_began(self, touch): if not self.game_on: return x, y = touch.location x, y = x + self.W / 2, y + self.H / 2 W, H = get_screen_size() x, y = x, y x, y = int(x), int(y) x, y = x - self.Woff, y - self.Hoff x, y = x // self.W, y // self.H if not self.inbounds(x, y): return count = self.react(self.net[x][y].brick_type, x, y, True) self.demark() if self.getty(x, y) in [0, 1, 2, 3]: if count &gt;= 2: self.react(self.net[x][y].brick_type, x, y) self.fall() self.give_score(count, touch.location) elif self.getty(x, y) == 4: self.bomb(x, y, 5 * count) elif self.getty(x, y) == 5: self.explode(x, y) self.fall() self.update_cells() def explode(self, x, y): if self.net[x][y].is_on: self.net[x][y].destroy() self.gems[self.net[x][y].brick_type] += 1 s = str(self.gems[self.net[x][y].brick_type]) self.lt[self.net[x][y].brick_type].text = " " * len(s) + ": " + s self.game_node.add_child(Explosion(self.net[x][y])) return True else: return False def react(self, col, x, y, ignore=False): if self.inbounds(x, y) and self.net[x][y].brick_type == col and self.net[x][y].is_on and self.net[x][y].lf and self.net[x][y].enabled: if not ignore: self.explode(x, y) else: self.net[x][y].mark() r = 1 r += self.react(col, x + 1, y + 0, ignore) r += self.react(col, x - 1, y - 0, ignore) r += self.react(col, x + 0, y + 1, ignore) r += self.react(col, x - 0, y - 1, ignore) return r else: return 0 def destroy_brick(self, x, y): self.net[x][y].destroy() run(Game(), LANDSCAPE, show_fps=True)</span></span></code> </pre><br></div></div><br> æ™¶ä½“å·¥ä½œæ¼”ç¤ºï¼š <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PLTlEe3xsaU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN464805/">https://habr.com/ru/post/zh-CN464805/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN464785/index.html">éç«äº‰æ€§ç›´çº¿ä¼˜åŠ¿</a></li>
<li><a href="../zh-CN464787/index.html">æˆ‘ç¡®å®šé«˜çº§ç§»åŠ¨å¼€å‘äººå‘˜åªä¼šåœ¨æ¨èä¸‹å‡ºç°</a></li>
<li><a href="../zh-CN464791/index.html">æ±½è½¦ç”¨Kubernetesï¼šå¦‚ä½•æ‰“å¼€å¼€å‘äººå‘˜å¯¹è½¦è½½è®¡ç®—æœºçš„è®¿é—®æƒé™å¹¶ä½¿å…¶å®‰å…¨</a></li>
<li><a href="../zh-CN464795/index.html">å¿«æ´»çš„Quartuselæˆ–å¤„ç†å™¨å¦‚ä½•å˜æˆè¿™æ ·çš„ç”Ÿæ´»</a></li>
<li><a href="../zh-CN464803/index.html">â€œéšè—wwwâ€ï¼šä¸ºä»€ä¹ˆä¸»æµæµè§ˆå™¨å¼€å‘äººå‘˜å†æ¬¡æ‹’ç»æ˜¾ç¤ºè¯¥å­åŸŸ</a></li>
<li><a href="../zh-CN464809/index.html">æˆ‘ä»¬å¦‚ä½•æµ‹è¯•äººè„¸è¯†åˆ«æŠ€æœ¯ä»¥åŠå®ƒçš„ç»“æœ</a></li>
<li><a href="../zh-CN464811/index.html">é€‚ç”¨äºå¼€å‘äººå‘˜çš„Apple Music</a></li>
<li><a href="../zh-CN464813/index.html">ç”¨autohotkeyä¸Šçš„è„šæœ¬æ›¿æ¢Punto Switcherï¼ŒBirmanå¸ƒå±€</a></li>
<li><a href="../zh-CN464819/index.html">æˆ‘ä¸Haikuçš„ç¬¬å…­å¤©ï¼šåœ¨èµ„æºï¼Œå›¾æ ‡å’Œç¨‹åºåŒ…çš„æ©æŠ¤ä¸‹</a></li>
<li><a href="../zh-CN464823/index.html">æˆ‘ä»¬è€ƒè™‘äº†â€œæ•°æ®ç§‘å­¦å®¶â€çš„å¹³å‡å·¥èµ„ã€‚ ä½¿ç”¨ç†ŠçŒ«/ pythonçš„Parsim hh.ru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>