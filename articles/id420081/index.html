<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß¢ üë©üèº‚Äçü§ù‚Äçüë©üèª üëÉ Instal Archlinux dengan enkripsi sistem lengkap dan LVM di LUKS ‚úãüèº üí∂ üíí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam posting ini Anda akan membaca sedikit tentang penelitian aneh saya selama cuti sakit paksa. Ini akan mengenai beberapa hal sekaligus, yang bukan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Instal Archlinux dengan enkripsi sistem lengkap dan LVM di LUKS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420081/">  Dalam posting ini Anda akan membaca sedikit tentang penelitian aneh saya selama cuti sakit paksa.  Ini akan mengenai beberapa hal sekaligus, yang bukan "praktik terbaik", tetapi juga mungkin!  Jadi di sini adalah tutorial tentang cara menginstal Archlinux (distr favorit saya) sehingga: <br><br><ul><li>  tanpa / boot terpisah (hanya di / root) </li><li>  / pada lvm </li><li>  lvm di dalam wadah luks </li><li>  dengan UEFI </li><li> di mesin virtual. </li><li>  <s>dengan boot aman</s> ("sulit" di mesin virtual tidak mungkin berhasil) </li></ul><br>  Patut dicatat bahwa semuanya akan dienkripsi kecuali untuk partisi sistem EFI dengan satu file grubx64.efi - aplikasi EFI untuk menjalankan grub. <br><br>  Jika Anda tertarik, selamat datang ke kucing! <br><a name="habracut"></a><br>  Pertama, saya mengatur semuanya pada laptop Lenovo X240 saya, kemudian untuk menulis artikel saya menggunakan mesin virtual dengan OVMF di Proxmox. <br><br><h4>  Pengaturan testbed: </h4><br>  Semuanya dibuat cukup standar.  Gambar menggunakan lengkungan favorit saya, yang selalu dapat diunduh dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Yandex</a> . <br><br>  Selanjutnya, beberapa poin pada virtual di Proxmox tentang UEFI.  Untuk menguji operasi dudukan dengan UEFI (jika tidak maka tidak akan begitu menarik), Anda perlu mengatur OVMF alih-alih SeaBIOS di properti mesin virtual: <br><br><img src="https://habrastorage.org/webt/ru/ge/fh/rugefhk4s2dhorfq7myeyu_yuam.png"><br><br>  Selanjutnya, tambahkan disk UEFI sesuai, untuk mendapatkan sesuatu seperti ini: <br><br><img src="https://habrastorage.org/webt/hp/ht/6w/hpht6w6iadkra0ur4mon_iuvgeu.png"><br><br>  Sekarang kita dapat memulai mesin virtual dan memulai proses instalasi.  Di konsol mesin virtual, segera mulai layanan sshd, atur kata sandi root dan temukan alamat dhcp mesin virtual: <br><br><img src="https://habrastorage.org/webt/zy/1y/et/zy1yetqzltmbhk9yb3mxirmfqby.png"><br><br>  Selanjutnya, kita dapat terus bekerja pada ssh untuk membuatnya lebih nyaman. <br><br><h4>  Tata letak disk </h4><br>  Jadi, setelah terhubung melalui ssh, pertama-tama kita mengatur waktu sehingga nantinya tidak akan menghasilkan sistem file di masa depan: <br><br><pre><code class="bash hljs">timedatectl <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-ntp <span class="hljs-literal"><span class="hljs-literal">true</span></span> &amp;&amp; timedatectl <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-timezone Europe/Moscow</code> </pre> <br>  Periksa apakah semuanya benar: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># timedatectl Local time: Tue 2018-08-14 13:42:03 MSK Universal time: Tue 2018-08-14 10:42:03 UTC RTC time: Tue 2018-08-14 10:42:04 Time zone: Europe/Moscow (MSK, +0300) System clock synchronized: yes NTP service: active RTC in local TZ: no</span></span></code> </pre><br>  Sekarang kita dapat mulai mempartisi disk.  Pada tahap ini, saya memiliki drive / dev / vda, sebagai  Pengontrol Virtio dan ini hanyalah disk kosong tanpa tabel partisi: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># fdisk -l /dev/vda Disk /dev/vda: 15 GiB, 16106127360 bytes, 31457280 sectors Units: sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes</span></span></code> </pre><br>  Kami akan memecahnya menjadi 2 partisi: <br><br><ul><li>  disk fat32 untuk aplikasi UEFI (EFI_system_partition) </li><li>  Wadah LUK dengan yang lainnya </li></ul><br>  Gunakan gdisk untuk membuat GPT: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># gdisk /dev/vda GPT fdisk (gdisk) version 1.0.4 Command (? for help): o This option deletes all partitions and creates a new protective MBR. Proceed? (Y/N): y</span></span></code> </pre><br>  Selanjutnya, buat partisi pertama untuk EFI dengan tipe EF00 (Partisi Sistem EFI): <br><br><pre> <code class="bash hljs">Command (? <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">help</span></span>): n Partition number (1-128, default 1): First sector (34-31457246, default = 2048) or {+-}size{KMGTP}: Last sector (2048-31457246, default = 31457246) or {+-}size{KMGTP}: +512M Current <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> is <span class="hljs-string"><span class="hljs-string">'Linux filesystem'</span></span> Hex code or GUID (L to show codes, Enter = 8300): &lt;b&gt;EF00&lt;/b&gt; Changed <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> of partition to <span class="hljs-string"><span class="hljs-string">'EFI System'</span></span></code> </pre><br>  Sekarang buat partisi untuk LUKS, tempat kami bahkan tidak akan repot dengan tipenya dan membiarkannya apa adanya: <br><br><pre> <code class="bash hljs">Command (? <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">help</span></span>): n Partition number (2-128, default 2): First sector (34-31457246, default = 1050624) or {+-}size{KMGTP}: Last sector (1050624-31457246, default = 31457246) or {+-}size{KMGTP}: &lt;b&gt;Current <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> is <span class="hljs-string"><span class="hljs-string">'Linux filesystem'</span></span> Hex code or GUID (L to show codes, Enter = 8300): Changed <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> of partition to <span class="hljs-string"><span class="hljs-string">'Linux filesystem'</span></span>&lt;/b&gt;</code> </pre><br>  Kami akan menuliskan perubahan dan menyelesaikannya dengan markup partisi: <br><br><pre> <code class="bash hljs">Command (? <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">help</span></span>): w Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING PARTITIONS!! Do you want to proceed? (Y/N): y OK; writing new GUID partition table (GPT) to /dev/vda. The operation has completed successfully.</code> </pre><br><h4>  Membuat wadah LUKS dan sistem file </h4><br>  Dengan bagian pertama (vda1), semuanya cukup sederhana.  Kami hanya perlu memformatnya dan untuk saat ini: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># mkfs.vfat /dev/vda1 mkfs.fat 4.1 (2017-01-24)</span></span></code> </pre><br>  Partisi kedua adalah wadah yang harus Anda persiapkan terlebih dahulu.  Kami memformat partisi melalui cryptsetup dan mengatur frasa sandi: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># cryptsetup -v luksFormat /dev/vda2 WARNING! ======== This will overwrite data on /dev/vda2 irrevocably. Are you sure? (Type uppercase yes): YES Enter passphrase for /dev/vda2: Verify passphrase: Command successful.</span></span></code> </pre><br>  *** Saya tidak peduli dengan pilihan cipher, dengan pengacakan ditimpa dengan urandom dan lainnya, tetapi hanya membuat wadah default. <br><br>  Selanjutnya, buka wadah dengan menentukan frasa sandi yang sama: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># cryptsetup luksOpen /dev/vda2 container Enter passphrase for /dev/vda2:</span></span></code> </pre><br>  Sekarang kami memiliki wadah terbuka yang dapat diakses melalui device mapper: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># ls -l /dev/mapper | grep container lrwxrwxrwx 1 root root 7 Aug 14 14:01 container -&gt; ../dm-0</span></span></code> </pre> <br>  Sekarang kita dapat melanjutkan dengan lvm (saya akan menulis dengan cepat, karena ini bukan subjek): <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># pvcreate /dev/mapper/container Physical volume "/dev/mapper/container" successfully created. root@archiso ~ # vgcreate rootvg /dev/mapper/container Volume group "rootvg" successfully created root@archiso ~ # lvcreate -L1G -n swap rootvg Logical volume "swap" created. root@archiso ~ # lvcreate -L5G -n root rootvg Logical volume "root" created. root@archiso ~ # lvcreate -L2G -n home rootvg Logical volume "home" created. root@archiso ~ # lvs LV VG Attr LSize Pool Origin Data% Meta% Move Log Cpy%Sync Convert home rootvg -wi-a----- 2.00g root rootvg -wi-a----- 5.00g swap rootvg -wi-a----- 1.00g</span></span></code> </pre><br>  Selanjutnya, buat sistem file di lv kami: <br><br><pre> <code class="bash hljs">root@archiso ~ <span class="hljs-comment"><span class="hljs-comment"># mkfs.ext4 -L root /dev/mapper/rootvg-root mke2fs 1.44.3 (10-July-2018) ... Writing superblocks and filesystem accounting information: done [root@archiso ~]# mkfs.ext4 -L home /dev/mapper/rootvg-home mke2fs 1.44.3 (10-July-2018) Creating filesystem with 524288 4k blocks and 131072 inodes ... Writing superblocks and filesystem accounting information: done [root@archiso ~]# mkswap -L swap /dev/mapper/rootvg-swap ... LABEL=swap, UUID=98b0bc31-1c62-4fec-bb97-e1913d1e8cb4</span></span></code> </pre><br>  Sekarang semua ini dapat dipasang untuk menginstal sistem dasar.  Titik instalasi adalah / mnt, di mana root dari sistem masa depan kita akan dimulai: <br><br><pre> <code class="bash hljs">[root@archiso ~]<span class="hljs-comment"><span class="hljs-comment"># mount /dev/mapper/rootvg-root /mnt/ [root@archiso ~]# mkdir -p /mnt/{home,boot/efi}</span></span></code> </pre><br>  <i>*** / boot / efi yang saya buat sehingga / boot itu sendiri tetap di / dev / mapper / rootvg-root, dan folder efi sudah di-mount di / dev / vda1 (partisi fat32 efi):</i> <br><br><pre> <code class="bash hljs">[root@archiso ~]<span class="hljs-comment"><span class="hljs-comment"># mount /dev/vda1 /mnt/boot/efi/ [root@archiso ~]# mount /dev/mapper/rootvg-home /mnt/home/ [root@archiso ~]# swapon /dev/mapper/rootvg-swap</span></span></code> </pre><br>  Periksa titik pemasangan saat ini (selalu berguna): <br><br><pre> <code class="bash hljs">[root@archiso ~]<span class="hljs-comment"><span class="hljs-comment"># lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT loop0 7:0 0 462.5M 1 loop /run/archiso/sfs/airootfs sr0 11:0 1 573M 0 rom /run/archiso/bootmnt vda 254:0 0 15G 0 disk ‚îú‚îÄvda1 254:1 0 512M 0 part /mnt/boot/efi ‚îî‚îÄvda2 254:2 0 14.5G 0 part ‚îî‚îÄcontainer 253:0 0 14.5G 0 crypt ‚îú‚îÄrootvg-swap 253:1 0 1G 0 lvm [SWAP] ‚îú‚îÄrootvg-root 253:2 0 5G 0 lvm /mnt ‚îî‚îÄrootvg-home 253:3 0 2G 0 lvm /mnt/home</span></span></code> </pre> <br>  Seperti yang kita lihat, semuanya jujur ‚Äã‚Äãdan sekarang saatnya menempatkan lengkungan itu sendiri. <br><br><h4>  Instalasi sistem dasar </h4><br>  Instal paket base dari set base dan devel-devel menggunakan paket pacstrap (Anda dapat meletakkan semua yang Anda inginkan dan selain itu): <br><br><pre> <code class="bash hljs">pacstrap /mnt base base-devel</code> </pre> <br>  Semuanya boot dengan sempurna, sistem dasar sudah siap.  Secara alami, saya menghapus kesimpulan.  Sekarang kita dapat mengkonfigurasi sistem ini untuk boot dan bekerja. <br><br>  Dari hal-hal dasar, kami segera menghasilkan fstab: <br><br><pre> <code class="bash hljs">genfstab -pU /mnt &gt;&gt; /mnt/etc/fstab</code> </pre><br>  Selanjutnya, buat arch-chroot ke dalam sistem baru ini: <br><br><pre> <code class="bash hljs">[root@archiso ~]<span class="hljs-comment"><span class="hljs-comment"># arch-chroot /mnt</span></span></code> </pre><br>  <i>*** arch-chroot adalah utilitas yang sangat berguna, karena ia melakukan semuanya dengan sendirinya.</i>  <i>Meskipun Anda selalu dapat menggunakan chroot standar, sebelum melakukan ini, ikuti instruksi di gentoo-handbook <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki.gentoo.org/wiki/Handbook</a> : AMD64 / Instalasi / Bagian Basis <b>‚Äú</b> Memasang <b>sistem file yang diperlukan‚Äù</b></i> <br><br>  Segera konfigurasikan waktu sistem dan nama host: <br><br><pre> <code class="bash hljs">ln -s /usr/share/zoneinfo/Europe/Moscow /etc/localtime &amp;&amp; \ hwclock --systohc &amp;&amp; \ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> luks-test &gt; /etc/hostname</code> </pre><br>  Tetapkan kata sandi root: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># passwd root New password: Retype new password: passwd: password updated successfully</span></span></code> </pre><br>  Batalkan komentar lokal yang diperlukan di /etc/locale.gen: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># vi /etc/locale.gen [root@archiso /]# grep -v '^#' /etc/locale.gen en_US ISO-8859-1 en_US.UTF-8 UTF-8 ru_RU.UTF-8 UTF-8 ru_RU ISO-8859-5</span></span></code> </pre> <br>  Kami akan menghasilkan mereka: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># locale-gen Generating locales... en_US.ISO-8859-1... done en_US.UTF-8... done ru_RU.UTF-8... done ru_RU.ISO-8859-5... done Generation complete</span></span></code> </pre> <br>  Segera konfigurasikan untuk sistem dan konsol: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># echo LANG=en_US.UTF-8 &gt; /etc/locale.conf [root@archiso /]# echo KEYMAP=ru &gt; /etc/vconsole.conf [root@archiso /]# echo FONT=cyr-sun16 &gt;&gt; /etc/vconsole.conf</span></span></code> </pre> <br>  Sekarang konfigurasikan file /etc/mkinitcpio.conf, yang bertanggung jawab untuk opsi, kait, dll. Saat membuat initramfs: <br><br><pre> <code class="bash hljs">vi /etc/mkinitcpio.conf</code> </pre> <br>  Yang paling penting adalah pengait dan urutannya: <br><br><pre> <code class="bash hljs">HOOKS=(base udev autodetect modconf block keymap encrypt lvm2 resume filesystems keyboard fsck)</code> </pre> <br>  <i>*** melanjutkan pengait untuk mem-boot sistem setelah hibernasi dari swap.</i>  <i>Pada mesin virtual itu tidak diperlukan.</i>  <i>Saya menyalinnya dari beech.</i> <br><br>  Sekarang kita dapat menghasilkan initramfs: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># mkinitcpio -p linux ==&gt; Building image from preset: /etc/mkinitcpio.d/linux.preset: 'default' -&gt; -k /boot/vmlinuz-linux -c /etc/mkinitcpio.conf -g /boot/initramfs-linux.img ==&gt; Starting build: 4.17.14-arch1-1-ARCH -&gt; Running build hook: [base] -&gt; Running build hook: [udev] -&gt; Running build hook: [autodetect] -&gt; Running build hook: [modconf] -&gt; Running build hook: [block] -&gt; Running build hook: [keymap] -&gt; Running build hook: [encrypt] -&gt; Running build hook: [lvm2] -&gt; Running build hook: [resume] -&gt; Running build hook: [filesystems] -&gt; Running build hook: [keyboard] -&gt; Running build hook: [fsck] ==&gt; Generating module dependencies ==&gt; Creating gzip-compressed initcpio image: /boot/initramfs-linux.img ==&gt; Image generation successful</span></span></code> </pre><br>  Sekarang setelah kita memiliki sistem, kita perlu menginstal bootloader itu sendiri.  Pilihan saya jatuh pada grub (2), karena entah bagaimana lebih akrab dan cukup mudah memuat kernel dari partisi terenkripsi (baik, atau saya tidak benar-benar mencari yang lain). <br><br>  Instal paket grub: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># pacman -S grub dosfstools efibootmgr mtools</span></span></code> </pre><br>  Sebelum membuat konfigurasi, edit opsi grub default: <br><br><pre> <code class="bash hljs">vim /etc/default/grub</code> </pre><br>  di sini Anda perlu menghapus komentar pada satu baris penting (tidak ada komentar, tentu saja): <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Uncomment to enable booting from LUKS encrypted devices GRUB_ENABLE_CRYPTODISK=y</span></span></code> </pre><br>  dan tambahkan (ada yang kosong secara default) ke GRUB_CMDLINE_LINUX: <br><br><pre> <code class="bash hljs">GRUB_CMDLINE_LINUX=<span class="hljs-string"><span class="hljs-string">"cryptdevice=UUID=5ad7c9ad-fb17-4839-925e-479432516c07:container"</span></span></code> </pre><br>  <i>UUID yang saya ambil dari blkid:</i> <i><br><br></i> <pre> <i><code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># blkid | grep vda2 /dev/vda2: UUID="5ad7c9ad-fb17-4839-925e-479432516c07" TYPE="crypto_LUKS" PARTLABEL="Linux filesystem" PARTUUID="667a1243-17ff-4f03-952c-5afd5e3415cc"</span></span></code></i> </pre><br>  Kami membuat konfigurasi untuk grub: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># grub-mkconfig -o /boot/grub/grub.cfg Generating grub configuration file ... WARNING: Failed to connect to lvmetad. Falling back to device scanning. Found linux image: /boot/vmlinuz-linux Found initrd image: /boot/initramfs-linux.img Found fallback initrd image(s) in /boot: initramfs-linux-fallback.img WARNING: Failed to connect to lvmetad. Falling back to device scanning. done</span></span></code> </pre><br>  Selanjutnya, instal grub sendiri pada disk: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># grub-install /dev/vda Installing for x86_64-efi platform. ... Installation finished. No error reported.</span></span></code> </pre><br>  <i>*** Anda dapat menambahkan --recheck --debug, tentukan arsitekturnya ... tapi ... itu benar-benar berfungsi dengan sendirinya)</i> <br><br>  Sekarang kita akan mengedit / etc / crypttab sehingga sistem itu sendiri tahu bahwa ketika memuat perlu mendekripsi bagian LUKS.  Tambahkan baris: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"container /dev/vda2 none"</span></span> &gt;&gt; /etc/crypttab</code> </pre><br>  Yang berarti bahwa Anda perlu meminta kata sandi (tidak ada) untuk partisi / dev / vda2 dan menyajikannya sebagai wadah melalui perangkat mapper. <br><br>  Sekarang kita siap untuk keluar dari chroot dan reboot sistem: <br><br><pre> <code class="bash hljs">[root@archiso /]<span class="hljs-comment"><span class="hljs-comment"># exit exit [root@archiso ~]# reboot Welcome back!</span></span></code> </pre> <br>  Sekarang mari kita beralih ke konsol mesin virtual untuk melihat hasilnya: <br><br><img src="https://habrastorage.org/webt/zx/hd/sh/zxhdshkaqy4zc06h3_etdlrwfxu.png"><br><br>  Pada tahap ini, kami memulai aplikasi EFI /boot/efi/EFI/arch/grubx64.efi dengan / dev / vda1, yang meminta kami kata sandi untuk mendekripsi wadah kami. <br><br>  Selanjutnya, setelah memasukkan kata sandi: <br><br><img src="https://habrastorage.org/webt/g3/o1/px/g3o1px_jx-gved8okzl2ojt2m3y.png"><br><br>  Ini adalah jendela grub yang familier dengan opsi boot kami dari /boot/grub/grub.cfg. <br>  Pada tahap ini, grub mendekripsi kontainer kami dan mendapatkan akses ke file ini sendiri (/boot/grub/grub.cfg), kernel, dan initramfs.  Setelah memilih opsi, kernel akan boot secara default, initramfs: <br><br><img src="https://habrastorage.org/webt/4o/lh/gg/4olhggvohhh5t5wvk8ta0wzeoek.png"><br><br>  Secara aktif, kernel muncul dengan kait terenkripsi, yang lagi-lagi meminta kami untuk kata sandi untuk mendekripsi wadah (secara umum, Anda perlu memasukkan kata sandi 2 kali, tetapi mungkin Anda membuat 2 wadah untuk boot dan root dari kelebihan paranoia :) <br><br>  Dan kemudian setelah sistem terisi penuh: <br><br><img src="https://habrastorage.org/webt/sp/bz/dp/spbzdplbl60sycfknr2bjuc5wuk.png"><br><br>  <b>PS:</b> untuk meningkatkan level skizofrenia, hanya boot aman saja tidak cukup untuk menandatangani bootloader grubx64.efi kami. <br><br>  Saya merasa tidak menarik untuk hanya meletakkan kernel dan initramfs di / dev / vda1, karena saya sudah melakukannya 100 kali.  Boot loader lain seperti SHIM, bootctl, dll. Tidak tahu bagaimana melakukan ini (yah, jika saya tidak tahu, beri tahu kami di komentar) <br><br><div class="spoiler">  <b class="spoiler_title">Bahan yang berguna tentang topik dan bahan yang digunakan</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki.archlinux.org/index.php/Dm-crypt/Encrypting_an_entire_system#LVM_on_LUKS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki.gentoo.org/wiki/Efibootmgr/en</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki.archlinux.org/index.php/Installation_guide</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wiki.archlinux.org/index.php/EFI_system_partition</a> </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id420081/">https://habr.com/ru/post/id420081/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id420071/index.html">Harga berbeda untuk gudang di multi-gudang. Perbaikan 1C-Bitrix</a></li>
<li><a href="../id420073/index.html">Seni Manajemen: Tinjauan Laporan Terbaik dengan Teamlead Conf 2018. Bagian 2</a></li>
<li><a href="../id420075/index.html">Peta cerdik ini menjelaskan bagaimana segala sesuatu dalam fisika cocok satu sama lain.</a></li>
<li><a href="../id420077/index.html">Peluang Perdagangan Online Baru</a></li>
<li><a href="../id420079/index.html">Membuat Rumput Interaktif di Mesin Unreal</a></li>
<li><a href="../id420083/index.html">Tindakan Ideal untuk Asisten Google - 8 pelajaran dari Moscow Hackathon</a></li>
<li><a href="../id420085/index.html">Pengenalan objek dan emosi manusia menggunakan Firebase ML Kit</a></li>
<li><a href="../id420087/index.html">Ini adalah pos dengan laporan dan video di MS SQL Server.</a></li>
<li><a href="../id420089/index.html">Robomobiles: Peleton dan Sosis Bavaria</a></li>
<li><a href="../id420091/index.html">Komentar dalam kode sebagai cara ekspresi diri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>