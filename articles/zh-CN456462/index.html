<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸŒ¾ ğŸ¥’ ğŸ•“ å°†è§’åº¦ç»„ä»¶åº“ç»„è£…ä¸ºWebç»„ä»¶ ğŸ‘¼ğŸ¾ â¬…ï¸ ğŸŒ„</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ­£åœ¨æ’°å†™è®¸å¤šæœ‰å…³Angular Elementsçš„æ–‡ç« ï¼Œå¹¶å®šæœŸé˜…è¯»æŠ¥å‘Šã€‚ å°±åƒï¼Œæ‚¨ä¸å†éœ€è¦éƒ¨ç½²å¤šä¸ªå®Œæ•´çš„è§’åº¦-åªéœ€æ”¶é›†Webç»„ä»¶å¹¶åœ¨é¡µé¢ä¸Šä½¿ç”¨å®ƒä»¬å³å¯ã€‚ 

 ä½†æ˜¯ï¼Œé€šå¸¸ï¼Œè¿™äº›ææ–™ä»…é™äºè€ƒè™‘ç›¸å½“ä¹Œæ‰˜é‚¦çš„æƒ…å†µï¼šæˆ‘ä»¬åˆ¶ä½œä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®ï¼Œåˆ›å»ºä¸€ä¸ªè§’åº¦ç»„ä»¶ï¼Œé…ç½®è¯¥é¡¹ç›®ä»¥ç»„è£…Elementsï¼Œæœ€åç¼–è¯‘å‡ ä¸ªJS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å°†è§’åº¦ç»„ä»¶åº“ç»„è£…ä¸ºWebç»„ä»¶</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/456462/"> æ­£åœ¨æ’°å†™è®¸å¤šæœ‰å…³Angular Elementsçš„æ–‡ç« ï¼Œå¹¶å®šæœŸé˜…è¯»æŠ¥å‘Šã€‚ å°±åƒï¼Œæ‚¨ä¸å†éœ€è¦éƒ¨ç½²å¤šä¸ªå®Œæ•´çš„è§’åº¦-åªéœ€æ”¶é›†Webç»„ä»¶å¹¶åœ¨é¡µé¢ä¸Šä½¿ç”¨å®ƒä»¬å³å¯ã€‚ <br><br> ä½†æ˜¯ï¼Œé€šå¸¸ï¼Œè¿™äº›ææ–™ä»…é™äºè€ƒè™‘ç›¸å½“ä¹Œæ‰˜é‚¦çš„æƒ…å†µï¼šæˆ‘ä»¬åˆ¶ä½œä¸€ä¸ªå•ç‹¬çš„é¡¹ç›®ï¼Œåˆ›å»ºä¸€ä¸ªè§’åº¦ç»„ä»¶ï¼Œé…ç½®è¯¥é¡¹ç›®ä»¥ç»„è£…Elementsï¼Œæœ€åç¼–è¯‘å‡ ä¸ªJSæ–‡ä»¶ï¼Œå°†å®ƒä»¬è¿æ¥åˆ°å¸¸è§„é¡µé¢å°†ä¸ºæˆ‘ä»¬æä¾›æ‰€éœ€çš„ç»“æœã€‚ ä¸‡å²ï¼Œè¯¥ç»„ä»¶å·¥ä½œæ­£å¸¸ï¼ <br><br><img src="https://habrastorage.org/webt/m0/n_/x-/m0n_x-qmnnmm76bosbioi_b12ni.png" alt="å›¾ç‰‡"><br><br> åœ¨å®è·µä¸­ï¼Œæ­¤å¤–ï¼Œä¼˜é€‰åœ°ï¼Œéœ€è¦ä»ç°æˆçš„å·¥ä½œè§’åº¦é¡¹ç›®ä¸­æ‹‰å‡ºå‡ ä¸ªéƒ¨ä»¶ï¼Œä»¥ä¾¿ä¸å½±å“å…¶å½“å‰çš„å¼€å‘å’Œä½¿ç”¨ã€‚ æ­£æ˜¯ç”±äºä»¥ä¸‹ä¸€ç§æƒ…å†µï¼Œæœ¬æ–‡æ‰è¢«è¯å®ï¼šæˆ‘ä¸ä»…è¦ç»„è£…é¡¹ç›®çš„å„ä¸ªå…ƒç´ ï¼Œè€Œä¸”è¦å®Œæˆå°†Angularä¸Šçš„æ•´ä¸ªUIåº“ç¼–è¯‘ä¸ºä¸€ç»„å…·æœ‰æœ¬åœ°Webç»„ä»¶çš„æ–‡ä»¶çš„è¿‡ç¨‹ã€‚ <br><a name="habracut"></a><br><h3> æ¨¡å—å‡†å¤‡ </h3><br> é¦–å…ˆï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ç”¨äºç¼–è¯‘Angular Elementsçš„æ¨¡å—çš„å¤–è§‚ã€‚ <br><br><pre><code class="javascript hljs">@NgModule({ <span class="hljs-attr"><span class="hljs-attr">imports</span></span>: [BrowserModule], <span class="hljs-attr"><span class="hljs-attr">entryComponents</span></span>: [SomeComponent], }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(readonly injector: Injector) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ngElement = createCustomElement(SomeComponent, { injector, }); customElements.define(<span class="hljs-string"><span class="hljs-string">'some-component'</span></span>, ngElement); } ngDoBootstrap() {} }</code> </pre> <br> æˆ‘ä»¬éœ€è¦ï¼š <br><br><ol><li> å°†æˆ‘ä»¬è®¡åˆ’åˆ¶ä½œä¸€ä¸ªè§’åº¦å…ƒç´ çš„ç»„ä»¶æ·»åŠ åˆ°entryComponentsä¸­ï¼Œå¯¼å…¥è¯¥ç»„ä»¶æ‰€éœ€çš„æ¨¡å—ã€‚ </li><li> ä½¿ç”¨createCustomElementå’Œæ³¨å…¥å™¨åˆ›å»ºè§’åº¦å…ƒç´ ã€‚ </li><li> åœ¨æµè§ˆå™¨çš„customElementsä¸­å£°æ˜ä¸€ä¸ªWebç»„ä»¶ã€‚ </li><li> é‡å†™ngDoBootstrapæ–¹æ³•ä¸ºç©ºã€‚ </li></ol><br> ç¬¬ä¸€é¡¹æ˜¯ç»„ä»¶æœ¬èº«åŠå…¶ä¾èµ–é¡¹çš„åç§°ï¼Œå…¶ä½™ä¸‰é¡¹æ˜¯åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºWebç»„ä»¶æ‰€éœ€çš„è¿‡ç¨‹ã€‚ è¿™ç§åˆ†ç¦»å…è®¸æ‚¨å°†åˆ›å»ºå•ç‹¬å…ƒç´ çš„é€»è¾‘æ”¾åœ¨æŠ½è±¡è¶…ç±»ä¸­ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> abstract <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyElementModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(injector: Injector, component: InstanceType&lt;any&gt;, name: string) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ngElement = createCustomElement(component, { injector, }); customElements.define(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${MY_PREFIX}</span></span></span><span class="hljs-string">-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${name}</span></span></span><span class="hljs-string">`</span></span>, ngElement); } ngDoBootstrap() {} }</code> </pre><br> è¯¥è¶…ç±»èƒ½å¤Ÿä»æ³¨å…¥å™¨ï¼Œç»„ä»¶å’Œåç§°ä¸­ç»„è£…å‡ºå®Œæ•´çš„æœ¬æœºç»„ä»¶ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ³¨å†Œã€‚ ç”¨äºåˆ›å»ºç‰¹å®šå…ƒç´ çš„æ¨¡å—å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="javascript hljs">@NgModule({ <span class="hljs-attr"><span class="hljs-attr">imports</span></span>: [BrowserModule, MyButtonModule], <span class="hljs-attr"><span class="hljs-attr">entryComponents</span></span>: [MyButtonComponent], }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ButtonModule</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyElementModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(injector: Injector) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(injector, MyButtonComponent, <span class="hljs-string"><span class="hljs-string">'button'</span></span>); } }</code> </pre><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æŒ‰é’®çš„æ¨¡å—æ”¶é›†åˆ°NgModuleå…ƒæ•°æ®ä¸­ï¼Œå¹¶åœ¨entryComponentsä¸­ä»è¯¥æ¨¡å—å£°æ˜ç»„ä»¶ï¼Œè¿˜ä»Angularä¾èµ–é¡¹æ³¨å…¥æœºåˆ¶è·å–æ³¨å…¥å™¨ã€‚ <br><br> è¯¥æ¨¡å—å·²å‡†å¤‡å¥½è¿›è¡Œç»„è£…ï¼Œå¹¶å°†ä¸ºæˆ‘ä»¬æä¾›ä¸€ç»„JSæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å¯ä»¥æŠ˜å åˆ°å•ç‹¬çš„Webç»„ä»¶ä¸­ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå‡ ä¸ªæ¨¡å—ï¼Œç„¶åè½®æµä»ä¸­ç»„è£…Webç»„ä»¶ã€‚ <br><br><h3> æ±‡æ€»ä¸€äº›ç»„ä»¶ </h3><br> ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ç»“æœæ¨¡å—çš„å¼•å¯¼è¿‡ç¨‹ã€‚ æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘å–œæ¬¢å°†è¿™ç§é€»è¾‘æ”¾å…¥ä¸€ä¸ªå•ç‹¬çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æƒ³æ³•ï¼Œè¯¥æ–‡ä»¶å°†è´Ÿè´£ç¼–è¯‘ç‰¹å®šæ¨¡å—ã€‚ <br><br> å…ƒç´ çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><img src="https://habrastorage.org/webt/7t/5x/ff/7t5xffyjpc6svbpmyaapsvbk08o.png" alt="å›¾ç‰‡"><br><br> æœ€ç®€å•çš„ç‰ˆæœ¬ä¸­çš„ä¸€ä¸ªå•ç‹¬çš„ç¼–è¯‘æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="javascript hljs">enableProdMode(); platformBrowserDynamic() .bootstrapModule(ButtonModule) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err));</code> </pre><br> è¿™ç§æ–¹æ³•å°†æœ‰åŠ©äºè½»æ¾ç»•è¿‡å·²å‡†å¤‡å¥½çš„æ¨¡å—ï¼Œå¹¶é€šè¿‡Elementsçš„ç®€å•æ˜äº†åœ°ç»´æŠ¤é¡¹ç›®ç»“æ„ã€‚ <br><br> åœ¨angular.jsonæ„å»ºè®¾ç½®ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šæ”¶é›†çš„æ–‡ä»¶åˆ°distä¸­æŸä¸ªä¸´æ—¶æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"outputPath"</span></span>: <span class="hljs-string"><span class="hljs-string">"projects/elements/dist/tmp"</span></span></code> </pre><br> ç»„è£…æ¨¡å—åï¼Œä¼šæœ‰ä¸€ç»„è¾“å‡ºæ–‡ä»¶ã€‚ <br><br> å¯¹äºç¨‹åºé›†æœ¬èº«ï¼Œè¯·åœ¨angular-cliä¸­ä½¿ç”¨é€šå¸¸çš„buildå‘½ä»¤ï¼š <br><br><pre> <code class="bash hljs">ng run elements:build:production --main=<span class="hljs-string"><span class="hljs-string">'projects/elements/src/${project}/${component}/compile.ts'</span></span></code> </pre><br> æœ€ç»ˆäº§å“å°†æ˜¯ä¸€ä¸ªå•ç‹¬çš„å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨Ahead-of-Time-compilationæ‰“å¼€ç”Ÿäº§æ ‡å¿—ï¼Œç„¶åå°†è·¯å¾„æ›¿æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼Œè¯¥æ–‡ä»¶ç”±é¡¹ç›®å’Œç»„ä»¶åç§°ç»„æˆã€‚ <br><br> ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç»“æœæ”¶é›†åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œè¿™å°†æ˜¯æˆ‘ä»¬å•ç‹¬çš„Webç»„ä»¶çš„æœ€ç»ˆæ†ç»‘åŒ…ã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨æ™®é€šçš„çŒ«ï¼š <br><br><pre> <code class="bash hljs">cat dist/tmp/runtime.js dist/tmp/main.js &gt; dist/tmp/my-<span class="hljs-variable"><span class="hljs-variable">${component}</span></span>.js</code> </pre><br> åœ¨æ­¤å¤„éœ€è¦æ³¨æ„çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬ä¸è¦å°†polyfills.jsæ–‡ä»¶æ”¾åœ¨æ¯ä¸ªç»„ä»¶çš„æ†ç»‘åŒ…ä¸­ï¼Œå› ä¸ºå¦‚æœå°†æ¥åœ¨åŒä¸€é¡µé¢ä¸Šä½¿ç”¨å¤šä¸ªç»„ä»¶ï¼Œåˆ™ä¼šå¾—åˆ°é‡å¤ã€‚ å½“ç„¶ï¼Œæ‚¨åº”è¯¥åœ¨angular.jsonä¸­ç¦ç”¨outputHashingé€‰é¡¹ã€‚ <br><br> æˆ‘ä»¬å°†æŠŠç»“æœåŒ…ä»ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶å¤¹è½¬ç§»åˆ°ä¸€ä¸ªç”¨äºå­˜å‚¨ç»„ä»¶çš„æ–‡ä»¶å¤¹ã€‚ ä¾‹å¦‚ï¼Œåƒè¿™æ ·ï¼š <br><br><pre> <code class="bash hljs">cp dist/tmp/my-<span class="hljs-variable"><span class="hljs-variable">${component}</span></span>.js dist/components/</code> </pre><br> å‰©ä¸‹çš„åªæ˜¯å°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€èµ·-ç¼–è¯‘è„šæœ¬å·²å‡†å¤‡å°±ç»ªï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// compileComponents.js projects.forEach(project =&gt; { const components = fs.readdirSync(`src/${project}`); components.forEach(component =&gt; compileComponent(project, component)); }); function compileComponent(project, component) { const buildJsFiles = `ng run elements:build:production --aot --main='projects/elements/src/${project}/${component}/compile.ts'`; const bundleIntoSingleFile = `cat dist/tmp/runtime.js dist/tmp/main.js &gt; dist/tmp/my-${component}.js`; const copyBundledComponent = `cp dist/tmp/my-${component}.js dist/components/`; execSync(`${buildJsFiles} &amp;&amp; ${bundleIntoSingleFile} &amp;&amp; ${copyBundledComponent}`); }</span></span></code> </pre><br> ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç®€æ´çš„çˆ¶äº²ï¼Œå…¶ä¸­åŒ…å«ä¸€ç»„Webç»„ä»¶ï¼š <br><br><img src="https://habrastorage.org/webt/7o/nk/xn/7onkxngfgmbewzxeq9-d5ikovt8.png" alt="å›¾ç‰‡"><br><br><h3> å°†ç»„ä»¶è¿æ¥åˆ°å¸¸è§„é¡µé¢ </h3><br> æˆ‘ä»¬ç»„è£…çš„Webç»„ä»¶å¯ä»¥ç‹¬ç«‹æ’å…¥é¡µé¢ä¸­ï¼Œå¹¶æ ¹æ®éœ€è¦è¿æ¥å…¶JSåŒ…ï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-elements-input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">my-elements-input</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my-input.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> ä¸ºäº†ä¸æ‹–æ‹½æ¯ä¸ªç»„ä»¶çš„æ•´ä¸ªzone.jsï¼Œæˆ‘ä»¬åœ¨æ–‡æ¡£å¼€å§‹å¤„å°†å…¶è¿æ¥ä¸€æ¬¡ï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"zone.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> è¯¥ç»„ä»¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ <br><br> ç„¶åæ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-elements-button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onClick()"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-elements-button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my-button.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> æˆ‘ä»¬å¯åŠ¨é¡µé¢å¹¶... <br><br><img src="https://habrastorage.org/webt/kq/36/xx/kq36xxo1cjhlf0vqhnptywiytcq.png" alt="å›¾ç‰‡"><br><br> å“¦ï¼Œåäº†ï¼ <br><br> å¦‚æœæˆ‘ä»¬æŸ¥çœ‹æ†ç»‘åŒ…ï¼Œå°±ä¼šå‘ç°è¿™æ ·ä¸€æ¡ä¸èµ·çœ¼çš„è¡Œï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.webpackJsonp=<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.webpackJsonp||[]</code> </pre><br><img src="https://habrastorage.org/webt/49/3n/i_/493ni_nz-hug_uyxsw8eskihvnc.jpeg" alt="å›¾ç‰‡"><br><br>  Webpackè¡¥ä¸ç¨‹åºçª—å£ï¼Œä»¥å…é‡å¤åŠ è½½ç›¸åŒçš„æ¨¡å—ã€‚ äº‹å®è¯æ˜ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªæ·»åŠ åˆ°é¡µé¢çš„ç»„ä»¶æ‰èƒ½å°†è‡ªèº«æ·»åŠ åˆ°customElementsã€‚ <br><br> è¦è§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨custom-webpackï¼š <br><br><ol><li> ä½¿ç”¨å…ƒç´ å°†custom-webpackæ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼š <br><br> <code>ng add @angular-builders/custom-webpack --project=elements <br></code> <br></li><li> é…ç½®angular.jsonï¼š <br><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"builder"</span></span>: <span class="hljs-string"><span class="hljs-string">"@angular-builders/custom-webpack:browser"</span></span>, <span class="hljs-string"><span class="hljs-string">"options"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"customWebpackConfig"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"./projects/elements/elements-webpack.config.js"</span></span> }, ...</code> </pre><br></li><li> åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰webpacké…ç½®æ–‡ä»¶ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">jsonpFunction</span></span>: <span class="hljs-string"><span class="hljs-string">'myElements-'</span></span> + uuidv1(), <span class="hljs-attr"><span class="hljs-attr">library</span></span>: <span class="hljs-string"><span class="hljs-string">'elements'</span></span>, }, };</code> </pre><br> åœ¨å…¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä»»ä½•æ–¹ä¾¿çš„æ–¹å¼ä¸ºæ¯ä¸ªç¨‹åºé›†ç”Ÿæˆå”¯ä¸€çš„IDã€‚ æˆ‘åˆ©ç”¨äº†uuidã€‚ <br></li></ol><br> æ‚¨å¯ä»¥å†æ¬¡è¿è¡Œæ„å»ºè„šæœ¬-æ–°ç»„ä»¶åœ¨åŒä¸€é¡µé¢ä¸Šè¿è¡Œè‰¯å¥½ã€‚ <br><br><h3> å¸¦æ¥ç¾ä¸½ </h3><br> æˆ‘ä»¬çš„ç»„ä»¶ä½¿ç”¨å…¨å±€CSSå˜é‡æ¥æŒ‡å®šç»„ä»¶çš„é¢œè‰²ä¸»é¢˜å’Œå¤§å°ã€‚ <br><br> åœ¨ä½¿ç”¨æˆ‘ä»¬çš„åº“çš„è§’åº¦åº”ç”¨ç¨‹åºä¸­ï¼Œå®ƒä»¬æ”¾ç½®åœ¨é¡¹ç›®çš„æ ¹ç»„ä»¶ä¸­ã€‚ å¯¹äºç‹¬ç«‹çš„Webç»„ä»¶ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› æ­¤åªéœ€ç¼–è¯‘æ ·å¼å¹¶è¿æ¥åˆ°ä½¿ç”¨Webç»„ä»¶çš„é¡µé¢å³å¯ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// compileHelpers.js compileMainTheme(); function compileMainTheme() { const pathFrom = `../../main-project/styles/themes`; const pathTo = `dist/helpers`; execSync( `lessc ${pathFrom}/theme-default-vars.less ${pathTo}/main-theme.css`,; ); }</span></span></code> </pre><br> æˆ‘ä»¬ä½¿ç”¨çš„æ›´å°‘ï¼Œå› æ­¤åªéœ€ç¼–è¯‘æˆ‘ä»¬çš„lesscå˜é‡ï¼Œç„¶åå°†ç»“æœæ–‡ä»¶æ”¾å…¥helpersæ–‡ä»¶å¤¹ã€‚ <br><br> è¿™ç§æ–¹æ³•ä½¿æ‚¨å¯ä»¥æ§åˆ¶é¡µé¢ä¸­æ‰€æœ‰Webç»„ä»¶çš„æ ·å¼ï¼Œè€Œæ— éœ€é‡æ–°ç¼–è¯‘å®ƒä»¬ã€‚ <br><br><h3> æœ€ç»ˆè„šæœ¬ </h3><br> å®é™…ä¸Šï¼Œç»„è£…ä¸Šè¿°å…ƒç´ çš„æ•´ä¸ªè¿‡ç¨‹å¯ä»¥ç®€åŒ–ä¸ºä¸€ç»„åŠ¨ä½œï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh rm -r -f dist/ &amp;&amp; mkdir -p dist/components &amp;&amp; node compileElements.js &amp;&amp; node compileHelpers.js &amp;&amp; rm -r -f dist/tmp</span></span></code> </pre><br> ä»ç„¶ä»…éœ€ä»main package.jsonè°ƒç”¨æ­¤è„šæœ¬ï¼Œä»¥å‡å°‘ç¼–è¯‘å®é™…è§’åº¦åˆ†é‡çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œè€Œåªéœ€æ‰§è¡Œä¸€ä¸ªå‘½ä»¤å³å¯ã€‚ <br><br> å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a>ä¸Šæ‰¾åˆ°ä¸Šè¿°æ‰€æœ‰è„šæœ¬ä»¥åŠä½¿ç”¨angularå’Œnativeç»„ä»¶çš„æ¼”ç¤ºã€‚ <br><br><h3> åˆè®¡ </h3><br> æˆ‘ä»¬ç»„ç»‡äº†ä¸€ä¸ªè¿‡ç¨‹ï¼Œå…¶ä¸­æ·»åŠ æ–°çš„Webç»„ä»¶ä»…éœ€èŠ±è´¹å‡ åˆ†é’Ÿï¼ŒåŒæ—¶ä¿æŒä»ä¸­è·å–ä¸»è¦è§’åº¦é¡¹ç›®çš„ç»“æ„ã€‚ <br><br> ä»»ä½•å¼€å‘äººå‘˜éƒ½å¯ä»¥å°†ç»„ä»¶æ·»åŠ åˆ°ä¸€ç»„å…ƒç´ ä¸­ï¼Œå¹¶å°†å®ƒä»¬ç»„è£…åˆ°ä¸€ç»„å•ç‹¬çš„JS Webç»„ä»¶åŒ…ä¸­ï¼Œè€Œæ— éœ€ç ”ç©¶ä½¿ç”¨Angular Elementsçš„ç»†èŠ‚ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN456462/">https://habr.com/ru/post/zh-CN456462/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN456442/index.html">åœ¨Yandexå’ŒJetBrainsçš„æ”¯æŒä¸‹è¿›å…¥åœ£å½¼å¾—å ¡å›½ç«‹å¤§å­¦çš„æœ¬ç§‘è¯¾ç¨‹</a></li>
<li><a href="../zh-CN456446/index.html">Ceph-ä»â€œè†ç›–â€åˆ°â€œç”Ÿäº§â€</a></li>
<li><a href="../zh-CN456448/index.html">é€‰æ‹©JSæ¡†æ¶çš„è§„åˆ™</a></li>
<li><a href="../zh-CN456450/index.html">DO-RA.Aviaç”¨äºç›‘æ§èˆªç©ºå®‡å®™è¾å°„</a></li>
<li><a href="../zh-CN456452/index.html">Rangesä¹‹å‰å’Œä¹‹åçš„C ++ä»£ç ç¤ºä¾‹</a></li>
<li><a href="../zh-CN456466/index.html">å¦‚ä»Šçš„PHPæ³›å‹ï¼ˆå·®ä¸å¤šï¼‰</a></li>
<li><a href="../zh-CN456470/index.html">WSUS Package Publisherçš„é™·é˜±</a></li>
<li><a href="../zh-CN456472/index.html">ä»‹ç»Goå’ŒMggoæ¡†æ¶</a></li>
<li><a href="../zh-CN456474/index.html">äº•å­—æ¸¸æˆç¬¬0éƒ¨åˆ†ï¼šæ¯”è¾ƒè‹—æ¡å’Œååº”</a></li>
<li><a href="../zh-CN456476/index.html">ä¿®æ”¹äº†è“ç‰™å †æ ˆï¼Œä»¥æ”¹å–„æ²¡æœ‰AACï¼ŒaptXæˆ–LDACç¼–è§£ç å™¨çš„è€³æœºä¸Šçš„éŸ³é¢‘è´¨é‡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>