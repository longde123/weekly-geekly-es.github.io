<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò£ üìÄ üõÄüèΩ Die Kunst des Schamanismus oder der benutzerdefinierten Firmware f√ºr Olinuxino. UBOOT Teil 2 ü•ã üèÑ üôä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All dies wurde unter Ubuntu 16.04 gesammelt. 

 Die Entscheidung zum Erstellen der Firmware wurde aufgrund des fehlenden freien Zugriffs auf das Image...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die Kunst des Schamanismus oder der benutzerdefinierten Firmware f√ºr Olinuxino. UBOOT Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434942/">  All dies wurde unter Ubuntu 16.04 gesammelt. <br><br>  Die Entscheidung zum Erstellen der Firmware wurde aufgrund des fehlenden freien Zugriffs auf das Image f√ºr dieses Board (Olimex A13-Olinuxino) getroffen.  Und der Hersteller bot an, eine SD-Karte mit einem Image zu kaufen, die zu diesem Zeitpunkt etwa 10 Euro kostete, was nicht wirklich funktionierte. Au√üerdem war sie f√ºr einen Monitor konzipiert. <br><br>  Wir werden die Bootloader-Konfiguration f√ºr das Booten von der SD-Karte konfigurieren.  Da sich kein NAND-Speicher auf der Karte befindet und alle anderen Startoptionen leicht schief sind (wer uboot zusammenstellen kann, um von USB-Medien zu booten, sollte zwei Schritte vorw√§rts gehen und freigeben).  Der Allwinner-Algorithmus zum Laden von a13-Prozessoren finden Sie auf der Website des Herstellers.  Oder hier ist ein Ausschnitt aus einem Datenblatt. <br><br><img src="https://habrastorage.org/webt/4n/qd/wn/4nqdwnqofayue4o5x7i7it2nwmq.jpeg"><br><a name="habracut"></a><br>  Aus dem Algorithmus ist klar ersichtlich, dass der Bootloader zuerst auf der SD-Karte √ºberpr√ºft wird, dann der Rest und erst am Ende der Bootloader auf USB √ºberpr√ºft wird.  Daher k√∂nnen Tablets und Smartphones mit Ubuntu ausgef√ºhrt werden, wenn sie die SD-Karte auf die entsprechende Weise verschieben.  Und anscheinend wird ein solcher Algorithmus, wenn nicht f√ºr alle, f√ºr viele Hersteller von Armprozessoren gelten. <br><br>  Zuerst m√ºssen Sie die SD-Karte besch√§digen, damit beim Eingeben von Befehlen kein Fehler auftritt. Wir reduzieren den gesamten Vorgang auf eine Skriptdatei (ich ziehe es vor, alles auf solche Dateien zu reduzieren, da Sie sie mehrmals ausf√ºhren m√ºssen). <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh DEViCELINK=/dev/sdb fdisk $DEViCELINK &lt;&lt;EOF n #    p #   1 #   2048 #     2MiB +64M #  ,    kernel     dts  n p 2 +2G #    ubuntu n p 3 +2G #         n p 4 #         w EOF mkfs.ext2 /dev/sdb1 &lt;&lt; EOF #   kernel    fat16  ext2 y EOF mkfs.ext4 /dev/sdb2 &lt;&lt; EOF y EOF mkfs.ext4 /dev/sdb3 &lt;&lt; EOF y EOF mkfs.ext4 /dev/sdb4 &lt;&lt; EOF y EOF</span></span></code> </pre> <br><h4>  UBOOT Build </h4><br>  Lassen Sie uns n√§her auf den Bootloader eingehen, und da wir UBOOT ausw√§hlen, pumpen wir die Version von u-boot-2018.05 aus, letztere zu diesem Zeitpunkt. <br><br>  Es wird davon ausgegangen, dass die gesamte f√ºr die Montage erforderliche Software bereits installiert ist.  Starten Sie den Build, indem Sie den Bootloader konfigurieren. <br><br>  Um die Konfiguration zu starten, m√ºssen Sie mit UBOOT in den Ordner gehen und von dort aus den folgenden Befehl ausf√ºhren: <br><br><pre> <code class="plaintext hljs">make O=../olimex-uboot #       -j4 #     ARCH=arm #      CROSS_COMPILE=arm-linux-gnueabihf- #    xconfig #   GUI </code> </pre><br>  Als Ergebnis der Ausf√ºhrung erhalten wir ein solches Fenster. <br><br><img src="https://habrastorage.org/webt/pa/w-/9n/paw-9nsvkx9pbxwsiwpcto_mdnu.jpeg"><br><br>  Dies ist die sogenannte X-Version des Konfigurators. Sie verwenden normalerweise die Konsolenoption. Weitere Informationen sind darin enthalten. Dies ist jedoch visueller und deckt unsere Anforderungen vollst√§ndig ab. <br><br>  Und wenn Sie viel Zeit haben oder es Ihnen nichts ausmacht, k√∂nnen Sie den Bootloader selbst von Grund auf neu konfigurieren.  Es ist jedoch besser, die fertige Konfiguration dieser Karte √ºber das Dateimen√º herunterzuladen.  W√§hlen Sie im Ordner mit der Bootloader-Quelle unter /u-boot-2018.05/configs/ die Datei A13-OlinuXino_defconfig aus. Dies ist unsere Konfiguration, in der bereits alles installiert ist.  Klicken Sie anschlie√üend auf Speichern und schlie√üen Sie das Fenster, da hier nichts ge√§ndert werden muss. <br><br>  Der Build-Befehl muss noch ausgef√ºhrt werden: <br><br><pre> <code class="plaintext hljs">make O=../olimex-uboot -j4 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-</code> </pre><br>  In diesem Befehl sind die Elemente alle dieselben wie im vorherigen, nur ohne den Parameter xconfig, was Konfiguration bedeutet.  Das ist alles, der Bootloader ist zusammengebaut. <br><br>  Nachdem die Assembly abgeschlossen ist, m√ºssen wir in dem im Befehl angegebenen Ordner diese Datei "u-boot-sunxi-with-spl.bin" finden. Dies ist der gew√ºnschte Bootloader. <br><br>  Verwenden Sie als N√§chstes den folgenden Befehl, um den Bootloader auf die SD-Karte hochzuladen: <br><br><pre> <code class="plaintext hljs">dd if=../olimex-uboot/u-boot-sunxi-with-spl.bin #      of=/dev/sdb #     SD  bs=1024 seek=8 #  8KiB  ,     </code> </pre><br>  Der Bootloader, der gerade nach dem Start aufgezeichnet wurde, zeigt auf den n√§chsten Abschnitt der SD-Karte / dev / sdb1 und sucht dort nach einer Skriptdatei mit Umgebungsvariablen, die Anweisungen zum weiteren Laden enth√§lt. <br><br>  Diese Datei sollte boot.scr hei√üen. Eine Datei mit diesem Namen sucht nach dem Download nach uboot.  Nat√ºrlich k√∂nnen sowohl der Dateiname als auch die Download-Methode ge√§ndert werden, wenn Sie in die UBOOT-Konfiguration wechseln. Lassen Sie uns jedoch auf diese Option eingehen. <br><br>  Sie sollten auch Ger√§tebaumdateien f√ºr eine Sache kompilieren, sie befinden sich in der Quelle mit dem Bootloader unter /u-boot-2018.05/arch/arm/dts/. Wir sind an der Datei sun5i-a13-olinuxino.dts interessiert.  Es repr√§sentiert eine Konfiguration von Registern und Peripherieger√§ten des Prozessors.  Dies ist eine universelle Konfigurationsdatei, daher ist die Option m√∂glich, wenn ein Uboot-Bootloader f√ºr verschiedene Prozessoren verwendet wird, jedoch unterschiedliche dts-Dateien verwendet werden.  Dieselben dts-Dateien befinden sich auch im Quellcode des Linux-Kernels. Sie sind im Grunde die gleichen, nur ein wenig anders geschrieben, und Sie k√∂nnen ausw√§hlen, woher der zusammengestellte Ger√§tebaum stammt.  Im Allgemeinen m√ºssen Sie zum Erstellen von dts-Dateien den folgenden Befehl ausf√ºhren: <br><br><pre> <code class="plaintext hljs">make O=../olimex-uboot -j4 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- dtbs #      dts </code> </pre><br>  Die kompilierte Datei befindet sich unter ../olimex-uboot/arch/arm/dts/. <br>  Erw√§gen Sie, die Datei boot.scr detaillierter abzurufen. <br>  Erstellen Sie zun√§chst die Datei boot.cmd mit dem Inhalt: <br><br><pre> <code class="plaintext hljs">load mmc 0 0x43000000 sun5i-a13-olinuxino.dtb load mmc 0 0x42000000 uImage setenv bootargs root=/dev/mmcblk0p2 rootfstype=ext4 rw rootwait console=ttyS0,115200 bootm 0x42000000 ‚Äì 0x43000000</code> </pre><br>  Damit uboot die Anweisungen verstehen kann, muss diese Datei in Form eines Skripts vorliegen. Dazu m√ºssen Sie den folgenden Befehl ausf√ºhren: <br><br><pre> <code class="plaintext hljs"> mkimage -C none -A arm -T script -d boot.cmd boot.scr</code> </pre><br>  Wobei boot.scr die erforderliche Datei ist. <br><br>  Die erste Zeile l√§dt mmc 0 0x43000000 sun5i-a13-olinuxino.dtb l√§dt die Ger√§tebaumdatei an der angegebenen Adresse im RAM.  load mmc 0 gibt an, dass Sie die Datei aus dem ersten Abschnitt der SD-Karte herunterladen m√ºssen, w√§hrend die Nummerierung f√ºr uboot null und nicht eins ist. <br><br>  Die zweite Zeile load mmc 0 0x42000000 uImage l√§dt den zusammengestellten Linux-Kernel unter der angegebenen Adresse. <br><br>  F√ºr unsere Version wird die normalerweise weiter verwendete Variable setenv video-mode f√ºr uns nicht ben√∂tigt, da die Verwendung des Monitors nicht geplant ist. <br><br>  Dritte Zeile: <br><br><pre> <code class="plaintext hljs">setenv bootargs #    root=/dev/mmcblk0p2 #    SD    rootfs rootfstype=ext4 #    rootfs rw #    rootwait console=ttyS0,115200 #    uart0</code> </pre> <br>  Nun, der letzte Bootm-Befehl l√§dt den Kernel aus dem zuvor in den Speicher geladenen. <br><br>  Im n√§chsten Artikel wird der letzte Teil, der auf dem ersten Abschnitt der SD-Karte platziert werden sollte, die Bildung des Linux-Kernel-Kernels sein. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der erste Teil des Artikels</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der dritte Teil des Artikels</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de434942/">https://habr.com/ru/post/de434942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de434930/index.html">Videoanzeige heute: muss ein erfolgreiches Gesch√§ft haben</a></li>
<li><a href="../de434932/index.html">R√∂hrenverst√§rker ohne Kanon</a></li>
<li><a href="../de434934/index.html">Wie KI-Lernskalen</a></li>
<li><a href="../de434938/index.html">Was Sie 2019 von Tesla erwarten k√∂nnen: Modell Y, Modell S / X-Update und mehr</a></li>
<li><a href="../de434940/index.html">Gesch√§ft Ich liebe dich</a></li>
<li><a href="../de434944/index.html">Notizen eines Phytochemikers. Bananenschale schl√§gt zur√ºck</a></li>
<li><a href="../de434946/index.html">Mein Umzug nach Norwegen</a></li>
<li><a href="../de434950/index.html">Die Gegenwart, die unsere Zukunft bestimmen wird</a></li>
<li><a href="../de434952/index.html">OMower mit ROS, die ersten Schritte</a></li>
<li><a href="../de434956/index.html">Das IT-Unternehmen w√§chst, der Gewinn ist nicht besonders. Was zu tun ist?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>