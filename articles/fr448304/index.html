<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¶üèø üë®üèΩ‚Äçüî¨ üôÇ Le livre "Vue.js en action" ‚òÉÔ∏è üëØ ‚òØÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut, habrozhiteli! Le but de ce livre est de vous donner les connaissances avec lesquelles vous n'h√©siterez pas √† rejoindre n'importe quel projet ut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le livre "Vue.js en action"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/448304/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/7u/pn/a0/7upna0knmll01vosthivrjtjhpi.jpeg" align="left" alt="image"></a>  Salut, habrozhiteli!  Le but de ce livre est de vous donner les connaissances avec lesquelles vous n'h√©siterez pas √† rejoindre n'importe quel projet utilisant cette biblioth√®que.  Le livre est destin√© √† tous ceux qui sont int√©ress√©s √† apprendre Vue.js et qui ont une exp√©rience avec JavaScript, HTML et CSS.  Vous n'√™tes pas oblig√© d'avoir une connaissance approfondie de ce domaine, mais la compr√©hension des bases, telles que les tableaux, les variables, les boucles et les √©l√©ments HTML, ne fera pas de mal. <br><br>  Sous la coupe se trouve un passage sous la forme du chapitre Vuex, d√©crivant: quelle est la condition;  l'utilisation de getters;  mise en ≈ìuvre de mutations;  ajouter des actions;  travailler avec les m√©thodes d'assistance Vuex;  modules et configuration du projet. <br><a name="habracut"></a><br><h3>  10.1.  Pourquoi avons-nous besoin de Vuex </h3><br>  La biblioth√®que Vuex g√®re l'√©tat.  Il le stocke de mani√®re centralis√©e, ce qui facilite l'acc√®s √† tous les composants.  L'√©tat est une information ou une donn√©e qui prend en charge l'application.  Ceci est important car nous avons besoin d'un m√©canisme fiable et compr√©hensible pour travailler avec ces informations. <br><br>  Si vous avez d√©j√† de l'exp√©rience avec d'autres frameworks pour cr√©er des applications d'une seule page, certains de ces concepts peuvent vous sembler familiers.  Par exemple, React utilise un syst√®me de gestion d'√©tat similaire appel√© Redux.  Vuex et Redux sont influenc√©s par le projet Flux.  Il s'agit de l'architecture propos√©e par Facebook, qui est con√ßue pour simplifier la construction d'applications Web clientes.  Il contribue au mouvement des donn√©es dans un sens: des actions au r√©partiteur, puis au stockage et √† la fin √† la vue.  Cette approche vous permet de s√©parer l'√©tat du reste de l'application et encourage les mises √† jour synchrones.  Vous pouvez en savoir plus sur Flux √† partir de la documentation officielle sur facebook.github.io/flux/docs/overview.html. <br><br>  Vuex fonctionne sur le m√™me principe, aidant √† changer l'√©tat de mani√®re pr√©visible et synchrone.  Les d√©veloppeurs n'ont pas √† se soucier des cons√©quences de la mise √† jour de l'√©tat avec des fonctions synchrones et asynchrones.  Imaginez que nous interagissions avec une API de serveur qui renvoie des donn√©es au format JSON.  Que se passe-t-il si en m√™me temps ces donn√©es sont modifi√©es par une biblioth√®que tierce?  Nous ne voulons pas d'un r√©sultat impr√©visible.  Vuex permet d'√©viter de telles situations en √©liminant toutes les modifications asynchrones. <br>  Vous vous demandez probablement pourquoi nous avons m√™me besoin de la biblioth√®que Vuex.  Au final, Vue.js vous permet de transmettre des informations aux composants.  Comme vous le savez dans les chapitres pr√©c√©dents, les param√®tres d'entr√©e et les √©v√©nements utilisateur sont destin√©s √† cela.  Nous pourrions m√™me cr√©er notre propre bus d'√©v√©nements pour le transfert de donn√©es et la communication entre composants.  Un exemple d'un tel m√©canisme est pr√©sent√© sur la Fig.  10.1. <br><br>  Ce serait appropri√© pour les petites applications avec une poign√©e de composants.  Dans ce cas, vous devez transf√©rer les informations √† seulement quelques destinataires.  Mais que se passe-t-il si l'application est plus grande, plus complexe et en couches?  Il est clair que dans un grand projet, il n'est pas si facile de garder une trace de toutes les fonctions de rappel, des param√®tres d'entr√©e et des √©v√©nements. <br><br>  Juste pour de telles situations, la biblioth√®que Vuex a √©t√© cr√©√©e.  Il vous permet d'organiser le travail avec l'√âtat sous la forme d'un r√©f√©rentiel centralis√©.  Imaginez un sc√©nario qui m√©rite r√©flexion sur l'utilisation de Vuex.  Par exemple, nous travaillons sur un blog avec des articles et des commentaires que vous pouvez cr√©er, modifier et supprimer.  En m√™me temps, nous avons un panneau d'administration qui vous permet de bloquer et d'ajouter des utilisateurs. <br><br>  Voyons comment cela est impl√©ment√© √† l'aide de Vuex.  Dans la fig.  La figure 10.2 montre que le composant EditBio est un enfant du panneau d'administration.  Il a besoin d'acc√©der aux informations utilisateur pour pouvoir les mettre √† jour.  En travaillant avec Vuex, nous pouvons acc√©der au r√©f√©rentiel central, modifier les donn√©es et enregistrer les modifications directement √† partir du composant EditBio.  C'est bien mieux que de passer des informations de l'instance racine de Vue.js au composant Admin puis √† EditBio en utilisant les param√®tres d'entr√©e.  Il nous serait difficile de garder une trace des donn√©es situ√©es √† diff√©rents endroits. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xr/0b/03/xr0b03q-1ielejscatrwuawsmfw.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/az/hj/6x/azhj6xybhs1mchcgfshl3ardskq.png" alt="image"></div><br>  N√©anmoins, l'utilisation de Vuex a un prix sous la forme d'un code passe-partout suppl√©mentaire et de la complexit√© de la structure de l'application.  Comme d√©j√† mentionn√©, il est pr√©f√©rable de ne pas utiliser cette biblioth√®que dans des projets simples compos√©s de plusieurs composants.  Son v√©ritable potentiel se manifeste dans les grandes applications avec un √©tat plus complexe. <br><br><h3>  10.2.  Etat et mutation dans Vuex </h3><br>  Vuex stocke l'√©tat de l'ensemble de l'application dans un seul objet, √©galement appel√© source unique de v√©rit√©.  Comme son nom l'indique, toutes les donn√©es sont collect√©es en un seul endroit et ne sont pas dupliqu√©es dans d'autres parties du code. <br><blockquote>  CONSEIL <br><br>  Il convient de noter que nous ne sommes pas tenus de stocker toutes nos donn√©es dans Vuex.  Les composants individuels peuvent avoir leur propre √©tat local.  Dans certaines situations, cela est pr√©f√©rable.  Par exemple, votre composant a une variable qui n'est utilis√©e qu'√† l'int√©rieur.  Elle doit rester locale. </blockquote>  Prenons un exemple simple de travail avec l'√©tat dans Vuex.  Tout notre code sera plac√© dans un seul fichier.  Plus tard, vous apprendrez comment ajouter Vuex √† un projet √† l'aide de Vue-CLI.  Ouvrez un √©diteur de texte et cr√©ez le fichier vuex-state.html.  Nous afficherons un message situ√© dans le r√©f√©rentiel central et un compteur.  Le r√©sultat est montr√© dans la fig.  10.3. <br><br><img src="https://habrastorage.org/webt/iv/4v/tn/iv4vtnbwgbqcbfgp-gmmh1ujhsg.png" align="left" alt="image">  Tout d'abord, ajoutez des balises de script avec des liens vers Vue et Vuex.  Cr√©ez ensuite le balisage HTML.  Nous utiliserons les balises H1, H2, H3 et le bouton.  La balise h1 affiche l'en-t√™te avec une variable locale d√©clar√©e dans l'instance Vue.js.  Les messages de bienvenue et de compteur sont ex√©cut√©s en tant que propri√©t√©s calcul√©es sur la base du r√©f√©rentiel Vuex. <br><br>  L'√©l√©ment bouton d√©clenche une action d'incr√©mentation.  Copiez le code du Listing 10.1 dans le fichier vuex-state.html. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i8/0x/34/i80x34aujec0yim7ew-xuroqslu.png" alt="image"></div><br>  Lorsque vous avez termin√© avec le balisage HTML, commen√ßons √† cr√©er le r√©f√©rentiel Vuex.  Il contiendra toutes les donn√©es d'application, y compris les propri√©t√©s msg et count. <br><br>  Pour mettre √† jour l'√©tat, nous utilisons des mutations.  C'est quelque chose comme des setters d'autres langages de programmation.  Le passeur d√©finit la valeur, la mutation met √† jour l'√©tat du programme.  Dans Vuex, les mutations doivent √™tre synchrones.  Dans notre exemple, le compteur n'est incr√©ment√© qu'au clic d'un bouton, il n'est donc pas n√©cessaire de s'inqui√©ter du code asynchrone (plus tard, nous consid√©rerons les actions qui aident √† r√©soudre les probl√®mes d'asynchronie). <br><br>  Cr√©ez une fonction d'incr√©mentation √† l'int√©rieur de l'objet de mutations qui incr√©mente l'√©tat.  Prenez le code du Listing 10.2 et collez-le en bas du fichier vuex-state.html. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ev/35/cc/ev35cct8d2bymgoqwg47n6loghi.png" alt="image"></div><br>  Nous avons donc pr√©par√© le balisage HTML et le r√©f√©rentiel Vuex.  Vous pouvez maintenant ajouter une logique qui les connectera.  Nous voulons que le mod√®le affiche les valeurs de msg et de compteur, qui font partie de l'√©tat Vuex.  De plus, le compteur doit √™tre mis √† jour. <br><br>  Cr√©ez une instance de Vue.js avec une nouvelle fonction de donn√©es qui renverra une propri√©t√© d'en-t√™te locale avec le texte de l'application Vuex.  Dans la section calcul√©e, ajoutez les propri√©t√©s calcul√©es welcome et counter.  Le premier renverra store.state.msg, et le second - store.state.count. <br><br>  Enfin, vous devez ajouter une m√©thode appel√©e incr√©ment.  Une mutation a √©t√© d√©clar√©e dans le r√©f√©rentiel Vuex, mais nous ne pouvons pas l'utiliser directement pour mettre √† jour l'√©tat.  Une fonction de validation sp√©ciale est pr√©vue √† cet effet.  Il indique √† Vuex de mettre √† jour le r√©f√©rentiel et enregistre ainsi les modifications.  L'expression store.commit ('increment') effectue la mutation.  Ins√©rez l'extrait de code suivant (extrait 10.3) imm√©diatement apr√®s le code cr√©√© dans l'extrait 10.2. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ou/fr/fx/oufrfxchrwxh0ilabltkow4vl6e.png" alt="image"></div><br>  Ceci est une application de travail √† part enti√®re bas√©e sur Vuex!  Essayez d'appuyer sur le bouton - chaque fois que vous appuyez sur le compteur devrait augmenter de 1. <br><br>  Mettez √† jour le code afin qu'en appuyant sur le bouton, le compteur soit incr√©ment√© de 10. Si vous examinez attentivement la mutation d'incr√©mentation, vous remarquerez qu'elle ne prend qu'un seul argument, state.  Passons-en un autre - appelons-le charge utile.  Il sera transmis par la m√©thode d'incr√©mentation, qui est cr√©√©e dans l'instance racine de Vue.js. <br><br>  Copiez le contenu de vuex-state.html dans le nouveau fichier vuex-state-pass.html.  En utilisant cette application comme exemple, nous montrons comment les arguments sont pass√©s. <br><br>  Comme vous pouvez le voir dans l'extrait 10.4, seuls l'objet mutations et la m√©thode d'incr√©mentation doivent √™tre mis √† jour.  Ajoutez √† l'incr√©ment de mutation un autre argument appel√© charge utile.  Il s'agit de la valeur par laquelle state.count augmentera.  Recherchez l'appel √† store.commit dans la m√©thode d'incr√©mentation et sp√©cifiez 10 comme deuxi√®me argument.  Mettez √† jour le fichier vuex-state.html comme indiqu√© ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lp/ar/lp/lparlpajbodkpiupswhu-5sj814.png" alt="image"></div><br>  Enregistrez le fichier vuex-state-pass.html et ouvrez-le dans un navigateur.  Maintenant, lorsque le bouton est enfonc√©, le compteur doit augmenter de 10, et non de 1. Si quelque chose s'est mal pass√©, v√©rifiez la console du navigateur et assurez-vous que vous n'avez pas fait de fautes de frappe. <br><br><h3>  10.3.  Getters et actions </h3><br>  Dans l'exemple pr√©c√©dent, nous avons acc√©d√© au magasin directement √† partir des propri√©t√©s calcul√©es.  Mais que se passerait-il si nous avions plusieurs composants n√©cessitant le m√™me acc√®s?  Supposons que nous voulons afficher un message de bienvenue en majuscules.  Dans ce cas, les getters nous aideront. <br><br>  Les Getters font partie de Vuex.  Ils vous permettent d'impl√©menter un acc√®s unifi√© √† l'√©tat dans tous les composants.  Prenons un exemple de la section 10.2 et au lieu d'un acc√®s direct au r√©f√©rentiel via des propri√©t√©s calcul√©es, nous utilisons des getters.  De plus, nous faisons en sorte que le getter de la propri√©t√© msg traduise toutes ses lettres en majuscules. <br><br>  Copiez le contenu du fichier vuex-state-pass.html dans vuex-state-getter-action.html.  Pour simplifier la t√¢che, laissez le code HTML inchang√©.  √Ä la fin, vous devriez obtenir quelque chose de similaire √† la fig.  10.4. <br><br><img src="https://habrastorage.org/webt/sw/po/np/swponphqaqcwiinwh-5b-gai7b0.png" align="left" alt="image">  Comme vous pouvez le voir, le message Hello World est maintenant affich√© en mots.  Appuyer sur le bouton Press Me incr√©mente le compteur de la m√™me mani√®re que dans l'exemple pr√©c√©dent. <br><br>  Localisez la construction Vuex.Store dans le nouveau fichier vuex-state-getter-action.html imm√©diatement en dessous de la balise <img src="https://habrastorage.org/webt/ux/wq/hg/uxwqhgjw_hle7zwwssn_a6kylcw.png" alt="image">  Ajoutez un nouvel objet apr√®s des mutations appel√©es getters.  Cr√©ez les m√©thodes msg et count √† l'int√©rieur de cet objet, comme indiqu√© dans l'extrait 10.5.  Les deux m√©thodes acceptent le m√™me argument d'√©tat. <br><br>  Le getter msg renverra state.msg.toUppercase ().  Gr√¢ce √† cela, le message est toujours affich√© en majuscules.  Dans le getter, nous renverrons state.count.  Apr√®s avoir ajout√© des getters sous les mutations, le fichier vuex-state-getter-action.html devrait ressembler √† ceci. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lh/17/hg/lh17hghhfqmvinzfxxyvd6kfw10.png" alt="image"></div><br>  Les actions sont une autre partie int√©grante de Vuex.  J'ai mentionn√© plus t√¥t que les mutations doivent √™tre synchrones.  Mais que faire si nous travaillons avec du code asynchrone?  Comment faire des appels asynchrones capables de changer d'√©tat?  Les actions de Vuex nous y aideront. <br>  Imaginez que l'application acc√®de au serveur et attend une r√©ponse.  Ceci est un exemple d'une action asynchrone.  Malheureusement, les mutations sont asynchrones, nous ne pouvons donc pas les utiliser ici.  Au lieu de cela, ajoutez une op√©ration asynchrone bas√©e sur l'action Vuex. <br><br>  Pour cr√©er un retard, utilisez la fonction setTimeout.  Ouvrez le fichier vuex-state-getter-action.html et ajoutez-y l'objet actions imm√©diatement apr√®s les getters.  √Ä l'int√©rieur de cet objet, placez l'action d'incr√©mentation, qui prend les arguments de contexte et de charge utile.  En utilisant le contexte, nous enregistrerons les modifications.  Placez l'op√©ration context.commit dans setTimeout.  De cette fa√ßon, nous simulons un retard sur le serveur.  Nous pouvons √©galement passer l'argument de charge utile √† context.commit, qui entre ensuite dans la mutation.  Mettez √† jour le code bas√© sur l'extrait 10.6. <br><br>  Apr√®s avoir mis √† jour Vuex.Store, vous pouvez passer √† l'instance racine de Vue.js.  La propri√©t√© calcul√©e n'acc√©dera pas au magasin directement, comme auparavant, mais √† l'aide de getters.  Nous modifions √©galement la m√©thode d'incr√©mentation.  Pour acc√©der √† la nouvelle propri√©t√© Vuex que nous avons cr√©√©e pr√©c√©demment, elle utilisera l'appel store.dispatch ('increment', 10). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ow/na/tk/ownatktwrqjz5jnedkigjoqbqdg.png" alt="image"></div><br>  Le premier argument de l'appel de r√©partition est le nom de l'action et le deuxi√®me argument contient toujours des donn√©es suppl√©mentaires qui sont transmises √† cette action. <br><blockquote>  CONSEIL <br><br>  Les donn√©es suppl√©mentaires peuvent √™tre une variable r√©guli√®re ou m√™me un objet. <br>  Mettez √† jour l'instance Vue.js dans le fichier vuex-state-getter-action.html comme indiqu√© dans l'extrait 10.7. </blockquote><img src="https://habrastorage.org/webt/9r/m1/b1/9rm1b1-hossqa_axypdxhp47v7q.png" alt="image"><br><br>  T√©l√©chargez l'application et appuyez plusieurs fois sur le bouton.  Vous devriez remarquer un retard, mais le compteur augmentera de 10 apr√®s chaque pression. <br><br><h3>  10.4.  Utilisation de Vuex dans un projet d'animalerie √† l'aide de Vue-CLI </h3><br>  Revenons au projet d'animalerie sur lequel nous travaillions.  Si vous ne l'avez pas oubli√©, nous avons d√©cid√© d'ajouter des animations et des transitions.  Maintenant, nous int√©grons la biblioth√®que Vuex que nous avons rencontr√©e plus t√¥t. <br><br>  Nous transf√©rons les donn√©es sur les marchandises √† l'entrep√¥t.  Comme vous vous en souvenez des chapitres pr√©c√©dents, les donn√©es ont √©t√© initialis√©es dans le crochet cr√©√© √† l'int√©rieur du composant principal.  Maintenant, ce hook devrait g√©n√©rer un nouvel √©v√©nement qui initialise le r√©f√©rentiel Vuex.  Nous ajouterons √©galement les produits de propri√©t√© calcul√©s, qui r√©cup√®rent les produits √† l'aide du getter (nous le cr√©erons plus tard).  Le r√©sultat final ressemblera √† la Fig.  10.5. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-s/6q/nf/-s6qnfzox3qmsvozrfvla8liuqe.png" alt="image"></div><br><h3>  10.4.1.  Installer Vuex avec Vue-CLI </h3><br>  Tout d'abord, installez Vuex!  Il s'agit d'un processus simple.  Pr√©parez la derni√®re version de l'animalerie sur laquelle nous avons travaill√© au chapitre 8. Vous pouvez √©galement t√©l√©charger tout le code de ce chapitre sur GitHub sur github.com/ErikCH/VuejsInActionCode. <br><br>  Ouvrez une fen√™tre de terminal et acc√©dez au r√©pertoire racine du projet.  Pour installer la derni√®re version de Vuex, ex√©cutez la commande suivante: <br><br><pre><code class="plaintext hljs">$ npm install vuex</code> </pre> <br>  et enregistrez l'enregistrement √† ce sujet dans le fichier package.json de l'animalerie. <br><br>  Vous devez maintenant ajouter le stockage au fichier main.js, qui se trouve dans le dossier src.  Le r√©f√©rentiel lui-m√™me n'existe pas encore, mais nous l'importons quand m√™me.  Habituellement, il se trouve dans le fichier src / store / store.js, mais vous pouvez choisir un chemin diff√©rent - tous les d√©veloppeurs ont leurs propres pr√©f√©rences.  Arr√™tons-nous sur l'option g√©n√©ralement accept√©e.  Plus loin dans ce chapitre, nous discuterons d'une structure de r√©pertoires alternative utilisant des modules. <br><br>  Vous devez ajouter du stockage √† l'instance racine de Vue.js sous le routeur, comme indiqu√© dans l'extrait 10.8.  Soit dit en passant, nous utilisons la norme ES6, donc store: store peut √™tre raccourci pour stocker. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/du/gj/ns/dugjnsblenm_dydxirxudmpqbbk.png" alt="image"></div><br>  Apr√®s avoir connect√© le stockage √† l'instance racine, nous pouvons y acc√©der √† partir de n'importe quelle partie de l'application.  Cr√©ez le fichier src / store / store.js.  Nous y placerons le r√©f√©rentiel Vuex avec des informations sur les produits propos√©s par l'animalerie.  En haut, ajoutez deux instructions d'importation, une pour Vue et Vuex.  Sp√©cifiez ensuite Vue.use (Vuex) pour tout assembler. <br><br>  Nous avons import√© le r√©f√©rentiel dans le fichier main.js de ./store/store.  Vous devez maintenant exporter l'objet de magasin dans store.js.  Comme vous pouvez le voir dans l'extrait 10.9, nous exportons une valeur de magasin const √©gale √† Vuex.Store. <br><br>  Tout d'abord, ajoutez des objets avec √©tat et mutations.  L'√©tat contiendra un objet vide appel√© produits.  Bient√¥t, nous le remplirons avec la m√©thode initStore.  La mutation est appel√©e SET_STORE, elle affectera les biens transf√©r√©s √† la propri√©t√© state.products.  Collez le code de la liste suivante dans le fichier src / store / store.js que nous venons de cr√©er. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rq/2a/hi/rq2ahigjzyp0u3khuvvkrerrqxk.png" alt="image"></div><br>  Nous devons cr√©er une action et un getter dans le r√©f√©rentiel.  Un getter retournera un objet produits.  L'action est un peu plus compliqu√©e.  Vous devez transf√©rer le hook cr√©√©, qui lit le fichier static / products.json √† l'aide d'Axios, vers l'objet actions dans Vuex. <br><br>  J'ai mentionn√© plus t√¥t que les mutations doivent √™tre synchrones et que seules les actions √† l'int√©rieur de Vuex peuvent accepter du code asynchrone.  Pour contourner cette limitation, mettez le code Axios dans l'action Vuex. <br><br>  Cr√©ez un objet actions dans le fichier store.js et ajoutez-y la m√©thode initStore.  Copiez le contenu du crochet cr√©√© √† partir du fichier components / Main.vue dans cette m√©thode.  Au lieu d'affecter response.data.products √† l'objet products, nous invoquons la mutation √† l'aide de la fonction commit.  Passez response.data.products comme argument √† SET_STORE.  Le code r√©sultant devrait ressembler √† ceci (Listing 10.10). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nj/cp/od/njcpodi_wkiwlkhc5o_0du-1udu.png" alt="image"></div><br>  Nous avons presque termin√©, il nous suffit de mettre √† jour le fichier Main.vue et de transf√©rer les marchandises de l'objet produits locaux vers le r√©f√©rentiel Vuex.  Ouvrez le fichier src / components / Main.vue et recherchez la fonction de donn√©es.  Supprimez les produits de la ligne: {}.  Nous acc√©derons aux marchandises √† partir de la propri√©t√© calcul√©e que le magasin retourne. <br><br>  Trouvez les propri√©t√©s calcul√©es cartItemCount et sortedProducts dans Main.vue, elles devraient aller juste apr√®s la section des m√©thodes.  Ajoutez la propri√©t√© products et faites-la retourner le getter du m√™me nom. <br><br>  Nous avons connect√© le r√©f√©rentiel √† l'instance racine de Vue.js dans le fichier main.js, nous n'avons donc plus besoin de l'importer.  De plus, lorsque vous utilisez Vue-CLI, le stockage est toujours disponible sous la forme de ceci. $ Store.  N'oubliez pas le signe $, sinon cela entra√Ænera une erreur.  Ajoutez la propri√©t√© des produits calcul√©s, comme indiqu√© dans l'extrait 10.11. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1f/nj/ry/1fnjry2y8uanpzheonuljtcbzvi.png" alt="image"></div><br>  Recherchez le crochet cr√©√© dans lequel l'objet produits est initialis√© et supprimez son contenu.  Au lieu de cela, ins√©rez l'appel d'action initStore que nous avons cr√©√© pr√©c√©demment dans le r√©f√©rentiel Vuex.  Pour appeler une action, utilisez la fonction de r√©partition, comme dans l'exemple pr√©c√©dent.  Le listing 10.12 montre √† quoi devrait ressembler le hook cr√©√© apr√®s la mise √† jour du fichier Main.vue. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vn/1b/40/vn1b40pqnqauvsjz-jsh7amutty.png" alt="image"></div><br>  Cela devrait suffire.  Ex√©cutez la commande npm run dev dans le terminal et une fen√™tre avec l'application d'animalerie devrait appara√Ætre √† l'√©cran.  Essayez de mettre les marchandises dans le panier et assurez-vous que tout fonctionne comme il se doit.  En cas de probl√®me, recherchez des erreurs dans la console.  Dans le fichier src / store / store.js, au lieu de Vuex.store, vous pouvez accidentellement taper Vuex.Store.  N'oubliez pas cela! <br><br><h3>  10.5.  M√©thodes d'assistance Vuex </h3><br>  Vuex fournit des m√©thodes d'assistance pratiques qui rendent le code plus concis et √©liminent l'ajout des m√™mes getters, setters, mutations et actions.  Pour une liste compl√®te des m√©thodes d'assistance de Vuex, consultez le guide officiel √† vuex.vuejs.org/guide/core-concepts.html.  Voyons comment ils fonctionnent. <br><br>  La principale m√©thode d'assistance que vous devez conna√Ætre s'appelle mapGetters.  Il est utilis√© pour ajouter tous les getters disponibles √† la section calcul√©e et ne n√©cessite pas de r√©pertorier chacun d'eux.  Mais avant de l'utiliser, vous devez l'importer dans le composant.  Encore une fois, retournez √† l'animalerie et ajoutez la m√©thode mapGetters. <br><br>  Ouvrez le fichier src / components / Main.vue et recherchez la balise de script.  Quelque part √† l'int√©rieur de cette balise, le composant En-t√™te doit √™tre import√©.  Connectez mapGetters imm√©diatement apr√®s cette importation, comme indiqu√© dans l'extrait 10.13. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/df/1a/oy/df1aoyonrmhjh26zev5aehqhtec.png" alt="image"></div><br>  Vous devez maintenant mettre √† jour la propri√©t√© calcul√©e.  Recherchez la fonction produits dans la section calcul√©e et ins√©rez l'objet mapGetters √† sa place. <br><br>  mapGetters est un objet unique, pour son bon fonctionnement, il est n√©cessaire d'utiliser l'op√©rateur spread de ES6 - il d√©veloppe l'expression dans une situation o√π des arguments sont attendus (z√©ro ou plus).  Vous pouvez en savoir plus sur cette syntaxe dans la documentation MDN √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">developer.mozilla.org/en/docs/Web/JavaScript/Reference/Operators/Spread_syntax</a> . <br><br>  mapGetters s'assurera que tous les getters sont ajout√©s en tant que propri√©t√©s calcul√©es.  C'est une mani√®re beaucoup plus simple et plus √©l√©gante que d'√©crire une propri√©t√© calcul√©e distincte pour chaque getter.  Tous les getters sont r√©pertori√©s dans le tableau mapGetters.  Ajoutez cette m√©thode d'assistance au fichier Main.vue (extrait 10.14). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w8/uc/4r/w8uc4rzccr0ygnfvoooi_7j8mda.png" alt="image"></div><br>  Apr√®s avoir ex√©cut√© la commande npm run dev, l'animalerie devrait fonctionner comme auparavant.  La m√©thode d'aide mapGetters ne semble pas tr√®s utile jusqu'√† pr√©sent, mais plus nous ajoutons de getters, plus cela √©conomisera de temps. <br><br>  Vous devez conna√Ætre trois autres m√©thodes d'assistance: mapState, mapMutations et mapActions.  Ils fonctionnent tous de mani√®re similaire, r√©duisant la quantit√© de code passe-partout que vous devez √©crire manuellement. <br><br>  Imaginez que votre r√©f√©rentiel contient plusieurs donn√©es et que l'acc√®s √† l'√©tat s'effectue directement √† partir du composant, sans utiliser de getters.  Dans ce cas, vous pouvez utiliser la m√©thode mapState √† l'int√©rieur de la section calcul√©e (Listing 10.15). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/09/yf/2w/09yf2w3fnle9nujbxlsqsdku3g4.png" alt="image"></div><br>  Imaginez maintenant que vous devez utiliser plusieurs mutations dans un composant.  Pour simplifier ce processus, utilisez la m√©thode d'assistance mapMutations (Listing 10.16), comme c'est le cas avec mapState et mapGetters.  Le mut1 suivant lie this.mut1 () √† ceci. $ Store.commit ('mut1'). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6h/7y/py/6h7ypy5x0dsc400qmndzolgzr-m.png" alt="image"></div><br>  Enfin, consid√©rons la m√©thode d'assistance mapActions.  Il vous permet d'ajouter des actions Vuex √† l'application, √©liminant ainsi la n√©cessit√© de cr√©er des m√©thodes avec des appels de r√©partition dans chaque cas.  Revenant √† l'exemple pr√©c√©dent, imaginez que l'application contient des op√©rations asynchrones.  √âtant donn√© que l'utilisation de mutations est exclue, nous devons recourir √† l'action.  Apr√®s les avoir cr√©√©s dans Vuex, vous devez y acc√©der dans l'objet m√©thodes du composant.  Ce probl√®me peut √™tre r√©solu √† l'aide de mapActions.  act1 liera this.act1 () √† ceci. $ store.dispatch ('act1'), comme indiqu√© dans l'extrait 10.17. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6b/lf/e2/6blfe2nzmh7iotgvmia9d8nksto.png" alt="image"></div><br>  Enfin, consid√©rons la m√©thode d'assistance mapActions.  Il vous permet d'ajouter des actions Vuex √† l'application, √©liminant ainsi la n√©cessit√© de cr√©er des m√©thodes avec des appels de r√©partition dans chaque cas.  Revenant √† l'exemple pr√©c√©dent, imaginez que l'application contient des op√©rations asynchrones.  √âtant donn√© que l'utilisation de mutations est exclue, nous devons recourir √† l'action.  Apr√®s les avoir cr√©√©s dans Vuex, vous devez y acc√©der dans l'objet m√©thodes du composant.  Ce probl√®me peut √™tre r√©solu √† l'aide de mapActions.  act1 liera this.act1 () √† ceci. $ store.dispatch ('act1'), comme indiqu√© dans l'extrait 10.17. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ov/5m/jm/ov5mjmyoyymzvr09mtyibqsrhmk.png" alt="image"></div><br>  Au fur et √† mesure que l'application se d√©veloppe, ces m√©thodes d'assistance seront de plus en plus utiles, r√©duisant la quantit√© de code qui doit √™tre √©crit.  Gardez √† l'esprit que vous devez r√©fl√©chir aux noms de propri√©t√© dans votre r√©f√©rentiel, car les m√©thodes d'assistance vous permettent d'y acc√©der dans les composants. <br><br><h3>  10.6.  Br√®ve introduction aux modules </h3><br>  Au d√©but de ce chapitre, nous avons cr√©√© le fichier store.js dans le r√©pertoire src / store.  Pour un petit projet, cette approche est tout √† fait appropri√©e.  Mais que faire si nous avons affaire √† une application beaucoup plus importante?  Le fichier store.js augmentera rapidement et il sera difficile de garder une trace de tout ce qui s'y passe. <br>  Pour r√©soudre ce probl√®me, Vuex propose le concept de modules.  Les modules vous permettent de diviser le stockage en plusieurs parties plus petites.  Chaque module a ses propres √©tats, mutations, actions et getters, vous pouvez m√™me les imbriquer les uns dans les autres. <br><br>  Nous r√©√©crivons l'animalerie √† l'aide de modules.  Le fichier store.js restera en place, mais √† c√¥t√© de lui, vous devez cr√©er le dossier modules et y placer le fichier products.js.  La structure du r√©pertoire devrait ressembler √† celle de la fig.  10.6. <br><br><img src="https://habrastorage.org/webt/-a/xi/tt/-axittmozbvjtdxsblaraowkbdy.png" align="left" alt="image">  Dans products.js, vous devez cr√©er quatre objets: √©tat, getters, actions et mutations.  Le contenu de chacun d'eux doit √™tre copi√© √† partir du fichier store.js. <br><br>  Ouvrez le fichier src / store / store.js et commencez √† copier le code √† partir de celui-ci.  Une fois termin√©, le fichier products.js devrait ressembler √† ceci (extrait 10.18). <br><br>  Maintenant, nous devons exporter tout le code que nous avons ajout√© au fichier product.js.  Cela l'importera dans store.js.  Au bas du fichier, ajoutez l'expression d'exportation par d√©faut.  Il s'agit d'une instruction d'exportation au format ES6 qui vous permet d'importer ce code √† partir d'autres fichiers (Listing 10.19). <br><br>  Le fichier store.js doit √™tre mis √† jour.  Ajoutez-y un objet modules, √† l'int√©rieur duquel vous pouvez lister tous les nouveaux modules.  N'oubliez pas d'importer le fichier modules / produits que nous avons cr√©√© pr√©c√©demment. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qn/t1/mo/qnt1moalahiofswpasrzsw7dsec.png" alt="image"></div><br>  Notre exemple ne contient qu'un seul module, alors ajoutez-le imm√©diatement √† l'objet modules.  Vous devez √©galement supprimer tous les √©l√©ments inutiles de Vuex.Store, comme indiqu√© dans l'extrait 10.20. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wf/f0/0u/wff00uliblovkw3hhwsr4xfsxni.png" alt="image"></div><br>  En important les modules, nous avons termin√© le processus de refactoring.  Apr√®s avoir actualis√© la page, l'application devrait fonctionner exactement comme avant. <br><blockquote>  Espaces de noms dans Vuex <br><br>  Dans certains grands projets, la modularisation peut entra√Æner certains probl√®mes.  √Ä mesure que de nouveaux modules sont ajout√©s, des conflits peuvent survenir avec les noms des actions, des getters, des mutations et des propri√©t√©s d'√©tat.  Par exemple, vous pouvez accidentellement attribuer le m√™me nom √† deux getters dans des fichiers diff√©rents.  Et, comme tout se trouve dans un espace de noms global global dans Vuex, une erreur de cl√© en double se produira dans la console. <br>  Pour √©viter ce probl√®me, placez chaque module dans un espace de noms distinct.  Pour ce faire, sp√©cifiez simplement namespaced: true en haut de Vuex.store.  En savoir plus sur cette fonctionnalit√© dans la documentation officielle de Vuex √† vuex.vuejs.org/en/guide/modules.html. </blockquote>  ¬ªPlus d'informations sur le livre sont disponibles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web de l'√©diteur</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Contenu</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extrait</a> <br><br>  25% de r√©duction sur les <b>colporteurs</b> - <b>Vue.js</b> <br><br>  Lors du paiement de la version papier du livre, une version √©lectronique du livre est envoy√©e par e-mail. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448304/">https://habr.com/ru/post/fr448304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448294/index.html">La loi sur l'isolement du Runet est adopt√©e par la Douma d'Etat en trois lectures</a></li>
<li><a href="../fr448296/index.html">Freelance et Finance: 5 fa√ßons de s'entendre entre un client et un freelance</a></li>
<li><a href="../fr448298/index.html">GLTF et GLB Basics, Partie 2</a></li>
<li><a href="../fr448300/index.html">Mailto de la conf√©rence: CLOUD - sur les nuages ‚Äã‚Äãet autour</a></li>
<li><a href="../fr448302/index.html">Une vuln√©rabilit√© dans les filtres AdBlock et uBlock permet d'ex√©cuter du code arbitraire c√¥t√© utilisateur</a></li>
<li><a href="../fr448308/index.html">Data Science Digest (avril 2019)</a></li>
<li><a href="../fr448310/index.html">√âcrire un bot de t√©l√©gramme en python √† l'aide de la biblioth√®que de telebot partie 1</a></li>
<li><a href="../fr448316/index.html">D√©terminer la race d'un chien: un cycle de d√©veloppement complet, d'un r√©seau neuronal en Python √† une application sur Google Play</a></li>
<li><a href="../fr448320/index.html">Pourquoi le silicium et pourquoi CMOS?</a></li>
<li><a href="../fr448322/index.html">C ++ Russia 2019: diffusion gratuite de la premi√®re salle et un peu sur ce qui sera √† la conf√©rence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>