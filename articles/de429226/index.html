<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòô üéµ üñêüèæ Dynamische Preisgestaltung oder wie Yandex.Taxi eine hohe Nachfrage vorhersagt üè¢ ü§¥üèø üë®‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Zuvor mussten sie, um ein Taxi zu rufen, eine unterschiedliche Anzahl von Versanddiensten anrufen und mindestens eine halbe Stunde warten, bis das Aut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dynamische Preisgestaltung oder wie Yandex.Taxi eine hohe Nachfrage vorhersagt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/429226/"><img src="https://habrastorage.org/webt/6p/yq/tr/6pyqtrc3l2zveuaglelsme4xphg.png"><br><br>  Zuvor mussten sie, um ein Taxi zu rufen, eine unterschiedliche Anzahl von Versanddiensten anrufen und mindestens eine halbe Stunde warten, bis das Auto geliefert wurde.  Jetzt sind die Taxiservices gut automatisiert und die durchschnittliche Lieferzeit f√ºr Yandex.Taxi in Moskau betr√§gt ca. 3-4 Minuten.  Aber es lohnt sich, ein Massenereignis zu regnen oder zu beenden, und wieder kann es zu einem Mangel an kostenlosen Autos kommen. <br><br>  Mein Name ist Anton Skogorev, ich leite die Performance Development Group der Yandex.Taxi-Plattform.  Heute werde ich den Lesern von Habr erz√§hlen, wie wir gelernt haben, eine hohe Nachfrage vorherzusagen und zus√§tzlich Fahrer anzulocken, damit Benutzer jederzeit ein kostenloses Auto finden k√∂nnen.  Sie erfahren, wie ein Koeffizient gebildet wird, der sich auf den Wert der Bestellung auswirkt.  Alles dort ist alles andere als so einfach, wie es auf den ersten Blick erscheinen mag. <br><br><a name="habracut"></a><br><h3>  Dynamische Preisherausforderung </h3><br>  Die wichtigste Aufgabe der dynamischen Preisgestaltung ist es, immer die M√∂glichkeit zu bieten, ein Taxi zu bestellen.  Dies wird mit dem Anstiegspreiskoeffizienten erreicht, mit dem der berechnete Preis multipliziert wird.  Wir nennen es einfach Schwall.  Es ist wichtig zu sagen, dass der Anstieg nicht nur die Nachfrage nach Taxis reguliert, sondern auch dazu beitr√§gt, neue Fahrer f√ºr die Steigerung des Angebots zu gewinnen. <br><br>  Wenn der Anstieg zu gro√ü eingestellt ist, werden wir die Nachfrage zu stark reduzieren, es wird einen √úberschuss an kostenlosen Autos geben.  Wenn zu niedrig eingestellt, sehen Benutzer "keine freien Autos".  Sie m√ºssen in der Lage sein, einen Koeffizienten zu w√§hlen, bei dem wir zwischen dem Mangel an freien Autos und der geringen Nachfrage auf d√ºnnem Eis laufen. <br><br>  Wovon sollte dieser Koeffizient abh√§ngen?  Es f√§llt sofort die Abh√§ngigkeit von der Anzahl der Autos und Bestellungen rund um den Benutzer ein.  Jetzt k√∂nnen Sie einfach die Anzahl der Bestellungen durch die Anzahl der Fahrer teilen, den Koeffizienten ermitteln und ihn mit einer Formel (m√∂glicherweise linear) in unseren Anstieg umwandeln. <br><br>  Bei dieser Aufgabe gibt es jedoch ein kleines Problem: Es kann zu sp√§t sein, Bestellungen um den Benutzer herum zu z√§hlen.  Schlie√ülich ist eine Bestellung fast immer eine bereits besetzte Maschine, was bedeutet, dass eine Erh√∂hung unseres Koeffizienten immer zu sp√§t kommt.  Daher betrachten wir keine erstellten Bestellungen, sondern die <b>Absicht,</b> einen <b>Autostift zu</b> bestellen.  Eine Stecknadel ist eine Bezeichnung ‚ÄûA‚Äú auf einer Karte, die ein Benutzer beim Starten unserer Anwendung anbringt. <br><br><img src="https://habrastorage.org/webt/8t/du/0a/8tdu0aql7pjzmgqgqerbnso7zuw.png"><br><br>  Lassen Sie uns das Problem formulieren: Wir m√ºssen die <b>Momentanwerte</b> von Maschinen und Stiften irgendwann im Benutzer lesen. <br><br><h3>  Wir z√§hlen die Anzahl der Stifte und Autos </h3><br>  Wenn sich die Pin-Position √§ndert (der Benutzer w√§hlt Punkt ‚ÄûA‚Äú), sendet die Benutzeranwendung neue Koordinaten und ein kleines Blatt mit zus√§tzlichen Informationen an das Backend, um den Pin genauer zu bewerten (z. B. den ausgew√§hlten Tarif). <br><br>  Wir versuchen, uns an die Microservice-Architektur zu halten, bei der jeder Microservice separate Aufgaben ausf√ºhrt.  Der Surger Microservice befasst sich mit der Berechnung des Surges.  Es registriert die Pins, speichert sie in der Datenbank und aktualisiert auch das Nugget der Pins im RAM, in das sie ziemlich gut passen.  Die Cache-Verz√∂gerung w√§hrend einer solchen Arbeit betr√§gt nur wenige Sekunden, was in unserem Fall akzeptabel ist. <br><br><div class="spoiler">  <b class="spoiler_title">Ein paar Worte zur Datenbank</b> <div class="spoiler_text">  Bei der Registrierung wird jeder Pin asynchron zu MongoDb mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">TTL-Index</a> hinzugef√ºgt, wobei TTL die ‚ÄûLebensdauer‚Äú des Pins ist, bei der wir ihn f√ºr die Berechnung des Erh√∂hungskoeffizienten als aktiv betrachten.  Der Benutzer wartet nicht, w√§hrend wir diese Aktionen ausf√ºhren.  Selbst wenn etwas schief geht, ist der Verlust einer Stecknadel keine so gro√üe Trag√∂die. <br><br><img src="https://habrastorage.org/webt/7g/u0/f6/7gu0f6uercnenpw3c4h2xyu4tls.jpeg"><br></div></div><br>  Ein Hot-Cache wird mit einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Geo-Hash-</a> Index erstellt.  Wir gruppieren alle Stifte nach Geohash und sammeln dann die Stifte f√ºr den gew√ºnschten Radius um den Bestellpunkt. <br><br>  Wir machen dasselbe mit Autos, aber in einem anderen Dienst namens Tracker, zu dem der Surger einfach mit der Frage geht, "wie viele Fahrer sich in diesem Radius befinden". <br><br>  Wir betrachten also die Momentanwerte des Koeffizienten. <br><br><img src="https://habrastorage.org/webt/mi/r7/y7/mir7y77n8i0b_dh8-w9vaxtex9k.jpeg"><br><br><h3>  Caching </h3><br>  <b>Fall</b> : Sie stehen im Gartenring in Moskau und m√∂chten ein Auto buchen.  Gleichzeitig springt der Preis ziemlich oft und das ist √§rgerlich. <br><br>  Wenn man die Mechanik bereits kennt, kann man verstehen, dass dies daran liegen kann, dass sich die Fahrer zum Zeitpunkt der Anforderung des √úberspannungsschutzes an einer bedingten Ampel ansammeln und auch schnell abreisen.  Aus diesem Grund k√∂nnen Anstieg und Preis sp√ºrbar ‚Äûspringen‚Äú. <br><br>  Um dies zu vermeiden, speichern wir den Wert des Anstiegs nach Benutzer zwischen.  Wenn ein Benutzer zu einer √úberspannung kommt, pr√ºfen wir, ob f√ºr diesen Benutzer ein gespeicherter √úberspannungswert in einem akzeptablen Radius vorliegt (eine lineare Tour aller gespeicherten √úberspannungen des Benutzers).  Wenn ja, geben wir es zur√ºck, sonst rechnen wir mit einem neuen und sparen auch. <br><br>  Das hat gut funktioniert, aber es gibt andere Situationen. <br><br>  <b>Fall</b> : 2 Benutzer fordern einen Anstieg an.  Einer bestellt 30 Sekunden sp√§ter als der andere, wenn Autos von einer Ampel aus einem fr√ºheren Fall bereits abgefahren sind.  Wir erhalten ein Bild, in dem 2 Benutzer, die fast gleichzeitig bestellen, merklich unterschiedliche Spannungsspitzen haben k√∂nnen. <br><br>  Und hier gehen wir vom Cache nach Benutzer zum Cache nach Position.  Anstatt den Anstiegswert nur vom Benutzer zwischenzuspeichern, beginnen wir nun, ihn mit dem bereits bekannten Geo-Hash zwischenzuspeichern.  Also haben wir das Problem fast behoben.  Warum fast?  Weil es an den Grenzen von Geoheshes Unterschiede geben kann.  Aber das Problem ist nicht so bedeutend, weil wir eine Gl√§ttung haben. <br><br><h3>  Gl√§tten </h3><br>  Vielleicht ist Ihnen beim Lesen eines Falles √ºber eine Ampel aufgefallen, dass es irgendwie unfair war, einen sofortigen Anstieg in Abh√§ngigkeit von der Ampel in Betracht zu ziehen.  Wir denken auch, also haben wir herausgefunden, wie wir die Situation beheben k√∂nnen. <br><br>  Wir haben uns entschlossen, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Methode</a> der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">n√§chsten Nachbarn</a> aus dem maschinellen Lernen f√ºr das Regressionsproblem auszuleihen, um festzustellen, inwieweit sich der Wert des sofortigen Anstiegs von dem unterscheidet, was um uns herum geschieht. <br><br>  Die Trainingsphase besteht, wie in der formalen Beschreibung der Methode, darin, alle Objekte zu speichern. In unserem Fall, den berechneten Werten des Anstiegs im Pin, tun wir dies bereits zum Zeitpunkt des Ladens aller Pins in den Cache.  Die kleine Sache ist, den Momentanwert zu berechnen, ihn mit dem Wert in der Zone zu vergleichen und zuzustimmen, dass wir nicht zu stark vom Wert in der Zone abweichen k√∂nnen. <br><br>  So erhalten wir ein System mit einer schnellen Reaktion auf Ereignisse, mit dem Sie den Wert des ansteigenden Koeffizienten schnell ablesen k√∂nnen. <br><br><h3>  Surge Driving Card </h3><br>  Um mit dem Fahrer zu kommunizieren, m√ºssen wir in der Lage sein, die √úberspannungskarte in der Fahreranwendung anzuzeigen - einem Taxameter.  Dies gibt dem Fahrer eine R√ºckmeldung dar√ºber, ob in dem Bereich, in dem er sich gerade befindet, Nachfrage besteht und wohin er umziehen sollte, um die teuersten Bestellungen zu erhalten.  F√ºr uns bedeutet dies, dass mehr Fahrer mit hoher Nachfrage in die Zone kommen und diese abwickeln werden. <br><br><img src="https://habrastorage.org/webt/q8/89/m-/q889m-nye_deix_n6i5tqkbnoba.png"><br><br>  Wir leben mit dem Paradigma, dass das Ger√§t des Fahrers ein eher schwaches Ger√§t ist.  Daher liegt das Rendern des hexagonalen Sto√ügitters auf der Backend-Seite.  Der Client kommt zum Backend f√ºr Kacheln.  Dies sind geschnittene Rasterbilder zur direkten Anzeige auf der Karte. <br><br>  Wir haben einen separaten Dienst, der regelm√§√üig Abg√ºsse von Stiften aus dem Surger-Mikroservice aufnimmt und alle Metainformationen berechnet, die zum Rendern des hexagonalen Gitters erforderlich sind: Wo ist welches Hex und welcher Schwall befindet sich in jedem. <br><br><h3>  Fazit </h3><br>  Dynamische Preisgestaltung ist eine st√§ndige Suche nach einem Gleichgewicht zwischen Angebot und Nachfrage, sodass den Nutzern immer kostenlose Autos zur Verf√ºgung stehen, auch durch den Mechanismus, zus√§tzliche Fahrer f√ºr Gebiete mit hoher Nachfrage zu gewinnen.  Zum Beispiel arbeiten wir derzeit an einer tieferen Nutzung des maschinellen Lernens zur Berechnung des Anstiegs.  Im Rahmen einer der Aufgaben in diesem Bereich lernen wir, die Wahrscheinlichkeit zu bestimmen, mit der ein Pin in eine Bestellung umgewandelt wird, und diese Informationen zu ber√ºcksichtigen.  Da hier genug Arbeit vorhanden ist, freuen wir uns immer √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neue Spezialisten</a> im Team. <br><br>  Wenn Sie mehr √ºber einen Teil dieses gro√üen Themas erfahren m√∂chten, schreiben Sie in die Kommentare.  Feedback und Ideen sind ebenfalls willkommen! <br><br>  PS In der n√§chsten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ver√∂ffentlichung wird</a> mein Kollege √ºber den Einsatz von maschinellem Lernen sprechen, um die erwartete Ankunftszeit eines Taxis vorherzusagen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de429226/">https://habr.com/ru/post/de429226/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de429216/index.html">Bei Google Play nach Verk√§ufen suchen - ist es die Sorge wert?</a></li>
<li><a href="../de429218/index.html">Julia und partielle Differentialgleichungen</a></li>
<li><a href="../de429220/index.html">FSIN gegen die Gesetze der Physik oder Bienen gegen Honig</a></li>
<li><a href="../de429222/index.html">Die Staatsduma wird die Rechnung √ºber gro√üe Benutzerdaten zur √úberarbeitung zur√ºcksenden</a></li>
<li><a href="../de429224/index.html">Dunkle Webformularmuster oder das am meisten konvertierte Formular</a></li>
<li><a href="../de429228/index.html">PMP Die Pr√ºfung bestehen. Was zu beachten ist und warum Sie es brauchen</a></li>
<li><a href="../de429230/index.html">Bericht: Epson-Projektoren bei Integrated Systems Russia 2018</a></li>
<li><a href="../de429232/index.html">Karriere Steroide. Hunde</a></li>
<li><a href="../de429234/index.html">Erstellung des Spiels "Like Coins" auf Godot Engine. Teil 1</a></li>
<li><a href="../de429236/index.html">Wie viele Data Scientists ben√∂tigen Sie, um eine Gl√ºhbirne einzuschalten (oder welches Team sorgt daf√ºr, dass die Daten f√ºr das Unternehmen funktionieren)?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>