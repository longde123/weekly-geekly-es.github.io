<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèº üë®üèæ‚Äçüîß ü§Æ La combinaison d'une approche multiplateforme et native dans le d√©veloppement d'applications mobiles üëµüèª üë®üèª‚Äç‚úàÔ∏è üéâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour publier des applications pour une seule plate-forme mobile n'est pas pertinent et vous devez prendre soin de d√©velopper deux versions √† la fois, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La combinaison d'une approche multiplateforme et native dans le d√©veloppement d'applications mobiles</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430892/">  Pour publier des applications pour une seule plate-forme mobile n'est pas pertinent et vous devez prendre soin de d√©velopper deux versions √† la fois, pour iOS et Android.  Et ici, vous pouvez choisir deux fa√ßons: travailler dans les langages de programmation "natifs" pour chaque syst√®me d'exploitation ou utiliser des frameworks multiplateformes. <br><br>  Lors du d√©veloppement d'un des projets chez DD Planet, je me suis appuy√© sur la derni√®re option.  Et dans cet article, je parlerai de l'exp√©rience de d√©veloppement d'une application multiplateforme, des probl√®mes que nous avons rencontr√©s et des solutions trouv√©es. <br><a name="habracut"></a><br><h2>  Trois approches pour d√©velopper des applications mobiles multiplateformes </h2><br>  Pour commencer, r√©fl√©chissez aux approches utilis√©es lorsque vous devez obtenir deux applications √† la fois: pour iOS et Android. <br><br>  Le premier est le plus cher, en temps et en ressources: d√©velopper une application distincte pour chaque plateforme.  La complexit√© de cette approche r√©side dans le fait que chacun des syst√®mes d'exploitation n√©cessite sa propre approche: cela s'exprime √† la fois dans le langage dans lequel le d√©veloppement est en cours (pour Android - Java ou Kotlin, pour iOS - Objective-C ou Swift), et les m√©thodes de description de la partie UI applications (fichiers axml et xib ou storyboard, respectivement). <br><br>  Ce seul fait nous am√®ne au fait que pour cette approche, il est n√©cessaire de former deux √©quipes de d√©veloppement.  De plus, vous devrez dupliquer la logique pour chacune des plateformes: interaction avec l'API et la logique m√©tier. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-j/pl/52/-jpl52-jwex193hykedjtv569to.png" alt="image"></div><br>  Mais que se passe-t-il si le nombre d'API utilis√©es augmente? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pt/kl/zc/ptklzcfkjzn5zxmgqjuyxkhvtyq.png" alt="image"></div><br>  Cela soul√®ve la question: comment r√©duire la quantit√© requise de ressources humaines?  D√©barrassez-vous de la n√©cessit√© de dupliquer le code pour chaque plate-forme.  Il existe un nombre suffisant de cadres et de technologies qui r√©solvent ce probl√®me. <br><br>  L'utilisation d'un framework multiplateforme (Xamarin.Forms, par exemple) permet d'√©crire du code dans un langage de programmation et de d√©crire une fois la logique des donn√©es et la logique de l'interface utilisateur, en un seul endroit.  Par cons√©quent, la n√©cessit√© d'utiliser deux √©quipes de d√©veloppement dispara√Æt.  Et √† la suite de la compilation du projet, nous obtenons deux applications natives √† la sortie.  Et c'est la deuxi√®me approche. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sc/si/v4/scsiv4dfupwnvimrp1507onobfa.png" alt="image"></div><br>  Beaucoup, je pense, savent ce qu'est Xamarin, ou du moins en ont entendu parler, mais comment √ßa marche?  Xamarin est bas√© sur l'impl√©mentation open source de la plate-forme .NET - Mono.  Mono comprend son propre compilateur C #, son runtime, ainsi qu'un certain nombre de biblioth√®ques, y compris l'impl√©mentation de WinForms et ASP.Net. <br><br>  L'objectif du projet est de permettre aux programmes √©crits en C # de s'ex√©cuter sur des syst√®mes d'exploitation autres que Windows - syst√®mes Unix, Mac OS et autres.  Le framework Xamarin lui-m√™me, en substance, est une biblioth√®que de classes qui fournit aux d√©veloppeurs un acc√®s au SDK et aux compilateurs de la plateforme pour ceux-ci.  Xamarin.Forms, √† son tour, vous permet non seulement d'√©crire pour les deux plates-formes dans une seule langue, mais √©galement de concevoir des √©crans √† l'aide du balisage XAML, familier √† ceux qui avaient d√©j√† une exp√©rience avec les applications WPF.  Gr√¢ce √† l'assemblage du projet, nous obtenons un aspect presque identique sur toutes les plates-formes, car au stade de la compilation, tous les contr√¥les XF sont convertis en natif pour chaque plate-forme. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w4/ft/fs/w4ftfsahuvg63dn2ugjfugnp6_8.png" alt="image"></div><br>  Le d√©veloppeur est oblig√© d'√©crire du code pour chaque plate-forme uniquement si l'acc√®s √† des fonctionnalit√©s de la plate-forme est n√©cessaire (par exemple, un scanner d'empreintes digitales ou le niveau de la batterie) ou s'il est n√©cessaire d'affiner le comportement de contr√¥le.  Dans certains cas, lors du d√©veloppement d'une application, il peut √™tre n√©cessaire d'√©crire du code d√©pendant de la plate-forme, mais m√™me dans ce cas, personne n'interdit de prendre des fonctions de plate-forme √† l'interface et d'interagir avec elle √† partir d'un projet commun √† l'avenir. <br><br>  Un langage de programmation, peu de code, etc.  Tout cela semble beau mais, Xamarin.Forms n'est pas une solution miracle, et toute sa beaut√© se transforme en pierres de r√©alit√©.  D√®s qu'une situation survient lorsque les commandes XF int√©gr√©es ne r√©pondent plus √† leurs exigences, la structure des √©crans et des commandes devient de plus en plus compliqu√©e.  Pour assurer un travail confortable avec les √©crans d'un projet commun, vous devez √©crire de plus en plus de rendus personnalis√©s. <br><br>  Cela passera √† la troisi√®me approche, que nous utilisons lors du d√©veloppement d'applications. <br><br>  Nous avons d√©j√† d√©couvert que l'utilisation de Xamarin Forms peut compliquer le travail plut√¥t que le simplifier.  Par cons√©quent, pour mettre en ≈ìuvre des √©crans d'une architecture complexe, des √©l√©ments de conception et des contr√¥les fondamentalement diff√©rents des natifs, un compromis et la possibilit√© de combiner les premi√®re et deuxi√®me approches ont √©t√© trouv√©s. <br><br>  Nous avons tous les m√™mes trois projets: un projet PCL commun, mais sans Xamarin Forms, et deux projets Xamarin Android et Xamarin iOS.  Il y a toujours la possibilit√© d'√©crire tout dans une seule langue, une logique commune entre deux projets, mais il n'y a pas de limitations d'un seul balisage XAML.  Le composant UI est contr√¥l√© par chaque plate-forme et utilise des outils natifs, sur Android - natif AXML, sur des fichiers iOS - XIB.  Chaque plate-forme a la capacit√© de se conformer √† ses directives, car la connexion entre le Core et les projets de plate-forme n'est organis√©e qu'au niveau des donn√©es. <br><br>  Pour organiser une telle relation, vous pouvez utiliser le mod√®le de conception MVVM et son impl√©mentation assez populaire pour Xamarin - MVVMCross.  Son utilisation vous permet de conserver un ViewModel commun √† chaque √©cran, qui d√©crit toute la ¬´logique m√©tier¬ª de l'≈ìuvre, et de confier son rendu √† la plateforme.  Il permet √©galement √† deux d√©veloppeurs de travailler avec le m√™me √©cran (l'un avec la logique - l'autre avec l'interface utilisateur) et de ne pas interf√©rer l'un avec l'autre.  En plus de la mise en ≈ìuvre du mod√®le, nous obtenons un nombre suffisant d'outils pour le travail: la mise en ≈ìuvre de DI et IoC.  Pour √©lever l'interaction avec la plateforme au niveau du code commun, un d√©veloppeur a juste besoin de d√©clarer une interface et de l'impl√©menter sur la plateforme.  Pour des choses typiques, MvvmCross fournit d√©j√† un ensemble de ses propres plugins.  Dans l'√©quipe, nous utilisons le plugin messenger pour √©changer des messages entre la plateforme et le code commun et le plugin pour travailler avec des fichiers (s√©lection d'images dans la galerie, etc.). <br><br><h2>  Nous r√©solvons les probl√®mes de conception complexe et de navigation multi-niveaux </h2><br>  Comme mentionn√© pr√©c√©demment, lors de l'utilisation de repr√©sentations complexes √† l'√©cran, le cadre peut compliquer davantage la vie que la rendre plus facile.  Mais qu'est-ce qu'on appelle un √©l√©ment complexe?  √âtant donn√© que je suis principalement engag√© dans le d√©veloppement iOS, un exemple de cette plate-forme sera consid√©r√©.  Par exemple, une chose aussi banale qu'un champ d'entr√©e peut avoir plusieurs √©tats et suffisamment de logique pour la commutation et la visualisation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/fw/vf/anfwvfodqmfoui_0u2i6k52g_s4.png" alt="image"></div><br>  Au cours de l'utilisation des entr√©es utilisateur, un tel contr√¥le d'entr√©e a √©t√© d√©velopp√© ici.  Il peut √©lever son nom au-dessus du champ de saisie, travailler avec des masques, d√©finir des pr√©fixes, des postfixes, notifier lorsque CapsLock est enfonc√©, valider les informations en deux modes: interdiction d'entr√©e et de sortie des informations d'erreur.  La logique √† l'int√©rieur du contr√¥le prend environ ~ 1000 lignes.  Et, il semblerait: qu'est-ce qui peut √™tre compliqu√© dans la conception du champ de saisie? <br><br>  Un exemple simple d'un contr√¥le complexe que nous avons vu.  Et les √©crans? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cz/dq/ul/czdqulhcq0x1trskfg4j9szemd0.png" alt="image"></div><br>  Pour commencer, je pr√©cise que dans la plupart des cas, un √©cran d'application est une classe - UIViewController, d√©crivant son comportement.  Pendant le d√©veloppement, la cr√©ation d'une navigation √† plusieurs niveaux √©tait n√©cessaire.  Le concept de l'application d√©velopp√©e se r√©sume √† g√©rer votre bien immobilier et √† interagir avec les voisins et les organisations municipales.  Par cons√©quent, trois niveaux de navigation ont √©t√© construits: propri√©t√©, niveau de pr√©sentation (domicile, ville, r√©gion) et type de contenu.  Toute commutation s'effectue sur un seul √©cran. <br><br>  Cela a √©t√© fait pour que l'utilisateur, o√π qu'il soit, comprenne quel type de contenu il voit.  Pour organiser une telle navigation, l'√©cran principal de l'application ne se compose pas d'un seul contr√¥leur.  Visuellement, il peut √™tre divis√© en 3 parties, mais peut-on essayer de deviner combien de contr√¥leurs sont utilis√©s ici? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tz/od/9h/tzod9hfhgm2r4fcebdz0pbhg06y.png" alt="image"></div><br>  Quinze contr√¥leurs principaux.  Et c'est juste pour le contenu. <br><br>  Ici, un tel monstre vit sur l'√©cran principal et se sent plut√¥t bien.  Quinze contr√¥leurs pour un √©cran, c'est bien s√ªr beaucoup.  Cela affecte la vitesse de l'application enti√®re et vous devez l'optimiser d'une mani√®re ou d'une autre. <br><br>  Nous avons refus√© l'initialisation synchrone: tous les mod√®les de vue sont initialis√©s en arri√®re-plan et uniquement lorsque cela est n√©cessaire.  Pour r√©duire le temps de rendu, nous avons √©galement abandonn√© les fichiers xib pour ces √©crans: le positionnement absolu et les math√©matiques sont toujours plus rapides que le calcul des d√©pendances entre les √©l√©ments. <br><br>  Pour garder une trace de tant de contr√¥leurs, vous devez comprendre: <br><br><ul><li>  Dans quel √©tat est chacun d'eux; </li><li>  O√π est l'utilisateur; </li><li>  Ce qu'il attend de voir lors du passage √† un autre contr√¥leur. </li></ul><br>  Pour ce faire, j'ai √©crit un processeur de navigation distinct qui stocke des informations sur l'emplacement de l'utilisateur, le type de contenu qu'il consulte, l'historique de navigation, etc.  Il contr√¥le l'ordre et la n√©cessit√© de l'initialisation. <br><br>  √âtant donn√© que chaque onglet est un curseur de contr√¥leur (afin de cr√©er une transition de balayage sur eux), vous devez comprendre: chacun d'eux peut √™tre dans son propre √©tat (par exemple, "News" est ouvert sur l'un et "Voting" sur l'autre).  Ceci est suivi par le m√™me processeur de navigation.  M√™me en changeant le niveau de pr√©sentation du domicile √† la r√©gion, nous resterons sur le m√™me type de contenu. <br><br><h2>  Nous contr√¥lons le flux de donn√©es en temps r√©el </h2><br>  En travaillant avec autant de donn√©es dans l'application, vous devez organiser la livraison des informations pertinentes dans toutes les sections en temps r√©el.  Pour r√©soudre ce probl√®me, 3 m√©thodes peuvent √™tre distingu√©es: <br><br><ol><li>  Acc√©der √† l'API par des minuteries ou des d√©clencheurs et demander √† nouveau le contenu pertinent sur les √©crans; </li><li>  Avoir une connexion permanente au serveur et recevoir les changements en temps r√©el; </li><li>  Recevez push avec des changements de contenu. </li></ol><br>  Chaque approche a ses avantages et ses inconv√©nients, il est donc pr√©f√©rable d'utiliser les trois, en ne choisissant que les points forts de chacune.  Nous avons divis√© sous condition le contenu de l'application en plusieurs types: chaud, r√©gulier et service.  Ceci est fait afin de d√©terminer le temps acceptable entre l'√©v√©nement et la notification de l'utilisateur.  Par exemple, nous voulons voir un message de discussion imm√©diatement apr√®s qu'il nous l'ait envoy√© - il s'agit d'un contenu br√ªlant.  Autre option: sondage aupr√®s des voisins.  Cela ne fait aucune diff√©rence lorsque nous le voyons, maintenant ou dans une minute, car c'est un contenu ordinaire.  Les petites notifications √† l'int√©rieur de l'application (messages non lus, commandes, etc.) sont un contenu de service qui n√©cessite une livraison urgente, mais ne prend pas beaucoup de donn√©es. <br><br>  Il s'av√®re: <br><br><ul><li>  Contenu chaud - connexion permanente avec l'API; </li><li>  Contenu normal - requ√™tes http √† l'API; </li><li>  Contenu du syst√®me - notifications push. </li></ul><br>  La chose la plus int√©ressante est de maintenir une connexion constante.  √âcrire votre propre client pour travailler avec des sockets Web est une √©tape dans le lapin, vous devez donc chercher d'autres solutions.  En cons√©quence, nous nous sommes arr√™t√©s √† la biblioth√®que SignalR.  Voyons voir ce que c'est. <br><br>  ASP.Net SignalR est une biblioth√®que de Microsoft qui simplifie l'interaction client-serveur en temps r√©el, fournissant une communication bidirectionnelle entre le client et le serveur.  Le serveur comprend une API √† part enti√®re pour g√©rer la connexion, les √©v√©nements de d√©connexion de connexion, un m√©canisme pour combiner les clients connect√©s en groupes et l'autorisation. <br><br>  SignalR peut utiliser des requ√™tes Websockets, LongPolling et http comme transport.  Vous pouvez sp√©cifier le type de transport de force ou faire confiance √† la biblioth√®que: si websocket peut √™tre utilis√©, il fonctionnera via websocket, si ce n'est pas possible, il descendra jusqu'√† ce qu'il trouve un transport acceptable.  Ce fait s'est av√©r√© tr√®s pratique, √©tant donn√© qu'il est pr√©vu de l'utiliser sur des appareils mobiles. <br><br>  Total, quel avantage en tirons-nous: <br><br><ul><li>  Possibilit√© d'√©changer des messages de tout type entre le client et le serveur; </li><li>  Le m√©canisme pour basculer automatiquement entre les sockets Web, les requ√™tes de mise en pool longue et les requ√™tes Http; </li><li>  Informations sur l'√©tat actuel de la connexion; </li><li>  Une opportunit√© d'unir les clients en groupes; </li><li>  M√©thodes pratiques pour manipuler la logique d'envoi de messages dans un groupe; </li><li>  La possibilit√© de faire √©voluer le serveur. </li></ul><br>  Bien s√ªr, cela ne satisfait pas tous les besoins, mais facilite sensiblement la vie. <br><br>  A l'int√©rieur du projet, un wrapper est utilis√© sur la biblioth√®que SignalR, ce qui simplifie encore plus son travail, √† savoir: <br><br><ul><li>  Surveille l'√©tat de la connexion, se reconnecte selon les conditions sp√©cifi√©es et en cas de rupture; </li><li>  Capable de remplacer ou de rouvrir rapidement la connexion, tuant de mani√®re asynchrone l'ancienne et la remettant au garbage collector pour la d√©chirer - comme il s'est av√©r√©, la m√©thode de connexion fonctionne dix fois plus rapidement que la m√©thode de fermeture (Dispose ou Stop), et c'est la seule fa√ßon de la fermer; </li><li>  Organise une file d'attente pour l'envoi de messages afin que la reconnexion ou la r√©ouverture de la connexion n'interrompe pas l'envoi; </li><li>  Transf√®re le contr√¥le aux d√©l√©gu√©s appropri√©s en cas d'erreurs impr√©vues. </li></ul><br>  Chacun de ces wrappers (nous les appelons clients) fonctionne en tandem avec le syst√®me de mise en cache et, en cas de d√©connexion, ne peut demander que les donn√©es qu'il aurait pu manquer pendant cette p√©riode.  ¬´Chacun¬ª car plusieurs compos√©s actifs sont d√©tenus simultan√©ment.  √Ä l'int√©rieur de l'application, il y a un messager √† part enti√®re et un client distinct est utilis√© pour le r√©parer. <br><br>  Le deuxi√®me client est responsable de la r√©ception des notifications.  Comme je l'ai d√©j√† dit, le type de contenu habituel est obtenu via les requ√™tes http, √† l'avenir sa mise √† jour incombera √† ce client, qui en rend compte tous les changements importants (par exemple, le vote est pass√© d'un statut √† un autre, la publication de nouvelles). <br><br><h2>  Visualisez les donn√©es dans l'application </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/01/ne/xn/01nexnxh3zdp2j3cizlcx2lxuhc.png" alt="image"></div><br>  Obtenir des donn√©es est une chose, montrer en est une autre.  La mise √† jour des donn√©es en temps r√©el a ses propres difficult√©s.  Au minimum, vous devez d√©cider comment pr√©senter ces mises √† jour √† l'utilisateur.  Dans l'application, nous utilisons trois types de notifications: <br><br><ol><li>  Notification de contenu non lu; </li><li>  Mise √† jour automatique des donn√©es sur l'√©cran; </li><li>  Offre de contenu. </li></ol><br>  La fa√ßon la plus famili√®re et la plus ordinaire de montrer qu'il y a du nouveau contenu est de mettre en surbrillance l'ic√¥ne de la section.  Ainsi, presque toutes les ic√¥nes ont la possibilit√© d'afficher le notificateur de contenu non lu sous la forme d'un point rouge.  Les choses les plus int√©ressantes sont les mises √† jour automatiques. <br><br>  La mise √† jour automatique des donn√©es n'est possible que lorsque le nouveau contenu ne r√©organise pas l'√©cran et ne modifie pas la taille des contr√¥les.  Par exemple, sur l'√©cran d'enqu√™te: les informations sur les votes ne changeront que la valeur de la barre de progression et les pourcentages.  De tels changements n'entra√Æneront aucun redimensionnement; ils peuvent √™tre appliqu√©s instantan√©ment sans probl√®me. <br><br>  Des difficult√©s surviennent lorsque vous devez ajouter un nouveau contenu √† des listes.  En fait, toutes les listes de l'application sont ScrollView et ont plusieurs caract√©ristiques: taille de la fen√™tre, taille du contenu et position du d√©filement.  Tous ont un d√©but statique (haut de l'√©cran avec les coordonn√©es 0; 0) et peuvent s'√©tendre vers le bas.  Ajouter du nouveau contenu dans la liste, √† la fin, ne pose aucun probl√®me, la liste durera.  Mais le nouveau contenu devrait appara√Ætre en haut, et voici l'image: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rh/ve/am/rhveamjeqsuityqnk3_io3njrxy.png" alt="image"></div><br>  √âtant sur 3 √©l√©ments, nous serons sur 2 - le parchemin rebondira.  Et comme le nouveau contenu peut arriver en permanence, l'utilisateur ne pourra pas faire d√©filer normalement.  Vous pourriez dire: pourquoi ne pas calculer la taille du nouveau contenu et d√©placer le d√©filement vers le bas sur cette valeur?  Oui, cela peut √™tre fait.  Mais alors vous devez contr√¥ler manuellement la position de d√©filement, et si √† ce moment l'utilisateur d√©file dans n'importe quelle direction, son action sera interrompue.  C'est pourquoi ces √©crans ne peuvent pas √™tre mis √† jour en temps r√©el sans le consentement de l'utilisateur. <br><br>  La meilleure solution dans cette situation serait d'informer l'utilisateur que pendant qu'il fait d√©filer le flux, quelqu'un a publi√© du nouveau contenu.  Dans notre conception, cela ressemble √† un cercle rouge dans le coin de l'√©cran.  En cliquant dessus, l'utilisateur donne son consentement conditionnel √† ce que nous le renvoyions en haut de l'√©cran et que nous montrions un nouveau contenu. <br><br>  Avec cette approche, nous avons bien s√ªr √©vit√© les probl√®mes de ¬´glissement¬ª du contenu, mais ils devaient encore √™tre r√©solus.  √Ä savoir, sur l'√©cran de discussion, car pendant la communication et l'interaction avec l'√©cran, le nouveau contenu doit √™tre affich√© √† diff√©rents endroits. <br><br>  La diff√©rence entre le chat et les listes r√©guli√®res est que le nouveau contenu est en bas de l'√©cran.  Puisqu'il s'agit d'une ¬´queue¬ª, vous pouvez y ajouter du contenu sans trop de difficult√©.  L'utilisateur y passe 90% du temps, ce qui signifie que vous devez constamment garder la position de d√©filement et la d√©placer vers le bas lors de la r√©ception et de l'envoi de messages.  Dans une conversation en direct, de telles actions doivent √™tre effectu√©es assez souvent. <br><br>  Le deuxi√®me point: charger l'historique tout en faisant d√©filer vers le haut.  Juste au moment de charger l'histoire, nous nous trouvons dans une situation o√π il est n√©cessaire de placer des messages au-dessus du niveau de r√©vision (ce qui entra√Ænera des biais) afin que le d√©filement soit fluide et continu.  Et comme nous le savons d√©j√†, afin de ne pas d√©ranger l'utilisateur, il est impossible de contr√¥ler manuellement la position de d√©filement. <br><br>  Et nous avons trouv√© une solution: nous l'avons retourn√©e.  Le retournement d'√©cran a r√©solu deux probl√®mes √† la fois: <br><br><ol><li>  La queue de la liste est en haut, afin que nous puissions facilement ajouter une histoire sans interf√©rer avec le d√©filement de l'utilisateur; </li><li>  Le dernier message est toujours en haut de la liste et nous n'avons pas besoin de faire d√©filer l'√©cran avant. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0n/hx/zf/0nhxzfnj9mhuofyu4bkr1epdtlw.png" alt="image"></div><br>  Cette solution a √©galement contribu√© √† acc√©l√©rer le rendu, en √©liminant les op√©rations inutiles avec le contr√¥le de d√©filement. <br><br>  En parlant de performance.  Dans les premi√®res versions de l'√©cran, des baisses notables ont √©t√© d√©tect√©es lors du d√©filement des messages.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtant donn√© que le contenu de la ¬´monnaie¬ª est h√©t√©roclite - texte, fichiers, photos - vous devez constamment recalculer la taille de la cellule, ajouter et supprimer des √©l√©ments dans la monnaie. </font><font style="vertical-align: inherit;">Par cons√©quent, l'optimisation de la bulle √©tait n√©cessaire. </font><font style="vertical-align: inherit;">Nous avons fait la m√™me chose qu'avec l'√©cran principal, en rendant partiellement la p√¢te avec un positionnement absolu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque vous travaillez avec des listes dans iOS, avant de dessiner une cellule, vous devez conna√Ætre sa hauteur. </font><font style="vertical-align: inherit;">Par cons√©quent, avant d'ajouter un nouveau message √† la liste, vous devez pr√©parer toutes les informations n√©cessaires pour les afficher dans un flux s√©par√©, calculer la hauteur des cellules, traiter les donn√©es utilisateur, et seulement apr√®s avoir d√©couvert et mis en cache tout ce qui est n√©cessaire, ajoutez la cellule √† la liste. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cons√©quence, nous obtenons un d√©filement fluide et un flux d'interface utilisateur non surcharg√©.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour r√©sumer: </font></font></h2><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le d√©veloppement multiplateforme permet d'√©conomiser du temps et de l'argent; </font></font></li><li>      ,    ,     ; </li><li>           ,      ; </li><li>           ; </li><li> SignalR ‚Äì     -    ; </li><li>            ; </li><li>         ,    , ; </li><li>      ,   SignalR-,  ,  , , . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430892/">https://habr.com/ru/post/fr430892/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430882/index.html">Xiaomi Aqara Switch refaire de ZigBee √† Z-Wave</a></li>
<li><a href="../fr430884/index.html">Imprimerie: pourquoi "LANIT-Integration" a ouvert sa propre "imprimerie"</a></li>
<li><a href="../fr430886/index.html">Mettre √† jour la biblioth√®que SPPermission et hater</a></li>
<li><a href="../fr430888/index.html">Est-il s√ªr d'utiliser des packages R pour travailler avec l'API des syst√®mes publicitaires</a></li>
<li><a href="../fr430890/index.html">O√π l'agilit√© est terrible, surtout la m√™l√©e</a></li>
<li><a href="../fr430894/index.html">Situation: les marques d√©pensent de plus en plus d'argent pour la publicit√© dans les podcasts - nous comprenons pourquoi</a></li>
<li><a href="../fr430896/index.html">Linux Foundation a √©tabli des fonds pour GraphQL et Ceph - pourquoi sont-ils n√©cessaires et √† quoi s'attendre d'eux</a></li>
<li><a href="../fr430900/index.html">Le premier laser de l'histoire: ce que c'√©tait</a></li>
<li><a href="../fr430902/index.html">Elfes en m√©moire. Ex√©cution d'ELF dans la RAM Linux</a></li>
<li><a href="../fr430906/index.html">Maman dort tranquillement la nuit - nous collectons OpenCV pour Raspbian'a</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>