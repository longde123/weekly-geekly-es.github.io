<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßë‚Äçü§ù‚Äçüßë üëåüèæ ü§≥üèª Rapport du Java Virtual Machine Language Summit 2019 ‚ÜïÔ∏è üíáüèº ü•å</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui s'est termin√© le douzi√®me sommet JVM LS . Comme d'habitude, ce fut un √©v√©nement hardcore avec des pr√©sentations techniques sur les machine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rapport du Java Virtual Machine Language Summit 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/JetBrains/blog/462101/"><img src="https://habrastorage.org/webt/nh/xk/cf/nhxkcfgwiztaulvnbccwhxgcpwe.png" align="right" width="250"><br><p>  Aujourd'hui s'est termin√© le douzi√®me sommet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JVM LS</a> .  Comme d'habitude, ce fut un √©v√©nement hardcore avec des pr√©sentations techniques sur les machines virtuelles et les langages qui y tournent.  Comme d'habitude, le sommet s'est tenu √† Santa Clara, sur le campus Oracle.  Comme d'habitude, il y a beaucoup plus de personnes qui souhaitent venir ici qu'il n'y a de places: le nombre de participants ne d√©passe pas 120. Comme d'habitude, il n'y a pas eu de marketing, seulement des abats. </p><br><p>  Ce sommet est d√©j√† le troisi√®me pour moi, et chaque fois que je le visite avec grand plaisir, malgr√© le terrible d√©calage horaire.  Ici, vous pouvez non seulement √©couter des rapports, mais aussi apprendre √† mieux conna√Ætre les gens du monde de la JVM, participer √† des conversations informelles, poser des questions lors d'ateliers et vous sentir g√©n√©ralement impliqu√© dans de grandes r√©alisations. </p><br><p>  Si vous n'avez pas assist√© au sommet, cela n'a pas d'importance.  La plupart des rapports sont publi√©s sur YouTube presque imm√©diatement apr√®s le sommet.  En fait, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ils sont d√©j√† disponibles</a> .  Pour faciliter la navigation, je d√©crirai bri√®vement ici tous les reportages et ateliers auxquels j'ai r√©ussi √† participer. </p><a name="habracut"></a><br><h1>  29 juillet </h1><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ghadi Shayban - Clojure Futures</a> </h1><br><p> Il ne s'agit pas des fonctionnalit√©s de la compilation Future dans le langage <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Clojure</a> , comme beaucoup le pensaient, mais simplement du d√©veloppement du langage, des subtilit√©s de la g√©n√©ration de code et des probl√®mes qu'ils rencontrent.  Par exemple, il s'est av√©r√© que dans Clojure, il est important d'annuler les variables locales apr√®s la derni√®re utilisation, car si le d√©but d'une liste qui est g√©n√©r√© paresseusement dans une variable locale, puis en la contournant, les n≈ìuds qui ont d√©j√† √©t√© contourn√©s peuvent ne pas √™tre collect√©s par le garbage collector et le programme peut se bloquer avec OutOfMemory .  En g√©n√©ral, le compilateur C2 JIT lib√®re lui-m√™me les variables apr√®s la derni√®re utilisation, mais la norme ne le garantit pas et, par exemple, l'interpr√©teur HotSpot ne le fait pas. </p><br><p>  Il √©tait √©galement int√©ressant d'en savoir plus sur la mise en ≈ìuvre de la r√©partition dynamique des appels de fonction.  J'ai √©galement appris que jusqu'√† r√©cemment, Clojure ciblait JVM 6 et n'√©tait r√©cemment pass√© √† JVM 8. Maintenant, les auteurs du compilateur regardent invokedynamic. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alan Bateman et Rickard B√§ckman - Mise √† jour du projet Loom</a> </h1><br><p>  Le projet Loom est une fibre l√©g√®re pour Java.  Il y a un an, Alan et Ron avaient d√©j√† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parl√©</a> de ce projet, puis il semblait que tout allait tr√®s bien et √©tait sur le point d'√™tre pr√™t.  Cependant, ce projet n'est pas encore officiellement entr√© dans Java et est toujours en cours de d√©veloppement dans une fourchette distincte du r√©f√©rentiel.  Bien s√ªr, il s'est av√©r√© qu'il √©tait n√©cessaire de r√©gler beaucoup de d√©tails. </p><br><p>  De nombreuses API standard de ReentrantLock.lock √† Socket.accept sont d√©j√† adapt√©es aux fibres: si un tel appel est effectu√© √† l'int√©rieur d'une fibre, l'√©tat d'ex√©cution sera enregistr√©, la pile sera d√©roul√©e et le thread du syst√®me d'exploitation sera lib√©r√© pour d'autres t√¢ches jusqu'√† ce qu'un √©v√©nement r√©veille la fibre (par exemple, ReentrantLock.unlock).  Cependant, par exemple, le bon vieux bloc synchronis√© ne fonctionne toujours pas et, semble-t-il, il ne peut pas se passer d'une refactorisation s√©rieuse de toute la prise en charge de la synchronisation dans la JVM.  Un autre d√©roulement de la pile ne fonctionnera pas s'il y a des trames natives dans la pile entre le d√©but de la fibre et le point d'arr√™t.  Dans ces deux cas, rien n'explose, mais la fibre ne lib√®re pas le flux. </p><br><p>  Il existe de nombreuses questions sur la fa√ßon dont Fibre se compare √† l'ancienne classe java.lang.Thread.  Il y a un an, l'id√©e √©tait de faire de la fibre une sous-classe de Thread.  Maintenant, ils l'ont refus√© et en font une entit√© ind√©pendante, car √©muler dans chaque fibre tout le comportement d'un flux r√©gulier est assez cher.  Dans ce cas, Thread.currentThread () √† l'int√©rieur de la fibre retournera le blende g√©n√©r√©, et non le vrai thread dans lequel tout est ex√©cut√©.  Mais l'accroche se comportera plut√¥t bien (m√™me si cela peut ralentir le travail).  L'id√©e importante est de ne donner en aucun cas le v√©ritable flux multim√©dia sur lequel la fibre s'ex√©cute √† l'int√©rieur de la fibre.  Cela peut √™tre dangereux car une fibre peut facilement se d√©placer vers un autre fil.  La tromperie continuera. </p><br><p>  Il est curieux que les participants au projet aient d√©j√† introduit quelques modifications pr√©paratoires dans le r√©f√©rentiel JDK principal afin de leur faciliter la vie.  Par exemple, en Java 13, la m√©thode doPrivileged a √©t√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©√©crite √†</a> partir du code natif enti√®rement en Java, gagnant environ 50 fois plus de performances.  Pourquoi est-ce un projet Loom?  Le fait est que cette m√©thode appara√Æt tr√®s souvent au milieu de la pile, et bien qu'elle soit native, les fibres avec cette pile ne se sont pas arr√™t√©es.  D'une mani√®re ou d'une autre, le projet en b√©n√©ficie d√©j√†. </p><br><p>  Sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page du projet,</a> vous pouvez lire la documentation et t√©l√©charger l'arborescence source, et il existe √©galement des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">assemblages binaires</a> que vous pouvez prendre et jouer aujourd'hui.  Nous esp√©rons que dans les ann√©es √† venir, tout sera int√©gr√©. </p><br><h1>  Brian Goetz - Atelier "Projet Ambre" </h1><br><p> En parall√®le, un atelier se d√©roulait sur le projet Loom, mais je suis all√© √† Amber.  Ici, nous avons bri√®vement discut√© des objectifs du projet et des principaux PEC dans lesquels le travail se poursuit - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Correspondance de mod√®les</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">types d'</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">enregistrements</a> et de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">scell√©s</a> .  Ensuite, toute la discussion est tomb√©e dans la question priv√©e de la port√©e.  J'en ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parl√©</a> lors de la conf√©rence du Joker l'ann√©e derni√®re, en principe, rien de tr√®s nouveau n'a √©t√© dit.  J'ai essay√© de pousser une id√©e avec des types d'unions implicites comme <code>if(obj instanceof Integer x || obj instanceof Long x) use(x.longValue())</code> , mais je n'ai pas vu d'enthousiasme. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jean Christophe Beyler, Arthur Eubanks et Man Cao - Thread Sanitizing for Java</a> </h1><br><p>  √Ä tous √©gards, un merveilleux projet de Google pour rechercher des races en utilisant des donn√©es sous forme de lecture et d'√©criture du m√™me champ non volatile ou √©l√©ment de tableau √† partir de diff√©rents flux sans √©tablir de relation ant√©rieure.  Le projet a √©t√© initialement √©crit en tant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">que module LLVM</a> pour le code natif, et maintenant il a √©t√© adapt√© pour HotSpot.  Il s'agit d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet</a> OpenJDK <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">officiel</a> avec sa liste de diffusion et son r√©f√©rentiel. </p><br><p>  Selon les auteurs, la chose fonctionne maintenant tr√®s bien, vous pouvez assembler et jouer.  De plus, elle trouve la course non seulement dans le code Java, mais aussi dans le code des biblioth√®ques natives.  Les courses dans le code de la machine virtuelle elle-m√™me ne sont pas recherch√©es, car toutes les primitives de synchronisation sont √©crites √† leur mani√®re et TSan n'est pas en mesure de les d√©tecter.  Selon les auteurs, TSan ne donne pas de faux positifs. </p><br><p>  Le principal probl√®me est la performance.  D√©sormais, seul l'interpr√©teur est instrument√© pour le code Java, respectivement, la compilation JIT est compl√®tement d√©sactiv√©e et l'interpr√©teur, qui est d√©j√† lent, ralentit plusieurs fois.  Mais si vous avez suffisamment de ressources (Google en a bien s√ªr assez), vous pouvez occasionnellement piloter vos suites de tests en utilisant TSan.  Il est √©galement pr√©vu d'ajouter une instrumentation au JIT, mais il s'agit d'une intervention beaucoup plus s√©rieuse dans la JVM. </p><br><p>  Quelqu'un a demand√© si la d√©sactivation de la compilation JIT n'affecte pas le r√©sultat, car certaines races peuvent ne pas appara√Ætre sur l'interpr√©teur.  L'orateur n'a pas exclu cette possibilit√©, mais a d√©clar√© qu'il avait d√©j√† trouv√© un grand nombre de courses qui prendraient tr√®s longtemps √† ratisser.  Soyez donc prudent lorsque vous ex√©cutez votre projet sous TSan: vous pouvez d√©couvrir la v√©rit√© d√©sagr√©able. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Brian Goetz - Mise √† jour Valhalla</a> </h1><br><p>  Tout le monde attend des types de valeurs en Java, mais personne ne sait quand ils appara√Ætront.  Cependant, les mouvements sont de plus en plus graves.  Il existe d√©j√† des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">assemblages binaires de</a> test avec le jalon L2 actuel.  Dans les plans actuels, le Valhalla complet viendra sur le jalon L100, mais les auteurs sont toujours optimistes et croient que plus de deux pour cent ont √©t√© r√©alis√©s. </p><br><p>  Donc, du point de vue du langage, nous avons des classes avec le modificateur inline, qui sont trait√©es de mani√®re sp√©ciale par la machine virtuelle.  Les instances de ces classes peuvent √™tre incorpor√©es dans d'autres objets, et des tableaux plats contenant des instances de classes en ligne sont √©galement possibles.  L'instance n'a pas d'en-t√™te, ce qui signifie qu'il n'y a pas d'identit√©, le code de hachage est calcul√© par champs, <code>==</code> √©galement par champs, une tentative de synchronisation ou <code>Object.wait()</code> sur une telle classe l√®vera une exception IllegalMonitorStateException.  L'√©criture de <code>null</code> dans une variable de ce type, bien s√ªr, ne fonctionnera pas.  Cependant, les auteurs proposent une alternative: si vous avez d√©clar√© un <code>Point</code> classe en ligne, vous pouvez alors d√©clarer un champ ou une variable de type (surprise-surprise!) <code>Point?</code>  , puis il y aura un objet √† part enti√®re sur le tas (comme la boxe) avec un en-t√™te, une identit√© et une valeur <code>null</code> . </p><br><p>  Les questions ouvertes s√©rieuses restent la sp√©cialisation des g√©n√©riques et la migration des classes existantes (par exemple, <code>Optional</code> ) vers une classe en ligne afin de ne pas casser le code existant (oui, les gens √©crivent <code>null</code> dans des variables de type <code>Optional</code> ).  N√©anmoins, l'image se profile et l'√©cart est visible. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David Wrighton et Neal Gafter - Types de valeurs dans le CLR</a> </h1><br><p>  Ce fut une surprise pour moi que le m√™me Neil Gafter, co-auteur des puzzlers Java originaux, travaille maintenant chez Microsoft sur le runtime .Net.  C'√©tait √©galement une surprise de voir un rapport sur le CLR (le soi-disant runtime .Net) sur la JVM LS.  Mais se familiariser avec l'exp√©rience de coll√®gues d'autres mondes est toujours utile.  Le rapport parle des vari√©t√©s de r√©f√©rences et de pointeurs dans le CLR, des instructions de bytecode utilis√©es pour les types de valeur et de la fa√ßon dont les fonctions g√©n√©ralis√©es magnifiquement sp√©cialis√©es comme r√©duire.  Il √©tait int√©ressant d'apprendre que l'un des objectifs des types de valeur dans .Net est l'interop√©rabilit√© avec le code natif.  Pour cette raison, l'emplacement des champs dans les types de valeur est strictement fixe et peut √™tre projet√© sur une structure sans transformations.  La JVM n'a jamais eu une telle t√¢che, et quoi faire avec l'interop√©rabilit√© native - voir ci-dessous. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vladimir Ivanov et John Rose - Vecteurs et num√©rique sur la JVM</a> </h1><br><p>  Mettez √† jour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le rapport de l'an dernier</a> .  Encore une fois, la question est de savoir pourquoi ils n'ont toujours rien publi√©, alors qu'il y a un an, tout avait l'air plut√¥t bien. </p><br><p>  Un vecteur est une collection de plusieurs nombres, qui dans le mat√©riel peut √™tre repr√©sent√© par un seul registre vectoriel comme zmm0 pour AVX512.  Dans les vecteurs, vous pouvez charger des donn√©es √† partir de tableaux, effectuer des op√©rations sur celles-ci comme une multiplication par √©l√©ment et les renvoyer.  Toutes les op√©rations pour lesquelles il existe des instructions de processeur sont int√©gr√©es par le compilateur JIT dans ces instructions.  Le nombre d'op√©rations est tout simplement √©norme.  Si quelque chose manque, une impl√©mentation lente alternative est utilis√©e.  Les objets vectoriels interm√©diaires ne sont id√©alement pas cr√©√©s; l'analyse des √©chappements fonctionne.  Tous les algorithmes informatiques standard sont vectoris√©s avec un bang, en utilisant toute la puissance de votre processeur. </p><br><p>  Malheureusement, il est difficile pour les auteurs de ne pas avoir de valgalla: l'analyse d'√©chappement est fragile et peut ne pas fonctionner facilement.  Ces vecteurs doivent simplement √™tre des classes en ligne, puis tous les probl√®mes dispara√Ætront.  On ne sait pas si cette API peut m√™me √™tre publi√©e avant la premi√®re version de Valgalla.  Cela semble beaucoup plus pr√™t.  Parmi les probl√®mes appel√©s difficult√©s avec le support du code.  Il existe de nombreux √©l√©ments r√©p√©titifs pour diff√©rentes tailles de registres et diff√©rents types de donn√©es, de sorte que la plupart du code est g√©n√©r√© √† partir de mod√®les et qu'il est difficile de le maintenir. </p><br><p>  L'utilisation est √©galement imparfaite.  Il n'y a pas de surcharge d'op√©rateur en Java, donc les math√©matiques semblent laides: au lieu de <code>max(va-vb*42, 0)</code> vous devez √©crire <code>va.lanewise(SUB, vb.lanewise(MUL, 42)).lanewise(MAX, 0)</code> .  Ce serait bien d'avoir acc√®s aux lambdas AST comme en C #.  Il serait alors possible de g√©n√©rer une op√©ration lambda personnalis√©e comme <code>MYOP = binOp((va, vb) -&gt; max(va-vb*42, 0))</code> et de l'utiliser. </p><br><h1>  30 juillet </h1><br><p>  Le deuxi√®me jour s'est pass√© sous le pavillon de la compilation. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mark Stoodley - De AOT √† JIT et au-del√†!</a> </h1><br><p>  Un employ√© d'IBM, membre du projet JVM OpenJ9, parle de son exp√©rience avec les compilations JIT et AOT.  Il y a toujours des probl√®mes: JIT est un d√©marrage lent, car il se r√©chauffe;  Co√ªts du processeur pour la compilation.  AOT - performances sous-optimales en raison de l'absence de profil (il est possible de profiler, mais de mani√®re non triviale et pas toujours le profil lors de la compilation correspond au profil lors de l'ex√©cution), il est plus difficile √† utiliser, se lier √† la plate-forme cible, OS, garbage collector.  Certains des probl√®mes peuvent √™tre r√©solus en combinant des approches: en commen√ßant par du code compil√© par AOT puis en terminant par JIT.  Une bonne alternative √† tout cela est la mise en cache JIT.  Si vous avez beaucoup de machines virtuelles (bonjour, microservices), elles se tournent toutes vers un service distinct - le compilateur JIT (oui, JITaaS), o√π tout est comme un adulte, l'orchestration, l'√©quilibrage de charge.  Ce service se compile.  Tr√®s souvent, il peut donner du code pr√™t √† l'emploi √† une certaine m√©thode, car cette m√©thode a d√©j√† √©t√© compil√©e sur une autre JVM.  Cela am√©liore consid√©rablement l'√©chauffement, supprime la consommation de ressources de votre service JVM et r√©duit g√©n√©ralement la consommation totale de ressources. </p><br><p>  En g√©n√©ral, JITaaS pourrait √™tre le prochain mot √† la mode dans le monde JVM.  Malheureusement, je n'ai pas compris si cela pouvait √™tre jou√© en ce moment ou si c'est encore un d√©veloppement ferm√©. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Christian Wimmer - Am√©lioration de l'image native GraalVM</a> </h1><br><p>  GraalVM Native Image est une application Java compil√©e en code natif qui s'ex√©cute sans JVM (contrairement aux modules compil√©s √† l'aide d'un compilateur AOT comme jaotc).  Plus pr√©cis√©ment, ce n'est pas tout √† fait une application Java.  Pour fonctionner correctement, il a besoin d'un monde ferm√©, c'est-√†-dire que tout le code doit √™tre visible au stade de la compilation, pas Class.forName.  Vous pouvez g√©rer les r√©flexions et les m√©thodes, mais lorsque vous compilez, vous devez indiquer pr√©cis√©ment quelles classes et m√©thodes seront utilis√©es par le biais de la r√©flexion. </p><br><p>  Une autre chose amusante est l'initialisation de classe.  De nombreuses classes sont initialis√©es lors de la compilation.  Autrement dit, vos champs statiques seront calcul√©s par d√©faut par le compilateur et le r√©sultat sera √©crit dans l'image assembl√©e, et lorsque vous d√©marrez l'application, il est simplement lu.  Ceci est n√©cessaire pour obtenir une meilleure qualit√© de compilation: tout pliage constant peut √™tre effectu√© si les valeurs des champs statiques sont connues du compilateur.  Tout va bien avec JIT, l'interpr√©teur effectue une initialisation statique, puis en connaissant les constantes, vous pouvez compiler.  Et lors de la cr√©ation d'une application native, vous devez tromper.  Bien s√ªr, cela conduit √† des effets psych√©d√©liques amusants.  Ainsi, les classes sont g√©n√©ralement initialis√©es dans l'ordre auquel elles sont acc√©d√©es, et pendant la compilation, cet ordre est inconnu et l'initialisation dans un autre est possible.  S'il existe des r√©f√©rences circulaires entre les initialiseurs de classe, vous pouvez voir la diff√©rence dans le comportement du code JVM et dans l'image native. </p><br><h1>  Atelier Schatzl - Hotspot GC. </h1><br><p>  Tri√© toutes les douleurs associ√©es aux r√©cup√©rateurs.  Malheureusement, j'ai √©cout√© le plus.  Je me souviens que le rappel de la m√©moire du syst√®me d'exploitation a √©t√© discut√©, y compris le Xmx d√©go√ªtant pour tout le monde.  Bonne nouvelle: dans Java 13, une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouvelle option</a> -XX est ajout√©e: SoftMaxHeapSize.  Jusqu'√† pr√©sent, il n'est pris en charge que par le collecteur ZGC, mais G1 peut √©galement rattraper son retard.  Il d√©finit une limite sur la taille du tas, qui ne doit pas √™tre d√©pass√©e, sauf dans les situations d'urgence, lorsqu'elle ne fonctionne pas diff√©remment.  Ainsi, vous pouvez d√©finir un grand Xmx (par exemple, √©gal √† la taille de la RAM enti√®re) et un SoftMaxHeapSize raisonnable.  Ensuite, la JVM se maintiendra la plupart du temps, mais √† pleine charge, elle ne lancera toujours pas OutOfMemoryError, mais prendra plus de m√©moire du syst√®me d'exploitation.  Lorsque la charge diminue, la m√©moire revient. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mei-Chin Tsai - JIT et AOT dans le CLR</a> </h1><br><p>  Microsoft Mei-Chin Tsai a parl√© des fonctionnalit√©s de la compilation JIT et AOT dans le CLR.  La compilation AOT se d√©veloppe pour eux depuis longtemps, mais initialement (ngen.exe) elle a √©t√© r√©alis√©e sur la plateforme cible, un peu comme la premi√®re fois qu'elle a d√©marr√© (si vous avez Windows, recherchez les fichiers * .ni.dll dans le dossier Windows).  Les fichiers sont obtenus en fonction de la version de Windows local et m√™me d'autres DLL-ek.  Par cons√©quent, si la d√©pendance est mise √† jour, tous les modules natifs doivent √™tre recompil√©s.  Dans la deuxi√®me g√©n√©ration (crossgen), les auteurs ont pr√©compil√© des applications et des modules relativement ind√©pendants des versions et des d√©pendances du mat√©riel et du syst√®me d'exploitation.  Cela a ralenti le code car les appels de d√©pendance devaient maintenant √™tre rendus honn√™tement virtuels.  Ce probl√®me a √©t√© r√©solu en connectant JIT et en recompilant le code actif lors de l'application.  Ensuite, nous avons parl√© de la compilation √† plusieurs niveaux (√† plusieurs niveaux) (il semble que dans le CLR, ce soit √† ses balbutiements, alors qu'il se d√©veloppe en Java depuis au moins dix ans) et des plans futurs pour faire d'AOT v√©ritablement multiplateforme. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wei Kuai et Xiaoming Gu - Acc√©l√©rez les performances JVM avec JWarmUp</a> </h1><br><p>  Des coll√®gues d'Alibaba ont pr√©sent√© leur approche du probl√®me d'√©chauffement de la JVM.  Ils utilisent la JVM pour de nombreux services Web.  En principe, un d√©marrage tr√®s rapide n'est pas si important, car l'√©quilibreur peut toujours attendre que la machine d√©marre et ensuite seulement commencer √† lui envoyer des requ√™tes.  Cependant, le probl√®me est que la machine ne chauffe pas sans requ√™tes: le code qui d√©crit la logique de traitement des requ√™tes n'est pas appel√©, ce qui signifie qu'il ne compile pas.  Il sera compil√© lorsque les premi√®res demandes arriveront, c'est-√†-dire que peu importe le temps d'attente de l'√©quilibreur, il y aura un √©chec de performance sur les premi√®res demandes.  Auparavant, ils essayaient de r√©soudre ce probl√®me en lan√ßant de fausses demandes au service √† venir avant de lui envoyer de vraies demandes.  L'approche est int√©ressante, mais il est assez difficile de g√©n√©rer un tel faux flux qui provoquerait la compilation de tout le code n√©cessaire. </p><br><p>  Un probl√®me distinct est la d√©soptimisation.  Dans les mille premi√®res requ√™tes, une <code>if</code> toujours le long de la premi√®re branche, le compilateur JIT a g√©n√©ralement jet√© la seconde, y ins√©rant un pi√®ge de d√©soptimisation pour r√©duire la taille du code.  Mais la 1001e demande est all√©e √† la deuxi√®me branche, la d√©soptimisation a fonctionn√© et toute la m√©thode est all√©e √† l'interpr√®te.  Pendant que les statistiques sont √† nouveau compil√©es, tandis que la m√©thode est compil√©e par le compilateur C1, puis par le profil complet par le compilateur C2, les utilisateurs conna√Ætront un ralentissement.  Et puis dans la m√™me m√©thode, un autre <code>if</code> peut √™tre d√©soptimis√©, et tout ira sur un nouveau. </p><br><p>  JWarmUp r√©sout le probl√®me comme suit.  Lors de la premi√®re ex√©cution du service, un journal de compilation est √©crit pendant plusieurs minutes: il enregistre les m√©thodes qui ont √©t√© compil√©es et les informations de profilage n√©cessaires par branches, types, etc. Si ce service est red√©marr√©, imm√©diatement apr√®s le d√©marrage, toutes les classes du journal sont initialis√©es et les m√©thodes journalis√©es sont compil√©es en tenant compte du profil pr√©c√©dent.  Par cons√©quent, le compilateur fonctionnera bien au d√©marrage, apr√®s quoi l'√©quilibreur commencera √† envoyer des requ√™tes √† cette machine virtuelle Java.  √Ä ce moment, tout le code chaud qu'elle a d√©j√† √©t√© compil√©. </p><br><p>  Il convient de noter que le probl√®me de d√©marrage rapide n'est pas r√©solu ici.  Un lancement peut √™tre encore plus lent car de nombreuses m√©thodes sont compil√©es, dont certaines peuvent √™tre n√©cessaires seulement quelques minutes apr√®s le lancement.  Mais le journal se r√©v√®le r√©utilisable: contrairement √† AOT, vous pouvez augmenter le service sur une architecture diff√©rente ou avec un garbage collector diff√©rent et r√©utiliser le journal pr√©c√©dent. </p><br><p>  Les auteurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tentent</a> depuis longtemps <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de</a> pousser JWarmUp dans OpenJDK.  Jusqu'√† pr√©sent sans succ√®s, mais le travail avance.  L'essentiel est qu'un correctif √† part enti√®re soit assez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">accessible</a> pour vous-m√™me sur le serveur Code Review, vous pouvez donc facilement l'appliquer aux sources HotSpot et cr√©er la JVM vous-m√™me avec JWarmUp. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Juan Fumero - TornadoVM</a> </h1><br><p>  Il s'agit d'un document de recherche de Manchester, mais les auteurs affirment que le projet a d√©j√† √©t√© mis en ≈ìuvre √† certains endroits.  C'est √©galement un module compl√©mentaire pour OpenJDK, ce qui facilite le transfert de certains codes Java vers GPU, iGPU, FPGA ou simplement le parall√©lise aux c≈ìurs de son processeur.  Pour compiler sur le GPU, ils utilisent GraalVM dans lequel ils ont construit leur backend - TornadoJIT.  Une m√©thode Java correctement √©crite va de mani√®re transparente vers le p√©riph√©rique correspondant.  Certes, ils disent que la compilation sur FPGA peut prendre plusieurs heures, mais si votre t√¢che est consid√©r√©e comme un mois, alors pourquoi pas.  Certains benchmarks (par exemple, la transform√©e de Fourier discr√®te) sont plus de cent fois plus rapides que le Java brut, ce qui est pr√©vu en principe.  Le projet est enti√®rement t√©l√©charg√© sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> , o√π vous pouvez √©galement trouver des publications scientifiques sur le sujet. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Maurizio Cimadomore - D√©construire le Panama</a> </h1><br><p>  Tous la m√™me chanson - un projet de longue date, chaque pr√©sentation au sommet, il y a un an, tout semblait assez pr√™t, mais il n'y avait toujours pas de sortie.  Il s'est av√©r√© que depuis lors, la focalisation a chang√©. </p><br><p>  L'id√©e du projet est une interface am√©lior√©e avec du code natif.  Tout le monde sait combien il est douloureux d'utiliser JNI.  √áa fait vraiment mal.  Le projet Panama annule cette douleur: l'utilisation de classes Java jextract est g√©n√©r√©e √† partir des fichiers * .h de la biblioth√®que native, qui sont assez pratiques √† utiliser en appelant des m√©thodes natives.  C√¥t√© C / C ++, vous n'avez pas du tout besoin d'√©crire une seule ligne.  De plus, tout est devenu beaucoup plus rapide: les frais g√©n√©raux sur les appels vers Java-&gt; natif et natif-&gt; Java ont parfois baiss√©.  Que voulez-vous de plus? </p><br><p>  Il y a un probl√®me qui existe depuis un certain temps - le transfert de tableaux de donn√©es en code natif.  Jusqu'√† pr√©sent, la m√©thode recommand√©e est DirectByteBuffer, qui a beaucoup de probl√®mes.  L'une des plus graves est la dur√©e de vie non g√©r√©e (le tampon dispara√Ætra lorsque le garbage collector r√©cup√©rera l'objet Java appropri√©).  √Ä cause de cela et d'autres probl√®mes, les gens utilisent Unsafe qui, avec une diligence raisonnable, peut facilement d√©poser l'ensemble de la machine virtuelle. </p><br><p>  Cela signifie que vous avez besoin d'un nouvel acc√®s m√©moire normal en dehors du tas Java.  Allocation, accesseurs structur√©s, suppression explicite.  Accesseurs structur√©s - pour que vous n'ayez pas √† calculer vous-m√™me les d√©calages si vous avez besoin d'√©crire, par exemple, <code>struct { byte x; int y; }[5]</code> <code>struct { byte x; int y; }[5]</code>  <code>struct { byte x; int y; }[5]</code> .  Au lieu de cela, vous d√©crivez une fois la disposition de cette structure, puis faites, par exemple, <code>VarHandle</code> , qui peut lire tous les <code>x</code> en sautant par-dessus <code>y</code> .  Dans ce cas, bien s√ªr, il devrait toujours y avoir une v√©rification des fronti√®res, comme dans les tableaux Java ordinaires.  En outre, l'acc√®s √† une zone d√©j√† ferm√©e devrait √™tre interdit.  Et cela s'av√®re √™tre une t√¢che non triviale si nous voulons maintenir les performances au niveau dangereux et permettre l'acc√®s √† partir de plusieurs threads.  Bref, regardez la vid√©o, tr√®s int√©ressante. </p><br><h1>  Atelier: Vladimir Kozlov - Projet Metropolis </h1><br><p>  Le projet Metropolis combine toutes les tentatives de r√©√©criture de parties de la JVM en Java.  Sa partie principale aujourd'hui est le compilateur Graal.  Ces derni√®res ann√©es, il s'est tr√®s bien d√©velopp√© et il est d√©j√† question d'un remplacement complet du C2 vieillissant.  Autrefois, il y avait un probl√®me de bootstrap: le Graal a commenc√© lentement, car lui-m√™me devait √™tre compil√© en JIT ou interpr√©t√©.  Puis la compilation AOT est apparue (oui, l'objectif principal du projet de compilation AOT est le bootstrap du graal lui-m√™me).  Mais avec AOT, le Graal mange une partie d√©cente du tas d'une application Java qui peut ne pas vraiment vouloir partager son tas.  Nous avons maintenant appris √† transformer le Graal en une biblioth√®que native en utilisant Graal Native Image, ce qui nous a finalement permis d'isoler le compilateur du tas g√©n√©ral.  Avec les performances de pointe du code compil√© par le Graal, il y a encore des probl√®mes sur certains benchmarks.  Par exemple, le Graal est en retard sur C2 en intrins√®que et en vectorisation.  Cependant, gr√¢ce √† l'analyse d'inline et d'√©chappement tr√®s puissante, il casse simplement C2 sur le code fonctionnel, o√π de nombreux objets immuables et de nombreuses petites fonctions sont cr√©√©s.  Si vous √©crivez sur le Rocher et que vous n'utilisez toujours pas le Graal, courez pour l'utiliser.  De plus, dans les derni√®res versions de JDK, il est assez banal de faire quelques cl√©s, tout est d√©j√† dans le kit. </p><br><h1>  31 juillet </h1><br><h1>  Kevin Bourrillion - Annotations de nullit√© pour Java </h1><br><p>  Kevin a annonc√© un nouveau projet, mais a demand√© √† ne pas parler publiquement et √† ne pas publier un enregistrement de son discours sur YouTube.  D√©sol√©.  ,        . </p><br><h1> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dmitry Petrashko ‚Äî Gradual typing for Ruby at Scale with Sorbet</a> </h1><br><p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sorbet</a>   (!) Ruby,       Ruby   .  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Stripe</a>         Ruby   , ,    .  ,     . </p><br><h1> Lightning Talks </h1><br><p> -     .   Remi Forax     ,       ,   .    ,      : </p><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1156627887165804544"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p>      ,   -     ,   . </p><br><h1> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Erik Meijer ‚Äî Differentiable Programming</a> </h1><br><p>             ML  AI      ,     .     ,    Facebook   ‚Äî        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">getafix</a> , --,       ,   .          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> ,    .  ,    ,        . </p><br><p>    .   .    OpenJDK Committer Workshop. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462101/">https://habr.com/ru/post/fr462101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462083/index.html">Structures de donn√©es rapides avec des exemples. Premi√®re partie: liste cha√Æn√©e</a></li>
<li><a href="../fr462087/index.html">Test d'une femme de m√©nage intelligente (vodka, k√©fir, photos d'autres personnes)</a></li>
<li><a href="../fr462091/index.html">Solution de la t√¢che avec pwnable.kr cmd1, cmd2, asm, blukat. Filtrage bypass sous Linux. √âcrire un shellcode avec pwntools</a></li>
<li><a href="../fr462095/index.html">Travailler avec la lumi√®re et l'optique: comment d√©marrer une carri√®re √† l'universit√© - l'exp√©rience des dipl√¥m√©s de quatre programmes de ma√Ætrise sp√©cialis√©s</a></li>
<li><a href="../fr462097/index.html">Tour vert clair</a></li>
<li><a href="../fr462107/index.html">Marathon gratuit ¬´Big Data et super-h√©ros: votre premi√®re exp√©rience d'analyse de donn√©es¬ª</a></li>
<li><a href="../fr462109/index.html">Voir presque invisible, √©galement en couleur: une technique pour visualiser des objets √† travers un diffuseur</a></li>
<li><a href="../fr462111/index.html">Comment nous avons test√© plusieurs bases de donn√©es de s√©ries chronologiques</a></li>
<li><a href="../fr462113/index.html">Environnement irr√©prochable: personne ne devrait √©crire de code de qualit√©</a></li>
<li><a href="../fr462115/index.html">Ajustez le ciel √©toil√© sur WebGL en 1009 octets de JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>