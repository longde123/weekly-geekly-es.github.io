<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ถ ๐๏ธ ๐๐ผ OceanLotus: ูุณุชุชุฑ ุฌุฏูุฏ ุ ูุฎุทุทุงุช ูุฏููุฉ ๐๐ป ๐ด ๐๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชุดุชูุฑ ูุฌููุนุฉ OceanLotus (ุงููุนุฑููุฉ ุฃูุถูุง ุจุงุณู APT32 ู APT-C-00) ุจูุฌูุงุชูุง ูู ุดุฑู ุขุณูุง. ูู ุงูุนุงู ุงููุงุถู ุ ุชู ูุดุฑ ุนุฏุฏ ูู ุงูุฏุฑุงุณุงุช ุญูู ุนูู ุงููุฌููุนุฉ ุ ุจูุง ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OceanLotus: ูุณุชุชุฑ ุฌุฏูุฏ ุ ูุฎุทุทุงุช ูุฏููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/421779/" style=";text-align:right;direction:rtl">  ุชุดุชูุฑ ูุฌููุนุฉ OceanLotus (ุงููุนุฑููุฉ ุฃูุถูุง ุจุงุณู APT32 ู APT-C-00) ุจูุฌูุงุชูุง ูู ุดุฑู ุขุณูุง.  ูู ุงูุนุงู ุงููุงุถู ุ ุชู ูุดุฑ ุนุฏุฏ ูู ุงูุฏุฑุงุณุงุช ุญูู ุนูู ุงููุฌููุนุฉ ุ ุจูุง ูู ุฐูู ูุซุงุฆู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CyberReason</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฑุงุฌุนุฉ FireEye</a> ุ ููุตู ูุฌูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Volexity ูู</a> ุญูุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑู</a> .  ููุง ูุฑู ุ ุชููู ุงููุฌููุนุฉ ุจุชุญุฏูุซ ุงูุฃุจูุงุจ ุงูุฎูููุฉ ูุงูุจููุฉ ุงูุชุญุชูุฉ ููุงููุงุช ุงูุนุฏูู. <br><br>  ุชูุงุตู OceanLotus ุงุณุชูุฏุงู ุงูุดุฑูุงุช ูุงูููุงูุงุช ุงูุญููููุฉ ูู ุดุฑู ุขุณูุง.  ููููุง ูููุงุณ ESET ุนู ุจูุนุฏ ุ ูุฅู ุฃูุฏุงู OceanLotus ุฐุงุช ุงูุฃููููุฉ ุชูุน ูู ููุชูุงู ููุงูุณ ูููุจูุฏูุง ูุงูููุจูู. <br><br>  ููุฐ ุจุถุนุฉ ุฃุดูุฑ ุงูุชุดููุง ูุญููููุง ุฃุญุฏ ุฃุญุฏุซ ุฃุจูุงุจูู ุงูุฎูููุฉ.  ูุทุจู ุงูุนุฏูุฏ ูู ุงูุฃุฏูุงุช ุงูุชู ุชุฌุนู ูู ุงูุตุนุจ ุชุญููู ูุชุฌูุจ ุงููุดู - ุณููุงูุดูุง ูู ููุดูุฑ. <br><br><img src="https://habrastorage.org/webt/4f/mf/dz/4fmfdzgqiqskqku5rz7eeprycti.jpeg"><br><br><a name="habracut"></a><h2 style=";text-align:right;direction:rtl">  ุงูุชูุฒูุน </h2><br>  ูุณุชุฎุฏู ุงูููุงุฌููู ุฃุณุงููุจ ูุฎุชููุฉ ูุฅููุงุน ุงูุถุญูุฉ ุจุฅุทูุงู ูุทุงุฑุฉ ุฎุจูุซุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุญูุงุช ูุฒุฏูุฌุฉ ูุฃููููุงุช ุชุทุจููุงุช ููููุฉ (Word ู PDF ููุง ุฅูู ุฐูู) </h3><br>  ูู ุงููุญุชูู ุฃู ุชูุชุดุฑ ุงููุทุงุฑุงุช ุนุจุฑ ูุฑููุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู.  ูุงุญุธูุง ุฃุณูุงุก ุงููููุงุช ุงูุชุงููุฉ: <br>  - <code>Mi17 Technical issues - Phonesack Grp.exe</code> (Mi-17 - ุทุฑุงุฒ ุทุงุฆุฑุฉ ูููููุจุชุฑ ุฑูุณูุฉ) <br>  - <code>Chi tiet don khieu nai gui saigontel.exe</code> (ูุชุฑุฌู ูู ุงูููุชูุงููุฉ - "ุชูุงุตูู ุงููุทุงูุจุฉ ุงููุฑุณูุฉ ุฅูู Saigontel" ุ Saigontel - ุดุฑูุฉ ุงูุงุชุตุงูุงุช ุงูููุชูุงููุฉ) <br>  - ุชู <code>Updated AF MOD contract - Jan 2018.exe</code> <br>  - <code>remove_pw_Reschedule of CISD Regular Meeting.exe</code> <br>  - <code>Sorchornor_with_PM_-_Sep_2017.exe</code> <br>  - <code>20170905-Evaluation Table.xls.exe</code> <br>  - <code>CV_LeHoangThing.doc.exe</code> (ุชู ุงูุนุซูุฑ ุนูู ุงูุณูุฑ ุงูุฐุงุชูุฉ ุงููุฒููุฉ ุฃูุถูุง ูู ููุฏุง) <br><br>  ูู ูุฐู ุงููููุงุช ููุง ุดูุก ูุดุชุฑู - ุฅุทูุงู ูุณุชูุฏ ุทุนู ูุญูู ุจูููุฉ ูุฑูุฑ.  ูู ุบูุฑ ุงููุงุถุญ ูุง ุฅุฐุง ูุงูุช ูููุฉ ุงููุฑูุฑ ููุฌูุฏุฉ ูู ููุงู ูุง ูู ุจูุงูุงุช ุงูุฑุณุงูุฉ ุงููุฑุณูุฉ ุ ุฃู ูุง ุฅุฐุง ูุงู ูุฌุจ ุนุฏู ูุชุญ ุงููุณุชูุฏ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุฑููุจ ููููุฉ </h3><br>  ุชู ุฑุตุฏ ุงูุนุฏูุฏ ูู ุงููุซุจุชุงุช ุงููุฒููุฉ ุงูุชู ุชุชุธุงูุฑ ุจุฃููุง ูุซุจุชุงุช ุฃู ุชุญุฏูุซุงุช ุจุฑุงูุฌ ูู ุญููุงุช ุซูุจ ุงูุฑู.  ุฃุญุฏ ุงูุฃูุซูุฉ ูู ูุซุจุช Firefox ุงููุนุงุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุนุจุฆุชู</a> ุงูููุตูู ุจูุงุณุทุฉ 360 Labs ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Freebuf</a> (ุจุงูุตูููุฉ). <br><br>  ุนููุฉ ุฃุฎุฑู ุฑุฃููุงูุง ูุงูุช ุชุณูู <code>RobototFontUpdate.exe</code> .  ุฑุจูุง ุงูุชุดุฑ ูู ุฎูุงู ุงูููุงูุน ุงููุนุฑุถุฉ ููุฎุทุฑ ุ ูููู ููุณ ูุฏููุง ุฃุฏูุฉ ูุงููุฉ ุนูู ุฐูู. <br><br>  ุฌููุน ุงููููุงุช ุงูููุตููุฉ ุ ุณูุงุก ุชู ุชูุฒูุนูุง ุนุจุฑ ุงูุจุฑูุฏ ุฃู ุชูุฒูููุง ุนูุฏ ุฒูุงุฑุฉ ูููุน ุชู ุงุฎุชุฑุงูู ุ ูุงูุช ุจุชุณููู ููุณ ุงููููู ุงูุฎููู.  ูู ุฅุญุฏู ุงููุดุงุฑูุงุช ุ ุณูููู ุจุชุญููู ุนููุฉ ูู <code>RobototFontUpdate.exe</code> ููููุฉ ุฅุฏุงุฑุชูุง ูุชูููุฐ ุญูููุฉ ุถุงุฑุฉ ุนูู ุงููุธุงู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชุญููู ุงูููู </h2><br>  ุชุนุชูุฏ ุนูููุฉ ุงูุชุซุจูุช ูุงูุชูููุฐ ุนูู ุงูุชุนุชูู ูุชุนุฏุฏ ุงูุทุจูุงุช ุ ุฃู ุชุดููุฑ ุงูููููุงุช ูุฅุนุงุฏุฉ ุจูุงุก ูููุงุช PE ูุชูููุงุช ุชุญููู ููุฏ ุงููุดุฑุฉ ูุงูุชุญููู ุงูุฌุงูุจู.  ุชู ูุตู ูุฐุง ุงูุฃุฎูุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏุฑุงุณุฉ Korplug ุงูุณุงุจูุฉ</a> ูู ESET. <br><br><h3 style=";text-align:right;direction:rtl">  ูุฑุงุฌุนุฉ ุงูุชูุฏู </h3><br>  ูุชููู ุงููุฌูู ูู ุฌุฒุฃูู: ูุทุงุฑุฉ ูุณูุงุฑุฉ ุฅุทูุงู.  ุณูุชู ุดุฑุญ ูู ุฎุทูุฉ ูู ูู ุฌุฒุก ูู ุงูุนูููุฉ ุจุงูุชูุตูู ูู ุงููุณู ุงูููุงุจู.  ููุฏู ุงูุฑุณูุงู ุงูุจูุงููุงู ุฃุฏูุงู ููุฑุฉ ููุฌุฒุฉ ุนู ุงูุชูุฏู ุงูุนุงู ููุจุฑุงูุฌ ุงูุถุงุฑุฉ. <br><br><img src="https://habrastorage.org/webt/yn/wa/jd/ynwajd8empdclmahz0mzaarmpxk.png"><br>  <i>ุงูุดูู 1. ุชูุฏู ุงููุทุงุฑุฉ</i> <br><br><img src="https://habrastorage.org/webt/gv/ba/jb/gvbajbzaqzd6tmrjpj95nkov-j8.png"><br>  <i>ุงูุดูู 2. ุชูุฏู ูุณุชุชุฑ</i> <br><br>  ุชูุฑูุจุง ูู ูุฐู ุงูููููุงุช ูุดูุดุฉ.  ูุนุชูุฏ ุงูุชุนุชูู ุนูู ุฃูุงูุฑ ุงูุงูุชูุงู ุงูุดุฑุทู ุงูุชูููููุฉ ุงูุชูููููุฉ.  ููู ูู ุงูููุงุฐุฌ: JZ / JNZ ู JP / JNP ู JO / JNO ููุง ุฅูู ุฐูู ุ ูููู ูู ุฒูุฌ ุจุงูุงูุชูุงู ุฅูู ููุณ ุงููุฏู.  ูุชุฎูู ุงูุชุณูุณู ุฑูุฒ ุบูุฑ ูุฑุบูุจ ููู ูุณุชุฎุฏู ูุคุดุฑ ุงูููุฏุณ ููููู ูุง ูุบูุฑ ูููุฉ ุงูุนูุงูุฉ ุงูุดุฑุทูุฉ.  ุงุชุถุญ ุฃู ุงูุงูุชูุงู ูุญุฏุซ ุฏุงุฎู ููุณ ุงููุฑุน.  ูุฐุง ูุคุฏู ุฅูู ูุดุงูู ุฃุซูุงุก ุนูููุฉ ูู ุงูุชุฌููุน ุจุณุจุจ ุงุณุชุฎุฏุงู ููู ูุคุดุฑ ุงูููุฏุณ ุงูุฅูุฌุงุจูุฉ. <br><br><img src="https://habrastorage.org/webt/lh/y6/an/lhy6anvm_1feplhj7depx1udiiu.png"><br>  <i>ุงูุดูู 3 ุงูุดูู 3. ุงูุงูุชูุงู ุงููุดุฑูุท ุงูุชููููู</i> <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุถูู ุจุนุถ ุงูุนูุงุตุฑ ุงูุฃุณุงุณูุฉ ููุจุฑูุงูุฌ ุนููุงููุง ูุงุญุฏูุง ุฅูู ุงูููุฏุณ ุ ูุจุนุฏ ุฐูู ุชูุชูู ุจู JMP / CALL ุ ุจูููุง ุชุถูู ุงูุนูุงุตุฑ ุงูุฃุณุงุณูุฉ ุงูุฃุฎุฑู ุนููุงููู ูุชูุชูู ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ RET.  ุฅุถุงูุฉ ุงูุนูุตุฑ ุงูุซุงูู ูู ุงููุธููุฉ ุงููุทููุจุฉ ุ ูุงูุฃูู ูู ุนููุงู ุนูุตุฑ ุงูุจุฑูุงูุฌ ุงูุฃุณุงุณู ุงูุชุงูู ุงูุฐู ุณูุชู ููู ุงูุงูุชูุงู.  ูุจุงูุชุงูู ุ ูุชู ุฅูุดุงุก ุงูุนูุงุตุฑ ุงูุฃุณุงุณูุฉ ููุจุฑูุงูุฌ ุจุฏูู ูุงุฆูุงุช ุงูุฃุตู. <br><br><img src="https://habrastorage.org/webt/jc/5j/dw/jc5jdw3rbtwezkp4ylemfursggw.png"><br>  <i>ุงูุดูู 4 ุงูุดูู 4. ุชูููุฉ PUSH / JMP</i> <br><br>  ูุชูุฌุฉ ููุฒูุฌ ูู ุงุซููู ูู ุชูููุงุช ุงูุชุนุชูู ุ ูุชู ุงูุญุตูู ุนูู ุงูุฑุณูู ุงูุจูุงููุฉ "ุงูุฌูููุฉ": <br><br><img src="https://habrastorage.org/webt/3l/pe/3x/3lpe3x_ccjdkh9rm0rpxyykztf0.png"><br>  <i>ุงูุดูู 5. ุงูุชุนุชูู ุนูู ุชุณูุณู ุชุดุบูู</i> <br><br>  ููุงุญุธุฉ ุฑูุฒ ุงูุจุฑูุฏ ุบูุฑ ุงููุฑุบูุจ ููู ุฃูุฑ ุจุณูุท ููุบุงูุฉ.  ูููู ุชุฌุงูููุง ูู ุชุญููู ุงูุนููุงุช ุ ุฅุฐุง ููุช ุชุนุฑู ูุฎุทุท ุงูุชุทุจูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุทุงุฑุฉ </h2><br><h3 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 1. ูุซููุฉ ุงูุทุนู </h3><br>  ูู ุงูุฃุดูุฑ ุงูุฃุฎูุฑุฉ ุ ุงุณุชุฎุฏู OceanLotus ุงูุนุฏูุฏ ูู ุงูุณุญุฑ.  ูุงุญุฏ ูููู ูู ุจุฑูุงูุฌ ูุฒูู ูุชุญุฏูุซ ุฎุท TrueType <code>Roboto Slab regular</code> .  ูุจุฏู ุงุฎุชูุงุฑ ุงูุฎุท ุบุฑูุจูุง ุจุนุถ ุงูุดูุก ุ ูุฃูู ูุง ูุฏุนู ุงูุนุฏูุฏ ูู ูุบุงุช ุดุฑู ุขุณูุง. <br><br><img src="https://habrastorage.org/webt/2p/p8/sm/2pp8sm8gjt15kzqakmyooah1pk8.jpeg"><br>  <i>ุงูุดูู 6. ุฃููููุฉ ุชุญุฏูุซ ุฎุท RobototFontUpdate</i> <br><br>  ุนูุฏ ุชูููุฐ ุฐูู ุ ูููู ุงูููู ุงูุซูุงุฆู ุจูู ุชุดููุฑ ููุงุฑุฏู (XOR ุ 128 ุจุงูุช ุ ุงูููุชุงุญ ุงูุซุงุจุช) ูุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ุงูุชู ุชู ูู ุชุดููุฑูุง (LZMA).  ููู RobotoSlab-Regular.ttf ุดุฑุนู <br><br>  (SHA1: <code>912895e6bb9e05af3a1e58a1da417e992a71a324</code> ) ุชูุช ูุชุงุจุชู ุฅูู ุงููุฌูุฏ <code>%temp%</code> ูุชู ุชุดุบููู ุจุงุณุชุฎุฏุงู ูุธููุฉ Win32 API <code>ShellExecute</code> . <br><br>  ูุชู ุชูููุฐ ููุฏ ุงููุดุฑุฉ ุงูุฐู ุชู ูู ุชุดููุฑู ูู ุงูููุงุฑุฏ.  ุจุนุฏ ุงูุชูููุฐ ุ ูููู ุชุญุฏูุซ ุฎุท ุฒุงุฆู ุจุชูููุฐ ุชุทุจูู ุขุฎุฑ ูุฏูู ุงููุญูุฏ ูู ุฅุฒุงูุฉ ุงููุทุงุฑุฉ.  ูุชู <code>%temp%\[0-9].tmp.exe</code> ุชุทุจูู <code>%temp%\[0-9].tmp.exe</code> ูุฐุง ุนูู ุฃูู <code>%temp%\[0-9].tmp.exe</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุฑุญูุฉ ุงูุซุงููุฉ: ููุฏ ุงููุดุฑุฉ </h3><br>  ูู ูู ูุฑุญูุฉ ุ ูุชู ุงุณุชุฎุฏุงู ููุณ ููุฏ ุงููุดุฑุฉ. <br><br>  ููุฏ ุงููุดุฑุฉ ูู ูุญูู PE ูุฎุตุต.  ูููู ุจุงุณุชุนุงุฏุฉ ุงูููู ุงููุงุจู ููุชูููุฐ ูู ุงูุฐุงูุฑุฉ - ูููู ุจูู ุชุดููุฑ ุฌููุน ุงูุฃูุณุงู ูุญุณุงุจ ุงูุญุฑูุงุช ุงููุงุฒูุฉ ูุงููุณุงูุงุช ุงูุจุงุฏุฆุฉ ุงูุฃุฎุฑู.  ูุณุชุฎุฏู <code>RtlMoveMemory</code> ุงููุธุงุฆู ุงูุซูุงุซ ููุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Windows: <code>VirtualAlloc</code> ู <code>RtlMoveMemory</code> ู <code>RtlZeroMemory</code> . <br><br>  <code>RtlZeroMemory</code> ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ <code>RtlZeroMemory</code> ุงูุญููู ูู ุฑุฃุณ PE.  ุณุชูุดู ุงูุงุนุชูุงุฏ ุนูู ุชูุฑูุบ ุฐุงูุฑุฉ ุชููุงุฆู ุ ูุฃู ุฑุคูุณ MZ / PE ุชุงููุฉ. <br>  ูุณุชุฏุนู ููุฏ shell ูุธููุฉ ุชุณุฌูู ุงูุฏุฎูู PE ุบูุฑ ุงููุดูุฑุฉ ุ ุซู <code>DLLEntry</code> ุชุตุฏูุฑ <code>DLLEntry</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุฑุญูุฉ 3. ุงููุทุงุฑุฉ ุงูุญููููุฉ </h3><br> <code>{103004A5-829C-418E-ACE9-A7615D30E125}.dll</code> <br>  ูููู ูุฐุง ุงูุจุฑูุงูุฌ ุงููุงุจู ููุชูููุฐ ุจูู ุชุดููุฑ ุงูููุงุฑุฏ ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ AES ูู ูุถุน CBC ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Windows.  ูุจูุบ ุญุฌู ุงูููุชุงุญ ุงูุซุงุจุช 256 ุจุช.  ุจุนุฏ ูู ุงูุชุดููุฑ ุ ูุชู ูู ุถุบุท ุงูุจูุงูุงุช ุงููุถุบูุทุฉ (ุฎูุงุฑุฒููุฉ LZMA). <br><br>  ุฅุฐุง ุจุฏุฃุช ุงูุนูููุฉ ุจุญููู ุงููุณุคูู ุ ูุฅู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุชููุฑ ุงูุซุจุงุช ูู ุฎูุงู ุฅูุดุงุก ุฎุฏูุฉ.  ูุฅูุง ุ ูุชู ุงุณุชุฎุฏุงู ููุชุงุญ ุงูุชุณุฌูู Run ุงูููุงุณููู ( <code>HKCU\SOFTWARE\Microsoft\ Windows\CurrentVersion\Run;DeviceAssociationService;rastlsc.exe</code> ). <br><br>  ุฅุฐุง ุชู ุชูููุฐ ุฑูุฒ ุงููุทุงุฑุฉ ุจุญููู ุงููุณุคูู ุ ูุฅูู ูุญุงูู ูุชุงุจุฉ ุงููููุงุช ุงููุฏุฑุฌุฉ ุฃุฏูุงู ุฅูู ุงููุฌูุฏ <code>C:\Program Files\Symantec\Symantec Endpoint Protection\12.1.671.4971.104a\DeviceAssociationService\</code> ุ ุฅุฐุง ูู ููู ูุฐูู ุ ููุชุจูุง ุฅูู ุงููุฌูุฏ <code>%APPDATA%\Symantec\Symantec Endpoint Protection\12.1.671.4971.104a\DeviceAssociationService\</code> : <br><br>  - <code>rastlsc.exe</code> (SHA1: <code>2616da1697f7c764ee7fb558887a6a3279861fac</code> ุ ูุณุฎุฉ ูู ุงูุชุทุจูู ุงูุดุฑุนู Symantec Network Access Control ุ <code>dot1xtra.exe</code> ) <br>  - <code>SyLog.bin</code> (SHA1: <code>5689448b4b6260ec9c35f129df8b8f2622c66a45</code> ุ ูุณุชุชุฑ ูุดูุฑ) <br>  - <code>rastls.dll</code> (SHA1: <code>82e579bd49d69845133c9aa8585f8bd26736437b</code> ุ ููู DLL ุถุงุฑ <code>rastlsc.exe</code> ) <br><br>  ูุฎุชูู ุงููุณุงุฑ ูู ุนููุฉ ุฅูู ุฃุฎุฑู ุ ููู ุงูุชุฎุทูุท ูุดุงุจู.  ุจูุงุกู ุนูู ุงูุญููู ุ ุชููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุจุชูุฑูุบ ุงููููุงุช ูู <code>%ProgramFiles%</code> ุฃู <code>%appdata%</code> .  ูุงุญุธูุง ุฃูุถูุง: <br><br>  - <code>\Symantec\CNG Key Isolation\</code> <br>  - <code>\Symantec\Connected User Experiences and Telemetry\</code> <br>  - <code>\Symantec\DevQuery Background Discovery Broker Tasks\</code> <br><br>  ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงููุณุงุฑุงุช ุจูุงุณุทุฉ ููุชุฌุงุช Symantec ุงููุฎุชููุฉ. <br><br>  ุจุนุฏ ุชุญููู ุงููุซุงุจุฑุฉ ูุชูููุฐ ุงูููู ุงููุงุจู ููุชูููุฐ ููู ุดุฑุนู ุ <br>  ูุชู ุชูููุฐ <code>rastlsc.exe</code> ุจุงุณุชุฎุฏุงู <code>CreateProcessW</code> . <br><br>  ูุงุญุธูุง ุฃูุถูุง ุฅุตุฏุงุฑูุง ( <code>{BB7BDEC9-B59D-492E-A4AF-4C7B1C9E646B}.dll</code> ) ูููุฐ <code>rastlsc.exe</code> ุจุงุณุชุฎุฏุงู ูุนููุฉ <code>krv</code> .  ุณููุงูุด ุจูุฒูุฏ ูู ุงูุชูุตูู ุฃุฏูุงู. <br><br><h2 style=";text-align:right;direction:rtl">  ูููู ูุณุชุชุฑ: ููุก rastlsc.exe </h2><br>  ูุณุชุฎุฏู ูุฑูู OceanLotus ุชูููุฉ ูุฏููุฉ ููุนุฑููุฉ ูู ุฃุญุฏ ุงููููุงุช ุงูุชูููุฐูุฉ ูููุชุฌ Symantec.  ุฎูุงุตุฉ ุงูููู ูู ุงุณุชุฎุฏุงู ุนูููุฉ ุชุญููู ููุชุจุฉ ูููู exe ุดุฑุนู ููููุน ุนู ุทุฑูู ูุชุงุจุฉ ููุชุจุฉ ุถุงุฑุฉ ุฅูู ููุณ ุงููุฌูุฏ.  ุณูุฌุนู ูุฐุง ุงูุณููู ุงูุถุงุฑ ูุจุฏู ุดุฑุนููุง ุญูุซ ูุชู ุชูููุฐ ูุฐู ุงูุฅุฌุฑุงุกุงุช ุฃุซูุงุก ุชุดุบูู ุงูููู ุงูุชูููุฐู ุงูููุซูู ุจู. <br><br>  ููุง ุฐูุฑ ุฃุนูุงู ุ ูุชู ุฅุนุงุฏุฉ ุชุนููู ููู <code>rastlsc.exe</code> ุงูุดุฑุนู ูุชูููุฐู. <br>  ูููู ุจุงุณุชูุฑุงุฏ ููู <code>rastls.dll</code> ุ ุงูุฐู ูุญุชูู ูู ูุฐู ุงูุญุงูุฉ ุนูู ูุญุชูู ุถุงุฑ. <br><br><img src="https://habrastorage.org/webt/jy/ga/ax/jygaaxccovxfilcmjrol9rmoklu.jpeg"><br>  <i>ุงูุดูู 7. ููู rastlsc.exe ูููุน ุฑูููุงู ูู Symantec</i> <br><br>  ููุฏ ุฑุฃููุง ุฃูุถูุง ุชุนุจุฆุฉ ุจุงุณุชุฎุฏุงู ูููุงุช ุชูููุฐูุฉ ูุดุฑูุนุฉ ููููุนุฉ ุฃุฎุฑู ุ ุจูุง ูู ุฐูู <code>mcoemcpy.exe</code> ูู McAfee ุ ุงูุฐู ูููู ุจุชุญููู <code>McUtil.dll</code> .  ุชู ุงุณุชุฎุฏุงู ูุฐู ุงูุชูููุฉ ุณุงุจููุง ุจูุงุณุทุฉ PlugX ุ ูุงูุชู ุฌุฐุจุช ุงูุชุจุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชูุงู CERT</a> (ุจุงููุบุฉ ุงูููุชูุงููุฉ). <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุฑุญูุฉ 1. ููุก ุงูููุชุจุฉ ุ rastls.dll </h3><br>  ุงูุงุณู ุงูุฏุงุฎูู ูููู dll ูู <code>{7032F494-0562-4422-9C39-14230E095C52}.dll</code> ุ ููููุง ุฑุฃููุง ุฅุตุฏุงุฑุงุช ุฃุฎุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ <code>{5248F13C-85F0-42DF-860D-1723EEAA4F90}.dll</code> .  ุชุคุฏู ุฌููุน ุงููุธุงุฆู ุงููุตุฏุฑุฉ ุฅูู ุชูููุฐ ููุณ ุงููุธููุฉ. <br><br><img src="https://habrastorage.org/webt/hg/1h/qm/hg1hqmssbsek8-kl8e7dkbzsotq.jpeg"><br>  <i>ุงูุดูู 8. ุชุคุฏู ุฌููุน ุตุงุฏุฑุงุช rasltls.dll ุฅูู ูุธููุฉ ูุงุญุฏุฉ</i> <br><br>  ูุญุงูู ุงูุชุตุฏูุฑ ูุฑุงุกุฉ ููู <code>SyLog.bin</code> ุงูููุฌูุฏ ูู ููุณ ุงููุฌูุฏ.  ุญุงููุช ุฅุตุฏุงุฑุงุช ุฃุฎุฑู ูุชุญ ููู <code>OUTLFLTR.DAT</code> .  ุฅุฐุง ูุงู ุงูููู ููุฌูุฏูุง ุ ูุณูุชู ูู ุชุดููุฑู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ AES ูู ูุถุน CBC ุจุงุณุชุฎุฏุงู ููุชุงุญ 256 ุจุช ูุฑููุฒ ุ ุซู ูุชู ูู ุถุบุท ุงูุจูุงูุงุช ุงููุถุบูุทุฉ ุงููุณุชููุฉ (ุถุบุท LZMA). <br><br>  ูุณุชุฎุฏู ูุชุบูุฑ <code>McUtil.dll</code> ุชูููุฉ ูุฎุชููุฉ.  ูููููุฉ ุงูุฃููู ุ ูุง ุชููู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ุจุฃู ุดูุก ุถุงุฑ ุ ูููููุง ูู ุงููุงูุน ุชุณุชุจุฏู ูุณู <code>mcoemcpy.exe</code> ููููู ุงูุดุฑุนู <code>mcoemcpy.exe</code> ุ ููู ููู ุซูุงุฆู.  ูููู ุจุฅูุดุงุก ููุฏ ูุดุฑุฉ ูููุชู ุงุณุชุฏุนุงุก ูุธููุฉ ููุฑุงุกุฉ ููุฏ ุงููุดุฑุฉ ุงููุดูุฑุฉ ูููุฑุญูุฉ ุงูุซุงููุฉ ูู ููู <code>mcscentr.adf</code> . <br><br>  ูุชู ุงุณุชุฎุฏุงู ุงูููุฏ ุงูุฒุงุฆู ุงูุชุงูู ูุฅูุดุงุก ููุฏ ุงูุตุฏู: <br><br> <code>x = False i = 0 <br> buff = genRandom() <br> opc1 = [0x58,0x59,0x5a,0x5b] <br> opc2 = [0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57] <br> opc3 = [0x90,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48, <br> 0x49,0x4a,0x4b] <br> while i &lt; len(buff): <br> currentChar = buff[i] if currentChar &lt; 0xc8: <br> buff[i] = opc1[currentChar % len(opc1)] <br> else: <br> if x: <br> buff[i] = opc2[currentChar % len(opc2)] <br> else: <br> buff[i] = opc3[currentChar % len(opc3)] x = x == False <br> i+=1</code> <br> <br>  ุฃุฏูุงู ูู ุงูุดูู ุ ููููู ุฑุคูุฉ ูุงุฆูุฉ ุจูุชุงุฆุฌ ุงููุฌูุน: <br><br><img src="https://habrastorage.org/webt/i8/4y/gg/i84yggcraq46pahxx_g5gzha4_y.png"><br>  <i>ุงูุฑูู 9 ุงูุดูู. ููุฏ ุงููุดุฑุฉ ุงูุชู ุชู ุฅูุดุงุคูุง</i> <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฎุทูุงุช 2-4.  Shellcode ููุงุฐูุฉ ู shellcode ูุฑุฉ ุฃุฎุฑู </h3><br>  ูููู <code>{E1E4CBED-5690-4749-819D-24FB660DF55F}.dll</code> ุจูู ุชุดููุฑ ูุชูุฒูู ููุชุจุฉ <code>{E1E4CBED-5690-4749-819D-24FB660DF55F}.dll</code> .  ุชููู ุงูููุชุจุฉ ุจุชุญููู ุงูููุงุฑุฏ ูุชุญุงูู ุจุฏุก ุชุดุบูู ุฎุฏูุฉ DeviceAss AssociationService.  ุชุญุชูู ุงููุนูููุงุช ุงูุชู ุชู ูู ุชุดููุฑูุง ุฃูุถูุง ุนูู ููุฏ ูุดุฑุฉ.  ูุฐุง ุงูุฃุฎูุฑ ููู ุชุดููุฑ ุงููุฑุญูุฉ ุงูููุงุฆูุฉ: ุจุงุจ ุฎููู. <br><br>  <code>{92BA1818-0119-4F79-874E-E3BF79C355B8}.dll</code> ุงููุชุบูุฑ <code>{92BA1818-0119-4F79-874E-E3BF79C355B8}.dll</code> ุฅุฐุง <code>rastlsc.exe</code> ุชูููุฐ <code>rastlsc.exe</code> ุจุงุณุชุฎุฏุงู <code>krv</code> ููุนููุฉ ุฃููู.  ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุชู ุฅูุดุงุก ูููุฉ ุ ููุชู ุชูููุฐ <code>rastlsc.exe</code> ูุฑุฉ ุฃุฎุฑู ุ ูููู ุจุฏูู ูุฐู ุงููุนููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุฑุญูุฉ 5. ุงูุจุงุจ ุงูุฎููู </h3><br> <code>{A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll</code> <br> <br>  ุฃููุงู ุ ุชุญุงูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุชูุฒูู ููุงุฑุฏูุง ููู ุชุดููุฑูุง ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ RC4.  ุชุญุชูู ุงูููุงุฑุฏ ุงููุงุชุฌุฉ ุนูู ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูุชูููู ุงูุจุงุจ ุงูุฎููู.  ุชูุณูู ุงูุชูููู ููุณ ูู ุงูุตุนุจ ุงูุนุซูุฑ ุนููู.  ุจุงุณุชุฎุฏุงู ูููู Kaitai ููุฎูุฏ ููููู ุ ูุญุตู ุนูู ูุง ููู: <br><br><img src="https://habrastorage.org/webt/wv/sq/7r/wvsq7r5rn67px5msvrjogbnoelk.jpeg"><br>  <i>ุงูุดูู 10. ูููู ุงูุชูููู</i> <br><br>  <b>ููุญูุธุฉ</b> : ุจุงุณุชุซูุงุก ุณุทุฑ domain_encoding_str ูููุชุจุฉ httpprov ุ ุชุชุบูุฑ ุงูุจูุงูุงุช ูู ุนููุฉ ุฅูู ุฃุฎุฑู.  ููุงุชูุญ ุงูุชุณุฌูู ูู ููุณูุง ุชูุฑูุจูุง ุ ูููู ููุง ูุฎุทุท ูุดุงุจู: <code>\HKCU\SOFTWARE\Classes\AppX[a-f0-9]{32}</code> ุ ูุง ุดูุก ุฑุงุฆุน. <br><br>  ูุชููู ุงูุจุฑูุงูุฌ ุงูุถุงุฑ ุฃูู 10 ุจุงูุช ูู ุงุณู ุงููุณุชุฎุฏู (UTF-16) ุ <code>mutex_encoding_str</code> ุจุณูุณูุฉ <code>mutex_encoding_str</code> ูู ุซูุงุซุฉ ุฃุญุฑู <code>mutex_encoding_str</code> ูู UTF-16 <code>mutex_encoding_str</code> ุจุงููุธุงู ุงูุณุช ุนุดุฑู.  ูุชู ุงุณุชุฎุฏุงู ุงููุชูุฌุฉ ูุงุณู ูุงุฆู ุงููุฒุงููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ููุณุชุฎุฏู ูุจุฏุฃ ุงุณูู ุจู <code>abc</code> <code>vwx</code> ุนูู ุดูู <code>vwx</code> ุ ุณูููู ูุงุฆู ุงููุฒุงููุฉ <code>\Sessions\1\BaseNamedObjects\170015001b</code> . <br><br>  ูุชุถูู ุงูุจุงุจ ุงูุฎููู ูุญูู PE ูููู ุจุชุญููู ููุชุจุฉ <code>HTTPProv.dll</code> ูู ุงูุฐุงูุฑุฉ ุ ููุณุชุฏุนู ููุทุฉ ุงูุฏุฎูู ุ ุซู ูุณุชุฏุนู ูุธููุฉ ุงูุชุตุฏูุฑ <code>CreateInstance</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชูุงุตู </h3><br>  ูุณุชุฎุฏู ุงูุจุงุจ ุงูุฎููู ุจุฑูุชูููู ุงุชุตุงู TCP ุงูููุงุณู ุนุจุฑ ุงููููุฐ <code>25123</code> .  ููุญุตูู ุนูู ุนููุงู IP ููุฎุงุฏู ุ ูููู ุงูุจุงุจ ุงูุฎููู ุฃููุงู ุจุฅูุดุงุก ุงุณุชุนูุงู DNS ูุญุฏุฏ. <br><br>  ูุญุฏุฏ ุงูุจุฑูุงูุฌ ุงูุถุงุฑ ุฃุญุฏ ุงููุฌุงูุงุช ุงูุซูุงุซุฉ ูู ุงูุชูููู ููุถูู ูุฌุงููุง ูุฑุนููุง ุฎุงุตูุง ูุชู ุฅูุดุงุคู ุจุงุณุชุฎุฏุงู ูููุชูู.  ุงููููุฉ ุงูุฃููู ูู ุงุณู ุงูููุจููุชุฑ ุจุทูู 16 ุจุงูุช.  ูุงูุซุงูู ูู ูุนุฑู ุฅุตุฏุงุฑ ุฑุจุงุนู ุงูุจุงูุช.  ุฑูุฒ Python 2 ุฃุฏูุงู ูู ุฎูุงุฑุฒููุฉ ุชุฑููุฒ: <br><br> <code>letters=domain_encoding_str # โghijklmnopโ hex_pc_name=pc_name.encode(โUTF-16LEโ).encode(โhexโ) s='' <br> for c in hex_pc_name: <br> if 0x2f &lt; ord(c) &lt; 0x3a: <br> s+=letters[ord(c) - 0x30] <br> else: <br> s+=c</code> <br> <br>  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงุณู ุงูููุจููุชุฑ ูู <code>random-pc</code> ุ ููุงู ูุนุฑู ุงูุฅุตุฏุงุฑ 0x0a841523 ุ ูุณูุชู ุฅูุดุงุก ุงููุฌุงู ุงูุชุงูู: <br> <code>niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.dwarduong[.]com</code> <br> <br>  ูููู ุงุณุชุฎุฏุงู ุงูุชุนุจูุฑ ุงูุนุงุฏู ุงูุชุงูู ูุชุณููุฉ ุฎุงุฏู C&amp;C ููุฐุง ุงูุจุงุจ ุงูุฎููู: <br> <code>[ghijklmnopabcdef]{4-60}\.[ghijklmnopabcdef]{8}\.[az]+\.[az]+</code> <br> <br>  ุฅุฐุง ูุงู ุนููุงู IP ููุชูู ุฅูู ูุฌุงู ูุนูู ุ ูุฅู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุชุญุงูู ุฅูุดุงุก ุงุชุตุงู TCP ูู ุฎูุงู ุงููููุฐ <code>25123</code> .  ููู ุนููุฉ ุซูุงุซุฉ ุฃุณูุงุก ูุทุงูุงุช ูุฎุชููุฉ ุชุณุชุฎุฏู ููุนุซูุฑ ุนูู ุฎุงุฏู C&amp;C. <br><br>  ูุชู ุชุดููุฑ ุนูููุฉ ุงูุงุชุตุงู ุนุจุฑ RC4 ูุถุบุทูุง ุจุงุณุชุฎุฏุงู LZMA.  ูู ุงููููู ูู ุชุดููุฑ ุญุฑูุฉ ุงููุฑูุฑ ุ ุญูุซ ูุชู ุฅุถุงูุฉ ุงูููุชุงุญ ุฅูู ุจุฏุงูุฉ ุงูุญุฒู.  ุงูุชูุณูู ููุง ููู: <br> <code>[ RC4 (4 )][ ]</code> <br> <br>  ูุชู ุฅูุดุงุก ูู ุจุงูุช ููุชุงุญ ุจูุงุณุทุฉ ุงูุฏุงูุฉ <code>rand</code> .  ุจุนุฏ ูู ุชุดููุฑ ุงูุญุฒูุฉ ูุชูุฑูุบูุง ุ ุชุญุชูู ุงูุจูุงูุงุช ุนูู ุงูุชูุณูู ุงูุชุงูู: <br> <code>[dw:][dw:][dw: ][dw: ][dw:] [dw:]</code> <br> <br>  ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ูุชุตู ูููุง ุงูุนููู ุจุงูุฎุงุฏู ุ ูุชู ุฅุฑุณุงู UUID ุ ูุงูุฐู ูุณุชุฎุฏู ููุนุฑู ุงูุฌูุณุฉ.  ูุชู ุชุฎุฒูู ูุฐุง ุงูุฃุฎูุฑ ูู ููุชุงุญ ุงูุชุณุฌูู ูุจูุงูุงุช ุซูุงุฆูุฉ: <code>HKCU\SOFTWARE\Classes\ AppXc52346ec40fb4061ad96be0e6cb7d16a\DefaultIcon</code> <br><br>  ููุง ูููุง ุณุงุจููุง ุ ูุญุชูู ุงูุจุงุจ ุงูุฎููู ุฃูุถูุง ุนูู ููุชุจุฉ ุชุณูู <code>HTTPprov</code> .  ูุชู ุงุณุชุฎุฏุงูู ูุทุฑููุฉ ุจุฏููุฉ ููุชูุงุตู ูุน ุงูุฎุงุฏู.  ูุฑุณู ููู DLL ุทูุจ POST ุนุจุฑ HTTP.  ููุง ุฃููุง ุชุฏุนู HTTPS ูุงููููุงุก ุจุงุณุชุฎุฏุงู SOCKS5 ู SOCKS4a ู SOCKS4.  ุชุฑุชุจุท ุงูููุชุจุฉ ุจุดูู ุซุงุจุช ุจู <code>libcurl</code> . <br><br>  ุจุนุฏ ุงูุชููุฆุฉ ุ ุณูุชู ุฅูุดุงุก ุฅุฏุฎุงู ุชุณุฌูู - ุฃูุฑ ููุจุงุจ ุงูุฎููู ูููุงุตูุฉ ุงุณุชุฎุฏุงู HTTP ููุชูุงุตู ูุน ุฎุงุฏู ุงูุฃูุงูุฑ: <code>HKCU\SOFTWARE\Classes\ CLSID{E3517E26-8E93-458D-A6DF-8030BC80528B}</code> . <br><br>  ูุชู ุงุณุชุฎุฏุงู ุชุทุจูู ุงูุนููู ุงูููุงุณู: <code>Mozilla/4.0 ( ; MSIE 8.0; Windows NT 6.0; Trident/4.0)</code> . <br><br>  ุงูุณูุฉ ุงูุฑุฆูุณูุฉ ููุฐู ุงูููุชุจุฉ ูู ุฎูุงุฑุฒููุฉ ุชุดููุฑ ุฎุงุตุฉ ููุนุฑู ููุฑุฏ ุนุงููู.  ูุชู ุฅูุดุงุก ุฌุฒุก ุงูููุฑุฏ ุงูุฎุงุต ุจู URI ุจุงุณุชุฎุฏุงู ุงูููุฏ ุงูุฒุงุฆู ุงูุชุงูู: <br><br> <code>buffEnd = ((DWORD)genRand(4) % 20) + 10 + buff; while (buff &lt; buffEnd){ <br> b=genRand(16); <br> if (b[0] - 0x50 &gt; 0x50) <br> t=0; <br> else <br> *buf++= UPPER(vowels[b[1] % 5]); <br> v=consonants[b[1]%21]); if (!t) <br> v=UPPER(v); <br> *buff++= v; <br> if (v!='h' &amp;&amp; b[2] - 0x50 &lt; 0x50) <br> *buff++= 'h'; <br> *buff++= vowels[b[4] % 5]; <br> if (b[5] &lt; 0x60) <br> *buff++= vowels[b[6] % 5]; <br> *buff++= consonants[b[7] % 21]; <br> if (b[8] &lt; 0x50) <br> *buff++= vowels[b[9] % 5]; <br> *buff++= '-'; <br> }; <br> *buff='\0';</code> <br> <br>  <b>ููุงุญุธุฉ</b> : ููุชูุถูุญ ุ ุชูุช ุฅุฒุงูุฉ ุงูุฌุฒุก ุงููุณุคูู ุนู ุงูุชุญูู ูู ุทูู ุงูุณูุณูุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. <br><br>  ููุญุตูู ุนูู ุงููุนุฑู ูู ุงูุณูุณูุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ุ ุชุชู ุฅุถุงูุฉ ุฑูููู ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุงูุชุญูู ูู ุงููุฌููุน ุงูุฎุงุตุฉ: <br><br> <code>checksum=crc32(buff) <br> num2=(checksum &gt;&gt; 16) + (checksum &amp; 0xffff) * 2 <br> num1=(num2 ^ 1) &amp; 0xf <br> URL=GENERATED_DOMAIN+ โ/โ + num1 + โ/โ + num2 + โ-โ + buff</code> <br> <br>  ุจุฅุถุงูุฉ <code>HTTPprov</code> URI ููุชุจุฉ <code>HTTPprov</code> ุ ูุญุตู ุนูู URL ุงูุชุงูู: <br> <code>hXXp://niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.aisicoin[.]com/ 13/139756-Ses-Ufali-L</code> <br> <br><h3 style=";text-align:right;direction:rtl">  ุงููุฑู </h3><br>  ุจุนุฏ ุชููู ูุนุฑูู ุงูุฌูุณุฉ SESSIONID ุ ูููู ุงูุจุงุจ ุงูุฎููู ุจุนูู ุจุตูุฉ ุงููุธุงู.  ูุชู ุฅูุดุงุก ุงูุญุฒูุฉ ุนูู ุงููุญู ุงูุชุงูู (ูุณุงูุฉ ุจุงุฏุฆุฉ ูู ุงูุญุฒูุฉ - ุงููุตู): <br><br>  <i>0x000</i> ุจุงูุช: ุชุชุบูุฑ ุงููููุฉ ูู ูู ุฅุตุฏุงุฑ <br>  <i>0x001</i> - 0x01: ุจุงูุช ูุดูุฑ <br>  <i>0x002</i> - ููุทูู: ุงูุชูุงุฒุงุช ูุฑุชูุนุฉ <br>  <i>0x003</i> - ุงููููุฉ ุงููุฒุฏูุฌุฉ: ูุนุฑู ุงูุฅุตุฏุงุฑ <br>  <i>0x007</i> - ุณูุณูุฉ (UTF-16) ุ ุงุณู ุงูููุจููุชุฑ (ุจุญุฏ ุฃูุตู 0x20) <br>  <i>0x027</i> - ุงูุณูุณูุฉ (UTF-16) ุ ุงุณู ุงููุณุชุฎุฏู <br>  <i>0x079</i> - ูุชูุฌุฉ ุงุณุชุนูุงู ุงูุชุณุฌูู ูู ููู <code>CurrentBuildNumber</code> <code>CurrentVersion</code> <code>HKLM\SOFTWARE\Microsoft\Windows NT\ CurrentVersion</code> : <code>ProductName</code> ู <code>CSDVersion</code> ู <code>CurrentVersion</code> ู <code>CurrentBuildNumber</code> ู <code>CurrentBuildNumber</code> ููุชูุฌุฉ ุงุณุชุฏุนุงุก <code>IsWow64Process (x86|x64)</code> <br>  <i>0x179</i> - ุงูุชูุณูู ุงููุงุญู ููุณูุณูุฉูช s (ูช s) ุ  ุชู ุงุณุชุจุฏุงููุง ุจู ( <code>GetVolumeInformationW:VolumeNameBuffer</code> ) ุ <code>VolumePathNames</code> <br>  <i>0x279</i> - ุงููุฑุต ุงููุนูู ูุงูุชุญูู ูู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูุฌูุงุฒ PhysicalDrive IOControl 0x2D1400 (IOCTL_STORAGE_QUERY_ PROPERTY) (VolSerialNumber) <br>  <i>0x379</i> - wmi <code>SELECT SerialNumber FROM Win32_BaseBoard</code> <br>  <i>0x3f9</i> - ุงุญุตู ุนูู ุงูุชุงุฑูุฎ ูุงูููุช ุงูุญุงูููู GetSystemTimeAsFileTime <br>  <i>0x400</i> - ููุทูู: ุบูุฑ ูุนุฑูู <br>  <i>0x401</i> - dword: ุชู ุงุณุชูุงูู ุจุนุฏ ูู ุชุดููุฑ ุงูููุฑุฏ <br><br>  ูููุง ููู ูุซุงู ูุจุตูุฉ ุงููุธุงู: <br><br><img src="https://habrastorage.org/webt/s5/kg/rj/s5kgrj1nop52oeuj-xgop8c7zsa.jpeg"><br>  <i>ุดูู 11. ุจุตูุฉ ุงููุธุงู</i> <br><br>  ูุฐุง ูู ุจุงุจ ุฎููู ูุงูู ูููุฑ ููุดุบููู ุนุฏุฏูุง ูู ุงูููุฒุงุช: ูุนุงูุฌุฉ ุงูููู ุ ูุงูุชุณุฌูู ูุงูุนูููุงุช ุ ูุชูุฒูู ููููุงุช ุฅุถุงููุฉ ุ ูุงูุญุตูู ุนูู ุจุตูุฉ ุฑูููุฉ ูููุธุงู.  ูููุง ููู ุฃุฑูุงู ูุฃูุตุงู ุงูุฃูุงูุฑ ุงููุฏุนููุฉ: <br><br>  0 - ุจุตูุฉ ุฑูููุฉ <br>  1 - ูุญุฏุฏ ุฑูู ุงูุฌูุณุฉ <br>  2 - ุฅูุดุงุก ุนูููุฉ ูุงูุญุตูู ุนูู ูุชูุฌุฉ (ุจุงุณุชุฎุฏุงู ูููุงุช ุงูุจุฑูุงูุฌ) <br>  3 - ุถุจุท ุนุฏุงุฏ ูุญุงููุงุช ุงูุงุชุตุงู <br>  4- ุชุฃุฌูู ููุช ุงูุงูุชุฑุงุน <br>  5 - ููุฑุฃ ููู ุฃู ููุชุงุญ ุงูุชุณุฌูู ููุนุชุจุฑ MD5 <br>  6 - ุฎูู ุนูููุฉ <br>  7 - ุฅูุดุงุก ููู ุฃู ุฅุฏุฎุงู ุชุณุฌูู ุฃู ุฏูู ูู ุงูุฐุงูุฑุฉ <br>  8 - ููุชุจ ุนูู ุงูุชุณุฌูู <br>  9 - ุงุณุชุทูุงุนุงุช ุงูุฑุฃู <br>  10- ุงูุจุญุซ ุนู ุงููููุงุช ูู ุงููุธุงู <br>  11- ูููู ุงููููุงุช ุฅูู ุฏููู ุขุฎุฑ <br>  12- ูุฒูู ุงููููุงุช ูู ุงููุฑุต <br>  13- ุงูุญุตูู ุนูู ูุงุฆูุฉ ุจุงูุฃูุฑุงุต ุงููููุฒุฉ ูู ุงููุธุงู ุจุงุณุชุฎุฏุงู ุงููุธููุฉ <br> <code>GetLogicalDriveStringW</code> <br>  14 - ูููู ุจุฅูุดุงุก ุฏููู <br>  15- ูุฒูู ุงูุฏููู <br>  16 - ููุฑุฃ ุงูููู ูู ุงูุฅุฒุงุญุฉ <br>  17 - ุงุณุชุฏุนุงุก ูุญูู PE (ุงูุชุจุฏูู ุฅูู ุงูุงุชุตุงู ุนุจุฑ <code>HTTPprov</code> ) <br>  18 - [ุบูุฑ ูุนุฑูู] <br>  19 - 0: ุงูุชุฑุงุน ุงููููุฉ ูู ุงูุชุณุฌูู ุ  1: ุชูููุฐ ุงูุจุฑูุงูุฌ ูุชูููุฐู <br>  20 - ูุญุฏุฏ ูุชุบูุฑ ุงูุจูุฆุฉ <br>  21 - ูุทูู ููุฏ ุงููุดุฑุฉ ูู ุฎูุท ุฌุฏูุฏ <br>  22 - ุฅุฑุฌุงุน ูุชุบูุฑ ุงูุจูุฆุฉ <br>  23 ูู ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ - ูุนูุฏ ุชุดุบูู ููุณู ุฅุฐุง ูุงู ูุชุบูุฑ ุจูุฆุฉ APPL ุบูุฑ ููุฌูุฏ <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h2><br>  ูุง ูุฒุงู OceanLotus ูุดุทูุง ููุบุงูุฉ ูููุงุตู ุชุญุฏูุซ ูุฌููุนุฉ ุงูุฃุฏูุงุช. <br>  ุชุณุนู ุงููุฌููุนุฉ ูุฅุฎูุงุก ุฃูุดุทุชูุง ุ ูุฐูู ูููู ุงูููุงุฌููู ุจุชุญุฏูุฏ ุงูุถุญุงูุง ุจุนูุงูุฉ ุ ูุงูุญุฏ ูู ุงูุชุดุงุฑ ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุ ูุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุงูุฎูุงุฏู ุญุชู ูุง ุชููุช ุงูุงูุชุจุงู ุฅูู ููุณ ุงููุฌุงู ุฃู ุนููุงู IP.  ุฅู ูู ุชุดููุฑ ุงููููู ุงูุฌุงุฑู ุชูููุฐู ูุชูููุฉ ุงูุชุญููู ุงูุฌุงูุจู ุ ุนูู ุงูุฑุบู ูู ุดุนุจูุชู ูุงุณุนุฉ ุงูุงูุชุดุงุฑ ุ ุชุฌุนู ูู ุงููููู ุชุฌูุจ ุงููุดู ุ ูุฃู ุนูู ุงูููุงุฌููู ูู ูุฐู ุงูุญุงูุฉ ูุชุฎูู ูุชุทุจูู ูุดุฑูุน. <br><br><h2 style=";text-align:right;direction:rtl">  ูุคุดุฑุงุช ุงูุชุณููุฉ (IoCs) </h2><br><h3 style=";text-align:right;direction:rtl">  ุนููุงุช </h3><br><h4 style=";text-align:right;direction:rtl">  ุงูุฌุฏูู 1: ุงููุทุงุฑุฉ </h4><br><img src="https://habrastorage.org/webt/4z/vz/kh/4zvzkhbbyci_fp6w6jyedbpn42i.png"><br><br><h4 style=";text-align:right;direction:rtl">  ุงูุฌุฏูู 2: ุงูููุชุจุงุช </h4><br><img src="https://habrastorage.org/webt/0g/9i/2r/0g9i2rys-bufj_lmi9xqb7orl3g.png"><br><br><h3 style=";text-align:right;direction:rtl">  ุดุจูุฉ </h3><br><h4 style=";text-align:right;direction:rtl">  ุนูุงููู IP </h4><br> <code>46.183.220.81 <br> 46.183.220.82 <br> 46.183.222.82 <br> 46.183.222.83 <br> 46.183.222.84 <br> 46.183.223.106 <br> 46.183.223.107 <br> 74.121.190.130 <br> 74.121.190.150 <br> 79.143.87.230</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar421779/">https://habr.com/ru/post/ar421779/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar421765/index.html">ูุง ูู ุชุทุจูู ุงูููุจ ูู ุงูุฅูุชุงุฌุ</a></li>
<li><a href="../ar421767/index.html">ูุชู ุนุฑุถ ุนูุงู ุงูููุงุฌู ูุฅุนุทุงุก ุญุงูุฉ ุงูุนุงูููู ูุญุณุงุจูู ุงูุฎุงุต</a></li>
<li><a href="../ar421769/index.html">ูุชุงุจ "ุงูุชุนูู ุงูุนููู ุนูู R"</a></li>
<li><a href="../ar421773/index.html">ุนูุฏูุง ุฃูุดุฃ ูุฑูู ูู ุงูุชููููู ุดุฑูุชูู ุ ุงูููุณู 3 (ุญููุช ุฃุฎูุฑูุง!)</a></li>
<li><a href="../ar421775/index.html">ุชู ุชุฏุฑูุจ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุนูู ุงูุชุนุฑู ุนูู ุงูุงูุชุฆุงุจ ุนู ุทุฑูู ุงูููุงู ุงูุชุนุณูู ูุดุฎุต ุจุฏูู ุณูุงู</a></li>
<li><a href="../ar421783/index.html">ุฅุทุงุฑ ุฅุฏุงุฑุฉ ุงูุฏููุฉ ุงููุฑุญ Huex</a></li>
<li><a href="../ar421785/index.html">ูุงููููุฑููุง ุนูู ูุดู ุงูุฑูุถ ุงูุชุงู ูููุฑุจูู ูู ุฅูุชุงุฌ ุงูุทุงูุฉ</a></li>
<li><a href="../ar421787/index.html">ุชุทููุฑ ููุฏุณุฉ ุงููุดุฑูุน ูุงูุณูู ูุฌุงูุง ุณูุฑูุจุช</a></li>
<li><a href="../ar421789/index.html">ุฌุนู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ "ุงูุฎูููุฉ" ูุฑุฉ ุฃุฎุฑู</a></li>
<li><a href="../ar421791/index.html">ุงููุถุงูุง ุงูุฃุฎูุงููุฉ ููุฐูุงุก ุงูุงุตุทูุงุนู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>