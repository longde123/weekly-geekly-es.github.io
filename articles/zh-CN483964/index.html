<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤳🏼 🛵 🤞🏻 不要担心JSON或您的第一个API应用程序 👨🏾‍💻 👩🏾‍🎨 🤱🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我有大约8年的代码采摘经验。 在这段时间里，我设法在不同方向上尝试了许多不同的语言和技术：从PHP Devel Studio上各种网络钓鱼笑话的“开发”到现代框架上成熟的Web应用程序和神经网络上的软件。 顺便说一下，由于这个职位，我第一次沉迷于编程是在12岁。 现在，我进入了计算机科学学士学位的第...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>不要担心JSON或您的第一个API应用程序</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483964/">我有大约8年的代码采摘经验。 在这段时间里，我设法在不同方向上尝试了许多不同的语言和技术：从PHP Devel Studio上各种网络钓鱼笑话的“开发”到现代框架上成熟的Web应用程序和神经网络上的软件。 顺便说一下，由于<a href="https://habr.com/ru/post/120975/">这个</a>职位，我第一次沉迷于编程是在12岁。 现在，我进入了计算机科学学士学位的第二年。 直到最近，也就是直到第一年，很长时间以来，每次看到JSON这个词时，我总是很害怕。 理解和理解。 但是我注意到，我小组中的许多人仍然无法使用任何API。 我喜欢那些文章的作者，他们在其中详细解释了他的主题，并附上了代码片段，并嚼碎了为什么和为什么决定这样做，并且不会陷入复杂的术语和技术中。 在本文中，我将描述API的用法（以PUBG API为例），就像他们所说的那样，用一个简单的词来表示新手，不要胡说八道。 走吧 <br><br><img src="https://i.playground.ru/p/4YD4zwcTGEkm0nnz-x2D3w.jpeg" alt="图片"><br><a name="habracut"></a><br><h4> 谷歌合作 </h4><br> 要完成本文，您将需要最少的Python知识。 所谓“最小”，是指印刷各种表格和字典。 我们将在Google合作环境（以下简称为“ colab”）中工作。  Colab是一个免费的浏览器环境，聪明的人可以在其中使用人工智能训练和测试他们的程序，并进行各种研究。 但是现在对我们来说无关紧要，我们对在那里编写代码的格式感兴趣：那里的执行文件称为“笔记本电脑”（英文-笔记本）。 以这种格式，可以直接在浏览器中编写和执行代码段（colab中的一段代码称为“代码单元”）。 <br><br> 让我们尝试： <br><br><ol><li>  <u>我们转到</u> <a href="http://colab.research.google.com/">Google Colab</a>并使用您的Google帐户<u>登录</u> </li><li> 主页面将为您提供有关如何使用Colab的帮助，我们将通过单击左上角的File&gt; New Python 3 notebook <u>创建</u>我们的第一台笔记本电脑 <br><br> 几秒钟后，我们应该看到类似于以下内容： <br><br><img src="https://habrastorage.org/webt/6j/5g/sb/6j5gsbx9n_lanr4gm2jvrao4igu.png"></li><li>  <u>记住</u>以下键盘快捷键： <br>  <b>Ctrl + Enter（对于MacOS为Cmd + Enter）</b> -运行当前代码单元 <br>  <b>ALT + Enter（对于MacOS为Option + Enter）</b> -运行当前代码单元，创建并转到新的代码单元 <br></li></ol><br> 在代码单元中，您可以立即编写常规的python代码。 如果要执行某些控制台命令，则在该行之前插入一个感叹号，例如： <br><br>  <b>Python代码</b> <br><br><pre><code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'Hello, PUBG!'</span></span>)</code> </pre> <br>  <b>控制台团队</b> <br><br><pre> <code class="python hljs">!mkdir hello_pubg !cd hello_pubg</code> </pre><br> 让我们尝试执行某种简单的算法，例如，找到两个数字的最大公约数： <br><br><ol><li> 在代码单元格中，我们输入： <br><br><pre> <code class="python hljs">a = <span class="hljs-number"><span class="hljs-number">10</span></span> b = <span class="hljs-number"><span class="hljs-number">8</span></span></code> </pre><br></li><li> 按Alt + Enter（对于MacOS为Option + Enter），然后输入新的代码单元格： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> a != <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> b != <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> a &gt; b: a %= b <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: b %= a gcd = a + b</code> </pre><br></li><li> 再次按Alt + Enter（对于MacOS是Option + Enter），然后在新的代码单元中输入： <br><br><pre> <code class="python hljs">print(gcd)</code> </pre><br> 然后按Ctrl + Enter（对于MacOS是Cmd + Enter）。 我们得到答案： <b>2</b> <br><br><img src="https://habrastorage.org/webt/qr/gr/ai/qrgraienmymje7jyuau1zd4s8h0.png"><br></li></ol><br> 如您所见，在Colab中工作非常简单，在这里测试将来应用程序的某些功能非常方便。 顺便说一句，如果要使用其他数字执行该算法，则需要更改第一个代码单元中变量的值，启动它，然后启动第二个，然后启动第三个。 <br><br> 我们没有关闭笔记本电脑，让我们走得更远。 <br><br><h4>  PUBG API </h4><br> 简单来说，什么是API。 每次我们访问某个网站时，该网站的服务器都会用HTML代码进行响应，例如，通过转到google.com，Google服务器会将HTML发送到我们的浏览器，由浏览器本身进行处理，并且浏览器向我们展示了一个漂亮的处理了所有样式的图片等。 但这并不总是会发生，例如，通过<a href="https://samples.openweathermap.org/data/2.5/forecast%3Fid%3D524901%26appid%3Db1b15e88fa797225412429c1c50c122a1">此</a>链接，我们将看到与print（）命令在python中的字典输出类似的内容。 就是这样 这是我们从<a href="https://openweathermap.org/">openweathermap</a>获得的当前天气信息的字典。 一个人永远不会自己处理来自服务器的此类响应。 该站点的开发人员已向我们提供了此类链接，以便我们可以在程序中使用它们。 通常，如果需要在我们的网站或应用程序上进行天气阻止，则可以转到openweathermap（或提供API的任何其他类似物），打开其文档并使用它。 解码和翻译成俄语的API听起来像“应用程序编程接口”，即<a href="http://site.com/request">site.com/request</a>形式的请求的集合，这些请求返回包含我们所需信息的字典。 这些字典的格式称为JSON。 还有一种XML格式，但是在本文中我们将不对其进行分析。 <br><br> 首先，我写道我们将使用游戏PUBG开发人员的<a href="https://developer.pubg.com/">官方API</a> 。 让我们开始吧。  <a href="https://pubg.op.gg/">这是</a>我们用来验证获得的阵型<a href="https://pubg.op.gg/">的资源</a> ，在新选项卡中将其打开，然后在搜索玩家的过程中输入任何玩家的昵称，例如“ Twitch_todol”。 该玩家的统计信息将打开： <br><br><img src="https://habrastorage.org/webt/pz/t-/pf/pzt-pfr7mlq5okdsj-rulpw4czg.png"><br><br> 我们打开他的最后一场比赛（列表中的第一场），然后查看我们需要的所有信息： <br><br><img src="https://habrastorage.org/webt/et/-w/xz/et-wxz0tdlxgkgfulxl_jme8lls.png"><br><br> 要从PUBG API获取有关此匹配项的信息： <br><br><ol><li>  <u>我们转到</u> <a href="https://developer.pubg.com/">PUBG开发人员</a>的官方<a href="https://developer.pubg.com/">页面</a> 。 <br></li><li> 通过单击“获取您自己的API密钥”按钮<u>登录或注册</u>页面。 我们是否玩这个游戏都没关系。 我们只需要从此站点获取我们的令牌，即api密钥。 <br><br> 每次使用PUBG服务器获取任何信息时，我们都需要为其提供唯一的令牌。 这样做有多种原因，最明显的是，游戏开发人员可以知道谁确切地从服务器接收信息，并对每个程序员进行限制。 在这种情况下，我们有一个限制-每分钟最多10个请求。 这对我们来说绰绰有余。 <br></li><li>  <u>我们创建应用程序并获取令牌</u> <br><br><img src="https://habrastorage.org/webt/yo/p-/pd/yop-pdfj4ikh5qguog9vpyefjfe.png"><br><br> 目前，我们在此处输入的内容并不重要。 我们单击“创建”应用程序，然后看到一长串与此类型有关的字符（使用您自己的字符，此字符不起作用）： <br><br><pre> <code class="python hljs">eyJ0eXAiOiJKV1QiLWFeCJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI5ZjIwYTJkMC0xMzYwLTAxMzgtZTFhYS03ZDVjOWM4YTdjZWUiLCJpc3MiOiJnYW1lbG9ja2VyIiwiaWF04IjoxNTc4MzkwNDQwLCJwdWIiOiJibHVlaG9sZSIsInRpdGxlIjoicHViZyIsImFwcCI6ImxlYW5jb3JlZ2ctZ21hIn0.fwFwEeEw3OghE8sACAHbpKWlJFBVo6F_DbB7dbanybLIIToJc4</code> </pre><br></li><li>  <u>复制令牌</u>并使用colab打开标签。 您没有关闭它，对吗？ <br></li><li> 在第一个代码单元格中，我们输入以下代码： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests url = <span class="hljs-string"><span class="hljs-string">"endpoint-url"</span></span> API_KEY = <span class="hljs-string"><span class="hljs-string">'&lt; &gt;'</span></span> header = { <span class="hljs-string"><span class="hljs-string">"Authorization"</span></span>: <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span> + API_KEY, <span class="hljs-string"><span class="hljs-string">"Accept"</span></span>: <span class="hljs-string"><span class="hljs-string">"application/vnd.api+json"</span></span> }</code> </pre><br> 快跑 在这段代码中，我们创建了一个字典（标头），其中包含用于访问PUBG API的基本参数。 每当我们要从字典中获取某些信息时，我们都会将其发送到服务器。 有条件地，我们告诉服务器“您好，我的名字是Petya，”-Petya是我们的令牌-“我想以JSON格式接收来自您的信息！” 我从本页的PUBG API文档中获得了刚刚给您的代码。 <br></li><li> 现在我们需要告诉我们到底需要从服务器那里得到什么。 在我们的案例中，我们想从他那里获得Twitch_todol玩家的最后一场比赛。 有关播放器的信息，请在以下位置提出要求 <br>  <a href="https://api.pubg.com/shards/steam/players%3Ffilter">api.pubg.com/shards/steam/players?filter</a> [playerNames] = Twitch_todol <br><br> 那就是（在新的代码单元中）： <br><br><pre> <code class="python hljs">player_name = <span class="hljs-string"><span class="hljs-string">'Twitch_todol'</span></span> r = requests.get(<span class="hljs-string"><span class="hljs-string">'https://api.pubg.com/shards/steam/players?filter[playerNames]='</span></span> + player_name, headers=header) player = r.json()</code> </pre><br> 在第二行中，我们使用请求库中的函数，其中第一个参数是服务器需要的参数，第二个参数是标头字典。 换句话说，我们对服务器说：“您好，我是Petya！ 我想从您那里获得有关JSON格式的Twitch_todol播放器的信息。 <br><br> 在第三行中，我们将服务器的响应转换为相同的JSON。 我们为什么要这样做？ 事实是服务器不会向我们返回json响应，而是将json转换为字符串。 并使用.json（）方法，将这种字符串转换为Python可以理解的字典。 <br><br> 让我们通过编写新的代码单元格来确保这一点： <br><br><pre> <code class="python hljs">type(player)</code> </pre><br> 答案是<b>字典</b> 。 也就是说，现在我们可以肯定地知道player变量包含一个字典，Python可以理解该字典并提供有关播放器的信息。 <br></li><li> 这本词典到底包含什么？ 让我们来看看 <br><br><pre> <code class="python hljs">player.keys()</code> </pre> <br> 我们看到了答案： <br><br>  <b>dict_keys（['数据'，'链接'，'元']）</b> <br><br> 这些是我们字典的键。 每个<a href="https://documentation.pubg.com/en/players-endpoint.html">页面</a>包含的内容都写在<a href="https://documentation.pubg.com/en/players-endpoint.html">此页面上</a> 。 <br><br> 为了确保获得所需的播放器，我们将编写以下内容： <br><br><pre> <code class="python hljs">player[<span class="hljs-string"><span class="hljs-string">'data'</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'attributes'</span></span>]</code> </pre> <br> 在这里，我们看到有关玩家的基本信息：他的注册时间，昵称，在哪个平台上玩游戏等等。 <br></li><li> 我们需要获取他的上一场比赛的ID，我们可以通过pubg.op.gg网站进行验证，该网站已经在我们的浏览器标签中打开。 为此，我们写： <br><br><pre> <code class="python hljs">player[<span class="hljs-string"><span class="hljs-string">'data'</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'relationships'</span></span>][<span class="hljs-string"><span class="hljs-string">'matches'</span></span>][<span class="hljs-string"><span class="hljs-string">'data'</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'id'</span></span>]</code> </pre> <br> 我们得到的内容类似于“ ca2c453b-649a-4556-b768-66b9e01aae63”（您可能会有所不同，因为在阅读本文时，该玩家可能已经玩了几次比赛）。 用你得到的东西。 我举一个例子，以免引起您的困惑。 <br><br> 因此，我们知道了比赛的ID，现在让我们获取有关比赛的信息，为此，我们创建了一个变量match_id，它等于我们收到的ID。 并且我们在稍微不同的地址处发出请求，但是按照通常的方案，即： <br><br><pre> <code class="python hljs">match_id = player[<span class="hljs-string"><span class="hljs-string">'data'</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'relationships'</span></span>][<span class="hljs-string"><span class="hljs-string">'matches'</span></span>][<span class="hljs-string"><span class="hljs-string">'data'</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'id'</span></span>] <span class="hljs-comment"><span class="hljs-comment"># id  r = requests.get('https://api.pubg.com/shards/steam/matches/' + match_id, headers=header) match = r.json()</span></span></code> </pre><br></li><li>  match变量，它是一个字典，包含有关该匹配的所有信息。 首先，我们将获得本场比赛所有球员的表现： <br><br><pre> <code class="python hljs">match_players = [item <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> match[<span class="hljs-string"><span class="hljs-string">'included'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item[<span class="hljs-string"><span class="hljs-string">'type'</span></span>] == <span class="hljs-string"><span class="hljs-string">'participant'</span></span>] match_players</code> </pre><br> 在这种情况下，我们填写玩家列表（match_players），并进行字典匹配['included']（“ included”是字典词典的键，其中包含比赛中所有玩家的指示符），同时检查键“ type”的值。 我们为什么要检查 <br>  match ['included']包含玩家信息吗？ 事实并非完全如此，比赛['included']还包含有关这些球员参加过的球队的信息（即项目['type']可以等于“花名册”）。 也就是说，match ['included']看起来像这样： <br><br>  [玩家，团队，团队，玩家，玩家，玩家，团队，...] <br><br> 尚不清楚为什么开发人员决定这样做，但这并没有以任何方式困扰我们。 <br><br> 因此，我们获得了球员的表现，但是我们对其他球员在这场比赛中的表现并不特别感兴趣，我们将看看球员Twitch_todol在这场比赛中的表现。 为此，我们执行： <br><br><pre> <code class="python hljs">my_player_stats = [item <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> match_players <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item[<span class="hljs-string"><span class="hljs-string">'attributes'</span></span>][<span class="hljs-string"><span class="hljs-string">'stats'</span></span>][<span class="hljs-string"><span class="hljs-string">'name'</span></span>] == player_name][<span class="hljs-number"><span class="hljs-number">0</span></span>] my_player_stats</code> </pre><br></li></ol><br> 比较结果统计信息： <br><br><img src="https://habrastorage.org/webt/gh/e9/co/ghe9coifaj8qxnxtuarl4kimplo.png"><br><br> 有关pubg.op.gg的统计信息 <br><br><img src="https://habrastorage.org/webt/ow/06/ns/ow06nsd9ktlikztmdirje4agd6c.png"><br><br> 我们看到一切都是一致的。 欢喜！ 顺便说一句，在我写这篇文章的时候，我们的英雄已经设法打了几场比赛，所以上面我给出的一些屏幕截图可能并不相同。 <br><br><h4> 完成时间 </h4><br> 在本文中，我想告诉最小的程序员，您不必担心JSON和API这两个词，它们可以方便，清晰地实现并且每个文档都附带有文档。 我试图用最易用的语言来解释这一点，而不使用复杂的术语。 <br><br> 同时，我还要感谢Habr和作者（ <a href="https://habr.com/ru/users/arhmax/" class="user_link">ArhMax</a> ）帮助我8年来第一次编写代码。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN483964/">https://habr.com/ru/post/zh-CN483964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN483944/index.html">如何以及为什么在两个堆栈上排队</a></li>
<li><a href="../zh-CN483946/index.html">GPU绑定。 第二部分 无尽的森林</a></li>
<li><a href="../zh-CN483954/index.html">[公告] 1月底的《 Global Game Jam 2020》</a></li>
<li><a href="../zh-CN483956/index.html">[公告] 2020年全球游戏果酱</a></li>
<li><a href="../zh-CN483958/index.html">2020年您需要了解的15种使用数组的JavaScript方法</a></li>
<li><a href="../zh-CN483972/index.html">如何使用Quora促进您的业务</a></li>
<li><a href="../zh-CN483974/index.html">通过iSCSI进行的Ceph-或站在吊床上滑雪</a></li>
<li><a href="../zh-CN483976/index.html">2020年的网络安全和威胁：假期过后我们等待着什么</a></li>
<li><a href="../zh-CN483978/index.html">了解2020年现代Web App开发的概念</a></li>
<li><a href="../zh-CN483980/index.html">创建容错IT基础架构。 第1部分-准备部署oVirt 4.3集群</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>