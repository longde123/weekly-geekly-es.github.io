<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๏ธ ๐ฅ ๐จ๐ฟโ๐คโ๐จ๐ผ ุญุฒูุฉ R tidyr ููุธุงุฆููุง ุงูุฌุฏูุฏุฉ pivot_longer ู pivot_wider ๐๏ธ ๐คพ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุญุฒูุฉ tidyr ูู ุฌุฒุก ูู ุฌููุฑ ุฅุญุฏู ุงูููุชุจุงุช ุงูุฃูุซุฑ ุดุนุจูุฉ ูู ุงููุบุฉ R - tidyverse . 
 ุงูุบุฑุถ ุงูุฑุฆูุณู ูู ุงูุญุฒูุฉ ูู ุฌูุจ ุงูุจูุงูุงุช ุฅูู ูุธูุฑ ุฃููู. 


 ููุฌุฏ ุนูู Ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุญุฒูุฉ R tidyr ููุธุงุฆููุง ุงูุฌุฏูุฏุฉ pivot_longer ู pivot_wider</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444622/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุญุฒูุฉ <strong>tidyr</strong> ูู ุฌุฒุก ูู ุฌููุฑ ุฅุญุฏู ุงูููุชุจุงุช ุงูุฃูุซุฑ ุดุนุจูุฉ ูู ุงููุบุฉ R - <strong>tidyverse</strong> . <br>  ุงูุบุฑุถ ุงูุฑุฆูุณู ูู ุงูุญุฒูุฉ ูู ุฌูุจ ุงูุจูุงูุงุช ุฅูู ูุธูุฑ ุฃููู. </p><br><p style=";text-align:right;direction:rtl">  ููุฌุฏ ุนูู Habrรฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุดูุฑ</a> ูุฎุตุต ููุฐู ุงูุญุฒูุฉ ุ ููููู ูุนูุฏ ุฅูู ุนุงู 2015.  ูุฃุฑูุฏ ุฃู ุฃุฎุจุฑูู ุนู ุฃูู ุงูุชุบููุฑุงุช ุฐุงุช ุงูุตูุฉ ุงูุชู ุฃุนูู ุนููุง ูุคูููุง ูุงุฏูู ููููุงู ูุจู ุจุถุนุฉ ุฃูุงู. </p><br><img src="https://habrastorage.org/getpro/habr/post_images/21a/cf9/6f5/21acf96f56c9b005b125708f5b122a2b.png" alt="ุตูุฑุฉ"><br><blockquote style=";text-align:right;direction:rtl"> <b>SJK</b> : <b>ูู</b> ุณูุชู ุฅููุงู ูุธุงุฆู ุงูุชุฌููุน () ูุงูุงูุชุดุงุฑ ()ุ <br><br>  <b>ูุงุฏูู ููููุงู</b> : ุฅูู ุญุฏ ูุง.  ุณูุชููู ุนู ุงูุชูุตูุฉ ุจุงุณุชุฎุฏุงู ูุฐู ุงููุธุงุฆู ุ ูุชุตุญูุญ ุงูุฃุฎุทุงุก ูููุง ุ ููููุง ุณุชุธู ููุฌูุฏุฉ ูู ุงูุญุฒูุฉ ูู ุงูุญุงูุฉ ุงูุญุงููุฉ. </blockquote><a name="habracut"></a><br><h2 id="soderzhanie" style=";text-align:right;direction:rtl">  ูุญุชูู </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููู TidyData</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงู ุงูุฑุฆูุณูุฉ ุงููุฏุฑุฌุฉ ูู ุญุฒูุฉ tidyr</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููู ุฌุฏูุฏ ูุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ูุงุณุน ุฅูู ุตูุบุฉ ุทูููุฉ ูุงูุนูุณ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุซุจูุช ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู tidyr 0.8.3.9000</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุจุฏูู ุฅูู ููุฒุงุช ุฌุฏูุฏุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงู ุจุณูุท ูุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ูุงุณุน ุฅูู ุชูุณูู ุทููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุตูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงุตูุงุช ุจุงุณุชุฎุฏุงู ููู ูุชุนุฏุฏุฉ (ุงููููุฉ.)</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญููู ุฅุทุงุฑุงุช ุงูุชุงุฑูุฎ ูู ุทููู ุฅูู ูุงุณุน</a> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุจุณุท ูุซุงู ูุฅููุงุก ุฌุฏูู ุจุชูุณูู ูุงุณุน</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููุฏ ุงุณู ุนููุฏ ูู ูุชุบูุฑุงุช ูุตุฏุฑ ูุชุนุฏุฏุฉ</a> </li></ul></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุนุถ ุงูุฃูุซูุฉ ุงููุชูุฏูุฉ ุนูู ุงูุนูู ูุน ููููู ุฌุฏูุฏ ููุนุจุฉ</a> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุจ ุงูุจูุงูุงุช ุฅูู ูุธูุฑ ุฃููู ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ุจูุงูุงุช ุฅูุฑุงุฏุงุช ุงูููุงูุงุช ุงููุชุญุฏุฉ ูุชุนุฏุงุฏ ุงูุฅูุฌุงุฑ ููุซุงู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจูู ุงูุฏููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฆูุฉ ุงูุงุชุตุงู</a> </li></ul></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงุณุชูุชุงุฌ</a> </li></ul><br><h2 id="koncepciya-tidydata" style=";text-align:right;direction:rtl">  ููููู TidyData </h2><br><p style=";text-align:right;direction:rtl">  ุงูุบุฑุถ ูู <strong>tidyr</strong> ูู ูุณุงุนุฏุชู ูู ุฌูุจ ุงูุจูุงูุงุช ุฅูู ูุธูุฑ ุฃููู ูุณูู.  ุงูุจูุงูุงุช ุงูุฏูููุฉ ูู ุงูุจูุงูุงุช ุญูุซ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ูุชุบูุฑ ูู ุนููุฏ. </li><li style=";text-align:right;direction:rtl">  ูู ููุงุญุธุฉ ูู ุฎุท. </li><li style=";text-align:right;direction:rtl">  ูู ูููุฉ ูู ุฎููุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุจูุงูุงุช ุงูุชู ูุชู ุชูุฏูููุง ุฅูู ุงูุจูุงูุงุช ูุฑุชุจุฉ ุฃุณูู ุจูุซูุฑ ูุฃูุซุฑ ููุงุกูุฉ ููุนูู ุฃุซูุงุก ุงูุชุญููู. </p><br><h2 id="osnovnye-funkcii-vhodyaschie-v-paket-tidyr" style=";text-align:right;direction:rtl">  ุงูููุงู ุงูุฑุฆูุณูุฉ ุงููุฏุฑุฌุฉ ูู ุญุฒูุฉ tidyr </h2><br><p style=";text-align:right;direction:rtl">  ูุญุชูู tidyr ุนูู ูุฌููุนุฉ ูู ุงููุธุงุฆู ูุชุญููู ุงูุฌุฏุงูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <code>fill()</code> - ููุก ุงูููู ุงูููููุฏุฉ ูู ุงูุนููุฏ ูุน ุงูููู ุงูุณุงุจูุฉ ุ </li><li style=";text-align:right;direction:rtl">  <code>separate()</code> - ุชูุณูู ุญูู ูุงุญุฏ ุฅูู ุนุฏุฉ ูู ุฎูุงู ูุงุตู ุ </li><li style=";text-align:right;direction:rtl">  <code>unite()</code> - ูููุฐ ุนูููุฉ ุงูุฌูุน ุจูู ุนุฏุฉ ุญููู ูู ูุงุญุฏ ุ ูุนููุณ ุงูุฏุงูุฉ <code>separate()</code> ุ </li><li style=";text-align:right;direction:rtl">  <code>pivot_longer()</code> - ุฏุงูุฉ ุชููู ุจุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ูุงุณุน ุฅูู ุชูุณูู ุทููู ุ </li><li style=";text-align:right;direction:rtl">  <code>pivot_wider()</code> - ุฏุงูุฉ ุชููู ุจุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ุทููู ุฅูู ุชูุณูู ูุงุณุน.  ุงูุนูููุฉ ูู ุนูุณ ุชูู ุงูุชู ูุชู ุชูููุฐูุง ุจูุงุณุทุฉ ุงูุฏุงูุฉ <code>pivot_longer()</code> . </li><li style=";text-align:right;direction:rtl">  <code>gather()</code> <strong>ููููุฉ</strong> - ุฏุงูุฉ ุชููู ุจุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ูุงุณุน ุฅูู ุชูุณูู ุทููู ุ </li><li style=";text-align:right;direction:rtl">  <code>spread()</code> <strong>ููููุฉ</strong> - ุฏุงูุฉ ุชููู ุจุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ุทููู ุฅูู ุชูุณูู ูุงุณุน.  ุงูุนูููุฉ ูู ุนูุณ ุงูุนูููุฉ ุงูุชู ุชููู ุจูุง ุงูุฏุงูุฉ collect <code>gather()</code> . </li></ul><br><h2 id="novaya-koncepciya-preobrazovaniya-dannyh-iz-shirokogo-formata-v-dlinnyy-i-naoborot" style=";text-align:right;direction:rtl">  ููููู ุฌุฏูุฏ ูุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ูุงุณุน ุฅูู ุตูุบุฉ ุทูููุฉ ูุงูุนูุณ </h2><br><p style=";text-align:right;direction:rtl">  ุณุงุจููุง ุ ุชู ุงุณุชุฎุฏุงู ุงูุฏุงูุชูู <code>gather()</code> ู <code>spread()</code> ููุฐุง ุงูููุน ูู ุงูุชุญูู.  ุนูู ูุฏุงุฑ ุณููุงุช ูู ูุฌูุฏ ูุฐู ุงููุธุงุฆู ุ ุฃุตุจุญ ูู ุงููุงุถุญ ุฃูู ุจุงููุณุจุฉ ููุนุธู ุงููุณุชุฎุฏููู ุ ุจูุง ูู ุฐูู ูุคูู ุงูุญุฒูุฉ ุ ูุฅู ุฃุณูุงุก ูุฐู ุงููุธุงุฆู ูุญุฌุฌูู ูู ุชูู ูุงุถุญุฉ ุชูุงููุง ูุชุณุจุจุช ูู ุตุนูุจุงุช ูู ุงูุนุซูุฑ ุนูููุง ูููู ุฃู ูู ูุฐู ุงููุธุงุฆู ูุฌูุจ ุฅุทุงุฑ ุงูุชุงุฑูุฎ ูู ูุงุณุน ุฅูู ุทููู ุดูู ูุงูุนูุณ ุจุงูุนูุณ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุตุฏุฏ ุ ุชู ุฅุถุงูุฉ <strong>ูุธููุชูู ุฌุฏูุฏุชูู ูููุชูู</strong> ุฅูู <strong>tidyr</strong> ุ ูุงูุชู ุชู ุชุตููููุง ูุชุญููู ุฅุทุงุฑุงุช ุงูุชุงุฑูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ุชู <code>pivot_longer()</code> ุงูุฏุงูุชูู <code>pivot_longer()</code> ู <code>pivot_wider()</code> ูู ุจุนุถ ุงููุธุงุฆู ูู ุญุฒูุฉ <strong>cdata</strong> ุงูุชู ุฃูุดุฃูุง John Mount ู Nina Zumel. </p><br><h3 id="ustanovka-naibolee-aktualnoy-versii-tidyr-0839000" style=";text-align:right;direction:rtl">  ุชุซุจูุช ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู tidyr 0.8.3.9000 </h3><br><p style=";text-align:right;direction:rtl">  ูุชุซุจูุช ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ ุงูุฃุญุฏุซ ูู <em>ุญุฒูุฉ</em> <strong>tidyr 0.8.3.9000</strong> ุ ุงูุชู ุชุชููุฑ ูููุง ูุธุงุฆู ุฌุฏูุฏุฉ ุ ุงุณุชุฎุฏู ุงูููุฏ ุงูุชุงูู. </p><br><p style=";text-align:right;direction:rtl"> <code>devtools::install_github("tidyverse/tidyr")</code> </p> <br><p style=";text-align:right;direction:rtl">  ูู ููุช ูุชุงุจุฉ ูุฐุง ุงูุชูุฑูุฑ ุ ุชุชููุฑ ูุฐู ุงููุธุงุฆู ููุท ูู ุฅุตุฏุงุฑ dev ูู ุงูุญุฒูุฉ ุนูู GitHub. </p><br><h3 id="perehod-na-novye-funkcii" style=";text-align:right;direction:rtl">  ุงูุชุจุฏูู ุฅูู ููุฒุงุช ุฌุฏูุฏุฉ </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ููุณ ูู ุงูุตุนุจ ููู ุงูุจุฑุงูุฌ ุงููุตูุฉ ุงููุฏููุฉ ููุนูู ูุน ูุธุงุฆู ุฌุฏูุฏุฉ ุ ูููู ุฃูุถู ุ ุณุฃุฃุฎุฐ ูุซุงูุงู ูู ูุซุงุฆู ุงููุธุงุฆู ุงููุฏููุฉ ูุฃุธูุฑ ููู ูุชู ุชูููุฐ ูุฐู ุงูุนูููุงุช ููุณูุง ุจุงุณุชุฎุฏุงู ุงููุธุงุฆู <code>pivot_*()</code> ุงูุฌุฏูุฏุฉ <code>pivot_*()</code> . </p><br><p style=";text-align:right;direction:rtl">  ุชุญููู ูุงุณุนุฉ ุฅูู ุชูุณูู ุทููู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุฒ ุนููุฉ ูู ูุซุงุฆู ุฌูุน ุงููุซุงุฆู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># example library(dplyr) stocks &lt;- data.frame( time = as.Date('2009-01-01') + 0:9, X = rnorm(10, 0, 1), Y = rnorm(10, 0, 2), Z = rnorm(10, 0, 4) ) # old stocks_gather &lt;- stocks %&gt;% gather(key = stock, value = price, -time) # new stocks_long &lt;- stocks %&gt;% pivot_longer(cols = -time, names_to = "stock", values_to = "price")</code> </pre></div></div><br><p style=";text-align:right;direction:rtl">  ุชุญููู ุชูุณูู ุทููู ุฅูู ูุงุณุน. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑูุฒ ุนููุฉ ูู ูุซุงุฆู ูุธููุฉ ุงูุงูุชุดุงุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># old stocks_spread &lt;- stocks_gather %&gt;% spread(key = stock, value = price) # new stock_wide &lt;- stocks_long %&gt;% pivot_wider(names_from = "stock", values_from = "price")</code> </pre></div></div><br><p style=";text-align:right;direction:rtl">  ูุฃู  ูู ุงูุฃูุซูุฉ ุงููุฐููุฑุฉ ุฃุนูุงู ููุนูู ูุน <code>pivot_longer()</code> ู <code>pivot_wider()</code> ุ ูู <em>ูุฎุฒูู</em> ุงูุฌุฏูู ุงููุตุฏุฑ ูุง ุชูุฌุฏ ุฃุนูุฏุฉ ูุฏุฑุฌุฉ ูู <em>names_to</em> <em>ูุงููุณูุทุงุช value_to ุ</em> ูุฌุจ ุงูุฅุดุงุฑุฉ ุฅูู ุฃุณูุงุฆูู ูู ุนูุงูุงุช ุงูุชุจุงุณ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุฌุฏูู ุจูุณุงุนุฏุฉ ูู ุงูุฐู ุณูู ุชูุชุดู ุจุณูููุฉ ุฃูุซุฑ ููููุฉ ุงูุชุจุฏูู ุฅูู ุงูุนูู ูุน ููููู ุฌุฏูุฏ <strong>tidyr</strong> . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/127/fc7/70a/127fc770a8175c98168864954e498199.png" alt="ุตูุฑุฉ"></p><br><h2 id="primechanie-ot-avtora" style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ูู ุงููุคูู </h2><br><blockquote style=";text-align:right;direction:rtl">  ูู ุงููุต ุฃุฏูุงู ูุงุจู ููุชููู ุ ูุฃูุฏ ุฃู ุฃููู ุชุฑุฌูุฉ ูุฌุงููุฉ ูููุตุบุฑ ูู ุงููููุน ุงูุฑุณูู ููููุชุจุฉ ุงูุญุฏูุซุฉ. </blockquote><br><h2 id="prostoy-primer-preobrazovaniya-dannyh-iz-shirokogo-formata-v-dlinnyy" style=";text-align:right;direction:rtl">  ูุซุงู ุจุณูุท ูุชุญููู ุงูุจูุงูุงุช ูู ุชูุณูู ูุงุณุน ุฅูู ุชูุณูู ุทููู </h2><br><p style=";text-align:right;direction:rtl">  <code>pivot_longer ()</code> - ูุฌุนู ูุฌููุนุงุช ุงูุจูุงูุงุช ุฃุทูู ูู ุฎูุงู ุชูููู ุนุฏุฏ ุงูุฃุนูุฏุฉ ูุฒูุงุฏุฉ ุนุฏุฏ ุงูุตููู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/760/8bb/c5d/7608bbc5d0873682bb5cb8ad3fb9857e.png" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ูุชุดุบูู ุงูุฃูุซูุฉ ุงูููุฏูุฉ ูู ุงูููุงูุฉ ุ ูุฌุจ ุฃููุงู ุชูุตูู ุงูุญุฒู ุงููุงุฒูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">library(tidyr) library(dplyr) library(readr)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุชุฑุถ ุฃู ูุฏููุง ุฌุฏูููุง ูุญุชูู ุนูู ูุชุงุฆุฌ ุงูุงุณุชุจูุงู ุงูุฐู ุณูุฆู ููู (ูู ุจูู ุฃุดูุงุก ุฃุฎุฑู) ุนู ุฏูููู ูุฏุฎููู ุงูุณููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 18 x 11 #&gt; religion `&lt;$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` #&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 Agnostic 27 34 60 81 76 137 #&gt; 2 Atheist 12 27 37 52 35 70 #&gt; 3 Buddhist 27 21 30 34 33 58 #&gt; 4 Catholic 418 617 732 670 638 1116 #&gt; 5 Don't kโฆ 15 14 15 11 10 35 #&gt; 6 Evangelโฆ 575 869 1064 982 881 1486 #&gt; 7 Hindu 1 9 7 9 11 34 #&gt; 8 Historiโฆ 228 244 236 238 197 223 #&gt; 9 Jehovahโฆ 20 27 24 24 21 30 #&gt; 10 Jewish 19 19 25 25 30 95 #&gt; # โฆ with 8 more rows, and 4 more variables: `$75-100k` &lt;dbl&gt;, #&gt; # `$100-150k` &lt;dbl&gt;, `&gt;150k` &lt;dbl&gt;, `Don't know/refused` &lt;dbl&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชูู ูุฐุง ุงูุฌุฏูู ุนูู ุจูุงูุงุช ุฏูู ุงููุณุชูุชู ูู ุงูุตููู ุ ูุชูุชุดุฑ ูุณุชููุงุช ุงูุฏุฎู ุนุจุฑ ุฃุณูุงุก ุงูุฃุนูุฏุฉ.  ูุชู ุชุฎุฒูู ุนุฏุฏ ุงููุณุชุฌูุจูู ูู ูู ูุฆุฉ ูู ููู ุงูุฎูุงูุง ุนูุฏ ุชูุงุทุน ุงูุฏูู ููุณุชูู ุงูุฏุฎู.  ูุฅุญุถุงุฑ ุงูุฌุฏูู ุฅูู ุชูุณูู ุฃููู ูุตุญูุญ ุ ูุง <code>pivot_longer()</code> ุณูู ุงุณุชุฎุฏุงู <code>pivot_longer()</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">pew %&gt;% pivot_longer(cols = -religion, names_to = "income", values_to = "count")</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">pew %&gt;% pivot_longer(cols = -religion, names_to = "income", values_to = "count") #&gt; # A tibble: 180 x 3 #&gt; religion income count #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 Agnostic &lt;$10k 27 #&gt; 2 Agnostic $10-20k 34 #&gt; 3 Agnostic $20-30k 60 #&gt; 4 Agnostic $30-40k 81 #&gt; 5 Agnostic $40-50k 76 #&gt; 6 Agnostic $50-75k 137 #&gt; 7 Agnostic $75-100k 122 #&gt; 8 Agnostic $100-150k 109 #&gt; 9 Agnostic &gt;150k 84 #&gt; 10 Agnostic Don't know/refused 96 #&gt; # โฆ with 170 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุณูุทุงุช ุฅูู <code>pivot_longer()</code> </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุณูุทุฉ ุงูุฃููู ุ <em>cols</em> ุ ุชุตู ุงูุฃุนูุฏุฉ ุงููุฑุงุฏ ุฏูุฌูุง.  ูู ูุฐู ุงูุญุงูุฉ ุ ุฌููุน ุงูุฃุนูุฏุฉ ุจุงุณุชุซูุงุก <em>ุงูููุช</em> . </li><li style=";text-align:right;direction:rtl">  ุชุนุทู ุงููุณูุทุฉ <em>names_to</em> ุงุณู ุงููุชุบูุฑ ุงูุฐู ุณูุชู ุฅูุดุงุคู ูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ุงูุชู <em>ุฌูุนูุงูุง</em> . </li><li style=";text-align:right;direction:rtl">  ุชุนุทู <em>value_to</em> ุงุณู ุงููุชุบูุฑ ุงูุฐู ุณูุชู ุฅูุดุงุคู ูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูู ููู ุฎูุงูุง ุงูุฃุนูุฏุฉ ุงููุฑุชุจุทุฉ. </li></ul><br><h2 id="specifikacii" style=";text-align:right;direction:rtl">  ููุงุตูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุงููุธููุฉ ุงูุฌุฏูุฏุฉ ูุญุฒูุฉ <strong>tidyr</strong> ุ ูุงูุชู ูู ุชูู ูุชููุฑุฉ ุณุงุจููุง ุนูุฏ ุงูุนูู ูุน ุงููุธุงุฆู ุงููุฏููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุงุตูุงุช ูู ุฅุทุงุฑ ุจูุงูุงุช ุ ูุชูุงูู ูู ุตู ูุน ุนููุฏ ูุงุญุฏ ูู ุฅุทุงุฑ ุชุงุฑูุฎ ุฅุฎุฑุงุฌ ุฌุฏูุฏ ุ ูุนููุฏูู ุฎุงุตูู ูุจุฏุฃุงู ุจูุง ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <em>.name</em> ูุญุชูู ุนูู ุงูุงุณู ุงูุฃุตูู ููุนููุฏ. </li><li style=";text-align:right;direction:rtl">  <em>.value</em> ูุญุชูู ุนูู ุงุณู ุงูุนููุฏ ุงูุฐู ุณุชุฐูุจ ุฅููู ููู ุงูุฎููุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ุชุนูุณ ุงูุฃุนูุฏุฉ ุงููุชุจููุฉ ูู ุงูููุงุตูุงุช ููู ุณูุชู ุนุฑุถ ุงุณู ุงูุฃุนูุฏุฉ <em>ุงููุงุจูุฉ</em> ููุถุบุท ูู <em>.name</em> ูู ุงูุนููุฏ ุงูุฌุฏูุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุชูุถุญ ุงูููุงุตูุงุช ุงูุจูุงูุงุช ุงูุฃูููุฉ ุงููุฎุฒูุฉ ูู ุงุณู ุงูุนููุฏ ุ ูุน ูุฌูุฏ ุตู ูุงุญุฏ ููู ุนููุฏ ูุนููุฏ ูุงุญุฏ ููู ูุชุบูุฑ ููุชุฑู ุจุงุณู ุงูุนููุฏ ุ ูุฑุจูุง ูุจุฏู ูุฐุง ุงูุชุนุฑูู ูุฑุจููุง ุงูุขู ุ ูููู ุจุนุฏ ุงููุธุฑ ูู ุจุนุถ ุงูุฃูุซูุฉ ุ ูุตุจุญ ูู ุดูุก ุฃูุซุฑ ูุถูุญูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุนูู ุงูููุงุตูุงุช ูู ุฃูู ููููู ุงุณุชุฑุฌุงุน ูุชุนุฏูู ูุชุนููู ุจูุงูุงุช ุชุนุฑูู ุฌุฏูุฏุฉ ูุฅุทุงุฑ ุงูุจูุงูุงุช ุงููุญูู. </p><br><p style=";text-align:right;direction:rtl">  ูุชู <code>pivot_longer_spec()</code> ูุธููุฉ <code>pivot_longer_spec()</code> ููุนูู ูุน ุงูููุงุตูุงุช ุนูุฏ ุชุญููู ุฌุฏูู ูู ุชูุณูู ูุงุณุน ุฅูู ุชูุณูู ุทููู. </p><br><p style=";text-align:right;direction:rtl">  ููู ุชุนูู ูุฐู ุงููุธููุฉ ุ ูุฅููุง ุชุฃุฎุฐ ุฃู ุฅุทุงุฑ ุชุงุฑูุฎ ุ ูุชููู ุจุฅูุดุงุก ุจูุงูุงุช ุงูุชุนุฑูู ุงูุฎุงุตุฉ ุจูุง ููุง ูู ููุถุญ ุฃุนูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ุฏุนูุง ูุฃุฎุฐ ูุฌููุนุฉ ุงูุจูุงูุงุช ูู ุงูุฐู ูุฃุชู ูุน ุญุฒูุฉ <strong>tidyr</strong> .  ุชุญุชูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฐู ุนูู ูุนูููุงุช ููุฏูุฉ ูู ุงูููุธูุฉ ุงูุตุญูุฉ ุงูุฏูููุฉ ุญูู ุญุงูุงุช ุงูุฅุตุงุจุฉ ุจุงูุณู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">who #&gt; # A tibble: 7,240 x 60 #&gt; country iso2 iso3 year new_sp_m014 new_sp_m1524 new_sp_m2534 #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 Afghanโฆ AF AFG 1980 NA NA NA #&gt; 2 Afghanโฆ AF AFG 1981 NA NA NA #&gt; 3 Afghanโฆ AF AFG 1982 NA NA NA #&gt; 4 Afghanโฆ AF AFG 1983 NA NA NA #&gt; 5 Afghanโฆ AF AFG 1984 NA NA NA #&gt; 6 Afghanโฆ AF AFG 1985 NA NA NA #&gt; 7 Afghanโฆ AF AFG 1986 NA NA NA #&gt; 8 Afghanโฆ AF AFG 1987 NA NA NA #&gt; 9 Afghanโฆ AF AFG 1988 NA NA NA #&gt; 10 Afghanโฆ AF AFG 1989 NA NA NA #&gt; # โฆ with 7,230 more rows, and 53 more variables</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ูุจูู ููุงุตูุงุชูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec &lt;- who %&gt;% pivot_longer_spec(new_sp_m014:newrel_f65, values_to = "count")</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 56 x 3 #&gt; .name .value name #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 new_sp_m014 count new_sp_m014 #&gt; 2 new_sp_m1524 count new_sp_m1524 #&gt; 3 new_sp_m2534 count new_sp_m2534 #&gt; 4 new_sp_m3544 count new_sp_m3544 #&gt; 5 new_sp_m4554 count new_sp_m4554 #&gt; 6 new_sp_m5564 count new_sp_m5564 #&gt; 7 new_sp_m65 count new_sp_m65 #&gt; 8 new_sp_f014 count new_sp_f014 #&gt; 9 new_sp_f1524 count new_sp_f1524 #&gt; 10 new_sp_f2534 count new_sp_f2534 #&gt; # โฆ with 46 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุญููู <em>ุงูุจูุฏ</em> ุ <em>iso2</em> ุ <em>iso3</em> ูู ุจุงููุนู ูุชุบูุฑุงุช.  ูููุชูุง ูู ููุจ ุงูุฃุนูุฏุฉ ูู <em>new_sp_m014</em> ุฅูู <em>newrel_f65</em> . </p><br><p style=";text-align:right;direction:rtl">  ุชุฎุฒู ุฃุณูุงุก ูุฐู ุงูุฃุนูุฏุฉ ุงููุนูููุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุดูุฑ ุงูุจุงุฏุฆุฉ <code>new_</code> ุฅูู ุฃู ุงูุนููุฏ ูุญุชูู ุนูู ุจูุงูุงุช ุนู ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ ููุฑุถ ุงูุณู ุ ูุฃู ุฅุทุงุฑ ุงูุชุงุฑูุฎ ุงูุญุงูู ูุญุชูู ุนูู ูุนูููุงุช ููุท ุนู ุงูุฃูุฑุงุถ ุงูุฌุฏูุฏุฉ ุ ูุจุงูุชุงูู ูุฅู ูุฐู ุงูุจุงุฏุฆุฉ ูู ุงูุณูุงู ุงูุญุงูู ูุง ุชุญูู ุฃู ูุนูู. </li><li style=";text-align:right;direction:rtl">  ูุตู <code>sp</code> / <code>rel</code> / <code>sp</code> / <code>ep</code> ุทุฑููุฉ ูุชุดุฎูุต ุงููุฑุถ. </li><li style=";text-align:right;direction:rtl">  <code>m</code> / <code>f</code> ุฌูุณ ุงููุฑูุถ. </li><li style=";text-align:right;direction:rtl">  <code>014</code> ุงููุฆุฉ ุงูุนูุฑูุฉ ูููุฑูุถ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูููููุง ูุตู ูุฐู ุงูุฃุนูุฏุฉ ุจุงุณุชุฎุฏุงู ุฏุงูุฉ <code>extract()</code> ุจุงุณุชุฎุฏุงู ุชุนุจูุฑ ุนุงุฏู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec &lt;- spec %&gt;% extract(name, c("diagnosis", "gender", "age"), "new_?(.*)_(.)(.*)")</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 56 x 5 #&gt; .name .value diagnosis gender age #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 new_sp_m014 count sp m 014 #&gt; 2 new_sp_m1524 count sp m 1524 #&gt; 3 new_sp_m2534 count sp m 2534 #&gt; 4 new_sp_m3544 count sp m 3544 #&gt; 5 new_sp_m4554 count sp m 4554 #&gt; 6 new_sp_m5564 count sp m 5564 #&gt; 7 new_sp_m65 count sp m 65 #&gt; 8 new_sp_f014 count sp f 014 #&gt; 9 new_sp_f1524 count sp f 1524 #&gt; 10 new_sp_f2534 count sp f 2534 #&gt; # โฆ with 46 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃูู ูุฌุจ ุฃู ูุธู ุนููุฏ <em>.name ุจุฏูู</em> ุชุบููุฑ ุ ูุฃู ูุฐุง ูู ููุฑุณูุง ูู ุฃุณูุงุก ุฃุนูุฏุฉ ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุตุฏุฑ. </p><br><p style=";text-align:right;direction:rtl">  ููุฌูุณ ูุงูุนูุฑ (ุฃุนูุฏุฉ <em>ุงูุฌูุณ</em> <em>ูุงูุนูุฑ</em> ) ููู ุซุงุจุชุฉ ููุนุฑููุฉ ุ ูุฐูู ููุตู ุจุชุญููู ูุฐู ุงูุฃุนูุฏุฉ ุฅูู ุนูุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec &lt;- spec %&gt;% mutate( gender = factor(gender, levels = c("f", "m")), age = factor(age, levels = unique(age), ordered = TRUE) )</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃุฎูุฑูุง ุ ูู ุฃุฌู ุชุทุจูู ุงูููุงุตูุงุช ุงูุชู ุฃูุดุฃูุงูุง ุนูู ุงูุชุงุฑูุฎ ุงูุฃุตูู ูุฅุทุงุฑ <em>who</em> ุ ูุญุชุงุฌ ุฅูู ุงุณุชุฎุฏุงู ูุณูุทุฉ <em>spec</em> ูู <code>pivot_longer()</code> . </p><br><p style=";text-align:right;direction:rtl"> <code>who %&gt;% pivot_longer(spec = spec)</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 405,440 x 8 #&gt; country iso2 iso3 year diagnosis gender age count #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;fct&gt; &lt;ord&gt; &lt;int&gt; #&gt; 1 Afghanistan AF AFG 1980 sp m 014 NA #&gt; 2 Afghanistan AF AFG 1980 sp m 1524 NA #&gt; 3 Afghanistan AF AFG 1980 sp m 2534 NA #&gt; 4 Afghanistan AF AFG 1980 sp m 3544 NA #&gt; 5 Afghanistan AF AFG 1980 sp m 4554 NA #&gt; 6 Afghanistan AF AFG 1980 sp m 5564 NA #&gt; 7 Afghanistan AF AFG 1980 sp m 65 NA #&gt; 8 Afghanistan AF AFG 1980 sp f 014 NA #&gt; 9 Afghanistan AF AFG 1980 sp f 1524 NA #&gt; 10 Afghanistan AF AFG 1980 sp f 2534 NA #&gt; # โฆ with 405,430 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุง ูุนููุงู ููุชู ูููู ุชุตููุฑู ุจุดูู ุชุฎุทูุทู ุนูู ุงููุญู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/90c/84b/16d/90c84b16d3e4c9860b8ced6e411757b3.png" alt="ุตูุฑุฉ"></p><br><h2 id="specifikaciya-s-ispolzovaniem-neskolkih-znacheniyvalue" style=";text-align:right;direction:rtl">  ุงูููุงุตูุงุช ุจุงุณุชุฎุฏุงู ููู ูุชุนุฏุฏุฉ (ุงููููุฉ.) </h2><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซุงู ุฃุนูุงู ุ ุชุถูู ุนููุฏ ููุงุตูุงุช ุงููููุฉ. ูููุฉ ูุงุญุฏุฉ ููุท ุ ููุญุฏุซ ูุฐุง ูู ูุนุธู ุงูุญุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูููู ูู ุจุนุถ ุงูุฃุญูุงู ูุฏ ุชูุดุฃ ุญุงูุฉ ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุฌูุน ุงูุจูุงูุงุช ูู ุงูุฃุนูุฏุฉ ูุน ุฃููุงุน ุงูุจูุงูุงุช ุงููุฎุชููุฉ ูู ุงูููู.  ุจุงุณุชุฎุฏุงู ุฏุงูุฉ <code>spread()</code> ุงูููููุฉ ุ ุณูููู ุฐูู ุตุนุจูุง ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุนุงุฑุฉ ุงููุซุงู ุงูุชุงูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุงููุตูุฑุฉ</a> ูุญุฒูุฉ <strong>data.table</strong> . </p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ุฅูุดุงุก ุฅุทุงุฑ ุจูุงูุงุช ุงูุชุฏุฑูุจ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">family &lt;- tibble::tribble( ~family, ~dob_child1, ~dob_child2, ~gender_child1, ~gender_child2, 1L, "1998-11-26", "2000-01-29", 1L, 2L, 2L, "1996-06-22", NA, 2L, NA, 3L, "2002-07-11", "2004-04-05", 2L, 2L, 4L, "2004-10-10", "2009-08-27", 1L, 1L, 5L, "2000-12-05", "2005-02-28", 2L, 1L, ) family &lt;- family %&gt;% mutate_at(vars(starts_with("dob")), parse_date)</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 5 x 5 #&gt; family dob_child1 dob_child2 gender_child1 gender_child2 #&gt; &lt;int&gt; &lt;date&gt; &lt;date&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 1 1998-11-26 2000-01-29 1 2 #&gt; 2 2 1996-06-22 NA 2 NA #&gt; 3 3 2002-07-11 2004-04-05 2 2 #&gt; 4 4 2004-10-10 2009-08-27 1 1 #&gt; 5 5 2000-12-05 2005-02-28 2 1</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชูู ุฅุทุงุฑ ุงูุชุงุฑูุฎ ุงูุฐู ุชู ุฅูุดุงุคู ูู ูู ุตู ุนูู ุจูุงูุงุช ุนู ุฃุทูุงู ุฃุณุฑุฉ ูุงุญุฏุฉ.  ูููู ููุนุงุฆูุงุช ุฃู ุชูุฌุจ ุทููุงู ุฃู ุทูููู.  ุจุงููุณุจุฉ ููู ุทูู ุ ูุชู ุชูููุฑ ุจูุงูุงุช ุนู ุชุงุฑูุฎ ุงููููุงุฏ ูุงูุฌูุณ ุ ูุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูู ุทูู ูู ุฃุนูุฏุฉ ูููุตูุฉ ุ ููููุชูุง ูู ุฌูุจ ูุฐู ุงูุจูุงูุงุช ุฅูู ุงูุชูุณูู ุงูุตุญูุญ ููุชุญููู. </p><br><p style=";text-align:right;direction:rtl">  ูุฑุฌู ููุงุญุธุฉ ุฃู ูุฏููุง ุงุซููู ูู ุงููุชุบูุฑุงุช ูุน ูุนูููุงุช ุญูู ูู ุทูู: ุฌูุณู ูุชุงุฑูุฎ ุงููููุงุฏ (ุงูุฃุนูุฏุฉ ูุน ุงูุจุงุฏุฆุฉ <em>dop</em> ุชุญุชูู ุนูู ุชุงุฑูุฎ ุงููููุงุฏ ุ ูุงูุฃุนูุฏุฉ ูุน ุงูุจุงุฏุฆุฉ <em>ุจูู ุงูุฌูุณูู</em> ุชุญุชูู ุนูู ุฌูุณ ุงูุทูู).  ูู ุงููุชูุฌุฉ ุงููุชููุนุฉ ุ ูุฌุจ ุฃู ูุฐูุจูุง ูู ุฃุนูุฏุฉ ูููุตูุฉ.  ูููููุง ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุฅูุดุงุก ููุงุตูุงุช ูููู ูุนููุฏ <code>.value</code> ูููุชุงู ูุฎุชููุชุงู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec &lt;- family %&gt;% pivot_longer_spec(-family) %&gt;% separate(col = name, into = c(".value", "child"))%&gt;% mutate(child = parse_number(child))</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 4 x 3 #&gt; .name .value child #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 dob_child1 dob 1 #&gt; 2 dob_child2 dob 2 #&gt; 3 gender_child1 gender 1 #&gt; 4 gender_child2 gender 2</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุฏุนูุง ูุฎุทู ูู ุงูุฎุทูุงุช ุงูุชู ูุชู ุชูููุฐูุง ุจูุงุณุทุฉ ุงูููุฏ ุฃุนูุงู. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>pivot_longer_spec(-family)</code> - ูู ุจุฅูุดุงุก ููุงุตูุงุช ุชุถุบุท ุนูู ูู ุงูุฃุนูุฏุฉ ุงููุชุงุญุฉ ุจุงุณุชุซูุงุก ุนููุฏ ุงูุนุงุฆูุฉ. </li><li style=";text-align:right;direction:rtl">  <code>separate(col = name, into = c(".value", "child"))</code> - ุงูุตู ุนููุฏ <em>.name</em> ุ ุงูุฐู ูุญุชูู ุนูู ุฃุณูุงุก ุงูุญููู ุงููุตุฏุฑ ุ ูุชู ูุถุน <em>ุนูุงูุงุช</em> ุชุญุช ุงูููู ููุถุนูุง ูู ุงูุฃุนูุฏุฉ <em>ุงููุฑุนูุฉ</em> <em>.val</em> ู ุงูุชุงุจุนุฉ. </li><li style=";text-align:right;direction:rtl">  <code>mutate(child = parse_number(child))</code> - ุชุญููู ููู ุงูุญูู <code>mutate(child = parse_number(child))</code> ูู ูุต ุฅูู ููุน ุจูุงูุงุช ุฑููู. </li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููููุง ุชุทุจูู ุงูููุงุตูุงุช ุงููุณุชููุฉ ุนูู ุฅุทุงุฑ ุงูุจูุงูุงุช ุงูุฃููู ุ ูุฅุญุถุงุฑ ุงูุฌุฏูู ุฅูู ุงููููุฐุฌ ุงููุทููุจ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">family %&gt;% pivot_longer(spec = spec, na.rm = T)</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 9 x 4 #&gt; family child dob gender #&gt; &lt;int&gt; &lt;dbl&gt; &lt;date&gt; &lt;int&gt; #&gt; 1 1 1 1998-11-26 1 #&gt; 2 1 2 2000-01-29 2 #&gt; 3 2 1 1996-06-22 2 #&gt; 4 3 1 2002-07-11 2 #&gt; 5 3 2 2004-04-05 2 #&gt; 6 4 1 2004-10-10 1 #&gt; 7 4 2 2009-08-27 1 #&gt; 8 5 1 2000-12-05 2 #&gt; 9 5 2 2005-02-28 1</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ูุณุชุฎุฏู ุงููุณูุทุฉ <code>na.rm = TRUE</code> ุ ูุฃู ูููุฐุฌ ุงูุจูุงูุงุช ุงูุญุงูู ููุฑุถ ุนูููุง ุฅูุดุงุก ุตููู ุฅุถุงููุฉ ููุฑุตุฏุงุช ุบูุฑ ุงูููุฌูุฏุฉ.  ูุฃู  ุนุงุฆูุฉ 2 ูุฏููุง ุทูู ูุงุญุฏ ููุท ุ <code>na.rm = TRUE</code> ุชุถูู ุฃู ุงูุนุงุฆูุฉ 2 ุณูููู ููุง ุณุทุฑ ูุงุญุฏ ูู ุงูุฅุฎุฑุงุฌ. </p><br><h2 id="preobrazovanie-data-freymov-iz-dlinnogo-formata-k-shirokomu" style=";text-align:right;direction:rtl">  ุชุญููู ุฅุทุงุฑุงุช ุงูุชุงุฑูุฎ ูู ุทููู ุฅูู ูุงุณุน </h2><br><p style=";text-align:right;direction:rtl">  <code>pivot_wider()</code> - ูู ุงูุชุญูู ุงูุนูุณู ุ ูุงูุนูุณ ุจุงูุนูุณ ูุฒูุฏ ุนุฏุฏ ุงูุฃุนูุฏุฉ ูู ุชุงุฑูุฎ ุงูุฅุทุงุฑ ุนู ุทุฑูู ุชูููู ุนุฏุฏ ุงูุตููู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b0d/a51/f47/b0da51f47f968a49e485989eba044914.png" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ูุงุฏุฑูุง ูุง ูุณุชุฎุฏู ูุฐุง ุงูููุน ูู ุงูุชุญููู ูุฅุญุถุงุฑ ุงูุจูุงูุงุช ุฅูู ูุธูุฑ ุฃููู ุ ููุน ุฐูู ุ ูููู ุฃู ุชููู ูุฐู ุงูุชูููุฉ ูููุฏุฉ ูุฅูุดุงุก ุงูุฌุฏุงูู ุงููุญูุฑูุฉ ุงููุณุชุฎุฏูุฉ ูู ุงูุนุฑูุถ ุงูุชูุฏูููุฉ ุ ุฃู ููุชูุงูู ูุน ุฃู ุฃุฏูุงุช ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุญูููุฉ ุ ูุฅู ุงูุฏุงูุชูู <code>pivot_longer()</code> ู <code>pivot_wider()</code> ุ ูููุง ูุคุฏูุงู ุฅุฌุฑุงุกุงุช ูุนุงูุณุฉ ุ ุฃู: <code>df %&gt;% pivot_longer(spec = spec) %&gt;% pivot_wider(spec = spec)</code> ู <code>df %&gt;% pivot_wider(spec = spec) %&gt;% pivot_longer(spec = spec)</code> ุฅูู df ุงูุฃุตูู. </p><br><h3 id="prosteyshiy-primer-privedeniya-tablicy-k-shirokomu-formatu" style=";text-align:right;direction:rtl">  ุฃุจุณุท ูุซุงู ูุฅููุงุก ุฌุฏูู ุจุชูุณูู ูุงุณุน </h3><br><p style=";text-align:right;direction:rtl">  ูุฅุซุจุงุช ุชุดุบูู ูุธููุฉ <code>pivot_wider()</code> ุ <em>ุณูุณุชุฎุฏู ูุฌููุนุฉ ุจูุงูุงุช fish_encounters</em> ุ ุงูุชู ุชุฎุฒู ูุนูููุงุช ุญูู ููููุฉ ุชุณุฌูู ุงููุญุทุงุช ุงููุฎุชููุฉ ูุญุฑูุฉ ุงูุฃุณูุงู ุนูู ุทูู ุงูููุฑ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 114 x 3 #&gt; fish station seen #&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt; #&gt; 1 4842 Release 1 #&gt; 2 4842 I80_1 1 #&gt; 3 4842 Lisbon 1 #&gt; 4 4842 Rstr 1 #&gt; 5 4842 Base_TD 1 #&gt; 6 4842 BCE 1 #&gt; 7 4842 BCW 1 #&gt; 8 4842 BCE2 1 #&gt; 9 4842 BCW2 1 #&gt; 10 4842 MAE 1 #&gt; # โฆ with 104 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุนุธู ุงูุญุงูุงุช ุ ุณูููู ูุฐุง ุงูุฌุฏูู ุฃูุซุฑ ุฅูุงุฏุฉ ูููุงุกูุฉ ููุงุณุชุฎุฏุงู ุฅุฐุง ูุฏูุช ูุนูููุงุช ููู ูุญุทุฉ ูู ุนููุฏ ูููุตู. </p><br><p style=";text-align:right;direction:rtl"> <code>fish_encounters %&gt;% pivot_wider(names_from = station, values_from = seen)</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">fish_encounters %&gt;% pivot_wider(names_from = station, values_from = seen) #&gt; # A tibble: 19 x 12 #&gt; fish Release I80_1 Lisbon Rstr Base_TD BCE BCW BCE2 BCW2 MAE #&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 4842 1 1 1 1 1 1 1 1 1 1 #&gt; 2 4843 1 1 1 1 1 1 1 1 1 1 #&gt; 3 4844 1 1 1 1 1 1 1 1 1 1 #&gt; 4 4845 1 1 1 1 1 NA NA NA NA NA #&gt; 5 4847 1 1 1 NA NA NA NA NA NA NA #&gt; 6 4848 1 1 1 1 NA NA NA NA NA NA #&gt; 7 4849 1 1 NA NA NA NA NA NA NA NA #&gt; 8 4850 1 1 NA 1 1 1 1 NA NA NA #&gt; 9 4851 1 1 NA NA NA NA NA NA NA NA #&gt; 10 4854 1 1 NA NA NA NA NA NA NA NA #&gt; # โฆ with 9 more rows, and 1 more variable: MAW &lt;int&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุณุฌู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฐู ุงููุนูููุงุช ููุท ุนูุฏูุง ูุชู ุงููุดู ุนู ุงูุฃุณูุงู ุจูุงุณุทุฉ ุงููุญุทุฉ ุ ุฃู  ุฅุฐุง ูู ูุชู ุฅุตูุงุญ ุฃู ุณููุฉ ุจูุงุณุทุฉ ูุญุทุฉ ูุง ุ ููู ุชููู ูุฐู ุงูุจูุงูุงุช ูู ุงูุฌุฏูู.  ูุฐุง ูุนูู ุฃูู ุณูุชู ููุคูุง ุงูุฅุฎุฑุงุฌ ุจูุงุณุทุฉ NA. </p><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูุนูู ุฃู ุนุฏู ูุฌูุฏ ุณุฌู ูุนูู ุฃูู ูู ูุชู ููุงุญุธุฉ ุงูุณูู ุ ูุฐูู ูููููุง ุงุณุชุฎุฏุงู ูุณูุทุฉ <em>value_fill</em> ูู <code>pivot_wider()</code> ูููุก ูุฐู ุงูููู ุงูููููุฏุฉ <code>pivot_wider()</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">fish_encounters %&gt;% pivot_wider( names_from = station, values_from = seen, values_fill = list(seen = 0) )</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 19 x 12 #&gt; fish Release I80_1 Lisbon Rstr Base_TD BCE BCW BCE2 BCW2 MAE #&gt; &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; #&gt; 1 4842 1 1 1 1 1 1 1 1 1 1 #&gt; 2 4843 1 1 1 1 1 1 1 1 1 1 #&gt; 3 4844 1 1 1 1 1 1 1 1 1 1 #&gt; 4 4845 1 1 1 1 1 0 0 0 0 0 #&gt; 5 4847 1 1 1 0 0 0 0 0 0 0 #&gt; 6 4848 1 1 1 1 0 0 0 0 0 0 #&gt; 7 4849 1 1 0 0 0 0 0 0 0 0 #&gt; 8 4850 1 1 0 1 1 1 1 0 0 0 #&gt; 9 4851 1 1 0 0 0 0 0 0 0 0 #&gt; 10 4854 1 1 0 0 0 0 0 0 0 0 #&gt; # โฆ with 9 more rows, and 1 more variable: MAW &lt;int&gt;</code> </pre> <br><h3 id="generaciya-imeni-stolbca-iz-neskolkih-ishodnyh-peremennyh" style=";text-align:right;direction:rtl">  ุชูููุฏ ุงุณู ุนููุฏ ูู ูุชุบูุฑุงุช ูุตุฏุฑ ูุชุนุฏุฏุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุชุฎูู ุฃู ูุฏููุง ุฌุฏูู ูุญุชูู ุนูู ูุฒูุฌ ูู ุงูููุชุฌ ูุงูุจูุฏ ูุงูุณูุฉ.  ูุฅูุดุงุก ุชุงุฑูุฎ ุฅุทุงุฑ ุงุฎุชุจุงุฑ ุ ููููู ุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">df &lt;- expand_grid( product = c("A", "B"), country = c("AI", "EI"), year = 2000:2014 ) %&gt;% filter((product == "A" &amp; country == "AI") | product == "B") %&gt;% mutate(value = rnorm(nrow(.)))</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 45 x 4 #&gt; product country year value #&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; #&gt; 1 A AI 2000 -2.05 #&gt; 2 A AI 2001 -0.676 #&gt; 3 A AI 2002 1.60 #&gt; 4 A AI 2003 -0.353 #&gt; 5 A AI 2004 -0.00530 #&gt; 6 A AI 2005 0.442 #&gt; 7 A AI 2006 -0.610 #&gt; 8 A AI 2007 -2.77 #&gt; 9 A AI 2008 0.899 #&gt; 10 A AI 2009 -0.106 #&gt; # โฆ with 35 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุชูุง ูู ุชูุณูุน ุฅุทุงุฑ ุงูุชุงุฑูุฎ ุจุญูุซ ูุญุชูู ุนููุฏ ูุงุญุฏ ุนูู ุจูุงูุงุช ููู ูุฌููุนุฉ ูู ุงูููุชุฌุงุช ูุงูุฏููุฉ.  ููููุงู ุจุฐูู ุ ูุง ุนููู ุณูู ุชูุฑูุฑ ุงููุชุฌู ุงูุฐู ูุญุชูู ุนูู ุฃุณูุงุก ุงูุญููู ุงููุฑุงุฏ ุถููุง ุฅูู ูุณูุทุฉ <em>names_from</em> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">df %&gt;% pivot_wider(names_from = c(product, country), values_from = "value")</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 15 x 4 #&gt; year A_AI B_AI B_EI #&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2000 -2.05 0.607 1.20 #&gt; 2 2001 -0.676 1.65 -0.114 #&gt; 3 2002 1.60 -0.0245 0.501 #&gt; 4 2003 -0.353 1.30 -0.459 #&gt; 5 2004 -0.00530 0.921 -0.0589 #&gt; 6 2005 0.442 -1.55 0.594 #&gt; 7 2006 -0.610 0.380 -1.28 #&gt; 8 2007 -2.77 0.830 0.637 #&gt; 9 2008 0.899 0.0175 -1.30 #&gt; 10 2009 -0.106 -0.195 1.03 #&gt; # โฆ with 5 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููููู ุฃูุถูุง ุชุทุจูู ุงูููุงุตูุงุช ุนูู ูุธููุฉ <code>pivot_wider()</code> .  ูููู ุนูุฏูุง ูุชู ุชูููุฑูุง ุฅูู <code>pivot_wider()</code> ุงูููุงุตูุงุช ุชููู ุจุนูุณ <code>pivot_longer()</code> : ูุชู ุฅูุดุงุก ุงูุฃุนูุฏุฉ ุงููุญุฏุฏุฉ ูู <em>.name</em> ุจุงุณุชุฎุฏุงู ููู ูู <em>.value</em> ูุงูุฃุนูุฏุฉ ุงูุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู ูุฌููุนุฉ ุงูุจูุงูุงุช ูุฐู ุ ููููู ุฅูุดุงุก ููุงุตูุงุช ูุณุชุฎุฏู ุฅุฐุง ููุช ุชุฑูุฏ ุฃู ูููู ููู ูุฌููุนุฉ ููููุฉ ูู ุงูุจูุฏ ูุงูููุชุฌ ุนููุฏ ุฎุงุต ุจูุง ุ ูููุณ ููุท ุชูู ุงูููุฌูุฏุฉ ูู ุงูุจูุงูุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spec &lt;- df %&gt;% expand(product, country, .value = "value") %&gt;% unite(".name", product, country, remove = FALSE)</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 4 x 4 #&gt; .name product country .value #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 A_AI A AI value #&gt; 2 A_EI A EI value #&gt; 3 B_AI B AI value #&gt; 4 B_EI B EI value</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">df %&gt;% pivot_wider(spec = spec) %&gt;% head()</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 6 x 5 #&gt; year A_AI A_EI B_AI B_EI #&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 2000 -2.05 NA 0.607 1.20 #&gt; 2 2001 -0.676 NA 1.65 -0.114 #&gt; 3 2002 1.60 NA -0.0245 0.501 #&gt; 4 2003 -0.353 NA 1.30 -0.459 #&gt; 5 2004 -0.00530 NA 0.921 -0.0589 #&gt; 6 2005 0.442 NA -1.55 0.594</code> </pre> <br><h2 id="neskolko-prodvinutyh-primerov-raboty-s-novoy-koncepciey-tidyr" style=";text-align:right;direction:rtl">  ุจุนุถ ุงูุฃูุซูุฉ ุงููุชูุฏูุฉ ุนูู ุงูุนูู ูุน ููููู ุฌุฏูุฏ ููุนุจุฉ </h2><br><h3 id="privedenie-dannyh-k-akkuratnomu-vidu-na-primere-nabora-dannyh-o-perepisi-dohoda-i-arendnoy-platy-v-ssha" style=";text-align:right;direction:rtl">  ุฌูุจ ุงูุจูุงูุงุช ุฅูู ูุธูุฑ ุฃููู ุจุงุณุชุฎุฏุงู ูุฌููุนุฉ ุจูุงูุงุช ุฅูุฑุงุฏุงุช ุงูููุงูุงุช ุงููุชุญุฏุฉ ูุชุนุฏุงุฏ ุงูุฅูุฌุงุฑ ููุซุงู </h3><br><p style=";text-align:right;direction:rtl">  ุชุญุชูู <em>ูุฌููุนุฉ ุจูุงูุงุช us_rent_income</em> ุนูู ูุนูููุงุช ุญูู ูุชูุณุท โโุงูุฏุฎู ูุงูุฅูุฌุงุฑ ููู ููุงูุฉ ูู ุงูููุงูุงุช ุงููุชุญุฏุฉ ุงูุฃูุฑูููุฉ ูุนุงู 2017 (ุชุชููุฑ ูุฌููุนุฉ ุงูุจูุงูุงุช ูู ุญุฒูุฉ <strong>tidycensus</strong> ). </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">us_rent_income #&gt; # A tibble: 104 x 5 #&gt; GEOID NAME variable estimate moe #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 01 Alabama income 24476 136 #&gt; 2 01 Alabama rent 747 3 #&gt; 3 02 Alaska income 32940 508 #&gt; 4 02 Alaska rent 1200 13 #&gt; 5 04 Arizona income 27517 148 #&gt; 6 04 Arizona rent 972 4 #&gt; 7 05 Arkansas income 23789 165 #&gt; 8 05 Arkansas rent 709 5 #&gt; 9 06 California income 29454 109 #&gt; 10 06 California rent 1358 3 #&gt; # โฆ with 94 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงููููุฐุฌ ุงูุฐู ูุชู ุจู ุชุฎุฒูู ุงูุจูุงูุงุช ูู <em>ูุฌููุนุฉ ุจูุงูุงุช</em> us_rent_income <em>ุ ูุฅู</em> ุงูุนูู ูุนูู ุบูุฑ ูุฑูุญ ููุบุงูุฉ ุ ูุฐูู ููุฏ ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ุชุญุชูู ุนูู ุฃุนูุฏุฉ: <em>ุงูุฅูุฌุงุฑ</em> ุ <em>ุงูุฅูุฌุงุฑ</em> ุ <em>ุงููุฌูุก</em> ุ <em>ุฅูุฑุงุฏ_ ุงูุฏุฎู</em> .  ููุงู ุงูุนุฏูุฏ ูู ุงูุทุฑู ูุฅูุดุงุก ูุฐู ุงูููุงุตูุงุช ุ ูููู ุงูุดูุก ุงูุฑุฆูุณู ูู ุฃููุง ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูู ูุฌููุนุฉ ูู ุงูููู ุงููุชุบูุฑุฉ <em>ูุชูุฏูุฑ / ูุฒุงุฑุฉ ุงูุฎุงุฑุฌูุฉ</em> ุ ุซู ุฅูุดุงุก ุงุณู ุงูุนููุฏ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> spec &lt;- us_rent_income %&gt;% expand(variable, .value = c("estimate", "moe")) %&gt;% mutate( .name = paste0(variable, ifelse(.value == "moe", "_moe", "")) )</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 4 x 3 #&gt; variable .value .name #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 income estimate income #&gt; 2 income moe income_moe #&gt; 3 rent estimate rent #&gt; 4 rent moe rent_moe</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชูููุฑ ูุฐู ุงูููุงุตูุงุช ุฅูู <code>pivot_wider()</code> ูุนุทููุง ุงููุชูุฌุฉ ุงูุชู ูุจุญุซ ุนููุง: </p><br><p style=";text-align:right;direction:rtl"> <code>us_rent_income %&gt;% pivot_wider(spec = spec)</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 52 x 6 #&gt; GEOID NAME income income_moe rent rent_moe #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 01 Alabama 24476 136 747 3 #&gt; 2 02 Alaska 32940 508 1200 13 #&gt; 3 04 Arizona 27517 148 972 4 #&gt; 4 05 Arkansas 23789 165 709 5 #&gt; 5 06 California 29454 109 1358 3 #&gt; 6 08 Colorado 32401 109 1125 5 #&gt; 7 09 Connecticut 35326 195 1123 5 #&gt; 8 10 Delaware 31560 247 1076 10 #&gt; 9 11 District of Columbia 43198 681 1424 17 #&gt; 10 12 Florida 25952 70 1077 3 #&gt; # โฆ with 42 more rows</code> </pre> <br><h3 id="vsemirnyy-bank" style=";text-align:right;direction:rtl">  ุงูุจูู ุงูุฏููู </h3><br><p style=";text-align:right;direction:rtl">  ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุชุทูุจ ุฅุญุถุงุฑ ูุฌููุนุฉ ุงูุจูุงูุงุช ุฅูู ุงููููุฐุฌ ุงูุตุญูุญ ุนุฏุฉ ุฎุทูุงุช. <br>  ุชุญุชูู <em>ูุฌููุนุฉ ุจูุงูุงุช</em> world_bank_pop ุนูู ุจูุงูุงุช ูู ุงูุจูู ุงูุฏููู ุญูู ุนุฏุฏ ุณูุงู ูู ุจูุฏ ูู 2000 ุฅูู 2018. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 1,056 x 20 #&gt; country indicator `2000` `2001` `2002` `2003` `2004` `2005` `2006` #&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 ABW SP.URB.Tโฆ 4.24e4 4.30e4 4.37e4 4.42e4 4.47e+4 4.49e+4 4.49e+4 #&gt; 2 ABW SP.URB.Gโฆ 1.18e0 1.41e0 1.43e0 1.31e0 9.51e-1 4.91e-1 -1.78e-2 #&gt; 3 ABW SP.POP.Tโฆ 9.09e4 9.29e4 9.50e4 9.70e4 9.87e+4 1.00e+5 1.01e+5 #&gt; 4 ABW SP.POP.Gโฆ 2.06e0 2.23e0 2.23e0 2.11e0 1.76e+0 1.30e+0 7.98e-1 #&gt; 5 AFG SP.URB.Tโฆ 4.44e6 4.65e6 4.89e6 5.16e6 5.43e+6 5.69e+6 5.93e+6 #&gt; 6 AFG SP.URB.Gโฆ 3.91e0 4.66e0 5.13e0 5.23e0 5.12e+0 4.77e+0 4.12e+0 #&gt; 7 AFG SP.POP.Tโฆ 2.01e7 2.10e7 2.20e7 2.31e7 2.41e+7 2.51e+7 2.59e+7 #&gt; 8 AFG SP.POP.Gโฆ 3.49e0 4.25e0 4.72e0 4.82e0 4.47e+0 3.87e+0 3.23e+0 #&gt; 9 AGO SP.URB.Tโฆ 8.23e6 8.71e6 9.22e6 9.77e6 1.03e+7 1.09e+7 1.15e+7 #&gt; 10 AGO SP.URB.Gโฆ 5.44e0 5.59e0 5.70e0 5.76e0 5.75e+0 5.69e+0 4.92e+0 #&gt; # โฆ with 1,046 more rows, and 11 more variables: `2007` &lt;dbl&gt;, #&gt; # `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;, `2011` &lt;dbl&gt;, `2012` &lt;dbl&gt;, #&gt; # `2013` &lt;dbl&gt;, `2014` &lt;dbl&gt;, `2015` &lt;dbl&gt;, `2016` &lt;dbl&gt;, `2017` &lt;dbl&gt;</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฏููุง ูู ุฅูุดุงุก ูุฌููุนุฉ ุจูุงูุงุช ุฃูููุฉ ุญูุซ ูููู ูู ูุชุบูุฑ ูู ุนููุฏ ูููุตู.  ูู ูุชุถุญ ุจุนุฏ ุงูุฎุทูุงุช ุงูุถุฑูุฑูุฉ ุ ููููุง ุณูุจุฏุฃ ูุน ุงููุดููุฉ ุงูุฃูุซุฑ ูุถูุญูุง: ูุชู ุชูุฒูุน ุงูุณูุฉ ุนูู ุนุฏุฉ ุฃุนูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฅุตูุงุญ ูุฐุง ุงูุฃูุฑ ุ ูุฌุจ ุนููู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ <code>pivot_longer()</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">pop2 &lt;- world_bank_pop %&gt;% pivot_longer(`2000`:`2017`, names_to = "year")</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 19,008 x 4 #&gt; country indicator year value #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 ABW SP.URB.TOTL 2000 42444 #&gt; 2 ABW SP.URB.TOTL 2001 43048 #&gt; 3 ABW SP.URB.TOTL 2002 43670 #&gt; 4 ABW SP.URB.TOTL 2003 44246 #&gt; 5 ABW SP.URB.TOTL 2004 44669 #&gt; 6 ABW SP.URB.TOTL 2005 44889 #&gt; 7 ABW SP.URB.TOTL 2006 44881 #&gt; 8 ABW SP.URB.TOTL 2007 44686 #&gt; 9 ABW SP.URB.TOTL 2008 44375 #&gt; 10 ABW SP.URB.TOTL 2009 44052 #&gt; # โฆ with 18,998 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">   โ   indicator. <br> <code>pop2 %&gt;% count(indicator)</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 4 x 2 #&gt; indicator n #&gt; &lt;chr&gt; &lt;int&gt; #&gt; 1 SP.POP.GROW 4752 #&gt; 2 SP.POP.TOTL 4752 #&gt; 3 SP.URB.GROW 4752 #&gt; 4 SP.URB.TOTL 4752</code> </pre> <br><p style=";text-align:right;direction:rtl">  SP.POP.GROW โ  , SP.POP.TOTL โ   ,  SP.URB. *  ,     .       : area โ  (total  urban)      (population  growth): </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">pop3 &lt;- pop2 %&gt;% separate(indicator, c(NA, "area", "variable"))</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 19,008 x 5 #&gt; country area variable year value #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; #&gt; 1 ABW URB TOTL 2000 42444 #&gt; 2 ABW URB TOTL 2001 43048 #&gt; 3 ABW URB TOTL 2002 43670 #&gt; 4 ABW URB TOTL 2003 44246 #&gt; 5 ABW URB TOTL 2004 44669 #&gt; 6 ABW URB TOTL 2005 44889 #&gt; 7 ABW URB TOTL 2006 44881 #&gt; 8 ABW URB TOTL 2007 44686 #&gt; 9 ABW URB TOTL 2008 44375 #&gt; 10 ABW URB TOTL 2009 44052 #&gt; # โฆ with 18,998 more rows</code> </pre> <br><p style=";text-align:right;direction:rtl">       variable   : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">pop3 %&gt;% pivot_wider(names_from = variable, values_from = value)</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 9,504 x 5 #&gt; country area year TOTL GROW #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 ABW URB 2000 42444 1.18 #&gt; 2 ABW URB 2001 43048 1.41 #&gt; 3 ABW URB 2002 43670 1.43 #&gt; 4 ABW URB 2003 44246 1.31 #&gt; 5 ABW URB 2004 44669 0.951 #&gt; 6 ABW URB 2005 44889 0.491 #&gt; 7 ABW URB 2006 44881 -0.0178 #&gt; 8 ABW URB 2007 44686 -0.435 #&gt; 9 ABW URB 2008 44375 -0.698 #&gt; 10 ABW URB 2009 44052 -0.731 #&gt; # โฆ with 9,494 more rows</code> </pre> <br><h3 id="spisok-kontaktov" style=";text-align:right;direction:rtl">   </h3><br><p style=";text-align:right;direction:rtl">  , ,      ,       -: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">contacts &lt;- tribble( ~field, ~value, "name", "Jiena McLellan", "company", "Toyota", "name", "John Smith", "company", "google", "email", "john@google.com", "name", "Huxley Ratcliffe" )</code> </pre> <br><p style=";text-align:right;direction:rtl">        ,    ,   ,     .    , ,          ("name"),      ,       ,    field   โnameโ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">contacts &lt;- contacts %&gt;% mutate( person_id = cumsum(field == "name") ) contacts</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 6 x 3 #&gt; field value person_id #&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; #&gt; 1 name Jiena McLellan 1 #&gt; 2 company Toyota 1 #&gt; 3 name John Smith 2 #&gt; 4 company google 2 #&gt; 5 email john@google.com 2 #&gt; 6 name Huxley Ratcliffe 3</code> </pre> <br><p style=";text-align:right;direction:rtl"> ,         ,        : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">contacts %&gt;% pivot_wider(names_from = field, values_from = value)</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#&gt; # A tibble: 3 x 4 #&gt; person_id name company email #&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 1 Jiena McLellan Toyota &lt;NA&gt; #&gt; 2 2 John Smith google john@google.com #&gt; 3 3 Huxley Ratcliffe &lt;NA&gt; &lt;NA&gt;</code> </pre> <br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><p style=";text-align:right;direction:rtl">   ,    <strong>tidyr</strong>    ,        <code>spread()</code>  <code>gather()</code> .        <code>pivot_longer()</code>  <code>pivot_wider()</code> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar444622/">https://habr.com/ru/post/ar444622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar444610/index.html">ุฅุญุตุงุกุงุช ููุฑุงูุจุฉ ุงูุจุฑุงูุฌ ุงููุตูุฉ PHP ูู ุงูููุช ุงูุญูููู. ClickHouse ูุบุฑุงูุงูุง ุชุฐูุจ ููุณุงุนุฏุฉ ุจููุจุง</a></li>
<li><a href="../ar444612/index.html">ุงูุถุฑุฑ ุงูููู ูุฑูุฒ C ++</a></li>
<li><a href="../ar444614/index.html">ุชุงุฑูุฎ ููููุณ ุจุฃูููู. ุงูุฌุฒุก ุงูุซุงูู: ุตุนูุฏุง ููุจูุทุง ููุดุฑูุงุช</a></li>
<li><a href="../ar444616/index.html">ุฅูุดุงุก ุฌูุงุฒ ุชุณุฌูู ุตูุชู ุฎุงุต ุจูุธุงู Android ุจุงุณุชุฎุฏุงู Kotlin</a></li>
<li><a href="../ar444620/index.html">ุงุณุชุฎุฏุงู ูููุงุช Linux Kernel Sequence</a></li>
<li><a href="../ar444624/index.html">ุงูุณูุงุฑุงุช ุงูููุฑุจุงุฆูุฉ ุนูู ุงููุงุฑ ูุงูุงุณุชุญูุงู</a></li>
<li><a href="../ar444630/index.html">ููุชุจ ุงููุนูููุงุช: ูุจุงุฏุฑุงุช ุงูุฅูุชุฑูุช ุงูุนุงูููุฉ</a></li>
<li><a href="../ar444634/index.html">ุฃูุนุงุจ ููุญูุฉ ุชููุญ ุงููุทูุฑูู 100 ููููู ุฏููุงุฑ</a></li>
<li><a href="../ar444636/index.html">ููุงุฐุง ูุง ูููููู ุงูููู ููุญุตูู ุนูู ุงููุงู</a></li>
<li><a href="../ar444638/index.html">ุถูุงู ุงูุฌูุฏุฉ ุนูู CodeFest. ุงูุฃุชูุชุฉ ุ ุงูุฅุฏุงุฑุฉ ุ ุงูุจููุฉ ุงูุชุญุชูุฉ ุ ุจูุน ุงูุฒูุงุจูุฉ ูู ุงููุชุฌุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>