<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéø üëêüèΩ üíì Combinando proyectos en diferentes centros de datos üë©üèª‚Äçüé§ üéë üíÖüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, examinaremos por qu√© el enfoque tradicional para combinar redes locales en el nivel L2 es ineficaz con un aumento significativo en l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Combinando proyectos en diferentes centros de datos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/436648/"><img src="https://habrastorage.org/webt/zy/ry/ey/zyryeyqpveem2dyaws3drxmvori.png"><br><br>  En este art√≠culo, examinaremos por qu√© el enfoque tradicional para combinar redes locales en el nivel L2 es ineficaz con un aumento significativo en la cantidad de equipos, y le diremos qu√© problemas pudimos resolver en el proceso de combinar proyectos ubicados en diferentes sitios. <br><br><h2>  Circuito L2 normal </h2><br>  A medida que la infraestructura de TI crece en el centro de datos, los clientes deben combinar servidores, almacenamiento, firewalls en una sola red.  Para esto, Selectel inicialmente sugiere usar una red de √°rea local. <br><br>  La red local est√° organizada como una red cl√°sica de "campus" dentro del mismo centro de datos, solo los conmutadores de acceso se encuentran directamente en los bastidores con los servidores.  Los conmutadores de acceso se combinan en un solo conmutador de capa de agregaci√≥n.  Cada cliente puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">solicitar una conexi√≥n</a> a la red local para cualquier dispositivo que alquile o coloque con nosotros en el centro de datos. <br><a name="habracut"></a><br>  Para organizar una red local, se utilizan conmutadores de acceso y agregaci√≥n dedicados, de modo que los problemas en la red de Internet no afecten a la red local. <br><br><img src="https://habrastorage.org/webt/j5/a5/re/j5a5re8shkxu356b54gjja2-mbg.png" title="Esquema de ejemplo para un cliente"><br>  No importa en qu√© rack se encuentre el pr√≥ximo servidor: Selectel combina los servidores en una sola red local y no tiene que pensar en los conmutadores o la ubicaci√≥n del servidor.  Puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">solicitar un servidor</a> cuando sea necesario y se conectar√° a la red local. <br><br>  L2 funciona muy bien, mientras que el tama√±o del centro de datos es peque√±o, cuando no todos los bastidores est√°n llenos.  Pero a medida que aumenta el n√∫mero de bastidores, servidores en bastidores, conmutadores, clientes, el circuito se vuelve mucho m√°s dif√≠cil de mantener. <br><br><img src="https://habrastorage.org/webt/tg/kw/im/tgkwimba1eybjn6vngl8yohqsm0.png" title="Esquema de ejemplo para m√∫ltiples clientes"><br>  Los servidores de un cliente se pueden ubicar en varios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">centros de datos</a> para garantizar la tolerancia a desastres o si es imposible colocar el servidor en un centro de datos existente (por ejemplo, todos los bastidores y todos los lugares est√°n ocupados).  Entre varios centros de datos, tambi√©n es necesaria la conectividad, entre servidores en una red local. <br><br>  A medida que crece el n√∫mero de centros de datos, bastidores y servidores, el circuito se vuelve m√°s complicado.  Al principio, la conectividad entre los servidores de diferentes centros de datos se llev√≥ a cabo simplemente a nivel de conmutadores de agregaci√≥n utilizando tecnolog√≠a VLAN. <br><br><img src="https://habrastorage.org/webt/dj/jd/rf/djjdrfihfysh2jo3tblzpa4evmk.png" title="Un esquema de ejemplo para un solo cliente en varios centros de datos"><br>  Pero el espacio de identificaci√≥n de VLAN es muy limitado (4095 ID de VLAN).  Entonces, para cada centro de datos, debe usar su propio conjunto de VLAN, lo que reduce la cantidad de identificadores posibles que se pueden usar entre los centros de datos. <br><br><h2>  Problemas L2 </h2><br>  Cuando se usa un esquema en el nivel L2 usando VLAN, la operaci√≥n incorrecta de uno de los servidores en el centro de datos puede provocar interrupciones en la provisi√≥n de servicios en otros servidores.  Los problemas m√°s comunes incluyen: <br><br><ul><li> Problemas con STP (Protocolo Spanning-Tree) </li><li>  Problemas con tormentas de difusi√≥n </li><li>  Problemas con el procesamiento incorrecto de multidifusi√≥n </li><li>  Factor humano (transferencia de enlace, transferencia de VLAN) </li><li>  Problemas con la organizaci√≥n de la reserva para L2 </li><li>  Problemas con el tr√°fico de unidifusi√≥n desconocida </li><li>  Problemas con la cantidad de direcciones MAC </li></ul><br>  Los problemas con STP a menudo se relacionan con la configuraci√≥n de los servidores del cliente o del equipo del cliente.  A diferencia de los puntos de intercambio de tr√°fico populares, no podemos filtrar completamente el STP en los puertos de acceso y los puertos de enfriamiento cuando llega una PDU STP.  En STP, varios fabricantes de equipos de red implementan la funcionalidad b√°sica de los conmutadores del centro de datos como la detecci√≥n de bucles en la red. <br><br>  Si STP no funciona correctamente en el lado del cliente, el dominio STP completo de al menos un conmutador de acceso puede verse afectado.  El uso de extensiones STP, como MSTP, tampoco es una soluci√≥n, porque la cantidad de puertos, VLAN y conmutadores a menudo excede la escalabilidad arquitect√≥nica del protocolo STP. <br><br><h3>  Broadcast </h3><br>  La red en el centro de datos se puede construir en dispositivos de diferentes fabricantes.  A veces, incluso las diferencias en la versi√≥n del software del conmutador son suficientes para que los conmutadores manejen el STP de manera diferente.  Entonces, por ejemplo, en el centro de datos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dubrovka 3</a> hay 280 bastidores, que exceden el n√∫mero m√°ximo posible de conmutadores en un dominio STP. <br><br>  Con el uso generalizado de STP en dicha red, el tiempo de respuesta a cualquier cambio, en particular, simplemente al encender o apagar el puerto, exceder√° todos los umbrales de espera.  ¬øNo desea que cuando uno de los clientes encienda el puerto, su conectividad de red desaparezca durante varios minutos? <br><br>  Los problemas con el tr√°fico de difusi√≥n a menudo surgen tanto por acciones incorrectas en el servidor (por ejemplo, creando un puente entre varios puertos del servidor) como por la configuraci√≥n incorrecta del software en los servidores.  Tratamos de nivelar posibles problemas con la cantidad de tr√°fico de transmisi√≥n que llega a nuestra red.  Pero podemos hacer esto en un puerto de conexi√≥n de servidor, y si se incluyen 5 servidores en un conmutador, cada uno de los cuales no excede los umbrales establecidos, entonces juntos pueden generar suficiente tr√°fico para activar el control en el conmutador de agregaci√≥n.  Seg√∫n nuestra propia pr√°ctica, los problemas con una tormenta de transmisi√≥n desde el lado del servidor pueden ser causados ‚Äã‚Äãpor una falla espec√≠fica de la tarjeta de red del servidor. <br><br>  Al proteger toda la red, el conmutador de agregaci√≥n "colocar√°" el puerto en el que se produjo la anomal√≠a de la red.  Desafortunadamente, esto conducir√° a la inoperancia de los cinco servidores que causaron este incidente, as√≠ como a la inoperancia de otros servidores (hasta varios bastidores en el centro de datos). <br><br><h3>  Multidifusi√≥n </h3><br>  Los problemas con el procesamiento incorrecto del tr√°fico de multidifusi√≥n son problemas muy espec√≠ficos que surgen en el complejo debido al funcionamiento incorrecto del software en el servidor y el software en el conmutador.  Por ejemplo, Corosync se configura en modo multidifusi√≥n entre varios servidores.  Regularmente el intercambio de paquetes de saludo se realiza en peque√±os vol√∫menes.  Pero en algunos casos, los servidores con Corosync instalado pueden reenviar una gran cantidad de paquetes.  Este volumen ya requiere una configuraci√≥n especial de los conmutadores o el uso de los mecanismos de procesamiento correctos (combinaci√≥n IGMP y otros).  En caso de funcionamiento incorrecto de los mecanismos o cuando se activan los umbrales, puede haber interrupciones del servicio que afecten a otros clientes.  Por supuesto, cuantos menos clientes en el switch, menos probable es que ocurran problemas de otro cliente. <br><br>  El factor humano es un tipo de problema bastante imprevisto que puede surgir al trabajar con equipos de red.  Cuando el administrador de la red est√° solo y construye su trabajo de manera competente, documenta las acciones y reflexiona sobre las consecuencias de sus acciones, entonces la probabilidad de un error es bastante peque√±a.  Pero cuando la cantidad de equipos en funcionamiento del centro de datos est√° creciendo, cuando hay muchos empleados, cuando hay muchas tareas, se requiere un enfoque completamente diferente para la organizaci√≥n del trabajo. <br><br>  Algunos tipos de acciones t√≠picas est√°n automatizadas para evitar errores humanos, pero muchos tipos de acciones no pueden automatizarse en este momento, o el precio de la automatizaci√≥n de tales acciones es irrazonablemente alto.  Por ejemplo, el cambio f√≠sico de los cables de conexi√≥n en un panel de conexi√≥n, la conexi√≥n de nuevos enlaces, la sustituci√≥n de enlaces existentes.  Todo lo relacionado con el contacto f√≠sico con SCS.  S√≠, hay paneles de conexi√≥n que permiten la conmutaci√≥n remota, pero son muy caros, requieren mucho trabajo preparatorio y tienen capacidades muy limitadas. <br><br>  Ning√∫n panel de conexi√≥n autom√°tico colocar√° un nuevo cable si es necesario.  Puede cometer un error al configurar un conmutador o enrutador.  Indique el n√∫mero de puerto incorrecto, el n√∫mero de VLAN, que se sellar√° al ingresar un valor num√©rico.  Al especificar cualquier configuraci√≥n adicional, no tenga en cuenta su influencia en la configuraci√≥n existente.  Con la complejidad creciente del esquema, lo que complica el esquema de redundancia (por ejemplo, debido a que el esquema actual alcanza el l√≠mite de escala), aumenta la probabilidad de errores humanos.  Cualquiera puede tener un error humano, independientemente de si el dispositivo se encuentra en la etapa de configuraci√≥n, un servidor, un conmutador, un enrutador o alg√∫n tipo de dispositivo de tr√°nsito. <br><br>  Organizar copias de seguridad L2 a primera vista parece una tarea sencilla para redes peque√±as.  El curso de Cisco ICND cubre los conceptos b√°sicos del uso de STP como protocolo originalmente dise√±ado para proporcionar redundancia L2.  STP tiene muchas restricciones que se denominan "por dise√±o" en este protocolo.  No debemos olvidar que cualquier dominio STP tiene un "ancho" muy limitado, es decir, el n√∫mero de dispositivos en un dominio STP es bastante peque√±o en comparaci√≥n con el n√∫mero de bastidores en el centro de datos.  El protocolo STP en su versi√≥n original divide los enlaces en usados ‚Äã‚Äãy de respaldo, lo que no proporciona una utilizaci√≥n completa de los enlaces ascendentes durante el funcionamiento normal. <br><br>  El uso de otros protocolos de reserva L2 impone sus limitaciones.  Por ejemplo, ERPS (Ethernet Ring Protection Switching): para la topolog√≠a f√≠sica utilizada, para el n√∫mero de anillos en un dispositivo, para la utilizaci√≥n de todos los enlaces.  El uso de otros protocolos, por regla general, implica cambios de propiedad de diferentes fabricantes o limita la construcci√≥n de la red a una tecnolog√≠a seleccionada (por ejemplo, TRILL / SPBm-factory usando el equipo Avaya). <br><br><h3>  Desconocido-unidifusi√≥n </h3><br>  Me gustar√≠a destacar especialmente el subtipo de problemas con tr√°fico de unidifusi√≥n desconocido.  Que es esto  El tr√°fico destinado a una direcci√≥n IP espec√≠fica a trav√©s de L3, pero se transmite en la red a trav√©s de L2, es decir, se transmite a todos los puertos que pertenecen a esta VLAN.  Esta situaci√≥n puede surgir por varias razones, por ejemplo, al recibir DDoS en una direcci√≥n IP desocupada.  O si durante un error tipogr√°fico en la configuraci√≥n del servidor se especific√≥ una direcci√≥n que no existe en la red como respaldo, y en el servidor hist√≥ricamente hay un registro ARP est√°tico en esta direcci√≥n.  La unidifusi√≥n desconocida aparece cuando todas las entradas en las tablas ARP est√°n presentes, pero en ausencia de la direcci√≥n MAC del receptor en las tablas de conmutaci√≥n de los conmutadores de tr√°nsito. <br><br>  Por ejemplo, el puerto detr√°s del cual se encuentra el host de red con la direcci√≥n dada a menudo pasa al estado desactivado.  Este tipo de tr√°fico est√° limitado por los conmutadores de tr√°nsito y, a menudo, se sirve de la misma manera que la difusi√≥n o la multidifusi√≥n.  Pero a diferencia de ellos, el tr√°fico de unidifusi√≥n desconocida puede iniciarse "desde Internet", y no solo desde la red del cliente.  El riesgo de tr√°fico de unidifusi√≥n desconocida es especialmente alto cuando las reglas de filtrado en los enrutadores fronterizos permiten la falsificaci√≥n de direcciones IP desde el exterior. <br><br>  Incluso la gran cantidad de direcciones MAC a veces puede ser un problema.  Parece que con un tama√±o de centro de datos de 200 bastidores, 40 servidores por bastidor, es poco probable que la cantidad de direcciones MAC exceda en gran medida la cantidad de servidores en el centro de datos.  Pero esto ya no es una declaraci√≥n verdadera, ya que uno de los sistemas de virtualizaci√≥n se puede iniciar en los servidores, y cada m√°quina virtual se puede representar por su direcci√≥n MAC, o incluso varias (al emular varias tarjetas de red en una m√°quina virtual, por ejemplo).  En total, podemos obtener m√°s de varios miles de direcciones MAC leg√≠timas de un rack en 40 servidores. <br><br>  Tal cantidad de direcciones MAC puede afectar la plenitud de la tabla de conmutaci√≥n en algunos modelos de conmutaci√≥n.  Adem√°s, para ciertos modelos de conmutadores, cuando se completa la tabla de conmutaci√≥n, se utiliza el hashing y algunas direcciones MAC pueden causar colisiones de hash que conducen a la aparici√≥n de tr√°fico de unidifusi√≥n desconocido.  La b√∫squeda aleatoria de direcciones MAC en un servidor arrendado a una velocidad de, por ejemplo, 4.000 direcciones por segundo, puede hacer que la tabla de conmutaci√≥n se desborde en el conmutador de acceso.  Naturalmente, los conmutadores aplican restricciones en la cantidad de direcciones MAC que se pueden aprender en los puertos del conmutador, pero dependiendo de la implementaci√≥n espec√≠fica de este mecanismo, los datos se pueden interpretar de diferentes maneras. <br><br>  Nuevamente, enviar tr√°fico a la direcci√≥n MAC filtrada por este mecanismo conduce a la aparici√≥n de tr√°fico de unidifusi√≥n desconocido.  Lo m√°s desagradable en esta situaci√≥n es que los interruptores rara vez son probados por el fabricante para la autocuraci√≥n despu√©s de casos con desbordamiento de la mesa de conmutaci√≥n.  Un solo desbordamiento de la tabla, causado, por ejemplo, por un error de un cliente en los par√°metros de hping o al escribir un script que monitorea su infraestructura, puede provocar el reinicio del conmutador y la interrupci√≥n de la comunicaci√≥n para todos los servidores ubicados en el rack.  Si se produce un desbordamiento de este tipo en el conmutador de nivel de agregaci√≥n, reiniciar el conmutador puede provocar un tiempo de inactividad de 15 minutos de toda la red local del centro de datos. <br><br>  Me gustar√≠a transmitir que el uso de L2 est√° justificado solo para casos limitados e impone muchas restricciones.  El tama√±o del segmento, el n√∫mero de segmentos L2: estos son todos los par√°metros que deben evaluarse cada vez que agrega una nueva VLAN con conectividad L2.  Y cuanto m√°s peque√±os son los segmentos L2, m√°s simple y, como resultado, m√°s confiable es la red en servicio. <br><br><h2>  Casos de uso t√≠picos de L2 </h2><br>  Como ya se mencion√≥, con el desarrollo gradual de la infraestructura en un centro de datos, se utiliza una red local L2.  Desafortunadamente, este uso tambi√©n est√° implicado en el desarrollo de proyectos en otro centro de datos o en otra tecnolog√≠a (por ejemplo, m√°quinas virtuales en la nube). <br><br><h3>  Enlace frontal y back-end, respaldo </h3><br>  Como regla general, el uso de una red local comienza con la separaci√≥n de la funcionalidad de los servicios front-end y back-end, asignando el DBMS a un servidor separado (para mejorar el rendimiento, para separar el tipo de sistema operativo en el servidor de aplicaciones y DBMS).  Inicialmente, el uso de L2 para estos fines parece justificado, en el segmento solo hay unos pocos servidores, a menudo incluso se encuentran en el mismo rack. <br><br><img src="https://habrastorage.org/webt/je/gf/1p/jegf1phbpite5kxigvt3vxmyj6a.png" title="Segmento L2 simple"><br>  Los servidores est√°n incluidos en una VLAN, en uno o varios conmutadores.  A medida que aumenta la cantidad de equipos, se incluyen cada vez m√°s servidores nuevos en los conmutadores de nuevos bastidores en el centro de datos, desde los cuales el dominio L2 comienza a crecer en ancho. <br><br><img src="https://habrastorage.org/webt/j5/a5/re/j5a5re8shkxu356b54gjja2-mbg.png" title="Extensi√≥n del segmento L2"><br>  Aparecen nuevos servidores, incluidos servidores de bases de datos de respaldo, servidores de respaldo y similares.  Mientras el proyecto vive en un centro de datos, los problemas de escala, por regla general, no surgen.  Los desarrolladores de aplicaciones simplemente se acostumbran al hecho de que en el pr√≥ximo servidor de la red local, la direcci√≥n IP cambia solo en el √∫ltimo octeto, y no es necesario que escriba ninguna regla de enrutamiento por separado. <br><br>  Se les pide a los desarrolladores que apliquen un esquema similar al crecimiento del proyecto, cuando los siguientes servidores ya se alquilan en otro centro de datos o cuando una parte del proyecto se traslada a m√°quinas virtuales <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en la nube</a> .  En la imagen, todo se ve muy simple y hermoso: <br><br><img src="https://habrastorage.org/webt/bx/2y/ho/bx2yholhikhhkjpdaavttkfgucm.png" title="Un ejemplo de combinaci√≥n de dos sitios usando L2"><br>  Parece que solo necesita conectar dos conmutadores de agregaci√≥n en DC1 y DC2 con una VLAN.  Pero, ¬øqu√© hay detr√°s de esta simple acci√≥n? <br><br><h3>  Reserva de recursos </h3><br>  Primero, aumentamos el ancho del dominio L2, por lo que todos los problemas potenciales de la red local de DC1 pueden surgir en DC2.  ¬øA qui√©n le gustar√≠a que sus servidores est√©n ubicados en DC2, y el incidente relacionado con la inaccesibilidad de la red local ocurrir√° debido a acciones incorrectas dentro de DC1? <br><br>  En segundo lugar, debe encargarse de hacer una copia de seguridad de esta VLAN.  El conmutador de agregaci√≥n en cada centro de datos es el punto de falla.  El cable entre los centros de datos es otro punto de falla.  Cada punto de falla debe ser reservado.  Dos conmutadores de agregaci√≥n, dos cables de conmutadores de agregaci√≥n a conmutadores de acceso, dos cables entre centros de datos ... Cada vez que aumenta el n√∫mero de componentes, y el circuito se vuelve m√°s complicado. <br><br><img src="https://habrastorage.org/webt/nq/ku/ws/nqkuws41ips807benbzzemxfzry.png" title="Ejemplo de esquema L2 redundante"><br>  La complejidad del esquema es causada por la necesidad de reservar cada elemento en el sistema.  Para una copia de seguridad completa de dispositivos y enlaces, debe duplicar casi todos los elementos.  En una red tan grande, ya no es posible usar STP para organizar la redundancia.  Ser√≠a posible presentar todos los elementos de red, en particular los conmutadores de acceso, como componentes de la nube MPLS, luego se obtendr√≠a redundancia debido a la funcionalidad del protocolo MPLS. <br><br>  Pero los dispositivos MPLS suelen ser dos veces m√°s caros que los dispositivos que no son MPLS.  Y debe tenerse en cuenta que el conmutador MPU en 1U, que tiene un buen grado de escalabilidad, la implementaci√≥n de la funcionalidad MPLS completa en el plano de control, en la pr√°ctica, no exist√≠a hasta hace poco.  Como resultado, deseo eliminar o minimizar el impacto de los problemas de L2 en la red existente, pero al mismo tiempo mantener la capacidad de reservar recursos. <br><br><h2>  Transici√≥n a L3 </h2><br>  Si cada enlace en la red se representa como un segmento IP separado, y cada dispositivo como un enrutador separado, entonces no necesitamos redundancia en el nivel L2.  La redundancia de enlaces y enrutadores se garantiza mediante protocolos de enrutamiento din√°mico y redundancia de enrutamiento en la red. <br><br>  Dentro del centro de datos, podemos guardar los esquemas de interacci√≥n del servidor existentes entre s√≠ a trav√©s de L2, y el acceso a los servidores en otro centro de datos ser√° a trav√©s de L3. <br><br><img src="https://habrastorage.org/webt/hc/2q/n4/hc2qn4wcnecwsrrkxh-daualss8.png" title="Conectividad del sitio con L3"><br>  Por lo tanto, los centros de datos est√°n interconectados por la conectividad L3.  Es decir, se emula que se instala un enrutador entre los centros de datos (de hecho, varios, para respaldo).  Esto le permite dividir dominios L2 entre centros de datos, usar su propia VLAN en cada centro de datos y comunicarse entre ellos.  Para cada cliente, puede usar rangos repetidos de direcciones IP, las redes est√°n completamente aisladas unas de otras y no puede acceder a la red de otro cliente desde la red de un cliente (excepto cuando ambos clientes acuerdan dicha conexi√≥n). <br><br>  Recomendamos que utilice segmentos IP del direccionamiento 10.0.0.0/8 para redes locales.  Para el primer centro de datos, la red ser√°, por ejemplo, 10.0.1.0/24, para el segundo - 10.0.2.0/24.  Selectel en el enrutador prescribe la direcci√≥n IP de esta subred.  Por lo general, las direcciones .250-.254 est√°n reservadas para los dispositivos de red Selectel, y una direcci√≥n .254 sirve como puerta de entrada a otras LAN.  La ruta se asigna a todos los dispositivos en todos los centros de datos: <br><br> <code>route add 10.0.0.0 mask 255.0.0.0 gw 10.0.x.254</code> <br> <br>  Donde x es el n√∫mero del centro de datos.  Debido a esta ruta, los servidores en los centros de datos se "ven" entre s√≠ por enrutamiento. <br><br><img src="https://habrastorage.org/webt/hf/x6/h1/hfx6h13labuqr97rfirrzwtw8nk.png" title="Ejemplo de enrutamiento para combinar dos sitios en L3"><br>  La presencia de dicha ruta simplifica la escala del esquema en el caso, por ejemplo, la aparici√≥n de un tercer centro de datos.  Luego, para los servidores en el tercer centro de datos, las direcciones IP del siguiente rango, 10.0.3.0/24, se registran en el enrutador, la direcci√≥n 10.0.3.254. <br><br><img src="https://habrastorage.org/webt/r_/lg/n5/r_lgn5-xrch-wfcytnqvyy7ujiy.png" title="Ejemplo de enrutamiento para combinar tres sitios en L3"><br>  Una caracter√≠stica distintiva de la implementaci√≥n de tal esquema es que no requiere reserva adicional en caso de falla del centro de datos o canales de comunicaci√≥n externos.  Entonces, por ejemplo, si el centro de datos 1 falla, la conexi√≥n entre el centro de datos 2 y el centro de datos 3 se conserva por completo, y al implementar el esquema con la alimentaci√≥n L2 entre los centros de datos a trav√©s de uno de ellos, como en la figura: <br><br><img src="https://habrastorage.org/webt/dj/jd/rf/djjdrfihfysh2jo3tblzpa4evmk.png" title="Operaci√≥n de enrutamiento al guardar esquemas L2"><br>  La conexi√≥n entre el centro de datos 2 y el centro de datos 3 depende de la eficiencia del centro de datos 1. O bien, se requiere la organizaci√≥n de enlaces adicionales y el uso de esquemas de reserva L2 complejos.  Y al guardar el esquema L2, toda la red sigue siendo muy sensible a la conmutaci√≥n incorrecta, la formaci√≥n de bucles de conmutaci√≥n, varias tormentas de tr√°fico y otros problemas. <br><br><h3>  Segmentos L3 dentro de proyectos </h3><br>  Adem√°s de usar diferentes segmentos L3 en diferentes centros de datos, tiene sentido asignar una red L3 separada para servidores en diferentes proyectos, a menudo realizados con diferentes tecnolog√≠as.  Por ejemplo, servidores de hardware en el centro de datos en una subred IP, servidores virtuales en el mismo centro de datos, pero en la nube VMware, en otra subred IP, algunos servidores relacionados con la organizaci√≥n en la tercera subred IP .  Entonces, los errores aleatorios en uno de los segmentos no conducen a una falla completa de todos los servidores incluidos en la red local. <br><br><img src="https://habrastorage.org/webt/v3/zi/gd/v3zigd00-7klicdt31likdem460.png" title="Segmentaci√≥n de redes de diferentes proyectos a nivel L3."><br><h2>  Reserva de enrutador </h2><br>  Todo esto es impresionante, pero hay un solo punto de falla entre proyectos: este es el enrutador.  ¬øQu√© hacer en este caso?  De hecho, el enrutador no est√° solo.  Se asignan dos enrutadores para cada centro de datos, y para cada cliente forman Virtual IP .254 utilizando el protocolo VRRP. <br><br>  El uso de VRRP entre dos dispositivos adyacentes con un segmento L2 com√∫n est√° justificado.  Para los centros de datos que se distribuyen geogr√°ficamente, se utilizan diferentes enrutadores y MPLS se organiza entre ellos.  Por lo tanto, cada cliente que se conecta a la red local de esta manera est√° conectado a un L3VPN separado hecho para √©l en estos enrutadores MPLS.  Y el esquema, en aproximaci√≥n a la realidad, se ve as√≠: <br><br><img src="https://habrastorage.org/webt/9y/ae/s8/9yaes8vvilol5-zrhikhychdvs4.png" title="Organizaci√≥n de reserva"><br>  La direcci√≥n de puerta de enlace para cada segmento .254 est√° reservada por VRRP entre los dos enrutadores. <br><br><h2>  Conclusi√≥n </h2><br>  Resumiendo todo lo anterior: cambiar el tipo de red local de L2 a L3 nos permiti√≥ mantener la capacidad de escalar, aument√≥ el nivel de confiabilidad y tolerancia a fallas, y tambi√©n nos permiti√≥ implementar esquemas de redundancia adicionales.  Adem√°s, esto eludi√≥ las restricciones existentes y las "trampas" de L2. <br><br>  A medida que crecen los proyectos y los centros de datos, las soluciones est√°ndar existentes alcanzan su l√≠mite de escalabilidad.  Esto significa que ya no son adecuados para la resoluci√≥n efectiva de problemas.  Los requisitos de fiabilidad y estabilidad del sistema en su conjunto aumentan constantemente, lo que a su vez afecta el proceso de planificaci√≥n.  Es importante tener en cuenta el hecho de que deben considerarse pron√≥sticos de crecimiento optimistas para que en el futuro no exista un sistema que no pueda escalarse. <br><br>  Cu√©ntanos: ¬øya est√°s usando L3VPN?  Nos vemos en los comentarios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es436648/">https://habr.com/ru/post/es436648/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es436638/index.html">Redistribuir ventanas entre monitores despu√©s de salir del modo de suspensi√≥n</a></li>
<li><a href="../es436640/index.html">Mi experiencia en publicidad y desarrollo de aplicaciones Android e iOS</a></li>
<li><a href="../es436642/index.html">Ticket to Ride.Europe: pasos modestos en la aritm√©tica del juego</a></li>
<li><a href="../es436644/index.html">S√≠mbolos sint√©ticos y m√≥dulos (WinDbg / DbgEng)</a></li>
<li><a href="../es436646/index.html">Transl√∫cido en Android y ajuste.</a></li>
<li><a href="../es436650/index.html">3 estrategias ganadoras de monetizaci√≥n de aplicaciones en 2019</a></li>
<li><a href="../es436652/index.html">MPS 2018.3: planes de generaci√≥n, mejoras en el lenguaje de ensamblaje y empaquetado y en el lenguaje del editor, interfaz actualizada</a></li>
<li><a href="../es436654/index.html">Desarrollo de un equipo para consultar datos de la base de datos - parte 4, concluyendo</a></li>
<li><a href="../es436656/index.html">Automatizaci√≥n para los aut√≥nomos: c√≥mo integrar los impuestos con un proyecto de TI</a></li>
<li><a href="../es436658/index.html">El futuro del comercio minorista: tendencias digitales clave basadas en el Big Show 2019 de NRF Retail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>