<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦃 🐂 👥 Aplikasi Praktis Transformasi Pohon AST Menggunakan Putout sebagai Contoh 🛍️ 🚙 🐶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendahuluan 


 Setiap hari ketika bekerja pada kode, dalam perjalanan untuk mengimplementasikan fungsional yang bermanfaat bagi pengguna, perubahan d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aplikasi Praktis Transformasi Pohon AST Menggunakan Putout sebagai Contoh</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439564/"><h2 id="vvedenie">  Pendahuluan </h2><br><p>  Setiap hari ketika bekerja pada kode, dalam perjalanan untuk mengimplementasikan fungsional yang bermanfaat bagi pengguna, perubahan dipaksa (tidak terhindarkan, atau hanya diinginkan) menjadi kode.  Ini bisa menjadi refactoring, memperbarui perpustakaan atau kerangka kerja ke versi utama baru, memperbarui sintaksis JavaScript (yang tidak jarang baru-baru ini).  Sekalipun perpustakaan adalah bagian dari proyek kerja, perubahan tidak dapat dihindari.  Sebagian besar perubahan ini bersifat rutin.  Tidak ada yang menarik bagi pengembang di dalamnya, di satu sisi, di sisi lain, itu tidak membawa apa-apa ke bisnis, dan di ketiga, selama proses pembaruan, Anda harus sangat berhati-hati untuk tidak merusak kayu bakar dan tidak merusak fungsionalitas.  Dengan demikian, kita sampai pada kesimpulan bahwa lebih baik untuk menggeser rutinitas seperti itu ke pundak program sehingga mereka akan melakukan semuanya sendiri, dan orang itu, pada gilirannya, akan mengontrol apakah semuanya dilakukan dengan benar.  Inilah yang akan dibahas dalam artikel hari ini. </p><a name="habracut"></a><br><h2 id="ast">  AST </h2><br><p> Untuk pemrosesan kode program, perlu menerjemahkannya ke dalam representasi khusus, yang akan memudahkan program untuk bekerja.  Representasi seperti itu ada, itu disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pohon Sintaksis Abstrak</a> (AST). <br>  Untuk mendapatkannya, gunakan parser.  AST yang dihasilkan dapat diubah sesuai keinginan Anda, dan untuk menyimpan hasilnya Anda memerlukan pembuat kode.  Mari kita perhatikan secara lebih rinci setiap langkah.  Mari kita mulai dengan parser. </p><br><h3 id="parser">  Parser </h3><br><p>  Dan kita punya kodenya: </p><br><pre><code class="javascript hljs">a + b</code> </pre> <br><p>  Parser biasanya dibagi menjadi dua bagian: </p><br><ul><li>  Analisis leksikal </li></ul><br><p>  Memecah kode menjadi token, yang masing-masing menggambarkan bagian dari kode: </p><br><pre> <code class="json hljs">[{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"Identifier"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"a"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"Punctuator"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"+"</span></span>, }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"Identifier"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"b"</span></span> }]</code> </pre> <br><ul><li>  Parsing </li></ul><br><p>  Membangun pohon sintaksis dari token: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"BinaryExpression"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"left"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"Identifier"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"a"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"operator"</span></span>: <span class="hljs-string"><span class="hljs-string">"+"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"right"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"Identifier"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"b"</span></span> } }</code> </pre> <br><p>  Dan sekarang kita sudah memiliki gagasan itu, yang dengannya Anda dapat bekerja secara terprogram.  Perlu diklarifikasi bahwa ada sejumlah besar parser <code>JavaScript</code> , berikut adalah beberapa di antaranya: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">babel-parser</a> - parser yang menggunakan <code>babel</code> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">espree</a> - parser yang menggunakan <code>eslint</code> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">acorn</a> - parser yang menjadi dasar dua sebelumnya; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">esprima</a> - parser populer yang mendukung JavaScript hingga EcmaScript 2017; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">cherow</a> adalah pemain baru di antara parser JavaScript yang mengklaim sebagai yang tercepat; </li></ul><br><p>  Ada parser JavaScript standar, ini disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ESTree</a> dan mendefinisikan node mana yang harus diuraikan. <br>  Untuk analisis yang lebih rinci tentang proses penerapan parser (serta trafo dan generator), Anda dapat membaca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kompiler super-kecil</a> . </p><br><h3 id="transformator">  Transformer </h3><br><p>  Untuk mengubah pohon AST, Anda dapat menggunakan pola <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengunjung</a> , misalnya, menggunakan perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@ babel / traverse</a> .  Kode berikut akan menampilkan nama semua pengidentifikasi kode JavaScript dari variabel <code>code</code> . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> parser <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@babel/parser"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> traverse <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"@babel/traverse"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> code = <span class="hljs-string"><span class="hljs-string">`function square(n) { return n * n; }`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ast = parser.parse(code); traverse(ast, { Identifier(path) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(path.node.name); } });</code> </pre> <br><h3 id="generator">  Generator </h3><br><p>  Anda dapat menghasilkan kode, misalnya, menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@ babel / generator</a> , dengan cara ini: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {parse} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@babel/parser'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> generate <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@babel/generator'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> code = <span class="hljs-string"><span class="hljs-string">'class Example {}'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ast = parse(code); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> output = generate(ast, code);</code> </pre> <br><p>  Jadi, pada tahap ini, pembaca seharusnya mendapat ide dasar tentang apa yang diperlukan untuk mengubah kode JavaScript, dan dengan alat apa yang diterapkan. </p><br><p>  Ini juga layak ditambahkan alat online seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">astexplorer</a> , itu menggabungkan sejumlah besar parser, transformer, dan generator. </p><br><h2 id="putout">  Putout </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Putout</a> adalah transformator kode yang diaktifkan plugin.  Bahkan, itu adalah persilangan antara <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">eslint</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">babel</a> , menggabungkan keunggulan dari kedua alat. </p><br><p>  Bagaimana <code>eslint</code> <code>putout</code> menunjukkan area masalah dalam kode, tetapi tidak seperti <code>eslint</code> <code>putout</code> mengubah perilaku kode, yaitu, ia dapat memperbaiki semua kesalahan yang dapat ditemukan. </p><br><p>  Seperti <code>babel</code> <code>putout</code> mengonversi kode, tetapi mencoba mengubahnya secara minimal, sehingga dapat digunakan untuk bekerja dengan kode yang disimpan dalam repositori. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Prettier</a> juga layak disebut, itu adalah alat pemformatan, dan berbeda secara radikal. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jscodeshift</a> terletak tidak jauh dari <code>putout</code> , tetapi tidak mendukung plugins, tidak menampilkan pesan kesalahan, dan juga menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tipe ast,</a> bukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@ babel / tipe</a> . </p><br><h3 id="istoriya-poyavleniya">  Kisah penampilan </h3><br><p>  Dalam prosesnya, <code>eslint</code> membantu saya dengan tips saya.  Tapi kadang-kadang aku ingin lebih banyak darinya.  Misalnya, untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menghapus debugger</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perbaiki test.only</a> , dan juga hapus variabel yang tidak digunakan.  Poin terakhir membentuk dasar <code>putout</code> , selama proses pengembangan, menjadi jelas bahwa itu sangat sulit dan banyak transformasi lainnya lebih mudah untuk diimplementasikan.  Dengan demikian, <code>putout</code> lancar tumbuh dari satu fungsi ke sistem plugin.  Menghapus variabel yang tidak terpakai sekarang merupakan proses yang paling sulit, tetapi ini tidak menghalangi kita untuk mengembangkan dan mendukung banyak transformasi lain yang sama bermanfaatnya. </p><br><h3 id="kak-putout-ustroen-iznutri">  Cara Kerja Putout Di Dalam </h3><br><p>  Pekerjaan <code>putout</code> dapat dibagi menjadi dua bagian: engine dan plugins.  Arsitektur ini memungkinkan Anda untuk tidak terganggu oleh transformasi saat bekerja dengan mesin, dan ketika bekerja pada plug-in, Anda akan fokus sebanyak mungkin pada tujuannya. </p><br><h4 id="vstroennye-plaginy">  Plugin bawaan </h4><br><p>  <code>putout</code> dibangun di atas sistem plugin.  Setiap plugin mewakili satu aturan.  Menggunakan aturan bawaan, Anda dapat melakukan hal berikut: </p><br><ul><li><p>  Temukan dan hapus: </p><br><ul><li>  variabel yang tidak digunakan </li><li> <code>debugger</code> </li> <li>  panggil <code>test.only</code> </li><li>  hubungi <code>test.skip</code> </li><li>  hubungi <code>console.log</code> </li><li>  panggil <code>process.exit</code> </li><li>  blok kosong </li><li>  pola kosong </li></ul><br></li><li><p>  Temukan dan pisahkan deklarasi variabel: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  var one, two; //  var one; var two;</span></span></code> </pre> <br></li><li><p>  Konversikan <code>esm</code> ke <code>commonjs</code> : </p><br></li></ul><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//  import one from 'one'; //  const one = require('one');</span></span></code> </pre> <br><ul><li>  Terapkan perusakan: </li></ul><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  const name = user.name; //  const {name} = user;</span></span></code> </pre> <br><ol><li>  Menggabungkan sifat-sifat perusakan: </li></ol><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  const {name} = user; const {password} = user; //  const { name, password } = user;</span></span></code> </pre> <br><p>  Setiap plugin dibangun sesuai dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Unix Philosophy</a> , yaitu, mereka sesederhana mungkin, masing-masing melakukan satu tindakan, membuat mereka mudah untuk digabungkan, karena mereka pada dasarnya adalah filter. </p><br><p>  Misalnya, memiliki kode berikut: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> name = user.name; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> password = user.password;</code> </pre> <br><p>  Pertama kali dikonversi dengan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">apply-destructure</a> ke: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {name} = user; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {password} = user;</code> </pre> <br><p>  Kemudian, menggunakan properti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">gabungan-penghancuran, itu</a> dikonversi menjadi: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { name, password } = user;</code> </pre> <br><p>  Dengan demikian, plugin dapat bekerja secara terpisah dan bersamaan.  Saat membuat plug-in Anda sendiri, disarankan untuk mematuhi aturan ini, dan mengimplementasikan plug-in dengan fungsionalitas minimal yang hanya melakukan apa yang Anda butuhkan, dan plug-in bawaan dan kustom akan menangani sisanya. </p><br><h4 id="primer-ispolzovaniya">  Contoh penggunaan </h4><br><p>  Setelah membiasakan diri dengan aturan <code>putout</code> , kami dapat mempertimbangkan contoh menggunakan <code>putout</code> . <br>  Buat file <code>example.js</code> dengan konten berikut: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> x = <span class="hljs-number"><span class="hljs-number">1</span></span>, y = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> name = user.name; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> password = user.password; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(name, password);</code> </pre> <br><p>  Sekarang jalankan <code>putout</code> dengan mengirimkan <code>example.js</code> sebagai argumen: </p><br><pre> <code class="plaintext hljs">coderaiser@cloudcmd:~/example$ putout example.js /home/coderaiser/example/example.js 1:6 error "x" is defined but never used remove-unused-variables 1:13 error "y" is defined but never used remove-unused-variables 6:0 error Unexpected "console" call remove-console 1:0 error variables should be declared separately split-variable-declarations 3:6 error Object destructuring should be used apply-destructuring 4:6 error Object destructuring should be used apply-destructuring 6 errors in 1 files fixable with the `--fix` option</code> </pre> <br><p>  Kami akan menerima informasi yang mengandung 6 kesalahan, dipertimbangkan secara lebih rinci di atas, sekarang kami akan memperbaikinya, dan melihat apa yang terjadi: </p><br><pre> <code class="plaintext hljs">coderaiser@cloudcmd:~/example$ putout example.js --fix coderaiser@cloudcmd:~/example$ cat example.js const { name, password } = user;</code> </pre> <br><p>  Sebagai hasil dari koreksi, variabel yang tidak digunakan dan panggilan <code>console.log</code> dihapus, dan perusakan juga diterapkan. </p><br><h4 id="nastroyki">  Pengaturan </h4><br><p>  Pengaturan default mungkin tidak selalu dan tidak untuk semua orang, jadi <code>putout</code> mendukung file konfigurasi <code>.putout.json</code> , terdiri dari bagian-bagian berikut: </p><br><ul><li>  Aturan </li><li>  Abaikan </li><li>  Cocok </li><li>  Plugin </li></ul><br><h5 id="rules">  Aturan </h5><br><p>  Bagian <code>rules</code> berisi sistem aturan.  Aturan, secara default, ditetapkan sebagai berikut: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"remove-unused-variables"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-debugger"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-only"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-skip"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-process-exit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-console"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"split-variable-declarations"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-empty"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"remove-empty-pattern"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"convert-esm-to-commonjs"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"apply-destructuring"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"merge-destructuring-properties"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre> <br><p>  Untuk mengaktifkan <code>remove-process-exit</code> cukup setel ke <code>true</code> dalam file <code>.putout.json</code> : </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"remove-process-exit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre> <br><p>  Ini akan cukup untuk melaporkan semua panggilan <code>process.exit</code> ditemukan dalam kode dan menghapusnya jika opsi <code>--fix</code> . </p><br><h5 id="ignore">  Abaikan </h5><br><p>  Jika Anda perlu menambahkan beberapa folder ke daftar pengecualian, cukup tambahkan bagian <code>ignore</code> : </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"ignore"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"test/fixture"</span></span> ] }</code> </pre> <br><h5 id="match">  Cocok </h5><br><p>  Jika Anda membutuhkan sistem aturan bercabang, misalnya, aktifkan <code>process.exit</code> untuk direktori <code>bin</code> , cukup gunakan bagian <code>match</code> : </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"match"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"bin"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"remove-process-exit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } } }</code> </pre> <br><h5 id="plugins">  Plugin </h5><br><p>  Jika Anda menggunakan plugin yang tidak terintegrasi dan memiliki awalan <code>putout-plugin-</code> , Anda harus memasukkannya di bagian <code>plugins</code> sebelum mengaktifkannya di bagian <code>rules</code> .  Misalnya, untuk menghubungkan <code>putout-plugin-add-hello-world</code> dan aktifkan aturan <code>add-hello-world</code> , cukup sebutkan: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"add-hello-world"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"add-hello-world"</span></span> ] }</code> </pre> <br><h4 id="dvizhok-putout">  Mesin Putout </h4><br><p>  Mesin <code>putout</code> adalah alat baris perintah yang membaca pengaturan, mem-parsing file, memuat dan menjalankan plugin, dan kemudian menulis hasil dari plugin. </p><br><p>  Dia menggunakan perpustakaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menyusun kembali</a> , yang membantu untuk melakukan tugas yang sangat penting: setelah parsing dan transformasi, kumpulkan kode dalam keadaan yang semirip mungkin dengan yang sebelumnya. </p><br><p>  Untuk parsing, parser yang kompatibel dengan <code>ESTree</code> digunakan ( <code>babel</code> saat ini dengan plugin <code>estree</code> , tetapi perubahan mungkin dilakukan di masa depan), dan alat <code>babel</code> digunakan untuk transformasi.  Kenapa persis <code>babel</code> ?  Semuanya sederhana.  Faktanya adalah bahwa ini adalah produk yang sangat populer, jauh lebih populer daripada alat serupa lainnya, dan ini berkembang jauh lebih cepat.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Setiap proposal baru dalam standar EcmaScript tidak lengkap tanpa plugin babel</a> .  <a href="">Babel juga</a> memiliki buku, <a href="">Babel Handbook</a> , yang menggambarkan dengan sangat baik semua fitur dan alat untuk melintasi dan mengubah pohon AST. </p><br><h4 id="svoy-plagin-dlya-putout">  Plugin khusus untuk Putout </h4><br><p>  Sistem plugin <code>putout</code> cukup sederhana, dan sangat mirip dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">eslint plugins</a> , serta <a href="">babel plugins</a> .  Benar, alih-alih satu fungsi, plugin <code>putout</code> harus mengekspor 3. Ini dilakukan untuk meningkatkan penggunaan kembali kode, karena fungsi duplikasi dalam 3 fungsi tidak terlalu nyaman, jauh lebih mudah untuk memasukkannya ke dalam fungsi yang terpisah dan cukup memanggilnya di tempat yang tepat. </p><br><h5 id="struktura-plagina">  Struktur plugin </h5><br><p>  Jadi plugin <code>Putout</code> terdiri dari 3 fungsi: </p><br><ul><li>  <code>report</code> - mengembalikan pesan; </li><li>  <code>find</code> - mencari tempat dengan kesalahan dan mengembalikannya; </li><li>  <code>fix</code> - memperbaiki tempat-tempat ini; </li></ul><br><p>  Poin utama yang perlu diingat ketika membuat plugin untuk <code>putout</code> adalah namanya, itu harus dimulai dengan <code>putout-plugin-</code> .  Berikutnya mungkin nama operasi yang dilakukan plugin, misalnya, plugin <code>remove-wrong</code> harus dipanggil seperti ini: <code>putout-plugin-remove-wrong</code> . </p><br><p>  Anda juga harus menambahkan kata-kata: <code>putout</code> dan <code>putout-plugin</code> ke bagian <code>package.json</code> di bagian <code>keywords</code> , dan tentukan <code>"putout": "&gt;=3.10"</code> di <code>peerDependencies</code> <code>"putout": "&gt;=3.10"</code> , atau versi yang akan menjadi yang terakhir pada saat menulis plugin. </p><br><h5 id="primer-plagina-dlya-putout">  Contoh plugin untuk Putout </h5><br><p>  Mari kita menulis contoh plugin yang akan menghapus kata <code>debugger</code> dari kode.  Plugin semacam itu sudah ada, itu adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@ putout / plugin-remove-debugger</a> dan cukup sederhana untuk mempertimbangkannya sekarang. </p><br><p>  Ini terlihat seperti ini: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//        module.exports.report = () =&gt; 'Unexpected "debugger" statement'; //     ,  debugger    Visitor module.exports.find = (ast, {traverse}) =&gt; { const places = []; traverse(ast, { DebuggerStatement(path) { places.push(path); } }); return places; }; //  ,     module.exports.fix = (path) =&gt; { path.remove(); };</span></span></code> </pre> <br><p>  Jika aturan <code>remove-debugger</code> disertakan dalam <code>.putout.json</code> , <code>@putout/plugin-remove-debugger</code> akan dimuat.  Pertama, fungsi <code>find</code> disebut, dengan menggunakan fungsi <code>traverse</code> , akan memotong node dari pohon AST dan menyimpan semua tempat yang diperlukan. </p><br><p>  Langkah selanjutnya <code>putout</code> akan berubah menjadi <code>report</code> untuk mendapatkan pesan yang diinginkan. </p><br><p>  Jika flag <code>--fix</code> digunakan, fungsi <code>fix</code> plugin akan dipanggil dan transformasi akan dilakukan, dalam hal ini, node akan dihapus. </p><br><h5 id="primer-testa-plagina">  Contoh Uji Plugin </h5><br><p>  Untuk mempermudah pengujian plugin, alat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">@ putout / test</a> ditulis.  Pada intinya, itu tidak lebih dari pembungkus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pita</a> , dengan beberapa metode untuk kenyamanan dan penyederhanaan pengujian. </p><br><p>  Tes untuk plugin <code>remove-debugger</code> mungkin terlihat seperti ini: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> removeDebugger = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'..'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> test = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'@putout/test'</span></span>)(__dirname, { <span class="hljs-string"><span class="hljs-string">'remove-debugger'</span></span>: removeDebugger, }); <span class="hljs-comment"><span class="hljs-comment">//        test('remove debugger: report', (t) =&gt; { t.reportCode('debugger', 'Unexpected "debugger" statement'); t.end(); }); //    test('remove debugger: transformCode', (t) =&gt; { t.transformCode('debugger', ''); t.end(); });</span></span></code> </pre> <br><h5 id="codemods">  Kodem </h5><br><p>  Tidak setiap transformasi perlu digunakan setiap hari, untuk transformasi satu kali itu cukup untuk melakukan hal yang sama, tetapi alih-alih menerbitkan ke <code>npm</code> letakkan di <code>~/.putout</code> .  Saat startup, <code>putout</code> akan mencari di folder ini, mengambil dan memulai transformasi. </p><br><p>  Berikut adalah contoh transformasi yang menggantikan <code>tape</code> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">koneksi</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">coba-ke-pita</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dengan</a> panggilan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">supertape</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">convert-tape-to-supertape</a> . </p><br><h3 id="eslint-plugin-putout">  eslint-plugin-putout </h3><br><p>  Pada akhirnya, ada baiknya menambahkan satu poin: <code>putout</code> mencoba mengubah kode secara minimal, tetapi jika itu terjadi pada teman yang melanggar beberapa aturan pemformatan, eslint --fix selalu siap <code>eslint --fix</code> , dan untuk tujuan ini ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">plugin eslint-plugin-putout khusus</a> .  Ini dapat mencerahkan banyak kesalahan pemformatan, dan tentu saja itu dapat disesuaikan sesuai dengan preferensi pengembang pada proyek tertentu.  Menghubungkannya mudah: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"extends"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"plugin:putout/recommended"</span></span>, ], <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"putout"</span></span> ] }</code> </pre> <br><p>  Sejauh ini, hanya ada satu aturan di dalamnya: <code>one-line-destructuring</code> , ia melakukan yang berikut: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  const { one } = hello; //  const {one} = hello;</span></span></code> </pre> <br><p>  Ada banyak lagi aturan <code>eslint</code> yang bisa Anda gunakan untuk membiasakan diri <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dengan lebih detail</a> . </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Saya ingin mengucapkan terima kasih kepada pembaca atas perhatian yang diberikan pada teks ini.  Saya sangat berharap bahwa topik transformasi AST akan menjadi lebih populer, dan artikel tentang proses yang menarik ini akan muncul lebih sering.  Saya akan sangat berterima kasih atas komentar dan saran yang terkait dengan pengembangan <code>putout</code> lebih lanjut.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Buat masalah</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kirim kumpulan permintaan</a> , uji, tulis aturan apa yang ingin Anda lihat, dan bagaimana memprogram kode Anda secara terprogram, kami akan bekerja sama untuk meningkatkan alat transformasi AST. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439564/">https://habr.com/ru/post/id439564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439552/index.html">Ekstensi Chrome berbahaya</a></li>
<li><a href="../id439556/index.html">TDMS Fairway. Metodologi PMBOK dan organisasi desain Rusia</a></li>
<li><a href="../id439558/index.html">Telepon lama baru. Temukan kembali telepon PSTN</a></li>
<li><a href="../id439560/index.html">Adaptor blockchain Ethereum untuk platform data IRIS InterSystems</a></li>
<li><a href="../id439562/index.html">Konfigurasikan kluster Kubernetes HA pada logam kosong dengan kubeadm. Bagian 1/3</a></li>
<li><a href="../id439566/index.html">Mengapa dokumentasi SRE penting? Bagian 3</a></li>
<li><a href="../id439568/index.html">SSD berbasis QLC - pembunuh hard drive? Tidak juga</a></li>
<li><a href="../id439570/index.html">IPython magic untuk mengedit tag sel Jupyter</a></li>
<li><a href="../id439572/index.html">Desain peralatan elektronik berbantuan komputer</a></li>
<li><a href="../id439574/index.html">SmartCard I2C Protocol. Tukar perintah APDU melalui antarmuka I2C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>