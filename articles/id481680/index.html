<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤚🏼 😬 🔶 Menulis TodoMVC di dap. Bagian 2 👨🏽‍🌾 🤶🏿 😻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ini adalah bagian kedua, terakhir, dari tutorial di mana kami menulis klien TodoMVC menggunakan kerangka kerja reaktif ds minimalis. 

 Ringkasan bagi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menulis TodoMVC di dap. Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481680/"> Ini adalah bagian kedua, terakhir, dari tutorial di mana kami menulis klien TodoMVC menggunakan kerangka kerja reaktif <a href="https://dap.js.org/" rel="nofollow">ds</a> minimalis. <br><br>  Ringkasan bagian <a href="https://habr.com/en/post/480912/">pertama</a> : kami menerima daftar tugas dari server dalam format JSON, membuat daftar HTML darinya, menambahkan kemampuan untuk mengedit nama dan tanda penyelesaian untuk setiap kasus, dan menerapkan pemberitahuan server tentang pengeditan ini. <br><br>  Itu masih harus direalisasikan: menghapus kasus sewenang-wenang, menambahkan kasus baru, pemasangan / reset massal dan penyaringan kasus berdasarkan penyelesaian dan fungsi menghapus semua kasus selesai.  Ini yang akan kita lakukan.  Versi final klien, yang akan kita bahas dalam artikel ini, dapat dilihat di <a href="https://dap.js.org/samples/tutorial/16.html" rel="nofollow">sini</a> . <br><br><a name="habracut"></a><br><br>  Opsi yang kami tentukan terakhir kali dapat disegarkan di <a href="https://dap.js.org/samples/tutorial/7-3.html" rel="nofollow">sini</a> . <br><br>  Ini kodenya: <br><br><pre><code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'#header'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'H1'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'INPUT#new-todo placeholder="What needs to be done?" autofocus'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) ,<span class="hljs-string"><span class="hljs-string">'#main'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'#toggle-all type=checkbox'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'UL#todo-list'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"*@ todos:query"</span></span> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$completed=.completed $editing= $patch=; a!"</span></span> ,<span class="hljs-string"><span class="hljs-string">'INPUT.toggle type=checkbox'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"#.checked=.completed"</span></span>) .ui(<span class="hljs-string"><span class="hljs-string">"$patch=($completed=#.checked)"</span></span>) ,<span class="hljs-string"><span class="hljs-string">'LABEL.view'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"? $editing:!; ! .title"</span></span>) .e(<span class="hljs-string"><span class="hljs-string">"dblclick"</span></span>,<span class="hljs-string"><span class="hljs-string">"$editing=`yes"</span></span>) ,<span class="hljs-string"><span class="hljs-string">'INPUT.edit'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"? $editing; !! .title@value"</span></span>) .ui(<span class="hljs-string"><span class="hljs-string">"$patch=(.title=#.value)"</span></span>) .e(<span class="hljs-string"><span class="hljs-string">"blur"</span></span>,<span class="hljs-string"><span class="hljs-string">"$editing="</span></span>) ,<span class="hljs-string"><span class="hljs-string">'BUTTON.destroy'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) .a(<span class="hljs-string"><span class="hljs-string">"!? $completed $editing"</span></span>) .u(<span class="hljs-string"><span class="hljs-string">"? $patch; (@method`PATCH .url:dehttp headers $patch@):query $patch="</span></span>) ) ) ,<span class="hljs-string"><span class="hljs-string">'#footer'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'#todo-count'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'UL#filters'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) ,<span class="hljs-string"><span class="hljs-string">'#clear-completed'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) ) .DICT({ <span class="hljs-attr"><span class="hljs-attr">todos</span></span> : <span class="hljs-string"><span class="hljs-string">"//todo-backend-express.herokuapp.com/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: {<span class="hljs-string"><span class="hljs-string">"Content-type"</span></span>:<span class="hljs-string"><span class="hljs-string">"application/json"</span></span>} }) .FUNC({ <span class="hljs-attr"><span class="hljs-attr">convert</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">dehttp</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">=&gt;</span></span>url.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^https?\:/</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>) } }) .RENDER()</code> </pre> <br><br>  Sekarang hanya ada lima puluh baris di sini, tetapi pada akhir artikel akan ada dua kali lebih banyak - sebanyak 100. Akan ada banyak permintaan HTTP ke server, jadi silakan buka alat pengembang (di Chrome, seperti yang Anda ingat, Ctrl + Shift + I) - akan ada Pertama-tama, tab Jaringan menarik, dan kedua, Konsol.  Juga, jangan lupa untuk melihat kode untuk setiap versi halaman kami - di Chrome itu adalah Ctrl + U. <br><br>  Di sini saya harus melakukan sedikit penyimpangan.  Jika Anda tidak membaca bagian <a href="https://habr.com/en/post/480912/">pertama</a> tutorial, saya tetap merekomendasikan untuk memulainya.  Jika Anda membacanya, tetapi tidak mengerti apa-apa, lebih baik membacanya lagi.  Seperti yang ditunjukkan oleh komentar pada dua artikel saya sebelumnya, sintaks dan prinsip dap tidak selalu langsung dipahami oleh pembaca yang tidak siap.  Artikel lain tidak disarankan untuk dibaca oleh orang yang merasa tidak nyaman dengan tampilan sintaksis tidak seperti si. <br><br><img src="https://habrastorage.org/webt/wj/-n/br/wj-nbrh5eflirkcich69glgnooo.jpeg"><br><br>  Bagian kedua tutorial ini akan sedikit lebih rumit dan menarik daripada yang pertama.  <i>[TODO: minta <a href="https://habr.com/en/users/token/" class="user_link">token untuk</a> menemukan gambar otak anak sekolah yang meledak di internet]</i> . <br><br>  Dengan izin Anda, saya akan terus memberi nomor bab dengan bagian 1.  Di sana kami menghitung sampai 7. Jadi, <br><br><h2>  8. Membuat daftar to-do dari variabel status </h2><br>  Untuk menghapus <code>BUTTON.destroy</code> dari daftar ada tombol <code>BUTTON.destroy</code> .  Penghapusan terdiri dari pengiriman permintaan DELETE ke server dan sebenarnya menghapus elemen <code>UL#todo-list &gt; LI</code> dengan semua konten.  Dengan mengirimkan permintaan DELETE, semuanya jelas: <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'BUTTON.destroy'</span></span>.ui(<span class="hljs-string"><span class="hljs-string">"(@method`DELETE .url:dehttp):query"</span></span>)</code> </pre><br><br>  Tetapi dengan penghapusan elemen dari layar, opsi dimungkinkan.  Seseorang bisa dengan mudah memperkenalkan variabel keadaan lain, katakanlah <code>$deleted</code> , dan sembunyikan elemen dengan CSS, termasuk kelas CSS yang <code>deleted</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$completed=.completed $editing= $patch= $deleted=; a!"</span></span> <span class="hljs-comment"><span class="hljs-comment">//  $deleted   "" ... ,'BUTTON.destroy'.d("(@method`DELETE .url:dehttp):query $deleted=`yes") //  $deleted -     ) .a("!? $completed $editing $deleted") //   CSS  .deleted{display:none}</span></span></code> </pre><br><br>  Dan itu akan berhasil.  Tapi itu akan curang.  Selain itu, lebih jauh ke bawah kita akan memiliki filter dan penghitung kasus aktif dan selesai (apa yang ada di <code>#footer</code> ).  Oleh karena itu, lebih baik untuk segera menghapus objek dari daftar yang harus dilakukan dengan jujur, “secara fisik”.  Artinya, kita perlu kemampuan untuk memodifikasi array itu sendiri, yang awalnya kita terima dari server - yang berarti bahwa array ini juga harus menjadi variabel keadaan.  Sebut saja dia <code>$todos</code> . <br><br>  Cakupan variabel <code>$todos</code> adalah untuk memilih leluhur umum dari semua elemen yang akan mengakses variabel ini.  Dan itu akan diakses oleh <code>INPUT#new-todo</code> dari <code>#header</code> , dan counter dari <code>#footer</code> , dan sebenarnya <code>UL#todo-list</code> .  Nenek moyang yang sama dari mereka semua adalah elemen root dari template, <code>#todoapp</code> .  Oleh karena itu, dalam aturan-d kita akan mendefinisikan variabel <code>$todos</code> .  Di tempat yang sama, kami segera mengunggah data dari server ke sana.  Dan untuk membangun daftar <code>UL#todo-list</code> , kita sekarang juga akan berasal dari itu: <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$todos=todos:query"</span></span> <span class="hljs-comment"><span class="hljs-comment">//   $todos      ... ,'UL#todo-list'.d("*@ $todos" //     $todos</span></span></code> </pre><br><br>  <b>Itu penting.</b>  Jika selama pengujian tiba-tiba daftar agenda tidak dimuat - sangat mungkin seseorang menghapus semuanya (ini adalah server publik, dan apa pun bisa terjadi di sana). <br>  Dalam hal ini, harap buka <a href="https://dap.js.org/samples/tutorial/16.html" rel="nofollow">contoh fitur lengkap</a> dan buat beberapa kasus untuk percobaan. <br><br>  <a href="https://dap.js.org/samples/tutorial/8-1.html" rel="nofollow">Kami melihat</a> .  Di sini <code>$todos</code> <i>dideklarasikan</i> dalam aturan-d elemen <code>#todoapp</code> dan segera <i>diinisialisasi dengan</i> data yang diperlukan.  Segalanya tampak berfungsi, tetapi satu fitur yang tidak menyenangkan telah muncul.  Jika server merespons permintaan untuk waktu yang lama (Chrome memungkinkan Anda untuk mensimulasikan situasi ini: pada tab Jaringan pada alat pengembang, Anda dapat memilih berbagai mode untuk mensimulasikan jaringan lambat), maka versi aplikasi kami yang baru hingga permintaan selesai terlihat agak sedih - tidak ada yang lain selain beberapa CSS artefak.  Gambar seperti itu pasti tidak akan menambah antusiasme bagi pengguna.  Meskipun versi sebelumnya tidak menderita karena hal ini - sampai data diterima pada halaman, hanya daftar itu sendiri yang hilang, tetapi elemen lain segera muncul, tanpa menunggu data. <br><br>  Ini masalahnya.  Seperti yang Anda ingat, konverter <code>:query</code> tidak sinkron.  Sinkronisasi ini dinyatakan dalam fakta bahwa sampai permintaan selesai, hanya eksekusi aturan saat ini yang diblokir, yaitu generasi elemen, yang, pada kenyataannya, membutuhkan data yang diminta (yang logis).  Generasi elemen lain tidak diblokir.  Oleh karena itu, ketika <code>UL#todo-list</code> mengakses server, hanya saja server itu diblokir, tetapi bukan <code>#header</code> dan bukan <code>#footer</code> , yang langsung ditarik.  Sekarang seluruh <code>#todoapp</code> sedang menunggu permintaan untuk diselesaikan. <br><br><h2>  9. Pemuatan data tertunda </h2><br>  Untuk memperbaiki situasi dan menghindari pemblokiran elemen-elemen yang tidak terlibat, kami akan menunda pemuatan awal data sampai semuanya sudah diambil.  Untuk melakukan ini, kami tidak akan segera memuat data ke variabel <code>$todos</code> , tetapi pertama-tama kami hanya menginisialisasi dengan "tidak ada" <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$todos="</span></span> <span class="hljs-comment"><span class="hljs-comment">//   $todos    ""</span></span></code> </pre><br><br>  Jadi dia tidak akan memblokir apa pun dan seluruh templat akan berfungsi - meskipun untuk saat ini dengan "daftar tugas" yang kosong.  Tetapi sekarang, dengan layar awal yang membosankan, Anda dapat dengan aman <i>memodifikasi</i> <code>$todos</code> dengan mengunggah daftar tugas untuk itu.  Untuk melakukan ini, tambahkan keturunan ini ke <code>#todoapp</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'loader'</span></span> .u(<span class="hljs-string"><span class="hljs-string">"$todos=todos:query"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//  $todos,       .d("u") //   (u-)   </span></span></code> </pre><br><br>  Elemen ini memiliki aturan-u yang terlihat persis sama dengan aturan pemblokiran yang kami tolak, tetapi ada satu perbedaan mendasar. <br>  Biarkan saya mengingatkan Anda bahwa aturan-d (dari <i>bawah</i> ) adalah aturan pembuatan elemen yang dieksekusi ketika templat dibuat dari atas ke <i>bawah</i> , dari induk ke turunan;  dan aturan-u (dari <i>atas</i> ) adalah aturan reaksi yang dijalankan sebagai respons terhadap peristiwa yang muncul dari bawah ke <i>atas</i> , dari anak ke orang tua. <br>  Jadi, jika sesuatu (termasuk "tidak ada") ditugaskan <b>ke</b> variabel <b>dalam aturan-d</b> , ini berarti <i>deklarasi dan inisialisasi</i> dalam lingkup elemen ini dan turunannya (lingkup bersarang diimplementasikan dalam dap, seperti pada JS )  Penugasan <b>dalam aturan-up</b> berarti <i>modifikasi</i> variabel yang dideklarasikan sebelumnya dalam cakupan.  Deklarasi dan inisialisasi variabel dalam aturan-d memungkinkan orang tua untuk meneruskan kepada keturunan menuruni hierarki informasi yang diperlukan untuk konstruksi, dan modifikasi memungkinkan orang tua untuk memberikan pembaruan pada informasi ini dan dengan demikian memulai restrukturisasi yang tepat dari semua elemen yang bergantung padanya. <br><br>  Elemen <code>loader</code> , yang merupakan turunan <code>#todoapp</code> , dalam aturan-u-nya <b>memodifikasi</b> variabel <code>$todos</code> , memuat data dari server ke dalamnya, yang menyebabkan regenerasi otomatis semua elemen konsumen dari variabel ini (dan hanya mereka, yang penting!).  Konsumen suatu variabel adalah elemen yang aturan-dnya mengandung variabel ini sebagai nilai, yaitu  Mereka yang <b>membaca</b> variabel ini (dengan mempertimbangkan ruang lingkup) saat membangun. <br><br>  Kami sekarang memiliki satu konsumen variabel <code>$todos</code> - <code>UL#todo-list</code> sangat, yang kemudian akan dibangun kembali setelah memuat data. <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'UL#todo-list'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"*@ $todos"</span></span> <span class="hljs-comment"><span class="hljs-comment">//  ,   $todos</span></span></code> </pre><br><br>  Jadi, <a href="https://dap.js.org/samples/tutorial/9.html" rel="nofollow">sekarang</a> kita memiliki daftar yang harus dilakukan adalah variabel status di <code>#todoapp</code> , sambil tidak memblokir rendering awal templat. <br><br><h2>  10. Menghapus dan menambahkan to-do </h2><br>  Sekarang kita dapat memodifikasi <code>$todos</code> segala cara.  Mari kita mulai dengan menghapus item.  Kami sudah memiliki tombol-lintas <code>BUTTON.destroy</code> , yang sejauh ini hanya mengirim permintaan penghapusan server <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'BUTTON.destroy'</span></span>.ui(<span class="hljs-string"><span class="hljs-string">"(@method`DELETE .url:dehttp):query"</span></span>)</code> </pre><br><br>  Penting untuk memastikan bahwa objek yang sesuai juga dihapus dari variabel <code>$todos</code> - dan karena ini akan menjadi modifikasi, <code>UL#todo-list</code> , sebagai konsumen variabel ini, akan secara otomatis membangun kembali, tetapi tanpa elemen yang dihapus. <br><br>  Dengan sendirinya, dap tidak menyediakan sarana khusus untuk memanipulasi data.  Manipulasi dapat ditulis dengan sempurna dalam fungsi di JS, dan aturan dap hanya mengirimkan data kepada mereka dan mengambil hasilnya.  Kami menulis fungsi JS untuk menghapus objek dari array tanpa mengetahui jumlahnya.  Sebagai contoh, ini: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> remove = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arr,tgt</span></span></span><span class="hljs-function">)=&gt;</span></span> arr.filter( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">obj</span></span></span><span class="hljs-function"> =&gt;</span></span> obj!=tgt );</code> </pre><br><br>  Anda mungkin dapat menulis sesuatu yang lebih efektif, tetapi ini bukan tentang itu sekarang.  Kecil kemungkinan bahwa aplikasi kita harus bekerja dengan daftar yang harus dilakukan dari jutaan item.  Yang penting adalah bahwa fungsi mengembalikan objek array baru, dan bukan hanya menghilangkan elemen dari apa adanya. <br><br>  Untuk membuat fungsi ini dapat diakses dari aturan dap, Anda perlu menambahkannya ke bagian <code>.FUNC</code> , tetapi sebelum itu memutuskan bagaimana kami ingin menyebutnya.  Opsi paling sederhana dalam kasus ini adalah, mungkin, untuk memanggilnya dari konverter, yang menerima objek <code>{ todos, tgt }</code> dan mengembalikan array yang difilter <br><br><pre> <code class="javascript hljs">.FUNC({ <span class="hljs-attr"><span class="hljs-attr">convert</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">dehttp</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function"> =&gt;</span></span> url.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^https?\:/</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-comment"><span class="hljs-comment">//        remove: x =&gt; remove(x.todos,x.tgt) //     } })</span></span></code> </pre><br><br>  tetapi tidak ada yang menghentikan Anda dari mendefinisikan fungsi ini tepat di dalam <code>.FUNC</code> (Saya sudah mengatakan bahwa <code>.FUNC</code> sebenarnya adalah metode JS biasa, dan argumennya adalah objek JS biasa?) <br><br><pre> <code class="javascript hljs">.FUNC({ <span class="hljs-attr"><span class="hljs-attr">convert</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">dehttp</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function"> =&gt;</span></span> url.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^https?\:/</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-attr"><span class="hljs-attr">remove</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.todos.filter( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function"> =&gt;</span></span> todo!=x.tgt ) } })</code> </pre><br><br>  Sekarang kita dapat mengakses konverter ini dari aturan dap <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'BUTTON.destroy'</span></span> .ui(<span class="hljs-string"><span class="hljs-string">"$todos=($todos $@tgt):remove (@method`DELETE .url:dehttp):query"</span></span>)</code> </pre><br><br>  Di sini, pertama-tama kita membentuk objek yang dalam notasi JS cocok dengan <code>{ todos, tgt:$ }</code> , meneruskannya ke <code>:remove</code> konverter yang dijelaskan dalam <code>.FUNC</code> , dan kembalikan hasil yang difilter ke <code>$todos</code> , dengan demikian mengubahnya.  Di sini <code>$</code> adalah <i>konteks data</i> elemen, objek bisnis dari array <code>$todos</code> tempat templat dibuat.  Setelah simbol <code>@</code> , alias argumen ditunjukkan.  Jika <code>@</code> ada, maka nama argumen sendiri digunakan.  Ini mirip dengan inovasi ES6 baru - <a href="http://es6-features.org/" rel="nofollow">singkatan properti</a> . <br><br>  Demikian pula, kami menambahkan kasus baru ke daftar menggunakan elemen <code>INPUT#new-todo</code> dan permintaan POST <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT#new-todo placeholder="What needs to be done?" autofocus'</span></span> .ui(<span class="hljs-string"><span class="hljs-string">"$=(#.value@title) (@method`POST todos@url headers $):query $todos=($todos $@tgt):insert #.value="</span></span>) ... .FUNC({ <span class="hljs-attr"><span class="hljs-attr">convert</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">dehttp</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function"> =&gt;</span></span> url.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^https?\:/</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-attr"><span class="hljs-attr">remove</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.todos.filter( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function"> =&gt;</span></span> todo!=x.tgt ), <span class="hljs-comment"><span class="hljs-comment">//     insert: x =&gt; x.todos.concat( [x.tgt] ) //     } })</span></span></code> </pre><br><br>  Aturan reaksi elemen <code>INPUT#new-todo</code> ke acara UI standar (untuk elemen <code>INPUT</code> , peristiwa <code>change</code> dianggap sebagai standar dap) termasuk: membaca input pengguna dari properti <code>value</code> elemen ini, membentuk konteks <code>$</code> lokal dengan nilai ini sebagai bidang <code>.title</code> , mengirimkan <code>$</code> context ke server menggunakan metode POST, memodifikasi array <code>$todos</code> dengan menambahkan konteks <code>$</code> sebagai elemen baru dan akhirnya membersihkan properti <code>value</code> elemen <code>INPUT</code> . <br><br>  Di sini, pembaca muda mungkin bertanya: mengapa menggunakan <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/concat" rel="nofollow"><code>concat()</code></a> saat menambahkan elemen ke array, jika ini dapat dilakukan dengan menggunakan <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/push" rel="nofollow"><code>push()</code></a> biasa <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/push" rel="nofollow"><code>push()</code></a> ?  Pembaca yang berpengalaman akan segera memahami apa masalahnya, dan menulis jawabannya di komentar. <br><br>  Kami melihat apa yang <a href="https://dap.js.org/samples/tutorial/10-1.html" rel="nofollow">terjadi.</a> Kasing ditambahkan dan dihapus secara normal, permintaan yang sesuai dikirim ke server dengan benar (Anda membiarkan tab Jaringan terbuka selama ini, kan?).  Tetapi bagaimana jika kita ingin mengubah nama atau status dari kasus yang baru ditambahkan?  Masalahnya adalah untuk memberi tahu server tentang perubahan ini, kita perlu <code>.url</code> , yang menetapkan server untuk bisnis ini.  Ketika kami menciptakan bisnis, <code>.url</code> tidak tahu masing-masing <code>.url</code> , kami tidak dapat membentuk permintaan PATCH yang benar untuk perubahan. <br><br>  Faktanya, semua informasi yang diperlukan tentang kasing terdapat dalam respons server terhadap permintaan POST, dan akan lebih tepat untuk membuat objek bisnis baru tidak hanya dari input pengguna, tetapi dari respons server, dan menambahkan objek ini ke <code>$todos</code> - dengan semua informasi yang disediakan informasi server, termasuk bidang <code>.url</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT#new-todo placeholder="What needs to be done?" autofocus'</span></span> .ui(<span class="hljs-string"><span class="hljs-string">"$todos=($todos (@method`POST todos@url headers (#.value@title)):query@tgt ):insert #.value="</span></span>)</code> </pre><br><br>  Kami melihat - oke, sekarang semuanya berjalan dengan benar.  Pemberitahuan ke server tentang pengeditan kasus yang baru dibuat berjalan dengan benar. <br><br>  Orang bisa berhenti pada ini, tapi ... Tapi jika Anda melihat dekat, Anda masih bisa melihat sedikit keterlambatan antara memasukkan nama kasing baru dan saat itu muncul dalam daftar.  Penundaan ini jelas terlihat jika Anda mengaktifkan jaringan lambat yang disimulasikan.  Seperti yang sudah Anda duga, masalahnya adalah permintaan ke server: pertama, kami meminta data untuk kasus baru dari server, dan hanya setelah menerimanya kami memodifikasi <code>$todos</code> .  Langkah selanjutnya, kami akan mencoba memperbaiki situasi ini, tetapi pertama-tama saya akan mengalihkan perhatian Anda ke poin lain yang menarik.  Jika kita kembali sedikit ke <a href="https://dap.js.org/samples/tutorial/10-1.html" rel="nofollow">versi sebelumnya</a> , kita perhatikan: meskipun permintaan juga ada, case baru ditambahkan ke daftar secara instan, tanpa menunggu permintaan untuk mengakhiri <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    , :query   .ui("$=(#.value@title) (@method`POST todos@url headers $):query $todos=($todos $@tgt):insert #.value=")</span></span></code> </pre><br><br>  Ini adalah fitur lain untuk mengerjakan konverter asinkron di dap: jika hasil konverter asinkron tidak digunakan (yaitu, ia tidak ditugaskan untuk apa pun), maka Anda tidak bisa menunggu penyelesaiannya - dan pelaksanaan aturan tidak diblokir.  Ini sering berguna: Anda mungkin memperhatikan bahwa ketika menghapus case dari daftar, mereka menghilang dari layar secara instan, tanpa menunggu hasil dari permintaan DELETE.  Ini terutama terlihat jika Anda dengan cepat menghapus beberapa kasus berturut-turut dan melacak permintaan di panel Jaringan. <br><br>  Tetapi, karena kita menggunakan hasil dari permintaan POST - menugaskannya ke <code>$</code> context - kita harus menunggu sampai selesai.  Oleh karena itu, Anda perlu menemukan cara lain untuk memodifikasi <code>$todos</code> sebelum menjalankan permintaan POST.  Solusi: masih, pertama buat objek bisnis baru dan segera tambahkan ke <code>$todos</code> , biarkan daftar gambar, dan hanya kemudian, setelah rendering, jika bisnis tidak memiliki <code>.url</code> (yaitu, bisnis baru saja dibuat), jalankan permintaan POST, dan memaksakan hasilnya pada konteks data dari kasus ini. <br><br>  Jadi, pertama-tama kita hanya menambahkan sebuah blank yang hanya berisi <code>.title</code> ke dalam <code>.title</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT#new-todo placeholder="What needs to be done?" autofocus'</span></span> .ui(<span class="hljs-string"><span class="hljs-string">"$todos=($todos (#.value@title)@tgt):insert #.value="</span></span>)</code> </pre><br><br>  <code>UL#todo-list &gt; LI</code> Aturan <code>UL#todo-list &gt; LI</code> Elemen <code>UL#todo-list &gt; LI</code> Sudah Berisi <code>a!</code>  memulai aturan-a setelah elemen pertama kali ditarik.  Di sana kita dapat menambahkan peluncuran permintaan POST tanpa adanya <code>.url</code> .  Untuk menyuntikkan bidang tambahan ke dalam konteks, dap memiliki <code>&amp;</code> operator <br><br><pre> <code class="javascript hljs"> .a(<span class="hljs-string"><span class="hljs-string">"!? $completed $editing; ? .url:!; &amp; (@method`POST todos@url headers $):query"</span></span>)</code> </pre><br><br>  <a href="https://dap.js.org/samples/tutorial/10-3.html" rel="nofollow">Kami melihat</a> .  Hal lain!  Bahkan dengan jaringan yang lambat, daftar yang harus dilakukan diperbarui secara instan, dan pemberitahuan server dan pemuatan data yang hilang terjadi di latar belakang, setelah menggambar daftar yang diperbarui. <br><br><h2>  11. Kawan semuanya! </h2><br>  Di elemen <code>#header</code> ada tombol untuk instalasi massal / reset tanda penyelesaian untuk semua kasus dalam daftar.  Untuk penugasan massal nilai ke bidang elemen array, kami hanya menulis pengonversi lain,: <code>:assign</code> , dan menerapkannya ke <code>$todos</code> dengan mengeklik <code>INPUT#toggle-all</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT#toggle-all type=checkbox'</span></span> .ui(<span class="hljs-string"><span class="hljs-string">"$todos=($todos (#.checked@completed)@src):assign"</span></span>) ... assign: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.todos &amp;&amp; x.todos.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(todo,x.src))</code> </pre><br><br>  Dalam hal ini, kami hanya tertarik pada bidang <code>.completed</code> , tetapi mudah untuk melihat bahwa dengan konverter seperti itu, Anda dapat secara besar-besaran mengubah nilai bidang apa pun dari elemen array. <br>  Oke, dalam array <code>$todos</code> diaktifkan, sekarang kita perlu memberi tahu server tentang perubahan yang dilakukan.  Dalam contoh asli, ini dilakukan dengan mengirimkan permintaan PATCH untuk setiap kasus - bukan strategi yang sangat efektif, tetapi tidak lagi tergantung pada kami.  Oke, untuk setiap kasus kami mengirim permintaan PATCH <br><br><pre> <code class="javascript hljs"> .ui(<span class="hljs-string"><span class="hljs-string">"*@ $todos=($todos (#.checked@completed)@src):assign; (@method`PATCH .url:dehttp headers (.completed)):query"</span></span>)</code> </pre><br><br>  <a href="https://dap.js.org/samples/tutorial/11.html" rel="nofollow">Kami melihat</a> : Sebuah klik pada common daw meluruskan semua daw individual, dan server diberitahu oleh permintaan PATCH yang sesuai.  Norma <br><br><h2>  12. Menyaring kasus berdasarkan penyelesaian </h2><br>  Selain daftar hal yang harus dilakukan, aplikasi juga harus dapat memfilter kasus dengan tanda penyelesaian dan menunjukkan penghitung tugas yang telah selesai dan belum selesai.  Tentu saja, untuk pemfilteran kita akan sepele untuk menggunakan metode <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/filter" rel="nofollow"><code>filter()</code></a> sama <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Array/filter" rel="nofollow"><code>filter()</code></a> yang disediakan oleh JS itu sendiri. <br><br>  Tapi pertama-tama Anda harus memastikan bahwa bidang <code>.completed</code> dari setiap kasus selalu benar, dan ketika Anda mengklik masing-masing kasus diperbarui dengan variabel <code>$completed</code> .  Sebelumnya, ini tidak penting bagi kami, tetapi sekarang akan menjadi. <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT.toggle type=checkbox'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"#.checked=.completed"</span></span>) .ui(<span class="hljs-string"><span class="hljs-string">"$patch=(.completed=$completed=#.checked) $recount=()"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//  .completed       </span></span></code> </pre><br><br>  Poin penting di sini adalah bahwa konteks data setiap kasus adalah objek kasus itu sendiri, yang terletak pada array <code>$todos</code> .  Bukan satu salinan, atau konstruksi terkait, tetapi objek itu sendiri.  Dan semua panggilan ke bidang <code>.title</code> , <code>.completed</code> , <code>.completed</code>  <code>url</code> - baca dan tulis - berlaku langsung ke objek ini.  Oleh karena itu, agar pemfilteran array <code>$todos</code> berfungsi dengan benar, kita perlu penyelesaian case agar tidak hanya tercermin di layar, tetapi juga di bidang <code>.completed</code> objek <code>.completed</code> . <br><br>  Untuk memperlihatkan hanya case dengan tanda kelengkapan yang diperlukan <code>.completed</code> dalam daftar, kami hanya akan memfilter <code>$todos</code> sesuai dengan filter yang dipilih.  Filter yang dipilih adalah, Anda dapat menebaknya, variabel keadaan lain dari aplikasi kami, dan kami akan menyebutnya: <code>$filter</code> .  Untuk memfilter <code>$todos</code> sesuai dengan <code>$filter</code> dipilih <code>$filter</code> mari kita pergi sepanjang thumbnail dan hanya menambahkan konverter lain, dari form <i>{list, filter} =&gt; daftar yang difilter</i> , dan kita akan mengambil nama dan fungsi penyaringan dari "array asosiatif" (yaitu, JS biasa objek) <code>todoFilters</code> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> todoFilters={ <span class="hljs-string"><span class="hljs-string">"All"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Active"</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function"> =&gt;</span></span> !todo.completed, <span class="hljs-string"><span class="hljs-string">"Completed"</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">todo</span></span></span><span class="hljs-function"> =&gt;</span></span> !!todo.completed }; <span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$todos= $filter="</span></span> <span class="hljs-comment"><span class="hljs-comment">//   $filter ... ,'UL#todo-list'.d("* ($todos $filter):filter" ... ,'UL#filters'.d("* filter" //  filter      .DICT ,'LI' .d("! .filter") .ui("$filter=.") //    "$filter=.filter" ) ... .DICT({ ... filter: Object.keys(todoFilters) //["All","Active","Completed"] }) .FUNC({ convert:{ ... filter: x =&gt;{ const a = x.todos, f = x.filter &amp;&amp; todoFilters[x.filter]; return a&amp;&amp;f ? a.filter(f) : a; } } })</span></span></code> </pre><br><br>  <a href="https://dap.js.org/samples/tutorial/12-1.html" rel="nofollow">Kami periksa</a> .  Filter berfungsi dengan baik.  Ada nuansa di mana nama-nama filter ditampilkan bersama, karena  di sini kami melangkah sedikit dari struktur DOM yang asli dan keluar dari CSS.  Tapi kita akan kembali ke sini nanti. <br><br><h2>  13. Penghitung kasus yang selesai dan aktif. </h2><br>  Untuk menampilkan penghitung kasing yang aktif dan case, cukup filter <code>$todos</code> dengan filter yang sesuai dan perlihatkan panjang array yang dihasilkan <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'#footer'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$active=($todos @filter`Active):filter $completed=($todos @filter`Completed):filter"</span></span> ,<span class="hljs-string"><span class="hljs-string">'#todo-count'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"! (active $active.length)format"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//  length    active ... ,'#clear-completed'.d("! (completed $completed.length)format") ) ... .DICT({ ... active: "{length} items left", completed: "Clear completed items ({length})" })</span></span></code> </pre><br><br>  Dalam <a href="https://dap.js.org/samples/tutorial/13-1.html" rel="nofollow">formulir ini,</a> penghitung menunjukkan nilai yang benar pada saat boot, tetapi tidak menanggapi perubahan selanjutnya dalam penyelesaian urusan (saat mengklik pada daw).  Faktanya adalah bahwa klik pada gagak, mengubah keadaan setiap kasus individu, tidak mengubah keadaan <code>$todos</code> - modifikasi elemen array bukanlah modifikasi dari array itu sendiri.  Oleh karena itu, kami memerlukan sinyal tambahan tentang perlunya mendaftar ulang kasus.  Sinyal semacam itu bisa menjadi variabel status tambahan, yang dimodifikasi setiap kali penghitungan ulang diperlukan.  Sebut saja <code>$recount</code> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan mendeklarasikan leluhur bersama dalam d-rule, kami akan memperbaruinya ketika kami mengklik daw, dan kami </font></font><code>#footer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan membuat </font><font style="vertical-align: inherit;">elemen menjadi </font><font style="vertical-align: inherit;">konsumen - untuk ini, cukup sebutkan variabel ini dalam d-rule-nya</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$todos= $filter= $recount="</span></span> <span class="hljs-comment"><span class="hljs-comment">//  $recount     ... ,'INPUT.toggle type=checkbox' .d("#.checked=.completed") .ui("$patch=(.completed=$completed=#.checked) $recount=()") //  $recount    ... ,'#footer'.d("$active=($todos @filter`Active):filter $completed=($todos @filter`Completed):filter $recount" //  $recount</span></span></code> </pre><br><br> <a href="https://dap.js.org/samples/tutorial/13-2.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> semuanya berfungsi sebagaimana mestinya, penghitung diperbarui dengan benar.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14. Penghapusan semua kasus yang diselesaikan. </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penghapusan banyak kasus di TodoMVC diimplementasikan sebagai non-halal sebagai modifikasi batch - oleh beberapa permintaan. </font><font style="vertical-align: inherit;">Baiklah, mari kita menghela nafas, mengangkat bahu, dan mengeksekusi sesuai dengan DELETE-request untuk setiap case yang sudah selesai - dan kita sudah memiliki semuanya </font></font><code>$completed</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dengan demikian, </font></font><code>$todos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setelah penghapusan kasus yang diselesaikan, apa yang seharusnya sudah masuk</font></font><code>$active</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'#clear-completed'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"! (completed $completed.length)format"</span></span>) .ui(<span class="hljs-string"><span class="hljs-string">"$todos=$active; *@ $completed; (@method`DELETE .url:dehttp):query"</span></span>)</code> </pre><br><br> <a href="https://dap.js.org/samples/tutorial/14.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami melihat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : kami membuat beberapa urusan yang tidak perlu, menandainya dengan daw dan menghapus. </font><font style="vertical-align: inherit;">Tab Network akan menunjukkan horor dari pendekatan ini ke operasi batch.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 15. Status di bilah alamat </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kembali ke pemilihan filter. </font><font style="vertical-align: inherit;">Dalam contoh asli, filter yang dipilih tercermin di bilah alamat setelah #. </font><font style="vertical-align: inherit;">Saat mengubah # -fragment di bilah alamat secara manual atau selama navigasi, filter yang dipilih juga berubah. </font><font style="vertical-align: inherit;">Ini memungkinkan Anda untuk pergi ke halaman aplikasi dengan URL dengan filter tugas yang sudah dipilih. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat menulis dengan </font></font><code>location.hash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operator </font></font><code>urlhash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, misalnya, di aturan-a elemen </font></font><code>#todoapp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(atau keturunannya), yang akan dieksekusi dengan setiap pembaruan</font></font><code>$filter</code> <br><br><pre> <code class="javascript hljs">.a(<span class="hljs-string"><span class="hljs-string">"urlhash $filter"</span></span>)</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan Anda dapat menginisialisasi variabel dengan </font></font><code>$filter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai dari bilah alamat dan kemudian memperbarui oleh acara </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hashchange</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menggunakan pseudo-converter </font></font><code>:urlhash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang mengembalikan keadaan saat ini </font></font><code>location.hash</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(tanpa #)</font></font><br><br><pre> <code class="javascript hljs">.d(<span class="hljs-string"><span class="hljs-string">"$todos= $filter=:urlhash $recount="</span></span> .e(<span class="hljs-string"><span class="hljs-string">"hashchange"</span></span>,<span class="hljs-string"><span class="hljs-string">"$filter=:urlhash"</span></span>)</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acara </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hashchange dimunculkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oleh browser ketika # -fragment di bilah alamat berubah. </font><font style="vertical-align: inherit;">Namun, untuk beberapa alasan hanya </font></font><code>window</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan </font></font><code>document.body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat mendengarkan acara ini. </font><font style="vertical-align: inherit;">Untuk melacak peristiwa ini dari suatu elemen </font></font><code>#todoapp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Anda harus menambahkan operator ke aturan-d </font></font><code>listen</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang menandatangani elemen untuk menyampaikan peristiwa dari objek</font></font><code>window</code> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span> .a(<span class="hljs-string"><span class="hljs-string">"urlhash $filter"</span></span>) .e(<span class="hljs-string"><span class="hljs-string">"hashchange"</span></span>,<span class="hljs-string"><span class="hljs-string">"$filter=:urlhash"</span></span>) .d(<span class="hljs-string"><span class="hljs-string">"$todos= $filter=:urlhash $recount=; listen @hashchange"</span></span></code> </pre><br><br> <a href="https://dap.js.org/samples/tutorial/15-1.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami melihat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : beralih filter, melacak perubahan di bilah alamat, ikuti tautan dengan </font></font><a href="https://dap.js.org/samples/tutorial/15-1.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#Active</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://dap.js.org/samples/tutorial/15-1.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#All</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://dap.js.org/samples/tutorial/15-1.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#Completed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Semuanya berfungsi. </font><font style="vertical-align: inherit;">Tapi kembali ke aslinya. </font><font style="vertical-align: inherit;">Di sana, tampaknya, pilihan filter diterapkan - dengan mengklik tautan. </font><font style="vertical-align: inherit;">Meski tidak terlalu praktis, kami akan melakukan hal yang sama demi kelengkapan.</font></font><br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'UL#filters'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"* filter"</span></span> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'A'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"!! (`# .filter)concat@href .filter@"</span></span>) ) )</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan untuk membuat filter yang dipilih menonjol, tambahkan operator stylization bersyarat </font></font><code>!?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang akan menambahkan kelas CSS ke elemen </font></font><code>selected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika nilai dalam bidang </font></font><code>.filter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konteks sama dengan nilai variabel</font></font><code>$filter</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'A'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"!! (`# .filter)concat@href .filter@; !? (.filter $filter)eq@selected"</span></span>)</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam </font></font><a href="https://dap.js.org/samples/tutorial/15-2.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formulir ini,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fungsi aplikasi dap kami sudah sepenuhnya (sejauh yang saya tahu) konsisten dengan apa yang dilakukan oleh </font></font><a href="https://todo-backend-express.herokuapp.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aslinya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 16. Beberapa sentuhan akhir </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak begitu suka dengan aslinya, bentuk kursor tidak berubah pada elemen yang aktif, jadi kami akan menambahkan </font></font><code>head</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gaya ini </font><font style="vertical-align: inherit;">ke </font><font style="vertical-align: inherit;">dokumen HTML kami</font></font><br><br><pre> <code class="javascript hljs"> [ui=click]{<span class="hljs-attr"><span class="hljs-attr">cursor</span></span>:pointer}</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi setidaknya kita akan melihat di mana Anda bisa mengklik. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oh ya! </font><font style="vertical-align: inherit;">Masih menulis kata "todos" dalam huruf kapital. </font><font style="vertical-align: inherit;">Tapi di sini saya, mungkin, akan membiarkan diri saya akhirnya menunjukkan sedikit imajinasi dan kreativitas, dan alih-alih hanya "todos" saya akan menulis "dap todos"</font></font><br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'H1'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"dap todos"</span></span>)</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wow </font><font style="vertical-align: inherit;">Sekarang </font></font><a href="https://dap.js.org/samples/tutorial/16.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplikasi kita</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat dianggap lengkap, dan tutorialnya diadakan (jika Anda dengan jujur ​​membaca baris-baris ini).</font></font><br><br><h2>  Kesimpulannya </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mungkin, saat membaca, Anda mendapat kesan bahwa program dap ditulis dengan coba-coba - ini semua "mari kita lihat apa yang terjadi", "tampaknya berhasil, tetapi ada nuansa", dll. </font></font> Ini sebenarnya tidak demikian.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua nuansa ini cukup jelas dan dapat diprediksi saat menulis kode. </font><font style="vertical-align: inherit;">Tapi saya pikir akan bermanfaat untuk menunjukkan dengan contoh nuansa ini mengapa keputusan ini atau itu ada dalam aturan dan mengapa itu dilakukan dengan cara ini dan bukan sebaliknya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tanyakan, seperti kata mereka, pertanyaan.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481680/">https://habr.com/ru/post/id481680/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481668/index.html">Masalah pemirsa pertama, atau kesulitan mengkonversi aliran video WebRTC ke HLS</a></li>
<li><a href="../id481670/index.html">Buat rencana tindakan menggunakan AWS Cloud Adoption Framework</a></li>
<li><a href="../id481672/index.html">Automata seluler di browser</a></li>
<li><a href="../id481674/index.html">Corong penjualan mobil atau bagaimana tidak menggabungkan pelanggan dan bahkan bekerja dengan mereka yang telah menolak layanan Anda?</a></li>
<li><a href="../id481676/index.html">Minggu Keamanan 52: Keamanan untuk Speaker Cerdas dan Kamera IP</a></li>
<li><a href="../id481684/index.html">Laptop dari Powerbank?</a></li>
<li><a href="../id481688/index.html">Mengapa mempelajari Java dan bagaimana melakukannya dengan efisien. Laporan Yandex</a></li>
<li><a href="../id481692/index.html">Menggunakan Pelacakan Prosesor Intel untuk Melacak Kode Mode Manajemen Sistem</a></li>
<li><a href="../id481694/index.html">Cara saya mempartisi di PostgreSQL</a></li>
<li><a href="../id481696/index.html">ruleeguard: pemeriksaan dinamis untuk Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>