<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüé§ üñ≤Ô∏è üëêüèæ Comment fonctionne MSTP ‚úçÔ∏è üç∫ ü•´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, parlons de MSTP. Avant de traiter avec MSTP, vous devez vous familiariser avec les protocoles STP et RSTP . MSTP est une modification de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment fonctionne MSTP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419785/"> Aujourd'hui, parlons de MSTP.  Avant de traiter avec MSTP, vous devez vous familiariser avec les protocoles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">STP</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RSTP</a> .  MSTP est une modification de RSTP, et donc de STP.  Si RSTP est le m√™me STP, seulement avec un envoi plus optimis√© des BPDU et du travail STP en g√©n√©ral, alors pourquoi devrions-nous trouver un MSTP qui fonctionne sur la base de RSTP?  La principale caract√©ristique de MSTP est la possibilit√© de travailler avec des VLAN.  Certains lecteurs peuvent dire: ¬´Attendez, Cisco pvst + et rpvst + ne sont-ils pas capables de fonctionner avec vlan?¬ª  RPVST + et PVST + ex√©cutent simplement des instances RSTP ou STP autonomes dans une seule limite vlan.  Mais ici, il y a des probl√®mes: <br><br><ul><li>  RPVST + et PVST + sont disponibles uniquement sur les √©quipements Cisco, et sur Cisco il n'y a pas de STP et RSTP classiques.  Que devons-nous faire si d'autres fournisseurs participent √† la topologie? </li><li>  Chaque instance de STP et RSTP envoie des BPDU toutes les deux secondes.  Si 100 vlanes sont ignor√©s sur le port de jonction, cela signifie que 100 messages seront envoy√©s en 2 secondes.  Ce qui n'est pas trop bon. </li><li>  Cisco a une limite sur le nombre d'instances STP ou RSTP sur un seul commutateur, selon le mod√®le.  Autrement dit, en ajoutant 128 r√©seaux locaux virtuels sur un commutateur, nous ferons face √† une telle restriction.  Lien <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> </li></ul><a name="habracut"></a><br>  Tous ces probl√®mes sont r√©solus avec succ√®s par le protocole multifournisseur MSTP.  Nous allons essayer de traiter son travail.  Le sch√©ma de construction d'une topologie sans boucle dans RSTP consiste √† cr√©er un graphique sans intersections quelle que soit la topologie logique, sans tenir compte de l'emplacement et de la configuration des vlans.  Dans MSTP, nous avons la possibilit√© de combiner certains r√©seaux locaux virtuels en un groupe et de cr√©er une topologie distincte pour chaque groupe.  Par exemple, jetez un ≈ìil √† une telle topologie: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/893/ec7/7a1/893ec77a1fc1abfe79a50798cbd67141.jpg" alt="Mon image"></a> <br><br>  Les PC agissent comme des segments de r√©seau.  PC1, PC3 est un segment de r√©seau o√π les vlans sont utilis√©s de 10 √† 50, et PC2, PC4 sont des vlans de 50 √† 100. Sur les commutateurs Sw1-4 eux-m√™mes, les vlans de 10 √† 100 sont cr√©√©s. Si nous utilisons le protocole RSTP, alors segments PC1 et PC2 pour acc√©der aux segments PC3 et PC4, respectivement, vous devez utiliser un chemin commun, en le choisissant parmi deux possibles: <b>Sw1-Sw2-Sw4</b> ou <b>Sw1-Sw3-Sw4</b> .  Malheureusement, cela ne fonctionnera pas pour construire un circuit avec une distribution de charge et l'un de ces chemins sera bloqu√© et vide.  Avec l'aide de PVST + et RPVST +, cela sera possible, mais il y a les probl√®mes mentionn√©s ci-dessus.  MSTP vient √† notre aide dans cette affaire, cr√©ant des instances RSTP pour un groupe de vlans 10-50 et 50-100.  Il peut √™tre configur√© que le commutateur racine pour Vlan 10-50 sera Sw3 et pour 50-100 - Sw2.  Le <b>chemin Sw1-Sw3-Sw4</b> sera utilis√© par le vlan 10-50, le <b>chemin Sw1-Sw2-Sw4</b> sera utilis√© par le vlan 50-100.  L'id√©e est de cr√©er des instances qui combineront les r√©seaux locaux virtuels et cr√©eront une arborescence RSTP s√©par√©ment pour chaque instance.  Ainsi, en combinant vlana 10-50 et 51-100 dans diff√©rentes instances, le protocole MSTP vous permettra de cr√©er des arborescences ind√©pendantes pour chaque instance.  La configuration ressemblera √† ceci: <br><blockquote>  configuration mst de spanning-tree <br>  note de nom <br>  instance 1 vlan 10-50 <br>  instance 2 vlan 51-100 <br></blockquote>  Il sera identique sur les 4 commutateurs.  Les commutateurs avec une configuration identique de ces param√®tres cr√©ent une r√©gion.  En ce qui concerne les r√©gions, nous parlerons plus en d√©tail ci-dessous, tandis que nous consid√©rons la topologie dans une r√©gion.  Pour chaque instance, son propre pont racine est s√©lectionn√©.  Sur Sw3, nous <b>saisissons la</b> commande <b>principale racine spanning-tree mst 1</b> afin que Sw3 soit le pont racine pour 10 √† 50 vlans, et sur Sw2 <b>spanning-tree mst 2 racine primaire</b> pour 51-100 vlans.  R√©capitulant, chaque instance <b>- plusieurs instances Spanning Tree (PIST</b> ) - Combine les vlan.  Et chaque r√©gion combine des commutateurs qui ont le m√™me MSTI.  √Ä strictement parler, dans la r√©gion, le commutateur doit avoir les param√®tres suivants: <br><br><ul><li>  nom de la r√©gion - le nom de la r√©gion.  D√©fini par la commande name. </li><li>  niveau de r√©vision - param√®tre de changement de configuration. </li><li>  MSTI. </li></ul><br>  Dans chaque r√©gion, il existe une instance de MSTI 0 (instance 0), qui est cr√©√©e par d√©faut et comprend tous les r√©seaux locaux virtuels qui n'√©taient pas inclus dans d'autres instances.  L'instance 0 est appel√©e IST: <br>  <b>Le Spanning Tree interne (IST)</b> est une copie sp√©ciale du spanning tree qui, par d√©faut, existe dans chaque r√©gion MST.  Num√©ro attribu√© par IST 0 (instance 0).  Il peut envoyer et recevoir des trames BPDU et sert √† g√©rer la topologie au sein d'une r√©gion.  Tous les VLAN configur√©s sur les commutateurs dans cette r√©gion MST sont li√©s √† l'IST par d√©faut. <br>  Le pont racine pour IST est appel√© pont racine r√©gional.  C'est via IST que les trames BPDU sont transmises √† travers lesquelles l'arborescence de chaque instance est install√©e.  Voyons √† quoi ressemble le BDPU dans cette r√©gion: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/603/7e8/9b6/6037e89b6888f6219b2bd82c2271c761.jpg" alt="Mon image"></a> <br><br>  Avant le d√©but de l'extension MST, BPDU MSTP est tr√®s difficile √† s√©parer de BPDU RSTP et, en gros, IST est un RSTP classique.  MSTP ajoute uniquement des donn√©es sur MSTI.  BPDU stocke les informations du pont racine pour l'instance 0-2.  Ainsi, pour tous les vlans et autorit√©s, un seul BPDU est envoy√©, contenant toutes les informations n√©cessaires.  Il s'agit d'une √©norme √©conomie sur PVST + et RPVST +.  Voyons la sortie de la commande show spanning-tree mst sur le commutateur Sw2: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/211/365/372/2113653723bfbe70f327a68a1ea4f27d.jpg" alt="Mon image"></a> <br><br>  Par exemple 0, il existe un champ sp√©cial - Racine r√©gionale.  Racine r√©gionale, nous avons s√©lectionn√© Sw3 √† l'aide de la <b>commande principale racine spanning-tree mst 0</b> .  La racine r√©gionale est le commutateur racine pour MSTI 0 dans la m√™me r√©gion.  Pour MSTI1, Root est √©galement Sw3 et pour MSTI2, c'est Sw2.  En termes de blocage de port et de convergence, MSTP r√©p√®te les principes de RSTP sur la base desquels il fonctionne, donc je pense que le travail de MSTP dans une r√©gion est tout √† fait compr√©hensible.  Consid√©rons une topologie avec deux r√©gions: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/501/c74/f20/501c74f206c089449ca1238133fa5dd8.jpg" alt="Mon image"></a> <br><br>  √Ä propos de la r√©gion A, il a √©t√© dit plus haut, essayons maintenant de comprendre comment les r√©gions interagissent les unes avec les autres.  Dans la r√©gion B, les commutateurs ont la configuration suivante: <br><blockquote>  configuration mst de spanning-tree <br>  nom RegionB <br>  instance 1 vlan 10-30 <br>  instance 2 vlan 31-60 <br></blockquote>  Dans le m√™me temps, Sw9 est le <b>principal racine</b> du <b>spanning-tree mst 1</b> est le commutateur racine pour Vlan 10-30, et Sw10 est le <b>principal racine</b> du <b>spanning-tree mst 2</b> est le commutateur racine pour Vlan 31-60. <br><br>  La construction de l'arbre STP dans la r√©gion B est similaire √† la r√©gion A et a √©t√© d√©crite ci-dessus.  Disons simplement que, puisque nous n'avons pas d√©fini le pont racine pour MSTI 0 dans la r√©gion B, il sera s√©lectionn√© par l'adresse MAC la plus basse parmi Sw9-12.  La plus petite adresse MAC est Sw9.  Sortie de commande avec Sw10: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/bbd/7f4/52a/bbd7f452a27ace3d97fc9b714bfed31a.jpg" alt="Mon image"></a> <br><br>  Pour MSTI 0 Racine r√©gionale 5000.0009.0000 (Sw9).  Ci-dessous, nous expliquerons pourquoi Sw9 et pourquoi l'adresse de priorit√© ou de pavot n'a rien √† voir avec cela.  Maintenant, nous nous int√©ressons davantage √† la question de ce qui se passera √† la fronti√®re.  Pour que l'arborescence STP soit correctement construite entre les r√©gions, une arborescence commune est cr√©√©e pour toutes les r√©gions utilisant MST0 (IST).  Un tel arbre est appel√© CIST.  Introduisons √©galement le concept CST.  Donc, rappelons d'abord l'IST: <br><br><ul><li>  <b>Internal Spanning Tree (IST)</b> est une copie sp√©ciale de l'arbre couvrant qui existe par d√©faut dans chaque r√©gion MST.  Num√©ro attribu√© par IST 0 (instance 0).  IST peut envoyer et recevoir des trames BPDU et sert √† g√©rer la topologie au sein d'une r√©gion.  Par d√©faut, tous les VLAN de la m√™me r√©gion sont li√©s √† IST.  Si plusieurs MSTI sont cr√©√©s dans une r√©gion, les VLAN qui ne leur sont pas associ√©s restent li√©s √† l'IST.  Dans nos r√©gions A et B, un arbre STP ind√©pendant est en cours de construction pour les vlans qui ne sont pas tomb√©s dans les autorit√©s 1 et 2. Root Bridge dans IST s'appelle Regional Root. </li><li>  <b>Common Spanning Tree (CST)</b> - un arbre reliant les r√©gions et tous les commutateurs STP, RSTP, PVST +, RPVST + (pas les commutateurs MST). </li><li>  <b>Arbre</b> couvrant <b>commun et interne (CIST)</b> - un arbre couvrant unique qui combine le CST et l'IST de chaque r√©gion MST. </li></ul><br>  Pour comprendre les limites de chaque arbre, je sugg√®re l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">article</a> suivant. <br><br>  IST est un arbre dans une r√©gion, CIST est un arbre entre les r√©gions, CST est un arbre qui combine des arbres dans une r√©gion et un arbre pour relier les r√©gions. <br><br>  Depuis que nous avons introduit la commande <b>principale racine spanning-tree mst 0</b> sur Sw3, le pont racine CIST pour les deux r√©gions sera Sw3.  S'il n'y a qu'une seule r√©gion dans toute la topologie, le pont racine r√©gional et le pont racine CIST co√Øncident.  S'il existe de nombreuses r√©gions, la meilleure racine r√©gionale parmi toutes les r√©gions est s√©lectionn√©e.  En outre, les commutateurs qui utilisent des protocoles autres que MSTP peuvent √™tre utilis√©s dans l'√©lection pour le r√¥le de pont racine CIST.  Si vous essayez de cr√©er une image globale, vous pouvez expliquer l'interaction des r√©gions comme suit: Chaque r√©gion semble √™tre une combinaison d'un certain nombre de commutateurs et est pr√©sent√©e aux autres commutateurs comme un grand commutateur virtuel.  Autrement dit, si nous consid√©rons notre topologie √† travers les yeux de la r√©gion B, nous obtenons l'image suivante pour cela: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/1d9/115/6f5/1d91156f550268ff06521adfff7a4136.jpg" alt="Mon image"></a> <br><br>  Il en sera de m√™me pour la r√©gion A, la r√©gion B sera repr√©sent√©e par un interrupteur.  Dans chaque r√©gion, chaque commutateur a un port racine le connectant √† la racine r√©gionale.  Chaque r√©gion s√©lectionne √©galement un port racine pour MSTI 0, ce qui conduit √† un pont racine CIST commun.  Ces ports peuvent √™tre les ports Gi1 / 1 sur Sw9 et Sw10, car ils connectent des r√©gions.  Dans notre topologie, Sw9 a le meilleur ID de pont, puis le port racine est s√©lectionn√© dessus, et sur Sw10 le port Gi1 / 1 est bloqu√©.  Sur Sw9, pour MSTI 0, le port Gi1 / 1 est le port racine, mais, par exemple, pour MSTI 1 et 2, il existe un port racine pour le pont racine d'instance et le port qui m√®ne au pont racine CIST re√ßoit un nouveau r√¥le - Ma√Ætre.  D'une r√©gion √† l'autre, il ne peut y avoir qu'un seul canal de travail ou en d'autres termes un seul port ma√Ætre et un seul commutateur.  Voici des informations sur le MST sur le commutateur Sw9, sur lequel le port ma√Ætre sera s√©lectionn√©, faites attention au port Gi1 / 1: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/bbd/7f4/52a/bbd7f452a27ace3d97fc9b714bfed31a.jpg" alt="Mon image"></a> <br><br>  Ce port pour MSTI 0, comme nous l'avons dit, a le r√¥le de Root et pour MSTI 1-2 Master.  A √©galement introduit un nouveau type de canal - P2p Bound (RSTP).  Le type Boundary est attribu√© aux ports qui bordent l'autre r√©gion ou une autre variante du protocole STP.  Les informations sur le pont racine CIST sont transmises √† la r√©gion via le port ma√Ætre, une caract√©ristique distinctive est que ce port n'envoie pas de BPDU par lui-m√™me, mais re√ßoit uniquement, contrairement au type de port P2P dans RSTP.  L'exception concerne uniquement les BPDU avec l'indicateur TC (changement de topologie).  Voyons comment un commutateur dans une r√©gion traite les BPDU d'une autre r√©gion.  Comme nous l'avons dit sur le port ma√Ætre Gi1 / 1 Sw9, les BPDU de Sw1 seront re√ßus, tandis que Sw9 lui-m√™me ne sera pas envoy√©, r√©fl√©chissez √† nouveau: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/4d8/35e/f5a/4d835ef5a9fdc2514075fab810cf5cb9.jpg" alt="Mon image"></a> <br><br>  Sw1 envoie le m√™me BPDU, que le commutateur envoie des BPDU √† l'int√©rieur ou √† l'ext√©rieur de la r√©gion.  Apr√®s avoir accept√© ce BPDU, Sw9 traitera uniquement les informations avant le d√©but du champ Extension MST, seules ces informations sont utilis√©es pour construire un arbre dans l'instance 0. Ici, vous pouvez remarquer un fait int√©ressant - l'identifiant racine (50: 00: 00: 03: 00: 00) correspond √† l'identifiant du pont (50: 00: 00: 03: 00: 00), bien qu'il envoie le paquet Sw1 avec l'identificateur de pont - 50: 00: 00: 01: 00: 00.  Cela confirme notre th√©orie selon laquelle chaque r√©gion pour une autre est repr√©sent√©e par un grand commutateur virtuel.  Vous pouvez √©galement dire qu'entre les r√©gions, nous avons le RSTP classique.  Mais parlons du co√ªt du chemin racine.  Il existe deux types de co√ªt de trajet: interne et externe.  Le co√ªt du chemin racine, qui pointe vers MSTI 0, est externe.  Et malgr√© le fait qu'il existe un canal suppl√©mentaire de Sw1 vers Root Bridge (Sw3), il est toujours indiqu√© comme z√©ro.  C'√©tait comme si Root Bridge lui-m√™me l'avait envoy√©.  Les co√ªts du chemin d'acc√®s racine interne sont r√©pertori√©s dans les champs sous l'extension MST.  Le co√ªt du chemin racine interne CIST indique le co√ªt du chemin vers le pont racine r√©gional pour MSTI 0, et les champs sous MSTID 1 et 2 indiquent le co√ªt du chemin racine interne vers le pont racine pour chaque instance, respectivement.  Le co√ªt du chemin racine externe a un r√¥le sp√©cial et tr√®s important, il d√©terminera le pont racine r√©gional, et non la priorit√© et l'adresse du pavot, nous avons fait une remarque √† ce sujet ci-dessus.  Le commutateur qui a le plus petit co√ªt de chemin racine jusqu'au pont racine CIST deviendra le pont racine r√©gional!  Par exemple, Sw9 et Sw10 ont un co√ªt de chemin racine de 20 000, √©gal au co√ªt du port Gi1 / 1.  Et seulement apr√®s cela, ils commencent √† comparer leurs identifiants de pont.  V√©rifions cela, changez le co√ªt du lien en Sw10 et augmentons en m√™me temps sa priorit√© au maximum pour exclure son option de s√©lection de la racine r√©gionale par priorit√©.  Nous introduisons les commandes suivantes: <br><blockquote>  SW10 (config-if) # spanning-tree mst 0 priorit√© 61440 <br>  Sw10 (config-if) # interface gigabitEthernet 1/1 <br>  SW10 (config-if) # spanning-tree mst 0 co√ªte 10000 <br></blockquote>  Et nous obtenons que Sw10, malgr√© sa terrible priorit√©, est devenu Regional Root Bridge: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/e5b/abd/51c/e5babd51cd3a12bfbe4e0ab94d9b474a.jpg" alt="Mon image"></a> <br><br>  Ainsi, la s√©lection du pont racine r√©gional se produit dans cette s√©quence et le pont racine r√©gional ne peut jamais √™tre un commutateur sans ports de fronti√®re: <br><br><ul><li>  Co√ªt du chemin externe le plus bas vers le pont racine du CIST. </li><li>  Identificateur de pont r√©gional le plus bas. </li><li>  CIST Bridge Identifier de BPDU de la r√©gion avec CIST Root Bridge. </li></ul><br>  Si, par exemple, nous ajoutons un lien entre Sw9 et Sw4 et pensons √† quel lien deviendra ma√Ætre, alors avec tous les param√®tres √©gaux, le champ CIST Bridge Identifier, qui est inf√©rieur √† l'extension MST, deviendra le champ d√©terminant.  Nous avons menti un peu en disant que Sw9 ne regarde pas les donn√©es sous l'extension MST.  Dans ce cas, l'identificateur de pont CIST de l'extension MST sera compt√©. <br>  Voyons maintenant le comportement de MST lorsque nous ajoutons des commutateurs RPVST: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/d40/eff/45b/d40eff45b3025e0e1b47b6a352199390.jpg" alt="Mon image"></a> <br><br>  Deux cas sont possibles: <br><br><ol><li>  Root Bridge appartient √† RPVST. </li><li>  Root Bridge appartient √† MSTP. </li></ol><br>  Consid√©rons d'abord le cas o√π Sw3 continue d'√™tre un pont racine CIST (c'est-√†-dire le cas 2).  Dans ce cas, Sw10 et Sw12 d√®s qu'ils re√ßoivent des BPDU de RSTP1 et RSTP2 pour chaque vlan, ils changeront le type de port Gi1 / 0 en <b>P2p Bound (PVST)</b> .  Ce type signifie que Sw10 et Sw12 sur ce port sont connect√©s aux commutateurs RPVST et commenceront √† envoyer des copies des BPDU pour MSTI0 (c'est-√†-dire sans champs en dessous de l'extension MST) √† tous les vlanes autoris√©s sur ce port.  Ainsi, RSTP1 et RSTP2 ne remarqueront pas que Sw10 et Sw12 utilisent un protocole diff√©rent.  Cette technologie dans MSTP est appel√©e <b>PVST Simulation,</b> et avec elle, nous obtenons la coordination entre les diff√©rents commutateurs. <br><br>  Le cas o√π le pont racine est parmi les commutateurs RPVST est plus complexe et n'est pas recommand√©.  Supposons que nous ayons RSTP1 est le pont racine pour tous les vlan.  Par souci de simplicit√©, nous supposons que l'ensemble vlan 1-3 et entrez la commande <b>spanning-tree vlan 1-3 priorit√© 12288,</b> la priorit√© la plus faible parmi les RSTP et MSTP commutateurs.  Sw10 commencera √† recevoir BPDU pour chacun des vlana.  Il est tr√®s important de comprendre que seuls les BPDU pour Vlan 1 seront trait√©s par le commutateur MSTP. Comment cela se produit-il? <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/d40/eff/45b/d40eff45b3025e0e1b47b6a352199390.jpg" alt="Mon image"></a> <br><br>  Selon le nombre de vlans configur√©s, de nombreux paquets RPVST + BPDU seront envoy√©s, mais en plus, ils seront √©galement envoy√©s via le BPDU vlan natif avec l'adresse mac de destination - 01: 80: c2: 00: 00: 00.  C'est cette adresse de pavot que MSTP utilise, les commutateurs PVST et RPVST utilisent une adresse de pavot diff√©rente - 01: 00: 0c: cc: cc: cd.  Quel que soit le vlan configur√© comme natif, les informations du premier vlan seront transmises dans cette BPDU.  Seul ce package sera trait√© pour construire l'arborescence par les commutateurs MSTP.  Les BPDU restants pour certains vlanes seront utilis√©s pour v√©rifier la protection du n≈ìud racine pendant les simulations PVST (PVST simulations root-guard-based consistent check).  Quel genre de ch√®que?  D√®s que nous configurons RSTP1 √† l'aide d'une telle commande de <b>spanning-tree vlan 1-3 priority 12288</b> , alors sur Sw10 nous obtiendrons imm√©diatement une erreur: <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/7a0/098/25f/7a009825fc7dd326bc5e426493500385.jpg" alt="Mon image"></a> <br><br>  Essayons d'expliquer.  Sw10 a adopt√© un BPDU vlan natif pour le vlan 1 avec la priorit√© 12288 + 1.  Trait√© et d√©cid√© que Gi1 / 0 est son port racine.  Puis est venu le PVST BPDU pour le reste du vlan (1-3), il les a √©tudi√©s pour v√©rifier l'int√©grit√© du commutateur racine et il y avait des priorit√©s 12288 + 2, 12288 + 3 pour le vlan 2-3, qui sont plus de 12288 + 1.  L'int√©grit√© s'effondre - d'une part, il doit s'agir du port racine, et l'obtention d'autres priorit√©s plus √©lev√©es force le port √† basculer vers le r√¥le d√©sign√©.  Une telle ambigu√Øt√© n'est pas autoris√©e pour de tels protocoles, et MST bloque ce port, le transformant en √©tat BKN, signalant une erreur - <b>Blocage du port racine Gi1 / 0: BPDU PVST inf√©rieur inconsistant re√ßu</b> .  Pour √©viter cela, il est n√©cessaire que pas un seul vlan dont les BPDU soient transmis sur ce port ait une priorit√© inf√©rieure (plus) que le vlan 1. Autrement dit, si nous r√©duisons la priorit√© du vlan 2-3 √† 4096, il est √©videmment inf√©rieur √† vlana 1, puis corrigez ce probl√®me. <br><br> <a href="" rel="nofollow"><img src="https://habrastorage.org/getpro/habr/post_images/0f6/4a6/c6d/0f64a6c6d9b21ae127cb5572c7ade92d.jpg" alt="Mon image"></a> <br><br>  Comme vous pouvez le voir, un message est apparu qui r√©tablit le bon fonctionnement du port - <b>incoh√©rence de la simulation PVST supprim√©e sur le port GigabitEhternet 0/1</b> . <br><br>  Sur ce, je pense, pour terminer la conversation sur MSTP.  Liens utiles ci-dessous: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">www.cisco.com/c/en/us/support/docs/lan-switching/multiple-instance-stp-mistp-8021s/116464-configure-pvst-00.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">habrahabr.ru/post/128172</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">www.cisco.com/c/ru_s/support/docs/lan-switching/multiple-instance-stp-mistp-8021s/116464-configure-pvst-00.pdf</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">www.cisco.com/c/en/us/td/docs/switches/datacenter/nexus5000/sw/configuration/guide/cli_rel_4_0_1a/CLIConfigurationGuide/MST.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">networkengineering.stackexchange.com/questions/28716/multiple-spanning-tree-terminology-cst-ist-cist-and-exact-behavior</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">blog.sbolshakov.ru/11-3-mstp</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">blog.ine.com/2010/02/22/understanding-mstp</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">networklessons.com/spanning-tree/multiple-spanning-tree-mst</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419785/">https://habr.com/ru/post/fr419785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419773/index.html">De z√©ro √† h√©ros "Actions sur Google": commencer</a></li>
<li><a href="../fr419777/index.html">Comment vendre des serveurs NNN aux Pays-Bas et ne pas se laisser enthousiasmer: les secrets de vente</a></li>
<li><a href="../fr419779/index.html">Les poumons cultiv√©s ont √©t√© transplant√©s avec succ√®s chez un porc; apr√®s 5 ans, des essais sur l'homme sont possibles</a></li>
<li><a href="../fr419781/index.html">SpaceX a organis√© le premier atelier sur Mars</a></li>
<li><a href="../fr419783/index.html">L'homme contre la machine: une nouvelle √©thique pour la cybers√©curit√©</a></li>
<li><a href="../fr419787/index.html">Rapport du Club Club 2018, chapitre 3.9: ¬´Cinq fois la performance des ressources¬ª</a></li>
<li><a href="../fr419789/index.html">Pens√©es de Jimmy Wales: ¬´Wikip√©dia est comme une saucisse ...¬ª</a></li>
<li><a href="../fr419791/index.html">Apple refuse le programme d'affiliation pour promouvoir les applications de l'App Store</a></li>
<li><a href="../fr419795/index.html">Tesla a signal√© une perte record. Les actions de la soci√©t√© ont encore augment√© en raison des pr√©visions pour le prochain trimestre</a></li>
<li><a href="../fr419797/index.html">R√©tro-ing√©nierie du protocole du panneau du climatiseur inverter Electrolux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>