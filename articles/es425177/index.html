<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëäüèº üòô üßëüèΩ‚Äçü§ù‚ÄçüßëüèΩ Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 3 üîÇ üôÖ üë®üèø‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Encuadernaci√≥n (persistencia) 
 Enlaces a todas las partes: 
 Parte 1. Obtenci√≥n del acceso inicial (acceso inicial) 
 Parte 2. Ejecuci√≥n 
 Parte 3. F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprenda t√°cticas adversas, t√©cnicas y conocimientos comunes (ATT @ CK). T√°cticas empresariales. Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425177/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Encuadernaci√≥n (persistencia)</a> </h1><br>  <b>Enlaces a todas las partes:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1. Obtenci√≥n del acceso inicial (acceso inicial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2. Ejecuci√≥n</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3. Fijaci√≥n (persistencia)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 4. Escalada de privilegios</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 5. Evasi√≥n de defensa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 6. Obtenci√≥n de credenciales (acceso de credenciales)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 7. Descubrimiento</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 8. Movimiento lateral</a> <br><br>  La tarea principal de asegurar el acceso es garantizar una presencia constante en el sistema atacado, porque el acceso puede perderse debido a un reinicio del sistema atacado, la p√©rdida de credenciales o el bloqueo de herramientas de acceso remoto debido a la detecci√≥n de un ataque. <br><a name="habracut"></a><br>  <i>El autor no es responsable de las posibles consecuencias de aplicar la informaci√≥n establecida en el art√≠culo, y tambi√©n se disculpa por posibles imprecisiones hechas en algunas formulaciones y t√©rminos.</i>  <i>La informaci√≥n publicada es un recuento gratuito de los contenidos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MITER ATT &amp; CK</a> .</i> <br><br>  Los m√©todos para garantizar la constancia en el sistema se pueden dividir en 3 categor√≠as: <br><ul><li>  Creaci√≥n no autorizada de cuentas o robo de credenciales existentes; </li><li>  Instalaci√≥n oculta y lanzamiento de herramientas de acceso remoto; </li><li>  Realizar cambios en la configuraci√≥n del sistema atacado con la ayuda de la cual es posible ejecutar numerosos c√≥digos maliciosos.  El c√≥digo malicioso se puede iniciar autom√°ticamente cada vez que el sistema se inicia o cada usuario inicia sesi√≥n en el sistema, inicia servicios modificados o maliciosos, inicia ciertos programas por parte del usuario o inicia el proceso de actualizaci√≥n del sistema o software de terceros. </li></ul><br>  Adem√°s, se presentan las t√©cnicas de bloqueo de acceso ofrecidas por ATT &amp; CK. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de archivos ~ / .bash_profile y ~ / .bashrc</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n: los</i> atacantes pueden incrustar c√≥digo en los archivos ~ / .bash_profile y ~ / .bashrc ( <i>dise√±ados para crear un entorno de usuario en el sistema operativo</i> ), que se ejecutar√° cuando el usuario inicie sesi√≥n o inicie un nuevo shell.  El archivo ~ / .bash_profile se ejecuta cuando el usuario inicia sesi√≥n, ~ / .bashrc se ejecuta cuando los shells se abren de forma interactiva.  Cuando un usuario inicia sesi√≥n (local o remotamente, por ejemplo a trav√©s de SSH) con un nombre de usuario y contrase√±a, ~ / .bash_profile se ejecuta antes de que se devuelva la invitaci√≥n del usuario.  Despu√©s de eso, cada vez que se abre un nuevo shell, se ejecuta ~ / .bashrc. <br>  En macOS, Terminal.app es ligeramente diferente en el sentido de que inicia el shell de inicio de sesi√≥n predeterminado cada vez que se abre la ventana del terminal, invocando ~ / .bash_profile cada vez. <br><br>  <i>Recomendaciones de protecci√≥n:</i> conceder derechos para modificar los archivos ~ / .bash_profile y ~ / .bashrc solo para administradores autorizados. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de archivos ejecutables de aplicaciones "caracter√≠sticas de accesibilidad de Windows" (Caracter√≠sticas de accesibilidad)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: las</i> aplicaciones de accesibilidad (lupa de pantalla, teclado en pantalla, etc.) se pueden iniciar utilizando combinaciones de teclas antes de que un usuario inicie sesi√≥n en el sistema.  Un atacante puede reemplazar los archivos de inicio de estos programas o cambiar la forma en que se inician y abrir una consola de comandos u obtener una puerta trasera sin iniciar sesi√≥n. <br><ul><li>  <i>C: \ Windows \ System32 \ sethc.exe</i> - lanzado 5 veces presionando la tecla Shift; </li><li>  <i>C: \ Windows \ System32 \ utilman.exe</i> : lanzado presionando la combinaci√≥n de Win + U. </li></ul><br>  En WinXP y versiones posteriores, sethc.exe y utilman.exe pueden reemplazarse, por ejemplo, con cmd.exe, luego, cuando presiona la combinaci√≥n de teclas deseada, cmd.exe se inicia antes de ingresar a Windows con privilegios del sistema. <br>  En Vista y versiones posteriores, debe cambiar la clave de registro que configura cmd.exe u otro programa como depurador, por ejemplo, para ultiman.exe.  Despu√©s de editar el registro y presionar la combinaci√≥n de teclas deseada en la pantalla de inicio de sesi√≥n o al conectarse al host a trav√©s de RDP, se ejecutar√° cmd.exe con derechos de sistema. <br>  Tambi√©n hay programas de Windows que pueden usarse para implementar esta t√©cnica de ataque: <br><ul><li>  C: \ Windows \ System32 \ osk.exe; </li><li>  C: \ Windows \ System32 \ Magnify.exe; </li><li>  C: \ Windows \ System32 \ Narrator.exe; </li><li>  C: \ Windows \ System32 \ DisplaySwitch.exe; </li><li>  C: \ Windows \ System32 \ AtBroker.exe. </li></ul><br><br>  <i>Recomendaciones de seguridad:</i> configure el inicio de la autenticaci√≥n de red obligatoria para usuarios remotos antes de crear una sesi√≥n RDP y mostrar la pantalla de inicio de sesi√≥n ( <i>habilitada de forma predeterminada en Windows Vista y posterior</i> ).  Use la puerta de enlace de escritorio remoto para administrar conexiones y configurar la seguridad RDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de la clave de DLL de AppCert</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: las</i> DLL especificadas en el valor de la clave AppCertDLL se cargan en cada proceso que llama a las funciones API utilizadas con frecuencia: <i>CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, WinExec</i> .  Se puede abusar del valor de la clave AppCertDLLs al hacer que una DLL maliciosa cargue y ejecute ciertos procesos.  AppCertDLLs se almacena en la siguiente clave de registro: <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager</i> . <br><br>  <i>Recomendaciones de protecci√≥n:</i> utilice todos los medios posibles para bloquear software potencialmente peligroso y descargar archivos DLL desconocidos, como AppLocker y DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de la clave DLL de AppInit</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: las</i> DLL especificadas en el valor de la clave AppInit_DLL se cargan en cada proceso que carga user32.dll.  En la pr√°ctica, esto es casi todos los programas. <br>  AppInit_DLLs se almacena en las siguientes claves de registro: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Windows;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Windows.</i> </li></ul><br>  Se puede abusar del valor de la clave AppInit_DLL para exceder los privilegios al cargar archivos DLL maliciosos e iniciar ciertos procesos.  La funcionalidad AppInit_DLLs est√° deshabilitada en Windows 8 y versiones posteriores cuando se activa el arranque seguro. <br><br>  <i>Recomendaciones de protecci√≥n:</i> considere usar una versi√≥n del sistema operativo no anterior a Windows 8 y habilitar el arranque seguro.  Utilice todo tipo de medios para bloquear software potencialmente peligroso y descargar archivos DLL desconocidos, como AppLocker y DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Abuso del subsistema de compatibilidad de aplicaciones (Aplicaci√≥n Shimming)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: La</i> <i>infraestructura / marco de compatibilidad de aplicaciones de Microsoft Windows se</i> cre√≥ para garantizar la compatibilidad de los programas con las actualizaciones de Windows y los cambios en el c√≥digo del sistema operativo.  El sistema de compatibilidad utiliza las llamadas shim ("juntas"), bibliotecas que act√∫an como un b√∫fer entre el programa y el sistema operativo.  Usando la memoria cach√© de shim, el sistema determina la necesidad de juntas de shim (almacenadas como una base de datos .sdb).  Varios archivos .sdb almacenan varios procedimientos para interceptar el c√≥digo de la aplicaci√≥n, procesarlo y luego redirigirlo al sistema operativo.  La lista de todas las juntas de cu√±as instaladas por el instalador (sdbinst.exe) se almacena de forma predeterminada en: <br><ul><li>  <i>% WINDIR% \ AppPatch \ sysmain.sdb</i> ; </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ InstalledSDB</i> . </li></ul><br>  Las bases de datos de shim personalizadas se almacenan en: <br><ul><li>  <i>% WINDIR% \ AppPatch [64] \ Personalizado;</i> </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Custom</i> . </li></ul><br>  Para garantizar la protecci√≥n en el modo de usuario, se excluye la posibilidad de cambiar el n√∫cleo del sistema operativo utilizando shim-gaskets, y se requieren derechos de administrador para instalarlos.  Sin embargo, algunos shim pads pueden usarse para evitar el Control de cuentas de usuario (UAC), la inyecci√≥n de DLL, deshabilitar la <a href="">Prevenci√≥n de ejecuci√≥n de datos</a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Manejo de excepciones de estructuras</a> , as√≠ como interceptar direcciones de memoria.  Un atacante que usa juntas de ajuste puede aumentar los privilegios, instalar puertas traseras, desactivar la protecci√≥n del sistema operativo, como Windows Defender. <br><br>  <i>Recomendaciones de protecci√≥n:</i> no hay muchas maneras de evitar la aplicaci√≥n de calces.  No se recomienda deshabilitar la compatibilidad de aplicaciones para evitar problemas con la estabilidad del sistema operativo.  Microsoft lanz√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KB3045645</a> , que eliminar√° el indicador de "elevaci√≥n autom√°tica" en el archivo sdbinst.exe para evitar el uso del sistema shim para evitar el UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de componentes del paquete de autenticaci√≥n de Windows</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: las</i> DLL de Windows Authentification Pack son cargadas por el proceso de la Autoridad de Seguridad Local (LSA) al inicio del sistema y brindan soporte para m√∫ltiples procesos de inicio de sesi√≥n y m√∫ltiples protocolos de seguridad del sistema operativo.  Los atacantes pueden usar el mecanismo de ejecuci√≥n autom√°tica LSA colocando un enlace a un archivo binario en la siguiente clave de registro: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ Paquetes de autenticaci√≥n: [binario de destino]</i> . <br>  El sistema lanzar√° [Target binary] cuando <i>se</i> descarguen los <i>paquetes de autenticaci√≥n</i> . <br><br>  <i>Recomendaciones de protecci√≥n:</i> en Windows 8.1, Windows Server 2012 R2 y LSA posteriores, puede hacer que funcione como un proceso protegido (PPL) utilizando la clave de registro: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL = DWORD: 00000001</i> , <br>  que requiere que todas las DLL cargadas por LSA se firmen con un certificado digital de Microsoft. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Creaci√≥n de trabajos BITS (trabajos BITS)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n:</i> <i>El Servicio de transferencia inteligente en segundo plano de Windows (BITS)</i> es un mecanismo para transferir archivos asincr√≥nicamente a trav√©s del Modelo de objetos componentes (COM) utilizando un ancho de banda bajo.  BITS generalmente es utilizado por actualizadores, mensajeros instant√°neos y otras aplicaciones que prefieren trabajar en segundo plano sin interrumpir el funcionamiento de otras aplicaciones de red.  Las tareas de transferencia de archivos se representan como tareas BITS que contienen una cola de una o m√°s operaciones de archivo.  La interfaz para crear y administrar tareas BITS est√° disponible en las herramientas PowerShell y BITSAdmin.  Los atacantes pueden usar BITS para descargar, iniciar y luego limpiar despu√©s de ejecutar c√≥digo malicioso.  Las tareas de BITS se almacenan de forma aut√≥noma en la base de datos de BITS, mientras que el sistema no crea nuevos archivos o entradas de registro, a menudo el firewall permite BITS.  Con las tareas de BITS, puede afianzarse en el sistema creando tareas largas (de forma predeterminada, 90 d√≠as) o llamando a un programa arbitrario despu√©s de completar una tarea o error de BITS (incluso despu√©s de reiniciar el sistema operativo). <br><br>  <i>Recomendaciones de protecci√≥n:</i> BITS es una funcionalidad est√°ndar del sistema operativo, cuyo uso es dif√≠cil de distinguir de la actividad maliciosa, por lo tanto, el vector de protecci√≥n debe estar dirigido a evitar el lanzamiento de herramientas maliciosas al comienzo de la cadena de ataque.  Deshabilitar BITS por completo puede detener las actualizaciones de software leg√≠timas, sin embargo, puede considerar restringir el acceso a la interfaz BITS a usuarios y grupos de acceso espec√≠ficos, y tambi√©n puede limitar la vida √∫til de las tareas de BITS, que se configura cambiando las siguientes teclas: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Pol√≠ticas \ Microsoft \ Windows \ BITS \ JobInactivityTimeout;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Pol√≠ticas \ Microsoft \ Windows \ BITS \ MaxDownloadTime</i> . </li></ul><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kits de arranque</a> </h3><br>  <i>Sistema:</i> Linux, Windows <br>  <i>Derechos:</i> administrador, sistema <br>  <i>Descripci√≥n:</i> Bootkit es un tipo de malware que puede cambiar los sectores de arranque de un disco duro, incluidos Master Boot Record (MBR) y Volume Boot Record (VBR).  Los atacantes pueden usar Bootkit para acoplar en sistemas por debajo del sistema operativo.  MBR: la secci√≥n del ferrocarril, que se carga inmediatamente despu√©s de completar la Bios de inicializaci√≥n de hardware.  Un atacante con acceso para reescribir el MBR puede reemplazar el c√≥digo del gestor de arranque por uno malicioso.  VBR es la partici√≥n del disco duro que recibe el control del proceso de arranque desde el MBR.  Por analog√≠a con la opci√≥n de reescribir MBR, un atacante puede ejecutar c√≥digo malicioso en la etapa de arranque del sistema. <br><br>  <i>Recomendaciones de protecci√≥n:</i> Uso de las herramientas de control de integridad MBR y VBR.  Usando Trusted Platform Module (TPM) y Secure Boot. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Extensiones de navegador</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: por</i> regla general, los complementos tienen todos los accesos y derechos que puede obtener un navegador.  Los complementos maliciosos se pueden instalar descargando aplicaciones maliciosas disfrazadas de programas leg√≠timos utilizando t√©cnicas de ingenier√≠a social, phishing o un atacante que ya ha comprometido el sistema.  Los complementos maliciosos pueden abrir sitios web en segundo plano, robar informaci√≥n que un usuario ingresa en un navegador, incluidas las credenciales, para ser utilizados como instaladores de herramientas de administraci√≥n remota (RAT) y arreglos para el sistema. <br><br>  <i>Recomendaciones de protecci√≥n:</i> instale complementos solo de fuentes confiables.  Controle los complementos instalados con la directiva de grupo.  Evite la instalaci√≥n de complementos por parte de usuarios comunes.  Inventario y monitoreo de complementos instalados. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de los par√°metros de las asociaciones de archivos (Cambiar la asociaci√≥n de archivos predeterminada)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n: los</i> atacantes pueden modificar las asociaciones de archivos para ejecutar comandos arbitrarios.  La elecci√≥n de las asociaciones de archivos con las aplicaciones se almacena en el registro de Windows y los usuarios, administradores y programas que tienen acceso al registro pueden editarla.  Las aplicaciones pueden modificar asociaciones para invocar programas arbitrarios.  Los par√°metros de las asociaciones del sistema se almacenan en el registro: <i>HKEY_CLASSES_ROOT \. [Extensi√≥n]</i> , por ejemplo, <i>HKEY_CLASSES_ROOT \ .txt</i> .  Los diversos comandos se enumeran como subsecciones: <i>HKEY_CLASSES_ROOT \ [handler] \ shell \ [action] \ [command]</i> , por ejemplo: <br><ul><li>  HKEY_CLASSES_ROOT \ txtfile \ shell \ open \ [comando]; </li><li>  HKEY_CLASSES_ROOT \ txtfile \ shell \ print \ [comando]; </li><li>  HKEY_CLASSES_ROOT \ txtfile \ shell \ printto \ [comando]; </li></ul><br>  donde <i>[comando]</i> es el comando que se ejecutar√° al abrir el archivo con la extensi√≥n especificada. <br><br>  Mejores pr√°cticas de <i>seguridad:</i> siga <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">las recomendaciones de Microsoft</a></i> para las asociaciones de archivos.  Utilice todos los medios posibles para bloquear software potencialmente peligroso, como AppLocker y DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Firmware de componentes</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> sistema <br>  <i>Descripci√≥n:</i> algunos ciberdelincuentes pueden usar herramientas sofisticadas para comprometer los componentes de la computadora e instalar firmware malicioso en ellos que ejecutar√° c√≥digo malicioso fuera del sistema operativo o incluso el firmware del sistema principal (Bios).  La t√©cnica consiste en flashear componentes de computadora que no tienen un sistema de verificaci√≥n de integridad incorporado, por ejemplo, discos duros.  Un dispositivo con firmware malicioso puede proporcionar acceso constante al sistema atacado a pesar de las fallas y la sobrescritura del disco duro.  La t√©cnica est√° dise√±ada para superar la protecci√≥n del software y el control de integridad. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Interceptaci√≥n de enlaces y secuestro del modelo de objetos componentes de enlaces</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n:</i> <i>Microsoft Component Object Model (COM)</i> es una tecnolog√≠a para crear software basado en componentes interactivos de un objeto, cada uno de los cuales se puede usar en muchos programas simult√°neamente.  Los atacantes pueden usar COM para inyectar c√≥digo malicioso que se puede ejecutar en lugar de uno leg√≠timo capturando enlaces y enlaces COM.  Para interceptar un objeto COM, debe reemplazar el enlace a un componente leg√≠timo del sistema en el registro de Windows.  Una nueva llamada a este componente ejecutar√° c√≥digo malicioso. <br><br>  <i>Recomendaciones de protecci√≥n: no se recomiendan</i> medidas preventivas para prevenir este ataque, ya que los objetos COM son parte del sistema operativo y est√°n instalados en el software del sistema.  Bloquear cambios en los objetos COM puede afectar la estabilidad del sistema operativo y el software.  Se recomienda el vector de protecci√≥n para bloquear software malicioso y potencialmente peligroso. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Crear cuentas</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: los</i> atacantes con acceso suficiente pueden crear cuentas locales o de dominio para una mayor consolidaci√≥n en el sistema.  Los comandos de usuario de red tambi√©n se pueden usar para crear cuentas. <br><br>  <i>Recomendaciones de seguridad:</i> el uso de autenticaci√≥n multifactor.  Configure ajustes de seguridad en servidores importantes, configure controles de acceso, firewalls.  Prohibir el uso de una cuenta de administrador de dominio para realizar operaciones diarias durante las cuales un atacante puede obtener informaci√≥n de la cuenta.  Los atacantes que crearon cuentas en el sistema solo pueden obtener acceso limitado a la red si los niveles de acceso est√°n bloqueados correctamente.  Es posible que solo se requieran cuentas para asegurar el acceso a un sistema separado. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intercepci√≥n de b√∫squeda de DLL (Secuestro de orden de b√∫squeda de DLL)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n: la</i> t√©cnica consiste en explotar vulnerabilidades en el algoritmo para encontrar mediante las aplicaciones los archivos DLL que necesitan para funcionar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MSA2269637</a> ).  A menudo, el directorio de b√∫squeda de DLL es el directorio de trabajo del programa, por lo que los atacantes pueden reemplazar la DLL de origen por una maliciosa con el mismo nombre de archivo. <br>  Los ataques remotos en b√∫squedas de DLL se pueden llevar a cabo cuando el programa instala su directorio actual en un directorio remoto, por ejemplo, un recurso compartido de red.  Adem√°s, los atacantes pueden cambiar directamente el m√©todo de b√∫squeda y carga de archivos DLL reemplazando los archivos .manifest o .local, que describen los par√°metros de b√∫squeda de DLL.  Si el programa atacado funciona con un alto nivel de privilegios, la DLL maliciosa cargada por √©l tambi√©n se ejecutar√° con altos derechos.  En este caso, la t√©cnica se puede utilizar para aumentar los privilegios del usuario al administrador o al sistema. <br><br>  <i>Recomendaciones de protecci√≥n:</i> evite la carga remota de DLL (habilitada de manera predeterminada en Windows Server 2012+ y disponible con actualizaciones para XP + y Server 2003+).  Habilita el modo de b√∫squeda segura para archivos DLL, que restringe los directorios de b√∫squeda a directorios como <i>% SYSTEMROOT%</i> antes de realizar una b√∫squeda de DLL en el directorio de la aplicaci√≥n actual. <br>  Habilitar el modo de b√∫squeda segura de DLL: <br>  <i>Configuraci√≥n del equipo&gt; [Pol√≠ticas]&gt; Plantillas administrativas&gt; MSS (Legacy): MSS: (SafeDllSearchMode) Habilite el modo de b√∫squeda de DLL seguro.</i> <br>  Clave de registro correspondiente: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br>  Considere auditar un sistema protegido para corregir deficiencias de DLL utilizando herramientas como PowerUP en PowerSploit.  No olvides bloquear el software malicioso y potencialmente peligroso, as√≠ como seguir las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">recomendaciones de Microsoft</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intercepci√≥n de b√∫squeda de Dylib (secuestro de Dylib)</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: la</i> t√©cnica se basa en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vulnerabilidades en los algoritmos de b√∫squeda de biblioteca din√°mica dylib en macOS y OS X.</a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La conclusi√≥n es determinar el dylib que carga la aplicaci√≥n atacada y luego colocar la versi√≥n maliciosa de dylib con el mismo nombre en el directorio de trabajo de la aplicaci√≥n. </font><font style="vertical-align: inherit;">Esto har√° que la aplicaci√≥n cargue dylib, que se encuentra en el directorio de trabajo del programa. </font><font style="vertical-align: inherit;">En este caso, el Dylib malicioso se ejecutar√° con los derechos de acceso de la aplicaci√≥n atacada. </font><font style="vertical-align: inherit;">Consejos de seguridad </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> evite que los usuarios escriban archivos en directorios de b√∫squeda dylib. </font><font style="vertical-align: inherit;">Audite las vulnerabilidades utilizando el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dylib Hijacking Scanner</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Objective-See.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Servicios remotos externos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario </font><i><font style="vertical-align: inherit;">: Los</font></i><font style="vertical-align: inherit;"> atacantes pueden usar los servicios remotos externos de la organizaci√≥n, como VPN, Citrix y WinRM, para protegerse dentro de la red atacada. El acceso a los servicios puede llevarse a cabo utilizando cuentas v√°lidas obtenidas mediante t√©cnicas para redirigir a los usuarios a sitios falsos (pharming), o en la etapa de comprometer la red. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restringir el acceso a servicios remotos utilizando conmutadores administrados centralmente, utilizando una VPN. </font><font style="vertical-align: inherit;">Prohibici√≥n del acceso remoto directo a la red interna mediante el uso de servidores proxy, puertas de enlace y firewalls. </font><font style="vertical-align: inherit;">Deshabilitar servicios que se pueden usar de forma remota, como WinRM. </font><font style="vertical-align: inherit;">El uso de la autenticaci√≥n de dos factores. </font><font style="vertical-align: inherit;">Monitorear la actividad del uso de servicios remotos fuera del horario laboral.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desventajas de los permisos a nivel del sistema de archivos (Debilidad de permisos del sistema de archivos)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Usuario, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La esencia de la t√©cnica es reemplazar los archivos ejecutables que se inician autom√°ticamente por varios procesos (por ejemplo, cuando se inicia el sistema operativo o en un momento determinado, si los derechos de los archivos ejecutables est√°n configurados incorrectamente). Despu√©s de la suplantaci√≥n de identidad, el archivo malicioso se lanzar√° con los derechos del proceso, por lo que si el proceso tiene un nivel de acceso m√°s alto, el atacante podr√° escalar los privilegios. En esta t√©cnica, los atacantes pueden intentar manipular los archivos binarios del servicio de Windows.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otra variante del ataque est√° asociada con las deficiencias de los algoritmos en el trabajo de los instaladores autoextra√≠bles. Durante el proceso de instalaci√≥n, los instaladores a menudo descomprimen varios archivos √∫tiles, incluidos .dll y .exe, en el directorio% TEMP%, sin embargo, es posible que no establezcan los permisos adecuados para restringir el acceso a los archivos desempaquetados, lo que permite a los atacantes realizar suplantaci√≥n de archivos y, como resultado, aumenta los privilegios o evita el control de la cuenta, como algunos instaladores se ejecutan con privilegios extendidos. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restricci√≥n de derechos de cuenta para que solo los administradores puedan administrar los servicios e interactuar con los archivos binarios utilizados por los servicios. </font><font style="vertical-align: inherit;">Deshabilite las opciones de escalado de privilegios UAC para usuarios est√°ndar. </font><font style="vertical-align: inherit;">La configuraci√≥n de UAC se almacena en la siguiente clave de registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para rechazar autom√°ticamente las solicitudes de escalada de privilegios, debe agregar una clave: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ConsentPromptBehaviorUser" = dword: 00000000.</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para controlar el trabajo de los instaladores, debe agregar una clave: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"EnableInstallerDetection" = dword: 00000001</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que requerir√° una contrase√±a para instalar programas.</font></font></li></ul><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archivos y directorios ocultos</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos: </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Descripci√≥n del</font></i><font style="vertical-align: inherit;"> usuario </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los atacantes pueden usar la capacidad de ocultar archivos y carpetas para no atraer la atenci√≥n de los usuarios. En Windows, los usuarios pueden ocultar archivos usando el comando attrib. Es suficiente especificar el atributo + h &lt;nombre de archivo&gt; para ocultar el archivo o "+ s" para marcar el archivo como sistema. Al agregar el par√°metro "/ S", la utilidad attrib aplicar√° los cambios de forma recursiva. En Linux / Mac, los usuarios pueden ocultar archivos y carpetas simplemente especificando un "." Al comienzo del nombre del archivo. Despu√©s de eso, los archivos y las carpetas se ocultar√°n de la aplicaci√≥n Finder y, como la utilidad "ls". En macOS, los archivos se pueden marcar con UF_HIDDEN, lo que deshabilitar√° su visibilidad en Finder.app, pero no evitar√° que se vean archivos ocultos en Terminal.app. Muchas aplicaciones crean archivos y carpetas ocultos para no saturar el espacio de trabajo del usuario. Por ejemploLas utilidades SSH crean una carpeta .ssh oculta que almacena una lista de hosts conocidos y claves de usuario.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Evitar el uso de esta t√©cnica es dif√≠cil debido a que ocultar archivos es una caracter√≠stica est√°ndar del sistema operativo.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interceptar llamadas a funciones de la API de Windows (enlace)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> las funciones de la API de Windows generalmente se almacenan en archivos DLL. </font><font style="vertical-align: inherit;">La t√©cnica de conexi√≥n es redirigir las llamadas a las funciones API mediante:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Procedimientos de enlace: procedimientos integrados en el sistema operativo que ejecutan c√≥digo cuando se llaman varios eventos, por ejemplo, pulsaciones de teclas o mover el mouse; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificaciones a la tabla de direcciones (IAT), que almacena punteros a funciones API. </font><font style="vertical-align: inherit;">Esto le permitir√° "enga√±ar" a la aplicaci√≥n atacada, forz√°ndola a iniciar una funci√≥n maliciosa;</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cambio directo de funci√≥n (empalme), durante el cual se cambian los primeros 5 bytes de la funci√≥n, en lugar de que se inserta la transici√≥n a una funci√≥n maliciosa u otra determinada por el atacante. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al igual que las inyecciones, los atacantes pueden usar el enganche para ejecutar c√≥digo malicioso, enmascarar su ejecuci√≥n, acceder a la memoria del proceso atacado y aumentar los privilegios. </font><font style="vertical-align: inherit;">Los atacantes pueden capturar llamadas API que incluyen par√°metros que contienen datos de autenticaci√≥n. </font><font style="vertical-align: inherit;">El enganche generalmente es utilizado por rootkits para ocultar actividades maliciosas en el sistema. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interceptaci√≥n de eventos en el sistema operativo es parte del funcionamiento normal del sistema, por lo que cualquier restricci√≥n de esta funcionalidad puede afectar negativamente la estabilidad de las aplicaciones leg√≠timas, como el software antivirus. </font><font style="vertical-align: inherit;">Los esfuerzos para evitar el uso de t√©cnicas de intercepci√≥n deben centrarse en las etapas m√°s tempranas de la cadena de ataque. </font><font style="vertical-align: inherit;">Puede detectar actividad de enganche maliciosa al monitorear las llamadas a las funciones SetWindowsHookEx y SetWinEventHook, utilizando detectores de rootkit y analizando el comportamiento an√≥malo de los procesos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hipervisor</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> el hipervisor puede verse comprometido por un atacante y tener rootkits ocultos de los sistemas invitados. </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de seguridad:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> evite el acceso malicioso a cuentas privilegiadas necesarias para instalar y configurar un hipervisor.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inyecci√≥n IFEO (inyecci√≥n de opciones de ejecuci√≥n de archivos de imagen)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> El mecanismo de Opciones de ejecuci√≥n de archivos de imagen (IFEO) le permite ejecutar un depurador de programa en lugar de un programa, previamente especificado por el desarrollador en el registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Opciones de ejecuci√≥n de archivos de imagen / [ejecutable]</font></font></i> </li><li> <i>HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\[executable]</i> ,,  <i>[executable]</i> ‚Äî     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al igual que las inyecciones, </font><font style="vertical-align: inherit;">se puede abusar </font><font style="vertical-align: inherit;">del valor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ejecutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ejecutando c√≥digo arbitrario para aumentar los privilegios u obtener un punto de apoyo en el sistema. Los programas maliciosos pueden usar IFEO para eludir la protecci√≥n mediante el registro de depuradores que redirigen y rechazan diversas aplicaciones de sistema y seguridad. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica descrita se basa en el abuso de las herramientas de desarrollo de SO normales, por lo que cualquier restricci√≥n puede causar inestabilidad de software leg√≠timo, por ejemplo, aplicaciones de seguridad. Los esfuerzos para evitar el uso de las t√©cnicas de inyecci√≥n de IFEO deben centrarse en las primeras etapas de la cadena de ataque. Puede detectar dicho ataque monitoreando procesos con </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_only_this_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Extensiones y m√≥dulos de n√∫cleo cargables (M√≥dulos y extensiones de n√∫cleo)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ra√≠z </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Los m√≥dulos de kernel descargables (LKM) son programas especiales que se pueden cargar y descargar desde el kernel sin la necesidad de un reinicio completo del sistema. </font><font style="vertical-align: inherit;">Por ejemplo, LKM incluye controladores de dispositivo. </font><font style="vertical-align: inherit;">Los atacantes pueden cargar LKM maliciosos utilizando varios rootkits. </font><font style="vertical-align: inherit;">Por lo general, estos rootkits se rompen, los archivos, los procesos, la actividad de la red, los registros de auditor√≠a falsos, proporcionan puertas traseras. </font><font style="vertical-align: inherit;">Al igual que LKM en macOS, existen los llamados KEXT que se cargan y descargan con los comandos kextload y kextunload. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilice las herramientas de detecci√≥n de rootkit de Linux: rkhunter, chrootkit. </font><font style="vertical-align: inherit;">Limite el acceso a la cuenta ra√≠z, que es necesaria para cargar m√≥dulos en el n√∫cleo. </font><font style="vertical-align: inherit;">Utilice el control de acceso forzado de SELinux.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificaci√≥n del encabezado LC_LOAD_DYLIB Adici√≥n en archivos Mach-O (LC_LOAD_DYLIB Adici√≥n)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> los archivos Mach-O contienen una serie de encabezados que se utilizan para realizar ciertas operaciones al descargar un archivo binario. </font><font style="vertical-align: inherit;">El encabezado LC_LOAD_DYLIB en los binarios de Mach-O le dice al sistema operativo qu√© bibliotecas dylib cargar. </font><font style="vertical-align: inherit;">Los cambios en los encabezados invalidar√°n la firma digital, sin embargo, un atacante puede eliminar el comando LC_CODE_SIGNATURE del archivo binario y el sistema no verificar√° que la firma sea correcta cuando se descargue. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> todos los archivos binarios deben estar firmados con las ID de desarrollador de Apple correctas, y las listas blancas de aplicaciones se compilan de acuerdo con hashes conocidos.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controladores de la Autoridad de seguridad local (controlador LSASS)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Autoridad de Seguridad Local (LSA): un subsistema de Windows que proporciona autenticaci√≥n de usuario. </font><font style="vertical-align: inherit;">El LSA incluye varias DLL din√°micas interconectadas que se ejecutan en el proceso LSASS.exe. </font><font style="vertical-align: inherit;">Los atacantes pueden atacar LSASS.exe reemplazando o agregando controladores LSA ileg√≠timos y luego ejecutando c√≥digo arbitrario. </font><font style="vertical-align: inherit;">La t√©cnica se implementa en el malware Pasam y Wingbird, que "arroja" las DLL modificadas utilizadas para cargar LSASS. </font><font style="vertical-align: inherit;">En este caso, el c√≥digo malicioso se ejecuta antes de que la DLL ileg√≠tima cause un bloqueo y el posterior bloqueo del servicio LSASS. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En Windows 8.1 y Server 2012 R2, habilite la protecci√≥n LSA activando la clave especificada: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL = dword: 00000001.</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta protecci√≥n garantiza que los complementos y controladores cargados con LSA est√©n firmados digitalmente por Microsoft. </font><font style="vertical-align: inherit;">En Windows 10 y Server 16, habilite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Credential Guard de Windows Defender</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ejecutar lsass.exe en un entorno virtual aislado. </font><font style="vertical-align: inherit;">Para reducir el riesgo de que las bibliotecas maliciosas se carguen en lsass.exe, habilite el modo seguro de b√∫squeda de DLL:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager \ SafeDllSearchMode.</font></font></i> </li></ul><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agentes de lanzamiento</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Usuario, administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t√©cnica consiste en abusar de la funcionalidad de creaci√≥n y lanzamiento por parte de los usuarios Agentes de lanzamiento: servicios de ejecuci√≥n autom√°tica a nivel de usuario. </font><font style="vertical-align: inherit;">Cuando cada usuario inicia sesi√≥n en el sistema, launchd carga los par√°metros de los Agentes de lanzamiento desde los archivos * .plist. </font><font style="vertical-align: inherit;">Los archivos Plist tienen una estructura XML y contienen instrucciones que le indican a launchd qu√© ejecutables y cu√°ndo iniciar. </font><font style="vertical-align: inherit;">Los archivos Plist se pueden encontrar en los siguientes directorios:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / System / Library / LaunchAgents; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Library / LauncAgents; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> $ Inicio / Biblioteca / Agentes de lanzamiento. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los atacantes tambi√©n pueden enmascarar los nombres de agentes de lanzamiento maliciosos utilizando los nombres de programas leg√≠timos. </font><font style="vertical-align: inherit;">Por ejemplo, el troyano Komplex crea un agente de lanzamiento: $ HOME / Library / LaunchAgents / com.apple.updates.plist. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n: con la</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> directiva de grupo, configure la restricci√≥n para los usuarios que crean agentes de lanzamiento. </font><font style="vertical-align: inherit;">La creaci√≥n de agentes de lanzamiento implica cargar o crear archivos plist en el disco, por lo tanto, concentre sus esfuerzos de defensa en las primeras etapas del ataque.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lanzar demonios (lanzar demonio)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> administrador </font><i><font style="vertical-align: inherit;">: La</font></i><font style="vertical-align: inherit;"> t√©cnica consiste en cambiar los par√°metros de los servicios de nivel de inicio del sistema: el Daemon de inicio, especificado en los archivos plist, por el atacante. </font><font style="vertical-align: inherit;">Cuando se inicia el sistema, el proceso Lanzado carga los par√°metros de servicios (daemons) de los archivos plist ubicados en los siguientes directorios:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / System / Library / LaunchDeamons; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Library / LaunchDeamons. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch Daemon se puede crear con privilegios de administrador, pero se ejecuta bajo la cuenta ra√≠z, por lo que un atacante puede escalar privilegios. </font><font style="vertical-align: inherit;">Los permisos de los archivos plist deben ser root: mientras que, sin embargo, el script o programa especificado en √©l puede tener permisos menos estrictos. </font><font style="vertical-align: inherit;">Por lo tanto, un atacante puede modificar los archivos ejecutables especificados en plist, y as√≠ modificar los servicios actuales del sistema para asegurar el sistema o escalar privilegios. </font><font style="vertical-align: inherit;">Consejos de </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguridad:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite los privilegios del usuario para que solo los administradores autorizados puedan crear Launch Daemon. </font><font style="vertical-align: inherit;">Considere monitorear c√≥mo se crean los archivos plist en su sistema utilizando aplicaciones como KnockKnock.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launchctl Utility</font></font></a> </h3> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usuario, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Launchctl: una utilidad para administrar el servicio Launchd. Con Launchctl, puede administrar los servicios del sistema y del usuario (LaunchDeamons y LaunchAgents), as√≠ como ejecutar comandos y programas. Launchctl admite subcomandos de l√≠nea de comandos que son interactivos o redirigidos desde la entrada est√°ndar: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">launchctl submit -l [labelname] - / Path / to / thing / to / execute '' arg "'' arg" '' arg ".</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Iniciar y reiniciar servicios y Demonios, los atacantes pueden ejecutar c√≥digo e incluso omitir la lista blanca si launchctl es un proceso autorizado; sin embargo, cargar, descargar y recargar servicios y demonios puede requerir privilegios elevados.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitar los derechos de los usuarios para crear Agentes de lanzamiento y lanzar Deamons de lanzamiento utilizando la Pol√≠tica de grupo. </font><font style="vertical-align: inherit;">Con la aplicaci√≥n KnockKnock, puede descubrir programas que usan launchctl para administrar Agentes de lanzamiento y Deamons de lanzamiento.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programa de trabajo local</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario, administrador, ra√≠z </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n: Los</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atacantes pueden crear tareas en los sistemas atacados para que los programas no autorizados se inicien cuando el sistema se inicia o seg√∫n un cronograma. </font><font style="vertical-align: inherit;">Los sistemas Linux y Apple admiten varios m√©todos para programar el lanzamiento de tareas peri√≥dicas en segundo plano: cron, at, launchd. </font><font style="vertical-align: inherit;">A diferencia del Programador de tareas de Windows, la programaci√≥n de tareas en sistemas Linux no se puede hacer de forma remota, excepto para usar sesiones remotas como SSH. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limitar los derechos de los usuarios para crear tareas programadas, bloquear las utilidades del sistema y otro software que se puede usar para programar tareas.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art√≠culos de inicio de sesi√≥n</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario </font><i><font style="vertical-align: inherit;">: los</font></i><font style="vertical-align: inherit;"> atacantes para protegerse en el sistema pueden configurar su c√≥digo para que se inicie autom√°ticamente utilizando elementos de inicio de sesi√≥n (configuraci√≥n del usuario para el inicio de la aplicaci√≥n en cada inicio de sesi√≥n). Los elementos de inicio de sesi√≥n creados con el Marco de administraci√≥n de servicios no se muestran en la configuraci√≥n del sistema y solo se pueden eliminar a trav√©s de la aplicaci√≥n en la que se crearon. Los usuarios solo pueden administrar los elementos de inicio de sesi√≥n que se muestran en la configuraci√≥n del sistema. La configuraci√≥n de dichos elementos de inicio de sesi√≥n se almacena en el archivo plist en el directorio del usuario: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / Library / Preferences / com.apple.loginitems.plist.</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las aplicaciones que forman parte del elemento de inicio de sesi√≥n pueden mostrar ventanas que son visibles para el usuario al inicio, pero puede ocultarlas con la opci√≥n "Ocultar". </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite los derechos de usuario para crear un elemento de inicio de sesi√≥n. </font><font style="vertical-align: inherit;">Vale la pena se√±alar que mantener presionada la tecla May√∫s durante el inicio de sesi√≥n evita que las aplicaciones se inicien autom√°ticamente. </font><font style="vertical-align: inherit;">Controle la configuraci√≥n del elemento de inicio de sesi√≥n ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraci√≥n del sistema ‚Üí Usuarios y grupos ‚Üí Elementos de inicio de sesi√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scripts de inicio de sesi√≥n</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para consolidarse en el sistema, un atacante puede usar la capacidad de crear nuevos o modificar scripts de inicio de sesi√≥n existentes, scripts que se ejecutan cada vez que un usuario o grupo de usuarios en particular inicia sesi√≥n en el sistema. Si un atacante obtuvo acceso a una secuencia de comandos de inicio de sesi√≥n en un controlador de dominio de Windows, puede modificarlo para ejecutar c√≥digo en todos los sistemas del dominio para "desplazar" la red. Dependiendo de la configuraci√≥n de los derechos de acceso a los archivos de comandos de inicio de sesi√≥n (por lo general, dichos archivos de comandos se almacenan en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\\ [DC] \ NETLOGON \</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), el atacante puede necesitar credenciales locales o administrativas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En Mac, secuencias de comandos de inicio de sesi√≥n (enlace de inicio de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sesi√≥n / cierre de sesi√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), a diferencia del elemento de inicio de sesi√≥n, que se inicia en el contexto del usuario, se puede ejecutar como root. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de seguridad:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Restricci√≥n de privilegios de administrador para crear scripts de inicio de sesi√≥n. </font><font style="vertical-align: inherit;">Identificaci√≥n y bloqueo de software potencialmente peligroso que se puede utilizar para modificar escenarios de inicio de sesi√≥n.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificar servicios existentes</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> para iniciar repetidamente c√≥digo malicioso en un sistema, un atacante puede modificar la configuraci√≥n de los servicios existentes utilizando las utilidades o herramientas del sistema para interactuar con la API de Windows. </font><font style="vertical-align: inherit;">Los atacantes pueden da√±ar o matar intencionalmente un servicio para la posterior invocaci√≥n de un programa modificado o comando de restauraci√≥n del servicio. </font><font style="vertical-align: inherit;">El uso de servicios existentes es una de las t√©cnicas de enmascaramiento que dificulta la detecci√≥n de actividad maliciosa. </font><font style="vertical-align: inherit;">La informaci√≥n sobre la configuraci√≥n de los servicios de Windows, incluida la ruta a los programas y comandos para iniciar y restaurar el servicio, se almacena en el registro:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede cambiar la configuraci√≥n de los servicios utilizando las utilidades de consola sc.exe y Reg. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limitar los privilegios de los usuarios y grupos para cambiar las configuraciones del servicio, otorgando derechos solo a los administradores autorizados. </font><font style="vertical-align: inherit;">Bloqueo de software potencialmente peligroso. </font><font style="vertical-align: inherit;">Para estudiar los cambios en los servicios del sistema con el fin de identificar los intentos de proteger a un atacante en el sistema, puede usar la utilidad Sysinternals Autoruns.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL de Netsh Helper (DLL de Netsh Helper)</font></font></a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: los</i> atacantes pueden ejecutar c√≥digo utilizando la utilidad de consola Netsh incorporada, que permite cargar archivos DLL de extensi√≥n para ampliar la funcionalidad: <br>  <i>netsh&gt; agregar ayuda [ruta DLL]</i> <br>  La informaci√≥n sobre las bibliotecas registradas utilizadas por netsh se almacena en el registro: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ NetSh</i> <br>  Algunos clientes VPN corporativos y utilidades de red pueden usar netsh.exe, inici√°ndolo en nombre del sistema; en esta situaci√≥n, el atacante puede registrar o modificar la DLL auxiliar que se ejecutar√° cuando el cliente VPN use netsh.  Las herramientas para implementar este tipo de ataque se incluyen con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CobaltStrike</a> (marco de prueba de penetraci√≥n). <br><br>  <i>Consejos de seguridad:</i> Bloquee software potencialmente peligroso utilizando herramientas como AppLocker. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Nuevos servicios</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n:</i> Nombre de acceso al sistema, los atacantes pueden crear nuevos servicios y configurarlos para que se inicien autom√°ticamente.  El nombre del servicio se puede enmascarar utilizando nombres espec√≠ficos del sistema operativo.  Los servicios se pueden crear con privilegios de administrador, pero se ejecutan en nombre del sistema.  Los servicios se pueden crear desde la l√≠nea de comandos, usando herramientas de acceso remoto con interoperabilidad con la API de Windows, o usando herramientas de administraci√≥n est√°ndar de Windows y PowerShell. <br><br>  <i>Recomendaciones de seguridad:</i> limite los derechos de usuario para crear nuevos servicios para que solo los administradores autorizados puedan hacerlo.  Aplicar AppLocker y la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pol√≠tica de restricci√≥n de software</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Inicio autom√°tico en aplicaciones de Office (inicio de aplicaciones de Office)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n:</i> algunos mecanismos de trabajo de MS Office se pueden usar para ejecutar c√≥digo cuando se ejecutan aplicaciones de oficina y, como resultado, para proporcionar a los atacantes su constancia en el sistema: <br>  ‚Ä¢ Incrustar macros maliciosas de VBA en las plantillas b√°sicas de Office.  Word usa la plantilla Normal.dotm: <br>  <i>C: \ Users \ [Nombre de usuario] \ AppData \ Roaming \ Microsoft \ Templates \ Normal.dotm</i> . <br>  No hay una plantilla predeterminada en Excel, sin embargo, puede agregarla manualmente y se cargar√° autom√°ticamente: <br>  <i>C: \ Usuarios \ [Nombre de usuario] \ AppData \ Roaming \ Microsoft \ Excel \ XLSTART \ Personal.xls</i> . <br>  La implementaci√≥n del ataque solo es posible si la opci√≥n " <i>Ejecutar todas las macros</i> " est√° habilitada en el Centro de confianza de Office: <br>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Office \ [Version] \ [Application] \ Security \ VBAWarnings: 1;</i> <br>  ‚Ä¢ Al colocar un enlace DLL en la secci√≥n de prueba de Office del registro de Windows, la DLL especificada se ejecuta cada vez que se inicia la aplicaci√≥n de Office: <br>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Office Test \ Special \ Perf \ [Predeterminado]: [Especifique la ruta a la DLL];</i> <br>  ‚Ä¢ Agregar complementos a la aplicaci√≥n de Office con c√≥digo malicioso que se ejecutar√° cuando se inicie la aplicaci√≥n atacada. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>Mejores pr√°cticas de seguridad</i></a> <i>:</i> siga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>las mejores pr√°cticas de Microsoft al configurar las opciones de seguridad de macro</i></a> .  Para evitar el funcionamiento del mecanismo de prueba de Office, cree la secci√≥n especificada en el registro y establezca permisos de solo lectura para evitar el acceso a ella sin derechos de administrador.  Si es posible, deshabilite los complementos de Office, si los necesita, luego siga las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>recomendaciones de Microsoft</i></a> al organizar su trabajo. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intercepci√≥n de ruta</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n: la</i> t√©cnica de interceptar una ruta es colocar el archivo ejecutable en un directorio desde el cual la aplicaci√≥n lo iniciar√° en lugar del archivo de destino.  Un atacante puede usar los siguientes m√©todos: <br><ul><li>  Rutas inexistentes.  Las rutas a los archivos ejecutables del servicio se almacenan en las claves de registro y pueden tener uno o m√°s espacios, por ejemplo, <i>C: \ Archivos de programa \ service.exe</i> , si el atacante crea el archivo <i>C: \ Program.exe</i> en el sistema, Windows lo iniciar√° en lugar de procesar la ruta archivo objetivo de servicio. </li><li>  Configuraci√≥n incorrecta de variables de entorno.  Si en la variable PATH la ruta <i>C: \ example</i> precede a <i>c: \ Windows \ System32</i> y <i>existe</i> el archivo <i>C: \ example \ net.exe</i> , cuando se llame al comando net, se ejecutar√° <i>C: \ example \ net.exe</i> , y no <i>c: \ Windows \ System32 \ net.exe</i> . </li><li>  Intercepci√≥n del orden de b√∫squeda (Secuestro de orden de b√∫squeda).  Cuando no se especifica la ruta completa al archivo ejecutable, Windows, por regla general, busca el archivo con el nombre especificado en el directorio actual, luego busca en los directorios del sistema.  Por ejemplo, el archivo "example.exe", cuando se ejecuta, inicia cmd.exe con argumentos para ejecutar el comando net use.  El atacante puede colocar el archivo net.exe en el directorio de ubicaci√≥n de example.exe y se iniciar√° en lugar de la <i>utilidad c: \ Windows \ System32 \ net.exe</i> .  Adem√°s, si el atacante coloca el archivo net.com en el directorio con el archivo net.exe, Windows ejecutar√° net.com de acuerdo con el orden de ejecuci√≥n definido en la variable de sistema PATHEXT. </li></ul><br>  <i>La interceptaci√≥n de orden de b√∫squeda de archivos tambi√©n se utiliza para ejecutar archivos DLL utilizando la t√©cnica de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">b√∫squeda de secuestro de</a> archivos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DLL</a> .</i> <br><br>  <i>Recomendaciones de seguridad: las</i> comillas indican las rutas especificadas en los archivos de configuraci√≥n, los scripts, la variable PATH, la configuraci√≥n del servicio y los accesos directos.  Recuerde el orden de b√∫squeda de archivos ejecutables y use solo rutas completas.  Limpie las claves de registro antiguas que quedan del software remoto para que no queden claves en el registro que apunten a archivos inexistentes.  Establezca una prohibici√≥n de escritura por parte de los usuarios del sistema en el directorio ra√≠z C: \ y los directorios del sistema de Windows, limite los permisos de escritura a los directorios con archivos ejecutables. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de archivos Plist (Modificaci√≥n Plist)</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n: los</i> atacantes pueden modificar archivos plist especificando en ellos su propio c√≥digo para su ejecuci√≥n en el contexto de otro usuario.  Los archivos de propiedades de plist ubicados en <i>/ Library / Preferences</i> se ejecutan con privilegios elevados, y los archivos de plist de <i>~ / Library / Preferences</i> se ejecutan con privilegios de usuario. <br><br>  Consejos de seguridad <i>:</i> evite que los archivos plist se modifiquen haci√©ndolos de solo lectura. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Golpe de puerto</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: los</i> atacantes pueden usar los m√©todos de detecci√≥n de puertos para ocultar los puertos abiertos que usan para conectarse al sistema. <br><br>  Consejos de <i>seguridad: el</i> uso de firewalls con estado puede evitar que se implementen algunas opciones de Knock Port. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modificaci√≥n de los monitores de puertos en el Administrador de impresi√≥n (monitores de puertos)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: un</i> atacante puede organizar la ejecuci√≥n de una DLL arbitraria en nombre del sistema cada vez que Windows se inicia utilizando el abuso de la configuraci√≥n del Administrador de impresi√≥n (Spoolsv.exe).  Para interactuar con los dispositivos de impresi√≥n, Spoolsv.exe utiliza los llamados monitores de puertos, estos son archivos DLL que utilizan comandos de bajo nivel para enviarlos a los dispositivos de impresi√≥n a trav√©s de una interfaz LAN, USB, LPT o COM.  Las DLL anteriores se almacenan en <i>C: \ windows \ system32</i> y se registran en el registro: <br>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Print \ Monitors</i> . <br>  Port Monitor se puede instalar utilizando la API AddMonitor o directamente editando la clave de registro anterior. <br><br>  <i>Recomendaciones de protecci√≥n:</i> organice el bloqueo de software potencialmente peligroso y use herramientas de control de inicio de aplicaciones. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rc.common</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Derechos:</i> root <br>  <i>Descripci√≥n: Un</i> atacante puede agregar c√≥digo al archivo <i>/etc/rc.common</i> que se ejecutar√° cada vez que el sistema se inicie como root.  Rc.common es un script que se ejecuta durante el arranque de OC y es el precursor de Launch Agents y Launh Deamons.  Esta es una tecnolog√≠a obsoleta para programas de inicio autom√°tico, pero a√∫n es compatible con macOS y OS X. <br><br>  <i>Recomendaciones de seguridad:</i> restrinja los privilegios del usuario para editar el archivo rc.common. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aplicaciones reabiertas</a> </h3><br>  <i>Sistema:</i> macOS <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n:</i> en los sistemas que comienzan con <i>OS X 10.7 (Lion)</i> , un atacante puede organizar la ejecuci√≥n de un archivo malicioso cada vez que se reinicia el sistema operativo.  La t√©cnica se basa en el abuso de la funci√≥n de reiniciar aplicaciones despu√©s de reiniciar el sistema.  Usando las herramientas integradas en la GUI, el usuario puede decirle al sistema qu√© aplicaciones deben reiniciarse en caso de reinicio del sistema operativo.  Estas configuraciones se almacenan en archivos plist: <br><ul><li>  <i>~ / Library / Preferences / com.apple.loginwindow.plist;</i> </li><li>  <i>~ / Library / Preferences / ByHost / com.apple.loginwindows. *. Plist.</i> </li></ul><br>  Un atacante puede modificar los archivos anteriores para ejecutar c√≥digo malicioso cada vez que se reinicia el sistema. <br><br>  <i>Recomendaciones de protecci√≥n: la</i> funci√≥n de reinicio de la aplicaci√≥n se puede deshabilitar con el comando de consola: <i>valores predeterminados write -g ApplePersistence -bool no</i> . <br>  Adem√°s, mantener presionada la tecla May√∫s durante el arranque evita que las aplicaciones se inicien autom√°ticamente. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Acceso redundante</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n: los</i> atacantes pueden usar simult√°neamente varias herramientas de acceso remoto con diferentes protocolos de control para diversificar los riesgos de detecci√≥n.  Por lo tanto, si se detecta y bloquea una de las herramientas de acceso remoto, pero la parte defensora no ha identificado todas las herramientas del atacante, el acceso remoto a la red atacada se conservar√°.  Los atacantes tambi√©n pueden intentar obtener acceso a cuentas v√°lidas de servicios corporativos remotos, como las VPN, para obtener acceso alternativo al sistema en caso de bloquear las herramientas b√°sicas de acceso remoto.  El uso de un shell web tambi√©n es una de las formas de acceder de forma remota a una red a trav√©s de un servidor web. <br><br>  <i>Recomendaciones de protecci√≥n:</i> Monitoree la presencia y el bloqueo del inicio de herramientas de acceso remoto conocidas en su red (AmmyAdmin, Radmin, RemotePC, VNC, etc.), use herramientas para controlar el inicio de aplicaciones y bloquear software potencialmente peligroso.  La introducci√≥n de sistemas IDS e IPS que detectan malware espec√≠fico mediante firmas reducir√° la probabilidad de un ataque exitoso, pero con el tiempo, los atacantes modificar√°n sus herramientas para cambiar la firma y, como resultado, evitar√°n los sistemas IDS e IPS. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Inicio autom√°tico con la tecla Ejecutar claves y la carpeta Inicio (Registro Ejecutar claves / Carpeta de inicio)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Usuario, Administrador <br>  <i>Descripci√≥n: Un</i> atacante puede agregar "claves de ejecuci√≥n" o un enlace a la carpeta Inicio en el registro de Windows para iniciar un archivo malicioso cuando un usuario inicia sesi√≥n en el sistema.  El programa se ejecutar√° con los derechos del usuario actual.  Los atacantes pueden enmascarar las claves de inicio en el registro para que parezcan parte de programas leg√≠timos. <br>  Las claves de ejecuci√≥n se almacenan en las siguientes claves de registro: <br><ul><li>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run;</i> </li><li>  <i>HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ RunOnce;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Run;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ RunOnce.</i> </li></ul><br><br>  <i>Recomendaciones de protecci√≥n:</i> identificaci√≥n y bloqueo de software potencialmente peligroso, monitoreo de cambios en la carpeta de inicio y las ramas de registro enumeradas anteriormente. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Secuestro de proveedores de confianza y SIP (proveedor de confianza y SIP)</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">subvirtiendo la confianza en Windows</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n: los</i> atacantes pueden modificar los componentes de la arquitectura para firmar y verificar la firma digital del c√≥digo de Windows para evitar los medios de controlar el lanzamiento de programas que permiten ejecutar solo el c√≥digo firmado.  Para crear, firmar y verificar la firma de archivos de varios formatos en Windows, <i>se utiliza el</i> denominado <i>Paquete de interfaz de sujeto (SIP)</i> , especificaciones de software que son √∫nicas para cada tipo de archivo, a trav√©s de las cuales la interacci√≥n entre las funciones API inicia la creaci√≥n, el c√°lculo y la verificaci√≥n de firmas y directamente archivos.  El <i>proveedor de confianza</i> confirma la validez de la firma: estos son componentes de software del sistema operativo que realizan diversos procedimientos relacionados con el c√°lculo y la verificaci√≥n de firmas digitales. <br>  M√©todos de ataque populares: <br><ul><li>  Modificaci√≥n de las <i>claves</i> <i>DLL</i> y <i>FuncName</i> en la secci√≥n <i>CryptSIPDllGetSignedDataMsg</i> : <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ OID \ EncodingType 0 \ CryptSIPDllGetSignedDataMsg \ [SIP_GUID]</i> . <br>  Se realiza para reemplazar la biblioteca DLL que proporciona la funci√≥n <i>CryptSIPDllGetSignedDataMSG</i> , que devuelve el certificado digital codificado del archivo firmado.  Una funci√≥n falsa siempre puede devolver un valor de firma v√°lido previamente conocido (por ejemplo, una firma de Microsoft para archivos de sistema ejecutables) cuando se utiliza un SIP modificado.  Un atacante puede intentar aplicar una firma v√°lida para todos los archivos, sin embargo, lo m√°s probable es que esto conduzca a la invalidaci√≥n de la firma, ya que el hash devuelto por la funci√≥n no coincidir√° con el hash calculado desde el archivo. </li><li>  Modificaci√≥n de las <i>claves</i> <i>DLL</i> y <i>FuncName</i> en la secci√≥n: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ OID \ EncodingType 0 \ CryptSIPDllVerifyIndirectData / [SIP_GUID]</i> . <br>  Se realiza para reemplazar la biblioteca DLL que proporciona la funci√≥n <i>CryptSIPDllVerifyIndirectData</i> , que <i>verifica el</i> hash calculado a partir del archivo con el hash especificado en la firma digital y devuelve el resultado de la verificaci√≥n (True / False).  Por lo tanto, un atacante puede garantizar la verificaci√≥n exitosa de cualquier archivo utilizando SIP modificado.  Los valores clave anteriores pueden redirigir a una funci√≥n adecuada desde una biblioteca existente, eliminando as√≠ la necesidad de crear un nuevo archivo DLL en el disco. </li><li>  Modificaci√≥n de las <i>claves</i> <i>DLL</i> y <i>FuncName</i> en la secci√≥n: <br>  <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Cryptography \ Providers \ Trust \ FinalPolicy / [Trust Provider GUID]</i> . <br>  El prop√≥sito de esto es reemplazar la biblioteca DLL que proporciona la funci√≥n FinalPolicy para un proveedor de confianza espec√≠fico, que decodifica, analiza la firma y toma una decisi√≥n sobre la confianza.  Similar a CryptSIPDllVerifyIndirectData, el valor de las claves anteriores puede redirigir a una DLL existente. </li></ul><br>  <i>Es importante tener en cuenta que el ataque descrito en el mecanismo de confianza de Windows se puede implementar utilizando la t√©cnica de secuestro de √≥rdenes de b√∫squeda de DLL.</i> <br><br>  <i>Recomendaciones de protecci√≥n:</i> aseg√∫rese de que los usuarios del sistema protegido no puedan modificar las claves de registro relacionadas con los componentes SIP y Trust Provider.  Considere eliminar SIP innecesarios y obsoletos.  Use todo tipo de medios para bloquear la descarga de archivos DLL maliciosos, por ejemplo, aquellos integrados en Windows AppLocker y DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tarea programada</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario, administrador, sistema <br>  <i>Descripci√≥n: Las</i> utilidades como at, schtasks y Windows Task Scheduler se pueden usar para programar programas y scripts para que se ejecuten en una fecha y hora espec√≠ficas.  Se puede programar una tarea en un sistema remoto, siempre que se use RPC para la autenticaci√≥n y la impresora y el uso compartido de archivos est√© habilitado.  La programaci√≥n de tareas en un sistema remoto requiere privilegios de administrador.  Un atacante podr√≠a usar la ejecuci√≥n remota de c√≥digo para obtener privilegios del sistema o iniciar un proceso con una cuenta espec√≠fica. <br><br>  <i>Recomendaciones de protecci√≥n:</i> limite los privilegios del usuario.  El uso de herramientas, como el m√≥dulo PowerUP en PowerSploit, que se pueden utilizar para encontrar debilidades en la resoluci√≥n de tareas programadas.  Deshabilitar la capacidad de iniciar tareas en nombre del sistema, deshabilitar la opci√≥n " <i>Permitir a los operadores del servidor programar tareas</i> " en la pol√≠tica de seguridad y habilitar la configuraci√≥n " <i>Asignaci√≥n de derechos de usuario: aumentar la prioridad de programaci√≥n</i> ". <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protector de pantalla (protector de pantalla)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> usuario <br>  <i>Descripci√≥n: los</i> atacantes pueden usar la configuraci√≥n del protector de pantalla para lanzar malware despu√©s de un cierto per√≠odo de inactividad del usuario. <br>  La aplicaci√≥n Windows Screensaver (scrnsave.exe) se encuentra en <i>C: \ Windows \ System32</i> , junto con otros protectores de pantalla incluidos en el ensamblaje del sistema operativo base.  Un atacante puede manipular los par√°metros de la pantalla de presentaci√≥n en la <i>clave de</i> registro <i>HKEY_CURRENT_USER \ Control Panel \ Desktop</i> : <br><ul><li>  SCRNSAVE.EXE: especifique la ruta al archivo ejecutable malicioso; </li><li>  ScreenSaveActivr: establezca el valor en "1" para activar el protector de pantalla; </li><li>  ScreenSaverISSecure: establezca el valor en "0" para que el sistema no requiera una contrase√±a para desbloquear el escritorio de Windows despu√©s de desactivar el protector de pantalla; </li><li>  ScreenSaverTimeout: establece el per√≠odo de inactividad antes de iniciar el protector de pantalla. </li></ul><br><br>  <i>Recomendaciones de protecci√≥n:</i> bloquee la capacidad de ejecutar archivos * .scr desde ubicaciones no est√°ndar.  Administre la configuraci√≥n de su protector de pantalla utilizando la Pol√≠tica de grupo, que proh√≠be los cambios locales en la configuraci√≥n de su protector de pantalla. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Proveedor de soporte de seguridad (SPP)</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> administrador <br>  <i>Descripci√≥n: los</i> atacantes pueden configurar el c√≥digo malicioso para que se ejecute cada vez que se inicia el sistema o se llama a la funci√≥n AddSecurityPackage API agregando un proveedor de soporte de seguridad (SSP) falso a la configuraci√≥n de la Autoridad de seguridad local (LSA).  SSP: m√≥dulos de programa (DLL) que contienen uno o m√°s esquemas de autenticaci√≥n y criptograf√≠a que se cargan en el proceso LSASS al inicio del sistema.  Las DLL de SPP tienen acceso a contrase√±as cifradas y de texto sin formato almacenadas en Windows.  La configuraci√≥n de SPP se almacena en dos claves de registro: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ Paquetes de seguridad</i> ; </li><li>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ OSConfig \ Security Packages</i> . </li></ul><br>  <i>Recomendaciones de protecci√≥n:</i> en Windows 8.1, Windows Server R2 y versiones posteriores del sistema operativo, debe activar el modo protegido LSA (Process Protect Light - PPL), en el que todos los archivos DLL SPP deben estar firmados digitalmente por Microsoft: <br>  <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Lsa \ RunAsPPL = dword: 00000001</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Debilidades en el registro de servicio Permisos Debilidad</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Derechos:</i> Administrador, Sistema <br>  <i>Descripci√≥n:</i> si los permisos de usuarios y grupos permiten cambiar los valores de las claves en el registro de Windows donde se almacenan los par√°metros del servicio, los atacantes pueden modificar directamente las claves que almacenan las rutas a los archivos ejecutables para iniciar los servicios o utilizar varias herramientas de administraci√≥n de servicios: sc.exe, PowerShell o Reg.  Los atacantes tambi√©n pueden cambiar los par√°metros relacionados con la falla del servicio, por ejemplo, FailureCommand, que indica un comando que se ejecutar√° en caso de una falla del servicio o da√±o intencional.  Los par√°metros de servicio se almacenan en <i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services</i> . <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aseg√∫rese de que los usuarios del sistema protegido no puedan cambiar las claves del registro que almacenan los par√°metros de los componentes del sistema. </font><font style="vertical-align: inherit;">Utilice todos los medios posibles para bloquear software potencialmente peligroso, por ejemplo, Windows AppLocker.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modificaci√≥n de acceso directo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Usuario, Administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n: Los</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atacantes pueden crear nuevos accesos directos y enlaces simb√≥licos disfrazados de programas leg√≠timos o modificar las rutas en los accesos directos existentes para que sus herramientas se ejecuten en lugar de la aplicaci√≥n original. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de seguridad:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limite los derechos de los usuarios y grupos, como Administradores, para crear enlaces simb√≥licos utilizando el GPO: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraci√≥n del equipo&gt; [Pol√≠ticas]&gt; Configuraci√≥n de Windows&gt; Configuraci√≥n de seguridad&gt; Pol√≠ticas locales&gt; Asignaci√≥n de derechos de usuario: Crear enlaces simb√≥licos. </font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Use herramientas para bloquear software potencialmente peligroso y la Pol√≠tica de restricci√≥n de software.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Art√≠culos de inicio</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font><i><font style="vertical-align: inherit;">: </font></i></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> administrador </font><i><font style="vertical-align: inherit;">: Un</font></i><font style="vertical-align: inherit;"> atacante puede usar el mecanismo obsoleto, pero a√∫n trabajando en macOS Sierra, mecanismo de inicio autom√°tico para aplicaciones que usan StartupItems para configurar el lanzamiento de su c√≥digo con privilegios de root en el momento del arranque. </font><font style="vertical-align: inherit;">StartupItems es un directorio en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un script de comando y un archivo de propiedades StartupParameters.plist. </font><font style="vertical-align: inherit;">El script y el archivo de propiedades deben estar en la parte superior de la jerarqu√≠a: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems / [MyStartupItem]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dado que el mecanismo StartupItems es obsoleto, la prohibici√≥n de escribir en el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directorio / Library / Startupitems /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le permitir√° evitar la creaci√≥n de elementos de inicio.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware del sistema</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">: los</font></i><font style="vertical-align: inherit;"> atacantes especialmente sofisticados pueden modificar o actualizar Bios, UIFI o UFI, a fin de proporcionar la capacidad de instalar actualizaciones de firmware maliciosas y repararlas en el sistema. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dirija el vector de protecci√≥n para evitar que el atacante acceda a cuentas privilegiadas que son necesarias para implementar la t√©cnica descrita. </font><font style="vertical-align: inherit;">Considere la necesidad y aplicabilidad del </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trusted Platform Module (TPM)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el sistema protegido </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Considere la necesidad de usar herramientas externas para monitorear y analizar la seguridad del firmware del sistema, por ejemplo, el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marco CHIPSEC</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proveedores de tiempo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">: Los</font></i><font style="vertical-align: inherit;"> atacantes pueden registrar como proveedor de tiempo (Proveedor de tiempo) una DLL maliciosa que se ejecutar√° cuando el sistema se inicie o cambie la configuraci√≥n de Windows Time Server (W32Time). Los par√°metros de los proveedores de tiempo se almacenan en el registro: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services \ W32Time \ TimeProviders</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para registrar un proveedor de tiempo, necesitar√° derechos de administrador, pero se ejecutar√° en el contexto de la cuenta de servicio local. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considere usar un GPO para configurar cambios de bloqueo en la configuraci√≥n de W32Time. </font><font style="vertical-align: inherit;">Use todo tipo de medios para bloquear la descarga de archivos DLL maliciosos, por ejemplo, aquellos integrados en Windows AppLocker y DeviceGuard.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equipo trampa</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usuario, administrador </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El comando trap protege el script de interrupciones ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ctrl + c, ctrl + d, ctrl + z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc.). Si el script recibe una se√±al de interrupci√≥n especificada en los argumentos del comando trap, procesa la se√±al de interrupci√≥n por s√≠ sola, mientras que el shell no procesar√° dicha se√±al. Los atacantes pueden usar trap para registrar el c√≥digo que se ejecutar√° cuando el shell reciba ciertas se√±ales de interrupci√≥n. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El uso de esta t√©cnica es dif√≠cil de prevenir, porque el atacante utiliza los mecanismos est√°ndar del sistema operativo. </font><font style="vertical-align: inherit;">El vector de protecci√≥n debe estar dirigido a prevenir acciones maliciosas en las primeras etapas del ataque, por ejemplo, en la etapa de entrega o creaci√≥n de un archivo malicioso en el sistema.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuentas Validas</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n: los</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atacantes pueden robar las credenciales de una cuenta de usuario o servicio espec√≠fica mediante credenciales de acceso, capturar credenciales en el proceso de inteligencia mediante ingenier√≠a social. Las credenciales comprometidas se pueden usar para omitir los sistemas de control de acceso y obtener acceso a sistemas remotos y servicios externos, como VPN, OWA, Escritorio remoto, o para obtener privilegios elevados en sistemas y √°reas espec√≠ficos de la red. Si el escenario es exitoso, los atacantes pueden rechazar el malware para que sea dif√≠cil de detectar. Adem√°s, los atacantes pueden crear cuentas con nombres y contrase√±as predefinidos para mantener el acceso de respaldo en caso de intentos fallidos de utilizar otros medios.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aplique una pol√≠tica de contrase√±a, siga las recomendaciones para dise√±ar y administrar una red corporativa para limitar el uso de cuentas privilegiadas en todos los niveles administrativos. </font><font style="vertical-align: inherit;">Controles regulares de las cuentas de dominio y locales y sus derechos para identificar aquellos que podr√≠an permitir a un atacante obtener un amplio acceso. </font><font style="vertical-align: inherit;">Monitoreo de la actividad de la cuenta utilizando sistemas SIEM.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Shell web</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un atacante puede utilizar Web Shell como puerta de acceso para acceder a su red o acceso redundante al sistema atacado, como un mecanismo de respaldo para proteger en caso de detecci√≥n y bloqueo de los principales canales de acceso al entorno atacado. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aseg√∫rese de que sus servidores web externos se actualicen regularmente y de que no haya vulnerabilidades conocidas que permitan a los atacantes cargar un archivo o script al servidor con posterior ejecuci√≥n. </font><font style="vertical-align: inherit;">Verifique que los permisos de las cuentas y grupos con derechos de administraci√≥n del servidor no coincidan con las cuentas en la red interna que se pueden usar para iniciar sesi√≥n en el servidor web, iniciar el shell web o anclar al servidor web. </font><font style="vertical-align: inherit;">Web Shell es dif√≠cil de detectar porque </font><font style="vertical-align: inherit;">no inician conexiones y su lado del servidor puede ser peque√±o e inofensivo, por ejemplo, la versi√≥n PHP del shell de China Chopper Web parece una l√≠nea: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[? php </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eval</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ($ _POST ['contrase√±a']);]</font></font></i> <br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suscripci√≥n de eventos de instrumentaci√≥n de administraci√≥n de Windows</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sistema </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> WMI Event Subscription es una funcionalidad que le permite al administrador configurar la recepci√≥n de notificaciones de eventos, incluidas las que ocurrieron en sistemas remotos, seguido de la ejecuci√≥n autom√°tica de cualquier acci√≥n (ejecutar un script, aplicaci√≥n etc.) Los atacantes, para poder establecerse en el sistema, pueden abusar de la funcionalidad descrita anteriormente al configurar una suscripci√≥n para eventos como el reloj del sistema o el tiempo de funcionamiento de la computadora, seguido de la ejecuci√≥n del c√≥digo cuando ocurra este evento. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aseg√∫rese de que solo las cuentas de administrador tengan derechos para conectarse de forma remota a WMI, y que en el sistema protegido no haya coincidencia de las cuentas de administrador del sistema con otras cuentas privilegiadas. </font><font style="vertical-align: inherit;">Deshabilitar WMI puede causar inestabilidad del sistema, por lo tanto, requiere una evaluaci√≥n preliminar de las posibles consecuencias negativas.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon Helper DLL</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Derechos de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrador, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descripci√≥n del </font><font style="vertical-align: inherit;">sistema </font><font style="vertical-align: inherit;">: al modificar en el registro los par√°metros de las DLL auxiliares utilizadas por Winlogon.exe, un atacante puede proporcionar m√∫ltiples ejecuciones de DLL maliciosas para su reparaci√≥n en el sistema. </font><font style="vertical-align: inherit;">Los par√°metros de Winlogon se almacenan en secciones:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_CURRENT_USER \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Winlogon</font></font></i> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Winlogon</font></font></i> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se conocen varias subsecciones vulnerables: </font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon \ Notify</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : especifica archivos DLL que manejan eventos de Windows</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon \ Userinit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : apunta al archivo userinit.exe, el programa de inicializaci√≥n del usuario que se ejecuta cuando el usuario inicia sesi√≥n en el sistema;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Winlogon \ Shell</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : apunta al archivo explorer.exe, el shell del sistema que se ejecuta cuando un usuario inicia sesi√≥n en el sistema.</font></font></li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recomendaciones de protecci√≥n:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aseg√∫rese de que solo los administradores autorizados puedan cambiar la configuraci√≥n de Winlogon. </font><font style="vertical-align: inherit;">Utilice todo tipo de medios para bloquear la descarga de archivos DLL maliciosos y programas potencialmente peligrosos, por ejemplo, aquellos integrados en Windows AppLocker y DeviceGuard.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425177/">https://habr.com/ru/post/es425177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425167/index.html">Dialectos del ingl√©s: c√≥mo entender al interlocutor sin romperse el cerebro</a></li>
<li><a href="../es425169/index.html">¬°Un momento! Conoce a Normcore Marketing</a></li>
<li><a href="../es425171/index.html">Tecnolog√≠a s√≥lida: es hora de reconstruir la web</a></li>
<li><a href="../es425173/index.html">Amnist√≠a completa Putin ha presentado un proyecto de ley para despenalizar parcialmente el art√≠culo 282 sobre extremismo en Internet</a></li>
<li><a href="../es425175/index.html">Un poco sobre las tarjetas de sonido con sintetizadores FM OPL2 / 3 para PC ...</a></li>
<li><a href="../es425179/index.html">Las estrellas de YouTube comienzan a agotarse en el trabajo: "el atractivo de los trabajos m√°s interesantes se ha desvanecido"</a></li>
<li><a href="../es425181/index.html">Frankie Zapata para The Verge: "El combustible turborreactor ayudar√° a derretir el escepticismo del hormig√≥n armado"</a></li>
<li><a href="../es425187/index.html">Intel PAC con FPGA Stratix 10 SX: acelerador para tareas grandes</a></li>
<li><a href="../es425191/index.html">Fastware</a></li>
<li><a href="../es425195/index.html">Las listas negras, blancas y grises protegen la seguridad empresarial</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>