<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🤝‍👨🏽 🏅 🍔 如何与JS中的微控制器对话 👰 👨🏾‍🔬 👦🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="为什么需要微控制器？ 例如，在家中设置一个啤酒厂。 如果您的啤酒厂不够用，那么您可以做更大的事情：建立一个探访室，安排一个演示文稿，一个用滴画图画的交互式喷泉或一家大型公司的展位。 您可以使用微控制器执行任何操作-这完全取决于您的想象力。 

 有一个误解，要创建自己的压盖，您需要了解汇编程序C /...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何与JS中的微控制器对话</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/450826/"> 为什么需要微控制器？ 例如，在家中设置一个啤酒厂。 如果您的啤酒厂不够用，那么您可以做更大的事情：建立一个探访室，安排一个演示文稿，一个用滴画图画的交互式喷泉或一家大型公司的展位。 您可以使用微控制器执行任何操作-这完全取决于您的想象力。 <br><br> 有一个误解，要创建自己的压盖，您需要了解汇编程序C / C ++，能够管理内存并深刻理解电。 它曾经是，但是技术正在发展，现在要完全实施其项目，仅JS就足够了！ <br><br><img src="https://habrastorage.org/webt/cc/wc/ou/ccwcoucl5o2c-9xayxy04jc8fsq.jpeg"><br><br> 好的，我们知道JavaScript，但是如何将其连接到硬件？ 那里有什么铁，它能做什么？ 如何配置整个系统？ 在对报告进行解码时， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FrontendConf的</a> Victor Nakoryakova <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">将</a>学习：仅使用JS来控制伺服器，如何将系统与PC物理组合，以及有关JS应用程序的通讯选项。 我们将讨论serialport和Firmata软件包，带有C ++自写固件的serialport，Espruino，以及直接在JS，Raspberry Pi，本地网络上的HTTP和通过云的HTTP和MQTT上对控制器进行编程的方法。 <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yqeTaf44vNk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <strong>Victor Nakoryakov</strong> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">nailxx</a> ）-技术总监，Amperka的共同创始人。 他喜欢先进的开发技术，功能编程和物理计算。  Amperka生产和销售电子模块，因此非专业人士可以用自己的双手，培训工具包和可以添加到其设备中的单个构造块来创建智能设备-电动机，GPS，SMS。 <br><br><h2> 在哪里写JavaScript </h2><br>  <strong>Espruino具有带JavaScript的独立微控制器。</strong>  Espruino平台允许您直接将JS写入微控制器。 这本身就是一个自治的事物：连接到计算机，闪烁，然后独立工作。 <br><br>  <strong>Raspberry Pi</strong>是带有GPIO的小型计算机。 <br><br>  <strong>在Web应用程序中</strong> ，到前端或后端。 <br><br> 我将以青蛙为例来说明系统的操作。 从手机<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">转到toad.amperka.ru-</a>将出现一个简单的Web界面。 <br><br><img src="https://habrastorage.org/webt/pd/ya/be/pdyabe5bjmklkee0jjco7nontue.jpeg"><br><br> 左列控制左眼，右-右。 原理很简单-我按下按钮，伺服电机转眼。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oc/z5/re/ocz5rert1d774i6ic7dzkaahjpa.gif" width="350"></div><br><br> 报告期间<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">视频</a>展示的立场与青蛙。 <br><br><h2> 青蛙如何工作 </h2><br> 当您打开toad.amperka.ru时，您将获得一个包含使用<a href="">MQTT.js</a>库的静态JS的静态网页。 该库与云中的MQTT代理联系。 <br><br><img src="https://habrastorage.org/webt/5r/7h/it/5r7hit4db5ds9369m2fgmsua8t4.jpeg"><br><br> 如果您知道Redis，发布/订阅，RabbitMQ或其他消息队列，那么您会立即了解它的含义。  <strong>MQTT是机器对机器的消息代理</strong> 。 轻巧简单，因此即使是薄弱的腺体也可以使用它。 <br><br>  MQTT需要服务器上的代理。 但是您甚至不必提起它-租用它。 每月只需​​花几美元，您就可以拥有自己的MQTT经纪人。 无需后端。 <br><br> 另一方面，MQTT代理有一个控制器。 有许多不同的设备都具有此角色，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Wi-Fi Slot</a> 。 这是一个可以连接到Internet的控制器。 <br><br><img src="https://habrastorage.org/webt/th/dz/jc/thdzjcdluwlertps_bl5lbkdjui.jpeg"><br><br> 它基于流行的ESP8266芯片工作。 增加了通过微型USB供电的能力，并通过三触点连接外围设备以连接到其他设备。 <br><br><h2> 如何用JS编程硬件 </h2><br> 没什么特别的，JS常规-几乎是完整的ES6。 用于在低水平上处理电信号的某些功能和对象已添加到标准库中。 例如，用于简单的数字读写的功能。 <br><br>  <strong>digitalRead-数字读数</strong> 。 对于控制器，这是一个问题：“ 4号插针上有3伏电压吗？” 如果有电压，它将返回TRUE；否则，将返回FALSE。 这实现了简单的二进制传感器的读取：按钮，开关，簧片锁和红外运动传感器。 <br><br>  <strong>digitalWrite是一个简单的数字记录</strong> 。 我们说digitalWrite TRUE-3V与引脚相连。 我们说的是digitalWrite FALSE-0V。 使用这个简单的原理，您可以点亮/熄灭LED灯带或发射核导弹。 我们向中继传递一个微弱的信号，它将大负载换向，然后火箭飞了起来。 <br><br> 还有一些用于处理介于0至3V之间的中间值的函数： <br><br><ul><li>  AnalogRead; </li><li>  AnalogWrite; </li><li>  setWatch; </li><li>  digitalPulse。 </li></ul><br> 命令允许您询问各种扭曲并提供模糊记录功能。 <br><br> 接下来是与微控制器世界公认的接口配合使用的对象。 如果在网络上我们理解并熟悉HTTP，WebSocket，TCP，那么对于微控制器，这是： <br><br><ul><li> 串口-串口; </li><li>  I2C总线 </li><li>  SPI总线 </li><li>  OneWire总线。 </li></ul><br><h2> 如何踢伺服电机 </h2><br> 例如，我将告诉您如何控制皮下注射的电机。 电机协议很简单。 将0V施加到控制引脚-下限。 每隔20μs必须踢一次，以提供稳定的3V单位，过一会儿-重置为0。 <br><br><img src="https://habrastorage.org/webt/io/1t/aj/io1tajdpojik7cxsab0mrddw0bi.jpeg"><br><br> 然后，一切再次重复。 根据单元的长度，我们得到不同的转速。 脉冲长度为1,500μs时，电机静止不动。 当朝一个方向或另一个方向偏离时，它会顺时针或逆时针旋转。 偏差的大小会影响旋转速度。 <br><br><h2> 如何编程 </h2><br> 在同名的Espruino IDE中完成对Espruino平台的编程。 微控制器板通过微型USB电缆连接到计算机。 唯一的事情是您必须安装驱动程序，这需要1.5分钟。 该驱动程序是为MAC和Windows安装的，在Linux上，一切都可以直接使用。 <br><br> 这是一个只需单击一下即可加载到环境中的程序示例。 它每秒闪烁一次LED： <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> on = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ on = !on; LED1.write(on); },<span class="hljs-number"><span class="hljs-number">500</span></span>);</code> </pre> <br> 在环境的左侧是REPL解释器。 输入“ 1 + 1”。 程序给出答案“ 2”。 奇迹！ <br><br> 奇迹是，当您按下按钮时，数字“ 1”，“ +”号和下一个单元将通过电缆连接到控制器。 当您按ENTER键时，表达式在微控制器而不是计算机内部执行。 微控制器得到结果“ 2”，并通过电缆将其返回给计算机。 显示屏上显示“ 2”。 <br><br><blockquote>  JavaScript在硬件内部执行。 </blockquote><br> 除了演算娱乐外，您还可以旋转电动机。 您将需要AnalogWrite函数，该函数发送一个方波。 我们说什么叫波。 例如，在我的主板上，它被签名为A7。 然后我们指出持续时间-例如，在20 000μs中的1300μs，我们将服务一个。 还需要一个选项来设置此突跳的频率-每秒50次，即20,000μs。 <br><br><pre> <code class="javascript hljs">&gt;analogWrite(A7, <span class="hljs-number"><span class="hljs-number">1300</span></span> / <span class="hljs-number"><span class="hljs-number">2000</span></span>, {<span class="hljs-attr"><span class="hljs-attr">freq</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>}} =<span class="hljs-literal"><span class="hljs-literal">undefined</span></span> &gt;</code> </pre> <br> 我们将经过1500-我们将强制以更大的速度向另一个方向旋转。 <br><br><pre> <code class="javascript hljs">&gt;analogWrite(A7, <span class="hljs-number"><span class="hljs-number">2300</span></span> / <span class="hljs-number"><span class="hljs-number">2000</span></span>, {<span class="hljs-attr"><span class="hljs-attr">freq</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>}} =<span class="hljs-literal"><span class="hljs-literal">undefined</span></span> &gt;</code> </pre> <br> 或说停下来。 <br><br><pre> <code class="javascript hljs">&gt;digitalWrite(A7, <span class="hljs-number"><span class="hljs-number">0</span></span>) =<span class="hljs-literal"><span class="hljs-literal">undefined</span></span> &gt;</code> </pre> <br> 使用相同的功能，您可以编写一个完整的程序，该程序可以根据外部因素（按按钮，传感器读数）进行所需的操作。 <br><br><h3> 图书馆 </h3><br> 回忆协议实现的细节并不总是很方便。 因此，对于各种铁，已经创建了许多图书馆，从小型到大型。 它们包含所有技术功能。 这些库使用清晰的方法：从nfc标签读取数据，读取以ppm为单位的二氧化碳浓度，或向Telegram发送消息。 <br><ul><li> 伺服写; </li><li>  barometer.init; </li><li> 晴雨表 </li><li> 晴雨表温度 </li><li>  nfc.listen; </li><li>  nfc.on（'tag'，...）; </li><li>  nfc.readPage; </li><li>  nfc.writePage; </li><li>  relay.turnOn; </li><li>  relay.turnOff; </li><li> 气体校准 </li><li>  gas.read（'CO2'）; </li><li>  telegram.sendMessage。 </li></ul><br> 理解低级命令很有用，但是不必创建就可以开始创建。 <br><br><h2> 客户代码 </h2><br> 因此，当我们在青蛙中单击左列或右列的按钮之一时，我们要在相应的伺服上设置的值将发送到主题蟾蜍/眼睛/左或右。 <br><br><img src="https://habrastorage.org/webt/y1/3e/mt/y13emt_fcb-qdw2j_tihccn8ukm.jpeg"><br><br><pre> <code class="javascript hljs">&lt;button <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"toad__eye__control"</span></span> data-queue=<span class="hljs-string"><span class="hljs-string">"left"</span></span> data-payload=<span class="hljs-string"><span class="hljs-string">"1300"</span></span>&gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/button&gt;</span></span></code> </pre> <br>  1300是脉冲持续时间。 左边的和1300是哪里来的？ 我只是将它们作为数据属性添加到HTML中。 <br><br> 在JS中，我们编写了简单的代码。 <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mqtt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mqtt'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> client = mqtt.connect(<span class="hljs-string"><span class="hljs-string">`ws://</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${location.hostname}</span></span></span><span class="hljs-string">:9001`</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onEyeControlClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { queue, payload } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dataset; client.publish(<span class="hljs-string"><span class="hljs-string">`toad/eye/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${queue}</span></span></span><span class="hljs-string">`</span></span>, payload); } <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">".toad__eye__control"</span></span>) .forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> e.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, onEyeControlClick));</code> </pre> <br> 让我们分部分分析代码。 首先，我们连接到代理，该代理默认情况下在端口9001上工作： <code>const client = mqtt.connect(`ws://${location.hostname}:9001`);</code>  。 <br><br> 当单击任何按钮时，我们会发布一条带有有效负载的新消息，该消息是从数据属性中获得的： <code>client.publish(`toad/eye/${queue}`, payload);</code>  。 <br><br> 接下来，我们发布有关主题，该主题也是在数据属性的基础上形成的。 这是浏览器中所有的JS代码。 <br><br><h2> 董事会代码 </h2><br>  Wi-fi插槽启动时，它会订阅感兴趣的主题并接收数据。 当它们到达时，插槽会做出反应并使电动机工作。 <br><br><img src="https://habrastorage.org/webt/5r/7h/it/5r7hit4db5ds9369m2fgmsua8t4.jpeg"><br><br> 板上的代码通常分为几部分。 首先，我们正在连接库。 特别是，这只是<strong>运行Servo</strong>的<strong>库，</strong>以免调用细节。 它们在安培范围内。 <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ssid = <span class="hljs-string"><span class="hljs-string">"Droidxx"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> password = <span class="hljs-string"><span class="hljs-string">"****"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> brokerHostname = <span class="hljs-string"><span class="hljs-string">"toad.amperka.ru"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> leftEye = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"@amperka/servo"</span></span>).connect(A5); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rightEye = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"@amperka/servo"</span></span>).connect(A7).</code> </pre> <br> 每个人都可以创建和发布自己的库。 我们已经为自己的模块和其他流行模块制作了几十个模块。 所有开放源代码- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">快来使用吧</a> 。 <br><br> 然后，我们需要<strong>用于与Wi-Fi和MQTT代理一起使用的库</strong> 。 <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> wifi = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"Wifi"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mqtt = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"tinyMQTT"</span></span>).create(brokerHostname);</code> </pre> <br> 没有操作系统，因此即使连接到Wi-Fi也是手动操作。 连接护理是您的事，但并不难。 要连接到网络，我们只需调用“ connect”方法，如果成功或失败，将调用“ callback”并报告操作结果。 <br><br><pre> <code class="javascript hljs">wifi.connect(ssid, { <span class="hljs-attr"><span class="hljs-attr">password</span></span>: password }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Error connecting:"</span></span>, e); wifi.disconnect(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Wi-Fi OK, connecting to broker ..."</span></span>); mqtt.connect(); } });</code> </pre> <br> 如果一切正常，请连接到MQTT代理。 <br><br> 连接成功后，我们将订阅有趣的主题，即，所有以蟾蜍/眼睛开头的主题。 <br><br><pre> <code class="javascript hljs">mqtt.on(<span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ mqtt.subscribe(<span class="hljs-string"><span class="hljs-string">"toad/eye/*"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Connected to broker"</span></span>, brokerHostname); });</code> </pre> <br> 收到消息后，我们便知道消息的来源。 这与简单的URL解析非常相似。 根据主题，我们决定影响哪只眼睛。 如果您有意识，那么用这种眼光我们可以写出“有效载荷”中以微秒为单位的内容。 <br><br><pre> <code class="javascript hljs">mqtt.on(<span class="hljs-string"><span class="hljs-string">"message"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">msg</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> eye = (msg.topic === <span class="hljs-string"><span class="hljs-string">"toad/eye/left"</span></span>) ? leftEye : (msg.topic === <span class="hljs-string"><span class="hljs-string">"toad/eye/right"</span></span>) ? rightEye : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eye) { eye.write(<span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>(msg.message), <span class="hljs-string"><span class="hljs-string">"us"</span></span>); } });</code> </pre> <br> 那就是青蛙的全部魔力。 <br><br><h2>  Espruino JS的局限性 </h2><br> 我们浏览了Espruino平台。 扭青蛙不是她唯一的选择。 但是该平台有其自己的暗区，这使我们考虑了其他选择。 <br><br>  <strong>“总计” 1-4 Mb RAM</strong> 。  RAM有限制。 同时在代码和数据上只给出了几兆字节。 似乎在一个以演出来衡量RAM的时代，这还不够。 但是对于一组小型设备而言，这就足够了。 在2 Mb时，您可以做华丽的事情-足以容纳喷泉。 <br><br>  <strong>使用NPM并不是那么简单</strong> 。 此问题适用于Espruino IDE。 如果我们写“ require”，Espruino会放在一个地方，而在另一个地方，如果没有，它将对NPM产生后退。 此时，它可能会变慢。  Espruino并不总是能够处理复杂的程序包。 从这个意义上讲，它的功能比同一个Webpack或Parcel的功能低得多。 这很痛苦，但是如果您自己配置工具链，并且了解熨斗内部发生的情况，那么就没有问题。 <br><br>  <strong>铁的分类。</strong> 并非称为开发平台的所有硬件都会吸引Espruino。 按照微控制器世界的标准，Espruino非常脆弱-它需要500 Kb的RAM。 这样的记忆不会有任何铁。 规范的Arduino Uno或Arduino Nano只有2 Kb的RAM-因此，在那里是不可能的。 我们可以在Espruino的官方硬件上使用Espruino进行硬件工作。 <br><br><img src="https://habrastorage.org/webt/gb/fx/9-/gbfx9-t4nskmti1hepnxlkz-lx0.png"><br><br>  Espruino是一家一人的公司，经常在Kickstarter上推出新产品，并且总是成功收集。 如果您想支持该平台-正式购买。 <br><br> 还有第三种选择-使用功能强大但第三方的开发板。 例如，公司ST产生“ Nuclear”和“ Discovery”。 标有STM32的铁可能会拉动Espruino。 <br><br> 让我们来看两个替代选项。 首先是Raspberry Pi。 <br><br><h2> 树莓派 </h2><br><blockquote> 这是一台成熟的名片大小的Linux计算机。 </blockquote><br><br><img src="https://habrastorage.org/webt/y_/af/ws/y_afwsgmlr9e7fvkesyrwlvobak.jpeg"><br><br> 此外，还有输入/输出引脚。 如果您可以使用Raspberry Pi，请使用以下设备拓扑。 <br><br><img src="https://habrastorage.org/webt/if/1a/jf/if1ajfsmxsvwwcap7ac_cpu8i2k.jpeg"><br><br> 这里的云是可选的-移动设备可以通过主机名，API或自动检测网络上设备的系统直接连接到设备。 我家里有智能电视和备用硬盘。 仅因为它们位于同一LAN上，即可从所有其他设备访问它们。 <br><br> 原理是一样的。 将设备放在网络上的Raspberry Pi上并构建客户端，以使其绕过中介直接通过HTTP或WebSocket连接到它。 云将Raspberry Pi上的应用程序用于其目的：它记录传感器或广播天气预报。 <br><br> 具有完整后端的下一个可能的拓扑。 <br><br><img src="https://habrastorage.org/webt/if/1a/jf/if1ajfsmxsvwwcap7ac_cpu8i2k.jpeg"><br><br> 服务器在云中崛起。 他的客户端与通过HTTP或WebSocket保持连接的移动应用程序相同。 另一方面，已经使用HTTP或相同的MQTT通过Raspberry Pi保持了连接。 <br><br> 用这种方法的好处是可以完全控制：验证，授权，拒绝客户。 同时，在莫斯科，一种全球性的设备已成为一种设备，符拉迪沃斯托克（Vladivostok）可以与它进行通信。 <br><br><h3>  Raspberry Pi的局限性 </h3><br>  <strong>加载时间长。</strong>  Raspberry Pi是一台完整的计算机，需要花费一些时间才能启动。  SD卡用作硬盘驱动器。 即使最快的卡，仍然会丢失常规的HDD，更不用说SSD。 随着时间的推移，负载接近一分钟。 <br><br>  <strong>下一个缺点是能耗</strong> 。 在能源效率方面，谈论Raspberry Pi作为移动设备。 电池不会持续很长时间-账单会一直计时。 为了使该设备工作六个月或一年，需要一个合格的微控制器程序和一组电池。 <br><br>  <strong>不良的GPIO是通用输入/输出</strong> 。 在Raspberry Pi上，波形馈送，波形读取以及与模拟信号一起使用的功能比微控制器要弱得多，这是微控制器的主要任务。 例如，在Raspberry Pi上开箱即用，将无法在硬件模式下控制伺服器。 <br><br><img src="https://habrastorage.org/webt/0r/sz/oj/0rszojmbxar2o-zhp26divehxj4.jpeg"><br><br> 限制是有条件的，因为扩展可以绕开它。 例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Troyka帽</a>铁<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">片</a> ，可对所有信号进行低级控制。  Raspberry Pi通过高级软件包与她进行通信。 发出命令以扭转伺服器并起作用。 使用这些扩展卡，您可以连接任何所需的设备。 <br><br><h2>  Arduino的 </h2><br> 您可以选择普通的<strong>Arduino</strong> ，每个人都已经厌倦了。 但是必须将JavaScript移到可以打开Node JS的位置-旧计算机或同一台Raspberry Pi。 <br><br><img src="https://habrastorage.org/webt/fc/z2/gx/fcz2gxhtqtz7gsoqbopfki6tlqm.jpeg"><br><br> 我们通过USB电缆将不需要的旧计算机连接到Arduino。 在Arduino中， <a href="">一次</a>填充标准<a href="">Firmata</a>固件。 她将Arduino变成了一个僵尸，他遵循主人-一台旧计算机的指示。 主人说要向某某引脚发送某某信号，然后Arduino进行传输。 <br><br> 为了进行通信，使用带有NPM的库-带有清晰API的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SerialPort</a>和Firmata。 因此，您又回到了JS世界，编写了发送到服务器的高级程序。 您相信Arduino可以处理信号，并且她可以执行信号。 <br><br> 并非总是与Firmata一起设法管理一切。 它能够与所需的硬件进行交互：伺服器，LED灯带，媒体控制器。 但是，如果不具备读取非常特殊的陀螺仪或加速度计的功能，它将无法正常工作。 然后，您必须在常规的Arduino上用C编写程序。 <br><br> 但这还不是全部-如果您不想用C编写，请使用开源工具<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">XOD.io。</a> <br><br><img src="https://habrastorage.org/webt/-p/-9/j0/-p-9j0ex1ngdm7pfdq-lv5dej9u.jpeg"><br><br> 这是一个可视化的编程环境，您在其中构建的图将变成代码，并且您已经可以对其进行编译和填充。  XOD.io允许不熟悉微控制器编程的复杂性和细微差别的人快速创建简单的程序。 如果您是从Firmata成长的，但仍然不觉得低强度的写作能力，请使用XOD.io。 <br><br><blockquote> 下一次<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FrontendConf</a>会议将于10月举行。 您了解大多数前端开发人员所不了解的JavaScript，开发了易于使用的界面或发现了性能瓶颈，并准备告诉它它的位置，我们正在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">等待应用程序</a>提供报告。 <br><br> 我们会在程序中收集有趣的报告，会议新闻，视频和文章到常规新闻通讯中- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">注册</a> 。 </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN450826/">https://habr.com/ru/post/zh-CN450826/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN450816/index.html">负责的开发人员的HTTP标头</a></li>
<li><a href="../zh-CN450818/index.html">从高Ceph延迟到使用eBPF / BCC的内核补丁</a></li>
<li><a href="../zh-CN450820/index.html">FrontendConf计划委员会：框架，视野，世界经验和会议使命</a></li>
<li><a href="../zh-CN450822/index.html">消失的框架</a></li>
<li><a href="../zh-CN450824/index.html">CSS的状态</a></li>
<li><a href="../zh-CN450828/index.html">当城市入睡时...</a></li>
<li><a href="../zh-CN450830/index.html">Nikita Dubko谈会议，冒名顶替综合症和报告</a></li>
<li><a href="../zh-CN450832/index.html">一个动画的故事</a></li>
<li><a href="../zh-CN450834/index.html">解析网站-在俄罗斯一般合法吗？</a></li>
<li><a href="../zh-CN450836/index.html">在云层后面的轨道上：如何在摩天大楼中清洗玻璃</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>