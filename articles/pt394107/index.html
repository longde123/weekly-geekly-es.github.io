<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿‍🤝‍🧑🏿 🕑 🚶🏻 Relógio LED Shadowplay na plataforma Arduino Uno 👩‍❤️‍👩 📨 💆🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em vez de se juntar
 
 
 Portanto, nossa equipe de três pessoas teve a tarefa: montar um pequeno projeto de hardware em um tempo muito curto, de prefe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Relógio LED Shadowplay na plataforma Arduino Uno</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394107/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em vez de se juntar</font></font></h3><br>
<img src="https://habrastorage.org/files/48b/451/4a6/48b4514a6fd144ba8e19798a1588bd87.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, nossa equipe de três pessoas teve a tarefa: montar um pequeno projeto de hardware em um tempo muito curto, de preferência na plataforma Arduino. </font><font style="vertical-align: inherit;">Vale ressaltar que até aquele momento estávamos familiarizados com os circuitos, em grande parte, em teoria. </font><font style="vertical-align: inherit;">E isso significa - nem experiência com um ferro de solda (praticamente), nem, principalmente, experiência com o Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De repente, deparamos com </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dedicado ao projeto Shadowplay Clock. </font><font style="vertical-align: inherit;">Este é um relógio de parede projetado por uma equipe de designers vienenses, a hora em que você pode ver tocando um dedo no centro. </font><font style="vertical-align: inherit;">Os LEDs acendem de forma que a sombra do dedo no centro mostre a hora. </font><font style="vertical-align: inherit;">Foi decidido criar o mesmo (ou muito semelhante), mas em casa. </font><font style="vertical-align: inherit;">O artigo acima, como você pode ver, não contém uma descrição detalhada do projeto. </font><font style="vertical-align: inherit;">De tudo isso, seguimos que nós mesmos tivemos que descobrir como esse dispositivo funciona e dar vida a ele. </font><font style="vertical-align: inherit;">O que nós, de fato, fizemos.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Materiais</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para criar um relógio, você precisa:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> espaços em branco do painel de fibras</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tira de diodo de 60 LED</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arduino uno</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RTC DS1307 Módulo de relógio em tempo real</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> botão</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tábua de pão</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registrador de mudança 74HC595 (x2)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trava de registro de 8 bits 74HC573N (x8)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> decodificador 4-16 K155ID3 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inversor de dreno aberto IN74HC05AN (x10)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unidade de potência </font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos começar</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Então, o algoritmo do dispositivo:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando a energia é aplicada, os LEDs acendem em uma combinação predeterminada. </font><font style="vertical-align: inherit;">No Shadowplay original, todos os LEDs acenderam, mas pareceu-nos que seria mais interessante lançar alguma combinação como protetor de tela.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando o botão é pressionado (sim, também nos afastamos do original e inserimos um pequeno botão no centro), a hora é lida no módulo RTC.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O tempo de leitura é convertido em código binário (máscara) e inserido nos registros.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependendo da máscara, o diodo necessário é ativado.</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardware</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando finalmente decidimos a idéia do projeto, a primeira coisa que tentamos foi esboçar mentalmente versões aproximadas dos esquemas para sua implementação. A questão principal era como lidar com 60 LEDs. De fato, a resposta a essa pergunta determinou o método de construção de quase todo o esquema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira opção que veio à mente foi o uso de decodificadores. O circuito compilado era uma cascata de quatro decodificadores 4-16 e um decodificador 2-4, ambos com entradas de descriptografia. Essa cascata permitia endereçar a 64 saídas, o que era mais que suficiente para conectar 60 LEDs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, surgiu a questão de como fazer mais de um LED funcionar (endereço) ao mesmo tempo (afinal, precisávamos fornecer ao relógio pelo menos os minutos e ponteiros do relógio). Aqui, a principal desvantagem desse esquema foi manifestada - o decodificador não pode, por definição, endereçar mais de uma saída por vez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa falha nos forçou a abandonar a idéia com uma cascata de decodificadores. Além disso, agora temos outro requisito para o futuro circuito - suporte para a operação simultânea de um número diferente de LEDs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para atender a esse requisito, pensamos que é possível permitir que cada LED armazene seu estado. Os registros são adequados para essa finalidade, onde cada descarga individual corresponde ao estado de um dos LEDs. Decidimos usar registros de 8 bits, pois eles são mais comuns e mais práticos. Assim, em nosso circuito, precisaremos de 8 registros para fornecer suporte a 60 LEDs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, pensamos em como controlar o status dos LEDs com o Arduino por meio de registros. Cada registro para operação normal deve receber todos os 8 bits na sua totalidade. O Arduino Uno, é claro, fornece saídas suficientes para transmitir vários bits por vez, mas essa abordagem não será racional. Além disso, o esquema contém apenas 8 registros, o que significa que você precisa abordá-los de alguma forma. Para esse fim, adicionamos um decodificador e dois registradores de deslocamento de 8 bits conectados em cascata ao circuito. Um registro de deslocamento armazena uma máscara de estado de 8 bits, que será carregada em um dos 8 registros regulares, cujo número é armazenado no segundo registro de deslocamento. Consequentemente, um decodificador é conectado ao segundo registrador de deslocamento. Para esses propósitos, um decodificador de 3 por 8 é suficiente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para remover a inversão do número necessário de saídas, usamos dois circuitos do inversor KR1533LN1. Isso, é claro, complicou um pouco o esquema. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outra tarefa foi a tensão de trabalho dos LEDs igual a 12 volts em comparação com 5 volts de circuitos lógicos. A solução proposta foi usar um inversor de dreno aberto. Esse microcircuito desempenha o papel de uma tecla que fecha (com lógico 1) ou abre (com 0 lógico) um dos contatos do LED com o terra, ativando ou desativando o LED. O circuito assume operação de 12 volts, de acordo com a tensão de operação dos LEDs; portanto, para obter 5 volts para circuitos lógicos, o estabilizador KR142EN5A com dois capacitores foi adicionado ao circuito.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Algumas entradas de certos microcircuitos implicam um valor constante na entrada, portanto elas foram conectadas ao terra ou a uma fonte de energia. </font><font style="vertical-align: inherit;">Nesse caso, estas são as seguintes entradas:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A entrada inversa de reset MR nos dois registros de deslocamento é conectada através do registro de carga à saída do estabilizador em 5 volts.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A entrada de ativação de saída OE inversa nos dois registros de deslocamento é conectada diretamente ao terra.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O decodificador inverso habilita a entrada E0 conectada ao terra</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/files/994/7dc/3c6/9947dc3c61754b44b034f4670f846fbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O circuito é controlado por quatro entradas (E1, SH, ST, DS). </font><font style="vertical-align: inherit;">A finalidade e os níveis de sinal de cada um deles são discutidos em mais detalhes abaixo:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A entrada E1 foi projetada para ativar o decodificador. No nosso caso, inicialmente no decodificador, existem duas entradas de controle E1, E0, e ambas são inversas. Haverá uma saída suficiente para que a segunda (E0) possa ser trazida para o chão. O estado do decodificador "padrão" fica operacional até que um nível alto de sinal seja aplicado a E1. Para fazer o oposto, conectamos esta entrada ao inversor. Sem isso, o decodificador pode emitir sinais de controle incorretos para os registros, por exemplo, no momento da atualização dos dados no registro de deslocamento. Como já mencionado, um decodificador de 3 por 8 pode ser usado no circuito, que pode ter uma entrada de controle não inversa, o que facilitará a solução de todos os problemas descritos acima sem fios extras e ferro de soldar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando um nível de sinal único é aplicado a E1, o decodificador decodifica o endereço de registro localizado no registro de deslocamento correspondente e envia um sinal para a saída desejada. Depois disso, o decodificador desliga novamente aplicando um nível de sinal baixo em E1. Tal comutador do decodificador gera um sinal na saída desejada, cuja borda e decaimento serve como um pulso de clock de registro para capturar em si os dados armazenados no barramento.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As próximas três entradas já se destinam ao controle de registros de turno. Vale a pena começar com a coisa mais simples - entrada de dados do DS. Esta entrada, como o nome indica, é destinada à transmissão de dados. Como os registros de deslocamento no circuito são conectados em cascata, o DS representa a saída correspondente de um deles. A entrada do segundo registro de deslocamento está conectada à saída do último bit do primeiro registro. O resultado é um registro de turno para 16 bits, dos quais apenas 12 bits são usados. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entrada SH é uma entrada de relógio. Uma onda quadrada é alimentada nessa entrada, responsável por carregar e alterar dados em cada um dos registros, respectivamente, esse contato do circuito é conectado aos pinos SHCP de ambos os registros.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O último pino ST serve como uma trava de dados nas saídas do registro. Um impulso é dado a esta entrada, no entanto, ela é fornecida apenas quando os dados no registro de deslocamento são finalmente carregados e é necessário corrigi-los na saída dos registros. Somente depois de dar esse sinal, os dados baixados dentro do registro na primeira linha de gatilhos entram na segunda linha de gatilhos e ficam disponíveis no barramento. ST é um pino conectado aos pinos STcp de ambos os registradores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resta explicar a fiação dos dois pinos dos registros de deslocamento MR e OE. A primeira entrada (MR) é responsável por despejar dados dentro do registro. Nesse circuito, essa oportunidade não é necessária; portanto, um alto nível de sinal é fornecido a esta saída através da carga.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A segunda entrada de registro (OE) é responsável por desconectar a segunda linha de gatilhos dentro do registro de deslocamento do barramento, ou seja, a entrada de habilitação. </font><font style="vertical-align: inherit;">Esta função também não é necessária, portanto, a saída é enrolada no chão. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Outro contato não descrito acima é projetado para remover o nível de sinal do botão no centro do relógio; o diagrama do botão é típico e representa uma carga e uma chave, dependendo da posição em que um nível de sinal baixo ou alto é enviado ao Arduino. </font><font style="vertical-align: inherit;">Dependendo do estado do botão, o relógio funciona no modo de proteção de tela ou no modo de exibição da hora.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A conexão com o Arduino não possui recursos especiais, exceto que o pino SH está idealmente conectado ao pino digital SCK. </font><font style="vertical-align: inherit;">O restante das saídas do circuito pode ser conectado a qualquer uma das entradas digitais de uso geral disponíveis. </font><font style="vertical-align: inherit;">No nosso caso, a conexão tem a seguinte forma:</font></font><br>
<br>
<ul>
<li>Arduino pin13 (SCK) –   SH</li>
<li>Arduino pin 11 –   ST Arduino pin 8 –   DS Arduino pin 5 –   E1 Arduino pin 3 –   Arduino pin GND –   (      )<br>
       ,      .<br>
<br>
    :   36  —   ;    36  ( ) \ 26  ( ) —  .   Shadowplay    72 ,     36.     ,    60  ( + ).     .   ,   ,     ,      .<br>
<br>
<img src="https://habrastorage.org/files/c46/3ff/f0b/c463fff0b95e402eaf9b4274301f04ba.jpg"><br>
<br>
  ,     .      ,    .   ,      .      ,  «»    50 — 60,        . , 60   .  :      —   .<br>
<br>
<img src="https://habrastorage.org/files/871/643/435/87164343503642ba802ead947d81ab6a.JPG"><br>
<br>
   ,  ,    ,  .      —     . ,         ,    .  ,   —  .<br>
<br>
<div class="spoiler"><b class="spoiler_title">      .</b><div class="spoiler_text"><img src="https://habrastorage.org/files/f95/9cc/f6d/f959ccf6d1c34b58ac31411eb3477a99.jpg"><br>
</div></div><br>
-,  .<br>
<br>
     Shadowplay.  ,       ,    . ,    ,       .      , ..     .        ,  ,       100% .    ,       .       .     ,         .  ,               .<br>
<br>
 ,      (       ),     ,    —    . ,  ,   !    .   ,  - -   . ,   ,    .             ,     ,           .   ,     ,    ,   .     .,     -         .    ,      ,   , ,   ,     . <br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.youtube.com/embed/uy-cLHOz-5M%3Ffeature%3Doembed&amp;usg=ALkJrhg88bnN0CRDAVMwB6mnBN0lBXCCxA" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 ,     .         . ..   ,     , ( ,      ,         ),      . <br>
<br>
<h4> </h4><br>
,     ().      Arduino.  ,    RTC,   —    .      DS1307,   — I2C.       2100     .          .     RTC  Arduino,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>.         RTC.<br>
<br>
<img src="https://habrastorage.org/files/c76/129/084/c761290840164f52a699e8f7d0c23a50.jpg"><br>
<br>
     ,      RTC,         .<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"> <pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Time.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DS1307RTC.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> REG [<span class="hljs-number"><span class="hljs-number">8</span></span>];<font></font>
tmElements_t te;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c,reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">13</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">11</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">8</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">5</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, INPUT);   <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
  <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//      RTC  </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Hour = 18;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Minute = 50;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Second = 0;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Day = 20; //</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Month = 4; // </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Year = CalendarYrToTm(2016); </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//RTC.write(te);</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{ 
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>))                    <span class="hljs-comment"><span class="hljs-comment">// ,     </span></span><font></font>
  {RTC.read(te);<font></font>
   SetShadowTime(te.Hour,te.Minute,te.Second,<span class="hljs-number"><span class="hljs-number">2</span></span>);        <span class="hljs-comment"><span class="hljs-comment">//         </span></span>
   delay(<span class="hljs-number"><span class="hljs-number">900</span></span>);<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>                                   <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span><font></font>
  {wait1();<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
                                         <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,<span class="hljs-number"><span class="hljs-number">0</span></span>); <font></font>
   <font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//======================================================================= </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUpLightByMask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RegNum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LightMask)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//         </span></span></span><span class="hljs-function">
</span></span>{<font></font>
  <font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, LOW);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, LOW);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, MSBFIRST, LightMask);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, LSBFIRST, RegNum);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, HIGH);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digitalClockDisplay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{  <span class="hljs-comment"><span class="hljs-comment">//    RTC  ,    RTC  </span></span><font></font>
  RTC.read(te);<font></font>
  Serial.print(te.Hour);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" : "</span></span>);<font></font>
  Serial.print(te.Minute);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" :"</span></span>);<font></font>
  Serial.print(te.Second);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Day);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Month);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(tmYearToCalendar(te.Year));<font></font>
  Serial.println();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ,     , ,        :</span></span>
<span class="hljs-comment"><span class="hljs-comment">//0 -  ,1 -   , 2 -    </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetShadowTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hours, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Minutes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Seconds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param)</span></span></span></span>{   
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h,hshift,m,s;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) REG[j] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Hours &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) Hours -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  h = Hours + <span class="hljs-number"><span class="hljs-number">6</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(h &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) h -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
    <font></font>
  hshift = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Minutes / <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  <font></font>
  REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
             <font></font>
   <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">1</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
   }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
     <font></font>
   s = Seconds + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(s &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) s -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(s%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,REG[j]);<font></font>
  }<font></font>
  <font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wait1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    </span></span></span><span class="hljs-function">
</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">0</span></span>;
     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       c = c | <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);  <font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);   <font></font>
      }<font></font>
   }<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">255</span></span>;
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);<font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);     <font></font>
      }<font></font>
    }  <font></font>
}<font></font>
</code></pre> <br>
</div></div><br>
<h4></h4><br>
    .         .      (Arduino, RTC)     .      ,   .       ,    «- ».   —   .  :<br>
<br>
    .<br>
<br>
<div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.slideshare.net/slideshow/embed_code/61634811&amp;usg=ALkJrhgpfdw-eTkcKzBBRqsirjadMECMIg" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br>
<br>
   ,       «»:<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.youtube.com/embed/KbbakER89U0%3Ffeature%3Doembed&amp;usg=ALkJrhiOWVuMXcJ4YwYqPJNyWE90mTJKoA" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 , ,    :<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.youtube.com/embed/SIPI6ug_dls%3Ffeature%3Doembed&amp;usg=ALkJrhjS7MbZa7egR6BFeMiAQPBDq0bC_w" frameborder="0" allowfullscreen=""></iframe><br>
<br>
    ,  ,   ,   . <br>
<br>
 ,  ,     .   ,    ?      .     :         ( ,     ,  ..). ,   ,  ,         .        . ,     .<br>
<br>
<h4></h4><br>
  ?<br>
<br>
<ul>
<li>,    ,   .</li>
<li>       .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A capacidade de alterar programaticamente facilmente a sequência de LEDs piscando, o que fornece uma variedade infinita de combinações.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não reivindicamos a exatidão absoluta de nossas soluções de circuitos e software. </font><font style="vertical-align: inherit;">Como já mencionado, a experiência negativa também é experiência. </font><font style="vertical-align: inherit;">Talvez este artigo ajude alguém a evitar nossos erros. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obrigado pela atenção!</font></font></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt394107/">https://habr.com/ru/post/pt394107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt394095/index.html">Como os alunos das escolas Hackathon da NASA fazem engenharia reversa de uma pulseira de fitness para controlar um drone</a></li>
<li><a href="../pt394097/index.html">Dor. Formato RusMARC</a></li>
<li><a href="../pt394101/index.html">Enquete: qual idioma é usado no seu sistema operacional</a></li>
<li><a href="../pt394103/index.html">Vento e gelo em Marte</a></li>
<li><a href="../pt394105/index.html">O cotonete Bluetooth inteligente informa quando é a hora de mudar</a></li>
<li><a href="../pt394111/index.html">Por quanto tempo ou onde armazenar rapidamente as informações no disco</a></li>
<li><a href="../pt394113/index.html">AOC e Jide lançaram PCs tudo em um no Remix OS</a></li>
<li><a href="../pt394115/index.html">Quanto é a sua ideia?</a></li>
<li><a href="../pt394123/index.html">Minecraft Gameband - uma pulseira para jogadores</a></li>
<li><a href="../pt394125/index.html">Windows 7 instalado em smartphones LG G Watch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>