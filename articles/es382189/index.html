<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕺🏾 💉 🚠 Smart.js - (más que) nuevo firmware para ESP8266 🏓 🆚 ⛹️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el habr, a menudo se publican artículos sobre varios proyectos basados ​​en el popular chip ESP8266, por lo que no hablaré de eso yo mismo. 
 
 Jus...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart.js - (más que) nuevo firmware para ESP8266</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/382189/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el habr, a menudo se publican artículos sobre varios proyectos basados ​​en el popular chip ESP8266, por lo que no hablaré de eso yo mismo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Justo al final: desarrollamos un nuevo firmware para este dispositivo, ofreciendo utilizar Javascript para el desarrollo. </font><font style="vertical-align: inherit;">Pero Smart.js no es solo un firmware de intérprete JS, también es un "kit" diferente para trabajar con equipos y una infraestructura en la nube. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d0c/4c1/ca4/d0c4c1ca4a2b453faf77decff24d5b13.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para más detalles, por favor, debajo del cat.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Debo decir de inmediato que este artículo es un artículo de revisión, en el que trataré de hablar sobre lo que Smart.js puede hacer, y hablaré muy poco sobre cómo funciona todo. Si está interesado en saber cómo funciona, este puede ser el tema del próximo artículo (y también puede ver la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fuente</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, ¿qué tenemos debajo del capó? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En primer lugar, es un motor JS llamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V7</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> desarrollado por Cesanta. Sin pensar demasiado en él, solo noto que este motor fue desarrollado originalmente para plataformas integradas, por lo tanto, se distingue por su pequeño tamaño, bajo consumo de memoria, excelente portabilidad y un alto grado de configurabilidad. Sin embargo, solo un intérprete JS en el ESP8266 sería algo en sí mismo, por lo que Smart.js puede comunicarse con el mundo exterior.</font></font><br>
<ul>
<li>I2C.  API    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>,      «»  (<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">EEPROM</a>). I2C   bit-bang,      ; </li>
<li>SPI. ESP   SPI ,       SPI  HSPI,  HSPI,  ,  Hardware SPI. «» SPI       ,     .     bit-bang',      ,   HSPI (,     ESP,      SPI, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>).   API  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>;</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wifi. </font><font style="vertical-align: inherit;">Sería extraño no admitir WiFi. </font><font style="vertical-align: inherit;">Por eso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apoyamos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sistema de archivos. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> basa en SPIFFS;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">También hay una API para trabajar con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GPIO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://github.com/cesanta/smart.js/blob/master/README.md&amp;usg=ALkJrhjGoWOLpfxLrSSkHIpXWFDFFSbZjQ#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cliente HTTP</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simple </font><font style="vertical-align: inherit;">;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... y un conjunto de varias </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funciones auxiliares</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, si es interesante, lea el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">archivo Léame</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tratamos de describir todo lo que es. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora un poco sobre un comienzo rápido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Descargar desde el archivo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flash'n'Chips</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Flash'n'chips es un controlador flash "patentado". </font><font style="vertical-align: inherit;">Puede usar cualquiera, pero Flash'n'chips genera inmediatamente la identificación y la contraseña del dispositivo necesarias para conectarse a la nube. </font><font style="vertical-align: inherit;">Hay una versión para OS X y Windows.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y Linux</font></font></b><div class="spoiler_text"> Linux    ,   ,    .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Además del flasher, el archivo también contiene firmware de "lanzamiento" (es decir, Alpha). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conectamos el ESP8266 a USB, lanzamos Flash'n'chips y vemos algo como esto: </font></font><br>
<br>
<img src="https://habrastorage.org/files/ad9/a25/fd9/ad9a25fd9fcf452f9e3066080d20a87a.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
haga clic en "Cargar firmware" y el firmware se descargará en el dispositivo. </font><font style="vertical-align: inherit;">Dependiendo de su ESP, se pueden requerir movimientos corporales adicionales. </font><font style="vertical-align: inherit;">Por ejemplo, uso el ESP01 más simple, así que antes de flashear necesito conectar GPIO0 a GND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos conectados por la terminal. </font><font style="vertical-align: inherit;">(También hay un Flash'N'Chips incorporado, estoy más familiarizado con picocom, pero esto no es importante). </font><font style="vertical-align: inherit;">Velocidad - 115200.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vemos la consola.</font></font></b><div class="spoiler_text">    ,     .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En esta consola, puede escribir inmediatamente el código JS. ("Smartjs NNN / MM $" es un mensaje de línea de comando, NNN es la cantidad de memoria libre, MM es la cantidad de memoria actualmente consumida directamente por el intérprete). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece una consola normal. </font></font><br>
<br>
<img src="https://habrastorage.org/files/afa/c9c/7d3/afac9c7d37e24b7f8b007648dcb37783.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando presiona Enter, el comando se ejecuta y su resultado se muestra en la consola, es decir, puede prescindir de mucha "impresión". Otra forma de escribir y ejecutar código JS es escribirlo en su editor favorito, guardarlo en un archivo y descargarlo en su dispositivo. La forma más fácil de hacer esto es con el mismo Flash'n'Chips: en el cuadro combinado Seleccionar acción, seleccione "Cargar archivo". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora el archivo se puede ejecutar con el comando File.load ("nombre de archivo") escribiendo este comando en la consola o agregándolo al archivo init.js (el archivo se ejecutará automáticamente cuando se inicie el dispositivo).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El firmware para ESP8266 Smart.js no está limitado. Como escribí anteriormente, todavía hay una nube donde puedes enviar datos desde el dispositivo, almacenarlos allí, tomarlos desde allí o simplemente mirar los gráficos. Se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adjunta</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> una API para enviar datos a la nube </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para comenzar rápidamente, grabamos un video corto:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/6DYfGsqQzCg%3Ffeature%3Doembed&amp;usg=ALkJrhgM-9K8eLfGeOUiJDwLAwiBtzQh7Q" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aquellos. Si necesita, por ejemplo, controlar la temperatura en el apartamento, entonces no tendrá que hacer casi nada. Es suficiente conectar un sensor de temperatura al ESP, escribir un "controlador" (o preparar uno) en JS, registrarse en la nube, escribir un pequeño script que lea la temperatura y la envíe a la nube. Y luego ve al sitio y mira la tabla. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, el firmware funcionará sin una nube. Pero es más conveniente con la nube, parte del trabajo de rutina se corta. Hay un enlace a la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nube</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el github </font><font style="vertical-align: inherit;">, y si tiene una cuenta github o G +, entonces el registro se ajustará en un par de clics.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, si carece de algunas funciones, siempre puede usar C. Puede simplemente escribir una nueva funcionalidad en C sin tener que asociarla con JS. Al mismo tiempo, seguirá siendo posible usar casi todas las API que son (en la mayoría de los casos, la API de JS es una envoltura delgada sobre las funciones sysh), además, puede usar las funciones ESP SDK. No es </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">difícil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ensamblar el firmware desde la fuente </font><font style="vertical-align: inherit;">, gracias a la presencia de imágenes acoplables. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puedes expandir JS. Para hacer esto, escribimos la funcionalidad necesaria en C y luego la ponemos a disposición en JS. Esto tampoco </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es difícil</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aquellos que trabajan con ESP8266, Smart.js parecerá similar a NodeMCU. No discutiré, aunque parezca. Pero tenemos grandes planes para el desarrollo de Smart.js y para portarlos a otros dispositivos, por lo que, con el tiempo, creo que habrá menos similitudes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hablando de nuestros planes. Ahora el estado de Smart.js es ALPHA 1. La próxima versión está programada para el otoño (que, por supuesto, no interfiere con aquellos que desean ensamblar el firmware de las fuentes con ninguna frecuencia). Para el otoño, aumentaremos la cantidad de memoria disponible para el usuario, actualizaremos los scripts desde la nube (es decir, en teoría sería posible nunca conectar el ESP8266 a la computadora), haremos el puerto a otras plataformas, etc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y ahora es importante para nosotros recibir comentarios. ¿Te gusta? ¿Lo que falta? ¿Qué es superfluo? ¡Todo es interesante!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, descargue el firmware, pruébelo, estaremos encantados. </font><font style="vertical-align: inherit;">Doble licencia, GPLv2 para todos los que vienen y comercial para aquellos que no tienen la GPL y / o necesitan soporte.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es382189/">https://habr.com/ru/post/es382189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es382179/index.html">Fallout Shelter para Android OS aparecerá el 13 de agosto</a></li>
<li><a href="../es382181/index.html">JiT-JiS SCM o "Cómo hacen los autos"</a></li>
<li><a href="../es382183/index.html">Apple recibió una patente para un control remoto biométrico para hogares inteligentes</a></li>
<li><a href="../es382185/index.html">4 tecnologías para ayudar a salvar los océanos</a></li>
<li><a href="../es382187/index.html">Revisión del monitor sin marco EIZO Foris FS2434</a></li>
<li><a href="../es382191/index.html">Kepler-452b. Otro "doble" de la Tierra en la constelación Cygnus. El primer exoplaneta cuya existencia se considera probada.</a></li>
<li><a href="../es382193/index.html">China ha puesto en órbita dos satélites de navegación más para el sistema BeiDou</a></li>
<li><a href="../es382195/index.html">Periodistas robóticos: los algoritmos son más una herramienta que una amenaza</a></li>
<li><a href="../es382199/index.html">¿Por qué el exoplaneta de la NASA no es un evento tan bueno?</a></li>
<li><a href="../es382201/index.html">7 mejores foros de quadcopter, blogs y canales de YouTube</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>