<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ì ‚ô£Ô∏è üë©üèæ‚Äçü§ù‚Äçüë©üèΩ Lo que necesita saber sobre JavaScript Engine Switcher 3.0 üôãüèæ üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø üõÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El JavaScript Engine Switcher se cre√≥ originalmente como una biblioteca auxiliar y su desarrollo estaba determinado en gran medida por las necesidades...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lo que necesita saber sobre JavaScript Engine Switcher 3.0</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439446/"><p><img src="https://habrastorage.org/webt/qo/zx/ss/qozxssedwxgcrteo4wnodfixdmy.png" alt="Logotipo para la tercera versi√≥n de JavaScript Engine Switcher"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El JavaScript Engine Switcher</a> se cre√≥ originalmente como una biblioteca auxiliar y su desarrollo estaba determinado en gran medida por las necesidades de las bibliotecas que lo usaban.  De hecho, cada una de sus versiones principales resolvi√≥ una o varias tareas importantes necesarias para el desarrollo posterior de otras bibliotecas: </p><br><ol><li> En la primera versi√≥n, esta tarea consist√≠a en agregar tantos m√≥dulos adaptadores para los motores JS populares que admitieran la plataforma .NET como fuera posible.  Y esto les dio a los usuarios de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bundle Transformer</a> cierta flexibilidad: en las computadoras del desarrollador, pod√≠an usar el m√≥dulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MSIE</a> que admite la depuraci√≥n de c√≥digo JS usando Visual Studio, y en servidores que no ten√≠an una versi√≥n moderna de Internet Explorer o no estaban instalados, pod√≠an usar M√≥dulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">V8</a> .  Algunos incluso lograron ejecutar el Bundle Transformer en Mono en Linux y Mac usando los m√≥dulos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jurassic</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jint</a> . </li><li>  La tarea principal de la segunda versi√≥n fue la implementaci√≥n del soporte de .NET Core, que se requer√≠a para la nueva versi√≥n de la biblioteca <a href="">ReactJS.NET</a> .  Otra tarea importante fue la creaci√≥n de un m√≥dulo multiplataforma que puede procesar r√°pidamente grandes cantidades de c√≥digo JS (los m√≥dulos Jurassic y Jint no eran adecuados para esto), y despu√©s de una serie de mejoras, el m√≥dulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ChakraCore</a> se convirti√≥ en dicho m√≥dulo. </li><li>  En la tercera versi√≥n, el objetivo principal era mejorar la integraci√≥n con la biblioteca ReactJS.NET y mejorar la productividad. </li></ol><br><p> En este art√≠culo, consideraremos algunas innovaciones de la tercera versi√≥n, que para muchos resultaron ser obvias incluso despu√©s de leer el <a href="">texto de</a> la <a href="">versi√≥n</a> y la secci√≥n de documentaci√≥n <a href="">"C√≥mo actualizar las aplicaciones a la versi√≥n 3.X"</a> : cambios en la clase <code>JsEngineSwitcher</code> , reorganizaci√≥n de excepciones, mensajes de error m√°s informativos, interrupci√≥n y compilaci√≥n preliminar de scripts, la capacidad de cambiar el tama√±o m√°ximo de pila en los m√≥dulos ChakraCore y MSIE, as√≠ como un nuevo m√≥dulo basado en NiL.JS. </p><a name="habracut"></a><br><h2>  Cambios en la clase JsEngineSwitcher </h2><br><p>  En la nueva versi√≥n, la clase <code>JsEngineSwitcher</code> implementa la interfaz <code>IJsEngineSwitcher</code> y ya no es un singleton (puede crear una instancia usando el <code>new</code> operador).  Para obtener una instancia global, en lugar de la propiedad <code>Instance</code> , use la propiedad <code>Current</code> .  La propiedad <code>Current</code> , a diferencia de la propiedad <code>Instance</code> desuso, tiene el tipo de retorno <code>IJsEngineSwitcher</code> .  Adem√°s, la propiedad <code>Current</code> tiene un setter, con el que puede reemplazar la implementaci√≥n est√°ndar por la suya propia: </p><br><pre> <code class="cs hljs">JsEngineSwitcher.Current = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyJsEngineSwitcher();</code> </pre> <br><p>  En las aplicaciones web ASP.NET Core que tienen instalado el paquete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JavaScriptEngineSwitcher.Extensions.MsDependencyInjection</a> , la implementaci√≥n se reemplaza utilizando el <code>AddJsEngineSwitcher</code> extensi√≥n <code>AddJsEngineSwitcher</code> : </p><br><pre> <code class="cs hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Extensions.MsDependencyInjection; ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IServiceCollection services</span></span></span><span class="hljs-function">)</span></span> { ‚Ä¶ services.AddJsEngineSwitcher(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyJsEngineSwitcher(), options =&gt; ‚Ä¶ ) ‚Ä¶ ; ‚Ä¶ } ‚Ä¶ } ‚Ä¶</code> </pre> <br><p>  Estos cambios casi siempre "rompen" las aplicaciones o bibliotecas que usan la versi√≥n anterior de JavaScript Engine Switcher.  Por lo tanto, debe realizar los siguientes cambios en su c√≥digo: </p><br><ol><li>  Cambie el tipo de variables, par√°metros o propiedades de <code>JsEngineSwitcher</code> a <code>IJsEngineSwitcher</code> . </li><li>  En lugar de la propiedad <code>Instance</code> , use la propiedad <code>Current</code> todas partes. </li></ol><br><p>  Tambi√©n vale la pena se√±alar que para la mayor√≠a de los desarrolladores, estos cambios no ser√°n de beneficio particular, ya que su objetivo principal era simplificar las pruebas unitarias (por ejemplo, anteriormente, en las pruebas unitarias de la biblioteca ReactJS.NET, se <a href="">usaron</a> bloqueos, pero ahora puede <a href="">prescindir de ellos</a> ). </p><br><h2>  Reorganizaci√≥n de excepciones </h2><br><p>  Antes de la tercera versi√≥n, la mayor√≠a de los errores del motor JS se convirtieron en <code>JsRuntimeException</code> tipo <code>JsRuntimeException</code> , y solo los errores que ocurrieron durante el proceso de inicializaci√≥n del motor se convirtieron en <code>JsEngineLoadException</code> .  Tambi√©n hubo una clase base <code>JsException</code> , de la que se heredaron dos de los tipos de excepciones anteriores, que hicieron posible interceptar absolutamente todos los errores que ocurrieron durante el funcionamiento de los motores JS.  A pesar de los inconvenientes obvios, esta organizaci√≥n de excepciones encaja bien con el concepto de una interfaz unificada para acceder a las capacidades b√°sicas de los motores JS. </p><br><p>  Pero con la implementaci√≥n de la interrupci√≥n y la precompilaci√≥n de los scripts (los analizar√© en las siguientes secciones), surgi√≥ la necesidad de un nuevo enfoque para organizar excepciones.  Lo primero que deb√≠a hacer era agregar un nuevo tipo de excepci√≥n: <code>JsInterruptedException</code> , que era necesario para notificar al usuario sobre la interrupci√≥n de la ejecuci√≥n del script.  Luego fue necesario dividir expl√≠citamente todos los errores que ocurrieron durante el procesamiento del script en dos grupos: errores de compilaci√≥n (an√°lisis) y errores de tiempo de ejecuci√≥n.  Tambi√©n se requer√≠a separar todo tipo de errores espec√≠ficos de Chakra y V8, que no estaban relacionados con el procesamiento de scripts.  Tambi√©n era necesario tener en cuenta la presencia de una excepci√≥n en el motor Jint que ocurre cuando ha transcurrido el tiempo de espera para ejecutar un script (tiempo de espera).  Como resultado, se form√≥ un nuevo enfoque para la organizaci√≥n de excepciones, que se puede representar como la siguiente estructura jer√°rquica: </p><br><ul><li> <code>JsException</code> <br> <ul><li> <code>JsEngineException</code> <br> <ul><li> <code>JsEngineLoadException</code> </li> </ul></li><li> <code>JsFatalException</code> </li> <li> <code>JsScriptException</code> <br> <ul><li> <code>JsCompilationException</code> </li> <li> <code>JsRuntimeException</code> <br> <ul><li> <code>JsInterruptedException</code> </li> <li> <code>JsTimeoutException</code> </li> </ul></li></ul></li><li> <code>JsUsageException</code> </li> </ul></li><li>  <code>JsEngineNotFoundException</code> <sup>*</sup> </li></ul><br><p>  * - esta excepci√≥n no ocurre en el nivel del motor JS, sino en el nivel de JavaScript Engine Switcher. </p><br><p>  Creo que la jerarqu√≠a de excepciones presentada anteriormente no necesita comentarios, porque los nombres de las excepciones hablan por s√≠ mismos.  Con este enfoque, obtenemos no solo m√°s informaci√≥n sobre las causas del error, sino que tambi√©n podemos manejar de manera m√°s flexible ciertos tipos de excepciones. </p><br><h2>  Formato de mensaje de error unificado </h2><br><p>  Otro problema con las versiones anteriores de JavaScript Engine Switcher fue la dificultad para localizar errores que ocurrieron al procesar secuencias de comandos.  Desde la propiedad de excepci√≥n <code>Message</code> , fue dif√≠cil entender exactamente d√≥nde ocurri√≥ el error en el c√≥digo, por lo que tuve que analizar otras propiedades de excepci√≥n, lo que no siempre fue conveniente.  Adem√°s, el conjunto de propiedades existentes tampoco era suficiente. </p><br><p>  Por lo tanto, se agregaron 2 nuevas propiedades a la clase <code>JsScriptException</code> : </p><br><ol><li>  <strong>Tipo</strong> : tipo de error de JavaScript (por ejemplo, <code>SyntaxError</code> o <code>TypeError</code> ); </li><li>  <strong>DocumentName</strong> : el nombre del documento (generalmente extra√≠do de los valores de los siguientes par√°metros: <code>documentName</code> de los m√©todos <code>Execute</code> y <code>Evaluate</code> , <code>path</code> m√©todo <code>ExecuteFile</code> , <code>resourceName</code> m√©todo <code>ExecuteResource</code> , etc.); </li></ol><br><p>  Tambi√©n se ha agregado una nueva propiedad a la clase <strong>JsRuntimeException</strong> : <strong>CallStack</strong> , que contiene una representaci√≥n de cadena de la pila de llamadas. </p><br><p>  Anteriormente, un valor de una propiedad similar de la excepci√≥n .NET original o una representaci√≥n de cadena de un error de JavaScript simplemente se copiaba en la propiedad <code>Message</code> .  A menudo, los mensajes de error en diferentes motores JS difer√≠an no solo en el formato, sino tambi√©n en la cantidad de informaci√≥n √∫til presentada en ellos.  Por ejemplo, debido a la falta de informaci√≥n del n√∫mero de fila y columna en algunos mensajes de error, los desarrolladores de la biblioteca ReactJS.NET se vieron obligados a <a href="">volver a lanzar las excepciones</a> recibidas del JavaScript Engine Switcher. </p><br><p>  Por lo tanto, decid√≠ generar mis propios mensajes de error en el nivel del m√≥dulo adaptador, que tendr√≠a un formato √∫nico (unificado).  Este formato utiliza toda la informaci√≥n de error disponible: tipo, descripci√≥n, nombre del documento, n√∫mero de l√≠nea, n√∫mero de columna, fragmento de c√≥digo y pila de llamadas.  Como base para el nuevo formato, tom√© el formato de error de la biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Microsoft ClearScript</a> . </p><br><p>  A continuaci√≥n se muestran los mensajes sobre el mismo error de compilaci√≥n que fueron generados por diferentes m√≥dulos adaptadores: </p><br><pre> <code class="plaintext hljs">ChakraCore ========== SyntaxError: Unexpected identifier after numeric literal at declinationOfSeconds.js:12:23 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; Jint ==== SyntaxError: Unexpected token ILLEGAL at declinationOfSeconds.js:12:25 Jurassic ======== SyntaxError: Expected operator but found 'O' at declinationOfSeconds.js:12 MSIE   Classic ===================== SyntaxError: Expected ';' at declinationOfSeconds.js:12:25 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; MSIE   Chakra ActiveScript ================================= SyntaxError: Expected ';' at declinationOfSeconds.js:12:25 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; MSIE   Chakra IE JsRT ============================ SyntaxError: Expected ';' at 12:25 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; MSIE   Chakra Edge JsRT ============================== SyntaxError: Unexpected identifier after numeric literal at declinationOfSeconds.js:12:23 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; NiL === SyntaxError: Unexpected token 'O' at 12:25 V8 == SyntaxError: Invalid or unexpected token at declinationOfSeconds.js:12:24 -&gt; caseIndex = number % 1O &lt; 5 ? number % 10 : 5; Vroom ===== SyntaxError: Unexpected token ILLEGAL at declinationOfSeconds.js:12:24</code> </pre> <br><p>  Un ejemplo similar para un error de tiempo de ejecuci√≥n: </p><br><pre> <code class="plaintext hljs">ChakraCore ========== TypeError: Unable to get property '' of undefined or null reference at transliterate (russian-translit.js:929:4) -&gt; newCharValue = typeof charMapping[charValue] !== 'undefined' ? at Global code (Script Document:1:1) Jint ==== TypeError: charMapping is undefined at russian-translit.js:929:26 Jurassic ======== TypeError: undefined cannot be converted to an object at transliterate (russian-translit.js:929) at Global code (Script Document:1) MSIE   Classic ===================== TypeError: 'undefined' is null or not an object at russian-translit.js:929:4 MSIE   Chakra ActiveScript ================================= TypeError: Unable to get property '' of undefined or null reference at russian-translit.js:929:4 MSIE   Chakra IE JsRT ============================ TypeError: Unable to get property '' of undefined or null reference at transliterate (russian-translit.js:929:4) at Global code (Script Document:1:1) MSIE   Chakra Edge JsRT ============================== TypeError: Unable to get property '' of undefined or null reference at transliterate (russian-translit.js:929:4) at Global code (Script Document:1:1) NiL === TypeError: Can't get property "" of "undefined" V8 == TypeError: Cannot read property '' of undefined at transliterate (russian-translit.js:929:37) -&gt; newCharValue = typeof charMapping[charValue] !== 'undefined' ? at Script Document:1:1 Vroom ===== TypeError: Cannot read property '' of undefined at russian-translit.js:929:37</code> </pre> <br><p>  Como puede ver en los ejemplos, algunos motores JS nos dan descripciones de error y n√∫meros de columna completamente diferentes, y no siempre podemos obtener un conjunto completo de datos de error, pero a pesar de estas deficiencias, el formato unificado nos brinda m√°s informaci√≥n sobre la ubicaci√≥n del error que mensajes de error originales </p><br><h2>  Consejos de implementaci√≥n de ensamblado nativo </h2><br><p>  La principal causa de errores al trabajar con la segunda versi√≥n de JavaScript Engine Switcher fue que muchos desarrolladores olvidaron instalar paquetes NuGet que contienen ensamblajes nativos para m√≥dulos ChakraCore y V8.  En un momento, una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicaci√≥n en el rastreador de errores ReactJS.NET</a> tambi√©n se dedic√≥ a este problema ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la traducci√≥n al ruso</a> tambi√©n est√° disponible).  Ahora, este error se encuentra principalmente solo por principiantes que, por alguna raz√≥n, no leyeron la documentaci√≥n. </p><br><p>  Los autores de ReactJS.NET intentaron minimizar el n√∫mero de tales errores utilizando las sugerencias dentro de los mensajes de error, pero la <a href="">implementaci√≥n poco exitosa de</a> este enfoque gener√≥ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">a√∫n m√°s confusi√≥n</a> .  La idea de las sugerencias era buena, pero requer√≠a una implementaci√≥n fundamentalmente diferente, a saber, implementaci√≥n a nivel de m√≥dulos adaptadores de motores JS.  En la nueva versi√≥n de JavaScript Engine Switcher, tales sugerencias se agregan al mensaje de error cuando se envuelven las excepciones <code>DllNotFoundException</code> y <code>TypeLoadException</code> <code>JsEngineLoadException</code> (ver ejemplos de implementaci√≥n para los <a href="">m√≥dulos ChakraCore</a> , <a href="">V8</a> y <a href="">Vroom</a> ).  Adem√°s, estos consejos son inteligentes, porque  su generaci√≥n tiene en cuenta una serie de factores: tipo de sistema operativo, arquitectura del procesador y tiempo de ejecuci√≥n (.NET Framework, .NET Core o Mono). </p><br><p>  Por ejemplo, cuando se utiliza el m√≥dulo ChakraCore sin ensamblaje nativo en un proceso de 64 bits en el sistema operativo Windows, el mensaje de error se ver√° as√≠: </p><br><blockquote>  Error al crear la instancia de ChakraCoreJsEngine.  Lo m√°s probable es que haya sucedido porque no se encontr√≥ el ensamblado 'ChakraCore.dll' o una de sus dependencias.  Intente instalar el paquete JavaScriptEngineSwitcher.ChakraCore.Native.win-x64 a trav√©s de NuGet.  Adem√°s, a√∫n necesita instalar Microsoft Visual C ++ Redistributable para Visual Studio 2017 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.visualstudio.com/downloads/#microsoft-visual-c-redistributable-for-visual-studio-2017</a> ). </blockquote><br><p>  El mensaje de error da una pista de que necesita instalar el paquete NuGet JavaScriptEngineSwitcher.ChakraCore.Native.win-x64, y tambi√©n menciona que ChakraCore para Windows requiere el componente redistribuible de Microsoft Visual C ++ para que Visual Studio 2017 funcione. Si ocurre en un proceso de 32 bits, se le pedir√° al usuario que instale el paquete JavaScriptEngineSwitcher.ChakraCore.Native.win-x86. </p><br><p>  Un mensaje de error similar en Linux en .NET Core se ver√≠a as√≠: </p><br><blockquote>  Error al crear la instancia de ChakraCoreJsEngine.  Lo m√°s probable es que sucedi√≥, porque no se encontr√≥ el ensamblado 'libChakraCore.so' o una de sus dependencias.  Intente instalar el paquete JavaScriptEngineSwitcher.ChakraCore.Native.linux-x64 a trav√©s de NuGet. </blockquote><br><p>  En este caso, se propondr√° instalar el paquete JavaScriptEngineSwitcher.ChakraCore.Native.linux-x64. </p><br><p>  Cuando se inicia en Mono, se mostrar√° otro mensaje: </p><br><blockquote>  ... Los paquetes JavaScriptEngineSwitcher.ChakraCore.Native.linux- * no admiten la instalaci√≥n en Mono, pero puede instalar el ensamblaje nativo manualmente ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/Taritsyn/JavaScriptEngineSwitcher/wiki/ChakraCore#linux</a> ). </blockquote><br><p>  Dado que el paquete JavaScriptEngineSwitcher.ChakraCore.Native.linux-x64 es compatible solo con .NET Core, la informaci√≥n sobre herramientas proporcionar√° un enlace a las instrucciones para implementar manualmente el ensamblado nativo en Linux. </p><br><p>  Se pueden dar muchos m√°s ejemplos, pero esto no tiene sentido. </p><br><h2>  Anulaci√≥n de ejecuci√≥n de script </h2><br><p>  Cuando damos a los usuarios la oportunidad de ejecutar c√≥digo JS arbitrario en el servidor, nos enfrentamos a un problema muy grave: no sabemos cu√°nto tiempo llevar√° ejecutar este c√≥digo.  Esto puede ser una gran cantidad de c√≥digo no √≥ptimo o c√≥digo que ejecuta un bucle infinito.  En cualquier caso, ser√° un c√≥digo no controlado que consumir√° los recursos de nuestro servidor indefinidamente.  Para controlar de alguna manera este proceso, necesitamos la capacidad de interrumpir la ejecuci√≥n de los scripts.  Al usar motores escritos en .NET puro (por ejemplo, Jint, Jurassic o NiL.JS), siempre podemos comenzar a ejecutar c√≥digo JS como una tarea con la capacidad de cancelar, pero este enfoque no funcionar√° para otros motores.  Afortunadamente para nosotros, los motores C ++ tienen mecanismos incorporados para interrumpir los scripts. </p><br><p>  Para proporcionar acceso a estos mecanismos, la propiedad <code>SupportsScriptInterruption</code> y el m√©todo <code>Interrupt</code> se agregaron a la interfaz <code>IJsEngine</code> .  Dado que no todos los motores admiten esta funci√≥n, siempre debe verificar el valor de la propiedad <code>SupportsScriptInterruption</code> antes de llamar al m√©todo <code>Interrupt</code> (si en versiones anteriores de JavaScript Engine Switcher tuvo que ejecutar manualmente el recolector de basura, comprender√° de inmediato de qu√© estoy hablando): </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (engine.SupportsScriptInterruption) { engine.Interrupt(); }</code> </pre> <br><p>  Y necesita llamar a este m√©todo en un hilo separado diferente del hilo en el que se ejecutan los scripts.  Despu√©s de llamar al m√©todo <code>Interrupt</code> , todos los <code>CallFunction</code> <code>Evaluate</code> , <code>Execute*</code> y <code>CallFunction</code> se <code>CallFunction</code> terminar√°n con una <code>JsInterruptedException</code> . </p><br><p>  Dado que esta API es de bajo nivel, se recomienda utilizar m√©todos de extensi√≥n como los siguientes para las tareas descritas al principio de la secci√≥n: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> !NET40 using System.Runtime.ExceptionServices; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> using System.Threading; using System.Threading.Tasks; using JavaScriptEngineSwitcher.Core; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 using JavaScriptEngineSwitcher.Core.Extensions; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> using JavaScriptEngineSwitcher.Core.Resources; ‚Ä¶ /// &lt;summary&gt; /// Extension methods for &lt;see cref="IJsEngine"/&gt; /// &lt;/summary&gt; public static class JsEngineExtensions { /// &lt;summary&gt; /// Evaluates an expression within a specified time interval /// &lt;/summary&gt; /// &lt;typeparam name="T"&gt;Type of result&lt;/typeparam&gt; /// &lt;param name="engine"&gt;JS engine&lt;/param&gt; /// &lt;param name="expression"&gt;JS expression&lt;/param&gt; /// &lt;param name="timeoutInterval"&gt;Interval to wait before the /// script execution times out&lt;/param&gt; /// &lt;param name="documentName"&gt;Document name&lt;/param&gt; /// &lt;returns&gt;Result of the expression&lt;/returns&gt; /// &lt;exception cref="ObjectDisposedException"/&gt; /// &lt;exception cref="ArgumentNullException"/&gt; /// &lt;exception cref="ArgumentException"/&gt; /// &lt;exception cref="JsCompilationException"/&gt; /// &lt;exception cref="JsTimeoutException"/&gt; /// &lt;exception cref="JsRuntimeException"/&gt; /// &lt;exception cref="JsException"/&gt; public static T Evaluate&lt;T&gt;(this IJsEngine engine, string expression, TimeSpan timeoutInterval, string documentName) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (engine == null) { throw new ArgumentNullException(nameof(engine)); } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (engine.SupportsScriptInterruption) { using (var timer = new Timer(state =&gt; engine.Interrupt(), null, timeoutInterval, #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 new TimeSpan(0, 0, 0, 0, -1))) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> Timeout.InfiniteTimeSpan)) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> { try { return engine.Evaluate&lt;T&gt;(expression, documentName); } catch (JsInterruptedException e) { throw new JsTimeoutException( Strings.Runtime_ScriptTimeoutExceeded, e.EngineName, e.EngineVersion, e ); } } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 Task&lt;T&gt; task = Task.Factory.StartNew(() =&gt; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> Task&lt;T&gt; task = Task.Run(() =&gt; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> { return engine.Evaluate&lt;T&gt;(expression, documentName); }); bool isCompletedSuccessfully = false; try { isCompletedSuccessfully = task.Wait(timeoutInterval); } catch (AggregateException e) { Exception innerException = e.InnerException; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (innerException != null) { #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> NET40 innerException.PreserveStackTrace(); throw innerException; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> ExceptionDispatchInfo.Capture(innerException).Throw(); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { throw; } } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (isCompletedSuccessfully) { return task.Result; } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { throw new JsTimeoutException( Strings.Runtime_ScriptTimeoutExceeded, engine.Name, engine.Version ); } } } ‚Ä¶ } ‚Ä¶</span></span></code> </pre> <br><p>  Este m√©todo es un complemento del m√©todo del motor <code>Evaluate&lt;T&gt;</code> , que permite utilizar el par√°metro <code>timeoutInterval</code> establecer el tiempo de espera para que se ejecute el script.  El principio de funcionamiento de este m√©todo de extensi√≥n es muy simple.  Primero, verificamos si nuestro motor admite el mecanismo de interrupci√≥n incorporado.  Si lo <code>timeoutInterval</code> , creamos una instancia de la clase <code>Timer</code> , que, despu√©s del intervalo de <code>timeoutInterval</code> especificado en el par√°metro de <code>timeoutInterval</code> , inicia el m√©todo de <code>Interrupt</code> , luego llamamos al m√©todo del motor <code>Evaluate&lt;T&gt;</code> y, en caso de error, captura la <code>JsInterruptedException</code> y la envuelve en una <code>JsTimeoutException</code> .  Si el motor no admite interrupciones, cree una instancia de la clase <code>Task</code> que ejecute el m√©todo <code>Evaluate&lt;T&gt;</code> del motor, luego establezca el intervalo de espera para que la tarea se ejecute igual al valor del par√°metro <code>timeoutInterval</code> , y si la tarea se completa por tiempo de espera, arroje una <code>JsTimeoutException</code> tipo <code>JsTimeoutException</code> .  El siguiente es un ejemplo del uso de este m√©todo de extensi√≥n: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core.Helpers; ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> expression = <span class="hljs-string"><span class="hljs-string">@"function getRandomInt(minValue, maxValue) { minValue = Math.ceil(minValue); maxValue = Math.floor(maxValue); return Math.floor(Math.random() * (maxValue - minValue + 1)) + minValue; } function sleep(millisecondsTimeout) { var totalMilliseconds = new Date().getTime() + millisecondsTimeout; while (new Date().getTime() &lt; totalMilliseconds) { } } var randomNumber = getRandomInt(1, 10); sleep(randomNumber * 1000); randomNumber;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (IJsEngine engine = JsEngineSwitcher.Current.CreateDefaultEngine()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = engine.Evaluate&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(expression, TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">"randomNumber.js"</span></span>); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">" = {0}"</span></span>, result); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsTimeoutException) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"    JavaScript "</span></span> + <span class="hljs-string"><span class="hljs-string">"   !"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"   JavaScript-  "</span></span> + <span class="hljs-string"><span class="hljs-string">"!"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); } } } ‚Ä¶ } ‚Ä¶</code> </pre> <br><p>  Usando el m√©todo de extensi√≥n, calculamos el resultado de la expresi√≥n JS.  El resultado de la expresi√≥n es un entero aleatorio, y este n√∫mero tambi√©n es el n√∫mero de segundos por los cuales esta expresi√≥n se retrasa.  Adem√°s, al llamar al m√©todo de extensi√≥n, especificamos un intervalo de espera de 3 segundos.  Dado que el tiempo para calcular la expresi√≥n var√≠a de 1 a 10 segundos, en un caso, el resultado de la expresi√≥n se mostrar√° en la consola y, en otro, un mensaje sobre el tiempo de espera. </p><br><p>  No deber√≠a ser dif√≠cil para usted rehacer este m√©todo de extensi√≥n para llamar a otros m√©todos del motor (por ejemplo, <code>Execute*</code> , <code>CallFunction</code> u otras versiones sobrecargadas del m√©todo <code>Evaluate</code> ).  Hasta ahora no he decidido si agregar√© tales m√©todos de extensi√≥n a la biblioteca en s√≠, porque todav√≠a no est√° claro cu√°nto tendr√°n demanda. </p><br><h2>  Precompilaci√≥n de guiones </h2><br><p>  Me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pidieron que</a> agregara soporte para la compilaci√≥n preliminar de scripts <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en 2015</a> .  En ese momento, no estaba claro c√≥mo esa funci√≥n podr√≠a encajar en el concepto de una interfaz unificada.  Pero a medida que pasaba el tiempo, el soporte para las funciones de accesibilidad, como la recolecci√≥n de basura y la interrupci√≥n de scripts, comenz√≥ a aparecer gradualmente en JavaScript Engine Switcher.  En las √∫ltimas etapas de trabajo en la tercera versi√≥n, lleg√≥ el momento de la compilaci√≥n preliminar. </p><br><p>  Con la compilaci√≥n previa, puede compilar un script una vez y luego usarlo muchas veces para inicializar los motores JS.  Debido al hecho de que el script precompilado no requiere an√°lisis, la inicializaci√≥n de los motores ser√° m√°s r√°pida. </p><br><p>  En la actualidad, la precompilaci√≥n es compatible con 5 m√≥dulos adaptadores: ChakraCore, Jint, Jurassic, MSIE (solo en modos JsRT) y V8.  Para proporcionar acceso a los mecanismos del motor correspondientes, la propiedad <code>SupportsScriptPrecompilation</code> y 3 nuevos m√©todos se agregaron a la interfaz <code>Precompile</code> : <code>Precompile</code> , <code>PrecompileFile</code> y <code>PrecompileResource</code> .  <code>Precompile*</code> m√©todos de <code>Precompile*</code> devuelven una instancia de un objeto que implementa la interfaz <code>IPrecompiledScript</code> .  Este objeto es un script precompilado que puede ser utilizado por diferentes instancias de los motores (una versi√≥n sobrecargada del m√©todo <code>Execute</code> sirve para este prop√≥sito).  Considere un ejemplo simple de uso de esta API: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> JavaScriptEngineSwitcher.Core.Helpers; ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> sourceCode = <span class="hljs-string"><span class="hljs-string">@"function declinationOfSeconds(number) { var result, titles = ['', '', ''], titleIndex, cases = [2, 0, 1, 1, 1, 2], caseIndex ; if (number % 100 &gt; 4 &amp;&amp; number % 100 &lt; 20) { titleIndex = 2; } else { caseIndex = number % 10 &lt; 5 ? number % 10 : 5; titleIndex = cases[caseIndex]; } result = number + ' ' + titles[titleIndex]; return result; }"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> functionName = <span class="hljs-string"><span class="hljs-string">"declinationOfSeconds"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> itemCount = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] inputSeconds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[itemCount] { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">600</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] outputStrings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[itemCount]; IJsEngineSwitcher engineSwitcher = JsEngineSwitcher.Current; IPrecompiledScript precompiledCode = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> engine = engineSwitcher.CreateDefaultEngine()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!engine.SupportsScriptPrecompilation) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"{0}  {1}   "</span></span> + <span class="hljs-string"><span class="hljs-string">"  !"</span></span>, engine.Name, engine.Version); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { precompiledCode = engine.Precompile(sourceCode, <span class="hljs-string"><span class="hljs-string">"declinationOfSeconds.js"</span></span>); engine.Execute(precompiledCode); outputStrings[<span class="hljs-number"><span class="hljs-number">0</span></span>] = engine.CallFunction&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(functionName, inputSeconds[<span class="hljs-number"><span class="hljs-number">0</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsCompilationException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"     "</span></span> + <span class="hljs-string"><span class="hljs-string">" !"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"   JavaScript-  "</span></span> + <span class="hljs-string"><span class="hljs-string">"!"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> itemIndex = <span class="hljs-number"><span class="hljs-number">1</span></span>; itemIndex &lt; itemCount; itemIndex++) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> engine = engineSwitcher.CreateDefaultEngine()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { engine.Execute(precompiledCode); outputStrings[itemIndex] = engine.CallFunction&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;( functionName, inputSeconds[itemIndex]); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JsException e) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"   JavaScript- "</span></span> + <span class="hljs-string"><span class="hljs-string">" !"</span></span>); Console.WriteLine(); Console.WriteLine(JsErrorHelpers.GenerateErrorDetails(e)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> itemIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; itemIndex &lt; itemCount; itemIndex++) { Console.WriteLine(outputStrings[itemIndex]); } } ‚Ä¶ } ‚Ä¶</code> </pre> <br><p>    ,         .     <code>SupportsScriptPrecompilation</code>  ,       ,  ,     .     <code>Precompile</code>  ,      ,      <code>JsCompilationException</code> . C   <code>Execute</code>      , ..   .     <code>CallFunction</code>   <code>declinationOfSeconds</code>      .     .   ,    ,           .     3        .  ,        ,        .         ,    ,      . </p><br><p>      ,     ,    .   ,  ,           .       ReactJS.NET.        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JSPool</a> ,         ( <code>System.Runtime.Caching.MemoryCache</code>  .NET Framework 4.X, <code>System.Web.Caching.Cache</code>  ASP.NET 4.X  <code>Microsoft.Extensions.Caching.Memory.IMemoryCache</code>  ASP.NET Core).      ,        (       <a href=""> </a> ).    ,       ReactJS.NET. </p><br><p>      ReactJS.NET .              .        <code>AllowJavaScriptPrecompilation</code>   <code>true</code> . </p><br><p>  ASP.NET 4.X       <code>App_Start/ReactConfig.cs</code> : </p><br><pre> <code class="cs hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ReactConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ReactSiteConfiguration.Configuration ‚Ä¶ .SetAllowJavaScriptPrecompilation(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) ‚Ä¶ ; ‚Ä¶ } } ‚Ä¶</code> </pre> <br><p>  ASP.NET Core      <code>Startup.cs</code> : </p><br><pre> <code class="cs hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IApplicationBuilder app, IHostingEnvironment env</span></span></span><span class="hljs-function">)</span></span> { ‚Ä¶ app.UseReact(config =&gt; { config ‚Ä¶ .SetAllowJavaScriptPrecompilation(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) ‚Ä¶ ; }); app.UseStaticFiles(); ‚Ä¶ } } ‚Ä¶</code> </pre> <br><p>       ,      .       <a href="">JsExecutionBenchmark</a> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BenchmarkDotNet</a> .        JS-     .    14,9 ,     ,       .          JavaScript Engine Switcher ( 3.0.4). </p><br><p>   ,      .NET Framework 4.7.2: </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup>. </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td rowspan="2"> <sup>ChakraCore</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>41,72 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>74,46 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>35,07 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>91,79 </sup> </td></tr><tr><td rowspan="2"> <sup>Jint</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>27,19 </sup> </td><td align="right"> <sup>2 812,50</sup> </td><td align="right"> <sup>1 343,75</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>16 374,58 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>15,54 </sup> </td><td align="right"> <sup>1 296,88</sup> </td><td align="right"> <sup>640,63</sup> </td><td align="right"> <sup>31,25</sup> </td><td align="right"> <sup>7 521,49 </sup> </td></tr><tr><td rowspan="2"> <sup>Jurassic</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>455,70 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>15 575,28 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>78,70 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>7 892,94 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra IE JsRT</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>30,97 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>77,75 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>24,40 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>90,58 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra Edge JsRT</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>33,14 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>78,40 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>32,86 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>95,48 </sup> </td></tr><tr><td rowspan="2"> <sup>V8</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>41,10 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>79,33 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>39,25 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>96,17 </sup> </td></tr></tbody></table><br><p>         ,    .NET ‚Äî     Jurassic  5,79 ,   Jint  1,75 a.      2     ,      2       .                .      Jurassic,          : Jurassic   JS-  IL-  Reflection.Emit,    .        ,          ,      . Jint           .NET-,    .    Jint      ,             .      ,  Jint    ,    ,            .  Jint  Jurassic        . </p><br><p>      ,   C++,  MSIE   Chakra IE JsRT ‚Äî     26,93%.    ChakraCore (18,96%),  V8 (4,71%)  MSIE   Chakra Edge JsRT    (0,85%).           Internet Explorer    Edge.            .          (   )      .   ,      -         12-17  (       ).         .       .         . </p><br><p>     .NET Core 2.0    ( V8 ,    Microsoft ClearScript,    ,   .NET Core): </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup>. </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td rowspan="2"> <sup>ChakraCore</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>43,65 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>18,07 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>36,37 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>16,59 </sup> </td></tr><tr><td rowspan="2"> <sup>Jint</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>24,87 </sup> </td><td align="right"> <sup>2 750,00</sup> </td><td align="right"> <sup>1 375,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>16 300,25 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>15,25 </sup> </td><td align="right"> <sup>1 281,25</sup> </td><td align="right"> <sup>593,75</sup> </td><td align="right"> <sup>62,50</sup> </td><td align="right"> <sup>7 447,44 </sup> </td></tr><tr><td rowspan="2"> <sup>Jurassic</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>469,97 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>15 511,70 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>80,72 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>7 845,98 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra IE JsRT</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>31,50 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>20,28 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>24,52 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>18,78 </sup> </td></tr><tr><td rowspan="2"> <sup>MSIE   Chakra Edge JsRT</sup> </td><td>  <sup>No</sup> </td><td align="right"> <sup>35,54 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>20,45 </sup> </td></tr><tr><td>  <sup>Si</sup> </td><td align="right"> <sup>31,44 </sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>18,99 </sup> </td></tr></tbody></table><br><p>      . ,     ‚Äî  MSIE   Chakra Edge JsRT  (7,69%).           Chakra    . </p><br><h2>        ChakraCore  MSIE </h2><br><p>    ,  Microsoft,    ,    .     IIS    (256   32-   512   64-),     ASP.NET  JS- (,  TypeScript)   .       JavaScript Engine Switcher        .             ,        Node.js (492   32-   984   64-).   ,      ,  -    .        ChakraCore  MSIE    <code>MaxStackSize</code> ,          .         Node.js.       ,             . </p><br><h2>     NiL.JS </h2><br><p>      - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NiL</a> ,      <a href="">NiL.JS</a> . NiL.JS ‚Äî    JS-,    .NET.      2014 ,        Jurassic  Jint.    ‚Äî  .         ,       . </p><br><p>     .NET Framework 4.7.2    : </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td> <sup>Jint</sup> </td><td align="right"> <sup>27,19 </sup> </td><td align="right"> <sup>2 812,50</sup> </td><td align="right"> <sup>1 343,75</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>16 374,58 </sup> </td></tr><tr><td> <sup>Jurassic</sup> </td><td align="right"> <sup>455,70 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>15 575,28 </sup> </td></tr><tr><td> <sup>NiL</sup> </td><td align="right"> <sup>17,80 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>4 424,09 </sup> </td></tr></tbody></table><br><p>     .NET Core 2.0  : </p><br><table><thead><tr><th align="left"> <sup> </sup> </th><th align="left"> <sup> . </sup> </th><th align="left"> <sup>Gen 0  . .</sup> </th><th align="left"> <sup>Gen 1  . .</sup> </th><th align="left"> <sup>Gen 2  . .</sup> </th><th align="left"> <sup>    .</sup> </th></tr></thead><tbody><tr><td> <sup>Jint</sup> </td><td align="right"> <sup>24,87 </sup> </td><td align="right"> <sup>2 750,00</sup> </td><td align="right"> <sup>1 375,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>16 300,25 </sup> </td></tr><tr><td> <sup>Jurassic</sup> </td><td align="right"> <sup>469,97 </sup> </td><td align="right"> <sup>2 000,00</sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>15 511,70 </sup> </td></tr><tr><td> <sup>NiL</sup> </td><td align="right"> <sup>19,67 </sup> </td><td align="right"> <sup>1 000,00</sup> </td><td align="center"> <sup>-</sup> </td><td align="center"> <sup>-</sup> </td><td align="right"> <sup>4 419,95 </sup> </td></tr></tbody></table><br><p>       .        ,     (     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   </a> ).   ,   Jint        2016       ,       .   <a href="">   3.0.0 Beta 1353</a> ,    Jint    2,4  ,  NiL.JS  2.5.1200,        . </p><br><p>   NiL.JS  .         -  ,      -  ,    .    Bundle Transformer,  JavaScript Engine Switcher,     Hogan  Handlebars,      ReactJS.NET.              NiL.JS. </p><br><h2>  Referencias </h2><br><ol><li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JavaScript Engine Switcher</a>  GitHub </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> JavaScript Engine Switcher</a> </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬´  JavaScript Engine Switcher 2.X¬ª</a> </li><li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JSPool</a>  GitHub </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  ReactJS.NET</a> </li><li>   <a href="">ReactJS.NET</a>  GitHub </li></ol><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439446/">https://habr.com/ru/post/439446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439432/index.html">C√≥mo convertirse en un desarrollador de Java en 1.5 a√±os</a></li>
<li><a href="../439434/index.html">NestJS: el mismo backend real en nodejs</a></li>
<li><a href="../439436/index.html">Reducci√≥n de costos de peque√±as series de productos electr√≥nicos en Rusia. Estuche de radio por internet WOLNA</a></li>
<li><a href="../439440/index.html">Implemente Zimbra Collaboration Open Source, autorice a trav√©s de AD y cree autom√°ticamente buzones</a></li>
<li><a href="../439442/index.html">Julia Generadores de informes y documentos</a></li>
<li><a href="../439448/index.html">¬øQu√© preguntas sobre virtualizaci√≥n espera una respuesta de un graduado?</a></li>
<li><a href="../439450/index.html">RS-485 sobre microcontroladores dom√©sticos de la compa√±√≠a Milander</a></li>
<li><a href="../439454/index.html">Programa como arte: un nuevo paradigma de gesti√≥n de software</a></li>
<li><a href="../439456/index.html">Hipster Podcasts # 2</a></li>
<li><a href="../439458/index.html">C√≥mo tradujimos el sitio web de la Rep√∫blica a Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>