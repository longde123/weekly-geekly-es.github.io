<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖤 👨🏽‍🔬 🍷 Arduino控制的蓝牙控制的Android设备-全周期（第1部分） 👩🏽‍🌾 👅 💝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="引言 
 由三个引擎组装由Android设备通过蓝牙控制的Arduino汽车的详细历史记录。 在几十个段落中，我将尝试逐步解释每条电线的连接位置，如何编写专有应用程序以及我不得不跳过一周多的儿童耙子。 

 有关级别，作者和警告的一些信息 
 我是一位作家，是一个16岁至17岁的孩子，来自莫斯科附近...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arduino控制的蓝牙控制的Android设备-全周期（第1部分）</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424087/"><h2> 引言 </h2><br> 由三个引擎组装由Android设备通过蓝牙控制的Arduino汽车的详细历史记录。 在几十个段落中，我将尝试逐步解释每条电线的连接位置，如何编写专有应用程序以及我不得不跳过一周多的儿童耙子。 <br><br><h2> 有关级别，作者和警告的一些信息 </h2><br> 我是一位作家，是一个16岁至17岁的孩子，来自莫斯科附近的一个村庄，他专门编写Android应用程序（而且很难烧掉某些东西），因此我承担起解决问题的最佳方法的责任。 <br><br> 实际上，以下所述的每个步骤花了我更多的时间。 可能因为这个原因，我想分享自己的经验。 同时，如果您责骂自己的错误并告诉我进行优化，我将非常高兴。 <br><br><h2> 挑战赛 </h2><br> 最简单的任务是制作Arduino控制的汽车驱动器，并将遥控器替换为android。 但是在大多数情况下，我不得不重新发明轮子，因为在Internet上找不到合适的解决方案。 <br><a name="habracut"></a><br><h3> 将需要 </h3><br><ol><li>  Arduino的 </li><li> 电机罩（在我的情况下为两个） </li><li> 蓝牙功能 </li><li> 安卓系统 </li><li> 常规电线 </li></ol><br><h2> 设计依据 </h2><br> 乐高户外挑战者被作为基础（实际上，它看起来不太可悲）。 她剩下的一切：机壳（所有装饰元素均被移除）和三个引擎。 <br><img src="https://habrastorage.org/webt/5u/w0/8p/5uw08p_lewnr1zi49vaufwll86s.jpeg" alt="图片"><br> 机器有自己的主板，但是其中一项任务隐含着普遍性：我做到了，其他人可以重复。 他动脑筋，放了Arduino Uno。 <br><br><h2>  Arduino安装 </h2><br> 由于某些原因，创建者没有为Arduino提供空间，因此他们通过钻孔塑料将其固定在螺钉上。 他将胶合板放在木板下，以免短路。 最好在螺丝（一瓶）下面滑一些塑料，因为板子没有铁螺栓保护。 <br><br><img src="https://habrastorage.org/webt/-z/qx/o4/-zqxo4riolp63sjxmvgkhuusejm.png"><br><br> 我立即在板子顶部放了两个马达，这样就可以了。 要控制第二根线，您必须将一根线从任何数字端口连接到H1（方向），将第二根线从带有垫片支撑（标有“〜”，通常为10、11）的引脚上连接到E1（速度）。 <br><br><img src="https://habrastorage.org/webt/ud/it/js/uditjsgup1hjr2yxejhphyk0zbq.png"><br><br><h2> 确定旋转角度 </h2><br> 出人意料的是，响应于机器旋转的不是伺服驱动器，而是普通的发动机。 有一个问题：最好不要燃烧它，因为旋转角度是有限的，并且发动机可以随心所欲旋转。 <br><br> 拨动方法的选项消失了，因为在不同的电池电量下，提供给电动机的电流量将发生变化，这将导致角度不断变化。 转动到停止位置也是不可能的，迟早的齿轮会崩溃。 <br><br> 解决方案：通过电路跟踪角度。 照片显示了一个小东西，它安装在旋转机构附近。 在发动机随车轮向左/向右旋转的部分上，装有带铁触点的扇贝。 <br><br><img src="https://habrastorage.org/webt/4p/9c/yi/4p9cyiwd7tppugbduc7wrq-dejq.jpeg"><br><br><img src="https://habrastorage.org/webt/7t/sd/bj/7tsdbjwklwcsckcbuvjxkx_am0k.jpeg"><br><br> 工作原理：将一根导线焊接到每条线上（总共四根），底部连接到正极（始终用梳子夹紧，见图），其余导线变为负极。 当扇贝齿落在最下面一行时，例如第三行，发生短路，电流流过，这是Arduino注意到的。 <br><br><img src="https://habrastorage.org/webt/fs/6-/br/fs6-br5cafv3h0zuhu8veydvb-w.jpeg"><br><br> 由于三个波段的各种组合，最多可以定义七个角度。 例如，当所有线路上都有电流时，将车轮转到最右位置，而仅在顶部上有电流时，则将车轮尽可能向左转动。 该表提供了所有选项。 <br><br><img src="https://habrastorage.org/webt/zm/58/p0/zm58p0a4lopofcg4q64biku9qss.png"><br><br><h2> 连接角度和代号 </h2><br> 每种颜色都有其自己的颜色：底部是绿色，下面的第一个是红色，第二个是黑色，第三个是白色。 在初始阶段，使用面包板和LED进行视觉调试。 <br><br><img src="https://habrastorage.org/webt/bp/40/7m/bp407mzavfdtrovvmbage4rwhus.jpeg"><br><br> 连接图如图所示。 再加上我们拉到绿色，其他的我们拉到负。 通过安装的电阻来消除干扰和避免短路，将导线连接到输出A0-A2。 仅从保存其他端口中选择它们。 <br><br><img src="https://habrastorage.org/webt/ud/it/js/uditjsgup1hjr2yxejhphyk0zbq.png"><br><br> 该代码带有注释。 我们连接引脚并通过digitarRead（）询问它们。 如果有电压，将返回true。 接下来，我们查看结果是否意味着车轮处于极限位置，我们禁止沿该方向再转弯。 <br><br> 一个小技巧：由于将来将需要5V和3.3V的输出，因此您可以在一个数字引脚上加一个加号。 每次检查角度之前，请先通过digitalWrite（whitePin）提供电流，然后检查角度并除去电流。 <br><br><pre><code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">int</span></span> speedTurn = <span class="hljs-number"><span class="hljs-number">180</span></span>; // ,  <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">255</span></span> //    <span class="hljs-type"><span class="hljs-type">int</span></span> pinRed = A0; <span class="hljs-type"><span class="hljs-type">int</span></span> pinWhite = A1; <span class="hljs-type"><span class="hljs-type">int</span></span> pinBlack = A2; <span class="hljs-type"><span class="hljs-type">int</span></span> pinAngleStop = <span class="hljs-number"><span class="hljs-number">12</span></span>; //   ,    ,  //   <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { //    pinMode(pinRed, <span class="hljs-keyword"><span class="hljs-keyword">INPUT</span></span>); pinMode(pinBlack, <span class="hljs-keyword"><span class="hljs-keyword">INPUT</span></span>); pinMode(pinWhite, <span class="hljs-keyword"><span class="hljs-keyword">INPUT</span></span>); // pinMode(pinAngleStop, OUTPUT); //  ,    pinMode(angleDirection, OUTPUT); pinMode(angleSpeed, OUTPUT); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); } //   <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>(),      <span class="hljs-type"><span class="hljs-type">void</span></span> turn(<span class="hljs-type"><span class="hljs-type">int</span></span> angle) { digitalWrite(pinAngleStop, HIGH); //   ,    delay(<span class="hljs-number"><span class="hljs-number">5</span></span>); // ,   ""  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(angle &gt; <span class="hljs-number"><span class="hljs-number">149</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( digitalRead(pinWhite) == HIGH &amp;&amp; digitalRead(pinBlack) == LOW &amp;&amp; digitalRead(pinBlack) == LOW) { //    ,      ,   //  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } //   ,  digitalWrite(angleDirection, HIGH); analogWrite(angleSpeed, speedTurn); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (angle &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(pinRed) == HIGH &amp;&amp; digitalRead(pinBlack) == HIGH &amp;&amp; digitalRead(pinWhite) == HIGH) { //    ,      ,   //  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } //   ,  digitalWrite(angleDirection, LOW); analogWrite(angleSpeed, speedTurn); } digitalWrite(pinAngleStop, LOW); //     delay(<span class="hljs-number"><span class="hljs-number">5</span></span>); }</code> </pre> <br><h2> 行走轮平行化 </h2><br> 最初，两个推进引擎连接在一起。 之所以断开它们，有两个原因：如果车轮朝不同的方向旋转，转弯会更有效；两个强大的引擎不会拉一个板。 <br><br> 问题：电动机屏蔽罩有两个输出，每个输出产生2安培的电流。 每个引擎吃0.7A。 似乎更少，但不是在最大负载下。 假设机器卡在沙子中或被搁置，电流上升到安培以上。 不是很关键，但是有潜在危险。 <br><br> 但是事实证明，电路板加热至关重要。 比赛开始半分钟后，电动机护罩正在预热，并且开始工作异常：电流供应不正确，车轮没有旋转，依此类推。 <br><br> 解决这两个问题的方法：一台发动机连接到一个电动机护罩，第二台发动机连接到另一个。 奇怪的是，它有所帮助。 温度下降，没有过热。 您可以放一个散热器，但是很难安装。 <br><br><img src="https://habrastorage.org/webt/qp/ty/zd/qptyzd9l9hs1icacrd2m1oetyiq.png"><br><br><h2> 蓝牙连接 </h2><br> 我使用了HC-05模型，该模型起到了致命的笑话作用。 所有蓝牙都以相同的方式连接：一根线的电压为3.3V（有时只能从5V开始工作），第二根线的电压为负，另外两根线的端口为0和1（分别为读取和发送）。 蓝牙上由RXD签名的导线被卡在TXD arduino中，而TXD则被卡在RXD中（如果混合使用，将看不到数据）。 <br><br> 有一个警告：串行端口默认使用端口0和1，通过该端口可以填充草图。 也就是说，当蓝牙卡住时，草图不会被淹没。 有两种解决方法：在填充时取出蓝牙或重新分配蓝牙的输入和输出。 第二种选择分两行执行。 <br><br><pre> <code class="hljs cpp"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SoftwareSerial.h&gt; \\  SoftwareSerial BTSerial(8, 9); \\ 8  9   0  1</span></span></span></span></code> </pre> <br> 连续三天的工作使我吃饱的陷阱是沟通的速度。 出于习惯，我安装了9600并尝试。 要么没有数据，要么字符混乱。 最后答案是HC-05在38400上进行通讯！ 请密切注意以下事实：尽管使用Serial.begin（9600），在Setup（）中我将执行BTSerial.begin（39400）。 <br><br><h2> 指令发送系统 </h2><br> 这篇文章太长了，因此我将在第二部分中单独考虑Arduino和Android代码，现在我将描述原理。 <br><br>  android设备上有一个操纵杆（一个圆圈，其实现也位于第二部分）。  Android会从中读取读数并将其转换为适合arduino的数字：像素的速度会变成-255到255（负-反向）之间的值，并确定角度。 我故意将此任务交给了电话，因为它功能强大得多，并且能够从容应对每秒数百个值的计算。 <br><br><img src="https://habrastorage.org/webt/gc/sz/op/gcszopqgz0xeruzdui4zlntrtnu.jpeg"><br><br> 安装插座后，将以以下格式发送数据：@ speed＃* angle＃。  @-表示以下数字包含速度，＃-表示速度值的结尾，*-角度值的开始，＃-完成角度记录。 周期是无限的，命令每100毫秒发送一次（选择了最佳数量）。 如果在android上没有执行任何操作，则不会发送任何内容。 <br><br> 在草图代码中详细描述了数据接收算法。 他不止一次地通讯，对我而言，他的工作非常完美。 <br><br><h2> 第一部分结论 </h2><br> 在本文中，我试图公开与机器物理部分有关的所有内容。 很可能我错过了一些事情，所以一定要问。 <br><br> 但是，对我而言，最有趣的是第二位-Arduino程序和Android应用程序，真正的魔力正在发生，至少对于年轻的我而言。 <br><br> 如果您找不到某个部分的答案，并且想亲自给我一个缺点，请等待-dendolg1@mail.ru,。 <br><br>  UPD：第二部分已经发布<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-habr.com/post/424813</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424087/">https://habr.com/ru/post/zh-CN424087/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424073/index.html">Microsoft JET数据库引擎中的远程代码执行</a></li>
<li><a href="../zh-CN424077/index.html">法国要求将“遗忘权”全球化-它会影响什么</a></li>
<li><a href="../zh-CN424081/index.html">RESS-移动应用程序的新架构</a></li>
<li><a href="../zh-CN424083/index.html">Robinhood交易所的一项交易服务被指控将用户应用程序的数据出售给高频交易者</a></li>
<li><a href="../zh-CN424085/index.html">我们正在为IDA Pro开发NIOS II处理器模块</a></li>
<li><a href="../zh-CN424089/index.html">会议是邪恶的。 还是好？</a></li>
<li><a href="../zh-CN424091/index.html">WiX.Py：我们分三行收集MSI软件包</a></li>
<li><a href="../zh-CN424093/index.html">从古董收音机到DIY扬声器：用于音响设备的12个YouTube频道</a></li>
<li><a href="../zh-CN424099/index.html">使用Keras确定西瓜的成熟度：从构思到Google Play程序的整个周期</a></li>
<li><a href="../zh-CN424103/index.html">自1970年代以来，硅谷一直对员工“不可原谅”</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>