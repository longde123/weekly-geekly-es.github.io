<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öΩÔ∏è ü§∏üèΩ üë©üèº‚Äçü§ù‚Äçüë®üèæ P√≠ldora azul falsa ‚ú°Ô∏è ü§òüèæ üë≤üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Soy un gran admirador del tablero de pastillas azul. Son muy buenos en t√©rminos de precio / rendimiento. En realidad, mi amor por ellos se nota en el ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>P√≠ldora azul falsa</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459136/"> Soy un gran admirador del tablero de pastillas azul.  Son muy buenos en t√©rminos de precio / rendimiento.  En realidad, mi amor por ellos se nota en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo de April Fools sobre el firmware del pedal para tocar la balalaika</a> . <br><br><img src="https://habrastorage.org/webt/6s/wd/xg/6swdxgpdmolly9ywvdylhvgmuj8.png"><br><br>  Abra una caja con estos tableros y tome uno r√°pidamente para resolver algunos problemas, en el orden de las cosas.  As√≠ es, recientemente tom√© la siguiente placa, la flashe√© con un "firmware" bien depurado y probado y ... obtuve un dispositivo USB no identificado.  Tom√© otro tablero, lo "flashe√©", el dispositivo funcionaba all√≠.  Se acabar√≠a el asunto, pero me pregunto cu√°l es el problema.  Por lo tanto, cuando lleg√≥ el fin de semana, comenc√© un estudio detallado de por qu√© no funciona. <br><a name="habracut"></a><br>  En general, antes de "flashear" las placas, me aseguro de que la prueba realizada por el fabricante funcione: el LED parpadea.  As√≠ que estaba seguro de que el procesador, en general, est√° vivo.  ¬øCu√°l es la culpa entonces?  Quiz√°s l√≠neas USB o cuarzo. <br><br>  Las l√≠neas estaban bien, el cuarzo no comenz√≥.  Pero puede no comenzar por muchas razones.  Su lanzamiento se realiza mediante programaci√≥n, ya en las entra√±as de la funci√≥n <b>main ()</b> . Bueno, bueno, comenzamos a depurar el programa. <br><br>  Todo estar√≠a bien, pero el depurador no va a la funci√≥n <b>main ()</b> .  El programa se cuelga en alg√∫n lugar entre el inicio y esta funci√≥n. <br><br><img src="https://habrastorage.org/webt/ko/es/xj/koesxjk9g7tdmkfbvgciacfru1a.png"><br><br>  Paramos el programa: bastante esperado, estamos en el controlador <b>HardFault</b> . <br><br><img src="https://habrastorage.org/webt/3t/ij/c8/3tijc8kk_f5o_cyy0ivc95mnk9o.png"><br><br><img src="https://habrastorage.org/webt/_k/oj/9w/_koj9wd0mzpqfulrmwhacwa7_py.png"><br><br>  ¬øQu√© nos trae por aqu√≠?  Restablecer el contador de direcciones: <br><br><img src="https://habrastorage.org/webt/ng/mh/ch/ngmhchhxo_va_3_ip0r9z_6nnk4.png"><br><br>  Y comenzamos a seguir cuidadosamente el programa.  Aqu√≠ en esta l√≠nea todo muere, usamos al menos la operaci√≥n de <b>paso</b> , al menos <b>paso a paso</b> . <br><br><img src="https://habrastorage.org/webt/sa/4k/-1/sa4k-1gc061eyl4i94sv4pwg14a.png"><br><br>  Jolly Keil ... Bueno, nada.  Restablezca todo nuevamente (RST), haga clic con el mouse en la ventana del desensamblador y avance.  En este caso, podemos entender que todo est√° muriendo dentro de la funci√≥n <b>__scatterload</b> . <br><br><img src="https://habrastorage.org/webt/i9/nw/ps/i9nwpsk8ig7ck8yai1v7i7re0_y.png"><br><br>  En general, si todo muere en esta funci√≥n, ya hay una raz√≥n para ver si el tipo de controlador est√° confundido.  Pero no, es cierto (tambi√©n verifiqu√© dos veces la configuraci√≥n, pero este firmware funciona en otras placas). <br><br><img src="https://habrastorage.org/webt/tn/fg/ok/tnfgokogkw2yvys7_drk5n9ted4.jpeg"><br><br>  Bueno  Nuevamente, reiniciamos todo y ya rastreamos esta funci√≥n.  Despu√©s de algunos juicios, cuelga y se sonroja, encontramos la l√≠nea de culpabilidad ... <br><br><img src="https://habrastorage.org/webt/k6/3z/tz/k63ztz99gszkoxsafwjxid7jvmm.png"><br><br>  Si si.  Todo muere al guardar registros en la pila.  Al mismo tiempo, se ve a la izquierda que SP es 0x200030A0.  Nos fijamos en la documentaci√≥n para el controlador: <br><br><img src="https://habrastorage.org/webt/0v/u1/u6/0vu1u6su1xs0fahgqoxxajp1fmm.png"><br><br>  Veamos qu√© ventana est√° asignada para SRAM: <br><br><img src="https://habrastorage.org/webt/tb/iu/im/tbiuimemokbgv9fnercmrybq-mm.png"><br><br>  Eso es correcto  El puntero de pila (SP) est√° en el rango permitido.  Entonces, ¬øcu√°l es la culpa?  Intentemos reemplazar descaradamente el valor de SP con 0x200030A0, digamos, con 0x200020A0, ya que el depurador permite esto ... ¬°Chpok!  ¬°El bloqueo en la l√≠nea especificada se ha detenido!  Entonces, nuestro chip de memoria no tiene 20 kilobytes.  Cuanto?  Despu√©s de verificar varias veces, descubrimos que el √∫ltimo valor de trabajo de SP es 0x20002800.  Es decir, 10 kilobytes.  Esto corresponde al cristal STM32F103C6.  Ante nosotros hay un microcircuito aserrado.  Por desgracia <br><br>  Todo estar√≠a bien, pero las tablas de este lote en mi caja bastante grande son f√°ciles de distinguir.  Tienen un color especial de puentes y un LED esmeralda muy hermoso (el resto tiene un tono verde menos agradable).  Por lo tanto, se pueden asignar f√°cilmente desde el mont√≥n de otras placas.  Por supuesto, los revis√©.  Por supuesto, toda la fiesta se cort√≥ (tom√© una docena). <br><br>  Qu√© hacer con esto no est√° claro.  Cuando obtuve tres piezas en una docena de tableros, que no ten√≠an una prueba regular: el LED no parpadeaba (as√≠ que ahora los reviso no selectivamente, sino totalmente), pas√© una semana en el vendedor.  √âl "se volvi√≥ loco".  Constantemente interesado en lo que quiero hacer, prometi√≥ ayudar con consejos.  Y le repet√≠ una y otra vez que me conect√© est√∫pidamente a la fuente de alimentaci√≥n, siete tableros parpadean, tres, no.  Entonces est√°n muertos.  Y nuevamente tiene su √≥rgano de barril.  Y as√≠ una semana.  Pero all√≠ todo era obvio.  No pas√≥ la prueba del personal.  Aqu√≠, la prueba de tiempo completo pasa, no necesita mucha memoria.  C√≥mo demostrar que vino un falso no est√° claro.  Y si puede probarlo, de todos modos, de acuerdo con las reglas de Ali Express, debe devolver los productos.  En general, todo parece desesperanza.  Y lo m√°s importante, el vendedor final no tuvo intenciones maliciosas.  Tom√© otro lote de √©l, m√°s tarde.  Todo est√° bien all√≠.  √âl mismo fue decepcionado. <br><br>  De una forma u otra, informo al p√∫blico que esto sucede.  Verifique las placas no solo para el rendimiento general, sino tambi√©n para las especificaciones del mundo real.  Es cierto, qu√© hacer con una falta de coincidencia no est√° claro. <br><br>  El art√≠culo tiene otro beneficio pr√°ctico.  Muestra c√≥mo puede encontrar r√°pidamente la raz√≥n por la cual la placa de repente no funciona, si el problema no es la inoperancia completa del controlador (responde a trav√©s del puerto de depuraci√≥n SWD). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/459136/">https://habr.com/ru/post/459136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../459122/index.html">Aleksey Savvateev: Premio Nobel de Jean Tyrol por analizar mercados imperfectos (2014) y reputaci√≥n colectiva</a></li>
<li><a href="../459126/index.html">Tanque de robot Raspberry Pi con Intel Neural Computer Stick 2</a></li>
<li><a href="../459128/index.html">Interfaces japonesas en el mundo real</a></li>
<li><a href="../459130/index.html">Manejo suave de errores en microservicios</a></li>
<li><a href="../459134/index.html">Experiencia usando BDD</a></li>
<li><a href="../459138/index.html">C√≥mo la clave secreta de Huawei entr√≥ en el firmware de los enrutadores Cisco</a></li>
<li><a href="../459140/index.html">Colocaci√≥n del implante: ¬øc√≥mo se hace esto?</a></li>
<li><a href="../459142/index.html">Creaci√≥n de un gr√°fico de l√≠nea de media m√≥vil animada en R. Recuperaci√≥n de datos a trav√©s de la API de la NBA</a></li>
<li><a href="../459144/index.html">Frontend Weekly Digest (1 - 7 de julio de 2019)</a></li>
<li><a href="../459146/index.html">Food Design Digest Junio ‚Äã‚Äã2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>