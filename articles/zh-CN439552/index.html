<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💃🏽 🔂 😭 恶意的Chrome扩展程序 🏗️ 😂 🧞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="同学的听众是每月7100万。 与整个Internet受众一样，我们的用户也面临常见的安全威胁：网络钓鱼，病毒，密码重用。 通常，攻击社交网络用户的经济引擎是垃圾邮件的传播。 尽管此类攻击并非直接由Odnoklassniki造成的，但我们有兴趣加以应对，为此，我们正在调查所有重大的垃圾邮件事件。 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>恶意的Chrome扩展程序</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/439552/"><img src="https://habrastorage.org/webt/dz/ry/99/dzry99akp3bcnui_uqky91be_1s.jpeg"><br><br> 同学的听众是每月7100万。 与整个Internet受众一样，我们的用户也面临常见的安全威胁：网络钓鱼，病毒，密码重用。 通常，攻击社交网络用户的经济引擎是垃圾邮件的传播。 尽管此类攻击并非直接由Odnoklassniki造成的，但我们有兴趣加以应对，为此，我们正在调查所有重大的垃圾邮件事件。 <br><br> 在我们发现门户网站用户之间存在异常活动之后，便开始了对新的（成功的）垃圾邮件攻击的典型调查。 它可以表示为单个服务的负载增加（例如图片上传或搜索服务），相同类型内容的有效分发（例如指向相似站点的链接），甚至表示对支持服务的呼叫数量增加。 <br><a name="habracut"></a><br> 在调查过程中，对我们而言，首先重要的是确定垃圾邮件在社交网络中的分布方式。 通常，这种调查的结果是检测到一组感染了病毒的设备。 有时，在它们散布的垃圾邮件中，我们会找到病毒本身的链接。 因此，我们设法恢复了分配方案并找到了相关的用户。 <br><br> 此类攻击的一个有趣的特殊情况是感染了恶意的浏览器扩展。  Chrome扩展程序既可以安装在Chrome本身中，也可以安装在基于Chromium的浏览器中，例如Opera和Yandex.Browser。 也就是说，网络的最大份额可能被覆盖。 其他浏览器（Firefox，Safari）的恶意扩展很少见。 我可以假设由于这种浏览器的受众相对较少，因此病毒的开发不会带来任何好处。 <br><br> 我们甚至可以计算用户中恶意扩展的传播程度： <br><br><img src="https://habrastorage.org/webt/mb/7_/pt/mb7_ptag9bex0v2u56uvrkrplrq.png"><br><br> 每天我们注册100-200,000受感染的用户。 在2018年，总共有120万用户使用了受感染的浏览器。 <br><br>  2017年初，在OWASP俄罗斯第6次聚会上，我们已经<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">谈到</a>了Odnoklassniki在对抗Chrome恶意扩展的传播方面的经验。 在近两年中，发生了很多变化。 但是首先，让我们弄清楚扩展是如何工作的。 <br><br> 因此，Chrome允许用户通过安装扩展程序自定义浏览器。 <br> 扩展提供了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Javascript API</a> ，它们可以使用，包括： <br><br><ul><li> 拦截和修改HTTP请求和响应； </li><li> 修改显示页面的DOM； </li><li> 管理浏览器界面（打开和关闭选项卡，将项目添加到上下文菜单）； </li><li> 管理扩展列表； </li><li> 订阅系统事件，例如，通过鼠标和键盘； </li><li> 读取浏览器历史记录和站点数据。 </li></ul><br> 扩展程序通过Chrome网上应用店以带有源代码和资源（图片，样式，HTML页面）的存档的形式分发。 扩展的关键组件如下： <br><br><ul><li> <b>清单</b>是带有扩展名配置的JSON。 除其他事项外，清单声明了扩展将获得其数据访问权限的必要权限和域。 </li><li>  <b>后台脚本</b>在其自身上下文中在后台执行，与网页代码隔离。 它们旨在接收和处理来自浏览器的各种事件，并具有对其API的完全访问权限。 </li><li> <b>内容脚本</b>在网页的上下文中执行。 页面本身和扩展的Javascript环境彼此隔离，扩展无法访问页面的变量和功能，反之亦然。 脚本可以使用<code>XMLHttpRequest</code>修改DOM页面并执行跨站点请求。 与常规页面不同，相同的原始策略和CORS服务器策略不适用于扩展请求，它们仅受清单中请求的访问集限制。 </li></ul><br> 假设有人决定编写自己的病毒。 他能意识到什么？ <br><br>  <b>访问用户数据</b> <br> 如上所述，扩展可以拦截页面和服务器之间的请求和响应。 很明显，在这种情况下，用于保护数据在传输过程中的通用机制-SSL-不会帮助保护页面数据，因为浏览器会将其传输到已经解密的扩展程序中。 <br><br>  <b>更改页面内容</b> <br> 该扩展有权访问DOM，可以添加和删除元素，从而更改页面界面。 经典示例是横幅广告的替换。 <br><br>  <b>用户活动跟踪</b> <br> 该扩展程序可以订阅来自键盘和鼠标的事件，从而在浏览器中跟踪用户操作并收集密码，个人数据，银行卡号。 <br><br>  <b>为用户执行动作</b> <br> 该扩展程序可能会在受害者页面的上下文中违反相同的源策略执行脚本。 这意味着扩展名也可以启动用户可以在站点上执行的任何操作。 <br><br>  <b>绕过两因素身份验证和其他帐户保护</b> <br> 用户自己在浏览器中通过身份验证和授权，因此，扩展名接收与合法用户相同的会话。 <br><br>  <b>完美的僵尸网络</b> <br> 通常，智能验证码和防洪系统依赖于以下事实：通过IP，指纹和随时间分配的请求，可以将僵尸程序的流量与正常用户的流量区分开。 扩展请求不能与真实用户的请求分开。 <br><br> 今年，Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">宣布</a>了多项旨在阻止恶意软件在应用商店中传播的创新。 从第三方来源安装扩展程序，禁止内联安装，加强审核规则，禁止对扩展程序进行混淆和任意代码执行。 <br><br> 尽管如此，恶意扩展仍继续用于攻击用户。 典型的目标是帐户盗窃（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">示例</a> ），个人数据（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">示例</a> ），垃圾邮件或欺骗性广告（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">示例</a> ）。 <br><br> 为了成功进行攻击，扩展必须解决以下问题： <br><br><ul><li> 躲藏在商店里； </li><li> 寻找并留住观众； </li><li> 赚钱。 </li></ul><br> 由于商店中的审核更加严格，病毒作者正在寻找发布扩展的新方法。 在这里，我们观察到了垃圾邮件发送者适应垃圾邮件过滤器的经典情况：一个具有数十万用户的扩展名变成了来自拥有少量用户的不同作者的数十种不同扩展名，后来这些扩展名开始模仿具有良好声誉的流行应用程序。 扩展现在托管在流行的云服务中，其服务器部分和“控制中心”定义了在任何给定时间被感染的浏览器的行为。 <br><br> 从商店中删除后，可以在安装它们的用户的浏览器中禁用被识别为恶意的扩展。 为了保留受感染的观众并能够安装新的扩展程序而不是远程扩展程序，病毒编写者对与该扩展程序不直接相关的浏览器设置进行了更改：注册服务工作者，向用户订阅通知，将其替换为主页或搜索服务。 所有这些都使您可以将链接发送到浏览器，以安装该病毒的新版本。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27d/21d/6d7/27d21d6d742a084c44c46c73e52dd9ef.png"><br><br> 对于我们观察到的病毒，垃圾邮件是主要收入来源。 在为扩展分发垃圾邮件的多种方法中，最有可能的是以下几种： <br><br><ul><li>  <b>替换并在访问的页面上添加广告</b> 。 如上所述，扩展程序可以对查看页面的内容进行任意更改，包括用自己的内容替换网站上的合法广告，或者通过打开弹出窗口，新标签或将某些网站重定向到广告来向用户显示其他广告。 <br><br> 用广告代替扩展的一种明显形式是使用HTML5通知。 安装扩展程序并使其在浏览器中处于活动状态后，足以诱骗受害者进入一个页面，该页面将注册服务工作者并签署用户通知。 而且，由于此服务工作者与扩展没有直接关系，因此即使从浏览器中删除了扩展，作者仍将拥有以推送通知的形式与用户进行交流的渠道。 <br><br> 如果将扩展名从商店中删除，则类似的机制也将与社会工程学结合使用，以重新感染受害者：用户收到带有吸引人的内容（例如，“ ok.ru新未读消息”）的推送，并带有安装新版本病毒而不是已删除版本的链接。 </li><li>  <b>使用受害者的帐户在社交网络上分发垃圾邮件</b> 。 安装在浏览器中的扩展程序可以代表当前用户执行请求，包括以用户的正常内容为幌子发送垃圾邮件（向朋友写消息，在公共场所张贴便笺和帖子，上传照片或视频）。 </li></ul><br> 综上所述，我们可以得出结论，恶意浏览器扩展仍然是对用户和Web应用程序的重大威胁。 扩展提供了一种传播恶意代码的便捷机制：它们不需要高要求的创建条件，在安装过程中不会引起用户的怀疑，反病毒软件也很少发现它们。 <br><br> 由于浏览器中的网页权限明显少于扩展名，并且无能为力，无法保护用户，这一事实使情况更加恶化。 希望Google在Store上宣布的反病毒活动能够成功。 但是，在这种情况发生之前，我们会尽力减少病毒在社交网络中的传播，并尽可能安全地使用服务。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN439552/">https://habr.com/ru/post/zh-CN439552/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN439540/index.html">Etherblade.net-用于在FPGA上创建以太网流量封装器的开源项目（第1部分）</a></li>
<li><a href="../zh-CN439542/index.html">任天堂明确表示，只有盗版才能保存视频游戏历史</a></li>
<li><a href="../zh-CN439544/index.html">殖民地 第24章出发</a></li>
<li><a href="../zh-CN439546/index.html">机器人梦到电动朋克吗？ 我如何教神经网络写音乐</a></li>
<li><a href="../zh-CN439550/index.html">Hackquest2018。结果与写作。 第1-3天</a></li>
<li><a href="../zh-CN439556/index.html">TDMS航道。 PMBOK方法论和俄罗斯设计组织</a></li>
<li><a href="../zh-CN439558/index.html">新旧电话。 重塑PSTN电话</a></li>
<li><a href="../zh-CN439560/index.html">适用于InterSystems IRIS数据平台的以太坊区块链适配器</a></li>
<li><a href="../zh-CN439562/index.html">使用kubeadm在裸机上配置Kubernetes HA集群。 第1/3部分</a></li>
<li><a href="../zh-CN439564/index.html">以Putut为例的AST树转换的实际应用</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>