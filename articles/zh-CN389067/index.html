<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤾🏼 ⚱️ 🕠 NooLite无线设备和智能家居（第1部分）。Arduino的 👨‍✈️ 👔 🚗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="各位Geektimes亲爱的读者们，大家好！这次，我想引起您的注意，有关将nooLite无线设备集成到家庭自动化系统中的系列文章。此周期将类似于已经发布的有关将Laurent模块集成到Smart Home系统中的系列文章（一，二，三），只有它会讨论nooLite系统，并且在阅读了此周期后，您将对从S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NooLite无线设备和智能家居（第1部分）。Arduino的</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/389067/"><img src="https://habrastorage.org/files/d8c/f00/38e/d8cf0038e7a040fe8e07446481c0a1a0.jpg" alt="NooLite"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
各位Geektimes亲爱的读者们，大家好！</font><font style="vertical-align: inherit;">这次，我想引起您的注意，有关将</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">无线设备集成</font><font style="vertical-align: inherit;">到家庭自动化系统中</font><font style="vertical-align: inherit;">的系列文章</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此周期将类似于已经发布的有关</font><font style="vertical-align: inherit;">将Laurent模块集成到Smart Home系统中的</font><font style="vertical-align: inherit;">系列文章（</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">二</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">三</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），只有它会讨论nooLite系统，并且在阅读了此周期后，您将对从Smart管理nooLite设备毫无疑问。在家里。</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于系列文章</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
循环分为三个部分。在第一部分中，您将通过Arduino项目了解nooLite无线设备的操作原理以及如何对其进行管理。在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第二</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分将详细介绍一下在Arduino的超级服务器的控制模块MT1132的整合，在这方面的机会，智能家居控制的开口来解释。</font><font style="vertical-align: inherit;">本系列</font><font style="vertical-align: inherit;">的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三篇</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章将专门讨论一个非常有趣的主题-基于Arduino Mega Server创建“ 100合1”设备的概念。实际上，将仅基于一个nooLite无线二聚体，详细研究在AMS上创建无线焊台的示例。还将有</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第四</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分，您将学习如何创建魔术水晶。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
顺便说一下，将在第三篇文章中讨论的焊接站已经存在于最新的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">组件中</font><font style="vertical-align: inherit;">，编号为0.14。</font><font style="vertical-align: inherit;">最好奇的读者不能等待第三篇文章，而是立即下载分发工具包，并弄清它们如何独立工作。</font></font><br>
<br>
<img src="https://habrastorage.org/files/428/a18/eeb/428a18eeb1f84623bc6c9f8d59e08974.jpg" alt="焊台"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
很棒的是，AMS中可以同时存在数百个这样的设备。</font><font style="vertical-align: inherit;">例如，焊接站，气象站，安全单元，温室控制器等。所有这些都可以同时工作，也可以通过加载网页或整个专用于特定设备的站点来“启动”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，让我们不要超越自己，让我们最后留下最有趣的部分，但是现在我们将做必要的理论准备。</font><font style="vertical-align: inherit;">我保证将以最简单，最易懂的方式陈述一切。</font><font style="vertical-align: inherit;">因此，让我们开始吧。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NooLite设备</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NooLite设备已经是一个众所周知的流行系统，并且在Internet上有很多有关它的信息。</font><font style="vertical-align: inherit;">我将在这里尝试总结要点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这个概念非常简单-有用于控制灯光和各种负载的电源单元，以及向这些电源单元发送命令的控制面板。</font><font style="vertical-align: inherit;">自然，所有这些工作都无需有线连接的参与。</font><font style="vertical-align: inherit;">其实一切。</font><font style="vertical-align: inherit;">该系统的优点在于，所有组件都经过深思熟虑，制作精良并完全按照其所说的做-它们可靠地控制了连接的设备。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
还有无线传感器，来自智能手机的设备控制等等，但是不可能在一篇文章中介绍所有内容，这里我们仅关注nooLite与流行的DIY平台Arduino的集成。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在整个nooLite设备的广泛范围中，我们将对MT1132控制模块感兴趣，因为它设计用于连接Arduino和Raspberry Pi等单板计算机。它可以在简单的串行接口上​​工作。展望未来，我会说我喜欢该模块是因为它的简单性，可预测性和可靠的操作。经过一个月不愿工作的W5500芯片上的网络模块的无能为力的努力，我能够欣赏到这些品质。</font></font><br>
<br>
<img src="https://habrastorage.org/files/af4/5a9/4dc/af45a94dc2684467920e9191ebcafc83.jpg" alt="MT1132模块"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我特别喜欢以下事实：（除了电源）模块仅通过一根（！）线（RX）连接到Arduino。第二个（TX）可以完全省略。该模块是“单向”的，也就是说，它仅设计用于发送控制信号。 Nootehnika公司的计划包括开发和发布该模块的“双向”版本。</font></font><br>
<br>
<img src="https://habrastorage.org/files/60c/dfb/d07/60cdfbd0709b41b88b19a00638637d59.jpg" alt="SU111-300"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nooLite设备需要的第二个要素是功率控制单元，例如SU111-300。单元的连接是基本的，可以在图中看到。两条导线连接到220伏特网络，另外两条连接到负载。我唯一要注意的是，模块随附有一个跳线，用于阻止调光模式；如果要调节电源，则需要切断该跳线（并记住要对产生的裸线进行绝缘）。</font></font><br>
<br>
<img src="https://habrastorage.org/files/acf/cd5/4ad/acfcd54ad9ab4c57bf6409799dd3a133.jpg" alt="PU311-2"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我不会在遥控器上讲，因为这是一个“手动”控件，而与自动化有关的我们对自动化更感兴趣。</font><font style="vertical-align: inherit;">我只能说，实验是使用壁挂开关形式的PU311-2遥控器进行的，并且以最佳方式展示了自身，即，它可以清晰地打开和关闭灯，而不会出现故障。</font><font style="vertical-align: inherit;">实际上，好的设备与坏的设备不同-您只是没有注意到好。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作理念。</font><font style="vertical-align: inherit;">绑定和取消链接</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在使用nooLite系统打开和关闭电器之前，需要将控制模块“链接”到相应的电源单元。这可以通过所谓的过程来完成。在nooLite文档中详细描述了“绑定”和“调整”。简而言之，一切都归结为按下链接块上的一对按钮，并且没有任何困难。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在使用MT1132控制模块代替遥控器的情况下，过程的执行方式略有不同。即：由于模块没有按钮，因此您需要以编程方式在所需的通道上生成并发送控制命令，然后按下电源单元上的按钮，以确认“绑定”或“取消绑定”。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
通道是“控制线”，MT1132模块中有32条通道，名称中的后两位数字可以证明。</font><font style="vertical-align: inherit;">这意味着，通过此模块，您可以管理32个独立的设备组，对于一套公寓或一栋小房子来说，这已经足够了。</font><font style="vertical-align: inherit;">如果您的房子很大，则这些模块可以协同工作并扩展到任意数量的通道。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议说明</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nootehnika公司网站</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个很棒的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">文档</font></a><font style="vertical-align: inherit;">，全面详细地描述了模块连接及其控制协议。</font><font style="vertical-align: inherit;">我不会用不必要的技术细节来弄乱文章，任何人都可以阅读本文档，我将仅介绍要点。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要控制该模块，我们需要形成一个由12个字节组成的控制命令。</font><font style="vertical-align: inherit;">上面文档中描述了组建团队的原则。</font><font style="vertical-align: inherit;">正如您将在下面看到的那样，所有这些规则已经在控制功能中进行了编程，我们只需要使用它们就可以向模块发出命令。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">测试团队</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
nooLite有一个相当完善的命令系统，我们将从中选择最简单和最常见的命令系统，并使用其示例进行说明。</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">捕捉</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解开</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包容性</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功率设定（调光）</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
了解基本团队的工作方式后，您可以轻松使用其他任何团队。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">连接MT1132模块</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
正如我已经说过的，MT1132模块实际上是用一根电线（电源除外）连接的。</font><font style="vertical-align: inherit;">该模块可以由5伏电压和3.3伏电压供电。</font><font style="vertical-align: inherit;">因此，连接到5伏Arduino Mega或3.3伏Arduino Due没有问题。</font><font style="vertical-align: inherit;">唯一的一点是，随着功率的降低，系统可靠运行的范围将减小。</font><font style="vertical-align: inherit;">如果要使用3.3伏特的电压为模块供电，则必须考虑到这一点。</font></font><br>
<br>
<img src="https://habrastorage.org/files/fb8/2a4/d76/fb82a4d769cb49bda099e57591c13157.jpg" alt="Arduino的"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该模块具有RX和TX引脚，用于通过串行接口接收和发送信号。</font><font style="vertical-align: inherit;">模块操作的关键是RX的连接，用于接收来自控制器的控制命令。</font><font style="vertical-align: inherit;">因此，模块侧的RX引脚连接到Arduino侧的TX引脚（18）。</font><font style="vertical-align: inherit;">此引脚对Arduino Mega和Arduino Due有效。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">软件部分</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，让我们从Arduino的草图中找出如何管理所有这些经济性。</font><font style="vertical-align: inherit;">首先，初始化将MT1132模块连接到的Serial1（以标准频率9600完成）：</font></font><br>
<br>
<pre><code class="java hljs">Serial1.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在，主要控制功能的代码为：</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooSendCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> channel, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> format)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> buf[<span class="hljs-number"><span class="hljs-number">12</span></span>];<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>; i++) {<font></font>
    buf[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">85</span></span>;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">1</span></span>] = B01010000;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">2</span></span>] = command;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">3</span></span>] = format;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">5</span></span>] = channel;<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">6</span></span>] = data;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checkSum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; i++) {<font></font>
    checkSum += buf[i];<font></font>
  }<font></font>
<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">10</span></span>] = lowByte(checkSum);<font></font>
  buf[<span class="hljs-number"><span class="hljs-number">11</span></span>] = <span class="hljs-number"><span class="hljs-number">170</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; (<span class="hljs-number"><span class="hljs-number">12</span></span>); i++) {<font></font>
    Serial1.write(buf[i]);<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
原则上，我们甚至不需要知道它是如何工作的，我们可以在“黑匣子”模式或某种API中使用它，并保留一定的接口。</font><font style="vertical-align: inherit;">我们只需要知道如何使用该界面即可。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，只有四个参数-通道，命令，数据和格式。</font><font style="vertical-align: inherit;">您可以按照上述原则阅读该文档的请求，但可以进一步简化我们的任务，并将此接口包装在简单的nooLite设备控制命令中。</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooBind</span></span></span><span class="hljs-function">  </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooUnbind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOn</span></span></span><span class="hljs-function">    </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooOff</span></span></span><span class="hljs-function">   </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch)</span></span></span><span class="hljs-function">         </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nooValue</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{nooSendCommand(ch,  <span class="hljs-number"><span class="hljs-number">6</span></span>, v, <span class="hljs-number"><span class="hljs-number">1</span></span>);}
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
相对复杂的团队只是最后一个，在那里，除了渠道之外，力量水平也被设定。</font><font style="vertical-align: inherit;">草图中还有一些我们现在不讨论的团队，但它们的组成也很容易。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
其实...就是这样！</font><font style="vertical-align: inherit;">没有地方比这容易。</font><font style="vertical-align: inherit;">在代码中，控制命令如下所示：</font></font><br>
<br>
<pre><code class="java hljs">nooBind(ch);<font></font>
nooUnbind(ch);<font></font>
nooOn(ch);<font></font>
nooOff(ch);<font></font>
nooValue(ch, v);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
现在让我们练习练习nooLite电源模块管理。</font><font style="vertical-align: inherit;">因此，我们将功率模块绑定在零通道上：</font></font><br>
<br>
<pre><code class="java hljs">nooBind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功率单元上的LED开始闪烁。</font><font style="vertical-align: inherit;">按下功能块上的按钮-LED停止闪烁-连接了电源块。</font><font style="vertical-align: inherit;">除了零通道，您还可以使用其他任何通道。</font><font style="vertical-align: inherit;">您可以根据需要在草图代码中轻松生成通道号。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
打开灯（如果将灯绑在零通道上，则必须在该通道上发送其命令）：</font></font><br>
<br>
<pre><code class="java hljs">nooOn(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
设置功率（灯的亮度）：</font></font><br>
<br>
<pre><code class="java hljs">nooValue(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这里，您需要说一些有关组建力量级别的规则。功率值不会像人们想象的那样从0更改为255，而是从35更改为155。如果该值大于155，则功率将最大，如果为0，则等效于关闭命令。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这里（以防万一）一个公式，将“标准”值从0转换为100，转化为nooLite模块可以理解的格式：</font></font><br>
<br>
<pre><code class="java hljs">v = x * <span class="hljs-number"><span class="hljs-number">1.2</span></span> + <span class="hljs-number"><span class="hljs-number">34</span></span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此公式，您可以按通常的功率百分比设置灯泡的亮度。</font><font style="vertical-align: inherit;">而且，当然，如果需要非线性调整功率，则可以根据任何定律甚至选择固定值来创建变量v。</font><font style="vertical-align: inherit;">这将在周期的第三部分中进行讨论，届时我们将调整焊接台的加热温度。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
关闭设备：</font></font><br>
<br>
<pre><code class="java hljs">nooOff(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
解开：</font></font><br>
<br>
<pre><code class="java hljs">nooUnbind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
功率单元上的LED开始闪烁。</font><font style="vertical-align: inherit;">我们通过按下电源装置上的按钮来确认去耦。</font><font style="vertical-align: inherit;">就是这样，现在电源已停止响应我们的命令，我们可以再次在nooLite MT1132模块的32个通道中的任何一个上“捕捉”它。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这是完整的草图。</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完整的草图代码</font></font></b><div class="spoiler_text">byte const PIN_TX = 18; // TX PIN (to RX noolite)<br>
byte const PIN_RX = 19; // RX PIN (to TX noolite)<br>
<br>
void nooSendCommand(byte channel, byte command, byte data, byte format) {<br>
 byte buf[12];<br>
<br>
for (byte i = 0; i &lt; 12; i++) {<br>
 buf[i] = 0;<br>
 }<br>
<br>
buf[0] = 85;<br>
 buf[1] = B01010000;<br>
 buf[2] = command;<br>
 buf[3] = format;<br>
 buf[5] = channel;<br>
 buf[6] = data;<br>
<br>
int checkSum = 0;<br>
 for (byte i = 0; i &lt; 10; i++) {<br>
 checkSum += buf[i];<br>
 }<br>
<br>
buf[10] = lowByte(checkSum);<br>
 buf[11] = 170;<br>
<br>
for (byte i = 0; i &lt; (12); i++) {<br>
 Serial1.write(buf[i]);<br>
 }<br>
}<br>
<br>
void nooBind (byte ch) {nooSendCommand(ch, 15, 0, 0);}<br>
void nooUnbind (byte ch) {nooSendCommand(ch, 9, 0, 0);}<br>
<br>
void nooOn (byte ch) {nooSendCommand(ch, 2, 0, 0);}<br>
void nooOff (byte ch) {nooSendCommand(ch, 0, 0, 0);}<br>
void nooTrigger(byte ch) {nooSendCommand(ch, 4, 0, 0);}<br>
void nooCancel (byte ch) {nooSendCommand(ch, 10, 0, 0);}<br>
<br>
void nooUp (byte ch) {nooSendCommand(ch, 3, 0, 0);}<br>
void nooDown (byte ch) {nooSendCommand(ch, 1, 0, 0);}<br>
void nooRevers (byte ch) {nooSendCommand(ch, 5, 0, 0);}<br>
<br>
void nooValue (byte ch, byte v) {nooSendCommand(ch, 6, v, 1);}<br>
<br>
void setup() {<br>
 Serial1.begin(9600);<br>
<br>
/*     <br>
      loop(),    */<br>
<br>
//nooBind(0);<br>
<br>
//nooOn(0);<br>
 //nooOff(0);<br>
 //nooValue(0, 100);<br>
<br>
//nooUnbind(0); <br>
}<br>
<br>
void loop(){<br>
<br>
}<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小计</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
如您所见，</font><font style="vertical-align: inherit;">使用Arduino </font><font style="vertical-align: inherit;">控制</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源模块</font><font style="vertical-align: inherit;">并不复杂</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">相反，控制非常简单：模块通过一根线连接，命令几乎是一种自然的语言-“打开通道0”，“关闭通道1”， “要在通道3上设置50％的功率”真的没有那么简单。</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于那些读到最后的人有奖励</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
就</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在前</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">几天，发布了新版本的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Arduino Mega Server</font></a><font style="vertical-align: inherit;">，编号为0.14，该版本克服了该技术中所有的儿童疾病，并且可以快速，稳定地工作。</font><font style="vertical-align: inherit;">同样的版本包含集成的nooLite仪器控制核心及其全部工作原理，您将从系列“ nooLite无线设备和智能家居（第2部分）”的下一篇文章中学习。</font><font style="vertical-align: inherit;">Arduino Mega服务器。” </font><font style="vertical-align: inherit;">循环</font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的第二</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第四</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分。</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN389067/">https://habr.com/ru/post/zh-CN389067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN389051/index.html">CNET智能家居：小工具测试场</a></li>
<li><a href="../zh-CN389053/index.html">智能家居。脑子</a></li>
<li><a href="../zh-CN389057/index.html">CES 2016：LG和三星宣布推出智能家居</a></li>
<li><a href="../zh-CN389063/index.html">80年代的方形汽车如何由90年代精简</a></li>
<li><a href="../zh-CN389065/index.html">黎明探测器发送了谷神星陨石坑的详细图片</a></li>
<li><a href="../zh-CN389069/index.html">Remix OS是基于Android的多窗口OS，现已可用于PC</a></li>
<li><a href="../zh-CN389071/index.html">对全球导航卫星系统的干扰</a></li>
<li><a href="../zh-CN389073/index.html">Branto ORB：一个几乎神奇的球来控制您的房屋</a></li>
<li><a href="../zh-CN389075/index.html">新年大特卖</a></li>
<li><a href="../zh-CN389077/index.html">Oculus创始人：低功耗PC是虚拟现实普及的主要障碍</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>