<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌦️ 👩‍✈️ 🆕 Passives DNS in den Händen des Analysten 👨🏾‍🏫 👞 👊🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Domain Name System (DNS) ist wie ein Telefonbuch, das benutzerfreundliche Namen wie „ussc.ru“ in IP-Adressen übersetzt. Da DNS-Aktivität in fast a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Passives DNS in den Händen des Analysten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470974/"><p>  Das Domain Name System (DNS) ist wie ein Telefonbuch, das benutzerfreundliche Namen wie „ussc.ru“ in IP-Adressen übersetzt.  Da DNS-Aktivität in fast allen Kommunikationssitzungen vorhanden ist, unabhängig vom Protokoll.  Daher ist die DNS-Protokollierung eine wertvolle Datenquelle für einen Informationssicherheitsspezialisten, mit der er Anomalien erkennen oder zusätzliche Daten über das untersuchte System erhalten kann. </p><br><p> Im Jahr 2004 schlug Florian Weimer eine solche Protokollierungsmethode wie Passives DNS vor, mit der Sie den Verlauf von DNS-Datenänderungen wiederherstellen und indizieren und suchen können, um auf die folgenden Daten zugreifen zu können: </p><br><ul><li>  Domainname </li><li>  IP-Adresse des angeforderten Domainnamens </li><li>  Datum und Uhrzeit der Antwort </li><li>  Antworttyp </li><li>  usw. </li></ul><br><p>  Daten für passives DNS werden von rekursiven DNS-Servern mit integrierten Modulen oder durch Abfangen von Antworten von den für die Zone verantwortlichen DNS-Servern erfasst. </p><br><img src="https://habrastorage.org/webt/zt/vg/gj/ztvggj6s1bxlduk5nfyw7cv0dy4.png" alt="Bild"><br><p>  <i>Abbildung 1. Passives DNS (von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ctovision.com übernommen</a> )</i> </p><a name="habracut"></a><br><p>  Die Besonderheit von Passiv-DNS besteht darin, dass die IP-Adresse des Clients nicht registriert werden muss, um die Privatsphäre der Benutzer zu schützen. </p><br><p>  Derzeit gibt es viele Dienste, die den Zugriff auf passive DNS-Daten ermöglichen: </p><br><div class="scrollable-table"><table><tbody><tr><th></th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DNSDB</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VirusTotal</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Passivetotal</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Krake</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sicherheitstrails</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Umbrella Investigate</a> </th></tr><tr><td>  <b>Firma</b> </td><td>  Weitsichtsicherheit </td><td>  VirusTotal </td><td>  Riskisk </td><td>  SafeDNS </td><td>  Sicherheitstrails </td><td>  Cisco </td></tr><tr><td>  <b>Zugang</b> </td><td>  Auf Anfrage </td><td>  Keine Registrierung erforderlich </td><td>  Kostenlose Registrierung </td><td>  Auf Anfrage </td><td>  Keine Registrierung erforderlich </td><td>  Auf Anfrage </td></tr><tr><td>  <b>API</b> </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td></tr><tr><td>  <b>Kundenverfügbarkeit</b> </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td><td>  Ist vorhanden </td><td>  Fehlt </td><td>  Fehlt </td><td>  Fehlt </td></tr><tr><td>  <b>Starten Sie die Datenerfassung</b> </td><td>  2010 Jahr </td><td>  2013 Jahr </td><td>  2009 Jahr </td><td>  Zeigt nur die letzten 3 Monate an </td><td>  2008 Jahr </td><td>  2006 Jahr </td></tr></tbody></table></div><br><p>  <i>Tabelle 1. Dienste mit Zugriff auf passive DNS-Daten</i> </p><br><h4>  Optionen für die Verwendung von passivem DNS </h4><br><p>  Mit passivem DNS können Sie Verbindungen zwischen Domänennamen, NS-Servern und IP-Adressen herstellen.  Auf diese Weise können Sie Karten der untersuchten Systeme erstellen und Änderungen in einer solchen Karte von der ersten Erkennung bis zum aktuellen Moment verfolgen. </p><br><p>  Passives DNS erleichtert auch die Erkennung von Verkehrsanomalien.  Wenn Sie beispielsweise Änderungen in NS-Zonen und Datensätzen wie A und AAAA verfolgen, können Sie bösartige Websites mithilfe der Fast-Flux-Methode identifizieren, mit der C &amp; C vor Erkennung und Blockierung geschützt wird.  Da legitime Domänennamen (mit Ausnahme derjenigen, die für den Lastenausgleich verwendet werden) ihre IP-Adressen nicht häufig ändern und die meisten legitimen Zonen ihre NS-Server selten ändern. </p><br><p>  Passives DNS ermöglicht es Ihnen im Gegensatz zur direkten Aufzählung von Subdomänen in Wörterbüchern, selbst die exotischsten Domainnamen zu finden, z. B. "222qmxacaiqaaaaazibq4aaidhmbqaaa0undefined7140c0.p.hoff.ru".  Außerdem können Sie manchmal Testbereiche (und gefährdete Bereiche) einer Website, Materialien für Entwickler usw. finden. </p><br><h4>  Untersuchen von Links aus E-Mails mit passivem DNS </h4><br><p>  Derzeit ist Spam eine der Hauptmethoden, mit denen ein Angreifer in den Computer des Opfers eindringt oder vertrauliche Informationen stiehlt.  Versuchen wir, den Link aus einem solchen Brief mithilfe von passivem DNS zu untersuchen, um die Wirksamkeit dieser Methode zu bewerten. </p><br><img src="https://habrastorage.org/webt/ok/er/po/okerponr7oatd6mmgunqldthynk.jpeg" alt="Bild"><br><p>  <i>Abbildung 2. Spam-E-Mail</i> </p><br><p>  Der Link von diesem Brief führte zur Website magnit-boss.rocks, die anbot, automatisch Boni zu sammeln und Geld zu erhalten: </p><br><img src="https://habrastorage.org/webt/f2/i9/cc/f2i9ccb3lrwvrrkkzzcu-tnmxtk.png" alt="Bild"><br><p>  <i>Abbildung 3. Die auf magnit-boss.rocks gehostete Seite</i> </p><br><p>  Um diese Site zu untersuchen, wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Riskiq-API</a> verwendet, die bereits 3 vorgefertigte Clients in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ruby</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rust enthält</a> . </p><br><p>  Zunächst lernen wir den gesamten Verlauf dieses Domainnamens kennen. Dazu verwenden wir den folgenden Befehl: </p><br><p>  <i>pt-client pdns --query magnit-boss.rocks</i> </p><br><p>  Dieser Befehl zeigt Informationen zu allen DNS-Auflösungen an, die diesem Domänennamen zugeordnet sind. </p><br><img src="https://habrastorage.org/webt/m4/wn/f6/m4wnf6telpyggxepwd3fwcqlros.png" alt="Bild"><br><p>  <i>Abbildung 4. Antwort von der Riskiq-API</i> </p><br><p>  Lassen Sie uns die Antwort von der API in eine visuellere Form bringen: </p><br><img src="https://habrastorage.org/webt/fi/jh/dp/fijhdp0-c8csxrlyejytmcydgr4.png" alt="Bild"><br><p>  <i>Abbildung 5. Alle Datensätze aus der Antwort</i> </p><br><p>  Für weitere Untersuchungen wurden IP-Adressen verwendet, an die dieser Domain-Name zum Zeitpunkt des Eingangs des Schreibens 01.08.2019 aufgelöst wurde. Diese IP-Adressen sind die folgenden Adressen 92.119.113.112 und 85.143.219.65. </p><br><p>  Verwenden des Befehls: </p><br><p>  <i>pt-client pdns --query</i> </p><br><p>  Sie können alle Domänennamen abrufen, die diesen IP-Adressen zugeordnet sind. <br>  Die IP-Adresse 92.119.113.112 enthält 42 eindeutige Domänennamen, die in diese IP-Adresse aufgelöst wurden. Darunter befinden sich folgende Namen: </p><br><ul><li>  magnit-boss.club </li><li>  igrovie-avtomaty.me </li><li>  pro-x-audit.xyz </li><li>  zep3-www.xyz </li><li>  usw </li></ul><br><p>  Die IP-Adresse 85.143.219.65 enthält 44 eindeutige Domänennamen, die in diese IP-Adresse aufgelöst wurden. Darunter befinden sich folgende Namen: </p><br><ul><li>  cvv2.name (Website für den Verkauf von Kreditkartendaten) </li><li>  emaills.world </li><li>  www.mailru.space </li><li>  usw </li></ul><br><p>  Verbindungen mit diesen Domainnamen deuten auf Phishing hin, aber wir glauben an gute Leute, also werden wir versuchen, einen Bonus von 332.501,72 Rubel zu erhalten?  Nachdem Sie auf die Schaltfläche „JA“ geklickt haben, werden Sie von der Site aufgefordert, 300 Rubel von der Karte zu übertragen, um das Konto zu entsperren, und zur Eingabe von Daten an as-torpay.info gesendet. </p><br><img src="https://habrastorage.org/webt/em/ng/e-/emnge-q11hjwa-v_km4fekbv5xc.png" alt="Bild"><br><p>  <i>Abbildung 6. Ac-pay2day.net-Homepage</i> </p><br><p>  Es sieht aus wie eine legale Website, es gibt ein https-Zertifikat und auf der Hauptseite wird angeboten, dieses Zahlungssystem mit Ihrer Website zu verbinden, aber leider funktionieren nicht alle Links zur Verbindung.  Dieser Domainname wird in nur 1 IP-Adresse aufgelöst - 190.115.19.74.  Es hat wiederum 1475 eindeutige Domainnamen, die in diese IP-Adresse aufgelöst wurden, einschließlich solcher Namen wie: </p><br><ul><li>  ac-pay2day.net </li><li>  ac-payfit.com </li><li>  as-manypay.com </li><li>  fletkass.net </li><li>  as-magicpay.com </li><li>  usw </li></ul><br><p>  Wie wir sehen können, können Sie mit Passive DNS schnell und effizient Daten über die untersuchte Ressource sammeln und sogar eine Art Fingerabdruck erstellen, mit dem Sie ein ganzes Schema für den Diebstahl personenbezogener Daten vom Eingang bis zur wahrscheinlichen Verkaufsstelle aufdecken können. </p><br><img src="https://habrastorage.org/webt/z_/wc/bc/z_wcbcwwi8zvjfp8zu7eyqbsrik.png" alt="Bild"><br><p>  <i>Abbildung 7. Karte des untersuchten Systems</i> </p><br><p>  Nicht alles ist so rosig, wie wir möchten.  Beispielsweise können solche Untersuchungen bei CloudFlare oder ähnlichen Diensten leicht zum Erliegen kommen.  Die Effektivität der Datenbank hängt stark von der Anzahl der DNS-Abfragen ab, die das Modul durchlaufen, um passive DNS-Daten zu erfassen.  Trotzdem ist passives DNS eine Quelle zusätzlicher Informationen für den Forscher. </p><br><p>  <em>Autor: Spezialist des Uralzentrums für Sicherheitssysteme</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de470974/">https://habr.com/ru/post/de470974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de470954/index.html">Installieren Sie Zimbra OSE 8.8.15 und Zextras Suite Pro unter Ubuntu 18.04 LTS</a></li>
<li><a href="../de470958/index.html">Lebendigkeitssonden in Kubernetes können gefährlich sein</a></li>
<li><a href="../de470962/index.html">JSConf Budapest 2019</a></li>
<li><a href="../de470964/index.html">Holzspielzeug - Inschriften</a></li>
<li><a href="../de470966/index.html">Ken Thompsons Unix-Passwort</a></li>
<li><a href="../de470976/index.html">Song of Ice (Bloody Enterprise) und Flames (DevOps und IaC)</a></li>
<li><a href="../de470978/index.html">Analysten-Marktforschung: Wo studieren sie, welche Tools verwenden sie und wie viel verdienen sie?</a></li>
<li><a href="../de470980/index.html">Die Aufgaben, die Softwareroboter (RPAs) im Bankensektor lösen</a></li>
<li><a href="../de470982/index.html">Analyse von Commits und Pull-Anfragen in Travis CI, Buddy und AppVeyor mit PVS-Studio</a></li>
<li><a href="../de470984/index.html">Analyse von Commits und Pull-Anfragen in Travis CI, Buddy und AppVeyor mit PVS-Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>