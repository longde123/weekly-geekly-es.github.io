<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµ üë®üèø‚Äçü§ù‚Äçüë®üèª üöë IB fakapy 2019 - t√≠pico e n√£o muito üìê üõë ü§òüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Mas n√£o √© chato!" - este √© o lema informal dos funcion√°rios do nosso centro de monitoramento de amea√ßas cibern√©ticas Solar JSOC (e devo dizer que 201...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>IB fakapy 2019 - t√≠pico e n√£o muito</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/484676/"><img src="https://habrastorage.org/webt/o_/ja/qs/o_jaqstiymm03aoz1w6qphpa3zo.jpeg"><br><br>  "Mas n√£o √© chato!" - este √© o lema informal dos funcion√°rios do nosso centro de monitoramento de amea√ßas cibern√©ticas Solar JSOC (e devo dizer que 2019 correspondeu totalmente a ele).  No in√≠cio do ano novo, muitas pessoas gostam de fazer um balan√ßo e estabelecer novas metas, mas decidimos contar alguns ‚Äúhorrores da nossa cidade‚Äù - os casos de 2019, que impressionaram at√© analistas experientes.  A conclus√£o dessas hist√≥rias √© apenas uma: a tecnologia se desenvolve e evolui, e a pregui√ßa, a neglig√™ncia e o descuido s√£o eternos. <br><a name="habracut"></a><br><h2>  Guest Wifi </h2><br>  Ao conectar clientes ao monitoramento, solicitamos antes de tudo as informa√ß√µes mais importantes: contas cr√≠ticas, grupos de dom√≠nios, segmentos n√£o confi√°veis, endere√ßos brancos, DMZ, sub-redes cr√≠ticas, etc.  As sub-redes n√£o confi√°veis ‚Äã‚Äãs√£o apenas Wi-Fi convidado, bem como redes de prestadores de servi√ßos, segmentos de teste com permiss√µes para permitir qualquer, etc. ... Geralmente vemos que a possibilidade de intera√ß√£o com esses segmentos est√° ausente ou seriamente limitada, porque control√°-los muito dif√≠cil, se n√£o imposs√≠vel.  Na rede do cliente, n√£o havia possibilidade de tais intera√ß√µes, exceto a p√°gina de autoriza√ß√£o na rede de convidados.  Acalmamo-nos adicionando uma proibi√ß√£o de interagir do Wi-Fi com os servidores TOR, C&amp;C e outros esp√≠ritos malignos, para que n√£o f√¥ssemos bombardeados com opera√ß√µes pelas quais o cliente em potencial n√£o estava interessado (embora ainda coletemos estat√≠sticas sobre esses incidentes para relat√≥rios resumidos).  E na terceira manh√£ do projeto piloto, notamos uma anomalia: o fluxo de eventos do firewall aumentou 4 vezes! <br><br><img src="https://habrastorage.org/webt/ao/gk/dx/aogkdxypbtzzkbsmbnzzwgnh-yo.png"><br><br>  Eles come√ßaram a procurar a causa do "bloqueio" e, com surpresa, o encontraram no segmento de Wi-Fi convidado.  Um determinado host gerou 4 milh√µes (!) De eventos por hora.  E os eventos s√£o bastante interessantes - conex√µes na porta 445 com endere√ßos brancos aleat√≥rios do espa√ßo da Internet.  Quatro milh√µes, Karl! <br><br><img src="https://habrastorage.org/webt/zi/0s/k1/zi0sk1t0jcyqpybqjlxytrrfs54.png"><br><br>  Tendo informado o cliente sobre isso, eles come√ßaram a aguardar informa√ß√µes sobre o host e o incidente, j√° que o DHCP (√© o servidor de autoriza√ß√£o) n√£o estava conectado ao SIEM.  Ap√≥s cerca de 3-4 horas, o cliente informou que o host √© um telefone celular.  Dizer que ficamos surpresos √© n√£o dizer nada.  Um telefone celular comum n√£o pode gerar esse fluxo de eventos.  Eles come√ßaram a descobrir os detalhes, e o celular n√£o teve nada a ver com isso - algu√©m acabou de usar um dos dispositivos registrados como cobertura.  N√£o foi poss√≠vel encontrar a verdadeira fonte de atividade, e nosso cliente disse que n√£o estava interessado nesse caso, portanto, a atividade teve que ser minimizada.  No entanto, alertamos os especialistas do cliente sobre os poss√≠veis riscos: como a atividade (obviamente maliciosa) prov√©m de seus endere√ßos, eles podem, por exemplo, entrar nas listas de servidores C&amp;C de fornecedores de antiv√≠rus e receber reclama√ß√µes de √≥rg√£os policiais (quem sabe qual infraestrutura esse host verificar√° - afinal, pode haver KII, e a verifica√ß√£o de vulnerabilidades refere-se a incidentes que precisam ser relatados ao GosSOPKA).  Ap√≥s esses argumentos, o cliente ainda decidiu entender com mais detalhes e cumprir nossas recomenda√ß√µes.  E eles eram os seguintes: <br><br><ol><li>  feche todas as portas, exceto 80 e 443 (essa foi a decis√£o certa, porque ap√≥s 445 uma varredura na porta 22 seguiu), </li><li>  introduzimos restri√ß√µes √† velocidade da Internet distribu√≠da, </li><li>  ativar chips UTM, incluindo controle de aplicativos, e cortar categorias estranhas como torrents, navegadores TOR, scanners detectados e muito mais, </li><li>  ative o limite do n√∫mero de conex√µes por intervalo de tempo. </li></ol><br>  O cliente nunca foi capaz de descobrir quem era esse usu√°rio ativo de Wi-Fi, mas pelo menos o bloqueou com oxig√™nio (e, provavelmente, o atacante foi procurar o pr√≥ximo Wi-Fi dispon√≠vel. <br><br>  Alguns meses depois, esse piloto foi fechado e transferido com sucesso para o contrato, mas ainda encontramos casos semelhantes em empresas completamente diferentes, de modo que as recomenda√ß√µes acima podem ser classificadas como universais. <br><br><h2>  Por padr√£o, ou sabotagem de fornecedor </h2><br>  Paralelamente √† conex√£o piloto ao monitoramento Solar JSOC, o cliente encomendou um novo UTM.  A migra√ß√£o para ela foi faseada: primeiro transferiu a ACL pelas sub-redes e depois as pol√≠ticas do aplicativo.  A sobremesa √© a mais interessante. <br><br>  Tudo aconteceu de acordo com os cl√°ssicos - na sexta √† noite.  A primeira linha registrou contratempos no contato com a infraestrutura do cliente para n√≥s TOR, aparecendo como C&amp;C em uma das listas de discuss√£o do FinCERT.  Como o projeto era piloto e o cliente transferiu todos os incidentes para Baixa criticidade, n√£o havia um cart√£o de incidente, al√©m da notifica√ß√£o por correio, um cart√£o de incidente.  Portanto, a primeira opera√ß√£o de hosts diferentes em um endere√ßo, apesar de suscitar suspeitas entre os engenheiros de monitoramento, n√£o foi mais ampliada.  Quando o n√∫mero de viagens chegou a tr√™s, os caras perceberam que algo estava errado e informaram o analista que levou o incidente para o trabalho. <br><br><img src="https://habrastorage.org/webt/92/yj/rb/92yjrbhfw46vr3kuadcpyqsbg10.png"><br><br>  Primeiro, o analista entrou em contato com os funcion√°rios respons√°veis ‚Äã‚Äãdo cliente e sugeriu conectar hosts no n√≠vel do log local para identificar a fonte da atividade.  No momento da discuss√£o com os especialistas do cliente, o n√∫mero de hosts havia aumentado para 7. A situa√ß√£o era muito semelhante √† epidemia, mas o antiv√≠rus nos hosts estava funcionando e silencioso, n√£o havia a√ß√µes ativas e intera√ß√µes de host na rede. <br><br>  A conex√£o de tr√™s hosts no n√≠vel do log local tamb√©m n√£o forneceu um entendimento de qual processo gerou a atividade.  A ansiedade cresceu, a √∫nica op√ß√£o de trabalho foi o isolamento de hosts com a remo√ß√£o paralela de um despejo de RAM e a imagem do disco r√≠gido.  O analista come√ßou a preparar instru√ß√µes e, ao mesmo tempo, decidiu pesquisar o IP que os hosts acessavam para disponibilidade em outras correspond√™ncias e incidentes (porque o tipo de atividade que observamos era diferente daquele descrito no boletim informativo do FinCERT).  Na maioria das vezes, a id√©ia √© bastante infeliz, mas n√£o desta vez. <br><br>  Foi dada aten√ß√£o ao artigo cujo t√≠tulo apareceu o endere√ßo IP e o nome do fornecedor da UTM.  Para resumir a ess√™ncia da publica√ß√£o, o fornecedor comprou um endere√ßo IP que anteriormente pertencia ao n√≥ TOR, que foi apresentado no boletim informativo da FinCERT.  E isso n√£o √© tudo!  Al√©m disso, o fornecedor decidiu tornar esse endere√ßo padr√£o para o redirecionamento de todas as chamadas suspeitas da infraestrutura de seus clientes para endere√ßos potencialmente maliciosos.  Ou seja, qualquer conex√£o com um endere√ßo IP estranho foi interpretada pela UTM como ileg√≠tima e redirecionada para esse endere√ßo milagroso. <br><br><img src="https://habrastorage.org/webt/b4/xg/fu/b4xgfus7ztgevycehvha4zmbmfi.png"><br><br>  Depois de especificar se o m√≥dulo de prote√ß√£o antimalware j√° est√° ativado e ap√≥s receber a confirma√ß√£o, os especialistas em analistas e clientes expiraram. <br><br>  PS A an√°lise das falhas que o UTM detectou confirma que todas as 7 atividades foram falsas positivas. <br><br>  Prometemos recomenda√ß√µes para cada caso, mas aqui, talvez, damos apenas um: n√£o implante na sexta-feira.  E avise todos os interessados ‚Äã‚Äãe simpatizantes. <br><br><img src="https://habrastorage.org/webt/yu/vy/nr/yuvynrtns5tf9j5tv9qo_ze8xl8.jpeg"><br><br><h2>  Historicamente </h2><br>  Este leitmotif re√∫ne uma grande variedade de casos.  Veja o descomissionamento, por exemplo.  Muitas vezes, processos que perderam relev√¢ncia nas empresas s√£o simplesmente esquecidos: ningu√©m ‚Äúanalisa‚Äù a infraestrutura antiga, deixando as antigas m√°quinas virtuais, servidores e acessos √† rede.  Ao mesmo tempo, ningu√©m monitora atualiza√ß√µes, antiv√≠rus e eventos nesses hosts, e mesmo os administradores geralmente n√£o conhecem os propriet√°rios dos sistemas.  Portanto, ap√≥s algum tempo, esses elementos de infraestrutura n√£o apresentam as surpresas mais agrad√°veis.  Quanto custa apenas enviar telemetria significativa de uma organiza√ß√£o ambiental em um projeto conclu√≠do em 2005 para servidores FTP de um pa√≠s n√£o amig√°vel! <br><br>  Muitas vezes, ningu√©m lida com a manuten√ß√£o de sistemas de 10 anos de idade, embora eles continuem sendo usados.  Por exemplo, um portal de redefini√ß√£o de senha que usa o mecanismo antigo e para a conveni√™ncia dos usu√°rios examina a Internet, ou RDP, que o contratado precisa configurar aplicativos de neg√≥cios e se destaca por 5 a 6 anos. <br><br>  A exist√™ncia de tais problemas geralmente se torna conhecida quando: <br><br><ol><li>  o host foi hackeado e a criptografia ocorreu com mais extors√£o (houve muitos desses incidentes recentemente), </li><li>  h√° uma migra√ß√£o de uma solu√ß√£o no per√≠metro para outra, </li><li>  chegamos ao piloto e coletamos o perfil das portas abertas no per√≠metro. </li></ol><br>  Mas tamb√©m existem situa√ß√µes completamente m√≠ticas: em 2013, a empresa construiu um t√∫nel com um contratado atendendo seu sistema financeiro.  O contrato terminou, mas o t√∫nel permaneceu, como foi feito pela empresa da qual o contratado alugou as instala√ß√µes juntamente com a infraestrutura de TI.  Uma nova empresa ocupou o mesmo lugar e ficou surpresa ao encontrar endere√ßos dispon√≠veis da infraestrutura de outras pessoas.  A curiosidade assumiu, e depois a tenta√ß√£o e a sede de lucro.  Eles lan√ßaram um banco de dados de contrapartes e contratos com o barulho - o benef√≠cio da competi√ß√£o foi interessante, mas ningu√©m fez barulho na empresa v√≠tima.  A hist√≥ria durou mais de um ano (n√£o foi poss√≠vel rastrear mais adiante os registros), mas no final, a investiga√ß√£o, as demiss√µes e a cereja no bolo s√£o um caso criminal. <br><br><h2>  AWOL, ou porque √© mais conveniente </h2><br>  O caso como um todo √© bastante trivial, o que n√£o pode ser dito sobre a "metodologia de implementa√ß√£o". <br><br>  Dado: <br><br><ol><li>  projeto piloto de monitoramento de clientes; </li><li>  fontes conectadas no per√≠metro, bem como entre os segmentos corporativo e tecnol√≥gico; </li><li>  administra√ß√£o de plant√£o no local de trabalho e atendimento ao segmento de rede fechada; </li><li>  o desejo agudo do administrador √© trabalhar menos, dormir mais e fazer tudo com conforto. </li></ol><br>  Como eu j√° disse, ao conectar, solicitamos ao cliente informa√ß√µes diferentes, incluindo endere√ßos em branco, para coletar estat√≠sticas sobre as conex√µes a eles da Internet e, assim, formar um perfil de per√≠metro externo.  Depois de criar uma regra que preenche a lista no SIEM, em cerca de uma semana ou duas coletamos estat√≠sticas sobre todas as portas abertas no per√≠metro, descarregamos para o cliente, observamos e corrigimos juntos (ao fechar o que √© ileg√≠timo).  Reunindo informa√ß√µes para o perfil, periodicamente percorremos os olhos pela lista, verificando se as portas estavam abertas para todos ou apenas alguns endere√ßos nas listas brancas.  Chamava-se aten√ß√£o a porta 43388, que n√£o parecia digna de nota, mas foi transmitida em 3389 e o endere√ßo cinza, cujo propriet√°rio era desconhecido para n√≥s na √©poca. <br><br>  Ao verificar, verificou-se que est√° fechado para nossos endere√ßos.  Achamos que ele estava aberto nas listas brancas, mas durante o dia n√£o observamos nenhuma conex√£o bem-sucedida nele.  Chegando na manh√£ seguinte, eles notaram novamente que um pacote de eventos havia chegado da noite para o dia.  Desta vez, examinamos mais atentamente os endere√ßos de origem e vimos v√°rias sess√µes de Moscou com uma dura√ß√£o total de mais de 5 horas e um n√∫mero bastante grande de sess√µes curtas de todo o mundo.  Ent√£o ficou claro que a quest√£o n√£o era que o porto estivesse acess√≠vel apenas aos endere√ßos da lista branca, mas que ele fosse aberto apenas √† noite - das 00:00 √†s 06:00 da manh√£.  Depois de escavar os logs do dom√≠nio e do antiv√≠rus (eles haviam sido conectados naquela √©poca), ficamos surpresos ao descobrir que o endere√ßo pertence ao administrador de plant√£o, que deveria estar no local de trabalho durante esse intervalo de tempo!  Depois de analisar as conex√µes do carro, encontramos outra situa√ß√£o interessante: todas as noites, o porto tamb√©m era aberto (acho que n√£o √© dif√≠cil adivinhar qual) no segmento dedicado fechado.  √â quase imposs√≠vel notar essa atividade no quarto dia do piloto, a essa altura o n√∫mero de conex√µes permitidas entre segmentos ainda √© mais do que portas abertas no per√≠metro.  Depois de informar os guardas de seguran√ßa sobre a situa√ß√£o, eles conectaram o host no n√≠vel do log local e certificaram-se de que o administrador estivesse escapando silenciosamente de casa do trabalho.  Como se viu, ele morava quase em uma casa vizinha, e a conex√£o remota, √© claro, se tornou uma tenta√ß√£o demais. <br><br>  Talvez, se o administrador descrevesse a situa√ß√£o, ele poderia trabalhar remotamente atrav√©s do SKDPU, desde que, no momento do acidente, ele pudesse trabalhar em 15 minutos e n√£o houvesse problemas. <br><br><h2>  Total </h2><br>  Na realidade, uma das principais amea√ßas √† seguran√ßa da informa√ß√£o √© a goivagem no terreno.  Portanto, minimize os riscos: <br><br><ol><li>  Acompanhe as configura√ß√µes de per√≠metro e firewall. </li><li>  Tente fazer o controle remoto em uma empresa gerenciada (VPN atrav√©s de um servidor de terminal).  E se ele j√° existir, controle quem o usa (removendo v√°rios RATs em hosts que agora detectam facilmente quase todos os mecanismos antiv√≠rus). </li><li>  Siga as a√ß√µes de usu√°rios privilegiados: muitas vezes eles perdem a vigil√¢ncia, acreditando que t√™m tudo sob controle e facilitam o acesso dos invasores a dados cr√≠ticos. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484676/">https://habr.com/ru/post/pt484676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484664/index.html">Outro [quase] Trojan inviol√°vel para Android</a></li>
<li><a href="../pt484666/index.html">Novos Dell e Alienware na CES 2020: um breve resumo dos principais an√∫ncios</a></li>
<li><a href="../pt484668/index.html">Vis√£o geral do programa Vis√£o de produto do produto</a></li>
<li><a href="../pt484670/index.html">Antipatterns PostgreSQL: um registro raro chegar√° ao meio de JOIN</a></li>
<li><a href="../pt484672/index.html">Como Hanipotans Deanonymize hackers e golpistas online</a></li>
<li><a href="../pt484678/index.html">Palestras Abertas no JetBrains Research Labs</a></li>
<li><a href="../pt484680/index.html">Tradu√ß√£o do livro de Andrew Un, Passion for Machine Learning, Cap√≠tulo 33</a></li>
<li><a href="../pt484686/index.html">Por que os resistores s√£o indicados pela cor?</a></li>
<li><a href="../pt484688/index.html">Estamos nos aproximando do limite de poder computacional - precisamos de novos programadores</a></li>
<li><a href="../pt484690/index.html">Semin√°rio, confer√™ncia, mitap: estudando as estat√≠sticas de 18.000 eventos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>