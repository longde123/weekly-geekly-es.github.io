<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüé§ ü•ä üëã Toute la v√©rit√© sur RTOS. Article # 14. Sections de m√©moire: introduction et services de base üïù ü§≥üèº üö¥üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Des sections de la m√©moire ont √©t√© mentionn√©es plus t√¥t dans l'un des articles pr√©c√©dents (# 6), o√π une comparaison a √©t√© faite avec la fonction stand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Toute la v√©rit√© sur RTOS. Article # 14. Sections de m√©moire: introduction et services de base</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426425/"><img src="https://habrastorage.org/webt/nh/9i/nk/nh9inkxdyuljdn4wesz0e-lpjhg.jpeg"><br><br>  Des sections de la m√©moire ont √©t√© mentionn√©es plus t√¥t dans l'un des articles pr√©c√©dents (# 6), o√π une comparaison a √©t√© faite avec la fonction standard du langage C <b>malloc ()</b> .  Une partition est une r√©gion de m√©moire obtenue √† partir d'un pool de partitions (pool de m√©moire).  Le partage de m√©moire offre un moyen flexible d'allouer de fa√ßon fiable et d√©terministe et de lib√©rer de la m√©moire. <br><a name="habracut"></a><br>  Articles pr√©c√©dents de la s√©rie: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 13.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Structures de donn√©es de t√¢che et appels d'API non pris en charge</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 12.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Services pour travailler avec des t√¢ches</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 11.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√¢ches: configuration et introduction √† l'API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scheduler: fonctionnalit√©s avanc√©es et pr√©servation du contexte</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 9.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Scheduler: impl√©mentation</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 8.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nucleus SE: conception interne et d√©ploiement</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nucleus SE: Introduction</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Autres services RTOS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interaction et synchronisation des t√¢ches</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√¢ches, changement de contexte et interruptions</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">T√¢ches et planification</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RTOS: Structure et mode temps r√©el</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article # 1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RTOS: introduction.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a> <br><h2>  Utilisation de sections </h2><br>  Dans Nucleus SE, les pools de partitions sont configur√©s au moment de la cr√©ation.  Une seule application peut avoir jusqu'√† 16 pools de partitions.  S'ils ne sont pas configur√©s, les structures de donn√©es et les appels de service li√©s √† ces pools ne seront pas inclus dans l'application. <br><br>  Un pool de partitions est une zone m√©moire divis√©e en un certain nombre de blocs de taille fixe.  Le d√©veloppeur a un contr√¥le total sur la taille et le nombre de partitions dans chaque pool.  Les t√¢ches peuvent demander des sections de m√©moire allou√©es et recevoir un pointeur vers la zone de stockage et ne doivent pas √©crire de donn√©es en dehors de la section allou√©e.  Une section peut √™tre lib√©r√©e par n'importe quelle t√¢che lors du passage d'un pointeur vers une fonction API.  Une demande d'allocation d'une partition en l'absence de partitions libres peut entra√Æner une erreur ou une suspension de la demande, selon les param√®tres d'appel API s√©lectionn√©s et la configuration de Nucleus SE. <br><br><h2>  Configuration de partitions de m√©moire </h2><br><h3>  Nombre de pools de partitions </h3><br>  Comme pour la plupart des objets Nucleus SE, la configuration du pool de partitions se fait principalement √† l'aide de la directive <b>#define</b> dans <b>nuse_config.h</b> .  Le param√®tre principal est <b>NUSE_PARTITION_POOL_NUMBER</b> , qui d√©termine le nombre de pools de partitions d√©finis dans l'application.  La valeur par d√©faut est 0 (c'est-√†-dire que les pools de partitions ne sont pas utilis√©s), le d√©veloppeur peut d√©finir n'importe quelle valeur de 0 √† 16. D'autres valeurs entra√Æneront une erreur de compilation, qui a √©t√© d√©tect√©e lors de la v√©rification dans <b>nuse_config_check.h</b> (elle est incluse dans <b>nuse_config.c</b> , et , donc, compile avec ce module), ce qui conduit √† la compilation de la directive <b>#error</b> . <br><br>  Le choix d'une valeur diff√©rente de z√©ro est un moyen prioritaire d'activer les pools de partitions.  Cela conduit √† la d√©finition des structures de donn√©es et √† l'attribution de la taille appropri√©e.  Les structures de donn√©es dans la ROM doivent √™tre initialis√©es avec les valeurs appropri√©es qui d√©crivent chaque pool de partitions.  Plus de d√©tails sur les structures de donn√©es seront dans le prochain article.  Cette s√©lection active √©galement les param√®tres de l'API. <br><br><h3>  Activer les appels API </h3><br>  Chaque fonction API (appel d'utilitaire) dans Nucleus SE est activ√©e par la directive <b>#define</b> dans <b>nuse_config.h</b> .  Pour les pools de partitions, ceux-ci incluent: <br><br>  <b>NUSE_PARTITION_ALLOCATE</b> <br>  <b>NUSE_PARTITION_DEALLOCATE</b> <br>  <b>NUSE_PARTITION_POOL_INFORMATION</b> <br>  <b>NUSE_PARTITION_POOL_COUNT</b> <br><br>  Par d√©faut, ils sont tous d√©finis sur <b>FALSE</b> , d√©sactivant ainsi chaque appel de service et emp√™chant l'inclusion d'un code d'impl√©mentation.  Pour configurer les pools de partitions dans l'application, vous devez s√©lectionner les appels d'API n√©cessaires et d√©finir les directives correspondantes sur <b>TRUE</b> . <br><br>  Ce qui suit est un extrait du fichier <b>nuse_config.h</b> par d√©faut: <br><br><img src="https://habrastorage.org/webt/gm/ih/_b/gmih_baxfyopw1op4ujx2t2fzue.jpeg"><br><br>  Si la fonction API Partition Pools est activ√©e, mais que les pools ne sont pas configur√©s, une erreur de compilation se produit (√† l'exception de <b>NUSE_Partition_Pool_Count ()</b> , qui est toujours activ√©).  Si votre code utilise un appel d'API qui n'a pas √©t√© activ√©, une erreur de mise en page se produira car le code d'impl√©mentation n'a pas √©t√© inclus dans l'application. <br><br><h2>  Appels de l'utilitaire du pool de partitions </h2><br>  Nucleus RTOS prend en charge sept appels d'utilitaires li√©s aux pools de partitions, qui offrent les fonctionnalit√©s suivantes: <br><br><table><tbody><tr><th>  <b>Description fonctionnelle</b> </th><th>  <b>Nucleus RTOS</b> </th><th>  <b>Nucleus SE</b> </th></tr><tr><td>  S√©lection de section </td><td>  <b>NU_Allocate_Partition ()</b> </td><td>  <b>NUSE_Partition_Allocate ()</b> </td></tr><tr><td>  Communiqu√© de section </td><td>  <b>NU_Deallocate_Partition ()</b> </td><td>  <b>NUSE_Partition_Deallocate ()</b> </td></tr><tr><td>  Fournir des informations <br>  √† propos d'un pool de partitions particulier </td><td>  <b>NU_Partition_Pool_Information ()</b> </td><td>  <b>NUSE_Partition_Pool_Information ()</b> </td></tr><tr><td>  Renvoie la valeur de la quantit√© (actuellement) configur√©e <br>  pools d'applications </td><td>  <b>NU_Established_Partition_Pools ()</b> </td><td>  <b>NUSE_Partition_Pool_Count ()</b> </td></tr><tr><td>  Ajout (cr√©ation) d'un nouveau pool de partitions √† l'application </td><td>  <b>NU_Create_Partition_Pool ()</b> </td><td>  Non impl√©ment√©. </td></tr><tr><td>  Modification (suppression) d'un pool de partitions d'une application </td><td>  <b>NU_Delete_Partition_Pool ()</b> </td><td>  Non impl√©ment√©. </td></tr><tr><td>  Renvoyer des pointeurs vers tous les pools de partitions existants dans l'application </td><td>  <b>NU_Partition_Pool_Pointers ()</b> </td><td>  Non impl√©ment√©. </td></tr></tbody></table><br>  La mise en ≈ìuvre de chaque appel sera discut√©e en d√©tail. <br><br>  Il convient de noter que ni Nucleus RTOS ni Nucleus SE n'ont de fonction de red√©marrage.  Cela se fait expr√®s.  Tr√®s souvent, une t√¢che alloue une section et transmet un pointeur √† une autre t√¢che (qui peut ensuite la lib√©rer).  Si vous rechargez le pool de partitions, toutes les partitions seront marqu√©es comme inutilis√©es, cependant, il n'existe aucun m√©canisme pour surveiller et notifier toutes les t√¢ches pouvant utiliser des partitions. <br><br><h2>  Services de partition et de lib√©ration </h2><br>  Les op√©rations fondamentales avec les pools de partitions sont l'allocation des partitions dans le pool (c'est-√†-dire marquer la partition comme utilis√©e et renvoyer son adresse) et lib√©rer la partition (c'est-√†-dire que la partition est marqu√©e comme non utilis√©e).  Nucleus RTOS et Nucleus SE fournissent deux appels d'API de base pour ces op√©rations, qui sont d√©crits ci-dessous. <br><br><h3>  S√©lection de section </h3><br>  L'appel de l'API RTOS Nucleus pour allouer une partition est tr√®s flexible, ce qui permet aux d√©veloppeurs de suspendre les t√¢ches pendant une p√©riode ind√©finie ou sans d√©lai si l'op√©ration ne peut pas √™tre termin√©e imm√©diatement, par exemple, lorsque vous essayez d'allouer une partition √† partir d'un pool dans lequel toutes les partitions sont d√©j√† distribu√©es.  Nucleus SE fournit le m√™me service, seules les t√¢ches de pause sont facultatives et aucun d√©lai d'attente n'est impl√©ment√©. <br><br><h3>  Appel √† la partition de l'API Nucleus RTOS </h3><br>  Prototype d'appel: <br><br>  <b>STATUS NU_Allocate_Partition (pool NU_PARTITION_POOL *, VOID ** return_pointer, suspension UNSIGNED);</b> <br><br>  Valeur de retour: <br><br>  <b>NU_SUCCESS</b> - l'appel s'est termin√© avec succ√®s; <br>  <b>NU_NO_PARTITION</b> - aucune section n'est disponible; <br>  <b>NU_INVALID_POOL</b> - pointeur de pool de partitions non valide; <br>  <b>NU_INVALID_POINTER</b> - a pass√© un pointeur nul aux donn√©es retourn√©es ( <b>NULL</b> ); <br>  <b>NU_INVALID_SUSPEND</b> - une tentative de suspension d'une t√¢che a √©t√© effectu√©e √† partir d'un thread non associ√© √† la t√¢che; <br>  <b>NU_TIMEOUT</b> - aucune partition n'est disponible, m√™me apr√®s suspension pour la p√©riode d'attente sp√©cifi√©e; <br>  <b>NU_POOL_DELETED</b> - Le pool de partitions a √©t√© supprim√© lorsque la t√¢che a √©t√© suspendue. <br><br><h3>  Appel de l'API Nucleus SE pour mettre en surbrillance une partition </h3><br>  Cet appel d'API prend en charge la fonctionnalit√© principale de l'API Nucleus RTOS. <br><br>  Prototype d'appel: <br><br>  <b>STATUS NUSE_Partition_Allocate (pool NUSE_PARTITION_POOL, ADDR * return_pointer, U8 suspend);</b> <br><br>  Param√®tres: <br><br>  <b>pool</b> - index (ID) du pool de partitions utilis√©; <br>  <b>return_pointer</b> - pointeur vers une variable de type <b>ADDR</b> , qui prend l'adresse de la section s√©lectionn√©e; <br>  <b>suspend</b> - param√®tre pour <b>suspendre</b> la t√¢che; il peut prendre les valeurs <b>NUSE_NO_SUSPEND</b> ou <b>NUSE_SUSPEND</b> . <br><br>  Valeur de retour: <br><br>  <b>NUSE_SUCCESS</b> - l'appel s'est termin√© avec succ√®s; <br>  <b>NUSE_NO_PARTITION</b> - aucune section n'est disponible; <br>  <b>NUSE_INVALID_POOL</b> - index de pool de partitions non valide; <br>  <b>NUSE_INVALID_POINTER</b> - a pass√© un pointeur nul aux donn√©es retourn√©es ( <b>NULL</b> ); <br>  <b>NUSE_INVALID_SUSPEND: une</b> tentative de suspension d'une t√¢che a √©t√© effectu√©e √† partir d'un thread qui n'√©tait pas associ√© √† la t√¢che ou lorsque les API de verrouillage ont √©t√© d√©sactiv√©es. <br><br><h3>  Impl√©mentation de l'allocation de partition dans Nucleus SE </h3><br>  Le code de fonction API <b>NUSE_Partition_Allocate</b> est s√©lectionn√© √† l'aide de la compilation conditionnelle apr√®s v√©rification des param√®tres, selon que l'appel API √† bloquer (suspendre les t√¢ches) est activ√© ou non.  Ci-dessous, nous examinerons s√©par√©ment ces deux options. <br><br>  Si les appels de blocage sont d√©sactiv√©s, l'appel d'API est assez simple: <br><br><img src="https://habrastorage.org/webt/se/0i/fx/se0ifxxbybhe2mjp5owlfc2zrr0.jpeg"><br><br>  Tout d'abord, la disponibilit√© des partitions gratuites est v√©rifi√©e.  S'il n'y a pas de telles partitions, une erreur est renvoy√©e ( <b>NUSE_NO_PARTITION</b> ).  Ensuite, il y a une √©num√©ration des sections, au cours de laquelle les premiers octets sont v√©rifi√©s pour des valeurs nulles (ce qui indique que la section n'est pas utilis√©e).  Lorsqu'une telle partition est trouv√©e, elle se voit attribuer l'indicateur ¬´utilis√©¬ª, qui inclut l'index du pool de partitions (voir ¬´Lib√©rer la partition¬ª ci-dessous), et renvoie un pointeur sur l'octet suivant (le d√©but de la zone de donn√©es r√©elles).  Des explications sur les structures de donn√©es des pools de partitions seront pr√©sent√©es dans l'article suivant de la section Structures de donn√©es. <br><br>  Si le verrouillage est activ√©, le code de cet appel API devient un peu plus compliqu√©: <br><br><img src="https://habrastorage.org/webt/y_/os/bd/y_osbdsgsaqfon1cm0351zzxbxq.jpeg"><br><br>  Le code est enferm√© dans une <b>boucle do ... while</b> , qui continue de s'ex√©cuter tant que le param√®tre de pause est <b>NUSE_SUSPEND</b> . <br><br>  Si aucune partition n'est disponible et que le param√®tre de pause est <b>NUSE_NO_SUSPEND</b> , l'appel d'API s'arr√™te et renvoie <b>NUSE_NO_PARTITION</b> .  Si le param√®tre de pause a √©t√© d√©fini sur <b>NUSE_SUSPEND</b> , la t√¢che se met en pause.  Lors du retour (par exemple, lorsqu'une t√¢che reprend), la valeur de retour de <b>NUSE_SUCCESS</b> indique que la t√¢che a √©t√© reprise car la section m√©moire a √©t√© lib√©r√©e et le code retourne au d√©but de la boucle.  Comme il n'y a pas de fonctions API pour recharger les pools de partitions, les t√¢ches ne peuvent pas √™tre reprises pour d'autres raisons, mais pour la stabilit√© du blocage d'autres types d'objets, le processus de validation <b>NUSE_Task_Blocking_Return []</b> est conserv√©. <br><br><h3>  Communiqu√© de section </h3><br>  La sortie de la section dans Nucleus RTOS et Nucleus SE la rend √† nouveau disponible.  Avant la publication, il ne v√©rifie pas si cette section est utilis√©e par une t√¢che ou non, le programmeur d'application en est responsable.  Seul un pointeur vers une zone de donn√©es est requis pour lib√©rer une section. <br><br><h3>  Appel de l'API Nucleus RTOS √† la partition gratuite </h3><br>  Prototype d'appel: <br><br>  <b>STATUS NU_Deallocate_Partition (partition VOID *);</b> <br><br>  Param√®tres: <br><br>  <b>partition</b> - un pointeur vers la zone de donn√©es (retourn√©e par la fonction <b>NU_Allocate_Partition ()</b> ) de la partition √† lib√©rer; <br><br>  Valeur de retour: <br><br>  <b>NU_SUCCESS</b> - l'appel s'est termin√© avec succ√®s; <br>  <b>NU_INVALID_POINTER</b> - Pointeur de section NULL ou n'indique pas une section valide utilis√©e. <br><br><h3>  Appel de l'API Nucleus SE pour lib√©rer la partition </h3><br>  Cet appel d'API prend en charge la fonctionnalit√© principale de l'API Nucleus RTOS. <br><br>  Prototype d'appel: <br><br>  <b>STATUS NUSE_Partition_Deallocate (partition ADDR);</b> <br><br>  Param√®tres: <br><br>  <b>partition</b> - un pointeur vers la zone de donn√©es (retourn√©e par la fonction <b>NUSE_Partition_Allocate ()</b> ) de la partition √† lib√©rer <br><br>  Valeur de retour: <br><br>  <b>NUSE_SUCCESS</b> - l'appel s'est termin√© avec succ√®s; <br>  <b>NUSE_INVALID_POINTER</b> - le pointeur de section est nul ( <b>NULL</b> ) ou n'indique pas une section valide utilis√©e <br><br><h3>  Impl√©mentation </h3><br>  Au lieu d'impl√©menter √† l'aide des fonctions API bloquantes et non bloquantes, la fonction <b>NUSE_Partition_Deallocate ()</b> contient simplement une section compil√©e conditionnellement qui est responsable du d√©verrouillage des t√¢ches.  Ce code impl√©mente la lib√©ration des sections: <br><br><img src="https://habrastorage.org/webt/sz/ro/zl/szrozlvg_xc8hbpeqmthmmdbm7a.jpeg"><br><br>  Tout d'abord, l'index de section est extrait de l'octet d'√©tat.  Ensuite, l'√©tat de la partition passe √† "inutilis√©", le compteur des partitions utilis√©es diminue et la fonction signale la r√©ussite de l'op√©ration. <br><br>  Si le verrouillage est activ√©, le code suivant est utilis√© pour reprendre les t√¢ches en attente du pool de partitions disponible: <br><br><img src="https://habrastorage.org/webt/9k/jm/3w/9kjm3wbdcj1lj6ruhimnhm67xva.jpeg"><br><br>  Si des t√¢ches ont √©t√© bloqu√©es lors de l'allocation de partitions dans ce pool, la premi√®re table reprend. <br><br>  Dans le prochain article, nous parlerons des appels d'API suppl√©mentaires li√©s aux partitions de m√©moire, ainsi que des structures de donn√©es associ√©es. <br><br>  <b>√Ä propos de l'auteur:</b> Colin Walls travaille dans l'industrie √©lectronique depuis plus de trente ans, consacrant la majeure partie de son temps au micrologiciel.  Il est maintenant ing√©nieur firmware chez Mentor Embedded (une division de Mentor Graphics).  Colin Walls intervient souvent lors de conf√©rences et s√©minaires, auteur de nombreux articles techniques et de deux livres sur le firmware.  Vit au Royaume-Uni. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426425/">https://habr.com/ru/post/fr426425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426415/index.html">Fintech-digest: contr√¥le de la digitalisation par la Banque Centrale, salaire de crypto-monnaie, carte Mir sous forme de bracelets et porte-cl√©s</a></li>
<li><a href="../fr426417/index.html">Pavel 2.0: consultant reptiloid sur JS, node.js avec sockets et t√©l√©phonie</a></li>
<li><a href="../fr426419/index.html">Surcharge interdite ou m√©thodes de pontage en Java</a></li>
<li><a href="../fr426421/index.html">EHCI humainement en russe</a></li>
<li><a href="../fr426423/index.html">mmWave sur smartphones: comment Qualcomm a rendu possible l'impossible</a></li>
<li><a href="../fr426427/index.html">Des trucs utiles pour "bourrer": une petite s√©lection √† petits prix</a></li>
<li><a href="../fr426429/index.html">Installation de FreeSWITCH 1.8 sur Debian 9 (Raspbian Stretch, l'image de base du syst√®me Smart Home de MajorDoMo sur Rasbperri Pi)</a></li>
<li><a href="../fr426431/index.html">D√©montage du moteur de roman visuel Qlie</a></li>
<li><a href="../fr426433/index.html">D√©licieux SMM pour le restaurant</a></li>
<li><a href="../fr426435/index.html">Les meilleurs sp√©cialistes sont ceux que j'ai pr√©par√©s moi-m√™me: un cours de test de jeu par des experts du groupe Mail.Ru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>