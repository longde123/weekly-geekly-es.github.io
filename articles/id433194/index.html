<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦊 👩‍👩‍👧 💪🏼 Lampu malam yang dijadwalkan ✖️ 🚶🏿 🌱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dengan kelahiran seorang anak, muncul pertanyaan tentang lampu malam. Di suatu tempat mereka membaca bahwa perlu untuk tidur nyenyak. Cepat digunakan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lampu malam yang dijadwalkan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433194/"><img src="https://habrastorage.org/webt/nf/ev/13/nfev13d1ijvairxa-ebeg7ng7am.jpeg" alt="gambar"><br><br>  Dengan kelahiran seorang anak, muncul pertanyaan tentang lampu malam.  Di suatu tempat mereka membaca bahwa perlu untuk tidur nyenyak.  Cepat digunakan untuk tidur dengan cahaya redup.  Sangat nyaman untuk bangun dari jeritan dan lolongan di tengah malam dan melihat apa yang dikeluhkan bayi (jika Anda bisa mengerti).  Selain itu, dalam cahaya redup, Anda dapat bergoyang, membalik dan terus tidur. <br><br>  Awalnya, sampel uji lampu dibuat dari sepotong strip LED kuning (12 volt), yang digunakan selama 1,5 tahun. <br><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/an/hw/kd/anhwkdovnnwhdziqqhhbcxr0hbc.jpeg" alt="gambar"><br><br>  Selain desain yang tipis, setiap pagi mulai mengganggu untuk melepas unit catu daya dari stopkontak.  Saya bangun di pagi hari, cukup cahaya memasuki ruangan dari jalan.  Dengan demikian, lampu terbuang sia-sia selama beberapa jam setiap hari.  Sekali lagi, dalam setengah tahun, pengontrol pita RGB Cina melupakan pengaturan saat ini dan perlu mencari panel kontrol untuk mengingatkannya cara bekerja.  Saya memutuskan untuk membuat lampu baru dengan shutdown otomatis, dengan penyesuaian warna menggunakan potensiometer dan radio. <br><br>  Cepat membuat prototipe berdasarkan arduino nano.  Fungsi dasar debug. <br><br><img src="https://habrastorage.org/webt/fb/jy/xu/fbjyxu7k6vr2uk2wa66e2oc58yy.jpeg" alt="gambar"><br><br>  Saya mengambil kesempatan ini untuk mencoba Fritzing.  Saya tidak menyukainya, tetapi gambarnya jelas dan "lucu".  Rupanya tidak ada yang baru ditemukan. <br><br><img src="https://habrastorage.org/webt/el/8v/pr/el8vprz7g0kiuxlvu61ac184t7a.jpeg" alt="gambar"><br><br>  Mengganti "nano" dengan modul yang sedikit diketahui, kompatibel dengan Arduino dengan transceiver radio built-in (pengontrol 8-bit, kinerja, dan isian sebanding dengan "Nana").  Di rumah, saya sudah memiliki satu perangkat yang beroperasi pada frekuensi 868 MHz, ini akan menjadi yang kedua.  Spesifikasi singkat dari situs web pabrikan: <br><br><div class="spoiler">  <b class="spoiler_title">Karakteristik singkat</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jq/6n/c-/jq6nc-tmx6s5s1xlln6t9bm1m8u.png" alt="gambar"><br></div></div><br><br><img src="https://habrastorage.org/webt/gu/1d/rl/gu1drlc_2banpoqihqjrlsiawms.jpeg" alt="gambar"><br><br>  Saya tidak melihat masalah besar melakukan hal yang sama pada ESP8266 (ada kolektor firmware online yang nyaman untuk skrip pada LUA).  Sedikit lebih rumit pada Bluetooth (untuk menginstal modul HM-10 Anda membutuhkan programmer yang murah, lingkungan pengembangan dan pemahaman protokol).  Meskipun Anda dapat menggunakan modul Bluetooth dengan Arduino.  Tapi saya menggunakan ZUNo, karena telah lama dan menunggu saya, dan seluruh infrastruktur siap untuk menghubungkan dan mengelola perangkat serupa ke dalam satu jaringan (saya berbicara tentang pengontrol jaringan rumah pintar). <br>  Untuk semua kaki yang digunakan pada arduino, analog ditemukan dalam modul. <br><br><img src="https://habrastorage.org/webt/yl/e1/nw/yle1nwmi36wleu53yyx6lunkr0y.png" alt="gambar"><br><br>  Untuk bekerja dengan modul dari Arduino IDE, Anda perlu mengkonfigurasinya (deskripsi pengaturan ada di situs web produsen).  Tidak ada keajaiban yang terjadi.  Ketika mencoba mengkompilasi, saya mendapatkan kesalahan "tidak mendukung" untuk "pernyataan dengan kolom kosong atau tanpa badan!"  Saya menggunakan perpustakaan Adafruit_NeoPixel.  Saya naik ke dalamnya, melihat berapa banyak siklus di dalamnya dan menutupnya.  Saya harus pergi lagi ke situs web produsen dan mencari contoh bekerja dengan LED (sebuah contoh dengan cepat ditemukan).  Jadi saya bukan orang pertama yang mengalami masalah serupa. <br><br>  Agar lampu ini dikendalikan oleh radio dalam kode Arduino, Anda perlu menambahkan makro dan mengimplementasikan beberapa fungsi: <br><br><pre><code class="cpp hljs">ZUNO_SETUP_CHANNELS( ZUNO_SWITCH_MULTILEVEL(getRed, setRed), ZUNO_SWITCH_MULTILEVEL(getGreen, setGreen), ZUNO_SWITCH_MULTILEVEL(getBlue, setBlue), ZUNO_SWITCH_BINARY(switch_getter, switch_setter) );</code> </pre> <br>  Makro ini menjelaskan perangkat Z-Wave dengan tiga sakelar multi-level (kontrol RGB) dan satu sakelar sederhana (on / off sederhana). <br><br>  Saya memiliki implementasi fungsi yang paling sederhana (seperti pada contoh di situs web pabrikan).  Anda dapat melihatnya di daftar terlampir. <br><br><h3>  <b>Pemilihan kasus</b> </h3><br>  Saya sudah punya kasing.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Disegel dengan penutup transparan</a> .  Di bawah tutupnya pas 25 LED.  Tes berhasil.  Lampu memiliki margin kecerahan yang besar untuk kamar saya.  Penutup case ini transparan, jadi saya memutuskan untuk meredakan sedikit cahaya. <br><br><img src="https://habrastorage.org/webt/eb/dn/a2/ebdna25kb2xg3dedtuhpib2k8qe.jpeg" alt="gambar"><br><br>  Manik-manik berwarna sketsa dan kubus akrilik, diisi dengan epoksi transparan.  Cat dari manik-manik berwarna larut di bawah pengaruh resin. <br><br><img src="https://habrastorage.org/webt/kq/gh/dn/kqghdnnc4qp4dcxa058oun_zwb4.jpeg" alt="gambar"><br><br>  Yang paling menarik adalah tutup dari rumah yang tertutup rapat bocor dan hampir semua resin bocor.  Saya tidak tahu di mana saya berhasil mengenai tutupnya, tetapi setelah pengeringan retakan terlihat jelas. <br><br><img src="https://habrastorage.org/webt/1h/aa/aq/1haaaqrcyeoacbznogmwonzgb8g.jpeg" alt="gambar"><br><br>  Papan sirkuit tercetak dibuat dengan metode fotoresistif. <br><br><img src="https://habrastorage.org/webt/me/3w/th/me3wthtnt9ybhvyzc3v_-nhvy0o.jpeg" alt="gambar"><br><br><img src="https://habrastorage.org/webt/oa/kh/vl/oakhvltkcldrtlncqd8kwkub_ms.jpeg" alt="gambar"><br><br>  Setelah pengawetan dan pengerjaan mesin <br><br><img src="https://habrastorage.org/webt/yh/oy/zy/yhoyzyalmtvzihrg_adlie0l0k0.jpeg" alt="gambar"><br><br>  Modul dengan mikrokontroler digantikan oleh prototipe-nya, yang tergeletak di lemari (karena itu tidak disayangkan, tetapi ZUNo perlu dilindungi).  Versi pertama ZUNo, tetapi dimensinya lebih besar dan lebih buruk dari antena, dan Anda belum dapat membelinya.  Tes kurang lebih berhasil.  Segmen terakhir harus disolder ulang.  Awalnya disolder ke sisi yang salah.  Dan sesuaikan jumlah LED dalam firmware. <br><br><img src="https://habrastorage.org/webt/_j/wd/ys/_jwdyskx5_cwxqkea6xt7jbkjqk.jpeg" alt="gambar"><br><br><img src="https://habrastorage.org/webt/gx/qc/qa/gxqcqaaas0qbg7gy54ysyzofbnu.jpeg" alt="gambar"><br><br>  Inilah yang terjadi: <br><br><img src="https://habrastorage.org/webt/i7/fb/0u/i7fb0ul-f1kejvabyxrbhzmkcea.jpeg" alt="gambar"><br><br><h3>  <b>Kontrol radio</b> </h3><br>  Jendela utama dengan saluran kontrol lampu <br><br><img src="https://habrastorage.org/webt/zj/r_/_0/zjr__02hc4it_fasqf-qkhi0gle.png" alt="gambar"><br><br>  Sesuaikan kecerahan satu saluran strip LED <br><br><img src="https://habrastorage.org/webt/1b/80/ho/1b80hohb7oaxhwyyzga6k5osnw0.png" alt="gambar"><br><br>  Mengatur mematikan lampu malam di pagi hari <br><br><img src="https://habrastorage.org/webt/yx/ar/ua/yxaruahy9rj26onaqu6tbo2uu5a.png" alt="gambar"><br><br><h3>  <b>Kesimpulan</b> </h3><br>  Perangkat berfungsi.  Ini kompak dan rapi.  Ini didukung oleh pengisian daya ponsel. <br>  Dari masalah yang diperhatikan: <br><br><ul><li>  selama perakitan, sobek sebagian trek pada resistor variabel, jadi dalam mode manual Anda hanya dapat mengontrol satu saluran. </li><li>  hanya 20 dari 25 LED yang berfungsi normal. Saya punya banyak hal, jadi saya kemungkinan besar akan membiarkannya mengidentifikasi kekurangan yang lebih serius. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Sketsa lampu malam</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ZUNO_NeoPixel.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAX_PIXELS 20 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// NB! Z-Uno can not control more than 25 WS2811 without harming RF communications #define PIXEL_SIZE 3 // Three colors per pixel #define BUFF_SIZE (MAX_PIXELS * PIXEL_SIZE) byte pixel_buff[BUFF_SIZE]; NeoPixel pixels(pixel_buff, BUFF_SIZE); #define B_PRESSED 1 #define BUTTON_PIN 1 // Digital IO pin connected to the button. This will be #define DEF_RED 30 #define DEF_GREEN 20 byte red = DEF_RED; byte green = DEF_GREEN; byte blue = 0; #define POWER_ON 1 #define POWER_OFF 0 byte light_power = POWER_ON; byte last_light_power = POWER_OFF; ZUNO_SETUP_CHANNELS( ZUNO_SWITCH_MULTILEVEL(getRed, setRed), ZUNO_SWITCH_MULTILEVEL(getGreen, setGreen), ZUNO_SWITCH_MULTILEVEL(getBlue, setBlue), ZUNO_SWITCH_BINARY(switch_getter, switch_setter) ); void switch_setter(byte value) { Serial.println("switch"); Serial.print("value= "); Serial.println(value); if(value &gt; 1) light_power = POWER_ON; else light_power = POWER_OFF; } byte switch_getter() { return light_power; } int getRed() { return red/2.56; } int getGreen() { return green/2.56; } int getBlue() { return blue/2.56; } void setRed(byte value) { red = value * 2,56; for(uint8_t i = 0; i &lt; MAX_PIXELS; i++) pixels.setPixelColor(i, pixels.Color(red, green, blue)); pixels.show(); Serial.print("set red = "); Serial.println(value); } void setGreen(byte value) { green = value * 2,56; for(uint8_t i = 0; i &lt; MAX_PIXELS; i++) pixels.setPixelColor(i, pixels.Color(red, green, blue)); pixels.show(); Serial.print("set red = "); Serial.println(value); } void setBlue(byte value) { blue = value * 2,56; for(uint8_t i = 0; i &lt; MAX_PIXELS; i++) pixels.setPixelColor(i, pixels.Color(red, green, blue)); pixels.show(); Serial.print("set red = "); Serial.println(value); } void set_LEDS() { for(uint8_t i = 0; i &lt; MAX_PIXELS; i++) pixels.setPixelColor(i, pixels.Color(red, green, blue)); pixels.show(); } void read_resistors() { red = (analogRead(A0) &gt;&gt; 2) &amp; 0xff; green = (analogRead(A1) &gt;&gt; 2) &amp; 0xff; blue = (analogRead(A3) &gt;&gt; 2) &amp; 0xff; Serial.print(red); Serial.print(" "); Serial.print(green); Serial.print(" "); Serial.print(blue); Serial.print(" "); Serial.println(); set_LEDS(); } #define DEBOUNCE_ACK 10 byte check_button() { static bool oldState = HIGH; byte debounce_cnt = 0; static byte ret = 0; if(digitalRead(BUTTON_PIN) == LOW) { if(ret != B_PRESSED) while(digitalRead(BUTTON_PIN) == LOW) { if(debounce_cnt == DEBOUNCE_ACK) { ret = B_PRESSED; break; } else debounce_cnt++; delay(10); } } else { debounce_cnt = 0; ret = 0; } return ret; } void setup() { Serial.begin(9600); pixels.begin(); pixels.clear(); pinMode(BUTTON_PIN, INPUT_PULLUP); } void loop() { if(check_button() == B_PRESSED) read_resistors(); if(last_light_power != light_power) { Serial.println("set power"); if(light_power == POWER_OFF) { Serial.println("power off"); red = 0; green = 0; blue = 0; } else { Serial.println("power on"); red = DEF_RED; green = DEF_GREEN; blue = 0; } set_LEDS(); last_light_power = light_power; } }</span></span></span></span></code> </pre> <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id433194/">https://habr.com/ru/post/id433194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id433182/index.html">Apakah mungkin untuk melatih agen untuk perdagangan di pasar saham dengan bala bantuan? Implementasi bahasa R</a></li>
<li><a href="../id433184/index.html">ASP.NET Core 2.2 dirilis. Apa yang baru? (2 dari 3)</a></li>
<li><a href="../id433186/index.html">Tidak cukup hanya dengan menghitung poligon untuk mengoptimalkan model 3D</a></li>
<li><a href="../id433188/index.html">Negara Duma memperkenalkan RUU tentang pekerjaan otonom Runet</a></li>
<li><a href="../id433192/index.html">Kubernetes: Solusi Proyek Pribadi yang Luar Biasa Terjangkau</a></li>
<li><a href="../id433196/index.html">Panduan Hadiah Tahun Baru</a></li>
<li><a href="../id433198/index.html">10 dolar untuk hosting: 20 tahun yang lalu dan hari ini</a></li>
<li><a href="../id433202/index.html">Memilih arsitektur solusi untuk pasar jasa pengiriman</a></li>
<li><a href="../id433204/index.html">Bagaimana cara mempelajari pengembangan Java? Pengalaman siswa GeekUniversity Nikita Chernetsov</a></li>
<li><a href="../id433206/index.html">Kami mengundang Anda pada tanggal 22 Desember ke Data Christmas Tree</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>