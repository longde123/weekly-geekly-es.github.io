<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¯ â˜ï¸ ğŸ‘©ğŸ»â€ğŸ“ Ajouter Furigan Ã  la macro Kanji Python pour LibreOffice ğŸ‘¼ğŸ¿ ğŸ¤š ğŸ›¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mesdames et messieurs, le plan est le suivant:
 
 

- tout ce que vous vouliez savoir sur l'Ã©criture japonaise, mais aviez peur de demander
- Qu'est-c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ajouter Furigan Ã  la macro Kanji Python pour LibreOffice</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395153/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesdames et messieurs, le plan est le suivant:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tout ce que vous vouliez savoir sur l'Ã©criture japonaise, mais aviez peur de demander</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Qu'est-ce qu'un texte rubis </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comment Ã©crire des addons pour libreoffice en python</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comment gÃ©nÃ©rer de la lecture pour kanzi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tout mettre ensemble dans un furiganiseur!</font></font></li>
</ul><br>
<img src="https://habrastorage.org/files/cc5/24f/513/cc524f513715442397b9e3abaff3612f.png"><br>
<br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le japonais moderne utilise principalement trois systÃ¨mes d'Ã©criture. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PremiÃ¨rement, ce sont deux alphabets syllabes: hiragana et katakana. Hiragana est plus arrondi, ressemble Ã  ceci: ã“ ã‚Œ ã¯ ã² ã‚‰ ãŒ ãª ã§ ã™ et est, pour ainsi dire, l'alphabet principal .ã€‚ Katakana est plus angulaire (ã‚« ã‚¿ ã‚« ãƒŠ ãƒ‡ ã‚¹) et est utilisÃ© principalement pour les mots empruntÃ©s, en gÃ©nÃ©ral, l'ensemble des signes pour l'hiragana et le katakana est presque le mÃªme. De plus, nous appellerons tout cela simplement Â«kanaÂ». Â«Alphabet syllabiqueÂ» signifie qu'au lieu de nos voyelles et consonnes Â«aÂ», Â«bÂ» et Â«cÂ» - seulement des syllabes entiÃ¨res telles que Â«kaÂ», Â«saÂ» et Â«thatÂ». Il y a aussi des voyelles, cependant, il y a cinq morceaux ("a", "et", "y", "e", "o" + "i", "u" et "e") et une seule consonne "n" dans ordre d'exception.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est pourquoi il est trÃ¨s difficile pour les Japonais de prononcer des mots avec des consonnes successives - ils n'y sont tout simplement pas habituÃ©s, mais ce n'est pas important pour nous maintenant. Avec un cana, en principe, vous pouvez Ã©crire n'importe quelle phrase en japonais. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre systÃ¨me est celui des personnages empruntÃ©s Ã  la Chine, que nous continuerons d'appeler </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kanji</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puis ce qu'ils s'appellent. AprÃ¨s l'emprunt, les kanji japonais, oui sobsno et chinois aussi, ont considÃ©rablement changÃ©, et maintenant ils sont assez diffÃ©rents, bien que, d'un autre cÃ´tÃ©, ils soient en grande partie similaires. Disons simplement qu'en regardant un texte chinois, un japonais peut plus ou moins comprendre de quoi il parle. Les kanji ressemblent Ã  ceci: å‹ é” ã€ æ—¥æœ¬ é…’ ã€ ä¸–ç•Œã€‚ Oui, en japonais, c'est un point rond.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un point clÃ© pour la comprÃ©hension: le japonais et le chinois au niveau de la grammaire ne sont gÃ©nÃ©ralement pas liÃ©s du tout. Donc, juste comme Ã§a, il Ã©tait impossible de prendre des caractÃ¨res chinois et de commencer Ã  les Ã©crire. En fait, avec l'aide du kanji, vous pouvez Ã©crire des mots individuels, plutÃ´t mÃªme les bases des mots, et le kana est toujours utilisÃ© pour indiquer les formes grammaticales et la connexion des mots entre eux. Cela ressemble Ã  ceci: é€ ã‚Š ãŒ ãª ã¯ ã¨ ã£ ã¦ ã‚‚ ä¾¿åˆ© ã§ ã™. Si vous regardez attentivement, vous pouvez voir que le premier caractÃ¨re est kanji, suivi de plusieurs signes de kana, etc. Cette astuce facilite la distinction visuelle entre le texte japonais et le chinois, qui sont graphiquement plus Â«densesÂ» car il n'y a que des kanji. Ce kana, qui est attachÃ© au kanji pour indiquer la forme grammaticale, est appelÃ© "okurigan".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, et enfin ... Le nombre de kanji est assez important, et si vous n'Ãªtes pas un robot, se souvenir de tout est difficile. Si le mot est Ã©crit par kanji, il n'est souvent pas Ã©vident de savoir comment le lire en personne, malgrÃ© le fait que dans la langue parlÃ©e le mot pourrait bien Ãªtre trouvÃ© et que la personne le sait. Pour aider dans cette situation, en particulier pour les kanji rares ou lorsque le texte est destinÃ© aux enfants, aux Ã©trangers ou Ã  d'autres catÃ©gories de citoyens mentalement limitÃ©s - la lecture d'un kanji est signÃ©e d'en haut avec un kana. C'est ce qu'on appelle le Â« </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">furigana</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â». Il ressemble Ã  l'image au dÃ©but du post. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fuh, passez au point suivant. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour ajouter des annotations sur du texte, le soi-disant rubis est utilisÃ©. Cela n'a rien Ã  voir avec le langage de programmation. Comme je viens de l'apprendre de WikipÃ©dia, en russe, on l'appelle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Â«agateÂ»</font></font></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prise en charge de Ruby est disponible en html Ã  l'aide de la balise ruby:</font></font><br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ruby</span></span></span><span class="hljs-tag">&gt;</span></span><font></font>
 <font></font>
 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rt</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rt</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ruby</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais maintenant, nous nous intÃ©ressons Ã  LibreOffice. </font><font style="vertical-align: inherit;">En mode manuel, vous pouvez ajouter une annotation rubis au texte via le menu Format -&gt; Guide phonÃ©tique asiatique. </font><font style="vertical-align: inherit;">C'est un peu Ã©trange, car vous pouvez utiliser le champ de frottement non seulement pour la phonÃ©tique, mais aussi pour les figues. </font><font style="vertical-align: inherit;">Si ce n'est pas dans le menu, vous pouvez essayer d'ajouter la prise en charge des langues asiatiques dans Outils -&gt; Options -&gt; ParamÃ¨tres de langue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous voulons le faire automatiquement pour le texte sÃ©lectionnÃ©. </font><font style="vertical-align: inherit;">LibreOffice est merveilleux en ce que vous pouvez y Ã©crire des macros en Python. </font><font style="vertical-align: inherit;">Pour ce faire, le module libreoffice-script-provider-python doit Ãªtre installÃ© (installÃ© via apt-get), ce qui ne vaut pas la valeur par dÃ©faut. </font><font style="vertical-align: inherit;">Oh oui, je fais tout sous Ubuntu, si vous avez un systÃ¨me d'exploitation diffÃ©rent, vous pouvez partager la recette dans les commentaires :)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La macro elle-mÃªme est Ã©crite comme une fonction rÃ©guliÃ¨re sur un Python. Le document est visible Ã  travers une variable globale avec une instance de la classe correspondante et, en fait, toutes les mÃ©thodes nÃ©cessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voici un exemple simple:</font></font><br>
 <pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HelloWorldPython</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span><font></font>
    desktop = XSCRIPTCONTEXT.getDesktop()<font></font>
    model = desktop.getCurrentComponent()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> hasattr(model, <span class="hljs-string"><span class="hljs-string">"Text"</span></span>):<font></font>
        model = desktop.loadComponentFromURL(<span class="hljs-string"><span class="hljs-string">"private:factory/swriter"</span></span>,<span class="hljs-string"><span class="hljs-string">"_blank"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, () )<font></font>
    text = model.Text<font></font>
    tRange = text.End<font></font>
    tRange.String = <span class="hljs-string"><span class="hljs-string">"Hello World (in Python)"</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span><font></font>
g_exportedScripts = HelloWorldPython,<font></font>
</code></pre> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous enregistrons dans un fichier, le mettons ou faisons un lien symbolique dans le dossier dans lequel LibreOffice contient les scripts. Dans mon cas, c'est Â«~ / .config / libreoffice / 4 / user / Scripts / pythonÂ». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ouvrez LibreOffice Writer (OpenOffice devrait Ã©galement fonctionner), allez dans Outils -&gt; Macros -&gt; ExÃ©cuter la macro et voyez notre script lÃ -bas, si tout a fonctionnÃ©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il reste Ã  Ã©crire un script qui reprendrait les kanji du document et ajouterait leurs lectures en roubles des caractÃ¨res correspondants. Tout est simple: il existe des programmes spÃ©ciaux pour la gÃ©nÃ©ration de lecture, nous les exÃ©cutons simplement Ã  partir de notre script de macro, via des entrÃ©es-sorties standard, exÃ©cutons du texte japonais et insÃ©rons la sortie dans le document.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un programme appelÃ© kakasi prend du texte japonais et donne une lecture complÃ¨te, mais ce n'est pas exactement ce dont vous avez besoin, car </font><font style="vertical-align: inherit;">Je veux distribuer des fragments d'indices phonÃ©tiques entre les champs de rubis des personnages correspondants. </font><font style="vertical-align: inherit;">Pour ce faire, en utilisant mecab, vous pouvez symboliser le texte japonais, et donc dÃ©jÃ  le nourrir kakasi en plusieurs parties. </font><font style="vertical-align: inherit;">En fait, la prÃ©cision de la gÃ©nÃ©ration de lecture Ã  partir de cela se dÃ©grade lÃ©gÃ¨rement, mais la mise en page du document s'amÃ©liore. </font><font style="vertical-align: inherit;">Certains dÃ©fauts peuvent ensuite Ãªtre corrigÃ©s manuellement. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
C'est sobsno et c'est tout, mettez apt-get install kakasi, mecab, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
allez sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github.com/undertherain/furiganize</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tÃ©lÃ©chargez le script maladroit que j'ai Ã©crit Ã  partir de lÃ  et qui sanglote, mais Ã§a fait tout. </font><font style="vertical-align: inherit;">Mettez-le dans le dossier souhaitÃ© et profitez-en. </font><font style="vertical-align: inherit;">Si quelqu'un partage son expÃ©rience avec d'autres systÃ¨mes d'exploitation - ce sera gÃ©nÃ©ralement merveilleux.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr395153/">https://habr.com/ru/post/fr395153/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr395143/index.html">Est-il possible d'introduire l'Ã©thique dans l'algorithme des robomobiles?</a></li>
<li><a href="../fr395145/index.html">Demandez Ã  Ethan n Â° 59: Qu'est-ce que l'Ã©nergie noire?</a></li>
<li><a href="../fr395147/index.html">Le SUV Mitsubishi Outlander s'introduit facilement par Wi-Fi</a></li>
<li><a href="../fr395149/index.html">Une nouvelle explication du principe du moteur "impossible" EmDrive: ce sont tous des photons</a></li>
<li><a href="../fr395151/index.html">Climatique dans votre maison. Annonce TION MagicAir</a></li>
<li><a href="../fr395155/index.html">Smart Light: Fonctions de contrÃ´le d'Ã©clairage</a></li>
<li><a href="../fr395157/index.html">ProgrÃ¨s des DVR de voiture et comparaison avec les camÃ©ras d'action</a></li>
<li><a href="../fr395159/index.html">Projet spÃ©cial: Centrale solaire sur un camping-car. Partie 1</a></li>
<li><a href="../fr395161/index.html">Les robots Amazon font leur travail 4 fois plus vite que les humains</a></li>
<li><a href="../fr395163/index.html">SÃ©lection: plus de 50 matÃ©riaux pour comprendre le marchÃ© boursier</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>