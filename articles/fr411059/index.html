<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíì üö© üìï Comment devenir magicien (partie 2). Coulisses techniques üë©üèø‚ÄçüöÄ ü•§ üöµüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Geektimes, bonjour! Comme promis, c'est la suite du dernier article sur notre petit monde de magie. Aujourd'hui, je vais vous parler des coulisses des...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment devenir magicien (partie 2). Coulisses techniques</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/411059/"><p>  Geektimes, bonjour!  Comme promis, c'est la suite du dernier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> sur notre petit monde de magie.  Aujourd'hui, je vais vous parler des coulisses des qu√™tes magiques, des d√©cisions qui ont √©t√© prises et de la fa√ßon dont nous sommes arriv√©s √† la conclusion que la qu√™te a un tel sc√©nario et une telle apparence. </p><br><p>  Parce que  Jusqu'√† la construction de la qu√™te, j'aimais l'√©lectronique, en particulier la programmation des microcontr√¥leurs AVR en C, il a √©t√© d√©cid√© d'essayer de maximiser ce potentiel, ce qui permettrait d'ajouter un maximum d'interactivit√©, d'int√©r√™t et d'excitation √† la qu√™te!  De plus, je ne voulais vraiment pas que la qu√™te ressemble √† des dizaines d'autres (travaillant √† l'√©poque dans notre ville). </p><br><p>  En r√©fl√©chissant au nouveau sc√©nario, nous avons clairement d√©cid√© que nous n'aurions ni serrures, ni cl√©s, ni t√¢ches standard, en g√©n√©ral, allumez l'√©lectronique au maximum de nos capacit√©s! </p><br><p>  Examinons de plus pr√®s la partie technique, et maintenant je vais vous dire comment rendre l'√©lectronique aussi <s>collective</s> que possible. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/dn/vy/th/dnvythtcndsal3tgxf_ia1s_yxk.jpeg"></a> </p><a name="habracut"></a><br><h2>  Revue g√©n√©rale </h2><br><p>  Nous allons omettre la mise en ≈ìuvre initiale de la qu√™te (peut-√™tre que j'en parlerai plus tard) et nous concentrer sur le moment de l'ach√®vement (apr√®s quoi la qu√™te a la forme finale). </p><br><p>  Apr√®s avoir discut√© de notre nouvelle vision de la qu√™te, j'ai r√©alis√© que la puissance d'un microcontr√¥leur est d√©j√† petite et que vous devez connecter un ordinateur, combinant tous les appareils en un seul syst√®me.  Pour comprendre l'int√©grit√© de l'image, un diagramme de tous les appareils et de leurs interactions a √©t√© compil√©: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wh/ef/vm/whefvmw6i3ss9jkjumnxju_veiw.jpeg" width="550"></div><br><p>  D'apr√®s le diagramme, vous pourriez penser que l'ordinateur est le principal, mais ce n'est pas tout √† fait vrai, il assumera le r√¥le de gestion et de lecture des pistes audio, ce que, comme vous l'avez d√©j√† remarqu√© dans l'article pr√©c√©dent, nous en avons beaucoup. </p><br><p>  Le microcontr√¥leur Atmega16 est devenu le c≈ìur de l'ensemble du syst√®me (le seul crit√®re de s√©lection √©tait un nombre suffisant de GPIO), qui, via UART, communique avec le programme sur l'ordinateur.  Tous les autres appareils sont fabriqu√©s sur le microcontr√¥leur Atmega8 (il est excellent en termes de nombre de GPIO et a un prix abordable). </p><br><p>  La plupart des cartes sont soud√©es sur les plaques d'essai bilat√©rales les plus cool, respectivement, tous les d√©tails dans les bo√Ætiers DIP.  Certaines planches sont rest√©es d√®s le d√©but de la qu√™te. </p><br><div class="spoiler">  <b class="spoiler_title">Programme pour ordinateur</b> <div class="spoiler_text"><p>  La fen√™tre principale du programme: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jy/ym/8o/jyym8oqes1h3jybzjf1x-ipqloo.jpeg" width="500"></div><br><p>  Fen√™tre √©largie pour les situations d'urgence: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lp/gz/is/lpgzisvnnrzbjmd544mjapcd-eg.jpeg" width="500"></div><br><p>  Fen√™tre d'erreur: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zc/_y/x-/zc_yx-mgwz-s08u-leuj7zh5oso.jpeg" width="500"></div></div></div><br><p>  La carte principale ne re√ßoit (!) Que des signaux discrets d'autres appareils (via les optocoupleurs visibles sur la photo), communique avec l'ordinateur, contr√¥le la LED dans le bol m√©moire. </p><br><div class="spoiler">  <b class="spoiler_title">Photo du tableau</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/tw/uy/ax/twuyaxztwv4q95ghdpey2fjojfo.jpeg" width="300"><img src="https://habrastorage.org/webt/l_/6e/jz/l_6ejzxjegptdieidedh4w3lq_g.jpeg" width="300"></p></div></div><br><p>  <strong>Canon magique principal: baguette</strong> </p><br><p>  Une baguette magique est un peu magique, un aimant en n√©odyme est int√©gr√© √† sa pointe.  Il a fait d'elle un bon grand-p√®re-tourneur de bois pour seulement 2 $.  Le principal probl√®me √©tait de pousser un aimant de diam√®tre maximum, en gardant la pointe aussi mince que possible. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ou/pu/t5/ouput5svy1t_kylawmvy4z-psf8.jpeg" height="100"></div><br><p>  Examinons maintenant de plus pr√®s chaque appareil. </p><br><p>  <strong>Branche rouge</strong> </p><br><p>  <em>Le livre</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jg/wm/5n/jgwm5nqowqi-snfpqeea6qygdbs.jpeg" width="500"></div><br><p>  L'√©v√©nement audio du livre est d√©clench√© par la remorque, qui est mont√©e dans une √©tag√®re.  Il est initialement ferm√© et pour l'ouvrir, vous devez apporter une baguette avec un aimant.  Le livre est comme un mini-coffre-fort: il a des piles (Li-ion 3S), un interrupteur √† lames et une cl√© √† transistor qui contr√¥le le verrou √©lectrom√©canique (afin de ne pas laisser tout le courant passer par l'interrupteur √† lames. En m√™me temps, vous pouvez voir une belle lueur √† l'int√©rieur de l'interrupteur √† lames, mais cela ne durera pas longtemps et la probabilit√© de ¬´coller¬ª des contacts).  Tout est simple ici - la baguette est relev√©e, le commutateur √† lames passe le courant, le transistor est ouvert et le p√™ne est r√©tract√©.  L'int√©rieur du coffre aux orteils ressemble √† ceci: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4p/a3/cs/4pa3csv5uafgtxobfj8ufadhdi8.jpeg" width="500"></div><br><p>  Et la vue finale: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cv/3n/vq/cv3nvqxj-m6f1ciowre3bxc3vjk.jpeg" width="500"></div><br><p>  <em>Dobby</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/ra/7q/ghra7qobwrgesiu4rcqtj9mtxay.jpeg" width="500"></div><br><p>  Parce que  la t√¢che √©tait de r√©agir le plus interactivement pour apporter la chaussette √† Dobby, le choix s'est port√© sur la technologie RFID.  Pour ce faire, j'ai d√ª coudre un petit porte-cl√©s dans ma chaussette (comme dans un interphone √† l'entr√©e) et mettre sur la chaussette le m√™me signe que Dobby dans la paume de sa main.  Derri√®re l'image de Dobby se trouve le module RFID. </p><br><p>  L'appareil est bas√© sur le microcontr√¥leur Atmega8 et le module RFID RC522 populaire.  Apr√®s avoir remont√© la chaussette (un rayon de r√©ponse allant jusqu'√† 4 cm est tout simplement parfait), le transistor √† effet de champ ouvre le verrou √©lectromagn√©tique dans la bo√Æte et √† l'aide d'un ressort, le couvercle est soulev√©, un signal est envoy√© √† la carte principale et un voyant rouge s'allume dans le bol de m√©moire. </p><br><div class="spoiler">  <b class="spoiler_title">Frais</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/jq/ql/_7/jqql_7jfi3w6lis3u58ylar3mwi.png" width="450"></div></div></div><br><p>  <strong>Branche bleue</strong> </p><br><p>  <em>Chemin√©e</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6w/b0/ej/6wb0ejy-xmt10rrvvknd2emkp_8.jpeg" height="450"></div><br><p>  La chemin√©e est naturellement fausse.  Fait de profil et de cloison s√®che coll√©s avec des tuiles de brique. </p><br><p>  Electronique mont√©e sur Atmega8.  Une remorque est mont√©e dans chaque brique et une bande LED bleue est connect√©e.  Les briques elles-m√™mes reposent sur un c√¥t√© des rideaux, et de l'autre un guide primitif avec un ressort de rappel est fait.  Lorsque vous cliquez pour la premi√®re fois sur une brique, tous les boutons-poussoirs (il y en a 7) sont allum√©s pendant 100 ms et l'≈ìil est retir√© de l'image √† l'aide d'un moteur pas √† pas, le signal ira √† la carte principale, la m√©moire s'allumera et la lumi√®re bleue dans le bol m√©moire. </p><br><p>  Le moteur pas √† pas et la bande LED sont contr√¥l√©s √† l'aide du transistor Darlington ULN2003 (pour les curieux, la partie th√©orique peut √™tre lue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ). </p><br><p>  Maintenant, chaque clic sur une brique inverse son √©tat (un clic - on, le suivant - √©teint et ainsi de suite), la premi√®re fois que vous cliquez sur une brique, le capteur infrarouge est cach√© dans l'image: la LED IR est allum√©e, le rayonnement bat loin du joueur qui approche et c'est √† un transistor IR qui utilisant <del>  ferme collective </del>  des ajustements pr√©cis par des r√©sistances donnent un signal discret 0 ou 1 √† la sortie. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j7/vo/vs/j7vovsqzvpecwnnta4ryuuicqzo.jpeg" width="500"></div><br><p>  Il existe √©galement une solution contre les √©clairages parasites (particuli√®rement si les utilisateurs commencent √† faire briller une lampe sur la chemin√©e), un autre (masqu√©) est inclus dans le circuit ouvert du transistor IR principal, qui, lorsqu'il est expos√© √† la lumi√®re, d√©sactive simplement la r√©action du microcontr√¥leur. </p><br><p>  D√®s que le capteur IR est d√©clench√©, le microcontr√¥leur active √©galement le clignotement de la combinaison souhait√©e qui doit √™tre press√©e (surbrillance) et, en passant, la s√©quence de pressage joue √©galement un r√¥le.  Le clignotement de la combinaison souhait√©e d√©sactive toutes les briques pr√©c√©demment press√©es. </p><br><p>  Lorsque la bonne combinaison a √©t√© press√©e, l'image s'ouvre √† l'aide d'un verrou √©lectrom√©canique plus grand que dans les cercueils.  Pour ce faire, j'ai m√™me d√ª mettre un transformateur assez gros uniquement pour ce loquet. </p><br><p>  (En g√©n√©ral, ces verrous sont tr√®s faibles, bien qu'ils consomment beaucoup de courant au pic. Vous devez √™tre tr√®s prudent avec leur contr√¥le, si vous lui donnez du courant pendant plus de 5 secondes, il peut simplement br√ªler, c'est comme √ßa que j'ai br√ªl√© un verrou) </p><br><div class="spoiler">  <b class="spoiler_title">Acc√®s aux n≈ìuds techniques et √† la carte</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/3f/3w/d_/3f3wd_pzwkiwc0akv-9gke8ycoy.jpeg" height="450"></div><br><p><img src="https://habrastorage.org/webt/19/y2/z1/19y2z1m4vdnzoakm9r3uurh638u.jpeg" width="350"><img src="https://habrastorage.org/webt/uf/xn/wv/ufxnwv1yklo_njv1hi_q6tf7doy.jpeg" width="350"></p></div></div><br><p>  <strong>Branche verte</strong> </p><br><p>  <em>Coffret</em> </p><br><p>  Sur la table, il y a un pot discret sur la remorque, si vous le soulevez, le voyant vert dans le chaudron s'allume et le cercueil s'ouvre, dans lequel il y a un indice pour la porte. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/bp/g3/dgbpg30xa87pu3vkc8hsuyk_muo.jpeg" width="550"></div><br><p>  (C'est le m√™me pot qui est n√©cessaire pour l'oeuf de P√¢ques avec les blagues de Dobby, qui est d√©crit dans le premier article) </p><br><p>  <em>La porte</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yj/s4/n1/yjs4n1lzj_ouxjypnurgsiu_vsm.jpeg" width="350"></div><br><p>  Lorsque vous appuyez pour la premi√®re fois compl√®tement sur la poign√©e (pour cela, vous avez d√ª mettre 2 interrupteurs de fin de course √† l'arri√®re de la porte afin de r√©pondre √† une pression compl√®te sur la poign√©e), l'≈ìil du serpent sur la porte commence √† clignoter. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ki/gs/yq/kigsyq4bpjrb41m3wkeacow0liw.jpeg" width="300"></div><br><p>  L'algorithme d'ouverture de porte correct peut √™tre compris √† partir de l'invite: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jw/rt/nv/jwrtnvq9y7fhpzfylrovjdse5xw.jpeg" height="400"></div><br><div class="spoiler">  <b class="spoiler_title">Plus tard, il s'est av√©r√© que cet indice est assez compliqu√© pour les joueurs.</b>  <b class="spoiler_title">Par la suite, il a √©t√© remplac√© par un</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/hl/sr/v8/hlsrv8spyrijvnve2rz6fjmqfyi.jpeg" width="500"></div></div></div><br><p>  Pendant les pauses (5s), le microcontr√¥leur se bloque simplement en retard, et pendant l'appui, la variable est incr√©ment√©e.  Par cons√©quent, si vous appuyez longuement et fortement sur la poign√©e, elle s'ouvrira de toute fa√ßon, d'ailleurs, certaines personnes ont ouvert la porte de cette fa√ßon, sans comprendre comment elles l'ont fait.  Afin de ne pas fabriquer une nouvelle carte avec un microcontr√¥leur s√©par√© pour cette entreprise simple, plusieurs broches libres ont √©t√© trouv√©es sur la carte labyrinthe et tout y √©tait connect√©. </p><br><p>  <em>Miroir de poitrine</em> </p><br><p>  Sur le couvercle de la poitrine, 10 symboles magiques sont appliqu√©s et √† l'int√©rieur de l'anche sont coll√©s sous eux. <br>  L'utilisateur doit apporter la baguette aux 3 caract√®res corrects (la s√©quence n'a pas d'importance. La photo est marqu√©e de coches), cependant, d'autres figures ont √©galement des interrupteurs √† lames, tenant la baguette √† laquelle annule les clics pr√©c√©dents, m√™me si elles √©taient correctes (de sorte qu'il √©tait impossible d'ouvrir la poitrine en tenant la baguette pour tous les caract√®res dans une rang√©e).  Avec le bon choix de symboles, l'√©lectroaimant dans la poitrine s'ouvre (les Atmega8 et ULN2003 pr√©f√©r√©s sont dans la poitrine).  √Ä ce stade, un signal est envoy√© √† la carte de num√©rotation du labyrinthe (une unit√© courante de la broche d'un MK √† la broche d'un autre via une cl√© √† transistor) et les tourbillons commencent √† tourner dans le labyrinthe. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y4/mg/va/y4mgva5jwu7of5x1_zt4mtlgaem.jpeg" width="550"></div><br><p>  <em>Labyrinthe</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1w/lx/9c/1wlx9czlf4vl6-k_kolx6nrfile.jpeg" width="550"></div><br><p>  Nous avons sous-estim√© cette √©norme conception.  Elle a pris beaucoup de temps et d'efforts pour cr√©er, mais le r√©sultat en valait la peine.  Pour le travail du ¬´gros objet noir sur le mur¬ª, beaucoup de GPIO √©tait n√©cessaire (tout a √©t√© fait de la mani√®re la plus primitive - pas de multiplexeurs / d√©multiplexeurs, seulement hardcore!), J'ai donc d√ª briser l'appareil en unit√©s fonctionnelles - le cadran et le labyrinthe lui-m√™me.  Chaque n≈ìud est r√©alis√© sur le m√™me Atmega8. </p><br><div class="spoiler">  <b class="spoiler_title">Processus d'assemblage</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ha/kd/n7/hakdn7tbv9q7-3pjscovb9_pgok.gif" width="550"></div></div></div><br><p>  Dans le labyrinthe, le principe est simple (m√™me si cela ne semblait pas assez simple :)).  De nombreux probl√®mes ont √©t√© caus√©s par la pr√©sence d'une balle √† la fin de sa trajectoire.  Des interf√©rences al√©atoires interf√©raient constamment avec le fonctionnement d'un optocoupleur ouvert. </p><br><div class="spoiler">  <b class="spoiler_title">Photo du tableau</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/bv/16/pu/bv16pucrojx_6qpbaq5wmszmfrq.jpeg" width="550"></div></div></div><br><p>  Ce sont ces condensateurs jaunes qui ont permis de r√©soudre le probl√®me du fonctionnement al√©atoire des optocoupleurs. </p><br><p>  Suite au passage du labyrinthe, l'acc√®s √† la sph√®re verte s'ouvre.  Le syst√®me permettant d'y acc√©der est verrouill√© depuis les porti√®res de la voiture.  (En termes de prix / force de r√©traction, c'est un monstre!). </p><br><p>  Au d√©part, il n'√©tait pas pr√©vu de donner 1 balle pour le jeu, mais j'ai d√ª faire des ajustements d√®s la phase finale, car  dans les boules magn√©tiques, elles peuvent ¬´coller ensemble¬ª et les s√©parer est tr√®s probl√©matique, donc, afin d'exclure cette probabilit√© autant que possible dans le jeu, il a √©t√© d√©cid√© d'√©mettre des boules √† leur tour.  L'alimentation est r√©alis√©e √† l'aide d'un moteur pas √† pas et d'un volet improvis√© d'une vieille canne √† lancer. </p><br><div class="spoiler">  <b class="spoiler_title">Photo du m√©canisme</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/f0/bu/-p/f0bu-pdwg9bcxbnswdtufo-xgwk.jpeg" width="350"></div></div></div><br><p>  <strong>Unir nos forces</strong> </p><br><p>  <em>Echecs</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/li/sv/bj/lisvbj67_f4538jcwsngoz-6ule.jpeg" width="500"></div><br><p>  Apr√®s de longues d√©lib√©rations, une t√¢che avec un seul algorithme a √©t√© pens√©e (sous certaines conditions, que les joueurs r√©servent).  Il ne restait plus qu'√† mettre en place un syst√®me de mouvement d'√©checs et de r√©action aux actions des joueurs :) </p><br><div class="spoiler">  <b class="spoiler_title">Avec le soutien de la production agricole collective, la conception trrrresh suivante a √©t√© mise en ≈ìuvre:</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/cb/3n/dc/cb3ndck2a4ge9y2aud1mskzqdyq.jpeg" width="350"><img src="https://habrastorage.org/webt/yz/tx/bj/yztxbjncm7oilb359bslvcvsuvk.jpeg" width="350"></p></div></div><br><p>  Le m√©canisme est compos√© de goujons et d'√©crous M8, de roulements chinois et de bois.  Un aimant est mont√© sur chaque figure √† l'aide de laquelle le m√©canisme les d√©place.  Le couplage entre le moteur et le goujon est constitu√© d'un composant du pistolet √† colle, dont nous avions des consommables, en raison de la consommation consid√©rablement accrue de colle silicone. </p><br><div class="spoiler">  <b class="spoiler_title">Photo du tableau</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/jw/hh/ad/jwhhadki6ctudi0tz4dxd_i3cpk.jpeg" width="350"><img src="https://habrastorage.org/webt/g6/yd/rf/g6ydrfrphcnvrigm4uuqf3th5hc.jpeg" width="350"></p></div></div><br><p>  Qui sait, nous avons pris les pi√®ces du jeu d'√©checs Harry Potter, elles font toujours des sons diff√©rents, brillent, etc.  Je ne pouvais pas laisser ces caract√©ristiques comme √ßa, j'ai d√©plac√© ces ch√¢les sous la planche et il s'est av√©r√© que quand ils montent √† cheval - il hennit, et √† la fin, vous pouvez entendre le son du roi d√©chu. <br>  Apr√®s une victoire aux √©checs, la porte de l'armoire s'ouvre (elle s'ouvre rapidement √† l'aide d'un rail √† gaz pour meubles). </p><br><p>  Avant de passer au plus int√©ressant, je veux parler d'un chaudron (un bol de souvenirs) et d'un interphone pour la communication entre l'administrateur et les visiteurs pendant le match. </p><br><p>  <em>Bol de souvenirs</em> </p><br><p>  Pour commencer, ce chaudron en aluminium de dix litres a √©t√© trouv√© par mon grand-p√®re dans un garage comme un attribut de la cuisine sovi√©tique :) L'id√©e de faire un bol de souvenirs d'o√π la fum√©e soufflerait (et en fait de la vapeur) restait longtemps dans les pens√©es, mais nous sommes arriv√©s √† une mise en ≈ìuvre comp√©tente un peu plus tard. </p><br><p>  Les humidificateurs √† ultrasons d'une quantit√© de 6 (!!!) pi√®ces et d'une puissance totale d'environ 100 watts sont devenus l'agent de bu√©e! </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4s/rf/yf/4srfyfxjqghpglwjkvin8-fnvdu.png" width="350"></div><br><p>  H√©las, la photo n'a pas √©t√© conserv√©e, mais l'appareil est tr√®s simple, r√©alis√© selon le sch√©ma: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/te/ly/cz/telycz1hm-xsihi9bstgrn7amiw.png" width="350"></div><br><p>  Des dimensions ont √©t√© faites pour s'adapter parfaitement √† ce syst√®me sur la table (espace pour les tiroirs). </p><br><p>  <em>Interphone</em> </p><br><p>  Ma maigre connaissance des circuits analogiques n'a pas permis de r√©soudre rapidement ce probl√®me.  Apr√®s de longues tentatives infructueuses (mais comme il s'est av√©r√© plus tard, la solution √©tait proche de Chetrov!), J'ai demand√© √† mon ami de Kherson de me fabriquer un tel appareil. </p><br><div class="spoiler">  <b class="spoiler_title">Et apr√®s un certain temps, j'ai eu un tel appareil</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/wp/3l/gj/wp3lgj8lyrudgr3qay6jwyz9dzq.jpeg" height="350"><img src="https://habrastorage.org/webt/nl/fd/od/nlfdod5gxhlk0yqneatdm7qxye8.jpeg" height="350"></p></div></div><br><p>  Le pr√©amplificateur est fabriqu√© sur un amplificateur op√©rationnel √† faible bruit NE5532, apr√®s quoi il co√ªte TDA2006. </p><br><div class="spoiler">  <b class="spoiler_title">Circuit de pr√©ampli</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/zr/bs/c8/zrbsc8-3bnuu6vmscl3pvhvpugg.jpeg" width="400"></div></div></div><br><p>  Enfin, nous passons √† l'un des syst√®mes les plus complexes de la salle - la bataille finale avec le Seigneur des T√©n√®bres! </p><br><p>  <strong><em>Combattre</em></strong> </p><br><p>  L'id√©e √©tait de r√©aliser au moins une ¬´bataille¬ª √† peu pr√®s similaire du joueur (Harry Potter) avec Voldemort.  Pour plus d'effet, du vent a √©t√© ajout√© (2 ventilateurs).  Nous avons r√©fl√©chi √† beaucoup d'options, puis un ami m'a parl√© des LED WS2812 adressables.  Maintenant, m√™me les pilotes Arduino les plus paresseux parlent de ce qu'ils ont fait de cool, mais WS2812 √©tait moins connu, mais ils sont devenus notre salut!  Sans eux, il √©tait tout simplement irr√©aliste de r√©aliser notre id√©e! </p><br><p>  La bande LED de 5 m a √©t√© pli√©e en deux et un fil pour un interrupteur √† lames a √©t√© √©tir√© √† l'int√©rieur.  Les premi√®res bandes de 5 m ont √©t√© grav√©es en toute s√©curit√© dans le but d'√©conomiser sur l'alimentation pour la m√™me bande :) </p><br><p>  Nous avons commenc√© le d√©veloppement en d√©finissant les horaires: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x4/qo/wh/x4qowhnqimvp4m5c-sdratsqzws.jpeg" width="500"></div><br><p>  Certains probl√®mes ont ajout√© l'inclusion de fans.  Si vous apportez / retirez souvent la baguette, puis le relais (au d√©part, j'ai essay√© d'activer les ventilateurs via le relais), le microcontr√¥leur a simplement d√©moli la tour.  En cons√©quence, j'ai appris la capacit√© de contr√¥ler une charge de 220 V via une opto-simmistor.  Apr√®s √ßa je n'utilise pas de relais :) </p><br><p>  Il convient √©galement de mentionner qu'une grande puissance de calcul (√† l'√©chelle Atmega8) √©tait n√©cessaire pour consacrer au contr√¥le de la bande LED.  Au d√©but, le travail de la bande √©tait tr√®s accroch√©, nous avons souffert longtemps, nous ne pouvions pas comprendre pourquoi.  En cons√©quence, j'ai d√ª trouver sur Internet la personne qui a √©crit la biblioth√®que de cette cassette et lui demander de l'aide.  La raison √©tait simple: le MK n'a pas eu le temps d'ex√©cuter le code dans le gestionnaire d'interruption, et d√®s que nous l'avons corrig√©, tout fonctionnait parfaitement! </p><br><div class="spoiler">  <b class="spoiler_title">Photo du tableau</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/nh/iw/cp/nhiwcpjsdozd8dqie-ur6wk49uk.jpeg" width="350"><img src="https://habrastorage.org/webt/fb/ld/va/fbldvaxsykqrxfhbw3i0c7htiaw.jpeg" width="350"></p></div></div><br><p>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Programmes pour microcontr√¥leurs</a> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Programme pour ordinateur</a> </p><br><p>  Selon notre id√©e, cela devrait √™tre le dernier article, mais nous voulons toujours vous dire beaucoup de choses int√©ressantes, donc je veux annoncer la publication de deux autres articles sur la fa√ßon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de faire de v√©ritables Poudlard (1)</a> et de se d√©barrasser des id√©es non r√©alis√©es (2) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du bureau</a> . </p><br><p>  Ce sera int√©ressant! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr411059/">https://habr.com/ru/post/fr411059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr411045/index.html">Stick: le h√©ros m√©connu de l'√©volution humaine</a></li>
<li><a href="../fr411049/index.html">Que lire. Articles de fiction et blogs non connus et gel√©s</a></li>
<li><a href="../fr411051/index.html">Les satellites de Dauria Aerospace n'entrent pas en contact (malheureusement, suite)</a></li>
<li><a href="../fr411055/index.html">Experts: un conducteur humain sur le site du pilote automatique Uber pourrait √©viter une collision mortelle</a></li>
<li><a href="../fr411057/index.html">Space X et ULA signent des contrats de 650 millions de dollars avec le Pentagone</a></li>
<li><a href="../fr411061/index.html">Syst√®me d'exploitation r√©el pour un ancien PC ou netbook</a></li>
<li><a href="../fr411063/index.html">Apprendre l'√©l√©phant (partie 2)</a></li>
<li><a href="../fr411065/index.html">"Profiter du silence": quels sont les avantages et les inconv√©nients des endroits les plus calmes de la plan√®te</a></li>
<li><a href="../fr411067/index.html">Le premier univers 1. Cosmologie de l'inflation: notre univers fait-il partie du multivers? Partie 1</a></li>
<li><a href="../fr411069/index.html">"Cyborgs et espace"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>