<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐡 🚻 ☮️ Bagaimana membangun arsitektur IIoT do-it-yourself 👩‍👦‍👦 🚟 🍻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selama tahun lalu, kami telah merancang (dan terus mendukung) beberapa proyek IIoT. Anda mungkin pernah mendengar tentang IIoT, tetapi untuk berjaga-j...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana membangun arsitektur IIoT do-it-yourself</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/415933/"><p>  Selama tahun lalu, kami telah merancang (dan terus mendukung) beberapa proyek IIoT.  Anda mungkin pernah mendengar tentang IIoT, tetapi untuk berjaga-jaga, kami akan mencoba menjelaskan sesederhana apa itu dan mengapa itu menarik bagi pengembang, arsitek, dan administrator dari solusi yang sangat dimuat. </p><br><p><img src="https://habrastorage.org/webt/4v/ah/zc/4vahzcmpo0wh-i7hhutwxwzjjkk.png"></p><br><p>  IoT - Internet of Things - melibatkan perangkat pengendali yang dirancang untuk melakukan tugas-tugas rumah tangga sederhana (buka pintu garasi ketika mobil berhenti, nyalakan lampu menggunakan sensor atau perintah gerak, pantau suhu kamar), lalu di bawah IIoT - Internet industri barang - biasanya ada mengingat "digitalisasi" data dari industri, atas dasar analisis ahli yang dapat dilakukan, sering dengan bantuan pembelajaran mesin. </p><a name="habracut"></a><br><p>  Misalnya, Anda dapat mengumpulkan dan menganalisis data dari motor berputar untuk mempelajari tentang kegagalan waktu dan menghemat perbaikan.  Mengganti turbin yang benar-benar rusak jauh lebih mahal daripada perbaikan tepat waktu.  Contoh lain adalah penambangan batubara.  Analisis data tentang komposisi udara di tambang memungkinkan Anda merespons dalam waktu melebihi nilai yang diizinkan.  Ini membantu mencegah situasi yang mengancam jiwa para penambang. </p><br><p>  Aliran data - dari sensor lapangan, dari mesin industri, dari sensor gas - menuju hub agregasi dan, lebih lanjut, ke platform pemrosesan data dan analisis. </p><br><p>  Kami ingin berbicara tentang bagaimana arsitektur seperti itu terlihat, bagaimana mengumpulkan dan menganalisis data dengan cukup sederhana, dan membahas secara spesifik aplikasi individual.  Kami akan mengandalkan terjemahan artikel berbahasa Inggris dan pengalaman desain kami sendiri.  Artikel ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diterjemahkan</a> , dengan penjelasan dan tambahan kami. </p><br><p>  Pada artikel pertama, kami akan mencoba membuat arsitektur IIoT, di mana kami akan mengirimkan data lebih lanjut dari sensor, dan kemudian mentransfernya ke sistem yang menyediakan pemrosesan, analisis, pembelajaran mesin, dan pemantauan data yang masuk. </p><br>
<h3 id="sozdavaemaya-arhitektura">  Arsitektur yang Dibuat </h3><br><p>  Seringkali dalam IoT industri tidak ada akses langsung ke sensor dan sistem kontrol, oleh karena itu, gateway digunakan untuk menghubungkan tingkat OT (teknologi operasi) dan TI (teknologi informasi). </p><br><p>  Dengan demikian, arsitektur IIoT biasanya meliputi: perangkat akhir, gateway, hub regional dan, akhirnya, pemrosesan informasi dan sistem penyimpanan. </p><br><p>  Arsitektur yang dibuat harus memberikan peluang: </p><br><ul><li>  Kumpulkan data dari sensor ke gateway </li><li>  Transfer data ke cloud atau pusat data </li><li>  Memperbarui konfigurasi gateway secara otomatis </li><li>  Pertahankan transfer dan pemrosesan data yang aman </li></ul><br><p>  Pada gambar: arsitektur sistem dan perangkat lunak yang dibuat yang akan kita gunakan untuk membangunnya di setiap level. </p><br><p><img src="https://habrastorage.org/webt/pb/g9/ei/pbg9eiqinl-rarf31fvlpinih9o.png"></p><br><p>  Sensor mengumpulkan data dan mengirimkannya ke gateway menggunakan berbagai protokol kabel dan nirkabel (Serial, RS-485, MODBUS, CAN bus, OPC UA, BLE, WiFi, dll.).  Dalam contoh kita, kita akan ingat bahwa data datang ke gateway melalui WiFi. </p><br><p>  Sebagai gateway, kami akan menggunakan Raspberry Pi, di mana broker Mosquitto dan agen MiNiFi akan diluncurkan.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mosquitto</a> adalah broker pesan bersumber terbuka dan ringan yang akan kami gunakan untuk mengirimkan data lebih lanjut dari sensor menggunakan protokol MQTT.  MQTT menambahkan overhead minimum dan karenanya nyaman untuk digunakan dalam IoT ketika sumber daya perangkat keras dari perangkat akhir terbatas (misalnya, ponsel dan mikrokontroler digunakan). </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apache MiNiFi</a> - subproyek <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apache NiFi</a> - agen ringan yang mengimplementasikan fungsionalitas inti Apache NiFi, yang dirancang khusus untuk mengumpulkan data pada perangkat akhir. </p><br><p>  MiNiFi kompak, menggunakan sumber daya minimal dan memungkinkan manajemen terpusat dari semua agen.  Ini dengan mudah terhubung ke NiFi menggunakan Site-To-Site (S2S), yang memungkinkan Anda untuk membangun kontrol aliran data lengkap - scalable, aman dan memberikan ide yang jelas tentang semua tahapan transfer informasi. </p><br><p>  Dalam sistem kami, MiNiFi akan berlangganan semua topik broker Mosquitto dan akan meneruskan setiap pesan ke set NiFi di tingkat regional.  Anda juga dapat menggunakannya untuk terhubung ke sistem SCADA atau sumber data OT lainnya. </p><br><p>  Di tingkat regional, ada dua komponen: </p><br><p>  Apache NiFi adalah sistem manajemen aliran data yang kuat yang mendukung lebih dari 200 konektor.  Antarmuka grafis memungkinkan Anda merancang aliran data dengan cepat dan mudah. </p><br><p>  NiFi tidak mengorbankan kekuatan untuk kesederhanaan.  Ini adalah sistem terdistribusi dengan skala baik dengan pengiriman yang terjamin, tekanan balik (kemampuan untuk menyimpan data sebelum mengunggahnya ke sistem lain yang lebih lambat) dan penyeimbangan beban.  Fungsionalitas ini menjadikan NiFi alat yang luar biasa untuk aplikasi IoT yang sering bekerja di lingkungan jaringan yang tidak stabil. </p><br><p>  Dalam sistem kami, NiFi adalah pusat pengumpulan data yang mengarahkan mereka ke berbagai sistem dan aplikasi (HDFS, HBase, Kafka, S3, dll.). </p><br><p>  MiNiFi C2 Server (MiNiFi Command &amp; Control) adalah sub proyek Apache NiFi lain yang masih dalam pengembangan.  Perannya adalah untuk menjadi titik sentral dari konfigurasi ratusan dan ribuan agen MiNiFi yang sedang dalam produksi di lapangan (berbagai ruang, pabrik, wilayah).  Server C2 mengelola konfigurasi aliran MiNiFi (dalam terminologi C2 - kelas aplikasi berversi) dan menerbitkannya melalui API Istirahat.  Agen MiNiFi dapat terhubung ke API ini pada frekuensi yang diberikan untuk memperbarui konfigurasi mereka sendiri. </p><br><p>  Jadi, mari mulai membuat prototipe kami. </p><br><h4 id="soglashenie-o-imenovanii-domennyh-imen">  Perjanjian Nama Domain </h4><br><p>  Untuk konfigurasi lebih lanjut dari berbagai sistem yang harus saling menghubungi, mari kita sepakati nama domain yang akan kita gunakan dalam konfigurasi. </p><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  Apache NiFi      192.168.0.20 nifi.iot.local #  Apache MiNiFi C2     MiNiFi 192.168.0.20 minifi-c2.iot.local #raspberry pi,      Apache MiNiFi  MQTT  192.168.0.68 iot-hub-1.iot.local</span></span></code> </pre> <br><h4 id="podgotovka-raspberry-pi-mqtt-i-minifi">  Persiapan Raspberry Pi: MQTT dan MiNiFi </h4><br><p>  Untuk menginstal broker MQTT Mosquitto dan agen MiNiFi, jalankan perintah berikut pada Raspberry Pi Anda. </p><br><p>  Secara default, MiNiFi berisi sekumpulan penangan data minimal.  Anda dapat menambahkan penangan tambahan dari kit NiFI dengan menambahkan arsip NAR (arsip NiFi) ke direktori perpustakaan. </p><br><p>  Dengan perintah terakhir, kami menambahkan handler NAR MQTT. </p><br><pre> <code class="bash hljs">sudo apt-get update <span class="hljs-comment"><span class="hljs-comment">#install and run Mosquitto broker on default port 1883 sudo apt-get install mosquitto mosquitto #install and prepare MiNiFi agent wget http://apache.crihan.fr/dist/nifi/minifi/0.4.0/minifi-0.4.0-bin.tar.gz tar -xvf minifi-0.4.0-bin.tar.gz cd minifi-0.4.0 #add mqtt processor wget https://github.com/ahadjidj-hw/NiFi/raw/master/nifi-mqtt-nar-1.5.0.nar -P ./lib/</span></span></code> </pre> <br><p>  Sekarang mari kita instal server manajemen konfigurasi MiNiFi C2 pada server yang akan tersedia dengan Raspberry Pi </p><br><h4 id="ustanovka-i-konfigurirovanie-minifi-c2-servera">  Instalasi dan konfigurasi server MiNiFi C2. </h4><br><p>  Instal server MiNiFi C2 pada server publik yang akan tersedia dengan agen MiNiFi.  Anda dapat menggunakan distribusi hierarkis server C2 untuk infrastruktur jaringan yang kompleks, seperti dijelaskan di bawah ini.  Jalankan perintah berikut untuk menginstal server C2: </p><br><pre> <code class="bash hljs">wget http://apache.crihan.fr/dist/nifi/minifi/0.4.0/minifi-c2-0.4.0-bin.tar.gz tar -xvf minifi-c2-0.4.0-bin.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> minifi-c2-0.4.0</code> </pre> <br><ul><li>  Server C2 akan menerbitkan konfigurasi terorganisir kelas.  C2 mendukung “penyedia konfigurasi” pluggable: </li><li>  CacheConfigurationProvider, yang memperbarui konfigurasi berdasarkan konfigurasi yang ditentukan dalam sistem file atau S3 </li><li>  DelegatingConfigurationProvider, yang meneruskan delegasi ke server C2 lain untuk membuat struktur hierarki server C2. </li><li>  The NiFiRestConfigurationProvider, yang menghapus template dari server Apache NiFi melalui REST API mereka. </li></ul><br><p>  Kami akan mengonfigurasi server C2 untuk menggunakan NiFi sebagai penyedia konfigurasi.  Edit file ./conf/minifi-c2-context.xml, batalkan komentar pada blok xml </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.apache.nifi.minifi.c2.provider.nifi.rest.NiFiRestConfigurationProvider"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  dan tulis alamat server NiFi ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http: //nifi.iot.local: 8080</a> ) </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>http://nifi.iot.local:8080/nifi-api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constructor-arg</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h4 id="dalneyshee-konfigurirovanie-minifi-na-raspberry-pi">  Konfigurasi lebih lanjut dari MiNiFi pada Raspberry Pi </h4><br><p>  Secara default, untuk menambahkan penangan dan konfigurasinya, Anda perlu mengedit konfigurasi ./conf/config.yml.  Konfigurasi juga dapat ditulis secara manual atau dibuat menggunakan Apache NiFi GUI, diikuti dengan mengekspor konfigurasi sebagai templat.  Templat adalah file XML yang harus dikonversi ke file konfigurasi MiMLiFi YML menggunakan toolkit MiNiFi.  Berikut adalah contoh file konfigurasi yang memonitor file pada perangkat dan meneruskan setiap baris baru ke NiFi menggunakan protokol S2S. </p><br><p>  Untuk proyek kami, kami tidak akan menggunakan penyetelan manual.  Memang, jika ada banyak agen MiNiFi, itu tidak akan mudah untuk berhenti secara manual, edit config.yml dan restart agen setiap kali konfigurasi berubah. </p><br><p>  MiNiFi menggunakan Change Ingestor, yang dengannya agen belajar tentang konfigurasi baru yang mungkin.  Change Ingestor adalah plug-in, dan ada tiga ChangeIngestor yang secara asli didukung oleh MiNiFi. </p><br><ul><li>  FileChangeIngestor </li><li>  RestChangeIngestor </li><li>  PullHttpChangeIngestor </li></ul><br><p>  Kami akan menggunakan PullHttpChangeIngestor untuk secara berkala mengakses server C2 dan mengunduh konfigurasi baru.  Untuk mengkonfigurasi Ingestor ini, Anda perlu mengedit file ./conf/bootstrap.conf, batalkan komentar pada baris yang sesuai dan atur pengaturan berikut: </p><br><pre> <code class="bash hljs">nifi.minifi.notifier.ingestors=org.apache.nifi.minifi.bootstrap.configuration.ingestors.PullHttpChangeIngestor <span class="hljs-comment"><span class="hljs-comment"># Hostname on which to pull configurations from nifi.minifi.notifier.ingestors.pull.http.hostname=minifi-c2.iot.local # Port on which to pull configurations from nifi.minifi.notifier.ingestors.pull.http.port=10080 # Path to pull configurations from nifi.minifi.notifier.ingestors.pull.http.path=/c2/config # Query string to pull configurations with nifi.minifi.notifier.ingestors.pull.http.query=class=iot-minifi-raspberry-agent # Period on which to pull configurations from, defaults to 5 minutes if commented out nifi.minifi.notifier.ingestors.pull.http.period.ms=60000</span></span></code> </pre> <br><p>  Dengan konfigurasi ini, setiap agen MiNiFi akan mengakses server C2 menggunakan protokol REST API di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http: //minifi-c2.iot.local: 10080 / c2 / config</a> setiap menit dan meminta konfigurasi baru untuk kelas agen iot-minifi-raspberry-agent <br>  Poin penting: frekuensi 1 menit ditetapkan hanya untuk demonstrasi.  Dalam lingkungan produksi, Anda kemungkinan besar tidak perlu memperbarui agen dengan frekuensi seperti itu. </p><br><p>  Sebelum memulai agen, mari kita beralih ke level kontrol dan konfigurasikan server MiNiFi C2 dan Apache NiFi itu sendiri. </p><br><h4 id="ustanovka-i-konfigurirovanie-nifi-servera">  Menginstal dan mengonfigurasi server NiFi </h4><br><p>  Instal server NiFi yang dapat diakses dari server C2 dan mulai. </p><br><pre> <code class="bash hljs">wget http://apache.crihan.fr/dist/nifi/1.6.0/nifi-1.6.0-bin.tar.gz tar -xvf nifi-1.6.0-bin.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> nifi-1.6.0 ./bin/nifi.sh start</code> </pre> <br><p>  Sambungkan ke antarmuka NiFi di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http: // nifi-dev: 8080 / nifi /</a> dan buat aliran yang akan berjalan di agen MiNiFi, tapi sebelum itu tambahkan Input Port (ditambahkan dengan menekan tombol Input Port pada menu) di layer root dan beri nama dari Raspberry MiNiFi.  Di sinilah NiFi akan menerima file aliran dari MiNiFi. </p><br><p>  Tambahkan Funnel dan hubungkan Port Input ke Funnel - di artikel mendatang kami akan menyentuh pada pemrosesan data di sisi Apache NiFi. </p><br><p>  Tambahkan Prosesor konsumsiMQTT untuk berlangganan broker Mosquitto dan menandatanganinya di semua topik iot / sensor / * perhatikan bahwa tcp: // raspberrypi: 1883 setara dengan tcp: // localhost: 1883, karena utas ini akan berjalan di Raspberry Pi </p><br><p><img src="https://habrastorage.org/webt/lx/pk/vf/lxpkvfs8-shmdy1newdrmvrxc2w.png"></p><br><p>  Gunakan Processor UpdateAttribute untuk menambahkan atribut "versi", yang akan kami gunakan untuk memberi tahu sistem tentang konfigurasi ulang.  Anda dapat menambahkan atribut tambahan: cap waktu, lokasi, nama agen, dll. </p><br><p><img src="https://habrastorage.org/webt/ah/de/6o/ahde6oblujww3keigvuzk_jjoje.png"></p><br><p>  Terakhir, tambahkan Remote Process Group (RPG) - untuk mengirim acara yang diterima ke NiFi.  Gabungkan ketiga proses ini. </p><br><p><img src="https://habrastorage.org/webt/up/re/sf/upresfdp_hwcku4z4lykpp6upzc.png"></p><br><p>  Aliran Anda sekarang akan terlihat seperti pada tangkapan layar di bawah ini.  Aliran kiri akan diluncurkan pada Apache NiFi sendiri, dan akan menerima data dari Apache MiNiFi.  Utas kanan tidak akan mulai di dalam Apache Nifi, dibuat untuk keperluan prototyping dan konfigurasi, dan akan berjalan di Raspberry Pi. </p><br><p><img src="https://habrastorage.org/webt/9q/jh/fi/9qjhfidv9dmhcxwlbu5bnwtafpk.png"></p><br><p>  Simpan aliran yang tepat sebagai templat bernama "iot-minifi-raspberry-agent.v1".  Prinsip penamaan sangat penting di sini.  Kita harus menggunakan nama yang sama dengan nama kelas yang digunakan dalam konfigurasi MiNiFi. </p><br><p>  <em>Ini sangat penting - Anda perlu menyoroti tidak hanya komponen yang disimpan, tetapi juga hubungan di antara mereka.</em> <em><br></em> </p><br><p><img src="https://habrastorage.org/webt/zw/7u/8p/zw7u8prl5qspooe5igan-b7cy6c.png"></p><br><h4 id="razmeschenie-i-zapusk-prilozheniya">  Penempatan dan peluncuran aplikasi </h4><br><p>  Sebelum meluncurkan agen MiNiFi di Raspberry Pi, mari kita verifikasi bahwa server C2 dikonfigurasi dengan benar.  Buka URL di browser Anda: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http: // c2-server: 10080 / c2 / config? Class = iot-minifi-raspberry-agent &amp; versi = 1</a> C2 Server harus merespons dengan file yang berisi konfigurasi template yang kami buat dalam format YML. </p><br><p><img src="https://habrastorage.org/webt/-2/b-/oj/-2b-oj_o1-wcxszifh4zopzmkd8.png"></p><br><p>  Jika, alih-alih konfigurasi, server melempar Java Exception, Anda mengalami masalah di server C2 yang disebutkan di sini: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/apache/nifi-minifi/pull/126#issuecomment-388856304</a> <br>  Anda harus menginstal versi 0.3.0 atau menghapus file javax.ws.rs-api-2.1.jar dari folder lib direktori server C2. </p><br><p>  Jika Anda melihat log server C2, Anda dapat melihat bahwa server telah menerima permintaan dengan parameter {class = [iot-minifi-raspberry-agent], versi = [1]} </p><br><p><img src="https://habrastorage.org/webt/ov/u_/r-/ovu_r-lyumqz9l_j_qpigysyuoe.png"></p><br><p>  Sekarang setelah koneksi antara komponen arsitektur individual (MQTT, MiNiFi, NiFi dan C2) terbentuk, mulai agen MiNiFi pada Raspberry Pi dengan perintah: </p><br><pre> <code class="bash hljs">./bin/minifi.sh start</code> </pre> <br><p>  Setelah beberapa detik, Anda akan melihat log server C2.  Tuan rumah 192.168.1.50 (dalam kasus kami, alamat IP perangkat Raspberry Pi) meminta server C2 untuk menyediakan versi terbaru dari kelas "iot-minifi-raspberry-agent".  Dibandingkan dengan permintaan kami sebelumnya, yang kami lakukan di browser, Anda dapat mencatat bahwa MiNiFi tidak menunjukkan versi.  Jika Anda membuka konfigurasi agen MiNiFi di ./conf/config.yml, Anda akan melihat konfigurasi yang sama yang kami terima di browser, mengatur permintaan dengan tangan. </p><br><p><img src="https://habrastorage.org/webt/mx/iz/kt/mxizktf5jxyrrqz2k3wtvzjrtx0.png"></p><br><p>  MQTT menunjukkan bahwa agen MiNiFi terhubung ke broker dan berlangganan ke topik iot / sensor / # </p><br><p><img src="https://habrastorage.org/webt/5r/3m/gy/5r3mgyboojzkkldhcmxicengpsu.png"></p><br><h4 id="kontrol-peredavaemyh-dannyh">  Kontrol Transmisi </h4><br><p>  Hebat, sekarang mari kita buat sensor kita mulai menghasilkan data dan menerbitkannya ke MQTT.  MiNiFi akan mulai mengunggah informasi dan mengirim ke NiFi, seperti yang ditunjukkan pada gambar di bawah. </p><br><p>  <em>Penting: Agar komponen Apache NiFi mulai bekerja, Anda harus mengklik tombol Play.</em> <em><br></em> <br><img src="https://habrastorage.org/webt/0z/h_/qu/0zh_qu6j5ftih7dgmupq7we3b4e.png"></p><br><p>  Sekarang, mari kita lihat salah satu tulisan di dalam NiFi.  Informasi berasal dari sensor "iot / sensor / LightIntensity / z", versi aplikasi - 1 </p><br><p><img src="https://habrastorage.org/webt/pj/zh/ie/pjzhiekpoq8vqe4wgipbjxgiwha.png"></p><br><h4 id="obnovlenie-konfiguracii-minifi">  Pembaruan konfigurasi MiNiFi </h4><br><p>  Sekarang setelah infrastruktur kami berfungsi dan data menuju ke "pusat data" kami, mari kita instal konfigurasi MiNiFi baru.  Buka antarmuka Apache NiFi dan edit handler pembaruanAttribute.  Ubah atribut "versi" menjadi 2 alih-alih 1 dan simpan templat "iot-minifi-raspberry-agent.v2" yang baru.  Itu saja.  Konfigurasi baru akan digunakan secara otomatis. </p><br><p>  Anda dapat melihat log server C2 dan melihat bahwa versi baru V2 terdeteksi, server tidak menemukannya dalam cache dan memuatnya. </p><br><p><img src="https://habrastorage.org/webt/cm/-4/sc/cm-4sccwolb-9dnpd4f88fga5pk.png"></p><br><p>  Kemudian MiNiFi menemukan konfigurasi baru, cadangan konfigurasi sebelumnya, membongkar yang baru dan me-restart: </p><br><p><img src="https://habrastorage.org/webt/w-/tv/44/w-tv44lsbcmdb0ckfdnue4r4iya.png"></p><br><blockquote>  Pada artikel selanjutnya, kita akan berbicara tentang bagaimana kita mengumpulkan sensor dan memasukkannya ke dalam arsitektur kita.  Setelah itu, kita akan berbicara tentang analisis data. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id415933/">https://habr.com/ru/post/id415933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id415919/index.html">Refactoring program on Go: akselerasi hingga 23 kali</a></li>
<li><a href="../id415923/index.html">Apakah Persatuan Lambat? Perhatian LINQ</a></li>
<li><a href="../id415925/index.html">MasterCard mematenkan teknologi blockchain anonim</a></li>
<li><a href="../id415927/index.html">Lampu Industri Breeze 50</a></li>
<li><a href="../id415929/index.html">Optimalisasi Arsitektur Kecerdasan Buatan: Perlombaan Dimulai</a></li>
<li><a href="../id415935/index.html">Urutan Penyisipan</a></li>
<li><a href="../id415937/index.html">Roket pribadi Jepang MOMO-2 meledak di landasan peluncuran</a></li>
<li><a href="../id415939/index.html">Pemrosesan Grafik Terdistribusi dengan Spark GraphX</a></li>
<li><a href="../id415941/index.html">Bagaimana kami mencoba mencari barcode dan tidak mengerti apa-apa</a></li>
<li><a href="../id415943/index.html">"Teori Pengembangan Game dan Hiburan": Poin-Poin Utama dari Buku Raff Coster</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>