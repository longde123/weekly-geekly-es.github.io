<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüíª üë∂üèæ üçé Erstellen eines Rhythmus-Spiels in Unity ü§ü üëÇüèæ ‚ô•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung 
 Sie m√∂chten oder haben versucht, ein Rhythmus-Spiel zu erstellen, aber Spielelemente und Musik sind schnell nicht mehr synchron, und jetz...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen eines Rhythmus-Spiels in Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452168/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98c/c5f/e21/98cc5fe21847a5826eb9fb9e396e3379.jpg" alt="Bild"></div><br><h1>  Einf√ºhrung </h1><br>  Sie m√∂chten oder haben versucht, ein Rhythmus-Spiel zu erstellen, aber Spielelemente und Musik sind schnell nicht mehr synchron, und jetzt wissen Sie nicht, was Sie tun sollen.  Dieser Artikel hilft Ihnen dabei.  Ich habe Rhythmus-Spiele von der High School gespielt und oft in der √∂rtlichen Arcade-Halle bei DDR rumgehangen.  Heute bin ich immer auf der Suche nach neuen Spielen dieses Genres und Projekte wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Crypt of the Necrodancer</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bit.Trip.Runner</a> zeigen, dass in diesem Genre noch viel mehr getan werden kann.  Ich habe ein wenig an Prototypen von Rhythmus-Spielen in Unity gearbeitet und als Ergebnis einen Monat damit verbracht, ein kurzes Rhythmus-Spiel / Puzzle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Atomic Beats zu</a> erstellen.  In diesem Artikel werde ich √ºber die n√ºtzlichsten Code-Erstellungstechniken sprechen, die ich beim Erstellen dieser Spiele gelernt habe.  Ich konnte nirgendwo anders Informationen √ºber sie finden, oder sie wurden weniger detailliert dargestellt. <br><br>  Zun√§chst muss ich Yu Chao meine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">tiefe</a> Anerkennung f√ºr den Beitrag von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Music Syncing in Rhythm Games</a> [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úbersetzung in Habr√©</a> ] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aussprechen</a> .  Yu √ºberpr√ºfte die Grundlagen der Synchronisierung von Audio-Timings mit der Game-Engine in Unity und lud den Quellcode f√ºr sein Boots-Cut-Spiel hoch, was mir bei der Erstellung meines Projekts sehr geholfen hat.  Sie k√∂nnen seinen Beitrag studieren, wenn Sie eine kurze Einf√ºhrung in die Musiksynchronisation von Unity erhalten m√∂chten. Ich werde dieses Thema jedoch ausf√ºhrlicher und ausf√ºhrlicher behandeln.  Mein Code verwendet aktiv Informationen aus dem Artikel und dem Boots-Cut-Code. <br><a name="habracut"></a><br>  Das Herzst√ºck eines jeden Rhythmus-Spiels sind Timings.  Die Menschen reagieren √§u√üerst empfindlich auf Verzerrungen in den Rhythmus-Timings. Daher ist es sehr wichtig, dass alle Aktionen, Bewegungen und Eingaben im Rhythmus-Spiel direkt mit der Musik synchronisiert werden.  Leider verlieren herk√∂mmliche Unity- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeiterfassungsmethoden</a> wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Time.timeSinceLevelLoad</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Time.time</a> schnell die Synchronisation mit dem abgespielten Sound.  Daher greifen wir direkt mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AudioSettings.dspTime</a> auf das Audiosystem zu, das die wahre Anzahl der vom Audiosystem verarbeiteten Audio-Samples verwendet.  Dank dessen bleibt die Synchronisation mit der wiedergegebenen Musik immer erhalten (m√∂glicherweise ist dies bei sehr langen Audiodateien nicht der Fall, wenn Sampling-Effekte ins Spiel kommen, aber bei Songs normaler L√§nge sollte das System einwandfrei funktionieren).  Diese Funktion wird der Kern unserer Kompositionszeiterfassung sein, und basierend darauf werden wir die Hauptklasse erstellen. <br><br><h1>  Klassenleiter </h1><br>  Die Dirigentenklasse ist die Hauptkompositionsverwaltungsklasse, auf deren Grundlage der Rest des Rhythmus-Spiels aufgebaut wird.  Damit verfolgen wir die Position der Komposition und verwalten alle anderen synchronisierten Aktionen.  Um die Komposition zu verfolgen, ben√∂tigen wir einige Variablen <br><br><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Song beats per minute //This is determined by the song you're trying to sync up to public float songBpm; //The number of seconds for each song beat public float secPerBeat; //Current song position, in seconds public float songPosition; //Current song position, in beats public float songPositionInBeats; //How many seconds have passed since the song started public float dspSongTime; //an AudioSource attached to this GameObject that will play the music. public AudioSource musicSource;</span></span></code> </pre> <br>  Wenn wir die Szene starten, m√ºssen wir Berechnungen durchf√ºhren, um die Variablen zu bestimmen, und als Referenz die Zeit aufzeichnen, zu der der Song gestartet wurde. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Load the AudioSource attached to the Conductor GameObject musicSource = GetComponent&lt;AudioSource&gt;(); //Calculate the number of seconds in each beat secPerBeat = 60f / songBpm; //Record the time when the music starts dspSongTime = (float)AudioSettings.dspTime; //Start the music musicSource.Play(); }</span></span></code> </pre> <br>  Wenn Sie ein leeres GameObject mit einem solchen Skript erstellen und dann die Audioquelle mit der Komposition hinzuf√ºgen und das Programm ausf√ºhren, sehen Sie, dass das Skript die Startzeit der Komposition aufzeichnet, aber nichts anderes passiert.  Wir m√ºssen auch den BPM der Musik, die wir der Audioquelle hinzuf√ºgen, manuell eingeben. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7fc/3ac/550/7fc3ac5504438ff8bd050c50283250c6.png"></div><br>  Dank all dieser Werte k√∂nnen wir die Position in der Komposition bei der Aktualisierung des Spiels in Echtzeit verfolgen.  Wir werden den Zeitpunkt der Komposition zuerst in Sekunden, dann in Br√ºchen bestimmen.  Br√ºche sind eine viel bequemere M√∂glichkeit, eine Komposition zu verfolgen, da sie es uns erm√∂glichen, Aktionen und Timings parallel zur Komposition hinzuzuf√ºgen, beispielsweise in den Br√ºchen 1, 3 und 5.5, ohne dass Sekunden zwischen Br√ºchen berechnet werden m√ºssen.  F√ºgen Sie der Update () - Funktion der Conductor-Klasse die folgenden Berechnungen hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//determine how many seconds since the song started songPosition = (float)(AudioSettings.dspTime - dspSongTime); //determine how many beats since the song started songPositionInBeats = songPosition / secPerBeat; }</span></span></code> </pre> <br>  So erhalten wir die Differenz zwischen der aktuellen Zeit gem√§√ü dem Audiosystem und der Startzeit der Komposition, die die Gesamtzahl der Sekunden angibt, in denen die Komposition abgespielt wird.  Wir werden es in der songPosition-Variablen speichern. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/84e/f20/a32/84ef20a3208c566d97332c89549c5a7a.png"></div><br>  Beachten Sie, dass die Partitur in der Musik normalerweise mit einer Einheit mit den Br√ºchen 1-2-3-4 usw. beginnt und songPositionInBeats bei 0 beginnt und von diesem Wert an zunimmt, sodass der dritte Teil der Komposition songPositionInBeats entspricht, also 2,0 und nicht 3,0. <br><br>  Wenn Sie zu diesem Zeitpunkt ein traditionelles Spiel im Dance Dance Revolution-Stil erstellen m√∂chten, m√ºssen Sie Notizen entsprechend dem Bruch erstellen, in den Sie sie dr√ºcken m√ºssen, ihre Position relativ zur Klicklinie interpolieren und dann songPositionInBeats aufzeichnen, wenn die Taste gedr√ºckt wird, und Vergleichen Sie den Wert mit dem gew√ºnschten Notenanteil.  Yu Chao diskutiert in seinem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> ein Beispiel f√ºr ein solches Schema.  Um mich nicht zu wiederholen, werde ich andere potenziell n√ºtzliche Techniken in Betracht ziehen, die auf der Conductor-Klasse aufbauen k√∂nnen.  Ich habe sie beim Erstellen von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Atomic Beats verwendet</a> . <br><br><h1>  Wir passen uns dem urspr√ºnglichen Anteil an </h1><br>  Wenn Sie Ihre eigene Musik f√ºr ein Rhythmus-Spiel erstellen, ist es einfach, den ersten Schlag genau auf den Beginn der Musik abzustimmen. Wenn BPM dies korrekt angibt, wird die Conductor-Klasse songPositionInBeats zuverl√§ssig an die Komposition gebunden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/56a/acd/dfd/56aacddfd077d0d5890fdea4acb9d667.png"></div><br>  Wenn Sie jedoch vorgefertigte Musik verwenden, besteht eine hohe Wahrscheinlichkeit, dass vor Beginn der Komposition eine kurze Pause eingelegt wird.  Wenn dies nicht ber√ºcksichtigt wird, glaubt die Conductor-Klasse songPositionInBeats, dass der erste Beat zu Beginn des Songs gestartet wurde und nicht der Beat jetzt.  Alles, was weiter an die Werte der Aktien gebunden ist, wird nicht mit der Musik synchronisiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/981/9cc/e24/9819cce244fe54f954e0205345ec86fb.png"></div><br>  Um dies zu beheben, k√∂nnen Sie eine Variable hinzuf√ºgen, die diesen Versatz ber√ºcksichtigt.  F√ºgen Sie der Conductor-Klasse Folgendes hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//The offset to the first beat of the song in seconds public float firstBeatOffset;</span></span></code> </pre> <br>  In Update () ist die Variable songPosition: <br><br><pre> <code class="cs hljs">songPosition = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(AudioSettings.dspTime - dspSongTime);</code> </pre> <br>  ersetzt durch: <br><br><pre> <code class="cs hljs">songPosition = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(AudioSettings.dspTime - dspSongTime - firstBeatOffset);</code> </pre> <br>  Jetzt berechnet songPosition die Position im Song korrekt, wobei der wahre erste Schlag ber√ºcksichtigt wird.  Sie m√ºssen jedoch den Versatz zum ersten Schlag manuell eingeben, damit er f√ºr jede Datei eindeutig ist.  Zus√§tzlich wird es w√§hrend dieser Verschiebung ein kurzes Fenster geben, in dem sich songPosition als negativ herausstellt.  Dies hat m√∂glicherweise keine Auswirkungen auf das Spiel, aber ein Code, der von den Werten von songPosition oder songPositionInBeats abh√§ngt, kann derzeit m√∂glicherweise keine negativen Zahlen verarbeiten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/125/bfd/ab7/125bfdab794789a5920f1ef07bea8a26.png"><br><br><h1>  Wiederholungen </h1><br>  Wenn Sie mit einer Komposition arbeiten, die von Anfang bis Ende abgespielt wird, reicht die oben gezeigte Dirigentenklasse aus, um die Position zu verfolgen.  Wenn Sie jedoch eine kurze Spur haben, die geloopt ist, und mit dieser Schleife arbeiten m√∂chten, m√ºssen Sie die Repeater-Unterst√ºtzung in Conductor einbauen. <br><br>  Wenn Sie ein perfekt gelooptes Fragment (z. B. wenn das Songtempo 120 bpm betr√§gt und das geloopte Fragment eine L√§nge von 4 Beats hat, sollte es genau 8,0 Sekunden bei 2,0 Sekunden pro Freigabe sein) in die Audio Source-Klasse der Conductor-Klasse geladen haben, aktivieren Sie das Loop-Kontrollk√§stchen.  Der Dirigent funktioniert auf die gleiche Weise wie zuvor und √ºbertr√§gt die Gesamtzeit nach dem <em>ersten</em> Start des Clips an songPosition.  Um die Position der Schleife zu bestimmen, m√ºssen wir Conductor irgendwie mitteilen, wie viele Freigaben sich in einer Schleife befinden und wie viele Schleifen bereits gespielt wurden.  F√ºgen Sie der Conductor-Klasse die folgenden Variablen hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//the number of beats in each loop public float beatsPerLoop; //the total number of loops completed since the looping clip first started public int completedLoops = 0; //The current position of the song within the loop in beats. public float loopPositionInBeats;</span></span></code> </pre> <br>  Jetzt k√∂nnen wir mit jedem Update von SongPositionInBeats auch die Update () - Position der Schleife aktualisieren. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//calculate the loop position if (songPositionInBeats &gt;= (completedLoops + 1) * beatsPerLoop) completedLoops++; loopPositionInBeats = songPositionInBeats - completedLoops * beatsPerLoop;</span></span></code> </pre> <br>  Dies gibt uns einen Marker, der loopPositionInBeats mitteilt, wie viele Freigaben wir durch die Schleife gegangen sind, was f√ºr viele andere synchronisierte Elemente n√ºtzlich ist.  Denken Sie daran, die Anzahl der Freigaben der Schleife in GameObject Conductor einzugeben. <br><br>  Wir sollten auch die Berechnung der Aktien sorgf√§ltig pr√ºfen.  Musik beginnt immer bei 1, daher nimmt die 4-teilige Messung die Form 1-2-3-4- an, und in unserer Klasse beginnt loopPositionInBeats bei 0,0 und f√ºhrt Schleifen √ºber 4,0 durch.  Daher hat die exakte Mitte der Schleife, die bei der Berechnung der musikalischen Proportionen 3 betr√§gt, in loopPositionInBeats einen Wert von 2,0.  Sie k√∂nnen loopPositionInBeats √§ndern, um dies zu ber√ºcksichtigen. Dies wirkt sich jedoch auf alle anderen Berechnungen aus. Seien Sie daher beim Einf√ºgen von Notizen vorsichtig. <br><br>  Auch f√ºr die verbleibenden Tools ist es hilfreich, der Conductor-Klasse zwei weitere Aspekte hinzuzuf√ºgen.  Erstens eine analoge Version von LoopPositionInBeats namens LoopPositionInAnalog, die die Position in der Schleife im Bereich von 0 bis 1,0 misst.  Die zweite ist eine Instanz der Conductor-Klasse zum bequemen Aufrufen von anderen Klassen.  F√ºgen Sie der Conductor-Klasse die folgenden Variablen hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//The current relative position of the song within the loop measured between 0 and 1. public float loopPositionInAnalog; //Conductor instance public static Conductor instance;</span></span></code> </pre> <br>  F√ºgen Sie in der Funktion Awake () Folgendes hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { instance = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br>  und zur Funktion Update () hinzuf√ºgen: <br><br><pre> <code class="cs hljs">loopPositionInAnalog = loopPositionInBeats / beatsPerLoop;</code> </pre> <br><h1>  Synchronisieren </h1><br>  Es w√§re sehr n√ºtzlich, Bewegung oder Rotation mit den Lappen zu synchronisieren, damit sich die Elemente an den richtigen Stellen befinden.  In meinem Atomic Beats-Spiel habe ich damit Noten dynamisch um eine Mittelachse gedreht.  Zun√§chst wurden sie entsprechend ihrem Anteil innerhalb der Schleife um den Umfang gelegt, und dann wurde der gesamte Spielbereich gedreht, so dass die Noten mit der Depressionslinie in ihrem Anteil √ºbereinstimmten. <br><br>  Erstellen Sie dazu ein neues Skript namens SyncedRotation und h√§ngen Sie es an das GameObject an, das Sie drehen m√∂chten.  F√ºgen Sie der Update () - Funktion des SyncedRotation-Skripts Folgendes hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject.transform.rotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, Mathf.Lerp(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">360</span></span>, Conductor.instance.loopPositionInAnalog)); }</code> </pre> <br>  Dieser Code interpoliert die Drehung des GameObjects, an das dieses Spiel gebunden ist, im Intervall von 0 bis 360 Grad und dreht es so, dass es am Ende jeder Schleife eine volle Umdrehung vollendet.  Dies ist als Beispiel n√ºtzlich, aber f√ºr Loop- oder Frame-f√ºr-Frame-Animationen w√§re es sinnvoller, Loop-Animationen so zu synchronisieren, dass sie perfekt zum Tempo passen. <br><br><h1>  Animationssynchronisierung </h1><br>  Unity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Animator ist</a> extrem leistungsf√§hig, aber nicht immer genau.  F√ºr eine zuverl√§ssige Ausrichtung von Animationen und Musik musste ich mich mit der Animator-Klasse und ihrer Tendenz messen, sich allm√§hlich mit dem Tempo zu synchronisieren.  Au√üerdem war es schwierig, dieselben Animationen an unterschiedliche Tempi anzupassen, sodass Sie beim Umschalten zwischen Kompositionen die Keyframes der Animation nicht auf das aktuelle Tempo neu definieren mussten.  Stattdessen k√∂nnen wir direkt zur Animationsschleife gehen und die Position in dieser Schleife entsprechend der Position in der Schleife der Conductor-Klasse festlegen. <br><br>  Erstellen Sie zun√§chst eine neue Klasse mit dem Namen SyncedAnimation und f√ºgen Sie die folgenden Variablen hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//The animator controller attached to this GameObject public Animator animator; //Records the animation state or animation that the Animator is currently in public AnimatorStateInfo animatorStateInfo; //Used to address the current state within the Animator using the Play() function public int currentState;</span></span></code> </pre> <br>  H√§ngen Sie es an ein neues oder vorhandenes GameObject an, das Sie animieren m√∂chten.  In diesem Beispiel bewegen wir das Objekt einfach √ºber den Bildschirm hin und her. Das gleiche Prinzip kann jedoch auf jede Animation angewendet werden, sei es vor dem Festlegen der Eigenschaft oder auf eine Einzelbildanimation.  F√ºgen Sie GameObject ein Animator-Element hinzu und erstellen Sie einen neuen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Animator-Controller</a> namens SyncedAnimController sowie einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Animationsclip</a> namens BackAndForth.  Wir laden den Controller in die Animator-Klasse, die an das GameObject angeh√§ngt ist, und f√ºgen dem Animationsbaum als Standardanimation Animation hinzu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5f/582/0e3/d5f5820e383580dbc69b18dd037a67a1.png"></div><br>  Zum Beispiel habe ich die Animation so eingerichtet, dass das Objekt zuerst um 6 Einheiten nach rechts, dann um -6 nach links und dann zur√ºck auf 0 verschoben wird. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbc/d3a/0b9/dbcd3a0b909bb95cc0a91aaf2eaf65e0.png"></div><br>  F√ºgen Sie nun zum Synchronisieren der Animation den folgenden Code zur Start () - Funktion der SyncedAnimation-Klasse hinzu, mit der Informationen zum Animator initialisiert werden: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Load the animator attached to this object animator = GetComponent&lt;Animator&gt;(); //Get the info about the current animator state animatorStateInfo = animator.GetCurrentAnimatorStateInfo(0); //Convert the current state name to an integer hash for identification currentState = animatorStateInfo.fullPathHash; }</span></span></code> </pre> <br>  F√ºgen Sie dann den folgenden Code zu Update () hinzu, um die Animation festzulegen: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Start playing the current animation from wherever the current conductor loop is animator.Play(currentState, -1, (Conductor.instance.loopPositionInAnalog)); //Set the speed to 0 so it will only change frames when you next update it animator.speed = 0; }</span></span></code> </pre> <br>  Wir positionieren die Animation also im exakten Rahmen der Animation relativ zu einer vollst√§ndigen Schleife.  Wenn Sie beispielsweise die obige Animation verwenden und sich in der Mitte der Schleife befinden, wird die GameObject-Position nur 0 √ºberschreiten. Dies kann auf jede Animation angewendet werden, die Sie erstellen und die Sie mit dem Conductor-Tempo synchronisieren m√∂chten. <br><br>  Es ist auch erw√§hnenswert, dass Sie zum Erstellen einer nahtlosen Schleife von Animationen die Tangenten einzelner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Keyframes der Animation</a> auf der Animationskurve konfigurieren m√ºssen.  Mit der Einstellung "Linear" wird eine gerade Linie von einem Keyframe zum n√§chsten erstellt, und Constant beh√§lt die Animation bis zum n√§chsten Keyframe in einem Wert bei, wodurch eine ruckartige und scharfe Bewegung erzielt wird. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4c/68e/db4/f4c68edb4ab3e874379d8f6874b74fea.png"></div><br>  Obwohl diese Methode n√ºtzlich ist, wirkt sie sich auf alle √úberg√§nge der Animation aus, da sie dazu f√ºhrt, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">animationState</a> in dem Zustand bleibt, in dem es sich befand, als das Skript urspr√ºnglich ausgef√ºhrt wurde.  Diese Methode ist n√ºtzlich f√ºr Objekte, die nur eine synchronisierte Animation endlos verwenden m√ºssen. Um jedoch komplexere Objekte mit unterschiedlichen synchronisierten Animationen zu erstellen, m√ºssen Sie Code hinzuf√ºgen, der diese √úberg√§nge verarbeitet und die Variable currentState entsprechend dem gew√ºnschten Animationsstatus festlegt. <br><br><h1>  Fazit </h1><br>  Dies sind nur einige der Aspekte, die mir bei der Erstellung von Atomic Beats geholfen haben.  Einige von ihnen wurden aus anderen Quellen gesammelt oder aus der Not heraus erstellt, aber die meisten konnte ich nicht in der fertigen Form finden, also hoffe ich, dass dies n√ºtzlich ist!  Vielleicht ist ein Teil meines Systems aufgrund von CPU- oder Audiosystembeschr√§nkungen in gro√üen Projekten nicht mehr n√ºtzlich, aber es ist eine gute Grundlage f√ºr das Spielen eines Game Jam oder eines Hobbyprojekts. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ae/2a4/f7b/9ae2a4f7be098cc23e5b7283d5b1b9ba.png" alt="Bild"></div><br>  Das Erstellen eines Rhythmus-Spiels oder von mit Musik synchronisierten Spielelementen kann schwierig sein.  Um alles in einem konstanten Tempo zu halten, ben√∂tigen Sie m√∂glicherweise einen kniffligen Code. Ein Ergebnis, mit dem Sie in einem konstanten Tempo spielen k√∂nnen, kann f√ºr den Spieler sehr attraktiv sein.  In diesem Genre kann viel mehr getan werden als Spiele im traditionellen Dance Dance Revolution-Stil, und ich hoffe, dieser Artikel hilft Ihnen bei der Realisierung solcher Projekte.  Ich empfehle au√üerdem, wenn m√∂glich, mein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Atomic Beats-</a> Spiel zu evaluieren.  Ich habe es in einem Monat im Fr√ºhjahr dieses Jahres geschafft, es hat 8 kurze Tracks und es ist kostenlos! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452168/">https://habr.com/ru/post/de452168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452152/index.html">Welche L√∂sungen hat Rostelecom f√ºr IIoT?</a></li>
<li><a href="../de452154/index.html">Virtueller Cube - Anstelle von OLAP</a></li>
<li><a href="../de452158/index.html">TOPchik - ein offenes WordPress-Plugin zur kostenlosen √úberpr√ºfung der Site-Positionen f√ºr Suchanfragen √ºber die Yandex.XML-API</a></li>
<li><a href="../de452162/index.html">Bot f√ºr VK auf Python mit MySQL in einer Stunde, Teil 1</a></li>
<li><a href="../de452164/index.html">ModLook - ModBus-Registerscanner. Wir feiern den 20. Jahrestag des Programms</a></li>
<li><a href="../de452172/index.html">Komplexe Systeme. Erreichen eines kritischen Niveaus</a></li>
<li><a href="../de452174/index.html">Er braucht dich nicht</a></li>
<li><a href="../de452178/index.html">Analyse: 23 beliebte Fehler in geschriebenem Englisch und wie man sie vermeidet</a></li>
<li><a href="../de452180/index.html">Wir steigern die Leistung von SSD von den Knien aus, wo und warum zu klicken ist</a></li>
<li><a href="../de452182/index.html">Befragung von Mitarbeitern. Der Hauptfehler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>