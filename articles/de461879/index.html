<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÅ üì§ üîô Das Buch "Linux in Aktion" üéûÔ∏è üñ±Ô∏è üöï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo habrozhiteli! In dem Buch beschreibt David Clinton 12 reale Projekte, darunter die Automatisierung eines Sicherungs- und Wiederherstellungssyste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Das Buch "Linux in Aktion"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/461879/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/d4/en/xh/d4enxhes8pqnlk78urqxopa7ley.jpeg" align="left" alt="Bild"></a>  Hallo habrozhiteli!  In dem Buch beschreibt David Clinton 12 reale Projekte, darunter die Automatisierung eines Sicherungs- und Wiederherstellungssystems, das Einrichten einer pers√∂nlichen Dateibolke im Dropbox-Stil und das Erstellen eines eigenen MediaWiki-Servers.  Anhand interessanter Beispiele erfahren Sie mehr √ºber Virtualisierung, Notfallwiederherstellung, Sicherheit, Sicherung, Bereitstellung von DevOps und Fehlerbehebung bei Systemproblemen.  Jedes Kapitel endet mit einer √úberpr√ºfung der praktischen Empfehlungen, einem Glossar neuer Begriffe und √úbungen. <br><br><h3>  Auszug "10.1.  Erstellen eines OpenVPN-Tunnels ¬ª </h3><br><a name="habracut"></a>  In diesem Buch habe ich bereits viel √ºber Verschl√ºsselung gesprochen.  SSH und SCP k√∂nnen Daten sch√ºtzen, die √ºber Remoteverbindungen √ºbertragen werden (Kapitel 3), die Dateiverschl√ºsselung erm√∂glicht den Schutz von Daten beim Speichern auf dem Server (Kapitel 8) und TLS / SSL-Zertifikate k√∂nnen Daten w√§hrend der √úbertragung zwischen Standorten und Client-Browsern sch√ºtzen (Kapitel 9).  Manchmal m√ºssen Ihre Daten jedoch in einem gr√∂√üeren Bereich von Verbindungen gesch√ºtzt werden.  Es ist beispielsweise m√∂glich, dass einige Mitglieder Ihres Teams unterwegs arbeiten und √ºber √∂ffentliche Zugangspunkte √ºber WLAN eine Verbindung zum Netzwerk herstellen m√ºssen.  Sie sollten auf keinen Fall davon ausgehen, dass alle diese Zugriffspunkte sicher sind, aber Ihre Mitarbeiter ben√∂tigen wirklich eine M√∂glichkeit, eine Verbindung zu Unternehmensressourcen herzustellen. In diesem Fall hilft ein VPN. <br><br>  Ein ordnungsgem√§√ü gestalteter VPN-Tunnel bietet eine direkte Verbindung zwischen Remoteclients und dem Server, sodass Daten ausgeblendet werden, wenn sie √ºber ein unsicheres Netzwerk √ºbertragen werden.  Na und?  Sie haben bereits viele Tools gesehen, die dies mit Verschl√ºsselung tun k√∂nnen.  Der wahre Wert von VPNs besteht darin, dass Sie durch √ñffnen des Tunnels Remote-Netzwerke verbinden k√∂nnen, als w√§ren sie alle zusammen lokal.  In gewissem Sinne verwenden Sie eine Problemumgehung. <br><br>  Mit einem solchen erweiterten Netzwerk k√∂nnen Administratoren ihre Arbeit von √ºberall aus auf ihren Servern erledigen.  Noch wichtiger ist jedoch, dass ein Unternehmen mit Ressourcen, die auf mehrere Niederlassungen verteilt sind, diese f√ºr alle Gruppen sichtbar und zug√§nglich machen kann, die sie ben√∂tigen, wo immer sie sich befinden (Abb. 10.1). <br><br>  Der Tunnel selbst garantiert keine Sicherheit.  Einer der Verschl√ºsselungsstandards kann jedoch in die Netzwerkstruktur aufgenommen werden, wodurch das Sicherheitsniveau erheblich erh√∂ht wird.  Tunnel, die mit dem Open Source OpenVPN-Paket erstellt wurden, verwenden dieselbe TLS / SSL-Verschl√ºsselung, √ºber die Sie bereits gelesen haben.  OpenVPN ist nicht die einzige Option f√ºr den Tunnelbau, sondern eine der bekanntesten.  Es wird angenommen, dass es etwas schneller und sicherer ist als ein alternatives Schicht-2-Tunnelprotokoll, das IPSec-Verschl√ºsselung verwendet. <br><br>  M√∂chten Sie, dass jeder in Ihrem Team sicher miteinander kommuniziert, wenn Sie unterwegs sind oder in verschiedenen Geb√§uden arbeiten?  Dazu m√ºssen Sie einen OpenVPN-Server erstellen, um die Anwendungsfreigabe und den Zugriff auf die lokale Netzwerkumgebung des Servers zu erm√∂glichen.  Damit dies funktioniert, reicht es aus, zwei virtuelle Maschinen oder zwei Container zu starten: eine als Server / Host und die andere als Client.  Das Erstellen eines VPN ist kein einfacher Vorgang. Es lohnt sich daher wahrscheinlich, sich ein paar Minuten Zeit zu nehmen, um sich einen √úberblick zu verschaffen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vg/gc/o1/vggco1j4npzsjj4rqo8r-5bzmz8.png" alt="Bild"></div><br><h3>  10.1.1.  OpenVPN Server konfigurieren </h3><br>  Bevor Sie beginnen, werde ich Ihnen n√ºtzliche Ratschl√§ge geben.  Wenn Sie alles selbst erledigen (und ich kann es Ihnen nur empfehlen), werden Sie wahrscheinlich feststellen, dass Sie mit mehreren auf dem Desktop ge√∂ffneten Terminalfenstern arbeiten, von denen jedes mit dem Computer verbunden ist.  Es besteht die Gefahr, dass Sie irgendwann den falschen Befehl in das Fenster eingeben.  Um dies zu vermeiden, k√∂nnen Sie den Befehl hostname verwenden, um den in der Befehlszeile angezeigten Computernamen in einen Namen zu √§ndern, der Ihnen klar sagt, wo Sie sich befinden.  Sobald Sie dies tun, m√ºssen Sie den Server beenden und sich erneut anmelden, damit die neuen Einstellungen wirksam werden.  So sieht es aus: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b8/d9/o9/b8d9o9pzt2-m5-rtirtr46hl1lu.png" alt="Bild"></div><br>  Wenn Sie diesen Ansatz einhalten und den einzelnen Maschinen, mit denen Sie arbeiten, die entsprechenden Namen zuweisen, k√∂nnen Sie leicht verfolgen, wo Sie sich befinden. <br><br><blockquote>  Nach der Verwendung von Hostname kann es zu l√§stigen Meldungen kommen, dass Host OpenVPN-Server-Nachrichten nicht aufgel√∂st werden k√∂nnen, wenn Sie die folgenden Befehle ausf√ºhren.  Das Aktualisieren der Datei / etc / hosts mit dem entsprechenden neuen Hostnamen sollte das Problem beheben. </blockquote><br><h3>  Vorbereiten Ihres Servers f√ºr OpenVPN </h3><br>  F√ºr die Installation von OpenVPN auf Ihrem Server sind zwei Pakete erforderlich: openvpn und easy-rsa (um den Prozess der Generierung des Verschl√ºsselungsschl√ºssels zu steuern).  Bei Bedarf m√ºssen CentOS-Benutzer zuerst das Epel-Release-Repository installieren, wie in Kapitel 2 beschrieben. Um den Zugriff auf die Serveranwendung zu √ºberpr√ºfen, k√∂nnen Sie auch den Apache-Webserver (Apache2 f√ºr Ubuntu und httpd unter CentOS) installieren. <br><br>  W√§hrend Sie den Server einrichten, empfehle ich Ihnen, eine Firewall zu aktivieren, die alle Ports au√üer 22 (SSH) und 1194 (der Standard-OpenVPN-Port) blockiert.  Dieses Beispiel zeigt, wie ufw unter Ubuntu funktioniert, aber ich bin sicher, dass Sie sich noch an das Firewall-CentOS-Programm aus Kapitel 9 erinnern: <br><br><pre><code class="javascript hljs"># ufw enable # ufw allow <span class="hljs-number"><span class="hljs-number">22</span></span> # ufw allow <span class="hljs-number"><span class="hljs-number">1194</span></span></code> </pre> <br>  Um internes Routing zwischen Netzwerkschnittstellen auf dem Server zu erm√∂glichen, m√ºssen Sie eine Zeile (net.ipv4.ip_forward = 1) in der Datei /etc/sysctl.conf auskommentieren.  Auf diese Weise k√∂nnen Sie Remoteclients nach der Verbindung nach Bedarf umleiten.  F√ºhren Sie sysctl -p aus, damit der neue Parameter funktioniert: <br><br><pre> <code class="javascript hljs"># nano /etc/sysctl.conf # sysctl -p</code> </pre> <br>  Jetzt ist die Serverumgebung vollst√§ndig konfiguriert, aber es gibt noch etwas zu tun, bevor Sie bereit sind: Sie m√ºssen die folgenden Schritte ausf√ºhren (wir werden sie im Folgenden genauer betrachten). <br><br><ol><li>  Erstellen Sie auf dem Server einen Schl√ºsselsatz zum Verschl√ºsseln der Public-Key-Infrastruktur (PKI) mithilfe der mit dem easy-rsa-Paket gelieferten Skripts.  Im Wesentlichen fungiert der OpenVPN-Server auch als eigene Zertifizierungsstelle (CA). </li><li>  Bereiten Sie die entsprechenden Schl√ºssel f√ºr den Client vor </li><li>  Konfigurieren Sie die Datei server.conf f√ºr den Server </li><li>  Konfigurieren Sie Ihren OpenVPN-Client </li><li>  √úberpr√ºfen Sie Ihr VPN </li></ol><br><h3>  Generierung von Verschl√ºsselungsschl√ºsseln </h3><br>  Um Ihr Leben nicht zu verkomplizieren, k√∂nnen Sie Ihre Schl√ºsselinfrastruktur auf demselben Computer konfigurieren, auf dem der OpenVPN-Server ausgef√ºhrt wird.  Sicherheitsempfehlungen empfehlen jedoch normalerweise die Verwendung eines separaten CA-Servers f√ºr Bereitstellungen in einer Produktionsumgebung.  Der Prozess des Generierens und Zuweisens von Verschl√ºsselungsschl√ºsselressourcen zur Verwendung in OpenVPN ist in Abb. 2 dargestellt.  10.2. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rw/vl/a0/rwvla0o86yzylrzsytcf--7bnms.png" alt="Bild"></div><br>  Bei der Installation von OpenVPN wurde das Verzeichnis / etc / openvpn / automatisch erstellt, es ist jedoch noch nichts darin enthalten.  Die Pakete openvpn und easy-rsa enthalten Beispielvorlagendateien, die Sie als Grundlage f√ºr Ihre Konfiguration verwenden k√∂nnen.  Um den Zertifizierungsprozess zu starten, kopieren Sie das easy-rsa-Vorlagenverzeichnis von / usr / share / nach / etc / openvpn und wechseln Sie in das easy-rsa / -Verzeichnis: <br><br><pre> <code class="javascript hljs"># cp -r /usr/share/easy-rsa/ <span class="hljs-regexp"><span class="hljs-regexp">/etc/</span></span>openvpn $ cd /etc/openvpn/easy-rsa</code> </pre> <br>  Das easy-rsa-Verzeichnis enth√§lt nun einige Skripte.  In der Tabelle.  10.1 listet die Tools auf, mit denen Sie Schl√ºssel erstellen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ih/zx/zt/ihzxztprk0hm0gr9ozc8sz9qsgs.png" alt="Bild"></div><br><blockquote>  Diese Vorg√§nge erfordern Root-Rechte. Durch sudo su m√ºssen Sie also root werden. </blockquote><br>  Die erste Datei, mit der Sie arbeiten, hei√üt vars und enth√§lt die Umgebungsvariablen, die easy-rsa beim Generieren von Schl√ºsseln verwendet.  Sie m√ºssen die Datei bearbeiten, um Ihre eigenen Werte anstelle der bereits vorhandenen Standardwerte zu verwenden.  So sieht meine Datei aus (Listing 10.1). <br><br>  Listing 10.1.  Die Hauptfragmente der Datei / etc / openvpn / easy-rsa / vars <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> KEY_COUNTRY=<span class="hljs-string"><span class="hljs-string">"CA"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> KEY_PROVINCE=<span class="hljs-string"><span class="hljs-string">"ON"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> KEY_CITY=<span class="hljs-string"><span class="hljs-string">"Toronto"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> KEY_ORG=<span class="hljs-string"><span class="hljs-string">"Bootstrap IT"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> KEY_EMAIL=<span class="hljs-string"><span class="hljs-string">"info@bootstrap-it.com"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> KEY_OU=<span class="hljs-string"><span class="hljs-string">"IT"</span></span></code> </pre> <br>  Durch Ausf√ºhren der vars-Datei k√∂nnen Sie ihre Werte in die Shell-Umgebung √ºbertragen, von wo aus sie in den Inhalt Ihrer neuen Schl√ºssel aufgenommen werden.  Warum funktioniert der sudo-Befehl nicht alleine?  Denn in der ersten Phase bearbeiten wir das Skript namens vars und wenden es dann an.  Anwendung und bedeutet, dass die vars-Datei ihre Werte in die Shell-Umgebung √ºbertr√§gt, von wo aus sie in den Inhalt Ihrer neuen Schl√ºssel aufgenommen werden. <br><br>  Stellen Sie sicher, dass Sie die Datei mithilfe der neuen Shell erneut ausf√ºhren, um den nicht abgeschlossenen Vorgang abzuschlie√üen.  Wenn dies erledigt ist, werden Sie vom Skript aufgefordert, ein anderes Skript (clean-all) auszuf√ºhren, um Inhalte aus dem Verzeichnis / etc / openvpn / easy-rsa / keys / zu entfernen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2v/b4/ot/2vb4otncxyedhork8j0cs29s_64.png" alt="Bild"></div><br>  Der n√§chste Schritt besteht nat√ºrlich darin, das Clean-All-Skript auszuf√ºhren, gefolgt von build-ca, das das Stammzertifikat mithilfe des pkitool-Skripts erstellt.  Sie werden aufgefordert, die von vars bereitgestellten Authentifizierungseinstellungen zu best√§tigen: <br><br><pre> <code class="javascript hljs"># ./clean-all # ./build-ca Generating a <span class="hljs-number"><span class="hljs-number">2048</span></span> bit RSA private key</code> </pre> <br>  Als n√§chstes kommt das Build-Key-Server-Skript.  Da dasselbe pkitool-Skript zusammen mit dem neuen Stammzertifikat verwendet wird, werden dieselben Fragen angezeigt, um die Erstellung des Schl√ºsselpaars zu best√§tigen.  Die Schl√ºssel erhalten Namen basierend auf den von Ihnen √ºbergebenen Argumenten. Wenn Sie nicht mehrere VPNs auf diesem Computer starten, handelt es sich normalerweise um Server, wie im Beispiel: <br><br><pre> <code class="javascript hljs"># ./build-key-server server [...] Certificate is to be certified until Aug <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span> <span class="hljs-number"><span class="hljs-number">2027</span></span> GMT (<span class="hljs-number"><span class="hljs-number">3650</span></span> days) Sign the certificate? [y/n]:y <span class="hljs-number"><span class="hljs-number">1</span></span> out <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> certificate requests certified, commit? [y/n]y Write out database <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> entries Data Base Updated</code> </pre> <br>  OpenVPN verwendet die vom Diffie-Hellman-Algorithmus (unter Verwendung von build-dh) generierten Parameter, um die Authentifizierung f√ºr neue Verbindungen auszuhandeln.  Die hier erstellte Datei sollte nicht geheim sein, sondern muss mit dem Build-Dh-Skript f√ºr die derzeit aktiven RSA-Schl√ºssel generiert werden.  Wenn Sie in Zukunft neue RSA-Schl√ºssel erstellen, m√ºssen Sie die Datei auch basierend auf dem Diffie-Hellman-Algorithmus aktualisieren: <br><br><pre> <code class="javascript hljs"># ./build-dh</code> </pre> <br>  Ihre serverseitigen Schl√ºssel befinden sich jetzt im Verzeichnis / etc / openvpn / easy-rsa / keys /, OpenVPN wei√ü dies jedoch nicht.  Standardm√§√üig sucht OpenVPN in / etc / openvpn / nach Schl√ºsseln. Kopieren Sie sie also: <br><br><pre> <code class="javascript hljs"># cp /etc/openvpn/easy-rsa/keys/server* <span class="hljs-regexp"><span class="hljs-regexp">/etc/</span></span>openvpn # cp /etc/openvpn/easy-rsa/keys/dh2048.pem /etc/openvpn # cp /etc/openvpn/easy-rsa/keys/ca.crt /etc/openvpn</code> </pre> <br><h3>  Client-Verschl√ºsselungsschl√ºssel vorbereiten </h3><br>  Wie Sie bereits gesehen haben, verwendet die TLS-Verschl√ºsselung Paare entsprechender Schl√ºssel: einer ist auf dem Server und der andere auf dem Remoteclient installiert.  Dies bedeutet, dass Sie Client-Schl√ºssel ben√∂tigen.  Unser alter Freund pkitool ist genau das, was Sie daf√ºr brauchen.  In diesem Beispiel √ºbergeben wir das Client-Argument, indem wir das Programm im Verzeichnis / etc / openvpn / easy-rsa / ausf√ºhren, um Dateien mit den Namen client.crt und client.key zu generieren: <br><br><pre> <code class="javascript hljs"># ./pkitool client</code> </pre> <br>  Die beiden Client-Dateien sollten nun zusammen mit der urspr√ºnglichen ca.crt-Datei, die sich noch im Verzeichnis keys / befindet, sicher auf Ihren Client √ºbertragen werden.  Aufgrund ihrer Zugeh√∂rigkeit und Zugriffsrechte ist dies m√∂glicherweise nicht so einfach.  Am einfachsten ist es, den Inhalt der Quelldatei (und nur diesen Inhalt) manuell auf das Terminal zu kopieren, das auf dem Desktop Ihres PCs ausgef√ºhrt wird (w√§hlen Sie den Text aus, klicken Sie mit der rechten Maustaste darauf und w√§hlen Sie Kopieren aus dem Men√º).  F√ºgen Sie diese dann in eine neue Datei mit demselben Namen ein, den Sie im zweiten mit Ihrem Client verbundenen Terminal erstellt haben. <br><br>  Aber jeder kann ausschneiden und einf√ºgen.  Denken Sie stattdessen als Administrator, da Sie nicht immer Zugriff auf die GUI haben, wo ein Ausschneiden / Einf√ºgen m√∂glich ist.  Kopieren Sie die Dateien in das Ausgangsverzeichnis Ihres Benutzers (damit der Remote-SCP-Vorgang darauf zugreifen kann), und √§ndern Sie dann mit chown den Eigent√ºmer der Dateien von root in einen regul√§ren Nicht-Root-Benutzer, damit die Remote-scp-Aktion ausgef√ºhrt werden kann.  Stellen Sie sicher, dass alle Ihre Dateien aktuell installiert und zug√§nglich sind.  Sie werden sie etwas sp√§ter auf den Client verschieben: <br><br><pre> <code class="javascript hljs"># cp /etc/openvpn/easy-rsa/keys/client.key /home/ubuntu/ # cp /etc/openvpn/easy-rsa/keys/ca.crt /home/ubuntu/ # cp /etc/openvpn/easy-rsa/keys/client.crt /home/ubuntu/ # chown ubuntu:ubuntu /home/ubuntu/client.key # chown ubuntu:ubuntu /home/ubuntu/client.crt # chown ubuntu:ubuntu /home/ubuntu/ca.crt</code> </pre> <br>  Wenn ein vollst√§ndiger Satz von Verschl√ºsselungsschl√ºsseln einsatzbereit ist, m√ºssen Sie dem Server mitteilen, wie Sie ein VPN erstellen m√∂chten.  Dies erfolgt √ºber die Datei server.conf. <br><br><blockquote>  <b>Reduzieren Sie die Anzahl der Tastenanschl√§ge</b> <br><br>  Zu viel zum Drucken?  Eine Erweiterung mit Klammern hilft dabei, diese sechs Befehle auf zwei zu reduzieren.  Ich bin sicher, dass Sie diese beiden Beispiele studieren und verstehen k√∂nnen, was passiert.  Noch wichtiger ist, dass Sie verstehen, wie Sie diese Prinzipien auf Operationen anwenden, an denen Dutzende oder sogar Hunderte von Elementen beteiligt sind: <br><br><pre> <code class="javascript hljs"># cp /etc/openvpn/easy-rsa/keys/{ca.crt,client.{key,crt}} /home/ubuntu/ # chown ubuntu:ubuntu /home/ubuntu/{ca.crt,client.{key,crt}}</code> </pre> <br></blockquote><br><h3>  Einrichten der Datei server.conf </h3><br>  Wie k√∂nnen Sie wissen, wie die Datei server.conf aussehen soll?  Erinnern Sie sich an die easy-rsa-Verzeichnisvorlage, die Sie aus / usr / share / kopiert haben?  W√§hrend der Installation von OpenVPN blieb eine komprimierte Konfigurationsvorlagendatei √ºbrig, die Sie nach / etc / openvpn / kopieren k√∂nnen.  Ich werde auf der Tatsache aufbauen, dass die Vorlage archiviert wurde, und Ihnen ein n√ºtzliches Tool vorstellen: zcat. <br><br>  Sie wissen bereits, wie der Textinhalt einer Datei mit dem Befehl cat angezeigt wird. Was ist jedoch, wenn die Datei mit gzip komprimiert wird?  Sie k√∂nnen die Datei jederzeit entpacken, und cat zeigt sie dann gerne an. Dies sind jedoch ein oder zwei Schritte mehr als erforderlich.  Stattdessen k√∂nnen Sie, wie Sie wahrscheinlich bereits vermutet haben, den Befehl zcat eingeben, um den entpackten Text in einem Schritt in den Speicher zu laden.  Im folgenden Beispiel leiten Sie Text nicht auf dem Bildschirm, sondern in eine neue Datei mit dem Namen server.conf um: <br><br><pre> <code class="javascript hljs"># zcat \ /usr/share/doc/openvpn/examples/sample-config-files/server.conf.gz \ &gt; <span class="hljs-regexp"><span class="hljs-regexp">/etc/</span></span>openvpn/server.conf $ cd /etc/openvpn</code> </pre> <br>  Wir lassen die umfangreiche und n√ºtzliche Dokumentation, die mit der Datei geliefert wurde, beiseite und sehen, wie sie nach Abschluss der Bearbeitung aussehen k√∂nnte.  Beachten Sie, dass das Semikolon (;) OpenVPN anweist, die n√§chste Zeile nicht zu lesen oder auszuf√ºhren (Listing 10.2). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/en/4r/ften4rayxj99stxecmfjb9mx8eg.png" alt="Bild"></div><br>  Lassen Sie uns einige dieser Einstellungen durchgehen. <br><br><ul><li>  Standardm√§√üig funktioniert OpenVPN √ºber Port 1194. Sie k√∂nnen dies beispielsweise √§ndern, um Ihre Aktionen noch mehr auszublenden oder Konflikte mit anderen aktiven Tunneln zu vermeiden.  Da 1194 nur eine minimale Koordination mit den Kunden erfordert, ist dies am besten m√∂glich. </li><li>  OpenVPN verwendet entweder das Transmission Control Protocol (TCP) oder das User Datagram Protocol (UDP) f√ºr die Daten√ºbertragung.  TCP ist zwar etwas langsamer, aber zuverl√§ssiger und wird von Anwendungen, die an beiden Enden des Tunnels ausgef√ºhrt werden, mit gr√∂√üerer Wahrscheinlichkeit verstanden. </li><li>  Sie k√∂nnen dev tun mitteilen, wann Sie einen einfacheren und effizienteren IP-Tunnel erstellen m√∂chten, der den Inhalt der Daten √ºbertr√§gt und nicht mehr.  Wenn Sie andererseits mehrere Netzwerkschnittstellen (und die Netzwerke, die sie darstellen) durch Erstellen einer Ethernet-Br√ºcke verbinden m√ºssen, m√ºssen Sie dev tap ausw√§hlen.  Wenn Sie nicht verstehen, was dies alles bedeutet, verwenden Sie das Argument tun. </li><li>  In den n√§chsten vier Zeilen werden die OpenVPN-Namen der drei Authentifizierungsdateien auf dem Server und die zuvor erstellte dh2048-Einstellungsdatei √ºbergeben. </li><li>  Die Serverzeile legt den Bereich und die Subnetzmaske fest, die verwendet werden, um Clients bei der Anmeldung IP-Adressen zuzuweisen. </li><li>  Mit dem optionalen Push-Parameter "route 10.0.3.0 255.255.255.0" k√∂nnen Remoteclients auf private Subnetze hinter dem Server zugreifen.  Um diese Arbeit auszuf√ºhren, m√ºssen Sie auch das Netzwerk auf dem Server selbst konfigurieren, damit das private Subnetz √ºber das OpenVPN-Subnetz (10.8.0.0) informiert ist. </li><li>  Mit der Leitung port-share localhost 80 k√∂nnen Sie den √ºber Port 1194 kommenden Client-Verkehr an den lokalen Webserver umleiten, der Port 80 √ºberwacht. (Dies ist hilfreich, wenn Sie den Webserver zum Testen Ihres VPN verwenden m√∂chten.) Dies funktioniert nur, wenn wenn das TCP-Protokoll ausgew√§hlt ist. </li><li>  Der Benutzer Nobody und die Gruppen-Nogroup-Zeilen m√ºssen aktiv sein. L√∂schen Sie dazu die Semikolons (;).  Durch das Erzwingen, dass Remoteclients unter niemandem und unter Nogroup arbeiten, wird sichergestellt, dass Sitzungen auf dem Server nicht privilegiert sind. </li><li>  log gibt an, dass aktuelle Protokolleintr√§ge bei jedem Start von OpenVPN alte Eintr√§ge √ºberschreiben, w√§hrend log-append einer vorhandenen Protokolldatei neue Eintr√§ge hinzuf√ºgt.  Die Datei openvpn.log selbst wird in das Verzeichnis / etc / openvpn / geschrieben. </li></ul><br>  Dar√ºber hinaus wird der Client-zu-Client-Wert h√§ufig zur Konfigurationsdatei hinzugef√ºgt, sodass sich mehrere Clients zus√§tzlich zum OpenVPN-Server sehen k√∂nnen.  Wenn Sie mit Ihrer Konfiguration zufrieden sind, k√∂nnen Sie den OpenVPN-Server starten: <br><br><pre> <code class="javascript hljs"># systemctl start openvpn</code> </pre> <br><blockquote>  Aufgrund der sich √§ndernden Beziehung zwischen OpenVPN und systemd kann manchmal die folgende Syntax erforderlich sein, um einen Dienst zu starten: systemctl start openvpn @ server. </blockquote><br>  Wenn Sie ip addr ausf√ºhren, um die Liste der Netzwerkschnittstellen Ihres Servers anzuzeigen, sollte jetzt ein Link zu einer neuen Schnittstelle mit dem Namen tun0 angezeigt werden.  OpenVPN erstellt es, um eingehende Clients zu bedienen: <br><br><pre> <code class="javascript hljs">$ ip addr [...] <span class="hljs-number"><span class="hljs-number">4</span></span>: tun0: mtu <span class="hljs-number"><span class="hljs-number">1500</span></span> qdisc [...] link/none inet <span class="hljs-number"><span class="hljs-number">10.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> peer <span class="hljs-number"><span class="hljs-number">10.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>/<span class="hljs-number"><span class="hljs-number">32</span></span> scope global tun0 valid_lft forever preferred_lft forever</code> </pre> <br>  M√∂glicherweise m√ºssen Sie den Server neu starten, bevor alles vollst√§ndig funktioniert.  Die n√§chste Station ist der Client-Computer. <br><br><h3>  10.1.2.  OpenVPN-Client-Konfiguration </h3><br>  Traditionell werden Tunnel mit mindestens zwei Ausg√§ngen gebaut (sonst w√ºrden wir sie H√∂hlen nennen).  Ein ordnungsgem√§√ü konfiguriertes OpenVPN auf dem Server leitet einerseits den Datenverkehr zum und vom Tunnel.  Sie ben√∂tigen aber auch eine clientseitige Software, dh am anderen Ende des Tunnels. <br><br>  In diesem Abschnitt werde ich mich darauf konzentrieren, einen Linux-Computer des einen oder anderen Typs manuell als OpenVPN-Client einzurichten.  Dies ist jedoch nicht die einzige M√∂glichkeit, diese Gelegenheit zu nutzen.  OpenVPN unterst√ºtzt Clientanwendungen, die auf Desktop-Computern und Laptops mit Windows oder MacOS sowie auf Smartphones und Tablets mit Android und iOS installiert und verwendet werden k√∂nnen.  Siehe openvpn.net f√ºr Details. <br><br>  Das OpenVPN-Paket muss auf dem Client-Computer installiert werden, so wie es auf dem Server installiert wurde, obwohl easy-rsa nicht erforderlich ist, da die von Ihnen verwendeten Schl√ºssel bereits vorhanden sind.  Sie m√ºssen die Vorlagendatei client.conf in das Verzeichnis / etc / openvpn / kopieren, das Sie gerade erstellt haben.  Dieses Mal wird die Datei nicht archiviert, daher erledigt der regul√§re Befehl cp diese Aufgabe perfekt: <br><br><pre> <code class="javascript hljs"># apt install openvpn # cp /usr/share/doc/openvpn/examples/sample-config-files/client.conf \ /etc/openvpn/</code> </pre> <br>  Die meisten Einstellungen in Ihrer client.conf-Datei sind recht einfach: Sie sollten mit den Werten auf dem Server √ºbereinstimmen.  Wie Sie dem folgenden Dateibeispiel entnehmen k√∂nnen, lautet der eindeutige Parameter remote 192.168.1.23 1194, der dem Client die IP-Adresse des Servers mitteilt.  Stellen Sie erneut sicher, dass dies die Adresse Ihres Servers ist.  Sie m√ºssen den Clientcomputer auch zwingen, das Serverzertifikat zu authentifizieren, um einen m√∂glichen Man-in-the-Middle-Angriff zu verhindern.  Eine M√∂glichkeit, dies zu tun, besteht darin, den Line Remote-Cert-TLS-Server hinzuzuf√ºgen (Listing 10.3). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m1/nw/2w/m1nw2wwrhwag7fct4mr4ggng5n4.png" alt="Bild"></div><br>  Jetzt k√∂nnen Sie in das Verzeichnis / etc / openvpn / gehen und die Zertifizierungsschl√ºssel vom Server extrahieren.  Ersetzen Sie die Server-IP-Adresse oder den Dom√§nennamen im Beispiel durch Ihre Werte: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ng/u1/rm/ngu1rmk8tyxrntuepummte1wxuo.png" alt="Bild"></div><br>  Es ist wahrscheinlich, dass nichts Aufregendes passiert, bis Sie OpenVPN auf dem Client ausf√ºhren.  Da Sie einige Argumente √ºbergeben m√ºssen, tun Sie dies √ºber die Befehlszeile.  Das Argument --tls-client teilt OpenVPN mit, dass Sie als Client fungieren und mithilfe der TLS-Verschl√ºsselung eine Verbindung herstellen. --Config verweist auf Ihre Konfigurationsdatei: <br><br><pre> <code class="javascript hljs"># openvpn --tls-client --config /etc/openvpn/client.conf</code> </pre> <br>  Lesen Sie die Ausgabe des Befehls sorgf√§ltig durch, um sicherzustellen, dass Sie richtig angeschlossen sind.  Wenn zum ersten Mal etwas schief geht, kann dies an einer Nicht√ºbereinstimmung zwischen den Einstellungen zwischen den Server- und Client-Konfigurationsdateien oder an einem Netzwerkverbindungs- / Firewall-Problem liegen.  Hier sind einige Tipps zur Fehlerbehebung. <br><br><ul><li>  Lesen Sie die Ausgabe der OpenVPN-Operation auf dem Client sorgf√§ltig durch.  Es enth√§lt oft wertvolle Ratschl√§ge, was genau nicht durchgef√ºhrt werden kann und warum. </li><li>  √úberpr√ºfen Sie die Fehlermeldungen in den Dateien openvpn.log und openvpn-status.log im Verzeichnis / etc / openvpn / auf dem Server. </li><li>  √úberpr√ºfen Sie OpenVPN-bezogene und zeitgerechte Nachrichten in den Systemprotokollen auf dem Server und dem Client.  (journalctl -ce zeigt die neuesten Eintr√§ge an.) </li><li>  Stellen Sie sicher, dass Sie eine aktive Netzwerkverbindung zwischen dem Server und dem Client haben (weitere Informationen finden Sie in Kapitel 14). </li></ul><br><h3>  √úber den Autor </h3><br>  <b>David Clinton</b> ist Systemadministrator, Lehrer und Autor.  Er verwaltete, schrieb dar√ºber und erstellte Schulungsmaterialien f√ºr viele wichtige technische Disziplinen, darunter Linux-Systeme, Cloud Computing (insbesondere AWS) und Containertechnologien wie Docker.  Er schrieb das Buch Learn Amazon Web Services in einem Monat des Mittagessens (Manning, 2017).  Viele seiner Video-Tutorials finden Sie auf Pluralsight.com. Links zu seinen anderen B√ºchern (zur Linux-Administration und Servervirtualisierung) finden Sie unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bootstrap-it.com</a> . <br><br>  ¬ªWeitere Informationen zum Buch finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Website des Herausgebers</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Inhalt</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Auszug</a> <br><br>  25% Rabatt auf Gutschein f√ºr H√§ndler - <b>Linux</b> <br>  Nach Bezahlung der Papierversion des Buches wird ein elektronisches Buch per E-Mail verschickt. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461879/">https://habr.com/ru/post/de461879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461867/index.html">So erkennen Sie Bilder und Texte auf Ihrem Telefon mit ML Kit</a></li>
<li><a href="../de461871/index.html">101 Tipps, um ein guter Programmierer (und Mensch) zu werden</a></li>
<li><a href="../de461873/index.html">ViewPager 2 - neue Funktionalit√§t im alten Wrapper</a></li>
<li><a href="../de461875/index.html">5 nm vs 3 nm</a></li>
<li><a href="../de461877/index.html">Java vs Kotlin f√ºr Android: Meinungen von Entwicklern</a></li>
<li><a href="../de461881/index.html">Node.js Protokollierungshandbuch</a></li>
<li><a href="../de461885/index.html">EDS ist eine andere Art von Betrug</a></li>
<li><a href="../de461887/index.html">Eingabe von Aeronet Episode 2: Homing Drone</a></li>
<li><a href="../de461891/index.html">Wie wir mit ManageIQ Freunde in der Bankinfrastruktur gefunden haben</a></li>
<li><a href="../de461895/index.html">Lernen Sie w√§hrend der Reise - wie wir am 1. European Business Analysis Day gefahren sind</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>