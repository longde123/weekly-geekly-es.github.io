<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🤝‍👨🏿 🛎️ 👩🏿‍🎓 Cube RVB LED 4x4x4 pour la visualisation musicale ⏰ 🕺🏻 👨🏽‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, nous parlerons de l'expérience de l'assemblage d'un cube 4x4x4 sur des LED RGB, ainsi que du développement du logiciel nécessaire po...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cube RVB LED 4x4x4 pour la visualisation musicale</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395475/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet article, nous parlerons de l'expérience de l'assemblage d'un cube 4x4x4 sur des LED RGB, ainsi que du développement du logiciel nécessaire pour utiliser le cube comme visualiseur de son. </font><font style="vertical-align: inherit;">Le microcontrôleur Arduino Uno est utilisé.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8cc/708/0d1/8cc7080d1fde4dbd84bcb9c5c290e27d.png" height="500" alt="image"></div><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La préparation</font></font></h4><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cube</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la recherche de tels projets, une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">implémentation appelée «Charliecube» a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> été découverte, </font><font style="vertical-align: inherit;">créée par Asher Glick et Kevin Baker. </font><font style="vertical-align: inherit;">Cette option est remarquable en ce que, contrairement à d'autres implémentations, elle ne prévoit pas la présence de compteurs, de registres à décalage ou de tout autre composant pour construire le cube à des fins de programmation ultérieure et n'utilise que 16 sorties du microcontrôleur (tout en permettant d'adresser 64 LED). </font><font style="vertical-align: inherit;">Au cœur de cette implémentation se trouve la conception de l'écran LED appelé Charliplexing.</font></font><br>
<br>
<h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charliplexing</font></font></h6><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les sorties numériques des microcontrôleurs ont une logique à trois chiffres: connectées à l'alimentation, connectées à la "masse" et non connectées à quoi que ce soit. </font><font style="vertical-align: inherit;">Si nous devons allumer la LED, il faut appliquer «+» à X et «-» à «Y», seulement dans ce cas, elle s'allumera. </font><font style="vertical-align: inherit;">Si rien n'est envoyé à Y, la LED ne s'allume pas. </font><font style="vertical-align: inherit;">Plus de détails sur la méthode peuvent être trouvés dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'article Wikipédia du même nom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la description du travail spécifiquement dans notre cas est donnée ci-dessous.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8c1/71f/223/8c171f223d194bfdac112c6896cf7abc.jpg" alt="image"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disposition des colonnes LED</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Supposons que nous voulons allumer LED1 en vert. </font><font style="vertical-align: inherit;">Si vous suivez la ligne bleue, il est clair qu'il faut appliquer "+" à l'entrée 1. Après avoir suivi la ligne rouge, nous comprenons que nous devons appliquer "-" à l'entrée 3. Rien n'est envoyé aux autres entrées.</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisation</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a été décidé que toutes les analyses musicales seraient effectuées sur un PC connecté au cube. </font><font style="vertical-align: inherit;">L'idée principale: le PC analyse le canal d'enregistrement sonore, convertit le son en informations de fréquence et transfère les données de rythme musical à l'Arduino.En outre, le microcontrôleur basé sur ces informations met en évidence certaines LED. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les auteurs du projet ayant une grande expérience avec Ruby, je voudrais recourir à ce langage de programmation dans le cadre du projet. </font><font style="vertical-align: inherit;">Un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> David Guttman a </font><font style="vertical-align: inherit;">été découvert </font><font style="vertical-align: inherit;">décrivant la visualisation du son sur JRuby à l'aide de la gemme de traitement de rubis et de la bibliothèque java Minim. </font><font style="vertical-align: inherit;">L'article trouvé a été utilisé comme base pour écrire un visualiseur.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assemblage</font></font></h4><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Récupérez la colonne</font></font></h5><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/99a/910/37f/99a91037fe654e86b8a5e3a36c78fbdc.jpg" height="500" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant de connecter les LED à la colonne, il est nécessaire dans chacune des quatre LED de plier les pieds de sorte que chaque pied soit à 90 ° adjacent. </font></font><br>
<br>
<img src="https://habrastorage.org/files/558/7ff/cc9/5587ffcc91684ddf98f128cf2b2b5028.png" width="475" alt="image"><img src="https://habrastorage.org/files/c4e/f7d/88e/c4ef7d88ea9d433f8ba764f1bd0859ed.jpg" width="475" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, chacune des LED doit être tournée de 90 ° alternativement (chaque suivante doit être tournée de 90 ° dans le sens horaire par rapport à la précédente). </font><font style="vertical-align: inherit;">Auparavant, l'une des jambes peut être marquée (nous l'avons marquée avec du vernis vert) afin de ne pas se confondre. </font></font><br>
<br>
<img src="https://habrastorage.org/files/c4e/f7d/88e/c4ef7d88ea9d433f8ba764f1bd0859ed.jpg" width="475" alt="image"><img src="https://habrastorage.org/files/748/2ad/fef/7482adfefcf9456991d3bb2d7cba0068.png" width="475" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous connectons nos LED dans une colonne. </font><font style="vertical-align: inherit;">Après avoir connecté les LED, nous coupons les extrémités saillantes des pieds.</font></font><br>
<br>
<img src="https://habrastorage.org/files/7ec/381/295/7ec38129539b42e58d97d31688bc2e21.png" alt="image"><img src="https://habrastorage.org/files/376/e60/636/376e606368b84aae84fc1bbe79cfde31.png" alt="image"><img src="https://habrastorage.org/files/22a/18f/0d0/22a18f0d04e44fd2814877cab41678f1.png" alt="image"><br>
<br>
<img src="https://habrastorage.org/files/df5/eac/786/df5eac7864b64c9887342f2ed5ebe86a.jpg" width="470" alt="image"> <img src="https://habrastorage.org/files/d98/76f/c7d/d9876fc7d5a64a4b8e7d20ed347f3f83.jpg" width="470" alt="image"><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous plaçons les colonnes</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les 15 colonnes restantes sont collectées de la même manière.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6aa/0a2/5f7/6aa0a25f73eb40df874abf6779df7f42.jpg" height="500" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les colonnes sont placées sur la carte à la même distance les unes des autres, formant ainsi un cube avec un côté égal à 4 LED. </font><font style="vertical-align: inherit;">Tous les poteaux doivent être tournés dans le même sens (le marquage préliminaire de la jambe «de soutien» est ici très utile).</font></font><br>
<br>
<img src="https://habrastorage.org/files/4a1/894/e89/4a1894e899454363bbcd37cdf1fac2b3.png" width="470" alt="image"> <img src="https://habrastorage.org/files/40f/0ba/b12/40f0bab12a1542628f924e87df170699.png" alt="image"><br>
<br>
<img src="https://habrastorage.org/files/f94/e05/c5c/f94e05c5c01448498a5ad5487b83b4cf.jpg" width="470" alt="image"> <img src="https://habrastorage.org/files/1d6/2f5/a4b/1d62f5a4ba234b1f836334f9e9407375.jpg" width="470" alt="image"><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous connectons les colonnes ensemble</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Retournez la structure et commencez à connecter les fils. </font><font style="vertical-align: inherit;">Il y a 16 fils au total, la connexion a été réalisée en 4 étapes.</font></font><br>
<br>
<img src="https://habrastorage.org/files/e91/f53/d2e/e91f53d2e9f243a1afae139abfba6bed.png" width="470" alt="image"><img src="https://habrastorage.org/files/816/918/c4f/816918c4f19a4a6babe7cac6ea9c7ad8.jpg" width="470" alt="image"><br>
<br>
<img src="https://habrastorage.org/files/d89/32b/b25/d8932bb25a4b435dba018d9c2554d51d.png" width="470" alt="image"><img src="https://habrastorage.org/files/2e6/8dc/bcd/2e68dcbcd92a45d8a26c4dcca8c4615a.jpg" width="470" alt="image"><br>
<br>
<img src="https://habrastorage.org/files/28f/d81/65b/28fd8165b85c4b5c86708d809811c534.png" width="470" alt="image"><img src="https://habrastorage.org/files/703/7ef/517/7037ef5175aa4d90b4f0069aca659af3.jpg" width="470" alt="image"><br>
<br>
<img src="https://habrastorage.org/files/625/d44/a47/625d44a47e3444f08dd89a0e8eb402ab.png" width="470" alt="image"><img src="https://habrastorage.org/files/82c/c83/575/82cc83575e184f759f4204a4148fe7c1.jpg" width="470" alt="image"><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/36b/a9c/89f/36ba9c89f0d24475be59427d24df4bb7.jpg" height="500" alt="image"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il reste à se connecter à l'Arduino - et vous pouvez commencer la programmation.</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connectez-vous à Arduino</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les auteurs de Charlikub ont fourni la bibliothèque cubeplex pour une programmation pratique des cubes avec l'Arduino. </font><font style="vertical-align: inherit;">Pour que cette bibliothèque puisse être utilisée sans modifications, il est nécessaire de connecter nos fils dans l'ordre suivant (la numérotation correspond aux fils dans les images de la section précédente):</font></font><br>
<br>
<img src="https://habrastorage.org/files/b5f/6d6/34e/b5f6d634e3344e5d912eb0ae2b268f3b.png" alt="image"> <img src="https://habrastorage.org/files/cf3/763/270/cf3763270b574d20b9eb7f5b7be3feef.png" width="470" alt="image"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmation Arduino</font></font></h4><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctionnalité de base</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme mentionné ci-dessus, les auteurs ont utilisé la bibliothèque charlieplex, qui fournit une fonction drawLed () qui accepte la couleur et la position de la LED en coordonnées XYZ.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettez en surbrillance l'ensemble du cube en rouge</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"cubeplex.h"</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cubeSides = <span class="hljs-number"><span class="hljs-number">4</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  initCube();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ 
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; xpos &lt; cubeSides; xpos++) {
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = <span class="hljs-number"><span class="hljs-number">0</span></span>; ypos &lt; cubeSides; ypos++) {
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; zpos &lt; cubeSides; zpos++) {<font></font>
          drawLed(red, xpos, ypos, zpos);<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Messagerie PC</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La messagerie est implémentée via des E / S série sur le port via lequel le contrôleur se connecte à la machine. </font><font style="vertical-align: inherit;">Travailler avec de tels événements est implémenté dans Arduino via </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SerialEvent</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surlignage de cube personnalisé avec entrée utilisateur</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"cubeplex.h"</span></span></span></span><font></font>
<font></font>
String inputString = <span class="hljs-string"><span class="hljs-string">""</span></span>;         <font></font>
boolean stringComplete = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        SerialEvent,       inputString.</span></span>
<span class="hljs-comment"><span class="hljs-comment">//     Enter,    inputComplete      loop().</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> color = red;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  inputString.reserve(<span class="hljs-number"><span class="hljs-number">200</span></span>);<font></font>
  initCube();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stringComplete) {<font></font>
      Serial.println(inputString);<font></font>
      drawString(inputString);<font></font>
      resetBuffer();<font></font>
      inputString = <span class="hljs-string"><span class="hljs-string">""</span></span>;<font></font>
      stringComplete = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serialEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Serial.available()) {
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> inChar = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)Serial.read();<font></font>
    inputString += inChar;<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inChar == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) {<font></font>
      stringComplete = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ;       .</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resetBuffer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  flushBuffer();<font></font>
  clearBuffer();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//      .</span></span>
<span class="hljs-comment"><span class="hljs-comment">//   -     ,    .</span></span>
<span class="hljs-comment"><span class="hljs-comment">//    "000001002003"     { x: 0, y: 0 }.</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String inputString)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = <span class="hljs-number"><span class="hljs-number">-1</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = <span class="hljs-number"><span class="hljs-number">-1</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zpos = <span class="hljs-number"><span class="hljs-number">-1</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; inputString[i + <span class="hljs-number"><span class="hljs-number">3</span></span>]; i += <span class="hljs-number"><span class="hljs-number">3</span></span>) {<font></font>
    xpos = charToInt(inputString[i]);<font></font>
    ypos = charToInt(inputString[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]);<font></font>
    zpos = charToInt(inputString[i + <span class="hljs-number"><span class="hljs-number">2</span></span>]);<font></font>
<font></font>
    drawLed(color, xpos, ypos, zpos);<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">charToInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (value - <span class="hljs-string"><span class="hljs-string">'0'</span></span>);<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmation pour la musique légère</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On suppose que le cube clignotera au rythme de la musique. </font><font style="vertical-align: inherit;">Par conséquent, le format du message peut être simplifié à un chiffre. </font><font style="vertical-align: inherit;">L'algorithme est le suivant: dès que l'analyseur de musique "rattrape" le rythme, le cube doit s'allumer complètement. </font><font style="vertical-align: inherit;">Après cela, le cube s'éteindra lentement (couche par couche). </font><font style="vertical-align: inherit;">Dès que l'analyseur capture la mesure suivante, le cube se rallume complètement. </font><font style="vertical-align: inherit;">Autrement dit, il suffit de transférer une figure dans le cube: combien de couches doivent être mises en évidence pour le moment. </font><font style="vertical-align: inherit;">De plus, à chaque itération, nous déterminerons au hasard une nouvelle couleur.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mettez en surbrillance un nombre donné de couches</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawBeat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String inputString)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> height = charToInt(inputString[<span class="hljs-number"><span class="hljs-number">0</span></span>]);
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> color = random(red, white);<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; xpos &lt; cubeSides; xpos++) {
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = <span class="hljs-number"><span class="hljs-number">0</span></span>; ypos &lt; cubeSides; ypos++) {
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; zpos &lt; height; zpos++) {<font></font>
          drawLed(color, xpos, ypos, zpos);<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse sonore sur JRuby</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'ensemble de bibliothèque Minim comprend la classe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeatDetect</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui fournit des outils pour déterminer le rythme de la musique. </font><font style="vertical-align: inherit;">En général, en utilisant cette bibliothèque, il est extrêmement simple de se connecter au canal de réception du son et d'effectuer son analyse de fréquence. </font><font style="vertical-align: inherit;">Pour nos besoins, la méthode de fréquence pour déterminer le rythme est apparue. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code a été testé sur Ubuntu 15.10; </font><font style="vertical-align: inherit;">La version de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JRuby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisée par les auteurs est jruby 9.0.5.0. </font><font style="vertical-align: inherit;">Pour exécuter le script, vous devez installer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et connecter la bibliothèque </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minim</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyse du rythme</font></font></b><div class="spoiler_text"><pre><code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'ruby-processing'</span></span><font></font>
<font></font>
require_relative <span class="hljs-string"><span class="hljs-string">'translator'</span></span>
require_relative <span class="hljs-string"><span class="hljs-string">'serial_writer'</span></span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SoundProcessor</span></span></span><span class="hljs-class"> &lt; Processing::App</span></span>
  load_library <span class="hljs-string"><span class="hljs-string">"minim"</span></span>
  import <span class="hljs-string"><span class="hljs-string">"ddf.minim"</span></span>
  import <span class="hljs-string"><span class="hljs-string">"ddf.minim.analysis"</span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span></span>
    @minim = Minim.new <span class="hljs-keyword"><span class="hljs-keyword">self</span></span><font></font>
    @input = @minim.get_line_in<font></font>
    @beat = BeatDetect.new @input.mix.size, <span class="hljs-number"><span class="hljs-number">44100</span></span>
    @beat_value = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">001</span></span>
    @beat.set_sensitivity <span class="hljs-number"><span class="hljs-number">300</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span></span><font></font>
    process_beat<font></font>
    SerialWriter.instance.write(Translator.instance.translate(@beat_value))<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
  private<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_beat</span></span></span></span><font></font>
    @beat.detect @input.mix<font></font>
    @beat_value = @beat.is_kick ? <span class="hljs-number"><span class="hljs-number">1</span></span> : @beat_value * <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">95</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
SoundProcessor.new<font></font>
</code></pre><br>
</div></div><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Démonstration de travail</font></font></h4><br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/mXcTGpfKSxo%3Ffeature%3Doembed&amp;usg=ALkJrhgrea4_exqtyIkkdlNJutu9hUVhTA" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au moyen de PulseAudio, le visualiseur s'est vu attribuer une sortie audio en tant qu'entrée audio, c'est-à-dire </font><font style="vertical-align: inherit;">nous obtenons une visualisation de tout le son qui provient des haut-parleurs. </font><font style="vertical-align: inherit;">Après l'enregistrement, le son a été superposé à la vidéo, qui a été reproduite au moment de la création du film.</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Postface</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons réussi à obtenir un visualiseur sonore en conjonction avec un PC. </font><font style="vertical-align: inherit;">À l'avenir, vous pouvez améliorer l'algorithme pour déterminer le rythme (les outils standard pour déterminer le rythme de la bibliothèque Minim sont loin d'être idéaux), et les informations sur les fréquences peuvent également être sorties dans le cube. </font><font style="vertical-align: inherit;">Comme vous pouvez le voir, un cube est simple à construire et à programmer; </font><font style="vertical-align: inherit;">en outre, il utilise un minimum de composants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Références:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charliecube - Asher Glick</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charliplexing - Wikipedia</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Créer un visualiseur musical en 7 étapes avec Ruby - David Guttman</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code pour Arduino</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code du visualiseur</font></font></a></li>
</ul><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Auteurs</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Makoed Victor et Eugene Kunitsa, étudiants de 3e année des BSUiR Naval Forces</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr395475/">https://habr.com/ru/post/fr395475/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr395465/index.html">Microsoft a payé 10 000 $ pour une mise à niveau problématique du PC d'un utilisateur vers Windows 10</a></li>
<li><a href="../fr395467/index.html">Demandez à Ethan n ° 62: la plus grande galaxie spirale</a></li>
<li><a href="../fr395469/index.html">L'incident dans les nuages ​​(histoire)</a></li>
<li><a href="../fr395471/index.html">Edward Snowden vit une vie libre - comme un robot</a></li>
<li><a href="../fr395473/index.html">Moscow Geek Picnic: rapport Atlas</a></li>
<li><a href="../fr395477/index.html">Projet "Eye". La fin</a></li>
<li><a href="../fr395479/index.html">Les appareils VR sont plus bénéfiques pour les yeux que les écrans ordinaires</a></li>
<li><a href="../fr395481/index.html">Smart Ring Nimb du co-fondateur KermlinRussia est apparu sur Kickstarter</a></li>
<li><a href="../fr395485/index.html">Les scientifiques ont annoncé le lancement du projet d'écriture HGP, dont le but ultime est de créer un génome humain synthétique complet</a></li>
<li><a href="../fr395487/index.html">Drone de course FPV bricolage (partie 2) - configuration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>