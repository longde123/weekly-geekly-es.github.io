<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßë üö∫ üíÜüèø Otomatisasi mendapatkan informasi dari USRLE menggunakan Freepascal üíÜüèæ üëáüèº üë®üèΩ‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam pekerjaan saya (legal), saya siap untuk mengotomatisasi semua yang hanya cocok untuk ini. Tetapi sampai robot yang dipompa oleh jaringan saraf d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otomatisasi mendapatkan informasi dari USRLE menggunakan Freepascal</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419063/"><img src="https://habrastorage.org/webt/xp/n2/lb/xpn2lbf3yf9_ryhoprada0ehl5i.jpeg"><br><br><p>  Dalam pekerjaan saya (legal), saya siap untuk mengotomatisasi semua yang hanya cocok untuk ini.  Tetapi sampai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">robot yang</a> dipompa oleh jaringan saraf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari utopia Jerman Gref</a> tidak muncul dan tidak mengambil semua pekerjaan dari pengacara biasa, rutinitas akan tetap menjadi teman utama kami untuk waktu yang lama.  Otomatisasi rutin ini adalah sesuatu yang telah saya lakukan secara berkala selama beberapa tahun terakhir, baik itu banyak tabel di excel dengan sekelompok formula yang memungkinkan Anda untuk dengan cepat mencetak ratusan jenis dokumen surat yang sama dalam kata, atau dengan baik, secara otomatis membuat laporan.  Tetapi ada hal-hal yang tidak dapat Anda lakukan dengan formula dan substitusi sederhana.  Di sinilah pemrograman datang untuk menyelamatkan, yang saya sukai sejak kecil, dan kebetulan dimulai dengan delphi.  Sekarang lebih mudah bagi saya daripada di C # atau python, yang mulai saya pelajari baru-baru ini, untuk dengan cepat membuat semacam proyek di lingkungan Lazarus menggunakan freepascal.  Dan ya, saya serius percaya bahwa kemampuan lingkungan ini lebih dari cukup.  Oleh karena itu, otomatiskan USRLE, Anda dapat menebaknya, harus dilakukan menggunakan pascal. <br><a name="habracut"></a><br></p><p>  Seorang pengacara dari sebuah perusahaan konsultan yang menjalankan bisnis dari puluhan badan hukum, seorang pengacara perusahaan berdasarkan roti gratis, dan setiap pengacara lain yang dihadapkan untuk memastikan kegiatan organisasi - mereka semua tahu bagaimana lusinan dan ratusan nama yang berbeda, TIN, nomor PSRN bercampur di kepala Anda, bagaimana mudah untuk melupakan siapa manajernya, dan ketika masa berlaku perpanjangannya sesuai, apakah ada masalah dengan saham di LLC dan dengan pembayaran modal sewaannya.  Nah, kebutuhan untuk cepat membuat semacam dokumen, yang mencakup banyak detail yang terus berubah, memerlukan kesalahan dan kesalahan ketik berkala.  Untuk mengotomatisasi proses semacam itu, saya membutuhkan solusi database yang memungkinkan saya membuat dokumen menggunakan templat, mengelola berbagai pendaftar, melacak perubahan, dan tidak melewatkan tenggat waktu.  Nah, salah satu penyederhanaan hidup yang diperlukan adalah penerimaan cepat file baru dengan informasi dari USRLE dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs web Layanan Pajak Federal</a> .  Tentu saja, tidak ada yang mengatakan bahwa menggunakan situs secara langsung itu panjang dan sulit, tetapi setuju bahwa mengklik satu tombol tanpa meninggalkan aplikasi jauh lebih menyenangkan, dan Anda dapat melakukan ini tanpa memutus panggilan telepon (atau secangkir kopi). <br><br></p><p>  Jadi, untuk permulaan kita akan memutuskan apa yang ingin kita dapatkan.  Situs ini memungkinkan Anda untuk mencari dalam <abbr title="Dalam hal ini, keabsahan sumber informasi adalah penting, karena ekstrak dari USRLE yang diterima sepenuhnya gratis dengan cara ini diterima bahkan oleh pengadilan sebagai bukti.">register resmi</abbr> USRLE untuk mendapatkan nomor OGRN atau TIN yang unik dan memberikan satu hasil yang relevan dalam bentuk informasi singkat tentang orang tersebut dan tautan untuk mengunduh file pdf dengan ekstrak.  Juga, pencarian mungkin tidak jelas dengan nama dengan filter tambahan berdasarkan wilayah (subjek Federasi Rusia).  Dan dalam hal ini, situs mengeluarkan tabel dengan semua orang yang cocok dan dengan kumpulan data yang sama, termasuk tautan ke pdf. <br><br></p><p>  Jadi, dalam kasus tertentu, fungsi yang sudah jadi harus mengembalikan pdf dalam bentuk file (atau, lebih baik, stream), memiliki OGRN atau TIN di input.  Tetapi untuk universalisasi dan kemungkinan perluasan lebih lanjut, kami tidak akan mengabaikan semua fitur situs dan juga membuat fungsi pencarian fuzzy dengan mengembalikan seperangkat data yang ditemukan dengan nama organisasi, dengan mempertimbangkan filter berdasarkan wilayah atau tanpa itu.  Mari kita coba gambarkan antarmuka dari fungsi-fungsi ini: <br><br></p><pre><code class="delphi hljs">IEGRULstreamer = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; ; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsListByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Region: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; ; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LegalsList: TCollection)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br>  Untuk memahami apa parameter misterius X dan koleksi yang akan mengembalikan fungsi kedua, kita akan melihat bagaimana situs mengeksekusi permintaan. <br><br><p>  1. Situs ini memiliki formulir dengan bidang masukan untuk pengidentifikasi untuk mencari dan memeriksa captcha: <br><br><img src="https://habrastorage.org/webt/ua/vn/gf/uavngfdababogkh8q7yexvfx-nw.jpeg"><br><br></p><p>  2. Captcha dibuat menggunakan bidang tersembunyi yang dibuat sebelumnya dengan nama captchaToken, yang menggunakan skrip Java untuk menghasilkan gambar captcha untuk token ini. <br><br></p><p>  3. Setelah mengklik tombol "find", permintaan POST dikirim ke server, dalam hasil pemrosesan yang JSON dengan array objek dikembalikan.  Respons JSON ini menggunakan skrip Java lain untuk mengisi tabel yang kita lihat di hasil pencarian. <br><br>  Jadi, halangan pertama adalah cek captcha.  Agar tidak membebani metode kami berinteraksi dengan situs dengan fungsi berlebih, kami akan mengambil tindakan untuk memproses captcha sebagai fungsi terpisah.  Dan di X, kita akan memiliki parameter untuk metode panggilan balik, yang memiliki gambar captcha pada input dan string dengan captcha yang dikenali pada output: <br><br></p><pre> <code class="delphi hljs">TCapthcaRecognizeFunc = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Captha: TStream)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>; ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span></code> </pre><br>  Fungsi memproses captcha dapat melakukan ini sesuai keinginan Anda: biarkan pengguna memasukkannya secara manual, mengirim gambar ke server berbayar untuk pengenalan otomatis, secara independen mengenalinya menggunakan pengetahuan unik algoritma.  Untuk kesederhanaan gambar, dan karena dalam kasus saya tidak ada aliran captcha yang diharapkan pada skala industri, kami memilih opsi pertama: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TForm1</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RecognizeFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(captcha: TStream)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> CaptchaImg.Picture.LoadFromStream(captcha); Result := InputBox(<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">'    '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><p>  Pertanyaan kedua adalah isi dari respons JSON server.  Ini adalah contoh dari apa yang ada di dalamnya: <br><br></p><div class="spoiler">  <b class="spoiler_title">Respons terformat JSON</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: {<span class="hljs-attr"><span class="hljs-attr">"captcha"</span></span>:<span class="hljs-string"><span class="hljs-string">"382915"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ogrninnfl"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fam"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nam"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"otch"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"region"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ogrninnul"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"namul"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"regionul"</span></span>:<span class="hljs-string"><span class="hljs-string">"73"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"kind"</span></span>:<span class="hljs-string"><span class="hljs-string">"ul"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ul"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"searchByOgrn"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nameEq"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"searchByOgrnip"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}, <span class="hljs-attr"><span class="hljs-attr">"rows"</span></span>: [ {<span class="hljs-attr"><span class="hljs-attr">"T"</span></span>:<span class="hljs-string"><span class="hljs-string">"ED346E713D4A1AC851F9B589C6D2AECD1D809D5B6B5D1B98E697B6E0FD873E137B828AC59A60D159BB2894F11D00AB5639E2ACEE4E2ED5B7AC7A6EFE28FD987BC288B93C4D3D3EC1008DA0F128BA7E5E"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"INN"</span></span>:<span class="hljs-string"><span class="hljs-string">"7325001144"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NAME"</span></span>:<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"OGRN"</span></span>:<span class="hljs-string"><span class="hljs-string">"1027301175110"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ADRESTEXT"</span></span>:<span class="hljs-string"><span class="hljs-string">"432017,  ,  ,  , 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"CNT"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"DTREG"</span></span>:<span class="hljs-string"><span class="hljs-string">"03.12.2002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"KPP"</span></span>:<span class="hljs-string"><span class="hljs-string">"732501001"</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">"T"</span></span>:<span class="hljs-string"><span class="hljs-string">"2ECB284C7682E5F1D1129AA3074FABB4B74BB28EA426AF79C091CEDEA0D9E391CA26FF405A7C9742466E19C78FBE5A59BDCBCD21268FFD8AFD3A8509CCA84541"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"INN"</span></span>:<span class="hljs-string"><span class="hljs-string">"7303007375"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NAME"</span></span>:<span class="hljs-string"><span class="hljs-string">"      \"   \""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"OGRN"</span></span>:<span class="hljs-string"><span class="hljs-string">"1027301173283"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ADRESTEXT"</span></span>:<span class="hljs-string"><span class="hljs-string">"432063,  ,  ,   , 7"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"CNT"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"DTREG"</span></span>:<span class="hljs-string"><span class="hljs-string">"27.11.2002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"KPP"</span></span>:<span class="hljs-string"><span class="hljs-string">"732501001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"DTEND"</span></span>:<span class="hljs-string"><span class="hljs-string">"01.09.2010"</span></span>}, ] }</code> </pre><br></div></div><br>  Seperti yang Anda lihat, hasilnya mengembalikan objek kueri yang berisi parameter pencarian awal (sehingga mereka tetap di bidang formulir untuk digunakan kembali) dan array baris.  Tautan ke file pdf dikombinasikan dengan skrip java menggunakan ekspresi: <pre>  "https://egrul.nalog.ru/download/" </pre>  dan nilai kunci "T" dari objek.  Masa hidup file pdf yang dihasilkan adalah beberapa menit. <br><br><p>  Dua kesulitan utama yang saya temui saat membuat permintaan http adalah nilai header yang benar dan menggabungkan string dengan parameter permintaan POST.  Tetapi analisis sederhana dari halaman menggunakan alat peramban bawaan (di Chrome disebut dengan menekan F12) memberikan semua yang Anda butuhkan.  Berikut adalah contoh tajuk yang digunakan server untuk memberikan jawaban yang benar alih-alih 400 permintaan salah: <br><br></p><pre> <code class="hljs powershell">POST / HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: egrul.nalog.ru Connection: keep<span class="hljs-literal"><span class="hljs-literal">-alive</span></span> Accept: application/json, text/javascript, */*; q=<span class="hljs-number"><span class="hljs-number">0.01</span></span> Origin: https://egrul.nalog.ru X<span class="hljs-literal"><span class="hljs-literal">-Requested</span></span><span class="hljs-literal"><span class="hljs-literal">-With</span></span>: XMLHttpRequest User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: Chrome/<span class="hljs-number"><span class="hljs-number">67.0</span></span>.<span class="hljs-number"><span class="hljs-number">3396.99</span></span> Safari/<span class="hljs-number"><span class="hljs-number">537.36</span></span> Content<span class="hljs-literal"><span class="hljs-literal">-Type</span></span>: application/x<span class="hljs-literal"><span class="hljs-literal">-www</span></span><span class="hljs-literal"><span class="hljs-literal">-form</span></span><span class="hljs-literal"><span class="hljs-literal">-urlencoded</span></span> Referer: https://egrul.nalog.ru/ Accept<span class="hljs-literal"><span class="hljs-literal">-Encoding</span></span>: gzip, deflate, br Accept<span class="hljs-literal"><span class="hljs-literal">-Language</span></span>: ru<span class="hljs-literal"><span class="hljs-literal">-RU</span></span>,ru;q=<span class="hljs-number"><span class="hljs-number">0.9</span></span>,en<span class="hljs-literal"><span class="hljs-literal">-US</span></span>;q=<span class="hljs-number"><span class="hljs-number">0.8</span></span>,en;q=<span class="hljs-number"><span class="hljs-number">0.7</span></span></code> </pre><br>  Dan ini adalah baris dengan parameter: <br><br><pre> <code class="hljs perl">kind=ul&amp;srchUl=name&amp;ogrninnul=<span class="hljs-number"><span class="hljs-number">7716819629</span></span>&amp;namul=%D0%BF%D1%80%D0%B0%D0%B2% D<span class="hljs-number"><span class="hljs-number">0</span></span>%B8%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D1%82%D0%B2%D0%BE&amp;regionul=<span class="hljs-number"><span class="hljs-number">73</span></span> &amp;srchFl=ogrn&amp;ogrninnfl=&amp;fam=&amp;nam=&amp;otch=&amp;region=&amp;captcha=<span class="hljs-number"><span class="hljs-number">449023</span></span>&amp;captchaToken=DAEDA <span class="hljs-number"><span class="hljs-number">7504</span></span>CACAC82CF09E08319B68DF5F9BD62B2F44D33DD679DDE55B5CF58B17FEC84E78CEEB9639 <span class="hljs-number"><span class="hljs-number">84</span></span>D2B2BD8C3AA15</code> </pre> <br><p>  Berbekal data awal ini, kami melanjutkan ke implementasi tugas.  Saya akan menggunakan pustaka berikut untuk freepascal: <br><br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Synapse</a> adalah pustaka yang sangat nyaman dengan fungsi yang paling disederhanakan (untuk digunakan) mengirim permintaan-http ke server, ia juga bekerja dengan SSL, tetapi ini membutuhkan <abbr title="Saya memiliki cukup perpustakaan libeay32.dll dan ssleay32.dll pada platform win32">keberadaan pustaka openSSL</abbr> di folder atau sistem proyek, serta koneksi modul tambahan.  Cukup menghubungkan modul perpustakaan berikut ke proyek kami: httpsend, ssl_openssl, synautil. <br></p><p>  Pustaka bawaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fcl-json</a> - modul yang diperlukan: fpjson dan fpjsonrtti - untuk kenyamanan maksimum pemrosesan objek yang dikembalikan ke JSON. <br><br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Modul terpisah dari pustaka built-in fcl-xml</a> - untuk beberapa fungsi, Anda perlu bekerja dengan bagian-bagian HTML sebagai objek DOM, jadi kami akan menghubungkan modul SAX_HTML, DOM_HTML, DOM. <br><br>  Mari kita jelaskan jenis dan kelas objek yang akhirnya menjadi: <br><br></p><pre> <code class="delphi hljs"><span class="hljs-title"><span class="hljs-title">TEGRULItem</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TCollectionItem) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> fT, fINN, fNAME, fOGRN, fADRESTEXT, fCNT, fDTREG, fDTEND, fKPP: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPdfLink</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">published</span></span> <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> T: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fT <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fT; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> INN: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fINN <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fINN; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fNAME <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fNAME; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> OGRN: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fOGRN <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fOGRN; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> ADRESTEXT: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fADRESTEXT <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fADRESTEXT; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> CNT: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fCNT <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fCNT; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> DTREG: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fDTREG <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fDTREG; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> DTEND: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fDTEND <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fDTEND; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> KPP: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> fKPP <span class="hljs-keyword"><span class="hljs-keyword">write</span></span> fKPP; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><p>  Di kelas ini kita akan mengemas objek yang akan dikembalikan dalam array baris dalam respons JSON server.  Kita akan membacanya menggunakan JSONToCollection, tetapi untuk ini kita perlu membuat setiap objek elemen koleksi dan mendeklarasikan semua properti terkait seperti yang dipublikasikan.  Fungsi RTTI dalam freepascal (dan juga dalam delphi) mendapatkan akses ke nama properti hanya ketika dideklarasikan dalam lingkup ini.  Dan fungsi JSONToCollection dari modul fpjsonrtti hanyalah fungsi RTTI yang membandingkan nama-nama kunci dari objek JSON dengan nama-nama properti kelas. <br></p><blockquote>  Ada juga fungsi GetPdfLink di antarmuka kelas, yang mengembalikan tautan untuk mengunduh file pdf dengan informasi dari USRLE dengan menggabungkan alamat web dan nilai properti "T". </blockquote><br><br><p>  Kelas utama yang mengimplementasikan antarmuka yang dinyatakan di atas akan seperti ini: <br><br></p><pre> <code class="delphi hljs"> <span class="hljs-title"><span class="hljs-title">TEGRULStreamer</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, IEGRULStreamer) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HTTPSender: THTTPSend; Doc: THTMLDocument; Inputs: TDOMNodeList; captchaURL, captchaToken, captcha, Params: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCaptchaToken</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsList</span></span></span><span class="hljs-function">:</span></span> TCollection; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareHeaders</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessCaptcha</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CaptchaFunc: TCapthcaRecognizeFunc)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsListByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Region: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LegalsList: TCollection)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">destructor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Destroy</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><br><p>  Seperti yang Anda lihat, di samping implementasi dua fungsi utama antarmuka, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">semua properti dan metode lain dari kelas akan disembunyikan</a> dan hanya diperlukan untuk implementasi internal.  Secara umum, mereka dapat dimasukkan ke dalam metode utama, tetapi kami telah melalui pelajaran tentang kode duplikat, visualisasi dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">refactoring</a> secara umum. <br></p><p>  Mengingat enkapsulasi tindakan persiapan, metode utama umumnya akan berbeda hanya dengan membentuk serangkaian parameter http-request dan tipe data yang dikembalikan. <br><br></p><div class="spoiler">  <b class="spoiler_title">kode metode TEGRULStreamer.GetExtractByOGRN</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TEGRULStreamer</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetExtractByOGRN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OGRN: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; isLegal: boolean; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Extract: TStream)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ProcessCaptcha(CaptchaFunc); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isLegal <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Params := <span class="hljs-string"><span class="hljs-string">'kind=ul'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Params := <span class="hljs-string"><span class="hljs-string">'kind=fl'</span></span>; Params += <span class="hljs-string"><span class="hljs-string">'&amp;srchUl=ogrn&amp;srchFl=ogrn&amp;ogrninnul='</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isLegal <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Params += OGRN; Params += <span class="hljs-string"><span class="hljs-string">'&amp;namul=&amp;regionul=&amp;ogrninnfl='</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> isLegal <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Params += OGRN; Params += <span class="hljs-string"><span class="hljs-string">'&amp;fam=&amp;nam=&amp;otch=&amp;region&amp;captcha='</span></span> + captcha + <span class="hljs-string"><span class="hljs-string">'&amp;captchaToken='</span></span> + captchaToken; WriteStrToStream(HTTPSender.Document, Params); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> HTTPSender.HTTPMethod(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, EGRUL_URL) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception.Create(<span class="hljs-string"><span class="hljs-string">'   '</span></span>); HTTPSender.Headers.Clear; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> HTTPSender.HTTPMethod(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, TEGRULItem(GetLegalsList.Items[<span class="hljs-number"><span class="hljs-number">0</span></span>]).GetPdfLink) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> Extract := HTTPSender.Document <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Extract := <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>;</code> </pre><br></div></div><br><p>  Di sini, seperti yang dapat kita lihat, metode ini juga menggunakan parameter boolean isLegal, dan jika tidak disetel ke true, pencarian berjalan melalui database wirausahawan alih-alih badan hukum. <br><br></p><div class="spoiler">  <b class="spoiler_title">kode metode TEGRULStreamer.GetLegalsListByName</b> <div class="spoiler_text"><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TEGRULStreamer</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLegalsListByName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Region: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">; CaptchaFunc: TCapthcaRecognizeFunc; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LegalsList: TCollection)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ProcessCaptcha(CaptchaFunc); Params := <span class="hljs-string"><span class="hljs-string">'kind=ul&amp;srchUl=name&amp;srchFl=ogrn&amp;ogrninnul=&amp;namul='</span></span>; Params += <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> + <span class="hljs-string"><span class="hljs-string">'&amp;regionul='</span></span> + Region + <span class="hljs-string"><span class="hljs-string">'&amp;ogrninnfl=&amp;fam=&amp;nam=&amp;otch=&amp;region'</span></span>; Params += <span class="hljs-string"><span class="hljs-string">'&amp;captcha='</span></span> + captcha + <span class="hljs-string"><span class="hljs-string">'&amp;captchaToken='</span></span> + captchaToken; WriteStrToStream(HTTPSender.Document, Params); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> HTTPSender.HTTPMethod(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, EGRUL_URL) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception.Create(<span class="hljs-string"><span class="hljs-string">'   '</span></span>); LegalsList := GetLegalsList; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br></div></div><br><p>  Peran metode utilitas adalah sebagai berikut: <br><br>  <b>ProcessCaptcha</b> - mengunduh halaman html awal dari Layanan Pajak Federal, mencari captcha token, mengunduh gambar yang dihasilkan oleh token ini, dan mengalihkannya ke metode panggilan balik untuk pengenalan captcha.  Pada akhirnya, metode ini juga menetapkan tajuk yang benar untuk permintaan POST berikutnya. <br><br>  <b>GetCaptchaToken</b> - memuat semua bidang input dari halaman ke dalam struktur DOM, mencari bidang tersembunyi dengan capthcaToken pengidentifikasi dan mengembalikan nilainya. <br><br>  <b>GetLegalsList</b> - menggunakan fungsi RTTI JSONToCollection mengembalikan koleksi objek bertipe TEGRULItem yang dijelaskan di atas. <br><br>  <s><b><abbr title="fungsi ditransfer ke implementasi kelas TEGRULItem">GetPdfLink</abbr></b></s> - untuk mencari dengan OGRN atau TIN, dalam kasus yang tepat, hanya satu hasil yang akan selalu dikembalikan, oleh karena itu dalam GetExtractByOGRN fungsi dipanggil untuk elemen pertama dalam koleksi. <br><br></p><p>  Karena ini adalah pengalaman pertama saya dengan jaringan dalam freepascal, saya sangat senang bahwa semuanya ternyata persis seperti yang saya maksudkan.  Dalam bentuk kerja, perpustakaan dibuat dalam waktu kurang dari satu hari (terima kasih kepada pengguna forum dari freepascal.ru, yang berbicara tentang sinaps). <br><br></p><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Arsip dengan tes pustaka yang dihasilkan dan kodenya ada di sini</a> . <br><br></p><p>  Seperti biasa, saya akan senang dengan kritik yang membangun baik pada proyek dan implementasi.  Saya memahami bahwa ada banyak faktor yang masih dapat diperhitungkan: keterlambatan merespons permintaan http, akibatnya aplikasi akan dibekukan;  Tanggapan http salah dan situasi lainnya. <br><br></p><p>  Di masa depan, saya berencana untuk menghubungkan perpustakaan online dengan database alamat FIAS dan menyadari kemampuan untuk menghasilkan templat aplikasi yang lengkap, yang umumnya diedit dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Program Persiapan Dokumen untuk pendaftaran negara</a> . <br><br><img src="https://habrastorage.org/webt/pu/a0/qm/pua0qmeomu83os45u7on8e9picm.gif" align="right"><br>  <i>PS Maaf, Sberbank, untuk peran kelinci percobaan dan ratusan kali ekstraknya diunduh.</i>  <i>Semua atas nama sains, tentu saja.</i> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id419063/">https://habr.com/ru/post/id419063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id419049/index.html">GeekBrains Meluncurkan marathon edukasi online ‚ÄúFind Yourself in Digital‚Äù gratis</a></li>
<li><a href="../id419051/index.html">Bagaimana Flant Membantu Pemula</a></li>
<li><a href="../id419053/index.html">Menguji Teknologi Cache Adaptec RAID</a></li>
<li><a href="../id419055/index.html">Dalam teori string, Anda dapat bertahan dengan alam semesta yang jauh lebih sedikit.</a></li>
<li><a href="../id419061/index.html">Apa yang Baru di GoLand 2018.2</a></li>
<li><a href="../id419065/index.html">Intel Dunia Virtual. Berlatih</a></li>
<li><a href="../id419067/index.html">Cara menjual data pribadi, atau mengapa sulit memberi label harga pada informasi</a></li>
<li><a href="../id419069/index.html">Pemanasan global akan membuat dunia kita lebih hijau, tetapi jangan bersukacita</a></li>
<li><a href="../id419071/index.html">Mengikuti hack tp-link</a></li>
<li><a href="../id419075/index.html">Pada pembentukan urutan dalam hipotesis Collatz (3n + 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>