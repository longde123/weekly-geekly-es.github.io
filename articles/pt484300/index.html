<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💣 🦁 🕵🏿 PowerShell funcional com classes - não um oxímoro, eu garanto 🗿 💡 👩🏾‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Olá Habr! Apresento a você a tradução do artigo "PowerShell funcional com classes. 
 Eu prometo que não é um oxímoro " de Christopher Kuech. 


 Os pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PowerShell funcional com classes - não um oxímoro, eu garanto</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484300/"><p>  Olá Habr!  Apresento a você a tradução do artigo <a href="https://medium.com/faun/functional-powershell-with-classes-820c8e9acd8f">"PowerShell funcional com classes.</a> <a href="https://medium.com/faun/functional-powershell-with-classes-820c8e9acd8f"><br></a>  <a href="https://medium.com/faun/functional-powershell-with-classes-820c8e9acd8f">Eu prometo que não é um oxímoro "</a> de Christopher Kuech. </p><br><p>  Os paradigmas de programação funcional e orientada a objetos podem parecer incompatíveis entre si, mas ambos são igualmente suportados no Powershell.  Quase todas as linguagens de programação, funcionais e não, possuem meios de ligação estendida de nomes e valores;  Classes, como estruturas e registros, são apenas uma abordagem.  Se restringirmos o uso de Classes a nomes e valores e evitarmos conceitos de programação orientada a objetos "pesados" como herança, polimorfismo ou mutabilidade, poderemos tirar proveito deles sem complicar nosso código.  Além disso, adicionando métodos imutáveis ​​de conversão de tipos, podemos enriquecer nosso código funcional com Classes. </p><br><h2 id="magiya-kastov">  Magia de castas </h2><br><p>  Castes é um dos recursos mais poderosos do Powershell.  Ao converter um valor, você conta com o ambiente sendo adicionado ao seu aplicativo para inicialização e validação implícitas.  Por exemplo, uma conversão simples de uma string em [xml] a executará no código do analisador e gerará uma árvore xml completa.  Podemos usar Classes em nosso código para a mesma finalidade. </p><a name="habracut"></a><br><h3 id="kast-heshtablic">  Hashtables personalizados </h3><br><p>  Se você não tem um construtor, pode continuar sem ele usando uma tabela de hash para o tipo de sua classe.  Lembre-se de usar atributos de validação para aproveitar ao máximo esse padrão.  Ao mesmo tempo, podemos usar as propriedades digitadas da classe para acionar uma lógica de inicialização e validação ainda mais profunda. </p><br><pre><code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cluster</span></span></span></span> { [<span class="hljs-type"><span class="hljs-type">ValidatePattern</span></span>(<span class="hljs-string"><span class="hljs-string">"^[Az]+</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Service</span></span> [<span class="hljs-type"><span class="hljs-type">ValidateSet</span></span>(<span class="hljs-string"><span class="hljs-string">"TEST"</span></span>, <span class="hljs-string"><span class="hljs-string">"STAGE"</span></span>, <span class="hljs-string"><span class="hljs-string">"CANARY"</span></span>, <span class="hljs-string"><span class="hljs-string">"PROD"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$FlightingRing</span></span> [<span class="hljs-type"><span class="hljs-type">ValidateSet</span></span>(<span class="hljs-string"><span class="hljs-string">"EastUS"</span></span>, <span class="hljs-string"><span class="hljs-string">"WestUS"</span></span>, <span class="hljs-string"><span class="hljs-string">"NorthEurope"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Region</span></span> [<span class="hljs-type"><span class="hljs-type">ValidateRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Index</span></span> } [<span class="hljs-type"><span class="hljs-type">Cluster</span></span>]<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>{ Service = <span class="hljs-string"><span class="hljs-string">"MyService"</span></span> FlightingRing = <span class="hljs-string"><span class="hljs-string">"PROD"</span></span> Region = <span class="hljs-string"><span class="hljs-string">"EastUS"</span></span> Index = <span class="hljs-number"><span class="hljs-number">2</span></span> }</code> </pre> <br><p>  Além disso, o elenco ajuda a obter uma conclusão clara.  Compare a saída da matriz de tabelas de hash do cluster passada para Format-Table com o que acontece se você converter essas tabelas de hash pela primeira vez em uma classe.  As propriedades da classe são sempre listadas na ordem em que são definidas lá.  Não se esqueça de adicionar a palavra-chave oculta na frente de todas as propriedades que não devem estar visíveis na saída. </p><br><img src="https://habrastorage.org/webt/r9/td/62/r9td62pfnpoxg4dnud-1e2r41is.png" alt="imagem"><br><br><h3 id="kast-znacheniy">  Valores personalizados </h3><br><p>  Se você tiver um construtor com um argumento, converter os valores para o seu tipo de classe passará o valor para esse seu construtor, no qual você pode inicializar a instância da sua classe </p><br><pre> <code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cluster</span></span></span></span> { [<span class="hljs-type"><span class="hljs-type">ValidatePattern</span></span>(<span class="hljs-string"><span class="hljs-string">"^[Az]+</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Service</span></span> [<span class="hljs-type"><span class="hljs-type">ValidateSet</span></span>(<span class="hljs-string"><span class="hljs-string">"TEST"</span></span>, <span class="hljs-string"><span class="hljs-string">"STAGE"</span></span>, <span class="hljs-string"><span class="hljs-string">"CANARY"</span></span>, <span class="hljs-string"><span class="hljs-string">"PROD"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$FlightingRing</span></span> [<span class="hljs-type"><span class="hljs-type">ValidateSet</span></span>(<span class="hljs-string"><span class="hljs-string">"EastUS"</span></span>, <span class="hljs-string"><span class="hljs-string">"WestUS"</span></span>, <span class="hljs-string"><span class="hljs-string">"NorthEurope"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Region</span></span> [<span class="hljs-type"><span class="hljs-type">ValidateRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Index</span></span> Cluster([<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$id</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.Service, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.FlightingRing, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.Region, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.Index = <span class="hljs-variable"><span class="hljs-variable">$id</span></span> <span class="hljs-operator"><span class="hljs-operator">-split</span></span> <span class="hljs-string"><span class="hljs-string">"-"</span></span> } } [<span class="hljs-type"><span class="hljs-type">Cluster</span></span>]<span class="hljs-string"><span class="hljs-string">"MyService-PROD-EastUS-2"</span></span></code> </pre> <br><h3 id="kast-k-stroke">  Linha personalizada </h3><br><p>  Você também pode substituir o método de classe [string] ToString () para determinar a lógica da representação de string do objeto, por exemplo, usando a interpolação de string. </p><br><pre> <code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cluster</span></span></span></span> { <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidatePattern</span></span></span><span class="hljs-function">(</span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"^[Az]+</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-string"><span class="hljs-variable">$</span></span></span></span><span class="hljs-function"><span class="hljs-string">"</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Service</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidateSet</span></span></span><span class="hljs-function">(</span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"TEST"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"STAGE"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"CANARY"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"PROD"</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FlightingRing</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidateSet</span></span></span><span class="hljs-function">(</span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"EastUS"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"WestUS"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"NorthEurope"</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Region</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidateRange</span></span></span><span class="hljs-function">(</span><span class="hljs-number"><span class="hljs-function"><span class="hljs-number">0</span></span></span><span class="hljs-function">, </span><span class="hljs-number"><span class="hljs-function"><span class="hljs-number">255</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">int</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.Service, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.FlightingRing, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.Region, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>.Index <span class="hljs-operator"><span class="hljs-operator">-join</span></span> <span class="hljs-string"><span class="hljs-string">"-"</span></span> } } <span class="hljs-variable"><span class="hljs-variable">$cluster</span></span> = [<span class="hljs-type"><span class="hljs-type">Cluster</span></span>]<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>{ Service = <span class="hljs-string"><span class="hljs-string">"MyService"</span></span> FlightingRing = <span class="hljs-string"><span class="hljs-string">"PROD"</span></span> Region = <span class="hljs-string"><span class="hljs-string">"EastUS"</span></span> Index = <span class="hljs-number"><span class="hljs-number">2</span></span> } <span class="hljs-built_in"><span class="hljs-built_in">Write-Host</span></span> <span class="hljs-string"><span class="hljs-string">"We just created a model for '</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$cluster</span></span></span><span class="hljs-string">'"</span></span></code> </pre> <br><h3 id="kast-serializovannyh-instansov">  Instâncias serializadas personalizadas </h3><br><p>  O elenco permite desserialização segura.  Os exemplos abaixo falharão se os dados não atenderem às nossas especificações no Cluster </p><br><pre> <code class="powershell hljs"><span class="hljs-comment"><span class="hljs-comment">#    [Cluster]$cluster = Get-Content "./my-cluster.json" | ConvertFrom-Json [Cluster[]]$clusters = Import-Csv "./my-clusters.csv"</span></span></code> </pre> <br><br><h2 id="kasty-v-vashem-funkcionalnom-kode">  Castes no seu código de função </h2><br><p>  Os programas funcionais primeiro definem estruturas de dados, depois implementam o programa como uma sequência de transformações sobre estruturas de dados imutáveis.  Apesar da impressão conflitante, as classes realmente ajudam a escrever código funcional, graças aos métodos de conversão de tipo. </p><br><h3 id="funkcionalnyy-li-powershell-ya-pishu">  O Powershell é funcional que eu escrevo? </h3><br><p>  Muitas pessoas que vêm de C # ou com um passado semelhante escrevem o Powershell, que é semelhante ao C #.  Ao fazer isso, você reluta em usar os conceitos de programação funcional e provavelmente obtém o benefício de estar imerso na programação orientada a objetos no Powershell ou em uma melhor compreensão da programação funcional. </p><br><p>  Se você confiar fortemente na transformação de dados imutáveis ​​usando pipelines (|), Where-Object, ForEach-Object, Select-Object, Group-Object, Sort-Object, etc., terá um estilo e um uso mais funcionais Aulas de PowerShell em estilo funcional. </p><br><h3 id="funkcionalnoe-ispolzovanie-klassov">  Uso funcional de classes </h3><br><p>  As castas, embora usem sintaxe alternativa, estão apenas mapeando entre dois domínios.  No pipeline, você pode mapear uma matriz de valores usando o ForEach-Object. </p><br><p>  No exemplo abaixo, o construtor Node é executado toda vez que ocorre uma conversão para o Datum, e isso nos permite não escrever uma quantidade razoável de código.  Como resultado, nosso pipeline se concentra na consulta e agregação declarativa de dados, enquanto nossas classes cuidam da análise e validação de dados. </p><br><pre> <code class="powershell hljs"><span class="hljs-comment"><span class="hljs-comment">#       separation of concerns   class Node { [ValidateLength(3, 7)] [string] $Name [ValidateSet("INT", "PPE", "PROD")] [string] $FlightingRing [ValidateSet("EastUS", "WestUS", "NorthEurope", "WestEurope")] [string] $Region Node([string] $Name) { $Name -match "([az]+)(INT|PPE|PROD)([az]+)" $_, $this.Service, $this.FlightingRing, $this.Region = $Matches $this.Name = $Name } } class Datum { [string] $Name [int] $Value [Node] $Computer [int] Severity() { $this.Name -match "[0-9]+$" return $Matches[0] } } Write-Host "Urgent Security Audit Issues:" Import-Csv "./audit-results.csv" ` | ForEach-Object {[Datum]$_} ` | Where-Object Value -gt 0 ` | Group-Object {$_.Severity()} ` | Where-Object Name -lt 2 ` | ForEach-Object Group ` | ForEach-Object Computer ` | Where-Object FlightingRing -eq "PROD" ` | Sort-Object Name, Region -Unique</span></span></code> </pre> <br><br><h2 id="upakovka-klassa-dlya-pereispolzovaniya">  Reutilizar embalagens de classe </h2><br><h3 id="nichto-ne-stol-uzh-horosho-kak-kazhetsya">  Nada é tão bom quanto parece </h3><br><p>  Infelizmente, as classes não podem ser exportadas por módulos da mesma maneira que funções ou variáveis;  mas existem alguns truques.  Digamos que suas classes sejam definidas no arquivo ./my-classes.ps1 </p><br><ul><li><p>  Você pode dosar um arquivo com classes:.  ./my-classes.ps1.  Isso executará my-classes.ps1 no seu escopo atual e definirá todas as classes do arquivo. </p><br></li><li><p>  Você pode criar um módulo do Powershell que exporte todas as suas APIs de usuário (cmdlets) e defina a variável ScriptsToProcess = "./my-classes.ps1" no manifesto do seu módulo, com o mesmo resultado: ./my-classes.ps1 será executado em seu ambiente . </p><br></li></ul><br><p>  Qualquer que seja a opção escolhida, lembre-se de que o sistema de tipos Powershell não pode resolver os tipos com o mesmo nome carregados de lugares diferentes. <br>  Mesmo se você baixar duas classes idênticas com as mesmas propriedades de locais diferentes, você corre o risco de ter problemas. </p><br><h3 id="put-vpered">  Caminho a seguir </h3><br><p>  A melhor maneira de evitar problemas de resolução de tipos é nunca expor suas classes aos usuários.  Em vez de esperar que o usuário importe um tipo definido na classe, exporte do seu módulo uma função que elimine a necessidade de acessar diretamente a classe.  Para o Cluster, podemos exportar a função New-Cluster, que oferecerá suporte a conjuntos de parâmetros amigáveis ​​ao usuário e retornará o Cluster. </p><br><pre> <code class="powershell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cluster</span></span></span></span> { <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidatePattern</span></span></span><span class="hljs-function">(</span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"^[Az]+</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-string"><span class="hljs-variable">$</span></span></span></span><span class="hljs-function"><span class="hljs-string">"</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Service</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidateSet</span></span></span><span class="hljs-function">(</span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"TEST"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"STAGE"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"CANARY"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"PROD"</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FlightingRing</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidateSet</span></span></span><span class="hljs-function">(</span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"EastUS"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"WestUS"</span></span></span><span class="hljs-function">, </span><span class="hljs-string"><span class="hljs-function"><span class="hljs-string">"NorthEurope"</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Region</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">ValidateRange</span></span></span><span class="hljs-function">(</span><span class="hljs-number"><span class="hljs-function"><span class="hljs-number">0</span></span></span><span class="hljs-function">, </span><span class="hljs-number"><span class="hljs-function"><span class="hljs-number">255</span></span></span><span class="hljs-function">)] [</span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">int</span></span></span><span class="hljs-function">] $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Index</span></span></span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New-Cluster</span></span></span></span> { <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">OutputType</span></span></span><span class="hljs-function">([</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">Cluster</span></span></span><span class="hljs-function">])] </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Param</span></span></span></span>( [<span class="hljs-type"><span class="hljs-type">Parameter</span></span>(<span class="hljs-type"><span class="hljs-type">Mandatory</span></span>, <span class="hljs-type"><span class="hljs-type">ParameterSetName</span></span> = <span class="hljs-string"><span class="hljs-string">"Id"</span></span>, <span class="hljs-type"><span class="hljs-type">Position</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>)] [<span class="hljs-type"><span class="hljs-type">ValidateNotNullOrEmpty</span></span>()] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Id</span></span>, [<span class="hljs-type"><span class="hljs-type">Parameter</span></span>(<span class="hljs-type"><span class="hljs-type">Mandatory</span></span>, <span class="hljs-type"><span class="hljs-type">ParameterSetName</span></span> = <span class="hljs-string"><span class="hljs-string">"Components"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Service</span></span>, [<span class="hljs-type"><span class="hljs-type">Parameter</span></span>(<span class="hljs-type"><span class="hljs-type">Mandatory</span></span>, <span class="hljs-type"><span class="hljs-type">ParameterSetName</span></span> = <span class="hljs-string"><span class="hljs-string">"Components"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$FlightingRing</span></span>, [<span class="hljs-type"><span class="hljs-type">Parameter</span></span>(<span class="hljs-type"><span class="hljs-type">Mandatory</span></span>, <span class="hljs-type"><span class="hljs-type">ParameterSetName</span></span> = <span class="hljs-string"><span class="hljs-string">"Components"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Region</span></span>, [<span class="hljs-type"><span class="hljs-type">Parameter</span></span>(<span class="hljs-type"><span class="hljs-type">Mandatory</span></span>, <span class="hljs-type"><span class="hljs-type">ParameterSetName</span></span> = <span class="hljs-string"><span class="hljs-string">"Components"</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-variable"><span class="hljs-variable">$Index</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$Id</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$Service</span></span>, <span class="hljs-variable"><span class="hljs-variable">$FlightingRing</span></span>, <span class="hljs-variable"><span class="hljs-variable">$Region</span></span>, <span class="hljs-variable"><span class="hljs-variable">$Index</span></span> = <span class="hljs-variable"><span class="hljs-variable">$Id</span></span> <span class="hljs-operator"><span class="hljs-operator">-split</span></span> <span class="hljs-string"><span class="hljs-string">"-"</span></span> } [<span class="hljs-type"><span class="hljs-type">Cluster</span></span>]<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>{ Service = <span class="hljs-variable"><span class="hljs-variable">$Service</span></span> FlightingRing = <span class="hljs-variable"><span class="hljs-variable">$FlightingRing</span></span> Region = <span class="hljs-variable"><span class="hljs-variable">$Region</span></span> Index = <span class="hljs-variable"><span class="hljs-variable">$Index</span></span> } } <span class="hljs-built_in"><span class="hljs-built_in">Export-ModuleMember</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New-Cluster</span></span></code> </pre> <br><h4 id="chto-eschyo-pochitat">  O que mais ler </h4><br><p>  <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_classes">Sobre Classes</a> <br>  <a href="https://medium.com/%40cjkuech/defensive-powershell-with-validation-attributes-8e7303e179fd">PowerShell defensivo</a> <br>  <a href="https://medium.com/%40cjkuech/functional-programming-in-powershell-876edde1aadb">Programação funcional no PowerShell</a> <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484300/">https://habr.com/ru/post/pt484300/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484288/index.html">Como o confronto da Guerra Fria ajuda os chineses a iniciar a produção de computadores</a></li>
<li><a href="../pt484290/index.html">A folha de dicas que é necessária no iate</a></li>
<li><a href="../pt484292/index.html">O maior físico</a></li>
<li><a href="../pt484294/index.html">Hospedagem compartilhada ou servidor virtual - o que escolher?</a></li>
<li><a href="../pt484296/index.html">Lytko une</a></li>
<li><a href="../pt484302/index.html">Slurm DevOps - um melhor desempenho em 3 dias do que uma bela grua no futuro distante</a></li>
<li><a href="../pt484304/index.html">China adotou seu "Pacote Primavera"</a></li>
<li><a href="../pt484306/index.html">Aprendizagem pode ser uma revisão indecidível</a></li>
<li><a href="../pt484310/index.html">Biblioteca Webix JavaScript através dos olhos de um iniciante. Parte 2. Trabalhar com Formulários</a></li>
<li><a href="../pt484312/index.html">Armazenamento eficiente de centenas de milhões de arquivos pequenos. Solução Auto-Hospedada</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>