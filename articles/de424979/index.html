<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛶 🦑 🙎🏼 Ulme. Bequem und umständlich. HTTP, Aufgabe 🎚️ ⌛️ 👩🏻‍🤝‍👨🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir sprechen weiterhin über Elm 0.18 . 


 Ulme. Bequem und umständlich 
 Ulme. Bequem und umständlich. Zusammensetzung 
 Ulme. Bequem und umständlich...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ulme. Bequem und umständlich. HTTP, Aufgabe</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424979/"><p>  Wir sprechen weiterhin über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Elm 0.18</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ulme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bequem und umständlich</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ulme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bequem und umständlich.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zusammensetzung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ulme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bequem und umständlich.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Json.Encoder und Json.Decoder</a> </p><br><p>  In diesem Artikel werden Probleme der Interaktion mit der Serverseite behandelt. </p><a name="habracut"></a><br><h2 id="vypolnenie-zaprosov">  Abfrageausführung </h2><br><p>  Beispiele für einfache Abfragen finden Sie in der Beschreibung des <a href="https://package.elm-lang.org/packages/elm-lang/">HTTP-</a> Pakets. </p><br><p>  Der Anforderungstyp ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Request a</a> . <br>  Der Abfrageergebnistyp ist Ergebnis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Error</a> a. <br>  Beide Typen werden durch den Benutzertyp parametrisiert, dessen Decoder beim Generieren der Anforderung angegeben werden muss. </p><br><p>  Sie können die Anforderung mit den folgenden Funktionen ausführen: </p><br><ol><li>  Http.send; </li><li>  Http.toTask. </li></ol><br><p>  Mit Http.send können Sie die Anforderung ausführen und die Nachricht nach Abschluss an die im ersten Argument angegebene Aktualisierungsfunktion übergeben.  Die Nachricht enthält Daten über das Ergebnis der Anforderung. </p><br><p> Mit Http.toTask können Sie eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aufgabe</a> aus einer Anforderung erstellen, die Sie ausführen können.  Die Verwendung der Funktion Http.toTask ist meiner Meinung nach am bequemsten, da Task-Instanzen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mit verschiedenen Funktionen</a> kombiniert <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden können</a> , z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.map2</a> . </p><br><p>  Schauen wir uns ein Beispiel an.  Um beispielsweise Benutzerdaten zu speichern, müssen zwei aufeinanderfolgende abhängige Abfragen ausgeführt werden.  Lassen Sie es einen Beitrag vom Benutzer erstellen und Fotos für ihn speichern (einige CDN wird verwendet). </p><br><p>  Betrachten Sie zunächst die Implementierung für den Fall Http.Send.  Dafür benötigen wir zwei Funktionen: </p><br><pre><code class="hljs vbscript">save : UserData -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> UserData save userData = Http.post “/some/url” (Http.jsonBody (encodeUserData userData)) decodeUserData saveImages : <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; Images -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> CDNData saveImages id images = Http.post (“/some/cdn/<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>/” ++ (toString id)) (imagesBody images) decodedCDNData</code> </pre> <br><p>  Die UserData- und CDNData-Typen werden nicht beschrieben, beispielsweise sind sie nicht wichtig.  Die Funktion encodeUserData ist ein Encoder.  saveImages akzeptiert eine Benutzerdaten-ID, die zur Bildung der Adresse verwendet wird, und eine Liste von Fotos.  Die imagesBody-Funktion bildet einen Anforderungshauptteil vom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://package.elm-lang.org/packages/elm-lang/">mehrteiligen / Formulardatentyp</a> .  Die Funktionen decodeUserData und decodedCDNData decodieren die Serverantwort für Benutzerdaten bzw. das Ergebnis der CDN-Anforderung. </p><br><p>  Als nächstes benötigen wir zwei Nachrichten, die Abfrageergebnisse: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ImagesSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Angenommen, irgendwo in der Implementierung der Aktualisierungsfunktion gibt es einen Codeabschnitt, in dem Daten gespeichert werden.  Zum Beispiel könnte es so aussehen: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ClickedSomething -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Http.send DataSaved (<span class="hljs-keyword"><span class="hljs-keyword">save</span></span> model.userData))</code> </pre> <br><p>  In diesem Fall wird eine Abfrage erstellt und mit einer DataSaved-Nachricht markiert.  Ferner wird diese Nachricht empfangen: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> DataSaved (Ok userData) -&gt; ( {<span class="hljs-keyword"><span class="hljs-keyword">model</span></span> | userData = userData}, Http.send ImagesSaved (saveImages userData.id model.images)) DataSaved (Err reason) -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Cmd.None)</code> </pre> <br><p>  Bei erfolgreichem Speichern aktualisieren wir die Daten im Modell und rufen die Anforderung zum Speichern der Fotos auf, auf die wir die empfangene Benutzerdaten-ID übertragen.  Die Verarbeitung der ImagesSaved-Nachricht ähnelt der von DataSaved. Es ist erforderlich, erfolgreiche und fehlgeschlagene Fälle zu behandeln. </p><br><p>  Betrachten Sie nun die Option, die Funktion Http.toTask zu verwenden.  Mit den beschriebenen Funktionen definieren wir eine neue Funktion: </p><br><pre> <code class="hljs erlang-repl">saveAll : UserData -&gt; Images -&gt; Task Http.Error (UserData, CDNData) saveAll : userData images = save model.userData |&gt; Http.toTask |&gt; Task.andThen (\newUserData -&gt; saveImages usersData.id images |&gt; Http.toTask |&gt; Task.map (\newImages -&gt; (userData, newImages) } )</code> </pre> <br><p>  Durch die Möglichkeit, Aufgaben zu kombinieren, können wir jetzt alle Daten in einer Nachricht abrufen: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)) update : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class">) update msg model case </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> of </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ClickedSomething</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attempt</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveAll</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) -&gt; ( {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">}, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">none</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Err</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reason</span></span></span><span class="hljs-class">) -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Zum Ausführen von Anforderungen verwenden wir die Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.attempt</a> , mit der Sie die Aufgabe ausführen können.  Nicht zu verwechseln mit der Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.perform</a> .  Task.perform - Ermöglicht das Ausführen von Aufgaben, <strong>die nicht fehlschlagen können</strong> .  Task.attempt - Führt Aufgaben aus, die <strong>möglicherweise fehlschlagen</strong> . </p><br><p>  Dieser Ansatz ist kompakter in Bezug auf die Anzahl der Nachrichten, die Komplexität der Aktualisierungsfunktion und ermöglicht es Ihnen, die Logik lokaler zu halten. </p><br><p>  In meinen Projekten, Anwendungen und Komponenten erstelle ich häufig das Modul Commands.elm, in dem ich die Funktionen der Interaktion mit dem Serverteil mit dem Typ ... -&gt; Task Http.Error a beschreibe. </p><br><h2 id="sostoyanie-vypolneniya-zaprosov">  Ausführungsstatus anfordern </h2><br><p>  Bei der Ausführung von Abfragen muss die Schnittstelle häufig ganz oder teilweise blockiert werden und gegebenenfalls auch Fehler bei der Ausführung von Abfragen melden.  Im Allgemeinen kann der Status einer Anfrage wie folgt beschrieben werden: </p><br><ol><li>  die Anfrage wurde nicht abgeschlossen; </li><li>  die Anfrage ist in Bearbeitung; </li><li>  Die Anfrage wurde erfolgreich abgeschlossen. </li><li>  Anfrage fehlgeschlagen. </li></ol><br><p>  Für eine solche Beschreibung gibt es ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RemoteData-</a> Paket.  Zuerst habe ich es aktiv genutzt, aber im Laufe der Zeit wurde das Vorhandensein eines zusätzlichen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WebData-</a> Typs überflüssig und die Arbeit damit war mühsam.  Anstelle dieses Pakets wurden die folgenden Regeln angezeigt: </p><br><ol><li>  Deklarieren Sie alle Daten vom Server als Vielleicht.  In diesem Fall zeigt Nothing das Fehlen von Daten an. </li><li>  Deklarieren Sie ein Ladeattribut vom Typ Int im Anwendungs- oder Komponentenmodell.  Der Parameter speichert die Anzahl der ausgeführten Anforderungen.  Die einzige Unannehmlichkeit dieses Ansatzes besteht in der Notwendigkeit, das Attribut zu Beginn der Anforderung bzw. nach Abschluss zu erhöhen und zu verringern. </li><li>  Deklarieren Sie ein Fehlerattribut vom Typ List String im Anwendungs- oder Komponentenmodell.  Dieses Attribut wird zum Speichern von Fehlerdaten verwendet. </li></ol><br><p>  Das beschriebene Schema ist nicht viel besser als die Option mit dem RemoteData-Paket, wie die Praxis zeigt.  Wenn jemand andere Optionen hat, teilen Sie in den Kommentaren. </p><br><p>  Der Ausführungsstatus der Anforderung sollte den Download-Fortschritt aus dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Progress-</a> Paket enthalten. </p><br><h2 id="posledovatelnost-zadach">  Tasksequenz </h2><br><p>  Berücksichtigen Sie die Optionen für Tasksequenzen, die häufig in der Entwicklung zu finden sind: </p><br><ol><li>  sequentiell abhängige Aufgaben; </li><li>  konsistente unabhängige Aufgaben; </li><li>  parallele unabhängige Aufgaben. </li></ol><br><p>  Aufeinanderfolgende abhängige Aufgaben wurden bereits oben betrachtet, und ich werde in diesem Abschnitt eine allgemeine Beschreibung und Ansätze zur Implementierung geben. </p><br><p>  Die Tasksequenz wird beim ersten Fehler unterbrochen und ein Fehler zurückgegeben.  Bei Erfolg wird eine Kombination von Ergebnissen zurückgegeben: </p><br><pre> <code class="hljs erlang-repl">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  Dieser Code erstellt eine Aufgabe vom Typ Aufgabenfehler (a, b), die später ausgeführt werden kann. </p><br><p>  Mit der Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.andThen</a> können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie</a> eine neue Aufgabe zur Ausführung übertragen, wenn die vorherige erfolgreich abgeschlossen wurde.  Mit der Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.map</a> können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie</a> Melon-Ausführungsergebnisse bei Erfolg konvertieren. </p><br><p>  Es gibt Optionen, bei denen der erfolgreiche Abschluss der Aufgabe nicht ausreicht und Sie die Konsistenz der Daten überprüfen müssen.  Angenommen, die Benutzer-IDs stimmen überein: </p><br><pre> <code class="hljs pgsql">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.andThen (\resultB -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> resultA.userId == resultB.userId <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> -&gt; Task.succeed (resultA, resultB) <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> -&gt; Task.fail “<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the same” ) )</code> </pre> <br><p>  Es ist anzumerken, dass anstelle der Funktion Task.map die Funktion Task.andThen verwendet wird und der Erfolg der zweiten Aufgabe unabhängig mithilfe der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Funktionen</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.succeed</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.fail bestimmt wird</a> . </p><br><p>  Wenn eine der Aufgaben fehlschlagen kann und dies akzeptabel ist, müssen Sie die Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.onError</a> verwenden, um den Wert im Fehlerfall anzugeben: </p><br><pre> <code class="hljs julia">someTaskA |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.onError (\msg -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>,succeed defaultValue) |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.andThen (\resultA -&gt; someTaskB |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  Der Aufruf der Funktion Task.onError sollte unmittelbar nach der Deklaration der Task deklariert werden. </p><br><p>  Aufeinanderfolgende unabhängige Abfragen können mit den Funktionen Task.mapN ausgeführt werden.  So können Sie mehrere Aufgabenergebnisse zu einem kombinieren.  Die erste heruntergefallene Aufgabe unterbricht die Ausführung der gesamten Kette. Verwenden Sie daher die Funktion Task.onError für die Standardwerte.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schauen Sie sich auch die</a> Funktion <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Task.sequence an</a> , mit der Sie eine Reihe ähnlicher Aufgaben ausführen können. </p><br><p>  Parallele Aufgaben in der aktuellen Sprachimplementierung werden nicht beschrieben.  Ihre Implementierung ist auf Anwendungs- oder Komponentenebene durch Ereignisverarbeitung in der Aktualisierungsfunktion möglich.  Alle Logik bleibt auf den Schultern des Entwicklers. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de424979/">https://habr.com/ru/post/de424979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de424969/index.html">Node.js-Handbuch, Teil 9: Arbeiten mit dem Dateisystem</a></li>
<li><a href="../de424971/index.html">Habrokast "Sunset Manually" # 1. Versuch, eine Umgebung für die Entwicklung eines Spielzeugs für Windows einzurichten</a></li>
<li><a href="../de424973/index.html">Gesichtserkennung auf Video: Raspberry Pi und Neural Compute Stick</a></li>
<li><a href="../de424975/index.html">SIEM-Tiefen: Out-of-Box-Korrelationen. Teil 2. Datenschema als Reflexion des Weltmodells</a></li>
<li><a href="../de424977/index.html">Aus Fehlern lernen: Anwendungen im App Store und bei Google Play optimieren</a></li>
<li><a href="../de424981/index.html">Osterei-Text-Rollenspiel im Google-Suchmaschinencode</a></li>
<li><a href="../de424985/index.html">In einem wichtigen Präzedenzfall konnten US-Geheimdienste Anrufe im Messenger nicht abhören</a></li>
<li><a href="../de424987/index.html">Stellen Sie mit dem Wiener Filter unscharfe und defokussierte Bilder wieder her. Implementierung in C ++ OpenCV</a></li>
<li><a href="../de424989/index.html">Designprozess: 7 Schritte zum perfekten Projekt</a></li>
<li><a href="../de424991/index.html">Wenn alte Methoden nicht funktionieren: Vasily Mazin - über einen hybriden Ansatz zur KI-Entwicklung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>