<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏻 👯 💠 Wie ohne Schmerzen, ohne Sicherheitsabfrage und kostenlos, um Auszüge aus dem Federal State Property Fund des Unified State Register of Human Rights in eine für Menschen lesbare (*) Form zu bringen 🤛🏼 🤙🏾 🧒🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mein Verantwortungsbereich ist die Abonnementabteilung der Republik Nordossetien, eineinhalbhunderttausend persönliche Konten in drei Regionen der Reg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ohne Schmerzen, ohne Sicherheitsabfrage und kostenlos, um Auszüge aus dem Federal State Property Fund des Unified State Register of Human Rights in eine für Menschen lesbare (*) Form zu bringen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479978/"><p>  Mein Verantwortungsbereich ist die Abonnementabteilung der Republik Nordossetien, eineinhalbhunderttausend persönliche Konten in drei Regionen der Region.  Als Hintergrund erkläre ich Ihnen, wie ich zu Aussagen komme. </p><br><p>  Ich fing an, mit Rosreestr, wie sie sagen, auf der Stirn zu arbeiten: Ich öffnete den <a href="https://rosreestr.ru/wps/portal/p/cc_present/ir_egrn" rel="nofollow">Antrag über den Zugang zur staatlichen Immobilieninspektion der USRN</a> , gab den Schlüssel ein, füllte das Suchformular aus, klickte auf „Suchen“, wählte ein Objekt vom Typ „Wohngebäude“ oder „Wohnung“, bestellte einen Auszug, lud ein elektronisches Dokument herunter, konvertierte es in ein für Menschen lesbares (*) Format und speicherte es.  Alles ist einfach, aber nicht ohne Nuancen. </p><a name="habracut"></a><br><p>  Das Hauptproblem war, dass die Suche in vielen Fällen mehrere geeignete Objekte ergibt und Sie sich entscheiden müssen, für welches die Anweisung bestellt werden soll.  Ich fand keine offensichtlichen Kriterien und niemand half mir.  Ich habe immer alle passenden Optionen bestellt - meistens waren es zwei, manchmal drei, manchmal vier.  In den meisten Fällen stellte sich heraus, dass ein Dokument ein Auszug ist, und der Rest - "Dummies": "keine Informationen".  In einigen Fällen erwiesen sich alle Dokumente als "Dummies".  Deadlock: Geld ausgegeben, keine Informationen. </p><br><p><img src="https://habrastorage.org/webt/5v/tn/xp/5vtnxpeobvkmw1bnru9jrlfs-pc.png" alt="Bild"></p><br><p>  Das Problem wurde von einem neuen Kollegen in einem ungezwungenen Gespräch gelöst: Bevor Sie in das FSIS USRN einsteigen, müssen Sie die Adresse im offenen Teil der Rosreestr. <a href="https://rosreestr.ru/wps/portal/online_request" rel="nofollow">Referenzinformationen zu Immobilienobjekten online</a> durchbrechen.  Dort prüfen wir die Verfügbarkeit von Informationen zur Übertragung von Schutzrechten und bestellen bereits mit einer fertigen Katasternummer einen Auszug.  Dies verlängert etwas (und macht es gleichzeitig einfacher und schneller!) Den Weg zur Entladung, aber es ist sehr nützlich, weil  Für unsere Zwecke reicht oft ein Screenshot mit dem Datum des Rechtsübergangs aus;  Außerdem verwende ich diese Daten, um in den GIS-Dienstprogrammen zu arbeiten. </p><br><p><img src="https://habrastorage.org/webt/h2/mq/wr/h2mqwrcjc5ntewq-xarfbsoqtsm.png" alt="Bild"></p><br><p>  Also: </p><br><ul><li>  an der Adresse bestimmen wir die Katasternummer des Grundstücks, an dem (im Grundstück) Informationen über die Übertragung von Schutzrechten vorliegen (erstes Captcha); </li><li>  auf diese Katasternummer bestellen wir einen Auszug (zweites Captcha); </li><li>  Warten Sie auf eine Antwort und speichern Sie die Datei. </li><li>  Wir erhalten eine lesbare (*) Kopie des Dokuments (drittes Captcha). </li></ul><br><p>  Anfangs habe ich ein Dutzend Aussagen pro Monat gemacht, also war die Frage der Automatisierung überhaupt nicht.  Und dann - Bam!  Einhundertfünfzig!  Ein Paket!  Und ich bin zusammengebrochen. </p><br><p>  Und jetzt zu den Folien. </p><br><p>  <a href="https://habr.com/ru/users/zoldaten/" class="user_link">zoldaten</a> <a href="https://habr.com/ru/post/460040/">automatisierte die Anfrage nach Extrakten</a> und <a href="https://habr.com/ru/post/464337/">besiegte</a> sogar <a href="https://habr.com/ru/post/464337/">das Captcha</a> .  Ich habe die Reduzierung von Auszügen auf eine für Menschen lesbare (*) Form vereinfacht. </p><br><ol><li>  Wir beginnen mit dem Blatt "# Address List for Request": <br><ul><li>  LAN und Adresse - die ursprünglichen Daten, die wir vom Kunden erhalten;  Die empfangene Anweisung wird so aufgerufen, wie sie in der Spalte "Adresse" steht (dies ist jedoch nicht korrekt, siehe unten). </li><li>  Die Katasternummer, die wir im offenen Teil von Rosreestr gefunden haben, ist die erste Stufe des Prozesses. </li><li>  Anfrage - Nachdem wir die Erstellung der Anfrage bestätigt haben, speichern wir deren Nummer. In Zukunft wird die Nummer benötigt, um den gesamten Prozess zu steuern, den technischen Support zu kontaktieren usw.  - die zweite Phase des Prozesses. </li></ul></li><li>  Blatt "#Main": Klicken Sie auf die Schaltfläche "Alle Dateien verarbeiten".  Bei einer Geschwindigkeit von 5 bis 50 Teilen pro Minute (abhängig von der Zugriffsgeschwindigkeit auf den Dateispeicher) erhalten wir lesbare (*) Auszüge im PDF-Format. <br><br><img src="https://habrastorage.org/webt/1p/oo/d5/1pood5ec1fmopkyglbcunkr2ghm.png" alt="Bild"></li><li>  Wir speichern Berichte, wir senden sie an den Kunden. </li></ol><br><p>  Was muss getan werden, damit es funktioniert? </p><br><ol><li>  Erlaube natürlich Makros; </li><li>  Fügen Sie einen Link zu einer Komponente für die Verarbeitung von XML hinzu (Alt + F11&gt; Extras&gt; Verweise, suchen Sie etwas mit XML-Buchstaben in der Liste, überprüfen Sie). <br><br><img src="https://habrastorage.org/webt/5e/te/xt/5etextu0fsqqsbxhuvmtz_qmexe.png" alt="Bild"></li><li>  Aktivieren Sie die Anzeige von Dateierweiterungen - ohne diese Funktion funktioniert der in Windows integrierte Archivierer nicht. <br><br><img src="https://habrastorage.org/webt/xw/zd/pq/xwzdpqvtdqv9vlmu5oz3au3npv0.png" alt="Bild"></li><li>  alle <em>von Rosrestrestra empfangenen</em> Dateien "Response-80- <em>.zip" in einem Ordner ablegen;</em>  <em>Dabei werden alle Dateien mit Ausnahme von „Response-80-</em> .zip“ <em>aus diesem Ordner gelöscht</em> .  Aussagen werden dort gespeichert;  Alle Dateien werden verarbeitet. </li></ol><br><p>  Wo geprüft: </p><br><ul><li>  Terminalserver Windows 2008 + Office 2010 - funktioniert mit XML Version 3.0 und 6.0; </li><li>  Windows 10 + Office 365 - funktioniert nur mit XML 3.0. </li></ul><br><p>  Darüber hinaus. </p><br><ol><li>  Es gibt nur minimalen Schutz vor dem Narren. </li><li>  Wenn es zwei Aussagen mit den gleichen Katasternummern gibt, fällt alles.  Sie müssen sich das Protokoll ansehen (in einer separaten Datei), den Überschuss entfernen und alles von Anfang an neu starten. </li><li>  Es werden nur Anweisungen zur Übertragung von Rechten und "Dummies" implementiert, Anweisungen vom Typ "Informationen zum Objekt" werden nicht verarbeitet. </li><li>  Wenn die Quelldaten nicht die erforderliche Katasternummer enthalten (z. B. das Blatt ist im Allgemeinen leer und wir beginnen mit der Verarbeitung), werden die Anweisungen an der Adresse der Anweisung selbst benannt. </li><li>  Wenn es zwei oder mehr Anweisungen mit identischen Adressen gibt, wird eine zusätzliche Nummer in den Dateinamen geschrieben. </li><li>  Blattnamen - Hardcode können Sie nicht ändern;  Bei jedem Start wird alles außer diesen (und zwei ausgeblendeten) Blättern aus dem Buch gelöscht. </li></ol><br><p>  Ich kommentiere den Code nicht, da gibt es absolut nichts Interessantes - banale Schleifen, Durchqueren von XML-Knoten, Erweitern von Variablen in Zellen. </p><br><p>  Der Code ist offen und frei von jeglichen Einschränkungen </p><br><p>  (*) Das Wort "für Menschen lesbar" wird auf dieser Seite 6 Mal verwendet. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479978/">https://habr.com/ru/post/de479978/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479966/index.html">Playrix CI / CD: Wie wir unsere Spiele bauen und testen</a></li>
<li><a href="../de479968/index.html">Das Büro von Nginx wird aufgrund einer Klage der Rambler Group durchsucht. Der Pressedienst des Beschwerdeführers bestätigte die Klage</a></li>
<li><a href="../de479970/index.html">Tausend und ein UI-Fehler oder wie man einem Entwickler hilft, häufige UI-Fehler zu vermeiden</a></li>
<li><a href="../de479972/index.html">Apple Patch-Verlauf</a></li>
<li><a href="../de479974/index.html">Zero-Click-Angriffe: Wenn Ihre Sicherheit nicht Ihnen überlassen bleibt</a></li>
<li><a href="../de479982/index.html">Vidos und Insekten</a></li>
<li><a href="../de479988/index.html">Technologische Wettbewerbe Radiofest-2019. Zusammenfassung</a></li>
<li><a href="../de479992/index.html">Wie Sie UITextView beibringen, sich von anderen abzuheben</a></li>
<li><a href="../de479996/index.html">2 nm Transistoren: Zerhacken oder Zerhacken?</a></li>
<li><a href="../de479998/index.html">Türkische Tricks mit Würmern, Ratten ... und einem Freiberufler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>