<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฝ ๐ ๐ฉ๐ปโ๐ค RESTinio ูู ุฎุงุฏู HTTP ุบูุฑ ูุชุฒุงูู. ุบูุฑ ุงููุชุฒุงูู ๐ฅ ๐ฉ๐ฟโ๐คโ๐จ๐ป ๐ฝ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฐ ุนุงููู ุ ูููุง ุจูุดุฑ RESTinio ุ ุฅุทุงุฑ ุนูู OpenSource C ++ ุงูุตุบูุฑ ูุชุถููู ุฎุงุฏู HTTP ูู ุชุทุจููุงุช C ++. ูู ุชุตุจุญ RESTinio ุฐุงุช ุดุนุจูุฉ ูุจูุฑุฉ ุฎูุงู ูุฐุง ุงูููุช ุ ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>RESTinio ูู ุฎุงุฏู HTTP ุบูุฑ ูุชุฒุงูู. ุบูุฑ ุงููุชุฒุงูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451728/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ููุฐ ุนุงููู ุ ูููุง ุจูุดุฑ <a href="">RESTinio</a> ุ ุฅุทุงุฑ ุนูู OpenSource C ++ ุงูุตุบูุฑ ูุชุถููู ุฎุงุฏู HTTP ูู ุชุทุจููุงุช C ++.  ูู ุชุตุจุญ RESTinio ุฐุงุช ุดุนุจูุฉ ูุจูุฑุฉ ุฎูุงู ูุฐุง ุงูููุช ุ ููููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุชุถูุน</a> .  ูุฎุชุงุฑ ุฃุญุฏูู ุงูุฏุนู "ุงูุฃุตูู" ููุธุงู ุงูุชุดุบูู Windows ุ ูุดุฎุต ูุง ูุจุนุถ ุงูููุฒุงุช ุงููุฑุฏูุฉ (ูุซู ุฏุนู sendfile) ุ ูุดุฎุต ูุณุจุฉ ุงูููุฒุงุช ุ ูุณูููุฉ ุงูุงุณุชุฎุฏุงู ูุงูุชุฎุตูุต.  ููููู ุฃุนุชูุฏ ุ ูู ุงูุจุฏุงูุฉ ุ ุฃู ุงูุนุฏูุฏ ูู RESTinio ููุฌุฐุจูู ุฅูู ูุฐุง "ุงููุงููุช ุ ุงูุนุงูู" ุงูุฎุงุทุฆ: </p><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;restinio/all.hpp&gt; int main() { restinio::run( restinio::on_this_thread() .port(8080) .address("localhost") .request_handler([](auto req) { return req-&gt;create_response().set_body("Hello, World!").done(); })); return 0; }</span></span></span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ุญููุง ูู ูุง ูู ูุทููุจ ูุชุดุบูู ุฎุงุฏู HTTP ุฏุงุฎู ุชุทุจูู C ++. </p><br><p style=";text-align:right;direction:rtl">  ูุนูู ุงูุฑุบู ูู ุฃููุง ูุญุงูู ุฏุงุฆููุง ุฃู ูููู ุฅู ุงูููุฒุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ูุดุงุฑู ูููุง ุจุดูู ุนุงู ูู RESTinio ูู ุงููุนุงูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ููุทูุจุงุช ุงููุงุฑุฏุฉ ุ ูุฅููุง ูุง ูุฒุงู ููุงุฌู ุฃุญูุงููุง ุฃุณุฆูุฉ ุญูู ูุง ูุฌุจ ุงูููุงู ุจู ุฅุฐุง ูุงู ุนููู ุงูููุงู ุจุนูููุงุช ูุทููุฉ ูู ุฏุงุฎู request_handler. </p><br><p style=";text-align:right;direction:rtl">  ูุจูุง ุฃู ูุซู ูุฐุง ุงูุณุคุงู ุฐู ุตูุฉ ุ ูููููู ุงูุชุญุฏุซ ุนูู ูุฑุฉ ุฃุฎุฑู ูุฅุนุทุงุก ูุซุงููู ุตุบูุฑูู. </p><a name="habracut"></a><br><h1 id="nebolshaya-otsylka-k-istokam" style=";text-align:right;direction:rtl">  ุฅุดุงุฑุฉ ุตุบูุฑุฉ ุฅูู ุงูุฃุตูู </h1><br><p style=";text-align:right;direction:rtl">  ูุฑุฑูุง ุฃู ูุฌุนู ุฎุงุฏู HTTP ุงููุงุจู ููุชุถููู ุงูุฎุงุต ุจูุง ุจุนุฏ ุนุฏุฉ ูุฑุงุช ูุชุชุงููุฉ ููุงุฌู ููุงู ูุชุดุงุจูุฉ ููุบุงูุฉ: ูุงู ูู ุงูุถุฑูุฑู ุชูุธูู ุฅุฏุฎุงู HTTP ูุชุทุจูู C ++ ููุฌูุฏ ุฃู ูุงู ูู ุงูุถุฑูุฑู ูุชุงุจุฉ ุฎุฏูุฉ microservice ูุงู ูู ุงูุถุฑูุฑู ูููุง ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู C ++ "ุงูุซููู" ุงูููุฌูุฏ ุจุงููุนู ุฑูุฒ ูููููุฑู.  ูู ุงูุฎุตุงุฆุต ุงูุดุงุฆุนุฉ ููุฐู ุงูููุงู ุฃู ูุนุงูุฌุฉ ุงูุทูุจ ููุทูุจ ูููู ุฃู ุชูุชุฏ ูุนุดุฑุงุช ุงูุซูุงูู. </p><br><p style=";text-align:right;direction:rtl">  ุจูุนูู ุชูุฑูุจู ุ ููุฏุฉ ูููู ุซุงููุฉ ูุงุญุฏุฉ ุ ูุงู ุฎุงุฏู HTTP ูููู ุจุชุฑุชูุจ ุทูุจ HTTP ุฌุฏูุฏ ุ ูููู ูู ุฃุฌู ุฅุตุฏุงุฑ ุงุณุชุฌุงุจุฉ HTTP ุ ูุงู ูู ุงูุถุฑูุฑู ุงููุฌูุก ุฅูู ุจุนุถ ุงูุฎุฏูุงุช ุงูุฃุฎุฑู ุฃู ูุฅุฌุฑุงุก ุจุนุถ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุงููุทููุฉ.  ุฅุฐุง ููุช ุจูุนุงูุฌุฉ ุทูุจุงุช HTTP ูู ุงููุถุน ุงููุชุฒุงูู ุ ูุณูุญุชุงุฌ ุฎุงุฏู HTTP ุฅูู ูุฌููุนุฉ ูู ุขูุงู ุณูุงุณู ุงูุนูู ุ ูุงูุชู ุจุงููุงุฏ ูููู ุงุนุชุจุงุฑูุง ููุฑุฉ ุฌูุฏุฉ ุญุชู ูู ุงูุธุฑูู ุงูุญุฏูุซุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุฃูุซุฑ ููุงุกูุฉ ุนูุฏูุง ูููู ูุฎุงุฏู HTTP ุงูุนูู ุนูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูุงุญุฏ ููุท ุ ุญูุซ ูุชู ุชูููุฐ I / O ููุชู ุงุณุชุฏุนุงุก ูุนุงูุฌุงุช ุงูุทูุจ.  ูููู ูุนุงูุฌ ุงูุทูุจ ุจุจุณุงุทุฉ ุจุชูููุถ ุงููุนุงูุฌุฉ ุงููุนููุฉ ูุจุนุถ ูุคุดุฑุงุช ุชุฑุงุจุท ุงูุนูู ุงูุฃุฎุฑู ูุฅุฑุฌุงุน ุงูุชุญูู ุฅูู ุฎุงุฏู HTTP.  ุนูุฏูุง ุชููู ุงููุนูููุงุช ูู ููุช ูุงุญู ุ ูู ููุงู ูุง ุนูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ุขุฎุฑ ุ ุฌุงูุฒุฉ ููุฑุฏ ุนูู ุงูุทูุจ ุ ูุชู ุฅูุดุงุก ุงุณุชุฌุงุจุฉ HTTP ุจุจุณุงุทุฉ ุชูุชูุท ุฎุงุฏู HTTP ุชููุงุฆููุง ูุชุฑุณู ูุฐุง ุงูุฑุฏ ุฅูู ุงูุนููู ุงูููุงุณุจ. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃููุง ูู ูุนุซุฑ ุฃุจุฏูุง ุนูู ุฅุตุฏุงุฑ ุฌุงูุฒ ุจุณูุท ูุณูู ุงูุงุณุชุฎุฏุงู ุ ููุฏ ูุงู ูุธุงููุง ูุชูุงุทุนูุง ููููุฏูุฒูุง ูุนุชูุฏูุง ุนูู ุฃูู ูุธุงู ุฃุณุงุณู "ุฃุตูู" ุ ูุณูููุฑ ุฃุฏุงุก ูุงุฆููุง ุฅูู ุญุฏ ูุง ุ ูุงูุฃูู ูู ุฐูู ุฃูู ุณูุชู ุชูุญูุฏู ุฎุตูุตูุง ููุงุณุชุฎุฏุงู ุบูุฑ ุงููุชุฒุงูู ุงูุนูู ุ ุซู ูู ุจุฏุงูุฉ ุนุงู 2017 ุจุฏุฃูุง ุชุทููุฑ RESTinio. </p><br><p style=";text-align:right;direction:rtl">  ููุฏ ุฃุฑุฏูุง ุฃู ูุฌุนู ุฎุงุฏู HTTP ูุถูููุง ุบูุฑ ูุชุฒุงูู ุ ูุณูู ุงูุงุณุชุฎุฏุงู ุ ููุง ูุญุฑุฑ ุงููุณุชุฎุฏู ูู ุจุนุถ ุงููุฎุงูู ุงูุฑูุชูููุฉ ุ ูู ุญูู ุฃู ุฃูุซุฑ ุฃู ุฃูู ุฅูุชุงุฌูุฉ ุ ุนุจุฑ ููุตุฉ ููุณูุญ ุจุชูููู ูุฑู ููุฎุชูู ุงูุธุฑูู.  ูุจุฏู ุฃูู ูุนูู ุฌูุฏูุง ุ ูููู ุฏุนูุง ูุชุฑู ุงูุฃูุฑ ูููุณุชุฎุฏููู ููุญูููุง ... </p><br><h1 id="itak-est-vhodyaschiy-zapros-trebuyuschiy-mnogo-vremeni-na-obrabotku-chto-delat" style=";text-align:right;direction:rtl">  ูุฐูู ุ ููุงู ุทูุจ ูุงุฑุฏ ูุชุทูุจ ุงููุซูุฑ ูู ููุช ุงููุนุงูุฌุฉ.  ูุง ูุฌุจ ุงูููุงู ุจู </h1><br><h2 id="rabochie-niti-restinioasio" style=";text-align:right;direction:rtl">  ุฎููุท ุงูุนูู RESTinio / Asio </h2><br><p style=";text-align:right;direction:rtl">  ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุง ูููุฑ ูุณุชุฎุฏูู RESTinio ูู ููุถูุนุงุช ุงูุนูู ูููู ูุณุชุฎุฏู RESTinio ุจุงูุถุจุท.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูุนุชุจุฑ ุดุฎุต ูุง ุฃูู ุนูุฏูุง ูุชู ุชุดุบูู RESTinio ุนูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูุงุญุฏ (ุจุงุณุชุฎุฏุงู <code>run(on_this_thread(...))</code> ุ ููุง ูู ุงููุซุงู ุฃุนูุงู) ุ ุซู ุนูู ูุคุดุฑ ุชุฑุงุจุท ุงูุนูู ูุฐุง ูุณุชุฏุนู RESTinio ูุนุงูุฌุงุช ุทูุจ ููุท.  ุจูููุง I / O RESTinio ูุฎูู ููุถูุน ูููุตู ุชุญุช ุบุทุงุก ูุญุฑู ุงูุณูุงุฑุฉ.  ููุณุชูุฑ ูุคุดุฑ ุงูุชุฑุงุจุท ุงููููุตู ูุฐุง ูู ุฎุฏูุฉ ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ ุนูุฏูุง ูููู ูุคุดุฑ ุชุฑุงุจุท ุงูุนูู ุงูุฑุฆูุณู ูุดุบูููุง ุจุงูุทูุจ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูุชู ุงุณุชุฎุฏุงู ูุงูุฉ ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุงูุชู ูุฎุตุตูุง ุงููุณุชุฎุฏู ูู RESTinio ูุชูููุฐ ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูููุงุทูุจ request_handlers.  ูุฐูู ุ ุฅุฐุง ุจุฏุฃุช ุชุดุบูู ุฎุงุฏู RESTinio ุฎูุงู <code>run(on_this_thread(...))</code> ุ ุซู ุฏุงุฎู <code>run()</code> ูู ุณูุณูุฉ ุงูุนูููุงุช ุงูุญุงููุฉ ุ ุณูุชู ุชูููุฐ ูู ูู I / O ููุนุงูุฌุงุช ุงูุทูุจ. </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุชูุฑูุจู ุ ุชุทูู RESTinio ุญููุฉ ุฃุญุฏุงุซ Asio ุ ุญูุซ ุชููู ุจูุนุงูุฌุฉ ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ ุ ููุฑุงุกุฉ ูุชุญููู ุงูุจูุงูุงุช ูู ุงูุงุชุตุงูุงุช ุงูุญุงููุฉ ุ ููุชุงุจุฉ ุงูุจูุงูุงุช ุงูุฌุงูุฒุฉ ููุฅุฑุณุงู ุ ููุนุงูุฌุฉ ุงูุงุชุตุงูุงุช ุงููุบููุฉ ุ ุฅูุฎ.  ูู ุจูู ุฃุดูุงุก ุฃุฎุฑู ุ ุจุนุฏ ูุฑุงุกุฉ ุงูุทูุจ ุงููุงุฑุฏ ูุชุญูููู ุจุงููุงูู ูู ุงูุงุชุตุงู ุงูุชุงูู ุ ูุชู ุงุณุชุฏุนุงุก request_handler ุงููุญุฏุฏ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู ููุนุงูุฌุฉ ูุฐุง ุงูุทูุจ. </p><br><p style=";text-align:right;direction:rtl">  ููููุง ูุฐูู ุ ุฅุฐุง ูุงู request_handler ุจุญุธุฑ ุชุดุบูู ุงูุฎูุท ุงูุญุงูู ุ ูุณูุชู ุฃูุถูุง ุญุธุฑ ุญููุฉ ุญุฏุซ Asio-action ุงูุชู ุชุนูู ุนูู ููุณ ุงูุฎูุท.  ูู ุดูุก ุจุณูุท. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุชู ุชุดุบูู RESTinio ุนูู ูุฌููุนุฉ ูู ูุคุดุฑุงุช ุชุฑุงุจุท ุงูุนูู (ุฃู ุนู ุทุฑูู <code>run(on_thread_pool(...))</code> ุ ููุง <a href="">ูู ูุฐุง ุงููุซุงู</a> ) ุ <code>run(on_thread_pool(...))</code> ููุณ ุงูุดูุก ุชูุฑูุจูุง: ูุชู ุชุดุบูู ุญููุฉ ุญุฏุซ Asio ุนูู ูู ูุคุดุฑ ุชุฑุงุจุท ูู ุงูุชุฌูุน.  ูุฐูู ุ ุฅุฐุง ุจุฏุฃ ุจุนุถ request_handler ูู ูุถุงุนูุฉ ุงููุตูููุงุช ุงููุจูุฑุฉ ุ ูุณูุคุฏู ุฐูู ุฅูู ุญุธุฑ ูุคุดุฑ ุชุฑุงุจุท ุงูุนูู ูู ุงูุชุฌูุน ููู ูุชู ุนุฑุถ ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูู ูุฐุง ุงูููุถูุน. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุนูุฏ ุงุณุชุฎุฏุงู RESTinio ุ ุชุชูุซู ูููุฉ ุงููุทูุฑ ูู ุฅููุงู ูููุฏุณู ุงูุทูุจ ูู ููุช ูุนููู ุ ูููุถู ุฃูุง ูููู ุฐูู ุทูููุงู. </p><br><h2 id="nuzhen-li-vam-pul-rabochih-potokov-dlya-restinioasio" style=";text-align:right;direction:rtl">  ูู ุชุญุชุงุฌ ุฅูู ุชุฌูุน ุณูุฑ ุนูู ูู RESTinio / Asioุ </h2><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุนูุฏูุง ูููู request_handler ุงููุญุฏุฏ ูู ูุจู ุงููุณุชุฎุฏู ุจุญุธุฑ ูุคุดุฑ ุชุฑุงุจุท ุงูุนูู ุงูุฐู ูุชู ุงุณุชุฏุนุงุคู ููุชุฑุฉ ุทูููุฉ ุ ูููุฏ ูุคุดุฑ ุงูุชุฑุงุจุท ูุฐุง ุงููุฏุฑุฉ ุนูู ูุนุงูุฌุฉ ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ.  ูููู ูุงุฐุง ูู ุฃู request_handler ูุญุชุงุฌ ุฅูู ุงููุซูุฑ ูู ุงูููุช ูุชูููู ุงุณุชุฌุงุจุฉุ  ูููุชุฑุถ ุฃูู ูููู ุจููุน ูู ุนูููุงุช ุงูุญูุณุจุฉ ุงูุซูููุฉ ุ ุงูุชู ูุง ูููู ุงุฎุชุตุงุฑูุง ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ุฅูู ุจุถุนุฉ ูููู ุซุงููุฉุ </p><br><p style=";text-align:right;direction:rtl">  ูุฏ ูุนุชูุฏ ุฃุญุฏ ุงููุณุชุฎุฏููู ุฃูู ูุธุฑูุง ูุฃู RESTinio ููููู ุงูุนูู ุนูู ูุฌููุนุฉ ูู ูุคุดุฑุงุช ุชุฑุงุจุท ุงูุนูู ุ ููุง ุนููู ุณูู ุชุญุฏูุฏ ุญุฌู ุงูุชุฌูุน ุงูุฃูุจุฑ ููุฐุง. </p><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูู ูุนูู ูุฐุง ุฅูุง ูู ุงูุญุงูุงุช ุงูุจุณูุทุฉ ุนูุฏูุง ูููู ูุฏูู ุนุฏุฏ ูููู ูู ุงูุงุชุตุงูุงุช ุงููุชูุงุฒูุฉ.  ููุซุงูุฉ ุงูุงุณุชุนูุงู ููุฎูุถุฉ.  ุฅุฐุง ูุงู ุนุฏุฏ ุงูุงุณุชุนูุงู ุงููุชูุงุฒู ูุตู ุฅูู ุงูุขูุงู (ุนูู ุงูุฃูู ุจุถุน ูุฆุงุช ููุท) ุ ููู ุงูุณูู ุฃู ุชุญุตู ุนูู ูููู ุนูุฏูุง ุชููู ุฌููุน ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุงูุนุงููุฉ ูู ุงูุชุฌูุน ูุดุบููุฉ ุจูุนุงูุฌุฉ ุงูุทูุจุงุช ุงูููุจููุฉ ุจุงููุนู.  ููู ูููู ููุงู ุงููุฒูุฏ ูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุงููุชุจููุฉ ูุชูููุฐ ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ.  ูุชูุฌุฉ ูุฐูู ุ ุณูู ูููุฏ ุงูุฎุงุฏู ุงุณุชุฌุงุจุชู.  ุจูุง ูู ุฐูู RESTinio ุณูููุฏ ุงููุฏุฑุฉ ุนูู ูุนุงูุฌุฉ ุงููููุงุช ุงูุชู RESTinio ุชุญุณุจ ุชููุงุฆูุง ุนูุฏูุง ูุชููู ุงุชุตุงูุงุช ุฌุฏูุฏุฉ ูุนูุฏ ูุนุงูุฌุฉ ุงูุทูุจุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุชูููุฐ ุนูููุงุช ุญุธุฑ ุทูููุฉ ูุฎุฏูุฉ ุงูุทูุจุงุช ุงููุงุฑุฏุฉ ุ ููู ุงูุฃูุถู ุชุฎุตูุต ูุคุดุฑ ุชุฑุงุจุท ุนูู ูุงุญุฏ ููุท ูู RESTinio ุ ูููู ุชุนููู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุชุฏููุงุช ุงูุนูู ูุชูููุฐ ูุฐู ุงูุนูููุงุช ููุณูุง.  ุณูููู ูุนุงูุฌ ุงูุทูุจ ุจูุถุน ุงูุทูุจ ุงูุชุงูู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุ ุญูุซ ุณูุชู ุงุณุชุฑุฏุงุฏ ุงูุทูุจ ูุฅุฑุณุงูู ูููุนุงูุฌุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุฏ ุจุญุซูุง ูู ูุซุงู ุนูู ูุฐุง ุงููุฎุทุท ุจุงูุชูุตูู ุนูุฏูุง ุชุญุฏุซูุง ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุฑูุน ุนุฑุถ Shrimp ุงูุฎุงุต</a> ุจูุง ูู ูุฐู ุงูููุงูุฉ: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Shrimp: Scale and ูุดุงุฑูุฉ ุตูุฑ HTTP ูู Modern C ++ ุจุงุณุชุฎุฏุงู ImageMagic ++ ู SObjectizer ู RESTinio</a> ." </p><br><h2 id="primery-delegirovaniya-obrabotki-zaprosov-na-otdelnye-rabochie-niti" style=";text-align:right;direction:rtl">  ุฃูุซูุฉ ูุชูููุถ ูุนุงูุฌุฉ ุงูุทูุจ ุฅูู ูุคุดุฑุงุช ุชุฑุงุจุท ุงูุนูู ุงููุฑุฏูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุฃุนูุงู ุ ุญุงููุช ุฃู ุฃุดุฑุญ ููุงุฐุง ููุณ ูู ุงูุถุฑูุฑู ุฅุฌุฑุงุก ูุนุงูุฌุฉ ุทูููุฉ ูุจุงุดุฑุฉ ุฏุงุฎู request_handler.  ูู ุฃูู ุชุฃุชู ุงููุชูุฌุฉ ุงููุงุถุญุฉ: ูุฌุจ ุชูููุถ ูุนุงูุฌุฉ ุงูุทูุจุงุช ุงููุทููุฉ ุฅูู ุณูุณูุฉ ุนูููุงุช ุฃุฎุฑู.  ุฏุนููุง ููุธุฑ ูู ููู ูููู ุฃู ูุจุฏู ูุฐุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซุงููู ุฃุฏูุงู ุ ูุญุชุงุฌ ุฅูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูุงุญุฏ ูุชุดุบูู RESTinio ููุคุดุฑ ุชุฑุงุจุท ุนูู ุขุฎุฑ ููุญุงูุงุฉ ูุนุงูุฌุฉ ุงูุทูุจุงุช ุงูุทูููุฉ.  ููุญุชุงุฌ ุฃูุถูุง ุฅูู ููุน ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุฑุณุงุฆู ูููู ุงูุทูุจุงุช ูู ูุคุดุฑ ุชุฑุงุจุท RESTinio ุฅูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูููุตู. </p><br><p style=";text-align:right;direction:rtl">  ูู ููู ูู ุงูุณูู ุจุงููุณุจุฉ ูู ุฃู ุฃููู ุจุชูููุฐ ูุงุฆูุฉ ุงูุชุธุงุฑ ุฑุณุงุฆู ุฌุฏูุฏุฉ ุขููุฉ ูุณูุณูุฉ ุงูุฑุณุงุฆู ุนูู ุฑูุจุชู ููุฐูู ุงููุซุงููู ุ ูุฐูู ุงุณุชุฎุฏูุช ุจุฑูุงูุฌ SObjectizer ุงูุฃุตูู ุงูุฎุงุต ุจู ูุณูุงุณูู ุ ููู ูููุงุช CSP.  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุนู mchain ููุง: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุจุงุฏู ุงููุนูููุงุช ุจูู ุฎููุท ุงูุนูู ุฏูู ุฃููุ CSP- ุงููููุงุช ููุณุงุนุฏุชูุง</a> ." </p><br><h3 id="sohranenie-obekta-request_handle" style=";text-align:right;direction:rtl">  ุญูุธ ูุงุฆู request_handle </h3><br><p style=";text-align:right;direction:rtl">  ุงูุชูููุฉ ุงูุฃุณุงุณูุฉ ุงูุชู ุชู ุจูุงุก ุชูููุถ ูุนุงูุฌุฉ ุงูุทูุจ ุนูููุง ูู ููู ูุงุฆู <code>request_handle_t</code> ููุงู ูุง. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ุชููู RESTinio ุจุงุณุชุฏุนุงุก request_handler ุงููุญุฏุฏ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู ููุนุงูุฌุฉ ุทูุจ ูุงุฑุฏ ุ ูุชู ุชูุฑูุฑ ูุงุฆู ูู ุงูููุน <code>request_handle_t</code> ุฅูู <code>request_handle_t</code> .  ูุฐุง ุงูููุน ููุณ ุฃูุซุฑ ูู ูุคุดุฑ ุฐูู ููุนููุงุช ุงูุทูุจ ุงููุณุชูู.  ูุฐูู ุ ุฅุฐุง ูุงู ูู ุงููุฑูุญ ุฃู ูุนุชูุฏ ุดุฎุต ูุง ุฃู <code>request_handle_t</code> ูู <code>shared_ptr</code> ุ ูููููู ุงูุชูููุฑ ูู ุฐูู ุจุฃูุงู.  ูุฐุง <code>shared_ptr</code> ูู. </p><br><p style=";text-align:right;direction:rtl">  ููุธุฑูุง ูุฃู <code>request_handle_t</code> is <code>shared_ptr</code> ุ ูููููุง ุชูุฑูุฑ ูุฐุง ุงููุคุดุฑ ุงูุฐูู ุจุฃูุงู ูู ููุงู ูุง.  ูุงุฐุง ุณููุนู ูู ุงูุฃูุซูุฉ ุฃุฏูุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุญู ุจุญุงุฌุฉ ุฅูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูููุตู ูููุงุฉ ููุชูุงุตู ูุนูุง.  ูููู ุจุฅูุดุงุก ูู ุดูุก: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  SObjectizer. so_5::wrapped_env_t sobj; //  std::thread    . std::thread processing_thread; //    main      join. //    RAII. auto processing_thread_joiner = so_5::auto_join(processing_thread); //      . auto req_ch = so_5::create_mchain(sobj); //       main. //    RAII. auto ch_closer = so_5::auto_close_drop_content(req_ch); //     . //      main()  - , //     ,      join(). processing_thread = std::thread{ processing_thread_func, req_ch };</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฌุฏ ูุต ูุคุดุฑ ุชุฑุงุจุท ุงูุนูู ููุณู ุฏุงุฎู ุฏุงูุฉ <code>processing_thread_func()</code> ุ ูุงูุชู ุณููุงูุดูุง ุจุนุฏ ูููู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฏููุง ุจุงููุนู ุฎูุท ุนูู ูููุตู ูููุงุฉ ููุชูุงุตู ูุนูุง.  ููููู ุจุฏุก ุฎุงุฏู RESTinio: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ,     . struct traits_t : public restinio::default_traits_t { using logger_t = restinio::shared_ostream_logger_t; }; restinio::run( restinio::on_this_thread&lt;traits_t&gt;() .port(8080) .address("localhost") .request_handler([req_ch](auto req) { //   GET-   . if(restinio::http_method_t::http_get == req-&gt;header().method() &amp;&amp; "/" == req-&gt;header().path()) { //    . so_5::send&lt;handle_request&gt;(req_ch, req); return restinio::request_accepted(); } else return restinio::request_rejected(); }) .cleanup_func([&amp;] { //      . //    , ..  req_ch //          //     . so_5::close_drop_content(req_ch); }));</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุทู ูุฐุง ุงูุฎุงุฏู ุจุณูุท ุฌุฏุง.  ุฅุฐุง ูุตู ุทูุจ GET ูู '/' ุ ูุณูููุถ ูุนุงูุฌุฉ ุงูุทูุจ ููุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ.  ููููุงู ุจุฐูู ุ ูููู ุจุชูููุฐ ุนูููุชูู ูููุชูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฑุณุงู ูุงุฆู <code>request_handle_t</code> ุฅูู ููุงุฉ CSP.  ุจูููุง ูุชู ุชุฎุฒูู ูุฐุง ุงููุงุฆู ุฏุงุฎู ููุงุฉ CSP ุฃู ูู ุฃู ููุงู ุขุฎุฑ ุ ูุนุฑู RESTinio ุฃู ุงูุทูุจ ูุง ูุฒุงู ุนูู ููุฏ ุงูุญูุงุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูุฑุฌุน ุงููููุฉ <code>restinio::request_accepted()</code> ูู ูุนุงูุฌ ุงูุทูุจ.  ูุฐุง ูุฌุนู RESTinio ูููู ุฃูู ุชู ูุจูู ุงูุทูุจ ูููุนุงูุฌุฉ ูุฃูู ูุง ูููู ุฅุบูุงู ุงูุงุชุตุงู ุจุงูุนููู. </li></ul><br><p style=";text-align:right;direction:rtl">  ุญูููุฉ ุฃู request_handler ูู ููุดุฆ ุนูู ุงูููุฑ ุงุณุชุฌุงุจุฉ RESTinio ูุง ุชูุชู.  ุจูุฌุฑุฏ <code>restinio::request_accepted()</code> ุ ูุชุญูู ุงููุณุชุฎุฏู ูุณุคูููุฉ ูุนุงูุฌุฉ ุงูุทูุจ ูุณูุชู ุฅูุดุงุก ุงูุฑุฏ ุนูู ุงูุทูุจ ูู ููู ูู ุงูุฃูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ูุนุงูุฌ ุงูุทูุจ ุจุฅุฑุฌุงุน <code>restinio::request_rejected()</code> ุ ูุนูุฏุฆุฐู ูุฏุฑู RESTinio ุฃู ุงูุทูุจ ูู ุชุชู ูุนุงูุฌุชู ูุณููุฑุฌุน ุงูุฎุทุฃ 501 ุฅูู ุงูุนููู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุตูุญ ุงููุชูุฌุฉ ุงูุฃูููุฉ: ูููู ุชูุฑูุฑ ูุซูู <code>request_handle_t</code> ููุงู ูุง ุ ูุฃูู ูู ุงูุญูููุฉ <code>std::shared_ptr</code> .  ุนูู ุงูุฑุบู ูู ุฃู ูุฐุง ุงููุซูู ููุฏ ุงูุญูุงุฉ ุ ูุฅู RESTinio ุชุนุชุจุฑ ุฃู ุงูุทูุจ ููุฏ ุงููุนุงูุฌุฉ.  ุฅุฐุง ูุงู ูุนุงูุฌ ุงูุทูุจ ุจุฅุฑุฌุงุน <code>restinio::request_accepted()</code> ุ ููู ุชููู RESTinio ูู ุนุฏู ุฅูุดุงุก ุงุณุชุฌุงุจุฉ ููุทูุจ ุงูุขู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููููุง ุฃู ููุธุฑ ุฅูู ุชูููุฐ ูุฐุง ุงูููุถูุน ูููุตูุฉ ุฌุฏุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processing_thread_func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(so_5::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">mchain_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> req_ch)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       //    . std::random_device rd; std::mt19937 generator{rd()}; std::uniform_int_distribution&lt;&gt; pause_generator{350, 3500}; //      timeout_elapsed. auto delayed_ch = so_5::create_mchain(req_ch-&gt;environment()); //     -  . bool stop = false; select( so_5::from_all() //      . .on_close([&amp;stop](const auto &amp;) { stop = true; }) //     select(). //  select()     . .stop_on([&amp;stop]{ return stop; }), //   handle_request     RESTinio. case_(req_ch, [&amp;](handle_request cmd) { //     . const std::chrono::milliseconds pause{pause_generator(generator)}; //     . so_5::send_delayed&lt;timeout_elapsed&gt;(delayed_ch, //    timeout_elapsed. pause, //      timeout_elapsed. cmd.m_req, pause); }), //   timeout_elapsed. case_(delayed_ch, [](timeout_elapsed cmd) { //     . cmd.m_req-&gt;create_response() .set_body("Hello, World! (pause:" + std::to_string(cmd.m_pause.count()) + "ms)") .done(); }) ); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูููุทู ููุง ุจุณูุท ููุบุงูุฉ: ูุญู ูุชููู ุงูุทูุจ ุงูุฃููู ูู ุดูู ุฑุณุงูุฉ <code>handle_request</code> ุชูุฌููู ุฅูู ุฃููุณูุง ูู ุดูู ุฑุณุงูุฉ <code>timeout_elapsed</code> ุชุฃุฎูุฑูุง ูุจุนุถ ุงูููุช ุงูุนุดูุงุฆู.  ูููู ุจูุนุงูุฌุฉ ุงูุทูุจ ุงููุนููุฉ ููุท ุนูุฏ ุงุณุชูุงู <code>timeout_elapsed</code> . </p><br><p style=";text-align:right;direction:rtl">  <strong>ูุญุฏุซ.</strong>  ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ <code>done()</code> ุนูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูููุตู ุ ูุชู ุฅุฎุทุงุฑ RESTinio ุฃู ุงุณุชุฌุงุจุฉ ุฌุงูุฒุฉ ูุฏ ุธูุฑุช ุชุญุชุงุฌ ุฅูู ูุชุงุจุชูุง ุฅูู ุงุชุตุงู TCP.  ูุจุฏุฃ RESTinio ุนูููุฉ ุงููุชุงุจุฉ ุ ููู ูู ูุชู ุชูููุฐ ุนูููุฉ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ููุณูุง ุญูุซ <code>done()</code> ุ ูููู ุญูุซ ุชููู RESTinio ุจุฅุฌุฑุงุก I / O ูุชุฏุนู request_handlers.  ุฃู  ูู ูุฐุง ุงููุซุงู ุ ูุชู ุงุณุชุฏุนุงุก <code>done()</code> ุนูู ูุคุดุฑ ุชุฑุงุจุท ุนูู ูููุตู ุ ูุณูุชู ุชูููุฐ ุนูููุฉ ุงููุชุงุจุฉ ุนูู ูุคุดุฑ ุงูุชุฑุงุจุท ุงูุฑุฆูุณู ุ ุญูุซ <code>restinio::run()</code> . </p><br><p style=";text-align:right;direction:rtl">  ุงูุฑุณุงุฆู ููุณูุง ูุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">handle_request</span></span></span><span class="hljs-class"> {</span></span> restinio::<span class="hljs-keyword"><span class="hljs-keyword">request_handle_t</span></span> m_req; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout_elapsed</span></span></span><span class="hljs-class"> {</span></span> restinio::<span class="hljs-keyword"><span class="hljs-keyword">request_handle_t</span></span> m_req; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::chrono::milliseconds m_pause; };</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ูุฃุฎุฐ ูุคุดุฑ ุชุฑุงุจุท ุนูู ูููุตู <code>request_handle_t</code> ููุญูุธู ุญุชู ุชูุดุฃ ุงููุฑุตุฉ ูุชุดููู ุงุณุชุฌุงุจุฉ ูุงููุฉ.  ูุนูุฏูุง ุชูุดุฃ ูุฐู ุงููุฑุตุฉ ุ ูุชู ุงุณุชุฏุนุงุก <code>create_response()</code> ุนูู ูุงุฆู ุงูุทูุจ ุงููุญููุธ ููุชู ุฅุฑุฌุงุน ุงูุงุณุชุฌุงุจุฉ ุฅูู RESTinio.  ุซู RESTinio ุจุงููุนู ูู ุณูุงู ุนูููุง ููุชุจ ุงูุงุณุชุฌุงุจุฉ ูู ุงุชุตุงู ูุน ุงูุนููู ุงููุทุงุจู. </p><br><p style=";text-align:right;direction:rtl">  ููุง ุ ูุชู ุชุฎุฒูู ูุซูู <code>request_handle_t</code> ูู ุฑุณุงูุฉ ูุชุฃุฎุฑุฉ <code>timeout_elapsed</code> ุ ูุธุฑูุง ูุนุฏู ูุฌูุฏ ูุนุงูุฌุฉ ุญููููุฉ ูู ูุฐุง ุงููุซุงู ุงูุจุฏุงุฆู.  ูู ุชุทุจูู ุญูููู ุ ูููู ุชุฎุฒูู <code>request_handle_t</code> ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ูุนููุฉ ุฃู ุฏุงุฎู ูุงุฆู ุชู ุฅูุดุงุคู ููุนุงูุฌุฉ ุงูุทูุจ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุนุซูุฑ <a href="">ุนูู</a> ุงูุฑูุฒ ุงููุงูู ููุฐุง ุงููุซุงู ูู <a href="">ุจูู ุฃูุซูุฉ RESTinio ุงูุนุงุฏูุฉ</a> . </p><br><h4 id="neskolko-nebolshih-poyasneniy-po-kodu" style=";text-align:right;direction:rtl">  ุจุนุถ ุงูููุงุญุธุงุช ุฑูุฒ ุตุบูุฑ </h4><br><p style=";text-align:right;direction:rtl">  ูุนูู ูุฐุง ุงูุฅูุดุงุก ุฎุตุงุฆุต RESTinio ุงูุชู ูุฌุจ ุฃู ูุดุชูู ุนูููุง ุฎุงุฏู RESTinio: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ,     . struct traits_t : public restinio::default_traits_t { using logger_t = restinio::shared_ostream_logger_t; }; restinio::run( restinio::on_this_thread&lt;traits_t&gt;()</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงููุซุงู ุ ุฃุญุชุงุฌ ุฅูู RESTinio ูุชุณุฌูู ุฅุฌุฑุงุกุงุช ูุนุงูุฌุฉ ุงูุทูุจ ุงูุฎุงุตุฉ ุจู.  ูุฐูู ุ ููุช ุจุชุนููู <code>logger_t</code> ููููู ูุฎุชูููุง ุนู <code>null_logger_t</code> ุงูุงูุชุฑุงุถู.  ููู ููุฐ ุฐูู ุงูุญูู  ุณุชุนูู RESTinio ุ ูู ุงููุงูุน ุ ุนูู ุนุฏุฉ ุณูุงุณู ุนูููุงุช (RESTinio ุชุนุงูุฌ ุงูุทูุจุงุช ุงููุงุฑุฏุฉ ูู ุณูุณูุฉ ุงูุฑุณุงุฆู ุงูุฑุฆูุณูุฉ ุ ููู ุงูุฑุฏูุฏ ุชุฃุชู ูู ุณูุณูุฉ ุนูููุงุช ูููุตูุฉ) ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุฃุฏุงุฉ ุชุณุฌูู ุขููุฉ <code>shared_ostream_logger_t</code> ุ ููู <code>shared_ostream_logger_t</code> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฏุงุฎู <code>processing_thread_func()</code> ุ ูุชู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ SObjectizer <code>select()</code> ุ ูุงูุชู ุชุดุจู ุฅูู ุญุฏ ูุง ุฅูุดุงุก Go-shn ุงููุญุฏุฏ: ููููู ูุฑุงุกุฉ ุงูุฑุณุงุฆู ููุนุงูุฌุชูุง ูู ุนุฏุฉ ูููุงุช ูู ููุช ูุงุญุฏ.  ุชุนูู ูุธููุฉ <code>select()</code> ุญุชู ูุชู ุฅุบูุงู ุฌููุน ุงููููุงุช ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูููุง.  ุฃู ุญุชู ูุชู ุฅุฎุจุงุฑูุง ุจุงูููุฉ ุฃู ุงูููุช ูุฏ ุงูุชูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ุฅุฐุง ูุงูุช ููุงุฉ ุงูุงุชุตุงู ุจุฎุงุฏู RESTinio ูุบููุฉ ุ ููุง ูุงุฆุฏุฉ ูู ููุงุตูุฉ ุงูุนูู.  ูุฐูู ุ ูู <code>select()</code> ุ ูุชู ุชุญุฏูุฏ ุงูุงุณุชุฌุงุจุฉ ูุฅุบูุงู ุฃู ูู ุงููููุงุช: ุจูุฌุฑุฏ ุฅุบูุงู ููุงุฉ ุ ูุชู ุฑูุน ุนูุงูุฉ ุงูุชููู.  ูุณูุคุฏู ุฐูู ุฅูู ุฅููุงู <code>select()</code> ูุงูุฎุฑูุฌ ูู <code>processing_thread_func()</code> . </p><br><h3 id="sohranenie-obekta-response_builder" style=";text-align:right;direction:rtl">  ุญูุธ ูุงุฆู response_builder </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซุงู ุงูุณุงุจู ุ ูุธุฑูุง ูู ุญุงูุฉ ุจุณูุทุฉ ุนูุฏูุง ูููู ูู ุงููููู ุญูุธ <code>request_handle_t</code> ุญุชู ูุชููู ูู ุชูุฏูู ุงูุงุณุชุฌุงุจุฉ ุงููุงููุฉ ููุทูุจ ุนูู ุงูููุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ูุฏ ูููู ููุงู ุณููุงุฑูููุงุช ุฃูุซุฑ ุชุนููุฏูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุชูุฏูู ุฅุฌุงุจุฉ ูู ุฃุฌุฒุงุก.  ููุฐุง ูู ุ ุชููููุง ุทูุจูุง ุ ูููููุง ุนูู ุงูููุฑ ุชุดููู ุงูุฌุฒุก ุงูุฃูู ููุท ูู ุงูุงุณุชุฌุงุจุฉ.  ูุญู ุชุดูููู.  ุซู ุ ุจุนุฏ ุจุนุถ ุงูููุช ุ ูุฏููุง ุงููุฑุตุฉ ูุชุดููู ุงูุฌุฒุก ุงูุซุงูู ูู ุงูุฅุฌุงุจุฉ.  ุจุนุฏ ุฐูู ุ ุจุนุฏ ูุฑูุฑ ุจุนุถ ุงูููุช ุ ูููููุง ุชุดููู ุงูุฌุฒุก ุงูุชุงูู ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฏ ูููู ูู ุงููุณุชุญุณู ุจุงููุณุจุฉ ููุง ุฃู ุชุฎุชูู ูู ูุฐู ุงูุฃุฌุฒุงุก ุฃุซูุงุก ุชุดููููุง.  ุฃู  ุฃููุงู ุ ุงูุฌุฒุก ุงูุฃูู ูู ุงูุฅุฌุงุจุฉ ุญุชู ูุชููู ุงูุนููู ูู ุทุฑุญูุง ุ ุซู ุงูุฌุฒุก ุงูุซุงูู ุ ุซู ุงูุฌุฒุก ุงูุซุงูุซ ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ูุณูุญ ูู RESTinio ุจุงูููุงู ุจุฐูู ูุธุฑูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฃููุงุน ูุฎุชููุฉ ูู ุฃุฌูุฒุฉ ุงูุงุณุชุฌุงุจุฉ</a> .  ุนูู ูุฌู ุงูุฎุตูุต ุ ุฃููุงุน ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">user_controlled_output</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">chunked_output</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุญุงูุฉ ุ ูุง ูููู ุญูุธ <code>request_handle_t</code> ุ ูุฃู <code>request_handle_t</code> ูู ูููู ูููุฏูุง ุฅูุง ุญุชู ุฃูู ููุงููุฉ ุฅูู <code>create_reponse()</code> .  ุจุนุฏ ุฐูู ูุญุชุงุฌ ููุนูู ูุน response_builder.  ุญุณูุง ... </p><br><p style=";text-align:right;direction:rtl">  ุญุณูุง ุ ูุฐุง ุฌูุฏ.  Response_builder ูู ููุน ูุชุญุฑู ุ ูุดุจู ุฅูู ุญุฏ ูุง unique_ptr.  ูุฐูู ูููููุง ุฃูุถูุง ุงูุงุญุชูุงุธ ุจูุง ุทุงููุง ุงุญุชุฌูุง ุฅูููุง.  ููุฅุธูุงุฑ ููู ูุจุฏู ุ ูููุง ุจุฅุนุงุฏุฉ ุงููุซุงู ุฃุนูุงู ููููุงู.  ุฏุน ุงูุฏุงูุฉ <code>processing_thread_func()</code> ุชุดูู ุงูุงุณุชุฌุงุจุฉ ูู ุงูุฃุฌุฒุงุก. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ููุณ ุตุนุจุง ุนูู ุงูุงุทูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ ุงูุฃููุงุน ุงูุชู ุณุชุญุชุงุฌ ุฅูููุง <code>processing_thread_func()</code> ุงูุฌุฏูุฏุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">handle_request</span></span></span><span class="hljs-class"> {</span></span> restinio::<span class="hljs-keyword"><span class="hljs-keyword">request_handle_t</span></span> m_req; }; <span class="hljs-comment"><span class="hljs-comment">//     . using output_t = restinio::chunked_output_t; //   reponse_builder-   . using response_t = restinio::response_builder_t&lt;output_t&gt;; //     . struct timeout_elapsed { response_t m_resp; int m_counter; };</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุจูู ุงูุฑุณุงูุฉ <code>handle_request</code> ุจุฏูู ุชุบููุฑ.  ูููู ูู ุงูุฑุณุงูุฉ ุงูุชู <code>timeout_elapsed</code> ูููู ุงูุขู ุจุชุฎุฒูู not <code>request_handle_t</code> ุ ูููู ุงุณุชุฌุงุจุฉ <code>timeout_elapsed</code> ุงูููุน ุงูุฐู ูุญุชุงุฌู.  ุจุงูุฅุถุงูุฉ ุฅูู ุนุฏุงุฏ ุงูุฃุฌุฒุงุก ุงููุชุจููุฉ.  ุจูุฌุฑุฏ ุฅุนุงุฏุฉ ุชุนููู ูุฐุง ุงูุนุฏุงุฏ ุ ุชูุชูู ุทูุจ ุงูุฎุฏูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููููุง ุฅููุงุก ูุธุฑุฉ ุนูู ุฅุตุฏุงุฑ ุฌุฏูุฏ ูู ุงูุฏุงูุฉ <code>processing_thread_func()</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processing_thread_func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(so_5::</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">mchain_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> req_ch)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::random_device rd; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::mt19937 generator{rd()}; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;&gt; pause_generator{<span class="hljs-number"><span class="hljs-number">350</span></span>, <span class="hljs-number"><span class="hljs-number">3500</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> delayed_ch = so_5::create_mchain(req_ch-&gt;environment()); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> stop = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; select( so_5::from_all() .on_close([&amp;stop](<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> &amp;) { stop = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }) .stop_on([&amp;stop]{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stop; }), case_(req_ch, [&amp;](handle_request cmd) { <span class="hljs-comment"><span class="hljs-comment">//    ,    . auto resp = cmd.m_req-&gt;create_response&lt;output_t&gt;(); resp.append_header( restinio::http_field::server, "RESTinio" ) .append_header_date_field() .append_header( restinio::http_field::content_type, "text/plain; charset=utf-8" ); //    ,  RESTinio //   . resp.flush(); //       . so_5::send_delayed&lt;so_5::mutable_msg&lt;timeout_elapsed&gt;&gt;(delayed_ch, //     . std::chrono::milliseconds{pause_generator(generator)}, //    timeout_elapsed. //     response_builder-  . std::move(resp), 3); }), case_(delayed_ch, [&amp;](so_5::mutable_mhood_t&lt;timeout_elapsed&gt; cmd) { //      . cmd-&gt;m_resp.append_chunk( "this is the next part of the response\n" ); //  RESTinio   . cmd-&gt;m_resp.flush(); cmd-&gt;m_counter -= 1; if( 0 != cmd-&gt;m_counter ) { //        . so_5::send_delayed( delayed_ch, std::chrono::milliseconds{pause_generator(generator)}, std::move(cmd)); } else // ,   . cmd-&gt;m_resp.done(); }) ); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู     ,        .       .         . </p><br><p style=";text-align:right;direction:rtl"> <strong>Upd.</strong>   <code>flush()</code>   ,     <code>done()</code> : RESTinio   ,   I/O-    ,   <code>flush()</code> ,  ,  RESTinio  -   request_handler-.  ุฃู    <code>flush()</code>     ,        , ,   <code>restinio::run()</code> . </p><br><p style=";text-align:right;direction:rtl">       ,    RESTinio    : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[2019-05-13 15:02:35.106] TRACE: starting server on 127.0.0.1:8080 [2019-05-13 15:02:35.106] INFO: init accept #0 [2019-05-13 15:02:35.106] INFO: server started on 127.0.0.1:8080 [2019-05-13 15:02:39.050] TRACE: accept connection from 127.0.0.1:49280 on socket #0 [2019-05-13 15:02:39.050] TRACE: [connection:1] start connection with 127.0.0.1:49280 [2019-05-13 15:02:39.050] TRACE: [connection:1] start waiting for request [2019-05-13 15:02:39.050] TRACE: [connection:1] continue reading request [2019-05-13 15:02:39.050] TRACE: [connection:1] received 78 bytes [2019-05-13 15:02:39.050] TRACE: [connection:1] request received (#0): GET / [2019-05-13 15:02:39.050] TRACE: [connection:1] append response (#0), flags: { not_final_parts, connection_keepalive }, write group size: 1 [2019-05-13 15:02:39.050] TRACE: [connection:1] start next write group for response (#0), size: 1 [2019-05-13 15:02:39.050] TRACE: [connection:1] start response (#0): HTTP/1.1 200 OK [2019-05-13 15:02:39.050] TRACE: [connection:1] sending resp data, buf count: 1, total size: 167 [2019-05-13 15:02:39.050] TRACE: [connection:1] outgoing data was sent: 167 bytes [2019-05-13 15:02:39.050] TRACE: [connection:1] finishing current write group [2019-05-13 15:02:39.050] TRACE: [connection:1] should keep alive [2019-05-13 15:02:40.190] TRACE: [connection:1] append response (#0), flags: { not_final_parts, connection_keepalive }, write group size: 3 [2019-05-13 15:02:40.190] TRACE: [connection:1] start next write group for response (#0), size: 3 [2019-05-13 15:02:40.190] TRACE: [connection:1] sending resp data, buf count: 3, total size: 42 [2019-05-13 15:02:40.190] TRACE: [connection:1] outgoing data was sent: 42 bytes [2019-05-13 15:02:40.190] TRACE: [connection:1] finishing current write group [2019-05-13 15:02:40.190] TRACE: [connection:1] should keep alive [2019-05-13 15:02:43.542] TRACE: [connection:1] append response (#0), flags: { not_final_parts, connection_keepalive }, write group size: 3 [2019-05-13 15:02:43.542] TRACE: [connection:1] start next write group for response (#0), size: 3 [2019-05-13 15:02:43.542] TRACE: [connection:1] sending resp data, buf count: 3, total size: 42 [2019-05-13 15:02:43.542] TRACE: [connection:1] outgoing data was sent: 42 bytes [2019-05-13 15:02:43.542] TRACE: [connection:1] finishing current write group [2019-05-13 15:02:43.542] TRACE: [connection:1] should keep alive [2019-05-13 15:02:46.297] TRACE: [connection:1] append response (#0), flags: { not_final_parts, connection_keepalive }, write group size: 3 [2019-05-13 15:02:46.297] TRACE: [connection:1] start next write group for response (#0), size: 3 [2019-05-13 15:02:46.297] TRACE: [connection:1] sending resp data, buf count: 3, total size: 42 [2019-05-13 15:02:46.297] TRACE: [connection:1] append response (#0), flags: { final_parts, connection_keepalive }, write group size: 1 [2019-05-13 15:02:46.297] TRACE: [connection:1] outgoing data was sent: 42 bytes [2019-05-13 15:02:46.298] TRACE: [connection:1] finishing current write group [2019-05-13 15:02:46.298] TRACE: [connection:1] should keep alive [2019-05-13 15:02:46.298] TRACE: [connection:1] start next write group for response (#0), size: 1 [2019-05-13 15:02:46.298] TRACE: [connection:1] sending resp data, buf count: 1, total size: 5 [2019-05-13 15:02:46.298] TRACE: [connection:1] outgoing data was sent: 5 bytes [2019-05-13 15:02:46.298] TRACE: [connection:1] finishing current write group [2019-05-13 15:02:46.298] TRACE: [connection:1] should keep alive [2019-05-13 15:02:46.298] TRACE: [connection:1] start waiting for request [2019-05-13 15:02:46.298] TRACE: [connection:1] continue reading request [2019-05-13 15:02:46.298] TRACE: [connection:1] EOF and no request, close connection [2019-05-13 15:02:46.298] TRACE: [connection:1] close [2019-05-13 15:02:46.298] TRACE: [connection:1] close: close socket [2019-05-13 15:02:46.298] TRACE: [connection:1] close: timer canceled [2019-05-13 15:02:46.298] TRACE: [connection:1] close: reset responses data [2019-05-13 15:02:46.298] TRACE: [connection:1] destructor called</code> </pre> <br><p style=";text-align:right;direction:rtl">   ,  RESTinio           167 .          ,           , RESTinio          . </p><br><p style=";text-align:right;direction:rtl">   ,    RESTinio   -     response_builder     ,        . </p><br><p style=";text-align:right;direction:rtl">      .        , ,     .       response_builder   .     ,   responce_builder       ,          .. </p><br><p style=";text-align:right;direction:rtl">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> . </p><br><h2 id="chto-budet-esli-obrabotka-zaprosa-zaymet-slishkom-mnogo-vremeni" style=";text-align:right;direction:rtl">  ,       ? </h2><br><p style=";text-align:right;direction:rtl"> ,   request_handler-     -   .  ,      ,           ? </p><br><p style=";text-align:right;direction:rtl">  RESTinio    ,   -  request_handler-.    - ,     , RESTinio       . ,         . , : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[2019-05-13 15:32:23.618] TRACE: starting server on 127.0.0.1:8080 [2019-05-13 15:32:23.618] INFO: init accept #0 [2019-05-13 15:32:23.618] INFO: server started on 127.0.0.1:8080 [2019-05-13 15:32:26.768] TRACE: accept connection from 127.0.0.1:49502 on socket #0 [2019-05-13 15:32:26.768] TRACE: [connection:1] start connection with 127.0.0.1:49502 [2019-05-13 15:32:26.768] TRACE: [connection:1] start waiting for request [2019-05-13 15:32:26.768] TRACE: [connection:1] continue reading request [2019-05-13 15:32:26.768] TRACE: [connection:1] received 78 bytes [2019-05-13 15:32:26.768] TRACE: [connection:1] request received (#0): GET / [2019-05-13 15:32:30.768] TRACE: [connection:1] handle request timed out [2019-05-13 15:32:30.768] TRACE: [connection:1] close [2019-05-13 15:32:30.768] TRACE: [connection:1] close: close socket [2019-05-13 15:32:30.768] TRACE: [connection:1] close: timer canceled [2019-05-13 15:32:30.768] TRACE: [connection:1] close: reset responses data [2019-05-13 15:32:31.768] WARN: [connection:1] try to write response, while socket is closed [2019-05-13 15:32:31.768] TRACE: [connection:1] destructor called</code> </pre> <br><p style=";text-align:right;direction:rtl">   -       . ,      ,  RESTinio   , ..     . </p><br><p style=";text-align:right;direction:rtl">   -    <code>handle_request_timeout</code> ,     RESTinio- ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> ). </p><br><h1 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h1><br><p style=";text-align:right;direction:rtl"> ,   ,      RESTinio โ   ,   .  ,     RESTinio,    ,        RESTinio,     . </p><br><p style=";text-align:right;direction:rtl">      RESTinio        ,  , ,  :  ? -  ? -  ? - -  ? </p><br><p style=";text-align:right;direction:rtl">  PS.    RESTinio     ,   SObjectizer,    .  ,  -   RESTinio ,     : " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> C++      HTTP-   </a> ", " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> HTTP-  C++:   RESTinio,   libcurl.  1</a> ", " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Shrimp:     HTTP    C++  ImageMagic++, SObjectizer  RESTinio</a> " </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar451728/">https://habr.com/ru/post/ar451728/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar451718/index.html">ุฅูุดุงุก ูุณุงุนุฏ ุตูุช</a></li>
<li><a href="../ar451720/index.html">ุชุญููู FIAS ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนูู MSSQLSERVER ุจูุงุณุทุฉ ุงูุงุฑุชุฌุงููุฉ (SQLXMLBULKLOAD) ูุนูู. ููู ูุฐุง (ุฑุจูุง) ููุณุช ุถุฑูุฑูุฉ</a></li>
<li><a href="../ar451722/index.html">ููู ุชู ุบูุฑ ูุชุฒุงูู ููุชุจุฉ ุงููุทุนุฉ</a></li>
<li><a href="../ar451724/index.html">Skyrmion ุฅูู ุฎูุงู skyrmion: skyrmions ุงููุทุจูุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูู ุงูุจูุงุณุชูู ุงูุญุฏูุฏู</a></li>
<li><a href="../ar451726/index.html">ุงูุจุญุซ ุนู ุนูู ูู ุงูุฎุงุฑุฌ: 7 ูุตุงุฆุญ ุจุณูุทุฉ ููุชุฎุตุตู ุชูููููุฌูุง ุงููุนูููุงุช</a></li>
<li><a href="../ar451738/index.html">ุนุฑุถ ููุฌุฒ ูููุงู "DeViSE: ูููุฐุฌ ุนููู ููุชุถููู ุงููุฑุฆู ูุงูุฏูุงูู"</a></li>
<li><a href="../ar451742/index.html">ูุจู ููู ูุงุญุฏ ูู DotNext 2019 Piter. ุฅุนูุงู ุงูุจุซ ุงููุฌุงูู</a></li>
<li><a href="../ar451746/index.html">MegaSlerm ูููููุฏุณูู ูุงููููุฏุณูู ุงููุนูุงุฑููู Kubernetes</a></li>
<li><a href="../ar451748/index.html">ูุฑุงูุจุฉ ุญุงูุฉ SSD ูู ูุตูููุงุช Qsan</a></li>
<li><a href="../ar451750/index.html">ูุชุงุจ "Elasticsearch ุ Kibana ุ Logstash ููุญุฑูุงุช ุงูุจุญุซ ูู ุงูุฌูู ุงูุชุงูู"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>