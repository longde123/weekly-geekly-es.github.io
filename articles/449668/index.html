<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèæ üë®üèΩ‚Äçüíª üëç Notas del proveedor de IoT. Errores de la encuesta de medidores de servicios p√∫blicos üë®üèΩ‚Äçüé® üéÖüèæ ‚òÑÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola queridos amantes de Internet de las cosas. En este art√≠culo, me gustar√≠a volver a hablar sobre la vivienda y los servicios comunales y una encues...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Notas del proveedor de IoT. Errores de la encuesta de medidores de servicios p√∫blicos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449668/">  Hola queridos amantes de Internet de las cosas.  En este art√≠culo, me gustar√≠a volver a hablar sobre la vivienda y los servicios comunales y una encuesta sobre dispositivos de medici√≥n. <br><br>  Peri√≥dicamente, otro jugador importante de telecomunicaciones dice cu√°n pronto ingresar√° a este mercado y aplastar√° a todos.  Cada vez con tales historias, pienso: "muchachos, ¬°buena suerte!" <br>  No tienes idea de d√≥nde est√°s escalando. <br><br>  Para que comprenda la escala del problema, describir√© brevemente una peque√±a parte de nuestra experiencia en el desarrollo de la plataforma Smart City.  La parte de la misma que es responsable de la programaci√≥n. <br><br><img src="https://habrastorage.org/webt/xu/49/vl/xu49vludx9l7aqn72w0jfxfhndo.jpeg"><br><br><a name="habracut"></a><h3>  Idea general y primeras dificultades. </h3><br>  Si no estamos hablando de dispositivos de medici√≥n individuales, sino de aquellos que est√°n en s√≥tanos, salas de calderas y empresas, entonces la mayor√≠a de ellos ahora est√°n equipados con una salida telem√©trica.  Con menos frecuencia pulsada, con mayor frecuencia: RS-485/232 o Ethernet.  Como regla, los dispositivos de medici√≥n m√°s "pan" son aquellos que consideran el calor.  Son ellos quienes est√°n listos para pagar su despacho en primer lugar. <br>  Ya he hablado en detalle en mi art√≠culo sobre las caracter√≠sticas de RS-485.  En resumen, es solo una interfaz de transferencia de datos.  En esencia, los requisitos para pulsos el√©ctricos y l√≠neas de comunicaci√≥n.  La descripci√≥n de los paquetes sube al est√°ndar de transferencia de datos, que se ejecuta sobre RS-485.  Y qu√© tipo de est√°ndar estar√° all√≠, se deja al fabricante.  A menudo Modbus, pero no es obligatorio.  Incluso si Modbus, a√∫n puede ser ligeramente modificado. <br><br>  De hecho, para cada medidor, necesita su propio script de encuesta, que sabe c√≥mo "hablar" con √©l e interrogarlo.  Esto significa que el sistema de despacho es un conjunto de scripts para cada contador individual.  Una base de datos donde se almacena todo esto.  Y una determinada interfaz de usuario en la que puede generar el informe que necesita. <br><br><img src="https://habrastorage.org/webt/_o/5_/r8/_o5_r8yi41f7wlnhbwxbu0bajny.png"><br><br>  Se ve f√°cil.  El diablo, como siempre, est√° en los detalles. <br><br>  Comencemos con la primera parte. <br><br><h3>  Guiones </h3><br>  ¬øC√≥mo escribirlos?  Bueno, obviamente, compre un medidor, rec√≥jalo, aprenda c√≥mo comunicarse con √©l e integrarlo en una plataforma com√∫n. <br><br>  Desafortunadamente, esta soluci√≥n cubrir√° solo una parte de nuestras necesidades.  Como regla general, un contador popular tiene varias generaciones, y el script para cada generaci√≥n puede diferir.  A veces un poco, a veces significativamente.  Al comprar algo, obtienes la √∫ltima generaci√≥n.  Es muy probable que el suscriptor sea algo m√°s antiguo.  Ya no se vende en tiendas.  Y el suscriptor no cambiar√° el nodo de medici√≥n. <br><br>  De ah√≠ el primer problema.  Escribir tales scripts es un grupo duro de desarrolladores e ingenieros de software "en el terreno".  Compramos la √∫ltima generaci√≥n, escribimos una plantilla inicial y luego la modificamos en dispositivos reales.  Hacer esto en el laboratorio no es realista, solo en el curso de trabajar con suscriptores en vivo. <br><br>  Nos llev√≥ mucho tiempo crear tal paquete.  Ahora el algoritmo est√° resuelto.  Las plantillas iniciales se ajustaban y complementaban constantemente, seg√∫n lo que conoci√©ramos en nuestra pr√°ctica.  Por supuesto, se advirti√≥ al suscriptor si de repente su contador estaba un poco "no as√≠".  Cuando aparece dicho dispositivo, se conecta de acuerdo con el esquema est√°ndar y la secuencia de comandos de sondeo se modifica en el camino.  En el momento de la integraci√≥n, el suscriptor trabaja de forma gratuita.  Se le notifica que todav√≠a vive en modo de prueba.  El proceso de integraci√≥n en s√≠ mismo es algo bastante impredecible.  Sucede que necesita hacer un m√≠nimo de correcciones.  Hay un proceso complejo con un viaje de campo, palear literatura y superar consecutivamente un rastrillo. <br><br>  La tarea no es simple, sino solucionable.  El resultado es un script de trabajo.  Cuanto mayor es la biblioteca de scripts, m√°s f√°cil es vivir. <br><br>  El segundo problema <br><br><h3>  Fichas tecnol√≥gicas de conexi√≥n </h3><br>  Para hacerte consciente de la complejidad de este trabajo, dar√© un ejemplo.  Tome el extremadamente popular medidor de calor VKT-7. <br><br>  El nombre en s√≠ no significa nada para nosotros.  VKT-7 tiene varias soluciones de hierro.  ¬øQu√© tipo de interfaz hay dentro? <br><br><img src="https://habrastorage.org/webt/6a/vj/2v/6avj2vxzeg84mfssvgarpqkyb-4.jpeg"><br><br>  Hay diferentes opciones  Puede haber una salida en el bloque DB-9 est√°ndar (esto es RS-232).  Podr√≠a ser simplemente un bloque de terminales con contactos RS-485.  Quiz√°s incluso una tarjeta de red con RJ-45 (en este caso, ModBus est√° empaquetado en Ethernet). <br><br>  O tal vez nada en absoluto.  Solo un metro desnudo.  Puede instalar una salida de interfaz en √©l, el fabricante lo vende por separado y cuesta dinero.  El principal problema: para instalarlo, debe abrir el mostrador y romper los sellos.  Es decir, se incluye una organizaci√≥n de suministro de recursos en este proceso.  Se le notifica que los sellos se romper√°n, se nombra un d√≠a y nuestro ingeniero, en presencia de un representante del recurso, realiza las mejoras necesarias, despu√©s de lo cual el medidor se sella nuevamente. <br><br>  Dependiendo de la interfaz instalada, se realiza un mayor refinamiento.  Por ejemplo, decidimos conectar un medidor para el cable.  Esta es la opci√≥n m√°s f√°cil, si nuestro conmutador est√° dentro de los 100 metros de accesibilidad, entonces es redundante ser m√°s sabio con LoRa.  Cable m√°s f√°cil a nuestra red, en una VLAN aislada. <br><br>  RS-485/232 necesita un convertidor Ethernet.  Muchos recordar√°n inmediatamente MOX, pero es costoso.  Para nuestras soluciones, hemos elegido una soluci√≥n china m√°s barata. <br><br>  Si la salida es Ethernet inmediatamente, entonces no se necesita un convertidor. <br><br>  Pregunta  Supongamos que configuramos la salida de la interfaz nosotros mismos.  ¬øPuede facilitarle la vida e instalar inmediatamente Ethernet en todas partes? <br><br>  Esto no siempre es posible.  Debemos observar el desempe√±o del caso.  Es posible que no tenga el orificio correcto para que la interfaz se pare como deber√≠a.  Y el mostrador, recuerdo, est√° en nuestro s√≥tano.  O en la sala de calderas.  Hay alta humedad, la estanqueidad no se puede romper.  Terminar el archivo con un archivo es una mala idea.  Es mejor poner algo que inicialmente no requiere grandes alteraciones.  A menudo, el RS-485 es la √∫nica salida. <br><br>  M√°s lejos.  ¬øEst√° el medidor conectado a la energ√≠a garantizada?  Si no, vive con bater√≠a.  En este modo, est√° dise√±ado para sondeo manual una vez al mes durante tres minutos.  El atractivo constante de VKT-7 dejar√° caer su bater√≠a.  Por lo tanto, debe obtener energ√≠a garantizada e instalar un convertidor de voltaje. <br><br>  Para cada fabricante de medidores, el m√≥dulo de potencia es diferente.  Puede ser una unidad externa en un riel DIN o un convertidor integrado. <br><br>  Resulta que un conjunto de diferentes interfaces y m√≥dulos de alimentaci√≥n para cada medidor siempre deben almacenarse en nuestro almac√©n.  La nomenclatura all√≠ es impresionante. <br><br>  Por supuesto, todo esto ser√° pagado por el suscriptor.  Pero no esperar√° un mes hasta que llegue el dispositivo deseado.  Y necesita un presupuesto para la conexi√≥n aqu√≠ y ahora.  Entonces el stock tecnol√≥gico cae sobre nuestros hombros. <br><br>  Todo lo que describ√≠ se convierte en un claro mapa de conexi√≥n t√©cnica para que los ingenieros de campo no piensen qu√© tipo de animal encontraron en el pr√≥ximo s√≥tano y qu√© necesitan para su trabajo. <br><br>  La lista de tareas es adyacente a las regulaciones generales de conexi√≥n.  Despu√©s de todo, no es suficiente incluir el contador en nuestra red, a√∫n necesita lanzar la misma VLAN en el puerto del conmutador, debe realizar diagn√≥sticos, realizar una encuesta de prueba.  Nos esforzamos por automatizar todo el proceso tanto como sea posible para evitar errores y no atraer las fuerzas adicionales de los ingenieros. <br><br>  Bueno, escribieron mapas t√©cnicos, regulaciones, automatizaci√≥n.  Log√≠stica establecida. <br><br><h3>  ¬øD√≥nde m√°s est√°n las trampas al acecho? </h3><br>  Los datos se leen y se vierten en la base de datos. <br><br>  El suscriptor de estas cifras no es ni fr√≠o ni caliente.  El necesita un informe.  Preferiblemente en la forma en que se usa.  A√∫n mejor, si inmediatamente en la forma de un informe que √©l entiende, que puede imprimir, ponga una firma y entregue.  Esto significa que necesita una interfaz simple e intuitiva que muestre informaci√≥n en el medidor y pueda generar autom√°ticamente un informe. <br><br>  Aqu√≠ nuestro zool√≥gico contin√∫a.  El hecho es que hay varios formularios de informes.  En esencia, reflejan lo mismo (calor consumido), pero de diferentes maneras. <br><br>  Algunos de los suscriptores informan en valores absolutos (es decir, los valores se escriben en el gr√°fico de consumo de calor, comenzando con la instalaci√≥n del medidor), algunos en deltas (esto es cuando escribimos el consumo durante un per√≠odo de tiempo sin referencia a los valores iniciales).  De hecho, no utilizan est√°ndares comunes, sino pr√°cticas establecidas.  Ha habido casos en que los suscriptores ven todos los valores que necesitan (la cantidad de calor consumido, la cantidad de refrigerante suministrado y dejado, la diferencia de temperatura), pero las columnas en el informe no est√°n en la misma secuencia. <br>  De ah√≠ el siguiente paso: el informe debe ser personalizable.  Es decir, el suscriptor mismo elige qu√© secuencia viene y qu√© recursos hay en su documento. <br><br>  Aqu√≠ hay un punto interesante.  Todo est√° bien si nuestro medidor est√° instalado correctamente.  Pero sucede que la organizaci√≥n de instalaci√≥n, al instalar el ITP, se equivoc√≥ y estableci√≥ incorrectamente el tiempo para el medidor.  Conocimos dispositivos que piensan, en el patio en 2010.  En nuestro sistema, se ver√° como cero lecturas para la fecha actual y consumo real, si elige 2010.  Los deltas son muy √∫tiles aqu√≠.  Es decir, decimos que en el √∫ltimo d√≠a han llegado muchas cosas. <br><br>  Parecer√≠a, ¬øpor qu√© tantas dificultades?  ¬øTan dif√≠cil dejar caer el reloj? <br><br>  Precisamente con VKT-7, esto conducir√° a un reinicio completo del contador y a la eliminaci√≥n de archivos del mismo. <br>  El suscriptor se ver√° obligado a demostrar a los recursos humanos que estableci√≥ el ITP no ayer, sino solo hace unos cinco a√±os. <br><br>  Y finalmente, una cereza en el pastel. <br><br><h3>  Certificaci√≥n </h3><br>  Tenemos un dispositivo de medici√≥n, tenemos un informe.  Entre ellos est√° nuestro sistema, que genera este informe.  ¬øLe crees a ella? <br><br>  Yo soy  Pero c√≥mo demostrar que nada est√° cambiando dentro de nosotros, que no estamos distorsionando el significado.  Este es un problema de certificaci√≥n.  El sistema de encuestas debe tener un certificado que confirme su imparcialidad.  Todos los sistemas grandes, como LERS, I Energetik y otros, tienen un certificado similar.  Lo tenemos, aunque es costoso y requiere mucho tiempo. <br><br>  Por supuesto, siempre puedes cortar la esquina y comprar algo listo.  Pero para esto tienes que pagar al desarrollador.  Y el desarrollador puede solicitar no solo una tarifa de entrada, sino tambi√©n una tarifa mensual.  Es decir, nos veremos obligados a compartir parte de nuestro pastel con √©l. <br><br><h3>  ¬øPor qu√© es todo? </h3><br>  Este no es el problema principal.  Desarrollar su propio sistema tambi√©n es muy costoso y mucho m√°s dif√≠cil.  Sin embargo, le da una ventaja importante.  Entendemos claramente c√≥mo funciona esto.  Lo escalamos f√°cilmente, podemos modificarlo si tal necesidad surge repentinamente.  El suscriptor recibe un servicio m√°s completo y, por nuestra parte, un control cien por ciento sobre el proceso. <br><br>  Por eso hemos elegido el segundo camino.  Hemos invertido en ello un a√±o de la vida de nuestros desarrolladores e ingenieros de campo.  Pero ahora entendemos claramente el trabajo de toda la cadena. <br><br>  Mirando hacia atr√°s, entiendo que sin el conocimiento adquirido, simplemente no podr√≠a interpretar correctamente el comportamiento anormal de uno u otro contador. <br><br>  Adem√°s, se puede construir algo m√°s sobre la base del sistema de despacho.  Alarmas de exceso de consumo, informe de accidente.  Pronto nos estamos preparando para lanzar una aplicaci√≥n m√≥vil. <br><br>  Fuimos a√∫n m√°s lejos y agregamos a nuestra plataforma (de lo contrario ya no se puede llamar) agregamos la capacidad de recibir llamadas de los residentes, la capacidad de administrar nuestros "intercomunicadores inteligentes", controlar inmediatamente el alumbrado p√∫blico y algunos proyectos m√°s sobre los que a√∫n no he escrito. <br><br><img src="https://habrastorage.org/webt/_v/zl/bw/_vzlbw1q-ue01p8udfadwdu3nuq.png"><br><br>  Todo esto es complicado, rompe cerebro y es largo.  Pero el resultado lo vale.  Los suscriptores reciben un producto completo terminado. <br><br>  Cada operador que planea ir a la vivienda y los servicios comunitarios definitivamente tomar√° este camino.  Va a pasar? <br>  Hay una pregunta  Ni siquiera se trata del dinero.  Como escrib√≠ anteriormente, aqu√≠ necesitamos un mont√≥n de trabajo en el campo y el desarrollo.  No todos los jugadores principales est√°n acostumbrados a esto.  Si sus desarrolladores est√°n en Mosc√∫, y las conexiones se realizan en Novosibirsk, entonces su tiempo para el producto terminado se extiende significativamente. <br><br>  El tiempo dir√° qui√©n se quedar√° en este mercado y qui√©n dir√°: bueno, ¬°que se vaya al infierno!  Pero una cosa s√© con certeza: venir y tomar participaci√≥n de mercado exclusivamente con dinero no funcionar√°.  Este proceso requiere enfoques no convencionales, buenos ingenieros, cavar en el regulador, comunicarse con recursos y suscriptores, identificar y superar constantemente el rastrillo. <br><br>  <b>PD:</b> En este art√≠culo, me concentr√© deliberadamente en el calor y no mencion√© la electricidad o el agua.  Tambi√©n describo la conexi√≥n por cable.  Si tenemos una salida de pulso, hay algunos matices, como las conciliaciones obligatorias despu√©s de la instalaci√≥n.  Puede ser que el cable no llegue, entonces se usa LoRaWAN.  Simplemente no es realista describir toda nuestra plataforma y las etapas de su desarrollo en un art√≠culo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/449668/">https://habr.com/ru/post/449668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449656/index.html">C√≥mo entretenerte con vk api</a></li>
<li><a href="../449658/index.html">El nuevo huevo de Pascua de Google: Thanos y el guante del infinito frente a los resultados de b√∫squeda de Google</a></li>
<li><a href="../449662/index.html">Bienvenido a hablar en PyCon Rusia 2019</a></li>
<li><a href="../449664/index.html">Configuraci√≥n de GitLab CI para cargar un proyecto java en maven central</a></li>
<li><a href="../449666/index.html">DevOpsForum 2019. Implementar DevOps no puede esperar</a></li>
<li><a href="../449670/index.html">Para apoyar a la musa: c√≥mo se organizan las donaciones para serpentinas</a></li>
<li><a href="../449672/index.html">Noerden Life2: reloj anal√≥gico con control "gestual" y cristal "t√°ctil"</a></li>
<li><a href="../449674/index.html">Soporte actualizado de Razor en Visual Studio Code, ahora con soporte Blazor</a></li>
<li><a href="../449676/index.html">Gesti√≥n competente: ¬ømito o realidad? Responda al Grupo Kolesa, Evil Martians and Wrike</a></li>
<li><a href="../449678/index.html">Por qu√© las tareas de software siempre toman m√°s tiempo de lo que piensas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>