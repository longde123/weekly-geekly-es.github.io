<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙍🏾 🏴󠁧󠁢󠁥󠁮󠁧󠁿 👩🏼‍🚀 Lampu yang dikendalikan gerakan pada Arduino 👩🏿‍🎨 👩🏻 👨🏼‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya !!! 
 Saya senang bisa menunjukkan kerajinan baru saya lagi. 
 Kali ini saya mengumpulkan lampu arduino yang dikendalikan oleh gesture. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lampu yang dikendalikan gerakan pada Arduino</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484278/"><img src="https://habrastorage.org/webt/d4/ag/wq/d4agwqmzn7bi_rgmhdau05bcc8c.jpeg" alt="gambar"><br><br>  Halo semuanya !!! <br>  Saya senang bisa menunjukkan kerajinan baru saya lagi. <br>  Kali ini saya mengumpulkan lampu arduino yang dikendalikan oleh gesture. <br><br>  Proyek ini menghabiskan banyak waktu, yang selalu saya kekurangan. <br>  Saya merakit versi pertama dari lampu dengan sangat cepat dan itu bekerja dengan baik untuk saya di papan tempat memotong roti, tetapi ketika saya memindahkannya ke tempat permanen di dalam case, semuanya dimulai, semua masalah dengan pembekuan, positif palsu dan masalah lainnya keluar.  Googling di Internet, saya menemukan banyak keluhan di situs asing terkait dengan masalah sensor APDS9960, tetapi saya tidak menemukan solusi untuk masalah ini.  Saya harus meluangkan sedikit waktu mempelajari Lembar Data dari sensor ini dan memahami operasinya.  Pada akhirnya, itu terbayar dan saya bisa menulis kode yang stabil. <br><br>  Jadi, semuanya beres. <br><a name="habracut"></a><br><h4>  Deskripsi lampu </h4><br>  Penekanan utama dalam lampu ini bukan pada visualisasi, tetapi pada kontrol gerakan, semua fungsi lainnya adalah sekunder. <br><br>  Lampu menyala dengan gerakan ke kiri atau kanan, dan Anda juga bisa menyalakannya dengan gerakan ke arah diri Anda sendiri, tetapi ini tidak sepenuhnya nyaman.  Selanjutnya, gerakan ke kiri dan kanan, Anda dapat menggulir melalui efek pencahayaan.  Jika Anda mulai membalik ke kanan, lampu akan lebih dulu mengubah warnanya dari putih menjadi merah, termasuk semua warna primer dan transisi di antara keduanya. <br><br>  Jika setelah menyalakan lampu kita mulai membalik ke kiri, kita akan melihat efek pencahayaan yang dinamis, seperti "Api", "Matriks", "Lampu Lava", "Pelangi", "Confetti", "Sparks", "Lampu Api", "Lampu Api".  Jika Anda perlu kembali ke lampu biasa, maka alih-alih membalik, Anda dapat mematikan lampu dengan gerakan dari diri Anda sendiri dan menghidupkan salah satu dari ketiga gerakan itu. <br>  Mematikan dilakukan dengan gerakan dari diri Anda sendiri. <br><br><img src="https://habrastorage.org/webt/zr/zi/4m/zrzi4maxu4cyqtt9qfh7hzgqu1q.gif"><br><br>  Kecerahan diatur oleh gerakan mendekati dan menjauh dari sensor.  Pertama-tama Anda harus mendekatkan telapak tangan ke sensor, dan kemudian mengangkatnya dengan tajam.  Lampu akan beralih ke mode penyesuaian kecerahan, menggerakkan telapak tangan lebih dekat dan lebih dekat, Anda perlu menemukan kecerahan yang sesuai dan mengunci tangan Anda selama beberapa detik sehingga nilai kecerahan dipertahankan.  Ketika kecerahan dipertahankan, lampu akan memberi tahu Anda tentang hal itu dengan mematikan lampu dengan mulus dan kemudian menyalakannya dengan tingkat kecerahan baru. <br><br>  Saya tidak terlalu memperhatikan efek visual, karena saya berencana membuat versi kedua dari lampu pada Wemos D1 mini controller.  Di mana saya berencana untuk membawa semuanya ke ideal.  Untuk alasan yang sama, saya masih menggunakan hanya satu baris LED, yang terdiri dari 4 strip ws2812b, bukan empat. <br><br><h4>  APDS9960 Mengganggu </h4><br>  Sebenarnya, masalah utama lampu LED terkait dengannya.  Interupsi dalam apds9960 menjalani kehidupan mereka sendiri, ia dapat bekerja dari apa saja, misalnya dari gangguan EM atau berada di dekat sensor seseorang, dari riak nutrisi, dan mungkin dari hal lain. <br><br><img src="https://habrastorage.org/webt/vn/iz/or/vnizoragveyxcjqiw3oq74y8dom.jpeg"><br><br>  Pertama saya mencoba untuk memperbaiki masalah dengan perubahan pada perangkat keras.  Penyaringan daya tidak membantu, bahkan dengan baterai 18650, sensor masih terus hidup.  Saya mencoba mengganti resistor beban sinyal INT ke + 5V dan ini juga tidak berhasil. <br><br>  Ketika penelitian datang, sebuah pemahaman muncul tentang mengapa gangguan palsu terjadi.  Masalah utama adalah refleksi acak dari sinyal IR.  Pabrikan merekomendasikan untuk menutupi sensor dan segala sesuatu di sekitarnya dengan lapisan karet hitam.  Saya tidak punya cat seperti itu dan saya tidak peduli dengan itu.  Meskipun yang pasti ini bisa sedikit mengurangi jumlah positif palsu. <br><br>  Saya menulis kode yang menyaring semua pemicu acak, tetapi mengalami masalah lain.  Setelah interupsi dipicu, informasi isyarat ditransmisikan melalui bus I2C tidak secara instan, tetapi memiliki penundaan tertentu.  Dan jika catu daya karena alamat strip LED berisik, maka waktu transmisi, dengan mempertimbangkan gangguan ini, akan selalu berbeda.  Saya harus mempertimbangkan fakta ini dan menulis ulang kode untuk menentukan gerakan dengan cara yang baru. <br><br><h4>  Definisi gerakan </h4><br>  Jika kode tidak menggunakan interupsi dari sensor, maka tidak ada masalah dengan definisi gerakan.  Namun dalam kasus ini, multitasking hilang.  Jika efek dinamis diaktifkan pada lampu, maka sesuai itu memerlukan kode siklus, terus menerus dieksekusi, dan interupsi akan diperlukan untuk menghapus pengontrol dari siklus. <br><br>  Untuk meningkatkan stabilitas pengenalan gerakan, perlu juga untuk mengurangi sensitivitas penerima di perpustakaan.  Untuk melakukan ini, ganti baris dalam file SparkFun_APDS9960.h: <br><br>  <i>if (! setLEDBoost (LED_BOOST_300))</i> <br>  pada <br>  <i>jika (! setLEDBoost (LED_BOOST_150))</i> <br><br>  Jika Anda mengunduh perpustakaan dari artikel ini, maka Anda tidak perlu melakukan apa pun, semuanya sudah diperbaiki di sana. <br>  Saya juga secara eksperimental memilih arus 50 mA LED, di mana gerakan ditentukan paling stabil dan tidak perlu memaksa LED inframerah dengan arus 100 mA. <br><br>  Dan saya juga membuat kesalahan dengan menempatkan mikrokontroler di bagian bawah lampu, dan sensor gerakan di penutup atas.  Karena itu, untuk menghubungkan arduino dan apds9960, saya harus menggunakan kabel sepanjang 30 cm yang juga menambah ketidakstabilan sensor.  Akibatnya, saya mengalahkan semua masalah ini secara terprogram. <br><br><h4>  Skema </h4><br><img src="https://habrastorage.org/webt/xe/uu/bi/xeuubilb8sr-rjoyuzi_swhliua.jpeg"><br><br>  Untuk memberi daya pada perangkat, saya menggunakan pengisi daya dari ponsel cerdas saya, dengan tegangan output 5V dan arus 2A.  Tetapi pada kenyataannya, lampu dengan cahaya putih yang dinyalakan pada kecerahan maksimum tidak mengkonsumsi di atas 1,3 A. Oleh karena itu, sumber daya apa pun dengan arus keluaran minimal 1,3 A cocok. <br><br>  Stabilisator dc-dc mini360 dapat diganti dengan konverter tegangan step-down lainnya, dengan arus keluaran minimal 150 mA. <br><br>  Dalam diagram di bawah ini, saya tidak menggunakan konverter level logika, tetapi ini adalah keputusan pribadi saya.  Dan oleh karena itu, saya tidak menerima tanggung jawab sebelumnya jika, jika Anda gagal, sensor APDS9960 terhubung tanpa konverter level TTL. <br><br>  Alih-alih Arduino Nano, Anda dapat menggunakan pengontrol Arduino UNO atau klonnya. <br><br>  Pastikan untuk memeriksa keberadaan jumper pada sensor gerakan, mereka ditandai dengan warna merah di foto di bawah ini.  Dalam kasus ketidakhadiran mereka, besi solder harus diaplikasikan pada jalur kontak ini, oleskan dan panaskan solder sampai terbentuk seragam.  Sekarang orang Cina memasok sensor ini tanpa jumper.  Tanpa jumper ini, pengoperasian sensor tidak dijamin. <br><br><img src="https://habrastorage.org/webt/kj/u0/dm/kju0dmvpbqiuuif-hetiy5hb0f8.jpeg"><br><br><h4>  Komponen yang Digunakan </h4><br>  Arduino Nano - 1 pcs. <br>  Gesture Sensor APDS9960 - 1 pc. <br>  LED strip ws2812b - 4 pcs. <br>  Mini360 step-down converter - 1 pc. <br>  Kabel penghubung - 1 set. <br><br><h4>  Kode Program untuk Arduino </h4><br>  Kode ini dibagi menjadi dua bagian.  Di bagian pertama adalah kode utama yang bekerja dengan sensor, dan di bagian kedua adalah kode untuk semua efek pencahayaan. <br><br>  Anda dapat menambahkan efek apa pun sendiri dengan analogi dengan kode saya, tetapi yang paling penting, jangan lupa untuk menambahkan fungsi untuk keluar dari gerakan dari efek lingkaran.  Untuk melakukan ini, tambahkan baris berikut di akhir loop <i>jika (check_int ()) kembali;</i> <br><br>  Deskripsi fungsi utama program <br>  processingGesture () memproses interupsi dari sensor gerakan. <br>  processingProximity () memproses interupsi dari sensor proximity. <br>  gesture_int () - interrupt handler dari sensor gesture. <br>  proximity_int () - interrupt handler dari sensor proximity. <br><br><h4>  Deskripsi konstanta </h4><br>  APDS9960_INT - input untuk interupsi eksternal.  Arduino Nano dan UNO hanya memiliki dua input seperti itu, 2 dan 3. <br><br>  PIN - di sini Anda perlu menentukan output ke strip LED.  Anda dapat menentukan pin digital apa pun yang terhubung dengan tali ws2812b. <br><br>  NUM_PIX - di sini kami menunjukkan jumlah LED alamat dalam rekaman yang digunakan. <br>  range - batas kesalahan adalah dari 0 hingga 10. Jika, ketika mengatur kecerahan, tangan diperbaiki di atas sensor selama 2 detik, maka pembacaan harus disimpan, tetapi jika pembacaan tidak disimpan, secara bertahap menambah batas kesalahan. <br><br>  <a href="" rel="nofollow">Unduh perpustakaan APDS9960</a> <br>  <a href="" rel="nofollow">Unduh sketsa lampu</a> <br><br><h4>  Video yang menunjukkan pengoperasian lampu </h4><br><iframe width="560" height="315" src="https://www.youtube.com/embed/C4QELMzOpiA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  Ringkasan </h4><br>  Lampu hidup terlihat lebih baik daripada di video.  Sekarang semua orang yang melihatnya dari saya diminta untuk mengumpulkan yang sama untuk mereka.  Saat ini, saya tidak suka bagaimana penyesuaian kecerahan bekerja, tetapi saya sedang mengusahakannya.  Saya tidak menjanjikan itu segera, tetapi versi lampu berikutnya sudah dalam pengembangan. <br><br>  Terima kasih telah membaca artikel sampai akhir!  Jika Anda masih memiliki pertanyaan, Anda dapat bertanya di komentar di bawah artikel. <br><br><h4>  PS </h4><br>  Ide lampu terinspirasi <a href="https://www.youtube.com/channel/UCOG6Bi2kvpDa1c8gHWZI5CQ/videos" rel="nofollow">di sini</a> <br>  Saya mengambil efek utama <a href="https://www.tweaking4all.com/hardware/arduino/adruino-led-strip-effects/" rel="nofollow">di sini</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id484278/">https://habr.com/ru/post/id484278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id484252/index.html">Antiquities: 20 tahun teknologi komputer dalam publikasi media</a></li>
<li><a href="../id484254/index.html">Bagaimana cara: infografis atau infografis?</a></li>
<li><a href="../id484270/index.html">Mari kita selesaikan sejumlah uang</a></li>
<li><a href="../id484274/index.html">Chip Qualcomm ADAS</a></li>
<li><a href="../id484276/index.html">Edisi # 29: Pelatihan TI - masalah saat ini dan tantangan dari perusahaan terkemuka</a></li>
<li><a href="../id484282/index.html">Program LyX yang misterius. Bagian 3</a></li>
<li><a href="../id484284/index.html">[Di dermaga] Berkibar. Bagian 3. Untuk Pengembang Asli Bereaksi</a></li>
<li><a href="../id484288/index.html">Bagaimana Konfrontasi Perang Dingin Membantu Cina Memulai Produksi Komputer</a></li>
<li><a href="../id484290/index.html">Lembar contekan yang dibutuhkan di kapal pesiar</a></li>
<li><a href="../id484292/index.html">Fisikawan terhebat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>