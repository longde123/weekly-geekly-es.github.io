<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜñ üëÉüèø üï∑Ô∏è Mesures de radioamateur: analyse du signal du bus I2C üñåÔ∏è üë©üèæ‚Äçü§ù‚Äçüë®üèø ‚¨ÖÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comme je l'ai mentionn√© √† plusieurs reprises dans mes publications, les projets d'amateur sont financ√©s par le budget familial et un radio-amateur ne ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mesures de radioamateur: analyse du signal du bus I2C</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438732/"><img src="https://habrastorage.org/getpro/habr/post_images/9d6/512/d5a/9d6512d5a8bbea73ff0cbdf18361c8d4.png"><br><br>  Comme je l'ai mentionn√© √† plusieurs reprises dans mes publications, les projets d'amateur sont financ√©s par le budget familial et un radio-amateur ne peut g√©n√©ralement pas se permettre d'acheter un √©quipement de mesure co√ªteux.  Nous devons nous contenter de ce que nous avons.  Ou le fait qu'il est possible de profiter de "pendant un certain temps".  Et parfois √† cause du d√©sespoir, le radio-amateur doit ¬´percer avec une scie et scier avec un vrille¬ª. <br><br>  R√©cemment, j'ai ressenti le besoin de savoir ce qui est r√©ellement transmis dans l'appareil que je d√©veloppe sur le bus I2C.  Ce fut ce moment heureux o√π vous pouviez vous permettre de ¬´scier avec une scie¬ª. <br><a name="habracut"></a><br>  Vous pouvez d√©couvrir comment les donn√©es sont √©chang√©es entre les appareils √† l'aide du protocole I2C <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Pour analyser les signaux sur le bus I2C, vous pouvez utiliser √† la fois un oscilloscope num√©rique √† deux canaux avec m√©moire et un analyseur logique. <br><br><h1>  Oscilloscope num√©rique double canal avec m√©moire </h1><br>  Lorsque vous travaillez avec des √©quipements √©lectroniques, l'oscilloscope est l'outil le plus polyvalent.  Les oscilloscopes num√©riques modernes ont un certain nombre de propri√©t√©s utiles qui permettent, entre autres, d'analyser les signaux du bus I2C. <br><br>  Dans ce cas, j'ai obtenu un oscilloscope num√©rique √† deux canaux ¬´pendant un certain temps¬ª avec de la m√©moire Rigol DS1102 (le prix sur le site Web du fabricant est de 461 $).  Cet appareil dispose de deux canaux de mesure avec une bande passante allant jusqu'√† 100 MHz et une fr√©quence d'√©chantillonnage du signal de 1 GSa / s. <br><br>  CH1 √©tait connect√© au signal SCL.  CH2 √©tait connect√© au signal SDA.  Pour les deux canaux, une √©chelle de 1,00 V / div a √©t√© d√©finie.  √âchelle de balayage - 10 us / div.  Pour plus de clart√©, le faisceau du premier canal est d√©cal√© vers la moiti√© sup√©rieure de l'√©cran et le faisceau du deuxi√®me canal vers le bas. <br><br>  Dans le menu Trigger, l'oscilloscope a √©t√© configur√© pour une seule mesure avec le d√©clencheur en atteignant le front montant dans le canal CH1 de niveau 1,00 V: <br><br><img src="https://habrastorage.org/webt/w5/rh/6f/w5rh6fc6t7ylim2soe16el1y-su.jpeg"><br><br>  Apr√®s avoir allum√© l'√©quipement test√©, le gros bouton rouge Marche / Arr√™t a √©t√© enfonc√©.  L'oscilloscope est pass√© en mode veille, puis a d√©marr√©.  Au bout de quelques secondes, l'enregistrement a √©t√© arr√™t√© manuellement. <br><br>  La forme d'onde obtenue a √©t√© enregistr√©e sur un support externe √©cran par √©cran: <br><br><img src="https://habrastorage.org/webt/jj/w-/uj/jjw-uj7azfuajleysvkjytbkqza.png"><br><br>  Analysons les signaux enregistr√©s.  Sur le premier √©cran, nous voyons un affichage des param√®tres de l'appareil et un oscillogramme des signaux SCL (partie sup√©rieure) et SDA (partie inf√©rieure de l'√©cran), sur lesquels nous lisons de gauche √† droite: <br><br><ul><li>  <b>Signal START</b> : le ma√Ætre r√®gle d'abord le niveau bas sur le bus SDA puis sur le bus SCL; </li><li>  <b>Adresse 7 bits</b> : lire 0x60 (1100000) sur le bus SDA le long des bords avant de la SCL; </li><li>  <b>signe du mode d'enregistrement</b> : on lit sur le bus SDA un niveau bas sur le bord d'attaque suivant du SCL; </li><li>  <b>Signal ACK</b> : apr√®s avoir transf√©r√© l'octet, le dispositif ma√Ætre commute pour recevoir via le bus SDA, le SDA est r√©gl√© haut, le dispositif esclave d√©finit le niveau bas sur le front descendant du SCL (en fait, le signal ACK), que le ma√Ætre lit sur le front montant du SCL; </li><li>  <b>Signal STOP</b> : le ma√Ætre passe au niveau haut sur le bus SCL puis sur le bus SDA </li></ul><br>  De m√™me, lentement mais s√ªrement, vous pouvez d√©crypter manuellement le reste de l'enregistrement. <br><br><h1>  Analyseur logique de signal num√©rique </h1><br>  Le protocole peut √™tre d√©crypt√© √† l'aide d'une m√©thode plus simple utilisant un analyseur logique et un logiciel appropri√©. <br><br>  Pour une utilisation comme analyseur logique, j'ai √©t√© aimablement fourni par des coll√®gues de Saleae Logic 8 (le prix sur le site Web du fabricant est de 399 $).  Le logiciel utilis√© √©tait la d√©mo Saleae Logic 1.2.18 tir√©e du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site officiel</a> .  Lors de l'installation de ce logiciel, j'ai accept√© un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">accord de licence</a> avec la condition, y compris, de ne pas utiliser ce logiciel avec un √©quipement tiers. <br><br>  Le programme comprenait un analyseur de protocole I2C.  CH0 a √©t√© attribu√© pour SCL et CH1 pour SDA.  Taux d'√©chantillonnage du signal 24 MSa / s. <br><br><img src="https://habrastorage.org/webt/pj/fx/jm/pjfxjmkkdap8oto_qytml1pwuco.png"><br><br>  Le lancement a √©t√© configur√© sur le front "leader" de CH0.  Le format hexad√©cimal a √©t√© s√©lectionn√© pour afficher les donn√©es. <br><br><img src="https://habrastorage.org/webt/g3/dq/kk/g3dqkkhyebti856uuvvri6qb1iw.png"><br><br>  Apr√®s avoir allum√© l'√©quipement sous test, un grand bouton vert de d√©marrage a √©t√© enfonc√©, et apr√®s quelques secondes, un graphique est apparu √† l'√©cran: <br><br><img src="https://habrastorage.org/webt/hj/ud/wi/hjudwij6fp19tjsbila6ryky11o.png"><br><br>  Je vois l'avantage maximal d'utiliser un analyseur logique dans la mesure o√π le programme lui-m√™me d√©chiffre les donn√©es re√ßues.  Les r√©sultats du d√©chiffrement sont entr√©s ligne par ligne dans la fen√™tre Protocoles d√©cod√©s.  Lorsque vous s√©lectionnez une ligne de donn√©es dans la fen√™tre, le programme affiche l'emplacement de ces donn√©es sur le graphique. <br><br><h1>  Oscilloscope num√©rique vs analyseur logique </h1><br>  Pour comparer les options, j'ai ¬´coll√©¬ª quatre captures d'√©cran de l'√©cran de l'oscilloscope et un fragment du diagramme de l'analyseur logique dans l'√©diteur graphique: <br><br><img src="https://habrastorage.org/webt/go/y8/-k/goy8-kswvkuwhlpepxz2bcp-s8u.png"><br><br>  Le d√©but est indiqu√© par un cercle vert, l'arr√™t est indiqu√© par un cercle rouge.  Le diagramme v√©rifie d'abord la pr√©sence d'un p√©riph√©rique avec l'adresse 0x60 sur le bus, puis √©crit 0x80 dans le registre 0xB7 de ce p√©riph√©rique. <br><br>  Si nous abordons la comparaison des options ¬´avec biais¬ª, nous pouvons voir que sur le diagramme de l'analyseur logique (fr√©quence d'√©chantillonnage 24 MSa / s) il y a une ¬´gigue¬ª du signal SCL, qui n'est pas pr√©sente, en tant que telle, sur l'oscillogramme avec une fr√©quence d'√©chantillonnage de 1 GSa / s.  Le reste de l'image est le m√™me et l'analyseur logique d√©chiffre √©galement correctement les donn√©es en mode automatique. <br><br>  Lors du choix de "soit-ou" dans le "r√©sidu sec", nous avons, dans le cas d'un oscilloscope, un appareil universel co√ªteux qui n'est pas aussi pratique pour analyser un bus qu'un analyseur logique, mais pour un prix comparable.  Dans ces conditions, personnellement, en tant qu'ing√©nieur de la ¬´vieille √©cole¬ª, j'aurais acquis un oscilloscope num√©rique. <br><br>  Cependant, s'il existait un logiciel avec un accord de licence permettant l'utilisation de clones bon march√© d'analyseurs logiques populaires, tels que Saleae Logic 8 ou DSLogic Plus ... <br><br><h1>  Et de tels logiciels existent </h1><br>  Les clones bon march√© des analyseurs logiques populaires, et pas seulement, sont pris en charge par le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">logiciel</a> open source du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet sigrok</a> . <br><br>  Le lieu de travail a √©t√© collect√©: <br><br><img src="https://habrastorage.org/webt/jv/b7/ui/jvb7uib7vtfwnq7h4z0_gpkc-xm.jpeg"><br><br>  Commence alors la ¬´danse avec un tambourin¬ª.  Sur Windows 10, seule la version 32 bits de PulseView a √©t√© lanc√©e.  Elle n'a pas d√©termin√© la pr√©sence d'un clone chinois bon march√© Saleae Logic dans le syst√®me (le prix sur le site Web du vendeur est de 7 $). <br><br>  Apr√®s cela, les pilotes WinUSB ont √©t√© install√©s dans Zadig pour le p√©riph√©rique <b>Logic</b> , et apr√®s une nouvelle num√©risation, il a √©t√© d√©fini dans Zadig comme le p√©riph√©rique <b>fx2latw</b> : <br><br><img src="https://habrastorage.org/webt/lx/t5/1c/lxt51c1hie09kwg5gxcco8uf8ay.png"><br><br>  Apr√®s cela, les pilotes WinUSB ont √©t√© √† nouveau install√©s pour le p√©riph√©rique <b>fx2latw</b> dans Zadig, et seulement apr√®s que PulseView a vu le p√©riph√©rique Saleae Logic dans la liste.  L'appareil est connect√©. <br><br>  Apr√®s avoir connect√© l'appareil, les r√©glages de programme suivants ont √©t√© effectu√©s (de gauche √† droite sur la barre d'outils, en commen√ßant par l'inscription "Saleae Logic"): <br><br><ul><li>  Le taux de capture pr√©-d√©clenchement = 2% est d√©fini en appuyant sur un bouton avec une cl√© et un tournevis; </li><li>  les entr√©es suppl√©mentaires sont d√©sactiv√©es en appuyant sur un bouton avec une sonde rouge; </li><li>  r√©gler le volume d'enregistrement de 100 K √©chantillons; </li><li>  r√©gler la fr√©quence d'√©chantillonnage √† 24 MHz; </li><li>  L'analyseur de protocole I2C est activ√© en appuyant sur un bouton avec une ic√¥ne jaune-verte. </li></ul><br>  Plus loin dans le panneau √† gauche des canaux: <br><br><ul><li>  les canaux re√ßoivent des √©tiquettes de texte correspondant aux signaux; </li><li>  condition de d√©clenchement affect√©e au front montant du signal SDA; </li><li>  Les signaux I2C se voient attribuer des canaux correspondants. </li></ul><br>  Apr√®s avoir allum√© l'√©quipement test√©, le bouton Run a √©t√© enfonc√©.  Le r√©sultat est d√©j√† familier: <br><br><img src="https://habrastorage.org/webt/k-/66/xd/k-66xd9p6bqrbfd6efb57rift58.png"><br><br>  Il semble que ¬´danser avec un tambourin¬ª en valait la peine! <br><br>  <b>UPD</b> : Apr√®s avoir install√© manuellement le pilote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">libusb-win32</a> dans le gestionnaire de p√©riph√©riques pour le p√©riph√©rique USB <b>Logic</b> , le programme PulseView a commenc√© √† d√©tecter de mani√®re stable la pr√©sence de Saleae Logic dans le syst√®me sans manipuler Zadig. <br><br><h4>  Br√®ves conclusions: </h4><br>  L'article d√©crit la m√©thodologie d'analyse des signaux de bus I2C √† l'aide d'un oscilloscope num√©rique avec m√©moire et des analyseurs logiques avec des progiciels d'application. <br><br>  Une m√©thode universelle d'analyse du signal, mais pas bon march√© et lente, est l'utilisation d'un oscilloscope num√©rique avec m√©moire. <br><br>  Une m√©thode rapide et budg√©taire d'analyse du signal, mais avec une t√¢che non triviale de connexion de l'√©quipement, est l'utilisation d'un clone peu co√ªteux d'un analyseur logique en conjonction avec PulseView. <br><br>  Je serais heureux si ma publication aidait les lecteurs √† gagner du temps et de l'argent. <br><br>  Dans la prochaine publication, je vais vous expliquer comment j'ai mesur√© la fr√©quence √† laquelle le r√©sonateur √† quartz a d√©marr√© dans le synth√©tiseur de fr√©quence, sans fr√©quencem√®tre.  Mais c'est une autre histoire ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr438732/">https://habr.com/ru/post/fr438732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr438714/index.html">Pr√©sentation de Veeam Backup & Replication 9.5 Update 4</a></li>
<li><a href="../fr438716/index.html">Utilisation de graphiques pour r√©soudre des syst√®mes clairsem√©s d'√©quations lin√©aires</a></li>
<li><a href="../fr438718/index.html">Le rouge est plus frais que le bleu: hi√©rarchie des couleurs entre les cultures</a></li>
<li><a href="../fr438726/index.html">Y Combinator: comment fermer une entreprise</a></li>
<li><a href="../fr438730/index.html">HomoLudens: Joyeux anniversaire, Sid Meyer (+ tous les articles en russe)</a></li>
<li><a href="../fr438734/index.html">Enchev√™trement de personnes partageant les m√™mes id√©es</a></li>
<li><a href="../fr438736/index.html">DevDay for Managers: g√©rer l'informatique</a></li>
<li><a href="../fr438740/index.html">G√©rer les secrets avec HashiCorp Vault</a></li>
<li><a href="../fr438746/index.html">En route vers les principes physiques de l'√©volution biologique. Continuation</a></li>
<li><a href="../fr438748/index.html">L'infrastructure comme code, nous gagnons √† l'√©chelle (Kirill Vetchinkin, TYME)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>