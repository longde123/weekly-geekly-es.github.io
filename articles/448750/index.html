<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òùüèº üåä üç° Sobre una vulnerabilidad que no es üßùüèº üîµ üë∏üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A finales de marzo de 2019, la compa√±√≠a estadounidense Trustwave, que se dedica a servicios de ciberseguridad y protecci√≥n contra amenazas, public√≥ un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sobre una vulnerabilidad que no es</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/448750/"><p><img src="https://habrastorage.org/webt/_t/__/76/_t__76uk8zeovwtlx8udwwxgpmk.jpeg" alt="imagen"><br>  A finales de marzo de 2019, la compa√±√≠a estadounidense Trustwave, que se dedica a servicios de ciberseguridad y protecci√≥n contra amenazas, public√≥ un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mensaje</a> sobre una vulnerabilidad en el DBMS PostgreSQL, que est√° presente en todas las versiones a partir de PostgreSQL 9.3 a la versi√≥n 11.2.  Esta vulnerabilidad se registr√≥ en la base de datos de vulnerabilidades de seguridad de la informaci√≥n CVE (Common Vulnerabilities and Exposures) con el n√∫mero <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE-2019-9193</a> .  Este mensaje caus√≥ un gran revuelo, porque de acuerdo con el sistema de calificaci√≥n de vulnerabilidad CVSS (Common Vulnerability Scoring System), esta vulnerabilidad recibi√≥ una calificaci√≥n de 9.0 en una escala de 10 puntos. </p><a name="habracut"></a><br><p>  A las vulnerabilidades se les asignaron las siguientes caracter√≠sticas: </p><br><ul><li>  Impacto de la confidencialidad (influencia en la confidencialidad): la divulgaci√≥n completa de la informaci√≥n conduce a la divulgaci√≥n de todos los archivos del sistema. </li><li>  Impacto de integridad (impacto en la integridad): una p√©rdida completa de la protecci√≥n del sistema, como resultado, todo el sistema se ve comprometido. </li><li>  Impacto en la disponibilidad: la disponibilidad de un recurso no est√° disponible por completo. </li><li>  La complejidad del acceso es baja.  El uso requiere muy poco conocimiento o habilidades. </li><li>  Autenticaci√≥n: requiere que un atacante inicie sesi√≥n en el sistema, por ejemplo, a trav√©s de la l√≠nea de comandos o mediante una sesi√≥n de escritorio o una interfaz web. </li><li>  Acceso obtenido - no. </li><li>  Tipo (s) de vulnerabilidad (tipo de vulnerabilidad): ejecuci√≥n de c√≥digo. </li></ul><br><h4>  Ahora veamos qu√© sucede realmente. </h4><br><p>  En 2013, se agreg√≥ una confirmaci√≥n en PostgreSQL 9.3, que, similar al comando \ copy meta en psql, le permite mover datos entre las tablas de PostgreSQL y los archivos normales en el sistema de archivos.  COPY TO copia el contenido de la tabla al archivo y COPY FROM - del archivo a la tabla (agrega datos a los que ya est√°n en la tabla).  A diferencia del metacomando \ copy, que se implementa en el cliente, el comando COPY..TO / FROM se implementa en el lado del servidor.  El comando COPY tiene un par√°metro opcional PROGRAM 'comando', que permite al servidor ejecutar el 'comando' y pasar la salida est√°ndar al servidor PostgreSQL o viceversa.  Fue este par√°metro el que caus√≥ el p√°nico y el mensaje sobre la vulnerabilidad, ya que seg√∫n Trustwave, este comando le permite ejecutar c√≥digo arbitrario en el contexto del usuario del sistema operativo.  Sin embargo, ¬°esto es exactamente lo que pretend√≠an los desarrolladores!  En esta ocasi√≥n, hubo una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicaci√≥n oficial del</a> Grupo de Desarrollo Global de PostgreSQL (PGDG), as√≠ como correspondencia en la lista de <a href="">correo</a> general pgsql-general <a href="">(CVE-2019-9193 sobre COPY FROM / TO PROGRAM</a> ) y comentarios de desarrolladores l√≠deres, por ejemplo Magnus Hagander, en su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">blog</a> . </p><br><p>  Pero para entender la esencia, los detalles son importantes.  Esto es lo que dice la documentaci√≥n sobre esto: " <em>Tenga en cuenta que el comando se inicia a trav√©s del shell de comandos, por lo que si necesita pasar cualquier argumento a este comando desde una fuente no confiable, debe deshacerse cuidadosamente de todos los caracteres especiales que tienen un significado especial en el shell, o para cribarlos.</em>  <em>Por razones de seguridad, es mejor limitarse a una l√≠nea de comando fija o al menos no permitir que los usuarios ingresen contenido arbitrario en ella</em> ". </p><br><p> Adem√°s, la documentaci√≥n dice que solo los superusuarios de la base de datos pueden ejecutar el comando COPIAR con un archivo o un comando externo, o (en la versi√≥n 11 apareci√≥) miembros de los roles integrados pg_read_server_files, pg_write_server_files o pg_execute_server_program, ya que esto le permite leer / escribir cualquier archivo y ejecutar cualquier programas a los que el servidor tiene acceso.  La ejecuci√≥n de un comando en PROGRAM puede estar limitada por otros mecanismos de control de acceso que operan en el sistema operativo, por ejemplo SELinux. </p><br><p>  Estructuralmente, no hay l√≠mite de seguridad entre el superusuario de la base de datos y el usuario del sistema operativo en cuyo nombre se ejecuta el proceso del servidor.  Las funciones para COPY ... PROGRAM agregadas en PostgreSQL 9.3 no cambiaron nada de lo anterior, pero agregaron un nuevo comando dentro de los mismos l√≠mites de seguridad que ya exist√≠an.  Por lo tanto, el servidor PostgreSQL no puede ejecutarse como el superusuario del sistema operativo (por ejemplo, root). </p><br><p>  La funcionalidad COPY..TO / FROM ... PROGRAM proporciona posibilidades ilimitadas para la manipulaci√≥n de datos, el procesamiento posterior de datos, la compresi√≥n de datos sobre la marcha, etc.  Y prohibir el uso de herramientas tan √∫tiles ser√≠a un error.  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">blog de</a> Michael Paquier se dan ejemplos del constructo COPY..TO / FROM ... PROGRAM. </p><br><p>  Una conclusi√≥n importante que se desprende de esta historia es que al dise√±ar y crear bases de datos, es necesario recordar no solo las caracter√≠sticas funcionales, sino tambi√©n la seguridad de la informaci√≥n y seguir las siguientes reglas: </p><br><ul><li>  Al crear usuarios comunes en la base de datos, no les otorgue permisos de superusuario, solo el usuario del sistema operativo postgres, en nombre del cual se inicia el servidor, act√∫a en la base de datos como superusuario.  En este caso, no hay escalada de privilegios.  Si otorga permiso de superusuario a un usuario de base de datos ordinario, esto ser√° equivalente a otorgar al usuario los permisos que el usuario de postgres tiene en el sistema operativo. </li><li>  Utilice las capacidades de pg_hba.conf para asegurarse de que ning√∫n superusuario pueda iniciar sesi√≥n de forma remota. <br>  Si no hay l√≠neas anteriores con "host" en el archivo pg_hba.conf, la siguiente entrada proh√≠be que el usuario postgres se conecte a cualquier base de datos desde cualquier direcci√≥n utilizando el protocolo tcp / ip. <br><br><pre><code class="plaintext hljs"># TYPE DATABASE USER ADDRESS METHOD host all postgres 0.0.0.0/0 reject</code> </pre> </li><li>  Use t√©cnicas avanzadas de seguridad de la informaci√≥n en PostgresSQL, como el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CIS PostgreSQL Benchmark</a> y la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gu√≠a de implementaci√≥n t√©cnica de seguridad de PostgreSQL (STIG)</a> . </li><li>  Utilice productos certificados para los cuales se haya confirmado el cumplimiento de los requisitos funcionales para la seguridad de la informaci√≥n y el nivel de confianza en las herramientas de seguridad de la informaci√≥n. </li></ul><br><p>  Por lo tanto, descubrimos que CVE-2019-9193 no es una vulnerabilidad.  Pero no debes relajarte.  No se pierda informaci√≥n sobre actualizaciones y nuevas versiones menores que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">corrigen las vulnerabilidades identificadas</a> , sin las cuales no puede hacer un solo proyecto grande. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448750/">https://habr.com/ru/post/448750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448738/index.html">¬øQui√©n caza startups?</a></li>
<li><a href="../448740/index.html">Escuchamos m√∫sica SID (Commodore 64) a trav√©s de OPL3 en PC modernas</a></li>
<li><a href="../448744/index.html">¬øC√≥mo transferir una variable de fragmento a actividad en Android?</a></li>
<li><a href="../448746/index.html">√çndices en PostgreSQL - 7 (GIN)</a></li>
<li><a href="../448748/index.html">Reflexiones sobre belleza y c√≥digo</a></li>
<li><a href="../448754/index.html">Qui√©n es qui√©n en c√≥digo abierto: biograf√≠as geek</a></li>
<li><a href="../448756/index.html">Antecedentes: por qu√© Apple y Qualcomm se pelearon y luego se reconciliaron</a></li>
<li><a href="../448758/index.html">Reloj inteligente con BASIC en 6502 f√≠sico</a></li>
<li><a href="../448762/index.html">Disturbios en el Picaba. Los usuarios van masivamente a Reddit</a></li>
<li><a href="../448764/index.html">Relojes en ATtiny13</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>