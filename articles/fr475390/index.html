<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêÅ ü§≥üèæ üë©üèæ‚Äçüç≥ Comment cr√©er votre premi√®re application Web √† l'aide de Go üßëüèº‚Äçü§ù‚Äçüßëüèª ü§Ø üöµüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous pr√©sente la traduction de l'article "Comment construire votre premi√®re application web avec Go" par Ayooluwa Isaiah. 


 Ceci e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment cr√©er votre premi√®re application Web √† l'aide de Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475390/"><p>  Bonjour, Habr!  Je vous pr√©sente la traduction de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Comment construire votre premi√®re application web avec Go"</a> par Ayooluwa Isaiah. </p><br><p>  Ceci est le guide de votre premi√®re application Web Go.  Nous allons cr√©er une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">application de news</a> qui utilise l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API News</a> pour recevoir des articles de news sur un sujet sp√©cifique et la d√©ployer sur le serveur de production √† la fin. </p><a name="habracut"></a><br><p>  Vous pouvez trouver le code complet utilis√© pour ce tutoriel dans ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©f√©rentiel GitHub</a> . </p><br><h2 id="trebovaniya">  Pr√©requis </h2><br><p> La seule condition requise pour cette t√¢che est que Go soit install√© sur votre ordinateur et que vous connaissiez un peu sa syntaxe et ses constructions.  La version Go que j'ai utilis√©e pour cr√©er l'application est √©galement la plus r√©cente au moment de la r√©daction: <strong>1.12.9</strong> .  Pour afficher la version install√©e de Go, utilisez la commande <code>go version</code> . </p><br><p>  Si vous trouvez cette t√¢che trop difficile pour vous, allez √† ma pr√©c√©dente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le√ßon de</a> langue d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">introduction</a> , qui devrait vous aider √† d√©marrer. </p><br><h2 id="itak-nachnem">  Commen√ßons donc! </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nous clonons le r√©f√©rentiel de fichiers de d√©marrage sur GitHub</a> et <code>cd</code> dans le r√©pertoire cr√©√©.  Nous avons trois fichiers principaux: Dans le fichier <code>main.go</code> nous √©crirons tout le code Go pour cette t√¢che.  Le fichier <code>index.html</code> est le mod√®le qui sera envoy√© au navigateur et les <code></code> de l'application se trouvent dans <code>assets/styles.css</code> . </p><br><h2 id="sozdadim-bazovyy-veb-server">  Cr√©er un serveur Web de base </h2><br><p>  Commen√ßons par cr√©er un serveur principal qui envoie le texte ¬´Hello World!¬ª Au navigateur lors de l'ex√©cution d'une requ√™te GET √† la racine du serveur.  Modifiez votre fichier <code>main.go</code> pour qu'il ressemble √† ceci: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { w.Write([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(<span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Hello World!&lt;/h1&gt;"</span></span>)) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { port := os.Getenv(<span class="hljs-string"><span class="hljs-string">"PORT"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> port == <span class="hljs-string"><span class="hljs-string">""</span></span> { port = <span class="hljs-string"><span class="hljs-string">"3000"</span></span> } mux := http.NewServeMux() mux.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, indexHandler) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":"</span></span>+port, mux) }</code> </pre> <br><p>  La premi√®re ligne du <code>package main</code> - d√©clare que le code du fichier <code>main.go</code> au package principal.  Apr√®s cela, nous avons import√© le package <code>net/http</code> , qui fournit des impl√©mentations client et serveur HTTP √† utiliser dans notre application.  Ce package fait partie de la biblioth√®que standard et est inclus avec chaque installation Go. </p><br><p>  Dans la fonction <code>main</code> , <code>http.NewServeMux()</code> cr√©e un nouveau multiplexeur de requ√™tes HTTP et l'affecte √† la variable <code>mux</code> .  Essentiellement, le multiplexeur de demandes fait correspondre l'URL des demandes entrantes √† la liste des chemins enregistr√©s et appelle le gestionnaire appropri√© pour le chemin chaque fois qu'une correspondance est trouv√©e. </p><br><p>  Ensuite, nous enregistrons notre premi√®re fonction de gestionnaire pour le chemin racine <code>/</code> .  Cette fonction de gestionnaire est le deuxi√®me argument de <code>HandleFunc</code> et poss√®de toujours la <code>func (w http.ResponseWriter, r * http.Request)</code> signature <code>func (w http.ResponseWriter, r * http.Request)</code> . </p><br><p>  Si vous regardez la fonction <code>indexHandler</code> , vous verrez qu'elle a juste une telle signature, ce qui en fait un deuxi√®me argument valide pour <code>HandleFunc</code> .  Le param√®tre <code>w</code> est la structure que nous utilisons pour envoyer des r√©ponses √† la requ√™te HTTP.  Il impl√©mente la m√©thode <code>Write()</code> , qui prend une tranche d'octets et √©crit les donn√©es combin√©es dans le cadre de la r√©ponse HTTP. </p><br><p>  En revanche, le param√®tre <code>r</code> repr√©sente la requ√™te HTTP re√ßue du client.  C'est ainsi que nous acc√©dons aux donn√©es envoy√©es par le navigateur Web sur le serveur.  Nous ne l‚Äôutilisons pas encore ici, mais nous l‚Äôutiliserons certainement plus tard. </p><br><p>  Enfin, nous avons la m√©thode <code>http.ListenAndServe()</code> , qui d√©marre le serveur sur le port 3000 si le port n'est pas d√©fini par l'environnement.  N'h√©sitez pas √† utiliser un port diff√©rent si 3000 est utilis√© sur votre ordinateur. </p><br><p>  Ensuite, compilez et ex√©cutez le code que vous venez d'√©crire: </p><br><pre> <code class="bash hljs">go run main.go</code> </pre> <br><p>  Si vous allez sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http: // localhost: 3000</a> dans votre navigateur, vous devriez voir le texte "Hello World!". </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/989/645/927/9896459277d1e7aa363ee0f9c444bc92.png" alt="Courageux navigateur regard√© le texte Hello World"></a> </p><br><h2 id="shablony-v-go">  Go Templates </h2><br><p>  Voyons les bases de la cr√©ation de mod√®les dans Go.  Si vous connaissez les mod√®les dans d'autres langues, cela devrait √™tre assez facile √† comprendre. </p><br><p>  Les mod√®les permettent de personnaliser facilement la sortie de votre application Web en fonction de l'itin√©raire sans avoir √† √©crire le m√™me code √† diff√©rents endroits.  Par exemple, nous pouvons cr√©er un mod√®le pour la barre de navigation et l'utiliser sur toutes les pages du site sans dupliquer le code.  De plus, nous avons √©galement la possibilit√© d'ajouter une logique de base √† nos pages Web. </p><br><p>  Go propose deux biblioth√®ques de mod√®les dans sa biblioth√®que standard: <code>text/template</code> et <code>html/template</code> .  Les deux fournissent la m√™me interface, mais le package <code>html/template</code> est utilis√© pour g√©n√©rer une sortie HTML prot√©g√©e contre l'injection de code, nous allons donc l'utiliser ici. </p><br><p>  Importez ce package dans votre fichier <code>main.go</code> et utilisez-le comme suit: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"html/template"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tpl = template.Must(template.ParseFiles(<span class="hljs-string"><span class="hljs-string">"index.html"</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { tpl.Execute(w, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { port := os.Getenv(<span class="hljs-string"><span class="hljs-string">"PORT"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> port == <span class="hljs-string"><span class="hljs-string">""</span></span> { port = <span class="hljs-string"><span class="hljs-string">"3000"</span></span> } mux := http.NewServeMux() mux.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, indexHandler) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":"</span></span>+port, mux) }</code> </pre> <br><p>  <code>tpl</code> est une variable de niveau package qui indique la d√©finition d'un mod√®le √† partir des fichiers fournis.  L'appel <code>template.ParseFiles</code> analyse le fichier <code>index.html</code> √† la racine de notre r√©pertoire de projet et v√©rifie sa validit√©. </p><br><p>  Nous encapsulons l'appel <code>template.ParseFiles</code> dans <code>template.Must</code> afin que le code provoque une panique lorsqu'une erreur se produit.  La raison pour laquelle nous paniquons ici au lieu d'essayer de g√©rer l'erreur est parce que cela n'a aucun sens de continuer √† ex√©cuter le code si nous avons un mod√®le non valide.  Il s'agit d'un probl√®me qui doit √™tre r√©solu avant d'essayer de red√©marrer le serveur. </p><br><p>  Dans la fonction <code>indexHandler</code> nous <code>indexHandler</code> le mod√®le cr√©√© pr√©c√©demment en fournissant deux arguments: o√π nous voulons √©crire la sortie et les donn√©es que nous voulons transmettre au mod√®le. </p><br><p>  Dans le cas ci-dessus, nous √©crivons la sortie dans l'interface <code>ResponseWriter</code> et, puisque nous n'avons actuellement aucune donn√©e √† transmettre √† notre mod√®le, <code>nil</code> est transmis comme deuxi√®me argument. </p><br><p>  Arr√™tez le processus en cours dans votre terminal √† l'aide de Ctrl-C et red√©marrez-le avec <code>go run main.go</code> , puis actualisez votre navigateur.  Vous devriez voir le texte ¬´D√©mo de l'application News¬ª sur la page, comme illustr√© ci-dessous: </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/8f8/3d2/10b/8f83d210b810eeacb35c3684adcaa827.png" alt="Courageux navigateur affich√© le texte de d√©monstration de l'application"></a> </p><br><h2 id="dobavlyaem-panel-navigacii-na-stranicu">  Ajouter une barre de navigation √† la page </h2><br><p>  Remplacez le contenu de la <code>&lt;body&gt;</code> dans votre fichier index.html comme indiqu√© ci-dessous: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">main</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>News Demo<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GET"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search-input"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Enter a news topic"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"q"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/freshman-tech/news"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button github-button"</span></span></span><span class="hljs-tag">&gt;</span></span>View on Github<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">main</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Red√©marrez ensuite le serveur et actualisez votre navigateur.  Vous devriez voir quelque chose de similaire √† ceci: </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/abf/65e/ea8/abf65eea8166c5839ec6e01e19d31eb4.png" alt="Navigateur visualise une barre de navigation sans style"></a> </p><br><h2 id="rabota-so-staticheskimi-faylami">  Travailler avec des fichiers statiques </h2><br><p>  Veuillez noter que la barre de navigation que nous avons ajout√©e ci-dessus n'a pas de styles, malgr√© le fait que nous les ayons d√©j√† sp√©cifi√©s dans la <code>&lt;head&gt;</code> notre document. </p><br><p>  En effet, le chemin <code>/</code> correspond √† tous les chemins qui ne sont pas trait√©s ailleurs.  Par cons√©quent, si vous acc√©dez √† <a href="">http: // localhost: 3000 / assets / style.css</a> , vous obtiendrez toujours la page d'accueil de News Demo au lieu du fichier CSS car la route <code>/assets/style.css</code> pas √©t√© sp√©cifiquement d√©clar√©e. </p><br><p>  Mais la n√©cessit√© de d√©clarer des gestionnaires explicites pour tous nos fichiers statiques est irr√©aliste et ne peut pas √©voluer.  Heureusement, nous pouvons cr√©er un gestionnaire pour servir toutes les ressources statiques. </p><br><p>  La premi√®re chose √† faire est de cr√©er une instance de l'objet serveur de fichiers, en passant dans le r√©pertoire dans lequel se trouvent tous nos fichiers statiques: </p><br><pre> <code class="go hljs">fs := http.FileServer(http.Dir(<span class="hljs-string"><span class="hljs-string">"assets"</span></span>))</code> </pre> <br><p>  Ensuite, nous devons dire √† notre routeur d'utiliser cet objet serveur de fichiers pour tous les chemins commen√ßant par le pr√©fixe <code>/assets/</code> : </p><br><pre> <code class="go hljs">mux.Handle(<span class="hljs-string"><span class="hljs-string">"/assets/"</span></span>, http.StripPrefix(<span class="hljs-string"><span class="hljs-string">"/assets/"</span></span>, fs))</code> </pre> <br><p>  Maintenant tous ensemble: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// main.go //   func main() { port := os.Getenv("PORT") if port == "" { port = "3000" } mux := http.NewServeMux() //     fs := http.FileServer(http.Dir("assets")) mux.Handle("/assets/", http.StripPrefix("/assets/", fs)) mux.HandleFunc("/", indexHandler) http.ListenAndServe(":"+port, mux) }</span></span></code> </pre> <br><p>  Red√©marrez le serveur et actualisez le navigateur.  Les styles doivent s'activer comme indiqu√© ci-dessous: </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/933/902/77d/93390277dcb620c2f3a3e0421a4f5e6d.png" alt="Navigateur courageux afficher la barre de navigation de style"></a> </p><br><h2 id="sozdaem-rout-search">  Nous cr√©ons un itin√©raire / recherche </h2><br><p>  Cr√©ons un itin√©raire qui g√®re les requ√™tes de recherche d'articles de presse.  Nous utiliserons l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API News</a> pour traiter les demandes, vous devez donc vous inscrire pour recevoir une cl√© API gratuite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><p>  Cette route attend deux param√®tres de requ√™te: <code>q</code> repr√©sente la requ√™te de l'utilisateur et la <code>page</code> utilis√©e pour faire d√©filer les r√©sultats.  Ce param√®tre de <code>page</code> est facultatif.  S'il n'est pas inclus dans l'URL, nous supposons simplement que le num√©ro de page des r√©sultats est d√©fini sur ¬´1¬ª. </p><br><p>  Ajoutez le gestionnaire suivant sous <code>indexHandler</code> √† votre fichier <code>main.go</code> : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">searchHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { u, err := url.Parse(r.URL.String()) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { w.WriteHeader(http.StatusInternalServerError) w.Write([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(<span class="hljs-string"><span class="hljs-string">"Internal server error"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } params := u.Query() searchKey := params.Get(<span class="hljs-string"><span class="hljs-string">"q"</span></span>) page := params.Get(<span class="hljs-string"><span class="hljs-string">"page"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> page == <span class="hljs-string"><span class="hljs-string">""</span></span> { page = <span class="hljs-string"><span class="hljs-string">"1"</span></span> } fmt.Println(<span class="hljs-string"><span class="hljs-string">"Search Query is: "</span></span>, searchKey) fmt.Println(<span class="hljs-string"><span class="hljs-string">"Results page is: "</span></span>, page) }</code> </pre> <br><p>  Le code ci-dessus extrait les param√®tres <code>q</code> et <code>page</code> de l'URL de demande et les affiche tous les deux dans le terminal. </p><br><p>  Enregistrez ensuite la fonction <code>searchHandler</code> tant que gestionnaire de chemin de <code>/search</code> , comme indiqu√© ci-dessous: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { port := os.Getenv(<span class="hljs-string"><span class="hljs-string">"PORT"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> port == <span class="hljs-string"><span class="hljs-string">""</span></span> { port = <span class="hljs-string"><span class="hljs-string">"3000"</span></span> } mux := http.NewServeMux() fs := http.FileServer(http.Dir(<span class="hljs-string"><span class="hljs-string">"assets"</span></span>)) mux.Handle(<span class="hljs-string"><span class="hljs-string">"/assets/"</span></span>, http.StripPrefix(<span class="hljs-string"><span class="hljs-string">"/assets/"</span></span>, fs)) <span class="hljs-comment"><span class="hljs-comment">// Add the next line mux.HandleFunc("/search", searchHandler) mux.HandleFunc("/", indexHandler) http.ListenAndServe(":"+port, mux) }</span></span></code> </pre> <br><p>  N'oubliez pas d'importer les packages <code>fmt</code> et <code>net/url</code> ci-dessus: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"html/template"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"net/url"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> )</code> </pre> <br><p>  Red√©marrez maintenant le serveur, entrez la requ√™te dans le champ de recherche et v√©rifiez le terminal.  Vous devriez voir votre demande dans le terminal, comme indiqu√© ci-dessous: </p><br><br><br><h2 id="sozdayom-model-dannyh">  Cr√©er un mod√®le de donn√©es </h2><br><p>  Lorsque nous faisons une demande au point de terminaison <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>News API/everything</code></a> , nous attendons une r√©ponse json au format suivant: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ok"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"totalResults"</span></span>: <span class="hljs-number"><span class="hljs-number">4661</span></span>, <span class="hljs-attr"><span class="hljs-attr">"articles"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"source"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Gizmodo.com"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jennings Brown"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"World's Dumbest Bitcoin Scammer Tries to Scam Bitcoin Educator, Gets Scammed in The Process"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ben Perrin is a Canadian cryptocurrency enthusiast and educator who hosts a bitcoin show on YouTube. This is immediately apparent after a quick a look at all his social media. Ten seconds of viewing on of his videos will show that he is knowledgeable about di‚Ä¶"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://gizmodo.com/worlds-dumbest-bitcoin-scammer-tries-to-scam-bitcoin-ed-1837032058"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"urlToImage"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://i.kinja-img.com/gawker-media/image/upload/s--uLIW_Oxp--/c_fill,fl_progressive,g_center,h_900,q_80,w_1600/s4us4gembzxlsjrkmnbi.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"publishedAt"</span></span>: <span class="hljs-string"><span class="hljs-string">"2019-08-07T16:30:00Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"content"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ben Perrin is a Canadian cryptocurrency enthusiast and educator who hosts a bitcoin show on YouTube. This is immediately apparent after a quick a look at all his social media. Ten seconds of viewing on of his videos will show that he is knowledgeable about..."</span></span> } ] }</code> </pre> <br><p>  Pour travailler avec ces donn√©es dans Go, nous devons g√©n√©rer une structure qui refl√®te les donn√©es lors du d√©codage du corps de r√©ponse.  Bien s√ªr, vous pouvez le faire manuellement, mais je pr√©f√®re utiliser le site Web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JSON-to-Go</a> , ce qui rend ce processus vraiment facile.  Il g√©n√®re une structure Go (avec des balises) qui fonctionnera pour ce JSON. </p><br><p>  Tout ce que vous avez √† faire est de copier l'objet JSON et de le coller dans le champ marqu√© <strong>JSON</strong> , puis de copier la sortie et de la coller dans votre code.  Voici ce que nous obtenons pour l'objet JSON ci-dessus: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> AutoGenerated <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Status <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"status"`</span></span> TotalResults <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-string"><span class="hljs-string">`json:"totalResults"`</span></span> Articles []<span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Source <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { ID <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} <span class="hljs-string"><span class="hljs-string">`json:"id"`</span></span> Name <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"name"`</span></span> } <span class="hljs-string"><span class="hljs-string">`json:"source"`</span></span> Author <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"author"`</span></span> Title <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"title"`</span></span> Description <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"description"`</span></span> URL <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"url"`</span></span> URLToImage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"urlToImage"`</span></span> PublishedAt time.Time <span class="hljs-string"><span class="hljs-string">`json:"publishedAt"`</span></span> Content <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"content"`</span></span> } <span class="hljs-string"><span class="hljs-string">`json:"articles"`</span></span> }</code> </pre> <br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/ac8/9d9/44f/ac89d944f90e03d2313a02d38364ba0d.png" alt="Navigateur courageux afficher l'outil JSON to Go"></a> </p><br><p>  J'ai apport√© plusieurs modifications √† la structure <code>AutoGenerated</code> en s√©parant le fragment <code>Articles</code> dans sa propre structure et en mettant √† jour le nom de la structure.  Collez la d√©claration de variable <code>tpl</code> suivante dans <code>main.go</code> et ajoutez le package de <code>time</code> √† votre importation: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Source <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { ID <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} <span class="hljs-string"><span class="hljs-string">`json:"id"`</span></span> Name <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"name"`</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Article <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Source Source <span class="hljs-string"><span class="hljs-string">`json:"source"`</span></span> Author <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"author"`</span></span> Title <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"title"`</span></span> Description <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"description"`</span></span> URL <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"url"`</span></span> URLToImage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"urlToImage"`</span></span> PublishedAt time.Time <span class="hljs-string"><span class="hljs-string">`json:"publishedAt"`</span></span> Content <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"content"`</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Results <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Status <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"status"`</span></span> TotalResults <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-string"><span class="hljs-string">`json:"totalResults"`</span></span> Articles []Article <span class="hljs-string"><span class="hljs-string">`json:"articles"`</span></span> }</code> </pre> <br><p>  Comme vous le savez peut-√™tre, Go requiert que tous les champs export√©s de la structure commencent par une majuscule.  Cependant, il est habituel de repr√©senter les champs JSON en utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">camelCase</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">snake_case</a> , qui ne commencent pas par une majuscule. </p><br><p>  Par cons√©quent, nous utilisons des balises de champ de structure telles que <code>json:"id"</code> pour afficher explicitement le champ de structure dans le champ JSON, comme indiqu√© ci-dessus.  Il vous permet √©galement d'utiliser des noms compl√®tement diff√©rents pour le champ de structure et le champ json correspondant, si n√©cessaire. </p><br><p>  Enfin, cr√©ons un type de structure diff√©rent pour chaque requ√™te de recherche.  Ajoutez ceci sous la structure des <code>Results</code> dans <code>main.go</code> : </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Search <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { SearchKey <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> NextPage <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TotalPages <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Results Results }</code> </pre> <br><p>  Cette structure repr√©sente chaque requ√™te de recherche effectu√©e par l'utilisateur.  <code>SearchKey</code> est la requ√™te elle-m√™me, le champ <code>NextPage</code> permet de faire d√©filer les r√©sultats, <code>TotalPages</code> - le nombre total de pages de r√©sultats de requ√™te et <code>Results</code> - la page actuelle des r√©sultats de requ√™te. </p><br><h2 id="otpravlyaem-zapros-po-news-api-i-renderim-rezultaty">  Envoyer une demande √† l'aide de l'API News et afficher les r√©sultats </h2><br><p>  Maintenant que nous avons le mod√®le de donn√©es pour notre application, continuons et faisons des demandes √† l'API News, puis restituons les r√©sultats sur la page. </p><br><p>  √âtant donn√© que l'API News n√©cessite une cl√© API, nous devons trouver un moyen de la transmettre dans notre application sans codage en dur dans le code.  Les variables d'environnement sont une approche courante, mais j'ai d√©cid√© d'utiliser √† la place des drapeaux de ligne de commande.  Go fournit un package d' <code>flag</code> qui prend en charge l'analyse de base des indicateurs de ligne de commande, et c'est ce que nous allons utiliser ici. </p><br><p>  <code>apiKey</code> abord une nouvelle variable <code>apiKey</code> sous la variable <code>tpl</code> : </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> apiKey *<span class="hljs-keyword"><span class="hljs-keyword">string</span></span></code> </pre> <br><p>  Ensuite, utilisez-le dans la fonction <code>main</code> comme suit: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { apiKey = flag.String(<span class="hljs-string"><span class="hljs-string">"apikey"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"Newsapi.org access key"</span></span>) flag.Parse() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> *apiKey == <span class="hljs-string"><span class="hljs-string">""</span></span> { log.Fatal(<span class="hljs-string"><span class="hljs-string">"apiKey must be set"</span></span>) } <span class="hljs-comment"><span class="hljs-comment">//    }</span></span></code> </pre> <br><p>  Ici, nous appelons la m√©thode <code>flag.String()</code> , qui nous permet de d√©finir un indicateur de cha√Æne.  Le premier argument de cette m√©thode est le nom de l'indicateur, le second est la valeur par d√©faut et le troisi√®me est la description de l'utilisation. </p><br><p>  Apr√®s avoir d√©fini tous les indicateurs, vous devez appeler <code>flag.Parse()</code> pour les <code>flag.Parse()</code> r√©ellement.  Enfin, comme l' <code>apikey</code> est un composant requis pour cette application, nous nous assurons que le programme se bloque si ce drapeau n'est pas d√©fini pendant l'ex√©cution du programme. </p><br><p>  Assurez-vous d'ajouter le package d' <code>flag</code> √† votre importation, puis red√©marrez le serveur et transmettez l'indicateur d' <code>apikey</code> requis, comme indiqu√© ci-dessous: </p><br><pre> <code class="bash hljs">go run main.go -apikey=&lt;your newsapi access key&gt;</code> </pre> <br><p>  Ensuite, continuons et mettons √† jour <code>searchHandler</code> afin que la requ√™te de recherche de l'utilisateur soit envoy√©e √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">newsapi.org</a> et que les r√©sultats soient affich√©s dans notre mod√®le. </p><br><p>  Remplacez les deux appels √† la m√©thode <code>fmt.Println()</code> √† la fin de la fonction <code>searchHandler</code> code suivant: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">searchHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// beginning of the function search := &amp;Search{} search.SearchKey = searchKey next, err := strconv.Atoi(page) if err != nil { http.Error(w, "Unexpected server error", http.StatusInternalServerError) return } search.NextPage = next pageSize := 20 endpoint := fmt.Sprintf("https://newsapi.org/v2/everything?q=%s&amp;pageSize=%d&amp;page=%d&amp;apiKey=%s&amp;sortBy=publishedAt&amp;language=en", url.QueryEscape(search.SearchKey), pageSize, search.NextPage, *apiKey) resp, err := http.Get(endpoint) if err != nil { w.WriteHeader(http.StatusInternalServerError) return } defer resp.Body.Close() if resp.StatusCode != 200 { w.WriteHeader(http.StatusInternalServerError) return } err = json.NewDecoder(resp.Body).Decode(&amp;search.Results) if err != nil { w.WriteHeader(http.StatusInternalServerError) return } search.TotalPages = int(math.Ceil(float64(search.Results.TotalResults / pageSize))) err = tpl.Execute(w, search) if err != nil { w.WriteHeader(http.StatusInternalServerError) } }</span></span></code> </pre> <br><p>  Tout d'abord, nous cr√©ons une nouvelle instance de la structure de <code>Search</code> et d√©finissons la valeur du champ <code>SearchKey</code> sur la valeur du param√®tre d'URL <code>q</code> dans la demande HTTP. </p><br><p>  Apr√®s cela, nous convertissons la variable de <code>page</code> en un entier et <code>NextPage</code> le r√©sultat au champ <code>NextPage</code> variable de <code>search</code> .  Ensuite, nous cr√©ons la variable <code>pageSize</code> et d√©finissons sa valeur sur 20. Cette variable <code>pageSize</code> repr√©sente le nombre de r√©sultats que l'API news renverra dans sa r√©ponse.  Cette valeur peut aller de 0 √† 100. </p><br><p>  Ensuite, nous cr√©ons le point de terminaison √† l'aide de <code>fmt.Sprintf()</code> et lui faisons une demande GET.  Si la r√©ponse de l'API News n'est pas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://freshman.tech/">200 OK</a> , nous renverrons une erreur g√©n√©rale du serveur au client.  Sinon, le corps de la r√©ponse est analys√© dans <code>search.Results</code> . </p><br><p>  Ensuite, nous calculons le nombre total de pages en divisant le champ <code>pageSize</code> par <code>pageSize</code> .  Par exemple, si une requ√™te renvoie 100 r√©sultats et que nous n'en affichons que 20 √† la fois, nous devrons faire d√©filer cinq pages pour voir les 100 r√©sultats de cette requ√™te. </p><br><p>  Apr√®s cela, nous rendons notre mod√®le et passons la variable de <code>search</code> comme interface de donn√©es.  Cela nous permet d'acc√©der aux donn√©es d'un objet JSON dans notre mod√®le, comme vous le verrez. </p><br><p>  Avant de passer √† <code>index.html</code> , assurez-vous de mettre √† jour vos importations comme indiqu√© ci-dessous: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"encoding/json"</span></span> <span class="hljs-string"><span class="hljs-string">"flag"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"html/template"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"math"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"net/url"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> <span class="hljs-string"><span class="hljs-string">"strconv"</span></span> <span class="hljs-string"><span class="hljs-string">"time"</span></span> )</code> </pre> <br><p>  Continuons et affichons les r√©sultats sur la page en modifiant le fichier <code>index.html</code> comme suit.  Ajoutez ceci sous la <code>&lt;header&gt;</code> : </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search-results"</span></span></span><span class="hljs-tag">&gt;</span></span> {{ range .Results.Articles }} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"news-article"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_blank"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"noreferrer noopener"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{.URL}}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span>{{.Title }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ .Description }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"metadata"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"source"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ .Source.Name }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">time</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"published-date"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ .PublishedAt }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">time</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"article-image"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ .URLToImage }}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> {{ end }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Pour acc√©der au champ de structure dans le mod√®le, nous utilisons l'op√©rateur point.  Cet op√©rateur fait r√©f√©rence √† un objet de structure (dans ce cas, la <code>search</code> ), puis √† l'int√©rieur du mod√®le, nous <code>{{.Results}}</code> simplement le nom du champ (comme <code>{{.Results}}</code> ). </p><br><p>  Le bloc de <code>range</code> nous permet d'it√©rer sur une tranche dans Go et de produire du HTML pour chaque √©l√©ment de la tranche.  Ici, nous parcourons la tranche des structures <code>Article</code> contenues dans le champ <code>Articles</code> et affichons le HTML √† chaque it√©ration. </p><br><p>  Red√©marrez le serveur, actualisez le navigateur et recherchez des actualit√©s sur un sujet populaire.  Vous devriez obtenir une liste de 20 r√©sultats par page, comme indiqu√© dans la capture d'√©cran ci-dessous. </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/e5b/129/9ff/e5b1299ffc3a2c0ba892cdf3a2097e73.png" alt="Navigateur visualise les listes de nouvelles"></a> </p><br><h2 id="sohranyaem-poiskovyy-zapros-v-inputehttpsfreshmantechweb-development-with-gopersist-the-search-query-in-the-input">  Enregistrer la requ√™te de recherche en √©tranger </h2><br><p>  Notez que la requ√™te de recherche dispara√Æt de l'entr√©e lorsque la page est actualis√©e avec les r√©sultats.  Id√©alement, la requ√™te doit √™tre conserv√©e jusqu'√† ce que l'utilisateur effectue une nouvelle recherche.  Voici comment fonctionne la recherche Google, par exemple. </p><br><p>  Nous pouvons facilement r√©soudre ce probl√®me en mettant √† jour l'attribut <code>value</code> de la balise d' <code>input</code> dans notre fichier <code>index.html</code> comme suit: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search-input"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ .SearchKey }}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Enter a news topic"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"q"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Red√©marrez votre navigateur et effectuez une nouvelle recherche.  La requ√™te de recherche sera enregistr√©e comme indiqu√© ci-dessous: </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/88c/c3b/44e/88cc3b44e1bdd882aa9dfde1666c32b3.png"></a> </p><br><h2 id="formatiruem-datu-publikaciihttpsfreshmantechweb-development-with-goformat-the-published-date">  Format date de publication </h2><br><p>  Si vous regardez la date dans chaque article, vous verrez qu'elle est mal lisible.  La sortie actuelle montre comment l'API News renvoie la date de publication de l'article.  Mais nous pouvons facilement changer cela en ajoutant une m√©thode √† la structure <code>Article</code> et en l'utilisant pour formater la date au lieu d'utiliser la valeur par d√©faut. </p><br><p>  Ajoutons le code suivant juste en dessous de la structure <code>Article</code> dans <code>main.go</code> : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a *Article)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormatPublishedDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { year, month, day := a.PublishedAt.Date() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fmt.Sprintf(<span class="hljs-string"><span class="hljs-string">"%v %d, %d"</span></span>, month, day, year) }</code> </pre> <br><p>  Ici, une nouvelle m√©thode <code>FormatPublishedDate</code> cr√©√©e dans la structure <code>Article</code> , et cette m√©thode formate le champ <code>PublishedAt</code> dans <code>Article</code> et renvoie une cha√Æne au format suivant: <code>10  2009</code> . </p><br><p>  Pour utiliser cette nouvelle m√©thode dans votre mod√®le, remplacez <code>.PublishedAt</code> par <code>.FormatPublishedDate</code> dans votre fichier <code>index.html</code> .  Red√©marrez ensuite le serveur et r√©p√©tez la requ√™te de recherche pr√©c√©dente.  Cela produira les r√©sultats avec une heure correctement format√©e, comme indiqu√© ci-dessous: </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/444/c8a/92f/444c8a92fbd3ee21d89646c2d5868250.png" alt="Courageux navigateur affich√©s une date correctement format√©e"></a> </p><br><h2 id="vyvodim-obschee-kolichestvo-rezultatovhttpsfreshmantechweb-development-with-goshow-the-total-number-of-results">  Affiche le nombre total de r√©sultats. </h2><br><p>  Am√©liorons l'interface utilisateur de notre application d'actualit√©s en indiquant le nombre total de r√©sultats en haut de la page, puis affichons un message au cas o√π aucun r√©sultat n'aurait √©t√© trouv√© pour une requ√™te particuli√®re. </p><br><p>  Tout ce que vous avez √† faire est d'ajouter le code suivant en tant qu'enfant du <code>.container</code> , juste au-dessus de l'√©l√©ment <code>.search-results</code> dans votre fichier <code>index.html</code> : </p><br><pre> <code class="go hljs">&lt;div class=<span class="hljs-string"><span class="hljs-string">"result-count"</span></span>&gt; {{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gt .Results.TotalResults <span class="hljs-number"><span class="hljs-number">0</span></span>)}} &lt;p&gt;About &lt;strong&gt;{{ .Results.TotalResults }}&lt;/strong&gt; results were found.&lt;/p&gt; {{ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ne .SearchKey <span class="hljs-string"><span class="hljs-string">""</span></span>) and (eq .Results.TotalResults <span class="hljs-number"><span class="hljs-number">0</span></span>) }} &lt;p&gt;No results found <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> your query: &lt;strong&gt;{{ .SearchKey }}&lt;/strong&gt;.&lt;/p&gt; {{ end }} &lt;/div&gt;</code> </pre> <br><p>  Go    ,     .    <code>gt</code> ,  ,   <code>TotalResults</code>  <code>Results</code>  .   ,         . </p><br><p>   ,  <code>SearchKey</code>     ( <code>(ne .SearchKey "")</code> )  <code>TotalResults</code>   ( <code>(eq .Results.TotalResults 0)</code> ),    ¬´No results found¬ª. </p><br><p>         ,        .      ¬´No results found¬ª. </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/305/bfc/407/305bfc40758d20abe8e01c1981930d41.png" alt="Navigateur ne montrant aucun r√©sultat trouv√© message"></a> </p><br><p>             .      ,   : </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/bbb/30a/c8c/bbb30ac8c3adc70ff1195ed3382ce928.png" alt="Navigateur affichant le nombre de r√©sultats en haut de la page"></a> </p><br><h2 id="paginaciyahttpsfreshmantechweb-development-with-gopagination">  </h2><br><p>      20  ,   ,             . </p><br><p>    <strong>Next</strong>  ,       .  ,      ,        <code>Search</code>  <code>main.go</code> : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *Search)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsLastPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s.NextPage &gt;= s.TotalPages }</code> </pre> <br><p>   ,    <code>NextPage</code> ,   <code>TotalPages</code>   <code>Search</code> .   ,    <code>NextPage</code>  ,     .    : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">searchHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//   search.TotalPages = int(math.Ceil(float64(search.Results.TotalResults / pageSize))) //   if  if ok := !search.IsLastPage(); ok { search.NextPage++ } //    }</span></span></code> </pre> <br><p> ,   ,        .       <code>.search-results</code>    <code>index.html</code> . </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination"</span></span></span><span class="hljs-tag">&gt;</span></span> {{ if (ne .IsLastPage true) }} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/search?q={{ .SearchKey }}&amp;page={{ .NextPage }}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button next-page"</span></span></span><span class="hljs-tag">&gt;</span></span>Next<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> {{ end }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>         ,  <strong>Next</strong>       . </p><br><p>  , <code>href</code>     <code>/search</code>        <code>q</code> ,   <code>NextPage</code>   <code>page</code> . </p><br><p>    <strong>Previous</strong> .        ,     1.   ,      <code>CurrentPage()</code>  <code>Search</code> ,   .     <code>IsLastPage</code> : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *Search)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CurrentPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s.NextPage == <span class="hljs-number"><span class="hljs-number">1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s.NextPage } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s.NextPage - <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br><p>    <code>NextPage - 1</code> ,   ,  <code>NextPage</code>  1.    ,   1   .     : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *Search)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreviousPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s.CurrentPage() - <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br><p>  ,         <strong>Previous</strong> ,      1.   <code>.pagination</code>    <code>index.html</code>  : </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination"</span></span></span><span class="hljs-tag">&gt;</span></span> {{ if (gt .NextPage 2) }} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/search?q={{ .SearchKey }}&amp;page={{ .PreviousPage }}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button previous-page"</span></span></span><span class="hljs-tag">&gt;</span></span>Previous<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> {{ end }} {{ if (ne .IsLastPage true) }} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/search?q={{ .SearchKey }}&amp;page={{ .NextPage }}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button next-page"</span></span></span><span class="hljs-tag">&gt;</span></span>Next<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> {{ end }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>        .      ,   : </p><br><br><br><h2 id="pokazyvaem-tekuschuyu-stranicuhttpsfreshmantechweb-development-with-goshow-the-current-page">    </h2><br><p>  ,      ,   ,            ,       . </p><br><p>          <code>index.html</code>  : </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"result-count"</span></span></span><span class="hljs-tag">&gt;</span></span> {{ if (gt .Results.TotalResults 0)}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>About <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>{{ .Results.TotalResults }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> results were found. You are on page <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>{{ .CurrentPage }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> of <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> {{ .TotalPages }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{ else if (ne .SearchKey "") and (eq .Results.TotalResults 0) }} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>No results found for your query: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>{{ .SearchKey }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {{ end }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  ,        ,                 . </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/071/3cd/5a8/0713cd5a870236b1e64309fd24575847.png" alt="Navigateur affichant la page actuelle"></a> </p><br><h2 id="deploim-na-herokuhttpsfreshmantechweb-development-with-godeploy-to-heroku">   Heroku </h2><br><p> ,    ,       Heroku. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   </a> ,     ,    .     .    <strong>freshman-news</strong> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> ,      Heroku   .    <code>heroku login</code>  ,       Heroku. </p><br><p> ,    git-   .  ,   <code>git init</code>     ,     ,   heroku    git-.  <code>freshman-news</code>   . </p><br><pre> <code class="bash hljs">heroku git:remote -a freshman-news</code> </pre> <br><p>   Procfile      ( <code>touch Procfile</code> )    : </p><br><pre> <code class="bash hljs">web: bin/news-demo -apikey <span class="hljs-variable"><span class="hljs-variable">$NEWS_API_KEY</span></span></code> </pre> <br><p>     GitHub      Go,   ,    <code>go.mod</code> ,   .   ,     ,   . </p><br><pre> <code class="go hljs">module github.com/freshman-tech/news-demo <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-number"><span class="hljs-number">1.12</span></span><span class="hljs-number"><span class="hljs-number">.9</span></span></code> </pre> <br><p>       <strong>Settings</strong>    Heroku   <strong>Reveal Config Vars</strong> .      <strong>NEWS_API_KEY</strong> ,           . </p><br><p> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/7e6/ddc/3df/7e6ddc3df666b96b83c892346746f0c3.png" alt="Variables de configuration Heroku"></a> </p><br><p> ,         Heroku    : </p><br><pre> <code class="bash hljs">git add . git commit -m <span class="hljs-string"><span class="hljs-string">"Initial commit"</span></span> git push heroku master</code> </pre> <br><p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://__.herokuapp.com</a> ,      . </p><br><h2 id="zaklyucheniehttpsfreshmantechweb-development-with-gowrap-up">  Conclusion </h2><br><p>        News     Go  -.   ,      Heroku. </p><br><p>  ,       .     -    ,   ,    . </p><br><p>  Merci d'avoir lu! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr475390/">https://habr.com/ru/post/fr475390/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr475370/index.html">Algorithme de Kahan: comment obtenir la diff√©rence exacte des produits</a></li>
<li><a href="../fr475372/index.html">Domaine frontal bas√© sur TLS 1.3</a></li>
<li><a href="../fr475378/index.html">¬´Nous ne pouvons pas laisser le droit aux donn√©es personnelles aux grandes entreprises¬ª - ancien r√©dacteur en chef de Wired UK sur l'avenir de la technologie</a></li>
<li><a href="../fr475384/index.html">Quoi de neuf dans Spring Boot 2.2?</a></li>
<li><a href="../fr475386/index.html">Attention, SAF: comment ne pas enfreindre la loi sur la publicit√©. M√©mo de l'annonceur</a></li>
<li><a href="../fr475392/index.html">Pourquoi utiliser python -m pip</a></li>
<li><a href="../fr475396/index.html">Qu'est-ce que la d√©sactivation des v√©rifications "inutiles" dans la CAO des cartes de circuits imprim√©s</a></li>
<li><a href="../fr475398/index.html">√âv√©nements num√©riques √† Moscou du 11 au 17 novembre</a></li>
<li><a href="../fr475400/index.html">√âv√©nements num√©riques √† Saint-P√©tersbourg du 11 au 17 novembre</a></li>
<li><a href="../fr475404/index.html">Mod√®le BLoC avec un exemple simple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>