<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСФ ЁЯСйЁЯП╝тАНЁЯН│ ЁЯТЕЁЯП╝ рджреЛ рдпрд╛рдХреЛрдЬреБрди рдХреА рд▓рдбрд╝рд╛рдИ, рдпрд╛ рдХреИрд╕рдВрдбреНрд░рд╛ рдмрдирд╛рдо HBaseред Sberbank рдЯреАрдо рдХрд╛ рдЕрдиреБрднрд╡ ЁЯСйтАНЁЯОд ЁЯМжя╕П ЁЯЫТ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдпрд╣ рдордЬрд╛рдХ рднреА рдирд╣реАрдВ рд╣реИ, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╡рд┐рд╢реЗрд╖ рдЪрд┐рддреНрд░ рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рд░ рдХреЛ рд╕рдмрд╕реЗ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдФрд░ рдЕрдВрдд рдореЗрдВ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛрдЧрд╛ рдХрд┐ рдХреНрдпреЛрдВ: 



 DB-Engine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рджреЛ рдпрд╛рдХреЛрдЬреБрди рдХреА рд▓рдбрд╝рд╛рдИ, рдпрд╛ рдХреИрд╕рдВрдбреНрд░рд╛ рдмрдирд╛рдо HBaseред Sberbank рдЯреАрдо рдХрд╛ рдЕрдиреБрднрд╡</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sberbank/blog/484096/">  рдпрд╣ рдордЬрд╛рдХ рднреА рдирд╣реАрдВ рд╣реИ, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╡рд┐рд╢реЗрд╖ рдЪрд┐рддреНрд░ рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рд░ рдХреЛ рд╕рдмрд╕реЗ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдФрд░ рдЕрдВрдд рдореЗрдВ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛрдЧрд╛ рдХрд┐ рдХреНрдпреЛрдВ: <br><br><img src="https://habrastorage.org/webt/i2/lk/zo/i2lkzo9tq7zpeprcbtgm3-mufk4.png"><br><br>  DB-Engines рд░реИрдВрдХрд┐рдВрдЧ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рджреЛ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп NoSQL рд╕реНрддрдВрдн рдЖрдзрд╛рд░ рдХреИрд╕реЗрдВрдбреНрд░рд╛ (рдЗрд╕рдХреЗ рдмрд╛рдж рд╕реАрдПрд╕) рдФрд░ HBase (HB) рд╣реИрдВред <br><br><img src="https://habrastorage.org/webt/su/rd/39/surd39n7bmrbnxgpn0512tnxamm.png"><br><br>  рднрд╛рдЧреНрдп рдХреА рдЗрдЪреНрдЫрд╛ рд╕реЗ, Sberbank рдореЗрдВ рд╣рдорд╛рд░реА рдбреЗрдЯрд╛ рд▓реЛрдбрд┐рдВрдЧ рдкреНрд░рдмрдВрдзрди рдЯреАрдо <a href="https://habr.com/ru/company/sberbank/blog/420425/">рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ</a> HB рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ рдХрд╛рдо <a href="https://habr.com/ru/company/sberbank/blog/420425/">рдХрд░</a> рд░рд╣реА рд╣реИред  рдЗрд╕ рд╕рдордп рдХреЗ рджреМрд░рд╛рди, рд╣рдордиреЗ рдЗрд╕рдХреА рдЦреВрдмрд┐рдпреЛрдВ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ рдФрд░ рдЗрд╕реЗ рдкрдХрд╛рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╕реАрдЦрд╛ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕реАрдПрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд░ рд╕рдордп рдПрдХ рд╡рд┐рдХрд▓реНрдк рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдиреЗ рдореБрдЭреЗ рдЦреБрдж рдХреЛ рд╕рдВрджреЗрд╣ рдХреЗ рд╕рд╛рде рдкреАрдбрд╝рд╛ рджреА: рдХреНрдпрд╛ рд╣рдордиреЗ рд╕рд╣реА рд╡рд┐рдХрд▓реНрдк рдмрдирд╛рдпрд╛?  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдбреЗрдЯрд╛рд╕реНрдЯреИрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП <a href="https://www.datastax.com/products/compare/nosql-performance-benchmarks">рддреБрд▓рдирд╛</a> рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдиреЗ рдХрд╣рд╛ рдХрд┐ рд╕реАрдПрд╕ рдЖрд╕рд╛рдиреА рд╕реЗ рд▓рдЧрднрдЧ рдПрдХ рдкреЗрд░рд╛рдИ рд╕реНрдХреЛрд░ рдХреЗ рд╕рд╛рде рдПрдЪрдмреА рдХреЛ рд╣рд░рд╛ рджреЗрддрд╛ рд╣реИред  рджреВрд╕рд░реА рдУрд░, DataStax рдПрдХ рдЗрдЪреНрдЫреБрдХ рд╡реНрдпрдХреНрддрд┐ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рдпрд╣рд╛рдВ рдПрдХ рд╢рдмреНрдж рднреА рдирд╣реАрдВ рд▓реЗрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкрд░реАрдХреНрд╖рдг рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╣реБрдд рдХрдо рдЬрд╛рдирдХрд╛рд░реА рд╢рд░реНрдордирд╛рдХ рдереА, рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ рдХрд┐ рдмрд┐рдЧрдбрд╛рдЯрд╛ рдиреЛрд╕реНрдХрд▓ рдХрд╛ рд░рд╛рдЬрд╛ рдХреМрди рд╣реИ, рдФрд░ рдкрд░рд┐рдгрд╛рдо рдмрд╣реБрдд рджрд┐рд▓рдЪрд╕реНрдк рдереЗред <br><a name="habracut"></a><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдП рдЧрдП рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдЖрд╡рд╢реНрдпрдХ рдкрд╣рд▓реБрдУрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╕реАрдПрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рд▓реЙрд╕ рдЯреЙрд▓рд░реЗрдВрд╕ рдореЛрдб рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдпрд╛рдиреА  рдпрд╣ рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдХреБрдВрдЬреА рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рд╕рд░реНрд╡рд░ (рдиреЛрдб) рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдпрд╣ рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕ рдХреБрдВрдЬреА рдХрд╛ рдореВрд▓реНрдп рдЦреЛ рдЬрд╛рдПрдЧрд╛ред  рдХрдИ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдмреИрдВрдХрд┐рдВрдЧ рдХреНрд╖реЗрддреНрд░ рдХреЗ рд▓рд┐рдП рдпрд╣ рдирд┐рдпрдо рдХреЗ рдмрдЬрд╛рдп рдЕрдкрд╡рд╛рдж рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдХреА рдХрдИ рдкреНрд░рддрд┐рдпрд╛рдВ рд╣реЛрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред <br><br>  рдЗрд╕рд▓рд┐рдП, рдХреЗрд╡рд▓ рдЯреНрд░рд┐рдкрд▓ рдкреНрд░рддрд┐рдХреГрддрд┐ рдХреЗ рд╕реАрдПрд╕ рдореЛрдб рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЕрд░реНрдерд╛рддреНред  рдорд╛рдорд▓реЗ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> KEYSPACE ks <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLICATION</span></span> = {<span class="hljs-string"><span class="hljs-string">'class'</span></span> : <span class="hljs-string"><span class="hljs-string">'NetworkTopologyStrategy'</span></span>, <span class="hljs-string"><span class="hljs-string">'datacenter1'</span></span> : <span class="hljs-number"><span class="hljs-number">3</span></span>};</code> </pre> <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдирд┐рд░рдВрддрд░рддрд╛ рдХреЗ рдЖрд╡рд╢реНрдпрдХ рд╕реНрддрд░ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВред  рд╕рд╛рдорд╛рдиреНрдп рдирд┐рдпрдо: <br>  NW + NR&gt; RF <br><br>  рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рд▓рд┐рдЦрддреЗ рд╕рдордп рдиреЛрдбреНрд╕ рд╕реЗ рдкреБрд╖реНрдЯрд┐рдХрд░рдг рдХреА рд╕рдВрдЦреНрдпрд╛ (NW) рдкреНрд▓рд╕ рдиреЛрдбреНрд╕ рд╕реЗ рдкреБрд╖реНрдЯрд┐рдХрд░рдг рдХреА рд╕рдВрдЦреНрдпрд╛ рдЬрдм рдкрдврд╝рдирд╛ (рдПрдирдЖрд░) рдкреНрд░рддрд┐рдХреГрддрд┐ рдХрд╛рд░рдХ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, RF = 3 рдФрд░ рдЗрд╕рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдХрд▓реНрдк рдЙрдкрдпреБрдХреНрдд рд╣реИрдВ: <br>  2 + 2&gt; 3 <br>  3 + 1&gt; 3 <br><br>  рдЪреВрдБрдХрд┐ рдбреЗрдЯрд╛ рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдмрдирд╛рдП рд░рдЦрдирд╛ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдореВрд▓рднреВрдд рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдЗрд╕рд▓рд┐рдП 3 + 1 рдпреЛрдЬрдирд╛ рдХреЛ рдЪреБрдирд╛ рдЧрдпрд╛ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдЪрдмреА рдПрдХ рд╕рдорд╛рди рдЖрдзрд╛рд░ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреНред  рдРрд╕реА рддреБрд▓рдирд╛ рдЕрдзрд┐рдХ рдИрдорд╛рдирджрд╛рд░ рд╣реЛрдЧреАред <br><br>  рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдбреЗрдЯрд╛рд╕реНрдЯреИрдХреНрд╕ рдиреЗ рдЕрдкрдиреЗ рд╢реЛрдз рдореЗрдВ рд╡рд┐рдкрд░реАрдд рдХрд┐рдпрд╛, рдЙрдиреНрд╣реЛрдВрдиреЗ рд╕реАрдПрд╕ рдФрд░ рдПрдЪрдмреА (рдПрдЪрдбреАрдПрдлрдПрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдмрджрд▓рдХрд░ рдЙрддреНрддрд░рд╛рд░реНрджреНрдз рдХреЗ рд▓рд┐рдП) рдХреЗ рд▓рд┐рдП рдЖрд░рдПрдл = 1 рд╕реЗрдЯ рдХрд┐рдпрд╛ред  рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╣рд▓реВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕реАрдПрд╕ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдкрд░ рдкреНрд░рднрд╛рд╡ рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдиреАрдЪреЗ рджреА рдЧрдИ рддрд╕реНрд╡реАрд░ рд╕реАрдПрд╕ рдореЗрдВ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдореЗрдВ рд╡реГрджреНрдзрд┐ рджрд░реНрд╢рд╛рддреА рд╣реИ: <br><br><img src="https://habrastorage.org/webt/fw/az/r9/fwazr9muypegpgjpyaq4rnagg8u.png"><br><br>  рдпрд╣рд╛рдВ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЗрдЦрддреЗ рд╣реИрдВ, рдЕрдзрд┐рдХ рдкреНрд░рддрд┐рд╕реНрдкрд░реНрдзреА рдзрд╛рдЧреЗ рдбреЗрдЯрд╛ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдЬрд┐рддрдирд╛ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред  рдпрд╣ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ RF = 3 рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдЧрд┐рд░рд╛рд╡рдЯ рдХрд╛рдлреА рдЕрдзрд┐рдХ рд╣реИред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдпрджрд┐ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ 5 рдзрд╛рд░рд╛рдУрдВ (рдХреБрд▓ 20) рдореЗрдВ 4 рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ RF = 3 рд▓рдЧрднрдЧ 2 рдЧреБрдирд╛ (150 рд╕реЗрдХрдВрдб RF = 3 рдмрдирд╛рдо 75 RF = 1 рдХреЗ рд▓рд┐рдП) рдЦреЛ рджреЗрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╣рдо 5 рдзрд╛рд░рд╛рдУрдВ (рдХреБрд▓ 40) рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ 8 рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдХреЗ рд▓реЛрдб рдмрдврд╝рд╛рддреЗ рд╣реИрдВ, рддреЛ рдЖрд░рдПрдл = 3 рдЦреЛрдирд╛ рдкрд╣рд▓реЗ рд╕реЗ 2.7 рдЧреБрдирд╛ (13875 рдмрдирд╛рдо 375 рд╕реЗрдХрдВрдб) рд╣реИред <br><br>  рд╢рд╛рдпрдж рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдпрд╣ рд╕реАрдПрд╕ рд▓реЛрдб рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рдлрд▓ рдбреЗрдЯрд╛рд╕реНрдЯреИрдХреНрд╕ рдкрд░реАрдХреНрд╖рдг рдХрд╛ рд░рд╣рд╕реНрдп рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реЗ рд╕реНрдЯреИрдВрдб рдкрд░ рдПрдЪрдмреА рдХреЗ рд▓рд┐рдП, рдкреНрд░рддрд┐рдХреГрддрд┐ рдХрд╛рд░рдХ рдХреЛ 2 рд╕реЗ 3 рдореЗрдВ рдмрджрд▓рдиреЗ рдХрд╛ рдХреЛрдИ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдерд╛ред  рдпрд╛рдиреА  рдбрд┐рд╕реНрдХ рд╣рдорд╛рд░реЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рд▓рд┐рдП HB рдХреЗ рд▓рд┐рдП рдЕрдбрд╝рдЪрди рдирд╣реАрдВ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдИ рдЕрдиреНрдп рдиреБрдХрд╕рд╛рди рднреА рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдПрдЪрдмреА рдХрд╛ рд╣рдорд╛рд░рд╛ рд╕рдВрд╕реНрдХрд░рдг рдереЛрдбрд╝рд╛ рдкреИрдЪ рдФрд░ рдЕрд╕реНрдкрд╖реНрдЯ рдерд╛, рд╡рд╛рддрд╛рд╡рд░рдг рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рд╣реИрдВ, рдЖрджрд┐ред  рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рд╢рд╛рдпрдж рдореИрдВ рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рдХрд┐ рд╕реАрдПрд╕ рдХреЛ рдареАрдХ рд╕реЗ рдХреИрд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдХреБрдЫ рдФрд░ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХреЗ рд╣реИрдВ рдФрд░ рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛ред  рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ рдмрд╛рддреЗрдВ рдкрд╣рд▓реЗред <br><br>  рд╕рднреА рдкрд░реАрдХреНрд╖рдг рдПрдХ рд▓реЛрд╣реЗ рдХреЗ рдХреНрд▓рд╕реНрдЯрд░ рдкрд░ рдХрд┐рдП рдЧрдП рдереЗ, рдЬрд┐рд╕рдореЗрдВ 4 рд╕рд░реНрд╡рд░ рдереЗ, рдкреНрд░рддреНрдпреЗрдХ рдПрдХ рд╡рд┐рдиреНрдпрд╛рд╕ рдореЗрдВ: <br><br>  <i>CPU: Xeon E5-2680 v4 @ 2.40GHz 64 рдзрд╛рдЧреЗред</i> <i><br></i>  <i>рдбрд┐рд╕реНрдХ: SATA HDD рдХреЗ 12 рдЯреБрдХрдбрд╝реЗ</i> <i><br></i>  <i>рдЬрд╛рд╡рд╛ рд╕рдВрд╕реНрдХрд░рдг: 1.8.0_111</i> <i><br></i> <br><br>  рд╕реАрдПрд╕ рд╕рдВрд╕реНрдХрд░рдг: 3.11.5 <br><br><div class="spoiler">  <b class="spoiler_title">рдкреИрд░рд╛рдореАрдЯрд░ cassandra.yml</b> <div class="spoiler_text">  num_tokens: 256 <br>  hinted_handoff_enabled: рд╕рдЪ <br>  hinted_handoff_throttle_in_kb: 1024 <br>  max_hints_delivery_threads: 2 <br>  hints_directory: / data10 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рд╕рдВрдХреЗрдд <br>  hints_flush_period_in_ms: 10000 <br>  max_hints_file_size_in_mb: 128 <br>  batchlog_replay_throttle_in_kb: 1024 <br>  рдкреНрд░рдорд╛рдгрдХ: AllowAllAuthenticator <br>  рд▓реЗрдЦрдХ: AllowAllAuthorizer <br>  role_manager: CassandraRoleManager <br>  рд░реЛрд▓реНрд╕_рд╡рд▓рд┐рдбреЗрдЯ_рдЗрди_рдореНрд╕: 2000 <br>  рдЕрдиреБрдорддрд┐рдпрд╛рдБ_рд╡рд╛рдпреБ_рдХрд░рдг_рдореЗрдВ: 2000 <br>  рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓_рд╡реИрд▓реНрдпреВрд╢рди_рдЗрди_рдПрдордПрд╕: 2000 <br>  рдкрд╛рд░реНрдЯреАрд╢рдирд░: org.apache.cassandra.dht.Murmur3Partitioner <br>  data_file_directories: <br>  - # data1 / cassandra / data # рдкреНрд░рддреНрдпреЗрдХ dataN рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдПрдХ рдЕрд▓рдЧ рдбреНрд░рд╛рдЗрд╡ рд╣реИ <br>  - / data2 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  - / рдбреЗрдЯрд╛ 3 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  - / рдбреЗрдЯрд╛ 4 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  - / data5 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  - / рдбреЗрдЯрд╛ 6 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  - / рдбреЗрдЯрд╛ 7 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  - / рдбреЗрдЯрд╛ 8 / рдХреИрд╕реЗрдВрдбреНрд░рд╛ / рдбреЗрдЯрд╛ <br>  рдкреНрд░рддрд┐рдмрджреНрдз / рдЕрдкреНрд░рддреНрдпрдХреНрд╖: / рдбреЗрдЯрд╛ 9 / рдХреИрд╕рдВрдбреНрд░рд╛ / рдХрдорд▓ <br>  cdc_enabled: false <br>  disk_failure_policy: рдмрдВрдж рдХрд░реЛ <br>  рдкреНрд░рддрд┐рдмрджреНрдз_рдлреЗрд▓рд┐рдпрд░_рдкреБрд▓рд┐рд╕: рдмрдВрдж рдХрд░реЛ <br>  prepared_statements_cache_size_mb: <br>  thrift_prepared_statements_cache_size_mb: <br>  key_cache_size_in_mb: <br>  key_cache_save_period: 14400 <br>  row_cache_size_in_mb: 0 <br>  row_cache_save_period: 0 <br>  counter_cache_size_in_mb: <br>  counter_cache_save_period: 7200 <br>  save_caches_directory: / data10 / cassandra / save_caches <br>  рдкреНрд░рддрд┐рдмрджреНрдз: рдЖрд╡рдзрд┐рдХ <br>  рдкреНрд░рддрд┐рдмрджреНрдз: <br>  рдкреНрд░рддрд┐рдмрджреНрдз рдХрд░рдирд╛ <br>  seed_provider: <br>  - class_name: org.apache.cassandra.locator.SimpleSeedProvider <br>  рдкреИрд░рд╛рдореАрдЯрд░: <br>  - рдмреАрдЬ: "*, *" <br>  рд╕рдорд╡рд░реНрддреА_ рд╕реВрддреНрд░: 256 # 64 рдХреА рдХреЛрд╢рд┐рд╢ рдХреА - рдХреЛрдИ рдЕрдВрддрд░ рдирд╣реАрдВ рджреЗрдЦрд╛ <br>  рд╕рдорд╡рд░реНрддреА_рд▓реЗрдЦ: 256 # 64 рдХреА рдХреЛрд╢рд┐рд╢ рдХреА - рдХреЛрдИ рдЕрдВрддрд░ рдирд╣реАрдВ рджреЗрдЦрд╛ <br>  рд╕рдорд╡рд░реНрддреА_рдХрд╛рдЙрдВрдЯрд░_рд▓реЗрдЦ: 256 # 64 рдХреА рдХреЛрд╢рд┐рд╢ рдХреА - рдХреЛрдИ рдЕрдВрддрд░ рдирд╣реАрдВ рджреЗрдЦрд╛ <br>  рд╕рдорд╡рд░реНрддреА_рд╕рд╛рдордЧреНрд░реАрдХреГрдд_рд╡рд┐рд╢реЗрд╖ рд▓реЗрдЦрди: 32 <br>  memtable_heap_space_in_mb: 2048 # 16 рдЬреАрдмреА рдХреА рдХреЛрд╢рд┐рд╢ рдХреА - рдзреАрдореА рдереА <br>  memtable_allocation_type: heap_buffers <br>  index_summary_capacity_in_mb: <br>  index_summary_resize_interval_in_minutes: 60 <br>  trickle_fsync: рдЧрд▓рдд <br>  trickle_fsync_interval_in_kb: 10240 <br>  storage_port: 7000 <br>  ssl_storage_port: 7001 <br>  рд╕реБрди_рджрд╛рджрд░реА: * <br>  рдкреНрд░рд╕рд╛рд░рдг_рдбреНрд░реЗрд╕: тАЛтАЛ* <br>  рд╕реБрди_реЛрди_рдмреНрд░реЛрдбрдХрд╛рд╕реНрдЯ_рдбреНрд░реЗрд╕: тАЛтАЛрд╕рдЪ <br>  internode_authenticator: org.apache.cassandra.auth.AllowAllInternodeAuthenticator <br>  start_native_transport: рд╕рдЪ <br>  native_transport_port: 9042 <br>  start_rpc: рд╕рдЪ рд╣реИ <br>  rpc_address: * <br>  rpc_port: 9160 <br>  rpc_keepalive: рд╕рдЪ рд╣реИ <br>  rpc_server_type: рд╕рд┐рдВрдХ <br>  Thrift_framed_transport_size_in_mb: 15 <br>  incremental_backups: рдЕрд╕рддреНрдп <br>  Snapshot_before_compaction: рдЭреВрдард╛ <br>  auto_snapshot: рд╕рдЪ <br>  column_index_size_in_kb: 64 <br>  column_index_cache_size_in_kb: 2 <br>  рд╕рдорд╡рд░реНрддреА_рдХрд╛рд░рдХ: 4 <br>  compaction_throughput_mb_per_sec: 1600 <br>  sstable_preemptive_open_interval_in_mb: 50 <br>  read_request_timeout_in_ms: 100000 <br>  range_request_timeout_in_ms: 200000 <br>  write_request_timeout_in_ms: 40000 <br>  counter_write_request_timeout_in_ms: 100000 <br>  cas_contention_timeout_in_ms: 20000 <br>  truncate_request_timeout_in_ms: 60000 <br>  request_timeout_in_ms: 200000 <br>  slow_query_log_timeout_in_ms: 500 <br>  cross_node_timeout: рдЧрд▓рдд <br>  endpoint_snitch: GossipingPropertyFileSnitch <br>  рдбрд╛рдпрдирд╛рдорд┐рдХ_рд╕реНрдиреЗрдЪ_рдЕрдкрдбреЗрдЯ_рдПрдВрдЯрд░рд╡рд▓_рдЗрди_рдореНрд╕: 100 <br>  рдбрд╛рдпрдирд╛рдорд┐рдХ_рд╕реНрдиреЗрдЪ_рд░реЗрд╕реЗрдЯ_рдЗрдВрдЯрд░рд╡рд▓_рдЗрди_рдПрдордПрд╕: 600000 <br>  рдбрд╛рдпрдиреЗрдорд┐рдХ_рд╕рд┐рдВрдЪ_рдмреЛрдз_рд╢реНрд░реЗрд╖реНрда: 0.1 <br>  request_scheduler: org.apache.cassandra.scheduler.NoScheduler <br>  server_encryption_options: <br>  internode_enc рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди: рдХреЛрдИ рдирд╣реАрдВ <br>  client_encryption_options: <br>  рд╕рдХреНрд╖рдо: рдЭреВрдард╛ <br>  internode_compression: dc <br>  inter_dc_tcp_nodelay: рдЕрд╕рддреНрдп <br>  tracetype_query_ttl: 86400 <br>  tracetype_repair_ttl: 604800 <br>  enable_user_defined_functions: рдЧрд▓рдд <br>  enable_scripted_user_defined_functions: рдЧрд▓рдд <br>  windows_timer_interval: 1 <br>  transparent_data_encryption_options: <br>  рд╕рдХреНрд╖рдо: рдЭреВрдард╛ <br>  tombstone_warn_threshold: 1000 <br>  tombstone_failure_threshold: 100000 <br>  batch_size_warn_threshold_in_kb: 200 <br>  рдмреИрдЪ_рд╕рд╛рдЗрдЬ_рдлреЗрд▓_рдереНрд░реЗрд╢рд▓реНрдб_in_kb: 250 <br>  unlogged_batch_across_partitions_warn_threshold: 10 <br>  compaction_large_partition_warning_threshold_mb: 100 <br>  gc_warn_threshold_in_ms: 1000 <br>  back_pressure_enabled: рдорд┐рдереНрдпрд╛ <br>  enable_materialized_ рд╕рд╛рдХреНрд╖рд╛рддреНрдХрд╛рд░: рд╕рддреНрдп <br>  enable_sasi_indexes: рд╕рддреНрдп <br></div></div><br>  рдЬреАрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕: <br><br><div class="spoiler">  <b class="spoiler_title">### рд╕реАрдПрдордПрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕</b> <div class="spoiler_text">  -XX: + UseParNewGC <br>  -XX: + UseConcMarkSweepGC <br>  -XX: + CMSParallelR рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рдиEnabled <br>  -XX: рдЙрддреНрддрд░рдЬреАрд╡реА рдЕрдиреБрдкрд╛рдд = 8 <br>  -рдПрдХреНрд╕рдПрдХреНрд╕: рдореИрдХреНрд╕рдЯреЗрдиреНрдпреЛрд░рдЯреНрд░реЗрд╢реЛрд▓реНрдб = 1 <br>  -XX: CMSInitiatingOccupancyFraction = 75 <br>  -XX: + UseCMSInitiatingOccupancyOnly <br>  -XX: CMSWaitDuration = 10000 <br>  -XX: + CMSParallelInitialMarkEnabled <br>  -XX: + CMSEdenChunksRecordAlways <br>  -XX: + CMSClassUnloadingEnabled <br><br></div></div><br>  рдореЗрдореЛрд░реА jvm.options рдХреЛ 16Gb рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдлрд┐рд░ рднреА 32 рдЬреАрдмреА рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЧрдИ, рдХреЛрдИ рдЕрдВрддрд░ рдирд╣реАрдВ рджреЗрдЦрд╛ рдЧрдпрд╛)ред <br><br>  рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдирд╛ рдХрдорд╛рдВрдб рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> ks.t1 (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>, title <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> compression = {<span class="hljs-string"><span class="hljs-string">'sstable_compression'</span></span>: <span class="hljs-string"><span class="hljs-string">'LZ4Compressor'</span></span>, <span class="hljs-string"><span class="hljs-string">'chunk_length_kb'</span></span>: <span class="hljs-number"><span class="hljs-number">64</span></span>};</code> </pre> <br>  рдПрдЪрдмреА рд╕рдВрд╕реНрдХрд░рдг: 1.2.0-cdh5.14.2 (рд╡рд░реНрдЧ рдореЗрдВ org.apache.hadoop.hbase.regionserver.Hegion рд╣рдордиреЗ MetricsRegion рдХреЛ рдмрд╛рд╣рд░ рдХрд░ рджрд┐рдпрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдЪрд▓рддреЗ рдЬреАрд╕реА рдХреЗ рд╕рд╛рде рд░реАрдЬрдирд░ рдХреЗ 1000 рд╕реЗ рдЕрдзрд┐рдХ рдХреНрд╖реЗрддреНрд░ рд╣реЛ рдЧрдП) <br><br><div class="spoiler">  <b class="spoiler_title">рдЧреИрд░-рдбрд┐рдлрд╝реЙрд▓реНрдЯ HBase рд╡рд┐рдХрд▓реНрдк</b> <div class="spoiler_text">  zookeeper.session.timeout: 120000 <br>  hbase.rpc.timeout: 2 рдорд┐рдирдЯ <br>  hbase.client.scanner.timeout.period: 2 рдорд┐рдирдЯ <br>  hbase.master.handler.count: 10 <br>  hbase.regionserver.lease.period, hbase.client.scanner.timeout.period: 2 рдорд┐рдирдЯ <br>  hbase.regionserver.handler.count: 160 <br>  hbase.regionserver.metahandler.count: 30 <br>  hbase.regionserver.logroll.period: 4 рдШрдВрдЯреЗ (s) <br>  hbase.regionserver.maxlogs: 200 <br>  hbase.hregion.memstore.flush.size: 1 GiB <br>  hbase.hregion.memstore.block.multiplier: 6 <br>  hbase.hstore.compactionThreshold: 5 <br>  hbase.hstore.blockingStoreFiles: 200 <br>  hbase.hregion.majorcompaction: 1 рджрд┐рди <br>  HBase рд╕реЗрд╡рд╛ рдЙрдиреНрдирдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реНрдирд┐рдкреЗрдЯ (рд╕реБрд░рдХреНрд╖рд╛ рд╡рд╛рд▓реНрд╡) hbase-site.xml рдХреЗ рд▓рд┐рдП: <br>  hbase.regionserver.wal.codecorg.apache.hadoop.hbase.regionserver.wal.IndexedWALEditCodec <br>  hbase.master.namespace.init.timeout3600000 <br>  hbase.regionserver.optionalcacheflushinterval18000000 <br>  hbase.regionserver.thread.compaction.large12 <br>  hbase.regionserver.wal.enablecompressiontrue <br>  hbase.hstore.compaction.max.size1073741824 <br>  hbase.server.compactchecker.interval.multiplier200 <br>  HBase RegionServer рдХреЗ рд▓рд┐рдП рдЬрд╛рд╡рд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рд╡рд┐рдХрд▓реНрдк: <br>  -XX: + UseParNewGC -XX: + UseConcMarkSweepGC -XX: CMSInitiatingOccupancyFraction = 70 -XX: + CMSParallelRemarkEnabled -XX: рдЖрд░рдХреНрд╖рд┐рдд рдХреЛрдбрдХреЛрдб = 256m <br>  hbase.snapshot.master.timeoutMillis: 2 рдорд┐рдирдЯ <br>  hbase.snapshot.region.timeout: 2 рдорд┐рдирдЯ <br>  hbase.snapshot.master.timeout.millis: 2 рдорд┐рдирдЯ <br>  HBase REST рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХрддрдо рд▓реЙрдЧ рдЖрдХрд╛рд░: 100 MiB <br>  HBase REST рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХрддрдо рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдмреИрдХрдЕрдк: 5 <br>  HBase рдереНрд░рд┐рдлреНрдЯ рд╕рд░реНрд╡рд░ рдореИрдХреНрд╕ рд▓реЙрдЧ рд╕рд╛рдЗрдЬ: 100 MiB <br>  HBase рдереНрд░рд┐рдлрд╝реНрдЯ рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХрддрдо рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдмреИрдХрдЕрдк: 5 <br>  рдорд╛рд╕реНрдЯрд░ рдореИрдХреНрд╕ рд▓реЙрдЧ рд╕рд╛рдЗрдЬ: 100 MiB <br>  рдорд╛рд╕реНрдЯрд░ рдЕрдзрд┐рдХрддрдо рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдмреИрдХрдЕрдк: 5 <br>  рдХреНрд╖реЗрддреНрд░рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХрддрдо рд▓реЙрдЧ рдЖрдХрд╛рд░: 100 MiB <br>  рдХреНрд╖реЗрддреНрд░рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХрддрдо рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдмреИрдХрдЕрдк: 5 <br>  HBase рд╕рдХреНрд░рд┐рдп рдорд╛рд╕реНрдЯрд░ рдбрд┐рдЯреЗрдХреНрд╢рди рд╡рд┐рдВрдбреЛ: 4 рдорд┐рдирдЯ <br>  dfs.client.hedged.read.threadpool.size: 40 <br>  dfs.client.hedged.read.threshold.millis: 10 рдорд┐рд▓реАрд╕реЗрдХрдВрдб (s) <br>  hbase.rest.threads.min: 8 <br>  hbase.rest.threads.max: 150 <br>  рдЕрдзрд┐рдХрддрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдлрд╝рд╛рдЗрд▓ рд╡рд┐рд╡рд░рдг: 180,000 <br>  hbase.thrift.minWorkerThreads: 200 <br>  hbase.master.executor.openregion.threads: 30 <br>  hbase.master.executor.closeregion.threads: 30 <br>  hbase.master.executor.serverops.threads: 60 <br>  hbase.regionserver.thread.compaction.small: 6 <br>  hbase.ipc.server.read.threadpool.size: 20 <br>  рдХреНрд╖реЗрддреНрд░ рдореВрд╡рд░ рд╕реВрддреНрд░: 6 <br>  рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рдХреНрд▓рд╛рдЗрдВрдЯ рдЬрд╛рд╡рд╛ рд╣реАрдк рд╕рд╛рдЗрдЬрд╝: 1 GiB <br>  HBase REST рд╕рд░реНрд╡рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдореВрд╣: 3 GiB <br>  HBase рдереНрд░рд┐рдлреНрдЯ рд╕рд░реНрд╡рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдореВрд╣: 3 GiB <br>  рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ HBase рдорд╛рд╕реНрдЯрд░ рдХрд╛ рдЬрд╛рд╡рд╛ рд╣реАрдк рдЖрдХрд╛рд░: 16 GiB <br>  рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ HBase рд░реАрдЬрдирд▓ рд╕реЗрд╡рд░ рдХрд╛ рдЬрд╛рд╡рд╛ рд╣реАрдк рд╕рд╛рдЗрдЬ: 32 GiB <br><br>  + рдЪрд┐рдбрд╝рд┐рдпрд╛рдШрд░ рдХреАрдкрд░ <br>  maxClientCnxns: 601 <br>  maxSessionTimeout: 120000 </div></div><br>  рддрд╛рд▓рд┐рдХрд╛рдПрдБ рдмрдирд╛рдирд╛: <br>  <i>hbase org.apache.hadoop.hbase.util.RegionSplitter ns: t1 рдпреВрдирд┐рдлрд╝реЙрд░реНрдордкреНрд▓реЗрдЯ -c 64 -f cf</i> <i><br></i>  <i>рдкрд░рд┐рд╡рд░реНрддрди 'ns: t1', {NAME =&gt; 'cf', DATA_BLOCK_ENCODING =&gt; 'FAST_DIFF', COMPRESSION =&gt; 'GZ'}</i> <br><br>  рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рд╣реИ - DataStax рд╡рд┐рд╡рд░рдг рдпрд╣ рдирд╣реАрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдПрдЪрдмреА рдЯреЗрдмрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреЗ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдмрдбрд╝реЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЗ рд▓рд┐рдП, рд╕рдВрдЦреНрдпрд╛ = 64 рдХреЛ рдЪреБрдирд╛ рдЧрдпрд╛, рдЬреЛ 640 рдЬреАрдмреА рддрдХ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддред  рдордзреНрдпрдо рдЖрдХрд╛рд░ рдХреА рдореЗрдЬред <br><br>  рдкрд░реАрдХреНрд╖рдг рдХреЗ рд╕рдордп, HBase рдореЗрдВ 22 рд╣рдЬрд╛рд░ рдЯреЗрдмрд▓ рдФрд░ 67 рд╣рдЬрд╛рд░ рдХреНрд╖реЗрддреНрд░ рдереЗ (рдпрд╣ рд╕рдВрд╕реНрдХрд░рдг 1.2.0 рдХреЗ рд▓рд┐рдП рдШрд╛рддрдХ рд╣реЛрдЧрд╛, рдпрджрд┐ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдкреИрдЪ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реИ)ред <br><br>  рдЕрдм рдХреЛрдб рдХреЗ рд▓рд┐рдПред  рдЪреВрдВрдХрд┐ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рдерд╛ рдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдХреМрди рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЕрдзрд┐рдХ рдлрд╛рдпрджреЗрдордВрдж рд╣реИрдВ, рдкрд░реАрдХреНрд╖рдг рд╡рд┐рднрд┐рдиреНрди рд╕рдВрдпреЛрдЬрдиреЛрдВ рдореЗрдВ рдХрд┐рдП рдЧрдП рдереЗред  рдпрд╛рдиреА  рдХреБрдЫ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ, рд▓реЛрдб рдПрдХ рд╕рд╛рде 4 рдЯреЗрдмрд▓ рдкрд░ рдЪрд▓рд╛ рдЧрдпрд╛ (рд╕рднреА 4 рдиреЛрдбреНрд╕ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдереЗ)ред  рдЕрдиреНрдп рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ, рдЙрдиреНрд╣реЛрдВрдиреЗ 8 рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд┐рдпрд╛ред  рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ 100 рдерд╛, рджреВрд╕рд░реЛрдВ рдореЗрдВ 200 (рдмреИрдЪ рдкреИрд░рд╛рдореАрдЯрд░ - рдиреАрдЪреЗ рдХреЛрдб рджреЗрдЦреЗрдВ)ред  рдорд╛рди рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░ 10 рдмрд╛рдЗрдЯреНрд╕ рдпрд╛ 100 рдмрд╛рдЗрдЯреНрд╕ (рдбреЗрдЯрд╛рд╕рд╛рдЗрдЬрд╝) рд╣реИред  рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░, рдкреНрд░рддреНрдпреЗрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╣рд░ рдмрд╛рд░ 5 рдорд┐рд▓рд┐рдпрди рд░рд┐рдХреЙрд░реНрдб рд▓рд┐рдЦреЗ рдФрд░ рдШрдЯрд╛рдП рдЧрдПред  рдЙрд╕реА рд╕рдордп, рдкреНрд░рддреНрдпреЗрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ 5 рдзрд╛рд░рд╛рдПрдБ рд▓рд┐рдЦреА рдЧрдИрдВ / рдкрдврд╝реА рдЧрдИрдВ (рд╕реНрдЯреНрд░реАрдо рдирдВрдмрд░ thNum рд╣реИ), рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЗ рдЕрдкрдиреА рд╕реНрд╡рдпрдВ рдХреА рдХреБрдВрдЬреА рд╕реАрдорд╛ (рдЧрдгрдирд╛ = 1 рдорд┐рд▓рд┐рдпрди) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (opType.equals(<span class="hljs-string"><span class="hljs-string">"insert"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long key = count * thNum; key &lt; count * (thNum + <span class="hljs-number"><span class="hljs-number">1</span></span>); key += <span class="hljs-number"><span class="hljs-number">0</span></span>) { StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"BEGIN BATCH "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; batch; i++) { String value = RandomStringUtils.random(dataSize, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); sb.append(<span class="hljs-string"><span class="hljs-string">"INSERT INTO "</span></span>) .append(tableName) .append(<span class="hljs-string"><span class="hljs-string">"(id, title) "</span></span>) .append(<span class="hljs-string"><span class="hljs-string">"VALUES ("</span></span>) .append(key) .append(<span class="hljs-string"><span class="hljs-string">", '"</span></span>) .append(value) .append(<span class="hljs-string"><span class="hljs-string">"');"</span></span>); key++; } sb.append(<span class="hljs-string"><span class="hljs-string">"APPLY BATCH;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String query = sb.toString(); session.execute(query); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long key = count * thNum; key &lt; count * (thNum + <span class="hljs-number"><span class="hljs-number">1</span></span>); key += <span class="hljs-number"><span class="hljs-number">0</span></span>) { StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"SELECT * FROM "</span></span>).append(tableName).append(<span class="hljs-string"><span class="hljs-string">" WHERE id IN ("</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; batch; i++) { sb = sb.append(key); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i+<span class="hljs-number"><span class="hljs-number">1</span></span> &lt; batch) sb.append(<span class="hljs-string"><span class="hljs-string">","</span></span>); key++; } sb = sb.append(<span class="hljs-string"><span class="hljs-string">");"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String query = sb.toString(); ResultSet rs = session.execute(query); } }</code> </pre><br>  рддрджрдиреБрд╕рд╛рд░, рдПрдЪрдмреА рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдорд╛рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдереА: <br><br><pre> <code class="java hljs">Configuration conf = getConf(); HTable table = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HTable(conf, keyspace + <span class="hljs-string"><span class="hljs-string">":"</span></span> + tableName); table.setAutoFlush(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); List&lt;Get&gt; lGet = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); List&lt;Put&gt; lPut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] cf = Bytes.toBytes(<span class="hljs-string"><span class="hljs-string">"cf"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] qf = Bytes.toBytes(<span class="hljs-string"><span class="hljs-string">"value"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (opType.equals(<span class="hljs-string"><span class="hljs-string">"insert"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long key = count * thNum; key &lt; count * (thNum + <span class="hljs-number"><span class="hljs-number">1</span></span>); key += <span class="hljs-number"><span class="hljs-number">0</span></span>) { lPut.clear(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; batch; i++) { Put p = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Put(makeHbaseRowKey(key)); String value = RandomStringUtils.random(dataSize, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); p.addColumn(cf, qf, value.getBytes()); lPut.add(p); key++; } table.put(lPut); table.flushCommits(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long key = count * thNum; key &lt; count * (thNum + <span class="hljs-number"><span class="hljs-number">1</span></span>); key += <span class="hljs-number"><span class="hljs-number">0</span></span>) { lGet.clear(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; batch; i++) { Get g = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Get(makeHbaseRowKey(key)); lGet.add(g); key++; } Result[] rs = table.get(lGet); } }</code> </pre><br>  рдЪреВрдБрдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ HB рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рд╕рдорд╛рди рд╡рд┐рддрд░рдг рдХрд╛ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рд▓рд╛рдореА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рджреЗрдЦрд╛ рдЧрдпрд╛: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] makeHbaseRowKey(<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> key) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] nonSaltedRowKey = Bytes.toBytes(key); CRC32 crc32 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CRC32(); crc32.update(nonSaltedRowKey); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> crc32Value = crc32.getValue(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] salt = Arrays.copyOfRange(Bytes.toBytes(crc32Value), <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ArrayUtils.addAll(salt, nonSaltedRowKey); }</code> </pre><br>  рдЕрдм рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдкрд░рд┐рдгрд╛рдо рд╣реИрдВ: <br><br><img src="https://habrastorage.org/webt/id/yd/pc/idydpc9plsmulsycf0i-wqy3c3c.png"><br><br>  рдЧреНрд░рд╛рдлрд╝ рдХреЗ рд╕рдорд╛рди: <br><br><img src="https://habrastorage.org/webt/72/ag/o1/72ago1u2gdnlufjanqwavk5p1jk.png"><br><br>  рдПрдЪрдмреА рдХрд╛ рд▓рд╛рдн рдЗрддрдирд╛ рдЕрджреНрднреБрдд рд╣реИ рдХрд┐ рд╕реАрдПрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХреА рдЕрдбрд╝рдЪрди рдХрд╛ рд╕рдВрджреЗрд╣ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рдмрд╕реЗ рд╕реНрдкрд╖реНрдЯ рдорд╛рдкрджрдВрдбреЛрдВ (рдЬреИрд╕реЗ рд╕рдорд╡рд░реНрддреА_рд▓реЗрдЦреЛрдВ рдпрд╛ memtable_heap_space_in_mb) рдХреЗ googling рдФрд░ рдорд░реЛрдбрд╝ рдиреЗ рддреНрд╡рд░рдг рдирд╣реАрдВ рджрд┐рдпрд╛ред  рдЙрд╕реА рд╕рдордп, рд▓реЙрдЧ рд╕рд╛рдл рд╣реЛрддреЗ рд╣реИрдВ, рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреА рдХрд╕рдо рдирд╣реАрдВ рдЦрд╛рддреЗ рд╣реИрдВред <br><br>  рдбреЗрдЯрд╛ рдиреЛрдбреНрд╕ рдореЗрдВ рд╕рдорд╛рди рд░реВрдк рд╕реЗ рд▓реЗрдЯрд╛ рд╣реЛрддрд╛ рд╣реИ, рд╕рднреА рдиреЛрдбреНрд╕ рдХреЗ рдЖрдВрдХрдбрд╝реЗ рд▓рдЧрднрдЧ рд╕рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рдпрд╣рд╛рдБ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдиреЛрдб рдХреЗ рд╕рд╛рде рдЖрдБрдХрдбрд╝реЗ рд╣реИрдВ</b> <div class="spoiler_text">  рдХреАрд╕реНрдкреЗрд╕: ks <br>  рдкрдврд╝реЗрдВ рдЧрдгрдирд╛: 9383707 <br>  рдкрдврд╝реЗрдВ рд╡рд┐рд▓рдВрдмрддрд╛: 0.04287025042448576 рдПрдордПрд╕ <br>  рд▓рд┐рдЦреЗрдВ рдЧрдгрдирд╛: 15462012 <br>  рд▓реЗрдЯреЗрдВрд╕реА рд▓рд┐рдЦреЗрдВ: 0.1350068438699957 рдПрдордПрд╕ <br>  рд▓рдВрдмрд┐рдд рдлреНрд▓рд╢: 0 <br>  рддрд╛рд▓рд┐рдХрд╛: t1 <br>  SSTable рдЧрдгрдирд╛: 16 <br>  рдЕрдВрддрд░рд┐рдХреНрд╖ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ (рд▓рд╛рдЗрд╡): 148.59 MiB <br>  рдЕрдВрддрд░рд┐рдХреНрд╖ рдХрд╛ рдЙрдкрдпреЛрдЧ (рдХреБрд▓): 148.59 MiB <br>  рд╕реНрдиреИрдкрд╢реЙрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╕реНрдерд╛рди (рдХреБрд▓): 0 рдмрд╛рдЗрдЯреНрд╕ <br>  рдмрдВрдж рдвреЗрд░ рд╕реНрдореГрддрд┐ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ (рдХреБрд▓): 5.17 MiB <br>  SSTable рд╕рдВрдкреАрдбрд╝рди рдЕрдиреБрдкрд╛рдд: 0.5720989576459437 <br>  рд╡рд┐рднрд╛рдЬрди рдХреА рд╕рдВрдЦреНрдпрд╛ (рдЕрдиреБрдорд╛рди): 3970323 <br>  рдпрд╛рджрдЧрд╛рд░ рд╕реЗрд▓ рдЧрдгрдирд╛: 0 <br>  рдпрд╛рджрдЧрд╛рд░ рдбреЗрдЯрд╛ рдХрд╛ рдЖрдХрд╛рд░: 0 рдмрд╛рдЗрдЯреНрд╕ <br>  рдореЗрдорд░реА рдСрдл рд╣реАрдк рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: 0 рдмрд╛рдЗрдЯреНрд╕ <br>  рдпрд╛рджрдЧрд╛рд░ рд╕реНрд╡рд┐рдЪ рдЧрдгрдирд╛: 5 <br>  рд╕реНрдерд╛рдиреАрдп рд░реАрдб рдХрд╛рдЙрдВрдЯ: 2346045 <br>  рд╕реНрдерд╛рдиреАрдп рд░реАрдб рд▓реЗрдЯреЗрдВрд╕реА: NaN ms <br>  рд╕реНрдерд╛рдиреАрдп рд▓реЗрдЦрди рдЧрдгрдирд╛: 3865503 <br>  рд╕реНрдерд╛рдиреАрдп рд▓реЗрдЦрди рд╡рд┐рд▓рдВрдмрддрд╛: NaN рдПрдордПрд╕ <br>  рд▓рдВрдмрд┐рдд рдлреНрд▓рд╢: 0 <br>  рдкреНрд░рддрд┐рд╢рдд рдХреА рдорд░рдореНрдордд: 0.0 <br>  рдмреНрд▓реВрдо рдлрд╝рд┐рд▓реНрдЯрд░ рдЭреВрдареА рд╕рдХрд╛рд░рд╛рддреНрдордХ: 25 <br>  рдмреНрд▓реВрдо рдлрд╝рд┐рд▓реНрдЯрд░ рдЭреВрдареА рдЕрдиреБрдкрд╛рдд: 0.00000 <br>  рдмреНрд▓реВрдо рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реНрдерд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ: 4.57 MiB <br>  рдмреНрд▓реВрдо рдлрд╝рд┐рд▓реНрдЯрд░ рдСрдл рд╣реАрдк рдореЗрдореЛрд░реА рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛: 4.57 MiB <br>  рдЗрдВрдбреЗрдХреНрд╕ рд╕рд╛рд░рд╛рдВрд╢ рдСрдл рд╣реАрдк рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛: 590.02 KiB <br>  рд╕рдВрдкреАрдбрд╝рди рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдмрдВрдж рдвреЗрд░ рд╕реНрдореГрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛: 19.45 KiB <br>  рд╕рдВрдХреБрдЪрд┐рдд рдмрд╛рдЗрдЯреНрд╕ рдиреНрдпреВрдирддрдо: 36 <br>  рдЕрдзрд┐рдХрддрдо рд╡рд┐рднрд╛рдЬрди рдмрд╛рдЗрдЯреНрд╕: 42 <br>  рд╕рдВрдХреБрдЪрд┐рдд рд╡рд┐рднрд╛рдЬрди рдХрд╛ рдЕрд░реНрде рдмрд╛рдЗрдЯреНрд╕ рд╣реЛрддрд╛ рд╣реИ: 42 <br>  рдФрд╕рдд рд▓рд╛рдЗрд╡ рд╕реЗрд▓ рдкреНрд░рддрд┐ рдЯреБрдХрдбрд╝рд╛ (рдЕрдВрддрд┐рдо рдкрд╛рдВрдЪ рдорд┐рдирдЯ): NaN <br>  рдкреНрд░рддрд┐ рдЯреБрдХрдбрд╝рд╛ рдЕрдзрд┐рдХрддрдо рдЬреАрд╡рд┐рдд рдХреЛрд╢рд┐рдХрд╛рдПрдВ (рдЕрдВрддрд┐рдо рдкрд╛рдВрдЪ рдорд┐рдирдЯ): 0 <br>  рдФрд╕рдд рдЯреБрдХрдбрд╝рд╛ рдкреНрд░рддрд┐ рдЯреБрдХрдбрд╝рд╛ (рдЕрдВрддрд┐рдо рдкрд╛рдБрдЪ рдорд┐рдирдЯ): NaN <br>  рдЕрдзрд┐рдХрддрдо рдЯреБрдХрдбрд╝рд╛ рдкреНрд░рддрд┐ рдЯреБрдХрдбрд╝рд╛ (рдЕрдВрддрд┐рдо рдкрд╛рдБрдЪ рдорд┐рдирдЯ): 0 <br>  рдЧрд┐рд░рд╛ рд╣реБрдЖ рдореНрдпреВрдЯреЗрд╢рди: 0 рдмрд╛рдЗрдЯреНрд╕ <br></div></div><br>  рдмреИрдЪ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ (рдПрдХ-рдПрдХ рдХрд░рдХреЗ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП) рдХрд╛ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдерд╛, рдпрд╣ рдХреЗрд╡рд▓ рдЦрд░рд╛рдм рд╣реЛ рдЧрдпрд╛ред  рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣ рд╕реАрдПрд╕ рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рдкреНрд░рджрд░реНрд╢рди рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕реАрдПрд╕ рдкрд░ рдкреНрд░рд╛рдкреНрдд рдкрд░рд┐рдгрд╛рдо рдбреЗрдЯрд╛рдЯреЗрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЧрдП рд╕рдорд╛рди рд╣реИрдВ - рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рд╕реИрдХрдбрд╝реЛрдВ рд╣рдЬрд╛рд░реЛрдВ рдСрдкрд░реЗрд╢рдиред  рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдЖрдк рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ CS рдЕрдзрд┐рдХ CPU рдФрд░ рдбрд┐рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/us/fo/i4/usfoi4-mgkktzlosilmz2ogm7uu.png"><br>  <i>рдЖрдВрдХрдбрд╝рд╛ рджреЛрдиреЛрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрдВрдХреНрддрд┐ рдореЗрдВ рд╕рднреА рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред</i> <br><br>  рдПрдЪрдмреА рдХреЗ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдкрдврд╝рдиреЗ рдХреЗ рд▓рд╛рднреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред  рдпрд╣ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рджреЛрдиреЛрдВ рдбреЗрдЯрд╛рдмреЗрд╕реЛрдВ рдХреЗ рд▓рд┐рдП, рдкрдврд╝рдиреЗ рдХреЗ рджреМрд░рд╛рди рдбрд┐рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмреЗрд╣рдж рдХрдо рд╣реИ (рдкреНрд░рддреНрдпреЗрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдЪрдХреНрд░ рдкрд░реАрдХреНрд╖рдг рдЪрдХреНрд░ рдХрд╛ рдЕрдВрддрд┐рдо рднрд╛рдЧ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕реАрдПрд╕ рдХреЗ рд▓рд┐рдП 15:20 рд╕реЗ 15:40 рддрдХ)ред  рдПрдЪрдмреА рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХрд╛рд░рдг рд╕реНрдкрд╖реНрдЯ рд╣реИ - рдЕрдзрд┐рдХрд╛рдВрд╢ рдбреЗрдЯрд╛ рдореЗрдореЛрд░реА рдореЗрдВ, рдореЗрдорд╕реНрдЯреЛрд░ рдореЗрдВ, рдФрд░ рдХреБрдЫ рдмреНрд▓реЙрдХрдЪреИрдЪ рдореЗрдВ рдХреИрд╢реНрдб рдереЗред  CS рдХреЗ рд▓рд┐рдП, рдпрд╣ рдмрд╣реБрдд рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдбрд┐рд╕реНрдХ рдЙрдкрдпреЛрдЧ рднреА рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рд┐рд░реНрдл рдорд╛рдорд▓реЗ рдореЗрдВ, рдкрдВрдХреНрддрд┐_cache_size_in_mb = 2048 рдХреИрд╢ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдФрд░ рдХреИрд╢рд┐рдВрдЧ рд╕реЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ = 'рдХреБрдВрдЬрд┐рдпрд╛рдБ': 'ALL', 'row_per_partition': '' 2,000,000 '}, рд▓реЗрдХрд┐рди рдЗрд╕рдиреЗ рдЗрд╕реЗ рдФрд░ рднреА рдмрджрддрд░ рдмрдирд╛ рджрд┐рдпрд╛ред <br><br>  рдПрдЪрдмреА рдореЗрдВ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рдХрд╣рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рд▓рд╛рдпрдХ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореВрд▓реНрдп 64 рдХреЛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдХрдо рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЙрджрд╛рд╣рд░рдг 4 рдХреЗ рдмрд░рд╛рдмрд░ рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ рдЬрдм рдЧрддрд┐ 2 рдмрд╛рд░ рдкрдврд╝рддреА рд╣реИред  рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдореЗрдорд╕реНрдЯреЛрд░ рддреЗрдЬреА рд╕реЗ рдмрдВрдж рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдлрд╛рдЗрд▓реЗрдВ рдЕрдзрд┐рдХ рдмрд╛рд░ рдлреНрд▓рд╢ рд╣реЛрдВрдЧреА рдФрд░ рдЗрд╕реЗ рдкрдврд╝рддреЗ рд╕рдордп рдЕрдзрд┐рдХ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЬреЛ рдПрдЪрдмреА рдХреЗ рд▓рд┐рдП рдПрдХ рдЬрдЯрд┐рд▓ рдСрдкрд░реЗрд╢рди рд╣реИред  рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ, рдпрд╣ рдкреНрд░реАрдкреНрд▓реЗрдЯрд┐рдВрдЧ рдФрд░ рдХреЙрдореНрдкреИрдХреНрдЯрд┐рдлрд╝рд┐рдХреЗрд╢рди рдХреА рд░рдгрдиреАрддрд┐ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдХреЗ рдЗрд▓рд╛рдЬ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╣рдо рдПрдХ рд╕реНрд╡-рдирд┐рд░реНрдорд┐рдд рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдХрдЪрд░реЗ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреГрд╖реНрдарднреВрдорд┐ рдореЗрдВ рд▓рдЧрд╛рддрд╛рд░ HFiles рдХреЛ рд╕рдВрдХреБрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛рд╕реНрдЯреИрдХреНрд╕ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХреЗ рд▓рд┐рдП, рдЖрдо рддреМрд░ рдкрд░ 1 рдХреНрд╖реЗрддреНрд░ рдкреНрд░рддрд┐ рддрд╛рд▓рд┐рдХрд╛ (рдЬреЛ рд╕рд╣реА рдирд╣реАрдВ рд╣реИ) рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдХреБрдЫ рд╣рдж рддрдХ рд╕реНрдкрд╖реНрдЯ рдХрд░реЗрдЧрд╛ рдХрд┐ рдПрдЪрдмреА рдЕрдкрдиреЗ рд░реАрдб рдЯреЗрд╕реНрдЯ рдореЗрдВ рдЗрддрдирд╛ рдХреНрдпреЛрдВ рдЦреЛ рдЧрдпрд╛ред <br><br>  рдЗрд╕ рд╕реЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИрдВред  рдпрд╣ рдорд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рд╕рдХрд▓ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдирд╣реАрдВ рд╣реБрдИ рдереАрдВ, рдХреИрд╕рдВрдбреНрд░рд╛ рдорд┐рдЯреНрдЯреА рдХреЗ рдкреИрд░реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдХреЛрд▓реЛрд╕рд╕ рдХреА рддрд░рд╣ рд╣реИред  рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рдЬрдмрдХрд┐ рд╡рд╣ рдПрдХ рдкреИрд░ рдкрд░ рд╕рдВрддреБрд▓рди рдмрдирд╛ рд░рд╣реА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЪрд┐рддреНрд░ рдореЗрдВ рд╣реИ, рд╡рд╣ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЕрдЪреНрдЫреЗ рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЬрдм рд╡рд╣ рд╕рдорд╛рди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рд▓рдбрд╝рддреА рд╣реИ, рддреЛ рд╡рд╣ рдПрдХрдореБрд╢реНрдд рд╣рд╛рд░ рдЬрд╛рддреА рд╣реИред  рдЙрд╕реА рд╕рдордп, рд╣рдорд╛рд░реЗ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкрд░ рдХрдо рд╕реАрдкреАрдпреВ рдЙрдкрдпреЛрдЧ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП, рд╣рдордиреЗ рдкреНрд░рддрд┐ рд╣реЛрд╕реНрдЯ рджреЛ рд░реАрдЬрд░реНрд╡рд░ рдПрдЪрдмреА рд▓рдЧрд╛рдП рдФрд░ рдЗрд╕ рддрд░рд╣ рдЙрддреНрдкрд╛рджрдХрддрд╛ рджреЛрдЧреБрдиреА рдХрд░рдирд╛ рд╕реАрдЦрд╛ред  рдпрд╛рдиреА  рд╕рдВрд╕рд╛рдзрди рдЙрдкрдпреЛрдЧ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП, рд╕реАрдПрд╕ рдХреЗ рд▓рд┐рдП рд╕реНрдерд┐рддрд┐ рдФрд░ рднреА рдЕрдзрд┐рдХ рдирд┐рд░рд╛рд╢рд╛рдЬрдирдХ рд╣реИред <br><br>  рдмреЗрд╢рдХ, рдпреЗ рдкрд░реАрдХреНрд╖рдг рдХрд╛рдлреА рд╕рд┐рдВрдереЗрдЯрд┐рдХ рд╣реИрдВ рдФрд░ рдпрд╣рд╛рдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреА рдорд╛рддреНрд░рд╛ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдорд╛рдореВрд▓реА рд╣реИред  рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЬрдм рдЯреЗрд░рд╛рдмрд╛рдЗрдЯреНрд╕ рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕реНрдерд┐рддрд┐ рдЕрд▓рдЧ рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдПрдЪрдмреА рдХреЗ рд▓рд┐рдП рд╣рдо рдЯреЗрд░рд╛рдмрд╛рдЗрдЯреНрд╕ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рд╕реАрдПрд╕ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд рд╣реЛ рдЧрдпрд╛ред  рдпрд╣ рдЕрдХреНрд╕рд░ рдЗрди рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рднреА рдПрдХ рдСрдкрд░реЗрд╢рдирдЯрд┐рдореЗрдбрдСрдЯрдПрдХреНрд╕ рдЕрдкрд╡рд╛рдж рдХреЛ рдлреЗрдВрдХ рджреЗрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд▓реЛрдЧреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкрд╣рд▓реЗ рд╣реА рдХрдИ рдЧреБрдирд╛ рдмрдврд╝рд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br>  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рд╕рдВрдпреБрдХреНрдд рдкреНрд░рдпрд╛рд╕реЛрдВ рд╕реЗ рд╣рдореЗрдВ рд╕реАрдПрд╕ рдХреА рдЕрдбрд╝рдЪрдиреЗрдВ рдорд┐рд▓реЗрдВрдЧреА рдФрд░ рдЕрдЧрд░ рд╣рдо рдЗрд╕реЗ рддреЗрдЬ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдореИрдВ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдкреЛрд╕реНрдЯ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдЬреЛрдбрд╝реВрдВрдЧрд╛ред <br><br>  <b>UPD:</b> CS рд╕реЗрдЯрдЕрдк рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджрд┐рд╢рд╛рдирд┐рд░реНрджреЗрд╢ рд▓рд╛рдЧреВ рдХрд┐рдП рдЧрдП рдереЗ: <br><br>  <i>disk_optimization_strategy: рдХрддрд╛рдИ</i> <i><br></i>  <i>MAX_HEAP_SIZE = "32G"</i> <i><br></i>  <i>HEAP_NEWSIZE = "3200M"</i> <i><br></i>  <i>-Xms32G</i> <i><br></i>  <i>-Xmx32G</i> <i><br></i>  <i>-XX: + UseG1GC</i> <i><br></i>  <i>-XX: G1RSetUpdatingPauseTimePercent = 5</i> <i><br></i>  <i>-рдПрдХреНрд╕рдПрдХреНрд╕: рдореИрдХреНрд╕рдЧреИрд╕рдХреЙрдореНрдкрд┐рд▓рд┐рд╕ = 500</i> <i><br></i>  <i>-рдПрдХреНрд╕рдПрдХреНрд╕: рдЗрдирд┐рд╢рд┐рдпреЗрдЯрд┐рдВрдЧ рд╣рд╛рдЗрдкрдСрдХреНрдпреВрдкреЗрдВрд╕реАрдкреЗрд░реЗрдВрдЯ = 70</i> <i><br></i>  <i>-XX: рд╕рдорд╛рдирд╛рдВрддрд░ GCThreads = 32</i> <i><br></i>  <i>-рдПрдХреНрд╕рдПрдХреНрд╕рдПрдХреНрд╕: рдХреЙрдирд╕реАрдХреНрд╢рдЯреНрд╕ = 8</i> <br><br>  рдУрдПрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдПрдХ рд▓рдВрдмреА рдФрд░ рдЬрдЯрд┐рд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИ (рд░реВрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛, рд╕рд░реНрд╡рд░ рд░рд┐рдмреВрдЯ рдХрд░рдирд╛, рдЖрджрд┐), рдЗрд╕рд▓рд┐рдП рдЗрди рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рджреВрд╕рд░реА рдУрд░, рджреЛрдиреЛрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕рдорд╛рди рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕рдм рдХреБрдЫ рдЙрдЪрд┐рдд рд╣реИред <br><br>  рдХреЛрдб рднрд╛рдЧ рдореЗрдВ, рдЯреЗрдмрд▓ рдкрд░ рд▓рд┐рдЦрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдереНрд░реЗрдбреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдиреЗрдХреНрдЯрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><pre> <code class="java hljs">connector = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CassandraConnector(); connector.connect(node, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, CL); session = connector.getSession(); session.getCluster().getConfiguration().getSocketOptions().setConnectTimeoutMillis(<span class="hljs-number"><span class="hljs-number">120000</span></span>); KeyspaceRepository sr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KeyspaceRepository(session); sr.useKeyspace(keyspace); prepared = session.prepare(<span class="hljs-string"><span class="hljs-string">"insert into "</span></span> + tableName + <span class="hljs-string"><span class="hljs-string">" (id, title) values (?, ?)"</span></span>);</code> </pre> <br><br>  рдбреЗрдЯрд╛ рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long key = count * thNum; key &lt; count * (thNum + <span class="hljs-number"><span class="hljs-number">1</span></span>); key++) { String value = RandomStringUtils.random(dataSize, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); session.execute(prepared.bind(key, value)); }</code> </pre> <br><br>  рдЗрд╕рд╕реЗ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдкреНрд░рджрд░реНрд╢рди рдкрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдкрдбрд╝рд╛ред  рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ YCSB рдЯреВрд▓ рдХреЗ рд╕рд╛рде рд▓реЛрдб рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛, рдмрд┐рд▓реНрдХреБрд▓ рдЙрд╕реА рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВред  рдиреАрдЪреЗ рдПрдХ рдзрд╛рдЧреЗ рдХреЗ рд▓рд┐рдП рдЖрдБрдХрдбрд╝реЗ (4 рдореЗрдВ рд╕реЗ): <br><br>  <i>2020-01-18 14: 41: 53: 180 315 рд╕реЗрдХрдВрдб: 10,000,000 рд╕рдВрдЪрд╛рд▓рди;</i>  <i>21589.1 рд╡рд░реНрддрдорд╛рди рдСрдкреНрд╕ / рд╕реЗрдХ;</i>  <i>] рдФрд╕рдд = 2582.71, 90 = 3491, 99 = 16767, 99.9 = 99711, 99.99 = 171263]</i> <i><br></i>  <i>[рдУрд╡рд░рд▓реЗ], рд░рдирдЯрд╛рдЗрдо (рдПрдордПрд╕), 315539</i> <i><br></i>  <i>[OVERALL], рдереНрд░реВрдкреБрдЯ (ops / sec), 31691.803548848162</i> <i><br></i>  <i>[TOTAL_GCS_PS_Scavenge], рдЧрд┐рдирддреА, 161</i> <i><br></i>  <i>[TOTAL_GC_TIME_PS_Scavenge], рд╕рдордп (ms), 2433</i> <i><br></i>  <i>[TOTAL_GC_TIME _% _ PS_Scavenge], рд╕рдордп (%), 0.7710615803434757</i> <i><br></i>  <i>[TOTAL_GCS_PS_MarkSweep], рдЧрдгрдирд╛, 0</i> <i><br></i>  <i>[TOTAL_GC_TIME_PS_MarkSweep], рд╕рдордп (ms), 0</i> <i><br></i>  <i>[TOTAL_GC_TIME _% _ PS_MarkSweep], рд╕рдордп (%), 0.0</i> <i><br></i>  <i>[TOTAL_GCs], рдЧрд┐рдирддреА, 161</i> <i><br></i>  <i>[TOTAL_GC_TIME], рд╕рдордп (рдПрдордПрд╕), 2433</i> <i><br></i>  <i>[TOTAL_GC_TIME_%], рд╕рдордп (%), 0.7710615803434757</i> <i><br></i>  <i>[INSERT], рд╕рдВрдЪрд╛рд▓рди, 10,000,000</i> <i><br></i>  <i>[INSERT], рдФрд╕рддрддрд╛ (рд╣рдореЗрдВ), рейрез4реи.реирекреи .режрез</i> <i><br></i>  <i>[INSERT], рдорд┐рдирд▓рд┐рдЯреА (рд╣рдореЗрдВ), реирем реп</i> <i><br></i>  <i>[INSERT], рдореИрдХреНрд╕рд▓реЗрдЯреЗрдВрд╕реА (рд╣рдореЗрдВ), ремреж реп реиред реп</i> <i><br></i>  <i>[рдЖрдИрдПрдирдПрд╕рдИрдЖрд░рдЯреА], реп рел рд╡реЗрдВрдЪрд░реЗрдВрдЯрд▓реАрд▓рд┐рдЯреА (рд╣рдореЗрдВ), релрежреж,</i> <i><br></i>  <i>[INSERT], репреп рд╡реЗрдВрдкрд╛рд░реНрд╕реЗрдВрдЯрд▓реАрд▓рд╛рдЯрд┐рдЯреА (рд╣рдореЗрдВ), рейрейрекрей реп</i> <i><br></i>  <i>[INSERT], рд░рд┐рдЯрд░реНрди = рдУрдХреЗ, резрежрежрежрежрежрежреж</i> <i><br></i> <br><br>  рдпрд╣рд╛рдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рд╕реНрдЯреНрд░реАрдо рдХреА рдЧрддрд┐ рд▓рдЧрднрдЧ 32 рд╣рдЬрд╛рд░ рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рд╣реИ, 4 рдзрд╛рд░рд╛рдУрдВ рдиреЗ рдХрд╛рдо рдХрд┐рдпрд╛ рд╣реИ, рдпрд╣ 128 рд╣рдЬрд╛рд░ рдирд┐рдХрд▓рд╛ рд╣реИред рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдбрд┐рд╕реНрдХ рд╕рдмрд╕рд┐рд╕реНрдЯрдо рдХреА рд╡рд░реНрддрдорд╛рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкрд░ рдирд┐рдЪреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдХреБрдЫ рдирд╣реАрдВ рд╣реИред <br><br>  рдЕрдзрд┐рдХ рд░реЛрдЪрдХ рдкрдврд╝рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред  рдХрд╛рдорд░реЗрдб рдХреА рд╕рд▓рд╛рд╣ рдХреА рдмрджреМрд▓рдд рд╡рд╣ рдореМрд▓рд┐рдХ рд░реВрдк рд╕реЗ рддреЗрдЬреА рд▓рд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдерд╛ред  рдкрдарди 5 рдзрд╛рд░рд╛рдУрдВ рдореЗрдВ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ 100 рдореЗрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред 200 рдХреА рд╡реГрджреНрдзрд┐ рдиреЗ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдбрд╛рд▓рд╛ред  рдмрд┐рд▓реНрдбрд░ рдХреЛ рднреА рдЬреЛрдбрд╝рд╛: <br>  .withLoadBalancingPolicy (рдирдпрд╛ TokenAwarePolicy (DCAwareRoundRobinPolicy.builder) (ред buildред ())ред <br><br>  рдирддреАрдЬрддрди, рдпрджрд┐ рдкрд╣рд▓реЗ рдкрд░реАрдХреНрд╖рдг рдореЗрдВ 159 644 рдСрдкреНрд╕ (5 рд╕реНрдЯреНрд░реАрдо, 4 рдЯреЗрдмрд▓, 100 рдмреИрдЪ) рджрд┐рдЦрд╛рдП рдЧрдП рдереЗ, рддреЛ рдЕрдм: <br>  100 рдзрд╛рдЧреЗ, 4 рдЯреЗрдмрд▓, рдмреИрдЪ = 1 (рд╡реНрдпрдХреНрддрд┐рдЧрдд): 301 969 рдСрдкреНрд╕ <br>  100 рдзрд╛рдЧреЗ, 4 рдЯреЗрдмрд▓, рдмреИрдЪ = 10: 447 608 рдСрдкреНрд╕ <br>  100 рдзрд╛рдЧреЗ, 4 рдЯреЗрдмрд▓, рдмреИрдЪ = 100: 625 655 рдСрдкреНрд╕ <br><br>  рдЪреВрдВрдХрд┐ рдкрд░рд┐рдгрд╛рдо рдмреИрдЪреЛрдВ рдХреЗ рд╕рд╛рде рдмреЗрд╣рддрд░ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рдПрдЪрдмреА рдХреЗ рд╕рд╛рде рдЗрд╕реА рддрд░рд╣ рдХреЗ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдП: <br><img src="https://habrastorage.org/webt/ct/bk/-y/ctbk-yrecbwegasrbpauq6f1vv8.png"><br>  <i>* рдЬрдм рд╕реЗ 400 рдереНрд░реЗрдбреНрд╕ рдореЗрдВ рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд░реИрдВрдбрдорд╕реНрдЯреНрд░рд┐рдВрдЧ рдпреВрдЯрд┐рд▓реНрд╕ рдлрд╝рдВрдХреНрд╢рди, рдЬреЛ рдкрд╣рд▓реЗ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдиреЗ рд╕реАрдкреАрдпреВ рдХреЛ 100% рддрдХ рд▓реЛрдб рдХрд┐рдпрд╛ рдерд╛, рдЗрд╕реЗ рдПрдХ рддреЗрдЬ рдЬрдирд░реЗрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред</i> <br><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдереНрд░реЗрдбреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╡реГрджреНрдзрд┐ рдПрдЪрдмреА рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдереЛрдбрд╝реА рд╡реГрджреНрдзрд┐ рджреЗрддреА рд╣реИред <br><br>  рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдВ рдХрдИ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдо рджрд┐рдП рдЧрдП рд╣реИрдВред  <a href="https://habr.com/ru/users/0x62ash/" class="user_link">0x62ash</a> рдХреЗ рдЕрдиреБрд░реЛрдз рдкрд░, рдлреНрд▓рд╢ рдХрдорд╛рдВрдб рдХреЛ рдкрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рдХрдИ рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдк рднреА рджрд┐рдП рдЧрдП рд╣реИрдВ: <br>  рдореЗрдореЙрд╕реНрдЯреЛрд░ - рдореЗрдореЛрд░реА рд╕реЗ рдкрдврд╝рдирд╛, рдЕрд░реНрдерд╛рддреНред  рдбрд┐рд╕реНрдХ рдореЗрдВ рдлреНрд▓рд╢ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред <br>  HFile + рдЬрд╝рд┐рдк - GZ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рджреНрд╡рд╛рд░рд╛ рд╕рдВрдХреБрдЪрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ рдкрдврд╝рдирд╛ред <br>  HFile + upzip - рд╕рдВрдкреАрдбрд╝рди рдХреЗ рдмрд┐рдирд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рд╡рд┐рд╢реЗрд╖рддрд╛ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╣реИ - рдЫреЛрдЯреА рдлрд╛рдЗрд▓реЗрдВ ("рдбреЗрдЯрд╛" рдлрд╝реАрд▓реНрдб, рдЬрд╣рд╛рдВ 10 рдмрд╛рдЗрдЯреНрд╕ рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВ) рдХреЛ рдЕрдзрд┐рдХ рдзреАрд░реЗ-рдзреАрд░реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдЕрдЧрд░ рд╡реЗ рд╕рдВрдХреБрдЪрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред  рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЖрдХрд╛рд░ рддрдХ рд╣реА рд╕рдВрднрд╡ рд╣реИ, рдЬрд╛рд╣рд┐рд░ рд╣реИ рдХрд┐ 5 рдЬреАрдмреА рдХреА рдлрд╛рдЗрд▓ рдХреЛ 10 рдПрдордмреА рд╕реЗ рдЕрдзрд┐рдХ рддреЗрдЬреА рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЗрди рд╕рднреА рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ рдЕрднреА рднреА рд╡рд┐рднрд┐рдиреНрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рдиреЛрдВ рдХреЗ рд╢реЛрдз рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╣рд▓ рдирд╣реАрдВ рд╣реИред <br><br>  рд░реБрдЪрд┐ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рд╡рд┐рд▓рдВрдмрддрд╛ рдФрд░ рдЕрдзрд┐рдХ рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП 100 рдЯреБрдХрдбрд╝реЛрдВ рдХреЗ рдПрдЪрдмреА рдмреИрдЪреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдИрд╕реАрдПрд╕рдмреА рдХреЛрдб рдХреЛ рд╕рд╣реА рдХрд┐рдпрд╛ред  рдиреАрдЪреЗ 4 рдкреНрд░рддрд┐рдпреЛрдВ рдХреЗ рдХрд╛рдо рдХрд╛ рдирддреАрдЬрд╛ рд╣реИ рдЬреЛ рдЙрдирдХреА рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ 100 рдзрд╛рдЧреЗ рд╣реИрдВред  рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рдХрд▓рд╛: <br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рдСрдкрд░реЗрд╢рди = 100 рд░рд┐рдХреЙрд░реНрдб</b> <div class="spoiler_text">  [рдУрд╡рд░рд▓реЗ], рд░рдирдЯрд╛рдЗрдо (рдПрдордПрд╕), 1165415 <br>  [OVERALL], рдереНрд░реВрдкреБрдЯ (ops / sec), 858.06343662987 <br>  [TOTAL_GCS_PS_Scavenge], рдЧрдгрдирд╛, 798 <br>  [TOTAL_GC_TIME_PS_Scavenge], рд╕рдордп (ms), 7346 <br>  [TOTAL_GC_TIME _% _ PS_Scavenge], рд╕рдордп (%), 0.6303334005484826 <br>  [TOTAL_GCS_PS_MarkSweep], рдЧрдгрдирд╛, 1 <br>  [TOTAL_GC_TIME_PS_MarkSweep], рд╕рдордп (ms), 74 <br>  [TOTAL_GC_TIME _% _ PS_MarkSweep], рд╕рдордп (%), 0.00634966943106101038 <br>  [TOTAL_GCs], рдЧрдгрдирд╛, 799 <br>  [TOTAL_GC_TIME], рд╕рдордп (ms), 7420 <br>  [TOTAL_GC_TIME_%], рд╕рдордп (%), 0.6366830699793635 <br>  [INSERT], рд╕рдВрдЪрд╛рд▓рди, 1,000,000 <br>  [INSERT], рдФрд╕рддрддрд╛ (рд╣рдореЗрдВ), резрезрел.8 реп рей.44 реп резремрекрек <br>  [INSERT], рдорд┐рдирд▓рд┐рдЯреА (рд╣рдореЗрдВ), резрекрелреи, <br>  [INSERT], рдореИрдХреНрд╕рд▓рд┐рдЯреА (рд╣рдореЗрдВ), резрек3режрекремрей <br>  [INSERT], реп релред рдкреАрд░рд╕реЗрдиреНрдЯрд▓реАрд▓реЗрдЯреЗрдВрд╕реА (рд╣рдореЗрдВ), реирек .рейрез реп <br>  [рдЖрдИрдПрдирдПрд╕рдИрдЖрд░рдЯреА], репреп рд╡реЗрдВрдкрд╛рд░реНрд╕реЗрдВрдЯреАрд▓рд┐рдЯреА (рд╣рдореЗрдВ), рекрекрел реп релрез <br>  [INSERT], рд░рд┐рдЯрд░реНрди = рдУрдХреЗ, резрежреж,режрежреж <br><br>  20/01/19 13:19:16 INFO рдЧреНрд░рд╛рд╣рдХ.рдХреЙрдиреНрдиреЗрдиреЗрд╢рди рдореЗрдиреЗрдЬрд░ $ HConnectionI рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: рд╕рдорд╛рдкрди рдЬреБрдХрд╛рдЗрдкрд░ рд╕реЗрд╢рди = 0x36f98ad0a4ad8cc <br>  20/01/19 13:19:16 INFO zookeeper.ZooKeeper: рд╕рддреНрд░: 0x36f98ad0a4ad8cc рдмрдВрдж <br>  20/01/19 13:19:16 рдЬрд╛рдирдХрд╛рд░реА zookeeper.ClientCnxn: EventThread рд╢рдЯ рдбрд╛рдЙрди <br>  [рдУрд╡рд░рд▓реЗ], рд░рдирдЯрд╛рдЗрдо (рдПрдордПрд╕), 1165806 <br>  [OVERALL], рдереНрд░реВрдкреБрдЯ (ops / sec), 857.7756504941646 <br>  [TOTAL_GCS_PS_Scavenge], рдЧрдгрдирд╛, 776 <br>  [TOTAL_GC_TIME_PS_Scavenge], рд╕рдордп (ms), 7517 <br>  [TOTAL_GC_TIME _% _ PS_Scavenge], рд╕рдордп (%), 0.644789956464643535 <br>  [TOTAL_GCS_PS_MarkSweep], рдЧрдгрдирд╛, 1 <br>  [TOTAL_GC_TIME_PS_MarkSweep], рд╕рдордп (ms), 63 <br>  [TOTAL_GC_TIME _% _ PS_MarkSweep], рд╕рдордп (%), 0.005403986598113236 <br>  [TOTAL_GCs], рдЧрдгрдирд╛, 777 <br>  [TOTAL_GC_TIME], рд╕рдордп (ms), 7580 <br>  [TOTAL_GC_TIME_%], рд╕рдордп (%), 0.6501939430745767 <br>  [INSERT], рд╕рдВрдЪрд╛рд▓рди, 1,000,000 <br>  [INSERT], рдФрд╕рддрддрд╛ (рд╣рдореЗрдВ), резрезремрежрекреи.реирежред реп рейрем <br>  [INSERT], рдиреНрдпреВрдирддрдорддрд╛ (рд╣рдореЗрдВ), резрекрежрелрем <br>  [INSERT], рдореИрдХреНрд╕рд▓рд┐рдЯреА (рд╣рдореЗрдВ), резрекремреиреи ,рез <br>  [рдЖрдИрдПрдирдПрд╕рдИрдЖрд░рдЯреА], реп рел рд╡реЗрдВрдкрд░реЗрдВрдЯрд┐рд▓рд╛рд▓рд┐рдЯреА (рд╣рдо), реирелрежреирей реп <br>  [INSERT], репреп рд╡реЗрдВрдкрд╛рд░реНрд╕реЗрдВрдЯрд▓реАрд▓рд╛рдЯреЗрдВрд╕реА (рд╣рдореЗрдВ), рекрекрем ,рез реп <br>  [INSERT], рд░рд┐рдЯрд░реНрди = рдУрдХреЗ, резрежреж,режрежреж <br><br>  20/01/19 13:19:16 INFO рдЧреНрд░рд╛рд╣рдХ.рдХреЙрдиреНрдиреЗрдиреЗрд╢рди рдореЗрдиреЗрдЬрд░ $ HConnectionI рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: рд╕рдорд╛рдкрди рдЬреБрдХрд╛рдЗрдкрд░ рд╕реЗрд╢рди = 0x26f98ad07b6d67e <br>  20/01/19 13:19:16 рдЬрд╛рдирдХрд╛рд░реА zookeeper.ZooKeeper: рд╕рддреНрд░: 0x26f98ad07b6d67e рдмрдВрдж <br>  20/01/19 13:19:16 рдЬрд╛рдирдХрд╛рд░реА zookeeper.ClientCnxn: EventThread рд╢рдЯ рдбрд╛рдЙрди <br>  [OVERALL], рд░рдирдЯрд╛рдЗрдо (ms), 1165999 <br>  [OVERALL], рдереНрд░реВрдкреБрдЯ (ops / sec), 857.63366863951 <br>  [TOTAL_GCS_PS_Scavenge], рдЧрдгрдирд╛, 818 <br> [TOTAL_GC_TIME_PS_Scavenge], Time(ms), 7557 <br> [TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.6481137633908777 <br> [TOTAL_GCS_PS_MarkSweep], Count, 1 <br> [TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 79 <br> [TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.006775305982252128 <br> [TOTAL_GCs], Count, 819 <br> [TOTAL_GC_TIME], Time(ms), 7636 <br> [TOTAL_GC_TIME_%], Time(%), 0.6548890693731299 <br> [INSERT], Operations, 1000000 <br> [INSERT], AverageLatency(us), 116172.212864 <br> [INSERT], MinLatency(us), 7952 <br> [INSERT], MaxLatency(us), 1458175 <br> [INSERT], 95thPercentileLatency(us), 250879 <br> [INSERT], 99thPercentileLatency(us), 446463 <br> [INSERT], Return=OK, 1000000 <br><br> 20/01/19 13:19:17 INFO client.ConnectionManager$HConnectionImplementation: Closing zookeeper sessionid=0x36f98ad0a4ad8cd <br> 20/01/19 13:19:17 INFO zookeeper.ZooKeeper: Session: 0x36f98ad0a4ad8cd closed <br> 20/01/19 13:19:17 INFO zookeeper.ClientCnxn: EventThread shut down <br> [OVERALL], RunTime(ms), 1166860 <br> [OVERALL], Throughput(ops/sec), 857.000839860823 <br> [TOTAL_GCS_PS_Scavenge], Count, 707 <br> [TOTAL_GC_TIME_PS_Scavenge], Time(ms), 7239 <br> [TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.6203829079752499 <br> [TOTAL_GCS_PS_MarkSweep], Count, 1 <br> [TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 67 <br> [TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.0057419056270675145 <br> [TOTAL_GCs], Count, 708 <br> [TOTAL_GC_TIME], Time(ms), 7306 <br> [TOTAL_GC_TIME_%], Time(%), 0.6261248136023173 <br> [INSERT], Operations, 1000000 <br> [INSERT], AverageLatency(us), 116230.849308 <br> [INSERT], MinLatency(us), 7352 <br> [INSERT], MaxLatency(us), 1443839 <br> [INSERT], 95thPercentileLatency(us), 250623 <br> [INSERT], 99thPercentileLatency(us), 447487 <br> [INSERT], Return=OK, 1000000 </div></div><br><br> ,    CS AverageLatency(us)   3114,   HB AverageLatency(us) = 1162 (,  1  = 100     ). <br><br>      тАФ        HBase.   ,  SSD       .   ,       ,    ,     4 ,  400    ,      .   :  тАФ  .  .   ScyllaDB     ,    тАж </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi484096/">https://habr.com/ru/post/hi484096/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi484084/index.html">1C-Bitrix рдФрд░ рдЗрд╕реЗ рдкреЗрд╢ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕</a></li>
<li><a href="../hi484088/index.html">рдкрд╛рд╕рд╡рд░реНрдб рд╣рд┐рдЯ рдкрд░реЗрдб (рд▓реАрдХ рд╕реЗ ~ 5 рдмрд┐рд▓рд┐рдпрди рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг)</a></li>
<li><a href="../hi484090/index.html">рд░реВрд╕реА рдбрд╛рдХ рдбреЗрдЯрд╛ рдХреЗрдВрджреНрд░ рдХреЗ рд▓рд┐рдП рдирдИ рдЖрдИрдЯреА рдЕрд╡рд╕рдВрд░рдЪрдирд╛</a></li>
<li><a href="../hi484092/index.html">рдХреБрдЫ рдХрдкрдбрд╝реЗ рдкрд╣рдиреЗ рд╣реБрдП рд░рд╛рдЬрдХреБрдорд╛рд░реЛрдВ рдФрд░ рд░рдИрд╕реЛрдВ</a></li>
<li><a href="../hi484094/index.html">рдбреЙрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рддреАрд╕рд░реЗ рд╡реНрдпрдХреНрддрд┐ рдЬрд╝реЛрдВрдмреА рд╢реВрдЯрд░ рдмрдирд╛рдПрдВ</a></li>
<li><a href="../hi484100/index.html">рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рд▓рд┐рдП Google рдореИрдкреНрд╕ рдПрд╕рдбреАрдХреЗ рдореЗрдВ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛</a></li>
<li><a href="../hi484102/index.html">PHP рдмрдирд╛рдо рдкрд╛рдпрдерди рдмрдирд╛рдо рд░реВрдмреА рдСрди рд░реЗрд▓реНрд╕: рд╡рд┐рд╕реНрддреГрдд рддреБрд▓рдирд╛</a></li>
<li><a href="../hi484106/index.html">PostgreSQL-6 рдореЗрдВ MVCCред рд╡реИрдХреНрдпреВрдо</a></li>
<li><a href="../hi484108/index.html">Etherblade.net рдиреЗрдЯрд╡рд░реНрдХ рдШрдЯрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдирдХреИрдкреНрд╕реБрд▓реЗрдЯрд░ рдФрд░ рдЖрдпрд╛рдд рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди (рднрд╛рдЧ рджреЛ)</a></li>
<li><a href="../hi484112/index.html">рдХреНрдпрд╛ рдкреНрд▓реЗрди рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>