<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç± üë®üèø‚Äçü§ù‚Äçüë®üèª üòõ Machen Sie sich mit dem Fahrrad vertraut, Teil 1: Lernen Sie die Grundlagen zum Anpassen des Visual Studio-Debuggers mithilfe von Plugins ‚úçüèΩ üíº ü•î</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine der Neuerungen von Visual Studio 2012 war das Erscheinen eines neuen benutzerdefinierten Debuggers namens Concord. Dank seines Komponentensystems...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Machen Sie sich mit dem Fahrrad vertraut, Teil 1: Lernen Sie die Grundlagen zum Anpassen des Visual Studio-Debuggers mithilfe von Plugins</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476298/"><img src="https://habrastorage.org/webt/kl/8o/1x/kl8o1xvmgggvg_ssk6tb72xz6se.png" align="right">  Eine der Neuerungen von Visual Studio 2012 war das Erscheinen eines neuen benutzerdefinierten Debuggers namens Concord.  Dank seines Komponentensystems k√∂nnen VSIX-Plug-Ins das Verhalten des Debuggers anpassen und neue kontextsensitive Tools schreiben, die den Debugger f√ºr ihre Anforderungen verwenden k√∂nnen.  Die API bietet viele QOL-Funktionen, z. B. das Zusammenf√ºhren von verwaltetem / nicht verwaltetem Code, die nahtlose Integration in einen remote / lokal debuggten Prozess und vieles mehr.  Tats√§chlich kann fast alles, was in der IDE getan werden kann, programmgesteuert mit der Concord-API durchgef√ºhrt werden!  √Ñndern Sie die Werte bestimmter Variablen im laufenden Betrieb, rufen Sie Funktionen auf Anfrage auf (oder lassen Sie das Programm gezielt Aufrufe √ºberspringen!). Plugins k√∂nnen nach PDB (!), Schrittweiser Umgehung und sogar Code-√Ñnderung suchen!  √ñffnen Sie die Katze und lernen Sie diese wenig bekannten Innovationen im Bereich des Fahrradbaus kennen. <br><a name="habracut"></a><br>  Sie sollten wahrscheinlich von vorne beginnen.  Der Debugger erkennt die Komponenten, indem er Informationen aus der Datei <i>vsdconfig liest</i> , auf die im Manifest des VSIX-Plugins verwiesen wird.  <i>Vsdconfig</i> gibt wiederum an, welche Schnittstellen von den <i>Plug-in-</i> Komponenten implementiert werden und wie diese Komponenten zu finden sind (Verkn√ºpfung mit einer DLL-Datei, die die Klasse angibt, oder, im Fall der nativen Implementierung, CLSID. Ich werde Beispiele in C # angeben).  Au√üerdem wird eine eindeutige Kennung (GUID) f√ºr jede Komponente sowie deren "Ebene" angegeben.  Eine Ebene bestimmt, in welcher Reihenfolge Plugins verarbeitet werden und in welchem ‚Äã‚ÄãKontext diese Implementierung geladen wird - in den IDE-Prozess oder in den Prozess der debuggten Anwendung.  Dies liegt an der Tatsache, dass einige Funktionen nur im Kontext einer IDE und umgekehrt funktionieren k√∂nnen - nur im Kontext eines debuggten Prozesses.  Einige API-Funktionen arbeiten dort und dort auf die gleiche Weise.  Au√üerdem haben einige Komponenten ihre eigenen Layoutregeln, da sie m√∂glicherweise von vorhandenen Debugger-Elementen abh√§ngen, die sich auf ihren festgelegten Ebenen befinden.  Um Vorf√§lle zu vermeiden, empfehle ich RTFM (https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.debugger.componentinterfaces?view=visualstudiosdk-2017) und unabh√§ngige Experimente in einer separaten Sandbox, was nicht schade sein wird L√∂schen, wenn etwas passiert (dies ist wiederum mit einer solchen Nuance verbunden - in einigen F√§llen ist nicht einmal klar, warum die Assembly oder der Typ nicht geladen wird, da ich immer noch nicht finden konnte, wo die Protokolle erscheinen, die das Problem stabil signalisieren w√ºrden. Fehler, In Bezug auf eine Abh√§ngigkeit, die nicht in den Zielprozess geladen werden kann, kann sie beispielsweise in der Ausgabe st erscheinen  Di- oder nicht. Seien Sie akuratno, nehmen h√§ufig Commits <s>und sitzen nicht betrunken hinter dem Steuer).</s> <br><br>  Die Liste der Ebenen ist wie folgt (ich werde den Text in Englisch geben, damit der Leser keine Zwischenf√§lle beim Begehen von RFTM-Handlungen hat): <br><br>  IDE-Komponentenebenen (Werte&gt; 100.000): <br><div class="scrollable-table"><table><tbody><tr><th>  Komponente </th><th>  Komponentenebene </th></tr><tr><td>  AD7 AL </td><td>  1.000.000.000 </td></tr><tr><td>  Demontageanbieter </td><td>  9.998.000 </td></tr><tr><td>  Stapelabfrage - Komponenten, die den Aufrufstapel abfragen m√∂chten </td><td>  9,997,000 </td></tr><tr><td>  Stack-Anbieter </td><td>  9.996.000 </td></tr><tr><td>  Stapelfilter - Ebene, auf der Stapel gefiltert und mit Anmerkungen versehen werden k√∂nnen </td><td>  9.995.000 </td></tr><tr><td>  Haltepunkt-Manager </td><td>  9.994.000 </td></tr><tr><td>  IDE Expression Evaluation </td><td>  9.992.000 </td></tr><tr><td>  Symbolstapelwanderer - Stapelwanderer, die Zugriff auf Symbole ben√∂tigen </td><td>  9,991,000 </td></tr><tr><td>  IDE SymbolProvider - Komponenten, die Symbolinformationen f√ºr den Rest des Debuggers bereitstellen.  Der Symbolpfad sollte nicht unterhalb dieser Ebene verwendet werden. </td><td>  1,999,000 </td></tr></tbody></table></div><br>  Ebenen der Komponenten des Zielprozesses (Werte &lt;99,999): <br><div class="scrollable-table"><table><tbody><tr><th>  Komponente </th><th>  Komponentenebene </th></tr><tr><td>  Monitor Symbol Provider - Symbolanbieter, wenn der symbolische Status auf dem Zielcomputer erstellt wurde (Beispiel: Interpreter, dynamisch kompilierter / ausgegebener Code) </td><td>  75.000 </td></tr><tr><td>  Haltepunktbedingungsprozessor - Auf dieser Ebene werden Haltepunktbedingungen wie Bedingungsausdr√ºcke und Trefferzahlen verarbeitet.  Unterhalb dieses Punktes sind alle physischen Haltepunktereignisse sichtbar, unabh√§ngig davon, ob sie falsche Bedingungen haben oder nicht. </td><td>  70.000 </td></tr><tr><td>  Monitor Task Provider - Dies ist die Ebene f√ºr das Task Data Mining im Zielprozess </td><td>  65.500 </td></tr><tr><td>  Ausdrucksauswertung √ºberwachen </td><td>  65.000 </td></tr><tr><td>  Monitorkoordination - Komponenten, die zwischen den verschiedenen Monitoren nach Schritt, Haltepunkt nach nativer Adresse, Stackwalk usw. vermitteln. </td><td>  60.000 </td></tr><tr><td>  √úberwachen Sie Stack-Walker </td><td>  55.000 </td></tr><tr><td>  Benutzerdefinierter Debug-Monitor - Reserviert f√ºr Debug-Monitore von Drittanbietern, die die von den Standard-Debug-Monitoren bereitgestellten Dienste nutzen m√∂chten. </td><td>  40.500 </td></tr><tr><td>  Runtime Debug Monitor - Bietet Daten√ºberpr√ºfung und Ausf√ºhrungskontrolle f√ºr verwalteten / systemeigenen / Skriptcode </td><td>  40.000 </td></tr><tr><td>  Basis-Debug-Monitor </td><td>  10.000 </td></tr><tr><td>  Base Debug Monitor Services - Bietet Utility-Services f√ºr Base Debug-Monitore (z. B. Prozesserstellung) sowie Pre-Debug-Services (z. B. Prozessauflistung). </td><td>  1.000 </td></tr></tbody></table></div><br>  Als n√§chstes in der Reihenfolge, den Prozess der Erstellung eines Projekts.  Wenn es keine wichtigen Nuancen g√§be, k√∂nnte ich diesen Prozess minimal beschreiben oder √ºberspringen, aber die Realit√§ten sind v√∂llig anders - wir ben√∂tigen eine Reihe von Bibliotheksabh√§ngigkeiten sowie ein Tool zum Erstellen von Konfigurationsdateien, die aus irgendeinem Grund nicht mit VisualStudio verteilt werden, aber verf√ºgbar sind nur mit nuget.  Tats√§chlich m√ºssen wir uns jetzt der Essenz zuwenden.  Der Prozess zum Erstellen und Einrichten eines Projekts ist wie folgt aufgebaut: <br><br><ol><li>  √ñffnen Sie Visual Studio.  In meinem Fall 2017 Community Edition </li><li>  VSIX-Projekt (Registerkarte <i>Visual C # -&gt; Erweiterbarkeit</i> oder √ºber die Suche).  Nennen wir es "HelloVSIX" </li><li>  F√ºgen Sie ein neues Klassenbibliotheksprojekt in die Projektmappe ein und nennen Sie es "DebuggeePlugin". </li><li>  Wir setzen den Verweis auf das Projekt "DebuggeePlugin" im Projekt "HelloVSIX" </li><li>  Wir haben den Verweis auf die Assembly "Microsoft.VisualStudio.Debugger.Engine" in das DebuggeePlugin-Projekt eingef√ºgt </li><li>  F√ºgen Sie dem Projekt ‚ÄûDebuggeePlugin‚Äú den Verweis f√ºr das Nuget-Paket Microsoft.VSSDK.Debugger.VSDConfigTool hinzu.  Dies ist unser Tool zum Generieren von VSD-Konfigurationen. </li></ol><br>  Jetzt sind wir bereit, unser Plugin dazu zu bringen, etwas N√ºtzliches zu tun.  Lassen Sie uns das einfachste tun, was Sie tun k√∂nnen - lassen Sie es eine MessageBox anzeigen, die "Hallo VSIX" sagt, wenn der Zielprozess auf einen Einstiegspunkt st√∂√üt.  Dazu m√ºssen wir eine Klasse erstellen, die die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">IDkmEntryPointNotification-</a> Schnittstelle implementiert, sowie mehrere Konfigurationsdateien ausf√ºllen.  F√ºgen Sie eine neue √∂ffentliche Klasse mit dem Namen DkmEntryPointNotificationService hinzu, erben Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">IDkmEntryPointNotification-</a> Schnittstelle und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">belassen Sie</a> die Standardimplementierung f√ºr den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Moment</a> : <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotImplementedException(); } } }</code> </pre> <br>  F√ºgen Sie die Datei "DkmEntryPointNotificationService.vsdconfigxml" zum Projekt "DebuggeePlugin" hinzu.  F√ºr jede deklarierte Klasse, die Benachrichtigungen √ºber Implementierungen der Namespace-Schnittstellen Microsoft.VisualStudio.Debugger.ComponentInterfaces erhalten soll, sollte eine solche Datei vorhanden sein.  √úbrigens ist es m√∂glich, mehrere solcher Schnittstellen gleichzeitig in einer Klasse zu implementieren.  Jetzt m√ºssen wir die Build-Aktion unserer ".vsdconfigxml" -Datei √§ndern.  Dazu m√ºssen Sie die Projektdatei manuell bearbeiten (ich meine es ernst).  Wir entladen das DebuggeePlugin-Projekt und √∂ffnen es mit dem Studio-Editor.  Wir m√ºssen das folgende XLM-Tag finden: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">None</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  und verschieben Sie dieses Tag in Ihre eigene ItemGroup, indem Sie den Typ von None in VsdConfigXmlFiles √§ndern: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VsdConfigXmlFiles</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Sie k√∂nnen das Projekt speichern und neu laden. <br><br>  Nun gehe zu den Einstellungen.  Das erste, was zu tun ist: Wenn die Datei vsdconfig.xsd zum DebuggeePlugin-Projekt hinzugef√ºgt wird, sollte sie gel√∂scht werden.  Wir werden es jetzt ersetzen, da es einfacher ist, mit Rohtext zu arbeiten.  √ñffnen Sie DkmEntryPointNotificationService.vsdconfigxml und ersetzen Sie den Text durch den folgenden: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/vstudio/vsdconfig/2008"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"422413E1-450E-40A6-AE24-7E80A81CC668"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">^_^quotòôÆquot^_^</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AssemblyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.DkmEntryPointNotificationService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NoFilter</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IDkmEntryPointNotification"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> &gt; <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/vstudio/vsdconfig/2008"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"422413E1-450E-40A6-AE24-7E80A81CC668"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">^_^quotòôÆquot^_^</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AssemblyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.DkmEntryPointNotificationService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NoFilter</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IDkmEntryPointNotification"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In einer solchen Datei m√ºssen wir Folgendes angeben: <br><br><ol><li>  ComponentId - Dieser Wert kann mit dem GUID-Generierungstool (Tools -&gt; CreateGUID) generiert werden. </li><li>  ComponentLevel ist die Ebene unserer Komponente in der Hierarchie.  In der obigen Tabelle und den Hilfeinformationen zu MSDN finden Sie Informationen zum Ausw√§hlen des gew√ºnschten Wertebereichs. </li><li>  Assemblyname ist der Name unserer Assembly (keine L√∂sung!).  In diesem Fall gibt es ein DebuggeePlugin </li><li>  Klassenname - sollte einschlie√ülich des Namespaces angegeben werden, in dem sich die Klasse befindet.  In diesem Fall DebuggeePlugin.DkmEntryPointNotificationService </li><li>  Array InterfaceGroup - Jeder Eintrag in ihm gibt eine von dieser Komponente implementierte Schnittstelle an.  Innerhalb jedes InterfaceGroup-Knotens sollte sich ein Unterknoten befinden, der die Schnittstellen angibt, die allen Filtern in dieser Gruppe gemeinsam sind, aber sp√§ter √ºber Filter.  Jetzt haben wir nur einen Schnittstellenknoten und tragen den Namen der IdkmEntryPointNotification-Schnittstelle.  Wenn wir mehrere Schnittstellen h√§tten, g√§be es mehrere Schnittstellenknoten. </li></ol><br>  Lassen Sie mich daran erinnern, dass es f√ºr jede Klasse, die Benachrichtigungen vom Debugger erhalten soll, eine solche Datei geben muss.  Aber der Spa√ü h√∂rt hier nicht auf.  Jede solche Datei wird anschlie√üend in einer .vsdconfig-Datei im Ausgabeverzeichnis des Projekts gesammelt.  Und auf sie sollte im Plugin-Manifest verwiesen werden.  Dies geschieht wie folgt: <br><br><ol><li>  Nachdem wir die ".vsdconfigxml" -Datei generiert haben, m√ºssen wir ... die L√∂sung einmal sammeln, da wir sonst keine .vsdconfig -Datei im Ausgabeverzeichnis des Projekts haben.) </li><li>  √ñffnen Sie anschlie√üend den Texteditor f√ºr die Datei source.extension.vsixmanifest und f√ºgen Sie den folgenden Code vor dem schlie√üenden PackageManifest-Tag hinzu: </li></ol><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Asset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggerEngineExtension"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.vsdconfig"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Wenn nach den abgeschlossenen Aktionen die Datei ‚ÄûDebuggeePlugin.vsdconfig‚Äú im HelloVSIX-Projekt angezeigt wird, sollte sie <b>AUS DEM PROJEKT ENTFERNT</b> und die L√∂sung erneut gesammelt werden, andernfalls wird sie nicht aktualisiert. <br><br>  Die Vorarbeiten sind beendet!  Sie k√∂nnen mit dem Debuggen unseres Plugins beginnen.  Dies erfolgt durch Starten einer experimentellen Instanz von VisualStudio (f√ºr VSIX-Projekte ist dies das Standard-Debug-Ziel, sodass keine zus√§tzlichen Schritte erforderlich sind).  Tats√§chlich klicken wir auf Debug-&gt; StartDebugging und sehen eine experimentelle Instanz von VisualStudio.  Standardm√§√üig sollte unser Plugin bereits installiert sein.  Sie k√∂nnen dies √ºber das Men√º Extras-&gt; Erweiterungen und Updates √ºberpr√ºfen. <br><br>  Aufgrund der Tatsache, dass wir die IDkmEntryPointNotification-Schnittstelle implementiert haben, m√ºssen wir ein Testprojekt in einer experimentellen Instanz von VisualStudio erstellen.  Tats√§chlich erstellen wir ein neues Projekt, w√§hlen <b>C ++ -&gt; Konsolenanwendung</b> (w√§hlen Sie C ++, da die folgenden Beispiele C ++ - Besonderheiten enthalten), nennen es <b>VSIXTestApp</b> , f√ºhren es ohne √Ñnderungen aus, sammeln und sehen, dass unsere experimentelle Instanz keine Ausnahme mehr innerhalb der DebuggeePlugin-Methode ausl√∂st. DkmEntryPointNotificationService.OnEntryPoint.  Gro√üartig!  Nun m√ºssen Sie die MessageBox anzeigen.  Dazu m√ºssen Sie dem DebuggeePlugin-Projekt die folgenden Verweise hinzuf√ºgen: <br><br><ul><li>  Microsoft.VisualStudio.Shell.15.0 </li><li>  Microsoft.VisualStudio.Shell.Interop </li><li>  Microsoft.VisualStudio.Shell.Interop.8.0 </li><li>  Microsoft.VisualStudio.OLE.Interop </li></ul><br>  F√ºgen Sie am Anfang der Datei DkmEntryPointNotificationService.cs zwei Verwendungen hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop;</code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">F√ºgen Sie</a> der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">VsShellUtilities.ShowMessageBox-</a> Methode in der DkmEntryPointNotificationService.OnEntryPoint-Methode einen Aufruf hinzu: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { VsShellUtilities.ShowMessageBox(Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, OLEMSGICON.OLEMSGICON_INFO, OLEMSGBUTTON.OLEMSGBUTTON_OK, OLEMSGDEFBUTTON.OLEMSGDEFBUTTON_FIRST); } } }</code> </pre><br>  Wir bauen um, starten eine experimentelle Instanz des Studios, starten ein Testprojekt und voila! <br><br>  Wir sehen, dass die Testinstanz des Studios MessageBox erstellt hat! <br><br><img src="https://habrastorage.org/webt/2c/a7/fd/2ca7fdpdvkt3z_fscr76xskl7rk.png"><br><br>  Und was n√ºtzt das eigentlich? <br><br>  Hier haben wir gelernt, wie ein VSIX-Projekt mit einem Plug-In f√ºr den Visual Studio-Debugger eingerichtet wird, wobei die meisten Nuancen ber√ºcksichtigt werden, die dem Ergebnis im Wege standen.  Dies ist der Ausgangspunkt f√ºr detailliertere Arbeiten.  Im n√§chsten Artikel zeige ich Ihnen einen weiteren wichtigen Punkt: Wie wird die Kommunikation zwischen der IDE und den Debug-Zielkomponenten durchgef√ºhrt? <br><br>  F√ºr weitere Hilfe bei der Verwendung der Concord-API k√∂nnen Sie nicht nur auf MSDN verweisen, sondern auch auf die folgenden Microsoft-Repositorys auf dem Github: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">github.com/microsoft/PTVS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">github.com/Microsoft/ConcordExtensibilitySamples</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de476298/">https://habr.com/ru/post/de476298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de476288/index.html">Top 5 JS-Frameworks f√ºr die Front-End-Entwicklung im Jahr 2020. Teil 2</a></li>
<li><a href="../de476290/index.html">Fehlerbehandlung in Express</a></li>
<li><a href="../de476292/index.html">SVG oder Leinwand?</a></li>
<li><a href="../de476294/index.html">Distributed Gaming Network als Alternative zu GFN: Wie und warum kann es abheben, wo es in der Russischen F√∂deration bereits funktioniert</a></li>
<li><a href="../de476296/index.html">21. November, Product Engineering MeetUp: Wer ist ein Produktingenieur?</a></li>
<li><a href="../de476300/index.html">Das Tram-Magazin ist ein hell erleuchteter und schnell verblassender Star der russischen Kinderavantgarde</a></li>
<li><a href="../de476304/index.html">Dongle-Authentifizierung f√ºr Linux-Ger√§tehardware auf Systemen der h√∂chsten Ebene</a></li>
<li><a href="../de476306/index.html">TelegramBot-Anweisungen zum Erstellen grundlegender Funktionen f√ºr den Bot. (Teil 1)</a></li>
<li><a href="../de476308/index.html">Die f√ºnf wichtigsten Methoden zur Softwareentwicklung, die im Jahr 2020 befolgt werden m√ºssen</a></li>
<li><a href="../de476310/index.html">Menschliches Gesicht CRM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>