<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≥ üßñüèª üêü Cr√©ez une cascade √©l√©gante √† partir de RiME directement dans Unity ou UE4 üïäÔ∏è üç≠ üåø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a des jeux avec un visuel si m√©morable qu'il est effrayant de consid√©rer le temps pass√© sur son d√©veloppement, prenez au moins le dernier God of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cr√©ez une cascade √©l√©gante √† partir de RiME directement dans Unity ou UE4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/434620/">  Il y a des jeux avec un visuel si m√©morable qu'il est effrayant de consid√©rer le temps pass√© sur son d√©veloppement, prenez au moins le dernier God of War ou RDR2.  Et il y a des projets qui soudoient avec leur ambiance, m√™me s'ils sont loin de AAA.  √Ä titre d'exemple, RiME a √©t√© lou√© plus d'une fois pour son style, son et histoire.  Et r√©cemment, le concepteur de niveaux du jeu a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rejoint</a> l'√©quipe de CD Projekt Red pour travailler sur Cyberpunk 2077. RiME a √©galement inspir√© l'artiste 3D Math Roodhuizen pour cr√©er son propre art. <br><br>  Et dans le contexte de tout cela, je suis tomb√© sur une ArtStation sur un guide pour cr√©er de l'eau r√©aliste.  Si la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">derni√®re fois</a> on parlait de la rivi√®re, alors cette fois d'une cascade stylis√©e.  Dans la premi√®re partie, nous verrons comment cr√©er un ¬´effet d'onde¬ª, et m√™me directement dans le moteur de jeu.  Pour plus de commodit√©, toutes les √©tapes sont accompagn√©es de gifs et / ou de photos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/uk/aj/8lukajs1s-31mo7gfvimmginvuq.gif"></div><a name="habracut"></a><br>  Tout d'abord, merci √† Simon Trumpler, un artiste de Tequila Games qui a travaill√© sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RiME</a> .  J'√©tais encore nouveau dans les shaders et les effets visuels quand j'ai trouv√© son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mat√©riel</a> et j'ai pens√©: "Wow, je peux faire la m√™me chose?"  Je vous recommande de lire le rapport pour en savoir plus sur les fa√ßons de cr√©er des effets stylis√©s (comme le feu, par exemple). <br><br>  Parlons maintenant de la cr√©ation d'une cascade.  Cela sera particuli√®rement utile pour les personnes qui ne connaissent pas le syst√®me Shader Graph.  Notre objectif: apprendre de nouvelles fa√ßons de travailler et mieux comprendre les shaders. <br><br>  J'utiliserai Unity comme exemple, mais la plupart des m√©thodes sont √©galement applicables dans UE4 - si vous avez l'habitude de travailler l√†-bas, r√©p√©tez simplement apr√®s moi.  Pour plus de commodit√©, chaque √©tape est visualis√©e avec un gif ou une image. <br><br>  Vous aurez donc besoin de: <br><br><ul><li>  Unity 2018. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Amplify Shader Editor</a> (plugin Unity).  Mais si vous ne voulez pas d√©penser d'argent pour cela, installez Unity 2017 et t√©l√©chargez gratuitement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Shaderforge</a> depuis le magasin de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ressources</a> (la nouvelle version du moteur ne prend pas en charge ce plugin, mais il fonctionne toujours dans Unity 2017).  Les deux outils sont presque identiques, sauf que certains points sont appel√©s diff√©remment. </li><li>  Autodesk Maya. </li><li>  Tout pour cr√©er ou √©diter des textures.  J'utilise Photoshop et parfois m√™me Substance Designer (mais vous n'en aurez certainement pas besoin pour cette cascade). </li></ul><br>  Tout d'abord, sur ¬´l'effet d'entra√Ænement¬ª qui se produit lorsqu'une cascade tombe √† la surface.  Il peut √©galement √™tre utilis√© √† d'autres fins, par exemple pour cr√©er des ondulations autour d'objets dans l'eau. <br><br><img src="https://habrastorage.org/webt/ub/jk/o5/ubjko5iypg5csetxipvglwfpjy8.gif"><br><br>  Ouvrez Unity et assurez-vous que le plugin shader est install√©.  Au moment d'√©crire ces lignes, Unity a son propre Shader Graph, qui est toujours en cours de d√©veloppement.  Et bien qu'il ne soit pas pr√™t, je recommande toujours d'utiliser l'√©diteur Amplify Shader pour Unity 2018 ou Shaderforge dans Unity 2017. <br><br>  Cr√©ez un nouveau mat√©riau et donnez-lui un nom (j'ai MAT_WaterWrinkles).  Cliquez ensuite avec le bouton droit sur le mat√©riau dans l'onglet Projet et acc√©dez √† Cr√©er&gt; Amplifier le shader&gt; Surface Shader.  Dans ce cas, le nouveau shader s'applique automatiquement. <br><br>  Vous pouvez s√©lectionner un shader √† tout moment dans l'onglet Mat√©riaux&gt; liste d√©roulante des shaders (pour Shaderforge, il y aura quelque chose comme un shader PBL).  N'oubliez pas que le shader doit √™tre nomm√© √† la fois dans la liste des dossiers et dans le shader lui-m√™me apr√®s son ouverture. <br><br><img src="https://habrastorage.org/webt/8g/05/ve/8g05ve_dflwmkgqywfjpq30crdu.jpeg"><br><br>  D√®s que vous ouvrez un nouveau shader, vous verrez quelque chose comme ceci: <br><br><img src="https://habrastorage.org/webt/7i/ee/pk/7ieepkf2levm_2zi1pjphvgeuue.jpeg"><br><br>  Je n'√©crirai pas de guide d√©taill√© sur l'utilisation de Shader Graph, et si vous √™tes compl√®tement nouveau, lisez d'abord les guides d'introduction. <br><br>  Dans tous les cas, pour obtenir l'effet souhait√©, nous avons d'abord besoin d'un Panner r√©gulier.  Le voici avec la texture de test dans l'avion: <br><br><img src="https://habrastorage.org/webt/83/hd/9f/83hd9fk8wgk-hcuhmoxac7rcz_u.gif"><br><br>  Panner d√©place les coordonn√©es UV.  Assurez-vous que la texture du mode Wrap est d√©finie sur R√©p√©ter.  Dans Shaderforge, vous devrez peut-√™tre connecter un n≈ìud temporaire √† l'entr√©e Panner, pour Amplifier certaines de ces valeurs de base sont d√©j√† incluses dans le n≈ìud lui-m√™me. <br><br>  Nous avons donc une texture en mouvement.  Mais nous voulons atteindre cet effet: <br><br><img src="https://habrastorage.org/webt/ub/jk/o5/ubjko5iypg5csetxipvglwfpjy8.gif"><br><br>  Et pour cela il faut qu'il d√©file comme ceci: <br><br><img src="https://habrastorage.org/webt/lw/ww/em/lwwwemj-vv8amtlxpfkynjek1gq.gif"><br><br>  Comme vous pouvez le voir, la structure du n≈ìud est la m√™me - Panner d√©place simplement les coordonn√©es UV dans les directions U et V (ou X et Y).  Pour obtenir la direction de panoramique souhait√©e, nous devons cr√©er un maillage personnalis√© avec UV.  Gif pour plus de clart√©: <br><br>  En appliquant le m√™me mat√©riau √† un autre maillage, nous pouvons contr√¥ler la direction de la texture dans l'espace 3D lorsqu'elle se d√©place dans l'espace UV. <br><br><img src="https://habrastorage.org/webt/j9/1o/dr/j91odru3w4elitmc02elpxlm00s.gif"><br><br>  Pour am√©liorer l'effet, ajoutez quelques polygones suppl√©mentaires et d√©formez les UV afin que la texture au centre se d√©place plus rapidement que le long des bords.  Et placez les UV de sorte que la couture ne soit pas visible. <br><br><img src="https://habrastorage.org/webt/vs/fv/qy/vsfvqynzumjlprdxippxpz_odqg.jpeg"><br><br>  Une conclusion importante en d√©coule: les bons effets se composent rarement d'un seul syst√®me et sont souvent une combinaison de plusieurs. <br><br>  Nous avons obtenu une texture se d√©pla√ßant dans la bonne direction √† la bonne vitesse.  Le scan UV est positionn√© de sorte que le d√©placement de droite √† gauche dans l'espace UV avec le Panner se transforme en mouvement vers l'int√©rieur et vers l'ext√©rieur dans l'espace 3D.  Pour qu'il n'y ait pas de couture dans la texture sur le mod√®le 3D, vous devez √©pingler le scan UV (raccourci clavier X pour l'accrochage √† la grille) aux sommets de l'espace de texture verticalement.  En cons√©quence, nous avons obtenu l'effet souhait√©. <br><br>  Maintenant la transparence.  Commen√ßons par les choses de base.  De nombreux calculs simples que vous effectuez dans le shader vont de 0 (noir) √† 1 (blanc).  Autrement dit, 0,5 est une nuance de gris et 0,2 est une nuance de gris fonc√©.  Lors de l'application de ces valeurs (dans ce cas, au canal d'opacit√© du n≈ìud de sortie principal), vous contr√¥lerez le niveau de transparence du mat√©riau.  N'oubliez pas que vous devez d'abord activer cette fonction.  Dans Amplify, vous pouvez changer le type de rendu (en mode de fusion) d'opaque en, par exemple, transparent.  Dans ce cas, nous utiliserons le type de rendu D√©coupe transparente - le pixel affich√© par ce mat√©riau est soit compl√®tement transparent soit compl√®tement opaque.  Cela peut √™tre vu dans le gif ci-dessus - il n'y a pas de pixels "translucides" affich√©s par ce shader. <br><br><img src="https://habrastorage.org/webt/0z/v2/zw/0zv2zwyehiurwcxxdvdq9c6jmrg.jpeg"><br><br>  Nous prenons une texture d√©grad√©e avec une √©tape et la pla√ßons dans le shader.  Ici, il se connecte √† la sortie alb√©do (couleur) du n≈ìud principal. <br><br><img src="https://habrastorage.org/webt/ft/vm/x1/ftvmx1e9ujfhpcfcizmjwof5jmy.jpeg"><br><br>  Et ici, il est connect√© √† la sortie du masque d'opacit√© (ce param√®tre est activ√© lorsque le type de rendu est Transparent Cutout). <br><br><img src="https://habrastorage.org/webt/zv/l7/oh/zvl7oholli9y2wtctoafl_gcoda.jpeg"><br><br>  On peut voir que la texture d√©grad√©e utilise des valeurs de pixels noir et blanc pour d√©terminer la transparence ou l'opacit√©.  Tout de 1 (blanc) √† 0,5 (gris) devient opaque, et tout de 0,5 (gris) √† 1 (noir) devient compl√®tement transparent (ou ne s'affiche pas du tout).  Le masque d'opacit√© cr√©e une ligne dure et arrondit les valeurs √† 0 ou 1, selon le nombre le plus proche. <br><br>  Une autre texture en niveaux de gris: <br><br><img src="https://habrastorage.org/webt/ol/_v/ka/ol_vkageq7enmygek80rhan1-hk.jpeg"><br><br>  Connect√© au masque d'opacit√©: <br><br><img src="https://habrastorage.org/webt/cd/9w/jt/cd9wjtycl78kqj0wx_f8mimpnti.jpeg"><br><br>  Vous avez l'id√©e.  Et vous devinez comment il peut √™tre utilis√©: <br><br><img src="https://habrastorage.org/webt/2u/rq/dc/2urqdccavjdibo7blc0frlq-xpk.gif"><br><br>  Vous voyez essentiellement une image bleue d√©filer dans le graphique Shader.  Et le fait que j'utilise uniquement la sortie R (rouge) de ce noeud.  Par souci d'optimisation, j'ai regroup√© deux textures en niveaux de gris (textures en niveaux de gris) dans un fichier, mais ce n'est pas n√©cessaire.  Des images similaires peuvent √™tre regroup√©es √† l'aide de Photoshop ou de Substance Designer. <br><br><img src="https://habrastorage.org/webt/px/7k/6u/px7k6ulmvnbqonfar8_sqjkfzga.jpeg"><br><br>  L'effet d'entra√Ænement est un bon d√©but, mais il peut √™tre meilleur.  Pourquoi ne pas empiler deux textures en niveaux de gris l'une sur l'autre pour rendre l'effet d'entra√Ænement plus al√©atoire? <br><br><img src="https://habrastorage.org/webt/zg/tn/78/zgtn78eo71em4hd8zyosznmyfjy.gif"><br><br>  J'utilise la m√™me texture, mais j'ajoute des canaux diff√©rents.  Je les fais d√©filer √† diff√©rentes vitesses et un peu dans des directions diff√©rentes.  La texture a un bon gradient de valeurs de gris, ce qui donne un sentiment d'effet d'onde al√©atoire. <br><br>  Sur le gif suivant, il y a encore une chose dont nous n'avons pas encore discut√© - donc votre version peut sembler un peu diff√©rente: <br><br><img src="https://habrastorage.org/webt/7u/ow/bn/7uowbnsld8tvgzcl6amkm2wajps.gif"><br><br>  Vous pouvez voir, par exemple, un pixel avec une valeur de 0,2 (qui ne rend pas) passe sur un pixel avec une valeur de 0,4 (qui ne rend pas non plus) et devient soudainement un pixel avec une valeur de 0,6 - puisque nous utilisons un n≈ìud suppl√©mentaire (0,2 ajout√©s √† 0,4 et 0,6).  L'ajout de ces deux textures de niveaux de gris des vagues les unes sur les autres √† des vitesses diff√©rentes donne un effet proche de l'effet souhait√©. <br><br><img src="https://habrastorage.org/webt/2u/rq/dc/2urqdccavjdibo7blc0frlq-xpk.gif"><br><br>  Ici, pour d√©montrer le r√©sultat, j'ai ajout√© des textures de niveaux de gris les unes aux autres dans Photoshop. <br><br><img src="https://habrastorage.org/webt/va/at/uy/vaatuyfg9hr2clslyh3xoskstra.gif"><br><br>  Cependant, la couture √† la fin du maillage est toujours distincte.  Et nous devons obtenir ceci: <br><br><img src="https://habrastorage.org/webt/e-/qs/5f/e-qs5fmcvn2fjqd3jdjxnoty-nw.gif"><br><br>  Au lieu de cela: <br><br><img src="https://habrastorage.org/webt/49/64/w_/4964w_tiq28mxap8bnczbd0tqm8.gif"><br><br>  Sur le premier des deux GIF, les ondulations disparaissent lentement et deviennent plus petites lorsqu'elles approchent du bord de la grille.  La fa√ßon la plus simple de proc√©der consiste √† utiliser la couleur de sommet (couleur de sommet). <br><br>  Chaque sommet du mod√®le contient ses propres donn√©es (par exemple, les coordonn√©es X, Y et Z), ainsi qu'une couleur ayant une valeur de 0 √† 1. La couleur des sommets peut √©galement √™tre d√©finie dans l'√©diteur 3D. <br>  La plupart des sommets ext√©rieurs sont noirs (c'est-√†-dire qu'ils ont une valeur de 0).  Ils deviennent blancs (plus pr√®s de 1) √† l'approche du centre.  Notez que vous aurez besoin de subdivisions suppl√©mentaires pour obtenir des sommets qui peuvent √™tre color√©s. <br><br><img src="https://habrastorage.org/webt/bu/uo/pp/buuoppsouwnxep4s4ujpbbazixk.jpeg"><br><br>  Par exemple, dans Maya, pour la coloration, vous pouvez aller dans le menu Affichage du maillage&gt; Couleur du sommet de la peinture et cliquer sur le champ Plus d'options. <br><br>  Nous pouvons maintenant combiner Vertex Color dans notre shader en utilisant Multiply. <br><br><img src="https://habrastorage.org/webt/66/sm/-w/66sm-wwyze85kybg_srrerrqabo.gif"><br><br>  J'ai appliqu√© un d√©grad√© au-dessus des textures utilis√©es et d√©fini le mode de calque sur Multiplier. <br><br><img src="https://habrastorage.org/webt/xi/wi/d1/xiwid1mg_pfo461adllkdm2t6-k.gif"><br><br>  Le gradient augmente la valeur de gris √† 0 (noir), donc le rendu des pixels sera plus difficile (ils n'apparaissent pas en dessous de la valeur de 0,5).  Cela conduit au fait que les lignes de pulsations sont compress√©es plus pr√®s du bord (les couleurs des sommets agissent principalement comme un gradient). <br><br><img src="https://habrastorage.org/webt/e-/qs/5f/e-qs5fmcvn2fjqd3jdjxnoty-nw.gif"><br><br>  J'ai ajout√© quelques n≈ìuds suppl√©mentaires pour contr√¥ler l'√©paisseur des lignes d'ondulation.  Voici le graphique complet: <br><br><img src="https://habrastorage.org/webt/vu/b-/so/vub-soqrrulpflvlb3xhnzacme8.jpeg"><br><br>  Exp√©rimentez simplement la vitesse / la direction du d√©filement, ajustez la texture et essayez de changer la mosa√Øque pour tirer le meilleur parti de l'effet. <br><br>  Cela nous aidera √† cr√©er un shader plus complexe - une cascade.  Nous parlerons de lui dans la prochaine partie. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr434620/">https://habr.com/ru/post/fr434620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr434598/index.html">Un regard sur l'avenir ou sur les changements √† venir dans l'industrie mini√®re jusqu'en 2050</a></li>
<li><a href="../fr434602/index.html">Comment Google a tent√© de conqu√©rir la Chine - et a perdu</a></li>
<li><a href="../fr434604/index.html">Comment ne pas √©crire de mod√®les pour bootstrap</a></li>
<li><a href="../fr434616/index.html">Le HI-FI sovi√©tique et ses cr√©ateurs: l'enregistrement sonore num√©rique en URSS - √† deux pas de la victoire</a></li>
<li><a href="../fr434618/index.html">MVP et Dagger 2 - Squelette d'application Android - Partie 2</a></li>
<li><a href="../fr434622/index.html">Quels mondes peuvent survivre apr√®s la mort du soleil?</a></li>
<li><a href="../fr434624/index.html">Comment j'ai trouv√© un bug dans GNU Tar</a></li>
<li><a href="../fr434626/index.html">Nouveau t√©l√©chargeur Buhtrap</a></li>
<li><a href="../fr434628/index.html">bitContainer (pour la nourriture) - Yandex.Station fait maison</a></li>
<li><a href="../fr434634/index.html">Universal Radio Hacker - Un moyen facile d'explorer les protocoles radio num√©riques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>