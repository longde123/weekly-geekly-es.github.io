<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüëß‚Äçüë¶ üñ±Ô∏è ‚ôÇÔ∏è Montre LED Shadowplay sur la plate-forme Arduino Uno üéÖüèø üçÜ ‚ö†Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au lieu de rejoindre
 
 
 Notre √©quipe de trois personnes a donc eu la t√¢che de monter un petit projet mat√©riel en tr√®s peu de temps, de pr√©f√©rence su...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Montre LED Shadowplay sur la plate-forme Arduino Uno</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394107/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au lieu de rejoindre</font></font></h3><br>
<img src="https://habrastorage.org/files/48b/451/4a6/48b4514a6fd144ba8e19798a1588bd87.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre √©quipe de trois personnes a donc eu la t√¢che de monter un petit projet mat√©riel en tr√®s peu de temps, de pr√©f√©rence sur la plateforme Arduino. </font><font style="vertical-align: inherit;">Il convient de mentionner que jusqu'√† ce moment, nous √©tions familiers avec les circuits, pour la plupart, en th√©orie. </font><font style="vertical-align: inherit;">Et cela signifie - ni exp√©rience avec un fer √† souder (pratiquement), ni, surtout, exp√©rience avec Arduino. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soudain, nous sommes tomb√©s sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©di√© au projet Shadowplay Clock. </font><font style="vertical-align: inherit;">Il s'agit d'une horloge murale con√ßue par une √©quipe de designers viennois, le temps par lequel vous pouvez voir en touchant un doigt vers leur centre. </font><font style="vertical-align: inherit;">Les LED s'allument de telle sorte que l'ombre du doigt au centre indique l'heure. </font><font style="vertical-align: inherit;">Il a √©t√© d√©cid√© de cr√©er le m√™me (ou tr√®s similaire), mais √† la maison. </font><font style="vertical-align: inherit;">L'article ci-dessus, comme vous pouvez le voir, ne contient pas de description d√©taill√©e du projet. </font><font style="vertical-align: inherit;">De tout cela, il s'ensuit que nous-m√™mes avons d√ª comprendre comment cet appareil fonctionne et lui donner vie. </font><font style="vertical-align: inherit;">En fait, ce que nous avons fait.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mat√©riaux</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour cr√©er une montre dont vous avez besoin:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©bauches de panneaux de fibres</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bande de diodes 60 LED</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arduino uno</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Module d'horloge en temps r√©el RTC DS1307</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bouton</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> planche √† pain</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registre √† d√©calage 74HC595 (x2)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verrou de registre 8 bits 74HC573N (x8)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d√©codeur 4-16 K155ID3 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> onduleur √† drain ouvert IN74HC05AN (x10)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unit√© de puissance </font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commen√ßons</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'algorithme de l'appareil:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque l'alimentation est appliqu√©e, les LED s'allument selon une combinaison pr√©d√©termin√©e. </font><font style="vertical-align: inherit;">Dans le Shadowplay original, toutes les LEDs se sont allum√©es, mais il nous a sembl√© qu'il serait plus int√©ressant de lancer une combinaison comme √©conomiseur d'√©cran.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque le bouton est enfonc√© (oui, nous nous sommes √©galement √©loign√©s de l'original et ins√©r√© un petit bouton au centre), l'heure est lue depuis le module RTC.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le temps de lecture est converti en code binaire (masque) et entr√© dans des registres.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selon le masque, la diode requise est allum√©e.</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mat√©riel informatique</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsque nous avons finalement d√©cid√© de l'id√©e du projet, la premi√®re chose que nous avons essay√©e a √©t√© de dessiner mentalement des versions approximatives des sch√©mas pour sa mise en ≈ìuvre. La principale question √©tait de savoir comment traiter 60 LED. En fait, la r√©ponse √† cette question a d√©termin√© la m√©thode de construction de presque tout le sch√©ma. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re option qui m'est venue √† l'esprit √©tait l'utilisation de d√©codeurs. Le circuit compil√© √©tait une cascade de quatre d√©codeurs 4-16 et d'un d√©codeur 2-4, tous deux avec des entr√©es d'activation de d√©chiffrement. Une telle cascade a permis d'adresser √† 64 sorties, ce qui √©tait plus que suffisant pour connecter 60 LED.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, la question s'est pos√©e de savoir comment faire fonctionner plus d'une LED (adresse) en m√™me temps (apr√®s tout, nous devions fournir √† l'horloge au moins les minutes et les aiguilles). Ici, le principal inconv√©nient de ce sch√©ma s'est manifest√© - le d√©codeur ne peut, par d√©finition, pas adresser plus d'une sortie √† la fois. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette faille nous a oblig√©s √† abandonner l'id√©e avec une cascade de d√©codeurs. De plus, nous avons maintenant une autre exigence pour le futur circuit: la prise en charge du fonctionnement simultan√© d'un nombre diff√©rent de LED.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour satisfaire cette exigence, nous avons pens√© qu'il √©tait possible de permettre √† chaque LED de stocker son √©tat. Les registres sont bien adapt√©s √† cet effet, o√π chaque d√©charge individuelle correspond √† l'√©tat de l'une des LED. Nous avons d√©cid√© d'utiliser des registres 8 bits, car ils sont plus courants et plus pratiques. Par cons√©quent, dans notre circuit, nous aurons besoin de 8 registres de ce type pour prendre en charge 60 LED.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous avons r√©fl√©chi √† la fa√ßon de contr√¥ler l'√©tat des LED avec Arduino via des registres. Chaque registre pour un fonctionnement normal devrait recevoir les 8 bits dans leur int√©gralit√©. Arduino Uno, bien s√ªr, fournit suffisamment de sorties pour transmettre plusieurs bits √† la fois, mais cette approche ne sera pas rationnelle. De plus, le sch√©ma ne contient que 8 registres, ce qui signifie que vous devez en quelque sorte les adresser. A cet effet, nous avons ajout√© un d√©codeur et deux registres √† d√©calage 8 bits connect√©s en cascade au circuit. Un registre √† d√©calage stocke un masque d'√©tat √† 8 bits, qui sera charg√© dans l'un des 8 registres r√©guliers, dont le nombre est stock√© dans le deuxi√®me registre √† d√©calage. Par cons√©quent, un d√©codeur est connect√© au deuxi√®me registre √† d√©calage. √Ä ces fins, un d√©codeur 3 x 8 est tout √† fait suffisant.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour supprimer l'inversion du nombre de sorties requis, nous avons utilis√© deux circuits onduleurs KR1533LN1. Bien s√ªr, cela compliquait quelque peu le sch√©ma. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une autre t√¢che √©tait la tension de travail des LED √©gale √† 12 volts contre 5 volts de circuits logiques. La solution propos√©e consistait √† utiliser un onduleur √† drain ouvert. Un tel microcircuit joue le r√¥le d'une touche qui ferme (avec 1 logique) ou ouvre (avec 0 logique) l'un des contacts de la LED avec le sol, allumant ou √©teignant ainsi la LED. Le circuit suppose un fonctionnement √† partir de 12 volts, conform√©ment √† la tension de fonctionnement des LED, donc afin d'obtenir 5 volts pour les circuits logiques, le stabilisateur KR142EN5A avec deux condensateurs a √©t√© ajout√© au circuit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certaines entr√©es de certains microcircuits impliquent une valeur constante √† l'entr√©e, elles √©taient donc connect√©es √† la terre ou √† une source d'alimentation. </font><font style="vertical-align: inherit;">Dans ce cas, ce sont les entr√©es suivantes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'entr√©e de r√©initialisation MR inverse dans les deux registres √† d√©calage est connect√©e via le registre de charge √† la sortie du stabilisateur √† 5 volts.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'entr√©e de validation de sortie OE inverse dans les deux registres √† d√©calage est directement connect√©e √† la masse.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©codeur inverse permettant l'entr√©e E0 connect√©e √† la masse</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/files/994/7dc/3c6/9947dc3c61754b44b034f4670f846fbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le circuit est contr√¥l√© par quatre entr√©es (E1, SH, ST, DS). </font><font style="vertical-align: inherit;">Le but et les niveaux de signal de chacun d'eux sont discut√©s plus en d√©tail ci-dessous:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'entr√©e E1 est con√ßue pour activer le d√©codeur. Dans notre cas, initialement sur le d√©codeur, il y a deux entr√©es de commande E1, E0, et les deux sont inverses. Il y aura suffisamment d'une sortie, de sorte que la seconde (E0) puisse √™tre amen√©e au sol. L'√©tat de d√©codeur ¬´par d√©faut¬ª est op√©rationnel jusqu'√† ce qu'un niveau de signal √©lev√© soit appliqu√© √† E1. Pour faire le contraire, nous avons connect√© cette entr√©e √† l'onduleur. Sans cela, le d√©codeur peut donner des signaux de commande incorrects aux registres, par exemple, au moment de la mise √† jour des donn√©es dans le registre √† d√©calage. Comme d√©j√† mentionn√©, un d√©codeur 3 x 8 peut √™tre utilis√© dans le circuit, qui peut avoir une entr√©e de commande non inverse, ce qui permettra de r√©soudre facilement tous les probl√®mes d√©crits ci-dessus sans fils suppl√©mentaires et sans fer √† souder.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lorsqu'un seul niveau de signal est appliqu√© √† E1, le d√©codeur d√©code l'adresse de registre situ√©e dans le registre √† d√©calage correspondant et envoie un signal √† la sortie souhait√©e. Apr√®s cela, le d√©codeur s'√©teint √† nouveau en appliquant un niveau de signal faible √† E1. Un tel commutateur du d√©codeur g√©n√®re un signal √† la sortie souhait√©e, dont le front et la d√©croissance servent d'impulsion d'horloge de registre pour capturer en soi les donn√©es stock√©es sur le bus.</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les trois entr√©es suivantes sont d√©j√† destin√©es au contr√¥le des registres √† d√©calage. Cela vaut la peine de commencer par la chose la plus simple: la saisie de donn√©es DS. Cette entr√©e, comme son nom l'indique, est destin√©e √† la transmission de donn√©es. Les registres √† d√©calage du circuit √©tant connect√©s en cascade, le DS repr√©sente la sortie correspondante de l'un d'entre eux. L'entr√©e du deuxi√®me registre √† d√©calage est connect√©e √† la sortie du dernier bit du premier registre. Le r√©sultat est un registre √† d√©calage pour 16 bits, dont seulement 12 bits sont utilis√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'entr√©e SH est une entr√©e d'horloge. Une onde carr√©e est envoy√©e √† cette entr√©e, qui est responsable du chargement et du d√©calage des donn√©es dans chacun des registres, respectivement, ce contact du circuit est connect√© aux broches SHCP des deux registres.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La derni√®re broche ST sert de verrou de donn√©es sur les sorties du registre. Une impulsion est donn√©e √† cette entr√©e, cependant, elle n'est fournie que lorsque les donn√©es dans le registre √† d√©calage sont finalement charg√©es et il est n√©cessaire de les fixer √† la sortie des registres. Ce n'est qu'apr√®s avoir donn√© ce signal que les donn√©es t√©l√©charg√©es √† l'int√©rieur du registre sur la premi√®re rang√©e de d√©clencheurs arrivent sur la deuxi√®me rang√©e de d√©clencheurs et deviennent disponibles sur le bus. ST est une broche connect√©e aux broches STcp des deux registres. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Reste √† expliquer le c√¢blage des deux broches des registres √† d√©calage MR et OE. La premi√®re entr√©e (MR) est responsable du dumping des donn√©es dans le registre. Dans ce circuit, une telle opportunit√© n'est pas requise, par cons√©quent, un niveau de signal √©lev√© est fourni √† cette sortie via la charge.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxi√®me entr√©e de registre (OE) est charg√©e de d√©connecter la deuxi√®me rang√©e de d√©clencheurs √† l'int√©rieur du registre √† d√©calage du bus, c'est-√†-dire l'entr√©e de validation. </font><font style="vertical-align: inherit;">Cette fonction n'est √©galement pas requise, par cons√©quent, la sortie est enroul√©e √† la terre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un autre contact non d√©crit ci-dessus est con√ßu pour supprimer le niveau du signal du bouton au centre de la montre, le sch√©ma des boutons est typique et repr√©sente une charge et une cl√©, selon la position dont un niveau de signal bas ou √©lev√© est envoy√© √† l'Arduino. </font><font style="vertical-align: inherit;">Selon l'√©tat du bouton, la montre fonctionne soit en mode √©conomiseur d'√©cran, soit en mode affichage de l'heure.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La connexion √† l'Arduino n'a pas de caract√©ristiques sp√©ciales, sauf que la broche SH est id√©alement connect√©e √† la broche num√©rique SCK. </font><font style="vertical-align: inherit;">Le reste des sorties du circuit peut √™tre connect√© √† n'importe laquelle des entr√©es num√©riques √† usage g√©n√©ral disponibles. </font><font style="vertical-align: inherit;">Dans notre cas, la connexion a la forme suivante:</font></font><br>
<br>
<ul>
<li>Arduino pin13 (SCK) ‚Äì   SH</li>
<li>Arduino pin 11 ‚Äì   ST Arduino pin 8 ‚Äì   DS Arduino pin 5 ‚Äì   E1 Arduino pin 3 ‚Äì   Arduino pin GND ‚Äì   (      )<br>
       ,      .<br>
<br>
    :   36  ‚Äî   ;    36  ( ) \ 26  ( ) ‚Äî  .   Shadowplay    72 ,     36.     ,    60  ( + ).     .   ,   ,     ,      .<br>
<br>
<img src="https://habrastorage.org/files/c46/3ff/f0b/c463fff0b95e402eaf9b4274301f04ba.jpg"><br>
<br>
  ,     .      ,    .   ,      .      ,  ¬´¬ª    50 ‚Äî 60,        . , 60   .  :      ‚Äî   .<br>
<br>
<img src="https://habrastorage.org/files/871/643/435/87164343503642ba802ead947d81ab6a.JPG"><br>
<br>
   ,  ,    ,  .      ‚Äî     . ,         ,    .  ,   ‚Äî  .<br>
<br>
<div class="spoiler"><b class="spoiler_title">      .</b><div class="spoiler_text"><img src="https://habrastorage.org/files/f95/9cc/f6d/f959ccf6d1c34b58ac31411eb3477a99.jpg"><br>
</div></div><br>
-,  .<br>
<br>
     Shadowplay.  ,       ,    . ,    ,       .      , ..     .        ,  ,       100% .    ,       .       .     ,         .  ,               .<br>
<br>
 ,      (       ),     ,    ‚Äî    . ,  ,   !    .   ,  - -   . ,   ,    .             ,     ,           .   ,     ,    ,   .     .,     -         .    ,      ,   , ,   ,     . <br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/uy-cLHOz-5M%3Ffeature%3Doembed&amp;usg=ALkJrhjYFSgCSV_fUwtnPkJosRoo7dmnLA" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 ,     .         . ..   ,     , ( ,      ,         ),      . <br>
<br>
<h4> </h4><br>
,     ().      Arduino.  ,    RTC,   ‚Äî    .      DS1307,   ‚Äî I2C.       2100     .          .     RTC  Arduino,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>.         RTC.<br>
<br>
<img src="https://habrastorage.org/files/c76/129/084/c761290840164f52a699e8f7d0c23a50.jpg"><br>
<br>
     ,      RTC,         .<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"> <pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Time.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DS1307RTC.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> REG [<span class="hljs-number"><span class="hljs-number">8</span></span>];<font></font>
tmElements_t te;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c,reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">13</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">11</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">8</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">5</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, INPUT);   <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
  <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//      RTC  </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Hour = 18;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Minute = 50;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Second = 0;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Day = 20; //</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Month = 4; // </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Year = CalendarYrToTm(2016); </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//RTC.write(te);</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{ 
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>))                    <span class="hljs-comment"><span class="hljs-comment">// ,     </span></span><font></font>
  {RTC.read(te);<font></font>
   SetShadowTime(te.Hour,te.Minute,te.Second,<span class="hljs-number"><span class="hljs-number">2</span></span>);        <span class="hljs-comment"><span class="hljs-comment">//         </span></span>
   delay(<span class="hljs-number"><span class="hljs-number">900</span></span>);<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>                                   <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span><font></font>
  {wait1();<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
                                         <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,<span class="hljs-number"><span class="hljs-number">0</span></span>); <font></font>
   <font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//======================================================================= </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUpLightByMask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RegNum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LightMask)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//         </span></span></span><span class="hljs-function">
</span></span>{<font></font>
  <font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, LOW);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, LOW);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, MSBFIRST, LightMask);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, LSBFIRST, RegNum);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, HIGH);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digitalClockDisplay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{  <span class="hljs-comment"><span class="hljs-comment">//    RTC  ,    RTC  </span></span><font></font>
  RTC.read(te);<font></font>
  Serial.print(te.Hour);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" : "</span></span>);<font></font>
  Serial.print(te.Minute);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" :"</span></span>);<font></font>
  Serial.print(te.Second);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Day);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Month);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(tmYearToCalendar(te.Year));<font></font>
  Serial.println();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ,     , ,        :</span></span>
<span class="hljs-comment"><span class="hljs-comment">//0 -  ,1 -   , 2 -    </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetShadowTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hours, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Minutes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Seconds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param)</span></span></span></span>{   
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h,hshift,m,s;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) REG[j] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Hours &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) Hours -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  h = Hours + <span class="hljs-number"><span class="hljs-number">6</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(h &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) h -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
    <font></font>
  hshift = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Minutes / <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  <font></font>
  REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
             <font></font>
   <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">1</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
   }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
     <font></font>
   s = Seconds + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(s &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) s -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(s%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,REG[j]);<font></font>
  }<font></font>
  <font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wait1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    </span></span></span><span class="hljs-function">
</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">0</span></span>;
     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       c = c | <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);  <font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);   <font></font>
      }<font></font>
   }<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">255</span></span>;
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);<font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);     <font></font>
      }<font></font>
    }  <font></font>
}<font></font>
</code></pre> <br>
</div></div><br>
<h4></h4><br>
    .         .      (Arduino, RTC)     .      ,   .       ,    ¬´- ¬ª.   ‚Äî   .  :<br>
<br>
    .<br>
<br>
<div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.slideshare.net/slideshow/embed_code/61634811&amp;usg=ALkJrhi_TsKj7RBQmVH3uOM3MrlgsVpg6A" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br>
<br>
   ,       ¬´¬ª:<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/KbbakER89U0%3Ffeature%3Doembed&amp;usg=ALkJrhhlBuf5qNqUItaQ55nCOEd5MkNT8w" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 , ,    :<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/SIPI6ug_dls%3Ffeature%3Doembed&amp;usg=ALkJrhihpYTRtms6Dx9TzmMk73SJHpdWlg" frameborder="0" allowfullscreen=""></iframe><br>
<br>
    ,  ,   ,   . <br>
<br>
 ,  ,     .   ,    ?      .     :         ( ,     ,  ..). ,   ,  ,         .        . ,     .<br>
<br>
<h4></h4><br>
  ?<br>
<br>
<ul>
<li>,    ,   .</li>
<li>       .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La possibilit√© de modifier facilement par programmation la s√©quence des LED clignotantes, ce qui donne une vari√©t√© infinie de combinaisons.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ne revendiquons pas l'exactitude absolue de nos circuits et solutions logicielles. </font><font style="vertical-align: inherit;">Comme d√©j√† mentionn√©, l'exp√©rience n√©gative est √©galement une exp√©rience. </font><font style="vertical-align: inherit;">Peut-√™tre que cet article aidera quelqu'un √† √©viter nos erreurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci de votre attention!</font></font></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr394107/">https://habr.com/ru/post/fr394107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr394095/index.html">Comment les √©coliers du Hackathon de la NASA inversent la conception d'un bracelet de fitness pour contr√¥ler un drone</a></li>
<li><a href="../fr394097/index.html">[HAINE] La douleur. Format RusMARC</a></li>
<li><a href="../fr394101/index.html">Sondage: quelle langue est utilis√©e dans votre syst√®me d'exploitation</a></li>
<li><a href="../fr394103/index.html">Vent et glace sur Mars</a></li>
<li><a href="../fr394105/index.html">L'√©couvillon Bluetooth intelligent vous indique quand il est temps de changer</a></li>
<li><a href="../fr394111/index.html">Combien de temps ou o√π stocker rapidement les informations sur le disque</a></li>
<li><a href="../fr394113/index.html">AOC et Jide ont sorti des PC tout-en-un sur Remix OS</a></li>
<li><a href="../fr394115/index.html">Quelle est votre id√©e?</a></li>
<li><a href="../fr394123/index.html">Minecraft Gameband - un bracelet pour les joueurs</a></li>
<li><a href="../fr394125/index.html">Windows 7 install√© sur les smartphones LG G Watch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>