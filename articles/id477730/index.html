<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤾🏻 👶🏻 🧙🏿 ChipWhisperer: Serangan Energi pada Magma 👨🏻‍🎨 📶 👸🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Diposting oleh rakf 





 Sebagai bagian dari Summer of Hack 2019 di Digital Security, saya berurusan dengan serangan daya dan bekerja dengan ChipWhi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ChipWhisperer: Serangan Energi pada Magma</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/477730/"><p>  Diposting oleh <a href="https://habr.com/ru/users/rakf/" class="user_link">rakf</a> </p><br><p><img src="https://habrastorage.org/webt/t1/qx/44/t1qx44fuppd2dlfmn-vvb6fsriq.jpeg"></p><br><p>  Sebagai bagian dari Summer of Hack 2019 di Digital Security, saya berurusan dengan serangan daya dan bekerja dengan ChipWhisperer. </p><br><h2 id="chto-eto">  Apa ini </h2><br><p>  Analisis energi adalah jenis serangan melalui saluran pihak ketiga.  Yaitu, serangan yang menggunakan informasi yang muncul sebagai akibat dari implementasi fisik sistem. </p><br><p>  Informasi apa yang mungkin berguna bagi penyerang: </p><br><ul><li>  waktu konversi kriptografi; </li><li>  konsumsi daya; </li><li>  medan elektromagnetik; </li><li>  kebisingan dll </li></ul><br><p>  Serangan energi dianggap yang paling universal. </p><a name="habracut"></a><br><h2 id="pochemu-rabotaet">  Mengapa ini berhasil? </h2><br><p>  Mikroprosesor, mikrokontroler, RAM, dan banyak sirkuit logika lainnya didasarkan pada teknologi CMOS.  Konsumsi daya sirkuit CMOS terdiri dari dua komponen: statis dan dinamis.  Konsumsi daya statis sangat kecil, yang merupakan salah satu alasan monopolisasi teknologi.  Daya dinamis disebabkan oleh pengalihan transistor dan tergantung pada data yang diproses dan operasi yang dilakukan.  Karena komponen statis terutama konstan, perubahan daya total disebabkan oleh daya dinamis dan, karenanya, konsumsi energi total dapat digunakan untuk analisis. </p><br><h2 id="instrumentariy">  Toolkit </h2><br><p>  <a href="https://newae.com/tools/chipwhisperer/">ChipWhisperer</a> , saya menggunakan versi 2-bagian: </p><br><p><img src="https://habrastorage.org/webt/56/p3/p4/56p3p4nq89l3drktqn9c0eo1mta.jpeg" alt="Versi 2 Bagian ChipWhisperer"></p><br><p>  ChipWhisperer adalah toolkit open source untuk meneliti keamanan perangkat yang disematkan.  Ini memungkinkan analisis energi dan serangan berbasis kesalahan. </p><br><p>  Biaya akan dikenakan biaya $ 250.  Pengembang memposisikannya sebagai solusi revolusioner, karena kompleks seperti itu, menurut pencipta, harganya mulai $ 30k.  Perangkat ini terdiri dari 2 papan: papan target dan papan tangkap. </p><br><p>  Ada versi lain, dengan kelebihan mereka (tetapi juga dengan biaya yang besar), Anda juga dapat secara terpisah membeli berbagai papan target, kartu ekspansi, menyelidiki untuk analisis penuh perangkat Anda dan menggunakan ChipWhisperer hanya untuk menghapus. </p><br><p>  ChipWhisperer memiliki <a href="https://wiki.newae.com/Main_Page">wiki yang</a> sangat baik, <a href="https://chipwhisperer.readthedocs.io/en/latest/tutorials.html">laboratorium</a> pengembangan kecil, dan pada versi ke 5 mereka bahkan membuat <a href="https://chipwhisperer.readthedocs.io/en/latest/api.html">dokumentasi</a> API yang baik.  Lagu dihapus dari perangkat yang terhubung menggunakan perangkat lunak mereka dan dicatat sebagai array NumPy. </p><br><p>  Pertama, Anda perlu menulis firmware untuk perangkat target.  Sebagai bagian dari lab, cipher AES, DES, TEA dipertimbangkan.  Bagi mereka, sudah ada firmware siap pakai dan pengaturan untuk menghapus jejak (jumlah sampel yang akan diambil, offset, frekuensi ADC, dll.).  Untuk pengaturan penelitian independen harus dipilih secara eksperimental. </p><br><p>  Seperti disebutkan di atas, Anda dapat memprovokasi kegagalan papan target: menyebabkan kerusakan sinyal jam, melewatkan instruksi dan mengekstrak informasi rahasia. </p><br><p>  Dalam kompleks besar, osiloskop digunakan untuk melacak jejak. </p><br><h2 id="analiz">  Analisis </h2><br><p>  Ada beberapa metode analisis dasar: </p><br><ul><li>  analisis daya sederhana (SPA); </li><li>  analisis daya diferensial (DPA); </li><li>  analisis korelasi daya (CPA). </li></ul><br><p> Analisis daya sederhana mencakup analisis visual grafik daya.  Misalnya, kata sandi dapat diperoleh satu karakter pada satu waktu dengan mengamati profil daya ketika karakter yang benar dimasukkan dan membandingkannya dengan yang salah. </p><br><p><img src="https://habrastorage.org/webt/ep/rf/tg/eprftggxt26idk5tq4uccp3p9kq.png" alt="Analisis kekuatan kata sandi"></p><br><p>  Atau Anda dapat melihat putaran enkripsi di trek.  Tidak cukup data untuk mendapatkan kunci, tetapi dapat diasumsikan algoritma mana yang dieksekusi.  Angka tersebut jelas menunjukkan 10 putaran AES. </p><br><p><img src="https://habrastorage.org/webt/ib/pl/e7/ibple7hxooxtxb1bkah2d1k-i_s.png" alt="AES SPA"></p><br><p>  Analisis diferensial (DPA) jauh lebih efisien daripada analisis sederhana, DPA didasarkan pada metode analisis statistik untuk mendeteksi perbedaan dalam jejak daya.  Namun, alat yang sangat efektif untuk "membuka" kunci akan membutuhkan sejumlah besar rute.  Saya tidak menggunakan metode ini untuk analisis, tetapi pada akhirnya saya akan memberikan beberapa tautan ke sumber yang dijelaskan dengan baik. </p><br><p>  Dasar analisis korelasi adalah perangkat statistik untuk menentukan kunci enkripsi rahasia.  Kadang-kadang itu diisolasi dalam tipe yang terpisah, kadang-kadang disebut sebagai DPA.  Metode ini membutuhkan lebih sedikit jejak daripada DPA, saya menggunakannya untuk analisis daya.  Saya akan memberi tahu Anda lebih banyak tentang hal itu. </p><br><p>  Tugas utama adalah membangun model konsumsi energi yang akurat dari perangkat yang diteliti.  Jika model yang akurat dibangun, ada korelasi yang nyata antara nilai yang diprediksi dan yang sebenarnya. </p><br><p>  Salah satu model kekuatan yang dapat digunakan adalah model berat Hamming.  Berat Hamming adalah jumlah nilai non-nol dalam representasi biner.  Asumsi model ini adalah bahwa jumlah bit yang diatur dalam register akan berkorelasi dengan energi yang dikonsumsi oleh perangkat.  Berat Hamming sendiri digunakan selanjutnya sebagai unit energi konvensional.  Model jarak Hamming juga digunakan - jumlah bit berbeda dalam 2 nilai. </p><br><p>  Untuk membandingkan model berat Hamming dan konsumsi daya nyata, koefisien Pearson linier digunakan.  Ini menunjukkan ketergantungan linear dari satu kuantitas pada kuantitas lainnya.  Dengan model yang dibangun dengan benar, koefisien ini akan cenderung ke 1. </p><br><p>  Algoritma BPA umum terdiri dari langkah-langkah utama berikut: </p><br><ul><li>  hapus konsumsi daya saat mengonversi pesan pada tombol yang tidak dikenal; </li><li>  kami membangun model konsumsi energi chip ketika mengonversi pesan yang sama pada semua varian kunci sub-blok (256 opsi untuk setiap byte); </li><li>  kami menemukan koefisien korelasi linier untuk konsumsi daya yang disimulasikan dan nyata.  Dalam kasus kunci sejati, koefisien akan cenderung ke 1; </li><li>  algoritme diulang untuk sub-blok kunci yang tersisa. </li></ul><br><p>  Akibatnya, kunci dikembalikan secara berurutan, dalam bagian-bagian kecil.  Jika kita menyerang satu byte kunci pada suatu waktu, maka kita menggunakan 2 <sup>8</sup> upaya untuk setiap kunci.  Misalnya, jika Anda memilih AES - 128, maka jumlah total upaya untuk 16 byte kunci adalah 2 <sup>12</sup> , yang jauh lebih baik daripada menekan 2 <sup>128</sup> . </p><br><h3 id="analiz-shifra-magma">  Analisis Sandi Magma </h3><br><p>  Magma adalah kode yang didefinisikan dalam GOST R 34.12-2015, pada kenyataannya GOST 28147-89 yang sama, hanya dalam profil.  Blok terenkripsi melewati 32 putaran di mana beberapa transformasi terjadi.  Kunci terdiri dari 256 bit, setiap tombol bulat adalah bagian dari aslinya. </p><br><p><img src="https://habrastorage.org/webt/il/lf/jg/illfjg84nei10xf2xgboiifkmjy.png" alt="Fungsi Feistel GOST"></p><br><p>  Kami akan menganalisis data yang diperoleh menggunakan metode CPA. </p><br><p>  Pertama, Anda perlu memilih nilai menengah dari algoritma, yang tergantung pada data yang diketahui dan sebagian kecil dari kunci dan dapat dihitung dengan transformasi sederhana.  Biasanya nilai ini adalah output S-box (Magma sekarang memiliki 1 tabel substitusi, oleh karena itu lebih mudah untuk melakukan serangan seperti itu) dari yang pertama (teks terbuka diketahui) atau babak terakhir (cipherteks dikenal). </p><br><p>  Saya meneliti kunci dengan teks terbuka terkenal, oleh karena itu opsi ini akan dipertimbangkan lebih lanjut.  Dalam algoritma Magma, tidak seperti DES, AES, penambahan blok 32-bit dengan kunci bulat terjadi modulo 2 <sup>32</sup> , oleh karena itu, lebih baik untuk memulai analisis dari output terakhir dari S-box, karena menambahkan nilai tertinggi tidak mempengaruhi yang lebih muda.  Kami mempertimbangkan output dari masing-masing S-box: pertama 8, kemudian diberikan 8, 7 dan seterusnya sampai yang pertama.  Penghapusan trek dilakukan pada mikrokontroler 8-bit, dan kita dapat mengasumsikan bahwa itu bekerja dengan dual S-box.  Karena itu, saya akan menyerang segera dengan 1 byte. </p><br><p>  Perhitungan model energi untuk byte kunci terakhir: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[leak("Gost28147_tc26_ParamZ", kguess, block2ns(text[tnum])[0], 0)]</span></span></code> </pre> <br><p>  di mana fungsi kebocoran hanya mengembalikan output S-box dari byte terakhir. </p><br><p>  Kami menghitung koefisien Pearson linier untuk nilai-nilai yang disimulasikan dan nyata sesuai dengan rumus: </p><br><p><img src="https://habrastorage.org/webt/yt/wd/f-/ytwdf-ah0p0fshbi-i83_tldkvs.png" alt="Korelasi"></p><br><pre> <code class="python hljs"> cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-comment"><span class="hljs-comment">#Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span></span></code> </pre> <br><p>  Saat memilih subkunci sejati, koefisien korelasi akan memiliki lonjakan yang signifikan: </p><br><p><img src="https://habrastorage.org/webt/8o/7j/8z/8o7j8zrfxosgutb_eymflrxxhp0.png" alt="Korelasi1"></p><br><p>  Dengan demikian, setiap byte dari tombol bulat dianalisis. </p><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number"><span class="hljs-number">8</span></span>) | best_round ...</code> </pre> <br><p>  Mengingat kunci putaran pertama, kita dapat menghitung 2 dan tombol putaran berikutnya dengan cara yang sama.  Kunci Magma lengkap dapat diperoleh dengan mengeluarkan 8 kunci bulat. </p><br><p>  Dalam proses penyelesaian masalah ini, beberapa nuansa muncul.  Tidak seperti AES, DES, cipher Belalang, penambahan kunci putaran plaintext terjadi modulo 2 <sup>32</sup> .  Penambahan bit rendah mempengaruhi tinggi, tidak seperti XORa.  Saat menghitung setiap subkunci berikutnya, Anda harus memperhitungkan hasil dari masa lalu.  Begitu pula dengan tombol bulat.  Data ini sangat sensitif.  Jika salah satu nilai dihitung secara tidak benar, perhitungan lebih lanjut dari seluruh kunci akan salah. </p><br><p>  Perlu juga dipertimbangkan bahwa sekarang cukup sulit untuk menemukan chip yang memiliki arsitektur empat-bit: sebagian besar chip memiliki delapan-bit.  Tentu saja, ada chip kriptografi khusus yang dirancang untuk algoritma konversi keamanan tertentu (atau beberapa algoritma) dan memiliki arsitektur paling efisien. </p><br><p>  Untuk menjalankan DES cipher, prosesor kripto tersebut dapat memiliki arsitektur enam-bit, untuk Magma - empat-bit, yang memungkinkan setiap kotak-S diproses secara terpisah.  Perangkat target saya adalah 8-bit, dan dalam kasus "Magma", konversi akan dilakukan pada delapan bit dalam satu pendekatan, yaitu  penggantian akan dilakukan pada 2 S-box, konsumsi daya akan dipertimbangkan untuk 2 S-box.  Jika salah satu S-box, senior atau junior, cocok dengan kunci sebenarnya, dan yang lain tidak cocok, ledakan korelasi tinggi dapat terjadi. </p><br><p>  Dengan semua hal di atas, pada output kami memiliki skrip berikut untuk analisis jalur konsumsi energi untuk cipher Magma: </p><br><div class="spoiler">  <b class="spoiler_title">Skrip python</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np path = <span class="hljs-string"><span class="hljs-string">r'C:\Users\user\chipwhisperer\projects\gost_10000_2_data\traces\2019.08.11-19.53.25_'</span></span> traces = np.load(path + <span class="hljs-string"><span class="hljs-string">'traces.npy'</span></span>) text = np.load(path + <span class="hljs-string"><span class="hljs-string">'textin.npy'</span></span>) keys = np.load(path + <span class="hljs-string"><span class="hljs-string">'keylist.npy'</span></span>) HW = [bin(n).count(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">256</span></span>)] SBOXES = {<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>: ( (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), (<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), )} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_K</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s, _in)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" S-box substitution :param s: S-box :param _in: 32-bit word :returns: substituted 32-bit word """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (s[<span class="hljs-number"><span class="hljs-number">0</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">1</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">2</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">3</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">4</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">5</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">6</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">7</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">28</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block2ns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Convert block to N1 and N2 integers """</span></span> data = bytearray(data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( data[<span class="hljs-number"><span class="hljs-number">7</span></span>] | data[<span class="hljs-number"><span class="hljs-number">6</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">5</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, data[<span class="hljs-number"><span class="hljs-number">3</span></span>] | data[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addmod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, mod=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ** </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Modulo adding of two integers """</span></span> r = x + int(y) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r &lt; mod <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> r - mod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_shift11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 11-bit cyclic shift """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((x &lt;&lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) | ((x &gt;&gt; (<span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">11</span></span>)) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, byte)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] _in = addmod(data, key) sbox_leak = _K(s, _in); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sbox_leak &gt;&gt; (<span class="hljs-number"><span class="hljs-number">8</span></span> * byte)) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Feistel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, nround)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] w = bytearray(key) x = [ w[<span class="hljs-number"><span class="hljs-number">3</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] | w[<span class="hljs-number"><span class="hljs-number">2</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | w[<span class="hljs-number"><span class="hljs-number">1</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | w[<span class="hljs-number"><span class="hljs-number">0</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">8</span></span>) ] n1, n2 = block2ns(data) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(nround): n1, n2 = _shift11(_K(s, addmod(n1, x[i]))) ^ n2, n1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n1 numtraces = len(traces) numpoint = np.shape(traces)[<span class="hljs-number"><span class="hljs-number">1</span></span>] bestguess = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">32</span></span> round_data = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * numtraces <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[i] = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>): best_round = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tnum_r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[tnum_r][rnum] = Feistel(<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>, bestguess, text[tnum_r], rnum) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero best_round_key = kguess &lt;&lt; (bnum * 8) | best_round sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[round("Gost28147_tc26_ParamZ", best_round_key, round_data[tnum][rnum], bnum)] #Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess])) best_round = best_round | (np.argmax(maxcpa) &lt;&lt; (bnum * 8)) bestguess[((rnum + 1) * 4)-bnum - 1] = np.argmax(maxcpa) print "Best Key Guess: " for b in bestguess: print "%02x "%b,</span></span></code> </pre> </div></div><br><p>  <a href="https://github.com/rakf/ChipWhisperer/tree/master/GOST">Repositori Hasil GitHub</a> </p><br><h2 id="vyvody">  Kesimpulan </h2><br><p>  Sebagai bagian dari penelitian, saya bekerja dengan ChipWhisperer.  Terlepas dari kenyataan bahwa saya tidak mencoba semua alat (misalnya, glitching), saya pasti menemukan ChipWhisperer bermanfaat, terutama jika Anda tidak ingin membeli perangkat keras khusus yang mahal. </p><br><p>  Adapun analisis sandi kami untuk konsumsi daya, lebih tahan terhadap serangan ini daripada sandi yang diuraikan di atas, tetapi dengan data yang cukup, kuncinya dapat diperoleh tanpa masalah. </p><br><p>  Bahan yang menarik: </p><br><ul><li>  Analisis Daya Diferensial P. Kocher </li><li>  "Serangan Analisis Daya: Mengungkap Rahasia Kartu Cerdas" </li><li>  <a href="https://xakep.ru/2015/01/29/crypto-i-keys/">Kriptografi di bawah todongan senjata I: mencari kunci algoritma kriptografi</a> R. Korkikyan. </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">Kriptografi di bawah todongan senjata II: analisis nutrisi diferensial</a> R. Korkikyan. </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">Laporan dengan ZeroNights 2014</a> R. Korkikyan. </li><li>  <a href="http://2014.zeronights.org/assets/files/slides/cryptocodingv2.pdf">cryptocoding v2</a> dengan ZeroNights 2014 tentang implementasi perangkat lunak. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id477730/">https://habr.com/ru/post/id477730/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id477716/index.html">Matematikawan menggunakan contoh "tag" menghitung bagaimana keacakan terjadi</a></li>
<li><a href="../id477718/index.html">Lapisan konvolusional: konvolusi cepat sesuai dengan metode Shmuel Vinograd</a></li>
<li><a href="../id477722/index.html">Panduan Gaya Google di C ++. Bagian 8</a></li>
<li><a href="../id477724/index.html">Habraseminar merek SDM: tentang bakat, perburuan, dan konten</a></li>
<li><a href="../id477728/index.html">Apa yang harus dilakukan memimpin tim sehingga tim tidak kehabisan tenaga</a></li>
<li><a href="../id477732/index.html">Klasifikasi jari yang salah dari sistem navigasi bawah air</a></li>
<li><a href="../id477734/index.html">Memahami UICollectionViewLayout dengan Aplikasi Foto</a></li>
<li><a href="../id477736/index.html">Jalur penguji: dari "rem tangan" ke otomatisasi</a></li>
<li><a href="../id477738/index.html">iKassa atau bagaimana kami menjinakkan "kasir digital"</a></li>
<li><a href="../id477740/index.html">Dan ke mana harus melihat teleskop ini dengan mata Anda?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>