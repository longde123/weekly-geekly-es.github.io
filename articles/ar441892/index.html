<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ฆ ๐ ุฅูุดุงุก ูุงูุจ ุชุฏูู ุจูุงูุงุช ูุชุฏูู ุงูุจูุงูุงุช ูู Pub / Sub ุฅูู BigQuery ุงุณุชูุงุฏูุง ุฅูู GCP ุจุงุณุชุฎุฏุงู Apache Beam SDK ู Python ๐ข ๐จ๐ผโโ๏ธ โณ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูููุช ุงูุญุงูู ุ ุฃูุง ููุฎุฑุท ูู ูููุฉ ุฏูู ุงูุจูุงูุงุช (ูุชุญููููุง). ูู ุจุนุถ ุงูุฏูุงุฆุฑ 
 ุชูุนุฑู ูุซู ูุฐู ุงูุนูููุฉ ุจู ETL ุ ุฃู ุงุณุชุฎุฑุงุฌ ูุชุญููู ูุชุญููู ุงููุนูููุงุช. 


 ุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฅูุดุงุก ูุงูุจ ุชุฏูู ุจูุงูุงุช ูุชุฏูู ุงูุจูุงูุงุช ูู Pub / Sub ุฅูู BigQuery ุงุณุชูุงุฏูุง ุฅูู GCP ุจุงุณุชุฎุฏุงู Apache Beam SDK ู Python</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441892/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/is/qf/7j/isqf7j7patfl6lgirlqfrfbz-k8.png" alt="ุงูุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ุงูุญุงูู ุ ุฃูุง ููุฎุฑุท ูู ูููุฉ ุฏูู ุงูุจูุงูุงุช (ูุชุญููููุง).  ูู ุจุนุถ ุงูุฏูุงุฆุฑ <br>  ุชูุนุฑู ูุซู ูุฐู ุงูุนูููุฉ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ETL</a> ุ ุฃู  ุงุณุชุฎุฑุงุฌ ูุชุญููู ูุชุญููู ุงููุนูููุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุชุดูู ุงูุนูููุฉ ุจุฑูุชูุง ูุดุงุฑูุฉ ุฎุฏูุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Google Cloud Platform</a> ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุงูุฉ /</a> ุฎุฏูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุนูุฉ</a> ูุชุฏูู ุงูุจูุงูุงุช ูู ุงูููุช ุงููุนูู </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฏูู ุงูุจูุงูุงุช</a> - ุฎุฏูุฉ ูุชุญููู ุงูุจูุงูุงุช (ูููู <br>  ุงูุนูู ูู ุงูููุช ุงููุนูู ููู ูุถุน ุงูุฏููุนุงุช) </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">BigQuery</a> - ุฎุฏูุฉ ูุชุฎุฒูู ุงูุจูุงูุงุช ูู ุดูู ุฌุฏุงูู <br>  (ูุฏุนู SQL) </li></ul><a name="habracut"></a><br><h5 id="0-tekuschee-polozhenie-del" style=";text-align:right;direction:rtl">  0. ุงููุถุน ุงูุญุงูู </h5><br><p style=";text-align:right;direction:rtl"> ูู ุงูููุช ุงูุญุงูู ุ ููุงู ุฅุตุฏุงุฑ ุนููู ููุจุซ ุนูู ุงูุฎุฏูุงุช ุงููุฐููุฑุฉ ุฃุนูุงู ุ ูููู ูู <br>  ููุงูุจ ุ <a href="">ูุชู ุงุณุชุฎุฏุงู</a> ุฃุญุฏ ุงูููุงูุจ <a href="">ุงูููุงุณูุฉ</a> . </p><br><p style=";text-align:right;direction:rtl">  ุงููุดููุฉ ูู ุฃู ูุฐุง ุงููุงูุจ ูููุฑ ููู ุงูุจูุงูุงุช ูู 1 ุฅูู 1 ุ ุฃู  ุนูู <br>  ุนูุฏ ูุฏุฎู Pub / Sub ุ ูุฏููุง ุณูุณูุฉ ุชูุณูู JSON ุ ุนูุฏ ุงูุฅุฎุฑุงุฌ ูุฏููุง ุฌุฏูู BigQuery ูุน ุงูุญููู ุ <br>  ุงูุชู ุชุชูุงูู ูุน ููุงุชูุญ ุงููุงุฆูุงุช ูู ุงููุณุชูู ุงูุนููู ูู ุงููุฏุฎูุงุช JSON. </p><br><h5 id="1-postanovka-zadachi" style=";text-align:right;direction:rtl">  1. ุจูุงู ุงููุดููุฉ </h5><br><p style=";text-align:right;direction:rtl"> ูู ุจุฅูุดุงุก ูุงูุจ ุชุฏูู ุจูุงูุงุช ูุณูุญ ูู ุจุงูุญุตูู ุนูู ุฌุฏูู ุฃู ุฌุฏุงูู ูู ุงูุฅุฎุฑุงุฌ <br>  ูููุง ูุดุฑูุท ูุนููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฑูุฏ ุฅูุดุงุก ุฌุฏูู ูููุตู ููู ูููุง <br>  ููู ุฅุฏุฎุงู ูุญุฏุฏ JSON.  ูู ุงูุถุฑูุฑู ุฃู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุญูููุฉ ุฃู ุจุนุถ <br>  ูููู ุฃู ุชุญุชูู ูุงุฆูุงุช JSON ุงููุฏุฎูุฉ ุนูู JSON ูุชุฏุงุฎูุฉ ููููุฉ ุ ุฃู  ูู ุถุฑูุฑู <br>  ุชููู ูุงุฏุฑูุง ุนูู ุฅูุดุงุก ุฌุฏุงูู BigQuery ูุน ุญููู ูู ุงูููุน <code>RECORD</code> ูุชุฎุฒูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุชุฏุงุฎูุฉ</a> <br>  ุงูุจูุงูุงุช. </p><br><h5 id="2-podgotovka-k-resheniyu" style=";text-align:right;direction:rtl">  2. ุงูุชุญุถูุฑ ูููุฑุงุฑ </h5><br><p style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ูุงูุจ Dataflow ุ ุงุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Apache Beam</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SDK</a> ุ ูุงูุฐู ุจุฏูุฑู ุ <br>  ูุฏุนู Java ู Python ููุบุฉ ุจุฑูุฌุฉ.  ูุฌุจ ุฃู ุฃููู ุฐูู <br>  ุงูุฅุตุฏุงุฑ ุงููุญูุฏ ูู Python 2.7.x ูุฏุนูู ุ ุงูุฃูุฑ ุงูุฐู ูุงุฌุฃูู ููููุงู.  ุนูุงูุฉ ุนูู ุฐูู ุ ุงูุฏุนู <br>  ุฌุงูุง ุฃูุณุน ุฅูู ุญุฏ ูุง ุ ูุฃู  ุจุงููุณุจุฉ ูู Python ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุนุถ ุงููุธุงุฆู ุบูุฑ ูุชููุฑุฉ ูุฃูุซุฑ ูู ุฐูู <br>  ูุงุฆูุฉ ูุชูุงุถุนุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุตูุงุช</a> ุงููุฏูุฌุฉ.  ุจุงูููุงุณุจุฉ ุ ููููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุงุจุฉ</a> ุงูููุตูุงุช ุงูุฎุงุตุฉ ุจู. </p><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูุธุฑูุง ูุญูููุฉ ุฃููู ูุณุช ูุนุชุงุฏูุง ุนูู Java ุ ููุฏ ุงุณุชุฎุฏูุช Python. </p><br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุจุฏุก ูู ุฅูุดุงุก ูุงูุจ ุ ูุฌุจ ุฃู ูููู ูุฏูู ูุง ููู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฏุฎุงู ุชูุณูู JSON ููุฌุจ ุฃูุง ูุชุบูุฑ ูู ุงูููุช ุงูููุงุณุจ </li><li style=";text-align:right;direction:rtl">  ูุฎุทุท ุฃู ูุฎุทุทุงุช ุฌุฏุงูู BigQuery ุงูุชู ุณูุชู ุฏูู ุงูุจูุงูุงุช ุฅูููุง </li><li style=";text-align:right;direction:rtl">  ุนุฏุฏ ุงูุฌุฏุงูู ุงูุชู ุณูุชู ุฏูู ุฏูู ุจูุงูุงุช ุงููุฎุฑุฌุงุช ุฅูููุง </li></ol><br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃูู ุจุนุฏ ุฅูุดุงุก ูุงูุจ ูุจุฏุก ุชุดุบูู Dataflow Job ุจูุงุกู ุนููู ุ ูููู ุฃู ุชููู ูุฐู ุงููุนููุงุช <br>  ุงูุชุบููุฑ ููุท ุนู ุทุฑูู ุฅูุดุงุก ูุงูุจ ุฌุฏูุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูููู ุจุถุน ูููุงุช ุญูู ูุฐู ุงููููุฏ.  ุงููู ุฌููุนุง ูุฃุชูู ูู ุญูููุฉ ุฃูู ูุง ููุฌุฏ ุฃู ุงุญุชูุงู <br>  ุฅูุดุงุก ูุงูุจ ุฏููุงูููู ูููู ุฃู ูุฃุฎุฐ ุฃู ุณูุณูุฉ ููุฏุฎูุงุช ุ ุชุญููู ุฐูู <br>  ููููุง ููููุทู ุงูุฏุงุฎูู ุ ุซู ููุก ุงูุฌุฏุงูู ุงูุชู ุชู ุฅูุดุงุคูุง ุฏููุงูููููุง ุจุดูู ุญููู <br>  ุงูุชู ุฃูุดุฃุชูุง ุงูุฏุงุฆุฑุฉ.  ูู ุงููุญุชูู ุฌุฏูุง ูุฌูุฏ ูุฐุง ุงูุงุญุชูุงู ุ ูููู ุถูู ุงูุจูุงูุงุช <br>  ุฃูุง ูู ุชูุฌุญ ูู ุชูููุฐ ูุซู ูุฐุง ุงููุฎุทุท.  ุจูุฏุฑ ูุง ุฃููู ููู <br>  ุชู ุฅูุดุงุก ุฎุท ุงูุฃูุงุจูุจ ูุจู ุชูููุฐู ูู ููุช ุงูุชุดุบูู ุ ูุจุงูุชุงูู ูุง ุชูุฌุฏ ุทุฑููุฉ ูุชุบููุฑู ุฅูู <br>  ููุทูุฑ.  ุฑุจูุง ุดุฎุต ูุง ุณูู ูุดุงุฑู ูุฑุงุฑูู. </p><br><h5 id="3-reshenie" style=";text-align:right;direction:rtl">  3. ุงููุฑุงุฑ </h5><br><p style=";text-align:right;direction:rtl">  ูููู ุฃูุซุฑ ุงูุชูุงูุง ููุนูููุฉ ุ ูุฌุฏุฑ ุฅุญุถุงุฑ ุฑุณู ุชุฎุทูุทู ููุง ูุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎุท ุงูุฃูุงุจูุจ</a> <br>  ูู ูุซุงุฆู ุดุนุงุน Apache. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yq/yi/3z/yqyi3zjiwpmjf4i6qp7x4znqv2c.png" alt="ุงูุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุชูุง (ุณูุณุชุฎุฏู ุงููุณูุฉ ูู ุนุฏุฉ ุฌุฏุงูู): </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุฏุฎูุงุช - ุงูุจูุงูุงุช ุชุฃุชู ูู PubSub ูู Dataflow Job </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Transform</a> # 1 - ูุชู ุชุญููู ุงูุจูุงูุงุช ูู ุณูุณูุฉ ุฅูู ูุงููุณ Python ุ ูุญุตู ุนูู ุงูุฅุฎุฑุงุฌ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PCollection</a> # 1 </li><li style=";text-align:right;direction:rtl">  ุงูุชุญููู ุฑูู 2 - ูุชู ุชูููุฒ ุงูุจูุงูุงุช ุ ููุฒูุฏ ูู ุงููุตู ููููุง ูุฌุฏุงูู ูููุตูุฉ ุ ุฅูู <br>  ุงูุฅุฎุฑุงุฌ ูู PCollection # 2 (ูู ุงููุงูุน tolle PCollection) </li><li style=";text-align:right;direction:rtl">  ุงูุชุญููู ุฑูู 3 - ุชุชู ูุชุงุจุฉ ุงูุจูุงูุงุช ูู PCollection # 2 ุฅูู ุงูุฌุฏุงูู ุจุงุณุชุฎุฏุงู ุงููุฎุทุทุงุช <br>  ุงูุฌุฏุงูู </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุนูููุฉ ูุชุงุจุฉ ุงููุงูุจ ุงูุฎุงุต ุจู ุ ุงุณุชูููุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐู</a> ุงูุฃูุซูุฉ ุจูุดุงุท. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุฏ ุงููุงูุจ ูุน ุงูุชุนูููุงุช (ุงูุชุนูููุงุช ุงููุณุฑู ุจุงูุทุฑููุฉ ููุณูุง ูู ุงููุคูููู ุงูุณุงุจููู):</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># coding=utf-8 from __future__ import absolute_import import logging import json import os import apache_beam as beam from apache_beam.pvalue import TaggedOutput from apache_beam.options.pipeline_options import PipelineOptions from apache_beam.options.pipeline_options import SetupOptions from apache_beam.options.pipeline_options import StandardOptions from apache_beam.io.gcp.bigquery import parse_table_schema_from_json #  GCP  gcp_project = '' #  Pub/Sub  topic_name = '' # Pub/Sub    'projects/_GCP_/topics/_' input_topic = 'projects/%s/topics/%s' % (gcp_project, topic_name) #  BigQuery  bq_dataset = 'segment_eu_test' #       schema_dir = './' class TransformToBigQuery(beam.DoFn): #          ,   # BigQuery IO     python dict def process(self, element, *args, **kwargs): body = json.loads(element) #       ,      # python dict       ,     #   yield body class TagDataWithReqType(beam.DoFn): #      , ..      #     ,       #  with_outputs + default def process(self, element, *args, **kwargs): req_type = element.get('_') types = ( 'type1', 'type2', 'type3', ) if req_type in types: yield TaggedOutput(req_type, element) else: yield element def run(): #       _.json   schema_dir,  #         ()  schema_dct = {} for schema_file in os.listdir(schema_dir): filename_list = schema_file.split('.') if filename_list[-1] == 'json': with open('%s/%s' % (schema_dir, schema_file)) as f: schema_json = f.read() schema_dct[filename_list[0]] = json.dumps({'fields': json.loads(schema_json)}) # We use the save_main_session option because one or more DoFn's in this # workflow rely on global context (eg, a module imported at module level). pipeline_options = PipelineOptions() p = beam.Pipeline(options=pipeline_options) pipeline_options.view_as(SetupOptions).save_main_session = True pipeline_options.view_as(StandardOptions).streaming = True # Read from PubSub into a PCollection. input_stream = p | beam.io.ReadFromPubSub(input_topic) # Transform stream to BigQuery IO format stream_bq = input_stream | 'transform to BigQuery' &gt;&gt; beam.ParDo(TransformToBigQuery()) # Tag stream by schema name tagged_stream = \ stream_bq \ | 'tag data by type' &gt;&gt; beam.ParDo(TagDataWithReqType()). with_outputs(*schema_dct.keys(), main='default') # Stream unidentified data to default table tagged_stream.default | 'push to default table' &gt;&gt; beam.io.WriteToBigQuery( '%s:%s.default' % ( gcp_project, bq_dataset, ), schema=parse_table_schema_from_json(schema_dct.get('default')), ) # Stream data to BigQuery tables by number of schema names for name, schema in schema_dct.iteritems(): tagged_stream[name] | 'push to table %s' % name &gt;&gt; beam.io.WriteToBigQuery( '%s:%s.%s' % ( gcp_project, bq_dataset, name), schema=parse_table_schema_from_json(schema), ) result = p.run() result.wait_until_finish() if __name__ == '__main__': logging.getLogger().setLevel(logging.INFO) logger = logging.getLogger(__name__) run()</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุณูุชุทุฑู ุฅูู ุงูููุฏ ูููุฏู ุชูุถูุญุงุช ุ ููู ุฃููุงู ูุฌุฏุฑ ุจูุง ุงูููู ุจุฃู ุงูุฃูุฑ ุงูุฑุฆูุณู <br>  ุตุนูุจุฉ ูู ูุชุงุจุฉ ูุฐุง ุงููุงูุจ ูู ุงูุชูููุฑ ูู ุญูุซ "ุฏูู ุงูุจูุงูุงุช" ุ ู <br>  ููุณ ุฑุณุงูุฉ ูุญุฏุฏุฉ.  ูู ุงูุถุฑูุฑู ุฃูุถูุง ููู ุฃู Pub / Sub ูุนูู ูุน ุงูุฑุณุงุฆู ู <br>  ูู ูููู ุณูู ูุชููู ูุนูููุงุช ููุถุน ุนูุงูุงุช ุนูู ุงูุฏูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">pipeline_options = PipelineOptions() p = beam.Pipeline(options=pipeline_options) pipeline_options.view_as(SetupOptions).save_main_session = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> pipeline_options.view_as(StandardOptions).streaming = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุณุจุจ  ูุณุชุฎุฏู ููุตู Apache Beam Pub / Sub IO ููุท ูู ูุถุน ุงูุชุฏูู ุงูุถุฑูุฑู <br>  ุฃุถู PipelineOptions () (ุนูู ุงูุฑุบู ูู ุฃูู ูู ุงููุงูุน ูุง ูุชู ุงุณุชุฎุฏุงู ุงูุฎูุงุฑุงุช) ุ ูุฅูุง ุ ูู ุจุฅูุดุงุก ูุงูุจ <br>  ููุน ูุน ุงูุงุณุชุซูุงุก.  ูุฌุจ ุฃู ููุงู ุนู ุฎูุงุฑุงุช ุฅุทูุงู ุงููุงูุจ.  ูููู ุฃู ูููู <br>  ุซุงุจุช ููุง ูุณูู ุจ "ููุช ุงูุชุดุบูู".  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุง ููู</a> ุฑุงุจุท ูููุซุงุฆู ุงููุชุนููุฉ ุจูุฐุง ุงูููุถูุน.  ุชุชูุญ ูู ุงูุฎูุงุฑุงุช ุฅูุดุงุก ูุงูุจ ุฏูู ุชุญุฏูุฏ ุงููุนููุงุช ููุฏููุง ุ ูููู ุชูุฑูุฑูุง ุนูุฏ ุจุฏุก ุชุดุบูู Dataflow Job ูู ุงููุงูุจ ุ ูููู ูุง ูุฒุงู ูุชุนุฐุฑ ุนูู ุชูููุฐู ุ ูุฑุจูุง ูุฑุฌุน ุฐูู ุฅูู ุญูููุฉ ุฃู ูุฐุง ุงูุฑุงุจุท ูุง ูุฏุนู <code>RuntimeValueProvider</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Read from PubSub into a PCollection. input_stream = p | beam.io.ReadFromPubSub(input_topic)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ูุงุถุญ ูู ุงูุชุนููู ุ ูุฑุฃูุง ุงูููุถูุน ูู ุงูููุถูุน.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ููููู ุงุณุชุฎุฏุงู ุงูุฏูู <br>  ุณูุงุก ูู ุงูููุถูุน ููู ุงูุงุดุชุฑุงู (ุงูุงุดุชุฑุงู).  ุฅุฐุง ุชู ุชุญุฏูุฏ ุงูููุถูุน ููุฏุฎู ุ ุซู <br>  ุณูุชู ุฅูุดุงุก ุงุดุชุฑุงู ูุคูุช ูู ูุฐุง ุงูููุถูุน ุชููุงุฆููุง.  ุจูุงุก ุงูุฌููุฉ ูู ุฃูุถุง ุฌูููุฉ <br>  ูุงุถุญ ุ <code>beam.io.ReadFromPubSub(input_topic)</code> ุฅุฑุณุงู ุฏูู ุจูุงูุงุช ุงูุฅุฏุฎุงู <code>beam.io.ReadFromPubSub(input_topic)</code> ุฅูู ูููุนูุง <br>  ุฎุท ุฃูุงุจูุจ <code>p</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Transform stream to BigQuery IO format stream_bq = input_stream | 'transform to BigQuery' &gt;&gt; beam.ParDo(TransformToBigQuery())</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ูู ุงูููุงู ุงูุฐู ูุญุฏุซ ููู ุงูุชุญููู ุฑูู 1 ููุชู ุชุญููู ูุฏุฎูุงุชูุง ูู ุณูุณูุฉ ุจูุซูู ุฅูู <br>  dython dict ุ ููู ุงูุฅุฎุฑุงุฌ ูุญุตู ุนูู PCollection # 1.  <code>&gt;&gt;</code> ูุธูุฑ ูู ุจูุงุก ุงูุฌููุฉ.  ุนูู <br>  ูู ุงููุงูุน ุ ุงููุต ูู ุนูุงูุงุช ุงูุชุจุงุณ ูู ุงุณู ุงูุฏูู (ูุฌุจ ุฃู ูููู ูุฑูุฏูุง) ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุนููู ุ <br>  ุงูุฐู ุณูุชู ุฅุถุงูุชู ุฅูู ุงููุชูุฉ ุนูู ุงูุฑุณู ุงูุจูุงูู ูู ูุงุฌูุฉ ููุจ GCP Dataflow.  ุฏุนูุง ูููุฑ ุจูุฒูุฏ ูู ุงูุชูุงุตูู <br>  ุงูุทุจูุฉ ุงููุชุฌุงูุฒุฉ <code>TransformToBigQuery</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransformToBigQuery</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(beam.DoFn)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#          ,   # BigQuery IO     python dict def process(self, element, *args, **kwargs): body = json.loads(element) #       ,      # python dict       ,     #  ,      python dict yield body</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุญุชูู ูุชุบูุฑ <code>element</code> ุนูู ุฑุณุงูุฉ ูุงุญุฏุฉ ูู ุงุดุชุฑุงู PubSub.  ููุง ูุฑู ูู <br>  ุฑูุฒ ุ ูู ุญุงูุชูุง ูุฌุจ ุฃู ูููู JSON ุตุงูุญ.  ูู ุงููุตูู ุงูุฏุฑุงุณูุฉ ูุฌุจ ุฃู ูููู <br>  ูุชู ุฅุนุงุฏุฉ ุชุนุฑูู ุทุฑููุฉ <code>process</code> ุ ูุงูุชู ุงูุชุญููุงุช ุงููุงุฒูุฉ <br>  ุฎุท ุงูุฅุฏุฎุงู ููุญุตูู ุนูู ุงูุฅุฎุฑุงุฌ ุงูุฐู ูุทุงุจู ุงูุฏุงุฆุฑุฉ <br>  ุงูุฌุฏูู ุงูุฐู ุณูุชู ููู ุชุญููู ูุฐู ุงูุจูุงูุงุช.  ุจุณุจุจ  ุชุฏูููุง ูู ูุฐู ุงูุญุงูุฉ ูู <br>  ูุณุชูุฑ ุ <code>unbounded</code> ูููุง ูุชุนูู ุจู Apache Beam ุ ูุฌุจ ุนููู ุฅุนุงุฏุชู ุจุงุณุชุฎุฏุงู <br>  <code>yield</code> ุ ูููุณ <code>return</code> ุ ููุง ุจุงููุณุจุฉ ูุฏูู ุงูุจูุงูุงุช ุงูููุงุฆู.  ูู ุญุงูุฉ ุงูุชุฏูู ุงูููุงุฆู ุ <br>  (ูุถุฑูุฑู) ุจุงูุฅุถุงูุฉ ุฅูู ุชูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>windowing</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>triggers</code></a> </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Tag stream by schema name tagged_stream = \ stream_bq \ | 'tag data by type' &gt;&gt; beam.ParDo(TagDataWithReqType()).with_outputs(*schema_dct.keys(), main='default')</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ุงูููุฏ ููุฌู PCollection # 1 ุฅูู Transform # 2 ุญูุซ ุณูุชู ูุถุน ุงูุนูุงูุงุช <br>  (ุงููุตู) ูู ุฏูู ุงูุจูุงูุงุช.  ูู ูุชุบูุฑ <code>schema_dct</code> ูู ูุฐู ุงูุญุงูุฉ ุ ูุงููุณ ุ ุญูุซ ูููู ุงูููุชุงุญ ูู ุงุณู ููู ุงููุฎุทุท ุจุฏูู ุงูุงูุชุฏุงุฏ ุ ุณูููู ูุฐุง ูู ุงูุนูุงูุฉ ุ ูุชููู ุงููููุฉ ูู JSON ุงูุตุญูุญุฉ ูููุธุงู <br>  ุฌุฏุงูู BigQuery ููุฐู ุงูุนูุงูุฉ.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูุฌุจ ุฅุฑุณุงู ุงููุฎุทุท ุจุงูุถุจุท ุฅูู <br>  ุนุฑุถ <code>{'fields': }</code> ุญูุซ <code></code> ูู ูุฎุทุท ุฌุฏูู BigQuery ูู ูููุฐุฌ JSON (ููููู <br>  ุชุตุฏูุฑ ูู ูุงุฌูุฉ ุงูููุจ). </p><br><p style=";text-align:right;direction:rtl">  <code>main='default'</code> ูู ุงุณู ุนูุงูุฉ ุณูุงุณู ุงูุฑุณุงุฆู ุงูุชู ุณูุฐูุจูู ุฅูููุง <br>  ุฌููุน ุงูุฑุณุงุฆู ุงูุชู ูุง ุชุฎุถุน ูุดุฑูุท ูุถุน ุงูุนูุงูุงุช.  ุงููุธุฑ ูู ุงูุตู <br>  <code>TagDataWithReqType</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TagDataWithReqType</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(beam.DoFn)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#      , ..      #     ,       #  with_outputs + default def process(self, element, *args, **kwargs): req_type = element.get('_') types = ( 'type1', 'type2', 'type3', ) if req_type in types: yield TaggedOutput(req_type, element) else: yield element</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ุ ุชุชู ุฅุนุงุฏุฉ ุชุนุฑูู ูุฆุฉ <code>process</code> ููุง ุฃูุถูุง.  ูุญุชูู ูุชุบูุฑ <code>types</code> ุนูู ุฃุณูุงุก <br>  ูุนูููุง ุฃู ุชุชุทุงุจู ูุน ุงูุฑูู ูุงูุงุณู ูุฑูู ูุฃุณูุงุก ููุงุชูุญ ุงููุงููุณ <br>  <code>schema_dct</code> .  ุนูู ุงูุฑุบู ูู ุฃู ุฃุณููุจ <code>process</code> ูุฏูู ุงููุฏุฑุฉ ุนูู ูุจูู ุงูุญุฌุฌ ุ ุฅูุง ุฃููู ูุง ุฃุจุฏุงู <br>  ููุช ูุงุฏุฑุง ุนูู ุชูุฑูุฑูุง.  ูู ุฃุญุณุจ ุงูุณุจุจ ุจุนุฏ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุฎุฑุฌุงุช ุ ูุญุตู ุนูู ูุฌููุนุฉ ูู ุงูุฎููุท ูู ุนุฏุฏ ุงูุนูุงูุงุช ุ ุฃู ุนุฏุฏ ุนูุงูุงุชูุง <br>  ุนูุงูุงุช ูุญุฏุฏุฉ ูุณุจูุง + ุงูููุถูุน ุงูุงูุชุฑุงุถู ุงูุฐู ูุดู ูู ูุถุน ุนูุงูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Stream unidentified data to default table tagged_stream.default | 'push to default table' &gt;&gt; beam.io.WriteToBigQuery( '%s:%s.default' % ( gcp_project, bq_dataset, ), schema=parse_table_schema_from_json(schema_dct.get('default')), )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชุญููู ุฑูู ... (ูู ุงููุงูุน ุ ุฅูู ููุณ ุนูู ุงูุฑุณู ุงูุชุฎุทูุทู ุ ูุฐุง "ูุฑุน") - ููุชุจ ุงูุฏูู ุงูุงูุชุฑุงุถู <br>  ุฅูู ุงูุฌุฏูู ุงูุงูุชุฑุงุถู. </p><br><p style=";text-align:right;direction:rtl">  <code>tagged_stream.default</code> - ูุชู ุฃุฎุฐ ุฏูู ูุน ุงูุนูุงูุฉ <code>default</code> ุ ุจูุงุก ุฌููุฉ ุจุฏูู ูู <code>tagged_stream['default']</code> </p><br><p style=";text-align:right;direction:rtl">  <code>schema=parse_table_schema_from_json(schema_dct.get('default'))</code> - ููุง ูุชู ุชุนุฑูู ุงููุฎุทุท <br>  ุงูุฌุฏุงูู.  ูุฑุฌู ููุงุญุธุฉ ุฃู ููู <code>default.json</code> ูุน ูุฎุทุท ุฌุฏูู BigQuery ุตุงูุญ <br>  ูุฌุจ ุฃู ูููู ูู ุงูุฏููู <code>schema_dir = './'</code> . </p><br><p style=";text-align:right;direction:rtl">  ุณูุชู ุงูุงูุชูุงู ุฅูู ุฌุฏูู ูุณูู <code>default</code> . </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุงูุฌุฏูู ุจูุฐุง ุงูุงุณู (ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุญุฏุฏุฉ ููุฐุง ุงููุดุฑูุน) ุบูุฑ ููุฌูุฏ ุ ูุนูุฏุฆุฐู <br>  ุณูุชู ุฅูุดุงุคู ุชููุงุฆููุง ูู ุงููุฎุทุท ุจูุถู ุงูุฅุนุฏุงุฏ ุงูุงูุชุฑุงุถู <br> <code>create_disposition=BigQueryDisposition.CREATE_IF_NEEDED</code> </p> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Stream data to BigQuery tables by number of schema names for name, schema in schema_dct.iteritems(): tagged_stream[name] | 'push to table %s' % name &gt;&gt; beam.io.WriteToBigQuery( '%s:%s.%s' % ( gcp_project, bq_dataset, name), schema=parse_table_schema_from_json(schema), )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุญููู ุฑูู 3 ุ ูุฌุจ ุฃู ูููู ูู ุดูุก ูุงุถุญูุง ูุฃููุฆู ุงูุฐูู ููุฑุคูู ุงูููุงูุฉ ูู ุงูุจุฏุงูุฉ ูุงูุฎุงุตุฉ <br>  ุจูุงุก ุฌููุฉ ุจูุซูู.  ููุตู ูุฌููุนุฉ ุงูุฏูู ูุน ุญููุฉ ูููุชุจ ูู ุฏูู ูู ุฌุฏููู ุงูุฎุงุต ุจู <br>  ูุฎุทุทู.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงุณู ุงูุฏูู ูุฌุจ ุฃู ูููู ูุฑูุฏูุง - <code>'%s:%s.%s' % (gcp_project, bq_dataset, name)</code> . </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฌุจ ุฃู ูููู ูู ุงููุงุถุญ ููู ูุนูู ูุฐุง ูููููู ุฅูุดุงุก ูุงูุจ.  ููุฐุง ุชุญุชุงุฌ <br>  ุชุดุบูู ูู ูุญุฏุฉ ุงูุชุญูู (ูุง ุชูุณ ุชูุดูุท venv ุฅุฐุง ูุงู ุฐูู ูุชุงุญูุง) ุฃู ูู IDE: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">python _.py / --runner DataflowRunner / --project dreamdata-test / --staging_location gs://STORAGE_NAME/STAGING_DIR / --temp_location gs://STORAGE_NAME/TEMP_DIR / --template_location gs://STORAGE_NAME/TEMPLATES_DIR/TEMPLATE_NAME</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ูุฌุจ ุชูุธูู ุงููุตูู ุฅูู ุญุณุงุจ Google ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุฎูุงู ุงูุชุตุฏูุฑ <br>  <code>GOOGLE_APPLICATION_CREDENTIALS</code> ุงูุจูุฆุฉ <code>GOOGLE_APPLICATION_CREDENTIALS</code> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุทุฑููุฉ</a> ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ุนู - <code>--runner</code> .  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู <code>DataflowRunner</code> ุฃู ูุฐุง ุงูุฑูุฒ <br>  ุณูุชู ุชุดุบูู ููุงูุจ ููุธููุฉ Dataflow Job.  ูุง ูุฒุงู ูู ุงููููู ุชุญุฏูุฏ <br>  <code>DirectRunner</code> ุ ุณูุชู ุงุณุชุฎุฏุงูู ุงูุชุฑุงุถูุง ุฅุฐุง ูู ููู ููุงู ุฎูุงุฑ - <code>--runner</code> ูุฑูุฒ <br>  ุณุชุนูู ููุธููุฉ Dataflow Job ุ ููู ูุญูููุง ุ ููู ููุงุณุจ ุฌุฏูุง ููุชุตุญูุญ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ุชุญุฏุซ ุฃู ุฃุฎุทุงุก ุ ูุณูุชู <code>gs://STORAGE_NAME/TEMPLATES_DIR/TEMPLATE_NAME</code> <br>  ุฅูุดุงุก ูุงูุจ.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู <code>gs://STORAGE_NAME/STAGING_DIR</code> ุณูุชู ูุชุงุจุชูุง ุฃูุถูุง <br>  ูููุงุช ุงูุฎุฏูุฉ ุงูุถุฑูุฑูุฉ ููุชุดุบูู ุงููุงุฌุญ ููุธููุฉ Datafow ุงูุชู ุชู ุฅูุดุงุคูุง ุนูู ุฃุณุงุณ <br>  ูุงูุจ ููุณุช ุจุญุงุฌุฉ ุฅูู ุญุฐููุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุธููุฉ ุชุฏูู ุจูุงูุงุช ุจุงุณุชุฎุฏุงู ูุฐุง ุงููุงูุจ ุ ูุฏูููุง ุฃู ุจูุงุณุทุฉ ุฃู <br>  ุจุทุฑููุฉ ุฃุฎุฑู (CI ุนูู ุณุจูู ุงููุซุงู). </p><br><h5 id="4-vyvody" style=";text-align:right;direction:rtl">  4. ุงูุงุณุชูุชุงุฌุงุช </h5><br><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ุชูููุง ูู ุฏูู ุงูุฏูู ูู PubSub ุฅูู BigQuery ุจุงุณุชุฎุฏุงู <br>  ุชุญูููุงุช ุงูุจูุงูุงุช ุงูุถุฑูุฑูุฉ ูุบุฑุถ ูุฒูุฏ ูู ุงูุชุฎุฒูู ูุงูุชุญููู ู <br>  ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช. </p><br><h2 id="osnovnye-ssylki" style=";text-align:right;direction:rtl">  ุงูุฑูุงุจุท ุงูุฑุฆูุณูุฉ </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุจุงุชุดู ุดุนุงุน sdk</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://www.google.com/url%3Fsa%3Dt%26rct%3Dj%26q%3D%26esrc%3Ds%26source%3Dweb%26cd%3D1%26cad%3Drja%26uact%3D8%26ved%3D2ahUKEwjHvcGT5svgAhV7wsQBHSDWDEoQFjAAegQIABAC%26url%3D">ุฌูุฌู ุชุฏูู ุงูุจูุงูุงุช</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุฌู bigquery</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌููุณ ููุฑ ููุงู ุนู ุงููุชูุณุท</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุซูุฉ ูุดูุฑุฉ ุจุงูุซูู ูู Apache Beam</a> </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูููุงูุฉ ุ ูู ุงููููู ุนุฏู ุงูุฏูุฉ ุฃู ุญุชู ุงูุฃุฎุทุงุก ุ ุณุฃููู ููุชูุงู ููุจูุงุก <br>  ุงูููุฏ.  ูู ุงูููุงูุฉ ุ ุฃูุฏ ุฃู ุฃุถูู ุฐูู ูู ุงููุงูุน ุ ูุง ูุชู ุงุณุชุฎุฏุงู ูู ุดูุก ููุง <br>  ููุฒุงุช Apache Beam SDK ุ ููู ูุฐุง ูู ููู ุงููุฏู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar441892/">https://habr.com/ru/post/ar441892/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar441878/index.html">ุฃูุช ููุง ุชุฑูุฏ ุ ููููู ูุนูุช</a></li>
<li><a href="../ar441882/index.html">ุจุฑูุงูุฌ VMware NSX ูุฃุตุบุฑ ุงูุฌุฒุก 3. ุชูููู DHCP</a></li>
<li><a href="../ar441886/index.html">ุนูู ูุฏุงุฑ ุงูุงุซูู ุนุดุฑ ุนุงููุง ุงููุงุถูุฉ ุ ูู ุฃุนุฑุถ ุณูุฑุฉ ุฐุงุชูุฉ ุฃุจุฏูุง</a></li>
<li><a href="../ar441888/index.html">SIP ูู ููุจุฑ ุงูุตูุช ุจุณุนุฑ ุงูููุฒู</a></li>
<li><a href="../ar441890/index.html">ูู ูุง ุชุญุชุงุฌ ููุนุฑูุชู ุญูู ููุญูุงุช ุชุทุจููุงุช iOS</a></li>
<li><a href="../ar441896/index.html">ุชุนูู ุงูุชูุชููุงุช ุงูุชูุชูููุฉ ูุงูุชูููุงุช ูุงููุนุงุฑู ุงูุนุงูุฉ (ATT @ CK). ุชูุชููุงุช ุงููุคุณุณุฉ. ุงูุฌุฒุก 9</a></li>
<li><a href="../ar441898/index.html">Sketch + Node.js: ุฅูุดุงุก ุฑููุฒ ููุนุฏูุฏ ูู ุงูููุตุงุช ูุงูุนูุงูุงุช ุงูุชุฌุงุฑูุฉ</a></li>
<li><a href="../ar441900/index.html">ุชุญุฏุซ ุณุงุชูุง Nadella ุนู ุงูุชุนุงูู ูุน ุงูุจูุชุงุบูู</a></li>
<li><a href="../ar441902/index.html">ููู ุชุฎูู ุงูุชูููููุฌูุง ุญูุงุฆู ุฌุฏูุฏุฉ</a></li>
<li><a href="../ar441904/index.html">ุชุซุจูุช ุดุงุดุฉ IPS ุนูู Thinkpad T430S</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>