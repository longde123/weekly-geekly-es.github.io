<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÑ ‚ôÄÔ∏è üèúÔ∏è Encabezados HTTP requeridos üï∫üèæ üòµ üôãüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nuestros clientes Fastly adoran manipular encabezados HTTP. Elegir la combinaci√≥n correcta de encabezados es una de las mejores cosas que puede hacer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Encabezados HTTP requeridos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413205/"> Nuestros clientes Fastly adoran manipular encabezados HTTP.  Elegir la combinaci√≥n correcta de encabezados es una de las mejores cosas que puede hacer para mantener su sitio seguro y hacer una contribuci√≥n significativa a su rendimiento. <br><br>  La mayor√≠a de los desarrolladores conocen los encabezados HTTP importantes y √∫tiles.  Los m√°s famosos son <code>Content-Type</code> y <code>Content-Length</code> , estos son encabezados casi universales.  Pero recientemente, se han utilizado encabezados como <code>Content-Security-Policy</code> y <code>Strict-Transport-Security</code> para aumentar la <code>Strict-Transport-Security</code> , y <code>Link rel=preload</code> para mejorar el rendimiento.  A pesar del soporte generalizado en los navegadores, solo unos pocos los usan. <br><br>  En un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo anterior,</a> vimos encabezados innecesarios.  Ahora veamos qu√© encabezados realmente deber√≠an configurarse para su sitio. <br><a name="habracut"></a><br><h1>  Tarea </h1><br>  Hay varios servicios en Internet que analizar√°n su sitio y le aconsejar√°n qu√© encabezados agregar.  Mir√© el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">securityheaders.io</a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Observatorio de</a> Mozilla para complementar mis propios conocimientos y datos de la red Fastly. <br><br><h1>  Qu√© encabezados deben estar en su sitio </h1><br>  Entonces, ¬øcu√°les son los encabezados principales en las respuestas de su servidor?  La mayor√≠a son responsables de mejorar la seguridad: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pol√≠tica de seguridad de contenido</a> .  Act√∫a como un firewall en el navegador.  Si su sitio se ve comprometido, ayuda a limitar el da√±o al evitar conexiones a hosts no aprobados.  Titular muy importante.  Si no lo tiene, debe habilitarlo. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pol√≠tica de referencia</a> .  Ajusta el nivel de detalle para incluir en el encabezado <code>Referer</code> al salir de la p√°gina.  Ayuda a evitar la fuga de datos a los sitios donde van los enlaces.  Muy recomendable <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estricto-Transporte-Seguridad</a> .  Evita cualquier intento de conectarse al sitio utilizando HTTP normal.  Ayuda a detener los ataques MiTM y mejora la seguridad del sitio.  Tambi√©n muy recomendable. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Protecci√≥n X-XSS</a> .  Evita algunas formas de ataques de secuencias de comandos en sitios cruzados, evitando la ejecuci√≥n de secuencias de comandos si en la solicitud hay alg√∫n marcado de un documento en la misma forma.  Por ejemplo, si carga una p√°gina con la direcci√≥n <code>/index.html?foo=&lt;script&gt;alert('foo');&lt;/script&gt;</code> <code>&lt;script&gt;alert('foo');&lt;/script&gt;</code> , y en el c√≥digo fuente de la p√°gina est√° <code>&lt;script&gt;alert('foo');&lt;/script&gt;</code> entonces el script est√° bloqueado.  En estos d√≠as, el t√≠tulo se reemplaza en gran medida por CSP. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">X-Content-Type-Options</a> .  Establezca el valor en <code>nosniff</code> para evitar que los navegadores ejecuten contenido similar a JavaScript para el que no se establece el valor de tipo de contenido correcto.  Previene ataques como la mezcla MIME, y recientemente Chrome se ha utilizado para activar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aislamiento del sitio</a> .  Con el tiempo, se vuelve menos importante debido al comportamiento mejorado de los navegadores de forma predeterminada, pero actualmente sigue siendo una de las mejores pr√°cticas. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CORS</a> .  Los encabezados Cross-Origin Resource Sharing le permiten cargar una URL con un script de otra fuente.  Este es un t√≠tulo opcional.  Los t√≠tulos de este tipo son permisivos, no prohibitivos, por lo que su ausencia proporciona el m√°ximo nivel de seguridad. <br><br>  Otros son para el rendimiento: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tiempo-Permitir-Origen</a> .  Brinda acceso a las herramientas de monitoreo para solicitar datos de tiempo.  Esto es, en muchos aspectos, informaci√≥n valiosa, puede mejorar en gran medida la calidad de los an√°lisis como Google Analytics o Speedcurve. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace rel = precarga</a> .  Le informa al navegador sobre los recursos cr√≠ticos que deben descargarse, incluso si no hay una necesidad inmediata de ellos.  Use el encabezado para las fuentes y CSS importantes. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Temporizaci√≥n del servidor</a>  Proporciona informaci√≥n de sincronizaci√≥n del servidor que complementa la API de sincronizaci√≥n de navegaci√≥n y la API de sincronizaci√≥n de recursos con informaci√≥n m√°s detallada sobre el tiempo necesario para completar las tareas en el servidor (por ejemplo, "cu√°nto tiempo pasamos en MySQL").  Excelente para monitorear datos de rendimiento, combinados con las herramientas RUM Beacon. <br><br>  Echemos un vistazo m√°s de cerca a algunos de ellos. <br><br><h1>  Pol√≠tica de seguridad de contenido: mant√©ngalo dentro </h1><br>  Aunque <code>Content-Security-Policy</code> es uno de los t√≠tulos m√°s importantes, tambi√©n es uno de los m√°s detallados.  El encabezado CSP m√°s grande que encontr√© en HTTPArchive fue de 10K.  <i>Diez kilobytes</i> .  Para un solo valor de encabezado.  Peor a√∫n: aunque los cuerpos de respuesta se pueden transmitir, la mayor√≠a de los servidores y servidores proxy almacenan los encabezados y solo se transmiten una vez finalizados.  La compresi√≥n HTTP / 2 ayuda un <i>poco</i> a recordarlos entre solicitudes, pero esto no significa que el encabezado de 10 KB est√© bien. <br><br>  Adem√°s, al completar el primer paquete completo de su respuesta, puede hacer que el navegador realice dos llamadas al servidor <b>solo para comenzar a recibir el contenido</b> .  As√≠ que piense no solo en eliminar encabezados innecesarios, sino tambi√©n en maximizar los existentes. <br><br><h1>  Pol√≠tica de referencia </h1><br>  Desde tiempos inmemoriales (es decir, en el mundo web desde finales de los 90), los navegadores env√≠an (y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escriben incorrectamente</a> ) el encabezado <code>Referer</code> .  Durante la mayor parte de su historia, esta ha sido una de las formas m√°s importantes de rastrear los movimientos de los usuarios entre p√°ginas en las herramientas de an√°lisis, as√≠ como comprender el origen del tr√°fico entrante.  Sin embargo, este √∫ltimo est√° asociado con importantes problemas de privacidad.  Si hago clic en el enlace del correo electr√≥nico desde el cliente de correo electr√≥nico, el sitio puede determinar mi dominio de correo electr√≥nico.  Peor a√∫n, conocer la URL completa de la que vino, incluidos los argumentos de la solicitud, puede revelar los t√©rminos de su √∫ltima consulta de b√∫squeda o datos personales, como una direcci√≥n de correo electr√≥nico. <br><br>  Puede seleccionar varias estrategias de las opciones de Pol√≠tica de referencia disponibles, pero mi consejo habitual es "origen-cuando-origen-cruzado", que habilita Referer para todas las solicitudes normales, pero trunca el valor solo al dominio si el enlace va de un dominio a otro .  Los enlaces dentro de su propio sitio incluyen una referencia completa. <br><br><h1>  Medici√≥n del tiempo del servidor en el servidor CDN Edge </h1><br>  <code>Server-Timing</code> tiene muchas caracter√≠sticas agradables, y una de ellas es que puede agregar varias instancias en respuesta, y todas se combinar√°n en un navegador o herramienta RUM.  Es decir, si la solicitud pasa por varias etapas de procesamiento del servidor, como sucede en el CDN, cada etapa agrega sus propias m√©tricas de tiempo y no entran en conflicto entre s√≠.  Aqu√≠ le mostramos c√≥mo agregar m√©tricas Fastly al encabezado usando VCL en la configuraci√≥n de servicio Fastly: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">add</span></span> resp.http.<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Timing</span></span> = fastly_info.state {", fastly;desc="Edge <span class="hljs-type"><span class="hljs-type">time</span></span>";dur="} <span class="hljs-type"><span class="hljs-type">time</span></span>.elapsed.msec;</code> </pre> <br>  Este n√∫mero incluye el tiempo dedicado a esperar el back-end, por lo que, en el caso normal, todas las m√©tricas de tiempo del servidor ser√°n menores que el n√∫mero Fastly.  Sin embargo, si emitimos un documento de la memoria cach√© Fastly, ver√° las m√©tricas de tiempo originales desde el momento en que se gener√≥ la p√°gina, pero el n√∫mero Fastly confirmar√° que la p√©rdida de tiempo total es realmente muy peque√±a. <br><br>  Las m√©tricas de tiempo del servidor est√°n disponibles a trav√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">del objeto de rendimiento en JavaScript</a> y se muestran en el panel de red de Chrome Devtools: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d2e/5e2/349/d2e5e23497238f2cdf12cddf0c6dedb5.png"><br><br>  Actualmente, visualizaci√≥n de indicadores a nivel rudimentario.  Pero est√°n trabajando duro en esto, por lo que en el futuro es probable que la interfaz de usuario mejore significativamente. <br><br><h1>  Agregue todos los encabezados correctos. </h1><br>  R√°pidamente es un buen lugar para agregar todos los encabezados de seguridad y rendimiento.  A continuaci√≥n se muestra c√≥mo se ven todos juntos.  Agregue este c√≥digo en la etapa de entrega del flujo de solicitud, cambiando los valores a los que sean adecuados para su sitio ( <b>intente no copiar y pegar</b> sin verificar que los valores sean adecuados para su sitio): <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.Content-<span class="hljs-keyword"><span class="hljs-keyword">Security</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Policy</span></span> = "default-src 'self'; frame-ancestors 'self'"; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.Referer-<span class="hljs-keyword"><span class="hljs-keyword">Policy</span></span> = "origin-when-cross-origin"; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.<span class="hljs-keyword"><span class="hljs-keyword">Strict</span></span>-Transport-<span class="hljs-keyword"><span class="hljs-keyword">Security</span></span> = "max-age=86400"; # Increase <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> working well <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> prod (a year <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a common final <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.X-XSS-Protection = "1; mode=block"; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.X-Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Options</span></span> = "nosniff"; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.http.Origin) { # Consider checking this against an allowlist <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.<span class="hljs-keyword"><span class="hljs-keyword">Access</span></span>-Control-Allow-Origin = req.http.Origin; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.<span class="hljs-keyword"><span class="hljs-keyword">Access</span></span>-Control-Allow-Methods = "GET,HEAD,POST,OPTIONS"; } <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> resp.http.<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Timing</span></span> = fastly_info.state {", fastly;desc="Edge <span class="hljs-type"><span class="hljs-type">time</span></span>";dur="} <span class="hljs-type"><span class="hljs-type">time</span></span>.elapsed.msec; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.<span class="hljs-keyword"><span class="hljs-keyword">Timing</span></span>-Allow-Origin = "*"; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> resp.http.Link = "&lt;/fonts/myfont.otf&gt;; rel=preload; as=font";</code> </pre> <br>  En el pr√≥ximo art√≠culo, veremos algunos de los encabezados m√°s ex√≥ticos que est√°n comenzando a estandarizarse e implementarse en los navegadores. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413205/">https://habr.com/ru/post/es413205/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413187/index.html">Entrevista con Ryan Dahl, creador de Node.js</a></li>
<li><a href="../es413189/index.html">Colecci√≥n de sombras de ojos css Box-shadows.css</a></li>
<li><a href="../es413195/index.html">Pensamiento funcional Parte 6</a></li>
<li><a href="../es413199/index.html">Fracasos de futur√≥logos. Ideas de pel√≠culas que no se materializaron.</a></li>
<li><a href="../es413203/index.html">ICO y seguridad: an√°lisis del concurso de inteligencia competitiva en los d√≠as de pirateo positivo</a></li>
<li><a href="../es413207/index.html">PGCon 2018: fotos, diapositivas, impresiones</a></li>
<li><a href="../es413211/index.html">Analizando la aplicaci√≥n Avito iOS: Preg√∫ntame cualquier cosa</a></li>
<li><a href="../es413213/index.html">Apple WWDC 2018: transmisi√≥n de texto</a></li>
<li><a href="../es413215/index.html">GitHub ahora es propiedad oficial de Microsoft</a></li>
<li><a href="../es413217/index.html">¬øLos autos el√©ctricos son tan ecol√≥gicos?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>