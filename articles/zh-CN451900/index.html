<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😺 🕖 🍀 Facebook对浏览器API的第一项贡献 🖐🏾 ✌🏽 🧛🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我们作为受欢迎网站的所有者的地位以及我们对受欢迎的React平台的支持工作使我们获得了独特的机会和对与我们要用来解决“队列”问题的浏览器一起使用的理解。 作为Web标准社区（W3C）的活跃成员，我们参与了许多创新的讨论，包括服务工作者和CSS过度滚动 ，但直到最近，我们才制定了自己的计划来改进Web...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Facebook对浏览器API的第一项贡献</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451900/"><p><img src="https://habrastorage.org/webt/ot/me/yt/otmeytc2idaafvqyj9c3dcekdw4.jpeg" alt="遮盖"></p><br><p>我们作为受欢迎网站的所有者的地位以及我们对受欢迎的React平台的支持工作使我们获得了独特的机会和对与我们要用来解决“队列”问题的浏览器一起使用的理解。 作为Web标准社区（W3C）的活跃成员，我们参与了许多创新的讨论，包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">服务工作者</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CSS过度滚动</a> ，但直到最近，我们才制定了自己的计划来改进Web浏览器。 为了实现生产率的显着提高，提出了一个新的API，作为与Google Chrome浏览器同事的密切合作的结果，该API提供了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">试用版</a> 。  <strong>Chrome v74</strong>将包含<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">isInputPending API</a> ，可用于改善整体JavaScript执行时间和事件响应时间。 这只是改善Web上JavaScript计划的第一步。 我们希望获得开发人员的反馈，并使用它们来创建API的最终版本。 </p><a name="habracut"></a><br><p> 现代网络中最重要的性能指标之一是响应用户事件（单击按钮或进入字段）所需的时间，并具有完整的可视化效果。 在Facebook上，我们分四个阶段共享和评估事件： </p><br><ul><li> 操作系统接收数据 </li><li> 实际开始加工 </li><li> 开始在屏幕上显示更改以响应事件 </li><li> 处理完成，结果可视化 </li></ul><br><p> 当我们评估我们最有生产力的产品时，注意到队列中的等待时间会带来最大的延迟。 排队是指用户与页面进行交互（例如，单击或点击）与开始实际处理事件之间的时间。 在某些情况下，这种延迟可能非常严重。 想象一下，您单击通知图标，然后等待一分钟，按钮才会响应。 可能没有人会等待答案。 </p><br><h2 id="bystraya-zagruzka-ili-bystroe-reagirovanie-vyberite-odin"> 快速启动或快速响应：选择一种 </h2><br><p> 在快速页面加载和交互性之间很难进行权衡。 如果网站需要JavaScript，一种选择是将其全部运行在一个块中。 但这会产生问题。  Web浏览器中的JavaScript机制通常是单线程的，也就是说，它们一次只能在每个页面上执行一项操作。 在加载页面的情况下，这意味着如果用户单击某项，浏览器必须将click事件排队，直到启动整个JavaScript块。 </p><br><p> 像许多其他站点一样，我们通过将JavaScript分成小块来解决此问题。 在页面加载期间，我们启动一些JavaScript，然后将控制权返回给浏览器。 然后，浏览器可以检查输入事件队列，并查看是否有任何要处理的内容。 然后，浏览器可以在添加它们时返回运行中的JavaScript块。 这会有所帮助，但可能会导致其他问题。 每次我们将控制权返回给浏览器时，都会花费一些时间来检查输入事件的发生，处理事件以及选择下一个JavaScript块。 因此，尽管浏览器对事件的响应速度更快，但是我们仍然需要在代码块的大小和劣于浏览器的频率之间找到平衡。 如果我们过于频繁地更改控件，则页面加载速度太慢；相反，如果加载频率降低，浏览器将花费更多时间来响应用户事件，并且人们会感到失望。 </p><br><p><img src="https://habrastorage.org/webt/ta/sw/ue/taswuexpvwj5q5lpns2qmoyi0ue.jpeg" alt="快速加载"></p><br><blockquote> 如果我们运行较大的JavaScript块，则浏览器可能会延迟很长时间（如上所述）发送用户事件； 如果我们运行较小的块，则页面需要更长的时间加载（底部）。 </blockquote><br><h2 id="isinputpending-reshenie">  isInputPending解决方案 </h2><br><p> 当我们第一次发现队列中的延迟时，我们求助于Chrome中的同事。 我们想看看如果我们想出一种新的下载方法来消除这种折衷的困境，一切将会如何。 与他们交谈后，我们建议isInputPending。  <em>isInputPending API</em>是第一个将中断的概念用于Web用户事件的<em>API</em> 。 </p><br><p> 在<em>幕后</em> ， <em>isInputPending</em>在编译器端的Chrome输入队列上侦听以捕获事件，然后再将事件添加到主流中。 由于此侦听是在主线程之外执行的，因此<em>isInputPending</em>调用不会消耗大量计算资源，并且应该非常快。 这使开发人员可以频繁调用API并最大化响应速度。 </p><br><p> 一旦准备好该提案，我们便转向W3C Web性能工作组，并获得了各种浏览器供应商的同意，我们的想法值得探讨。 将来，我们将与Chrome中的同事合作，独立实施新的API，并在Chrome中发送相应的代码修复。 感谢Chrome的工程师，我们获得了试用补丁，使我们可以测试更改并在完整版本发布之前获得开发人员的反馈。 此版本将使我们能够了解此API对开发人员的重要性，并确定我们与Web浏览器提供商有关此API的未来对话。 这是我们第一次经历开发Web API的所有阶段，从在论坛上讨论提案到将代码传递到Web浏览器。 </p><br><h2 id="kak-rabotaet-isinputpending">  isPendPending如何工作 </h2><br><p> 顾名思义， <em>isInputPending会</em>告诉您是否有等待输入的事件。 开发人员可以在运行JavaScript时使用此信息来决定是否要重新获得对浏览器的控制。 正确使用<em>isInputPending</em>可以完全消除快速加载和交互性的难题。 </p><br><p>要使用API​​，请使用<code>navigator.scheduling.isInputPending()</code> 。 本质上，如果浏览器期望事件被调度，则此方法返回<code>true</code> 。 不带任何参数调用时，将检查所有受支持的事件类型。 此外，可以手动指定事件类型的列表：鼠标，滚轮，触摸，应检查这些事件的未决输入。 </p><br><h3 id="primer-proverka-lyubyh-tipov-sobytiy"> 示例：检查任何类型的事件 </h3><br><pre> <code class="plaintext hljs">while (workQueue.length &gt; 0) { if (navigator.scheduling.isInputPending()) { //       break; } let job = workQueue.shift(); job.execute(); }</code> </pre> <br><h3 id="primer-proverka-na-konkretnye-vhodnye-sobytiya"> 示例：检查特定的输入事件 </h3><br><pre> <code class="plaintext hljs">while (workQueue.length &gt; 0) { if (navigator.scheduling.isInputPending(['mousedown', 'mouseup', 'keydown', 'keyup'])) { //       'mousedown'  'mouseup'  'keydown'  'keyup' break; } let job = workQueue.shift(); job.execute(); }</code> </pre> <br><h2 id="chto-dalshe"> 接下来是什么？ </h2><br><p> 如果社区反馈是肯定的，则<em>isInputPending</em>可能会在Chrome中完全可用。 然后，我们可以消除队列中这些明显的延迟，并使Internet上的工作对于站点上的人员而言更快，更灵活。 对于还希望摆脱队列延迟并改善交互和下载性能的开发人员，将很快提供试用版。 请<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>注册并在试用版可用后立即分享您的意见。 </p><br><p>  Chrome的<em>isInputPending</em>移植过程是在Facebook上开发Web标准的新方法。 我们希望继续开发新的API，并增加对开源Web浏览器的贡献。 将来，我们可能会将此API直接嵌入React中，以便开发人员可以立即使用该API。 另外， <em>isInputPending</em>现在是创建用于在网络上进行规划的原语的出色工作的一部分。 我们希望继续与Chrome保持合作关系。 最后，我们希望看到浏览器工具，这些工具将允许开发人员将其更深入地集成到浏览器任务队列中，甚至允许开发人员了解各种网络请求和任务的浏览器优先级。 </p><br><h2 id="primechanie-avtora"> 作者注 </h2><br><p> 要尝试新的API，您需要： </p><br><ul><li> 安装Google Chrome浏览器74-76版 </li><li> 启用标志<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">实验Web平台功能</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">铬v74</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/66/bb/yq/66bbyqirlqgfzupbobwovk_ozv4.png" alt="v74"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Chrome v76（开发）</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/u9/1j/du/u91jdu5dbgtrt6gsrj2d-5mrbze.png" alt="v76"></p></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN451900/">https://habr.com/ru/post/zh-CN451900/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN451886/index.html">在测试中使用离散数学</a></li>
<li><a href="../zh-CN451890/index.html">在BIND中委派小于/ 24的反向子网区域。 如何运作</a></li>
<li><a href="../zh-CN451894/index.html">编译器体系结构的简要概述</a></li>
<li><a href="../zh-CN451896/index.html">“牢不可破”的eyeDisk受虹膜扫描保护，但以明文形式传输密码</a></li>
<li><a href="../zh-CN451898/index.html">俄语创新</a></li>
<li><a href="../zh-CN451902/index.html">Microsoft Azure开发人员营地俄罗斯</a></li>
<li><a href="../zh-CN451904/index.html">有时候，更多就是更少。 当负载减少导致延迟增加时</a></li>
<li><a href="../zh-CN451906/index.html">交换漏洞：如何检测特权提升</a></li>
<li><a href="../zh-CN451908/index.html">计算机的历史：Yandex博物馆的一个夜晚</a></li>
<li><a href="../zh-CN451912/index.html">MuseNet深度神经网络写音乐</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>