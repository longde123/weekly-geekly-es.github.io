<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❓ 🏪 👲🏼 Tentang Masalah Penerjemah Python dan Memikirkan Kembali Bahasa 🤜🏾 👩‍🎓 🥓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- Berapa banyak arsitek yang Anda butuhkan untuk mengimplementasikan bahasa pemrograman? 
 - Seratus. Seseorang akan menulis implementasinya, dan 99 a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tentang Masalah Penerjemah Python dan Memikirkan Kembali Bahasa</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481782/"><p>  - <em>Berapa banyak arsitek yang Anda butuhkan untuk mengimplementasikan bahasa pemrograman?</em> <br>  - <em>Seratus.</em>  <em>Seseorang akan menulis implementasinya, dan 99 akan mengatakan apa yang dapat mereka lakukan dengan lebih baik.</em> </p><br><p>  Pada artikel ini, saya ingin menyentuh tidak hanya pada bahasa itu sendiri, tetapi juga pada detail implementasi CPython dan pustaka standarnya, yang memastikan bahwa Anda tidak akan memiliki cara mudah untuk membuat aplikasi Python menjadi multithread, cepat, atau mudah didukung, dan mengapa begitu banyak yang dibuat implementasi alternatif (PyPy, Cython, Jython, IronPython, Python untuk .NET, Parkit, Nuitka, Stackless, Unladen Swallow), setengahnya sudah mati;  dan hanya sedikit yang mengerti mengapa alternatif itu tidak memiliki kesempatan untuk memenangkan perjuangan untuk bertahan hidup melawan bahasa lain.  Ya, ada GDScript, yang dirancang untuk menyelesaikan masalah kinerja, ada Nim, yang dirancang untuk menyelesaikan semua masalah secara umum, tanpa mengharuskan pengguna untuk secara eksplisit menyatakan jenis.  Namun, mengingat inersia industri yang sangat besar, saya menyadari bahwa dalam 10 tahun ke depan, bahasa-bahasa baru pasti tidak akan menempati ceruk yang signifikan.  Namun, saya <strong>percaya</strong> bahwa python dapat dibuat efektif dengan mengubah gaya penulisan kode, untuk sebagian besar mempertahankan sintaks asli, dan sepenuhnya menjaga kemungkinan interaksi antara kode gaya lama dan baru.  Saya akan fokus pada masalah CPython, bukan pesaing terdekatnya, PyPy, karena PyPy benar-benar melompati semua masalah yang sama dari CPython. </p><a name="habracut"></a><br><p>  Saya seorang programmer dengan tujuh tahun pengalaman, terutama terlibat dalam pengembangan aplikasi desktop, dengan beberapa penekanan pada web dan database multi-threaded.  Anda bertanya, "tunggu sebentar, tapi apa kesamaan python dengan antarmuka pengguna, front web, dan multithreading?".  Dan saya akan menjawab "itu saja - tidak ada."  Saya menggunakan C, Delphi, JavaScript, dan SQL untuk tugas saya.  Saya tidak terlalu senang dengan situasi ini, dan beberapa waktu yang lalu saya mencoba untuk berpartisipasi dalam proyek Eric Snow untuk mengimplementasikan dukungan untuk banyak penerjemah dalam CPython: <br>  <a href="https://www.python.org/dev/peps/pep-0554/" rel="nofollow">https://www.python.org/dev/peps/pep-0554/</a> <br>  <a href="https://github.com/ericsnowcurrently/multi-core-python" rel="nofollow">https://github.com/ericsnowcurrently/multi-core-python</a> </p><br><p>  Sayangnya, pemahaman dengan cepat datang bahwa: </p><br><ul><li>  CPython agak kurang didukung untuk proyek yang begitu populer, dan memiliki banyak masalah lama yang muncul ketika mencoba menggambar ulang implementasi.  Akibatnya, Eric telah memilih penerjemah dengan kemajuan variabel selama beberapa tahun; </li><li>  bahkan setelah implementasi multi penerjemah yang berhasil, tidak jelas bagaimana mengatur eksekusi paralel lebih lanjut.  PEP menyarankan menggunakan saluran sederhana, tetapi alat ini menjadi berbahaya karena tugasnya menjadi lebih kompleks, dengan ancaman pembekuan dan perilaku yang tidak terduga; </li><li>  bahasa itu sendiri memiliki masalah besar mencegah penafsir dari bertukar data secara langsung dan memberikan jaminan perilaku yang dapat diprediksi. </li></ul><br><p>  Sekarang, lebih detail tentang masalahnya. </p><br><h4 id="izmenyaemye-opredeleniya-klassov">  Definisi kelas yang dapat dimodifikasi </h4><br><p>  Ya, saya mengerti bahwa kelas dalam python dideklarasikan pada saat runtime.  Tapi sialnya, mengapa memasukkan variabel ke dalamnya?  Mengapa menambahkan metode baru ke objek lama?  Anda tidak bisa mendeklarasikan fungsi dan variabel di luar kelas di Java apa pun, tetapi tidak ada batasan seperti itu di python (dan python dibuat sebelum Java).  Selain itu, saya meminta Anda untuk memperhatikan bagaimana Anda perlu membungkuk dengan kanker untuk menambahkan metode serupa ke objek itu sendiri, dan bukan ke kelas - ini membutuhkan tipe. Metode, fungsi. Get___, functools.partial, dan sebagainya. <br>  Sebagai permulaan, saya ingin mengajukan pertanyaan aneh: mengapa ular sanca membutuhkan metode sama sekali?  Bukan fungsi, seperti pada JavaScript tutup, tetapi metode kelas.  Salah satu faktor: Guido tidak datang dengan cara yang lebih baik untuk membuat nama pendek fungsi (sehingga tidak ada gtk_button_set_focus_on_click), karena tidak jelas bagaimana memilih fungsi yang diperlukan untuk objek spesifik ini dari sekelompok fungsi serupa dengan nama pendek.  Namun demikian, len, iter, next, isinstance, slice, dict, dir, str, repr, hash, ketik muncul dengan python - sekarang ini adalah pembungkus atas metode kelas yang sesuai dengan garis bawah dalam nama, dan sekali tipe built-in sederhana tidak kelas dan hanya bekerja melalui fungsi-fungsi ini.  Secara pribadi, saya tidak melihat banyak perbedaan antara pencatatan metode (objek) dan metode object.method - terutama jika metode adalah fungsi statis, yang, secara umum, tidak peduli dengan argumen mana (diri) yang harus diterima. <br>  Definisi kelas dinamis dalam kasus umum: </p><br><ul><li>  Jangan memberikan <strong>pengujian</strong> modular.  Sepotong kode yang dikerjakan dengan benar dalam pengujian dapat memberikan kesalahan ketika seluruh sistem bekerja, dan Anda tidak akan terlindungi dari hal ini di dalam CPython; </li><li>  membuat kesulitan besar dalam <strong>pengoptimalan</strong> .  Deklarasi kelas tidak menjamin operasi kelas yang sebenarnya.  Untuk alasan ini, satu-satunya proyek pengoptimal yang berhasil dari PyPy menggunakan pelacakan untuk mendeteksi urutan tindakan aktual yang dilakukan oleh metode penyelidikan; </li><li>  Jangan berlabuh dengan eksekusi kode <strong>paralel</strong> .  Sebagai contoh, multiprosesing yang sama berfungsi dengan salinan definisi kelas, dan jika, Tuhan melarang, mengubah deskripsi kelas di salah satu salinan, maka aplikasi Anda berisiko hancur berantakan. </li></ul><br><p>  Versi kelas dinamis yang lebih halus menimpa akses atribut melalui __getattribute__, __getattr__, dan lainnya.  Seringkali mereka digunakan sebagai pengambil rutin, untuk mendelegasikan fungsi ke objek bidang, dan kadang-kadang untuk mengatur <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA" rel="nofollow">DSL</a> .  Semua fungsi ini dapat diimplementasikan dengan cara yang lebih beradab, tanpa mengubah kelas menjadi tumpukan deskripsi, yang perilakunya terkadang sulit dijamin.  Omong-omong, dalam kasus getter / setter, mekanisme seperti itu sudah ada - ini adalah deskriptor atribut: <a href="https://www.python.org/dev/peps/pep-0252/" rel="nofollow">https://www.python.org/dev/peps/pep-0252/#id5</a> </p><br><p>  Swapping kelas panas diperlukan untuk debugging dan pengkodean biasa, tetapi masih harus menjadi alat khusus untuk pengembang, dan bukan artefak saat runtime yang tidak bisa dihilangkan. </p><br><p>  Kelas yang dikompilasi hanyalah langkah kecil yang telah diambil oleh Cython dan Nuitka, tetapi langkah ini saja, tanpa perubahan lain, tidak cukup untuk mendapatkan efek yang signifikan bahkan dalam hal kecepatan eksekusi, karena, misalnya, python secara ekstensif menggunakan pengikatan variabel dinamis, yang mana-mana tidak hilang dalam kode yang dikompilasi. </p><br><h4 id="mnozhestvennoe-nasledovanie">  Warisan berganda </h4><br><p>  Saya pikir ini adalah pemimpin parade topi.  Bahkan tidak pada tingkat fungsi-C dalam implementasi python itu sendiri dan ekstensi-nya.  "Tapi bagaimana dengan antarmuka?" Anda keberatan.  Antarmuka dalam C ++ dan Java diperlukan dalam peran mendeklarasikan protokol untuk memanggil metode objek untuk tujuan verifikasi statis selanjutnya dari protokol ini saat dikompilasi, serta untuk menghasilkan tabel metode yang pada saat run time akan digunakan oleh kode lain yang tidak tahu apa-apa tentang objek sumber.  Peran ini hampir sepenuhnya hilang dalam python, oleh karena itu tidak ada pembenaran untuk keberadaannya.  Saya suka cara antarmuka dibuat di Go - sangat mirip dengan python ABC: <a href="https://www.python.org/dev/peps/pep-3119" rel="nofollow">https://www.python.org/dev/peps/pep-3119</a> </p><br><p>  Multiple inheritance bukan masalah langsung untuk paralelisasi dan optimisasi, tetapi mempersulit keterbacaan dan pemeliharaan kode - ini adalah kode lasagna (dengan analogi dengan kode spaghetti). </p><br><h4 id="generatory">  Generator </h4><br><p>  Ini adalah kasus GoTo yang benar-benar terabaikan, ketika eksekusi tidak hanya melompati kode secara tidak terkendali - melompati tumpukan.  Terutama permainan sengit terjadi ketika generator bersinggungan dengan manajer konteks (halo PEP 567).  Jika ada kecenderungan umum dalam python untuk mengacaukan aplikasi menjadi bola yang ketat dari keadaan yang dapat berubah yang terhubung yang tidak memberikan ruang untuk pengujian, paralelisasi, dan manuver program optimasi, maka generator adalah ceri pada kue ini. </p><br><p>  Menurut Anda apa hasil dari program ini: </p><br><pre><code class="python">import contextlib
@contextlib.contextmanager
def context_manager():
    try:
        print('')
        yield
    finally:
        print('')

def gen_in_manager():
    m = context_manager()
    with m:
        for i in range(5):
            yield i

g1 = gen_in_manager()
next(g1)
print('')</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p>     <a href="https://stackoverflow.com/questions/41881731/is-it-safe-to-combine-with-and-yield-in-python" rel="nofollow">stackoverflow</a><br>
<br>
<br>
 —        </p></div></div><br>
<p>      ,           :</p><br>
<pre><code class="python">import contextlib
@contextlib.contextmanager
def context_manager():
    try:
        print('')
        yield
    finally:
        print('')

def gen_in_manager():
    m = context_manager()
    with m:
        for i in range(5):
            yield i

def test():
    g1 = gen_in_manager()
    next(g1)

test()
print('')</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p><br>
<br>
</p></div></div><br>
<p>        .<br>
  ,         ,    :        async/await,          . </p><br>
<p> :  RPython    -.  ,       .             <strong></strong>, <strong></strong>,  <strong></strong>.</p><br>
<h4 id="izmenyaemye-znacheniya"> </h4><br>
<p><a href="https://stackoverflow.com/questions/530530/python-2-x-gotchas-and-landmines" rel="nofollow">https://stackoverflow.com/questions/530530/python-2-x-gotchas-and-landmines</a></p><br>
<pre><code class="python">&gt;&gt;&gt; a = ([42],)
&gt;&gt;&gt; a[0] += [43, 44]
TypeError: 'tuple' object does not support item assignment
&gt;&gt;&gt; a
([42, 43, 44],)
&gt;&gt;&gt; a = ([42],)
&gt;&gt;&gt; b = a[0]
&gt;&gt;&gt; b += [43, 44]
&gt;&gt;&gt; a
([42, 43, 44],)

&gt;&gt;&gt; x = y = [1,2,3]
&gt;&gt;&gt; x = x + [4]
&gt;&gt;&gt; x == y
False
&gt;&gt;&gt; x = y = [1,2,3]
&gt;&gt;&gt; x += [4]
&gt;&gt;&gt; x == y
True

&gt;&gt;&gt; x = [[]]*5
&gt;&gt;&gt; x
[[], [], [], [], []]
&gt;&gt;&gt; x[0].append(0)
&gt;&gt;&gt; x
[[0], [0], [0], [0], [0]]</code></pre><br>
<p>      ,      «'tuple' object does not support item assignment»     :        .    ,      ,     , , .  ,   , x[0].append(0)                 ,   CPython        ,     .         ,          .</p><br>
<p>        —  [] ?   , ,             .  ,  Clojure     ,       -  partial-copy-on-write      .        ,         .</p><br>
<p>    ?  , ,      . ,   copy-on-write  ,         : b.append.., b[].., b +=… :     ,     ,    —  <strong>, , </strong>.  ,  ,       ,   ,  //      ,         .</p><br>
<p>       copy-on-write?               ,  ,        (),          (  ),        ,    .</p><br>
<p>  -                  .  ? ,       copy-on-write,      «({'first': 1, 'second': 2},)»,  ,   ,     ,  ,      ,      «{'first': 1, 'second': 2}».</p><br>
<h4 id="polimorfizm-i-mnozhestvennaya-dispetcherizaciya">   </h4><br>
<p><a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25BB%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2580%25D1%2584%25D0%25B8%25D0%25B7%25D0%25BC_(%25D0%25B8%25D0%25BD%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B0" rel="nofollow">https://ru.wikipedia.org/wiki/_(</a>)<br>
«       —      »</p><br>
<p>: <a href="https://en.wikipedia.org/wiki/Multiple_dispatch" rel="nofollow">https://en.wikipedia.org/wiki/Multiple_dispatch#Use_in_practice</a><br>
 ,     13–32%       (a.k.a.  ),  2.7–6.5%  —    .      :         ,    ,    ,      .   ,  ,            .</p><br>
<p>,     —    ,     .      ,  ,      . ,      double    char,     ,        double        .</p><br>
<pre><code class="cpp">float a = 2.0;
float *src = &amp;a;
char *dest = malloc(sizeof(float));
memcpy(dest, src, sizeof(float));
printf("%f", *(double*)dest);</code></pre><br>
<p> ,       (, , )    —           -   ,     , ,  .</p><br>
<p>   ,       (     )   .             :      «a = b + c»,     ,     .      ?</p><br>
<ul>
<li>    : «if (Py_TYPE(obj) == &amp;PyLong_Type) {long val = PyLong_AsLong...}»        type();</li>
<li>     : «PyArg_ParseTuple()»        ,  «this.number = int(param1); this.text = str(param2)» —          ,       .      , ,           (   ,         );</li>
<li>//    .               —            .</li>
</ul><br>
<p>,    .     ,      ?         CPython, ,  ,     ,    ,      .  ,   :             . ,       ?   :  ,        /     ,     /   . C «a = b + c»    ( ,     ):</p><br>
<pre><code class="python">def PyNumber_Add(b, c):
  slotb = b.__add__
  if not type(b) is type(c) and c.__add__:
    slotc = c.__add__
    if slotc is slotb:
      slotc = None
  if slotb:
    if slotc and isinstance(c, b.__class__):
      return slotc(b, c)
    else:
      return slotb(b, c)
  else:
    return slotb(b, c)

if isinstance(b, str) and isinstance(c, str):
  a = unicode_concatenate(b, c)
else:
  a = PyNumber_Add(b, c)</code></pre><br>
<p>    ,         ,    . «  »     —  ,   , , ,     .   ,       ,   ,       «  », «», «»,   ;   —           .</p><br>
<p>   :   ,    .  ,       .    :    ,          .  ,        ,       —    .</p><br>
<p>           ,            .     ,       ,  <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D1%2581%25D0%25B5%25D1%2582%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C_(%25D1%2588%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BD_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B5%25D0%25BA%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)" rel="nofollow"> </a>.  ,     -       ,        .</p><br>
<p>      ,             ,     (     ),       (     ),        .     ,                 ,       (  ).   ,   ,           —       , ?                 <strong> </strong>  <strong>  </strong>.</p><br>
<p>         —   :        ,         .  ,    ,       . ,       ,     - ,     , :       .         ,    ,     —     MRO:<br>
<a href="https://www.python.org/download/releases/2.3/mro/" rel="nofollow">https://www.python.org/download/releases/2.3/mro/</a><br>
<a href="https://ru.wikipedia.org/wiki/C3-%25D0%25BB%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B0%25D1%2580%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F" rel="nofollow">https://ru.wikipedia.org/wiki/C3-</a> </p><br>
<p>   ,    3.4      « » ( <a href="https://www.youtube.com/watch%3Fv%3DohDB5gbtaEQ" rel="nofollow">Argument — Monty Python</a> ),             .   «    »…  ,  : 3.4   2014,       1991.</p><br>
<p>          .                 ,      (trait)  Rust ( ,   ,   , ,       ):<br>
<a href="https://doc.rust-lang.org/1.8.0/book/traits.html" rel="nofollow">https://doc.rust-lang.org/1.8.0/book/traits.html</a><br>
 ,        ,     ,      ,  ,           .        «».       ,     ,           . ,  -  , ,  Rust-. ,   __iter__ —      «». ,       ,     ,       ,      .       ,  «     - ,    ».   ,           ,    <a href="" rel="nofollow">C++ ranges</a>,       ,    ,    .<br>
  :</p><br>
<pre><code class="python">from collections.abc import Iterable, Container
from itertools import filterfalse

class MyList(Trait, Iterable, Container):
  pass

def __sub__(a: MyList, b: object):
  return list(filterfalse(lambda x: x == b, a))

def __sub__(a: MyList, b: Container):
  return list(filterfalse(lambda x: x in b, a))

a = MyList([1, 2, 3, 4, 5])
print(a - [2, 5]) #  , print(__sub__(a, b))
# : [1, 3, 4]
print(a - 3)
# : [1, 2, 4, 5]</code></pre><br>
<p>        MyList,     Iterable (  __iter__)  Container ( __contains__),    list,   list      MyList,   MyList    list,  list    MyList.        :</p><br>
<pre><code class="python">from collections.abc import Container
from itertools import filterfalse

class MyList(list):
  def __sub__(self, b):
    if isinstance(b, Container):
      return list(filterfalse(lambda x: x in b, a))
    else:
      return list(filterfalse(lambda x: x == b, a))

a = MyList([1, 2, 3, 4, 5])
print(a - [2, 5])
# : [1, 3, 4]
print(a - 3)
# : [1, 2, 4, 5]</code></pre><br>
<p>   :        ,          «a»,          .    « »,       -,       .</p><br>
<p>,             — ,            ,              ,   .   ,      ,        .</p><br>
<h4 id="operator-prisvoeniya-i-staticheskaya-tipizaciya">    </h4><br>
<p> ,         ,         . ,         ,      ,        ,     , ,    .          - ,      —     -  ,      . :</p><br>
<pre><code class="python">&gt;&gt;&gt; a = [1, 2, 3]
...
&gt;&gt;&gt; a = '15'
...
&gt;&gt;&gt; for i in map(lambda x: x*2, a):
&gt;&gt;&gt;    print(i)
11
55</code></pre><br>
<p> </p><br>
<pre><code class="plaintext">2
4
6</code></pre><br>
<p>          .</p><br>
<p>,            ,           .   None —    , NoneType.  ,     —   ,      -   ,         .        :</p><br>
<pre><code class="python">&gt;&gt;&gt; class A():
&gt;&gt;&gt;   def __init__(self, value):
&gt;&gt;&gt;     self.val = value
&gt;&gt;&gt;
&gt;&gt;&gt; a = A('2')
&gt;&gt;&gt; a.val = []
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
TypeError: can only assign str (not "list") to str
&gt;&gt;&gt; a.myattr = []
&gt;&gt;&gt; a.myattr = 2</code></pre><br>
<p>   A     val,      . , -          (myattr) —         ,          ,      .</p><br>
<p>,          .        —   ,    ,       .    ,       :</p><br>
<pre><code class="python">&gt;&gt;&gt; class A():
&gt;&gt;&gt;   def __init__(self, value):
&gt;&gt;&gt;     self.val = value
&gt;&gt;&gt;
&gt;&gt;&gt; def func():
&gt;&gt;&gt;   a = A(None)
&gt;&gt;&gt;   a.val = 2
&gt;&gt;&gt;   print(a.__dict__)
&gt;&gt;&gt;
&gt;&gt;&gt; func()
{'val': 2}</code></pre><br>
<p>      A&lt;None or Int&gt;,      . ,         ,         .</p><br>
<p>       :  ,              :   , ,            ,          «-»,     «».    —   ,    ; - ,  ,     ,          ,      .    , ,        «list»,  ,   ,  list comprehension,  ,   ,  BUILD_LIST  LIST_APPEND ( CPython) —          ?   ,      «  », «  - ».</p><br>
<p> ,  - ()        ,  «a.val = int(newval)». ,     ,          ,         .          ,  __setattr__  __setattribute__,   c 2.2       __set__ ( <a href="https://www.python.org/dev/peps/pep-0252/" rel="nofollow">https://www.python.org/dev/peps/pep-0252/</a> ).    :     ,           ,      —    C++/Java/C#.  ,            :        __set__, __get__, __delete__,           , :</p><br>
<pre><code class="python">&gt;&gt;&gt; a = StrictDict({'first': 1 })
&gt;&gt;&gt; a = { 'dummy': 666 }
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
StrictDictError: "first" key is missing in the assignment source</code></pre><br>
<p> ,          (  « »):     copy-on-write ,     ,        -,   copy-on-write    :</p><br>
<pre><code class="python">&gt;&gt;&gt; a = COWList([1, 2, 3])
&gt;&gt;&gt; b = a
&gt;&gt;&gt; a.append(4)
&gt;&gt;&gt; b.append(5)
&gt;&gt;&gt; a
[1, 2, 3, 4]
&gt;&gt;&gt; b
[1, 2, 3, 5]</code></pre><br>
<p>,    CPython         ,    «»:<br>
<a href="" rel="nofollow">https://github.com/python/cpython/blob/master/Objects/typeobject.c#L5074</a><br>
   ,  __slots__  .        ,        ,             ,       ,  ,        ,   ,     ,  .     (  )        .       ,     :   __slots__ ,    PyHeapTypeObject-&gt;ht_slots,  __dict__,         PyTypeObject-&gt;tp_dictoffset.   ,        .</p><br>
<h4 id="vyvod-tipov"> </h4><br>
<p> ,      ,         .           ,      ,     ,       ,      ,  « ,       ;     —      "",      ""»,             . ,     ,      .   <a href="https://twitter.com/tproger/status/1084801082084212736" rel="nofollow">  </a> «&lt;&gt;  = new &lt;&gt;()»,          «var  = new &lt;&gt;()». ,        ReasonML ,    ,     —    JS ,        ,        .</p><br>
<p>PyPy,    V8  JavaScript  LuaJIT,        ,         .       -    ,   ,          .        AOT ,   asm.js, WebAssembly,     PNaCl.</p><br>
<p>        : </p><br>
<ol>
<li>Bauer, A.M. and Saal, H.J. (1974). Does APL really need run-time checking? Software — Practice and Experience 4: 129–138. </li>
<li>Kaplan, M.A. and Ullman, J.D. (1980). A scheme for the automatic inference of variable types. J. A CM 27(1): 128–145. </li>
<li>Borning, A.H. and Ingalls, D.H.H. (1982). A type declaration and inference system for Smalltalk. In Conference Record of the Ninth Annual ACM Symposium on Principles of Programming Languages (pp. 133–141) </li>
<li><a href="https://ru.wikipedia.org/wiki/Standard_ML" rel="nofollow">https://ru.wikipedia.org/wiki/Standard_ML</a> — 1984 . </li>
</ol><br>
<p>  , Standard ML   ,      ,        .<br>
,   -          ,               .  ,    ,   —      ,          ,     (      ),        : </p><br>
<ol>
<li>Frank Pfenning. (1988). Partial polymorphic type inference and higher-order unification. In Proceedings of the 1988 ACM Conference on Lisp and Functional Programming, pp. 153–163 </li>
<li>Cardelli, Luca; Martini, Simone; Mitchell, John C.; Scedrov, Andre (1994). An extension of system F with subtyping. Information and Computation, vol. 9. North Holland, Amsterdam. pp. 4–56 </li>
<li>Benjamin C. Pierce, and David N. Turner. (1997). Local type inference. Indiana University CSCI Technical Report #493, pp. 1-25<br>
  <br>
(1998) Local type inference. POPL '98 Proceedings of the 25th ACM SIGPLAN-SIGACT symposium on Principles of programming languages, pp. 252-265<br>
<br>
(2000). Local type inference. ACM Transactions on Programming Languages and Systems (TOPLAS). Vol. 22(1), pp. 1-44 </li>
</ol><br>
<p>    —   ,    Scala,     2001 .</p><br>
<p> 1991   ,  1994 — ,  1995 —  «Matz»,         .    ,        ,       . ,   ,        — ,        ,   ,   ,        ,  ZeroMQ, RabbitMQ, Kafka.            ,        ,        ,                   ,       ,                      .             ,         ?  .  -     ,     Crystal,       ,   .</p><br>
<h4 id="itog"></h4><br>
<p> —    .         ,  ,      .</p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id481782/">https://habr.com/ru/post/id481782/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id481770/index.html">Pelopor pemrograman komputer Tony Brucker meninggal pada usia 94</a></li>
<li><a href="../id481774/index.html">Lembar Cheat Keamanan: Penambalan Virtual</a></li>
<li><a href="../id481776/index.html">Layanan 5G dan cloud gaming - uji cara kerjanya di Moskow</a></li>
<li><a href="../id481778/index.html">Analisis malware Skeleton Key</a></li>
<li><a href="../id481780/index.html">MyOffice memiliki lebih dari 200 fitur baru</a></li>
<li><a href="../id481784/index.html">Bagaimana Kafka menjadi kenyataan</a></li>
<li><a href="../id481786/index.html">Google mengubur ekstensi IMAP PHP</a></li>
<li><a href="../id481788/index.html">Analisis pemecahan masalah industri nyata (menyelamatkan anak babi dan lainnya)</a></li>
<li><a href="../id481790/index.html">Bagaimana selingkuh mengubah komunitas speedrunner</a></li>
<li><a href="../id481792/index.html">Bagaimana PVS-Studio mengadakan paruh kedua dari konferensi 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>