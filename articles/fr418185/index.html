<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¨ üç£ üë∂üèΩ Une histoire d'autopsie: comment nous avons invers√© Hancitor üë©üèø‚Äçüöí üöÑ üë©üèΩ‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour ceux qui ont d√©j√† assez jou√© avec les puzzles crackme , nous avons apport√© un nouveau cheval de Troie. Dans la nature, le t√©l√©chargeur Hancitor s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une histoire d'autopsie: comment nous avons invers√© Hancitor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/418185/"><img src="https://habrastorage.org/webt/dn/-j/1o/dn-j1ohonpxz_urf0totdzgdxa4.jpeg"><br><br>  Pour ceux qui ont d√©j√† assez jou√© avec les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">puzzles crackme</a> , nous avons apport√© un nouveau cheval de Troie.  Dans la nature, le t√©l√©chargeur Hancitor se trouve toujours dans son habitat naturel - les courriers ind√©sirables.  Actuellement, il est activement utilis√© pour t√©l√©charger le cheval de Troie bancaire Panda, qui est une modification du fameux Zeus. <br><br>  Par une froide soir√©e d'√©t√©, nous l'avons rencontr√© face √† face, en train de regarder les courriers ind√©sirables.  Si vous aimez voir ce que le malware a sous le capot, lisez notre nouvelle analyse inverse. <br><a name="habracut"></a><br>  Notre document malveillant ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/am/z_/bu/amz_buin-rjqprnnk-v2xuaio28.png"><br><br>  Par d√©faut, les macros sont bloqu√©es, donc le syst√®me avertit: "Les macros ont √©t√© d√©sactiv√©es."  Cependant, le contenu du message indique que les macros doivent √™tre incluses.  Eh bien, faisons-le.  Apr√®s avoir cliqu√© sur le bouton Activer le contenu, l'ordinateur est infect√©.  Voyons maintenant quel type de macro est ex√©cut√© et comment exactement l'infection se produit.  Cela peut √™tre fait imm√©diatement dans Word en allant dans l'onglet Affichage-&gt; Vacros \ Afficher les macros. <br><br><img src="https://habrastorage.org/webt/ly/uq/kd/lyuqkdosmy1commpds7-nu96gsa.png"><br><br>  Vous pouvez faire plus professionnellement - utilisez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">olevba √†</a> partir du paquet oletools.  Vous pouvez y installer le package sur le lien.  Ensuite, tapez olevba doc_file ‚Äìc ‚Äìdecode&gt; source.txt et obtenez la macro source. <br><br><img src="https://habrastorage.org/webt/tc/tk/gp/tctkgps17vavk9-zgtmzyjgparw.png"><br><br>  Par le code, je veux imm√©diatement dire que le cheval de Troie appartient √† la classe des t√©l√©chargeurs.  Le script se d√©gonfle de quelque part vers le Malwara.  Pour le prouver, d√©codons les cha√Ænes base64.  Il est plus pratique pour nous de le faire imm√©diatement via hiew, afin de ne pas copier-coller cent fois.  Pour ce faire, nous utilisons un plugin sp√©cial, qui est d√©crit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Voici ce qui s'est pass√©: <br><br><img src="https://habrastorage.org/webt/az/tv/jo/aztvjo9bo-8zxu7vaus2mzxadcc.png"><br><br>  Il s'agit d'un script malveillant, divis√© en deux parties et enregistr√© sous 1.hta.  En principe, nous ne sommes pas particuli√®rement int√©ress√©s par son fonctionnement.  C'est assez banal.  Le seul point important est de d√©terminer l'URL √† laquelle le fichier malveillant est t√©l√©charg√©.  Essayons de le retrouver, car ces informations peuvent √™tre utiles √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©curit√©</a> .  Ils peuvent ajouter des r√®gles de r√©seau pour bloquer les demandes √† ces URL, ce qui peut sauver l'entreprise de l'infection. <br><br>  Ha!  Il n'y a aucun lien.  Mais d'o√π vient le fichier 6.exe, qui d√©marre 1.hta?  Il est temps de revoir notre fichier dock dans hiew, mais plus attentivement: <br><br><img src="https://habrastorage.org/webt/b2/cc/y1/b2ccy1ewmolwz5wnaqojxdracbm.png"><br><br>  Oui, un exe-shnik est int√©gr√© au document du dock.  Oui, et fortement emball√©.  Expliquons ce qui se passe.  La macro d√©pose le script 1.hta malveillant dans le dossier Temp et le lance, et 1.hta, √† son tour, lance 6.exe √† partir de son r√©pertoire.  Il est clair que 6.exe est le m√™me PE-shnik emball√© que nous voyons √† l'√©cran.  Mais maintenant, nous nous demandons comment 6.exe baisse en% temp%.  Et cela se produit en raison d'une fonctionnalit√© int√©ressante de la suite Microsoft Office.  Le fait est que dans tout document OLE, tout autre fichier au format Ole10Native peut √™tre incorpor√©. <br><br>  Si c'est le cas, au d√©marrage, MS-Office lui-m√™me d√©pose le fichier ainsi construit dans le dossier% temp% sous le nom sp√©cifi√© dans l'en-t√™te de la structure Ole10Native.  Jetons un coup d'≈ìil √† cet objet.  Nous avons √©t√© aid√©s par le plugin pour le gestionnaire FAR - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OLE2Viewer</a> .  Nous ouvrons notre document malveillant dans le plugin, allons dans le r√©pertoire ObjectPool \ _1593522492 et voyons ceci: <br><br><img src="https://habrastorage.org/webt/cc/wn/mx/ccwnmx32xpqyiizulnovkdnrkla.png"><br><br>  Copiez ce fichier (Ole10Native) et ouvrez-le dans la vue. <br><br><img src="https://habrastorage.org/webt/vr/xb/37/vrxb37l9_urz13rlu0jvxphqpus.png"><br><br>  Ici, nous voyons sous quel nom notre objet OLE - 5c.pif tombera dans le dossier% temp%.  Revenons maintenant √† notre macro.  Sa t√¢che consiste √† lancer un exe-shnik ivre. <br><br><img src="https://habrastorage.org/webt/lo/wk/li/lowkli2uxojiyiq0gsoq6iuxh7e.png"><br><br>  En fait, pour √™tre pr√©cis, la macro ne d√©marre pas toujours le fichier d√©pos√© via 1.hta, mais aussi comme ceci: Shell "cmd.exe / c ping localhost -n 100 &amp;&amp;" &amp; Environ ("Temp") &amp; "\ 6 .pif ", vbHide <br><br><img src="https://habrastorage.org/webt/ut/8p/va/ut8pvaykzvbydqbqdfw3wuapvyy.png"><br><br>  La m√©thode de lancement, comme nous le voyons, d√©pend de la pr√©sence des processus suivants dans le syst√®me: bdagent.exe et PSUAMain.exe.  Pourquoi alors avez-vous besoin de ping localhost -n 100?  Et c'est une astuce grecque ancienne pour cr√©er un retard artificiel, au cas o√π.  Habituellement, ses variantes sont utilis√©es pour l'auto-suppression. <br><br>  √Ä ce stade, nous avons examin√© le fonctionnement d'un document malveillant.  Il nous est apparu clairement que le document lui-m√™me n'appartient pas √† des logiciels malveillants de type Trojan-Downloader, comme il semblait √† premi√®re vue, mais convient au type de Trojan-Dropper.  Voici ce qui s'est pass√© au d√©marrage: <br><br><img src="https://habrastorage.org/webt/rd/qp/ki/rdqpkibxofr7rfrqloll1p_xf_q.png"><br><br>  Il reste maintenant √† d√©monter la charge utile elle-m√™me.  Nous avons d√©j√† r√©alis√© que notre cheval de Troie est emball√©, nous devons donc le d√©baller d'abord.  Habituellement, ce processus est divis√© en deux √©tapes: <br>  1. Suppression du vidage d√©compress√© + restauration de la table d'importation. <br>  2. Analyse et purification des variables globales. <br><br>  Nous avons besoin de la deuxi√®me √©tape car il existe de nombreuses fonctions API qui, √† la suite de leur travail, nous renvoient des valeurs non r√©p√©titives.  Par exemple, CreatHeap nous renverra un descripteur de tas, qui sera ensuite utilis√© pour le travail.  Tr√®s souvent, il y a des v√©rifications de type dans le code: <i>si le descripteur de tas == 0, alors obtenez le descripteur de tas, sinon utilisez-en un d√©j√† initialis√©</i> .  Mais au moment du vidage, la variable contenant le descripteur donn√© √©tait d√©j√† initialis√©e par lui et √† ce moment le descripteur √©tait valide.  Lorsque nous essayons de d√©marrer le vidage, la variable avec notre descripteur contiendra l'ancienne valeur, c'est-√†-dire non √©gale √† 0, ce qui signifie que le test passera. <br><br>  Apr√®s cela, d√®s que le programme essaie d'utiliser ce descripteur, le syst√®me d'exploitation l√®vera une exception et le programme se bloquera avec une erreur.  Donc, pour √©viter cela, vous devez mettre √† z√©ro ces variables.  Ils sont g√©n√©ralement situ√©s dans une section accessible en √©criture des donn√©es.  Vous sugg√©rez probablement d'ouvrir cette section dans l'√©diteur hexad√©cimal et de tout √©craser avec des z√©ros?  Vous avez en partie raison, mais vous ne devez pas prendre de mesures irr√©fl√©chies.  Il existe des chevaux de Troie qui v√©rifient les variables non pas sur 0, mais sur un DWORD al√©atoire.  Et selon que le test est test√© ou non, diverses actions sont prises.  Vous n'avez pas besoin d'aller loin pour des exemples.  Il suffit de regarder le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cridex</a> (r√©cemment, il a disparu quelque part des radars, apparemment il a √©t√© compl√®tement mis √† niveau vers EMOTETA). <br><br>  Ex√©cutons donc notre exemple (dans une machine virtuelle, bien s√ªr).  Il est √©galement souhaitable que le trafic sortant de la machine virtuelle passe par un VPN. <br><br>  Nous lan√ßons notre cheval de Troie et il se bloque simplement dans le processus.  Super!  En r√®gle g√©n√©rale, les chevaux de Troie font les choses rapidement, puis s'arr√™tent imm√©diatement et s'autod√©truisent.  Par cons√©quent, vous devez rechercher des emplacements dans le code responsables de ces actions, y mettre une pause, puis effectuer un vidage.  Dans notre cas, nous pouvons le faire comme √ßa. <br><br>  Pour le vidage, nous utilisons le merveilleux utilitaire - Process Dump, qui peut √™tre trouv√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Cet utilitaire non seulement trouve tous les modules ex√©cutables cach√©s et les vide, mais restaure √©galement la table d'importation elle-m√™me.  L'utilitaire doit √™tre ex√©cut√© en tant qu'administrateur de la mani√®re suivante: pd / pid xxxx, o√π xxxx est l'ID du processus cheval de Troie.  Apr√®s cela, l'utilitaire vide tous les modules de processus.  Nous avons supprim√© les suppl√©mentaires et voici ce qui reste: <br><br><img src="https://habrastorage.org/webt/tg/je/db/tgjedb068z9unx10xyhit2dftii.png"><br><br>  Le nom du fichier ex√©cutable du processus cheval de Troie est 1.exe.  Il s'av√®re que le cheval de Troie d√©ball√© √©tait situ√© √† 0x2C0000.  Ouvrez-le ici: <br><br><img src="https://habrastorage.org/webt/84/je/fc/84jefcffxabgt-pihoargfo-raa.png"><br><br>  Juste un ≈ìil heureux!  Maintenant, le fichier est d√©compress√©, il est clairement visible.  La table d'importation a √©galement √©t√© reconnue.  Ouvrons-le dans IDA-PRO. <br><br><img src="https://habrastorage.org/webt/fn/hd/nc/fnhdncwcqiqd7jx_f7m8czjyf3m.png"><br><br>  Nous avons d√©j√† renomm√© certaines fonctions lors du tri de l'√©chantillon.  La premi√®re chose que le cheval de Troie commence par d√©terminer l'adresse de chargement de son module.  Et vraiment: comment savait-il √† quelle adresse son talon √©tait d√©ball√©?  Cela se fait avec une ancienne technique √©prouv√©e - retourner une page m√©moire √† 0x1000 par rapport √† l'adresse actuelle jusqu'√† ce que nous rencontrions les octets "MZ".  Cela fonctionne car les modules ex√©cutables chargent toujours le syst√®me d'exploitation √† une adresse qui est un multiple de 0x1000.  V√©rifiez par vous-m√™me.  Dans notre cas, une limite de 100 d√©capage est fix√©e. <br><br><img src="https://habrastorage.org/webt/7z/cy/5c/7zcy5cbgu4nls8b9yxz8gv9x3ai.png"><br><br>  Si quelqu'un ne comprend pas o√π il y a un retournement, voici o√π: <br>  result + = 0xFFFFF000 est √©quivalent √† result - = 0x1000. <br><br>  Apr√®s avoir re√ßu l'adresse de t√©l√©chargement de son module, le cheval de Troie d√©ball√© re√ßoit les adresses des fonctions n√©cessaires √† son fonctionnement.  Pour commencer, les adresses de deux fonctions sont recherch√©es - LoadLibraryA et GetProcAddress.  Connaissant les adresses de ces fonctions, vous pouvez les utiliser pour obtenir tout le reste.  Ces fonctions se trouvent dans la biblioth√®que kernel32.  Son adresse est obtenue en lisant le premier √©l√©ment (z√©ro - ntdll, premi√®re base de noyau, etc.) de la liste en anneau qui d√©crit tous les modules charg√©s dans l'ordre d'initialisation avec la structure _LDR_DATA_TABLE_ENTRY.  Le pointeur vers la liste est extrait du PEB. <br><br><img src="https://habrastorage.org/webt/zx/o3/s3/zxo3s3kevu7prcaoffacdxvklow.png"><br><br>  Apr√®s avoir re√ßu l'adresse kernel32.dll (√† partir de Windows 7 - kernelBase.dll), le cheval de Troie peut analyser manuellement sa table d'exportation et trouver les deux fonctions n√©cessaires, qui sont ex√©cut√©es de mani√®re pr√©visible dans le sous-programme sub_EF1E60. <br><br><img src="https://habrastorage.org/webt/7k/xz/4v/7kxz4vk7-ad4q4d221g-ealmkko.png"><br><br>  Jetez maintenant un ≈ìil √† la fonction que nous avons appel√©e getHeap. <br><br><img src="https://habrastorage.org/webt/qc/gv/oz/qcgvozmioggzgsidsap-5frkfas.png"><br><br>  Ici, nous observons uniquement la situation d√©crite ci-dessus.  Au moment du vidage, la variable hHeap contenait une valeur de 600000h.  Par cons√©quent, GetProcessHeap ne sera pas appel√©.  Au lieu de cela, le programme ira √† l'√©tiquette loc_EF11DD, o√π HeapAlloc est appel√© avec un handle non valide, ce qui nous donnera une erreur.  Par cons√©quent, nous prenons l'√©diteur hexad√©cimal et mettons √† z√©ro ce nombre.  Nous avons compt√© six endroits similaires. <br><br>  Ensuite, le plaisir commence.  Le cheval de Troie g√©n√®re un ID ¬´client¬ª unique bas√© sur le num√©ro de s√©rie du disque dur et l'adresse MAC.  Informations re√ßues ici: <br><br><img src="https://habrastorage.org/webt/hx/fo/ce/hxfoceeap2k3oqut_yjgwqsjnwu.png"><br><br>  Nous obtenons √©galement les informations suivantes: adresse IP, version du syst√®me d'exploitation, nom du r√©seau et nom d'utilisateur.  Sur la base de tout cela, une requ√™te HTTP est g√©n√©r√©e vers le panneau d'administration, dont nous ne connaissons pas encore l'adresse.  Ce n'est pas dans les lignes (m√™me sous la forme d√©ball√©e).  Mais il n'est pas l√†, car il est chiffr√© dans la configuration.  Son adresse peut √™tre extraite du code: <br><br><img src="https://habrastorage.org/webt/vw/9n/ej/vw9nej-cbxk5jgjljgjgasiwikw.png"><br><br>  La configuration p√®se 0x2008 octets et a le format suivant: les 8 premiers octets sont la cl√© RC4, 0x2000 octets sont les donn√©es crypt√©es. <br><br><img src="https://habrastorage.org/webt/tf/ne/je/tfneje_zc_aeq5nzmnzmkfd5r6c.png"><br><br>  Le fait que l'algorithme de chiffrement RC4 soit utilis√© ressort clairement de la liste suivante: <br><br><img src="https://habrastorage.org/webt/4g/jc/ci/4gjccirc5sxslir_xgfoiytzjhc.png"><br><br>  Veuillez noter que les 8 premiers octets seuls ne sont pas la cl√© de RC4.  La cl√© est le hachage SHA1 de ces octets.  Vous devez √©galement faire attention au drapeau 0x280011 de la fonction CryptDeriveKey.  MSDN a un avertissement concernant ce drapeau: <br><br><img src="https://habrastorage.org/webt/_t/2m/lu/_t2mlufhbsvpfivk9knvzdnoas0.png"><br><br>  De l√†, il devient clair que les 16 bits de poids fort de ce drapeau d√©finissent la taille de cl√© en bits.  Autrement dit, en octets, la taille de la cl√© est: (0x280011 &gt;&gt; 16) / 8 = 5. Par cons√©quent, la cl√© sera les cinq premiers octets du hachage des huit premiers octets de la configuration.  Videons la configuration et √©crivons un script python qui le d√©cryptera pour nous.  Le script ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/fo/ow/7t/foow7ta0eo02epz-qp8vtkiozfy.png"><br><br>  Le r√©sultat de son travail a √©t√© le fichier config.rc4.  Ouvrez-le ici: <br><br><img src="https://habrastorage.org/webt/rc/tz/dj/rctzdjyqwmh4ysz7pt7lhahlpna.png"><br><br>  Nous voyons une liste d√©chiffr√©e des zones d'administration.  Le premier mot est ¬´19nep07¬ª - num√©ro de build.  16 octets lui sont allou√©s.  Ensuite, une liste d'URL d'administration s√©par√©es par "|". <br><br>  Ainsi, le premier appel au panneau d'administration aura ce format: <br>  GUID = 3068075364164635648 &amp; BUILD = 19nep07 &amp; INFO = WIN-56G04BL06SL @ WIN -56G04BL06SL \ Reverse &amp; IP = 35.0.127.52 &amp; TYPE = 1 &amp; WIN = 6.1 (x32 <br><br><img src="https://habrastorage.org/webt/1e/5o/bg/1e5obgayvnhe8mlproaehfms000.png"><br><br>  Ensuite, la demande g√©n√©r√©e est envoy√©e en premier dans la liste du panneau d'administration. <br><br><img src="https://habrastorage.org/webt/ou/u8/ue/ouu8ueyhzcz_3hh2zbkmdh_hqvw.png"><br><br>  Ensuite, la r√©ponse de l'administrateur est lue, bien s√ªr, si elle est toujours vivante.  La r√©ponse doit √™tre cod√©e en base64.  Si ce n'est pas le cas, le prochain administrateur de la liste est pris.  Parfois, les administrateurs en direct renvoient une r√©ponse √©trange: <br><br><img src="https://habrastorage.org/webt/lu/d_/uo/lud_uoa61fkscmma-05nbxlkoic.png"><br><br>  C'est familier, non?  Oui, ce sont les m√™mes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chiffres</a> !  En fait, un auteur sait pourquoi l'administrateur commence √† les renvoyer!  Sous forme normale, la commande revient.  Malheureusement, il est impossible de dire avec certitude quel sera le format de r√©ponse, car il n'y a pas de trafic, tous les administrateurs sont morts.  Le fichier d√©cod√© est √©galement d√©cod√© en 0x7A: <br><br><img src="https://habrastorage.org/webt/f0/sc/8k/f0sc8kchkod-u2luugrrlty75t8.png"><br><br>  La r√©ponse doit contenir une commande.  Si ce n'est pas le cas, il y a un appel au prochain panneau d'administration.  Le code de commande est cod√© comme "x:", o√π x est la lettre codant une commande sp√©cifique.  Il y en a 7: ¬´r¬ª, ¬´l¬ª, ¬´e¬ª, ¬´b¬ª, ¬´d¬ª, ¬´c¬ª, ¬´n¬ª.  Consid√©rez les commandes ¬´b¬ª et ¬´r¬ª. <br><br>  Les gestionnaires de ces commandes ont la m√™me fonction.  Nous l'avons nomm√© comme GetExe.  Voici √† quoi √ßa ressemble: <br><br><img src="https://habrastorage.org/webt/_a/rz/lk/_arzlkrepv0wjyhlt0k4krtjtv8.png"><br><br>  Je pense que tout est clair ici.  Le cheval de Troie fait une requ√™te http et le fichier ex√©cutable est retourn√© en r√©ponse sous une forme compress√©e, qui est ensuite d√©compress√©e.  Des variations sont alors possibles.  Dans le cas de la commande ¬´b¬ª, les trois actions suivantes se produisent: <br><br>  <b>1. Cr√©ation du processus svchost sous forme fig√©e</b> <br><br><img src="https://habrastorage.org/webt/lz/yw/cy/lzywcy3d56o5tmkxdz8yu5ttvp4.png"><br><br>  <b>2. Injection dans l'espace d'adressage du processus de module t√©l√©charg√©</b> <br><br><img src="https://habrastorage.org/webt/7b/ab/fe/7babfemu0nyrag5bv6jtadst3o8.png"><br><br>  <b>3. Contr√¥le du transfert vers le module inject√©</b> <br><br><img src="https://habrastorage.org/webt/xj/m4/i5/xjm4i5ch6cpnogd79cz47tn1pny.png"><br><br>  Dans le cas de la commande r, les trois actions suivantes se produisent: <br>  1. T√©l√©chargement du fichier ex√©cutable en appelant la fonction GetExe. <br>  2. Enregistrement du fichier t√©l√©charg√© dans un dossier temporaire sous un nom al√©atoire. <br>  3. Lancez un fichier d√©pos√©. <br><br><img src="https://habrastorage.org/webt/qk/go/sj/qkgosjsrb_45ny1kkfi7cguuvbm.png"><br><br>  Termin√© <br><br>  PS La prochaine fois, nous pourrons analyser le Panda ou un crypteur.  √âcrivez dans les commentaires les logiciels malveillants qui vous int√©ressent le plus (√† des fins de recherche, bien s√ªr). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418185/">https://habr.com/ru/post/fr418185/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418169/index.html">Quoi de neuf dans Veeam Availability Console 2.0 Update 1?</a></li>
<li><a href="../fr418171/index.html">Sur quelles mesures s'appuyer si les utilisateurs effectuent peu de conversions sur le site?</a></li>
<li><a href="../fr418173/index.html">Aller-retour pour les r√©seaux de neurones, ou un examen de l'utilisation des auto-encodeurs dans l'analyse de texte</a></li>
<li><a href="../fr418177/index.html">√âdition d'images .heic sans perte de couleur</a></li>
<li><a href="../fr418183/index.html">Application de l'analyse de la parole en entreprise</a></li>
<li><a href="../fr418187/index.html">En Am√©rique, ils ont sugg√©r√© de remplacer toutes les biblioth√®ques par des hubs Amazon. Le public s'indigne</a></li>
<li><a href="../fr418189/index.html">H√©ritier de Zeus: pourquoi le cheval de Troie IcedID est dangereux pour les clients des banques</a></li>
<li><a href="../fr418191/index.html">Analogues en Python et JavaScript. Troisi√®me partie</a></li>
<li><a href="../fr418193/index.html">Comment vous sentez-vous de cr√©er un jeu pour Game Boy en 2017</a></li>
<li><a href="../fr418195/index.html">Cours MIT "S√©curit√© des syst√®mes informatiques". Conf√©rence 4: ¬´Partager les privil√®ges¬ª, partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>