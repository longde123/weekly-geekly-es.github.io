<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§ğŸ» ğŸ‡ğŸ¾ ğŸï¸ Debian 8ä¸Šçš„SAMBA classicupgradeä½“éªŒ ğŸ‘› âš”ï¸ ğŸ‘¨ğŸ»â€ğŸ“</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="èƒŒæ™¯çŸ¥è¯† 
 æœ‰ä¸€ä¸ªå°å‹çš„ä¼ä¸šå±€åŸŸç½‘ï¼Œå¤§çº¦10å¹´å‰ï¼Œåœ¨Debian 5ä¸Šå»ºç«‹äº†ç¬¬3ä¸ªSamba + LDAP + BINDï¼ˆåœ¨ç½‘å…³ä¸Šï¼‰çš„åŸŸã€‚ å®é™…ä¸Šï¼Œå¥¹åªéœ€è¦ç”¨æˆ·èº«ä»½éªŒè¯å’Œæ–‡ä»¶ç®¡ç†ã€‚ å¤šå¹´æ¥ï¼ŒæœåŠ¡å™¨å·²æ¯«æ— é—®é¢˜åœ°å‡çº§åˆ°Debiançš„æ–°ç‰ˆæœ¬ã€‚ ç›®å‰ï¼Œå®ƒå…·æœ‰æ¥è‡ªè½¯ä»¶åŒ…çš„Debian 8å’ŒSamba 4.2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Debian 8ä¸Šçš„SAMBA classicupgradeä½“éªŒ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418499/"><h2> èƒŒæ™¯çŸ¥è¯† </h2><br> æœ‰ä¸€ä¸ªå°å‹çš„ä¼ä¸šå±€åŸŸç½‘ï¼Œå¤§çº¦10å¹´å‰ï¼Œåœ¨Debian 5ä¸Šå»ºç«‹äº†ç¬¬3ä¸ªSamba + LDAP + BINDï¼ˆåœ¨ç½‘å…³ä¸Šï¼‰çš„åŸŸã€‚ å®é™…ä¸Šï¼Œå¥¹åªéœ€è¦ç”¨æˆ·èº«ä»½éªŒè¯å’Œæ–‡ä»¶ç®¡ç†ã€‚ å¤šå¹´æ¥ï¼ŒæœåŠ¡å™¨å·²æ¯«æ— é—®é¢˜åœ°å‡çº§åˆ°Debiançš„æ–°ç‰ˆæœ¬ã€‚ ç›®å‰ï¼Œå®ƒå…·æœ‰æ¥è‡ªè½¯ä»¶åŒ…çš„Debian 8å’ŒSamba 4.2ã€‚ <br><br> ä»Windows 7å¼€å§‹ï¼Œå°†è®¡ç®—æœºå¼•å…¥åŸŸï¼ˆæ²¡æœ‰ä¼—æ‰€å‘¨çŸ¥çš„å¸¦æœ‰ç¼–è¾‘æ³¨å†Œè¡¨çš„æ‹æ–ï¼‰æ— æ³•æ­£å¸¸å·¥ä½œã€‚ ç›¸åŒçš„æ‹æ–åœ¨Win 8å’ŒWin 10ä¹‹å‰çš„ç‰ˆæœ¬1803ä¸­èµ·ä½œç”¨ã€‚é™¤äº†æ— æ³•å°†è®¡ç®—æœºè¾“å…¥åŸŸä¹‹å¤–ï¼Œå…¶ä»–é—®é¢˜ä¸æ–­ç´¯ç§¯ï¼Œå› æ­¤ï¼Œå†³å®šè¿›è¡Œç»å…¸å‡çº§ã€‚ ç”±äºLANç»“æ„çš„ç®€å•æ€§ï¼Œå†³å®šä½¿ç”¨å†…éƒ¨Samba DNSã€‚ <br><br> æˆ‘æƒ³é©¬ä¸Šè¯´è¿™ç¯‡æ–‡ç« ä¸æ˜¯ç¡®åˆ‡çš„æŒ‡å—ï¼Œè€Œæ˜¯æ‰§è¡Œæ­¤æ“ä½œçš„ç»éªŒã€‚ å¼ºçƒˆå»ºè®®è¿›è¡Œé¢„æµ‹è¯•é˜¶æ®µã€‚ å°±æˆ‘è€Œè¨€ï¼ŒæœåŠ¡å™¨æ˜ åƒç”¨äºæµ‹è¯•å¹¶éƒ¨ç½²åœ¨VirtualBoxè™šæ‹Ÿæœºä¸Šï¼Œæ­¤å¤–ï¼Œä¸ºäº†æµ‹è¯•ç°æœ‰åŸŸå®¢æˆ·ç«¯çš„è¡Œä¸ºï¼Œè¿˜åˆ›å»ºäº†Win XP SP3å’ŒWin 10 1709å’Œ1803å®¢æˆ·ç«¯è®¡ç®—æœºã€‚ <br><br> æˆ‘è¿˜æƒ³æŒ‡å‡ºï¼Œåå¤çš„é”™è¯¯æ˜¯ç”±å¸¸è§çš„é”™åˆ«å­—å¼•èµ·çš„ã€‚ å°å¿ƒç‚¹ <br><a name="habracut"></a><br><h2> ç¯å¢ƒè¯´æ˜ </h2><br> æ“ä½œç³»ç»Ÿï¼šDebian 8 <br> åŸŸï¼šsamdom.local <br> æœåŠ¡å™¨åç§°ï¼špdc <br> æœåŠ¡å™¨IPï¼š10.10.1.220 <br><cut></cut><br><h2> è¿‡æ¸¡è¿‡ç¨‹ </h2><br><h4> å°†è½¯ä»¶åŒ…æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬+å®‰è£…ç¼ºå°‘çš„è½¯ä»¶åŒ…ã€‚ </h4><br> å°±æˆ‘è€Œè¨€ï¼Œæ›´æ–°åï¼Œä»…éœ€äº¤ä»˜krb5-userã€‚ <br><br><pre><code class="hljs sql">apt-get <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">upgrade</span></span> apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> samba smbclient krb5-<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> winbind</code> </pre> <br> å®‰è£…krb5-useræ—¶ï¼Œç³»ç»Ÿå°†è¯¢é—®æœ‰å…³æœåŠ¡å™¨åç§°å’ŒåŸŸåçš„å‡ ä¸ªé—®é¢˜ã€‚ æˆ‘ä»¬å¡«å†™æœåŠ¡å™¨çš„æ•°æ®ã€‚ <br><cut></cut><br><h4> æ¡‘å·´ç«™ </h4><br><pre> <code class="hljs sql">service samba-ad-dc <span class="hljs-keyword"><span class="hljs-keyword">stop</span></span> service smbd <span class="hljs-keyword"><span class="hljs-keyword">stop</span></span> service nmbd <span class="hljs-keyword"><span class="hljs-keyword">stop</span></span> service winbind <span class="hljs-keyword"><span class="hljs-keyword">stop</span></span></code> </pre> <br><h4> ä¼ è¾“æ—§åº“å’Œsambaé…ç½® </h4><br><pre> <code class="hljs swift">mv /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/samba /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/samba.<span class="hljs-type"><span class="hljs-type">NT</span></span> mv /etc/samba/smb.conf /etc/samba/smb.conf.<span class="hljs-type"><span class="hljs-type">NT</span></span></code> </pre> <br> æˆ‘å°†æ—§æ•°æ®åº“ç§»è‡³/var/lib/samba.NTï¼Œå› æ­¤æ‚¨éœ€è¦é‡æ–°åˆ›å»º/ var / lib / sambaç›®å½• <br><br><pre> <code class="hljs swift">mkdir /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/samba</code> </pre> <br> è¯¥æ–‡æ¡£å»ºè®®å°†æ‰€æœ‰æ•°æ®åº“ç§»è‡³å•ç‹¬çš„æ–‡ä»¶å¤¹ã€‚ å°±æˆ‘è€Œè¨€ï¼Œåªæœ‰gencache_notrans.tdbæ˜¯åˆ†å¼€æ”¾ç½®çš„ï¼Œå› æ­¤æˆ‘åªéœ€è¦ä¼ è¾“å®ƒã€‚ <br><br><pre> <code class="hljs swift">cp -p /run/samba/gencache_notrans.tdb /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/samba.<span class="hljs-type"><span class="hljs-type">NT</span></span></code> </pre> <br> è¯¥æ–‡æ¡£è¿˜è¯´ï¼Œä»…éœ€è¦å…­ä¸ªæ•°æ®åº“ï¼š <br><br><blockquote> ç§˜å¯†æ–‡ä»¶ <br>  schannel_store.tdb <br>  passdb.tdb <br>  gencache_notrans.tdb <br>  group_mapping.tdb <br>  account_policy.tdb </blockquote><br> ä½†æ˜¯ï¼Œæ–‡ä»¶å¤¹ä¸­å…¶ä»–æ–‡ä»¶çš„å­˜åœ¨ä¸ä¼šé˜»æ­¢è¿‡æ¸¡è¿‡ç¨‹ã€‚ <br><cut></cut><br><h4> å¼€å§‹ç»å…¸çš„å‡çº§è¿‡ç¨‹ </h4><br><pre> <code class="hljs powershell">samba<span class="hljs-literal"><span class="hljs-literal">-tool</span></span> domain classicupgrade â€”dbdir=/var/lib/samba.NT -<span class="hljs-literal"><span class="hljs-literal">-realm</span></span>=samdom.local -<span class="hljs-literal"><span class="hljs-literal">-dns</span></span><span class="hljs-literal"><span class="hljs-literal">-backend</span></span>=SAMBA_INTERNAL /etc/samba/smb.conf.NT</code> </pre> <br> æˆ‘æ³¨æ„åˆ°è¯¥æ–‡æ¡£ä¸å»ºè®®ä½¿ç”¨é¡¶çº§åŸŸlocalã€‚ï¼Œä½†å°±æˆ‘è€Œè¨€ï¼Œå®ƒæ˜¯å†å²ä¸Šå‘ç”Ÿçš„ã€‚ <br><br> åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å·¥ä½œè¡¨ä¸­ï¼Œç®¡ç†å‘˜å¯†ç å°†é—ªçƒï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦å†™ä¸‹æ¥ï¼‰ã€‚ <br><br> å¦‚æœé‡åˆ°é—®é¢˜ï¼Œåˆ™åœ¨å°è¯•è¿›è¡Œç»å…¸å‡çº§ä¹‹å‰ï¼Œå¿…é¡»è®°ä½åˆ é™¤åœ¨æ­¤è¿‡ç¨‹ä¸­åˆ›å»ºçš„æ•°æ®åº“æ–‡ä»¶å’Œsmb.confã€‚ <br><br><pre> <code class="hljs powershell">rm <span class="hljs-operator"><span class="hljs-operator">-f</span></span> /etc/samba/smb.conf rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /var/lib/samba/*</code> </pre> <br> å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œåˆ™å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥ã€‚ <br><br><h4> æ£€æŸ¥å’Œç¼–è¾‘æœåŠ¡å™¨é…ç½® </h4><br> åœ¨/etc/resolv.confä¸­åº”è¯¥æ˜¯ï¼ˆå¦‚æœä¸æ˜¯ä¸ºæ‚¨è‡ªåŠ¨åˆ›å»ºçš„ï¼‰ <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">domain</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">samdom</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.local</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nameserver</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.220</span></span></code> </pre> <br> åœ¨/ etc /ä¸»æœºä¸­ <br><br><pre> <code class="hljs css">127<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">localhost</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">localhost</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.localdomain</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.220</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pdc</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.samdom</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.local</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pdc</span></span></code> </pre> <br>  / etc / hostnameæ–‡ä»¶å¿…é¡»å…·æœ‰ç¼©å†™çš„ä¸»æœºå <br><br><pre> <code class="hljs">pdc</code> </pre> <br> åœ¨/ etc / network / interfasesä¸­ <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">dns-nameservers</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.10</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.220</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dns-search</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">samdom</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.local</span></span></code> </pre> <br><h4> é‡å®šå‘DNSè¯·æ±‚ </h4><br> å¦‚æœæ‚¨çš„æœåŠ¡å™¨å°†DNSæŸ¥è¯¢é‡å®šå‘åˆ°Internetï¼ˆå¹¶ä¸”ä½¿ç”¨INTERNAL_DNS Sambaï¼‰ï¼Œåˆ™éœ€è¦åœ¨smb.confçš„[global]éƒ¨åˆ†ä¸­ï¼Œä»ISP ipæ·»åŠ ä¸€è¡Œï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">dns</span></span> forwarder = ip</code> </pre> <br> åœ¨â€œ Sambaâ€ 4.2ä¸­ï¼Œåªèƒ½æŒ‡å®šä¸€ä¸ªIPã€‚ åœ¨ä¸‹é¢-ä¸€äº›ï¼Œå¸¦ç©ºæ ¼ã€‚ <br> å¦‚æœæ‚¨çš„ç½‘å…³æ§åˆ¶ä¼ å‡ºæµé‡ï¼Œåˆ™ä¸è¦å¿˜è®°æ‰“å¼€ä»æœåŠ¡å™¨åˆ°ç«¯å£53çš„udpæ•°æ®åŒ…é€šé“ã€‚ <br><br><h4> é…ç½®Kerberos </h4><br> æˆ‘ä»¬å°†/etc/krb5.confå¸¦åˆ°ç±»ä¼¼å½¢å¼ï¼š <br><br><pre> <code class="hljs pgsql">[libdefaults] default_realm = SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span> dns_lookup_realm = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> dns_lookup_kdc = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> krb4_config = /etc/krb.conf krb4_realms = /etc/krb.realms kdc_timesync = <span class="hljs-number"><span class="hljs-number">1</span></span> ccache_type = <span class="hljs-number"><span class="hljs-number">4</span></span> forwardable = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> proxiable = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> v4_instance_resolve = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> v4_name_convert = { host = { rcmd = host ftp = ftp } plain = { something = something-<span class="hljs-keyword"><span class="hljs-keyword">else</span></span> } } fcc-mit-ticketflags = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> [realms] SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span> = { kdc = pdc admin_server = pdc default_domain = SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span> } [domain_realm] .samdom.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> = SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span> samdom.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> = SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span></code> </pre> <br><h4> æ—¶é—´åŒæ­¥ </h4><br> å¦‚æœntpè½¯ä»¶åŒ…ä¸å€¼å¾—ï¼Œè¯·è®¾ç½®ï¼š <br><br><pre> <code class="hljs swift">apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install ntp</code> </pre> <br> åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰ç›®å½•/ var / lib / samba / ntp_signd /ã€‚ æ‰‹åŠ¨åˆ›å»ºã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦æˆäºˆä»–æƒåˆ©ï¼š <br><br><pre> <code class="hljs swift">chown root:ntp /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/samba/ntp_signd/ chmod <span class="hljs-number"><span class="hljs-number">750</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/samba/ntp_signd/</code> </pre> <br> æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦å°†/etc/ntp.confæ–‡ä»¶è½¬æ¢ä¸ºç±»ä¼¼å½¢å¼ï¼š <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Local</span></span> clock (Note: This <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the localhost address!) <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-number"><span class="hljs-number">127.127</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> fudge <span class="hljs-number"><span class="hljs-number">127.127</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> stratum <span class="hljs-number"><span class="hljs-number">10</span></span> # The source, <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> we are receiving the <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>pool.ntp.org iburst prefer driftfile /var/lib/ntp/ntp.drift logfile /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/ntp ntpsigndsocket /var/lib/samba/ntp_signd/ # <span class="hljs-keyword"><span class="hljs-keyword">Access</span></span> control # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> restriction: <span class="hljs-keyword"><span class="hljs-keyword">Only</span></span> allow querying <span class="hljs-type"><span class="hljs-type">time</span></span> (incl. ms-sntp) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> this machine <span class="hljs-keyword"><span class="hljs-keyword">restrict</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> kod nomodify notrap nopeer mssntp # Allow everything <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> localhost <span class="hljs-keyword"><span class="hljs-keyword">restrict</span></span> <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> # Allow that our <span class="hljs-type"><span class="hljs-type">time</span></span> source can <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> provide <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">restrict</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>pool.ntp.org mask <span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span> nomodify notrap nopeer noquery</code> </pre> <br><h4> å¸ä¸‹æ‹æ‰“å¹¶é‡æ–°å¯åŠ¨ </h4><br><pre> <code class="hljs cs">apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">remove</span></span> slapd reboot</code> </pre> <br><h4> æµ‹è¯•ä¸­ </h4><br> åœ¨æ–‡æ¡£ä¸­ï¼Œæµ‹è¯•æ˜¯é€šè¿‡ç®¡ç†å‘˜å¸æˆ·å®Œæˆçš„ã€‚ ä»å†å²ä¸Šçœ‹ï¼Œæˆ‘ä»¬å·²ç»å¼€å‘å‡ºç®¡ç†æ“ä½œæ¥è‡ªdomain_adminã€‚ æ¥ä¸‹æ¥ï¼Œå°†æ˜¾ç¤ºå‘½ä»¤åŠå…¶æ­£ç¡®çš„è¾“å‡ºã€‚ <br><br>  <b>æµ‹è¯•æ¡‘å·´èˆï¼š</b> <br><br><pre> <code class="hljs pgsql">root@debian:/root# smbclient -L localhost -U% <span class="hljs-keyword"><span class="hljs-keyword">Domain</span></span>=[SAMDOM] OS=[Unix] <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>=[Samba <span class="hljs-number"><span class="hljs-number">4.1</span></span><span class="hljs-number"><span class="hljs-number">.17</span></span>-Debian] Sharename <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span> <span class="hljs-comment"><span class="hljs-comment">--------- ---- ------- netlogon Disk sysvol Disk IPC$ IPC IPC Service (Samba 4.1.17-Debian) Domain=[SAMDOM] OS=[Unix] Server=[Samba 4.1.17-Debian] Server Comment --------- ------- Workgroup Master --------- -------</span></span></code> </pre> <br> å¦‚æœæ‚¨åœ¨è¿™é‡Œé‡åˆ°é”™è¯¯ï¼š <br><blockquote> ä¸loclhostçš„è¿æ¥å¤±è´¥ï¼ˆé”™è¯¯NT_STATUS_UNSUCCESSFULï¼‰ </blockquote><br> æ£€æŸ¥sambaæ˜¯å¦å¯åŠ¨ã€‚ åœ¨ä¸€ä¸ªæµ‹è¯•ä¸­ï¼Œæˆ‘å¿˜è®°å»é™¤ï¼ˆå…³é—­ï¼‰æ‹æ‰“ï¼Œå¹¶ä¸”ä¹Ÿçœ‹åˆ°äº†æ­¤é”™è¯¯ã€‚ <br><br> å†æ£€æŸ¥ä¸€æ¬¡ï¼š <br><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> smbclient //localhost/netlogon <span class="hljs-literal"><span class="hljs-literal">-Udomain_admin</span></span> <span class="hljs-literal"><span class="hljs-literal">-c</span></span> <span class="hljs-string"><span class="hljs-string">'ls'</span></span> Enter Administrator<span class="hljs-string"><span class="hljs-string">'s password: Domain=[SAMDOM] OS=[Unix] Server=[Samba xyz] . D 0 Tue Nov 1 08:40:00 2016 .. D 0 Tue Nov 1 08:40:00 2016 49386 blocks of size 524288. 42093 blocks available</span></span></code> </pre> <br>  <b>æµ‹è¯•DNS</b> <br><br><pre> <code class="hljs pgsql">root@debian:/root# nslookup samdom.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>: <span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.220</span></span> Address: <span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.220</span></span>#<span class="hljs-number"><span class="hljs-number">53</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>: samdom.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> Address: <span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.220</span></span></code> </pre> <br><pre> <code class="hljs pgsql">$ host -t SRV _ldap._tcp.samdom.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>. _ldap._tcp.samdom.example.com has SRV <span class="hljs-type"><span class="hljs-type">record</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">389</span></span> pdc.samdom.example.com.</code> </pre> <br><pre> <code class="hljs pgsql">$ host -t SRV _kerberos._udp.samdom.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>. _kerberos._udp.samdom.example.com has SRV <span class="hljs-type"><span class="hljs-type">record</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">88</span></span> pdc.samdom.example.com.</code> </pre> <br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> host <span class="hljs-literal"><span class="hljs-literal">-t</span></span> A pdc.samdom.local. dc1.samdom.example.com has address <span class="hljs-number"><span class="hljs-number">10.10</span></span>.<span class="hljs-number"><span class="hljs-number">1.220</span></span></code> </pre> <br>  <b>æµ‹è¯•Kerberos</b> <br><br><pre> <code class="hljs pgsql">root@debian:/root# kinit domain_admin@SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> domain_admin@SAMDOM.<span class="hljs-keyword"><span class="hljs-keyword">LOCAL</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Warning</span></span>: Your <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> will expire <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">41</span></span> days <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>  <span class="hljs-number"><span class="hljs-number">27</span></span>  <span class="hljs-number"><span class="hljs-number">2015</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">46</span></span></code> </pre><br><pre> <code class="hljs ruby">root@debian<span class="hljs-symbol"><span class="hljs-symbol">:/root</span></span><span class="hljs-comment"><span class="hljs-comment"># klist Ticket cache: FILE:/tmp/krb5cc_0 Default principal: domain_admin</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@SAMDOM</span></span></span><span class="hljs-comment">.LOCAL Valid starting Expires Service principal 16.10.2015 15:07:12 17.10.2015 01:07:12 krbtgt/SAMDOM.LOCAL</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@SAMDOM</span></span></span><span class="hljs-comment">.LOCAL renew until 17.10.2015 15:07:07</span></span></code> </pre> <br><h2> é™„åŠ è®¾ç½® </h2><br>  <b>ä¸ºäº†ä½¿åŸŸåå’Œç»„å‡ºç°åœ¨Linuxä¸Šï¼Œæ‚¨éœ€è¦ä¿®å¤/etc/nsswitch.confè€Œä¸æ˜¯æ•°å­—</b> <br><br> å­—ç¬¦ä¸²åº”ç®€åŒ–ä¸ºä»¥ä¸‹å½¢å¼ï¼š <br><blockquote>  passwdï¼šæ–‡ä»¶<u>winbind</u> <br> ç»„ï¼šæ–‡ä»¶<u>winbind</u> </blockquote><br> è¯·æ³¨æ„ï¼Œwinbindä»…æ·»åŠ åˆ°è¿™äº›è¡Œã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ–‡æ¡£ã€‚ <br> å°±æˆ‘è€Œè¨€ï¼Œæˆ‘è¿˜ä»è¯¥æ–‡ä»¶ä¸­åˆ é™¤äº†ldapçš„æåŠã€‚ <br><br><pre> <code class="hljs">reboot</code> </pre> <br>  <b>å¦‚æœåƒæˆ‘ä¸€æ ·ï¼Œå¦‚æœåœ¨classicupgrade dnsä¹‹å‰ï¼Œè¯¥æœåŠ¡å™¨ä½äºå¦ä¸€å°è®¡ç®—æœºä¸Šï¼Œå¹¶ä¸”æ‚¨æ­£åœ¨ä½¿ç”¨DHCPæœåŠ¡å™¨ï¼Œè¯·ä¸è¦å¿˜è®°æ›´æ”¹æŒ‡å‘DNSæœåŠ¡å™¨çš„DHCPæœåŠ¡å™¨è®¾ç½®ã€‚</b> <br><br><h4> é…ç½®ç½‘ç»œæ–‡ä»¶å¤¹ </h4><br> ä¸å»ºè®®å¼€å‘äººå‘˜å°†ADåŸŸæ§åˆ¶å™¨ç”¨ä½œæ–‡ä»¶æœåŠ¡å™¨ã€‚ ä½†æ˜¯ï¼Œå°±æˆ‘è€Œè¨€ï¼Œæ²¡æœ‰å…¶ä»–æœåŠ¡å™¨ã€‚ <br><br> è¯¥è®¾ç½®åœ¨â€œ Sambaâ€çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>æœ‰å¾ˆå¥½çš„æè¿°ï¼Œæ‚¨éœ€è¦æŸ¥çœ‹ä¸€ä¸‹ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œåˆ™ï¼š <br><br>  <b>æœ‰å¿…è¦æ£€æŸ¥ACLæ”¯æŒsambaã€‚</b> <br><br><pre> <code class="hljs perl">smbd -b | <span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> HAVE_LIBACL HAVE_LIBACL</code> </pre> <br>  <b>ä¸è¦å¿˜è®°è¯¥éƒ¨åˆ†å¿…é¡»ä½¿ç”¨user_xattrå’Œaclé€‰é¡¹æŒ‚è½½ã€‚</b> <br><br>  <b>åªæœ‰å…·æœ‰SeDiskOperatorPrivilegeçš„ç”¨æˆ·å’Œç»„æ‰èƒ½é…ç½®å¯¹çƒçš„æƒé™ï¼š</b> <br><br> ä¾‹å¦‚ï¼Œè¦å°†æ­¤ç±»æƒé™æˆäºˆDomain Adminsç»„ï¼Œæ‚¨éœ€è¦è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š <br><pre> <code class="hljs pgsql">net rpc rights <span class="hljs-keyword"><span class="hljs-keyword">grant</span></span> "Samdom\Domain Admins" SeDiskOperatorPrivilege -U "Samdom\domain_admin"</code> </pre> <br>  <b>ç›´æ¥æ·»åŠ çƒæ‚¨éœ€è¦ï¼š</b> <br><br> åˆ›å»ºç›®å½•å¹¶åˆ†é…å¿…è¦çš„æƒé™ï¼š <br><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta"># mkdir -p /srv/samba/Demo/ # chown root:</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Domain Admins"</span></span></span><span class="hljs-meta"> /srv/samba/Demo/ # chmod 0770 /srv/samba/Demo/</span></span></code> </pre> <br> æ·»åŠ åˆ°smb.conf <br><br><pre> <code class="hljs pgsql">[Demo] <span class="hljs-type"><span class="hljs-type">path</span></span> = /srv/samba/Demo/ <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">no</span></span></code> </pre> <br> ä¹‹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é‡æ–°åŠ è½½sambaé…ç½®ï¼š <br><br><pre> <code class="hljs pgsql">smbcontrol <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> reload-config</code> </pre> <br> å’Œä»¥å‰ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡åœ¨çƒçš„æè¿°ä¸­æ·»åŠ éšè—çƒï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">browseable</span></span> = <span class="hljs-literal"><span class="hljs-literal">no</span></span></code> </pre> <br> æ¥ä¸‹æ¥ï¼Œä»è®¡ç®—æœºçš„çª—å£ï¼Œä»å…·æœ‰<u>SeDiskOperatorPrivilege</u>çš„å¸æˆ·<u>åˆ†é…æƒé™</u> ã€‚ ä¸ºæ­¤ï¼Œè¯·è½¬åˆ°â€œè®¡ç®—æœºç®¡ç†â€ã€‚ <br> ç»‘å®šåˆ°è¿œç¨‹è®¡ç®—æœºï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºpdcåŸŸæ§åˆ¶å™¨ï¼‰ã€‚ é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ†é…æƒé™ï¼šâ€œå…±äº«æ–‡ä»¶å¤¹â€-&gt;â€œå…±äº«èµ„æºâ€ã€‚ <br><br> å½“æ‚¨è½¬åˆ°â€œå…±äº«æ–‡ä»¶å¤¹â€é¡¹æ—¶ï¼Œå¯èƒ½ä¼šæ”¶åˆ°é”™è¯¯æ¶ˆæ¯â€œè¿‡ç¨‹å·è¶…å‡ºå…è®¸çš„é™åˆ¶ï¼ˆ1745ï¼‰â€ã€‚ æˆ‘æ— è§†å®ƒï¼Œå› ä¸ºæˆ‘åœ¨Internetä¸Šæ‰¾ä¸åˆ°ä»»ä½•å¯ç†è§£çš„å†…å®¹ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•å’Œæ“ä½œè¿‡ç¨‹ä¸­ä¹Ÿä¸ä¼šå¼•èµ·é—®é¢˜ã€‚ <br><br> å¦‚æœæ‚¨ä»¥è¿™ç§æ–¹å¼å…±äº«æ—§çš„ç½‘ç»œæ–‡ä»¶å¤¹ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚ åœ¨classicupgradeä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡smb.confï¼Œlinuxç”¨æˆ·ï¼Œgroupï¼Œotherå’Œsetfaclæ¥è®¾ç½®Ballçš„æƒé™ã€‚ ç»è¿‡ç»å…¸å‡çº§åï¼Œæ‹¥æœ‰å˜æ›´ï¼Œæ›´åç­‰æƒåˆ©çš„å­¦æ ¡å¼€å§‹é€æ¸å‡ºç°ã€‚ é€’å½’setfaclå¹¶æ²¡æœ‰å¸®åŠ©ï¼Œå› ä¸ºå‡ºç°äº†å¸¦æœ‰æƒåˆ©ç»§æ‰¿çš„é—¨æ¡†ã€‚ <br><br> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ–‡æ¡£ä¸­ï¼Œå»ºè®®é€šè¿‡è¿œç¨‹è®¿é—®ä»è®¡ç®—æœºçš„çª—å£ä¸­åˆ†é…æƒé™ã€‚ <br><br> ç»“æœï¼Œç”±äºæ–‡ä»¶é‡ä¸æ˜¯å¾ˆå¤§ï¼Œå› æ­¤å†³å®šåœ¨éå·¥ä½œæ—¶é—´å°†æ•°æ®ä¼ è¾“åˆ°Windowsè®¡ç®—æœºï¼Œæ ¹æ®sambaå¼€å‘äººå‘˜çš„å»ºè®®é‡æ–°åˆ›å»ºç½‘ç»œæ–‡ä»¶å¤¹å¹¶é‡æ–°ä¸Šä¼ æ–‡ä»¶ã€‚ <br><br><h4> æœåŠ¡å™¨ä¸Šçš„ç”¨æˆ·ä¸»æ–‡ä»¶å¤¹ </h4><br> ç”¨æˆ·ä¸»æ–‡ä»¶å¤¹çš„ç®¡ç†ä¹Ÿå·²æ›´æ”¹ã€‚ <br> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æ¡£ä¸­</a>è¿˜å¯¹é…ç½®è¿‡ç¨‹è¿›è¡Œäº†å¾ˆå¥½çš„æè¿°ã€‚ <br> æˆ‘å°†ä»…æè¿°æˆ‘çš„æ¡ˆä¾‹çš„å…³é”®åŠŸèƒ½ã€‚ <br><br> ä»¥å‰ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„çƒã€‚ ç°åœ¨ï¼Œä»…å…±äº«æ–‡ä»¶å¤¹è¢«å…±äº«ï¼Œå¹¶ä¸”ç”¨æˆ·åªèƒ½è®¿é—®å…¶ç›®å½•ã€‚ <br><br> ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Microsoftè¿œç¨‹æœåŠ¡å™¨ç®¡ç†å·¥â€‹â€‹å…·ï¼ˆRSATï¼‰è¿›è¡Œå®‰è£…</a> ã€‚  RSATå…·æœ‰ä»¤äººä¸å¿«çš„åŠŸèƒ½ã€‚ å°†Win 10å‡çº§åˆ°æ–°ç‰ˆæœ¬æ—¶ï¼Œå¿…é¡»é‡æ–°å®‰è£…ã€‚ <br><br> å¯ä»¥é€šè¿‡â€œç”¨æˆ·å’Œè®¡ç®—æœºâ€ç®¡ç†å•å…ƒä¸­çš„ç”¨æˆ·å±æ€§æ‰‹åŠ¨æ‹¾å–ä¸»çƒã€‚ ä¸ªäººèµ„æ–™æ ‡ç­¾ã€‚  Uç›˜ï¼š\\ pdc \ç”¨æˆ·å…±äº«\ç”¨æˆ·å <br><br> ä½†æ˜¯ï¼Œé€šè¿‡åŸŸç­–ç•¥æ‰§è¡Œæ­¤æ“ä½œæ›´ä¸ºæ–¹ä¾¿ï¼Œä»¥ä¸Šæ–‡æ¡£åœ¨<b>â€œä½¿ç”¨ç»„ç­–ç•¥é¦–é€‰é¡¹â€</b>æ®µè½ä¸­å¯¹æ­¤è¿›è¡Œäº†éå¸¸æ¸…æ¥šçš„æè¿°ã€‚ <br><br> ä¸è¦å¿˜è®°å¯ä»¥é€šè¿‡æ·»åŠ å¯¹é€šç”¨çƒçš„æè¿°æ¥éšè—å®ƒï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">browseable</span></span> = <span class="hljs-literal"><span class="hljs-literal">no</span></span></code> </pre> <br><h4> åŸŸå‡çº§ </h4><br> ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†åŸŸæ¯«æ— é—®é¢˜åœ°å‡çº§åˆ°2008_R2çº§åˆ«ï¼š <br><br><pre> <code class="hljs pgsql">samba-tool <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-comment"><span class="hljs-comment">--domain=2008_R2 --forest=2008_R2</span></span></code> </pre> <br> æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹çº§åˆ«ï¼š <br><br><pre> <code class="hljs pgsql">samba-tool <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> <span class="hljs-keyword"><span class="hljs-keyword">show</span></span></code> </pre> <br><h4> å¦‚æœsmbd.logè¢«CUPSé”™è¯¯è½°ç‚¸ </h4><br> å°±æˆ‘è€Œè¨€ï¼Œè¿™ä¸ªé—®é¢˜å‡ºç°äº†ï¼š <br><br><blockquote> æ— æ³•è¿æ¥åˆ°CUPSæœåŠ¡å™¨æœ¬åœ°ä¸»æœºï¼š631 </blockquote><br> å·²<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”±æ­¤</a>ç®€çŸ­æ–‡ç« æ›´æ­£ã€‚ <br><br><h2> éšåå‡çº§åˆ°Debian 9é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ </h2><br> åœ¨ <br><br><pre> <code class="hljs powershell">apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> dist<span class="hljs-literal"><span class="hljs-literal">-upgrade</span></span></code> </pre> <br> å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³sambaå’Œwinbindä¸æƒ³æ›´æ–°ã€‚ é™·å…¥äº†ä¾èµ–å†²çªã€‚ <br><br> ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç¯‡æ–‡ç« ä¸­çš„æ–¹æ³•å¸®åŠ©äº†æˆ‘æ²¡æœ‰ä¿å­˜çš„é“¾æ¥ã€‚ <br> è¿™æ˜¯å®ƒçš„ç›´æ¥å¼•æ–‡ï¼š <br><br><blockquote> å¦‚æœSambaå¤„äºAD-DCæ¨¡å¼ï¼Œåˆ™å®ƒå’Œwinbindå¤±è´¥ã€‚ <br> æ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œç„¶åå°è¯•å†æ¬¡è¿è¡Œå‡çº§ <br><br>  systemctlåœæ­¢smbd nmbd winbind <br>  systemctlç¦ç”¨smbd nmbd winbind <br>  systemctlå–æ¶ˆå±è”½samba-ad-dc <br>  systemctlå¯åŠ¨samba-ad-dc <br>  systemctlå¯ç”¨samba-ad-dc <br></blockquote><br><br><h4> æ›´æ–°SAMBAç‰ˆæœ¬åï¼Œå»ºè®®ï¼šâ€œ Samba AD DCæ•°æ®åº“æ£€æŸ¥â€ã€‚ </h4><br><br> <code># samba-tool dbcheck --cross-ncs</code> <br> <br> è‡ªä»Deb 9 SAMBA 4.5ç‰ˆä»¥æ¥ï¼Œæˆ‘é‡åˆ°äº†ä¸€å †é”™è¯¯â€œ replPropertyMetaDataâ€ã€‚ <br> æ–‡æ¡£ä¸­ä»‹ç»äº†æ•…éšœæ’é™¤è¿‡ç¨‹ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wiki.samba.org/index.php/Updating_Samba#Fixing_replPropertyMetaData_Attributes</a> <br><br> å®ƒå½’ç»“ä¸ºå‘½ä»¤çš„æ‰§è¡Œï¼š <br><br> <code>samba-tool dbcheck --cross-ncs --fix --yes</code> <br> <br><h2> ä½¿ç”¨çš„æ¥æºæ¸…å• </h2><br>  SAMBAæ–‡æ¡£ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†Samba NT4åŸŸè¿ç§»åˆ°Samba ADï¼ˆç»å…¸å‡çº§ï¼‰</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†Sambaè®¾ç½®ä¸ºActive DirectoryåŸŸæ§åˆ¶å™¨</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨Windows ACLè®¾ç½®å…±äº«</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”¨æˆ·ä¸»æ–‡ä»¶å¤¹</a> <br> å¾ˆæ£’çš„æ–‡ç« ï¼š <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Debian 8åŸŸæ§åˆ¶å™¨ï¼ˆ...å·²ç»å…·æœ‰å†…ç½®çš„Samba4ï¼‰</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sambaé”™è¯¯ï¼šæ— æ³•è¿æ¥åˆ°CUPSæœåŠ¡å™¨æœ¬åœ°ä¸»æœºï¼š631</a> <br> ä¸€ä½ä¸çŸ¥åçš„è‹±è¯­ä½œè€…çš„ä¸€ç¯‡æ–‡ç« ï¼Œæè¿°äº†å¦‚ä½•å‡çº§åˆ°Debian 9 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN418499/">https://habr.com/ru/post/zh-CN418499/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN418487/index.html">å…³äºåœ¨å¾·å›½å·¥ä½œ</a></li>
<li><a href="../zh-CN418489/index.html">ä¸–ç•Œä¸“æ å»ºè®¾çš„æ°ä½œï¼šä¸‰å‘æ ‡å‡†çš„å‘å±•ï¼ŒJBLçš„å·¥ä½œå®¤å´‡æ‹œ</a></li>
<li><a href="../zh-CN418491/index.html">æµ‹è¯•è‡ªåŠ¨åŒ–ç”µé˜»</a></li>
<li><a href="../zh-CN418493/index.html">è“ç‰™åŠŸèƒ½ ç¬¬ä¸€äººç§°æ•…äº‹</a></li>
<li><a href="../zh-CN418497/index.html">â€œæˆ‘åœ¨å¦†å®¹ä¸Šä¸è®¤å¾—ä½ â€ï¼ˆcï¼‰</a></li>
<li><a href="../zh-CN418501/index.html">GDPRçš„å—å®³è€…ï¼šç”±äºæ–°çš„ä¸ªäººæ•°æ®è§„å®šè€Œå·²ç»åœæ­¢å·¥ä½œçš„äºº</a></li>
<li><a href="../zh-CN418503/index.html">2020å¹´åï¼Œè‹±å›½å°†è·å¾—ç¬¬ä¸€ä¸ªå¤ªç©ºæ¸¯-è‹æ ¼å…°</a></li>
<li><a href="../zh-CN418505/index.html">é—¨çº§é‡å­è½¯ä»¶å¹³å°çš„æ¦‚è¿°å’Œæ¯”è¾ƒ</a></li>
<li><a href="../zh-CN418507/index.html">å®‡å®™èˆªè¡Œç»™äº†æˆ‘ä»¬ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN418509/index.html">äºšé©¬é€Šæ‰¿è®¤æ‰¿è®¤28åç¾å›½å›½ä¼šè®®å‘˜ä¸ºç½ªçŠ¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>