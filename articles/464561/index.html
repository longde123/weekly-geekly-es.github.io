<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游띏游 游돖游낕 驕덢잺 Escribir aplicaciones iOS usando el patr칩n Redux 游뛊游 游돜游낕 游끧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recientemente, he estado m치s involucrado en el desarrollo front-end que en los dispositivos m칩viles, y me encontr칠 con algunos patrones de dise침o muy ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Escribir aplicaciones iOS usando el patr칩n Redux</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464561/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ul/g0/st/ulg0stea_xpvsornkcz8xjqt4_u.png" alt="imagen"></div><br>  Recientemente, he estado m치s involucrado en el desarrollo front-end que en los dispositivos m칩viles, y me encontr칠 con algunos patrones de dise침o muy interesantes que ya conoc칤a, pero que realmente no profundic칠 en ellos ... hasta ahora. <br><br>  Pero ahora todo esto tiene sentido, despu칠s de usar desde el desarrollo en React durante varias semanas, ahora no puedo volver a mis viejas formas de desarrollo para iOS.  No cambiar칠 a javascript (AKA React Native) para desarrollar aplicaciones m칩viles, pero aqu칤 hay algunas cosas que aprend칤. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rg/80/3y/rg803yazpnqjrd519umwebzi8li.png" alt="imagen"></div><br>  Volviendo al desarrollo de iOS, cre칠 un nuevo proyecto y comenc칠 a explorar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ReSwift</a> , esta es una implementaci칩n del patr칩n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Flux</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Redux</a> en Swift.  Y funciona de manera bastante simple, clon칠 la arquitectura de la aplicaci칩n JavaScript varias veces, ahora tengo un estado global y mis controladores solo escuchan este estado.  Los controladores mismos est치n formados por varios componentes de presentaci칩n que encapsulan un comportamiento muy espec칤fico. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/fk/m2/kp/fkm2kpcfjdmus82_7dvgjcoagjm.png" alt="imagen"><br><br>  Todos <b>los</b> cambios de <b>estado</b> se realizan en un solo lugar, en <b>reductor</b> .  Uno para el subestado.  Puedes ver todas las <b>acciones</b> en un solo lugar.  No m치s c칩digo de red o controladores de llamada, no m치s mutaciones de objetos en las vistas.  No m치s c칩digo de espagueti.  Solo hay un <b>estado</b> , y es cierto, sus diversos componentes de presentaci칩n (e insisto en ello) se suscriben a diferentes partes del <b>estado</b> y reaccionan en consecuencia.  Esta es simplemente la mejor arquitectura para una aplicaci칩n de modelo fuerte. <br><br>  Por un ejemplo.  Anteriormente, los controladores de vista de inicio de sesi칩n estaban llenos de muchas l칤neas de c칩digo, varios estados de control, manejo de errores, etc. Ahora se ve as칤: (Como ejemplo) <br><br><pre><code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Base <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReSwift class LoginViewController: UIViewController { @IBOutlet var usernameField: UITextField! @IBOutlet var passwordField: UITextField! override func viewDidLoad() { super.viewDidLoad() store.subscribe(self) {state in state.usersState } } @IBAction func onLoginButton(_ sender: Any) { store.dispatch(AuthenticatePassword(username: usernameField.text!, password: passwordField.text!)) } @IBAction func onTwitterButton(_ sender: Any) { store.dispatch(AuthenticateTwitter()) } @IBAction func onFacebookButton(_ sender: Any) { store.dispatch(AuthenticateFacebook(from: self)) } } <span class="hljs-comment"><span class="hljs-comment">// MARK: - State management extension LoginViewController: StoreSubscriber { func newState(state: UsersState) { if let error = state.authState.error { presentError(error: error.type, viewController: self, completion: nil) } if let _ = state.getCurrentUser { self.dismiss(animated: true, completion: nil) } } }</span></span></code> </pre> <br>  Controladores y representaciones de acciones de <b>despacho</b> en el estado global, estas acciones realmente funcionan con la red o lanzan las diversas partes que su aplicaci칩n necesitar치 convertir al nuevo estado. <br><br>  <b>Una acci칩n</b> puede desencadenar otra acci칩n, as칤 es como sucede para una solicitud de red, por ejemplo, tiene una acci칩n <i>FetchUser (id: String)</i> y una acci칩n que intercepta en un reductor que se parece a SetUser (usuario: Usuario).  En reductor, usted es responsable de fusionar / fusionar un nuevo objeto con su estado actual. <br><br>  Primero necesita <b>estado</b> , mi ejemplo se centrar치 en el objeto <i>Usuario</i> , por lo que el <b>estado</b> podr칤a verse as칤: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersState</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> users: [<span class="hljs-type"><span class="hljs-type">String</span></span>: <span class="hljs-type"><span class="hljs-type">User</span></span>] = [:] }</code> </pre><br>  Debe tener un archivo que encapsule todas las actividades de red para el objeto de usuario. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FetchUser</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(user: <span class="hljs-type"><span class="hljs-type">String</span></span>) { <span class="hljs-type"><span class="hljs-type">GETRequest</span></span>(path: <span class="hljs-string"><span class="hljs-string">"users/\(user)"</span></span>).run { (response: <span class="hljs-type"><span class="hljs-type">APIResponse</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UserJSON</span></span>&gt;) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> store.dispatch(<span class="hljs-type"><span class="hljs-type">SetUser</span></span>(user: response.object)) } } }</code> </pre><br>  Tan pronto como se completa la solicitud, se llama a otra <b>acci칩n</b> , esta acci칩n est치 realmente vac칤a, debe mencionarse, por ejemplo, en UsersActions.  Esta acci칩n describe el resultado en el que el reductor debe confiar para cambiar de estado. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SetUser</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user: <span class="hljs-type"><span class="hljs-type">UserJSON?</span></span> }</code> </pre><br>  Y, por 칰ltimo, el trabajo m치s importante se realiza en <b>UsersReducer</b> , debe tomar la acci칩n y hacer un trabajo de acuerdo con su contenido: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">usersReducer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(state: UsersState?, action: Action)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UsersState</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state = state ?? initialUsersState() <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> action { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">SetUser</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = action.user { state.users[user.id] = <span class="hljs-type"><span class="hljs-type">User</span></span>(json: user) } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state }</code> </pre><br>  Ahora todo lo que se necesita es <b>suscribirse / suscribirse</b> al estado en controladores o vistas, y cuando cambie, extraer la informaci칩n necesaria y obtener nuevos valores. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userId: <span class="hljs-type"><span class="hljs-type">String?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">didSet</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id = userId { store.dispatch(<span class="hljs-type"><span class="hljs-type">FetchUser</span></span>(user: id)) } } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user: <span class="hljs-type"><span class="hljs-type">User?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">didSet</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = user { setupViewUser(user: user) } } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() store.subscribe(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {state <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> state.usersState } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupViewUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user: User)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//Do uour UI stuff. } } extension UserViewController: StoreSubscriber { func newState(state: UsersState) { self.user = state.users[userId!] } }</span></span></code> </pre><br>  Pero ahora deber칤a echar un vistazo a los ejemplos de <i>ReSwift</i> para una comprensi칩n m치s profunda, planeo publicar una aplicaci칩n de c칩digo abierto (en realidad un juego) usando este patr칩n de dise침o.  Pero por ahora, el c칩digo muestra una idea muy cruda de c칩mo funciona todo esto en conjunto. <br><br>  Esta es todav칤a una arquitectura muy temprana en los libros de Glose, pero no podemos esperar a que la aplicaci칩n se ponga en producci칩n usando esta arquitectura. <br><br>  Siento que desarrollar aplicaciones que usen este patr칩n ahorrar치 mucho tiempo y esfuerzo.  Tomar치 un poco m치s de trabajo que un <i>cliente REST</i> est칰pidamente simple, porque habr치 un poco m치s de l칩gica dentro del estado del cliente, pero al final le ahorrar치 un tiempo invaluable para la depuraci칩n.  Podr치 modificar muchos elementos localmente y ya no habr치 cambios en cascada entre los controladores y las vistas.  Reproduzca el estado en orden de copia de seguridad, arch칤velo, cree middleware, etc. El flujo de datos de la aplicaci칩n es claro, centralizado y simple. <br><br>  El patr칩n <b>Redux</b> agrega un poco de estructura a la aplicaci칩n.  He estado haciendo MVC puro durante mucho tiempo, estoy seguro de que puedes crear una base de c칩digo limpia, pero tiendes a desarrollar h치bitos que a menudo hacen m치s da침o que bien.  Incluso puede dar un paso m치s e implementar completamente Redux controlando su interfaz de usuario (como controladores de vista, visores de alertas, controladores de enrutamiento) en un estado separado, pero a칰n no he logrado todo esto). <br><br>  Y pruebas ... Las pruebas unitarias ahora son f치ciles de implementar, porque todo lo que necesita probar es comparar los datos que ingresa con los datos contenidos en el estado global, para que las pruebas puedan enviar acciones simuladas, y luego verificar si el estado coincide con lo que usted querer <br><br>  En serio, este es el futuro.  El futuro es para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Redux</a> :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/464561/">https://habr.com/ru/post/464561/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../464551/index.html">쮺u치les son las mejores soluciones de comercio electr칩nico para pymes ...?</a></li>
<li><a href="../464553/index.html">Una manera f치cil de ganar dinero con Bug Bounty</a></li>
<li><a href="../464555/index.html">Manera f치cil de ganar dinero en Bug Bounty</a></li>
<li><a href="../464557/index.html">XD Design Bobby Pro: la nueva versi칩n que hemos estado esperando</a></li>
<li><a href="../464559/index.html">Caracter칤sticas del transporte Universiada y un Alex muy entusiasta</a></li>
<li><a href="../464563/index.html">Seguridad de la informaci칩n: 쯤u칠 necesita saber y poder ser considerado un buen especialista en seguridad de la informaci칩n?</a></li>
<li><a href="../464565/index.html">IP-KVM a trav칠s de QEMU</a></li>
<li><a href="../464571/index.html">Cerebro + VPS por 30 rublos =?</a></li>
<li><a href="../464579/index.html">Computer Vision Summer Camp - Escuela de verano Intel Computer Vision</a></li>
<li><a href="../464581/index.html">25 tipos de "C칠sar" y palabras en ingl칠s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>