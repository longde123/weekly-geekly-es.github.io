<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš† ğŸª ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ Kotlinä¾‹å¤–åŠå…¶åŠŸèƒ½ ğŸ•°ï¸ ğŸ‘©ğŸ¾â€ğŸ¤ ğŸ•ºğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬å…¬å¸å·²ç»åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨Kotlinä¸¤å¹´å¤šäº†ã€‚ å°±ä¸ªäººè€Œè¨€ï¼Œå¤§çº¦ä¸€å¹´å‰ï¼Œæˆ‘é‡åˆ°è¿‡è¿™ç§è¯­è¨€ã€‚ æœ‰å¾ˆå¤šè¯é¢˜è¦è®¨è®ºï¼Œä½†æ˜¯ä»Šå¤©æˆ‘ä»¬å°†è®¨è®ºé”™è¯¯å¤„ç†ï¼ŒåŒ…æ‹¬åŠŸèƒ½æ€§æ ·å¼ã€‚ æˆ‘å°†å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨Kotlinä¸­è¿›è¡Œæ“ä½œã€‚ 



 ï¼ˆæœ‰å…³è¯¥ä¸»é¢˜çš„ä¼šè®®çš„ç…§ç‰‡åœ¨Taganrogå…¬å¸ä¹‹ä¸€çš„åŠå…¬å®¤ä¸¾è¡Œã€‚Maxilektå·¥ä½œç»„ï¼ˆJa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kotlinä¾‹å¤–åŠå…¶åŠŸèƒ½</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/maxilect/blog/447380/"> æˆ‘ä»¬å…¬å¸å·²ç»åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨Kotlinä¸¤å¹´å¤šäº†ã€‚ å°±ä¸ªäººè€Œè¨€ï¼Œå¤§çº¦ä¸€å¹´å‰ï¼Œæˆ‘é‡åˆ°è¿‡è¿™ç§è¯­è¨€ã€‚ æœ‰å¾ˆå¤šè¯é¢˜è¦è®¨è®ºï¼Œä½†æ˜¯ä»Šå¤©æˆ‘ä»¬å°†è®¨è®ºé”™è¯¯å¤„ç†ï¼ŒåŒ…æ‹¬åŠŸèƒ½æ€§æ ·å¼ã€‚ æˆ‘å°†å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨Kotlinä¸­è¿›è¡Œæ“ä½œã€‚ <br><br><img src="https://habrastorage.org/webt/mb/bh/cp/mbbhcprsketr78wg8twpwhijg0y.jpeg" alt="å›¾ç‰‡"><br><br>  <i>ï¼ˆæœ‰å…³è¯¥ä¸»é¢˜çš„ä¼šè®®çš„ç…§ç‰‡åœ¨Taganrogå…¬å¸ä¹‹ä¸€çš„åŠå…¬å®¤ä¸¾è¡Œã€‚Maxilektå·¥ä½œç»„ï¼ˆJavaï¼‰è´Ÿè´£äººAlexey Shafranovå‘è¨€ï¼‰</i> <br><a name="habracut"></a><br><h3> åŸåˆ™ä¸Šå¦‚ä½•å¤„ç†é”™è¯¯ï¼Ÿ </h3><br> æˆ‘å‘ç°äº†å‡ ç§æ–¹æ³•ï¼š <br><br><ul><li> æ‚¨å¯ä»¥ä½¿ç”¨ä¸€äº›<b>è¿”å›å€¼</b>ä½œä¸ºé”™è¯¯äº‹å®çš„æŒ‡é’ˆï¼› </li><li> æ‚¨å¯ä»¥<b>å°†æŒ‡æ ‡å‚æ•°</b>ç”¨äºç›¸åŒçš„ç›®çš„ï¼Œ </li><li> è¾“å…¥ä¸€ä¸ª<b>å…¨å±€å˜é‡</b> </li><li> å¤„ç†<b>å¼‚å¸¸</b> </li><li> æ·»åŠ <b>åˆåŒï¼ˆDbCï¼‰</b> ã€‚ </li></ul><br> è®©æˆ‘ä»¬è¯¦ç»†ä»‹ç»æ¯ä¸ªé€‰é¡¹ã€‚ <br><br><h4> è¿”å›å€¼ </h4><br> å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›æŸä¸ªâ€œé­”æœ¯â€å€¼ã€‚ å¦‚æœæ‚¨æ›¾ç»ä½¿ç”¨è¿‡è„šæœ¬è¯­è¨€ï¼Œé‚£ä¹ˆæ‚¨ä¸€å®šå·²ç»çœ‹è¿‡ç±»ä¼¼çš„ç»“æ„ã€‚ <br><br> èŒƒä¾‹1ï¼š <br><br><pre><code class="plaintext hljs">function sqrt(x) { if(x &lt; 0) return -1; else return âˆšx; }</code> </pre> <br> èŒƒä¾‹2ï¼š <br><br><pre> <code class="plaintext hljs">function getUser(id) { result = db.getUserById(id) if (result) return result as User else return â€œCan't find user â€ + id }</code> </pre><br><h4> æŒ‡æ ‡å‚æ•° </h4><br> ä½¿ç”¨ä¼ é€’ç»™å‡½æ•°çš„ç‰¹å®šå‚æ•°ã€‚ é€šè¿‡å‚æ•°è¿”å›å€¼åï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹å‡½æ•°å†…éƒ¨æ˜¯å¦å­˜åœ¨é”™è¯¯ã€‚ <br><br> ä¸€ä¸ªä¾‹å­ï¼š <br><br><pre> <code class="plaintext hljs">function divide(x,y,out Success) { if (y == 0) Success = false else Success = true return x/y } divide(10, 11, Success) id (!Success) //handle error</code> </pre><br><h4> å…¨å±€å˜é‡ </h4><br> å…¨å±€å˜é‡çš„å·¥ä½œæ–¹å¼å¤§è‡´ç›¸åŒã€‚ <br><br> ä¸€ä¸ªä¾‹å­ï¼š <br><br><pre> <code class="plaintext hljs">global Success = true function divide(x,y) { if (y == 0) Success = false else return x/y } divide(10, 11, Success) id (!Success) //handle error</code> </pre><br><h4> ä¾‹å¤–æƒ…å†µ </h4><br> æˆ‘ä»¬éƒ½ä¹ æƒ¯äºä¾‹å¤–ã€‚ å®ƒä»¬å‡ ä¹åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ã€‚ <br><br> ä¸€ä¸ªä¾‹å­ï¼š <br><br><pre> <code class="plaintext hljs">function divide(x,y) { if (y == 0) throw Exception() else return x/y } try{ divide(10, 0)} catch (e) {//handle exception}</code> </pre><br><h4> åˆçº¦ï¼ˆDbCï¼‰ </h4><br> å¦ç™½è¯´ï¼Œæˆ‘ä»æœªè§è¿‡è¿™ç§æ–¹æ³•ã€‚ ç»è¿‡é•¿æ—¶é—´çš„æœå¯»ï¼Œæˆ‘å‘ç°Kotlin 1.3å…·æœ‰ä¸€ä¸ªå®é™…ä¸Šå…è®¸ä½¿ç”¨åˆåŒçš„åº“ã€‚ å³ æ‚¨å¯ä»¥åœ¨ä¼ é€’ç»™å‡½æ•°çš„å˜é‡ä¸Šè®¾ç½®æ¡ä»¶ï¼Œåœ¨è¿”å›å€¼ï¼Œè°ƒç”¨æ¬¡æ•°ï¼Œä»ä½•å¤„è°ƒç”¨ç­‰æ¡ä»¶ä¸Šè¿›è¡Œè®¾ç½®ã€‚ å¹¶ä¸”ï¼Œå¦‚æœæ»¡è¶³æ‰€æœ‰æ¡ä»¶ï¼Œåˆ™è®¤ä¸ºè¯¥åŠŸèƒ½å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ <br><br> ä¸€ä¸ªä¾‹å­ï¼š <br><br><pre> <code class="plaintext hljs">function sqrt (x) pre-condition (x &gt;= 0) post-condition (return &gt;= 0) begin calculate sqrt from x end</code> </pre><br> è€å®è¯´ï¼Œè¿™ä¸ªåº“çš„è¯­æ³•å¾ˆç³Ÿç³•ã€‚ ä¹Ÿè®¸è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘è¿˜æ²¡æœ‰çœ‹åˆ°è¿™æ ·çš„äº‹æƒ…ã€‚ <br><br><h3>  Javaä¸­çš„å¼‚å¸¸ </h3><br> è®©æˆ‘ä»¬ç»§ç»­å­¦ä¹ Javaä»¥åŠå®ƒä»ä¸€å¼€å§‹å°±å¦‚ä½•å·¥ä½œã€‚ <br><br><img src="https://habrastorage.org/webt/gk/oo/mw/gkoomw72k7yp5mhpi9ebpt02g-i.png" alt="å›¾ç‰‡"><br><br> è®¾è®¡è¯­è¨€æ—¶ï¼Œæå‡ºäº†ä¸¤ç§ç±»å‹çš„å¼‚å¸¸ï¼š <br><br><ul><li> æ£€æŸ¥-æ£€æŸ¥; </li><li> æœªé€‰ä¸­-æœªé€‰ä¸­ã€‚ </li></ul><br> ä»€ä¹ˆæ˜¯æ£€æŸ¥å¼‚å¸¸ï¼Ÿ ä»ç†è®ºä¸Šè®²ï¼Œå®ƒä»¬æ˜¯å¿…éœ€çš„ï¼Œä»¥ä¾¿äººä»¬å¿…é¡»æ£€æŸ¥é”™è¯¯ã€‚ å³ å¦‚æœæŸä¸ªå·²æ£€æŸ¥çš„å¼‚å¸¸æ˜¯å¯èƒ½çš„ï¼Œåˆ™å¿…é¡»ç¨åå¯¹å…¶è¿›è¡Œæ£€æŸ¥ã€‚ ä»ç†è®ºä¸Šè®²ï¼Œè¿™ç§æ–¹æ³•åº”è¯¥å¯¼è‡´æ²¡æœ‰æœªå¤„ç†çš„é”™è¯¯ï¼Œå¹¶æé«˜äº†ä»£ç è´¨é‡ã€‚ ä½†å®é™…ä¸Šå¹¶éå¦‚æ­¤ã€‚ æˆ‘è®¤ä¸ºæ¯ä¸ªäººè‡³å°‘ä¸€ç”Ÿä¸­éƒ½æœ‰ä¸€ä¸ªç©ºæ´çš„æ¸”è·ç‰©ã€‚ <br><br> ä¸ºä»€ä¹ˆè¿™ä¼šä¸å¥½ï¼Ÿ <br><br> è¿™æ˜¯ç›´æ¥æ¥è‡ªKotlinæ–‡æ¡£çš„ç»å…¸ç¤ºä¾‹-StringBuilderä¸­å®ç°çš„JDKçš„æ¥å£ï¼š <br><br><pre> <code class="plaintext hljs">Appendable append(CharSequence csq) throws IOException; try { log.append(message) } catch (IOException e) { //Must be safe }</code> </pre><br> æˆ‘ç¡®ä¿¡æ‚¨å·²ç»é‡åˆ°äº†å¾ˆå¤šç”¨try-catchåŒ…è£…çš„ä»£ç ï¼Œåœ¨è¿™é‡Œcatchæ˜¯ä¸€ä¸ªç©ºå—ï¼Œå› ä¸ºè¿™ç§æƒ…å†µæ ¹æœ¬å°±ä¸ä¼šå‘ç”Ÿã€‚ åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå¯¹å·²æ£€æŸ¥å¼‚å¸¸çš„å¤„ç†æ˜¯é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°çš„ï¼šå®ƒä»¬åªæ˜¯æŠ›å‡ºRuntimeExceptionå¹¶å°†å…¶æ•è·åˆ°ä¸Šé¢çš„æŸä¸ªåœ°æ–¹ï¼ˆæˆ–ä¸æ•è·å®ƒâ€¦â€¦ï¼‰ã€‚ <br><br><pre> <code class="plaintext hljs">try { // do something } catch (IOException e) { throw new RuntimeException(e); //  - ...</code> </pre><br><h3> ç§‘ç‰¹æ—æœ‰ä»€ä¹ˆå¯èƒ½ </h3><br> åœ¨ä¾‹å¤–æ–¹é¢ï¼ŒKotlinç¼–è¯‘å™¨çš„ä¸åŒä¹‹å¤„åœ¨äºï¼š <br><br>  1.ä¸åŒºåˆ†å·²æ£€æŸ¥å’Œæœªæ£€æŸ¥çš„å¼‚å¸¸ã€‚ ä»…æ£€æŸ¥æ‰€æœ‰å¼‚å¸¸ï¼Œæ‚¨å¯ä»¥è‡ªå·±å†³å®šæ˜¯å¦æ•è·å¹¶å¤„ç†å®ƒä»¬ã€‚ <br><br>  2. tryå¯ç”¨ä½œè¡¨è¾¾å¼-æ‚¨å¯ä»¥è¿è¡Œtryå—å¹¶ä»ä¸­è¿”å›æœ€åä¸€è¡Œï¼Œæˆ–è€…ä»catchå—è¿”å›æœ€åä¸€è¡Œã€‚ <br><br><pre> <code class="plaintext hljs">val value = try {Integer.parseInt(â€œlolâ€)} catch(e: NumberFormanException) { 4 } // </code> </pre><br>  3.å¼•ç”¨æŸäº›å¯¹è±¡æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ„é€ ï¼Œè¯¥æ„é€ å¯ä»¥ä¸ºç©ºï¼š <br><br><pre> <code class="plaintext hljs">val s = obj.money ?: throw IllegalArgumentException(â€œ , â€)</code> </pre><br><h4>  Javaå…¼å®¹æ€§ </h4><br>  Kotlinä»£ç å¯ä»¥åœ¨Javaä¸­ä½¿ç”¨ï¼Œåä¹‹äº¦ç„¶ã€‚ å¦‚ä½•å¤„ç†å¼‚å¸¸ï¼Ÿ <br><br><ul><li>  Kotlinä¸­Javaçš„å·²æ£€æŸ¥å¼‚å¸¸ä¸èƒ½è¢«æ£€æŸ¥æˆ–å£°æ˜ï¼ˆå› ä¸ºKotlinä¸­æ²¡æœ‰å·²æ£€æŸ¥å¼‚å¸¸ï¼‰ã€‚ </li><li> ä¸éœ€è¦åœ¨Javaä¸­æ£€æŸ¥æ¥è‡ªKotlinçš„å¯èƒ½æ£€æŸ¥å¼‚å¸¸ï¼ˆä¾‹å¦‚ï¼Œæœ€åˆæ¥è‡ªJavaçš„å¼‚å¸¸ï¼‰ã€‚ </li><li> å¦‚æœéœ€è¦æ£€æŸ¥ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•ä¸­çš„@Throwsæ‰¹æ³¨æ¥æ£€æŸ¥å¼‚å¸¸ï¼ˆæ‚¨å¿…é¡»æŒ‡å®šæ­¤æ–¹æ³•å¯ä»¥æŠ›å‡ºå“ªäº›å¼‚å¸¸ï¼‰ã€‚ ä¸Šé¢çš„æ³¨é‡Šä»…ç”¨äºJavaå…¼å®¹æ€§ã€‚ ä½†æ˜¯å®é™…ä¸Šï¼Œè®¸å¤šäººä½¿ç”¨å®ƒæ¥å£°æ˜è¿™ç§æ–¹æ³•åŸåˆ™ä¸Šå¯ä»¥å¼•å‘æŸç§å¼‚å¸¸ã€‚ </li></ul><br><h4> å°è¯•æ•è·å—çš„æ›¿ä»£æ–¹æ³• </h4><br> å°è¯•æ•è·å—å…·æœ‰æ˜æ˜¾çš„ç¼ºç‚¹ã€‚ å½“å®ƒå‡ºç°æ—¶ï¼Œéƒ¨åˆ†ä¸šåŠ¡é€»è¾‘å°†åœ¨catchä¸­ä¼ è¾“ï¼Œå¹¶ä¸”è¿™å¯ä»¥é€šè¿‡ä¸Šè¿°è®¸å¤šæ–¹æ³•ä¹‹ä¸€å‘ç”Ÿã€‚ å½“ä¸šåŠ¡é€»è¾‘åˆ†å¸ƒåœ¨æ•´ä¸ªå—æˆ–æ•´ä¸ªå‘¼å«é“¾ä¸­æ—¶ï¼Œå¾ˆéš¾ç†è§£åº”ç”¨ç¨‹åºçš„å·¥ä½œæ–¹å¼ã€‚ å¹¶ä¸”å¯è¯»æ€§å—æœ¬èº«ä¸ä¼šæ·»åŠ ä»£ç ã€‚ <br><br><pre> <code class="plaintext hljs">try { HttpService.SendNotification(endpointUrl); MarkNotificationAsSent(); } catch (e: UnableToConnectToServerException) { MarkNotificationAsNotSent(); }</code> </pre><br> æœ‰å“ªäº›é€‰æ‹©ï¼Ÿ <br><br> ä¸€ä¸ªé€‰é¡¹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§å¤„ç†å¼‚å¸¸çš„å®ç”¨æ–¹æ³•ã€‚ ç±»ä¼¼çš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="plaintext hljs">val result: Try&lt;Result&gt; = Try{HttpService.SendNotification(endpointUrl)} when(result) { is Success -&gt; MarkNotificationAsSent() is Failure -&gt; MarkNotificationAsNotSent() }</code> </pre><br> æˆ‘ä»¬æœ‰æœºä¼šä½¿ç”¨Try monadã€‚ æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªå­˜å‚¨ä¸€äº›ä»·å€¼çš„å®¹å™¨ã€‚  flatMapæ˜¯ä½¿ç”¨æ­¤å®¹å™¨çš„ä¸€ç§æ–¹æ³•ï¼Œè¯¥å®¹å™¨ä¸å½“å‰å€¼ä¸€èµ·å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å†æ¬¡è¿”å›ä¸€ä¸ªmonadã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥å‘¼å«å°†åŒ…è£…åœ¨Try monadä¸­ï¼ˆæˆ‘ä»¬è¿”å›Tryï¼‰ã€‚ å®ƒå¯ä»¥åœ¨ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„åœ°æ–¹å¤„ç†ã€‚ å¦‚æœè¾“å‡ºæœ‰ä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬å°†å¯¹å…¶æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼›å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™å°†åœ¨é“¾çš„æœ€æœ«ç«¯è¿›è¡Œå¤„ç†ã€‚ <br><br><h4> åŠŸèƒ½å¼‚å¸¸å¤„ç† </h4><br> åœ¨å“ªé‡Œå¯ä»¥å°è¯•ï¼Ÿ <br><br> é¦–å…ˆï¼Œæœ‰è®¸å¤šTryå’ŒEitherç±»çš„ç¤¾åŒºå®ç°ã€‚ æ‚¨å¯ä»¥æ¥å—å®ƒä»¬ç”šè‡³è‡ªå·±ç¼–å†™å®ç°ã€‚ åœ¨å…¶ä¸­ä¸€ä¸ªâ€œæˆ˜æ–—â€é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†è‡ªåˆ¶çš„Tryå®æ–½-æˆ‘ä»¬ç®¡ç†äº†ä¸€ä¸ªç­çº§ï¼Œå¹¶ä¸”åšå¾—å¾ˆå¥½ã€‚ <br> å…¶æ¬¡ï¼Œè¿˜æœ‰Arrowåº“ï¼Œè¯¥åº“åŸåˆ™ä¸Šä¸ºKotlinå¢åŠ äº†å¾ˆå¤šåŠŸèƒ½ã€‚ è‡ªç„¶åœ°ï¼Œæœ‰Try and Eitherã€‚ <br><br> å¥½å§ï¼Œæ­¤å¤–ï¼ŒResultç±»å‡ºç°åœ¨Kotlin 1.3ä¸­ï¼Œæˆ‘å°†åœ¨åé¢è¯¦ç»†è®¨è®ºã€‚ <br><br><h4> å°è¯•ä»¥Arrowåº“ä¸ºä¾‹ </h4><br>  Arrowåº“ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªTryç±»ã€‚ å®é™…ä¸Šï¼Œå®ƒå¯ä»¥å¤„äºä¸¤ç§çŠ¶æ€ï¼šæˆåŠŸæˆ–å¤±è´¥ï¼š <br><br><ul><li> æˆåŠŸå–æ¬¾æˆåŠŸå°†ä¿ç•™æˆ‘ä»¬çš„ä»·å€¼ï¼Œ </li><li> æ•…éšœå­˜å‚¨åœ¨æ‰§è¡Œä»£ç å—æœŸé—´å‘ç”Ÿçš„å¼‚å¸¸ã€‚ </li></ul><br> è°ƒç”¨å¦‚ä¸‹ã€‚ è‡ªç„¶ï¼Œå®ƒåŒ…è£…åœ¨å¸¸è§„try-catchä¸­ï¼Œä½†è¿™å°†åœ¨æˆ‘ä»¬ä»£ç å†…çš„æŸå¤„å‘ç”Ÿã€‚ <br><br><pre> <code class="plaintext hljs">sealed class Try&lt;out A&gt; { data class Success&lt;out A&gt;(val value: A) : Try&lt;A&gt;() data class Failure(val e: Throwable) : Try&lt;Nothing&gt;() companion object { operator fun &lt;A&gt; invoke(body: () -&gt; A): Try&lt;A&gt; { return try { Success(body()) } catch (e: Exception) { Failure(e) } } }</code> </pre><br> ç›¸åŒçš„ç±»åº”å®ç°flatMapæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸æ‚¨ä¼ é€’å‡½æ•°å¹¶è¿”å›æˆ‘ä»¬çš„try monadï¼š <br><br><pre> <code class="plaintext hljs">inline fun &lt;B&gt; map(f: (A) -&gt; B): Try&lt;B&gt; = flatMap { Success(f(it)) } inline fun &lt;B&gt; flatMap(f: (A) -&gt; TryOf&lt;B&gt;): Try&lt;B&gt; = when (this) { is Failure -&gt; this is Success -&gt; f(value) }</code> </pre><br> è¿™æ˜¯ä¸ºäº†ä»€ä¹ˆ å½“æˆ‘ä»¬æœ‰å¤šä¸ªé”™è¯¯æ—¶ï¼Œä¸ºäº†ä¸å¤„ç†æ¯ä¸ªç»“æœçš„é”™è¯¯ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä»ä¸åŒçš„æœåŠ¡ä¸­è·å¾—äº†ä¸€äº›ä»·å€¼ï¼Œå¹¶å¸Œæœ›å°†å®ƒä»¬ç»“åˆèµ·æ¥ã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸¤ç§æƒ…å†µï¼šè¦ä¹ˆæˆ‘ä»¬æˆåŠŸæ¥æ”¶å¹¶åˆå¹¶äº†å®ƒä»¬ï¼Œè¦ä¹ˆæœ‰äº›ä¸œè¥¿æ‰äº†ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š <br><br><pre> <code class="plaintext hljs">val result1: Try&lt;Int&gt; = Try { 11 } val result2: Try&lt;Int&gt; = Try { 4 } val sum = result1.flatMap { one -&gt; result2.map { two -&gt; one + two } } println(sum) //Success(value=15)</code> </pre><br> å¦‚æœä¸¤ä¸ªè°ƒç”¨éƒ½æˆåŠŸå¹¶ä¸”æˆ‘ä»¬å¾—åˆ°äº†å€¼ï¼Œåˆ™æ‰§è¡Œå‡½æ•°ã€‚ å¦‚æœå®ƒä»¬ä¸æˆåŠŸï¼Œåˆ™å¤±è´¥å°†è¿”å›å¼‚å¸¸ã€‚ <br><br> è¿™æ˜¯å¦‚æœä¸œè¥¿æ‰ä¸‹æ¥çš„æ ·å­ï¼š <br><br><pre> <code class="plaintext hljs">val result1: Try&lt;Int&gt; = Try { 11 } val result2: Try&lt;Int&gt; = Try { throw RuntimeException(â€œOh no!â€) } val sum = result1.flatMap { one -&gt; result2.map { two -&gt; one + two } } println(sum) //Failure(exception=java.lang.RuntimeException: Oh no!</code> </pre><br> æˆ‘ä»¬ä½¿ç”¨äº†ç›¸åŒçš„å‡½æ•°ï¼Œä½†æ˜¯è¾“å‡ºæ˜¯RuntimeExceptionçš„Failureã€‚ <br><br> å¦å¤–ï¼ŒArrowåº“å…è®¸æ‚¨ä½¿ç”¨å®é™…ä¸Šæ˜¯è¯­æ³•ç³–ï¼ˆç‰¹åˆ«æ˜¯ç»‘å®šï¼‰çš„æ„é€ ã€‚ å¯ä»¥é€šè¿‡ä¸²è¡ŒflatMapé‡å†™æ‰€æœ‰ç›¸åŒçš„å†…å®¹ï¼Œä½†æ˜¯ç»‘å®šä½¿æ‚¨å¯ä»¥è¯»å–å®ƒã€‚ <br><br><pre> <code class="plaintext hljs">val result1: Try&lt;Int&gt; = Try { 11 } val result2: Try&lt;Int&gt; = Try { 4 } val result3: Try&lt;Int&gt; = Try { throw RuntimeException(â€œOh no, again!â€) } val sum = binding { val (one) = result1 val (two) = result2 val (three) = result3 one + two + three } println(sum) //Failure(exception=java.lang.RuntimeException: Oh no, again!</code> </pre><br> é‰´äºå…¶ä¸­ä¸€é¡¹ç»“æœä¸‹é™äº†ï¼Œæˆ‘ä»¬åœ¨è¾“å‡ºä¸­å¾—åˆ°äº†ä¸€ä¸ªé”™è¯¯ã€‚ <br><br> ç±»ä¼¼çš„monadå¯ç”¨äºå¼‚æ­¥è°ƒç”¨ã€‚ ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸¤ä¸ªå¼‚æ­¥è¿è¡Œçš„å‡½æ•°ã€‚ æˆ‘ä»¬ä»¥ç›¸åŒçš„æ–¹å¼åˆå¹¶ç»“æœï¼Œè€Œæ— éœ€å•ç‹¬æ£€æŸ¥å…¶çŠ¶æ€ï¼š <br><br><pre> <code class="plaintext hljs">fun funA(): Try&lt;Int&gt; { return Try { 1 } } fun funB(): Try&lt;Int&gt; { Thread.sleep(3000L) return Try { 2 } } val a = GlobalScope.async { funA() } val b = GlobalScope.async { funB() } val sum = runBlocking { a.await().flatMap { one -&gt; b.await().map {two -&gt; one + two } } }</code> </pre><br> è¿™æ˜¯ä¸€ä¸ªæ›´â€œæˆ˜æ–—â€çš„ä¾‹å­ã€‚ æˆ‘ä»¬æœ‰ä¸€ä¸ªå¯¹æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œä»ä¸­è·å–ä¸»ä½“ï¼Œç„¶åå°è¯•å°†å…¶æ˜ å°„åˆ°æˆ‘ä»¬å·²ç»ä»ä¸­è¿”å›æ•°æ®çš„ç±»ã€‚ <br><br><pre> <code class="plaintext hljs">fun makeRequest(request: Request): Try&lt;List&lt;ResponseData&gt;&gt; = Try { httpClient.newCall(request).execute() } .map { it.body() } .flatMap { Try { ObjectMapper().readValue(it, ParsedResponse::class.java) } } .map { it.data } fun main(args : Array&lt;String&gt;) { val response = makeRequest(RequestBody(args)) when(response) { is Try.Success -&gt; response.data.toString() is Try.Failure -&gt; response.exception.message } }</code> </pre><br> å°è¯•æ•è·å°†ä½¿æ­¤å—çš„å¯è¯»æ€§å¤§å¤§é™ä½ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨è¾“å‡ºå¤„è·å¾—response.dataï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ç»“æœè¿›è¡Œå¤„ç†ã€‚ <br><br><h4>  Kotlin 1.3çš„ç»“æœ </h4><br>  Kotlin 1.3å¼•å…¥äº†Resultç±»ã€‚ å®é™…ä¸Šï¼Œå®ƒä¸Tryç±»ä¼¼ï¼Œä½†æœ‰å¾ˆå¤šé™åˆ¶ã€‚ å®ƒæœ€åˆæ—¨åœ¨ç”¨äºå„ç§å¼‚æ­¥æ“ä½œã€‚ <br><br><pre> <code class="plaintext hljs">val result: Result&lt;VeryImportantData&gt; = Result.runCatching { makeRequest() } .mapCatching { parseResponse(it) } .mapCatching { prepareData(it) } result.fold{ { data -&gt; println(â€œWe have $dataâ€) }, exception -&gt; println(â€œThere is no any data, but it's your exception $exceptionâ€) } )</code> </pre><br> å¦‚æœæ²¡æœ‰è®°é”™çš„è¯ï¼Œè¿™ä¸ªè¯¾ç¨‹ç›®å‰æ˜¯å®éªŒæ€§çš„ã€‚ è¯­è¨€å¼€å‘äººå‘˜å¯ä»¥æ›´æ”¹å…¶ç­¾åï¼Œè¡Œä¸ºæˆ–å°†å…¶å®Œå…¨åˆ é™¤ï¼Œå› æ­¤ç›®å‰ç¦æ­¢å°†å…¶ç”¨ä½œæ–¹æ³•æˆ–å˜é‡çš„è¿”å›å€¼ã€‚ ä½†æ˜¯ï¼Œå®ƒå¯ä»¥ç”¨ä½œå±€éƒ¨ï¼ˆç§æœ‰ï¼‰å˜é‡ã€‚ å³ å®é™…ä¸Šï¼Œå¯ä»¥ä»ç¤ºä¾‹ä¸­å°è¯•ä½¿ç”¨å®ƒã€‚ <br><br><h3> ç»“è®º </h3><br> æˆ‘ä¸ºè‡ªå·±å¾—å‡ºçš„ç»“è®ºï¼š <br><br><ul><li>  Kotlinä¸­çš„åŠŸèƒ½é”™è¯¯å¤„ç†æ—¢ç®€å•åˆæ–¹ä¾¿ï¼› </li><li> æ²¡æœ‰äººä¼šè´¹å¿ƒåœ°é€šè¿‡å¤å…¸é£æ ¼çš„å°è¯•æ•æ‰æ¥å¤„ç†å®ƒä»¬ï¼ˆå…·æœ‰ç”Ÿå‘½æƒï¼›å…·æœ‰ç”Ÿå‘½æƒï¼›å…·æœ‰ä¾¿åˆ©æ€§ï¼‰ï¼› </li><li> æ²¡æœ‰æ£€æŸ¥å¼‚å¸¸å¹¶ä¸æ„å‘³ç€ä¸èƒ½å¤„ç†é”™è¯¯ï¼› </li><li> ç”Ÿäº§ä¸­æœªæ•è·çš„å¼‚å¸¸ä¼šå¯¼è‡´å¯æ‚²çš„åæœã€‚ </li></ul><br> æ–‡ç« ä½œè€…ï¼šMaxilectå·¥ä½œç»„ï¼ˆJavaï¼‰è´Ÿè´£äººAlexey Shafranov <br><br>  PSï¼šæˆ‘ä»¬åœ¨Runetçš„å¤šä¸ªç«™ç‚¹ä¸Šå‘è¡¨æ–‡ç« ã€‚ è®¢é˜…æˆ‘ä»¬åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VK</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FB</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Telegramé¢‘é“</a>ä¸Šçš„é¡µé¢ï¼Œä»¥æŸ¥æ‰¾æœ‰å…³æˆ‘ä»¬æ‰€æœ‰å‡ºç‰ˆç‰©å’Œå…¶ä»–Maxilectæ–°é—»çš„ä¿¡æ¯ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN447380/">https://habr.com/ru/post/zh-CN447380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN447368/index.html">ä¸åªæ˜¯æŠ“è·³èš¤ã€‚ ä¸ºä»€ä¹ˆé€Ÿåº¦å¯¹ä»»ä½•å•†åº—éƒ½å¦‚æ­¤é‡è¦</a></li>
<li><a href="../zh-CN447370/index.html">ä¸ºä»€ä¹ˆï¼Œç”±äºä¸“åˆ©åˆ¶åº¦ç ´è£‚ï¼ŒTheranosçš„é˜´å½±ä»ç„¶ç¬¼ç½©ç€æˆ‘ä»¬</a></li>
<li><a href="../zh-CN447372/index.html">ITè½¬å‹æ˜¯ä¸å¯é¿å…çš„ï¼šä»å“ªé‡Œå¼€å§‹</a></li>
<li><a href="../zh-CN447374/index.html">ä½¿ç”¨PureLayoutä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºç•Œé¢å…ƒç´ ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</a></li>
<li><a href="../zh-CN447376/index.html">SNA Hackathon 2019</a></li>
<li><a href="../zh-CN447382/index.html">ã€Šç»Ÿä¸€ä¸Cï¼ƒã€‹ä¸€ä¹¦ã€‚ Gamedevä»æ„æ€åˆ°å®æ–½ã€‚ ç¬¬äºŒç‰ˆ</a></li>
<li><a href="../zh-CN447384/index.html">åŠŸç‡åŠå¯¼ä½“ä¿æŠ¤ç”Ÿæ€</a></li>
<li><a href="../zh-CN447388/index.html">TLï¼› ITMOå¤§å­¦çš„æ‘˜è¦ï¼šéç»å…¸çš„å¤§å­¦å…¥å­¦ï¼Œå³å°†å‘ç”Ÿçš„äº‹ä»¶å’Œæœ€æœ‰è¶£çš„èµ„æ–™</a></li>
<li><a href="../zh-CN447390/index.html">é€‚ç”¨äºVMware vSphereçš„AccelStor AFAé…ç½®æŒ‡å—</a></li>
<li><a href="../zh-CN447392/index.html">è‹±è¯­è¯­æ³•æ£€æŸ¥æœåŠ¡çš„ä¸‰ä¸ªé—®é¢˜ä»¥åŠæ˜¯å¦å¯ä»¥è§£å†³</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>