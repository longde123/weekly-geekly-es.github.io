<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò≥ üöß üèá Amazon Lumberyard: o grito da alma ü¶Ñ üòô ü¶Ä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os jogos s√£o um dos produtos de software mais populares. Esta √© uma ind√∫stria enorme em que um novo mecanismo de jogo - o Amazon Lumberyard. O projeto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Amazon Lumberyard: o grito da alma</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/416565/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94c/9b7/4f0/94c9b74f00eae5bc8d344548dd744585.png"></div><br>  Os jogos s√£o um dos produtos de software mais populares.  Esta √© uma ind√∫stria enorme em que um novo mecanismo de jogo - o Amazon Lumberyard.  O projeto ainda est√° no status beta e tem tempo para corrigir erros e melhorar a qualidade do c√≥digo.  Os desenvolvedores do mecanismo t√™m muito trabalho a fazer em um futuro pr√≥ximo para n√£o decepcionar milh√µes de jogadores e desenvolvedores de jogos. <br><a name="habracut"></a><br><h2>  1. Introdu√ß√£o </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Amazon Lumberyard</a> √© um mecanismo de jogo gratuito de plataforma cruzada AAA desenvolvido pela Amazon e baseado na arquitetura de mecanismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CryEngine</a> , que foi licenciada pela Crytek em 2015.  A prop√≥sito, a an√°lise do CryEngine j√° foi feita duas vezes por mim em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">agosto de 2016</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">abril de 2017</a> .  Ao mesmo tempo, devo observar que, ap√≥s um ano, o c√≥digo s√≥ piorou.  E outro dia, decidi ver o que a Amazon fazia com base nesse mecanismo de jogo.  Eles trabalharam muito bem no meio ambiente.  A documenta√ß√£o para desenvolvedores e software para implantar um ambiente de trabalho √© muito legal e de alto n√≠vel.  Mas o problema est√° novamente com o c√≥digo!  Espero que a Amazon tenha muito mais recursos para trabalhar com o projeto, e eles ainda prestem aten√ß√£o √† qualidade do c√≥digo.  Com esta revis√£o, espero chamar a aten√ß√£o dos desenvolvedores para a qualidade do c√≥digo e pressionar por uma nova abordagem no desenvolvimento desse mecanismo de jogo.  O estado atual do c√≥digo estava em um estado t√£o deplor√°vel que eu mudei o t√≠tulo do artigo v√°rias vezes e redesenhou a imagem do t√≠tulo enquanto olhava o relat√≥rio com os resultados da an√°lise.  A primeira vers√£o da imagem foi menos emocional: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/fa3/c02/e6dfa3c02fad5fb4eadd6ca01cd68b62.png"></div><br><br>  Analisamos as fontes do Amazon Lumberyard da vers√£o mais recente dispon√≠vel 1.14.0.1.  O c√≥digo fonte √© retirado do reposit√≥rio no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Github</a> .  Um dos primeiros jogos no mecanismo Lumberyard deve ser o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Star Citizen</a> .  Jogadores potenciais que est√£o esperando por ela, tamb√©m convido voc√™ a dar uma olhada no que est√° atualmente "sob o cap√¥" do jogo. <br><br><h2>  Integra√ß√£o com PVS-Studio </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O PVS-Studio foi</a> usado como um analisador de c√≥digo est√°tico.  Est√° dispon√≠vel para Windows, Linux e macOS.  I.e.  para a an√°lise do projeto de plataforma cruzada, ainda h√° algo a ser escolhido para um trabalho mais confort√°vel.  Al√©m de C e C ++, a an√°lise de projetos na linguagem C # √© suportada.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Planos Java</a> .  A grande maioria dos c√≥digos do mundo est√° escrita nos idiomas listados (n√£o sem erros, √© claro); portanto, tente o analisador PVS-Studio em seu projeto, voc√™ aprender√° muitas coisas interessantes ;-). <br><br>  Como sistema de montagem da Lumberyard, √© utilizado o WAF, que tamb√©m estava no CryEngine.  O analisador n√£o possui uma maneira especial de integrar-se com este sistema de montagem.  Decidi trabalhar com um projeto no Windows e escolhi este m√©todo para iniciar a an√°lise: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um sistema de monitoramento de compila√ß√£o</a> .  O arquivo de projeto para o Visual Studio √© gerado automaticamente.  Ele pode ser usado para criar o projeto e visualizar o relat√≥rio do analisador. <br><br>  A lista de comandos para an√°lise √© mais ou menos assim: <br><br><pre><code class="cpp hljs">cd /path/to/lumberyard/dev lmbr_waf.bat ... CLMonitor.exe monitor MSBuild.exe ... LumberyardSDK_vs15.sln ... CLMonitor.exe analyze --<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> /path/to/report.plog</code> </pre> <br>  O relat√≥rio, como eu disse, pode ser exibido no Visual Studio. <br><br><h2>  Sobre Igor e Qualcomm </h2><br>  O Amazon Lumberyard se posiciona como um mecanismo de jogo de plataforma cruzada.  √â f√°cil promover um projeto para as massas com esse recurso, mas √© muito dif√≠cil mant√™-lo.  Um dos avisos do PVS-Studio foi emitido em um fragmento de c√≥digo no qual o programador Igor lutou com o compilador Qualcomm.  Talvez ele tenha resolvido o problema, mas deixou um c√≥digo extremamente suspeito.  Eu decidi desenh√°-lo com uma imagem. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V523</a> A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">instru√ß√£o</a> 'then' √© equivalente √† instru√ß√£o 'else'.  toglsloperand.c 700 <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/933/cc0/610/933cc0610c9968b8c0d1455ffcd4f245.png"></p><br>  Aqui o mesmo c√≥digo √© executado, independentemente da condi√ß√£o calculada.  No contexto dos coment√°rios deixados, essa decis√£o parece suspeita. <br><br>  Em geral, o projeto n√£o √© o √∫nico local em que as condi√ß√µes precisam ser simplificadas para maior clareza ou para corrigir um erro real.  Aqui est√° uma lista desses lugares: <br><br><ul><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  livingentity.cpp 1385 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  tometalinstruction.c 4201 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  scripttable.cpp 905 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  budgetingsystem.cpp 701 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  editorframeworkapplication.cpp 562 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  particleitem.cpp 130 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  trackviewnodes.cpp 1223 </li><li>  V523 A instru√ß√£o 'then' √© equivalente √† instru√ß√£o 'else'.  propertyoarchive.cpp 447 </li></ul><br><h2>  Python ++ </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/000/30b/8bd/00030b8bd5aa006af7df8c98db5ef66f.png"></div><br><br>  O analisador encontrou um c√≥digo t√£o engra√ßado: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V709</a> CWE-682 Compara√ß√£o suspeita encontrada: 'a == b == c'.  Lembre-se de que 'a == b == c' n√£o √© igual a 'a == b &amp;&amp; b == c'.  toglslinstruction.c 564 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CallBinaryOp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> src1SwizCount = GetNumSwizzleElements(....); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> src0SwizCount = GetNumSwizzleElements(....); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> dstSwizCount = GetNumSwizzleElements(....); .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src1SwizCount == src0SwizCount == dstSwizCount) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { .... } .... }</span></span></code> </pre> <br>  Infelizmente, em C ++, esse c√≥digo √© compilado com √™xito, mas n√£o √© executado como pode parecer.  Express√µes em C ++ s√£o avaliadas em ordem de prioridade, executando castas impl√≠citas, se necess√°rio. <br><br>  Essa verifica√ß√£o estaria correta, por exemplo, na linguagem Python.  Mas nessa situa√ß√£o, o desenvolvedor "deu um tiro no p√©". <br><br>  Mais 3 tiros de controle: <br><br><ul><li>  V709 CWE-682 Compara√ß√£o suspeita encontrada: 'a == b == c'.  Lembre-se de que 'a == b == c' n√£o √© igual a 'a == b &amp;&amp; b == c'.  toglslinstruction.c 654 </li><li>  V709 CWE-682 Compara√ß√£o suspeita encontrada: 'a == b == c'.  Lembre-se de que 'a == b == c' n√£o √© igual a 'a == b &amp;&amp; b == c'.  toglslinstruction.c 469 </li><li>  V709 CWE-682 Compara√ß√£o suspeita encontrada: 'a == b == c'.  Lembre-se de que 'a == b == c' n√£o √© igual a 'a == b &amp;&amp; b == c'.  tometalinstruction.c 539 </li></ul><br><h2>  O primeiro e um dos melhores diagn√≥sticos </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e9/03c/f55/9e903cf5512521593ce3a8f226105025.png"></div><br><br>  Ser√° sobre o aviso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> - o primeiro diagn√≥stico de uso geral no PVS-Studio.  Os erros encontrados apenas neste diagn√≥stico podem ser suficientes para escrever um artigo.  E o projeto Amazon Lumberyard demonstra isso muito bem. <br><br>  Infelizmente, √© chato olhar para erros do mesmo tipo por um longo tempo; portanto, nesta se√ß√£o, comentarei apenas alguns fragmentos de c√≥digo e o restante dos avisos ser√£o listados. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> Existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">subexpress√µes</a> id√™nticas √† esquerda e √† direita do '||'  operador: hotX &lt;0 ||  hotX &lt;0 editorutils.cpp 166 <br><br><pre> <code class="cpp hljs">QCursor CMFCUtils::LoadCursor(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!pm.isNull() &amp;&amp; (hotX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || hotX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-function"><span class="hljs-function">QFile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span></span>; f.open(QFile::ReadOnly); <span class="hljs-function"><span class="hljs-function">QDataStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;f)</span></span></span></span>; stream.setByteOrder(QDataStream::LittleEndian); f.read(<span class="hljs-number"><span class="hljs-number">10</span></span>); quint16 x; stream &gt;&gt; x; hotX = x; stream &gt;&gt; x; hotY = x; } .... }</code> </pre> <br>  A condi√ß√£o n√£o possui a vari√°vel <b><i>Y</i></b> <i>quente</i> <b><i>.</i></b>  Erro de digita√ß√£o cl√°ssico. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> Existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">subexpress√µes</a> id√™nticas 'sp.m_pTexture == m_pTexture' √† esquerda e √† direita do operador '&amp;&amp;'.  shadercomponents.h 487 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> Existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">subexpress√µes</a> id√™nticas 'sp.m_eCGTextureType == m_eCGTextureType' √† esquerda e √† direita do operador '&amp;&amp;'.  shadercomponents.h 487 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> != (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SCGTexture&amp; sp) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sp.m_RegisterOffset == m_RegisterOffset &amp;&amp; sp.m_Name == m_Name &amp;&amp; sp.m_pTexture == m_pTexture &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 sp.m_RegisterCount == m_RegisterCount &amp;&amp; sp.m_eCGTextureType == m_eCGTextureType &amp;&amp; // &lt;= 2 sp.m_BindingSlot == m_BindingSlot &amp;&amp; sp.m_Flags == m_Flags &amp;&amp; sp.m_pAnimInfo == m_pAnimInfo &amp;&amp; sp.m_pTexture == m_pTexture &amp;&amp; // &lt;= 1 sp.m_eCGTextureType == m_eCGTextureType &amp;&amp; // &lt;= 2 sp.m_bSRGBLookup == m_bSRGBLookup &amp;&amp; sp.m_bGlobal == m_bGlobal) { return false; } return true; }</span></span></code> </pre> <br>  Duas c√≥pias de pastas foram encontradas neste fragmento de uma s√≥ vez.  Para maior clareza, pintei flechas. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> Existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">subexpress√µes</a> id√™nticas √† esquerda e √† direita do operador '==': pSrc.GetLen () == pSrc.GetLen () fbxpropertytypes.h 978 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FbxTypeCopy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FbxBlob&amp; pDst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> FbxString&amp; pSrc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> lCastable = pSrc.GetLen() == pSrc.GetLen(); FBX_ASSERT( lCastable ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( lCastable ) pDst.Assign(pSrc.Buffer(), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)pSrc.GetLen()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lCastable; }</code> </pre> <br>  Aqui, quero dizer ol√° aos desenvolvedores da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AUTODESK</a> .  Este erro √© da biblioteca do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SDK do FBX</a> .  Vari√°veis ‚Äã‚Äãconfusas <i>pSrc</i> e <i>pDst</i> .  Acho que, al√©m do Lumberyard, tamb√©m existem muitos outros usu√°rios cujos projetos dependem do c√≥digo com esse erro. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> Existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">subexpress√µes</a> id√™nticas √† esquerda e √† direita do operador '&amp;&amp;': pTS-&gt; pRT_ALD_1 &amp;&amp; pTS-&gt; pRT_ALD_1 d3d_svo.cpp 857 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CSvoRenderer::ConeTracePass(SSvoTargetsSet* pTS) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pTS-&gt;pRT_ALD_1 &amp;&amp; pTS-&gt;pRT_ALD_1) { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nPrevWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { pTS-&gt;pRT_ALD_1-&gt;Apply(<span class="hljs-number"><span class="hljs-number">10</span></span>, m_nTexStateLinear); pTS-&gt;pRT_RGB_1-&gt;Apply(<span class="hljs-number"><span class="hljs-number">11</span></span>, m_nTexStateLinear); } } .... }</code> </pre> <br>  Voltar para o c√≥digo Lumberyard.  Na condi√ß√£o, o mesmo ponteiro <i>pTS-&gt; pRT_ALD_1 √© verificado</i> .  Um deles deveria ter sido <i>pTS-&gt; pRT_RGB_1</i> .  Talvez, mesmo ap√≥s a explica√ß√£o, n√£o seja imediatamente poss√≠vel ver a diferen√ßa, mas existe uma: a diferen√ßa est√° nos substratos curtos <i>ALD</i> e <i>RGB</i> .  Se voc√™ for informado de que a Revis√£o de c√≥digo manual √© suficiente, mostre este exemplo. <br><br>  E se este exemplo n√£o for suficiente, existem mais 5 similares. <br><ul><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do '||'  operador :! pTS-&gt; pRT_ALD_0 ||! pTS-&gt; pRT_ALD_0 d3d_svo.cpp 1041 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '&amp;&amp;': m_pRT_AIR_MIN &amp;&amp; m_pRT_AIR_MIN d3d_svo.cpp 1808 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '&amp;&amp;': m_pRT_AIR_MAX &amp;&amp; m_pRT_AIR_MAX d3d_svo.cpp 1819 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '&amp;&amp;': m_pRT_AIR_SHAD &amp;&amp; m_pRT_AIR_SHAD d3d_svo.cpp 1830 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '&amp;&amp;': s_pPropertiesPanel &amp;&amp; s_pPropertiesPanel entityobject.cpp 1700 </li></ul><br>  E como prometi, aqui est√° uma lista dos avisos restantes da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V501</a> sem exemplos de c√≥digo: <div class="spoiler">  <b class="spoiler_title">Expandir lista</b> <div class="spoiler_text"><ul><li>  V501 Existem sub-express√µes id√™nticas 'MaxX &lt;0' √† esquerda e √† direita da '||'  operador.  czbufferculler.h 128 </li><li>  V501 Existem sub-express√µes id√™nticas 'm_joints [op [1]]. Limita [1] [i]' √† esquerda e √† direita do operador '-'.  articulatedentity.cpp 795 </li><li>  V501 Existem sub-express√µes id√™nticas 'm_joints [i] .limits [1] [j]' √† esquerda e √† direita do operador '-'.  articulatedentity.cpp 2044 </li><li>  V501 Existem sub-express√µes id√™nticas 'irect [0] .x + 1 - irect [1] .x &gt;&gt; 31' √† esquerda e √† direita da '|'  operador.  trimesh.cpp 4029 </li><li>  V501 Existem sub-express√µes id√™nticas 'b-&gt; mlen &lt;= 0' √† esquerda e √† direita do '||'  operador.  bstrlib.c 1779 </li><li>  V501 Existem sub-express√µes id√™nticas 'b-&gt; mlen &lt;= 0' √† esquerda e √† direita do '||'  operador.  bstrlib.c 1827 </li><li>  V501 Existem sub-express√µes id√™nticas 'b-&gt; mlen &lt;= 0' √† esquerda e √† direita do '||'  operador.  bstrlib.c 1865 </li><li>  V501 Existem sub-express√µes id√™nticas 'b-&gt; mlen &lt;= 0' √† esquerda e √† direita do '||'  operador.  bstrlib.c 1779 </li><li>  V501 Existem sub-express√µes id√™nticas 'b-&gt; mlen &lt;= 0' √† esquerda e √† direita do '||'  operador.  bstrlib.c 1827 </li><li>  V501 Existem sub-express√µes id√™nticas 'b-&gt; mlen &lt;= 0' √† esquerda e √† direita do '||'  operador.  bstrlib.c 1865 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '-': dd - dd finalizingspline.h 669 </li><li>  V501 H√° subexpress√µes id√™nticas 'pVerts [2] - pVerts [3]' √† esquerda e √† direita do operador '^'.  roadrendernode.cpp 307 </li><li>  V501 Existem sub-express√µes id√™nticas '! PGroup-&gt; GetStatObj ()' √† esquerda e √† direita do '||'  operador.  terrain_node.cpp 594 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do '||'  operador: val == 0 ||  val == - 0 xmlcpb_attrwriter.cpp 367 </li><li>  V501 Existem subexpress√µes id√™nticas 'geom_colltype_solid' √† esquerda e √† direita da '|'  operador.  attachmentmanager.cpp 1058 </li><li>  V501 Existem subexpress√µes id√™nticas '(TriMiddle - RMWPosition)' √† esquerda e √† direita da '|'  operador.  modelmesh.cpp 174 </li><li>  V501 Existem subexpress√µes id√™nticas '(goal - pAbsPose [b3] .t)' √† esquerda e √† direita do '|'  operador.  posemodifierhelper.cpp 115 </li><li>  V501 Existem subexpress√µes id√™nticas '(goal - pAbsPose [b4] .t)' √† esquerda e √† direita do '|'  operador.  posemodifierhelper.cpp 242 </li><li>  V501 Existem subexpress√µes id√™nticas '(m_eTFSrc == eTF_BC6UH)' √† esquerda e √† direita da '||'  operador.  texturestreaming.cpp 983 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '-': q2.vz - q2.vz azentitynode.cpp 102 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '-': q2.vz - q2.vz entitynode.cpp 107 </li><li>  V501 Existem sub-express√µes id√™nticas 'm_listRect.contains (event-&gt; pos ())' √† esquerda e √† direita da '||'  operador.  aidebuggerview.cpp 463 </li><li>  V501 Existem subexpress√µes id√™nticas √† esquerda e √† direita do operador '&amp;&amp;': pObj-&gt; GetParent () &amp;&amp; pObj-&gt; GetParent () designerpanel.cpp 253 </li></ul></div></div><br><h2>  Sobre a posi√ß√£o da c√¢mera nos jogos </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/564/587/079/5645870792e812044ad7bd3df6fdd2f0.png"></div><br><br>  H√° o segundo diagn√≥stico mais r√°pido no PVS-Studio - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V502</a> .  Esse diagn√≥stico √© mais antigo que algumas novas linguagens de programa√ß√£o, nas quais esse erro n√£o pode mais ser cometido.  E para C ++, esse erro ser√° relevante, talvez sempre. <br><br>  Vamos come√ßar com um pequeno exemplo simples. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V502</a> Talvez o operador '?:' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Funcione de</a> maneira diferente do esperado.  O operador '?:' Tem uma prioridade mais baixa que o operador '+'.  zipencryptor.cpp 217 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ZipEncryptor::ParseKey(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pos = i * <span class="hljs-number"><span class="hljs-number">2</span></span> + (v1 == <span class="hljs-number"><span class="hljs-number">0xff</span></span>) ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>; RCLogError(<span class="hljs-string"><span class="hljs-string">"...."</span></span>, pos); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... }</code> </pre> <br>  A opera√ß√£o de adi√ß√£o tem uma prioridade mais alta que o operador tern√°rio.  Portanto, essa express√£o tem uma l√≥gica de c√°lculo completamente diferente da assumida pelo autor. <br><br>  Voc√™ pode corrigir o erro desta maneira: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pos = i * <span class="hljs-number"><span class="hljs-number">2</span></span> + (v1 == <span class="hljs-number"><span class="hljs-number">0xff</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V502</a> Talvez o operador '?:' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Funcione de</a> maneira diferente do esperado.  O operador '?:' Tem uma prioridade mais baixa que o operador '-'.  3dengine.cpp 1898 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> C3DEngine::GetDistanceToSectorWithWater() { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (bCameraInTerrainBounds &amp;&amp; (m_pTerrain &amp;&amp; m_pTerrain-&gt;GetDistanceToSectorWithWater() &gt; <span class="hljs-number"><span class="hljs-number">0.1f</span></span>)) ? m_pTerrain-&gt;GetDistanceToSectorWithWater() : max(camPostion.z - OceanToggle::IsActive() ? OceanRequest::GetOceanLevel() : GetWaterLevel(), <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); }</code> </pre> <br>  E aqui est√° um c√≥digo de exemplo onde eles trabalham com a posi√ß√£o da c√¢mera.  Um exemplo √© dif√≠cil de perceber com os olhos e h√° um erro nele.  Para publica√ß√£o, a formata√ß√£o do c√≥digo foi alterada, mas no arquivo de origem esse c√≥digo √© ainda mais ileg√≠vel. <br><br>  Existe um erro nesta substring: <br><br><pre> <code class="cpp hljs">camPostion.z - OceanToggle::IsActive() ? .... : ....</code> </pre> <br>  Se a c√¢mera do seu jogo de repente come√ßar a se comportar de forma inadequada, voc√™ deve saber que os desenvolvedores salvaram na an√°lise de c√≥digo est√°tico: <br><br>  Outros exemplos com avisos semelhantes: <br><br><ul><li>  V502 Talvez o operador '?:' Funcione de maneira diferente do esperado.  O operador '?:' Tem uma prioridade mais baixa que o operador '-'.  scriptbind_ai.cpp 5203 </li><li>  V502 Talvez o operador '?:' Funcione de maneira diferente do esperado.  O operador '?:' Tem uma prioridade mais baixa que o operador '+'.  qcolumnwidget.cpp 136 </li><li>  V502 Talvez o operador '?:' Funcione de maneira diferente do esperado.  O operador '?:' Tem uma prioridade mais baixa que o operador '&amp;&amp;'.  shapetool.h 98 </li></ul><br><h2>  CryEngine Legacy </h2><br>  O Amazon Lumberyard √© baseado no c√≥digo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CryEngine</a> .  E n√£o em sua melhor vers√£o.  Eu tirei essa conclus√£o olhando o relat√≥rio do analisador.  Alguns erros encontrados j√° foram corrigidos na vers√£o mais recente do CryEngine para minhas duas revis√µes de c√≥digo, mas ainda est√£o presentes no c√≥digo Lumberyard.  Al√©m disso, no ano passado, o analisador foi significativamente aprimorado e foi poss√≠vel encontrar erros adicionais que agora est√£o presentes em dois mecanismos de jogo.  Mas com Lumberyard a situa√ß√£o √© pior.  A Amazon herdou essencialmente toda a d√≠vida t√©cnica da CryEngine.  Mas seu dever t√©cnico pr√≥prio, √© claro, aparece em cada empresa por conta pr√≥pria :). <br><br>  Nesta se√ß√£o, apresentarei alguns erros que foram corrigidos na vers√£o mais recente do CryEngine e agora permanecem apenas um problema do projeto Lumberyard. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V519</a> A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vari√°vel</a> 'BlendFactor [2]' recebe valores duas vezes sucessivamente.  Talvez isso seja um erro.  Verifique as linhas: 1283, 1284. ccrydxgldevicecontext.cpp 1284 <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/659/fb5/4bb/659fb54bb651df9abf4568dec3b76bf4.png"></div><br><br>  Aproximadamente essas emo√ß√µes ser√£o experimentadas pelos desenvolvedores do Lumberyard quando descobrirem que esse erro permaneceu apenas com eles. <br><br>  A prop√≥sito, existem mais dois: <br><br><ul><li>  V519 A vari√°vel 'm_auBlendFactor [2]' recebe valores atribu√≠dos duas vezes sucessivamente.  Talvez isso seja um erro.  Verifique as linhas: 919, 920. ccrydxgldevicecontext.cpp 920 </li><li>  V519 A vari√°vel 'm_auBlendFactor [2]' recebe valores atribu√≠dos duas vezes sucessivamente.  Talvez isso seja um erro.  Verifique as linhas: 926, 927. ccrydxgldevicecontext.cpp 927 </li></ul><br>  Existe um erro: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V546 O</a> membro de uma classe √© inicializado por si s√≥: 'eConfigMax (eConfigMax.VeryHigh)'.  particleparams.h 1837 <br><br><pre> <code class="cpp hljs">ParticleParams() : .... fSphericalApproximation(<span class="hljs-number"><span class="hljs-number">1.f</span></span>), fVolumeThickness(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>), fSoundFXParam(<span class="hljs-number"><span class="hljs-number">1.f</span></span>), eConfigMax(eConfigMax.VeryHigh), <span class="hljs-comment"><span class="hljs-comment">// &lt;= fFadeAtViewCosAngle(0.f) {}</span></span></code> </pre> <br>  No CryEngine, essa classe geralmente era reescrita, mas aqui o erro de inicializa√ß√£o permanecia. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V521</a> Tais express√µes usando o operador ',' s√£o perigosas.  Verifique se a express√£o '! SWords [iWord] .empty (), iWord ++' est√° correta.  tacticalpointsystem.cpp 3376 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CTacticalPointSystem::Parse(....) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sInput</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sSpec)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MAXWORDS = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sWords[MAXWORDS]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iC = <span class="hljs-number"><span class="hljs-number">0</span></span>, iWord = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; iWord &lt; MAXWORDS; !sWords[iWord].empty(), iWord++) { sWords[iWord] = sInput.Tokenize(<span class="hljs-string"><span class="hljs-string">"_"</span></span>, iC); } .... }</code> </pre> <br>  O ciclo suspeito que o CryEngine j√° reescreveu tamb√©m. <br><br><h2>  Erros vivem mais do que voc√™ pensa </h2><br>  Para os usu√°rios que come√ßam a usar o PVS-Studio pela primeira vez, a situa√ß√£o √© aproximadamente a mesma: eles encontram um erro, descobrem que foi adicionado h√° alguns meses e ficam felizes ao perceber que milagrosamente evitaram a manifesta√ß√£o do problema entre seus usu√°rios.  Muitos de nossos clientes passaram a usar regularmente o PVS-Studio precisamente ap√≥s essas hist√≥rias. <br><br>  √Äs vezes, para iniciar os processos de controle de qualidade de c√≥digo, a empresa deve visitar essas situa√ß√µes v√°rias vezes.  Aqui est√° um exemplo sobre o CryEngine e o Lumberyard: <br><br>  √â poss√≠vel satura√ß√£o da matriz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V557</a> CWE-119.  O √≠ndice 'id' est√° apontando al√©m do limite da matriz.  gameobjectsystem.cpp 113 <br><br><pre> <code class="cpp hljs">uint32 CGameObjectSystem::GetExtensionSerializationPriority(....) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (id &gt; m_extensionInfo.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span>; <span class="hljs-comment"><span class="hljs-comment">// minimum possible priority } else { return m_extensionInfo[id].serializationPriority; } }</span></span></code> </pre> <br>  Como voc√™ sabe, o Amazon Lumberyard n√£o se baseia na vers√£o mais recente do CryEngine.  No entanto, com a ajuda do analisador PVS-Studio, foi poss√≠vel encontrar um erro que est√° presente agora em dois mecanismos de jogo.  Foi necess√°rio verificar o √≠ndice usando o operador '&gt; =' ... <br><br>  O erro de indexa√ß√£o √© s√©rio.  Al√©m disso, existem <b>seis</b> lugares assim <b>!</b>  Aqui est√° outro exemplo: <br><br>  √â poss√≠vel satura√ß√£o da matriz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V557</a> CWE-119.  O √≠ndice 'index' est√° apontando al√©m do limite da matriz.  vehicleseatgroup.cpp 73 <br><br><pre> <code class="cpp hljs">CVehicleSeat* CVehicleSeatGroup::GetSeatByIndex(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> index) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; index &lt;= m_seats.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_seats[index]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; }</code> </pre> <br>  Algu√©m cometeu os erros do mesmo tipo, e eles n√£o foram corrigidos apenas porque n√£o haviam sido inclu√≠dos nas an√°lises de erros do CryEngine. <br><br>  Avisos restantes: <br><br><ul><li>  √â poss√≠vel satura√ß√£o da matriz V557 CWE-119.  O √≠ndice 'id' est√° apontando al√©m do limite da matriz.  gameobjectsystem.cpp 195 </li><li>  √â poss√≠vel satura√ß√£o da matriz V557 CWE-119.  O √≠ndice 'id' est√° apontando al√©m do limite da matriz.  gameobjectsystem.cpp 290 </li><li>  √â poss√≠vel satura√ß√£o da matriz V557 CWE-119.  O √≠ndice 'stateId' est√° apontando al√©m do limite da matriz.  vehicleanimation.cpp 311 </li><li>  √â poss√≠vel satura√ß√£o da matriz V557 CWE-119.  O √≠ndice 'stateId' est√° apontando al√©m do limite da matriz.  vehicleanimation.cpp 354 </li></ul><br>  A longa exist√™ncia de erros no c√≥digo pode ser explicada apenas pelo n√≠vel correspondente de teste do projeto.  Acredita-se que a an√°lise est√°tica encontre erros apenas no c√≥digo n√£o utilizado.  Ent√£o, isso n√£o √© verdade.  Os desenvolvedores esquecem que a maioria dos usu√°rios sofre silenciosamente de bugs n√£o √≥bvios nos programas, e a manifesta√ß√£o desses bugs muito raros geralmente afeta adversamente o trabalho de toda a empresa, a reputa√ß√£o e suas vendas, se houver. <br><br><h2>  Diferentes tons de programa√ß√£o de copiar e colar </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b7b/18c/0d2/b7b18c0d2641836736a2bde2d19ba5ba.png"></div><br><br>  Quando voc√™ chegou a esta se√ß√£o do artigo, provavelmente percebeu que a programa√ß√£o de copiar e colar √© a causa de muitos problemas.  No PVS-Studio, a busca por esses erros √© implementada em v√°rios diagn√≥sticos.  Esta se√ß√£o fornecer√° exemplos de copiar e colar encontrados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V561</a> . <br><br>  Aqui est√° um exemplo de c√≥digo suspeito ao declarar vari√°veis ‚Äã‚Äãcom o mesmo nome em escopos sobrepostos. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V561</a> CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'pLibrary' do que declar√°-lo novamente.  Declara√ß√£o anterior: entityobject.cpp, linha 4703. entityobject.cpp 4706 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CEntityObject::OnMenuConvertToPrefab() { .... IDataBaseLibrary* pLibrary = GetIEditor()-&gt;Get....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pLibrary == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { IDataBaseLibrary* pLibrary = GetIEditor()-&gt;Get....; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pLibrary == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { QString sError = tr(....); CryMessageBox(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } .... }</code> </pre> <br>  O ponteiro pLibrary n√£o substitui conforme o esperado.  A inicializa√ß√£o desse ponteiro foi completamente copiada sob a condi√ß√£o junto com a declara√ß√£o de tipo. <br><br>  Vou listar todos os lugares semelhantes: <br><br><ul><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'eType' do que declar√°-la novamente.  Declara√ß√£o anterior: toglsloperand.c, linha 838. toglsloperand.c 1224 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'eType' do que declar√°-la novamente.  Declara√ß√£o anterior: toglsloperand.c, linha 838. toglsloperand.c 1305 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'rSkelPose' do que declar√°-lo novamente.  Declara√ß√£o anterior: attachmentmanager.cpp, linha 409. attachmentmanager.cpp 458 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'nThreadID' do que declar√°-la novamente.  Declara√ß√£o anterior: d3dmeshbaker.cpp, linha 797. d3dmeshbaker.cpp 867 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'directoryNameList' do que declar√°-lo novamente.  Declara√ß√£o anterior: assetimportermanager.cpp, linha 720. assetimportermanager.cpp 728 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'pNode' do que declar√°-la novamente.  Declara√ß√£o anterior: breakpointsctrl.cpp, linha 340. breakpointsctrl.cpp 349 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'pLibrary' do que declar√°-lo novamente.  Declara√ß√£o anterior: prefabobject.cpp, linha 1443. prefabobject.cpp 1446 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'pLibrary' do que declar√°-lo novamente.  Declara√ß√£o anterior: prefabobject.cpp, linha 1470. prefabobject.cpp 1473 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'cmdLine' do que declar√°-lo novamente.  Declara√ß√£o anterior: fileutil.cpp, linha 110. fileutil.cpp 130 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'sfunctionArgs' do que declar√°-lo novamente.  Declara√ß√£o anterior: attributeitemlogiccallbacks.cpp, linha 291. attributeitemlogiccallbacks.cpp 303 </li><li>  V561 CWE-563 Provavelmente √© melhor atribuir valor √† vari√°vel 'curveName' do que declar√°-la novamente.  Declara√ß√£o anterior: qgradientselectorwidget.cpp, linha 475. qgradientselectorwidget.cpp 488 </li></ul><br>  Uma lista longa ... alguns dos lugares listados s√£o at√© c√≥pias completas do exemplo descrito. <br><br><h2>  Inicializa√ß√£o de autovalor </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54a/3e3/bff/54a3e3bff4ffeeeb75087c52d644eaa6.png"></div><br><br>  No c√≥digo do mecanismo de jogo, muitos locais foram encontrados onde a vari√°vel √© atribu√≠da a si mesma.  Em algum lugar em que esse c√≥digo permaneceu para depura√ß√£o, em algum lugar o c√≥digo foi simplesmente projetado com muito bom gosto (geralmente tamb√©m √© uma fonte de erros); portanto, darei a voc√™ um peda√ßo de c√≥digo que √© mais suspeito para mim. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V570</a> A vari√°vel 'behaviorParams.ignoreOnVehicleDestroyed' √© atribu√≠da a si mesma.  vehiclecomponent.cpp 168 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CVehicleComponent::Init(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!damageBehaviorTable.getAttr(....) { behaviorParams.ignoreOnVehicleDestroyed = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { behaviorParams.ignoreOnVehicleDestroyed = <span class="hljs-comment"><span class="hljs-comment">// &lt;= behaviorParams.ignoreOnVehicleDestroyed; // &lt;= } .... }</span></span></code> </pre> <br>  Na vis√£o atual, a ramifica√ß√£o <i>else</i> n√£o √© necess√°ria.  Mas talvez esse trecho de c√≥digo contenha um erro: eles queriam atribuir o valor oposto √† vari√°vel: <br><br><pre> <code class="cpp hljs">bValue = !bValue</code> </pre> <br>  Mas √© melhor que os desenvolvedores se familiarizem com os resultados desse diagn√≥stico. <br><br><h2>  Manipula√ß√£o de Problemas </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cef/4fe/a30/cef4fea30182004f3debd9467c1e8d16.png"></div><br><br>  Esta se√ß√£o dar√° muitos exemplos quando algo deu errado durante o tratamento de erros. <br><br>  <b>Exemplo 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V606</a> token sem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">propriet√°rio</a> 'nullptr'.  dx12rootsignature.cpp 599 <br><br><pre> <code class="cpp hljs">RootSignature* RootSignatureCache::AcquireRootSignature(....) { .... RootSignature* result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RootSignature(m_pDevice); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!result-&gt;Init(params)) { DX12_ERROR(<span class="hljs-string"><span class="hljs-string">"Could not create root signature!"</span></span>); <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } m_RootSignatureMap[hash] = result; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre> <br>  Esqueceu-se de escrever <i>return nullptr;</i>  .  Agora, o valor inv√°lido da vari√°vel <i>resultante</i> ser√° usado em outra parte do c√≥digo. <br><br>  O mesmo c√≥digo exato foi copiado para mais um local: <br><br><ul><li>  V606 token sem propriet√°rio 'nullptr'.  dx12rootsignature.cpp 621 </li></ul><br>  <b>Exemplo 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V606</a> Token sem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dono</a> 'false'.  fillspacetool.cpp 191 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> FillSpaceTool::FillHoleBasedOnSelectedElements() { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.size() == <span class="hljs-number"><span class="hljs-number">2</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.empty()) { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, iVertexSize(....); i &lt; iVertexSize; ++i) { validEdgeList.push_back(....); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.empty()) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { false; // &lt;= fail } std::vector&lt;BrushEdge3D&gt; linkedEdgeList; std::set&lt;int&gt; usedEdgeSet; linkedEdgeList.push_back(validEdgeList[0]); // &lt;= fail .... }</span></span></code> </pre> <br>  Um exemplo muito interessante de um erro com uma <i>declara√ß√£o de retorno</i> ausente.  Agora √© poss√≠vel acessar o √≠ndice de um cont√™iner vazio. <br><br>  <b>Exemplo 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V564</a> CWE-480 O operador '&amp;' √© aplicado ao valor do tipo bool.  Voc√™ provavelmente esqueceu de incluir par√™nteses ou pretende usar o operador '&amp;&amp;'.  toglslinstruction.c 2914 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetDataTypes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">// Check assumption that both the values which MOVC might pick // have the same basic data type. if(!psContext-&gt;flags &amp; HLSLCC_FLAG_AVOID_TEMP_REGISTER_ALIASING) { ASSERT(GetOperandDataType(psContext, &amp;psInst-&gt;asOperands[2]) == GetOperandDataType(psContext, &amp;psInst-&gt;asOperands[3])); } .... }</span></span></code> </pre> <br>  Verificado incorretamente a presen√ßa de bits no sinalizador.  O operador de nega√ß√£o se aplica ao valor do sinalizador, n√£o √† express√£o inteira.  Escreva corretamente assim: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!(psContext-&gt;flags &amp; ....))</code> </pre> <br>  Mais avisos semelhantes: <br><br><ul><li>  V564 CWE-480 O '|'  O operador √© aplicado ao valor do tipo bool.  Voc√™ provavelmente esqueceu de incluir par√™nteses ou pretende usar o '||'  operador.  d3dhwshader.cpp 1832 </li><li>  V564 CWE-480 O operador '&amp;' √© aplicado ao valor do tipo bool.  Voc√™ provavelmente esqueceu de incluir par√™nteses ou pretende usar o operador '&amp;&amp;'.  trackviewdialog.cpp 2112 </li><li>  V564 CWE-480 O '|'  O operador √© aplicado ao valor do tipo bool.  Voc√™ provavelmente esqueceu de incluir par√™nteses ou pretende usar o '||'  operador.  imagecompiler.cpp 1039 </li></ul><br>  <b>Exemplo 4</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V596</a> CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1491 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; PyGetPrefabLibrarys() { CPrefabManager* pPrefabManager = GetIEditor()-&gt;GetPrefabMa....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!pPrefabManager) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::runtime_error(<span class="hljs-string"><span class="hljs-string">"Invalid Prefab Manager."</span></span>); } .... }</code> </pre> <br>  Erro ao lan√ßar exce√ß√£o.  Era necess√°rio escrever assim: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::runtime_error(<span class="hljs-string"><span class="hljs-string">"Invalid Prefab Manager."</span></span>);</code> </pre> <br>  A lista completa de tais erros: <br><br><ul><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1515 </li><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1521 </li><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1543 </li><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1549 </li><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1603 </li><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1619 </li><li>  V596 CWE-390 O objeto foi criado, mas n√£o est√° sendo usado.  A palavra-chave 'throw' pode estar ausente: throw runtime_error (FOO);  prefabobject.cpp 1644 </li></ul><br><br><h2>  Alguns problemas ao trabalhar com mem√≥ria </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/521/55f/307/52155f307f3824842c324aa99902796e.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V549</a> CWE-688 O primeiro argumento da fun√ß√£o 'memcmp' √© igual ao segundo argumento.  meshutils.h 894 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VertexLess</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.m_links[a].links.size() != m.m_links[b].links.size()) { res = (m.m_links[a].links.size() &lt; m.m_links[b].links.size()) ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : +<span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { res = <span class="hljs-built_in"><span class="hljs-built_in">memcmp</span></span>(&amp;m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>], &amp;m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>]) * m.m_links[a].links.size()); } .... } .... };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A condi√ß√£o compara os tamanhos de dois vetores. </font><font style="vertical-align: inherit;">Se forem iguais, no ramo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> os </font><font style="vertical-align: inherit;">valores dos primeiros elementos dos vetores ser√£o comparados usando a fun√ß√£o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mas o primeiro e o segundo argumentos para essa fun√ß√£o s√£o os mesmos! </font><font style="vertical-align: inherit;">O acesso aos elementos da matriz √© bastante complicado. </font><font style="vertical-align: inherit;">Existem √≠ndices </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Muito provavelmente, um erro de digita√ß√£o est√° neles. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V611</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-762 A mem√≥ria foi alocada usando o operador 'new T []', mas foi liberada usando o operador 'delete'. </font><font style="vertical-align: inherit;">Considere inspecionar este c√≥digo. </font><font style="vertical-align: inherit;">Provavelmente √© melhor usar 'delete [] data;'. </font><font style="vertical-align: inherit;">vectorn.h 102</font></font><br><br><pre> <code class="cpp hljs">~vectorn_tpl() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(flags &amp; mtx_foreign_data)) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>[] data; } } vectorn_tpl&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vectorn_tpl&lt;ftype&gt;&amp; src) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src.len != len &amp;&amp; !(flags &amp; mtx_foreign_data)) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> data; <span class="hljs-comment"><span class="hljs-comment">// &lt;= data = new ftype[src.len]; } .... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A mem√≥ria do</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ponteiro de </font><i><font style="vertical-align: inherit;">dados est√° sendo</font></i><font style="vertical-align: inherit;"> liberada com uma instru√ß√£o inv√°lida. </font><font style="vertical-align: inherit;">O operador </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete []</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deve ser usado em </font><i><font style="vertical-align: inherit;">qualquer lugar</font></i><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C√≥digo inacess√≠vel </font></font></h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V779</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-561 C√≥digo inacess√≠vel detectado. </font><font style="vertical-align: inherit;">√â poss√≠vel que haja um erro. </font><font style="vertical-align: inherit;">fbxskinimporter.cpp 67</font></font><br><br><pre> <code class="cpp hljs">Events::ProcessingResult FbxSkinImporter::ImportSkin(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BuildSceneMeshFromFbxMesh(....) { context.m_createdData.push_back(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(createdData)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Events::ProcessingResult::Success; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { return Events::ProcessingResult::Failure; // &lt;= } context.m_createdData.push_back(); // &lt;= fail return Events::ProcessingResult::Success; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos os ramos da instru√ß√£o condicional terminam com a sa√≠da da fun√ß√£o. </font><font style="vertical-align: inherit;">No entanto, algum c√≥digo n√£o √© executado. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V779</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-561 C√≥digo inacess√≠vel detectado. </font><font style="vertical-align: inherit;">√â poss√≠vel que haja um erro. </font><font style="vertical-align: inherit;">dockablelibrarytreeview.cpp 153</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> DockableLibraryTreeView::Init(IDataBaseLibrary* lib) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_treeView &amp;&amp; m_titleBar &amp;&amp; m_defaultView) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_treeView-&gt;topLevelItemCount() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { ShowTreeView(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ShowDefaultView(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { return false; // &lt;= } emit SignalFocused(this); // &lt;= fail }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â f√°cil detectar um erro neste peda√ßo de c√≥digo. </font><font style="vertical-align: inherit;">Mas se voc√™ escrever o c√≥digo por um longo per√≠odo de tempo, a aten√ß√£o cai drasticamente e esses erros caem facilmente no projeto. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V622</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-478 Considere inspecionar a instru√ß√£o 'switch'. </font><font style="vertical-align: inherit;">√â poss√≠vel que o primeiro operador 'case' esteja ausente. </font><font style="vertical-align: inherit;">datum.cpp 872</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">AZ_INLINE </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsDataGreaterEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type.GetType()) { AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::Number: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IsDataGreaterEqual&lt;Data::NumberType&gt;(lhs, rhs); .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::AABB: AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>, Data::Traits&lt;Data::AABBType&gt;::GetName()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::OBB: AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>, Data::Traits&lt;Data::OBBType&gt;::GetName()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se o </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">switch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiver c√≥digo fora da </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instru√ß√£o case / default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ele nunca ser√° executado.</font></font><br><br><h2>  Conclus√£o </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O artigo inclui </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avisos do analisador, 25 deles com exemplos de c√≥digo. Quanto material existe em todo o relat√≥rio do analisador? Eu rapidamente rolei apenas um </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ter√ßo dos alertas de alto n√≠vel</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . H√° tamb√©m M√©dio e Baixo, um grupo de diagn√≥sticos para busca de otimiza√ß√µes e outras oportunidades inexploradas do analisador - esses s√£o centenas de erros mais √≥bvios e milhares de avisos inexplorados.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ent√£o o leitor precisa se perguntar: ‚Äú√â poss√≠vel, com essa abordagem do projeto, lan√ßar um bom mecanismo de jogo?‚Äù. N√£o h√° controle de qualidade do c√≥digo. O c√≥digo CryEngine com erros antigos foi usado como base, novos erros foram adicionados. O pr√≥prio CryEngine √© finalizado somente ap√≥s a pr√≥xima revis√£o do c√≥digo. A Amazon tem todas as chances, com seus recursos, de trabalhar na dire√ß√£o da qualidade do c√≥digo e liberar o melhor mecanismo de jogo! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o fique muito chateado. Entre os clientes do PVS-Studio, existem mais de trinta outras empresas envolvidas em jogos. Voc√™ pode se familiarizar com eles e seus produtos na p√°gina do nosso site " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clientes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " selecionando o filtro "Desenvolvimento de jogos". Ent√£o, estamos gradualmente melhorando o mundo. Talvez possamos melhorar o Amazon Lumberyard :).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um colega escreveu recentemente um artigo sobre o tema da qualidade do software para jogos. Sugiro que voc√™ esteja interessado em ler: " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An√°lise est√°tica na ind√∫stria de videogames: os 10 principais erros de software</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link para baixar o analisador </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como voc√™ pode ficar sem ele ;-)</font></font><br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ deseja compartilhar este artigo com um p√∫blico que fala ingl√™s, use o link para a tradu√ß√£o: Svyatoslav Razmyslov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Lumberyard: um grito de ang√∫stia</font></font></a> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ leu o artigo e tem uma pergunta?</font></font></b> <div class="spoiler_text">          .      : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">      PVS-Studio,  2015</a> . ,   . </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt416565/">https://habr.com/ru/post/pt416565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt416551/index.html">Teoria da felicidade. A lei da casca de melancia e a normalidade da anormalidade</a></li>
<li><a href="../pt416553/index.html">Como as abordagens para o desenvolvimento de terminais para negocia√ß√£o na bolsa est√£o mudando: 4 tend√™ncias de 2018</a></li>
<li><a href="../pt416555/index.html">Feed de not√≠cias: por que estamos fazendo isso errado?</a></li>
<li><a href="../pt416557/index.html">GitLab 11.0: Lan√ßamento de DevOps autom√°tico e gerenciamento de licen√ßas</a></li>
<li><a href="../pt416561/index.html">A impressora viveu, a impressora est√° viva, a impressora viver√°! Tratamento Canon MG7140</a></li>
<li><a href="../pt416569/index.html">Como o Prius, mas apenas no Linux: pensando em um escrit√≥rio h√≠brido</a></li>
<li><a href="../pt416573/index.html">Enviando email de qualquer endere√ßo</a></li>
<li><a href="../pt416575/index.html">An√°lise de rupturas por supercondutividade dos grandes √≠m√£s de colisor de Hadron no CERN</a></li>
<li><a href="../pt416577/index.html">Resumo do MBLT DEV - atualizado para desenvolvedores do iOS</a></li>
<li><a href="../pt416579/index.html">Controlamos os LEDs usando a API Bluetooth da Web e o Arduino</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>