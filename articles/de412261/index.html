<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📝 👼🏿 🙎🏿 "Alice, mach das Licht an." Sprachsteuerung eines Smart Homes basierend auf openHAB. Ohne Programmierung und SMS 🤰🏼 📴 👉🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="November 2017 wurde die Nummer elf im Kalender angezeigt. Der Verkauf von Aliexpress war in vollem Gange, seine Hände kratzten etwas zu kaufen. Die Wa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Alice, mach das Licht an." Sprachsteuerung eines Smart Homes basierend auf openHAB. Ohne Programmierung und SMS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412261/"><iframe width="560" height="315" src="https://www.youtube.com/embed/bTpH3pVVMG4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  November 2017 wurde die Nummer elf im Kalender angezeigt.  Der Verkauf von Aliexpress war in vollem Gange, seine Hände kratzten etwas zu kaufen.  Die Wahl fiel auf die " <i>Mi-light RGBW LED-Lampe AC86-265V Remote Control Smart Lighting</i> ".  Als Ergebnis wurden zwei Kopien der maximalen Leistung bei 9 Watt und ein MiLight WiFi iBox-Hub-Controller gekauft.  Die Lieferung aus China ließ nicht lange auf sich warten, und 4 Monate später, am 13. März 2018, wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Yandex.Dialogs-Plattform eröffnet</a> (eine Plattform, mit der Entwickler von Drittanbietern dem Sprachassistenten Alice Fähigkeiten hinzufügen können).  Als nächstes lernt Alice, die Beleuchtung (und nicht nur) in Ihrer Wohnung zu steuern, und wir helfen ihr dabei, schrittweise und ohne eine einzige Codezeile. <br><a name="habracut"></a><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Xiaomi Smart Lamp Setup</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installieren Sie openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lichtsteuerung durch openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Externer Zugriff auf openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IFTTT</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alice</a> </li></ol><br><a name="xiaomi"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/n8/ev/wx/n8evwxli9dh4en3ahsny_kmzn-e.jpeg"></div><br><h3>  1. Smart Lamps von Xiaomi einrichten. </h3><br>  Als erstes müssen Sie die Lampensteuerung einrichten, zumindest mithilfe der Anwendung von Xiaomi.  Wenn diese Phase für Sie bestanden ist, können Sie mit der Einrichtung eines Smart-Home-Servers oder sogar direkt mit der Integration von Alice und openHAB fortfahren.  Aber das Wichtigste zuerst.  Die Lampen selbst stellen keine Verbindung zu Ihrem Heimrouter her. Dazu benötigen Sie einen iBox-Hub, der bis zu vier Gruppen von Lichtquellen steuern kann.  Sie müssen es mit dem Netzwerk verbinden und dann die Lampen daran anschließen. <br><br><ol><li>  Wir versorgen die <b>iBox</b> mit <b>Strom,</b> indem wir sie über USB anschließen, beispielsweise an ein Ladegerät für das Telefon. </li><li>  Wenn Sie zum ersten Mal eine Verbindung herstellen, müssen Sie den Hub zurücksetzen. Drücken Sie daher <b>RST</b> . </li><li>  Installieren Sie anschließend die Anwendung von <b>Xiaomi</b> für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">iOS</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android</a> auf dem Telefon.  Stellen Sie sicher, dass das Telefon mit dem WLAN-Heimnetzwerk verbunden ist. </li><li>  Öffnen Sie die <b>Mi-Light 3.0-</b> Anwendung und klicken Sie auf <b>+</b> .  Hier interessiert uns die Registerkarte <b>Smart Link</b> . </li><li>  Geben Sie den Namen und das Kennwort des WLAN-Heimnetzwerks ein, mit dem das Telefon verbunden ist, und es ist geplant, eine Verbindung mit <b>iBox herzustellen</b> . </li><li>  Jetzt sollte Ihre <b>iBox</b> mit dem Netzwerk verbunden sein und die <b>SYS-</b> und <b>LINK-</b> Anzeigen sollten langsam bzw. schnell blinken.  Wenn nicht, drücken Sie erneut <b>RST</b> . </li><li>  Wenn die Anzeigen blinken, klicken Sie in der Anwendung <b>Konfiguration starten</b> . Der Vorgang zum Einrichten der Verbindung für den Hub beginnt. </li><li>  Nach ungefähr zehn Sekunden hört das Blinken auf, dann beginnt <b>SYS</b> langsam wieder zu blinken und <b>LINK</b> bleibt eingeschaltet.  Die Anwendung zeigt <b>Konfiguriert an</b> .  Der Hub ist mit dem Netzwerk verbunden.  Wenn es nicht in der <b>Geräteliste enthalten ist,</b> klicken Sie einfach auf Nach <b>Gerät suchen</b> . </li></ol><br>  Sie können bereits die Farbe und Helligkeit der iBox selbst steuern, aber wir müssen die Lampen anschließen.  Binden Sie dazu die Lampen an eine der vier Zonen, die dem Hub zur Steuerung zur Verfügung stehen. <br><br><ol><li>  Wir öffnen in der Anwendung <b>Mi-Light 3.0</b> aus der Liste des Hubs <b>Mi-Light</b> .  Gehen Sie zum Abschnitt <b>Farben</b> . </li><li>  Wählen Sie oben auf dem Bildschirm eine der Zonen aus und lassen Sie sie <b>Zone1 sein</b> .  Klicken Sie oben rechts auf das Symbol für die Gerätekopplung.  Der <b>Bildschirm LINK / UNLINK</b> mit Anweisungen wird <b>angezeigt</b> . </li><li>  Jetzt konfigurieren wir die Lampen, die wir an <b>Zone1</b> binden möchten, und ihre Verwaltung wird in Zukunft synchron erfolgen.  Um die Helligkeit und Farbe jeder Lampe einzeln zu steuern, müssen sie separaten Zonen zugeordnet werden.  Schalten Sie also die Lampe ein und klicken Sie innerhalb der ersten drei Sekunden in die <b>Link-</b> Anwendung.  Wenn die Lampe dreimal blinkt, ist alles in Ordnung, die Synchronisation war erfolgreich.  Sie können die Lampe steuern. </li></ol><br><div style="text-align:center;"><img height="400" src="https://habrastorage.org/webt/bj/gf/lj/bjgflj6c_5paymroxvyojr-7qpw.jpeg"></div><br>  Grundsätzlich haben Sie zu diesem Zeitpunkt bereits eine Fernbedienung zur Fernsteuerung des Lichts.  Darüber hinaus können Sie Ihr eigenes Lichtsteuersystem schreiben, da das Protokoll für die Kommunikation mit dem Hub seit langem bekannt ist (es war einst unter <i>limitlessled.com/dev</i> verfügbar).  Es gibt fertige Bibliotheken in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PHP</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Javascript</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python</a> .  Die Verwaltung ist jedoch nur über das lokale Netzwerk möglich, was Alice eindeutig nicht ausreicht.  Versuchen wir, dieses Problem zu lösen. <br><br><a name="openhab"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  2. Installieren Sie openHAB </h3><br>  Kurz gesagt, was ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">openHab</a> .  Dies ist ein Open Source Smart Home Management Server.  Entwickelt von der Community, unterstützt die Verwaltung einer Vielzahl von Geräten.  Es gibt einen mobilen Client, es besteht die Möglichkeit, Alexa von Amazon und einen Assistenten von Google zu verwalten.  Geschrieben in Java, basierend auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eclipse SmartHome-</a> Framework.  Damit es auch auf einem Kühlschrank installiert werden kann, ist die Hauptsache, dass die Java Virtual Machine auf diesem Kühlschrank ausgeführt wird.  Installationsanweisungen gelten für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linux</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mac OS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Raspberry Pi</a> , für verschiedene Netzwerkspeicher- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Synology</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">QNAP</a> .  Gehen Sie schnell die erste Option durch. <br><br><ol><li>  Repository-Schlüssel hinzufügen: <br><br><pre><code class="bash hljs">wget -qO - <span class="hljs-string"><span class="hljs-string">'https://bintray.com/user/downloadSubjectPublicKey?username=openhab'</span></span> | sudo apt-key add - sudo apt-get install apt-transport-https</code> </pre> </li><li>  Fügen Sie das Repository selbst hinzu: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'deb https://dl.bintray.com/openhab/apt-repo2 stable main'</span></span> | sudo tee /etc/apt/sources.list.d/openhab2.list</code> </pre> </li><li>  Wir aktualisieren und installieren den Server zusammen mit den Add-Ons: <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get install openhab2 sudo apt-get install openhab2-addons sudo apt-get install openhab2-addons-legacy</code> </pre> </li><li>  Wir richten den automatischen Start des Dienstes nach dem Neustart des Geräts ein und starten ihn: <br><br><pre> <code class="bash hljs">sudo systemctl start openhab2.service sudo systemctl status openhab2.service sudo systemctl daemon-reload sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> openhab2.service</code> </pre> </li><li>  Jetzt warten wir in der Region von <b>15 bis 20 Minuten</b> (dies ist keine Übertreibung, dies ist eine harte Realität mit Witzen über die Geschwindigkeit von Java), während es <code>http://openhab-device:8080</code> Weboberfläche unter der Adresse <code>http://openhab-device:8080</code> . </li><li>  Auf dieser Seite interessieren wir uns für den Artikel <b>Paper UI</b> .  Mit dieser Art von Schnittstelle werden wir in Zukunft arbeiten. </li></ol><br><img src="https://habrastorage.org/webt/t7/7t/4n/t77t4n7ug5blggwf7yyfstz-wd0.png"><br><br><a name="binding"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  3. Lichtsteuerung über openHAB </h3><br>  Wir haben also einen funktionierenden Smart-Home-Server und Lampen von Xiaomi mit der Möglichkeit der Fernsteuerung.  Es ist notwendig, sie zu verbinden.  openHAB unterstützt Bindemittel (Anweisungen zur Steuerung der angeschlossenen Elektronik) für viele Geräte, einschließlich dieser Lampen. <br><br><ol><li>  Gehen Sie zu <b>Add-On</b> → <b>Bindungen</b> . </li><li>  Installieren Sie <b>Milight Binding</b> . </li><li>  Um unser Gerät hinzuzufügen, klicken Sie im Abschnitt <b>Konfiguration</b> → <b>Dinge</b> auf <b>+</b> . </li><li>  Wir wählen <b>Milight Binding</b> , die automatische Suche nach dem Gerät beginnt. </li><li>  Ich habe nichts automatisch gefunden, daher habe ich das " <b>Manuell hinzufügen</b> " manuell hinzugefügt. </li><li>  Wir wählen den <b>iBox / iBox2-</b> Hub aus, der hinzugefügt werden soll. </li><li>  Auf der sich öffnenden Seite müssen Sie die Felder <b>IP</b> und <b>Bridge ID</b> (Mac-Adresse des angeschlossenen Geräts) ausfüllen. Sie finden sie beispielsweise in der Systemsteuerung des Routers (mein Hub ist im Netzwerk mit dem Namen des darin verwendeten HF-LPB100-Moduls registriert).  Hinzufügen. </li><li>  Großartig, <b>iBox / iBox2</b> erscheint jetzt in der Liste der Geräte mit der Aufschrift " <i>Online</i> ". </li><li>  <b>Klicken Sie erneut</b> auf <b>+</b> und wählen Sie <b>Milight Binding</b> , um die Lampen direkt hinzuzufügen. </li><li>  Jetzt müssen Sie nichts mehr von Hand hinzufügen. <b>Wählen Sie</b> einfach eine Gruppe von Lampen aus der Liste aus (in meinem Fall ist dies das <b>Element Rgbww-Farbe (Zone 1)</b> ). </li><li>  Das ausgewählte Element sollte in der Liste der Dinge mit der Aufschrift " <i>Online</i> " erscheinen. <br><br><img src="https://habrastorage.org/webt/lo/1u/pf/lo1upfvlh54rsjnxqbgcuxu389i.png"></li><li>  Geräte sind konfiguriert, jetzt müssen Sie ihnen Steuerelemente hinzufügen.  Klicken Sie dazu auf das neu hinzugefügte Element. </li><li>  Eine Liste der Lampenparameter, die wir fernsteuern können, wird geöffnet.  Klicken Sie auf den blauen Kreis <b>Helligkeit</b> . </li><li>  Wählen Sie als Nächstes das Steuerelement aus, dem wir den Geräteparameter zuordnen möchten, da  Wir haben sie noch nicht. Klicken Sie auf " <b>Neuen Artikel erstellen"</b> . </li><li>  <b>Legen</b> Sie einen beliebigen Namen fest, z. B. <b>Light_Switcher</b> , und ändern Sie den Typ von <b>Dimmer</b> in <b>Switch</b> , weil  Ich muss die Helligkeit der Lampe nicht anpassen, ich möchte sie nur ein- und ausschalten.  Wir ändern einfach die Kategorie in " <b>Licht",</b> sodass das Steuerelement mit einem Symbol im Abschnitt "Steuerung" angezeigt wird.  Klicken Sie auf <b>Link</b> . </li><li>  Gehen Sie zum Abschnitt <b>Steuerung</b> und genießen Sie die Bedienung des <b>Helligkeitsschalters</b> am Gerät. </li></ol><br><br><a name="myopenhab"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  4. Externer Zugriff auf openHAB </h3><br>  Aus Sicherheitsgründen ist nach den oben beschriebenen Manipulationen die Verwaltung des Smart-Home-Servers nur über das lokale Netzwerk möglich.  Dies ist eindeutig nicht genug für unsere Aufgabe.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Es gibt verschiedene Konfigurationsoptionen</a> : Konfigurieren Sie ein VPN für den Zugriff vom Internet auf ein lokales Netzwerk, konfigurieren Sie einen Reverse-Proxy oder verbinden Sie Ihren Server mit dem myopenHAB Cloud-Dienst unter myopenHAB.org.  Da in Russland die Anzahl der Mitarbeiter von Roskomnadzor direkt proportional zur Anzahl der Benutzer von VPN- und Proxyservern ist, werden wir die letztere Option verwenden. <br><blockquote>  Multiplizieren Sie die Dinge nicht unnötig </blockquote><br><ol><li>  Wir registrieren uns auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">myopenHAB-</a> Website, melden uns an und gehen zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://myopenhab.org/account</a> .  Auf dieser Seite interessieren uns zwei Felder: <b>openHAB UUID</b> und <b>openHAB Secret</b> .  Mit ihnen können Sie eine Serververbindung organisieren.  Lassen Sie uns herausfinden, wo wir sie bekommen können. </li><li>  Wir gehen zum <b>PaperUI openHAB-</b> Bedienfeld. </li><li>  Öffnen Sie den Abschnitt <b>Konfiguration</b> → <b>Add-Ons</b> → <b>Sonstiges</b> . </li><li>  Installieren Sie <b>openHAB Cloud Connector</b> . </li><li>  Unter <b>Konfiguration</b> → <b>Dienste</b> sollte das <b>openHAB Cloud-</b> Modul mit dem Modus " <i>Benachrichtigungen &amp; RAS</i> " angezeigt werden. </li><li>  Unter <b>Konfiguration</b> → <b>System</b> → <b>Add-On-Verwaltung muss der</b> Schalter " <i>Acceess Remote Repository</i> " aktiviert sein. </li><li>  Nach der Installation des Addons befinden sich die <b>gesuchten</b> Daten in den Dateien <b>/ var / lib / openhab2 / uuid</b> und <b>/ var / lib / openhab2 / openhabcloud / secret</b> ( <i>Benutzerdaten / uuid</i> und <i>Benutzerdaten / openhabcloud / secret</i> , falls Sie sie nicht aus dem Paket <i>installiert</i> haben).  Wir geben sie in den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kontoeinstellungen</a> auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">myopenHAB ein</a> und klicken auf <b>Aktualisieren</b> .  Wenn alles richtig konfiguriert ist, sollte das Wort " <i>Online</i> " links von Ihrer E-Mail-Adresse erscheinen.  Dies deutet darauf hin, dass der Zugriff auf Ihr Smart Home über das Internet offen ist, <b>Alice es</b> jedoch nicht sofort verwenden kann.  Zuerst müssen Sie das zuvor konfigurierte Gerät von außen zugänglich machen. </li><li>  Gehen Sie zu <b>Konfiguration</b> → <b>Dienste</b> → <b>openHAB Cloud</b> → <b>Konfigurieren</b> . </li><li>  Aktivieren Sie in der Liste <i>Elemente,</i> die <i>Apps wie IFTTT zugänglich gemacht werden sollen,</i> das Kontrollkästchen für die Helligkeitssteuerung und klicken Sie auf <b>Speichern</b> . </li><li>  Nach einer Weile überprüfen wir, ob das ausgewählte Element auf der Seite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">myopenhab.org/items</a> mit dem Status " <i>ON</i> " aufgeführt ist. </li></ol><br><img src="https://habrastorage.org/webt/tf/-a/3g/tf-a3gan7vajtb4qjy_urvu0nim.png"><br><br>  Die Lampensteuerung ist jetzt über das Internet über die openHAB Cloud-API möglich, die die OAuth2-Autorisierung unterstützt.  Leider sind die Kunden im Voraus festgelegt. Dies sind Alexa, Google Assistant und IFTTT.  Alice ist noch nicht in dieser Liste.  Das ist aber kein Problem! <br><br><a name="ifttt"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/3w/q5/0d/3wq50dhkw-rwzok-o3nghgq9ioe.jpeg"></div><br><h3>  5. IFTTT </h3><br><blockquote>  Wenn ja, dann. </blockquote><br>  Ein Dienst, mit dem Sie eine Aktionskette aus mehreren Diensten erstellen können.  Reagieren Sie bedingt mit einer Aktion in einem Dienst, wenn ein Auslöser für ein Ereignis in einem anderen Dienst funktioniert hat.  IFTTT unterstützt eine Vielzahl von Diensten, einschließlich myopenHAB, die uns interessieren.  Aber unterstützt Alice nicht.  Im Allgemeinen kann jeder dort ein Modul für seinen Service erstellen. Zunächst müssen Sie sich an die Verkaufsabteilung wenden und die Höhe Ihrer jährlichen Zahlung zugunsten von IFTTT herausfinden.  Unser Ziel ist es, den Service kostenlos zu nutzen, um Anfragen von Alice an openHAB umleiten zu können. <br><br><ol><li>  Wir registrieren uns auf der Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ifttt.com</a> und gehen zu <b>Applets</b> → <b>New Applet</b> . </li><li>  Nachdem Sie auf <b>+ dies</b> geklickt <b>haben</b> , müssen Sie den Dienst auswählen, bei dem das Ereignis ausgelöst wird.  Weil  <b>Alices</b> Dienst <b>ist nicht</b> auf der Liste, wir müssen etwas auswählen, das Befehle von ihr empfangen kann.  Dies ist ein <b>Webhooks-</b> Dienst.  Klicken Sie auf <b>Verbinden</b> . </li><li>  Wählen Sie als Nächstes den Auslöser " <i>Webanforderung empfangen</i> " aus der Liste mit einem Element aus. </li><li>  Geben Sie den Namen des Ereignisses an, z. B. <b>light_on</b> , und klicken Sie auf <b>Erstellen</b> . </li><li>  Jetzt müssen wir die Antwort auswählen, klicken Sie auf <b>+ das</b> .  Unsere Wahl von <b>openHAB</b> , Stecker. </li><li>  Klicken <b>Sie</b> im folgenden Fenster, der zuvor erwähnten OAuth2-Berechtigung, auf <b>Zulassen</b> . </li><li>  Die einzige Antwort auf den Sendebefehl ist verfügbar. </li><li>  Wählen Sie aus der Dropdown-Liste die Lampensteuerung (z. B. Light_Switcher) aus und geben Sie als Befehl zum Einschalten des Lichts das Wort " <i>ON</i> " an.  Wir schaffen. </li></ol><br>  Zur Überprüfung müssen wir einen Trigger für den Webhooks-Dienst aufrufen.  Wie kann man das machen?  Senden Sie eine POST-Anfrage. <br><br><ol><li>  Wir <b>suchen den Webhooks-</b> Dienst auf der <b>IFTTT-</b> <b>Website</b> und gehen zu der dazugehörigen Dokumentation. </li><li>  Auf der sich öffnenden Seite gibt es einen Befehl, den wir ausführen müssen und der <b>{event}</b> durch <b>light_on ersetzt</b> . </li><li>  Nachdem Sie auf <b>Test It</b> geklickt haben, sollte sich Ihre Lampe einschalten. </li></ol><br>  Es bleibt ein ähnliches Rezept für das Ereignis light_off zu erstellen, das den Befehl OFF an die Lichtsteuerung sendet.  Und dann lehre Alice, diese Auslöser auf unsere Bitte hin aufzurufen. <br><br><img src="https://habrastorage.org/webt/ky/z8/yw/kyz8ywf2mn07hfnfjpzj4jy26i4.png"><br><br><a name="alice"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/ba/ta/tn/batatn8tse9dchznkvkvxqgn98s.jpeg"></div><br><h3>  6. Alice </h3><br>  In meiner Bestellung, in meinem Wunsch, wird Alice das Licht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einschalten,</a> wenn Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yandex.Dialogs-</a> Plattform verwenden.  Die Plattform wurde im März dieses Jahres eröffnet und ermöglicht es jedem, Alice Fähigkeiten hinzuzufügen, indem er den entsprechenden Code schreibt.  Im Moment sind bereits eine Vielzahl von Fähigkeiten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im Katalog enthalten</a> .  Die Entwicklung von Fähigkeiten ist ein Thema für einen separaten Artikel über Habré, und hier haben wir " <i>ohne eine einzige Codezeile</i> ".  Wir werden also die verfügbaren Entwicklungen nutzen. <br><br><ol><li>  Wir installieren die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beta-Version der Yandex-Suchanwendung</a> , die derzeit nur <b>Benutzerfähigkeiten unterstützt</b> . </li><li>  Wir sagen <b>Alice</b> " <i>mach Zauber an</i> ".  Es ist die Fähigkeit von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Zaubersprüchen</b> / <b>Zaubersprüchen,</b></a> die es uns ermöglicht, POST-Anforderungen an <b>IFTTT-</b> Server auszuführen. </li><li>  Klicken Sie auf <b>Hinzufügen</b> und geben Sie die Adresse an, um das Licht des Formulars einzuschalten: <br><br><pre> <code class="bash hljs">https://maker.ifttt.com/trigger/light_on/with/key/{user_id}</code> </pre> </li><li>  Der nächste Schritt ist die Äußerung einer Phrase oder eines Wortes, auf die Alice antwortet, indem sie eine Anfrage an die angegebene Adresse abschließt (meine Alice antwortet „Mach das Licht an“). </li></ol><br>  Wenn Sie jetzt auf die entsprechende Schaltfläche klicken oder den Vorschlag aussprechen, wird die Anfrage von Yandex-Servern an den Skill-Server weitergeleitet, von dort an IFTTT und dann an myopenHAB, das die Daten mit direktem Zugriff auf den Lamp-Hub an Ihre lokale Instanz überträgt und das Licht aufleuchtet.  Wir werden sofort einen ähnlichen Befehl hinzufügen, um die Beleuchtung auszuschalten. <br><br><div style="text-align:center;"><img height="400" src="https://habrastorage.org/webt/xr/5e/nb/xr5enbudszmydm0msmidvavxl_g.jpeg"></div><br>  Sie müssen verstehen, dass es nicht ausreicht, nur Alice einzuschalten und zu sagen, <i>dass Sie das Licht einschalten</i> .  Yandex weiß nichts über unsere Teams für Smart Homes, Daten darüber werden in der Datenbank der Fertigkeit " <i>Zaubersprüche</i> " gespeichert.  Daher müssen Sie die Fertigkeit zuerst aufrufen, indem Sie „ <i>Zaubersprüche einschalten</i> “ sagen, und erst dann das Licht mit Ihrer Stimme ein- und ausschalten. <br><br><h3>  PS </h3><br>  Der Ansatz mit der Integration von Alice und openHAB durch IFTTT schränkt Ihre Vorstellungskraft nicht ein.  Sie können die Fähigkeit " <i>Zaubersprüche</i> " verwenden, um alle Dinge in Ihrer Smart-Home-Stimme zu steuern.  OpenHAB verfügt beispielsweise über Ordner für Samsung SmartTV, mit denen Sie den Ton und die Kanäle des Fernsehgeräts steuern können.  Die Interaktion von Alice und Webhooks ist die Implementierung einer Sprachschnittstelle zu allen IFTTT-Diensten. Mit " <i>Zaubersprüchen</i> " können Sie den Befehl eines dieser Dienste ausführen.  Oder Sie können Alice überhaupt nicht verwenden und Ihr Frontend schreiben, z. B. eine mobile Anwendung, die IFTTT-Anforderungen über dieselben Webhooks ausführt.  Ja, und IFTTT ist nicht erforderlich. Analog dazu können Sie die " <i>Zaubersprüche</i> " so konfigurieren, dass Anforderungen an Ihren Server erfüllt werden. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de412261/">https://habr.com/ru/post/de412261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de412249/index.html">Wissenschaftliche Arbeit ist veraltet; Was erwartet uns als nächstes?</a></li>
<li><a href="../de412251/index.html">Entkomme aus der Hölle. Der gefangene Pilot Devyatayev entführt ein Flugzeug unter der Nase deutscher Raketenmänner</a></li>
<li><a href="../de412253/index.html">Programmschutz über Vk.com</a></li>
<li><a href="../de412255/index.html">Als Fotos des neuen Honor 10. Vergleichen Sie mit Huawei P20 und iPhone 7 Plus</a></li>
<li><a href="../de412259/index.html">In den Vereinigten Staaten wird es eine neue Todesmethode geben: das Einatmen von Stickstoff</a></li>
<li><a href="../de412263/index.html">Funktionsweise des Bewertungssystems für chinesische Bürger: Verbrechen und Strafen</a></li>
<li><a href="../de412265/index.html">Wie World of Tanks VR erstellt wurde und warum es sich als ein völlig anderes Spiel herausstellte</a></li>
<li><a href="../de412267/index.html">Vergessene Apple Game Console</a></li>
<li><a href="../de412269/index.html">Amazon Echo Dot vs. Google Home Mini - welcher Assistent ist besser?</a></li>
<li><a href="../de412271/index.html">Der Triumph und die Tragödie von "Buran"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>