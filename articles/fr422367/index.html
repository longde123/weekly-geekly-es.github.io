<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õπüèº üëë üîÖ Comment restaurer des vid√©os pour Full Throttle Remastered. 2e partie üçÇ üêÄ üêí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans mon post pr√©c√©dent , j'ai expliqu√© comment nous avons extrait le contenu des fichiers FMV source et cr√©√© des outils pour analyser environ 67 Go d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment restaurer des vid√©os pour Full Throttle Remastered. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422367/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1de/374/14c/1de37414cbdd0d9728e11244fd636b5f.png" alt="image"></div><br>  Dans mon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">post</a> pr√©c√©dent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">,</a> j'ai expliqu√© comment nous avons extrait le contenu des fichiers FMV source et cr√©√© des outils pour analyser environ 67 Go d'archives √† la recherche de composants interm√©diaires utilis√©s pour cr√©er FMV.  Ces pi√®ces sont √† la base de la cr√©ation de contenu FMV remasteris√© et ont √©t√© utilis√©es comme ¬´dessins d'assemblage¬ª pour d√©marrer le projet. <br><br>  Comme indiqu√© dans l'article pr√©c√©dent, le workflow de remasterisation est divis√© en trois branches: remasterisation d'images dessin√©es √† la main, remasterisation de mod√®les 3D et remasterisation sonore.  Ci-dessous, je parlerai des fonctionnalit√©s du workflow et des astuces que nous avons utilis√©es pour automatiser la cr√©ation de la partie principale de la vid√©o. <br><a name="habracut"></a><br>  Nous avons augment√© la taille de tous les cadres originaux dessin√©s √† la main pour correspondre √† la r√©solution de 4K (3840x2160).  Compte tenu de l'ajout de la largeur de la sc√®ne refaite et du fait que le jeu √©tait affich√© en pixels non carr√©s, cela signifiait que toutes les ressources remasteris√©es devaient √™tre cr√©√©es dans une r√©solution de 4440x2400 pixels. <br><br>  Nous avons d√©cid√© d'utiliser Adobe Animate pour remasteriser toutes les images FMV dessin√©es √† la main, car nous avions d√©j√† un flux de travail pr√™t √† l'emploi apr√®s avoir d√©velopp√© Day of the Tentacle Remastered.  L'√©quipe d'artistes a bien ma√Ætris√© ce processus, nous n'avons donc pas envisag√© d'autres options. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3e2/b57/098/3e2b57098e68ff84ee833c7b56a3ad35.gif"></div><br>  <em>Exemple de remasterisation d'un cadre dessin√© √† la main</em> <br><br>  Les mod√®les 3D originaux des archives se trouvaient dans 3D Studio version 3. Heureusement, les versions modernes de 3D Studio Max ont pu importer toutes les donn√©es des maillages et des images cl√©s cin√©matographiques √† l'aide d'un autre script d'automatisation.  Apr√®s cela, nous avons converti ce fichier interm√©diaire pour qu'il fonctionne dans Autodesk Maya, o√π les artistes font leur magie de remasterisation. <br><br>  Pour donner un nouveau style aux surfaces des mailles, de nouveaux shaders ont √©t√© appliqu√©s, des textures de haute qualit√© ont √©t√© appliqu√©es et ces mailles ont √©t√© consid√©rablement compl√©t√©es pour donner au mod√®le un aspect plus lisse.  De plus, la fen√™tre d'image a √©t√© √©tendue pour toutes les cam√©ras d'entr√©e vid√©o afin de correspondre √† la r√©solution de travail de 4440x2400 pixels, car la cam√©ra d'origine a √©t√© con√ßue pour un rapport d'aspect plus √©troit. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df9/949/7bd/df99497bdfb6c540ef07e330cb9142b8.gif"></div><br>  <em>Exemple de remasterisation de mod√®les 3D</em> <br><br>  En ce qui concerne l'audio, nous avons r√©ussi √† trouver la plupart des versions originales de haute qualit√©, mais il y avait des exceptions.  Les enregistrements du studio de doublage de langue anglaise ont √©t√© regroup√©s dans des archives, mais le doublage dans d'autres langues, qui a √©t√© engag√© par des partenaires externes, n'√©tait pas disponible pour nous.  De plus, nous avons r√©ussi √† trouver la musique originale de The Gone Jackals, qui √©tait utilis√©e dans FMV.  Certaines versions d'effets sonores (SFX) ont √©t√© remplac√©es par des sons plus "serr√©s" avec un type de son similaire. <br><br>  Vous trouverez ci-dessous un organigramme qui explique en gros comment nous avons trait√© les ressources sources et les avons li√©es au contenu remasteris√©.  Les images vid√©o extraites d'origine (√† l'aide de SanExtract.exe) ont √©t√© utilis√©es comme ¬´source¬ª pour la comparaison avec tous les fichiers de donn√©es d'archives.  Les fichiers manifestes d'archives sont g√©n√©r√©s √† l'aide d'une recherche r√©cursive de toutes les donn√©es d'archives;  ils ont √©t√© utilis√©s pour trouver rapidement tous les fichiers uniques d'un certain type. <br><br>  L'outil SanWrangler a √©t√© utilis√© pour comparer visuellement la ¬´source¬ª d'origine des trames et des donn√©es archiv√©es.  L'utilisateur peut attacher visuellement des fichiers d'archive aux cadres d'origine et les enregistrer en tant que carte de d√©pendance au format XML.  Apr√®s avoir cr√©√© la carte des d√©pendances, il suffisait d'utiliser un script Python pour g√©n√©rer automatiquement des cadres dessin√©s manuellement √† partir des ressources du fichier de ¬´dessin¬ª d'origine, ainsi que des ¬´dessins d'assemblage¬ª pour Maya 3D.  Ces fichiers sont devenus le point de d√©part de l'√©quipe d'artistes, qui a ensuite proc√©d√© √† la remasterisation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2d/fa0/30a/c2dfa030a1899e9fb679ebd17caf1ee2.png"></div><br>  <em>Extraire des ressources originales et cr√©er des ¬´dessins d'assemblage¬ª</em> <br><br>  Ce fut la premi√®re des nombreuses √©tapes qui nous ont permis d'obtenir des versions FMV remasteris√©es pr√™tes √† l'emploi.  Oui, bien s√ªr, nous avons maintenant le point de d√©part de tous les fichiers qui doivent √™tre refaits, mais comment connecter tous ces fragments ensemble? <br><br>  Ci-dessous, je parlerai des m√©thodes d'automatisation utilis√©es dans le flux de production FMV.  Ces m√©thodes peuvent √™tre utilis√©es non seulement pour g√©n√©rer de la JVM et s'appliquent non seulement √† un jeu;  Je pense qu'ils sont assez universels et peuvent √™tre utilis√©s dans de nombreux aspects du d√©veloppement de jeux. <br><br>  Comme la plupart des workflows de cr√©ation graphique, ce processus sera it√©ratif.  Quelque part dans le fichier source, il peut y avoir un bogue qui doit √™tre corrig√© par l'artiste, et parfois il √©tait n√©cessaire de r√©exporter les fichiers d√©pendants des ressources.  Je pense que nous pr√©f√©rerions tous que ce travail soit effectu√© par un ordinateur plut√¥t que par une personne sujette aux erreurs. <br><br>  Nous savions exactement √† quoi devrait ressembler la vid√©o de Full Throttle Remastered et son, nous avons donc juste besoin d'am√©liorer leurs graphismes et leur son.  Toutes les vid√©os devaient correspondre aux originaux, image par image, y compris les chemins de cam√©ra, le volume sonore, le panoramique, etc.  Pour y parvenir, nous devions savoir √† quoi ressemblait le flux de travail de cr√©ation de FMV originaux.  Et ces 67 Go de donn√©es des archives LucasArts contenaient beaucoup d'indices sur la fa√ßon dont tout fonctionnait dans l'original.  Ce fut un excellent d√©but pour nous. <br><br><h1>  Le processus de cr√©ation d'une FMV originale </h1><br>  Cela peut sembler un peu nostalgique, mais je pense qu‚Äôil est important de discuter des aspects de l‚Äôarch√©ologie num√©rique de cette remasterisation des jeux.  En fin de compte, la compr√©hension du processus de cr√©ation de l'original vous permettra de r√©pondre √† de nombreuses questions et de donner des indices sur la fa√ßon dont les ressources se sont transform√©es en r√©sultat final.  Et lors de la cr√©ation de nouveaux FMV refaits, nous devons appliquer les m√™mes transformations √† nos ressources remasteris√©es d'origine afin que le produit fini soit aussi proche que possible de l'original.  Y compris nous avions besoin des √©l√©ments suivants: <br><br><ul><li>  Emplacement des pistes audio sur la timeline </li><li>  Param√®tres de volume et de panoramique pour les pistes audio lors de la lecture dans le jeu </li><li>  Composition d'images et placement de chaque image vid√©o dans le produit fini </li></ul><br>  Un outil appel√© SMUSHFT (SMUSH pour Full Throttle) a permis au cr√©ateur de FMV de placer des ressources vid√©o et audio sur la chronologie, puis d'encoder le film FMV r√©sultant (au format .san), qui a √©t√© lu par le moteur de jeu.  Toutes les vid√©os ont √©t√© divis√©es en une s√©rie d'images qui ont √©t√© coll√©es ensemble pour cr√©er le r√©sultat final.  SMUSHFT a permis √† l'utilisateur de d√©placer visuellement ces ressources le long de la chronologie et, si n√©cessaire, de refaire la vid√©o. <br><br>  Vous ne pouvez pas mentionner que je n'ai pas particip√© √† la cr√©ation du jeu original.  Je ne pouvais que deviner comment les ressources d'origine ont √©t√© cr√©√©es, en √©tudiant les donn√©es archiv√©es et en examinant les formats et les fichiers ex√©cutables contenus dans ces donn√©es.  Il semble que les mod√®les 3D aient √©t√© cr√©√©s dans Autodesk 3D Studio version 3, et les pi√®ces dessin√©es √† la main ont √©t√© cr√©√©es dans DeluxePaint Animation v1.0.  Je ne sais pas non plus √† quelles √©tapes la g√©n√©ration de donn√©es de forme d'onde pour l'audio consistait, mais chaque clip audio utilis√© (au format .sad) contient des informations sur le volume et le panoramique par images cl√©s, utilis√©es pour m√©langer le son pendant le jeu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c03/921/61a/c0392161ae29aa540fe78d7a6485a232.png"></div><br>  <em>Le processus de cr√©ation d'une FMV originale</em> <br><br>  Apr√®s avoir cr√©√© ces parties distinctes du cadre, le processus de combinaison du cadre a √©t√© effectu√©.  Ce processus a combin√© des rendus d'images 3D avec des cadres d'animation dessin√©s √† la main (avec tout le reste), cr√©ant un produit fini utilis√© par l'outil SMUSHFT (fichiers .nut).  Une fois le projet pr√™t pour l'encodage, la vid√©o a √©t√© trait√©e et le r√©sultat final (.san) peut d√©j√† √™tre lu dans le moteur de jeu. <br><br>  SMUSHFT a fait l'encodage final du format de fichier de la vid√©o d'origine (.san), et chaque fichier vid√©o avait un fichier de projet (.pro) qui d√©crivait l'assemblage de la vid√©o (son, vid√©o, emplacement des sous-titres).  Nous voulions extraire ces informations afin de pouvoir g√©n√©rer le fichier de projet Adobe Premiere Pro et l'utiliser pour encoder la version convertie de la vid√©o en r√©solution 4K.  Pour ce faire, nous devions effectuer une r√©tro-ing√©nierie du fichier de projet SMUSHFT. <br><br><h1>  Formats de fichiers d'ing√©nierie inverse </h1><br>  C'est g√©nial d'avoir du code source, car vous pouvez simplement l'√©tudier et comprendre comment le fichier de projet a √©t√© cr√©√© / lu.  Sans code source, vous devez ouvrir le fichier de projet dans un √©diteur hexad√©cimal et analyser les mod√®les √† l'int√©rieur du fichier.  C'est exactement la fa√ßon dont nous avons utilis√© pour extraire le contenu utile du fichier de projet SMUSHFT. <br><br>  Comme nous pouvions ex√©cuter le SMUSHFT d'origine dans DOSBox, nous avons vu l'interface utilisateur du programme, qui nous a donn√© des conseils sur le format de fichier.  Jetez un ≈ìil √† cette capture d'√©cran de l'ouverture du fichier .pro original: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cbb/854/63b/cbb85463b67ad09d81d939f442f9fdc0.png"></div><br>  <em>Exemple de projet SMUSHFT</em> <br><br>  Ici, vous pouvez remarquer ce qui suit: il y a des ressources nomm√©es dans le fichier (2027.NUT, 2027.SAD, IN_06A.NUT, etc.).  Ces ressources nomm√©es sont susceptibles d'afficher des caract√®res ASCII √† l'int√©rieur du fichier.  De plus, il y a des compteurs d'images en haut de la chronologie et √† gauche de la chronologie, il y a un nombre croissant de couches.  Et le dernier - chaque ressource sur la chronologie est situ√©e sur un num√©ro d'image sp√©cifique et a une certaine dur√©e.  Si nous pouvons extraire ces informations des fichiers de projet d'origine, cela nous permettra de savoir o√π placer automatiquement les nouvelles ressources sur la chronologie Adobe Premiere Pro. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3e5/de5/904/3e5de59049c14a72bb8373a0c72b48a0.png"></div><br>  <em>Exemple de projet Adobe Premiere Pro</em> <br><br>  En ouvrant le fichier de projet d'origine dans un √©diteur hexad√©cimal, vous pouvez obtenir des informations assez utiles.  Regardez l'exemple ci-dessus en hexad√©cimal: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5f/008/054/b5f00805485c3d4a8af811c4dc359063.png"></div><br>  <em>Fichier de projet SMUSHFT dans Hex Editor</em> <br><br>  Nous pouvons commencer √† regarder le fichier .pro avec un √©diteur hexad√©cimal (je pr√©f√®re Hexplorer) et essayer de rechercher des mod√®les.  Vous pouvez facilement trouver des ressources nomm√©es au format ASCII avec un octet z√©ro √† la fin.  Environ dans la m√™me zone de m√©moire, il y a un groupe de valeurs stock√©es sous forme de courts m√©trages (entier √† deux octets).  Comparaison des nombres affich√©s dans SMUSHFT avec <br>  Les chiffres du fichier de projet au format hexad√©cimal nous fournissent la base pour convertir correctement le fichier de projet d'origine en un √©diteur vid√©o moderne comme Adobe Premiere Pro. <br><br><h1>  Bo√Æte √† outils d'automatisation </h1><br>  La majeure partie de ce flux de travail a √©t√© automatis√©e et n'a pas n√©cessit√© d'intervention humaine.  L'une des raisons √† cela √©tait que le contenu de toutes les vid√©os √©tait enti√®rement copi√© de l'original;  en fait, nous ne faisions que mettre √† jour le contenu.  Et donc, nous n'avons pratiquement pas eu l'occasion de changer compl√®tement le format FMV.  Nous avions juste besoin de trouver un moyen de recr√©er la vid√©o en utilisant des ressources haute r√©solution, tout en minimisant le temps pass√© sur le produit. <br><br>  Tout d'abord, je dois dire qu'une premi√®re √©tape s√©rieuse avant d'automatiser l'ensemble du processus devrait √™tre une conversation avec une √©quipe de cr√©ateurs de contenu (graphiques et audio).  La raison en est que la plupart des processus d'automatisation exigent que les cr√©ateurs adh√®rent √† un certain ensemble de r√®gles concernant la pr√©paration des projets, l'emplacement des fichiers, les outils utilis√©s, etc.  Dans notre projet, cela signifiait que nous devions discuter des outils pour cr√©er le contenu des images dessin√©es √† la main, des mod√®les 3D et des sons, puis d'un √©diteur vid√©o pour assembler tout cela ensemble.  Il √©tait √©galement n√©cessaire de convenir des parties du flux de travail qui seront effectu√©es manuellement et lesquelles seront automatis√©es. <br><br>  En cons√©quence, nous avons d√©cid√© ce qui suit: <br><br><ul><li>  Les cadres dessin√©s manuellement seront cr√©√©s dans Adobe Animate avec une r√©solution de 4440x2400 pixels. </li><li>  Les mod√®les et animations 3D seront cr√©√©s dans Autodesk Maya et rendus manuellement, √©galement avec une r√©solution de 4440x2400 pixels </li><li>  Les fichiers audio seront cr√©√©s au format .wav avec des param√®tres de 48 KHz et 16 bits </li><li>  Les fragments de la vid√©o seront initialement g√©n√©r√©s automatiquement et l'artiste pourra changer n'importe quelle partie dont il a besoin (√† quelques exceptions pr√®s) </li><li>  Les √©tapes finales de l'assemblage et du codage de la FMV seront automatis√©es </li></ul><br>  Pour rendre les outils aussi automatis√©s que possible, nous avons utilis√© plusieurs m√©thodes.  Python a √©t√© choisi comme la ¬´colle¬ª reliant tout ensemble, car il est bien d√©velopp√© par diverses biblioth√®ques et le code est facile √† √©crire et √† maintenir.  Nous avons √©galement profit√© de son support interne pour les manipulations de fichiers ind√©pendantes de la plateforme (copie, d√©placement, suppression). <br><br><h2>  Python - appeler des fichiers ex√©cutables, obtenir des r√©sultats </h2><br>  La biblioth√®que de sous-processus Python √©tait id√©ale pour nous, car elle vous permet de modifier l'ex√©cution d'autres fichiers ex√©cutables et m√™me d'attendre la fin de leurs t√¢ches.  Il vous permet d'obtenir le code retourn√© par le programme et d'acc√©der au tampon stdout &amp; stderr. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess <span class="hljs-comment"><span class="hljs-comment"># The command to execute command = 'SanExtract.exe -f -i credits.san -o \"C:/output_dir/\" ' # Execute the command via subprocess child = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE) # Wait for process to complete, returns stdout &amp; stderr buffers stdout, stderr = child.communicate() # Retrieve the return code from the process return_code = child.returncode</span></span></code> </pre> <br>  <em>Un exemple d'interaction avec des fichiers ex√©cutables en Python</em> <br><br><h2>  Python - API Win32 </h2><br>  L'API Win32 est tr√®s utile car elle nous a permis de transmettre des messages clavier et souris depuis Windows √† partir d'un script.  Par exemple, vous pouvez cr√©er une fonction qui clique sur la souris dans certaines coordonn√©es X, Y de l'√©cran: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> win32api <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClickXY</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x,y)</span></span></span><span class="hljs-function">:</span></span> win32api.SetCursorPos((x,y)) win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN,x,y,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP,x,y,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  <em>Exemple de simulation de clic de souris Python</em> <br><br>  Vous pouvez m√™me envoyer des √©v√©nements de frappe au clavier (avec ou sans modificateurs): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> win32api <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> win32con <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PressKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code, modifierCode=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> modifierCode: win32api.keybd_event(modifierCode, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) win32api.keybd_event(code, <span class="hljs-number"><span class="hljs-number">0</span></span>, win32con.KEYEVENTF_EXTENDEDKEY | <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">0.021</span></span>) win32api.keybd_event(code, <span class="hljs-number"><span class="hljs-number">0</span></span>, win32con.KEYEVENTF_EXTENDEDKEY | win32con.KEYEVENTF_KEYUP, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> modifierCode: win32api.keybd_event(modifierCode, <span class="hljs-number"><span class="hljs-number">0</span></span>, win32con.KEYEVENTF_KEYUP, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  <em>Exemple de simulation de clavier Python</em> <br><br>  Il existe de nombreuses autres possibilit√©s, mais les exemples ci-dessus ont vraiment aid√© √† atteindre nos objectifs.  Vous pouvez envoyer des √©v√©nements de clavier √† n'importe quel programme actif et il commencera √† les saisir, comme si nous saisissions quelque chose √† partir du clavier, y compris en appuyant sur les touches de raccourci. <br><br><h2>  Python - vision par ordinateur pour cliquer sur les boutons </h2><br>  L'exp√©rience la plus unique a √©t√© l'utilisation de logiciels de vision par ordinateur dans ces outils qui ne pouvaient pas √™tre automatis√©s via des scripts internes.  La plupart des outils modernes prennent en charge les scripts, mais n√©cessitent toujours l'intervention de l'utilisateur.  Par exemple, 3D Studio Max vous permet d'ex√©cuter des fichiers MAXScript √† partir de la ligne de commande.  Dans notre cas, nous ex√©cutons le script pour importer automatiquement le fichier de maillage 3D, apr√®s quoi 3D Studio Max d√©marre automatiquement et affiche la bo√Æte de dialogue Importation de forme, dans laquelle l'utilisateur doit cliquer sur les boutons: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddc/b3e/4f9/ddcb3e4f9a830a8e72d9697eacf19b74.png"></div><br>  <em>Exemple de bo√Æte de dialogue Importation de forme</em> <br><br>  Donc - nous avons √©crit un script pour l'automatisation, et maintenant nous devons nous asseoir devant l'√©cran, en appuyant sur les touches?  Au lieu de rester assis au clavier et d'attendre que la fen√™tre pop-up apparaisse, nous pouvons faire prendre une capture d'√©cran au script, utiliser la liaison OpenCV √† Python pour trouver le mod√®le d'image de bouton et cliquer automatiquement dessus.  Voici √† quoi ressemble le mod√®le d'image pour l'exemple d√©crit ci-dessus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b1e/67c/af3/b1e67caf30b4ea94761063bb6ead063c.png"></div><br>  <em>Mod√®le d'image pour ok_button.png</em> <br><br>  Il convient de noter que le mod√®le d'image contient des fonctionnalit√©s suppl√©mentaires (texte pour ¬´Objet unique¬ª et ¬´Objets multiples¬ª).  Cela nous permet d'obtenir un r√©sultat de recherche plus d√©terministe.  Voici un exemple de script Python utilis√© pour cliquer automatiquement sur un emplacement trouv√© d'un mod√®le d'image: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ImageGrab <span class="hljs-comment"><span class="hljs-comment"># "Constants" TEMPLATE_THRESHOLD = 0.25 CLICK_OFFSET = 20 # Read the template image to search for template_image = cv2.imread('images/ok_button.png', 0) # Screenshot the current desktop and load it to a cv2 format screen = ImageGrab.grab() screen.save('screen.png') screen_image = cv2.imread('screen.png', 0) # Search for the template within the screenshot and retrieve search results match_result = cv2.matchTemplate(screen_image, template_image, cv2.TM_SQDIFF_NORMED) min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(match_result) # If below the threshold, it's likely we know where to click if min_val &lt; TEMPLATE_THRESHOLD: ClickXY(min_loc[0]+CLICK_OFFSET, min_loc[1]+CLICK_OFFSET)</span></span></code> </pre> <br>  <em>Un exemple de clic sur un √©l√©ment d'affichage √† l'aide d'OpenCV, √©crit en Python</em> <br><br>  Tous les exemples ci-dessus sont bas√©s sur Python.  Mais il y a des moments o√π nous avons besoin d'un contr√¥le plus pr√©cis du syst√®me de fen√™tres du syst√®me d'exploitation Windows.  Cela nous a amen√©s √† d√©velopper des outils natifs √† l'aide de l'API Windows Automation. <br><br><h2>  Windows Native (C ++) - API Windows Automation </h2><br>  L'API Windows Automation permet d'acc√©der √† l'ancienne API Microsoft Active Accessibility (MSAA) ainsi qu'√† l'API Microsoft UI Automation.  Vous pouvez en savoir plus √† ce sujet sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page Microsoft</a> . <br><br>  En cons√©quence, nous avons r√©alis√© le fait que nous pouvions faire des demandes √† certains √©l√©ments de l'interface Windows (boutons, champs de texte, onglets, √©l√©ments de menu), savoir o√π ces √©l√©ments sont situ√©s dans l'espace sur l'√©cran et cliquer / interagir avec eux.  Le SDK Windows dispose √©galement d'outils de test qui vous permettent de voir quelles propri√©t√©s sont disponibles.  Ils nous ont permis de comprendre ce qui peut √™tre automatis√© dans chaque programme sp√©cifique. <br><br>  L'application Inspect.exe est tr√®s utile pour afficher la hi√©rarchie de la gestion des fen√™tres de programme;  il fournit une id√©e approximative de l'emplacement des objets tels que les commandes de menu et comment faire r√©f√©rence aux √©l√©ments de fen√™tre √† l'aide d'appels API d'automatisation. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f2/d3f/650/0f2d3f650f30c4982f10d9d31b94c35c.png"></div><br>  <em>Exemple Inspect.exe</em> <br><br>  Apr√®s avoir appris la hi√©rarchie de contr√¥le du programme Windows, vous saurez comment la trouver √† partir de la poign√©e de la fen√™tre principale et apprendre √† cliquer sur diff√©rents √©l√©ments via l'API: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;WinUser.h&gt; #include &lt;UIAutomation.h&gt; // Click on a sub-menu item given the Window &amp; Menu handles. void ClickSubMenu(HWND hwnd, HMENU hmenu, const char *pMenuName) { // Iterate through the menu items of the window int menu_item_count = GetMenuItemCount(hmenu); for(int menu_id = 0; menu_id &lt; menu_item_count; ++menu_id) { char menu_name[MAX_PATH]; int len = GetMenuString(hmenu, menu_id, reinterpret_cast&lt;LPSTR&gt;(&amp;menu_name[0]), sizeof(menu_name), MF_BYPOSITION); // Look for the specific menu you're searching for and click it // Make sure to set the window active before doing it... if(!strcmp(pMenuName, menu_name)) { // now get the rect and click the center RECT rect; BOOL success = GetMenuItemRect(hwnd, hmenu, menu_id, &amp;rect); if(success) { SetActiveWindow(hwnd); POINT point = GetMiddlePoint(rect); SetCursorPos(point.x, point.y); mouse_event(MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_LEFTDOWN, point.x, point.y, 0, 0); mouse_event(MOUSEEVENTF_ABSOLUTE | MOUSEEVENTF_LEFTUP, point.x, point.y, 0, 0); Sleep(DO_TASK_INTERVAL_WAIT_MS); } } } }</span></span></span></span></code> </pre> <br>  <em>Un exemple de pousser un contr√¥le de fen√™tre en C ++</em> <br><br>  Et bien s√ªr, passer des touches √† la fen√™tre active est √©galement simple: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;WinUser.h&gt; #include &lt;UIAutomation.h&gt; // Type the character string to the given window handle static void TypeCharacters(HWND window_handle, const char *pString) { int len = strlen(pString); for(int count = 0; count &lt; len; ++count) { SendMessage(window_handle, WM_CHAR, (WPARAM)pString[count], (LPARAM)0); Sleep(CHARACTER_REPEAT_INTERVAL_MS); } }</span></span></span></span></code> </pre> <br>  <em>Exemple de simulation de clavier C ++</em> <br><br>  Bien s√ªr, ces API ont beaucoup plus de fonctionnalit√©s.  J'ai trouv√© que gr√¢ce √† l'outil Inspect.exe, vous pouvez faire la lumi√®re sur les √©l√©ments de la fen√™tre du programme accessibles. <br><br><h2>  Formats de texte interm√©diaires </h2><br>  Une partie de notre flux de travail consistait √† enregistrer les fichiers sous forme de texte et √† modifier les valeurs dans ces fichiers texte.  Au final, les outils disposent d'une interface utilisateur pour changer l'√©tat des donn√©es auxiliaires.  Et si vous savez ce que devraient √™tre ces donn√©es auxiliaires, il n'est pas n√©cessaire de travailler avec l'outil, il suffit de modifier les donn√©es auxiliaires.  L'astuce consiste √† savoir comment manipuler ces donn√©es de support;  lors du changement de formats de fichiers propri√©taires, cela peut √™tre difficile.  Ce ne serait pas bien si tout le monde avait un simple fichier texte avec lequel vous pouvez travailler? <br><br>  L'astuce consiste √† trouver un moyen de contourner les formats de fichiers propri√©taires utilis√©s par la plupart des outils.  La solution consiste g√©n√©ralement √† utiliser les options d'importation et d'exportation disponibles dans la plupart des outils commerciaux modernes.  Voici quelques exemples: <br><br>  Adobe Premiere Pro enregistre les fichiers dans un format propri√©taire, mais vous pouvez importer / exporter des projets au format XML Final Cut Pro.  Apr√®s avoir export√© au format XML, vous pouvez modifier le XML de la mani√®re dont nous avons besoin et r√©importer le projet dans Adobe Premiere Pro. <br><br>  Un autre exemple est la correction des r√©f√©rences de texture utilis√©es dans le format de maillage 3D obsol√®te d'Autodesk 3D Studio version 3. Lors de l'importation du fichier de maillage d'origine, nous enregistrons le maillage nouvellement converti dans un fichier .fbx interm√©diaire √† l'aide de caract√®res ASCII.  Dans ce format, vous pouvez traiter un fichier texte et remplacer toutes les lignes de liens de texture par les bonnes. <br><br>  Adobe Animate / Flash est assez dr√¥le car il s'av√®re que les fichiers .fla sont en fait des fichiers .zip un peu ¬´cass√©s¬ª.  Sous forme non compress√©e, ils sont stock√©s au format XFL, qui peut faire r√©f√©rence √† d'autres objets XFL (par exemple, des bitmaps) √† partir d'un dossier local.  L'ing√©nieur en chef de Double Fine Oliver Franzke a cr√©√© un script Python modifi√© pour emballer / d√©compresser les fichiers .fla √† l'aide de ZIP afin que nous puissions cr√©er / modifier ces fichiers. <br><br><h1>  Exemples d'utilisation </h1><br><h2>  3D Studio Max </h2><br>  La version moderne de 3D Studio Max a √©t√© utilis√©e pour importer le fichier .prj d'origine dans la sc√®ne et l'enregistrer au format ASCII .fbx.  Pour chaque fichier .prj qui devait √™tre converti, un fichier MaxScript (.ms) a √©t√© g√©n√©r√© automatiquement √† partir du script Python, qui ressemblait √† ceci: <br><br><pre> <code class="bash hljs">importFile <span class="hljs-string"><span class="hljs-string">"G:\FullThrottle_Backup\FullThrottle_SourceAssets\BENBIKE.PRJ"</span></span> <span class="hljs-comment"><span class="hljs-comment">#noPrompt</span></span></code> </pre> <br>  <em>Exemple d'importation d'un mod√®le 3D √† l'aide de MaxScript</em> <br><br>  Apr√®s cela, ce fichier .ms a √©t√© simplement appel√© par la commande Python pour s'ex√©cuter dans 3dsmax.exe: <br><br><pre> <code class="bash hljs">3dsmax.exe -U MAXScript <span class="hljs-string"><span class="hljs-string">"C:\FullThrottleRemastered\import_prj.ms"</span></span></code> </pre> <br>  <em>Un exemple de commande de console pour appeler un fichier ex√©cutable avec le fichier MaxScript sp√©cifi√©</em> <br><br>  Comme mentionn√© ci-dessus, dans ce cas, 3D Studio Max a ouvert une bo√Æte de dialogue sur laquelle vous deviez cliquer.  Le bundle OpenCV avec Python a aid√© √† cliquer sur le bouton dans cette fen√™tre afin que le fichier d'origine soit import√© sans intervention de l'utilisateur.  Apr√®s avoir import√© le fichier, une s√©rie de touches de menu a √©t√© enfonc√©e (√† l'aide de win32api Python) pour lancer un autre fichier MAXScript qui exportait le mod√®le en tant que fichier .fbx au format ASCII.  √âtant donn√© que .fbx a √©t√© enregistr√© en tant que fichier texte normal, toutes les d√©pendances des d√©pendances de texture du mod√®le ont √©t√© remplac√©es par des liens vers des images dans un format moderne.  Ensuite, le fichier .fbx modifi√© a de nouveau √©t√© automatiquement charg√© dans 3DSMax et export√© en tant que fichier .max.  √Ä ce stade, le fichier .max peut √™tre envoy√© √† l'artiste pour un remasterisation. <br><br><h2>  Adobe Animate / Flash </h2><br>  Adobe Animate / Flash a √©t√© utilis√© pour remasteriser toutes les ressources FMV dessin√©es √† la main.  Nous avons pris les cadres originaux dessin√©s √† la main (320x200 pixels) trouv√©s par l'outil SanWrangler et les avons utilis√©s comme ¬´dessins d'assemblage¬ª.  L'√©chelle de l'image a √©t√© agrandie pour s'adapter √† 4440x2400 pixels, apr√®s quoi un fichier .fla a √©t√© g√©n√©r√© automatiquement √† l'aide d'un script Python. <br><br>  Ensuite, il suffisait de g√©n√©rer automatiquement le fichier .fla √† partir de z√©ro, en utilisant notre connaissance du format XFL Adobe Animate / Flash.  Nous avons pu utiliser la trousse d'outils d√©j√† cr√©√©e par Oliver Franzke pour g√©n√©rer des dessins d'assemblage de fichiers d'animation dessin√©s √† la main. <br><br><h2>  Adobe Premiere Pro </h2><br>  L'API Windows Automation nous a vraiment aid√©s √† d√©terminer quels contr√¥les Premiere Pro sont √† l'√©cran.  Dans certains cas, ils n'avaient pas de raccourcis clavier.  Apr√®s avoir re√ßu les coordonn√©es des √©l√©ments du menu, il √©tait n√©cessaire de d√©placer le curseur sur ces coordonn√©es et d'envoyer un √©v√©nement de clic de souris. <br><br>  Tout cela est tr√®s bien, mais certains contr√¥les sont rendus d'autres mani√®res et sont donc invisibles pour l'API Windows Automation.  Pour ce cas, nous avons d√©cid√© d'utiliser un tas d'OpenCV et de Python pour pouvoir utiliser OpenCV dans un environnement de script.  Cela √©tait particuli√®rement utile lorsque vous travaillez avec Adobe Premiere Pro: bien qu'il prenne partiellement en charge les scripts JavaScript, le type de contr√¥le requis n'√©tait pas disponible via l'API. <br><br>  De plus, les fichiers de projet Adobe Premiere Pro sont stock√©s dans un format binaire propri√©taire.  Par cons√©quent, nous ne pouvions pas simplement cr√©er comme par magie le fichier Premiere Pro, mais nous pouvions utiliser la fonction d'importation, qui nous permettait d'importer les donn√©es dans le fichier Final Cut Pro, qui a le format XML.  Il suffisait ensuite de g√©n√©rer le fichier XML correct, de positionner correctement toutes les ressources sur la timeline, puis d'importer automatiquement ce fichier Final Cut Pro .xml pour le convertir au format souhait√©.  Ensuite, nous pourrions mettre les images export√©es dans une file d'attente automatis√©e afin de pouvoir les combiner dans une vid√©o termin√©e. <br><br><h1>  Toutes les √©tapes </h1><br>  Vous trouverez ci-dessous un sch√©ma de principe g√©n√©ralis√© qui montre toutes les parties automatis√©es d'un nouveau flux de travail.  Chaque segment automatis√© est entour√© d'un rectangle arrondi avec des informations suppl√©mentaires sur les techniques d'automatisation utilis√©es. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f26/2c7/7cf/f262c77cf9d06f1fb6828e356ce40cc8.png"></div><br>  <em>Organigramme d'automatisation FMV remasteris√© simplifi√©</em> <br><br>  Vous remarquerez que la plupart du travail avec Adobe Premiere Pro n√©cessite l'utilisation de Python, ainsi que du code Windows natif sp√©cialis√©.  La raison en est la structure complexe des fen√™tres Premiere Pro, ainsi que la n√©cessit√© d'utiliser l'API native Windows Automation pour garantir une interaction correcte avec toutes les fen√™tres enfants d√©pendantes de cette application. <br><br><h1>  Tous ensemble </h1><br>  En utilisant les m√©thodes d√©crites ci-dessus, nous avons pu configurer plusieurs machines d'automatisation pour diviser le travail sur toutes les vid√©os en parties.  En outre, un Slack Bot a √©t√© int√©gr√© au flux de travail pour envoyer des commentaires sur l'automatisation √† notre canal Slack en fonction de l'√©tat des vid√©os passant par le pipeline de traitement, afin que nous sachions quand quelque chose ne va pas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b5/36d/f19/9b536df197475f6235282ac084c2efc8.gif"></div><br>  <em>Exemple d'automatisation d'Adobe Premiere Pro</em> <br><br><h1>  Les probl√®mes auxquels nous sommes confront√©s </h1><br>  Tout cela sonne bien, mais en fait, lors de la mise en ≈ìuvre du projet, nous avons rencontr√© des probl√®mes.  Je ne citerai que les points principaux. <br><br>  1) It√©ration de mixage de l'audio fini.  La remasterisation de tous les fichiers audio a √©t√© effectu√©e progressivement.  Par cons√©quent, lorsque nous avions, par exemple, l'effet sonore ¬´BOOM!¬ª, L'ing√©nieur du son ne savait pas o√π l'ins√©rer dans le mixage audio, il a donc d√ª attendre que la vid√©o soit encod√©e pour d√©couvrir ce qui avait mal tourn√©. <br><br>  2) Stockage de fichiers interm√©diaires non compress√©s.  Les images ont √©t√© stock√©es dans un format non compress√© jusqu'au tout dernier moment de l'encodage dans la vid√©o termin√©e.  Par cons√©quent, il √©tait n√©cessaire de stocker un grand nombre de trames dans le stockage local, dont certaines √©taient stock√©es dans le syst√®me de contr√¥le de version.  Une telle augmentation du volume stock√© √©tait tr√®s perceptible et peut √™tre assez co√ªteuse lors de l'utilisation de certains syst√®mes de contr√¥le de version (nous avons utilis√© Perforce). <br><br>  3) D√©lai d'ex√©cution.  Une partie solide du flux de travail a √©t√© automatis√©e, ce qui a permis aux ing√©nieurs de faire autre chose.  Cependant, le temps n√©cessaire pour cr√©er une vid√©o peut √™tre assez long.  La partie la plus longue est l'encodage des images en r√©solution 4k.  Nous avions des moyens d'√©tudier l'√©tat des ressources √† l'int√©rieur de Perforce pour comprendre quelles √©tapes devaient √™tre ex√©cut√©es √† nouveau, mais cette m√©thode n'√©tait pas aussi divis√©e en parties que nous le souhaiterions. <br><br><h1>  Prochaines √©tapes </h1><br>  Oui, l'article s'est av√©r√© volumineux!  Bien que notre impl√©mentation de ce workflow soit assez sp√©cifique pour le projet, je pense que certaines m√©thodes d'automatisation peuvent √™tre utilis√©es dans le d√©veloppement de n'importe quel jeu.  Apr√®s avoir compris la vid√©o, vous pouvez consid√©rer un sujet connexe - jouer √† FMV pendant l'ex√©cution du jeu.  Cela inclut des probl√®mes tels que l'encodage d'un flux audio multilingue, ainsi que la synchronisation de trame lors de la lecture de FMV d'origine.  Attendez la troisi√®me partie de l'article! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422367/">https://habr.com/ru/post/fr422367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422347/index.html">Migration d'une application r√©elle de MySQL autonome vers le cluster Percona XtraDB</a></li>
<li><a href="../fr422357/index.html">Apprentissage en profondeur pour d√©terminer le style et le genre des peintures</a></li>
<li><a href="../fr422361/index.html">Syndrome d'entreprise</a></li>
<li><a href="../fr422363/index.html">Conf√©rence PyCon Russie 2018: vid√©o de tous les rapports et pr√©sentations</a></li>
<li><a href="../fr422365/index.html">Yandex a d√©pos√© une plainte contre une d√©cision de justice de supprimer les liens vers des contenus pirat√©s</a></li>
<li><a href="../fr422369/index.html">Conception de tableaux de bord pour un site de commerce √©lectronique d'analyse Web. Partie 2: Bulletins √©lectroniques. Tableau de bord strat√©gique</a></li>
<li><a href="../fr422371/index.html">Test du v√©lo √©lectrique Twitter TW-E9L</a></li>
<li><a href="../fr422373/index.html">Nous vous invitons √† des r√©unions open source en septembre (Moscou et Saint-P√©tersbourg)</a></li>
<li><a href="../fr422375/index.html">Les contrats sont diff√©rents, ou ce pour quoi vous vous √™tes inscrit</a></li>
<li><a href="../fr422377/index.html">ESP8266 + FLProg - Param√®tres syst√®me utilisateur et synchronisation avec le serveur de temps exact</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>