<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçü§ù‚Äçüë®üèª üòä ‚òòÔ∏è Informe de Java Virtual Machine Language Summit 2019 üëÉüèæ üíáüèø üë©‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy finaliz√≥ la duod√©cima Cumbre JVM LS . Como de costumbre, fue un evento hardcore con presentaciones t√©cnicas en m√°quinas virtuales y los idiomas qu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Informe de Java Virtual Machine Language Summit 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/JetBrains/blog/462101/"><img src="https://habrastorage.org/webt/nh/xk/cf/nhxkcfgwiztaulvnbccwhxgcpwe.png" align="right" width="250"><br><p>  Hoy finaliz√≥ la duod√©cima Cumbre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JVM LS</a> .  Como de costumbre, fue un evento hardcore con presentaciones t√©cnicas en m√°quinas virtuales y los idiomas que se ejecutan en ellas.  Como de costumbre, la cumbre se celebr√≥ en Santa Clara, en el campus de Oracle.  Como es habitual, hay muchas m√°s personas que desean llegar aqu√≠ que lugares: el n√∫mero de participantes no supera los 120. Como es habitual, no hubo marketing, solo despojos. </p><br><p>  Esta cumbre ya es la tercera para m√≠, y cada vez que la visito con gran placer, a pesar del terrible desfase horario.  Aqu√≠ no solo puede escuchar informes, sino tambi√©n conocer a mejores personas del mundo de JVM, participar en conversaciones informales, hacer preguntas en talleres y, en general, sentirse involucrado en grandes logros. </p><br><p>  Si no asisti√≥ a la cumbre, no importa.  La mayor√≠a de los informes se publican en YouTube casi inmediatamente despu√©s de la cumbre.  En realidad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ya est√°n disponibles</a> .  Para facilitar la navegaci√≥n, describir√© brevemente aqu√≠ todos los informes y talleres a los que logr√© asistir. </p><a name="habracut"></a><br><h1>  29 de julio </h1><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ghadi Shayban - Futuros Clojure</a> </h1><br><p> No se trata de las caracter√≠sticas de la compilaci√≥n futura en el lenguaje <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Clojure</a> , como muchos pensaron, sino simplemente del desarrollo del lenguaje, las complejidades de la generaci√≥n de c√≥digo y los problemas que encuentran.  Por ejemplo, result√≥ que en Clojure es importante anular las variables locales despu√©s del √∫ltimo uso, porque si el encabezado de una lista que se genera de manera perezosa en una variable local, luego de anularla, el recolector de basura no puede recopilar los nodos que ya han sido anulados, y el programa puede bloquearse con OutOfMemory .  En general, el compilador JIT C2 mismo libera las variables despu√©s del √∫ltimo uso, pero el est√°ndar no garantiza esto y, por ejemplo, el int√©rprete HotSpot no. </p><br><p>  Tambi√©n fue interesante aprender sobre la implementaci√≥n del despacho din√°mico de llamadas a funciones.  Tambi√©n aprend√≠ que hasta hace poco, Clojure estaba apuntando a JVM 6 y solo recientemente cambi√© a JVM 8. Ahora los autores del compilador miran invocacionalmente din√°mico. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Alan Bateman y Rickard B√§ckman - Actualizaci√≥n de Project Loom</a> </h1><br><p>  El proyecto Loom es una fibra ligera para Java.  Hace un a√±o, Alan y Ron ya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hablaron</a> sobre este proyecto, y luego parec√≠a que todo iba muy bien y estaba a punto de estar listo.  Sin embargo, este proyecto a√∫n no ha entrado oficialmente en Java y todav√≠a se est√° desarrollando en una bifurcaci√≥n separada del repositorio.  Por supuesto, result√≥ que era necesario resolver muchos detalles. </p><br><p>  Muchas API est√°ndar, desde ReentrantLock.lock hasta Socket.accept, ya est√°n adaptadas para fibras: si dicha llamada se realiza dentro de una fibra, se guardar√° el estado de ejecuci√≥n, la pila se desenrollar√° y el subproceso del sistema operativo se liberar√° para otras tareas hasta que un evento despierte la fibra (por ejemplo, ReentrantLock.unlock).  Sin embargo, por ejemplo, el viejo bloque sincronizado todav√≠a no funciona y, al parecer, no puede funcionar sin una refactorizaci√≥n seria de todo el soporte de sincronizaci√≥n en la JVM.  Otro desbobinado de la pila no funcionar√° si hay marcos nativos en la pila entre el inicio de la fibra y el punto de interrupci√≥n.  En ambos casos, nada explota, pero la fibra no libera el flujo. </p><br><p>  Hay muchas preguntas sobre c√≥mo se compara Fiber con la antigua clase java.lang.Thread.  Hace un a√±o, surgi√≥ la idea de hacer de Fiber una subclase de Thread.  Ahora lo han rechazado y lo convierten en una entidad independiente, porque emular en cada fibra todo el comportamiento de una transmisi√≥n regular es bastante costoso.  En este caso, Thread.currentThread () dentro de la fibra devolver√° el blende generado, y no el hilo real en el que se ejecuta todo.  Pero el inconveniente se comportar√° bastante bien (aunque puede ralentizar el trabajo).  La idea importante es, bajo ninguna circunstancia, transmitir el flujo de medios real en el que se ejecuta la fibra dentro de la fibra.  Esto puede ser peligroso ya que una fibra puede moverse f√°cilmente a otro hilo.  El enga√±o continuar√°. </p><br><p>  Es curioso que los participantes del proyecto ya hayan introducido algunos cambios preparatorios en el repositorio principal de JDK para facilitarles la vida.  Por ejemplo, en Java 13, el m√©todo doPrivileged se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">reescribi√≥</a> desde el c√≥digo nativo completamente en Java, obteniendo un aumento de rendimiento de aproximadamente 50 veces.  ¬øPor qu√© es un proyecto de Loom?  El hecho es que este m√©todo en particular aparece muy a menudo en el medio de la pila, y aunque era nativo, las fibras con esta pila no se detuvieron.  De una forma u otra, el proyecto ya se est√° beneficiando. </p><br><p>  En <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la p√°gina del proyecto,</a> puede leer la documentaci√≥n y descargar el √°rbol fuente, y tambi√©n hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ensamblados binarios</a> que puede tomar y reproducir hoy.  Esperamos que en los pr√≥ximos a√±os todo se integre. </p><br><h1>  Brian Goetz - Taller "Proyecto Amber" </h1><br><p> Paralelamente, se estaba realizando un taller sobre el proyecto Loom, pero fui a Amber.  Aqu√≠ discutimos brevemente los objetivos del proyecto y los principales JEP en los que se est√° trabajando: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">coincidencia de patrones</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">registros</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tipos sellados</a> .  Luego, toda la discusi√≥n se centr√≥ en el tema privado del alcance.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Habl√© sobre esto</a> en la conferencia de Joker el a√±o pasado, en principio, no se dijo nada muy nuevo.  Trat√© de impulsar una idea con tipos de uni√≥n impl√≠citos como <code>if(obj instanceof Integer x || obj instanceof Long x) use(x.longValue())</code> , pero no vi entusiasmo. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jean Christophe Beyler, Arthur Eubanks y Man Cao - Thread Sanitizing para Java</a> </h1><br><p>  En todos los aspectos, un maravilloso proyecto de Google para buscar carreras utilizando datos en forma de lectura y escritura del mismo campo no vol√°til o elemento de matriz de diferentes flujos sin establecer una relaci√≥n de antes.  El proyecto se escribi√≥ originalmente como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un m√≥dulo LLVM</a> para c√≥digo nativo, y ahora se ha adaptado para HotSpot.  Este es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">proyecto oficial de</a> OpenJDK con su lista de correo y repositorio. </p><br><p>  Seg√∫n los autores, la cosa ahora est√° funcionando bastante bien, puedes ensamblar y jugar.  Adem√°s, encuentra las carreras no solo en el c√≥digo Java, sino tambi√©n en el c√≥digo de las bibliotecas nativas.  Las carreras en el c√≥digo de la m√°quina virtual en s√≠ no se buscan, porque todas las primitivas de sincronizaci√≥n se escriben a su manera, y TSan no puede detectarlas.  Seg√∫n los autores, TSan no da falsos positivos. </p><br><p>  El principal problema es el rendimiento.  Ahora solo el int√©rprete est√° instrumentado para el c√≥digo Java, respectivamente, la compilaci√≥n JIT est√° completamente deshabilitada y el int√©rprete, que ya es lento, se ralentiza varias veces.  Pero si tiene suficientes recursos (Google tiene, por supuesto, suficientes), ocasionalmente puede manejar sus suites de prueba usando TSan.  Tambi√©n se planea agregar instrumentaci√≥n al JIT, pero esta es una intervenci√≥n mucho m√°s seria en el JVM. </p><br><p>  Alguien pregunt√≥ si deshabilitar la compilaci√≥n JIT no afecta el resultado, porque algunas carreras pueden no aparecer en el int√©rprete.  El orador no descart√≥ esta posibilidad, pero dijo que ya hab√≠an encontrado una gran cantidad de carreras que les tomar√≠a mucho tiempo recoger.  Por lo tanto, tenga cuidado al ejecutar su proyecto bajo TSan: puede descubrir la verdad desagradable. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Brian Goetz - Actualizaci√≥n Valhalla</a> </h1><br><p>  Todos est√°n esperando los tipos de valores en Java, pero nadie sabe cu√°ndo aparecer√°n.  Sin embargo, los movimientos son cada vez m√°s serios.  Ya hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conjuntos binarios de</a> prueba con el hito L2 actual.  En los planes actuales, el Valhalla completo llegar√° al hito L100, pero los autores siguen siendo optimistas y creen que se ha hecho m√°s del dos por ciento. </p><br><p>  Entonces, desde el punto de vista del lenguaje, tenemos clases con el modificador en l√≠nea, que son procesadas de manera especial por la m√°quina virtual.  Las instancias de tales clases se pueden incrustar en otros objetos, y tambi√©n son posibles matrices planas que contienen instancias de clases en l√≠nea.  La instancia no tiene un encabezado, lo que significa que no hay identidad, el c√≥digo hash se calcula por campos, <code>==</code> tambi√©n por campos, un intento de sincronizaci√≥n o <code>Object.wait()</code> en dicha clase generar√° una IllegalMonitorStateException.  Escribir <code>null</code> en una variable de este tipo, por supuesto, no funcionar√°.  Sin embargo, los autores ofrecen una alternativa: si ha declarado un <code>Point</code> clase en l√≠nea, entonces puede declarar un campo o una variable de tipo (¬°sorpresa-sorpresa!) <code>Point?</code>  , y luego habr√° un objeto de pleno derecho en el mont√≥n (como el boxeo) con un encabezado, identidad y <code>null</code> encajar√° all√≠. </p><br><p>  Las preguntas abiertas serias siguen siendo la especializaci√≥n de gen√©ricos y la migraci√≥n de clases existentes (por ejemplo, <code>Optional</code> ) a una clase en l√≠nea para no romper el c√≥digo existente (s√≠, las personas escriben <code>null</code> en variables de tipo <code>Optional</code> ).  Sin embargo, la imagen se cierne y la brecha es visible. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">David Wrighton y Neal Gafter - Tipos de valor en el CLR</a> </h1><br><p>  Me sorprendi√≥ que el mismo Neil Gufter, coautor de los rompecabezas originales de Java, ahora trabaja en Microsoft en tiempo de ejecuci√≥n .Net.  Tambi√©n fue una sorpresa ver un informe sobre el CLR (el llamado tiempo de ejecuci√≥n .Net) en el JVM LS.  Pero familiarizarse con la experiencia de colegas de otros mundos siempre es √∫til.  El informe habla sobre las variedades de referencias y punteros en el CLR, sobre las instrucciones de c√≥digo de bytes utilizadas para los tipos de valor y sobre cu√°n bellamente especializadas est√°n las funciones generalizadas como reducir.  Fue interesante saber que uno de los objetivos de los tipos de valor en .Net es una interoperabilidad con c√≥digo nativo.  Debido a esto, la ubicaci√≥n de los campos en los tipos de valor est√° estrictamente fija y puede proyectarse en una estructura sin transformaciones.  La JVM nunca ha tenido una tarea de este tipo y qu√© hacer con la interoperabilidad nativa: consulte a continuaci√≥n. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Vladimir Ivanov y John Rose - Vectores y los n√∫meros en la JVM</a> </h1><br><p>  Nuevamente actualice <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el informe del a√±o pasado</a> .  Una vez m√°s, la pregunta es por qu√© todav√≠a no han lanzado nada, si hace un a√±o todo se ve√≠a bastante bien. </p><br><p>  Un vector es una colecci√≥n de varios n√∫meros, que en hardware se pueden representar mediante un √∫nico registro de vectores como zmm0 para AVX512.  En los vectores, puede cargar datos de matrices, realizar operaciones en ellos como la multiplicaci√≥n por elementos y devolverlos.  Todas las operaciones para las que hay instrucciones del procesador est√°n intr√≠nsecas en el compilador JIT en estas instrucciones.  El n√∫mero de operaciones es simplemente enorme.  Si falta algo, se usa una implementaci√≥n lenta alternativa.  Idealmente, los objetos intermedios vectoriales no se crean; el an√°lisis de escape funciona.  Todos los algoritmos inform√°ticos est√°ndar est√°n vectorizados con una explosi√≥n, utilizando toda la potencia de su procesador. </p><br><p>  Desafortunadamente, es dif√≠cil para los autores no tener valgalla: el an√°lisis de escape es fr√°gil y podr√≠a no funcionar f√°cilmente.  Estos vectores simplemente deben ser clases en l√≠nea, entonces todos los problemas desaparecer√°n.  No est√° claro si esta API puede incluso lanzarse antes de la primera versi√≥n de Valgalla.  Parece mucho m√°s listo.  Entre los problemas llamados dificultades con el soporte del c√≥digo.  Hay muchas piezas repetidas para diferentes tama√±os de registros y diferentes tipos de datos, por lo que la mayor parte del c√≥digo se genera a partir de plantillas y duele mantenerlo. </p><br><p>  El uso tambi√©n es imperfecto.  No hay sobrecarga del operador en Java, por lo que la matem√°tica se ve fea: en lugar de <code>max(va-vb*42, 0)</code> debe escribir <code>va.lanewise(SUB, vb.lanewise(MUL, 42)).lanewise(MAX, 0)</code> .  Ser√≠a bueno tener acceso a AST lambdas como en C #.  Entonces ser√≠a posible generar una operaci√≥n lambda personalizada como <code>MYOP = binOp((va, vb) -&gt; max(va-vb*42, 0))</code> y usarla. </p><br><h1>  30 de julio </h1><br><p>  El segundo d√≠a pas√≥ bajo la bandera de la compilaci√≥n. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mark Stoodley - ¬°De AOT a JIT y m√°s all√°!</a> </h1><br><p>  Un empleado de IBM, miembro del proyecto JVM OpenJ9, habla sobre su experiencia con la compilaci√≥n JIT y AOT.  Siempre hay problemas: JIT es un inicio lento, porque se est√° calentando;  Costos de CPU para la compilaci√≥n.  AOT: rendimiento sub√≥ptimo debido a la falta de un perfil (es posible crear un perfil, pero no trivialmente y no siempre el perfil durante la compilaci√≥n coincide con el perfil en la ejecuci√≥n), es m√°s dif√≠cil de usar, se vincula a la plataforma de destino, sistema operativo, recolector de basura.  Algunos de los problemas se pueden resolver combinando enfoques: comenzando con el c√≥digo compilado por AOT y luego terminando con JIT.  Una buena alternativa a todo esto es el almacenamiento en cach√© de JIT.  Si tiene muchas m√°quinas virtuales (hola, microservicios), todas recurren a un servicio separado: el compilador JIT (s√≠, JITaaS), donde todo es como un adulto, orquestaci√≥n, equilibrio de carga.  Este servicio compila.  Muy a menudo, puede dar c√≥digo listo para un determinado m√©todo, porque este m√©todo ya se ha compilado en otra JVM.  Esto mejora enormemente el calentamiento, elimina el consumo de recursos de su servicio JVM y, en general, reduce el consumo total de recursos. </p><br><p>  En general, JITaaS podr√≠a ser la pr√≥xima palabra de moda en el mundo JVM.  Desafortunadamente, no entend√≠ si esto podr√≠a jugarse ahora o si todav√≠a es un desarrollo cerrado. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Christian Wimmer - Mejorando la imagen nativa de GraalVM</a> </h1><br><p>  GraalVM Native Image es una aplicaci√≥n Java compilada en c√≥digo nativo que se ejecuta sin JVM (a diferencia de los m√≥dulos compilados utilizando un compilador AOT como jaotc).  M√°s precisamente, esta no es una aplicaci√≥n Java.  Para funcionar correctamente, necesita un mundo cerrado, es decir, todo el c√≥digo debe estar visible en la etapa de compilaci√≥n, no Class.forName.  Puede manejar los reflejos y los m√©todos, pero cuando compila debe indicar espec√≠ficamente qu√© clases y m√©todos se utilizar√°n a trav√©s de la reflexi√≥n. </p><br><p>  Otra cosa divertida es la inicializaci√≥n de clase.  Muchas clases se inicializan durante la compilaci√≥n.  Es decir, sus compiladores calcular√°n sus campos est√°ticos de manera predeterminada y el resultado se escribir√° en la imagen ensamblada, y cuando inicie la aplicaci√≥n, simplemente se leer√°.  Esto es necesario para lograr una mejor calidad de compilaci√≥n: cualquier plegado constante se puede hacer si el compilador conoce los valores de los campos est√°ticos.  Todo est√° bien con JIT, el int√©rprete realiza una inicializaci√≥n est√°tica y luego, conociendo las constantes, puede compilar.  Y al construir una aplicaci√≥n nativa, tienes que enga√±ar.  Esto, por supuesto, conduce a divertidos efectos psicod√©licos.  Por lo tanto, las clases generalmente se inicializan en el orden en que se accede, y durante la compilaci√≥n este orden es desconocido y es posible la inicializaci√≥n en otro.  Si hay referencias circulares entre los inicializadores de clase, puede ver la diferencia en el comportamiento del c√≥digo JVM y en la imagen nativa. </p><br><h1>  Taller Schatzl - Hotspot GC. </h1><br><p>  Solucion√≥ todo el dolor asociado con los recolectores de basura.  Lamentablemente, escuch√© a la mayor√≠a.  Recuerdo que se discuti√≥ el recuerdo de la memoria del sistema operativo, incluido el asqueroso Xmx para todos.  Hay buenas noticias: en Java 13 se agrega una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nueva opci√≥n</a> -XX: SoftMaxHeapSize.  Hasta ahora, solo es compatible con el recopilador ZGC, pero G1 tambi√©n puede ponerse al d√≠a.  Establece un l√≠mite en el tama√±o del mont√≥n, que no debe superarse, excepto en situaciones de emergencia, cuando no funciona de manera diferente.  Por lo tanto, puede establecer un Xmx grande (digamos, igual al tama√±o de toda la RAM) y algunos SoftMaxHeapSize razonables.  Entonces, la JVM se mantendr√° dentro del marco la mayor parte del tiempo, pero en la carga m√°xima todav√≠a no arrojar√° OutOfMemoryError, pero tomar√° m√°s memoria del sistema operativo.  Cuando la carga cae, la memoria volver√°. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mei-Chin Tsai - JIT y AOT en el CLR</a> </h1><br><p>  Microsoft Mei-Chin Tsai habl√≥ sobre las caracter√≠sticas de la compilaci√≥n JIT y AOT en el CLR.  La compilaci√≥n AOT se ha desarrollado para ellos durante mucho tiempo, pero inicialmente (ngen.exe) se llev√≥ a cabo en la plataforma de destino, como la primera vez que se inici√≥ (si tiene Windows, busque los archivos * .ni.dll en la carpeta de Windows).  Los archivos se obtienen dependiendo de la versi√≥n de Windows local e incluso de otras DLL-ek.  En consecuencia, si la dependencia se actualiza, todos los m√≥dulos nativos deben volver a compilarse.  En la segunda generaci√≥n (crossgen), los autores precompilaron aplicaciones y m√≥dulos relativamente independientes de las versiones y dependencias de hardware y sistema operativo.  Esto ralentiz√≥ el c√≥digo porque las llamadas de dependencia ahora ten√≠an que hacerse honestamente virtuales.  Este problema se resolvi√≥ conectando JIT y volviendo a compilar el c√≥digo activo durante la aplicaci√≥n.  Luego hablamos sobre la compilaci√≥n multinivel (en niveles) (parece que en el CLR esto est√° en su infancia, mientras que se ha desarrollado en Java durante al menos diez a√±os) y sobre los planes futuros para hacer que AOT sea verdaderamente multiplataforma. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wei Kuai y Xiaoming Gu: acelerar el rendimiento de JVM con JWarmUp</a> </h1><br><p>  Los colegas de Alibaba presentaron su enfoque al problema de calentamiento de JVM.  Usan la JVM para muchos servicios web.  En principio, un inicio muy r√°pido no es tan importante, porque el equilibrador siempre puede esperar hasta que la m√°quina se inicie y solo entonces comenzar a enviarle solicitudes.  Sin embargo, el problema es que la m√°quina no se calienta sin solicitudes: no se llama al c√≥digo que describe la l√≥gica para procesar las solicitudes, lo que significa que no se compila.  Se compilar√° cuando lleguen las primeras solicitudes, es decir, no importa cu√°nto espere el equilibrador, habr√° un error de rendimiento en las primeras solicitudes.  Anteriormente, intentaron resolver esto lanzando solicitudes falsas al pr√≥ximo servicio antes de enviarle solicitudes reales.  El enfoque es interesante, pero es bastante dif√≠cil generar una secuencia tan falsa que provocar√≠a la compilaci√≥n de todo el c√≥digo necesario. </p><br><p>  Un problema separado es la desoptimizaci√≥n.  En las primeras mil consultas, una <code>if</code> siempre fue a lo largo de la primera rama, el compilador JIT generalmente lanz√≥ la segunda, insertando una trampa de desoptimizaci√≥n all√≠ para reducir el tama√±o del c√≥digo.  Pero la solicitud n√∫mero 1001 fue a la segunda rama, la desoptimizaci√≥n funcion√≥ y todo el m√©todo fue al int√©rprete.  Mientras se compilan las estad√≠sticas nuevamente, mientras el compilador C1 compila el m√©todo, luego el perfil completo del compilador C2, los usuarios experimentar√°n una desaceleraci√≥n.  Y luego, en el mismo m√©todo, otro puede ser desoptimizado, y todo ir√° en uno nuevo. </p><br><p>  JWarmUp resuelve el problema de la siguiente manera.  Durante la primera ejecuci√≥n del servicio, se escribe un registro de compilaci√≥n durante varios minutos: registra qu√© m√©todos se compilaron y la informaci√≥n de perfil necesaria por ramas, tipos, etc. Si este servicio se reinicia, inmediatamente despu√©s del inicio, se inicializan todas las clases del registro y se compilan los m√©todos registrados. teniendo en cuenta el perfil anterior.  Como resultado, el compilador funcionar√° bien al inicio, despu√©s de lo cual el equilibrador comenzar√° a enviar solicitudes a esta JVM.  En este momento, todo el c√≥digo caliente que ya ha sido compilado. </p><br><p>  Vale la pena se√±alar que el problema de inicio r√°pido no se resuelve aqu√≠.  Un lanzamiento puede ser a√∫n m√°s lento porque se compilan muchos m√©todos, algunos de los cuales pueden ser necesarios solo unos minutos despu√©s del lanzamiento.  Pero el registro resulta ser reutilizable: a diferencia de AOT, puede elevar el servicio en una arquitectura diferente o con un recolector de basura diferente y reutilizar el registro anterior. </p><br><p>  Los autores han <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">intentado</a> durante mucho tiempo empujar JWarmUp a OpenJDK.  Hasta ahora sin √©xito, pero el trabajo se est√° moviendo.  Lo principal es que un parche completo es bastante <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">accesible</a> para usted en el servidor de Revisi√≥n de C√≥digo, por lo que puede aplicarlo f√°cilmente a las fuentes de HotSpot y construir el JVM usted mismo con JWarmUp. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Juan Fumero - TornadoVM</a> </h1><br><p>  Este es un trabajo de investigaci√≥n de Manchester, pero los autores afirman que el proyecto ya se ha implementado en algunos lugares.  Tambi√©n es un complemento para OpenJDK, que hace que sea bastante f√°cil transferir cierto c√≥digo Java a GPU, iGPU, FPGA o simplemente paralelizarlo a los n√∫cleos de su procesador.  Para compilar en la GPU, utilizan GraalVM en el que construyeron su backend: TornadoJIT.  Un m√©todo Java escrito correctamente va de forma transparente al dispositivo correspondiente.  Es cierto, dicen que la compilaci√≥n en FPGA puede tomar varias horas, pero si su tarea se considera un mes, entonces por qu√© no.  Algunos puntos de referencia (por ejemplo, la transformada discreta de Fourier) son m√°s de cien veces m√°s r√°pidos que Java, lo que se espera en principio.  El proyecto est√° completamente cargado en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> , donde tambi√©n puede encontrar publicaciones cient√≠ficas sobre el tema. </p><br><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Maurizio Cimadomore - Deconstruyendo Panam√°</a> </h1><br><p>  La misma canci√≥n: un proyecto de larga data, cada presentaci√≥n en la cumbre, hace un a√±o todo parec√≠a bastante listo, pero a√∫n no hab√≠a lanzamiento.  Result√≥ que desde entonces el enfoque ha cambiado. </p><br><p>  La idea del proyecto es una interoperaci√≥n mejorada con c√≥digo nativo.  Todos saben lo doloroso que es usar JNI.  Realmente duele.  El proyecto de Panam√° anula este dolor: el uso de clases Java de jextract se genera a partir de los archivos * .h de la biblioteca nativa, que son bastante convenientes de usar llamando a m√©todos nativos.  En el lado C / C ++, no tiene que escribir una sola l√≠nea.  Adem√°s, todo se volvi√≥ mucho m√°s r√°pido: la sobrecarga en llamadas a Java-&gt; native y native-&gt; Java cay√≥ a veces.  ¬øQu√© m√°s podr√≠as querer? </p><br><p>  Hay un problema que existe desde hace bastante tiempo: la transferencia de matrices de datos a c√≥digo nativo.  Hasta ahora, el m√©todo recomendado es DirectByteBuffer, que tiene muchos problemas.  Uno de los m√°s serios es la vida √∫til no administrada (el b√∫fer desaparecer√° cuando el recolector de basura recoja el objeto Java apropiado).  Debido a este y otros problemas, las personas usan Inseguro, que, con la debida diligencia, puede colocar f√°cilmente toda la m√°quina virtual. </p><br><p>  Esto significa que necesita un nuevo acceso a la memoria normal fuera del mont√≥n de Java.  Asignaci√≥n, accesores estructurados, eliminaci√≥n expl√≠cita.  Accesores estructurados: para que no tenga que calcular los desplazamientos usted mismo si necesita escribir, por ejemplo, <code>struct { byte x; int y; }[5]</code> <code>struct { byte x; int y; }[5]</code>  <code>struct { byte x; int y; }[5]</code> .  En cambio, una vez describe el dise√±o de esta estructura y luego hace, por ejemplo, <code>VarHandle</code> , que puede leer todo <code>x</code> saltando sobre <code>y</code> .  En este caso, por supuesto, siempre debe haber una verificaci√≥n de bordes, como en las matrices Java normales.  Adem√°s, deber√≠a prohibirse el acceso a un √°rea ya cerrada.  Y esto resulta ser una tarea no trivial si queremos mantener el rendimiento en el nivel inseguro y permitir el acceso desde m√∫ltiples hilos.  En resumen, mira el video, muy interesante. </p><br><h1>  Taller: Vladimir Kozlov - Proyecto Metr√≥polis </h1><br><p>  El proyecto Metropolis combina todos los intentos de reescribir partes de la JVM en Java.  Su parte principal hoy es el compilador Graal.  En los √∫ltimos a√±os, se ha desarrollado muy bien y ya se habla de un reemplazo completo para el envejecimiento C2.  Sol√≠a ‚Äã‚Äãhaber un problema de arranque: el grial comenz√≥ lentamente, porque √©l mismo tuvo que ser compilado o interpretado JIT.  Luego apareci√≥ la compilaci√≥n AOT (s√≠, el objetivo principal del proyecto de compilaci√≥n AOT es el arranque del propio grial).  Pero con AOT, el grial consume una porci√≥n decente del mont√≥n de una aplicaci√≥n Java que realmente no quiere compartir su mont√≥n.  Ahora hemos aprendido a convertir el grial en una biblioteca nativa usando Graal Native Image, que finalmente nos permiti√≥ aislar el compilador del mont√≥n general.  Con el rendimiento m√°ximo del c√≥digo compilado por el grial, todav√≠a hay problemas en algunos puntos de referencia.  Por ejemplo, el grial va a la zaga de C2 en intr√≠nseca y vectorizaci√≥n.  Sin embargo, gracias al poderoso an√°lisis de escape y alineaci√≥n, simplemente rompe C2 en el c√≥digo funcional, donde se crean muchos objetos inmutables y muchas funciones peque√±as.  Si escribe en la roca y a√∫n no usa el grial, corra para usar.  Adem√°s, en las √∫ltimas versiones de JDK es bastante trivial hacer un par de claves, todo ya est√° en el kit. </p><br><h1>  31 de julio </h1><br><h1>  Kevin Bourrillion - Anotaciones de nulidad para Java </h1><br><p>  Kevin anunci√≥ un nuevo proyecto, pero pidi√≥ no hablar p√∫blicamente y no publicar una grabaci√≥n de su discurso en YouTube.  Lo siento mucho  ,        . </p><br><h1> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dmitry Petrashko ‚Äî Gradual typing for Ruby at Scale with Sorbet</a> </h1><br><p>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sorbet</a>   (!) Ruby,       Ruby   .  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Stripe</a>         Ruby   , ,    .  ,     . </p><br><h1> Lightning Talks </h1><br><p> -     .   Remi Forax     ,       ,   .    ,      : </p><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1156627887165804544"></twitter-widget><blockquote class="twitter-tweet" data-lang="en_US" data-twitter-extracted-i158236038367778346="true"><p lang="en" dir="ltr"> It's time to remove checked exceptions! <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@RemiForaxOff</a> on <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">#JVMLS</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pic.twitter.com/xElpGTEu3q</a> </p> ‚Äî Tagir Valeev (@tagir_valeev) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">July 31, 2019</a> </blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p>      ,   -     ,   . </p><br><h1> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Erik Meijer ‚Äî Differentiable Programming</a> </h1><br><p>             ML  AI      ,     .     ,    Facebook   ‚Äî        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">getafix</a> , --,       ,   .          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> ,    .  ,    ,        . </p><br><p>    .   .    OpenJDK Committer Workshop. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/462101/">https://habr.com/ru/post/462101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../462083/index.html">Estructuras de datos r√°pidas con ejemplos. Primera parte: lista vinculada</a></li>
<li><a href="../462087/index.html">Prueba de un ama de llaves inteligente (vodka, k√©fir, fotos de otras personas)</a></li>
<li><a href="../462091/index.html">Soluci√≥n de la tarea con pwnable.kr cmd1, cmd2, asm, blukat. Evita el filtrado en Linux. Escribir shellcode con pwntools</a></li>
<li><a href="../462095/index.html">Trabaje con luz y √≥ptica: c√≥mo comenzar una carrera en la universidad: la experiencia de los graduados de cuatro programas de maestr√≠a especializados</a></li>
<li><a href="../462097/index.html">Tour verde claro</a></li>
<li><a href="../462107/index.html">Marat√≥n gratuito "Big Data y superh√©roes: su primera experiencia de an√°lisis de datos"</a></li>
<li><a href="../462109/index.html">Ver casi invisible, tambi√©n en color: una t√©cnica para visualizar objetos a trav√©s de un difusor</a></li>
<li><a href="../462111/index.html">C√≥mo probamos varias bases de datos de series temporales</a></li>
<li><a href="../462113/index.html">Entorno sin culpa: nadie debe escribir c√≥digo de calidad</a></li>
<li><a href="../462115/index.html">Encaja el cielo estrellado en WebGL en 1009 bytes de JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>