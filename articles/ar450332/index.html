<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ท๏ธ ๐ด๐ผ โจ๏ธ ููู ูุชู ุชูููุฐ ุชูุฏูู Witcher 3: ุงูุจุฑู ุ ููู witcher ุ ูุบูุฑูุง ูู ุงูุขุซุงุฑ ๐ช๐ฝ ๐ง ๐ง๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูุฌุฒุก 1. ุงูุณูุณุชุฉ 
 ูู ูุฐุง ุงูุฌุฒุก ุ ุณููุธุฑ ูู ุนูููุฉ ุชูุฏูู ุงูุจุฑู ูู Witcher 3: Wild Hunt. 

 ูุชู ุชูููุฐ ุชุฌุณูุฏ ุงูุจุฑู ูู ููุช ูุชุฃุฎุฑ ููููุงู ุนู ุชุฃุซูุฑ ุณุชุงุฑุฉ ุงููุท...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููู ูุชู ุชูููุฐ ุชูุฏูู Witcher 3: ุงูุจุฑู ุ ููู witcher ุ ูุบูุฑูุง ูู ุงูุขุซุงุฑ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450332/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/abf/ce7/1c4/abfce71c4469b6dcd077723d498c1685.jpg" alt="ุตูุฑุฉ"></div><br><h2 style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 1. ุงูุณูุณุชุฉ </h2><br>  ูู ูุฐุง ุงูุฌุฒุก ุ ุณููุธุฑ ูู ุนูููุฉ ุชูุฏูู ุงูุจุฑู ูู Witcher 3: Wild Hunt. <br><br>  ูุชู ุชูููุฐ ุชุฌุณูุฏ ุงูุจุฑู ูู ููุช ูุชุฃุฎุฑ ููููุงู ุนู ุชุฃุซูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณุชุงุฑุฉ ุงููุทุฑ</a> ุ ูููู ูุง ูุฒุงู ูุญุฏุซ ูู ููุฑ ุงูุชุฌุณูุฏ ุงููุจุงุดุฑ.  ูููู ููุงุญุธุฉ ุงูุจุฑู ูู ูุฐุง ุงูููุฏูู: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/VXt4PEEqV2k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  ุชุฎุชูู ุจุณุฑุนุฉ ูุจูุฑุฉ ุ ูุฐูู ูู ุงูุฃูุถู ูุดุงูุฏุฉ ุงูููุฏูู ุนูุฏ 0.25. <br><br>  ููููู ุฃู ุชุฑู ุฃู ูุฐู ููุณุช ุตูุฑูุง ุซุงุจุชุฉ ุ  ุจูุฑูุฑ ุงูููุช ุ ูุชุบูุฑ ุณุทูุนูุง ููููุงู. <br><br>  ูู ูุงุญูุฉ ุชูุฏูู ุงููุฑูู ุงูุฏูููุฉ ุ ููุงู ุงููุซูุฑ ูู ุฃูุฌู ุงูุชุดุงุจู ูุน ุฑุณู ุณุชุงุฑุฉ ูุทุฑ ูู ุงููุณุงูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุญุงูุงุช ุงููุฒุฌ ููุณูุง (ุงููุฒุฌ ุงูุฅุถุงูู) ูุงูุนูู (ุชูููู ุงููุญุต ุ ูุง ูุชู ุชุณุฌูู ุงูุนูู). <br><a name="habracut"></a><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4ba/7e1/f20/4ba7e1f2075dc128baf8b717eeb3ce92.jpg"></div><br>  <i>ุงููุดูุฏ ุฏูู ุงูุจุฑู</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3dd/37a/e59/3dd37ae5986de4621766f4fc64525906.jpg"></div><br>  <i>ูุดูุฏ ุงูุจุฑู</i> <br><br>  ูู ุญูุซ ููุฏุณุฉ ุงูุจุฑู ุ ูุฅู The Witcher 3 ุนุจุงุฑุฉ ุนู ุดุจูุฉ ุชุดุจู ุงูุฃุดุฌุงุฑ.  ููุซู ูุฐุง ุงููุซุงู ูู ุงูุจุฑู ุงูุดุจูุฉ ุงูุชุงููุฉ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5b7/23c/3dc/5b723c3dc1f934c0f6c14903e2a260cf.jpg"></div><br>  ูุฏููุง ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ููุงููุงุช ุทุจูุนูุฉ.  ูู ูุฐุง ูููุฏ ูู ูุฑุญูุฉ ุชุธููู ููุฉ ุงูุฑุฃุณ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุฑุชูุณ ุดุงุฏุฑ </h3><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฑูุฒ ุชุธููู ููุฉ ุงูุฑุฃุณ ุงููุฌูุนุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs">vs_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer cb1[<span class="hljs-number"><span class="hljs-number">9</span></span>], immediateIndexed dcl_constantbuffer cb2[<span class="hljs-number"><span class="hljs-number">6</span></span>], immediateIndexed dcl_input v0.xyz dcl_input v1.xy dcl_input v2.xyz dcl_input v4.xyzw dcl_input v5.xyzw dcl_input v6.xyzw dcl_input v7.xyzw dcl_output o0.xy dcl_output o1.xyzw dcl_output_siv o2.xyzw, position dcl_temps <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: mov o0.xy, v1.xyxx <span class="hljs-number"><span class="hljs-number">1</span></span>: mov o1.xyzw, v7.xyzw <span class="hljs-number"><span class="hljs-number">2</span></span>: mul r0.xyzw, v5.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].yyyy <span class="hljs-number"><span class="hljs-number">3</span></span>: mad r0.xyzw, v4.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].xxxx, r0.xyzw <span class="hljs-number"><span class="hljs-number">4</span></span>: mad r0.xyzw, v6.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].zzzz, r0.xyzw <span class="hljs-number"><span class="hljs-number">5</span></span>: mad r0.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r0.xyzw <span class="hljs-number"><span class="hljs-number">6</span></span>: mov r1.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">7</span></span>: mad r1.xyz, v0.xyzx, cb2[<span class="hljs-number"><span class="hljs-number">4</span></span>].xyzx, cb2[<span class="hljs-number"><span class="hljs-number">5</span></span>].xyzx <span class="hljs-number"><span class="hljs-number">8</span></span>: dp4 r2.x, r1.xyzw, v4.xyzw <span class="hljs-number"><span class="hljs-number">9</span></span>: dp4 r2.y, r1.xyzw, v5.xyzw <span class="hljs-number"><span class="hljs-number">10</span></span>: dp4 r2.z, r1.xyzw, v6.xyzw <span class="hljs-number"><span class="hljs-number">11</span></span>: add r2.xyz, r2.xyzx, -cb1[<span class="hljs-number"><span class="hljs-number">8</span></span>].xyzx <span class="hljs-number"><span class="hljs-number">12</span></span>: dp3 r1.w, r2.xyzx, r2.xyzx <span class="hljs-number"><span class="hljs-number">13</span></span>: rsq r1.w, r1.w <span class="hljs-number"><span class="hljs-number">14</span></span>: div r1.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r1.w <span class="hljs-number"><span class="hljs-number">15</span></span>: mul r1.w, r1.w, l(<span class="hljs-number"><span class="hljs-number">0.000001</span></span>) <span class="hljs-number"><span class="hljs-number">16</span></span>: mad r2.xyz, v2.xyzx, l(<span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">17</span></span>: mad r1.xyz, r2.xyzx, r1.wwww, r1.xyzx <span class="hljs-number"><span class="hljs-number">18</span></span>: mov r1.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">19</span></span>: dp4 o2.x, r1.xyzw, r0.xyzw <span class="hljs-number"><span class="hljs-number">20</span></span>: mul r0.xyzw, v5.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].yyyy <span class="hljs-number"><span class="hljs-number">21</span></span>: mad r0.xyzw, v4.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].xxxx, r0.xyzw <span class="hljs-number"><span class="hljs-number">22</span></span>: mad r0.xyzw, v6.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].zzzz, r0.xyzw <span class="hljs-number"><span class="hljs-number">23</span></span>: mad r0.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r0.xyzw <span class="hljs-number"><span class="hljs-number">24</span></span>: dp4 o2.y, r1.xyzw, r0.xyzw <span class="hljs-number"><span class="hljs-number">25</span></span>: mul r0.xyzw, v5.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].yyyy <span class="hljs-number"><span class="hljs-number">26</span></span>: mad r0.xyzw, v4.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].xxxx, r0.xyzw <span class="hljs-number"><span class="hljs-number">27</span></span>: mad r0.xyzw, v6.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].zzzz, r0.xyzw <span class="hljs-number"><span class="hljs-number">28</span></span>: mad r0.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r0.xyzw <span class="hljs-number"><span class="hljs-number">29</span></span>: dp4 o2.z, r1.xyzw, r0.xyzw <span class="hljs-number"><span class="hljs-number">30</span></span>: mul r0.xyzw, v5.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].yyyy <span class="hljs-number"><span class="hljs-number">31</span></span>: mad r0.xyzw, v4.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].xxxx, r0.xyzw <span class="hljs-number"><span class="hljs-number">32</span></span>: mad r0.xyzw, v6.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].zzzz, r0.xyzw <span class="hljs-number"><span class="hljs-number">33</span></span>: mad r0.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r0.xyzw <span class="hljs-number"><span class="hljs-number">34</span></span>: dp4 o2.w, r1.xyzw, r0.xyzw <span class="hljs-number"><span class="hljs-number">35</span></span>: ret</code> </pre> <br>  ููุงู ุงูุนุฏูุฏ ูู ุฃูุฌู ุงูุชุดุงุจู ูุน ุณุชุงุฑุฉ ุงููุทุฑ ุชุธููู ููุฉ ุงูุฑุฃุณ ุ ูุฐูู ูู ุฃูุฑุฑ.  ุฃุฑูุฏ ุฃู ุฃุจูู ูู ุงููุฑู ุงูููู ูู ุงูุณุทูุฑ 11-18: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">11</span></span>: add r2.xyz, r2.xyzx, -cb1[<span class="hljs-number"><span class="hljs-number">8</span></span>].xyzx <span class="hljs-number"><span class="hljs-number">12</span></span>: dp3 r1.w, r2.xyzx, r2.xyzx <span class="hljs-number"><span class="hljs-number">13</span></span>: rsq r1.w, r1.w <span class="hljs-number"><span class="hljs-number">14</span></span>: div r1.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r1.w <span class="hljs-number"><span class="hljs-number">15</span></span>: mul r1.w, r1.w, l(<span class="hljs-number"><span class="hljs-number">0.000001</span></span>) <span class="hljs-number"><span class="hljs-number">16</span></span>: mad r2.xyz, v2.xyzx, l(<span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">17</span></span>: mad r1.xyz, r2.xyzx, r1.wwww, r1.xyzx <span class="hljs-number"><span class="hljs-number">18</span></span>: mov r1.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">19</span></span>: dp4 o2.x, r1.xyzw, r0.xyzw</code> </pre> <br>  ุฃููุงู ุ cb1 [8] .xyz ูู ููุถุน ุงููุงููุฑุง ุ ู r2.xyz ูู ุงูููุถุน ูู ุงููุถุงุก ุงูุนุงููู ุ ุฃู ุฃู ุงูุณุทุฑ 11 ูุญุณุจ ุงููุชุฌู ูู ุงููุงููุฑุง ุฅูู ุงูููุถุน ูู ุงูุนุงูู.  ุซู ุฎุทูุท 12-15 ุญุณุงุจ <i>ุงูุทูู (worldPos - cameraPos) * 0.000001.</i> <br><br>  v2.xyz ูู ุงููุชุฌู ุงูุทุจูุนู ููููุฏุณุฉ ุงููุงุฑุฏุฉ.  ููุชุฏ ุงูุณุทุฑ 16 ูู ุงููุงุตู ุงูุฒููู [0-1] ุฅูู ุงููุงุตู ุงูุฒููู [-1 ุ 1]. <br><br>  ุซู ูุชู ุงุญุชุณุงุจ ุงููุฑูุฒ ุงูููุงุฆู ูู ุงูุนุงูู: <br><br>  <i>finalWorldPos = worldPos + length (worldPos - cameraPos) * 0.000001 * normalVector</i> <br>  ุณูููู ููุชุทู ุดูุฑุฉ HLSL ููุฐู ุงูุนูููุฉ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> ... <span class="hljs-comment"><span class="hljs-comment">// final world-space position float3 vNormal = Input.NormalW * 2.0 - 1.0; float lencameratoworld = length( PositionL - g_cameraPos.xyz) * 0.000001; PositionL += vNormal*lencameratoworld; // SV_Posiiton float4x4 matModelViewProjection = mul(g_viewProjMatrix, matInstanceWorld ); Output.PositionH = mul( float4(PositionL, 1.0), transpose(matModelViewProjection) ); return Output;</span></span></code> </pre> <br>  ุชุคุฏู ูุฐู ุงูุนูููุฉ ุฅูู "ุงููุฌุงุฑ" ุตุบูุฑ ููุดุจูุฉ (ูู ุงุชุฌุงู ุงููุชุฌู ุงูุนุงุฏู).  ููุฏ ุฌุฑุจุช ุงุณุชุจุฏุงู 0.000001 ุจุนุฏุฉ ููู ุฃุฎุฑู.  ูููุง ุงููุชุงุฆุฌ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6f1/dca/ddb/6f1dcaddbdcd0f6e3c957cd8d2a1121b.jpg"></div><br>  <i>0.000002</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/609/289/c37/609289c37cea41590ffcb94beebae7e5.jpg"></div><br>  <i>0.000005</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/56a/d36/09c/56ad3609c6bbe28990bc8894b163c50d.jpg"></div><br>  <i>0.00001</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/71b/e90/b04/71be90b04a538e953b4a0ee0d4ce2912.jpg"></div><br>  <i>0.000025</i> <br><br><h3 style=";text-align:right;direction:rtl">  ุจูุณู ุชุธููู </h3><br>  ุญุณููุง ุ ุงูุชุดููุง ุชุธููู ููุฉ ุงูุฑุฃุณ ุ ููุฏ ุญุงู ุงูููุช ุงูุขู ูููุตูู ุฅูู ุฑูุฒ ุงููุฌููุน ูุชุธููู ุงูุจูุณู! <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> ps_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer cb0[<span class="hljs-number"><span class="hljs-number">1</span></span>], immediateIndexed dcl_constantbuffer cb2[<span class="hljs-number"><span class="hljs-number">3</span></span>], immediateIndexed dcl_constantbuffer cb4[<span class="hljs-number"><span class="hljs-number">5</span></span>], immediateIndexed dcl_input_ps linear v0.x dcl_input_ps linear v1.w dcl_output o0.xyzw dcl_temps <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: mad r0.x, cb0[<span class="hljs-number"><span class="hljs-number">0</span></span>].x, cb4[<span class="hljs-number"><span class="hljs-number">4</span></span>].x, v0.x <span class="hljs-number"><span class="hljs-number">1</span></span>: add r0.y, r0.x, l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">2</span></span>: round_ni r0.y, r0.y <span class="hljs-number"><span class="hljs-number">3</span></span>: ishr r0.z, r0.y, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span>: xor r0.y, r0.y, r0.z <span class="hljs-number"><span class="hljs-number">5</span></span>: imul null, r0.z, r0.y, r0.y <span class="hljs-number"><span class="hljs-number">6</span></span>: imad r0.z, r0.z, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">7</span></span>: imad r0.y, r0.y, r0.z, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r0.y, r0.y, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>) <span class="hljs-number"><span class="hljs-number">9</span></span>: round_ni r0.z, r0.x <span class="hljs-number"><span class="hljs-number">10</span></span>: frc r0.x, r0.x <span class="hljs-number"><span class="hljs-number">11</span></span>: add r0.x, -r0.x, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">12</span></span>: ishr r0.w, r0.z, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">13</span></span>: xor r0.z, r0.z, r0.w <span class="hljs-number"><span class="hljs-number">14</span></span>: imul null, r0.w, r0.z, r0.z <span class="hljs-number"><span class="hljs-number">15</span></span>: imad r0.w, r0.w, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">16</span></span>: imad r0.z, r0.z, r0.w, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">17</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r0.z, r0.z, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>) <span class="hljs-number"><span class="hljs-number">18</span></span>: itof r0.yz, r0.yyzy <span class="hljs-number"><span class="hljs-number">19</span></span>: mul r0.z, r0.z, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>) <span class="hljs-number"><span class="hljs-number">20</span></span>: mad r0.y, r0.y, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>), -r0.z <span class="hljs-number"><span class="hljs-number">21</span></span>: mul r0.w, r0.x, r0.x <span class="hljs-number"><span class="hljs-number">22</span></span>: mul r0.x, r0.x, r0.w <span class="hljs-number"><span class="hljs-number">23</span></span>: mul r0.w, r0.w, l(<span class="hljs-number"><span class="hljs-number">3.000000</span></span>) <span class="hljs-number"><span class="hljs-number">24</span></span>: mad r0.x, r0.x, l(<span class="hljs-number"><span class="hljs-number">-2.000000</span></span>), r0.w <span class="hljs-number"><span class="hljs-number">25</span></span>: mad r0.x, r0.x, r0.y, r0.z <span class="hljs-number"><span class="hljs-number">26</span></span>: add r0.y, -cb4[<span class="hljs-number"><span class="hljs-number">2</span></span>].x, cb4[<span class="hljs-number"><span class="hljs-number">3</span></span>].x <span class="hljs-number"><span class="hljs-number">27</span></span>: mad_sat r0.x, r0.x, r0.y, cb4[<span class="hljs-number"><span class="hljs-number">2</span></span>].x <span class="hljs-number"><span class="hljs-number">28</span></span>: mul r0.x, r0.x, v1.w <span class="hljs-number"><span class="hljs-number">29</span></span>: mul r0.yzw, cb4[<span class="hljs-number"><span class="hljs-number">0</span></span>].xxxx, cb4[<span class="hljs-number"><span class="hljs-number">1</span></span>].xxyz <span class="hljs-number"><span class="hljs-number">30</span></span>: mul r0.xyzw, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].wxyz <span class="hljs-number"><span class="hljs-number">31</span></span>: mul o0.xyz, r0.xxxx, r0.yzwy <span class="hljs-number"><span class="hljs-number">32</span></span>: mov o0.w, r0.x <span class="hljs-number"><span class="hljs-number">33</span></span>: ret</code> </pre> <br>  ุฎุจุฑ ุฌูุฏ: ุงูููุฏ ููุณ ุทูููุงู. <br><br>  ุงูุฃุฎุจุงุฑ ุงูุณูุฆุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">3</span></span>: ishr r0.z, r0.y, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span>: xor r0.y, r0.y, r0.z <span class="hljs-number"><span class="hljs-number">5</span></span>: imul null, r0.z, r0.y, r0.y <span class="hljs-number"><span class="hljs-number">6</span></span>: imad r0.z, r0.z, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">7</span></span>: imad r0.y, r0.y, r0.z, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r0.y, r0.y, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>)</code> </pre> <br>  ... ูุง ูู ูู ุดูุกุ <br><br>  ุจุตุฑุงุญุฉ ุ ููุณุช ูุฐู ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ุฑุฃูุช ูููุง ูุทุนุฉ ูู ููุฏ ุงููุฌููุน ูู ุชุธููู Witcher 3.  ููู ุนูุฏูุง ูุงุจูุชู ูููุฑุฉ ุงูุฃููู ุ ููุฑุช: "ูุง ูุฐุง ุจุญู ุงูุฌุญููุ" <br><br>  ูููู ุงูุนุซูุฑ ุนูู ุดูุก ูุดุงุจู ูู ุจุนุถ ุชุธููู TW3 ุงูุฃุฎุฑู.  ูู ุฃุตู ูุบุงูุฑุงุชู ูุน ูุฐู ุงููุทุนุฉ ุ ูุฃููู ููุท ุฅู ุงูุฅุฌุงุจุฉ ุชููู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุถูุถุงุก ุงูุตุญูุญุฉ</a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// For more details see: http://libnoise.sourceforge.net/noisegen/ float integerNoise( int n ) { n = (n &gt;&gt; 13) ^ n; int nn = (n * (n * n * 60493 + 19990303) + 1376312589) &amp; 0x7fffffff; return ((float)nn / 1073741824.0); }</span></span></code> </pre> <br>  ููุง ุชุฑูู ุ ูู ุชุธููู ุจูุณู ูุทูู ุนููู ูุฑุชูู.  ุจุงุณุชุฎุฏุงู ุงูุฃุฏูุฉ ูู ูุฐุง ุงููููุน ุ ูููููุง ุฃู ูููู ููู ูุชู ุชูููุฐ ุงูุถูุถุงุก ุงูุณูุณุฉ ุจุดูู ุตุญูุญ.  ุณูู ุฃุนูุฏ ุฅูู ูุฐุง ูู ุบุถูู ุฏูููุฉ. <br><br>  ุงูุธุฑ ุฅูู ุงูุณุทุฑ 0 - ูุญู ููุง ููุนูููู ุจุงูุงุนุชูุงุฏ ุนูู ุงูุตูุบุฉ ุงูุชุงููุฉ: <br><br>  <i>ุญุฑูุฉ = elapsedTime * animationSpeed โโ+ TextureUV.x</i> <br>  ูุฐู ุงูููู ุ ุจุนุฏ ุงูุชูุฑูุจ ุฅูู ุงูุฌุงูุจ ุงูุณููู ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฑุถูุฉ</a> ) (ุฅุฑุดุงุฏุงุช <i>round_ni</i> ) ูู ุงููุณุชูุจู ุ ุชุตุจุญ ููุงุท ุฅุฏุฎุงู ููุถูุถุงุก ุงูุตุญูุญุฉ.  ุนุงุฏุฉู ูุง ูููู ุจุญุณุงุจ ูููุฉ ุงูุถูุถุงุก ูุงุซููู ูู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุ ุซู ูููู ุจุญุณุงุจ ุงููููุฉ ุงูููุงุฆูุฉ ุงูููุฑุจุฉ ุจููููุง (ุงูุธุฑ ูููุน libnoise ุนูู ุงูููุจ ููุงุทูุงุน ุนูู ุงูุชูุงุตูู). <br><br>  ุญุณููุง ุ ูุฐู ุถูุถุงุก <b>ุนุฏุฏ ุตุญูุญ</b> ุ ูููู ุจุนุฏ ูู ุดูุก ุ ูุฅู ุฌููุน ุงูููู ุงููุฐููุฑุฉ ุณุงุจููุง (ุชูุฑูุจูุง ุฃูุถูุง ูุฃุณูู) ุชุทูู! <br><br>  ูุงุญุธ ุฃูู ูุง ุชูุฌุฏ ุชุนูููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ftoi ููุง</a> .  ุฃูุชุฑุถ ุฃู ุงููุจุฑูุฌูู ูู CD Projekt Red ูุฏ ุงุณุชุฎุฏููุง ูุธููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">HLSL asint</a> ุงูุฏุงุฎููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุ ูุงูุชู ุชููู ุจุชุญููู ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุงุตูุฉ</a> ุงูุนุงุฆูุฉ "reinterpret_cast" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุนุงูููู</a> ูููุท ุตุญูุญ. <br><br>  ูุชู ุญุณุงุจ ูุฒู ุงูุงุณุชููุงุก ูููููุชูู ูู ุงูุฃุณุทุฑ 10-11. <br><br>  <i>ุงูุงุณุชููุงุก ุงููุฒู = 1.0 - ูุงุฑู (ุงูุฑุณูู ุงููุชุญุฑูุฉ) ุ</i> <br>  ูุฐุง ุงูููุฌ ูุณูุญ ููุง ุจุงูุชุญุฑูู ุจูู ุงูููู ูุน ูุฑูุฑ ุงูููุช. <br><br>  ูุฅูุดุงุก ุถูุถุงุก ุณูุณุฉ ุ ูุชู ุชูุฑูุฑ ูุฐุง <b>ุงููุญุฑู ุฅูู</b> ูุธููุฉ <b>SCurve</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s_curve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x2 = x * x; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x3 = x2 * x; <span class="hljs-comment"><span class="hljs-comment">// -2x^3 + 3x^2 return -2.0*x3 + 3.0*x2; }</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/15a/5d0/48e/15a5d048e4fcf9b12c51cad50d7bfc3e.png"></div><br>  <i>ูุธููุฉ Smoothstep [libnoise.sourceforge.net]</i> <br><br>  ุชูุนุฑู ูุฐู ุงูููุฒุฉ ุจุงุณู "ูุงุนู".  ูููู ููุง ุชุฑูู ูู ููุฏ ุงููุฌูุน ุ ูุฐู <b>ููุณุช</b> ูุธููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุนููุฉ</a> ุฏุงุฎููุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">HLSL</a> .  ุชุทุจู ุงููุธููุฉ ุงูุฏุงุฎููุฉ ุงููููุฏ ุจุญูุซ ุชููู ุงูููู ุตุญูุญุฉ.  ูููู ูุธุฑูุง ูุฃููุง ูุนุฑู ุฃู <i>ูุฒู ุงูุงุณุชููุงุก</i> ุณูููู ุฏุงุฆููุง ูู ุงููุทุงู [0-1] ุ ููููู ุชุฎุทู ุนูููุงุช ุงููุญุต ูุฐู ุจุฃูุงู. <br><br>  ุนูุฏ ุญุณุงุจ ุงููููุฉ ุงูููุงุฆูุฉ ุ ูุชู ุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุนูููุงุช ุงูุถุฑุจ.  ุชุนุฑู ุนูู ููููุฉ ุชุบููุฑ ูุฎุฑุฌุงุช ุฃููุง ุงูููุงุฆูุฉ ุงุนุชูุงุฏูุง ุนูู ูููุฉ ุงูุถูุถุงุก.  ูุฐุง ููุงุณุจ ูุฃูู ุณูุคุซุฑ ุนูู ุนุชุงูุฉ ุงูุจุฑู ุงูููุฏู ุ ุชูุงููุง ููุง ูู ุงูุญูุงุฉ ุงูุญููููุฉ. <br><br>  ุงุณุชุนุฏุงุฏ ุชุธููู ุจูุณู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> cbuffer cbPerFrame : <span class="hljs-keyword"><span class="hljs-keyword">register</span></span> (b0) { float4 cb0_v0; float4 cb0_v1; float4 cb0_v2; float4 cb0_v3; } cbuffer cbPerFrame : <span class="hljs-keyword"><span class="hljs-keyword">register</span></span> (b2) { float4 cb2_v0; float4 cb2_v1; float4 cb2_v2; float4 cb2_v3; } cbuffer cbPerFrame : <span class="hljs-keyword"><span class="hljs-keyword">register</span></span> (b4) { float4 cb4_v0; float4 cb4_v1; float4 cb4_v2; float4 cb4_v3; float4 cb4_v4; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VS_OUTPUT</span></span></span><span class="hljs-class"> {</span></span> float2 Texcoords : Texcoord0; float4 InstanceLODParams : INSTANCE_LOD_PARAMS; float4 PositionH : SV_Position; }; <span class="hljs-comment"><span class="hljs-comment">// Shaders in TW3 use integer noise. // For more details see: http://libnoise.sourceforge.net/noisegen/ float integerNoise( int n ) { n = (n &gt;&gt; 13) ^ n; int nn = (n * (n * n * 60493 + 19990303) + 1376312589) &amp; 0x7fffffff; return ((float)nn / 1073741824.0); } float s_curve( float x ) { float x2 = x * x; float x3 = x2 * x; // -2x^3 + 3x^2 return -2.0*x3 + 3.0*x2; } float4 Lightning_TW3_PS( in VS_OUTPUT Input ) : SV_Target { // * Inputs float elapsedTime = cb0_v0.x; float animationSpeed = cb4_v4.x; float minAmount = cb4_v2.x; float maxAmount = cb4_v3.x; float colorMultiplier = cb4_v0.x; float3 colorFilter = cb4_v1.xyz; float3 lightningColorRGB = cb2_v2.rgb; // Animation using time and X texcoord float animation = elapsedTime * animationSpeed + Input.Texcoords.x; // Input parameters for Integer Noise. // They are floored and please note there are using asint. // That might be an optimization to avoid "ftoi" instructions. int intX0 = asint( floor(animation) ); int intX1 = asint( floor(animation-1.0) ); float n0 = integerNoise( intX0 ); float n1 = integerNoise( intX1 ); // We interpolate "backwards" here. float weight = 1.0 - frac(animation); // Following the instructions from libnoise, we perform // smooth interpolation here with cubic s-curve function. float noise = lerp( n0, n1, s_curve(weight) ); // Make sure we are in [0.0 - 1.0] range. float lightningAmount = saturate( lerp(minAmount, maxAmount, noise) ); lightningAmount *= Input.InstanceLODParams.w; // 1.0 lightningAmount *= cb2_v2.w; // 1.0 // Calculate final lightning color float3 lightningColor = colorMultiplier * colorFilter; lightningColor *= lighntingColorRGB; float3 finalLightningColor = lightningColor * lightningAmount; return float4( finalLightningColor, lightningAmount ); }</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุชูุฎูุต </h3><br>  ูู ูุฐุง ุงูุฌุฒุก ุ ูุตูุช ุทุฑููุฉ ูุชูุฏูู ุงูุจุฑู ูู The Witcher 3. <br><br>  ุฃูุง ูุณุฑูุฑ ุฌุฏูุง ูุฃู ุฑูุฒ ุงููุฌููุน ุงูุฐู ุฎุฑุฌ ูู ุชุธูููู ูุชูุงูู ุชูุงููุง ูุน ุงููุต ุงูุฃุตูู! <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/25c/708/e50/25c708e503f4528c313c557abb080222.jpg"></div><br><h2 style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 2. ุณุฎููุฉ ุณูุงู ุงูุฎุฏุน </h2><br>  ุณูููู ูุฐุง ุงูุฌุฒุก ูุฎุชูููุง ููููุงู ุนู ุงูุณุงุจู.  ูู ุฐูู ุ ุฃุฑูุฏ ุฃู ุฃุฑูู ุจุนุถ ุฌูุงูุจ ุชุธููู ุงูุณูุงุก Witcher 3. <br><br>  ููุงุฐุง "ุงูุญูู ุณุฎููุฉ" ูููุณ ุชุธููู ูุงููุ  ุญุณูุง ุ ููุงู ุนุฏุฉ ุฃุณุจุงุจ.  ุฃููุงู ุ ุชุธููู ุงูุณูุงุก Witcher 3 ูู ูุญุด ูุนูุฏ ุฅูู ุญุฏ ูุง.  ูุญุชูู ุชุธููู ุงูุจูุณู ูู ุฅุตุฏุงุฑ 2015 ุนูู 267 ุณุทุฑูุง ูู ุฑูุฒ ุงููุฌููุน ุ ุจูููุง ูุญุชูู ุงูุชุธููู ูู Blood and Wine DLC ุนูู 385 ุณุทุฑูุง. <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูุญุตููู ุนูู ุงููุซูุฑ ูู ุงููุฏุฎูุงุช ุ ูุงูุชู ูุง ุชุคุฏู ุฅูู ุนูุณ ููุฏุณุฉ ููุฏ HLSL ุงููุงูู (ูุงููุงุจู ูููุฑุงุกุฉ!). <br><br>  ูุฐูู ุ ูุฑุฑุช ุฅุธูุงุฑ ุฌุฒุก ููุท ูู ุงูุญูู ูู ูุฐู ุชุธููู.  ุฅุฐุง ูุฌุฏุช ุดูุฆูุง ุฌุฏูุฏูุง ุ ูุณูู ุฃููู ุงููุดุงุฑูุฉ. <br><br>  ุงูุงุฎุชูุงูุงุช ุจูู ุฅุตุฏุงุฑ 2015 ู DLC (2016) ููุญูุธุฉ ููุบุงูุฉ.  ุนูู ูุฌู ุงูุฎุตูุต ุ ุชุดูู ุงูุงุฎุชูุงูุงุช ูู ุญุณุงุจ ุงููุฌูู ูููุถูุง ุ ุทุฑููุฉ ูุฎุชููุฉ ูุฌุนู ุงูุดูุณ ... ุญุชู ุชุธููู <i>Blood and Wine</i> ูุญุณุจ ุฏุฑุจ ุงูุชุจุงูุฉ ูู ุงูููู. <br><br>  ุณุฃุจุฏุฃ ุจุงูุฃุณุงุณูุงุช ุซู ุฃุชุญุฏุซ ุนู ุงูุญูู ุงูุบุจูุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฃุณุงุณูุงุช </h3><br>  ูุซู ูุนุธู ุงูุฃูุนุงุจ ุงูุญุฏูุซุฉ ุ ูุณุชุฎุฏู Witcher 3 skydome ูุชุตููู ุงูุณูุงุก.  ุงูุธุฑ ุฅูู ูุตู ุงููุฑุฉ ุงููุณุชุฎุฏู ููุฐุง ูู Witcher 3 (2015).  ููุงุญุธุฉ: ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุงููุฑุจุน ุงููุญูุท ููุฐู ุงูุดุจูุฉ ูู ุงููุทุงู ูู [0ุ0ุ0] ุฅูู [1ุ1ุ1] (Z ูู ุงููุญูุฑ ุงูุฐู ูุดูุฑ ูุฃุนูู) ููุงู ุจุชูุฒูุน ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ุจุณูุงุณุฉ.  ูู ููุช ูุงุญู ูุณุชุฎุฏููุง. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/49a/34d/3cf49a34dead2ff2e6f2542487edbf65.jpg"></div><br>  ุงูููุฑุฉ ูุฑุงุก skydome ุชุดุจู ููุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">skybox</a> (ุงููุฑู ุงููุญูุฏ ูู ุงูุดุจูุฉ ุงููุณุชุฎุฏูุฉ).  ูู ูุฑุญูุฉ ุชุธููู ููุฉ ุงูุฑุฃุณ ุ ูููู ุจุชุญููู ุงูููุฏ ุงููุฑุชุจุท ุจุงููุฑุงูุจ (ุนุงุฏุฉู ูุง ูููู ูุชูููุง ูุน ููุถุน ุงููุงููุฑุง) ุ ููุง ูุฎูู ุงูููู ุจุฃู ุงูุณูุงุก ุจุนูุฏุฉ ุฌุฏูุง ุจุงููุนู - ูู ูุตู ุฅูููุง ุฃุจุฏูุง. <br><br>  ุฅุฐุง ูุฑุฃุช ุงูุฃุฌุฒุงุก ุงูุณุงุจูุฉ ูู ูุฐู ุงูุณูุณูุฉ ูู ุงูููุงูุงุช ุ ูุฃูุช ุชุนูู ุฃู "The Witcher 3" ูุณุชุฎุฏู ุนูู ูุนููุณ ุ ุฃู ุฃู ุงููุณุชูู ุงูุจุนูุฏ ูู 0.0f ุ ูุงูุฃูุฑุจ ูู 1.0f.  ูุงุณุชููุงู ุฅุฎุฑุงุฌ skydome ุนูู ุงููุณุชูู ุงูุจุนูุฏ ุ ูู ูุนููุงุช ูุงูุฐุฉ ุงูุชุตูุญ ุ ูููุง ุจุชุนููู <i>MinDepth ุนูู</i> ููุณ ูููุฉ <i>MaxDepth</i> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2d7/34f/931/2d734f931c687dde42e3bb549a695764.jpg"></div><br>  ููุนุฑูุฉ ููููุฉ ุงุณุชุฎุฏุงู <i>ุญููู MinDepth</i> ู <i>MaxDepth</i> ุฃุซูุงุก ุชุญููู ูุงูุฐุฉ ุงูุงุณุชุนุฑุงุถ ุ ุงููุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> (docs.microsoft.com). <br><br><h3 style=";text-align:right;direction:rtl">  ููุฑุชูุณ ุดุงุฏุฑ </h3><br>  ููุจุฏุฃ ูุน ุชุธููู ููุฉ ุงูุฑุฃุณ.  ูู Witcher 3 (2015) ุ ูููู ุฑูุฒ ุชุธููู ุงููุฌููุน ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> vs_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer cb1[<span class="hljs-number"><span class="hljs-number">4</span></span>], immediateIndexed dcl_constantbuffer cb2[<span class="hljs-number"><span class="hljs-number">6</span></span>], immediateIndexed dcl_input v0.xyz dcl_input v1.xy dcl_output o0.xy dcl_output o1.xyz dcl_output_siv o2.xyzw, position dcl_temps <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: mov o0.xy, v1.xyxx <span class="hljs-number"><span class="hljs-number">1</span></span>: mad r0.xyz, v0.xyzx, cb2[<span class="hljs-number"><span class="hljs-number">4</span></span>].xyzx, cb2[<span class="hljs-number"><span class="hljs-number">5</span></span>].xyzx <span class="hljs-number"><span class="hljs-number">2</span></span>: mov r0.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span>: dp4 o1.x, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">4</span></span>: dp4 o1.y, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">5</span></span>: dp4 o1.z, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">6</span></span>: mul r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].yyyy, cb2[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">7</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].xxxx, r1.xyzw <span class="hljs-number"><span class="hljs-number">8</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].zzzz, r1.xyzw <span class="hljs-number"><span class="hljs-number">9</span></span>: mad r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r1.xyzw <span class="hljs-number"><span class="hljs-number">10</span></span>: dp4 o2.x, r0.xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">11</span></span>: mul r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].yyyy, cb2[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">12</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].xxxx, r1.xyzw <span class="hljs-number"><span class="hljs-number">13</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].zzzz, r1.xyzw <span class="hljs-number"><span class="hljs-number">14</span></span>: mad r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r1.xyzw <span class="hljs-number"><span class="hljs-number">15</span></span>: dp4 o2.y, r0.xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">16</span></span>: mul r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].yyyy, cb2[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">17</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].xxxx, r1.xyzw <span class="hljs-number"><span class="hljs-number">18</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].zzzz, r1.xyzw <span class="hljs-number"><span class="hljs-number">19</span></span>: mad r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r1.xyzw <span class="hljs-number"><span class="hljs-number">20</span></span>: dp4 o2.z, r0.xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">21</span></span>: mul r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].yyyy, cb2[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">22</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].xxxx, r1.xyzw <span class="hljs-number"><span class="hljs-number">23</span></span>: mad r1.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].zzzz, r1.xyzw <span class="hljs-number"><span class="hljs-number">24</span></span>: mad r1.xyzw, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].wwww, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>), r1.xyzw <span class="hljs-number"><span class="hljs-number">25</span></span>: dp4 o2.w, r0.xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">26</span></span>: ret</code> </pre> <br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุชุธููู ููุฉ ุงูุฑุฃุณ ุจููู texcoords ููุท ูููุถุน ูู ุงููุถุงุก ุงูุนุงููู ุฅูู ุงูุฅุฎุฑุงุฌ.  ูู <i>Blood and Wine ุ</i> ูุนุฑุถ ุฃูุถูุง ูุงูููุง ุทุจูุนููุง ุทุจูุนููุง.  ุณูู ุฃููุฑ ูู ุฅุตุฏุงุฑ 2015 ูุฃูู ุฃุจุณุท. <br><br>  ุงูุธุฑ ุฅูู ุงููุฎุฒู ุงููุคูุช ุงูุซุงุจุช ุงููุนูู ูู <b>cb2</b> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/360/38d/fc6/36038dfc67c29ef2934d96314ed46aff.jpg"></div><br>  ููุง ูุฏููุง ูุตูููุฉ ูู ุงูุนุงูู (ุชุญุฌูู ููุญุฏ ุจูุณุจุฉ 100 ูููู ูุณุจุฉ ุฅูู ูุถุน ุงููุงููุฑุง).  ูุง ุดูุก ูุนูุฏ.  cb2_v4 ู cb2_v5 ููุง ุนูุงูู ุงูุญุฌู / ุงูุงูุญุฑุงู ุงููุณุชุฎุฏูุฉ ูุชุญููู ููุงุถุน ุงูุฑุฃุณ ูู ุงููุงุตู ุงูุฒููู [0-1] ุฅูู ุงููุงุตู ุงูุฒููู [-1 ุ 1].  ูููู ููุง ุ ูุฐู ุงููุนุงููุงุช "ุถุบุท" ุงููุญูุฑ Z (ุฃุนูู). <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7e9/774/4c2/7e97744c28b0997b0b11049bee26fa7b.jpg"></div><br>  ูู ุงูุฃุฌุฒุงุก ุงูุณุงุจูุฉ ูู ุงูุณูุณูุฉ ุ ูุงู ูุฏููุง ุชุธููู ููุฉ ุงูุฑุฃุณ ููุงุซูุฉ.  ุชูุฏู ุงูุฎูุงุฑุฒููุฉ ุงูุนุงูุฉ ุฅูู ููู texcoords ุฅูู ุฃุจุนุฏ ูู ุฐูู ุ ุซู <i>ูุชู</i> ุงุญุชุณุงุจ <i>Position</i> ูุน ูุฑุงุนุงุฉ ูุนุงููุงุช ุงููููุงุณ / ุงูุงูุญุฑุงู ุ ุซู <i>ูุชู</i> ุญุณุงุจ <i>PositionW</i> ูู ุงููุถุงุก ุงูุนุงููู ุ ุซู ูุชู ุงุญุชุณุงุจ ุงูููุถุน ุงูููุงุฆู ููุณุงุญุฉ ุงููุทุน ุนู ุทุฑูู ุถุฑุจ <i>matWorld</i> ู <i>matViewProj</i> -&gt; ูุชู ุงุณุชุฎุฏุงู ุงูููุชุฌ ุงูุฎุงุต ุจููุง ุจุถุฑุจ <i>Position</i> ููุญุตูู ุนูู SV_Position ุงูููุงุฆู . <br><br>  ูุฐูู ุ ูุฌุจ ุฃู ูููู HLSL ูุชุธููู ููุฉ ุงูุฑุฃุณ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InputStruct</span></span></span><span class="hljs-class"> {</span></span> float3 param0 : POSITION; float2 param1 : TEXCOORD; float3 param2 : NORMAL; float4 param3 : TANGENT; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OutputStruct</span></span></span><span class="hljs-class"> {</span></span> float2 param0 : TEXCOORD0; float3 param1 : TEXCOORD1; float4 param2 : SV_Position; }; <span class="hljs-function"><span class="hljs-function">OutputStruct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EditedShaderVS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(in InputStruct IN)</span></span></span><span class="hljs-function"> </span></span>{ OutputStruct OUT = (OutputStruct)<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Simple texcoords passing OUT.param0 = IN.param1; // * Manually construct world and viewProj martices from float4s: row_major matrix matWorld = matrix(cb2_v0, cb2_v1, cb2_v2, float4(0,0,0,1) ); matrix matViewProj = matrix(cb1_v0, cb1_v1, cb1_v2, cb1_v3); // * Some optional fun with worldMatrix // a) Scale //matWorld._11 = matWorld._22 = matWorld._33 = 0.225f; // b) Translate // XYZ //matWorld._14 = 520.0997; //matWorld._24 = 74.4226; //matWorld._34 = 113.9; // Local space - note the scale+bias here! //float3 meshScale = float3(2.0, 2.0, 2.0); //float3 meshBias = float3(-1.0, -1.0, -0.4); float3 meshScale = cb2_v4.xyz; float3 meshBias = cb2_v5.xyz; float3 Position = IN.param0 * meshScale + meshBias; // World space float4 PositionW = mul(float4(Position, 1.0), transpose(matWorld) ); OUT.param1 = PositionW.xyz; // Clip space - original approach from The Witcher 3 matrix matWorldViewProj = mul(matViewProj, matWorld); OUT.param2 = mul( float4(Position, 1.0), transpose(matWorldViewProj) ); return OUT; }</span></span></code> </pre> <br>  ููุงุฑูุฉ ุธูุงูู (ูุณุงุฑ) ูุงูุฃุตู (ูููู): <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fd9/ed7/de2/fd9ed7de275ba36551e7751e1d351b8c.jpg"></div><br>  ุฎุงุตูุฉ ููุชุงุฒุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RenderDoc</a> ูู ุฃููุง ุชุณูุญ ููุง ุจุถุฎ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุธููููุง</a> ุจุฏูุงู ูู ุงูุชุธููู ุงูุฃุตูู ุ ูุณูู ุชุคุซุฑ ูุฐู ุงูุชุบููุฑุงุช ุนูู ุฎุท ุงูุฃูุงุจูุจ ุญุชู ููุงูุฉ ุงูุฅุทุงุฑ.  ููุง ุชุฑูู ูู ููุฏ HLSL ุ ููุฏ ูุฏูุช ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช ูุชูุจูุฑ ูุชุญููู ุงูููุฏุณุฉ ุงูููุงุฆูุฉ.  ููููู ุชุฌุฑุจุฉ ูุนูู ูุงูุญุตูู ุนูู ูุชุงุฆุฌ ูุถุญูุฉ ููุบุงูุฉ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0a5/350/e14/0a5350e14231505c0ff1bd5cbf384e15.jpg"></div><br><h4 style=";text-align:right;direction:rtl">  ููุฑุชูุณ ุดุงุฏุฑ ุงูุชุญุณูู </h4><br>  ูู ูุงุญุธุช ูุดููุฉ ุชุธููู ููุฉ ุงูุฑุฃุณ ุงูุฃุตููุ  ุงูุถุฑุจ ููุฉ ุงูุฑุฃุณ ูู ูุตูููุฉ ูุตูููุฉ ุฒุงุฆุฏุฉ ุชูุงูุง!  ููุฏ ูุฌุฏุช ูุฐุง ูู ุนุฏุฏ ูููู ูู ุชุธููู ููุฉ ุงูุฑุฃุณ (ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูุชุธููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณุชุงุฑุฉ ูู ุงููุทุฑ ูู ุงููุณุงูุฉ</a> ).  ูููููุง ุชุญุณููู ุนู ุทุฑูู ุถุฑุจ <i>PositionW ุนูู</i> ุงูููุฑ ุจูุงุณุทุฉ <i>matViewProj</i> ! <br><br>  ูุฐูู ุ ูููููุง ุงุณุชุจุฏุงู ูุฐุง ุงูุฑูุฒ ุจู HLSL: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Clip space - original approach from The Witcher 3 matrix matWorldViewProj = mul(matViewProj, matWorld); OUT.param2 = mul( float4(Position, 1.0), transpose(matWorldViewProj) );</span></span></code> </pre> <br>  ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Clip space - optimized version OUT.param2 = mul( matViewProj, PositionW );</span></span></code> </pre> <br>  ุงูุฅุตุฏุงุฑ ุงูุฃูุซู ูุนุทููุง ุฑูุฒ ุงูุชุฌููุน ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> vs_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer CB1[<span class="hljs-number"><span class="hljs-number">4</span></span>], immediateIndexed dcl_constantbuffer CB2[<span class="hljs-number"><span class="hljs-number">6</span></span>], immediateIndexed dcl_input v0.xyz dcl_input v1.xy dcl_output o0.xy dcl_output o1.xyz dcl_output_siv o2.xyzw, position dcl_temps <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: mov o0.xy, v1.xyxx <span class="hljs-number"><span class="hljs-number">1</span></span>: mad r0.xyz, v0.xyzx, cb2[<span class="hljs-number"><span class="hljs-number">4</span></span>].xyzx, cb2[<span class="hljs-number"><span class="hljs-number">5</span></span>].xyzx <span class="hljs-number"><span class="hljs-number">2</span></span>: mov r0.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span>: dp4 r1.x, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">4</span></span>: dp4 r1.y, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">5</span></span>: dp4 r1.z, r0.xyzw, cb2[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw <span class="hljs-number"><span class="hljs-number">6</span></span>: mov o1.xyz, r1.xyzx <span class="hljs-number"><span class="hljs-number">7</span></span>: mov r1.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">8</span></span>: dp4 o2.x, cb1[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">9</span></span>: dp4 o2.y, cb1[<span class="hljs-number"><span class="hljs-number">1</span></span>].xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">10</span></span>: dp4 o2.z, cb1[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">11</span></span>: dp4 o2.w, cb1[<span class="hljs-number"><span class="hljs-number">3</span></span>].xyzw, r1.xyzw <span class="hljs-number"><span class="hljs-number">12</span></span>: ret</code> </pre> <br>  ููุง ุชุฑูู ุ ูููุง ุจุชูููู ุนุฏุฏ ุงูุชุนูููุงุช ูู 26 ุฅูู 12 - ููู ุชุบููุฑ ููู ุฅูู ุญุฏ ูุง.  ูุง ุฃุนุฑู ูุฏู ุงูุชุดุงุฑ ูุฐู ุงููุดููุฉ ูู ุงููุนุจุฉ ุ ูููู ูู ุฃุฌู ุงููู ุ CD Projekt Red ุ ุฑุจูุง ุฃุทูู ุฑูุนุฉุ  :) <br><br>  ูุฃูุง ูุง ุฃูุฒุญ.  ููููู ุฅุฏุฑุงุฌ ุงูุชุธููู ุงููุญุณู ุงูุฎุงุต ุจู ุจุฏูุงู ูู RenderDoc ุงูุฃุตูู ุ ูุณูู ุชุฑู ุฃู ูุฐุง ุงูุชุญุณูู ูุง ูุคุซุฑ ุจุตุฑููุง ุนูู ุฃู ุดูุก.  ุจุตุฑุงุญุฉ ุ ูุง ุฃููู ููุงุฐุง ูุฑุฑุช ุดุฑูุฉ CD Projekt Red ุฅุฌุฑุงุก ุนูููุฉ ุงูุถุฑุจ ุงููุตูู ููุตูููุฉ ุจูุตูููุฉ ... <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุดูุณ </h3><br>  ูู The Witcher 3 (2015) ุ ูุชููู ุญุณุงุจ ุงูุงูุชุซุงุฑ ุงูุฌูู ูุงูุดูุณ ูู ูุฏุงุกูู ูููุตููู ููุฑุณู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/649/9df/02c/6499df02c248c9bab14a597b6b111d6d.jpg"></div><br>  <i>ููุชุดุฑ 3 (2015) - ุญุชู</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fe6/4ee/77c/fe64ee77c1923920bc01de149ddb60e7.jpg"></div><br>  <i>ููุชุดุฑ 3 (2015) - ูุน ุงูุณูุงุก</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/64d/9e5/416/64d9e541622b33d646b887db01c7c1a2.jpg"></div><br>  <i>ููุชุดุฑ 3 (2015) - ูุน ุงูุณูุงุก + ุงูุดูุณ</i> <br><br>  ูุดุจู ุชุฌุณูุฏ ุงูุดูุณ ูู ุฅุตุฏุงุฑ ุนุงู 2015 ุฅูู ุญุฏ ุจุนูุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฌุณูุฏ ุงูููุฑ</a> ูู ุญูุซ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุดูู</a> ุงูููุฏุณู ูุญุงูุงุช ุงูุฎูุท / ุงูุนูู. <br><br>  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูู <i>"ุงูุฏู ูุงููุจูุฐ" ุชุธูุฑ</i> ุงูุณูุงุก ูุน ุงูุดูุณ ูู ูุณุงุฑ ูุงุญุฏ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/184/7dd/daa/1847dddaa38e0876bc829a2d5747c9ce.jpg"></div><br>  <i>ููุชุดุฑ 3: ุงูุฏู ูุงููุจูุฐ (2016) - ุฅูู ุงูุฌูุฉ</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7fa/aff/002/7faaff002cc6d328d663c582c74a3628.jpg"></div><br>  <i>ููุชุดุฑ 3: ุงูุฏู ูุงููุจูุฐ (2016) - ูุน ุงูุฌูุฉ ูุงูุดูุณ</i> <br><br>  ุจุบุถ ุงููุธุฑ ุนู ุทุฑููุฉ ุชุฌุณูุฏู ููุดูุณ ุ ูุฃูุช ูู ูุฑุญูุฉ ูุง ูุง ุฒูุช ุจุญุงุฌุฉ ุฅูู ุงูุงุชุฌุงู (ุงูุทุจูุนู) ูุฃุดุนุฉ ุงูุดูุณ.  ุงูุทุฑููุฉ ุงูุฃูุซุฑ ููุทููุฉ ููุญุตูู ุนูู ูุฐุง ุงููุชุฌู ูู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฅุญุฏุงุซูุงุช ุงููุฑููุฉ</a> .  ูู ุงููุงูุน ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุงุซููู ููุท ูู ุงูููู ุงูุชู ุชุดูุฑ ุฅูู ุฒุงููุชูู (ุจุงูุฑุงุฏูุงู!): <i>Phi</i> ู <i>theta</i> .  ุจุนุฏ ุงุณุชูุงููู ุ ูููููุง ุงูุชุฑุงุถ ุฃู <i>r = 1</i> ุ ูุจุงูุชุงูู ุชููููู.  ุซู ุจุงููุณุจุฉ ููุฅุญุฏุงุซูุงุช ุงูุฏููุงุฑุชูุฉ ูุน ุงูุฅุดุงุฑุฉ ุฅูู ุงููุญูุฑ Y ุ ูููููู ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ูู HLSL: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> float3 vSunDir; vSunDir.x = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(fTheta)*<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(fPhi); vSunDir.y = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(fTheta)*<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(fPhi); vSunDir.z = <span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>(fTheta); vSunDir = normalize(vSunDir);</code> </pre> <br>  ุนุงุฏุฉ ุ ูุชู ุญุณุงุจ ุงุชุฌุงู ุถูุก ุงูุดูุณ ูู ุงูุชุทุจูู ุ ุซู ูุชู ุชูุฑูุฑู ุฅูู ุงููุฎุฒู ุงููุคูุช ุงูุซุงุจุช ููุงุณุชุฎุฏุงู ูู ุงููุณุชูุจู. <br><br>  ุจุนุฏ ุชููู ุงุชุฌุงู ุฃุดุนุฉ ุงูุดูุณ ุ ูููููุง ุงูุฎูุถ ูู ุฑูุฒ ุงููุฌููุน ูุชุธููู ุจูุณู <i>"ุงูุฏู ูุงููุจูุฐ"</i> ... <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> ... <span class="hljs-number"><span class="hljs-number">100</span></span>: add r1.xyw, -r0.xyxz, cb12[<span class="hljs-number"><span class="hljs-number">0</span></span>].xyxz <span class="hljs-number"><span class="hljs-number">101</span></span>: dp3 r2.x, r1.xywx, r1.xywx <span class="hljs-number"><span class="hljs-number">102</span></span>: rsq r2.x, r2.x <span class="hljs-number"><span class="hljs-number">103</span></span>: mul r1.xyw, r1.xyxw, r2.xxxx <span class="hljs-number"><span class="hljs-number">104</span></span>: mov_sat r2.xy, cb12[<span class="hljs-number"><span class="hljs-number">205</span></span>].yxyy <span class="hljs-number"><span class="hljs-number">105</span></span>: dp3 r2.z, -r1.xywx, -r1.xywx <span class="hljs-number"><span class="hljs-number">106</span></span>: rsq r2.z, r2.z <span class="hljs-number"><span class="hljs-number">107</span></span>: mul r1.xyw, -r1.xyxw, r2.zzzz ...</code> </pre> <br>  ุฃููุงู ุ <i>cb12 [0] .xyz</i> ูู ููุถุน ุงููุงููุฑุง ุ ููู <i>r0.xyz</i> ูููู ุจุชุฎุฒูู ููุถุน ููุฉ ุงูุฑุฃุณ (ูุฐุง ูู ุงููุงุชุฌ ูู ุดุงุฏุฑ ููุฉ ุงูุฑุฃุณ).  ูุฐูู ุ ูุญุณุจ ุงูุณุทุฑ 100 ุงููุชุฌู <i>worldToCamera</i> .  ููู ุฅููุงุก ูุธุฑุฉ ุนูู ุงูุณุทูุฑ 105-107.  ูููููุง ูุชุงุจุชูุง ุจุดูู <i>ุทุจูุนู (-WorldToCamera)</i> ุ ุฃู ูุญุณุจ ูุชุฌู <i>cameraToWorld</i> ุงูุทุจูุนู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">120</span></span>: dp3_sat r1.x, cb12[<span class="hljs-number"><span class="hljs-number">203</span></span>].yzwy, r1.xywx</code> </pre> <br>  ุซู ูููู ุจุญุณุงุจ ููุชุฌ ุงูุนุฏุฏูุฉ ุงูุฎุงุต <i>ุจูุงููุฑุงุช</i> <i>ููุงูุญุฉ ูุงููุงุช ุงูุงุชุฌุงู</i> ู <i>sunDirection</i> !  ุชุฐูุฑ ุฃูู ูุฌุจ ุชุทุจูุนูุง.  ูุญู ุฃูุถุง ุชุดุจุน ูุฐุง ุงูุชุนุจูุฑ ุงููุงูู ููุตุฑู ุนูู ุงููุงุตู ุงูุฒููู [0-1]. <br><br>  ! ููุชุงุฒ  ูุชู ุชุฎุฒูู ูุฐุง ุงูููุชุฌ ุงูููุงุณู ูู r1.x.  ููุฑู ุฃูู ููุทุจู ุจุนุฏ ุฐูู ... <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">152</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> r1.x, r1.x <span class="hljs-number"><span class="hljs-number">153</span></span>: mul r1.x, r1.x, cb12[<span class="hljs-number"><span class="hljs-number">203</span></span>].x <span class="hljs-number"><span class="hljs-number">154</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">exp</span></span> r1.x, r1.x <span class="hljs-number"><span class="hljs-number">155</span></span>: mul r1.x, r2.y, r1.x</code> </pre> <br>  ุงูุซุงููุซ "logุ mulุ exp" ูู ุงูุฃุณ.  ููุง ุชุฑูู ุ ูุฅููุง ูุฑูุน ุฌูุจ ุงูุชูุงู ูุฏููุง (ุงูููุชุฌ ุงูููุงุณู ูููุงููุงุช ุงูุทุจูุนูุฉ) ุฅูู ุญุฏ ูุง.  ูุฏ ุชุณุฃู ููุงุฐุง.  ุจูุฐู ุงูุทุฑููุฉ ุ ูููููุง ุฅูุดุงุก ุชุฏุฑุฌ ูุญุงูู ุงูุดูุณ.  (ููุคุซุฑ ุงูุณุทุฑ 155 ุนูู ุนุชุงูุฉ ูุฐุง ุงูุชุฏุฑุฌ ุงููููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุนูุฏ ุชุนูููู ูุฅุฎูุงุก ุงูุดูุณ ุชูุงููุง).  ูููุง ููู ุจุนุถ ุงูุฃูุซูุฉ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/674/662/658/6746626580dbe0d943c27bcda10f8a9d.jpg"></div><br>  <i>ุงูุฃุณ = 54</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b0a/a4e/fca/b0aa4efcae350fe8423e3bc8a1463d78.jpg"></div><br>  <i>ุงูุฃุณ = 2400</i> <br><br>  ุจุนุฏ ูุฐุง ุงูุชุฏุฑุฌ ุ ูุณุชุฎุฏูู <i>ููุชุญุฑูู</i> ุจูู <i>skyColor</i> ู <i>sunColor</i> !  ูุชุฌูุจ ุงููุทุน ุงูุฃุซุฑูุฉ ุ ุชุญุชุงุฌ ุฅูู ุชุดุจุน ุงููููุฉ ุนูู ุงูุณุทุฑ 120. <br><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูููู ุงุณุชุฎุฏุงู ูุฐู ุงูุฎุฏุนุฉ ููุญุงูุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฌุงู</a> ุงูููุฑ (ุนูุฏ ููู ุงูุฃุณ ุงูููุฎูุถุฉ).  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ูุชุฌู <i>moonDirection</i> ุ ูุงูุฐู ูููู ุญุณุงุจู ุจุณูููุฉ ุจุงุณุชุฎุฏุงู ุงูุฅุญุฏุงุซูุงุช ุงููุฑููุฉ. <br><br>  ูุฏ ูุจุฏู ุฑูุฒ HLSL ุงูุฌุงูุฒ ูุซู ุงูููุชุทู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> float3 vCamToWorld = normalize( PosW โ CameraPos ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cosTheta = saturate( dot(vSunDir, vCamToWorld) ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> sunGradient = <span class="hljs-built_in"><span class="hljs-built_in">pow</span></span>( cosTheta, sunExponent ); float3 color = lerp( skyColor, sunColor, sunGradient );</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุญุฑูุฉ ุงููุฌูู </h3><br>  ุฅุฐุง ูุฌุญุช ูู ูุถุงุก ููุช ุทููู ูู ุณูุงุก Witcher 3 ุงูุตุงููุฉ ุงูููููุฉ ุ ููููู ุฃู ุชุฑู ุฃู ุงููุฌูู ููุณุช ุซุงุจุชุฉ - ุฅููุง ุชุชุญุฑู ููููุงู ุนุจุฑ ุงูุณูุงุก!  ููุฏ ูุงุญุธุช ูุฐุง ุจุงูุตุฏูุฉ ุชูุฑูุจูุง ูุฃุฑุฏุช ูุนุฑูุฉ ููููุฉ ุชูููุฐู. <br><br>  ููุจุฏุฃ ุจุญูููุฉ ุฃู ุงููุฌูู ูู Witcher 3 ูุชู ุชูุฏูููุง ูุฎุฑูุทุฉ ููุนุจุฉ ุจุญุฌู 1024x1024x6.  ุฅุฐุง ููุฑุช ูู ุงูุฃูุฑ ุ ููููู ุฃู ุชููู ุฃู ูุฐุง ูู ุงูุญู ุงููุฑูุญ ููุบุงูุฉ ุงูุฐู ูุชูุญ ูู ุจุณูููุฉ ุงูุชูุงุท ุงูุงุชุฌุงูุงุช ููุญุตูู ุนูู ุนููุงุช ูู ุงูุฎุฑูุทุฉ ุงูููุนุจุฉ. <br><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฑูุฒ ุงููุฌูุน ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">159</span></span>: add r1.xyz, -v1.xyzx, cb1[<span class="hljs-number"><span class="hljs-number">8</span></span>].xyzx <span class="hljs-number"><span class="hljs-number">160</span></span>: dp3 r0.w, r1.xyzx, r1.xyzx <span class="hljs-number"><span class="hljs-number">161</span></span>: rsq r0.w, r0.w <span class="hljs-number"><span class="hljs-number">162</span></span>: mul r1.xyz, r0.wwww, r1.xyzx <span class="hljs-number"><span class="hljs-number">163</span></span>: mul r2.xyz, cb12[<span class="hljs-number"><span class="hljs-number">204</span></span>].zwyz, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">164</span></span>: mad r2.xyz, cb12[<span class="hljs-number"><span class="hljs-number">204</span></span>].yzwy, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), -r2.xyzx <span class="hljs-number"><span class="hljs-number">165</span></span>: mul r4.xyz, r2.xyzx, cb12[<span class="hljs-number"><span class="hljs-number">204</span></span>].zwyz <span class="hljs-number"><span class="hljs-number">166</span></span>: mad r4.xyz, r2.zxyz, cb12[<span class="hljs-number"><span class="hljs-number">204</span></span>].wyzw, -r4.xyzx <span class="hljs-number"><span class="hljs-number">167</span></span>: dp3 r4.x, r1.xyzx, r4.xyzx <span class="hljs-number"><span class="hljs-number">168</span></span>: dp2 r4.y, r1.xyxx, r2.yzyy <span class="hljs-number"><span class="hljs-number">169</span></span>: dp3 r4.z, r1.xyzx, cb12[<span class="hljs-number"><span class="hljs-number">204</span></span>].yzwy <span class="hljs-number"><span class="hljs-number">170</span></span>: dp3 r0.w, r4.xyzx, r4.xyzx <span class="hljs-number"><span class="hljs-number">171</span></span>: rsq r0.w, r0.w <span class="hljs-number"><span class="hljs-number">172</span></span>: mul r2.xyz, r0.wwww, r4.xyzx <span class="hljs-number"><span class="hljs-number">173</span></span>: sample_indexable(texturecube)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r4.xyz, r2.xyzx, t0.xyzw, s0</code> </pre> <br>  ูุญุณุงุจ ูุชุฌู ุฃุฎุฐ ุงูุนููุงุช ุงูููุงุฆู (ุงูุณุทุฑ 173) ุ ูุจุฏุฃ ุจุญุณุงุจ ูุชุฌู <i>worldToCamera</i> ุงูุทุจูุนู (ุงูุฎุทูุท 159-162). <br><br>  ุจุนุฏ ุฐูู ูุญุณุจ ููุชุฌูู ูุชุฌููู (163-164 ุ 165-166) ุจุงุณุชุฎุฏุงู <i>moonDirection</i> ุ ูุจุนุฏ ุฐูู ูุญุณุจ ุซูุงุซุฉ ููุชุฌุงุช ููุงุณูุฉ ููุญุตูู ุนูู ูุชุฌู ุฃุฎุฐ ุงูุนููุงุช ุงูููุงุฆู.  ููุฏ HLSL: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> float3 vWorldToCamera = normalize( g_CameraPos.xyz - Input.PositionW.xyz ); float3 vMoonDirection = cb12_v204.yzw; float3 vStarsSamplingDir = cross( vMoonDirection, float3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) ); float3 vStarsSamplingDir2 = cross( vStarsSamplingDir, vMoonDirection ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dirX = dot( vWorldToCamera, vStarsSamplingDir2 ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dirY = dot( vWorldToCamera, vStarsSamplingDir ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dirZ = dot( vWorldToCamera, vMoonDirection); float3 dirXYZ = normalize( float3(dirX, dirY, dirZ) ); float3 starsColor = texNightStars.Sample( samplerAnisoWrap, dirXYZ ).rgb;</code> </pre> <br>  ููุงุญุธุฉ ูููุณู: ูุฐุง ุฑูุฒ ูุตูู ุจุดูู ุฌูุฏ ููุบุงูุฉ ุ ูููุจุบู ุนููู ุงูุชุญููู ููู ุจูุฒูุฏ ูู ุงูุชูุงุตูู. <br><br>  ููุงุญุธุฉ ูููุฑุงุก: ุฅุฐุง ููุช ุชุนุฑู ุงููุฒูุฏ ุนู ูุฐู ุงูุนูููุฉ ุ ูุฃุฎุจุฑูู! <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุฌูู ุงููุชูุฃูุฆุฉ </h3><br>  ุงูุฎุฏุนุฉ ุงูุฃุฎุฑู ุงููุซูุฑุฉ ููุงูุชูุงู ุงูุชู ุฃูุฏ ุงุณุชูุดุงููุง ุจูุฒูุฏ ูู ุงูุชูุตูู ูู ูููุถ ุงููุฌูู.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ุชุฌููุช ูู ููููุบุฑุงุฏ ูู ุทูุณ ุตุงูู ุ ูุณุชูุงุญุธ ุฃู ุงููุฌูู ุชุชูุฃูุฃ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุช ูุถูููุฉ ููู ุชู ุชูููุฐ ูุฐุง. ุงุชุถุญ ุฃู ุงููุฑู ุจูู ุฅุตุฏุงุฑ 2015 ู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Blood and Wine"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุจูุฑ ุฌุฏูุง. ููุจุณุงุทุฉ ุ ุณุฃูุธุฑ ูู ุฅุตุฏุงุฑ 2015. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ุ ูุจุฏุฃ ูุจุงุดุฑุฉ ุจุนุฏ ุฃุฎุฐ ุนููุงุช </font><font style="vertical-align: inherit;">ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฌููุงูููู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููุณู ุงูุณุงุจู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">174</span></span>: mul r0.w, v0.x, l(<span class="hljs-number"><span class="hljs-number">100.000000</span></span>) <span class="hljs-number"><span class="hljs-number">175</span></span>: round_ni r1.w, r0.w <span class="hljs-number"><span class="hljs-number">176</span></span>: mad r2.w, v0.y, l(<span class="hljs-number"><span class="hljs-number">50.000000</span></span>), cb0[<span class="hljs-number"><span class="hljs-number">0</span></span>].x <span class="hljs-number"><span class="hljs-number">177</span></span>: round_ni r4.w, r2.w <span class="hljs-number"><span class="hljs-number">178</span></span>: bfrev r4.w, r4.w <span class="hljs-number"><span class="hljs-number">179</span></span>: iadd r5.x, r1.w, r4.w <span class="hljs-number"><span class="hljs-number">180</span></span>: ishr r5.y, r5.x, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">181</span></span>: xor r5.x, r5.x, r5.y <span class="hljs-number"><span class="hljs-number">182</span></span>: imul null, r5.y, r5.x, r5.x <span class="hljs-number"><span class="hljs-number">183</span></span>: imad r5.y, r5.y, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">184</span></span>: imad r5.x, r5.x, r5.y, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">185</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r5.x, r5.x, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>) <span class="hljs-number"><span class="hljs-number">186</span></span>: itof r5.x, r5.x <span class="hljs-number"><span class="hljs-number">187</span></span>: mad r5.y, v0.x, l(<span class="hljs-number"><span class="hljs-number">100.000000</span></span>), l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">188</span></span>: round_ni r5.y, r5.y <span class="hljs-number"><span class="hljs-number">189</span></span>: iadd r4.w, r4.w, r5.y <span class="hljs-number"><span class="hljs-number">190</span></span>: ishr r5.z, r4.w, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">191</span></span>: xor r4.w, r4.w, r5.z <span class="hljs-number"><span class="hljs-number">192</span></span>: imul null, r5.z, r4.w, r4.w <span class="hljs-number"><span class="hljs-number">193</span></span>: imad r5.z, r5.z, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">194</span></span>: imad r4.w, r4.w, r5.z, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">195</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r4.w, r4.w, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>) <span class="hljs-number"><span class="hljs-number">196</span></span>: itof r4.w, r4.w <span class="hljs-number"><span class="hljs-number">197</span></span>: add r5.z, r2.w, l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">198</span></span>: round_ni r5.z, r5.z <span class="hljs-number"><span class="hljs-number">199</span></span>: bfrev r5.z, r5.z <span class="hljs-number"><span class="hljs-number">200</span></span>: iadd r1.w, r1.w, r5.z <span class="hljs-number"><span class="hljs-number">201</span></span>: ishr r5.w, r1.w, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">202</span></span>: xor r1.w, r1.w, r5.w <span class="hljs-number"><span class="hljs-number">203</span></span>: imul null, r5.w, r1.w, r1.w <span class="hljs-number"><span class="hljs-number">204</span></span>: imad r5.w, r5.w, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">205</span></span>: imad r1.w, r1.w, r5.w, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">206</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r1.w, r1.w, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>) <span class="hljs-number"><span class="hljs-number">207</span></span>: itof r1.w, r1.w <span class="hljs-number"><span class="hljs-number">208</span></span>: mul r1.w, r1.w, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>) <span class="hljs-number"><span class="hljs-number">209</span></span>: iadd r5.y, r5.z, r5.y <span class="hljs-number"><span class="hljs-number">210</span></span>: ishr r5.z, r5.y, l(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-number"><span class="hljs-number">211</span></span>: xor r5.y, r5.y, r5.z <span class="hljs-number"><span class="hljs-number">212</span></span>: imul null, r5.z, r5.y, r5.y <span class="hljs-number"><span class="hljs-number">213</span></span>: imad r5.z, r5.z, l(<span class="hljs-number"><span class="hljs-number">0x0000ec4d</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span>) <span class="hljs-number"><span class="hljs-number">214</span></span>: imad r5.y, r5.y, r5.z, l(<span class="hljs-number"><span class="hljs-number">146956042240.000000</span></span>) <span class="hljs-number"><span class="hljs-number">215</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> r5.y, r5.y, l(<span class="hljs-number"><span class="hljs-number">0x7fffffff</span></span>) <span class="hljs-number"><span class="hljs-number">216</span></span>: itof r5.y, r5.y <span class="hljs-number"><span class="hljs-number">217</span></span>: frc r0.w, r0.w <span class="hljs-number"><span class="hljs-number">218</span></span>: add r0.w, -r0.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">219</span></span>: mul r5.z, r0.w, r0.w <span class="hljs-number"><span class="hljs-number">220</span></span>: mul r0.w, r0.w, r5.z <span class="hljs-number"><span class="hljs-number">221</span></span>: mul r5.xz, r5.xxzx, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">3.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">222</span></span>: mad r0.w, r0.w, l(<span class="hljs-number"><span class="hljs-number">-2.000000</span></span>), r5.z <span class="hljs-number"><span class="hljs-number">223</span></span>: frc r2.w, r2.w <span class="hljs-number"><span class="hljs-number">224</span></span>: add r2.w, -r2.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">225</span></span>: mul r5.z, r2.w, r2.w <span class="hljs-number"><span class="hljs-number">226</span></span>: mul r2.w, r2.w, r5.z <span class="hljs-number"><span class="hljs-number">227</span></span>: mul r5.z, r5.z, l(<span class="hljs-number"><span class="hljs-number">3.000000</span></span>) <span class="hljs-number"><span class="hljs-number">228</span></span>: mad r2.w, r2.w, l(<span class="hljs-number"><span class="hljs-number">-2.000000</span></span>), r5.z <span class="hljs-number"><span class="hljs-number">229</span></span>: mad r4.w, r4.w, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>), -r5.x <span class="hljs-number"><span class="hljs-number">230</span></span>: mad r4.w, r0.w, r4.w, r5.x <span class="hljs-number"><span class="hljs-number">231</span></span>: mad r5.x, r5.y, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>), -r1.w <span class="hljs-number"><span class="hljs-number">232</span></span>: mad r0.w, r0.w, r5.x, r1.w <span class="hljs-number"><span class="hljs-number">233</span></span>: add r0.w, -r4.w, r0.w <span class="hljs-number"><span class="hljs-number">234</span></span>: mad r0.w, r2.w, r0.w, r4.w <span class="hljs-number"><span class="hljs-number">235</span></span>: mad r2.xyz, r0.wwww, l(<span class="hljs-number"><span class="hljs-number">0.000500</span></span>, <span class="hljs-number"><span class="hljs-number">0.000500</span></span>, <span class="hljs-number"><span class="hljs-number">0.000500</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), r2.xyzx <span class="hljs-number"><span class="hljs-number">236</span></span>: sample_indexable(texturecube)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r2.xyz, r2.xyzx, t0.xyzw, s0 <span class="hljs-number"><span class="hljs-number">237</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> r4.xyz, r4.xyzx <span class="hljs-number"><span class="hljs-number">238</span></span>: mul r4.xyz, r4.xyzx, l(<span class="hljs-number"><span class="hljs-number">2.200000</span></span>, <span class="hljs-number"><span class="hljs-number">2.200000</span></span>, <span class="hljs-number"><span class="hljs-number">2.200000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">239</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">exp</span></span> r4.xyz, r4.xyzx <span class="hljs-number"><span class="hljs-number">240</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> r2.xyz, r2.xyzx <span class="hljs-number"><span class="hljs-number">241</span></span>: mul r2.xyz, r2.xyzx, l(<span class="hljs-number"><span class="hljs-number">2.200000</span></span>, <span class="hljs-number"><span class="hljs-number">2.200000</span></span>, <span class="hljs-number"><span class="hljs-number">2.200000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">242</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">exp</span></span> r2.xyz, r2.xyzx <span class="hljs-number"><span class="hljs-number">243</span></span>: mul r2.xyz, r2.xyzx, r4.xyzx</code> </pre> <br> .         . <br><br>   <i>starsColor</i>   173   -  <i>offset</i> .  <i>offset</i>       (r2.xyz,  235),       ,  -    (237-242)    (243). <br><br> ,   ? ,  .      <i>offset</i> .         skydome โ       . <br><br>  <i>offset</i>     ,   ,  UV   skydome (v0.xy)    ,     (cb[0].x). <br><br>      ishr/xor/and,          . <br><br>  ,      ,     ,    .      ,        ( <i>iadd</i> )       (  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">reversebits</a> ;  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">bfrev</a> ). <br><br> ,   .     . <br><br>    4 ยซยป  .    ,   4   : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> asint( <span class="hljs-built_in"><span class="hljs-built_in">floor</span></span>(x) ); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReverseInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reversebits( getInt(x) ); } <span class="hljs-comment"><span class="hljs-comment">// * Inputs - UV and elapsed time in seconds float2 starsUV; starsUV.x = 100.0 * Input.TextureUV.x; starsUV.y = 50.0 * Input.TextureUV.y + g_fTime; // * Iteration 1 int iStars1_A = getReverseInt( starsUV.y ); int iStars1_B = getInt( starsUV.x ); float fStarsNoise1 = integerNoise( iStars1_A + iStars1_B ); // * Iteration 2 int iStars2_A = getReverseInt( starsUV.y ); int iStars2_B = getInt( starsUV.x - 1.0 ); float fStarsNoise2 = integerNoise( iStars2_A + iStars2_B ); // * Iteration 3 int iStars3_A = getReverseInt( starsUV.y - 1.0 ); int iStars3_B = getInt( starsUV.x ); float fStarsNoise3 = integerNoise( iStars3_A + iStars3_B ); // * Iteration 4 int iStars4_A = getReverseInt( starsUV.y - 1.0 ); int iStars4_B = getInt( starsUV.x - 1.0 ); float fStarsNoise4 = integerNoise( iStars4_A + iStars4_B );</span></span></code> </pre> <br>     4  (  ,    <i>itof</i> ): <br><br>  1 โ r5.x, <br><br>  2 โ r4.w, <br><br>  3 โ r1.w, <br><br>  4 โ r5.y <br><br>   <i>itof</i> ( 216)  : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">217</span></span>: frc r0.w, r0.w <span class="hljs-number"><span class="hljs-number">218</span></span>: add r0.w, -r0.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">219</span></span>: mul r5.z, r0.w, r0.w <span class="hljs-number"><span class="hljs-number">220</span></span>: mul r0.w, r0.w, r5.z <span class="hljs-number"><span class="hljs-number">221</span></span>: mul r5.xz, r5.xxzx, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">3.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">222</span></span>: mad r0.w, r0.w, l(<span class="hljs-number"><span class="hljs-number">-2.000000</span></span>), r5.z <span class="hljs-number"><span class="hljs-number">223</span></span>: frc r2.w, r2.w <span class="hljs-number"><span class="hljs-number">224</span></span>: add r2.w, -r2.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">225</span></span>: mul r5.z, r2.w, r2.w <span class="hljs-number"><span class="hljs-number">226</span></span>: mul r2.w, r2.w, r5.z <span class="hljs-number"><span class="hljs-number">227</span></span>: mul r5.z, r5.z, l(<span class="hljs-number"><span class="hljs-number">3.000000</span></span>) <span class="hljs-number"><span class="hljs-number">228</span></span>: mad r2.w, r2.w, l(<span class="hljs-number"><span class="hljs-number">-2.000000</span></span>), r5.z</code> </pre> <br>     S-        UV,      .  ูุฐูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s_curve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x2 = x * x; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x3 = x2 * x; <span class="hljs-comment"><span class="hljs-comment">// -2x^3 + 3x^2 return -2.0*x3 + 3.0*x2; } ... // lines 217-222 float weightX = 1.0 - frac( starsUV.x ); weightX = s_curve( weightX ); // lines 223-228 float weightY = 1.0 - frac( starsUV.y ); weightY = s_curve( weightY );</span></span></code> </pre> <br>    ,              : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">229</span></span>: mad r4.w, r4.w, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>), -r5.x <span class="hljs-number"><span class="hljs-number">230</span></span>: mad r4.w, r0.w, r4.w, r5.x <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> noise0 = lerp( fStarsNoise1, fStarsNoise2, weightX ); <span class="hljs-number"><span class="hljs-number">231</span></span>: mad r5.x, r5.y, l(<span class="hljs-number"><span class="hljs-number">0.000000001</span></span>), -r1.w <span class="hljs-number"><span class="hljs-number">232</span></span>: mad r0.w, r0.w, r5.x, r1.w <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> noise1 = lerp( fStarsNoise3, fStarsNoise4, weightX ); <span class="hljs-number"><span class="hljs-number">233</span></span>: add r0.w, -r4.w, r0.w <span class="hljs-number"><span class="hljs-number">234</span></span>: mad r0.w, r2.w, r0.w, r4.w <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> offset = lerp( noise0, noise1, weightY ); <span class="hljs-number"><span class="hljs-number">235</span></span>: mad r2.xyz, r0.wwww, l(<span class="hljs-number"><span class="hljs-number">0.000500</span></span>, <span class="hljs-number"><span class="hljs-number">0.000500</span></span>, <span class="hljs-number"><span class="hljs-number">0.000500</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), r2.xyzx <span class="hljs-number"><span class="hljs-number">236</span></span>: sample_indexable(texturecube)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r2.xyz, r2.xyzx, t0.xyzw, s0 float3 starsPerturbedDir = dirXYZ + offset * <span class="hljs-number"><span class="hljs-number">0.0005</span></span>; float3 starsColorDisturbed = texNightStars.Sample( samplerAnisoWrap, starsPerturbedDir ).rgb;</code> </pre> <br>     <i>offset</i> : <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/SAI-cLJFpfg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุญุณุงุจ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">starsColorDisturbed ุ ุงูุชูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก ุงูุฃุตุนุจ.</font></font> ุงูุตูุญุฉ! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุฅุฌุฑุงุก ุชุตุญูุญ ุฌุงูุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ูู starsColor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">starsColorDisturbed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุจุนุฏ ุฐูู ูุชู ุถุฑุจููุง:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> starsColor = <span class="hljs-built_in"><span class="hljs-built_in">pow</span></span>( starsColor, <span class="hljs-number"><span class="hljs-number">2.2</span></span> ); starsColorDisturbed = <span class="hljs-built_in"><span class="hljs-built_in">pow</span></span>( starsColorDisturbed, <span class="hljs-number"><span class="hljs-number">2.2</span></span> ); float3 starsFinal = starsColor * starsColorDisturbed;</code> </pre> <br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุฌูู - ุงูููุณุงุช ุงูุฃุฎูุฑุฉ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏููุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">starsFinal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู r1.xyz. </font><font style="vertical-align: inherit;">ูู ููุงูุฉ ูุนุงูุฌุฉ ุงููุฌูู ุ ูุญุฏุซ ูุง ููู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">256</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> r1.xyz, r1.xyzx <span class="hljs-number"><span class="hljs-number">257</span></span>: mul r1.xyz, r1.xyzx, l(<span class="hljs-number"><span class="hljs-number">2.500000</span></span>, <span class="hljs-number"><span class="hljs-number">2.500000</span></span>, <span class="hljs-number"><span class="hljs-number">2.500000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">258</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">exp</span></span> r1.xyz, r1.xyzx <span class="hljs-number"><span class="hljs-number">259</span></span>: min r1.xyz, r1.xyzx, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">260</span></span>: add r0.w, -cb0[<span class="hljs-number"><span class="hljs-number">9</span></span>].w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">261</span></span>: mul r1.xyz, r0.wwww, r1.xyzx <span class="hljs-number"><span class="hljs-number">262</span></span>: mul r1.xyz, r1.xyzx, l(<span class="hljs-number"><span class="hljs-number">10.000000</span></span>, <span class="hljs-number"><span class="hljs-number">10.000000</span></span>, <span class="hljs-number"><span class="hljs-number">10.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ุฃุณูู ุจูุซูุฑ ููุงุฑูุฉ ุจุงููุฌูู ุงููุชูุฃูุฆุฉ ูุงููุชุญุฑูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐูู ุ ูุจุฏุฃ ุจุฑูุน </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">starsFinal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูู ููุฉ 2.5 - ููุฐุง ูุณูุญ ููุง ุจุงูุชุญูู ูู ูุซุงูุฉ ุงููุฌูู. </font><font style="vertical-align: inherit;">ุฐูู ุฌุฏุง. </font><font style="vertical-align: inherit;">ุซู ูุฌุนู ุงูููู ุงูุฃูุตู ูููุฌูู ูุณุงูู float3 (1 ุ 1 ุ 1). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cb0 [9] .w ูุณุชุฎุฏู ููุชุญูู ูู ุงูุฑุคูุฉ ุงููููุฉ ูููุฌูู. </font><font style="vertical-align: inherit;">ูุฐูู ุ ูููููุง ุฃู ูุชููุน ุฃู ุชููู ูุฐู ุงููููุฉ ุฎูุงู ุงูููุงุฑ ูู 1.0 (ูุงูุชู ุชุนุทู ุงูุถุฑุจ ุจููุฏุงุฑ ุตูุฑ) ุ ููู ุงูููู - 0.0. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุงูุฉ ุ ูุฒูุฏ ูู ูุถูุญ ุงููุฌูู ุจููุฏุงุฑ 10. ููุฐุง ูู ุดูุก!</font></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก 3. ุงูุฐูู ููุชุดุฑ (ุงูุฃุฌุณุงู ูุฎุฑูุทุฉ ุงูุณุทูุน) </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชูู ุฌููุน ุงูุชุฃุซูุฑุงุช ูุงูุชูููุงุช ุงูููุตููุฉ ุณุงุจููุง ูุฑุชุจุทุฉ ูุนูููุง ุจู Witcher 3. ุชูุฌุฏ ุฃุดูุงุก ูุซู ุชุตุญูุญ ุงููุบูุฉ ุฃู ุงูุชุธููู ุฃู ุญุณุงุจ ูุชูุณุท โโุงูุณุทูุน ูู ูู ูุนุจุฉ ุญุฏูุซุฉ ุชูุฑูุจูุง. </font><font style="vertical-align: inherit;">ุญุชู ุชุฃุซูุฑ ุงูุชุณูู ูุงุณุน ุงูุงูุชุดุงุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูู ุงูุณุจุจ ูู ุฃููู ูุฑุฑุช ุฅููุงุก ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุขููุงุช ุชูุฏูู "ุบุฑูุฒุฉ witcher". </font><font style="vertical-align: inherit;">ุฌูุฑุงูุช ุณุงุญุฑ ุ ูุจุงูุชุงูู ูุฅู ูุดุงุนุฑู ุฃูุซุฑ ุญุฏุฉ ูู ุดุนูุฑ ุงูุดุฎุต ุงูุนุงุฏู. </font><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ููููู ุฃู ูุฑู ููุณูุน ุฃูุซุฑ ูู ุงูุขุฎุฑูู ุ ููุง ูุณุงุนุฏู ุจุดูู ูุจูุฑ ูู ุชุญูููุงุชู. </font><font style="vertical-align: inherit;">ุชุณูุญ ูููุงูููุง ุงูุฐูู ุงูุณุงุญุฑุฉ ููุงุนุจ ุจุชุตูุฑ ูุฐู ุงูุขุซุงุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุง ููู ุนุฑุถ ููุชุฃุซูุฑ:</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/794z0wbcI6U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุงุญุฏ ุขุฎุฑ ุ ูุน ุฅุถุงุกุฉ ุฃูุถู: </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ReB6IrOb3ic" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  ,    : ,      ( )  ,    ( ).  ,     ,      ( ). ,         ยซ  ( ). <br><br>    ,         . <br><br>       ,   โ   ,    โ        . <br><br><h3 style=";text-align:right;direction:rtl">   </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ููุช ุ ููุงู ููุนุงู ูู ุงููุงุฆูุงุช ุ ููุญู ุจุญุงุฌุฉ ุฅูู ุงูุชูููุฒ ุจููููุง. </font><font style="vertical-align: inherit;">ูู Witcher 3 ุ ูุชู ุชุทุจูู ุฐูู ุจุงุณุชุฎุฏุงู ูุฎุฒู ูุคูุช ููุงุณุชูุณู. </font><font style="vertical-align: inherit;">ุนูุฏ ุฅูุดุงุก ุดุจูุงุช GBuffer ุงูุชู ูุฌุจ ุชูููุฒูุง ูู "ุชุชุจุนุงุช" (ุฃุญูุฑ) ุ ูุชู ุชูุฏูููุง ุจุงุณุชุฎุฏุงู ุงูุงุณุชูุณู = 8. ูุชู ุชูุฏูู ุงูุดุจูุงุช ุฐุงุช ุงูููู ุงูุฃุตูุฑ ููุงุฆูุงุช "ูุซูุฑุฉ ููุงูุชูุงู" ุจุงุณุชุฎุฏุงู stencil = 4. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ ุชุธูุฑ </font><font style="vertical-align: inherit;">ุงูููุงูุงู ุงูุชุงููุงู ุฅุทุงุฑูุง ูููุฐุฌููุง </font><font style="vertical-align: inherit;">ูุน ุบุฑูุฒุฉ witcher ูุฑุฆูุฉ ููุฎุฒู ุงูุงุณุชูุณู ุงูููุงุจู:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2a6/7ed/667/2a67ed667870cd52dcf0da4f366975b6.jpg"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ac7/a84/a9c/ac7a84a9c8aa25c1685a2a5f83f7447f.jpg"></div><br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุณุชูุณู ุงูุนุงุฒูุฉ ููุฌุฒ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบุงูุจูุง ูุง ูุชู ุงุณุชุฎุฏุงู ุงููุฎุฒู ุงููุคูุช ููุงุณุชูุณู ูู ุงูุฃูุนุงุจ ูุชูููุฒ ุงูุดุจูุงุช. </font><font style="vertical-align: inherit;">ูุชู ุชุนููู ููุณ ุงููููุฉ ููุฆุงุช ูุนููุฉ ูู ุงูุดุจูุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุชูุซู ุงูููุฑุฉ ูู ุงุณุชุฎุฏุงู ูุธููุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Always</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุน ุงููุดุบู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Replace ูู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุงูุฉ ูุฌุงุญ ุงุฎุชุจุงุฑ ุงูุงุณุชูุณู ููุน ุงููุดุบู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keep</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุฌููุน ุงูุญุงูุงุช ุงูุฃุฎุฑู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅููู ููููุฉ ุชูููุฐู ุจุงุณุชุฎุฏุงู D3D11:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> D3D11_DEPTH_STENCIL_DESC depthstencilState; <span class="hljs-comment"><span class="hljs-comment">// Set depth parameters.... // Enable stencil depthstencilState.StencilEnable = TRUE; // Read &amp; write all bits depthstencilState.StencilReadMask = 0xFF; depthstencilState.StencilWriteMask = 0xFF; // Stencil operator for front face depthstencilState.FrontFace.StencilFunc = D3D11_COMPARISON_ALWAYS; depthstencilState.FrontFace.StencilDepthFailOp = D3D11_STENCIL_OP_KEEP; depthstencilState.FrontFace.StencilFailOp = D3D11_STENCIL_OP_KEEP; depthstencilState.FrontFace.StencilPassOp = D3D11_STENCIL_OP_REPLACE; // Stencil operator for back face. depthstencilState.BackFace.StencilFunc = D3D11_COMPARISON_ALWAYS; depthstencilState.BackFace.StencilDepthFailOp = D3D11_STENCIL_OP_KEEP; depthstencilState.BackFace.StencilFailOp = D3D11_STENCIL_OP_KEEP; depthstencilState.BackFace.StencilPassOp = D3D11_STENCIL_OP_REPLACE; pDevice-&gt;CreateDepthStencilState( &amp;depthstencilState, &amp;m_pDS_AssignValue );</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชูุฑูุฑ ูููุฉ stensil ุงููุฑุงุฏ ูุชุงุจุชูุง ุฅูู ุงููุฎุฒู ุงููุคูุช ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StencilRef</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงุณุชุฏุนุงุก API:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// from now on set stencil buffer values to 8 pDevCon-&gt;OMSetDepthStencilState( m_pDS_AssignValue, 8 ); ... pDevCon-&gt;DrawIndexed( ... );</span></span></code> </pre> <br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูุฏูู ุงูุณุทูุน </font></font></h4><br>              R11G11B10_FLOAT,          R  G. <br><br>        ? ,      ,    ,        . <br><br>      : <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Xbs-ZRJ7v1w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6f1/073/f03/6f1073f03172250a5b4c052ebfdfd832.jpg"></div><br>      ,    . <br><br>      :   โโ,  โ   : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/077/c17/138/077c1713805b1f95625c05fb11643c53.jpg"></div><br>       โ  : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/14f/7df/63e/14f7df63e4e1760304e4a2c6279953d1.jpg"></div><br>       โ  : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6db/379/add/6db379add4ffc7f54a047f79b608d67f.jpg"></div><br>  ,    ,    ?   -! <br><br>       -,     ,      โ8โ (  )  โ4โ. <br><br>  -  : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a60/227/b57/a60227b575f307ad5a251aa817a49963.jpg"></div><br> โฆ    : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/014/6eb/5f4/0146eb5f4da50018f5d28b4453e2424c.jpg"></div><br>      ?   -     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> .     -   : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (StencilRef &amp; StencilReadMask OP StencilValue &amp; StencilReadMask) accept pixel <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> discard pixel</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญูุซ: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StencilRef</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููููุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ุจูุงุณุทุฉ ุงุณุชุฏุนุงุก API ุ </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StencilReadMask</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูููุงุน ุงููุณุชุฎุฏู ููุฑุงุกุฉ ูููุฉ stensil (ูุงุญุธ ุฃูู ููุฌูุฏ ุนูู ููุง ุงูุฌุงูุจูู ุงูุฃูุณุฑ ูุงูุฃููู) ุ </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OP</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุนุงูู ุงูููุงุฑูุฉ ุ ุชู ุชุนูููู ุนุจุฑ API ุ </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StencilValue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูููุฉ ุงููุฎุฒู ุงููุคูุช </font><i><font style="vertical-align: inherit;">ููุงุณุชูุณู</font></i><font style="vertical-align: inherit;"> ูู ุจูุณู ุงูุญุงูู ููุฏ ุงููุนุงูุฌุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููู ุฃู ูููู ุฃููุง ูุณุชุฎุฏู AND AND ุงูุซูุงุฆูุฉ ูุญุณุงุจ ุงููุนุงููุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุงูุชุนุฑู ุนูู ุงูุฃุณุงุณูุงุช ุ ุฏุนููุง ูุฑู ููู ูุชู ุงุณุชุฎุฏุงู ูุฐู ุงููุนููุงุช ูู ููุงููุงุช ุงูุณุญุจ ูุฐู:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/164/373/d2c/164373d2c3421c708e40dc9cb26eb7c9.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุงูุฉ ุงูุงุณุชูุณู ููุขุซุงุฑ</font></font></i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1e5/3c0/ae3/1e53c0ae3680bebe785e64739c4ece43.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏููุฉ ุงูุงุณุชูุณู ููุงุฆูุงุช ูุซูุฑุฉ ููุงูุชูุงู</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุง! </font><font style="vertical-align: inherit;">ููุง ูููููุง ุฃู ูุฑู ุ ูุงููุฑู ุงููุญูุฏ ูู ReadMask. </font><font style="vertical-align: inherit;">ุฏุนููุง ุงูุชุญูู ูู ุฐูู! </font><font style="vertical-align: inherit;">ุงุณุชุจุฏู ูุฐู ุงูููู ูู ูุนุงุฏูุฉ ุงุฎุชุจุงุฑ ุงูุงุณุชูุณู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> Let StencilReadMask = <span class="hljs-number"><span class="hljs-number">0x08</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> StencilRef = <span class="hljs-number"><span class="hljs-number">0</span></span>: For a pixel with stencil = <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0x08</span></span> &lt; <span class="hljs-number"><span class="hljs-number">8</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0x08</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">8</span></span> TRUE For a pixel with stencil = <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0x08</span></span> &lt; <span class="hljs-number"><span class="hljs-number">4</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0x08</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> FALSE</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฐูู. </font><font style="vertical-align: inherit;">ููุง ุชุฑูู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูุง ููุงุฑู ูููุฉ stensil ุ ูููู ุชุญูู ููุง ุฅุฐุง ูุงู ูุฏ ุชู ุชุนููู ุฌุฒุก ูุนูู ูู ุงููุฎุฒู ุงููุคูุช ููุงุณุชูุณู. </font><font style="vertical-align: inherit;">ูู ุจูุณู ูู ุงููุฎุฒู ุงููุคูุช ุงูุงุณุชูุณู ูุฏูู ุชูุณูู uint8 ุ ูุฐูู ุงููุงุตู ุงูุฒููู ููููู ูู [0-255]. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑุชุจุท</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฌููุน </font><i><font style="vertical-align: inherit;">ููุงููุงุช DrawIndexed (36)</font></i><font style="vertical-align: inherit;"> ุจุชูุฏูู ุขุซุงุฑ ุงูุฃูุฏุงู </font><i><font style="vertical-align: inherit;">ูุชุชุจุนุงุช</font></i><font style="vertical-align: inherit;"> ุ ูุจุงูุชุงูู ูู ูุฐุง ุงูุฅุทุงุฑ ุงููุญุฏุฏ ุ ุชุญุชูู ุฎุฑูุทุฉ ุงูุณุทูุน ุนูู ุงูุดูู ุงูููุงุฆู ุงูุชุงูู:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/917/f0d/d04/917f0dd0490ef8faa829ede007838906.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ูุจู ุงุฎุชุจุงุฑ ุงูุงุณุชูุณู ููุงู ุชุธููู ุจูุณู. </font><font style="vertical-align: inherit;">ููุง 28738 ู 28748 ุงุณุชุฎุฏุงู ููุณ ุชุธููู ุจูุณู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> ps_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer cb0[<span class="hljs-number"><span class="hljs-number">2</span></span>], immediateIndexed dcl_constantbuffer cb3[<span class="hljs-number"><span class="hljs-number">8</span></span>], immediateIndexed dcl_constantbuffer cb12[<span class="hljs-number"><span class="hljs-number">214</span></span>], immediateIndexed dcl_sampler s15, <span class="hljs-function"><span class="hljs-function">mode_default </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dcl_resource_texture2d</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> t15 dcl_input_ps_siv v0.xy, position dcl_output o0.xyzw dcl_output o1.xyzw dcl_output o2.xyzw dcl_output o3.xyzw dcl_temps 2 0: mul r0.xy, v0.xyxx, cb0[1].zwzz 1: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.x, r0.xyxx, t15.xyzw, s15 2: mul r1.xyzw, v0.yyyy, cb12[211].xyzw 3: mad r1.xyzw, cb12[210].xyzw, v0.xxxx, r1.xyzw 4: mad r0.xyzw, cb12[212].xyzw, r0.xxxx, r1.xyzw 5: add r0.xyzw, r0.xyzw, cb12[213].xyzw 6: div r0.xyz, r0.xyzx, r0.wwww 7: add r0.xyz, r0.xyzx, -cb3[7].xyzx 8: dp3 r0.x, r0.xyzx, r0.xyzx 9: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">sqrt</span></span></span><span class="hljs-function"> r0.x, r0.x 10: mul r0.y, r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.120000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 11: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">log</span></span></span><span class="hljs-function"> r1.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cb3[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">6</span></span></span></span><span class="hljs-function"><span class="hljs-params">].y)</span></span></span><span class="hljs-function"> 12: mul r1.xy, r1.xxxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2.800000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.800000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 13: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">exp</span></span></span><span class="hljs-function"> r1.xy, r1.xyxx 14: mad r0.zw, r1.xxxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">120.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">120.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 15: lt r1.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.030000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, cb3[6].y 16: movc r0.xy, r1.xxxx, r0.yzyy, r0.xwxx 17: div r0.x, r0.x, r0.y 18: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">log</span></span></span><span class="hljs-function"> r0.x, r0.x 19: mul r0.x, r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.600000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 20: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">exp</span></span></span><span class="hljs-function"> r0.x, r0.x 21: add r0.x, -r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 22: max r0.x, r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 23: mul o0.xyz, r0.xxxx, cb3[0].xyzx 24: mov o0.w, cb3[0].w 25: mov o1.xyzw, cb3[1].xyzw 26: mov o2.xyzw, cb3[2].xyzw 27: mov o3.xyzw, cb3[3].xyzw 28: ret</span></span></code> </pre> <br>         render target,   24-27 . <br><br> ,    โ   (    ),  1.                 ( 2-6). <br><br>    (cb3[7].xyz โ ,   <i></i>  !),          ( 7-9). <br><br>       : <br><br> โ cb3[0].rgb โ  .     float3(0, 1, 0) ()  float3(1, 0, 0) ( ), <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- cb3 [6]. ุนุงูู ููุงุณ ุงููุณุงูุฉ. </font><font style="vertical-align: inherit;">ูุคุซุฑ ูุจุงุดุฑุฉ ุนูู ุฏุงุฆุฑุฉ ูุตู ูุทุฑูุง ูุณุทูุน ุงููุงุชุฌ ุงูููุงุฆู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ููุช ูุงุญู ุ ูุฏููุง ุตูุบ ุตุนุจุฉ ููุบุงูุฉ ูุญุณุงุจ ุงูุณุทูุน ุงุนุชูุงุฏูุง ุนูู ุงููุณุงูุฉ ุจูู ุฌูุฑุงูุช ูุงููุงุฆู. </font><font style="vertical-align: inherit;">ุฃุณุชุทูุน ุฃู ุฃูุชุฑุถ ุฃู ุฌููุน ุงููุนุงููุงุช ูุชู ุงุฎุชูุงุฑูุง ุชุฌุฑูุจูุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฅุฎุฑุงุฌ ุงูููุงุฆู ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููู</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> * </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุฏุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุจุฏู ุฑูุฒ HLSL ูุงูุชุงูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FSInput</span></span></span><span class="hljs-class"> {</span></span> float4 param0 : SV_Position; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FSOutput</span></span></span><span class="hljs-class"> {</span></span> float4 param0 : SV_Target0; float4 param1 : SV_Target1; float4 param2 : SV_Target2; float4 param3 : SV_Target3; }; <span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getWorldPos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( float2 screenPos, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth )</span></span></span><span class="hljs-function"> </span></span>{ float4 worldPos = float4(screenPos, depth, <span class="hljs-number"><span class="hljs-number">1.0</span></span>); worldPos = mul( worldPos, screenToWorld ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> worldPos.xyz / worldPos.w; } <span class="hljs-function"><span class="hljs-function">FSOutput </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EditedShaderPS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(in FSInput IN)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// * Inputs // Directly affects radius of the effect float distanceScaling = cb3_v6.y; // Color of output at the end float3 color = cb3_v0.rgb; // Sample depth float2 uv = IN.param0.xy * cb0_v1.zw; float depth = texture15.Sample( sampler15, uv ).x; // Reconstruct world position float3 worldPos = getWorldPos( IN.param0.xy, depth ); // Calculate distance from Geralt to world position of particular object float dist_geraltToWorld = length( worldPos - cb3_v7.xyz ); // Calculate two squeezing params float t0 = 1.0 + 120*pow( abs(distanceScaling), 2.8 ); float t1 = 1.0 + 120*pow( abs(distanceScaling), 0.8 ); // Determine nominator and denominator float2 params; params = (distanceScaling &gt; 0.03) ? float2(dist_geraltToWorld * 0.12, t0) : float2(dist_geraltToWorld, t1); // Distance Geralt &lt;-&gt; Object float nominator = params.x; // Hiding factor float denominator = params.y; // Raise to power of 1.6 float param = pow( params.x / params.y, 1.6 ); // Calculate final intensity float intensity = max(0.0, 1.0 - param ); // * Final outputs. // * // * This PS outputs only one color, the rest // * is redundant. I just added this to keep 1-1 ratio with // * original assembly. FSOutput OUT = (FSOutput)0; OUT.param0.xyz = color * intensity; // == redundant == OUT.param0.w = cb3_v0.w; OUT.param1 = cb3_v1; OUT.param2 = cb3_v2; OUT.param3 = cb3_v3; // =============== return OUT; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุงุฑูุฉ ุตุบูุฑุฉ ูู ุงูุฑูุฒ ุงูุฃุตูู (ูุณุงุฑ) ูุฑูุฒ ุชุธููู ุงููุฌููุน (ูููู). </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/68c/07d/1d6/68c07d1d6fd99f81cb0b3b63c9927a53.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุช ูุฐู ูู ุงููุฑุญูุฉ ุงูุฃููู ูู ุชุฃุซูุฑ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฐูู ุงูุณุงุญุฑุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ูู ุฃุจุณุท.</font></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก 4. ุงูุฐูู ููุชุดุฑ (ุฎุฑูุทุฉ ุงููุฎุทุท) </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฑุฉ ุฃุฎุฑู ุ ุฃูู ูุธุฑุฉ ุนูู ุงููุดูุฏ ุงูุฐู ูุณุชูุดูู: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2a6/7ed/667/2a67ed667870cd52dcf0da4f366975b6.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุฌุฒุก ุงูุฃูู ูู ุชุญููู ุชุฃุซูุฑ ุบุฑูุฒุฉ ุงูุณุงุญุฑุฉ ุ ุฃูุถุญุช ููู ูุชู ุฅูุดุงุก "ุฎุฑูุทุฉ ุงูุณุทูุน". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏููุง ูุณูุฌ ุจููุก ุงูุดุงุดุฉ ุจุชูุณูู R11G11B10_FLOAT ุ ูุงูุฐู ูุฏ ูุจุฏู ูุงูุชุงูู:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/917/f0d/d04/917f0dd0490ef8faa829ede007838906.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ุงูููุงุฉ ุงูุฎุถุฑุงุก "ุขุซุงุฑ ุฃูุฏุงู" ุ ุงูุฃุดูุงุก ุงูุญูุฑุงุก ุงููุซูุฑุฉ ููุงูุชูุงู ุงูุชู ูููู ูู Geralt ุงูุชูุงุนู ูุนูุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุชููู ูุฐุง ุงููููุณ ุ ูููููุง ุงูุงูุชูุงู ุฅูู ุงููุฑุญูุฉ ุงูุชุงููุฉ - ููุฏ ุฃุทูู ุนูููุง "ุฎุฑูุทุฉ ุงูููุชูุฑ".</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1bf/428/855/1bf4288554d1cef31c2607a4ca73c2bb.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูุณูุฌ ุบุฑูุจ ุจุนุถ ุงูุดูุก ุจุชูุณูู 512x512 R16G16_FLOAT. </font><font style="vertical-align: inherit;">ูู ุงูููู ุฃู ูุชู ุชูููุฐู ุจุฃุณููุจ "ping pong". </font><font style="vertical-align: inherit;">ุฎุฑูุทุฉ ุงูููุงู ูู ุงูุฅุทุงุฑ ุงูุณุงุจู ูู ุจูุงูุงุช ุงูุฅุฏุฎุงู (ุฅูู ุฌุงูุจ ุฎุฑูุทุฉ ุงูุณุทูุน) ูุฅูุดุงุก ุฎุฑูุทุฉ ููุงู ุฌุฏูุฏุฉ ูู ุงูุฅุทุงุฑ ุงูุญุงูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุชูููุฐ ุงููุฎุงุฒู ุงููุคูุชุฉ ูู Ping-pong ุจุนุฏุฉ ุทุฑู ุ ููููู ุดุฎุตูุงู ุฃุญุจ ูุง ููู (ุงูููุฏ ุงูุฒุงุฆู):</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Declarations Texture2D m_texOutlineMap[2]; uint m_outlineIndex = 0; // Rendering void Render() { pDevCon-&gt;SetInputTexture( m_texOutlineMap[m_outlineIndex] ); pDevCon-&gt;SetOutputTexture( m_texOutlineMap[!m_outlineIndex] ); ... pDevCon-&gt;Draw(...); // after draw m_outlineIndex = !m_outlineIndex; }</span></span></code> </pre> <br>  ,      <i>[m_outlineIndex]</i> ,     <i>[!m_outlineIndex]</i> ,       . <br><br>     : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> ps_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer cb3[<span class="hljs-number"><span class="hljs-number">1</span></span>], immediateIndexed dcl_sampler s0, mode_default dcl_sampler s1, <span class="hljs-function"><span class="hljs-function">mode_default </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dcl_resource_texture2d</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> t0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dcl_resource_texture2d</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> t1 dcl_input_ps linear v2.xy dcl_output o0.xyzw dcl_temps 4 0: add r0.xyzw, v2.xyxy, v2.xyxy 1: round_ni r1.xy, r0.zwzz 2: frc r0.xyzw, r0.xyzw 3: add r1.zw, r1.xxxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 4: dp2 r1.z, r1.zwzz, r1.zwzz 5: add r1.z, -r1.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 6: max r2.w, r1.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 7: dp2 r1.z, r1.xyxx, r1.xyxx 8: add r3.xyzw, r1.xyxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 9: add r1.x, -r1.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 10: max r2.x, r1.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 11: dp2 r1.x, r3.xyxx, r3.xyxx 12: dp2 r1.y, r3.zwzz, r3.zwzz 13: add r1.xy, -r1.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 14: max r2.yz, r1.xxyx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 15: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r1.xyzw, r0.zwzz, t1.xyzw, s1 16: dp4 r1.x, r1.xyzw, r2.xyzw 17: add r2.xyzw, r0.zwzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.003906</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.003906</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 18: add r0.xyzw, r0.xyzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.003906</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.003906</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 19: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r1.yz, r2.xyxx, t1.zxyw, s1 20: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r2.xy, r2.zwzz, t1.xyzw, s1 21: add r1.yz, r1.yyzy, -r2.xxyx 22: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.xy, r0.xyxx, t1.xyzw, s1 23: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.zw, r0.zwzz, t1.zwxy, s1 24: add r0.xy, -r0.zwzz, r0.xyxx 25: max r0.xy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r0.xyxx)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r1.yzyy)</span></span></span><span class="hljs-function"> 26: min r0.xy, r0.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 27: mul r0.xy, r0.xyxx, r1.xxxx 28: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.zw, v2.xyxx, t0.zwxy, s0 29: mad r0.w, r1.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.150000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r0.w 30: mad r0.x, r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.350000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r0.w 31: mad r0.x, r0.y, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.350000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r0.x 32: mul r0.yw, cb3[0].zzzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">300.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">300.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 33: mad r0.yw, v2.xxxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">150.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">150.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r0.yyyw 34: ftoi r0.yw, r0.yyyw 35: bfrev r0.w, r0.w 36: iadd r0.y, r0.w, r0.y 37: ishr r0.w, r0.y, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">13</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 38: xor r0.y, r0.y, r0.w 39: imul null, r0.w, r0.y, r0.y 40: imad r0.w, r0.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x0000ec4d</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0000000000000000000000000000000000001</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 41: imad r0.y, r0.y, r0.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">146956042240.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 42: </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">and</span></span></span><span class="hljs-function"> r0.y, r0.y, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0x7fffffff</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 43: itof r0.y, r0.y 44: mad r0.y, r0.y, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000001</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.650000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 45: add_sat r1.xyzw, v2.xyxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.001953</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.001953</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 46: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.w, r1.xyxx, t0.yzwx, s0 47: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r1.x, r1.zwzz, t0.xyzw, s0 48: add r0.w, r0.w, r1.x 49: add_sat r1.xyzw, v2.xyxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.001953</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.001953</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 50: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r1.x, r1.xyxx, t0.xyzw, s0 51: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r1.y, r1.zwzz, t0.yxzw, s0 52: add r0.w, r0.w, r1.x 53: add r0.w, r1.y, r0.w 54: mad r0.w, r0.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.250000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, -r0.z 55: mul r0.w, r0.y, r0.w 56: mul r0.y, r0.y, r0.z 57: mad r0.x, r0.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.900000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r0.x 58: mad r0.y, r0.y, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.240000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r0.x 59: add r0.x, r0.y, r0.z 60: mov_sat r0.z, cb3[0].x 61: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">log</span></span></span><span class="hljs-function"> r0.z, r0.z 62: mul r0.z, r0.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 63: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">exp</span></span></span><span class="hljs-function"> r0.z, r0.z 64: mad r0.z, r0.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.160000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.700000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 65: mul o0.xy, r0.zzzz, r0.xyxx 66: mov o0.zw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 67: ret</span></span></code> </pre> <br>  ,        ,   ,    : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">0</span></span>: add r0.xyzw, v2.xyxy, v2.xyxy <span class="hljs-number"><span class="hljs-number">1</span></span>: round_ni r1.xy, r0.zwzz <span class="hljs-number"><span class="hljs-number">2</span></span>: frc r0.xyzw, r0.xyzw <span class="hljs-number"><span class="hljs-number">3</span></span>: add r1.zw, r1.xxxy, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span>: dp2 r1.z, r1.zwzz, r1.zwzz <span class="hljs-number"><span class="hljs-number">5</span></span>: add r1.z, -r1.z, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">6</span></span>: max r2.w, r1.z, l(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">7</span></span>: dp2 r1.z, r1.xyxx, r1.xyxx <span class="hljs-number"><span class="hljs-number">8</span></span>: add r3.xyzw, r1.xyxy, l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">9</span></span>: add r1.x, -r1.z, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">10</span></span>: max r2.x, r1.x, l(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">11</span></span>: dp2 r1.x, r3.xyxx, r3.xyxx <span class="hljs-number"><span class="hljs-number">12</span></span>: dp2 r1.y, r3.zwzz, r3.zwzz <span class="hljs-number"><span class="hljs-number">13</span></span>: add r1.xy, -r1.xyxx, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">14</span></span>: max r2.yz, r1.xxyx, l(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>     floor( TextureUV * 2.0 ),    : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e25/7b3/e14/e257b3e14ac5b8a1f2b65525333924c5.jpg"></div><br>       : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParams</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float2 uv)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> d = dot(uv, uv); d = <span class="hljs-number"><span class="hljs-number">1.0</span></span> - d; d = max( d, <span class="hljs-number"><span class="hljs-number">0.0</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d; }</code> </pre> <br> ,    1.0    float2(0.0, 0.0). <br><br>       .         ,     texcoords float2(1, 0),     float2(0, 1),    โ float2(1.0, 1.0). <br><br>  ูุฐูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> float2 flooredTextureUV = <span class="hljs-built_in"><span class="hljs-built_in">floor</span></span>( <span class="hljs-number"><span class="hljs-number">2.0</span></span> * TextureUV ); ... float2 uv1 = flooredTextureUV; float2 uv2 = flooredTextureUV + float2(<span class="hljs-number"><span class="hljs-number">-1.0</span></span>, <span class="hljs-number"><span class="hljs-number">-0.0</span></span>); float2 uv3 = flooredTextureUV + float2( <span class="hljs-number"><span class="hljs-number">-0.0</span></span>, <span class="hljs-number"><span class="hljs-number">-1.0</span></span>); float2 uv4 = flooredTextureUV + float2(<span class="hljs-number"><span class="hljs-number">-1.0</span></span>, <span class="hljs-number"><span class="hljs-number">-1.0</span></span>); float4 mask; mask.x = getParams( uv1 ); mask.y = getParams( uv2 ); mask.z = getParams( uv3 ); mask.w = getParams( uv4 );</code> </pre> <br>    <i>mask</i>   ,  ,      . , <i>mask.r</i>  <i>mask.w</i> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/559/e1c/242/559e1c242221886f5c0100fa66837c31.jpg"></div><br> <i>mask.r</i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/bb5/108/a24/bb5108a241181f23a66c7f3803d33cea.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mask.w</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุตููุง ุนูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุน</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุฏุนูุง ููุชูู. </font><font style="vertical-align: inherit;">ุฎุท 15 ุนููุงุช ุฎุฑูุทุฉ ุงูุฅูุงุฑุฉ. </font><font style="vertical-align: inherit;">ูุงุญุธ ุฃู ูุณูุฌ ุงููุตูุน ูู ุงูุชูุณูู R11G11B10_FLOAT ุ ุนูู ุงูุฑุบู ูู ุฃููุง ูุฃุฎุฐ ุนููุงุช ูู ุฌููุน ููููุงุช rgba. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงูููุชุฑุถ ุฃู .a ูู 1.0f. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุญุณุงุจ Texcoords ุงููุณุชุฎุฏูุฉ ูู ูุฐู ุงูุนูููุฉ ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">frac (TextureUV * 2.0)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฐูู ุ ูุฏ ุชุจุฏู ูุชูุฌุฉ ูุฐู ุงูุนูููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุง ููู:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/955/071/c05/955071c057420f3c4b083ed174046189.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุคูุฉ ุงูุชุดุงุจูุ </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุทูุฉ ุงูุชุงููุฉ ุฐููุฉ ุฌุฏูุง - ูุชู ุชูููุฐ ุงูููุชุฌ ุงูููุงุณู ุงููููู ูู ุฃุฑุจุนุฉ ููููุงุช (dp4):</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">16</span></span>: dp4 r1.x, r1.xyzw, r2.xyzw</code> </pre> <br>           (    ),    โ    ( ),     โ  (    .w    1.0).  .     : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/37c/488/3ab/37c4883ab098cd1bc4ef2d22187f7d16.jpg"></div><br>   <i>masterFilter</i> ,      .    ,   .         โ       . <br><br>   :          (:       1.0/256.0!)          : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> fTexel = <span class="hljs-number"><span class="hljs-number">1.0</span></span> / <span class="hljs-number"><span class="hljs-number">256</span></span>; float2 sampling1 = TextureUV + float2( fTexel, <span class="hljs-number"><span class="hljs-number">0</span></span> ); float2 sampling2 = TextureUV + float2( -fTexel, <span class="hljs-number"><span class="hljs-number">0</span></span> ); float2 sampling3 = TextureUV + float2( <span class="hljs-number"><span class="hljs-number">0</span></span>, fTexel ); float2 sampling4 = TextureUV + float2( <span class="hljs-number"><span class="hljs-number">0</span></span>, -fTexel ); float2 intensity_x0 = texIntensityMap.Sample( sampler1, sampling1 ).xy; float2 intensity_x1 = texIntensityMap.Sample( sampler1, sampling2 ).xy; float2 intensity_diff_x = intensity_x0 - intensity_x1; float2 intensity_y0 = texIntensityMap.Sample( sampler1, sampling3 ).xy; float2 intensity_y1 = texIntensityMap.Sample( sampler1, sampling4 ).xy; float2 intensity_diff_y = intensity_y0 - intensity_y1; float2 maxAbsDifference = max( <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(intensity_diff_x), <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(intensity_diff_y) ); maxAbsDifference = saturate(maxAbsDifference);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุฅุฐุง ุถุงุนููุง </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุงูู ุงูุชุตููุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุงุณุทุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxAbsDifference</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/dcb/332/626/dcb332626d34f07ecf1bd85928b7d1dc.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุณูุทุฉ ุฌุฏุง ููุนุงูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุชููู ุงูุฎุทูุท ุ ูููู ุจุชุฌุฑุจุฉ ุฎุฑูุทุฉ ุงูููุงู ูู ุงูุฅุทุงุฑ ุงูุณุงุจู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูู ุฃุฌู ุงูุญุตูู ุนูู ุชุฃุซูุฑ "ุดุจุญู" ุ ูุฃุฎุฐ ุฌุฒุกูุง ูู ุงููุนููุงุช ุงููุญุณูุจุฉ ุนูู ุงููุณุงุฑ ุงูุญุงูู ูุงูููู ูู ุฎุฑูุทุฉ ุงูููุชูุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฑุญุจุงู ูุตุฏูููุง ุงููุฏูู - ุถูุถุงุก ุนุฏุฏ ุตุญูุญ. </font><font style="vertical-align: inherit;">ุฅูู ููุฌูุฏ ููุง. </font><font style="vertical-align: inherit;">ูุนููุงุช ุงูุฑุณูู ุงููุชุญุฑูุฉ (cb3 [0] .zw) ูุฃุฎูุฐุฉ ูู ุงููุฎุฒู ุงููุคูุช ุงูุซุงุจุช ูุชุชุบูุฑ ุจูุฑูุฑ ุงูููุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> float2 outlines = masterFilter * maxAbsDifference; <span class="hljs-comment"><span class="hljs-comment">// Sample outline map float2 outlineMap = texOutlineMap.Sample( samplerLinearWrap, uv ).xy; // I guess it's related with ghosting float paramOutline = masterFilter*0.15 + outlineMap.y; paramOutline += 0.35 * outlines.r; paramOutline += 0.35 * outlines.g; // input for integer noise float2 noiseWeights = cb3_v0.zw; float2 noiseInputs = 150.0*uv + 300.0*noiseWeights; int2 iNoiseInputs = (int2) noiseInputs; float noise0 = clamp( integerNoise( iNoiseInputs.x + reversebits(iNoiseInputs.y) ), -1, 1 ) + 0.65; // r0.y</span></span></code> </pre> <br> :       ,       [-1;1] (     -).    TW3   ,             . <br><br>        ,      (      1.0/512.0),      .x: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// sampling of outline map fTexel = 1.0 / 512.0; sampling1 = saturate( uv + float2( fTexel, 0 ) ); sampling2 = saturate( uv + float2( -fTexel, 0 ) ); sampling3 = saturate( uv + float2( 0, fTexel ) ); sampling4 = saturate( uv + float2( 0, -fTexel ) ); float outline_x0 = texOutlineMap.Sample( sampler0, sampling1 ).x; float outline_x1 = texOutlineMap.Sample( sampler0, sampling2 ).x; float outline_y0 = texOutlineMap.Sample( sampler0, sampling3 ).x; float outline_y1 = texOutlineMap.Sample( sampler0, sampling4 ).x; float averageOutline = (outline_x0+outline_x1+outline_y0+outline_y1) / 4.0;</span></span></code> </pre> <br> ,    ,         ,      : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// perturb with noise float frameOutlineDifference = averageOutline - outlineMap.x; frameOutlineDifference *= noise0;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุชุดููู ุงููููุฉ ูู ุฎุฑูุทุฉ ุงูููุชูุฑ "ุงููุฏููุฉ" ุจุงุณุชุฎุฏุงู ุงูุถูุถุงุก - ููุฐุง ูู ุงูุฎุท ุงูุฑุฆูุณู ุงูุฐู ูุนุทู ูุณูุฌ ุงูุฅุฎุฑุงุฌ ูุดุนุฑ ููุชูุฆ ุงูุฌุณู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซู ููุงู ุญุณุงุจุงุช ุฃุฎุฑู ุ ูุจุนุฏูุง ุ ูู ุงูููุงูุฉ ุ ูุชู ุญุณุงุจ "ุงูุชูููู".</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// the main place with gives blocky look of texture float newNoise = outlineMap.x * noise0; float newOutline = frameOutlineDifference * 0.9 + paramOutline; newOutline -= 0.24*newNoise; // 59: add r0.x, r0.y, r0.z float2 finalOutline = float2( outlineMap.x + newOutline, newOutline); // * calculate damping float dampingParam = saturate( cb3_v0.x ); dampingParam = pow( dampingParam, 100 ); float damping = 0.7 + 0.16*dampingParam; // * final multiplication float2 finalColor = finalOutline * damping; return float4(finalColor, 0, 0);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅููู ููุทุน ููุฏูู ูุตูุฑ ููุถุญ ุฎุฑูุทุฉ ุชูุตูููุฉ ููุฏ ุงูุชูููุฐ: </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/vSscLz2RYsQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ููุช ููุชููุง ุจุชุธููู ุงูุจูุณู ุงููุงูู ุ ููู ูุชููุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุดุงุฏุฑ ูุชูุงูู ูุน RenderDoc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุซูุฑ ููุงูุชูุงู (ููุฃููู ุตุฑูุญูุง ููุฒุนุฌูุง ููููุงู) ุฃูู ุนูู ุงูุฑุบู ูู ูููุฉ ุฑูุฒ ุงููุฌูุน ูุน ุงูุชุธููู ุงูุฃุตูู ูู Witcher 3 ุ ูุฅู ุงููุธูุฑ ุงูููุงุฆู ูุฎุฑูุทุฉ ุงูููุชูุฑ ูู RenderDoc ูุชุบูุฑ! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ: ูู ุงูููุทุน ุงูุฃุฎูุฑ (ุงูุธุฑ ุงูุฌุฒุก ุงูุชุงูู) ุ ุณุชุฑู ุฃูู ูุง ูุชู ุงุณุชุฎุฏุงู ุณูู ููุงุฉ r. ูุฎุฑูุทุฉ ุงูููุงู. </font><font style="vertical-align: inherit;">ููุงุฐุง ุฅุฐู ูุญุชุงุฌ ุฅูู ููุงุฉ .gุ </font><font style="vertical-align: inherit;">ุฃุนุชูุฏ ุฃู ูุฐุง ููุน ูู ุงููุฎุฒู ุงููุคูุช ุจููุฌ ุจููุฌ ูู ูุณูุฌ ูุงุญุฏ - ูุงุญุธ ุฃู .r ูุญุชูู ุนูู ููุงุฉ .g + ุจุนุถ ุงููููุฉ ุงูุฌุฏูุฏุฉ.</font></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌุฒุก 5: ุงูุฐูู ููุชุดุฑ (ููุด ูุงููุชูุฌุฉ ุงูููุงุฆูุฉ) </font></font></h2><br>  ,     :   ,   ,    ,          .        ,       . <br><br>     .    !   โ   .  :  ,     . <br><br> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2a6/7ed/667/2a67ed667870cd52dcf0da4f366975b6.jpg"></div><br><br>  ุจุนุฏ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/abf/ce7/1c4/abfce71c4469b6dcd077723d498c1685.jpg"></div><br>       : <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ReB6IrOb3ic" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  ,     ,      ,      ยซ ยป,    ( )  ,       . <br><br>     : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> ps_5_0 dcl_globalFlags refactoringAllowed dcl_constantbuffer cb0[<span class="hljs-number"><span class="hljs-number">3</span></span>], immediateIndexed dcl_constantbuffer cb3[<span class="hljs-number"><span class="hljs-number">7</span></span>], immediateIndexed dcl_sampler s0, mode_default dcl_sampler s2, <span class="hljs-function"><span class="hljs-function">mode_default </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dcl_resource_texture2d</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> t0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dcl_resource_texture2d</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> t2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dcl_resource_texture2d</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> t3 dcl_input_ps_siv v0.xy, position dcl_output o0.xyzw dcl_temps 7 0: div r0.xy, v0.xyxx, cb0[2].xyxx 1: mad r0.zw, r0.xxxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 2: mov r1.yz, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r0.zzwz)</span></span></span><span class="hljs-function"> 3: div r0.z, cb0[2].x, cb0[2].y 4: mul r1.x, r0.z, r1.y 5: add r0.zw, r1.xxxz, -cb3[2].xxxy 6: mul_sat r0.zw, r0.zzzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.555556</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.555556</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 7: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">log</span></span></span><span class="hljs-function"> r0.zw, r0.zzzw 8: mul r0.zw, r0.zzzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 9: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">exp</span></span></span><span class="hljs-function"> r0.zw, r0.zzzw 10: dp2 r0.z, r0.zwzz, r0.zwzz 11: </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">sqrt</span></span></span><span class="hljs-function"> r0.z, r0.z 12: min r0.z, r0.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 13: add r0.z, -r0.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 14: mov_sat r0.w, cb3[6].x 15: add_sat r1.xy, -r0.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.030000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.030000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 16: add r1.x, r1.y, r1.x 17: add_sat r0.xy, r0.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.970000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.970000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 18: add r0.x, r0.x, r1.x 19: add r0.x, r0.y, r0.x 20: mul r0.x, r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">20.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 21: min r0.x, r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 22: add r1.xy, v0.xyxx, v0.xyxx 23: div r1.xy, r1.xyxx, cb0[2].xyxx 24: add r1.xy, r1.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 25: dp2 r0.y, r1.xyxx, r1.xyxx 26: mul r1.xy, r0.yyyy, r1.xyxx 27: mul r0.y, r0.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.100000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 28: mul r1.xy, r0.yyyy, r1.xyxx 29: max r1.xy, r1.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-0.400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 30: min r1.xy, r1.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.400000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 31: mul r1.xy, r1.xyxx, cb3[1].xxxx 32: mul r1.zw, r1.xxxy, cb0[2].zzzw 33: mad r1.zw, v0.xxxy, cb0[1].zzzw, -r1.zzzw 34: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r2.xyz, r1.zwzz, t0.xyzw, s0 35: mul r3.xy, r1.zwzz, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 36: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.y, r3.xyxx, t2.yxzw, s2 37: mad r3.xy, r1.zwzz, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 38: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r2.w, r3.xyxx, t2.yzwx, s2 39: mul r2.w, r2.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 40: mul r3.x, cb0[0].x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.100000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 41: add r0.x, -r0.x, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 42: mul r0.xy, r0.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.030000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 43: mov r3.yzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 44: mov r4.x, r0.y 45: mov r4.y, r2.w 46: mov r4.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 47: loop 48: ige r4.w, r4.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">8</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 49: breakc_nz r4.w 50: itof r4.w, r4.z 51: mad r4.w, r4.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.785375</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, -r3.x 52: sincos r5.x, r6.x, r4.w 53: mov r6.y, r5.x 54: mul r5.xy, r0.xxxx, r6.xyxx 55: mad r5.zw, r5.xxxy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r1.zzzw 56: mul r6.xy, r5.zwzz, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 57: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r4.w, r6.xyxx, t2.yzwx, s2 58: mad r4.x, r4.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r4.x 59: mad r5.zw, r5.zzzw, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.500000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 60: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r4.w, r5.zwzz, t2.yzwx, s2 61: mad r4.y, r4.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r4.y 62: mad r5.xy, r5.xyxx, r1.xyxx, r1.zwzz 63: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r5.xyz, r5.xyxx, t0.xyzw, s0 64: mad r3.yzw, r5.xxyz, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.125000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r3.yyzw 65: iadd r4.z, r4.z, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 66: endloop 67: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample_indexable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(texture2d)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> r0.xy, r1.zwzz, t3.xyzw, s0 68: mad_sat r0.xy, -r0.xyxx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.800000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.750000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r4.xyxx 69: dp3 r1.x, r3.yzwy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.300000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.300000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.300000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 70: add r1.yzw, -r1.xxxx, r3.yyzw 71: mad r1.xyz, r0.zzzz, r1.yzwy, r1.xxxx 72: mad r1.xyz, r1.xyzx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.600000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.600000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.600000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, -r2.xyzx 73: mad r1.xyz, r0.wwww, r1.xyzx, r2.xyzx 74: mul r0.yzw, r0.yyyy, cb3[4].xxyz 75: mul r2.xyz, r0.xxxx, cb3[5].xyzx 76: mad r0.xyz, r0.yzwy, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.200000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.200000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.200000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">, r2.xyzx 77: mov_sat r2.xyz, r0.xyzx 78: dp3_sat r0.x, r0.xyzx, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 79: add r0.yzw, -r1.xxyz, r2.xxyz 80: mad o0.xyz, r0.xxxx, r0.yzwy, r1.xyzx 81: mov o0.w, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">l</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.000000</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> 82: ret</span></span></code> </pre> <br> 82  โ ,    ! <br><br>      : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// *** Inputs // * Zoom amount, always 1 float zoomAmount = cb3_v1.x; // Another value which affect fisheye effect // but always set to float2(1.0, 1.0). float2 amount = cb0_v2.zw; // Elapsed time in seconds float time = cb0_v0.x; // Colors of witcher senses float3 colorInteresting = cb3_v5.rgb; float3 colorTraces = cb3_v4.rgb; // Was always set to float2(0.0, 0.0). // Setting this to higher values // makes "grey corners" effect weaker. float2 offset = cb3_v2.xy; // Dimensions of fullscreen float2 texSize = cb0_v2.xy; float2 invTexSize = cb0_v1.zw; // Main value which causes fisheye effect [0-1] const float fisheyeAmount = saturate( cb3_v6.x );</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุฉ ุงูุฃุณุงุณูุฉ ุงููุณุคููุฉ ุนู ุญุฌู ุงูุชุฃุซูุฑ ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fisheyeAmount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุฃุนุชูุฏ ุฃูู ูุฑุชูุน ุชุฏุฑูุฌูุงู ูู 0.0 ุฅูู 1.0 ุนูุฏูุง ูุจุฏุฃ ุฌูุฑุงูุช ูู ุงุณุชุฎุฏุงู ุบุฑูุฒุชู. </font><font style="vertical-align: inherit;">ูุง ุชุชุบูุฑ ุจููุฉ ุงูููู ูุซูุฑูุง ุ ููููู ุฃุธู ุฃู ุจุนุถูุง ุณูููู ูุฎุชูููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุจุชุนุทูู ุชุฃุซูุฑ ููุด ูู ุงูุฎูุงุฑุงุช (ูู ุฃูุญุต ูุฐุง). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูู ูุง ูุญุฏุซ ููุง ูู ุฃู ุงูุชุธููู ูุญุณุจ ุงูููุงุน ุงููุณุคูู ุนู ุงูุฒูุงูุง ุงูุฑูุงุฏูุฉ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">0</span></span>: div r0.xy, v0.xyxx, cb0[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyxx <span class="hljs-number"><span class="hljs-number">1</span></span>: mad r0.zw, r0.xxxy, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.000000</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">2</span></span>: mov r1.yz, <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(r0.zzwz) <span class="hljs-number"><span class="hljs-number">3</span></span>: div r0.z, cb0[<span class="hljs-number"><span class="hljs-number">2</span></span>].x, cb0[<span class="hljs-number"><span class="hljs-number">2</span></span>].y <span class="hljs-number"><span class="hljs-number">4</span></span>: mul r1.x, r0.z, r1.y <span class="hljs-number"><span class="hljs-number">5</span></span>: add r0.zw, r1.xxxz, -cb3[<span class="hljs-number"><span class="hljs-number">2</span></span>].xxxy <span class="hljs-number"><span class="hljs-number">6</span></span>: mul_sat r0.zw, r0.zzzw, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.555556</span></span>, <span class="hljs-number"><span class="hljs-number">0.555556</span></span>) <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> r0.zw, r0.zzzw <span class="hljs-number"><span class="hljs-number">8</span></span>: mul r0.zw, r0.zzzw, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">2.500000</span></span>, <span class="hljs-number"><span class="hljs-number">2.500000</span></span>) <span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">exp</span></span> r0.zw, r0.zzzw <span class="hljs-number"><span class="hljs-number">10</span></span>: dp2 r0.z, r0.zwzz, r0.zwzz <span class="hljs-number"><span class="hljs-number">11</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span> r0.z, r0.z <span class="hljs-number"><span class="hljs-number">12</span></span>: min r0.z, r0.z, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">13</span></span>: add r0.z, -r0.z, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู HLSL ุ ูููููุง ูุชุงุจุฉ ูุฐุง ุนูู ุงููุญู ุงูุชุงูู: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// Main uv float2 uv = PosH.xy / texSize; // Scale at first from [0-1] to [-1;1], then calculate abs float2 uv3 = abs( uv * 2.0 - 1.0); // Aspect ratio float aspectRatio = texSize.x / texSize.y; // * Mask used to make corners grey float mask_gray_corners; { float2 newUv = float2( uv3.x * aspectRatio, uv3.y ) - offset; newUv = saturate( newUv / 1.8 ); newUv = pow(newUv, 2.5); mask_gray_corners = 1-min(1.0, length(newUv) ); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃููุงู ุ ุงููุงุตู ุงูุฒููู [-1ุ </font><font style="vertical-align: inherit;">1] ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูููููุง ุงููุทููุฉ. </font><font style="vertical-align: inherit;">ุซู ููุงู "ุถุบุท" ุตุนุจุฉ. </font><font style="vertical-align: inherit;">ุงูููุงุน ุงูููุงุฆู ูู ููุง ููู:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ba9/320/0d4/ba93200d4f20e0a5bc361e96994b525b.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุฃุนูุฏ ุฅูู ูุฐุง ุงูููุงุน ูุงุญููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุณูู ุฃุชุฎุทู ุนู ูุตุฏ ุจุถุนุฉ ุฃุณุทุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุฃุฏุฑุณ ุจุนูุงูุฉ ุงูููุฏ ุงููุณุคูู ุนู ุชุฃุซูุฑ ุงูุชูุจูุฑ / ุงูุชุตุบูุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">22</span></span>: add r1.xy, v0.xyxx, v0.xyxx <span class="hljs-number"><span class="hljs-number">23</span></span>: div r1.xy, r1.xyxx, cb0[<span class="hljs-number"><span class="hljs-number">2</span></span>].xyxx <span class="hljs-number"><span class="hljs-number">24</span></span>: add r1.xy, r1.xyxx, l(<span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">25</span></span>: dp2 r0.y, r1.xyxx, r1.xyxx <span class="hljs-number"><span class="hljs-number">26</span></span>: mul r1.xy, r0.yyyy, r1.xyxx <span class="hljs-number"><span class="hljs-number">27</span></span>: mul r0.y, r0.w, l(<span class="hljs-number"><span class="hljs-number">0.100000</span></span>) <span class="hljs-number"><span class="hljs-number">28</span></span>: mul r1.xy, r0.yyyy, r1.xyxx <span class="hljs-number"><span class="hljs-number">29</span></span>: max r1.xy, r1.xyxx, l(<span class="hljs-number"><span class="hljs-number">-0.400000</span></span>, <span class="hljs-number"><span class="hljs-number">-0.400000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">30</span></span>: min r1.xy, r1.xyxx, l(<span class="hljs-number"><span class="hljs-number">0.400000</span></span>, <span class="hljs-number"><span class="hljs-number">0.400000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">31</span></span>: mul r1.xy, r1.xyxx, cb3[<span class="hljs-number"><span class="hljs-number">1</span></span>].xxxx <span class="hljs-number"><span class="hljs-number">32</span></span>: mul r1.zw, r1.xxxy, cb0[<span class="hljs-number"><span class="hljs-number">2</span></span>].zzzw <span class="hljs-number"><span class="hljs-number">33</span></span>: mad r1.zw, v0.xxxy, cb0[<span class="hljs-number"><span class="hljs-number">1</span></span>].zzzw, -r1.zzzw</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃููุงู ุ ูุชู ุญุณุงุจ ุฅุญุฏุงุซูุงุช ูุณูุฌ "ุงููุถุงุนูุฉ" ููุชู ุชูููุฐ ุงูุทุฑุญ 2 (1 ุ 1): </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> float2 uv4 = <span class="hljs-number"><span class="hljs-number">2</span></span> * PosH.xy; uv4 /= cb0_v2.xy; uv4 -= float2(<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ุชุตูุฑ ูุซู texcoord ุนูู ุงููุญู ุงูุชุงูู: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/70a/0b0/dfe/70a0b0dfeb9ca86eb86f137ac96c9811.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุญุณุงุจ ููุทุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูููุชุฌ ุงูุนุฏุฏูุฉ </font><i><font style="vertical-align: inherit;">(uv4 ุ uv4)</font></i><font style="vertical-align: inherit;"> ุ ูุงูุชู ุชุนุทููุง ุงูููุงุน:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1f0/b6c/0a9/1f0b6c0a97ed9ad17a6bc17f3ebcf6c6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฐู ูุณุชุฎุฏู ูุถุฑุจ texcoords ุฃุนูุงู: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e34/27e/5f2/e3427e5f2a925c8a78f77d81c5840da4.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงู: ูู ุงูุฒุงููุฉ ุงููุณุฑู ุงูุนููุง (ุจูุณู ุฃุณูุฏ) ุงูููู ุณุงูุจุฉ. </font><font style="vertical-align: inherit;">ูุชู ุนุฑุถูุง ุจุงูููู ุงูุฃุณูุฏ (0.0) ุจุณุจุจ ุงูุฏูุฉ ุงููุญุฏูุฏุฉ ูุชูุณูู R11G11B10_FLOAT. </font><font style="vertical-align: inherit;">ูุง ูุญุชูู ุนูู ุนูุงูุฉ ุจุช ุ ูุฐูู ูุง ูููู ุชุฎุฒูู ุงูููู ุงูุณูุจูุฉ ูููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซู ูุชู ุญุณุงุจ ูุนุงูู ุงูุชูููู (ููุง ููุช ุฃุนูุงู ุ </font><font style="vertical-align: inherit;">ูุฎุชูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fisheyeAmount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู 0.0 ุฅูู 1.0).</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> attenuation = fisheyeAmount * <span class="hljs-number"><span class="hljs-number">0.1</span></span>; uv4 *= attenuation;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซู ูุชู ุชูููุฐ ุงูุชูููุฏ (ูุญุฏ ุฃูุตู / ุฏูููุฉ) ูุถุฑุจ ูุงุญุฏ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจุงูุชุงูู ุ ูุชู ุญุณุงุจ ุงูุฅุฒุงุญุฉ. </font><font style="vertical-align: inherit;">ูุญุณุงุจ ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ุงูููุงุฆูุฉ ุ ูุงูุชู ุณูุชู ุงุณุชุฎุฏุงููุง </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃุฎุฐ</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนููุงุช ูู ูุณูุฌ ุงูููู ุ ูุฅููุง ุจุจุณุงุทุฉ ูููู ุจุฅุฌุฑุงุก ุงูุทุฑุญ: </font><i><font style="vertical-align: inherit;">float2 colorUV = mainUv - offsetุ </font></i></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนู ุทุฑูู ุฃุฎุฐ ุนููุงุช </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ colorUV</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงููุฏุฎูุฉ </font><font style="vertical-align: inherit;">ุ ูุญุตู ุนูู ุตูุฑุฉ ูุดููุฉ ุจุงููุฑุจ ูู ุงูุฒูุงูุง:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/bbc/4f4/967/bbc4f4967c3bf008bf3692af3eb54d69.jpg"></div><br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุญุฏูุฏ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ูุฃุฎุฐ ุนููุงุช ูู ุฎุฑูุทุฉ ุงูููุชูุฑ ููุนุซูุฑ ุนูู ุงูุฃููุฉ. </font><font style="vertical-align: inherit;">ุงูุฃูุฑ ุจุณูุท ููุบุงูุฉ ุ ุฃููุงู ุ ูุฌุฏ texcoords ูุฃุฎุฐ ุนููุงุช ูู ูุนุงูู ุงูุฃุดูุงุก ุงููุซูุฑุฉ ููุงูุชูุงู ุ ุซู ุงูููุงู ุจููุณ ุงูุดูุก ูู ุงููุณุงุฑุงุช:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// * Sample outline map // interesting objects (upper left square) float2 outlineUV = colorUV * 0.5; float outlineInteresting = texture2.Sample( sampler2, outlineUV ).x; // r0.y // traces (upper right square) outlineUV = colorUV * 0.5 + float2(0.5, 0.0); float outlineTraces = texture2.Sample( sampler2, outlineUV ).x; // r2.w outlineInteresting /= 8.0; // r4.x outlineTraces /= 8.0; // r4.y</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a08/746/0a3/a087460a37b1b88733e1fef632a566db.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุงุช ูุซูุฑุฉ ููุงูุชูุงู ูู ุฎุฑูุทุฉ ููุงู</font></font></i> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0c6/edc/995/0c6edc995e2f6cb4c6aeec6701c30ba3.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุขุซุงุฑ ูู ุฎุฑูุทุฉ ุงูููุชูุฑ</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃููุง ูุฃุฎุฐ ุนููุงุช ูู ููุงุฉ .x ููุท ูู ุฎุฑูุทุฉ ุงูููุชูุฑ ููุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงููุฑุจุนุงุช ุงูุนููุง ููุท.</font></font><br><br><h4 style=";text-align:right;direction:rtl">  ุญุฑูุฉ </h4><br>         ,     .        8        ,    . <br><br> ,        8.0. <br><br>         [0-1] <sup>2</sup> ,     1       : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3e3/8f1/de3/3e38f1de3016256205a5aa9199bb3a0d.jpg"></div><br>     ,  ,    .         15-21.         ,       (, -   ).     (15-21)   (41-42): <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">15</span></span>: add_sat r1.xy, -r0.xyxx, l(<span class="hljs-number"><span class="hljs-number">0.030000</span></span>, <span class="hljs-number"><span class="hljs-number">0.030000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">16</span></span>: add r1.x, r1.y, r1.x <span class="hljs-number"><span class="hljs-number">17</span></span>: add_sat r0.xy, r0.xyxx, l(<span class="hljs-number"><span class="hljs-number">-0.970000</span></span>, <span class="hljs-number"><span class="hljs-number">-0.970000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">18</span></span>: add r0.x, r0.x, r1.x <span class="hljs-number"><span class="hljs-number">19</span></span>: add r0.x, r0.y, r0.x <span class="hljs-number"><span class="hljs-number">20</span></span>: mul r0.x, r0.x, l(<span class="hljs-number"><span class="hljs-number">20.000000</span></span>) <span class="hljs-number"><span class="hljs-number">21</span></span>: min r0.x, r0.x, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) ... <span class="hljs-number"><span class="hljs-number">41</span></span>: add r0.x, -r0.x, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">42</span></span>: mul r0.xy, r0.xyxx, l(<span class="hljs-number"><span class="hljs-number">0.030000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ุชุฑูู ุ ูุง ูุนุชุจุฑ ุณูู ุงูุฅุทุงุฑุงุช ูู [0.00 - 0.03] ุจุฌุงูุจ ูู ุณุทุญ ุ ูููุฎุต ููููุง ุ ูุงุถุฑุจูุง 20 ูุดุจุนุชูุง. </font><font style="vertical-align: inherit;">ุฅููู ุงูุดูู ุงูุฐู ุชุจุฏู ุนููู ุจุนุฏ ุงูุฎุทูุท 15-21:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5b2/080/809/5b20808099b641be7510714ffd45a737.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฅููู ููู ุจุนุฏ ุงูุณุทุฑ 41: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fa8/51d/853/fa851d8539027d54d2874472d5952448.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุณุทุฑ 42 ุ ูุถุฑุจ ูุฐุง ูู 0.03 ุ ูุฐู ุงููููุฉ ูู ูุตู ูุทุฑ ุงูุฏุงุฆุฑุฉ ููุดุงุดุฉ ุจุฃููููุง. </font><font style="vertical-align: inherit;">ููุง ุชุฑูู ุ ุฃูุฑุจ ุฅูู ุญูุงู ุงูุดุงุดุฉ ุ ูุตุจุญ ูุตู ุงููุทุฑ ุฃุตุบุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูููููุง ุฃู ููุธุฑ ุฅูู ุฑูุฒ ุงููุฌููุน ุงููุณุคูู ุนู ุงูุญุฑูุฉ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">40</span></span>: mul r3.x, cb0[<span class="hljs-number"><span class="hljs-number">0</span></span>].x, l(<span class="hljs-number"><span class="hljs-number">0.100000</span></span>) <span class="hljs-number"><span class="hljs-number">41</span></span>: add r0.x, -r0.x, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">42</span></span>: mul r0.xy, r0.xyxx, l(<span class="hljs-number"><span class="hljs-number">0.030000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">43</span></span>: mov r3.yzw, l(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">44</span></span>: mov r4.x, r0.y <span class="hljs-number"><span class="hljs-number">45</span></span>: mov r4.y, r2.w <span class="hljs-number"><span class="hljs-number">46</span></span>: mov r4.z, l(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-number"><span class="hljs-number">47</span></span>: loop <span class="hljs-number"><span class="hljs-number">48</span></span>: ige r4.w, r4.z, l(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-number"><span class="hljs-number">49</span></span>: breakc_nz r4.w <span class="hljs-number"><span class="hljs-number">50</span></span>: itof r4.w, r4.z <span class="hljs-number"><span class="hljs-number">51</span></span>: mad r4.w, r4.w, l(<span class="hljs-number"><span class="hljs-number">0.785375</span></span>), -r3.x <span class="hljs-number"><span class="hljs-number">52</span></span>: sincos r5.x, r6.x, r4.w <span class="hljs-number"><span class="hljs-number">53</span></span>: mov r6.y, r5.x <span class="hljs-number"><span class="hljs-number">54</span></span>: mul r5.xy, r0.xxxx, r6.xyxx <span class="hljs-number"><span class="hljs-number">55</span></span>: mad r5.zw, r5.xxxy, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>), r1.zzzw <span class="hljs-number"><span class="hljs-number">56</span></span>: mul r6.xy, r5.zwzz, l(<span class="hljs-number"><span class="hljs-number">0.500000</span></span>, <span class="hljs-number"><span class="hljs-number">0.500000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">57</span></span>: sample_indexable(texture2d)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r4.w, r6.xyxx, t2.yzwx, s2 <span class="hljs-number"><span class="hljs-number">58</span></span>: mad r4.x, r4.w, l(<span class="hljs-number"><span class="hljs-number">0.125000</span></span>), r4.x <span class="hljs-number"><span class="hljs-number">59</span></span>: mad r5.zw, r5.zzzw, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.500000</span></span>, <span class="hljs-number"><span class="hljs-number">0.500000</span></span>), l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.500000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">60</span></span>: sample_indexable(texture2d)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r4.w, r5.zwzz, t2.yzwx, s2 <span class="hljs-number"><span class="hljs-number">61</span></span>: mad r4.y, r4.w, l(<span class="hljs-number"><span class="hljs-number">0.125000</span></span>), r4.y <span class="hljs-number"><span class="hljs-number">62</span></span>: mad r5.xy, r5.xyxx, r1.xyxx, r1.zwzz <span class="hljs-number"><span class="hljs-number">63</span></span>: sample_indexable(texture2d)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r5.xyz, r5.xyxx, t0.xyzw, s0 <span class="hljs-number"><span class="hljs-number">64</span></span>: mad r3.yzw, r5.xxyz, l(<span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>, <span class="hljs-number"><span class="hljs-number">0.125000</span></span>), r3.yyzw <span class="hljs-number"><span class="hljs-number">65</span></span>: iadd r4.z, r4.z, l(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">66</span></span>: endloop</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนูุง ูุจูู ููุง ููุฏุฉ ุฏูููุฉ. ูู ุงูุณุทุฑ 40 ุ ูุญุตู ุนูู ูุนุงูู ุงูููุช - ููุท ุจุนุฏ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุถุงุก ุงูููุช * 0.1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ูู ุงูุณุทุฑ 43 ุ ูุฏููุง ูุฎุฒู ูุคูุช ููููุณ ุงูุฃููุงู ุงูุฐู ุชู ุงูุญุตูู ุนููู ุฏุงุฎู ุงูุญููุฉ. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r0.x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุฃุณุทุฑ 41-42) ุ ููุง ูุนุฑู ุงูุขู ุ ูุตู ูุทุฑ ุงูุฏุงุฆุฑุฉ. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r4.x</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุณุทุฑ 44) ูู ุงูุฎุทูุท ุงูุนุฑูุถุฉ ูููุงุฆูุงุช ุงููุซูุฑุฉ ููุงูุชูุงู ุ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r4.y</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุณุทุฑ 45) ูู ุงูุฎุทูุท ุงูุนุฑูุถุฉ ูููุณุงุฑุงุช (ููุณููุฉ ุณุงุจููุง ุนูู 8!) ุ ู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r4.z</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุณุทุฑ 46) ูู ุนุฏุงุฏ ุงูุญููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ุชุชููุน ุ ุชุญุชูู ุงูุญููุฉ ุนูู 8 ุชูุฑุงุฑุงุช. ูุจุฏุฃ ุจุญุณุงุจ ุงูุฒุงููุฉ ูู ุฑุงุฏูุงู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i * PI_4</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุชู ุชุนุทููุง 2 * PI - ุฏุงุฆุฑุฉ ูุงููุฉ. ุฒุงููุฉ ูุดููุฉ ูุน ูุฑูุฑ ุงูููุช.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู sincos ุ ูุญุฏุฏ ููุทุฉ ุฃุฎุฐ ุงูุนููุงุช (ุฏุงุฆุฑุฉ ุงููุญุฏุฉ) ููุบูุฑ ูุตู ุงููุทุฑ ุจุงุณุชุฎุฏุงู ุงูุถุฑุจ (ุงูุณุทุฑ 54). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ูุฏูุฑ ุญูู ุงูุจููุณู ูู ุฏุงุฆุฑุฉ ููุฎุชุจุฑ ููุงูุญูุง ูุฃููุงููุง. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุฏูุฑุฉ ุ ูุญุตู ุนูู ูุชูุณุท โโุงูููู (ุจุณุจุจ ุงููุณูุฉ ุนูู 8) ููุฎุทูุท ูุงูุฃููุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> timeParam = time * <span class="hljs-number"><span class="hljs-number">0.1</span></span>; <span class="hljs-comment"><span class="hljs-comment">// adjust circle radius circle_radius = 1.0 - circle_radius; circle_radius *= 0.03; float3 color_circle_main = float3(0.0, 0.0, 0.0); [loop] for (int i=0; 8 &gt; i; i++) { // full 2*PI = 360 angles cycle const float angleRadians = (float) i * PI_4 - timeParam; // unit circle float2 unitCircle; sincos(angleRadians, unitCircle.y, unitCircle.x); // unitCircle.x = cos, unitCircle.y = sin // adjust radius unitCircle *= circle_radius; // * base texcoords (circle) - note we also scale radius here by 8 // * probably because of dimensions of outline map. // line 55 float2 uv_outline_base = colorUV + unitCircle / 8.0; // * interesting objects (circle) float2 uv_outline_interesting_circle = uv_outline_base * 0.5; float outline_interesting_circle = texture2.Sample( sampler2, uv_outline_interesting_circle ).x; outlineInteresting += outline_interesting_circle / 8.0; // * traces (circle) float2 uv_outline_traces_circle = uv_outline_base * 0.5 + float2(0.5, 0.0); float outline_traces_circle = texture2.Sample( sampler2, uv_outline_traces_circle ).x; outlineTraces += outline_traces_circle / 8.0; // * sample color texture (zooming effect) with perturbation float2 uv_color_circle = colorUV + unitCircle * offsetUV; float3 color_circle = texture0.Sample( sampler0, uv_color_circle ).rgb; color_circle_main += color_circle / 8.0; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุชู ุชูููุฐ ุฃุฎุฐ ุนููุงุช ุงูุฃููุงู ุจููุณ ุงูุทุฑููุฉ ุ </font><font style="vertical-align: inherit;">ููููุง ุณูุถูู ุฅุฒุงุญุฉ ูุถุฑูุจุฉ ูู ุฏุงุฆุฑุฉ "ููุฑุฏุฉ" </font><font style="vertical-align: inherit;">ุฅูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">colorUU</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฃุณุงุณูุฉ </font><font style="vertical-align: inherit;">.</font></font><br><br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณุทูุน </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ุงูุฏูุฑุฉ ุ ูููู ุจุชุฌุฑุจุฉ ุฎุฑูุทุฉ ุงูุณุทูุน ูุชุบููุฑ ููู ุงูุณุทูุน ุงูููุงุฆู (ูุฃู ุฎุฑูุทุฉ ุงูุณุทูุน ูุง ุชุนุฑู ุดูุฆูุง ุนู ุงููุฎุทุทุงุช): </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">67</span></span>: sample_indexable(texture2d)(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) r0.xy, r1.zwzz, t3.xyzw, s0 <span class="hljs-number"><span class="hljs-number">68</span></span>: mad_sat r0.xy, -r0.xyxx, l(<span class="hljs-number"><span class="hljs-number">0.800000</span></span>, <span class="hljs-number"><span class="hljs-number">0.750000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), r4.xyxx</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฏ HLSL: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// * Sample intensity map float2 intensityMap = texture3.Sample( sampler0, colorUV ).xy; float intensityInteresting = intensityMap.r; float intensityTraces = intensityMap.g; // * Adjust outlines float mainOutlineInteresting = saturate( outlineInteresting - 0.8*intensityInteresting ); float mainOutlineTraces = saturate( outlineTraces - 0.75*intensityTraces );</span></span></code> </pre> <br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฒูุงูุง ุงูุฑูุงุฏูุฉ ูุงูุชูุญูุฏ ุงูููุงุฆู ููู ุดูุก </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชู ุญุณุงุจ ุงูููู ุงูุฑูุงุฏู ุงูุฃูุฑุจ ุฅูู ุงูุฒูุงูุง ุจุงุณุชุฎุฏุงู ุงูููุชุฌ ุงูููุงุณู (ุฎุท ุงูุชุฌููุน 69): </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// * Greyish color float3 color_greyish = dot( color_circle_main, float3(0.3, 0.3, 0.3) ).xxx;</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b55/9a1/e0f/b559a1e0f3ae66041cdf3f9f48ba4b06.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซู ุงุซููู ูู ุงูุงุณุชููุงุก ูุชุงุจุนุฉ. </font><font style="vertical-align: inherit;">ูุฌูุน ุงูุฃูู ุจูู ุงูุฑูุงุฏู ูุน "ุงูููู ูู ุงูุฏุงุฆุฑุฉ" ุจุงุณุชุฎุฏุงู ุงูููุงุน ุงูุฃูู ุงูุฐู ูุตูุชู ุ ูุจุงูุชุงูู ุชุตุจุญ ุงูุฒูุงูุง ุฑูุงุฏูุฉ. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุงู ูุนุงูู 0.6 ุ ููุง ูููู ูู ุชุดุจุน ุงูุตูุฑุฉ ุงูููุงุฆูุฉ:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c6a/389/202/c6a38920286de2fe269224a6b26ebd77.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุซุงูู ูุฌูุน ุจูู ุงูููู ุงูุฃูู ูุน ูุง ุณุจู ุจุงุณุชุฎุฏุงู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fisheyeAmount</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฐุง ูุนูู ุฃู ุงูุดุงุดุฉ ุชุตุจุญ ุฃูุซุฑ ูุชุงูุฉ ุชุฏุฑูุฌูุง (ุจุณุจุจ ุงูุถุฑุจ ุจูุณุจุฉ 0.6) ูุงูุฑูุงุฏู ูู ุงูุฒูุงูุง! </font><font style="vertical-align: inherit;">ุงูุฑุงุฆุนุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HLSL:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// * Determine main color. // (1) At first, combine "circled" color with gray one. // Now we have have greyish corners here. float3 mainColor = lerp( color_greyish, color_circle_main, mask_gray_corners ) * 0.6; // (2) Then mix "regular" color with the above. // Please note this operation makes corners gradually gray (because fisheyeAmount rises from 0 to 1) // and gradually darker (because of 0.6 multiplier). mainColor = lerp( color, mainColor, fisheyeAmount );</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูููููุง ุงูุงูุชูุงู ุฅูู ุฅุถุงูุฉ ูุนุงูู ุงููุงุฆูุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุฃุฎุฐ ุงูุฃููุงู (ุงูุฃุญูุฑ ูุงูุฃุตูุฑ) ูู ุงููุฎุฒู ุงููุคูุช ุงูุซุงุจุช.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// * Determine color of witcher senses float3 senses_traces = mainOutlineTraces * colorTraces; float3 senses_interesting = mainOutlineInteresting * colorInteresting; float3 senses_total = 1.2 * senses_traces + senses_interesting;</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9ca/4ea/52d/9ca4ea52df8a22889828414ee2bfde05.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูู! </font><font style="vertical-align: inherit;">ูุญู ุชูุฑูุจุง ูู ุฎุท ุงูููุงูุฉ! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏููุง ุงูููู ุงูููุงุฆู ุ ููุงู ููู ุบุฑูุฒุฉ ุงูุณุงุญุฑุฉ ... ูุจูู ุงูุฌูุน ุจููููุง ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฐุง ุ ุฅุถุงูุฉ ุจุณูุทุฉ ููุณุช ููุงุณุจุฉ. </font><font style="vertical-align: inherit;">ุฃููุงู ูุญุณุจ ุงูููุชุฌ ุงูููุงุณู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">78</span></span>: dp3_sat r0.x, r0.xyzx, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dot_senses_total = saturate( dot(senses_total, float3(<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) ) );</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฐู ูุจุฏู ูุซู ูุฐุง: </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2ae/357/099/2ae357099e5bfe5185d16103f87a6b69.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุณุชุฎุฏู ูุฐู ุงูููู ูู ุงูููุงูุฉ ููุชุญุฑูู ุจูู ุงูููู ูููู ุงูุณุงุญุฑุฉ (ุงููุดุจุนุฉ): </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-number"><span class="hljs-number">76</span></span>: mad r0.xyz, r0.yzwy, l(<span class="hljs-number"><span class="hljs-number">1.200000</span></span>, <span class="hljs-number"><span class="hljs-number">1.200000</span></span>, <span class="hljs-number"><span class="hljs-number">1.200000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>), r2.xyzx <span class="hljs-number"><span class="hljs-number">77</span></span>: mov_sat r2.xyz, r0.xyzx <span class="hljs-number"><span class="hljs-number">78</span></span>: dp3_sat r0.x, r0.xyzx, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">1.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>) <span class="hljs-number"><span class="hljs-number">79</span></span>: add r0.yzw, -r1.xxyz, r2.xxyz <span class="hljs-number"><span class="hljs-number">80</span></span>: mad o0.xyz, r0.xxxx, r0.yzwy, r1.xyzx <span class="hljs-number"><span class="hljs-number">81</span></span>: mov o0.w, l(<span class="hljs-number"><span class="hljs-number">1.000000</span></span>) <span class="hljs-number"><span class="hljs-number">82</span></span>: ret float3 senses_total = <span class="hljs-number"><span class="hljs-number">1.2</span></span> * senses_traces + senses_interesting; <span class="hljs-comment"><span class="hljs-comment">// * Final combining float3 senses_total_sat = saturate(senses_total); float dot_senses_total = saturate( dot(senses_total, float3(1.0, 1.0, 1.0) ) ); float3 finalColor = lerp( mainColor, senses_total_sat, dot_senses_total ); return float4( finalColor, 1.0 );</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/abf/ce7/1c4/abfce71c4469b6dcd077723d498c1685.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฐุง ูู ุดูุก. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุธููู ูุงูู ูุชุงุญ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฑูุฉ ุจูู ุจูุฏู (ูุณุงุฑ) ูุชุธููู ุงูุฃุตูู (ูููู):</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/433/5be/2e4/4335be2e49bd901916567734cc0485a5.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุชููู ุฃู ุชุณุชูุชุนูุง ุจูุฐุง ุงูููุงู! </font><font style="vertical-align: inherit;">ููุงู ุงูุนุฏูุฏ ูู ุงูุฃููุงุฑ ุงูุฑุงุฆุนุฉ ูู ุขููุงุช "ุบุฑูุฒุฉ witcher" ุ ูุงููุชูุฌุฉ ุงูููุงุฆูุฉ ูุนูููุฉ ููุบุงูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ูู ุงููุงุถู ุฌุฒุกุง ูุญุต: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุซุงูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .]</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar450332/">https://habr.com/ru/post/ar450332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar450318/index.html">ุฃููุงุท ุงูุชุตููู ูู ุชุทููุฑ ุฌุงูุง ุณูุฑูุจุช ุงูุญุฏูุซุฉ</a></li>
<li><a href="../ar450320/index.html">ุชูุดู ุงูุฃูุนุงุจ ุงููููููุฉ ุงูุจุณูุทุฉ ุนู ุงูุชุนููุฏ ุงูููุงุฆู ููููู</a></li>
<li><a href="../ar450322/index.html">ููุงุฐุง ูุญุชุงุฌ ุฅูู ุงููุซูุฑ ูู ุงูุฑุณูุ</a></li>
<li><a href="../ar450324/index.html">ููู ูููู ูุธุงู ุชุชุจุน ุงูุฅูุชุงุฌูุฉ ุจุฅูุงูุฉ ููุธูู ุฃูุงุฒูู ุชููุงุฆููุง</a></li>
<li><a href="../ar450330/index.html">ุงุฎุชูุงุฑ ุงููุฏุฑุณุฉ ุนูุฏ ุงูุงูุชูุงู ุฅูู ุงูููุงูุงุช ุงููุชุญุฏุฉ ุงูุฃูุฑูููุฉ</a></li>
<li><a href="../ar450334/index.html">IaaS ูุชูููููุฌูุง ุงููุนูููุงุช ุงููุฏุงุฑุฉ: ููุฎุต ุงูุชูููููุฌูุง</a></li>
<li><a href="../ar450340/index.html">ููููุฉ ุชุญููู ูููุน ุงูููุงูุณ ูุฌุงููุง. ุชุนูููุงุช ุฎุทูุฉ ุจุฎุทูุฉ</a></li>
<li><a href="../ar450342/index.html">ุนู ุฃุดูุงุก ุจุณูุทุฉ ููุนูุฏุฉ. ูุนูุฏ ุงููุชุงุฉ ุงูุฏูุงุฌู ุฃู RTFM ูุชุนุฑูู ุงูุจูุงุณุชูู ูู ุงูููุฒู</a></li>
<li><a href="../ar450344/index.html">ููุดูุฑ ุจุงูุนูู ุงูุฃุจูุถ ุ ุฃู ููู ุญูุธุช ุฏูุฑุฉ ุงูููุฏูู ุงูุฎุงุตุฉ ุจู ูู ุงูุธููุฑ ุนูู ุงููุชุนูุจ</a></li>
<li><a href="../ar450346/index.html">ูููุชู ููุฎ ููุฏ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>