<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜò ‚åöÔ∏è üé£ Hacer un simple aerobote RC üîò üåï üë©‚Äçüë©‚Äçüëß‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A veces en Internet veo preguntas de principiantes que quieren construir un quadrocopter desde cero y escribir firmware para √©l. Yo mismo lo soy y par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hacer un simple aerobote RC</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/390429/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A veces en Internet veo preguntas de principiantes que quieren construir un quadrocopter desde cero y escribir firmware para √©l. </font><font style="vertical-align: inherit;">Yo mismo lo soy y para practicar la creaci√≥n de modelos RC decid√≠ comenzar con algo m√°s simple. </font></font><br>
<br>
<img src="https://habrastorage.org/files/7dd/6f2/46e/7dd6f246e98e47b8b5f3eda1ccdd14b0.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el art√≠culo en detalle para los m√°s peque√±os, describi√≥ el algoritmo de la embarcaci√≥n, el panel de control y la elecci√≥n de los componentes.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPor qu√© barco a√©reo?</font></font></h2><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simple;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Barato</font></font></li>
<li>     ;</li>
<li>     ,  -.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Volar veh√≠culos es genial, pero dif√≠cil. </font><font style="vertical-align: inherit;">En el aire, no puedes simplemente apagar los tornillos si algo sale mal. </font><font style="vertical-align: inherit;">S√≠, y se necesita un empuje espec√≠fico muy decente, incluso para aviones, sin mencionar el multicopter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plataformas como esta </font></font><br>
<br>
<img src="https://habrastorage.org/files/2ea/857/305/2ea8573051be4afcbe6aaf40c94a753d.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hay</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> una descripci√≥n m√°s detallada aqu√≠). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
solo pueden moverse, en la mayor√≠a de los casos, por una superficie lisa artificial, y su control es muy diferente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pero en el agua podemos navegar a cualquier parte, lo que en el futuro nos puede dar la oportunidad de hacer un piloto autom√°tico con GPS. </font><font style="vertical-align: inherit;">El dise√±o cl√°sico con una h√©lice es complicado para m√≠ por la unidad de salida del eje de la carcasa; no puedo imaginar c√≥mo sellarlo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√°s ventajas de un sistema de propulsi√≥n de aire:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se puede colocar en diferentes plataformas: un bote, trineo, un pedazo de espuma ...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No se atrapa en el fondo ni en las algas.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es necesario que el dispositivo pueda girar. </font><font style="vertical-align: inherit;">Hay 3 opciones:</font></font><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un tornillo + volante para giros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un tornillo + su sistema de giro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dos tornillos fijos. </font><font style="vertical-align: inherit;">Girar cambiando sus antojos es la forma m√°s f√°cil. </font><font style="vertical-align: inherit;">El lo us√≥.</font></font></li>
</ol><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control remoto</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Principio de operaci√≥n</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 joystick + m√∫ltiples interruptores. </font><font style="vertical-align: inherit;">La tarea del control remoto es enviar datos sobre la posici√≥n del mango del joystick y los interruptores varias veces por segundo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que hacer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, necesitas un transmisor de radio. La opci√≥n m√°s barata es NRF24L01 +, cuesta </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.85</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En segundo lugar, necesitas un joystick. Otro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Varios interruptores - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bueno, todo esto est√° arreglado en una pieza de PCB por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.13</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ya contaba $ 2.1, pero a√∫n necesita MK y comida. Aqu√≠ no todo est√° tan claro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mirando hacia el futuro, dir√© que ATmega8 o STM8S103F3P6 es suficiente, pero desde que comenc√© este proyecto durante mucho tiempo y hab√≠a poca experiencia, lo estrell√© en el panel de control Arduino Pro Mini y en el barco Arduino Nano (ATmega32P en todas partes). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el control remoto a√∫n se necesita:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Convertidor de potencia 0.9 - 5 V -&gt; 5 V para alimentar Arduino por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.35</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (el conector USB, junto con un pedazo de la placa, se puede cortar para ser compacto);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El estabilizador 3.3V AMS1117-3.3 para alimentar el m√≥dulo de radio, cuestan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.03 por unidad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compartimento de la bater√≠a para la bater√≠a de un dedo por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.15</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Total m√°s $ 0.53. </font><font style="vertical-align: inherit;">Adem√°s del controlador, un par de condensadores y cables, el costo de los componentes de la consola es de $ 2.63.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Llenado modelo RC</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componentes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo viene de los motores. </font><font style="vertical-align: inherit;">Los motores que compre, los componentes electr√≥nicos deber√°n instalarse con esa potencia, y la base (embarcaci√≥n, trineo) ser√° necesaria para la capacidad de carga correspondiente. </font><font style="vertical-align: inherit;">E ideol√≥gicamente, todo lo dem√°s es necesario solo para girar los tornillos a la velocidad correcta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Compr√© estos motores con h√©lices </font></font><br>
<br>
<img src="https://habrastorage.org/files/02a/811/047/02a8110476e840e68848408e6fcc4872.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 2.88 por par</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tom√© el L293D como conductor del motor: otros </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.35</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y luego hay un problema</font></font></b><div class="spoiler_text"> L293D         .                             ,   .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comida. </font><font style="vertical-align: inherit;">Necesitaremos hasta tres voltajes de suministro:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 V para todos los componentes electr√≥nicos excepto el m√≥dulo de radio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,3 V para el m√≥dulo de radio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para motores tanto como lo necesiten (mina 4.2 V).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 y 2 obtenemos lo mismo que en el panel de control, y para motores ponemos MT3608 por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0.86</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora para la parte divertida: el giroscopio. </font><font style="vertical-align: inherit;">El m√≥dulo MPU-6050 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cuesta $ 1.53</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hubo un deseo de usar tambi√©n el aceler√≥metro, de modo que cuando el joystick se mueve hacia un lado, la nave se despliega en su lugar. </font><font style="vertical-align: inherit;">Pero al final, abandon√≥ esta idea: una ligera pendiente, y el sistema comienza a pensar que se est√° acelerando hacia adelante o hacia atr√°s. </font><font style="vertical-align: inherit;">Result√≥ ser m√°s f√°cil girar el barco en su lugar simplemente compensando el movimiento hacia adelante / hacia atr√°s con el joystick. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agregue a esto $ 0.4 por el compartimento de la bater√≠a para 2 celdas AA y obtenga $ 6.4 componentes sin un controlador y cables.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El programa</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y de nuevo, v√°monos de los motores. </font><font style="vertical-align: inherit;">Cada uno de los dos motores accionados por el L293D puede </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o no excavar</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Girar hacia adelante;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Girar hacia atr√°s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No lo tuerzas.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que el c√≥digo sea m√°s f√°cil de leer, escriba </font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 funciones</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS);<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{    <font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS;<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftBackward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS);<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS);<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS;<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightBackward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS);<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora queremos controlar la velocidad de rotaci√≥n de los tornillos. </font><font style="vertical-align: inherit;">Por supuesto, haremos esto usando PWM. </font><font style="vertical-align: inherit;">No s√© si tal PWM se puede hacer en hardware ... Lo interrump√≠ program√°ticamente. </font><font style="vertical-align: inherit;">Declarar un par de variables globales.</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int8_t</span></span> motLeft = <span class="hljs-number"><span class="hljs-number">0</span></span>, motRight = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deje que los valores de estas variables &lt;0 significan que necesita girar hacia atr√°s, valores&gt; 0 - hacia adelante, y si son iguales a 0, entonces no necesita girar.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribiremos manejadores de interrupciones de temporizador</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">ISR(TIMER2_OVF_vect)<font></font>
{<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motLeftForward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motLeft &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motLeftBackward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motRight &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motRightForward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motRight &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motRightBackward();<font></font>
}<font></font>
<font></font>
ISR(TIMER2_COMPA_vect)<font></font>
{<font></font>
  motLeftStop();<font></font>
}<font></font>
<font></font>
ISR(TIMER2_COMPB_vect)<font></font>
{<font></font>
  motRightStop();<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, para cambiar la velocidad de rotaci√≥n de la h√©lice, necesitamos hacer 2 acciones:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escriba un valor positivo, negativo o cero en motLeft / motRight (el m√≥dulo no es importante);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registre la "velocidad de rotaci√≥n" en OCR2A / OCR2B.</font></font></li>
</ol><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribamos un par de funciones m√°s para esto</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotLeft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motLeft = v;  <font></font>
  OCR2A = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) * <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotRight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motRight = v;<font></font>
  OCR2B = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) * <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
}<font></font>
</code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;
</code></pre><br>
            OCR2x   5 (      ).<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora queda por configurar los pines MK y el temporizador</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  DDRD |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (1 &lt;&lt; CS22)|(1 &lt;&lt; CS21)|(1 &lt;&lt; CS20); // set up timer with prescaler = 1024.   16 </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (1 &lt;&lt; CS22)|(0 &lt;&lt; CS21)|(0 &lt;&lt; CS20); // set up timer with prescaler = 64.   1 </span></span>
  TCCR2B |= (<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;&lt; CS22)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; CS21)|(<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;&lt; CS20); <span class="hljs-comment"><span class="hljs-comment">// set up timer with prescaler = 8.  128 </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (0 &lt;&lt; CS22)|(0 &lt;&lt; CS21)|(1 &lt;&lt; CS20); // set up timer with prescaler = 1.  16 </span></span>
  TIMSK2 |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; TOIE2)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; OCIE2A)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; OCIE2B); <span class="hljs-comment"><span class="hljs-comment">// enable overflow interrupt</span></span>
  TCCR2A &amp;= ~(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// set WGM20 = 0, WGM21 = 0</span></span>
  TCCR2B &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// set WGM22 = 0</span></span>
  setMotLeft(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  setMotRight(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  sei();<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y puede controlar los motores simplemente llamando a las funciones setMotLeft (int8_t v) y setMotRight (int8_t v). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°Pero queremos controlar mal el barco! </font><font style="vertical-align: inherit;">¬°Queremos dar comandos como "adelante / atr√°s" y "derecha / izquierda"! </font><font style="vertical-align: inherit;">Y deja que descubra qu√© h√©lices tiene que girar para esto. </font><font style="vertical-align: inherit;">Adem√°s, quiero que el bote mismo compense el efecto de giro del viento, las corrientes y ... ¬°las h√©lices torcidas! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vayamos ahora del otro lado. </font><font style="vertical-align: inherit;">Desde el control remoto. </font><font style="vertical-align: inherit;">En el caso m√°s simple, el algoritmo de su operaci√≥n es el siguiente:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando encienda la alimentaci√≥n, recuerde la posici√≥n inicial del joystick;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el ciclo, lea la posici√≥n del joystick, reste la posici√≥n cero y env√≠e datos a la embarcaci√≥n.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuestro m√≥dulo de radio admite paquetes de hasta 32 bytes. </font><font style="vertical-align: inherit;">Para no recordar los desplazamientos, utilizaremos el registro</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControlStatus</span></span></span><span class="hljs-class">{</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> x,y;<font></font>
}  controlStatus;<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como sigue</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">    <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> packet[MAX_BUFF]; 
    <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(packet, <span class="hljs-number"><span class="hljs-number">0</span></span>, MAX_BUFF);    <font></font>
    controlStatus.x = (<span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span>)analogRead(<span class="hljs-number"><span class="hljs-number">1</span></span>) - x0;<font></font>
    controlStatus.y = (<span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span>)analogRead(<span class="hljs-number"><span class="hljs-number">0</span></span>) - y0;
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(packet, &amp;controlStatus, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(controlStatus));<font></font>
    Mirf.send(packet);<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(Mirf.isSending()){;};
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el lado del receptor, declararemos exactamente el mismo registro y </font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lo llenaremos</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Mirf.dataReady()) { 
    <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> data[MAX_BUFF];<font></font>
    Mirf.getData(data);<font></font>
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(&amp;controlStatus, data, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(controlStatus));<font></font>
    setMotRot(-controlStatus.x);<font></font>
    setMotForward(controlStatus.y); <font></font>
  }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En las funciones setMotRot y setMotForward</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escribir los valores en las variables globales motRot y motForward</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotRot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v)&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motRot = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)v;<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v)&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motForward = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)v;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y pasemos a lo m√°s interesante. </font><font style="vertical-align: inherit;">Para saber c√≥mo convertir "¬°gire a la izquierda a una velocidad de 5 grados por segundo y avance un poco!" </font><font style="vertical-align: inherit;">a "motor izquierdo 10% hacia atr√°s, derecho 20% hacia adelante". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se </font><font style="vertical-align: inherit;">ha escrito mucho </font><font style="vertical-align: inherit;">sobre qu√© </font><font style="vertical-align: inherit;">son los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controladores PID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Us√© solo dos componentes para la rotaci√≥n:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proporcional;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integral</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Y para avanzar y retroceder, el regulador no lo us√≥. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tomemos un ejemplo:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> iDeltaRot = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motTick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> rot = getRotAvg(); <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> deltaRot = rot - motRot * rotMaxSpeed / <span class="hljs-number"><span class="hljs-number">512</span></span>;<font></font>
  iDeltaRot += deltaRot;<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> motRight = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motForward * forwardMult - deltaRot * rotMult - iDeltaRot * iDeltaRotMult, <font></font>
          motLeft  = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motForward * forwardMult + deltaRot * rotMult + iDeltaRot * iDeltaRotMult;  <font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> motMax = max(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(motRight), <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(motLeft));
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motMax &gt; <span class="hljs-number"><span class="hljs-number">127</span></span>){<font></font>
    motRight = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motRight * <span class="hljs-number"><span class="hljs-number">127</span></span> / motMax;<font></font>
    motLeft  = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motLeft  * <span class="hljs-number"><span class="hljs-number">127</span></span> / motMax;<font></font>
  }<font></font>
  <font></font>
  setMotRight(motRight);<font></font>
  setMotLeft(motLeft);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El c√≥digo se ha simplificado para centrarse en partes importantes; el archivo tendr√° la versi√≥n completa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Que estamos haciendo aqui</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculamos la diferencia entre la velocidad de rotaci√≥n real de la embarcaci√≥n (podredumbre) y la deseada (motRot * rotMaxSpeed);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculamos las velocidades de rotaci√≥n deseadas de los tornillos motRight y motLeft;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si las velocidades de rotaci√≥n deseadas exceden el m√°ximo posible, las reducimos mientras mantenemos la relaci√≥n entre ellas;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Llamamos a setMotRight / setMotLeft que ya nos es familiar.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eso es todo! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬°Este es todo el algoritmo de control del barco! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
¬øEs dificil? </font><font style="vertical-align: inherit;">Creo que no </font><font style="vertical-align: inherit;">Pero, sin embargo, durante las pruebas y los ajustes surgieron muchos problemas que provocar√≠an numerosos accidentes si se tratara de un avi√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hay 4 coeficientes en la funci√≥n descrita:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forwardMult: sensibilidad al movimiento del joystick hacia adelante / hacia atr√°s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rotMaxSpeed: la velocidad de rotaci√≥n deseada al inclinar el joystick completamente hacia la derecha / izquierda;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rotMult: coeficiente del componente proporcional (cu√°nto afecta la desviaci√≥n de la velocidad de rotaci√≥n actual a la deseada);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iDeltaRotMult - coeficiente del componente integral (cu√°nto afecta la desviaci√≥n del √°ngulo de giro actual del deseado a la rotaci√≥n).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estos coeficientes se ajustan experimentalmente, y la reacci√≥n del bote al joystick y las influencias de despliegue externo depender√°n de ellos.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indicaci√≥n de estado</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al depurar / afinar, habr√° una confusi√≥n de la serie "¬øpor qu√© el barco reacciona al joystick no de la manera que yo quiero?". </font><font style="vertical-align: inherit;">Algunos puntos se pueden depurar mostrando informaci√≥n de depuraci√≥n en una PC, pero ser√≠a m√°s conveniente entender lo que est√° sucediendo en el acto. </font><font style="vertical-align: inherit;">Al principio, consider√© 2 opciones:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computadora port√°til;</font></font></li>
<li><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LCD Nokia 5110</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/a23/fc5/65d/a23fc565d564418bad9c2ad6a1144f0c.jpg"><br>
</div></div></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las desventajas de ambos son comprensibles: la computadora port√°til es grande e inc√≥moda de transportar, y la pantalla del Nokia 5110 no le permitir√° mostrar simult√°neamente una gran cantidad de par√°metros de estado del barco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tom√© un cruce entre ellos: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nextion Enhanced NX4827K043 - Pantalla t√°ctil HMI gen√©rica de 4.3 ''</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gracias a la pantalla t√°ctil, puede ajustar r√°pida y convenientemente los par√°metros del barco sobre la marcha. </font><font style="vertical-align: inherit;">Este es un tipo de computadora que consiste en:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microcontrolador GD32F103R8T6;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDRAM Winbond W9864G6KH-6 (8 MB);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memoria flash Winbond W25Q256FVFG (32 MB, 100,000 ciclos de reescritura, lo cual es muy bueno);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPGA Altera MAX II EPM570T144C5N.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo en el ensamblaje se ve as√≠ (se puede hacer clic): </font><font style="vertical-align: inherit;">
esta computadora / pantalla es una caja negra y est√° orientada a interactuar con una persona. Incluso el GPIO existente est√° afilado para conectar botones e indicadores. Su </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">tablero de expansi√≥n</font></a><font style="vertical-align: inherit;"> confirma esto. Por lo tanto, usar el controlador incorporado como control remoto de un barco (leer el joystick, intercambiar datos con el m√≥dulo de radio NRF24L01 +) fallar√°. Para interactuar con el microcontrolador, hay UART y ... eso es todo. </font><font style="vertical-align: inherit;">
Sobre c√≥mo y qu√© se puede hacer usando esta pantalla se puede hacer, est√° escrito un mont√≥n de + hay videos en Youtube. Ver, por ejemplo, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">esto</font></a></font><br>
<br>
<a href=""><img src="https://habrastorage.org/files/b78/b67/ad2/b78b67ad2ffd4f00a0e82daae979dad8.JPG"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Todo se muestra claramente all√≠. </font><font style="vertical-align: inherit;">Pero dado que esta pantalla es m√°s costosa que todos los dem√°s componentes del barco y la consola combinados, describir√© con m√°s detalle mis impresiones de trabajar con ella. </font><font style="vertical-align: inherit;">Tal vez esto ayude a alguien a comprender si esta opci√≥n es adecuada para √©l o si la laptop / pantalla Nokia 5110 ser√° preferible. </font><font style="vertical-align: inherit;">Ventajas de Nextion Enhanced NX4827K043:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muy facil de usar. </font><font style="vertical-align: inherit;">Hay documentaci√≥n simple, ejemplos, videos en Youtube, ... En un par de horas puedes resolverlo desde cero. </font><font style="vertical-align: inherit;">Casi todo lo que necesita saber sobre √©l est√° en dos p√°ginas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√°gina wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de instrucciones</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muy r√°pido desarrollo. </font><font style="vertical-align: inherit;">Un editor visual como Visual Studio (solo que m√°s f√°cil). </font><font style="vertical-align: inherit;">Tir√© componentes y todo funciona.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componentes de alta calidad. </font><font style="vertical-align: inherit;">La misma memoria flash para 100k ciclos de reescritura.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un depurador que puede simular una pantalla usando una PC y comunicarse con su MK a trav√©s de un puerto COM. </font><font style="vertical-align: inherit;">Le permite desarrollar completamente el dispositivo, depurar y comprar una pantalla, solo si todo funciona.</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aunque hay un problema con √©l</font></font></b><div class="spoiler_text">            .    . ,         ,         .<br>
</div></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensor resistivo </font><font style="vertical-align: inherit;">Puede crear controles bastante peque√±os y pincharlos con la u√±a o cualquier l√°piz.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desventajas</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Precio </font><font style="vertical-align: inherit;">$ 50 sigue siendo mucho para una pantalla de 4.3 ''.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay pocos componentes existentes, pocas configuraciones de componentes, no est√° claro c√≥mo crear los suyos propios. </font><font style="vertical-align: inherit;">Esto est√° parcialmente compensado por las funciones de dibujar primitivas (l√≠neas, rect√°ngulos, c√≠rculos, ...).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El componente Gauge est√°ndar parpadea cuando se actualiza.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No (al menos no encontr√©) transparencia.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Requisitos de energ√≠a: 4.75-7 V y corriente promedio de 250 mA. </font><font style="vertical-align: inherit;">Cuando cae el voltaje, la pantalla comienza a parpadear.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UART solamente. </font><font style="vertical-align: inherit;">Podr√≠a comunicarse con √©l por SPI y I¬≤C.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salida GPIO solo para el cable (sin peine 2,54 mm), sin ADC.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En general, la pantalla da la impresi√≥n de un producto de muy alta calidad, con el que es f√°cil y agradable trabajar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La pantalla puede realizar dos tareas a la vez:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indicaci√≥n de estado. </font><font style="vertical-align: inherit;">Estoy principalmente interesado en:</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Velocidades de rotaci√≥n" de los tornillos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El valor de la variable iDeltaRot es cu√°nto difiere el √°ngulo de giro deseado del deseado;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocidad de rotaci√≥n del barco;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ångulo de rotaci√≥n del bote;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frecuencia de recepci√≥n de paquetes desde el control remoto;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La frecuencia de las llamadas a la funci√≥n motTick.</font></font></li>
</ul><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√°metros de configuraci√≥n, a saber, los descritos anteriormente forwardMult, rotMaxSpeed, rotMult, iDeltaRotMult.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hecho 2 p√°ginas (clicable para evaluaci√≥n de calidad):</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indicaciones:</font></font><br>
 <br>
<a href=""><img src="https://habrastorage.org/files/6f7/aaa/571/6f7aaa57152e48a5b92e6555d230d863.JPG"></a><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuraci√≥n de par√°metros: </font><font style="vertical-align: inherit;">
primeras 4 columnas de izquierda a derecha: forwardMult, rotMult, iDeltaRotMult, rotMaxSpeed.</font></font><br>
 <br>
<a href=""><img src="https://habrastorage.org/files/256/9f6/22d/2569f622dc234426b0dc8d4352a8488e.JPG"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
</li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Barco de prueba de video en el piso:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kwHMI4QUjIs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La reacci√≥n del barco a un efecto de despliegue externo en varios iDeltaRotMult (coeficientes integrales):</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3numZhKZnic" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Demostraci√≥n de la influencia de los par√°metros en el agua:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/QuOtIunGEME" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El video en aguas abiertas no se pudo capturar. </font><font style="vertical-align: inherit;">Puedes confiar en que su manejo es bueno y que la velocidad m√°xima no es muy alta.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caracteristicas</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Varilla 9 g;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peso 115 g, de los cuales las bater√≠as pesan 52 g;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La aceleraci√≥n m√°xima es 0.77 m / s ^ 2. </font><font style="vertical-align: inherit;">Para humanos a 5 km / h, si no hubiera resistencia al agua, el bote acelerar√≠a en 1.8 s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El costo de los componentes es de aproximadamente $ 15 si usa el Arduino Nano tanto en el control remoto como en el bote (sin pantalla y bater√≠as).</font></font></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aquellos que desean recolectar algo controlado por radio, les recomiendo comenzar con una embarcaci√≥n con dos h√©lices fijas. </font><font style="vertical-align: inherit;">En mi opini√≥n, esto es lo m√°s simple que se puede hacer en esta √°rea. </font></font><br>
<br>
<a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archive con proyectos</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Y finalmente, para que haya algo por lo que luchar, aqu√≠ hay un video de un dispositivo incre√≠ble:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_iqqHAWJq_0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es390429/">https://habr.com/ru/post/es390429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es390419/index.html">Conecte la matriz de LED a la Raspberry pi</a></li>
<li><a href="../es390421/index.html">$ 8 DVB stick radio - explorando SDR con GNURadio</a></li>
<li><a href="../es390423/index.html">La cl√°usula de apocalipsis zombie de Amazon se ha agregado a las pol√≠ticas de servicios web de Amazon</a></li>
<li><a href="../es390425/index.html">Los robots aprendieron a cocinar ramen, cambiar su color y tama√±o</a></li>
<li><a href="../es390427/index.html">Depuraci√≥n de c√≥digo Arduino (AVR). Parte 1. Depuraci√≥n virtual</a></li>
<li><a href="../es390431/index.html">Epson EH-TW5210, EH-TW5300 y EH-TW5350 proyectores dom√©sticos: mejor, m√°s r√°pido, m√°s brillante</a></li>
<li><a href="../es390435/index.html">Los matem√°ticos han construido un mapa de conexiones en el universo de "Star Wars"</a></li>
<li><a href="../es390437/index.html">Alt√≠metro-vari√≥metro electr√≥nico hecho en casa con las se√±ales de advertencia de sonido y luz.</a></li>
<li><a href="../es390439/index.html">Reflejos entre bandas de Andreev sobre los contactos de van der Waals entre el grafeno y el seleniuro de niobio</a></li>
<li><a href="../es390441/index.html">Eclipse #include <Arduino.h></a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>