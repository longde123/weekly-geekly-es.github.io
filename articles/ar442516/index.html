<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉโ๐ซ ๐ฟ๏ธ ๐ฒ๏ธ ุงูุจุงูุฏุง ุฏููู ูุชุญููู ุงูุจูุงูุงุช ุงููุจูุฑุฉ ๐ง๐ผ ๐จ๐พโ๐ง ๐บ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุนูุฏ ุงุณุชุฎุฏุงู ููุชุจุฉ ุงูุจุงูุฏุง ูุชุญููู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ ุ ุงูุชู ูุง ูุชุฌุงูุฒ ุญุฌููุง 100 ููุฌุงุจุงูุช ุ ูุงุฏุฑุงู ูุง ูุตุจุญ ุงูุฃุฏุงุก ูุดููุฉ. ูููู ุนูุฏูุง ูุชุนูู ุงูุฃูุฑ ุจุฏ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุจุงูุฏุง ุฏููู ูุชุญููู ุงูุจูุงูุงุช ุงููุจูุฑุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/442516/" style=";text-align:right;direction:rtl"> ุนูุฏ ุงุณุชุฎุฏุงู ููุชุจุฉ ุงูุจุงูุฏุง ูุชุญููู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุตุบูุฑุฉ ุ ุงูุชู ูุง ูุชุฌุงูุฒ ุญุฌููุง 100 ููุฌุงุจุงูุช ุ ูุงุฏุฑุงู ูุง ูุตุจุญ ุงูุฃุฏุงุก ูุดููุฉ.  ูููู ุนูุฏูุง ูุชุนูู ุงูุฃูุฑ ุจุฏุฑุงุณุฉ ูุฌููุนุงุช ุงูุจูุงูุงุช ุ ุงูุชู ูููู ุฃู ุชุตู ุฃุญุฌุงููุง ุฅูู ุนุฏุฉ ุบูุบุงุจุงูุช ุ ูููู ุฃู ุชุคุฏู ูุดุงูู ุงูุฃุฏุงุก ุฅูู ุฒูุงุฏุฉ ูุจูุฑุฉ ูู ูุฏุฉ ุชุญููู ุงูุจูุงูุงุช ููููู ุฃู ุชุคุฏู ุฅูู ุนุฏู ุงููุฏุฑุฉ ุนูู ุฅุฌุฑุงุก ุงูุชุญููู ุจุณุจุจ ููุต ุงูุฐุงูุฑุฉ. <br><br>  ุจูููุง ุชุณุชุทูุน ุฃุฏูุงุช ูุซู Spark ูุนุงูุฌุฉ ูุฌููุนุงุช ุงูุจูุงูุงุช ุงููุจูุฑุฉ ุจููุงุกุฉ (ูู ูุฆุงุช ุงูุฌูุฌุงุจุงูุช ุฅูู ุนุฏุฉ ุชูุฑุงุจุงูุช) ุ ูู ุฃุฌู ุงูุงุณุชูุงุฏุฉ ุงููุงููุฉ ูู ูุฏุฑุงุชูุง ุ ุชุญุชุงุฌ ุนุงุฏุฉ ุฅูู ุฃุฌูุฒุฉ ูููุฉ ูููููุฉ ููุบุงูุฉ.  ูุจุงูููุงุฑูุฉ ูุน ุญููุงูุงุช ุงูุจุงูุฏุง ุ ูุฅููุง ูุง ุชุฎุชูู ูู ูุฌููุนุงุช ุบููุฉ ูู ุงูุฃุฏูุงุช ููุชูุธูู ูุงูุจุญุซ ูุงูุจูุงูุงุช ุนุงููุฉ ุงูุฌูุฏุฉ.  ุจุงููุณุจุฉ ุฅูู ูุฌููุนุงุช ุงูุจูุงูุงุช ูุชูุณุทุฉ ุงูุญุฌู ุ ูู ุงูุฃูุถู ุชุฌุฑุจุฉ ุงุณุชุฎุฏุงู ุญููุงูุงุช ุงูุจุงูุฏุง ุจุดูู ุฃูุซุฑ ููุงุกุฉ ุ ุจุฏูุงู ูู ุงูุชุจุฏูู ุฅูู ุฃุฏูุงุช ุฃุฎุฑู. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/gd/jg/60/gdjg60abxgti2otxocpd0ct2uci.jpeg"></a> <br><br>  ูู ุงููุงุฏุฉ ุงูุชู ูุชุฑุฌููุง ุงูููู ุ ุณูุชุญุฏุซ ุนู ููุฒุงุช ุงูุนูู ูุน ุงูุฐุงูุฑุฉ ุนูุฏ ุงุณุชุฎุฏุงู ุงูุจุงูุฏุง ุ ูููููุฉ ุชูููู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุจูุณุจุฉ 90ูช ุชูุฑูุจูุง ุนู ุทุฑูู ุชุญุฏูุฏ ุฃููุงุน ุงูุจูุงูุงุช ุงูููุงุณุจุฉ ุงููุฎุฒูุฉ ูู ุฃุนูุฏุฉ ููุงูู ุจูุงูุงุช ุงูุฌุฏูู ูู <code>DataFrame</code> . <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุงูุนูู ูุน ุงูุจูุงูุงุช ุนูู ุฃูุนุงุจ ุงูุจูุณุจูู</font> </h2><br>  ุณูุนูู ูุน ุงูุจูุงูุงุช ุญูู ุฃูุนุงุจ ุงูุจูุณุจูู ููุฑุงุจุทุฉ ุงููุจุฑู ุงูุชู ุชู ุฌูุนูุง ุนูู ูุฏุงุฑ 130 ุนุงููุง ูุฃุฎุฐุช ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Retrosheet</a> . <br><br>  ูู ุงูุจุฏุงูุฉ ุ ุชู ุชูุฏูู ูุฐู ุงูุจูุงูุงุช ูู ุตูุฑุฉ 127 ููููุง ุจุชูุณูู CSV ุ ููููุง ูููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฏูุฌูุง ูู</a> ูุฌููุนุฉ ุจูุงูุงุช ูุงุญุฏุฉ ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู csvkit ูุฃุถููุง</a> ุตููุง ูุญุชูู ุนูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตู</a> ุฃูู ูู ุงูุฌุฏูู ุงููุงุชุฌ.  ุฅุฐุง ููุช ุชุฑูุฏ ุ ููููู ุชูุฒูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุตุฏุงุฑูุง ูู</a> ูุฐู ุงูุจูุงูุงุช ูุชุฌุฑุจุชูุง ุ ููุฑุงุกุฉ ุงูููุงู. <br><br>  ููุจุฏุฃ ุจุงุณุชูุฑุงุฏ ูุฌููุนุฉ ุจูุงูุงุช ููููู ูุธุฑุฉ ุนูู ุงูุฃุณุทุฑ ุงูุฎูุณุฉ ุงูุฃููู.  ููููู ุงูุนุซูุฑ ุนูููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง</a> ุงูุฌุฏูู ุ ุนูู <code>   </code> ูุฑูุฉ <code>   </code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">import pandas as pd gl = pd.read_csv('game_logs.csv') gl.head()</code> </pre> <br>  ููุฌุฏ ุฃุฏูุงู ูุนูููุงุช ุญูู ุฃูู ุฃุนูุฏุฉ ุงูุฌุฏูู ูุน ูุฐู ุงูุจูุงูุงุช.  ุฅุฐุง ููุช ุชุฑุบุจ ูู ูุฑุงุกุฉ ุงูุชูุณูุฑุงุช ูุฌููุน ุงูุฃุนูุฏุฉ ุ ููููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุงูุนุซูุฑ ุนูู ูุงููุณ ุจูุงูุงุช ููุฌููุนุฉ ุงูุจูุงูุงุช ุจุฃููููุง. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>date</code> - ุชุงุฑูุฎ ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  <code>v_name</code> - ุงุณู ูุฑูู ุงูุถูู. </li><li style=";text-align:right;direction:rtl">  <code>v_league</code> - ุฏูุฑู ุงููุฑูู ุงูุฒุงุฆุฑ. </li><li style=";text-align:right;direction:rtl">  <code>h_name</code> - ุงุณู ุงููุฑูู ุงููุถูู. </li><li style=";text-align:right;direction:rtl">  <code>h_league</code> - ุฏูุฑู ุงููุฑูู ุงููุถูู. </li><li style=";text-align:right;direction:rtl">  <code>v_score</code> - ููุงุท ูู ุงููุฑูู ุงูุถูู. </li><li style=";text-align:right;direction:rtl">  <code>h_score</code> - ููุงุท ุงููุฑูู ุงููุถูู. </li><li style=";text-align:right;direction:rtl">  <code>v_line_score</code> - ููุฎุต ูููุงุท ูุฑูู ุงูุถูู ุ ุนูู ุณุจูู ุงููุซุงู - <code>010000(10)00</code> . </li><li style=";text-align:right;direction:rtl">  <code>h_line_score</code> - ููุฎุต ูููุงุท ุงููุฑูู ุงููุถูู ุ ุนูู ุณุจูู ุงููุซุงู - <code>010000(10)0X</code> . </li><li style=";text-align:right;direction:rtl">  <code>park_id</code> - ูุนุฑู ุงูุญูู ุงูุฐู ุชู ูุนุจ ุงููุนุจุฉ ุนููู. </li><li style=";text-align:right;direction:rtl">  <code>attendance</code> - ุนุฏุฏ ุงููุดุงูุฏูู. </li></ul><br>  ููุนุฑูุฉ ูุนูููุงุช ุนุงูุฉ ุญูู ูุงุฆู <code>DataFrame</code> ุ ููููู ุงุณุชุฎุฏุงู ุงูุฃุณููุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DataFrame.info ()</a> .  ุจูุถู ูุฐู ุงูุทุฑููุฉ ุ ููููู ูุนุฑูุฉ ุญุฌู ุงููุงุฆู ุ ูุฃููุงุน ุงูุจูุงูุงุช ุ ูุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ. <br><br>  ุจุดูู ุงูุชุฑุงุถู ุ ุชููุฑ ุงูุจุงูุฏุง ุ ูู ุฃุฌู ุชูููุฑ ุงูููุช ุ <code>DataFrame</code> ุชูุฑูุจูุฉ ุญูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุจูุงุณุทุฉ <code>DataFrame</code> .  ูุญู ููุชููู ุจุงููุนูููุงุช ุงูุฏูููุฉ ุ ูุฐูู ุณูููู ุจุชุนููู ุงููุนููุฉ <code>memory_usage</code> ุนูู <code>'deep'</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">gl.info(memory_usage='deep')</code> </pre> <br>  ูููุง ููู ุงููุนูููุงุช ุงูุชู ุชูููุง ูู ุงูุญุตูู ุนูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">&lt;class 'pandas.core.frame.DataFrame'&gt; RangeIndex: 171907 entries, 0 to 171906 Columns: 161 entries, date to acquisition_info dtypes: float64(77), int64(6), object(78) memory usage: 861.6 MB</code> </pre> <br>  ููุง ุงุชุถุญ ุ ูุฏููุง 171ุ907 ุตููุง ู 161 ุนููุฏูุง.  ุงูุชุดูุช ููุชุจุฉ ุงูุจุงูุฏุง ุฃููุงุน ุงูุจูุงูุงุช ุชููุงุฆููุง.  ููุงู 83 ุนููุฏูุง ูุญุชูู ุนูู ุจูุงูุงุช ุฑูููุฉ ู 78 ุนููุฏูุง ุจู ูุงุฆูุงุช.  ุชูุณุชุฎุฏู ุฃุนูุฏุฉ ุงููุงุฆูุงุช ูุชุฎุฒูู ุจูุงูุงุช ุงูุณูุณูุฉ ุ ููู ุงูุญุงูุงุช ุงูุชู ูุญุชูู ูููุง ุงูุนููุฏ ุนูู ุจูุงูุงุช ูู ุฃููุงุน ูุฎุชููุฉ. <br><br>  ุงูุขู ุ ูู ุฃุฌู ููู ุฃูุถู ูููููุฉ ุชุญุณูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุจุงุณุชุฎุฏุงู <code>DataFrame</code> ุ ุฏุนูุง ูุชุญุฏุซ ุนู ููููุฉ ุชุฎุฒูู ุงูุจุงูุฏุง ููุจูุงูุงุช ูู ุงูุฐุงูุฑุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุนุฑุถ ุฏุงุฎูู ูู DataFrame</font> </h2><br>  ุฏุงุฎู ุงูุจุงูุฏุง ุ ูุชู ุชุฌููุน ุฃุนูุฏุฉ ุงูุจูุงูุงุช ูู ูุชู ุฐุงุช ููู ูู ููุณ ุงูููุน.  ูููุง ููู ูุซุงู ุนูู ููููุฉ ุชุฎุฒูู ุฃูู 12 ุนููุฏูุง ูู <code>DataFrame</code> ูู ุงูุจุงูุฏุง. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d35/c70/c63/d35c70c635289a5cecc520c58e662e9a.png"></div><br>  <i><font color="#999999">ุงูุชูุซูู ุงูุฏุงุฎูู ูุฃููุงุน ูุฎุชููุฉ ูู ุงูุจูุงูุงุช ูู ุงูุจุงูุฏุง</font></i> <br><br>  ูุฏ ุชูุงุญุธ ุฃู ุงููุชู ูุง ุชุฎุฒู ูุนูููุงุช ุงุณู ุงูุนููุฏ.  ูุฐุง ูุฑุฌุน ุฅูู ุญูููุฉ ุฃู ุงููุชู ูุญุณููุฉ ูุชุฎุฒูู ุงูููู ุงููุชููุฑุฉ ูู ุฎูุงูุง ุงูุฌุฏูู ููุงุฆู <code>DataFrame</code> .  ูุฆุฉ <code>BlockManager</code> ูู ุงููุณุคููุฉ ุนู ุชุฎุฒูู ุงููุนูููุงุช ุญูู ุงููุฑุงุณูุงุช ุจูู ููุงุฑุณ ุงูุตู ูุงูุนููุฏ ููุฌููุนุฉ ุงูุจูุงูุงุช ููุง ูุชู ุชุฎุฒููู ูู ูุชู ูู ููุณ ุงูููุน ูู ุงูุจูุงูุงุช.  ุฅูู ููุนุจ ุฏูุฑ API ุงูุฐู ูููุฑ ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ.  ุนูุฏูุง ููุฑุฃ ุงูููู ุฃู <code>DataFrame</code> ุฃู <code>DataFrame</code> ุชุชูุงุนู ูุฆุฉ <code>DataFrame</code> ูุน ูุฆุฉ <code>BlockManager</code> ูุชุญููู ุทูุจุงุชูุง ุฅูู ุงุณุชุฏุนุงุกุงุช ุงููุธุงุฆู ูุงูุฃุณููุจ. <br><br>  ูุญุชูู ูู ููุน ุจูุงูุงุช ุนูู ูุฆุฉ ูุชุฎุตุตุฉ ูู ุงููุญุฏุฉ ุงูููุทูุฉ <code>pandas.core.internals</code> .  ุนูู ุณุจูู ุงููุซุงู ุ ูุณุชุฎุฏู ุงูุจุงูุฏุง ูุฆุฉ <code>ObjectBlock</code> ูุชูุซูู ุงููุชู ุงูุชู ุชุญุชูู ุนูู ุฃุนูุฏุฉ ุงูุณูุณูุฉ ููุฆุฉ <code>FloatBlock</code> ูุชูุซูู ุงููุชู ุงูุชู ุชุญุชูู ุนูู ุฃุนูุฏุฉ ุชุญุชูู ุนูู ุฃุฑูุงู <code>FloatBlock</code> ุงูุนุงุฆูุฉ.  ุจุงููุณุจุฉ ูููุชู ุงูุชู ุชูุซู ุงูููู ุงูุฑูููุฉ ุงูุชู ุชุดุจู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุฃู ุฃุฑูุงู <code>ndarray</code> ุงูุนุงุฆูุฉ ุ ุชุฌูุน ุงูุจุงูุฏุง ุงูุฃุนูุฏุฉ <code>ndarray</code> ุจูุงูุงุช <code>ndarray</code> .  ุชุนุชูุฏ ุจููุฉ ุงูุจูุงูุงุช ูุฐู ุนูู ุงูุตููู C ุ ููุชู ุชุฎุฒูู ุงูููู ูู ูุชูุฉ ูุณุชูุฑุฉ ูู ุงูุฐุงูุฑุฉ.  ุจูุถู ูุธุงู ุชุฎุฒูู ุงูุจูุงูุงุช ุ ุฃุตุจุญ ุงููุตูู ุฅูู ุฃุฌุฒุงุก ุงูุจูุงูุงุช ุณุฑูุนูุง ููุบุงูุฉ. <br><br>  ูุธุฑูุง ูุฃู ุจูุงูุงุช ุงูุฃููุงุน ุงููุฎุชููุฉ ูุชู ุชุฎุฒูููุง ุจุดูู ูููุตู ุ ูุฅููุง ููุญุต ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูุฃููุงุน ูุฎุชููุฉ ูู ุงูุจูุงูุงุช.  ููุจุฏุฃ ุจุงุณุชุฎุฏุงู ูุชูุณุท โโุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูุฃููุงุน ูุฎุชููุฉ ูู ุงูุจูุงูุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">for dtype in ['float','int','object']:   selected_dtype = gl.select_dtypes(include=[dtype])   mean_usage_b = selected_dtype.memory_usage(deep=True).mean()   mean_usage_mb = mean_usage_b / 1024 ** 2   print("Average memory usage for {} columns: {:03.2f} MB".format(dtype,mean_usage_mb))</code> </pre> <br>  ูุชูุฌุฉ ูุฐูู ุ ุงุชุถุญ ุฃู ูุชูุณุท โโูุคุดุฑุงุช ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ููุจูุงูุงุช ูู ุฃููุงุน ูุฎุชููุฉ ูุจุฏู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Average memory usage for float columns: 1.29 MB Average memory usage for int columns: 1.12 MB Average memory usage for object columns: 9.53 MB</code> </pre> <br>  ูุฐู ุงููุนูููุงุช ุชุฌุนููุง ูููู ุฃู ูุนุธู ุงูุฐุงูุฑุฉ ุชููู ุนูู 78 ุนููุฏูุง ูู ุชุฎุฒูู ููู ุงููุงุฆูุงุช.  ุณูุชุญุฏุซ ุฃูุซุฑ ุนู ูุฐุง ูุงุญููุง ุ ููู ุงูุขู ุฏุนููุง ูููุฑ ูููุง ุฅุฐุง ูุงู ุจุฅููุงููุง ุชุญุณูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูุน ุงูุฃุนูุฏุฉ ุงูุชู ุชุฎุฒู ุงูุจูุงูุงุช ุงูุฑูููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุฃููุงุน ูุฑุนูุฉ</font> </h2><br>  ููุง ูููุง ุณุงุจููุง ุ ุชูุซู ุงูุจุงูุฏุง ููููุง ุฑูููุฉ ูุซู ููุงูู ุงูุจูุงูุงุช <code>ndarray</code> ูุชุฎุฒููุง ูู ูุชู ูุชุฌุงูุฑุฉ ูู ุงูุฐุงูุฑุฉ.  ูุณูุญ ูู ูููุฐุฌ ุชุฎุฒูู ุงูุจูุงูุงุช ูุฐุง ุจุญูุธ ุงูุฐุงูุฑุฉ ูุงููุตูู ุฅูู ุงูููู ุจุณุฑุนุฉ.  ูุธุฑูุง ูุฃู ุงูุจุงูุฏุง ุชูุซู ูู ูููุฉ ูู ููุณ ุงูููุน ุจุงุณุชุฎุฏุงู ููุณ ุนุฏุฏ ุงูุจุงูุชุงุช ุ <code>ndarray</code> ููุงูู <code>ndarray</code> ูุนูููุงุช ุญูู ุนุฏุฏ ุงูููู ุ ูููู <code>ndarray</code> ุฃู ุชุนุฑุถ ุจุณุฑุนุฉ ูุจุฏูุฉ ูุนูููุงุช ุญูู ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงูุชู ุชุณุชููููุง ุฃุนูุฏุฉ ุชุฎุฒูู ุงูููู ุงูุนุฏุฏูุฉ. <br><br>  ุชุญุชูู ุงูุนุฏูุฏ ูู ุฃููุงุน ุงูุจูุงูุงุช ูู ุงูุจุงูุฏุง ุนูู ุงูุนุฏูุฏ ูู ุงูุฃููุงุน ุงููุฑุนูุฉ ุงูุชู ูููููุง ุงุณุชุฎุฏุงู ุนุฏุฏ ุฃูู ูู ุงูุจุงูุชุงุช ูุชูุซูู ูู ูููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชูู ููุน <code>float</code> ุนูู ุฃููุงุน ูุฑุนูุฉ <code>float16</code> ู <code>float32</code> ู <code>float64</code> .  ูุดูุฑ ุงูุฑูู ูู ุงุณู ุงูููุน ุฅูู ุนุฏุฏ ุงูุจุชุงุช ุงูุชู ูุณุชุฎุฏููุง ุงูููุน ุงููุฑุนู ูุชูุซูู ุงูููู.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูุฃููุงุน ุงููุฑุนูุฉ ุงููุฏุฑุฌุฉ ููุชู ุ ูุชู ุงุณุชุฎุฏุงู 2 ู 4 ู 8 ู 16 ุจุงูุช ุนูู ุงูุชูุงูู ูุชุฎุฒูู ุงูุจูุงูุงุช.  ูุนุฑุถ ุงูุฌุฏูู ุงูุชุงูู ุงูุฃููุงุน ุงููุฑุนูุฉ ูุฃููุงุน ุงูุจูุงูุงุช ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ูู ุญููุงูุงุช ุงูุจุงูุฏุง. <br><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <sup>ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุ ุจุงูุช</sup> <sup><br></sup> </td><td>  <sup>ุฑูู ุงูููุทุฉ ุงูุนุงุฆูุฉ</sup> <sup><br></sup> </td><td>  <sup>ุนุฏุฏ ุตุญูุญ</sup> <sup><br></sup> </td><td>  <sup>ุนุฏุฏ ุตุญูุญ ุบูุฑ ูููุนุฉ</sup> <sup><br></sup> </td><td>  <sup>ุงูุชุงุฑูุฎ ูุงูููุช</sup> <sup><br></sup> </td><td>  <sup>ุงููููุฉ ุงูููุทููุฉ</sup> <sup><br></sup> </td><td width="75">  <sup>ูุงุฆู</sup> <sup><br></sup> </td></tr><tr><td>  <sup>1</sup> <sup><br></sup> </td><td></td><td>  <sup>int8</sup> <sup><br></sup> </td><td>  <sup>uint8</sup> <sup><br></sup> </td><td></td><td>  <sup>ููุทูู</sup> <sup><br></sup> </td><td></td></tr><tr><td>  <sup>2</sup> <sup><br></sup> </td><td>  <sup>float16</sup> <sup><br></sup> </td><td>  <sup>int16</sup> <sup><br></sup> </td><td>  <sup>uint16</sup> <sup><br></sup> </td><td></td><td></td><td></td></tr><tr><td>  <sup>4</sup> <sup><br></sup> </td><td>  <sup>float32</sup> <sup><br></sup> </td><td>  <sup>int32</sup> <sup><br></sup> </td><td>  <sup>uint32</sup> <sup><br></sup> </td><td></td><td></td><td></td></tr><tr><td>  <sup>8</sup> <sup><br></sup> </td><td>  <sup>float64</sup> <sup><br></sup> </td><td>  <sup>int64</sup> <sup><br></sup> </td><td>  <sup>uint64</sup> <sup><br></sup> </td><td>  <sup>datetime64</sup> <sup><br></sup> </td><td></td><td></td></tr><tr><td>  <sup>ุณุนุฉ ุงูุฐุงูุฑุฉ ุงููุชุบูุฑุฉ</sup> <sup><br></sup> </td><td></td><td></td><td></td><td></td><td></td><td>  <sup>ูุงุฆู</sup> <sup><br></sup> </td></tr></tbody></table><br>  ุชุณุชุฎุฏู ูููุฉ ุงูููุน <code>int8</code> ุจุงูุช ูุงุญุฏ (8 ุจุช) ูุชุฎุฒูู ุฑูู ููููู ุฃู ุชูุซู 256 ูููุฉ ุซูุงุฆูุฉ (2 ุฅูู 8 ุทุงูุฉ).  ูุฐุง ูุนูู ุฃูู ูููู ุงุณุชุฎุฏุงู ูุฐุง ุงูููุน ุงููุฑุนู ูุชุฎุฒูู ุงูููู ูู ุงููุทุงู ูู -128 ุฅูู 127 (ุจูุง ูู ุฐูู 0). <br><br>  ููุชุญูู ูู ุงูุญุฏ ุงูุฃุฏูู ูุงูุญุฏ ุงูุฃูุตู ููููู ุงูููุงุณุจุฉ ููุชุฎุฒูู ุจุงุณุชุฎุฏุงู ูู ููุน ูุฑุนู ุตุญูุญ ุ ููููู ุงุณุชุฎุฏุงู ุทุฑููุฉ <code>numpy.iinfo()</code> .  ุงููุธุฑ ูู ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">import numpy as np int_types = ["uint8", "int8", "int16"] for it in int_types:   print(np.iinfo(it))</code> </pre> <br>  ุนู ุทุฑูู ุชูููุฐ ูุฐุง ุงูุฑูุฒ ุ ูุญุตู ุนูู ุงูุจูุงูุงุช ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Machine parameters for uint8 --------------------------------------------------------------- min = 0 max = 255 --------------------------------------------------------------- Machine parameters for int8 --------------------------------------------------------------- min = -128 max = 127 --------------------------------------------------------------- Machine parameters for int16 --------------------------------------------------------------- min = -32768 max = 32767 ---------------------------------------------------------------</code> </pre> <br>  ููุง ููููู ุงูุงูุชุจุงู ุฅูู ุงููุฑู ุจูู ุฃููุงุน <code>uint</code> (ุนุฏุฏ ุตุญูุญ ุบูุฑ ููููุน) ู <code>int</code> (ุนุฏุฏ ุตุญูุญ ููููุน).  ูุชูุชุน ููุง ุงูููุนูู ุจููุณ ุงูุณุนุฉ ุ ูููู ุนูุฏ ุชุฎุฒูู ุงูููู ุงูุฅูุฌุงุจูุฉ ููุท ูู ุงูุฃุนูุฏุฉ ุ ุชุณูุญ ุงูุฃููุงุน ุบูุฑ ุงููููุนุฉ ุจุงุณุชุฎุฏุงู ุฃูุซุฑ ููุงุกุฉ ููุฐุงูุฑุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุชุนุธูู ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุนุฏุฏูุฉ ุจุงุณุชุฎุฏุงู ุงูุฃููุงุน ุงููุฑุนูุฉ</font> </h2><br>  ูููู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ <code>pd.to_numeric()</code> ุชุญููู ุฃููุงุน ุฑูููุฉ.  ูุชุญุฏูุฏ ุฃุนูุฏุฉ ุนุฏุฏ ุตุญูุญ ุ ูุณุชุฎุฏู ุทุฑููุฉ <code>DataFrame.select_dtypes()</code> ุ ุซู ูููู <code>DataFrame.select_dtypes()</code> ูููุงุฑูุฉ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูุจู ูุจุนุฏ ุงูุชุญุณูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#     ,   , #   ,      . def mem_usage(pandas_obj):   if isinstance(pandas_obj,pd.DataFrame):       usage_b = pandas_obj.memory_usage(deep=True).sum()   else: #     ,     DataFrame,   Series       usage_b = pandas_obj.memory_usage(deep=True)   usage_mb = usage_b / 1024 ** 2 #       return "{:03.2f} MB".format(usage_mb) gl_int = gl.select_dtypes(include=['int']) converted_int = gl_int.apply(pd.to_numeric,downcast='unsigned') print(mem_usage(gl_int)) print(mem_usage(converted_int)) compare_ints = pd.concat([gl_int.dtypes,converted_int.dtypes],axis=1) compare_ints.columns = ['before','after'] compare_ints.apply(pd.Series.value_counts)</code> </pre> <br>  ูุฐู ูู ูุชูุฌุฉ ุฏุฑุงุณุฉ ุงุณุชููุงู ุงูุฐุงูุฑุฉ: <br><br> <code>7.87 MB <br> 1.48 MB</code> <br> <table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  ุฅูู <br></td><td>  ุจุนุฏ <br></td></tr><tr><td>  uint8 <br></td><td>  NaN <br></td><td>  5.0 <br></td></tr><tr><td>  uint32 <br></td><td>  NaN <br></td><td>  1.0 <br></td></tr><tr><td>  int64 <br></td><td>  6.0 <br></td><td>  NaN <br></td></tr></tbody></table><br>  ูุชูุฌุฉู ูุฐูู ุ ููููู ุฑุคูุฉ ุงูุฎูุงุถ ูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูู 7.9 ุฅูู 1.5 ููุฌุงุจุงูุช ุ ุฃู ุฃููุง ุฎูุถูุง ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุจุฃูุซุฑ ูู 80ูช.  ุงูุชุฃุซูุฑ ุงูููู ููุฐุง ุงูุชุญุณูู ุนูู <code>DataFrame</code> ุงูุฃุตูู ุ ููุน ุฐูู ุ ููุณุช ูููุฉ ุจุดูู ุฎุงุต ูุฃูู ูุญุชูู ุนูู ุนุฏุฏ ูููู ุฌุฏุงู ูู ุงูุฃุนูุฏุฉ ุนุฏุฏ ุตุญูุญ. <br><br>  ุฏุนููุง ููุนู ุงูุดูุก ููุณู ูุน ุงูุฃุนูุฏุฉ ุงูุชู ุชุญุชูู ุนูู ุฃุฑูุงู ุงููุงุตูุฉ ุงูุนุงุฆูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">gl_float = gl.select_dtypes(include=['float']) converted_float = gl_float.apply(pd.to_numeric,downcast='float') print(mem_usage(gl_float)) print(mem_usage(converted_float)) compare_floats = pd.concat([gl_float.dtypes,converted_float.dtypes],axis=1) compare_floats.columns = ['before','after'] compare_floats.apply(pd.Series.value_counts)</code> </pre> <br>  ูุงููุชูุฌุฉ ูู ูุง ููู: <br><br> <code>100.99 MB <br> 50.49 MB</code> <br> <table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  ุฅูู <br></td><td>  ุจุนุฏ <br></td></tr><tr><td>  float32 <br></td><td>  NaN <br></td><td>  77.0 <br></td></tr><tr><td>  float64 <br></td><td>  77.0 <br></td><td>  NaN <br></td></tr></tbody></table><br>  ููุชูุฌุฉ ูุฐูู ุ ูุฅู ุฌููุน ุงูุฃุนูุฏุฉ ุงูุชู ุชุฎุฒู ุฃุฑูุงู <code>float64</code> ุจููุน ุงูุจูุงูุงุช <code>float64</code> ุชุฎุฒู ุงูุขู ุฃุฑูุงู ุงูููุน <code>float32</code> ุ ููุง ุฃุนุทุงูุง ุชุฎููุถูุง ุจูุณุจุฉ 50ูช ูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ. <br><br>  ูู ุจุฅูุดุงุก ูุณุฎุฉ ูู <code>DataFrame</code> ุงูุฃุตูู ุ ูุงุณุชุฎุฏู ูุฐู ุงูุฃุนูุฏุฉ ุงูุฑูููุฉ ุงููุญุณูุฉ ุจุฏูุงู ูู ุชูู ุงูุชู ูุงูุช ููุฌูุฏุฉ ูู ุงูุฃุตู ุ ูุงูุธุฑ ูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุงูููู ุจุนุฏ ุงูุชุญุณูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">optimized_gl = gl.copy() optimized_gl[converted_int.columns] = converted_int optimized_gl[converted_float.columns] = converted_float print(mem_usage(gl)) print(mem_usage(optimized_gl))</code> </pre> <br>  ุฅููู ูุง ุญุตููุง ุนููู: <br><br> <code>861.57 MB <br> 804.69 MB</code> <br> <br>  ุนูู ุงูุฑุบู ูู ุฃููุง ุฎูุถูุง ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุจุดูู ูุจูุฑ ุนู ุทุฑูู ุฃุนูุฏุฉ ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุนุฏุฏูุฉ ุ ุจุดูู ุนุงู ุ ุนุจุฑ <code>DataFrame</code> ุจุฃูููู ุ ุงูุฎูุถ ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุจูุณุจุฉ 7ูช ููุท.  ูููู ุฃู ูุตุจุญ ุชุญุณูู ุชุฎุฒูู ุฃููุงุน ุงููุงุฆูุงุช ูุตุฏุฑูุง ููุชุญุณูู ุงูุฃูุซุฑ ุฎุทูุฑุฉ ูููููู. <br><br>  ูุจู ุฃู ูููู ุจูุฐุง ุงูุชุญุณูู ุ ุณูู ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ููููุฉ ุชุฎุฒูู ุงูุณูุงุณู ูู ุงูุจุงูุฏุง ุ ูููุงุฑูุชูุง ุจููููุฉ ุชุฎุฒูู ุงูุฃุฑูุงู ููุง. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ููุงุฑูุฉ ุขููุงุช ุชุฎุฒูู ุงูุฃุฑูุงู ูุงูุณูุงุณู</font> </h2><br>  ููุซู ููุน <code>object</code> ุงูููู ุจุงุณุชุฎุฏุงู ูุงุฆูุงุช ุณูุณูุฉ Python.  ูุฐุง ุฌุฒุฆููุง ูุฃู NumPy ูุง ูุฏุนู ุชูุซูู ููู ุงูุณูุณูุฉ ุงูููููุฏุฉ.  ูุธุฑูุง ูุฃู Python ูู ูุบุฉ ุนุงููุฉ ุงููุณุชูู ูุชู ุชูุณูุฑูุง ุ ููู ูุง ุชุฒูุฏ ุงููุจุฑูุฌ ุจุฃุฏูุงุช ูุถุจุท ููููุฉ ุชุฎุฒูู ุงูุจูุงูุงุช ูู ุงูุฐุงูุฑุฉ. <br><br>  ูุคุฏู ูุฐุง ุงูููุฏ ุฅูู ุญูููุฉ ุฃูู ูุง ูุชู ุชุฎุฒูู ุงูุณูุงุณู ูู ุฃุฌุฒุงุก ูุชุฌุงูุฑุฉ ูู ุงูุฐุงูุฑุฉ ุ ูุชู ุชุฌุฒุฆุฉ ุชูุซูููุง ูู ุงูุฐุงูุฑุฉ.  ูุฐุง ูุคุฏู ุฅูู ุฒูุงุฏุฉ ูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ูุฅูู ุชุจุงุทุค ูู ุณุฑุนุฉ ุงูุนูู ูุน ููู ุงูุณูุณูุฉ.  ูู ุงููุงูุน ุ ูู ุนูุตุฑ ูู ุงูุนููุฏ ุงูุฐู ูุฎุฒู ููุน ุจูุงูุงุช ุงููุงุฆู ูู ูุคุดุฑ ูุญุชูู ุนูู "ุงูุนููุงู" ุงูุฐู ุชูุฌุฏ ุจู ุงููููุฉ ุงูุญููููุฉ ูู ุงูุฐุงูุฑุฉ. <br><br>  ูููุง ููู ุฑุณู ุชุฎุทูุทู ูุณุชูุฏ ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐู</a> ุงููุงุฏุฉ ููุงุฑู ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฑูููุฉ ุจุงุณุชุฎุฏุงู ุฃููุงุน ุจูุงูุงุช NumPy ูุชุฎุฒูู ุงูุณูุงุณู ุจุงุณุชุฎุฏุงู ุฃููุงุน ุงูุจูุงูุงุช ุงููุถููุฉ ูู Python. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d80/66f/54b/d8066f54b091531c120b94c90f698236.png"></div><br>  <i><font color="#999999">ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฑูููุฉ ูุณูุณูุฉ</font></i> <br><br>  ููุง ููููู ุฃู ุชุชุฐูุฑ ุฃูู ูู ุฃุญุฏ ุงูุฌุฏุงูู ุฃุนูุงู ุ ุชุจูู ุฃูู ูุชู ุงุณุชุฎุฏุงู ููุฏุงุฑ ูุชุบูุฑ ูู ุงูุฐุงูุฑุฉ ูุชุฎุฒูู ุจูุงูุงุช ุฃููุงุน ุงููุงุฆูุงุช.  ุนูู ุงูุฑุบู ูู ุฃู ูู ูุคุดุฑ ูุดุบู ุจุงูุช ูุงุญุฏ ูู ุงูุฐุงูุฑุฉ ุ ุฅูุง ุฃู ูู ูููุฉ ุณูุณูุฉ ูุนููุฉ ุชุดุบู ููุณ ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงูุชู ุณูุชู ุงุณุชุฎุฏุงููุง ูุชุฎุฒูู ุณูุณูุฉ ูุงุญุฏุฉ ูู Python.  ูุชุฃููุฏ ูุฐุง ุ <code>sys.getsizeof()</code> ุทุฑููุฉ <code>sys.getsizeof()</code> .  ุฃููุงู ุ ุฃูู ูุธุฑุฉ ุนูู ุงูุฃุณุทุฑ ุงููุฑุฏูุฉ ุ ุซู ุนูู ูุงุฆู <code>Series</code> ุงูุจุงูุฏุง ุงูุฐู ูุฎุฒู ุจูุงูุงุช ุงูุณูุณูุฉ. <br><br>  ูุฐูู ุ ุฃููุงู ููุญุต ุงูุฎุทูุท ุงููุนุชุงุฏุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">from sys import getsizeof s1 = 'working out' s2 = 'memory usage for' s3 = 'strings in python is fun!' s4 = 'strings in python is fun!' for s in [s1, s2, s3, s4]:   print(getsizeof(s))</code> </pre> <br>  ููุง ุ ุชุจุฏู ุจูุงูุงุช ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ููุง ููู: <br><br> <code>60 <br> 65 <br> 74 <br> 74</code> <br> <br>  ุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุธููุฑ ุงุณุชุฎุฏุงู ุงูุณูุงุณู ูู ูุงุฆู <code>Series</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">obj_series = pd.Series(['working out',                         'memory usage for',                         'strings in python is fun!',                         'strings in python is fun!']) obj_series.apply(getsizeof)</code> </pre> <br>  ููุง ูุญุตู ุนูู ูุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0    60 1    65 2    74 3    74 dtype: int64</code> </pre> <br>  ููุง ููููู ุฃู ุชุฑู ุฃู ุฃุญุฌุงู ุงูุฎุทูุท ุงููุฎุฒูุฉ ูู ูุงุฆูุงุช <code>Series</code> ุงูุจุงูุฏุง ุชุดุจู ุฃุญุฌุงููุง ุนูุฏ ุงูุนูู ูุนูุง ูู ุจูุซูู ูุนูุฏ ุชูุซูููุง ูููุงูุงุช ูููุตูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุชุนุธูู ุชุฎุฒูู ุจูุงูุงุช ููุน ุงููุงุฆู ุจุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ุงููุฆููุฉ</font> </h2><br>  ุธูุฑุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุชุบูุฑุงุช</a> ุงููุฆููุฉ ูู ุงูุจุงูุฏุง ุงูุฅุตุฏุงุฑ 0.15.  ูุณุชุฎุฏู ุงูููุน ุงููุทุงุจู ุ <code>category</code> ุ ููู ุนุฏุฏ ุตุญูุญ ูู ุขููุงุชู ุงูุฏุงุฎููุฉ ุ ุจุฏูุงู ูู ุงูููู ุงูุฃุตููุฉ ุงููุฎุฒูุฉ ูู ุฃุนูุฏุฉ ุงูุฌุฏูู.  ูุณุชุฎุฏู Pandas ูุงููุณ ูููุตู ูุญุฏุฏ ูุฑุงุณูุงุช ุนุฏุฏ ุตุญูุญ ูููู ุฃูููุฉ.  ูุฐุง ุงูููุฌ ูููุฏ ุนูุฏูุง ุชุญุชูู ุงูุฃุนูุฏุฉ ุนูู ููู ูู ูุฌููุนุฉ ูุญุฏูุฏุฉ.  ุนูุฏูุง ูุชู ุชุญููู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูู ุนููุฏ ุฅูู ููุน <code>category</code> ุ ุชุณุชุฎุฏู ุงูุจุงูุฏุง ุงูููุน ุงููุฑุนู <code>int</code> ุ ูุงูุฐู ูุณูุญ ุจุงุณุชุฎุฏุงู ุฃูุซุฑ ููุงุกุฉ ููุฐุงูุฑุฉ ูููููู ุชูุซูู ุฌููุน ุงูููู ุงููุฑูุฏุฉ ุงูููุฌูุฏุฉ ูู ุงูุนููุฏ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1f5/48d/59c/1f548d59c9b41fd906d038c19d3a2da2.png"></div><br>  <i><font color="#999999">ูุตุฏุฑ ุงูุจูุงูุงุช ูุงูุจูุงูุงุช ุงููุฆููุฉ ุจุงุณุชุฎุฏุงู ุงูููุน ุงููุฑุนู int8</font></i> <br><br>  ููู ูููู ุจุงูุถุจุท ุฃูู ูููููุง ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงููุฆููุฉ ูุชูููู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุ ูุฌุฏ ุนุฏุฏ ุงูููู ุงููุฑูุฏุฉ ูู ุงูุฃุนูุฏุฉ ุงูุชู ุชุฎุฒู ููู ุฃููุงุน ุงููุงุฆูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">gl_obj = gl.select_dtypes(include=['object']).copy() gl_obj.describe()</code> </pre> <br>  ููููู ุงูุนุซูุฑ ุนูู ูุง ูุฏููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง</a> ุงูุฌุฏูู ุ ุนูู ุงููุฑูุฉ <code>    </code> . <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูุนููุฏ <code>day_of_week</code> ุ ููู ููู ุงูุฃุณุจูุน ุงูุฐู ุชู ูุนุจ ุงููุนุจุฉ ููู ุ ููุงู 171907 ูููุฉ.  ูู ุจูููุง ุ ููุท 7 ูุฑูุฏุฉ ูู ููุนูุง.  ุจุดูู ุนุงู ุ ูููู ุฅููุงุก ูุธุฑุฉ ูุงุญุฏุฉ ุนูู ูุฐุง ุงูุชูุฑูุฑ ูููู ุฃูู ูุชู ุงุณุชุฎุฏุงู ุนุฏุฏ ูููู ูู ุงูููู ุงููุฑูุฏุฉ ูู ุงูุนุฏูุฏ ูู ุงูุฃุนูุฏุฉ ูุชูุซูู ุจูุงูุงุช ุญูุงูู 172000 ูุนุจุฉ. <br><br>  ูุจู ุฃู ูููู ุจุงูุชุญุณูู ุนูู ูุทุงู ูุงุณุน ุ ุฏุนููุง ูุฎุชุงุฑ ุนููุฏูุง ูุงุญุฏูุง ูุฎุฒู ุจูุงูุงุช ุงููุงุฆู ุ ุนูู ุงูุฃูู <code>day_of_week</code> ุ ููุฑู ูุง ูุญุฏุซ ุฏุงุฎู ุงูุจุฑูุงูุฌ ุนูุฏ ุชุญูููู ุฅูู ููุน ูุงุทุน. <br><br>  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ูุญุชูู ูุฐุง ุงูุนููุฏ ุนูู 7 ููู ูุฑูุฏุฉ ููุท.  ูุชุญูููู ุฅูู ููุน ูุงุทุน ุ ูุณุชุฎุฏู ุทุฑููุฉ <code>.astype()</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">dow = gl_obj.day_of_week print(dow.head()) dow_cat = dow.astype('category') print(dow_cat.head())</code> </pre> <br>  ุฅููู ูุง ุญุตููุง ุนููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0    Thu 1    Fri 2    Sat 3    Mon 4    Tue Name: day_of_week, dtype: object 0    Thu 1    Fri 2    Sat 3    Mon 4    Tue Name: day_of_week, dtype: category Categories (7, object): [Fri, Mon, Sat, Sun, Thu, Tue, Wed]</code> </pre> <br>  ููุง ุชุฑู ุ ุนูู ุงูุฑุบู ูู ุชุบูุฑ ููุน ุงูุนููุฏ ุ ูุฅู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ููู ุชุจุฏู ููุง ูุงูุช ูู ูุจู.  ุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุง ูุญุฏุซ ุฏุงุฎู ุงูุจุฑูุงูุฌ. <br><br>  ูู ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ุ ูุณุชุฎุฏู ุงูุณูุฉ <code>Series.cat.codes</code> ููุนุฑูุฉ ุงูููู ุงูุตุญูุญุฉ ุงูุชู ูุณุชุฎุฏููุง ููุน <code>category</code> ูุชูุซูู ูู ููู ูู ุฃูุงู ุงูุฃุณุจูุน: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">dow_cat.head().cat.codes</code> </pre> <br>  ูุชููู ูู ูุนุฑูุฉ ูุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0    4 1    0 2    2 3    1 4    5 dtype: int8</code> </pre> <br>  ููุง ููููู ุฃู ุชุฑู ุฃู ูู ูููุฉ ูุฑูุฏุฉ ูุชู ุชุนููู ูููุฉ ุนุฏุฏูุฉ ููุง ุ ูุฃู ุงูุนููุฏ ุงูุขู ูู ุงูููุน <code>int8</code> .  ูุง ุชูุฌุฏ ููู ููููุฏุฉ ุ ูููู ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุณูุชู ุงุณุชุฎุฏุงู -1 ููุฅุดุงุฑุฉ ุฅูู ูุฐู ุงูููู. <br><br>  ุงูุขู ุฏุนูุง ููุงุฑู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ูุจู ูุจุนุฏ ุชุญููู ุงูุนููุฏ <code>day_of_week</code> ุฅูู ููุน <code>category</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">print(mem_usage(dow)) print(mem_usage(dow_cat))</code> </pre> <br>  ูุฐู ูู ุงููุชูุฌุฉ: <br><br> <code>9.84 MB <br> 0.16 MB</code> <br> <br>  ููุง ุชุฑูู ุ ูู ุงูุจุฏุงูุฉ ุชู ุงุณุชููุงู 9.84 ููุบุงุจุงูุช ูู ุงูุฐุงูุฑุฉ ุ ูุจุนุฏ ุงูุชุญุณูู ููุท 0.16 ููุฌุงุจุงูุช ุ ููุง ูุนูู ุชุญุณู ุจูุณุจุฉ 98ูช ูู ูุฐุง ุงููุคุดุฑ.  ูุฑุฌู ููุงุญุธุฉ ุฃู ุงูุนูู ูุน ูุฐุง ุงูุนููุฏ ุฑุจูุง ููุถุญ ุฃุญุฏ ุฃูุซุฑ ุณููุงุฑูููุงุช ุงูุชุญุณูู ุฑุจุญูุฉ ุนูุฏูุง ูุชู ุงุณุชุฎุฏุงู 7 ููู ูุฑูุฏุฉ ููุท ูู ุนููุฏ ูุญุชูู ุนูู ุญูุงูู 172000 ุนูุตุฑ. <br><br>  ุนูู ุงูุฑุบู ูู ุฃู ููุฑุฉ ุชุญููู ุฌููุน ุงูุฃุนูุฏุฉ ุฅูู ููุน ุงูุจูุงูุงุช ูุฐุง ุชุจุฏู ุฌุฐุงุจุฉ ุ ูุจู ุงูููุงู ุจุฐูู ุ ูุฌุจ ูุฑุงุนุงุฉ ุงูุขุซุงุฑ ุงูุฌุงูุจูุฉ ุงูุณูุจูุฉ ููุฐุง ุงูุชุญููู.  ูุฐูู ุ ูุฅู ุฃุฎุทุฑ ูู ูุฐุง ุงูุชุญูู ูู ุงุณุชุญุงูุฉ ุฅุฌุฑุงุก ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุนูู ุงูุจูุงูุงุช ุงููุฆููุฉ.  ููุทุจู ูุฐุง ุฃูุถูุง ุนูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุงูุนุงุฏูุฉ ุ ูุงุณุชุฎุฏุงู ุฃุณุงููุจ ูุซู <code>Series.min()</code> ู <code>Series.max()</code> ุฏูู ุชุญููู ุงูุจูุงูุงุช ุฃููุงู ุฅูู ููุน ุฑูู ุญูููู. <br><br>  ูุฌุจ ุฃู ููุตุฑ ุงุณุชุฎุฏุงู ููุน <code>category</code> ุนูู ุงูุฃุนูุฏุฉ ุงูุชู ุชุฎุฒู ุจูุงูุงุช <code>object</code> ุงูููุน ุจุดูู ุฃุณุงุณู ุ ุญูุซ ูููู ุฃูู ูู 50ูช ูู ุงูููู ูุฑูุฏุฉ ูู ููุนูุง.  ุฅุฐุง ูุงูุช ุฌููุน ุงูููู ุงูููุฌูุฏุฉ ูู ุงูุนููุฏ ูุฑูุฏุฉ ุ ูุณูุคุฏู ุงุณุชุฎุฏุงู ููุน <code>category</code> ุฅูู ุฒูุงุฏุฉ ูุณุชูู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ.  ูุฐุง ูุฑุฌุน ุฅูู ุญูููุฉ ุฃูู ูู ุงูุฐุงูุฑุฉ ูุฏูู ูุชุฎุฒูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฑููุฒ ุงููุฆุฉ ุงูุฑูููุฉ ุ ูููู ุงูุณูุณูุฉ ุงูุฃุตููุฉ.  ูููู ุงูุงุทูุงุน ุนูู ุชูุงุตูู ูููุฏ ุฃููุงุน <code>category</code> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู</a> ุงูุจุงูุฏุง. <br><br>  ุฏุนูุง ููุดุฆ ุญููุฉ ุชุชูุฑุฑ ุนูู ุฌููุน ุงูุฃุนูุฏุฉ ุงูุชู ุชุฎุฒู ุจูุงูุงุช <code>object</code> ุงููุชุงุจุฉ ุ ููุนุฑูุฉ ูุง ุฅุฐุง ูุงู ุนุฏุฏ ุงูููู ุงููุฑูุฏุฉ ูู ุงูุฃุนูุฏุฉ ูุชุฌุงูุฒ 50 ูช ุ ูุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุญูููุง ุฅูู ูุชุงุจุฉ <code>category</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">converted_obj = pd.DataFrame() for col in gl_obj.columns:   num_unique_values = len(gl_obj[col].unique())   num_total_values = len(gl_obj[col])   if num_unique_values / num_total_values &lt; 0.5:       converted_obj.loc[:,col] = gl_obj[col].astype('category')   else:       converted_obj.loc[:,col] = gl_obj[col]</code> </pre> <br>  ูุงุฑู ุงูุขู ูุง ุญุฏุซ ุจุนุฏ ุงูุชุญุณูู ุจูุง ุญุฏุซ ูู ูุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">print(mem_usage(gl_obj)) print(mem_usage(converted_obj)) compare_obj = pd.concat([gl_obj.dtypes,converted_obj.dtypes],axis=1) compare_obj.columns = ['before','after'] compare_obj.apply(pd.Series.value_counts)</code> </pre> <br>  ูุญุตู ุนูู ูุง ููู: <br><br> <code>752.72 MB <br> 51.67 MB</code> <br> <table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  ุฅูู <br></td><td>  ุจุนุฏ <br></td></tr><tr><td>  ูุงุฆู <br></td><td>  78.0 <br></td><td>  NaN <br></td></tr><tr><td>  ุงููุฆุฉ <br></td><td>  NaN <br></td><td>  78.0 <br></td></tr></tbody></table><br>           <code>category</code> ,     ,          , ,      ,     ,    ,  ,     . <br><br>  ,  ,     ,    <code>object</code> ,   752   52 ,    93%.     ,          .  ,       ,   ,  ,     891 . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">optimized_gl[converted_obj.columns] = converted_obj mem_usage(optimized_gl)</code> </pre> <br>     : <br><br> <code>'103.64 MB'</code> <br> <br>  .     - .    ,       <code>datetime</code> , ,  ,        . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">date = optimized_gl.date print(mem_usage(date)) date.head()</code> </pre> <br>       : <br><br> <code>0.66 MB</code> <br> <br>    : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0    18710504 1    18710505 2    18710506 3    18710508 4    18710509 Name: date, dtype: uint32</code> </pre> <br>  ,               <code>uint32</code> . -       <code>datetime</code>     ,         64 .       <code>datetime</code> ,  ,  ,          . <br><br>      <code>to_datetime()</code> ,  <code>format</code>    ,      <code>YYYY-MM-DD</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">optimized_gl['date'] = pd.to_datetime(date,format='%Y%m%d') print(mem_usage(optimized_gl)) optimized_gl.date.head()</code> </pre> <br>    : <br><br> <code>104.29 MB</code> <br> <br>    : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0   1871-05-04 1   1871-05-05 2   1871-05-06 3   1871-05-08 4   1871-05-09 Name: date, dtype: datetime64[ns]</code> </pre> <br><h2 style=";text-align:right;direction:rtl"> <font color="#3AC1EF">    </font> </h2><br>            <code>DataFrame</code> .        , , ,   ,  ,  ,  ,  .       ,        .    ,     ,     ,     .        ,        ,      <code>DataFrame</code> ,   . <br><br>  ,             .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pandas.read_csv()</a>   ,   . ,  <code>dtype</code>  ,   ,   ,   ,     โ  NumPy. <br><br>      ,          ,   .         ,      . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">dtypes = optimized_gl.drop('date',axis=1).dtypes dtypes_col = dtypes.index dtypes_type = [i.name for i in dtypes.values] column_types = dict(zip(dtypes_col, dtypes_type)) #    161 ,  #  10  /   #     preview = first2pairs = {key:value for key,value in list(column_types.items())[:10]} import pprint pp = pp = pprint.PrettyPrinter(indent=4) pp.pprint(preview)     : {   'acquisition_info': 'category',   'h_caught_stealing': 'float32',   'h_player_1_name': 'category',   'h_player_9_name': 'category',   'v_assists': 'float32',   'v_first_catcher_interference': 'float32',   'v_grounded_into_double': 'float32',   'v_player_1_id': 'category',   'v_player_3_id': 'category',   'v_player_5_id': 'category'}</code> </pre> <br>          ,      ,    . <br><br>    - : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">read_and_optimized = pd.read_csv('game_logs.csv',dtype=column_types,parse_dates=['date'],infer_datetime_format=True) print(mem_usage(read_and_optimized)) read_and_optimized.head()</code> </pre> <br>       : <br><br> <code>104.28 MB</code> <br> <br>    ,     <code>   </code>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> . <br><br>  ,    <code>   </code>  <code>   </code> ,     ,  ,       .      pandas       861.6   104.28 ,     88% . <br><br><h2 style=";text-align:right;direction:rtl"> <font color="#3AC1EF">  </font> </h2><br> ,  ,    ,     .     . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">optimized_gl['year'] = optimized_gl.date.dt.year games_per_day = optimized_gl.pivot_table(index='year',columns='day_of_week',values='date',aggfunc=len) games_per_day = games_per_day.divide(games_per_day.sum(axis=1),axis=0) ax = games_per_day.plot(kind='area',stacked='true') ax.legend(loc='upper right') ax.set_ylim(0,1) plt.show()</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3b2/699/6a2/3b26996a26b73e9a3ce87f3ff22dcf34.png"></div><br> <i><font color="#999999">,    </font></i> <br><br>  ,  1920-      ,  ,    50 ,        . <br><br>  ,  ,    ,      50 ,   . <br><br>    ,      . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">game_lengths = optimized_gl.pivot_table(index='year', values='length_minutes') game_lengths.reset_index().plot.scatter('year','length_minutes') plt.show()</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a6d/6db/5d2/a6d6db5d2e6bdb7330ac8a0ff2a6febd.png"></div><br> <i><font color="#999999"> </font></i> <br><br>   ,   1940-         . <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ุงููุชุงุฆุฌ</font> </h2><br>            pandas,         ,     <code>DataFrame</code> ,   90%.       : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">       ,   ,   ,    , . </li><li style=";text-align:right;direction:rtl">        . </li></ul><br>  ,            , ,         ,    ,  ,       pandas,    ,    . <br><br>  <b>ุฃุนุฒุงุฆู ุงููุฑุงุก!</b>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">eugene_bb</a> .    -  ,    โ    . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar442516/">https://habr.com/ru/post/ar442516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar442504/index.html">ูููู PHP Xdebug: ุนูุฏูุง ูุง ุชููู ุงูููุฒุงุช ุงูููุงุณูุฉ ูู Xdebug ูุงููุฉ</a></li>
<li><a href="../ar442506/index.html">ูู ุชุนุงูุจ ุฑูุณูุง ุนูู ุงูุงุชุฌุงุฑ ุบูุฑ ุงููุดุฑูุน ูู ุงูุจูุงูุงุช ุงูุดุฎุตูุฉุ</a></li>
<li><a href="../ar442508/index.html">ููู ุชุณุฑุน udalenka ุงูุงุจุชูุงุฑ ูู GitLab</a></li>
<li><a href="../ar442512/index.html">ุชุฎุตูุต Django ORM ุนูู ุณุจูู ุงููุซุงู ูู ZomboDB</a></li>
<li><a href="../ar442514/index.html">ุงููุธู ุงูููุฒุนุฉ. ุฃููุงุท ุงูุชุตููู. ูุฑุงุฌุนุฉ ูุชุงุจ</a></li>
<li><a href="../ar442518/index.html">ุฃูุถู 10 ุชูููุงุช ูููุฑุตูุฉ ุนูู ุงูุฅูุชุฑูุช 2018</a></li>
<li><a href="../ar442520/index.html">ุงููุถูุฉ. ุชูููุฑ 300 000 ุต. ุดูุฑูุง ุนูู ุงูุฅุนูุงูุงุช ุงูุณูุงููุฉ</a></li>
<li><a href="../ar442522/index.html">ุญุฏุณู RL (ุงูุชุนูู ุงูุชุนุฒูุฒ): ููุฏูุฉ ุฅูู ููุฒุฉ ุ ุงููุงูุฏ ุงููุงูุฏ (A2C)</a></li>
<li><a href="../ar442524/index.html">ููููุฉ ุฒูุงุฏุฉ ุงูุฃูู ูู ุชุญุฏูุฏ ุงููููุฉ ูุฃูุธูุฉ ุงูุชุญูู ูู ุงููุตูู</a></li>
<li><a href="../ar442526/index.html">ุชุงุฑูุฎ ูุงุนุจู ุงููุงุณูุช ุงูุณูููุงุชู (ุงูุฌุฒุก ุงูุซุงูู): ุทูุฑุฉ ุฌูุงุฒ Walkmen ุ ููู ุฃุฏุงุฉ ูุฃุฌูุฒุฉ KGB ููุณุฌูุงุช ุงูุฃุดุฑุทุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>