<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòé üõ§Ô∏è ü¶É Zentrales Bedienfeld f√ºr Lichtquellen TsPKIO-2D Rotor üëù ü§¢ ‚úèÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Entschuldigung, ich hatte lange Zeit keinen Spa√ü mehr mit der Benennung sowie mit Peripherieger√§ten f√ºr die Heimautomation. Insbesondere dieses Ding -...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zentrales Bedienfeld f√ºr Lichtquellen TsPKIO-2D Rotor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/411093/"><img src="https://habrastorage.org/getpro/geektimes/post_images/72f/6a9/ceb/72f6a9ceb826b19cdb266c3d334da65b.jpg" alt="Bild"><br><br>  Entschuldigung, ich hatte lange Zeit keinen Spa√ü mehr mit der Benennung sowie mit Peripherieger√§ten f√ºr die Heimautomation.  Insbesondere dieses Ding - die Fernbedienung des Lichts - stellte sich heraus, weil ich etwas mit einer Push-Twist-Click-Oberfl√§che und nicht mit einer √ºblichen Streuung von Tasten wollte.  Der Wow-Effekt wurde nicht erreicht: Zu Hause bemerke ich die Fernbedienung nicht aus n√§chster N√§he, aber zumindest habe ich die Gestalt geschlossen. <br><a name="habracut"></a><br>  Kurze TOR: <br><br>  1) Verwaltung von drei Beleuchtungsgruppen in der K√ºche <br>  2) Verwaltung von drei Beleuchtungsgruppen im Raum <br>  3) Verwaltung aller Lichtquellen gleichzeitig <br>  4) Angemessene Akkulaufzeit (ab einer Woche) <br>  5) Kompatibel mit Livolo-Codierung, SC2260, EV1527 <br><br>  Sie m√ºssen also nicht weiter lesen, wenn Sie Arduino, Livolo-Schalter und chinesische Funkbuchsen nicht m√∂gen.  Denn die erste ist die Basis f√ºr die Fernbedienung und die zweite und dritte die Peripherie. <br><br><h2>  Konzept </h2><br>  Die Steuerlogik schien mir wie folgt: <br><br><ol><li>  Durch Dr√ºcken des ‚ÄûKnopfes‚Äú werden die Zonen der Beleuchtungsgruppe in einem Ring (K√ºche - Raum - alles) umgeschaltet. </li><li>  Durch Drehen des Knopfes wird je nach Drehrichtung die Beleuchtung der ausgew√§hlten Gruppe ein- oder ausgeschaltet. </li><li>  Die Betriebsart (ausgew√§hlte Gruppe) wird durch eine unauff√§llige LED-Anzeige angezeigt. </li></ol><br>  Da ich die Funksteuerung nach der am meisten verachteten Option ohne Schutz vor St√∂rungen und R√ºckkopplungen verwende, wird gleichzeitig ein kleiner Trick f√ºr den Fall einer vers√§umten Operation bereitgestellt. <br><br>  Wenn das Drehen des Knopfes nicht zum gew√ºnschten Ergebnis f√ºhrt, k√∂nnen Sie den Befehl √ºberspringen, indem Sie in die entgegengesetzte Richtung dr√ºcken und drehen.  Dann kann der Befehl wie gewohnt wiederholt werden. <br><br>  Das hei√üt, wenn ich den Knopf im Uhrzeigersinn gedreht habe und das Hauptlicht nicht aufleuchtete, kann ich den Knopf dr√ºcken, gegen den Uhrzeigersinn drehen und dann loslassen und erneut im Uhrzeigersinn drehen, um das Einschalten zu wiederholen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/V0ZpCxEb3-U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Warum so schwer?  Dann habe ich neben den umst√§ndlichen Protokollen auch umst√§ndliche Peripherieger√§te.  Zum Beispiel funkgesteuerte Lichtschalter Livolo und Funkrelais, die denselben Befehl zum Ein- und Ausschalten haben, zusammen mit normalen Funkbuchsen, in denen die Befehle zum Ein- und Ausschalten getrennt sind. <br><br>  Mit dem Team-Skipping-Trick k√∂nnen Sie das Nichteinschlie√üen (Nichtausschlie√üen) kreativ √ºberwinden, ohne das allgemeine Beleuchtungsschema zu verletzen.  Wenn Sie einen Befehl √ºberspringen, k√∂nnen Sie au√üerdem √ºber Lichtquellen springen, die Sie nicht ein- oder ausschalten m√ºssen. <br><br>  Um zu verstehen, was mit der Fernbedienung passiert, verf√ºgt sie nat√ºrlich √ºber eine separate Anzeige, die beim Senden eines Befehls aufleuchtet. <br><br>  Wenn die Konsole einige Zeit nicht ber√ºhrt wird (im Code konfiguriert), geht der Controller in den Ruhezustand.  Er rettet jedoch nicht den letzten Zustand, und wenn er durch Dr√ºcken des Stifts aufwacht, beginnt er sein Leben von Grund auf neu. <br><br>  Dies ist kein Fehler.  Ich wiederhole, ich habe Schalter ohne R√ºckmeldung und die Konsole kann physisch keine Informationen √ºber den aktuellen Status jedes gesteuerten Peripherieger√§ts erhalten. <br><br>  Daher schaltet das Drehen des Knopfes unmittelbar nach dem Aufwachen das Licht von Grund auf ein oder aus. <br><br><h2>  Erster Ansatz </h2><br>  Das visuelle Konzept des Typs ‚ÄûBox mit einem Twist‚Äú erforderte, wie Sie sich vorstellen k√∂nnen, zwei Dinge: Boxen und Twists.  In der ersten Version wurde die Rolle der Box von einer d√ºnnen Powerbank gespielt, deren Verwendung zwei Probleme gleichzeitig l√∂ste: Ich hatte sowohl ein Geh√§use als auch ein Batterieladeschema, au√üerdem mit einem Stecker.  Die Batterie selbst musste nat√ºrlich durch eine kompaktere ersetzt werden, sonst konnte die F√ºllung nicht mehr passen. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/640/299/4df/6402994df7e71b82835d12f42541f1f0.jpg" alt="Bild"><br><br>  Es stellte sich heraus, dass die Wendung komplizierter war.  Bei der Suche stellte ich fest, dass die Kosten f√ºr das Gramm umso n√§her an den Kosten f√ºr ein Gramm Gold liegen, je sch√∂ner der Potentiometerknopf ist und je gr√∂√üer er ist.  Deshalb habe ich mir einen Stift gekauft, der mir f√ºr √§sthetische Eigenschaften nur minimal geeignet war. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/232/a3e/b60/232a3eb6074d6d8724fdc76d353274cc.jpg" alt="Bild"><br><br>  Der Steuerungsteil war das Ergebnis eines Experiments mit ATmega328P und einer logischen Fortsetzung der Handlung, die durch die vorhandene Hausautomation (auf denselben Arduino- und primitiven Funkprotokollen) festgelegt wurde. <br><br>  Ich habe nicht sehr teuer eine Streuung der genannten Controller und bedingten Prototyp-Leiterplatten (in der Tat einen Adapter von einem kleinen Geh√§use zu einem gro√üen Schritt) gekauft, um daraus eine Low-Budget-Version von Arduino mit einer minimalen (aber vern√ºnftigen) Anzahl von Elementen zu erstellen. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/625/ebb/095/625ebb0959641911621741e00fb1b699.jpg" alt="Bild"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/be0/e1c/ac4/be0e1cac460246c56f97f0c45e1c8bc7.jpg" alt="Bild"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/53d/bc5/9f1/53dbc59f1bb9ec5583f84de546b2df76.jpg" alt="Bild"><br><br>  Das Experiment erwies sich als erfolgreich, und der f√ºr die Arduino-Umgebung konfigurierte Controller blinkte die LED nach dem Verschlucken des klassischen Blink ziemlich erfolgreich.  Nun, dann habe ich nach dem Prinzip ‚ÄûBeende die Eule‚Äú der resultierenden Karte einen Encoder (mit einem Knopf), drei LEDs und einen normalen Sender mit Amplitudenmodulation auf einem Tr√§ger von 433,92 MHz hinzugef√ºgt. <br><br>  Um alle Elemente in einem kleinen Koffer unterzubringen, musste ich ein wenig leiden, aber die Fernbedienung funktionierte immer noch.  Und obwohl das Problem anscheinend gel√∂st ist, wollte ich mehr - den urspr√ºnglichen Fall. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b0b/716/2cc/b0b7162cc2941009ef081f0f76e4a2a8.jpg" alt="Bild"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/36b/08b/c76/36b08bc76093a6b66fe3f5e1b3597b1a.jpg" alt="Bild"><br><br><h2>  Zweiter Ansatz </h2><br>  Tats√§chlich war die erste Version (Beschwerde) einer Gruppe von Kameraden zerbrochen, so dass ich sie auf unbestimmte Zeit verschoben habe.  Aber er hat es nicht auseinander genommen: Es ist schade. <br><br>  Aber als der 3D-Drucker erschien, versprach er sich eines Tages, den gleichen Originalfall herzustellen und so die Frage mit der Fernbedienung zu schlie√üen. <br><br>  Ich wei√ü nicht, ob es gut oder schlecht geworden ist - ich wei√ü nicht wirklich, wie ich meine Sachen bewerten soll.  Aber bei 3DToday ist das Team einladender als bei MySKU (wor√ºber ich mich nicht beschwere - es ist selbst kein Geschenk), und sie bewerteten den Fall h√∂her als ich. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/5a1/89d/905/5a189d905d402c93afba5e4f4d88c1da.jpg" alt="Bild"><br><br>  Da ich jedoch v√∂llige Handlungsfreiheit hatte, gab ich die zerbrechlichen und verschwommenen chinesischen Batterien auf und nahm einen guten alten 18650 als Stromquelle. Und wie Sie leicht sehen k√∂nnen, bestimmen genau seine Abmessungen ma√ügeblich die Abmessungen des gesamten Geh√§uses. <br><br>  Ich fing an, das Geh√§use selbst modular zu gestalten, bestehend aus vielen Teilen, wodurch ich nur einzelne (fehlerhafte oder nicht sehr optimale) Elemente und nicht das gesamte Produkt nachdrucken konnte. <br><br>  Ein weiterer Punkt ist, dass ich wirklich keine Ausschnitte f√ºr Steckverbinder machen m√∂chte, was ich wirklich nicht kann.  Daher gibt es in der Lieferkette einen weiteren Trick, der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Evelyn, dem Igel, bekannt ist</a> : das drahtlose Laden. <br><br><img src="https://habrastorage.org/webt/ie/zq/6m/iezq6m_73cckmk6y-bidsohs9ye.jpeg"><br><br>  In meinem zashashnik lag einfach ein weiterer Empf√§nger, den ich sofort in Aktion setzte. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/fDLqxxDvQhM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Schlie√ülich ist der letzte Trick ziemlich offensichtlich, aber dennoch: Damit die Fernbedienung nicht um den Tisch kriecht, habe ich ein St√ºck einer rutschfesten Automatte auf den Boden geklebt.  Und am Ende ist dieses Ding ein absoluter Monolith, obwohl es auch kein Problem ist, es an einen anderen Ort zu bringen. <br><br><h2>  Was es braucht, um zu wiederholen </h2><br><h3>  St√ºck Eisen </h3><br>  1) ATmega328P-Controller - 1 Stck.  (in meinem TQFP-Paket, aber jeder kann) <br>  2) 10 kOhm Widerstand - 5 Stk.  (4 zur Unterdr√ºckung des Gebersprungs, 1 zur Steuerung) <br>  3) 100 Ohm Widerstand - 3 Stck. <br>  4) Keramikkondensatoren 0,1 Mikrofarad - 4 Stk.  (zur Steuerung und Unterdr√ºckung des Encoder-Bounce) <br>  5) Encoder (Valcoder) dr√ºcken - 1 Stck.  (Ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PEC12-4220F-S0024</a> ) <br>  6) LEDs - 3 Stck.  (Durchmesser 3 mm) <br>  7) Lithium-Batterie-Ladekarte - 1 Stck.  (Von der Powerbank, die theoretisch zur Hand war, reicht theoretisch jeder mit automatischem Einschalten unter Last) <br>  8) Qi Wireless Charging Receiver - 1 Stck. <br>  9) Ein Sender mit Amplitudenmodulation bei 433 MHz - 1 Stck.  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">so</a> ) <br>  10) Etwas Glasfaser f√ºr Encoderplatine <br>  11) 3D-Drucker <br>  12) Geeigneter Kunststoff (ich habe PLA gedruckt) <br>  13) M4x30 Schrauben - 4 Stck. <br><br>  Im Allgemeinen kann die Anzahl der Komponenten reduziert werden.  Zum Beispiel erfordert der Controller in einer sehr minimalen Version √ºberhaupt keine Umreifung, obwohl ich mich entschlossen habe, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Ratschl√§gen von Nick Gammon</a> zu folgen und nicht ein paar Kondensatoren und einen Widerstand verschont habe. <br><br>  Auf die gleiche Weise k√∂nnen Sie sich nicht mit der Hardware-Unterdr√ºckung von Kontaktspr√ºngen besch√§ftigen und versuchen, mit Software auszukommen.  Dann k√∂nnen Sie vier weitere Widerst√§nde und ein Paar Kondensatoren abkreuzen. <br><br>  Alternativ k√∂nnen Sie ein fertiges Arduino-Board wie das Pro Mini verwenden, aber in diesem Fall kann ich keinen niedrigen Energieverbrauch garantieren, und Sie m√ºssen es selbst zaubern.  Gleichzeitig muss der Fall korrigiert werden. <br><br>  Schema: <br><br><img src="https://habrastorage.org/webt/wo/xv/hh/woxvhhfaucpc3emhiyipfk56m1s.png"><br><br>  Als Referenz die Pinbelegung ATmega328p im TQFP-32-Paket von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hobby Electronics</a> : <br><br><img src="https://habrastorage.org/webt/1y/ea/sp/1yeasp0veriyrgvhrafu_inlwlm.jpeg"><br><br>  F√ºr meinen Encoder habe ich eine kleine Tafel gezeichnet: <br><br><img src="https://habrastorage.org/webt/i2/jg/d7/i2jgd7p7jlv1kyhbyjhoayd3d4k.jpeg"><br><br><img src="https://habrastorage.org/webt/ke/cr/yt/kecrytksno5yhwsjjdpcbwgc9-c.jpeg"><br><br><img src="https://habrastorage.org/webt/6y/vb/8j/6yvb8jl1h6zvpm-z-atgntumnsw.jpeg"><br><br>  Wenn es gut ist, m√ºsste es f√ºr die Montage des Encoders gebohrt oder mit seinem ‚ÄûBauch auf die Platine gedr√ºckt werden (wobei auf Isolation geachtet wird, damit kein Kurzschluss auftritt), damit der Encoder a) mehr oder weniger gleichm√§√üig montiert wird und b) nicht wackelt.  Historisch gesehen habe ich eine zweite Option. <br><br>  F√ºr den Fall ist es wichtig, dass die H√∂he der Platine mit Teilen ohne den Encoder nicht mehr (oder nicht viel mehr) 5 mm betr√§gt. <br><br><div class="spoiler">  <b class="spoiler_title">Wenn das Arduino-Board nicht zur Hand ist, m√ºssen Sie zuerst den Arduino-Bootloader auf den ATmega328P-Controller schreiben, damit alles funktioniert.</b> <div class="spoiler_text">  F√ºgen Sie dazu zun√§chst der Arduino-Umgebung eine Controller-Beschreibung hinzu.  Gehen Sie dazu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf die offizielle Arduino-Website</a> und laden Sie das f√ºr Ihre Umgebungsversion geeignete Beschreibungsarchiv herunter ( <a href="">f√ºr 1.6</a> , <a href="">f√ºr 1.5</a> , <a href="">f√ºr 1.0</a> ). <br><br>  Der Inhalt des Archivs sollte in den Hardwareordner des Arduino-Umgebungsordners extrahiert werden.  In Zukunft beschreibe ich am Beispiel der 1.0.3-Umgebung, die ich noch verwende, was passiert. <br><br>  Wenn die Beschreibungen kopiert werden, sollten Sie Arduino starten und die Programmiererskizze in Arduino laden, das als dieser Programmierer selbst verwendet wird.  Die Skizze befindet sich im Men√º Datei - Beispiele - ArduinoISP. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/037/517/98f/03751798f648adb8fea47a284a912667.jpg" alt="Bild"><br><br>  Nat√ºrlich sollten Sie Ihr Board und Ihren Port ausw√§hlen.  Ich w√§hle Mega, weil ich es habe: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7e7/483/4bd/7e74834bdd786979f926f4b65e2e344f.jpg" alt="Bild"><br><br>  Nach dem Laden der Programmierskizze m√ºssen Sie zur Zielplatine wechseln.  Das hei√üt,  in unserem Fall - ATmega328 mit einer Frequenz von 8 MHz und einem internen Master-Oszillator.  Es wird in die Liste der Boards aufgenommen, wenn die oben genannten Beschreibungen korrekt kopiert wurden: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b89/e98/7b2/b89e987b2243a79cc1d36e95d5a7ebab.jpg" alt="Bild"><br><br>  Jetzt m√ºssen Sie die MISO-, MOSI- und SCK-Leitungen der Programmierkarte und der Karte mit dem zuk√ºnftigen Arduino verbinden und auch RESET, GND und VCC verbinden.  Plus Power ist am besten an letzter Stelle. <br><br>  Basierend auf der obigen Infografik und Beschreibung von Arduino Mega ergibt sich folgendes Bild: <br><br>  SPI - Arduino Mega - ATmega328p <br><br>  MISO - 50 - 16 <br>  MOSI - 51 - 15 <br>  SCK - 52 - 17 <br>  SS (RESET) - 53 - 29 <br><br>  Physische Verbindung nach Ihrem Geschmack, ich habe eine ausschlie√ülich barbarische Methode angewendet - gew√∂hnliche Steckbrettdr√§hte direkt in die Plattenl√∂cher, ohne L√∂ten und Isolieren: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/c14/df6/d5f/c14df6d5f4cdda937de81eb2fa555ee0.jpg" alt="Bild"><br><br>  Wenn alles fertig ist, schreiben Sie den Bootloader auf.  Stellen Sie zun√§chst sicher, dass der richtige Programmierer ausgew√§hlt ist (Service - Programmierer - Arduino als ISP): <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e0c/dc4/a0c/e0cdc4a0c8914fbed3f5328c676f0210.jpg" alt="Bild"><br><br>  Dann machen wir den Service - Record Bootloader: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/568/21e/12f/56821e12f02cd705995d40429b15eec6.jpg" alt="Bild"><br></div></div><br>  Danach ist die Ausgabe eine minimalistische Arduino-Karte, um Skizzen zu laden, in die Sie den USB-Serial-Adapter oder eine vollst√§ndige Arduino-Karte mit einem solchen Adapter an Bord verwenden k√∂nnen.  Im ersten Fall m√ºssen Sie RX und TX √ºber Kreuz verbinden und vergessen Sie nicht, eine gemeinsame Masse anzuschlie√üen.  Im zweiten Fall ist es zus√§tzlich erforderlich, das als Adapter verwendete RESET Arduino gegen Masse kurzzuschlie√üen. <br><br>  Wenn Sie wie ich keine Schaltung haben, um den Controller vor dem Herunterladen der Skizze automatisch zur√ºckzusetzen, gibt es zwei M√∂glichkeiten: entweder ziehen Sie den Reset oder schalten Sie ihn einfach ein, wenn die Arduino-Umgebung angibt, dass der Download gestartet wurde. <br><br><h3>  Geh√§use </h3><br>  Der Fall ist, wie gesagt, modular.  Dies bedeutet, dass Sie an dem vor den Augen verborgenen Innenteil den abgestandenen und nicht mehr geeigneten Kunststoff einlassen k√∂nnen.  Sie k√∂nnen Elektronik darauf setzen: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/030/0a3/251/0300a325144382295c6e3b8d54971e23.jpg" alt="Bild"><br><br>  Ich mache darauf aufmerksam, dass der Fall spezifisch ist und in meine Version der F√ºllung passt. <br><br>  Ich schlage vor, den Rotor transparent zu machen, damit das Licht der Anzeigen gestreut wird.  F√ºr ein h√∂heres Gewicht kann eine M16-Mutter in den Rotor eingesetzt werden: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/9a0/8ef/68e/9a08ef68e2a079da4af3ed1eb148e961.jpg" alt="Bild"><br><br>  Ich brauche noch ein Rotorhemd und einen Bezug dazu.  Der Deckel wird einfach nach innen eingef√ºhrt und ruht auf Reibung.  Und nat√ºrlich k√∂nnen Sie nicht auf den oberen und unteren Teil des Au√üengeh√§uses verzichten. <br><br>  Ich habe einen Rotor mit einer F√ºllung von 10% gedruckt, die restlichen Elemente mit einer F√ºllung von 5%.  Kunststoff - PLA.  Die eingestellte Temperatur der D√ºse meines Druckers betr√§gt in den ersten drei Schichten 200 ¬∞ C, in den n√§chsten 185 ¬∞ C.  Leider kann ich nicht sagen, wie hoch die wahre Temperatur der D√ºse ist.  Der Tisch ist kalt. <br><br>  Die Montage ist einfach. <br><br><img src="https://habrastorage.org/webt/ka/cq/2-/kacq2-crn1cictkqxhpb0sok15u.jpeg"><br><br>  Die Platinen befinden sich in den Rillen des robusten Geh√§uses, die LEDs - Beine in den Rillen des unteren Teils des haltbaren Geh√§uses.  Die Antenne des Senders wird heruntergefahren, der drahtlose Ladeempf√§nger wird auf die gleiche Weise heruntergefahren - so dass er n√§her an derselben Ladung liegt. <br><br><img src="https://habrastorage.org/webt/d9/zu/ex/d9zuextrjywuvjbj4ve68-c2rgg.png"><br><br>  Die F√ºllung wird durch eine Zwischenplatte fixiert, in deren Nut der Geberkabelbaum verl√§uft. <br><br>  Der Encoder wird mit der oberen Platte befestigt, alle zusammen werden mit M4x30-Schrauben angezogen, die selbst die Gewinde in Kunststoff schneiden. <br><br>  Jetzt kann das haltbare Geh√§use in H√§lften des Au√üengeh√§uses eingeschlossen werden.  Ein Rotor wird auf die Encoderwelle und ein Hemd auf den Rotor gelegt.  Optional wird eine rutschfeste Matte auf die Unterseite des K√∂rpers geklebt.  Eine weitere Option ist ein dekorativer Einsatz, der die Naht zwischen den K√∂rperh√§lften verbirgt. <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text">  Im Code m√ºssen Sie Befehle zum Ein- und Ausschalten Ihrer Peripherieger√§te angeben.  Optional - √Ñndern Sie das Zeitlimit f√ºr das automatische Herunterfahren. <br><br>  Dies alles befindet sich im variablen Bereich. <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  : http://donalmorrissey.blogspot.ru/2010/04/sleeping-arduino-part-5-wake-up-via.html //  Livolo: http://forum.arduino.cc/index.php?action=dlattach;topic=153525.0;attach=108106 #include &lt;avr/sleep.h&gt; #include &lt;avr/power.h&gt; #include &lt;livolo.h&gt; #define adc_disable() (ADCSRA &amp;= ~(1&lt;&lt;ADEN)) // disable ADC (before power-off) #define adc_enable() (ADCSRA |= (1&lt;&lt;ADEN)) // re-enable ADC #define txPin 7 //   Livolo livolo(txPin); #define PULSESHORT 450 #define PULSELONG 1350 #define PULSESYNC 13950 #define encA 5 #define encB 6 //   #define buttonPin 2 //   () #define roomLed 10 //    #define kitchenLed 9 //    #define switchLed 3 //     #define switchLedTimeOut 150 //      #define switchTreshold 4 //      #define offDelay 15000 //   #define rLev 3 //     #define kLev 3 //     #define glev 2 //     #define txPowerPin 8 //    #define kitchenBackLightOn1 12 #define kitchenBackLightOn2 34 #define kitchenMainLightOn 56 #define roomBackLightOn 12 #define roomMainLightOn1 34 #define roomMainLightOn2 56 #define mainLightOn 12 #define kitchenBackLightOff1 12 #define kitchenBackLightOff2 34 #define kitchenMainLightOff 56 #define roomBackLightOff 12 #define roomMainLighOtff1 34 #define roomMainLightOff2 56 #define mainLightOff 12 #define LivoloID 8500 volatile byte rotorMode = 0; //   byte currentMode = 0; //    int curEncA, prevEncA, curButton, prevButton; //   ,  byte encCountPlus = 0; //   byte encCountMinus = 0; //   unsigned long offTimeOut = 0; //    unsigned long modeTimeOut = 0; //        unsigned long switchLedTime = 0; //      unsigned long modeTime = 0; //   unsigned int modeTreshold = 500; //     (  ) unsigned int bounceTreshold = 200; //     byte rLevState = 0; byte kLevState = 0; byte gLevState = 0; //   k - , r - , h - , b -  boolean kBackState = false; boolean kBackState1 = false; boolean kMainState = false; boolean rBackState = false; boolean rMainState = false; boolean rMainState1 = false; boolean hMainState = false; boolean bMainState = false; boolean afterSleep = false; //      boolean modeTimeOutStart = false; boolean switchLedOn = false; boolean allOn = false; //  " "    boolean allOff = false; //  " "    static void ookPulse(int on, int off) { digitalWrite(txPin, HIGH); delayMicroseconds(on); digitalWrite(txPin, LOW); delayMicroseconds(off); } static void rcSend(long remoteCode) { for (byte reSend = 0; reSend &lt; 8; reSend++) { for(byte repeat=0; repeat&lt;4; repeat++){ for (byte i = 24; i&gt;0; i--) { // transmit remoteID byte txPulse=bitRead(remoteCode, i-1); // read bits from remote ID // Serial.print(txPulse); switch (txPulse) { case 0: // 00 ookPulse(PULSESHORT,PULSELONG); //ookPulse(PULSESHORT,PULSELONG); break; case 1: // 11 ookPulse(PULSELONG,PULSESHORT); //ookPulse(PULSELONG,PULSESHORT); break; } // switch } // for loop ookPulse(PULSESHORT,PULSESYNC); // S(ync) // Serial.println(); } // repeat } delay(150); } void switchLedToggle() { digitalWrite(switchLed, HIGH); switchLedTime = millis(); switchLedOn = true; } void lightsUp(boolean lightsUpMode) { //       ""     //   "" -   if (afterSleep == true) { if (lightsUpMode == false) { gLevState = 1; rLevState = 3; kLevState = 3; } else {gLevState = 0; rLevState = 0; kLevState = 0; } afterSleep = false; //   " " } //   if (rotorMode == 2) { if (lightsUpMode == false){ if (allOff == false) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { //   gLevState = 0; rLevState = 0; kLevState = 0; rcSend(kitchenBackLightOff1); rcSend(kitchenBackLightOff2); rcSend(roomBackLightOff); livolo.sendButton(LivoloID, mainLightOff); } allOff = true; allOn = false; } } if (lightsUpMode == true){ //  ,    if (allOn == false) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { gLevState = 1; rLevState = 3; kLevState = 3; rcSend(kitchenBackLightOn1); rcSend(kitchenBackLightOn2); rcSend(roomBackLightOn); livolo.sendButton(LivoloID, mainLightOff); //    Livolo livolo.sendButton(LivoloID, kitchenMainLightOn); //#1   livolo.sendButton(LivoloID, roomMainLightOn1); // #2 livolo.sendButton(LivoloID, roomMainLightOn2); // #3 livolo.sendButton(LivoloID, mainLightOn); // #6 } allOn = true; allOff = false; } } } //  if (rotorMode == 1) { if (lightsUpMode == false &amp;&amp; kLevState &gt; 0) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { if (kLevState == 3) { //   livolo.sendButton(LivoloID, kitchenMainLightOff); // #3 } if (kLevState == 2) { //   2 livolo.sendButton(LivoloID, kitchenBackLightOff2); // #6 } if (kLevState == 1) { //   1 rcSend(kitchenBackLightOff1); } } if (kLevState!=0) { kLevState--;} // Serial.println(kLevState); } if (lightsUpMode == true &amp;&amp; kLevState &lt; 3) { switchLedToggle(); kLevState++; if (digitalRead(buttonPin) == HIGH) { if (kLevState &gt; 3) {kLevState = 3;} // Serial.println(kLevState); if (kLevState == 1) { //   1 rcSend(kitchenBackLightOn1); } if (kLevState == 2) { //   2 livolo.sendButton(LivoloID, kitchenBackLightOn2); // #6 } if (kLevState == 3) { //   livolo.sendButton(LivoloID, kitchenMainLightOn); // #3 } } } } //  if (rotorMode == 0) { if (lightsUpMode == false &amp;&amp; rLevState &gt; 0) { switchLedToggle(); if (digitalRead(buttonPin) == HIGH) { if (rLevState == 3) { //  1 livolo.sendButton(LivoloID, roomMainLighOtff1); //#1 } if (rLevState == 2) { //   livolo.sendButton(LivoloID, roomMainLightOff2); // #2 } if (rLevState == 1) { //   rcSend(roomBackLightOff); } } if (rLevState != 0) { rLevState--; } } if (lightsUpMode == true &amp;&amp; rLevState &lt; 3) { switchLedToggle(); rLevState++; if (digitalRead(buttonPin) == HIGH) { if (rLevState == 1) { //   rcSend(roomBackLightOn); } if (rLevState == 2) { //   livolo.sendButton(LivoloID, roomMainLightOn1); //#1 } if (rLevState == 3) { //   1 livolo.sendButton(LivoloID, roomMainLightOn2); // #2 } } } } } void wakeUp() { detachInterrupt(0); } void setMode() { if (rotorMode &gt;= 2 ) { rotorMode = 0; } else { rotorMode++; } offTimeOut = millis(); } void ledBlink() { for (byte iLed = 0; iLed&lt;3; iLed++) { digitalWrite(kitchenLed, HIGH); digitalWrite(roomLed, HIGH); delay(100); digitalWrite(kitchenLed, LOW); digitalWrite(roomLed, LOW); delay(100); } } void setLed() { if (rotorMode == 0) { //  digitalWrite(roomLed, HIGH); digitalWrite(kitchenLed, LOW); } if (rotorMode == 1) { //  digitalWrite(roomLed, LOW); digitalWrite(kitchenLed, HIGH); } if (rotorMode == 2) { //    digitalWrite(roomLed, HIGH); digitalWrite(kitchenLed, HIGH); } } void enterSleep() { // ledBlink(); afterSleep = true; digitalWrite(txPin, LOW); digitalWrite(txPowerPin, LOW); digitalWrite(roomLed, LOW); digitalWrite(kitchenLed, LOW); digitalWrite(switchLed, LOW); pinMode(txPin, INPUT); pinMode(txPowerPin, INPUT); pinMode(roomLed, INPUT); pinMode(kitchenLed, INPUT); pinMode(switchLed, INPUT); attachInterrupt(0, wakeUp, LOW); adc_disable(); set_sleep_mode(SLEEP_MODE_PWR_DOWN); sleep_enable(); sleep_mode(); sleep_disable(); power_all_enable(); pinMode(txPin, OUTPUT); pinMode(txPowerPin, OUTPUT); pinMode(roomLed, OUTPUT); pinMode(kitchenLed, OUTPUT); pinMode(switchLed, OUTPUT); digitalWrite(txPin, LOW); digitalWrite(txPowerPin, HIGH); // ledBlink(); setLed(); offTimeOut = millis(); allOn = false; allOff = false; } void setup() { // Serial.begin(115200); pinMode(txPin, OUTPUT); pinMode(txPowerPin, OUTPUT); pinMode(roomLed, OUTPUT); pinMode(kitchenLed, OUTPUT); pinMode(switchLed, OUTPUT); digitalWrite(txPin, LOW); digitalWrite(txPowerPin, HIGH); digitalWrite(roomLed, LOW); digitalWrite(kitchenLed, LOW); digitalWrite(switchLed, LOW); // pinMode(buttonPin, INPUT_PULLUP); pinMode(buttonPin, INPUT); pinMode(encA, INPUT); pinMode(encB, INPUT); prevEncA = digitalRead(encA); offTimeOut = millis(); rotorMode = 0; setLed(); prevButton = digitalRead(buttonPin); } void loop() { if ((millis() - offTimeOut) &gt; offDelay) { enterSleep(); } else { //     if (switchLedOn == true) { if ((millis() - switchLedTime) &gt; switchLedTimeOut) { digitalWrite(switchLed, LOW); switchLedOn = false; } } //       if (digitalRead(buttonPin) == LOW) { offTimeOut = millis(); } //   curButton = digitalRead(buttonPin); if ((prevButton == HIGH) &amp;&amp; (curButton == LOW)) { if (modeTimeOutStart == false) { modeTimeOut = millis(); modeTimeOutStart = true; } } else { if (modeTimeOutStart == true) { modeTime = millis() - modeTimeOut; if ((modeTime &lt; modeTreshold) &amp;&amp; (modeTime &gt; bounceTreshold)) { setMode(); modeTimeOutStart = false; prevButton = digitalRead(buttonPin); } else { modeTimeOutStart = false; prevButton = digitalRead(buttonPin); } } } //    if (currentMode != rotorMode) { //       ,     currentMode = rotorMode; //     setLed(); } //   curEncA = digitalRead(encA); if ((prevEncA == LOW) &amp;&amp; (curEncA == HIGH)) { offTimeOut = millis(); if (digitalRead(encB) == LOW) { encCountMinus++; encCountPlus = 0; // Serial.println("Encoder Minus"); if (encCountMinus &gt; switchTreshold) { encCountMinus = 0; lightsUp(false); } } else { encCountPlus++; encCountMinus = 0; // Serial.println("Encoder Plus"); if (encCountPlus &gt; switchTreshold) { encCountPlus = 0; lightsUp(true); } } } prevEncA = curEncA; } }</span></span></code> </pre> <br></div></div><br>  Fallmodell als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Referenz</a> . <br><br>  Das ist alles. <br><br>  PS: Ich habe versucht, nichts zu vergessen, aber ich konnte.  Wenn ja, entschuldige ich mich und werde mein Bestes tun, um Leitfragen richtig zu beantworten und Fehler zu korrigieren. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de411093/">https://habr.com/ru/post/de411093/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de411083/index.html">Sonnenuntergang "Sterne der Menschheit"</a></li>
<li><a href="../de411085/index.html">Pi-Sonos v3.0: Arbeiten an Fehlern oder ein v√∂llig neues Projekt?</a></li>
<li><a href="../de411087/index.html">Die nahe Zukunft der Grafikkarten</a></li>
<li><a href="../de411089/index.html">So identifizieren Sie einen Satelliten im Orbit</a></li>
<li><a href="../de411091/index.html">Data Center Technologies: Allgemeine Informationen zu QFX-Switches</a></li>
<li><a href="../de411095/index.html">Dem Kepler-Teleskop geht der Kraftstoff aus. Das Finale ist nahe</a></li>
<li><a href="../de411097/index.html">Standalone Mobile Messenger</a></li>
<li><a href="../de411099/index.html">Die PPFD kann leicht bewertet werden, wenn eine Anlage mit wei√üen LEDs beleuchtet wird: 1000 Lux = 15 Œºmol / s / m2</a></li>
<li><a href="../de411101/index.html">Die New Yorker Beh√∂rden erlaubten es, die Stromkosten f√ºr Bergleute zu erh√∂hen</a></li>
<li><a href="../de411105/index.html">Die Leistung der Kurierdrohnen h√§ngt davon ab, wo Sie wohnen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>