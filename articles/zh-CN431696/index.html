<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš— ğŸ‘¨â€âœˆï¸ ğŸ‘¶ğŸ½ ç§‘ä¸ åŸºç¡€çŸ¥è¯† ğŸ‘¨ğŸ½â€ğŸ’¼ ğŸ˜¦ ğŸ‘¨ğŸ½â€ğŸ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¯¹äºç¬¬ä¸€æ¬¡Kodeinäººæ¥è¯´Kodeinæˆ‘æ‰¾ä¸åˆ°å¯ç†è§£çš„æŒ‡å—ï¼Œå¹¶ä¸”è¯¥æ–‡æ¡£åœ¨æ‰€æœ‰åœ°æ–¹éƒ½ä¸æ˜¯é€æ˜ä¸”ä¸€è‡´çš„ï¼Œå› æ­¤ï¼Œæˆ‘æƒ³ä¸æ‚¨åˆ†äº«è¯¥åº“çš„ä¸»è¦åŠŸèƒ½ã€‚ ä¸€äº›åº“åŠŸèƒ½å°†å‘å¸ƒï¼Œä½†è¿™åŸºæœ¬ä¸Šæ˜¯é«˜çº§éƒ¨åˆ†ã€‚ åœ¨é˜…è¯»æœ¬æ–‡æ—¶ï¼Œæ‚¨ä¼šå‘ç°ä¸€åˆ‡æ­£å¸¸å¼€å§‹ï¼Œå¹¶å¼€å§‹ä½¿ç”¨Kodeinå®ç°ä¾èµ–å…³ç³»ã€‚ æœ¬æ–‡åŸºäºKodein 5.3.0 ï¼Œå› ä¸ºKod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç§‘ä¸ åŸºç¡€çŸ¥è¯†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431696/">å¯¹äºç¬¬ä¸€æ¬¡<code>Kodein</code>äººæ¥è¯´<code>Kodein</code>æˆ‘æ‰¾ä¸åˆ°å¯ç†è§£çš„æŒ‡å—ï¼Œå¹¶ä¸”è¯¥æ–‡æ¡£åœ¨æ‰€æœ‰åœ°æ–¹éƒ½ä¸æ˜¯é€æ˜ä¸”ä¸€è‡´çš„ï¼Œå› æ­¤ï¼Œæˆ‘æƒ³ä¸æ‚¨åˆ†äº«è¯¥åº“çš„ä¸»è¦åŠŸèƒ½ã€‚ ä¸€äº›åº“åŠŸèƒ½å°†å‘å¸ƒï¼Œä½†è¿™åŸºæœ¬ä¸Šæ˜¯é«˜çº§éƒ¨åˆ†ã€‚ åœ¨é˜…è¯»æœ¬æ–‡æ—¶ï¼Œæ‚¨ä¼šå‘ç°ä¸€åˆ‡æ­£å¸¸å¼€å§‹ï¼Œå¹¶å¼€å§‹ä½¿ç”¨<code>Kodein</code>å®ç°ä¾èµ–å…³ç³»ã€‚ æœ¬æ–‡åŸºäº<code>Kodein 5.3.0</code> ï¼Œå› ä¸º<code>Kodein 6.0.0</code>éœ€è¦<code>Support Library 28</code>æˆ–<code>AndroidX</code>å¹¶ä¸”ç”±äºè®¸å¤šç¬¬ä¸‰æ–¹åº“å°šæœªæä¾›å…¼å®¹ç‰ˆæœ¬ï¼Œå› æ­¤ç»å¯¹ä¸ä¼šåˆ‡æ¢åˆ°å®ƒä»¬ã€‚ <br><img src="https://habrastorage.org/webt/uj/ve/am/ujveamkhrxko4wle8mcfugfzjvc.png"><br><a name="habracut"></a><br>  <code>Kodein</code>æ˜¯ç”¨äºå®ç°ä¾èµ–é¡¹æ³¨å…¥ï¼ˆDIï¼‰çš„åº“ã€‚ å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰æ­¤æ¦‚å¿µï¼Œè¯·é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ‰å…³Dagger2</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡ç« </a>çš„å¼€å¤´ï¼Œä½œè€…åœ¨å…¶ä¸­ç®€è¦ä»‹ç»DIçš„ç†è®ºæ–¹é¢ã€‚ <br><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»¥Androidä¸ºä¾‹æ¥è€ƒè™‘æ‰€æœ‰å†…å®¹ï¼Œä½†æ®å¼€å‘äººå‘˜ç§°ï¼ŒKodeinåœ¨Kotlinæ”¯æŒçš„æ‰€æœ‰å¹³å°ï¼ˆJVMï¼ŒAndroidï¼ŒJSï¼ŒNativeï¼‰ä¸Šçš„è¡Œä¸ºå‡ç›¸åŒã€‚ <br><br><h3> å®‰è£…æ–¹å¼ </h3><br> ç”±äºJavaå…·æœ‰<code>type erasure</code>çš„äº‹å®ï¼Œå› æ­¤å‡ºç°äº†ä¸€ä¸ªé—®é¢˜-ç¼–è¯‘å™¨æ“¦é™¤äº†é€šç”¨ç±»å‹ã€‚ åœ¨å­—èŠ‚ç çº§åˆ«ï¼Œ <code>List&lt;String&gt;</code>å’Œ<code>List&lt;Date&gt;</code>åªæ˜¯<code>List</code> ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶æœ‰ä¸€ç§è·å–æœ‰å…³æ³›å‹ç±»å‹çš„ä¿¡æ¯çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒå°†èŠ±è´¹å¾ˆå¤šï¼Œå¹¶ä¸”ä»…åœ¨JVMå’ŒAndroidä¸Šæœ‰æ•ˆã€‚ åœ¨è¿™æ–¹é¢ï¼Œ <code>Kodein</code>å¼€å‘äººå‘˜å»ºè®®ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§ä¾èµ–å…³ç³»ä¹‹ä¸€ï¼šä¸€ç§åœ¨å·¥ä½œæ—¶æ¥æ”¶æœ‰å…³å¹¿ä¹‰ç±»å‹çš„ä¿¡æ¯ï¼ˆ <code>kodein-generic</code> ï¼‰ï¼Œè€Œå¦ä¸€ç§åˆ™ä¸ä½¿ç”¨ï¼ˆ <code>kodein-erased</code> ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨<code>kodein-erased</code> <code>List&lt;String&gt;</code>å’Œ<code>List&lt;Date</code> &gt;å°†è¢«ä¿å­˜ä¸º<code>List&lt;*&gt;</code> ï¼Œå¹¶ä¸”ä½¿ç”¨<code>kodein-generic</code>æ‰€æœ‰å†…å®¹å°†ä¸æŒ‡å®šçš„ç±»å‹ä¸€èµ·ä¿å­˜ï¼Œå³<code>List&lt;String&gt;</code>å’Œ<code>List&lt;Date&gt;</code> ã€‚ <br><br> å¦‚ä½•é€‰æ‹©ï¼Ÿ <br><br>  <b>ä¸è¦</b>åœ¨JVMä¸‹å†™-ä½¿ç”¨<code>kodein-erased</code> ï¼Œå¦åˆ™æ˜¯ä¸å¯èƒ½çš„ã€‚ <br> åœ¨JVMä¸‹è¿›è¡Œå†™æ“ä½œï¼Œæ€§èƒ½é—®é¢˜å¯¹æ‚¨æ¥è¯´éå¸¸é‡è¦-æ‚¨å¯ä»¥ä½¿ç”¨<code>kodein-erased</code> ï¼Œä½†æ˜¯è¦å°å¿ƒï¼Œè¿™ç§ä½“éªŒåœ¨è¿™äº›è¯çš„æ„ä¹‰ä¸Šå¯èƒ½æ˜¯æ„æ–™ä¹‹å¤–çš„ã€‚ å¦‚æœæ‚¨åˆ›å»ºçš„å¸¸è§„åº”ç”¨ç¨‹åºæ²¡æœ‰ä»»ä½•ç‰¹æ®Šçš„æ€§èƒ½è¦æ±‚ï¼Œè¯·ä½¿ç”¨<code>kodein-generic</code> ã€‚ <br><br> æœ€ç»ˆï¼Œå¦‚æœè€ƒè™‘åˆ°DIå¯¹æ€§èƒ½çš„å½±å“ï¼Œé‚£ä¹ˆå¤§å¤šæ•°ä¾èµ–å…³ç³»é€šå¸¸åªåˆ›å»ºä¸€æ¬¡ï¼Œæˆ–è€…åˆ›å»ºä¾èµ–å…³ç³»ä»¥ä¾›é‡å¤ä½¿ç”¨ï¼Œå› æ­¤é€šè¿‡æ­¤ç±»æ“ä½œï¼Œæ‚¨ä¸å¤ªå¯èƒ½å¯¹åº”ç”¨ç¨‹åºçš„æ€§èƒ½äº§ç”Ÿé‡å¤§å½±å“ã€‚ <br><br> å› æ­¤ï¼Œå®‰è£…ï¼š <br><br> é¦–å…ˆ-åœ¨å­˜å‚¨åº“ä¹‹é—´çš„build.gradleä¸­åº”è¯¥æ˜¯jcenterï¼ˆï¼‰ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰-æ·»åŠ ã€‚ <br><br><pre> <code class="plaintext hljs">buildscript { repositories { jcenter() } }</code> </pre><br> æ¥ä¸‹æ¥ï¼Œåœ¨ä¾èµ–å…³ç³»å—ä¸­ï¼Œæ·»åŠ ä¸Šè¿°åŸºæœ¬ä¾èµ–å…³ç³»ä¹‹ä¸€ï¼š <br><br><pre> <code class="plaintext hljs">implementation "org.kodein.di:kodein-di-generic-jvm:$version"</code> </pre><br><pre> <code class="plaintext hljs">implementation "org.kodein.di:kodein-di-erased-jvm:$version"</code> </pre><br> ç”±äºæˆ‘ä»¬åœ¨è°ˆè®ºAndroidï¼Œå› æ­¤å°†ä¼šæœ‰æ›´å¤šçš„ä¾èµ–é¡¹ã€‚ æ‚¨å½“ç„¶å¯ä»¥ä¸ç”¨å®ƒï¼ŒKodeinå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæ‹’ç»å…¶ä»–å¯¹Androidæœ‰ç”¨çš„åŠŸèƒ½ï¼ˆæˆ‘å°†åœ¨æœ¬æ–‡ç»“å°¾å¤„è®¨è®ºå®ƒä»¬ï¼‰ï¼Ÿ é€‰æ‹©æ˜¯æ‚¨çš„ï¼Œä½†æˆ‘å»ºè®®è¡¥å……ã€‚ <br><br> è¿™é‡Œä¹Ÿæœ‰é€‰é¡¹ã€‚ <br><br> é¦–å…ˆï¼Œæ‚¨æ²¡æœ‰ä½¿ç”¨<code>SupportLibrary</code> <br><br><pre> <code class="plaintext hljs">implementation "org.kodein.di:kodein-di-framework-android-core:$version"</code> </pre><br> ç¬¬äºŒæ¬¡ä½¿ç”¨ <br><br><pre> <code class="plaintext hljs">implementation "org.kodein.di:kodein-di-framework-android-support:$version"</code> </pre><br> ç¬¬ä¸‰-æ‚¨æ­£åœ¨ä½¿ç”¨AndroidX <br><br><pre> <code class="plaintext hljs">implementation "org.kodein.di:kodein-di-framework-android-x:$version"</code> </pre><br><h3> æˆ‘ä»¬å¼€å§‹åˆ›å»ºä¾èµ–å…³ç³» </h3><br> ä½¿ç”¨<code>Dagger2</code> ï¼Œæˆ‘ä¹ æƒ¯äºåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åœ¨Applicationç±»ä¸­åˆ›å»ºå’Œåˆå§‹åŒ–ä¾èµ–é¡¹ã€‚ <br><br> ä½¿ç”¨Kodeinï¼Œå¯ä»¥è¿™æ ·å®Œæˆï¼š <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApp</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { <span class="hljs-comment"><span class="hljs-comment">/*  */</span></span> } }</code> </pre><br> ä¾èµ–é¡¹å£°æ˜å§‹ç»ˆä»¥ <br><br><pre> <code class="kotlin hljs">bind&lt;TYPE&gt;() with</code> </pre><br><h4> æ ‡ç­¾ </h4><br>  Kodeinä¾èµ–é¡¹æ ‡è®°çš„åŠŸèƒ½ä¸<code>Dagger2</code> <code>Qualifier</code> <code>Dagger2</code> ã€‚ åœ¨<code>Dagger2</code>æ‚¨éœ€è¦æ‰§è¡Œå•ç‹¬çš„<code>Qualifier</code>æˆ–ä½¿ç”¨<code>@Named("someTag")</code> ï¼Œå®ƒå®é™…ä¸Šä¹Ÿæ˜¯<code>Qualifier</code> ã€‚ åº•çº¿å¾ˆç®€å•-é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‚¨å¯ä»¥åŒºåˆ†ç›¸åŒç±»å‹çš„ä¸¤ä¸ªä¾èµ–é¡¹ã€‚ ä¾‹å¦‚ï¼Œæ‚¨éœ€è¦æ ¹æ®æƒ…å†µè·å–åº”ç”¨ç¨‹åºæˆ–ç‰¹å®š<code>Activity</code>çš„<code>ontext</code> ï¼Œå› æ­¤åœ¨å£°æ˜ä¾èµ–é¡¹æ—¶éœ€è¦ä¸ºæ­¤æŒ‡å®šæ ‡ç­¾ã€‚  <code>Kodein</code>å…è®¸<code>Kodein</code>å£°æ˜ä¸€ä¸ªæ²¡æœ‰æ ‡ç­¾çš„ä¾èµ–é¡¹ï¼Œå®ƒæ˜¯åŸºç¡€çš„ï¼Œå¦‚æœæ‚¨åœ¨æ¥æ”¶åˆ°ä¾èµ–é¡¹æ—¶æœªæŒ‡å®šæ ‡ç­¾ï¼Œæˆ‘ä»¬å°†å¾—åˆ°å®ƒï¼Œå¦å¤–ä¸€ä¸ªéœ€è¦åŠ æ ‡ç­¾ï¼Œå¹¶ä¸”åœ¨æ”¶åˆ°ä¾èµ–é¡¹æ—¶ï¼Œéœ€è¦æŒ‡å®šæ ‡ç­¾ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;Context&gt;() with ... bind&lt;Context&gt;(tag = <span class="hljs-string"><span class="hljs-string">"main_activity"</span></span>) with ... bind&lt;Context&gt;(tag = <span class="hljs-string"><span class="hljs-string">"sale_activity"</span></span>) with ... }</code> </pre><br>  <code>tag</code>å‚æ•°çš„ç±»å‹ä¸º<code>Any</code> ï¼Œå› æ­¤æ‚¨ä¸ä»…å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ã€‚ ä½†æ˜¯è¯·è®°ä½ï¼Œç”¨ä½œæ ‡è®°çš„ç±»å¿…é¡»å®ç°<code>equals</code>å’Œ<code>hashCode</code>æ–¹æ³•ã€‚ å§‹ç»ˆæœ‰å¿…è¦å°†æ ‡è®°ä½œä¸ºå‘½åå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œè€Œä¸ç®¡æ˜¯åˆ›å»ºä¾èµ–é¡¹è¿˜æ˜¯æ¥æ”¶ä¾èµ–é¡¹ã€‚ <br><br><h3> ä¾èµ–æ³¨å…¥çš„ç±»å‹ </h3><br> æœ‰å‡ ç§åœ¨<code>Kodein</code>æä¾›ä¾èµ–å…³ç³»çš„<code>Kodein</code> ï¼Œ <code>Kodein</code> -åˆ›å»º<code>Kodein</code> ã€‚ å•ä¾‹å°†ä½äºåˆ›å»ºçš„<code>Kodein</code>å®ä¾‹çš„æ¡†æ¶å†…ã€‚ <br><br><h4> å•èº«äººå£«ä»‹ç» </h4><br> è®©æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ï¼š <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IMyDatabase&gt;() with singleton { RoomDb() } }</code> </pre><br> å› æ­¤ï¼Œæˆ‘ä»¬æä¾›ï¼ˆæä¾›ï¼‰ <code>IMyDatabase</code> ï¼Œåœ¨<code>RoomDb</code>å°†éšè—<code>RoomDb</code>å®ä¾‹ã€‚  <code>RoomDb</code>å®ä¾‹å°†åœ¨ä¾èµ–é¡¹çš„ç¬¬ä¸€ä¸ªè¯·æ±‚æ—¶åˆ›å»ºï¼›åœ¨<code>Kodein</code>æ–°çš„<code>Kodein</code>å®ä¾‹ä¹‹å‰ï¼Œä¸ä¼š<code>Kodein</code> ã€‚ åˆ›å»ºä¸€ä¸ªå•ä¾‹æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿å®ƒä¸åŒæ­¥ã€‚ è¿™å°†æé«˜ç”Ÿäº§ç‡ï¼Œä½†æ˜¯æ‚¨å¿…é¡»äº†è§£éšä¹‹è€Œæ¥çš„é£é™©ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IMyDatabase&gt;() with singleton(sync = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { RoomDb() } }</code> </pre><br> å¦‚æœæ‚¨ä¸éœ€è¦åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è€Œæ˜¯åœ¨åˆ›å»º<code>Kodein</code>å®ä¾‹åç«‹å³åˆ›å»º<code>Kodein</code>å®ä¾‹ï¼Œè¯·ä½¿ç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼š <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IMyDatabase&gt;() with eagerSingleton { RoomDb() } }</code> </pre><br><h4> ä¸æ–­åˆ›å»ºä¾èµ–çš„æ–°å®ä¾‹ </h4><br> åœ¨è®¿é—®ä¾èµ–å…³ç³»ä»¥è·å–æ–°å®ä¾‹æ—¶ï¼Œå¯ä»¥ä¸åˆ›å»ºå•è°ƒè€Œæ˜¯è¿ç»­åˆ›å»ºã€‚ ä¸ºæ­¤ï¼Œä½¿ç”¨äº†<code>provider</code>åŠŸèƒ½ï¼š <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IMainPresenter&gt;() with provider { QuantityPresenter() } }</code> </pre><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æˆ‘ä»¬è¯·æ±‚<code>IMainPresenter</code>ä¾èµ–é¡¹æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„<code>QuantityPresenter</code>å®ä¾‹ã€‚ <br><br><h4> ä¸æ–­åˆ›å»ºä¾èµ–å…³ç³»çš„æ–°å®ä¾‹ï¼Œå¹¶å°†å‚æ•°ä¼ é€’ç»™ä¾èµ–å…³ç³»çš„æ„é€ å‡½æ•° </h4><br> å°±åƒä¸Šä¸€ä¸ªç¤ºä¾‹ä¸€æ ·ï¼Œæ¯æ¬¡æ·»åŠ ä¾èµ–é¡¹æ—¶éƒ½å¯ä»¥è·å–å®ƒçš„æ–°å®ä¾‹ï¼Œä½†æ˜¯è¦æŒ‡å®šç”¨äºåˆ›å»ºä¾èµ–é¡¹çš„å‚æ•°ã€‚ å‚æ•°æœ€å¤§ä¸º<b>5</b> ã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨<code>factory</code>æ–¹æ³•ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IColorPicker&gt;() with factory { r: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, g: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, b: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, a: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; RgbColorPicker(r, g, b, a) } }</code> </pre><br><h4> æ¯æ¬¡æˆ‘ä»¬æ ¹æ®å‚æ•°åˆ›å»ºä¸€ä¸ªç¼“å­˜å®ä¾‹ </h4><br> é˜…è¯»ä¸Šä¸€æ®µï¼Œæ‚¨å¯èƒ½ä¼šè®¤ä¸ºï¼Œæ¯æ¬¡æ ¹æ®ä¼ é€’çš„å‚æ•°æ¥æ”¶ä¸€ä¸ªæ–°å®ä¾‹ï¼Œè€Œä¸æ˜¯æ¥æ”¶ä¸€ä¸ªæ–°å®ä¾‹ï¼Œè€Œæ˜¯æ¥æ”¶å¯¹ç›¸åŒå‚æ•°çš„ä¾èµ–é¡¹çš„ç›¸åŒå®ä¾‹ï¼Œå°†æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IRandomIntGenerator&gt;() with multiton { from: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, to: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; IntRandom(from, to) } }</code> </pre><br> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå½“æˆ‘ä»¬é¦–å…ˆè·å¾—å…·æœ‰å‚æ•°<code>5</code>å’Œ<code>10</code>çš„ä¾èµ–é¡¹æ—¶<code>10</code>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<code>IntRandom(5, 10)</code>çš„æ–°å®ä¾‹ï¼Œå½“æˆ‘ä»¬å†æ¬¡ä½¿ç”¨ç›¸åŒçš„å‚æ•°è°ƒç”¨è¯¥ä¾èµ–é¡¹æ—¶ï¼Œå°†è·å¾—å…ˆå‰åˆ›å»ºçš„å®ä¾‹ã€‚ å› æ­¤ï¼Œè·å¾—äº†å…·æœ‰å»¶è¿Ÿåˆå§‹åŒ–çš„å•ä¾‹<code>map</code> ã€‚ ä¸<code>factory</code>å‚æ•°æœ€å¤šä¸º<b>5</b> ã€‚ <br><br> ä¸å•è°ƒä¸€æ ·ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤å¤„ç¦ç”¨åŒæ­¥ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IRandomIntGenerator&gt;() with multiton(sync = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { from: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, to: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; IntRandom(from, to) } }</code> </pre><br><h4> åœ¨Kodeinä¸­ä½¿ç”¨è½¯é“¾æ¥å’Œå¼±é“¾æ¥ </h4><br> ä½¿ç”¨<code>singleton</code>æˆ–å¤š<code>singleton</code>æä¾›ä¾èµ–é¡¹æ—¶<code>multiton</code>å¯ä»¥æŒ‡å®šå¯¹å­˜å‚¨å®ä¾‹çš„å¼•ç”¨ç±»å‹ã€‚ åœ¨ä¸Šé¢æˆ‘ä»¬è€ƒè™‘çš„é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™å°†æ˜¯é€šå¸¸çš„<code>strong</code>é“¾æ¥ã€‚ ä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>soft</code>é“¾æ¥å’Œ<code>weak</code>é“¾æ¥ã€‚ å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰è¿™äº›æ¦‚å¿µï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯·åœ¨æ­¤å¤„æŸ¥çœ‹</a> ã€‚ <br><br> å› æ­¤ï¼Œæ‚¨çš„å•è°ƒå¯èƒ½ä¼šåœ¨åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­é‡æ–°åˆ›å»ºï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IMyMap&gt;() with singleton(ref = softReference) { WorldMap() } bind&lt;IClient&gt;() with singleton(ref = weakReference) { id -&gt; clientFromDB(id) } }</code> </pre><br><h4> æ¯ä¸ªæµå•ç‹¬çš„å•ä¾‹ </h4><br> è¿™æ˜¯ç›¸åŒçš„å•ä¾‹ï¼Œä½†æ˜¯å¯¹äºæ¯ä¸ªè¯·æ±‚ä¾èµ–é¡¹çš„çº¿ç¨‹ï¼Œå°†åˆ›å»ºä¸€ä¸ªå•ä¾‹ã€‚ ä¸ºæ­¤ï¼Œè¯·ä½¿ç”¨ç†Ÿæ‚‰çš„å‚æ•°<code>ref</code> ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;Cache&gt;() with singleton(ref = threadLocal) { LRUCache(<span class="hljs-number"><span class="hljs-number">16</span></span> * <span class="hljs-number"><span class="hljs-number">1024</span></span>) } }</code> </pre><br><h4> å¸¸é‡ä½œä¸ºå¯åµŒå…¥çš„ä¾èµ–é¡¹ </h4><br> æ‚¨å¯ä»¥æä¾›å¸¸é‡ä½œä¸ºä¾èµ–é¡¹ã€‚ è¯¥æ–‡æ¡£æè¯·æ‚¨æ³¨æ„ä»¥ä¸‹äº‹å®ï¼šä½¿ç”¨<code>Kodein</code>æ‚¨å¿…é¡»<code>Kodein</code>ä¸å¸¦ç»§æ‰¿æˆ–æ¥å£çš„ç®€å•ç±»å‹çš„å¸¸é‡ï¼Œä¾‹å¦‚åŸºå…ƒæˆ–æ•°æ®ç±»ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { constant(tag = <span class="hljs-string"><span class="hljs-string">"maxThread"</span></span>) with <span class="hljs-number"><span class="hljs-number">8</span></span> constant(tag = <span class="hljs-string"><span class="hljs-string">"serverURL"</span></span>) with <span class="hljs-string"><span class="hljs-string">"https://my.server.url"</span></span></code> </pre><br><h4> åˆ›å»ºä¾èµ–é¡¹è€Œä¸æ›´æ”¹ç±»å‹ </h4><br> ä¾‹å¦‚ï¼Œæ‚¨å¸Œæœ›å°†ä¾èµ–é¡¹ä½œä¸ºå•ä¾‹æä¾›ï¼Œä½†ä¸è¦å°†å…¶éšè—åœ¨æ¥å£åé¢ã€‚ æ‚¨æ ¹æœ¬æ— æ³•åœ¨è°ƒç”¨<code>bind</code>æ—¶æŒ‡å®šç±»å‹<code>from</code>è€Œæ˜¯ä½¿ç”¨<code>from</code>è€Œä¸æ˜¯<code>with</code> ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind() from singleton { Gson() }</code> </pre><br> ä¸Šé¢ç¤ºä¾‹ä¸­çš„ä¾èµ–é¡¹å°†å…·æœ‰å‡½æ•°çš„è¿”å›ç±»å‹ï¼Œå³å°†<code>Gson</code>ç±»å‹çš„ä¾èµ–é¡¹ã€‚ <br><br><h4> åˆ›å»ºè¶…ç±»æˆ–æ¥å£çš„å­ç±»ä¾èµ–é¡¹ </h4><br>  <code>Kodein</code>å…è®¸<code>Kodein</code>ä»¥ä¸åŒæ–¹å¼ä¸ºå®ç°å•ä¸ªæ¥å£çš„ä¸€ä¸ªæˆ–å¤šä¸ªç‰¹å®šç±»çš„åä»£æä¾›ä¾èµ–é¡¹ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;Animal&gt;().subTypes() with { animalType -&gt; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (animalType.jvmType) { Dog::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eagerSingleton</span></span></span><span class="hljs-class"> </span></span>{ Dog() } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; provider { WildAnimal(animalType) } } }</code> </pre><br>  <code>Animal</code>ç±»å¯ä»¥æ˜¯è¶…ç±»ä¹Ÿå¯ä»¥æ˜¯æ¥å£ï¼Œä½¿ç”¨<code>.subtypes</code>æˆ‘ä»¬å¯ä»¥è·å¾—<code>TypeToken&lt;*&gt;</code>ç±»å‹çš„<code>TypeToken&lt;*&gt;</code> ï¼Œä»ä¸­æˆ‘ä»¬å·²ç»å¯ä»¥è·å–Javaç±»ï¼Œå¹¶æ ¹æ®å®ƒä»¥ä¸åŒçš„æ–¹å¼æä¾›ä¾èµ–æ€§ã€‚ å¦‚æœæ‚¨åœ¨è®¸å¤šæƒ…å†µä¸‹éƒ½ä½¿ç”¨<code>TypeToken</code>æˆ–å…¶æ´¾ç”Ÿç±»ä½œä¸ºæ„é€ å‡½æ•°å‚æ•°ï¼Œåˆ™æ­¤åŠŸèƒ½å¾ˆæœ‰ç”¨ã€‚ åŒæ ·ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‚¨å¯ä»¥é¿å…ä¸ºç›¸åŒç±»å‹åˆ›å»ºç›¸åŒçš„ä¾èµ–é¡¹è€Œå¯¼è‡´ä¸å¿…è¦çš„ä»£ç ã€‚ <br><br><h4> åˆ›å»ºéœ€è¦å…¶ä»–ä¾èµ–é¡¹ä½œä¸ºå‚æ•°çš„ä¾èµ–é¡¹ </h4><br> é€šå¸¸ï¼Œæˆ‘ä»¬ä¸ä»…åˆ›å»ºæ²¡æœ‰å‚æ•°ä½œä¸ºä¾èµ–çš„ç±»ï¼Œè€Œä¸”åˆ›å»ºéœ€è¦å°†å‚æ•°ä¼ é€’ç»™æ„é€ å‡½æ•°çš„ç±»ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductGateway</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> api: IProductApi, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dispatchers: IDispatchersContainer) : IProductGateway</code> </pre><br> ä¸ºäº†åˆ›å»ºä¸€ä¸ªå…·æœ‰ä»¥å‰åœ¨<code>Kodein</code>åˆ›å»ºçš„ä¾èµ–å…³ç³»çš„ç±»ï¼Œåªéœ€å°†instanceï¼ˆï¼‰å‡½æ•°è°ƒç”¨ä½œä¸ºå‚æ•°ä¼ é€’<code>Kodein</code>è¶³å¤Ÿäº†ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ›å»ºçš„é¡ºåºå¹¶ä¸é‡è¦ã€‚ <br><br><pre> <code class="kotlin hljs">bind&lt;IDispatchersContainer&gt;() with singleton { DispatchersContainer() } bind&lt;IProductGateway&gt;() with singleton { ProductGateway(instance(), instance()) } bind&lt;IProductApi&gt;() with singleton { ProductApi() }</code> </pre><br> é™¤äº†<code>instance()</code>å¯èƒ½è¿˜æœ‰å¯¹<code>provider()</code>æˆ–<code>factory()</code>è°ƒç”¨ï¼›æˆ‘ä»¬å°†åœ¨è·å–å’Œå®ç°ä¾èµ–é¡¹çš„éƒ¨åˆ†ä¸­ä»”ç»†ç ”ç©¶è¿™äº›æ–¹æ³•ã€‚ <br><br><h4> é€šè¿‡è°ƒç”¨å…ˆå‰åˆ›å»ºçš„ä¾èµ–æ–¹æ³•æ¥åˆ›å»ºä¾èµ– </h4><br> å¬èµ·æ¥ä¸å¤ªå¥½ï¼Œä½†æ˜¯æ‚¨å¯ä»¥è°ƒç”¨<code>instance&lt;TYPE&gt;</code>æ¥è·å–æˆ‘ä»¬å·²ç»åœ¨æŸä¸ªåœ°æ–¹æä¾›çš„ç±»ï¼Œç„¶åè°ƒç”¨è¯¥ç±»çš„æ–¹æ³•ä»¥è·å–æ–°çš„ä¾èµ–é¡¹ã€‚ <br><br><pre> <code class="kotlin hljs">bind&lt;DataSource&gt;() with singleton { MySQLDataSource() } bind&lt;Connection&gt;() with provider { instance&lt;DataSource&gt;().openConnection() }</code> </pre><br><h3> æ¨¡ç»„ </h3><br> ä½¿ç”¨<code>Dagger2</code> ï¼Œæˆ‘ä¹ æƒ¯äº<code>Dagger2</code>ä¾èµ–æ€§ã€‚ ä¹ä¸€çœ‹ï¼Œåœ¨<code>Kodein</code> ï¼Œä¸€åˆ‡çœ‹èµ·æ¥éƒ½ä¸å¤ªå¥½ã€‚ æ‚¨éœ€è¦åœ¨<code>Application</code>ç±»ä¸­åˆ›å»ºå¾ˆå¤šä¾èµ–å…³ç³»ï¼Œè€Œæˆ‘ä¸ªäººå¹¶ä¸å–œæ¬¢å®ƒã€‚ ä½†æ˜¯æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œ <code>Kodein</code>è¿˜å…è®¸æ‚¨åˆ›å»ºæ¨¡å—ï¼Œç„¶ååœ¨éœ€è¦çš„åœ°æ–¹å°†å®ƒä»¬è¿æ¥èµ·æ¥ã€‚ <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;() with singleton { provideGson() } bind&lt;HttpClient&gt;() with singleton { provideHttpClient() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule) bind&lt;ISchedulersContainer&gt;() with singleton { SchedulersContainer() } <span class="hljs-comment"><span class="hljs-comment">//   }</span></span></code> </pre><br> ä½†æ˜¯è¯·æ³¨æ„ï¼Œæ¨¡å—åªæ˜¯å£°æ˜ç”¨äºè·å–ä¾èµ–å…³ç³»çš„æ–¹æ³•çš„å®¹å™¨ï¼›å®ƒä»¬æœ¬èº«ä¸ä¼šåˆ›å»ºç±»ã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨åœ¨æ¨¡å—ä¸­å°†æ¥æ”¶çš„æ¥æ”¶å£°æ˜ä¸ºå•ä¾‹ï¼Œç„¶åå°†æ­¤æ¨¡å—å¯¼å…¥åˆ°<code>Kodein</code>ä¸¤ä¸ªä¸åŒå®ä¾‹ä¸­ï¼Œé‚£ä¹ˆæ‚¨å°†è·å¾—ä¸¤ä¸ªä¸åŒçš„å•ä¾‹ï¼Œæ¯ä¸ª<code>Kodein</code>å®ä¾‹ä¸€ä¸ªã€‚ <br><br> å¦å¤–ï¼Œæ¯ä¸ªæ¨¡å—çš„åç§°å¿…é¡»å”¯ä¸€ã€‚ ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦ä»å¦ä¸€ä¸ªé¡¹ç›®å¯¼å…¥æ¨¡å—ï¼Œåˆ™å¾ˆéš¾ä¿è¯åç§°çš„å”¯ä¸€æ€§ï¼›ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥é‡å‘½åæ¨¡å—æˆ–åœ¨å…¶åç§°ä¸Šæ·»åŠ å‰ç¼€ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(apiModule.copy(name = <span class="hljs-string"><span class="hljs-string">"firstAPI"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(secondApiModule.copy(prefix = <span class="hljs-string"><span class="hljs-string">"secondAPI-"</span></span>))</code> </pre><br> å½“æ¨¡å—ç›¸äº’ä¾èµ–å¹¶æ„æˆæŸç§å±‚æ¬¡ç»“æ„æ—¶ï¼Œæˆ‘ä¹ æƒ¯äºå·¥ä½œã€‚  <code>Kodein</code>å¯ä»¥ä¸€æ¬¡å°†æ¯ä¸ªæ¨¡å—å¯¼å…¥<code>Kodein</code> ï¼Œå› æ­¤ï¼Œå¦‚æœå°è¯•å°†å…·æœ‰ç›¸åŒç›¸å…³æ¨¡å—çš„ä¸¤ä¸ªæ¨¡å—å¯¼å…¥ä¸€ä¸ª<code>Kodein</code> ï¼Œåˆ™åº”ç”¨ç¨‹åºå°†å´©æºƒã€‚ è§£å†³æ–¹æ¡ˆå¾ˆç®€å•-æ‚¨éœ€è¦ä½¿ç”¨<code>importOnce(someModule)</code>è°ƒç”¨è¿›è¡Œå¯¼å…¥ï¼Œè¿™å°†æ£€æŸ¥å…ˆå‰æ˜¯å¦å¯¼å…¥äº†å…·æœ‰ç›¸åŒåç§°çš„æ¨¡å—ï¼Œç„¶ååœ¨å¿…è¦æ—¶è¿›è¡Œå¯¼å…¥ã€‚ <br><br> ä¾‹å¦‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºå°†å´©æºƒï¼š <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;() with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> secondModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"second"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> thirdModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"third"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(secondModule) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(thirdModule) }</code> </pre><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;() with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> secondModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"second"</span></span>) { importOnce(appModule) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> thirdModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"third"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(secondModule) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(thirdModule) }</code> </pre><br> ä½†æ˜¯ï¼Œå¦‚æœ<code>importOnce</code>è°ƒç”¨æ­£åœ¨ç¬¬äºŒæ¬¡å°è¯•è¿æ¥ï¼Œé‚£ä¹ˆä¸€åˆ‡éƒ½ä¼šæ­£å¸¸ã€‚ å°å¿ƒç‚¹ <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;() with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> secondModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"second"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> thirdModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"third"</span></span>) { importOnce(appModule) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(secondModule) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(thirdModule) }</code> </pre><br><h4> ä¼ æ‰¿ </h4><br> å¦‚æœä¸¤æ¬¡ä½¿ç”¨åŒä¸€æ¨¡å—ï¼Œå°†åˆ›å»ºä¸åŒçš„ä¾èµ–å…³ç³»ï¼Œä½†æ˜¯ç»§æ‰¿å’Œå®ç°ç±»ä¼¼äº<code>Dagger2</code> <code>Subcomponents</code>çš„<code>Dagger2</code>å‘¢ï¼Ÿ ä¸€åˆ‡éƒ½å¾ˆç®€å•ï¼Œæ‚¨åªéœ€è¦ä»<code>Kodein</code>å®ä¾‹ç»§æ‰¿ï¼Œå°±å¯ä»¥è®¿é—®ç»§æ‰¿äººä¸­çˆ¶ä»£çš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;ISchedulersContainer&gt;() with singleton { SchedulersContainer() } <span class="hljs-comment"><span class="hljs-comment">//   } val subKodein = Kodein { extend(kodein) //   }</span></span></code> </pre><br><h4> é‡æ–°å®šä¹‰ </h4><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨æ— æ³•è¦†ç›–ä¾èµ–å…³ç³»ï¼Œå¦åˆ™ç”¨æˆ·ä¼šç–¯ç‹‚å¯»æ‰¾åº”ç”¨ç¨‹åºæ— æ³•æ­£å¸¸å·¥ä½œçš„åŸå› ã€‚ ä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>bind</code>å‡½æ•°çš„é™„åŠ å‚æ•°æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚ æ­¤åŠŸèƒ½å¯¹äºç»„ç»‡æµ‹è¯•éå¸¸æœ‰ç”¨ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;Api&gt;() with singleton { ApiImpl() } <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> bind&lt;Api&gt;(overrides = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) with singleton { OtherApiImpl() } }</code> </pre><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—åŠå…¶ä¾å­˜å…³ç³»ä¸èƒ½è¦†ç›–<code>Kodein</code>å¯¹è±¡ä¸­å·²å£°æ˜çš„ä¾å­˜å…³ç³»ï¼Œä½†æ˜¯åœ¨å¯¼å…¥æ¨¡å—æ—¶ï¼Œæ‚¨å¯ä»¥æŒ‡ç¤ºç°æœ‰çš„ä¾å­˜å…³ç³»å¯ä»¥è¦†ç›–å…¶ä¾å­˜å…³ç³»ï¼Œå¹¶ä¸”åœ¨è¯¥æ¨¡å—å†…éƒ¨ï¼Œæ‚¨å¯ä»¥æŒ‡å®šå…¶ä»–äººå¯ä»¥è¦†ç›–çš„ä¾å­˜å…³ç³»ã€‚ <br><br> å¬èµ·æ¥ä¸å¤ªæ¸…æ¥šï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ç¤ºä¾‹ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œåº”ç”¨ç¨‹åºå°†å´©æºƒï¼š <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;() with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Gson&gt;() with singleton { provideGson() } <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule) }</code> </pre><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;() with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Gson&gt;() with singleton { provideGson() } <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule, allowOverride = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) }</code> </pre><br> å¹¶ä¸”åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæ¨¡å—ä¾èµ–é¡¹å°†è¦†ç›–<code>Kodein</code>å¯¹è±¡ä¸­å£°æ˜çš„ä¾èµ–<code>Kodein</code> ã€‚ <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> appModule = Kodein.Module(<span class="hljs-string"><span class="hljs-string">"app"</span></span>) { bind&lt;Gson&gt;(overrides = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Gson&gt;() with singleton { provideGson() } <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(appModule, allowOverride = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) }</code> </pre><br> ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ç¡®å®æƒ³è¦å¹¶ä¸”äº†è§£è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œé‚£ä¹ˆå¯ä»¥åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œå¦‚æœè¯¥æ¨¡å—ä¸<code>Kodein</code>å¯¹è±¡å…·æœ‰ç›¸åŒçš„ä¾èµ–å…³ç³»<code>Kodein</code>åˆ™å°†é‡æ–°å®šä¹‰å®ƒä»¬ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºä¸ä¼šå´©æºƒã€‚ æˆ‘ä»¬ä¸ºæ¨¡å—ä½¿ç”¨<code>allowSilentOverride</code>å‚æ•°ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> testModule = Kodein.Module(name = <span class="hljs-string"><span class="hljs-string">"test"</span></span>, allowSilentOverride = <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { bind&lt;EmailClient&gt;() with singleton { MockEmailClient() } }</code> </pre><br> è¯¥æ–‡æ¡£è®¨è®ºäº†æœ‰å…³ç»§æ‰¿å’Œé‡æ–°å®šä¹‰ä¾èµ–å…³ç³»ä»¥åŠåœ¨ç»§æ‰¿äººä¸­å¤åˆ¶ä¾èµ–å…³ç³»çš„æ›´ä¸ºå¤æ‚çš„æƒ…å†µï¼Œä½†æ­¤å¤„å°†ä¸è€ƒè™‘è¿™äº›æƒ…å†µã€‚ <br><br><h3> æ£€ç´¢å’Œæ³¨å…¥ä¾èµ–é¡¹ </h3><br> æœ€åï¼Œæˆ‘ä»¬å¼„æ¸…æ¥šäº†å¦‚ä½•ä»¥å¤šç§æ–¹å¼å£°æ˜ä¾èµ–å…³ç³»ï¼Œæ˜¯æ—¶å€™å¼„æ¸…æ¥šå¦‚ä½•åœ¨å…¶ç±»ä¸­è·å–ä¾èµ–å…³ç³»äº†ã€‚ <br><br>  <code>Kodein</code>å¼€å‘äººå‘˜å…±äº«è·å–ä¾èµ–é¡¹çš„ä¸¤ç§æ–¹å¼- <code>injection</code>å’Œ<code>retieval</code> ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œ <code>injection</code>æ˜¯æŒ‡ç±»åœ¨åˆ›å»ºæ—¶å³åœ¨æ„é€ å‡½æ•°ä¸­æ¥æ”¶æ‰€æœ‰ä¾èµ–é¡¹çš„æƒ…å†µï¼Œè€Œ<code>retrieval</code>æ˜¯æŒ‡ç±»æœ¬èº«è´Ÿè´£è·å–å…¶ä¾èµ–é¡¹çš„æƒ…å†µã€‚ <br><br> ä½¿ç”¨<code>injection</code>æ‚¨çš„ç±»å¯¹<code>Kodein</code>å¹¶ä¸”è¯¥ç±»ä¸­çš„ä»£ç æ›´åŠ <code>Kodein</code> ï¼Œä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä½¿ç”¨<code>Kodein</code> ï¼Œé‚£ä¹ˆæ‚¨å°†æœ‰æœºä¼šæ›´çµæ´»åœ°ç®¡ç†ä¾èµ–é¡¹ã€‚ åœ¨<code>retrieval</code>çš„æƒ…å†µä¸‹ï¼Œä»…åœ¨ç¬¬ä¸€æ¬¡ä¾èµ–æ—¶æ‰å»¶è¿Ÿ<code>retrieval</code>æ‰€æœ‰ä¾èµ–ã€‚ <br><br><h4> ä¾èµ–å…³ç³»çš„<code>Kodein</code>æ–¹æ³• </h4><br>  <code>Kodein</code>ç±»çš„å®ä¾‹å…·æœ‰ä¸‰ç§è¿”å›ä¾èµ–é¡¹ï¼Œä¾èµ–é¡¹å·¥å‚æˆ–ä¾èµ–é¡¹æä¾›ç¨‹åºçš„æ–¹æ³•-åˆ†åˆ«æ˜¯<code>instance()</code> ï¼Œ <code>factory()</code>å’Œ<code>provider()</code> ã€‚ å› æ­¤ï¼Œå¦‚æœä½¿ç”¨<code>factory</code>æˆ–<code>provider</code>æä¾›ä¾èµ–é¡¹ï¼Œåˆ™ä¸ä»…å¯ä»¥æ¥æ”¶å‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œè¿˜å¯ä»¥æ¥æ”¶å‡½æ•°æœ¬èº«ã€‚ è¯·è®°ä½ï¼Œæ‚¨å¯ä»¥åœ¨æ‰€æœ‰å˜ä½“ä¸­ä½¿ç”¨æ ‡ç­¾ã€‚ <br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;BigDecimal&gt;() with factory { value: String -&gt; BigDecimal(value) } bind&lt;Random&gt;() with provider { Random() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> number: BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> instance(arg = <span class="hljs-string"><span class="hljs-string">"23.87"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numberFactory: (value: String) -&gt; BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> factory() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> random: Random <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> instance() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> randomProvider: () -&gt; Random <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> provider()</code> </pre><br><h4> é€šè¿‡æ„é€ å‡½æ•°è¿›è¡Œä¾èµ–æ³¨å…¥ </h4><br> å¦‚æ‚¨æ‰€çŸ¥ï¼Œè¿™å°†ä¸<code>injection</code>æœ‰å…³ã€‚ è¦å®ç°ï¼Œå¿…é¡»é¦–å…ˆå°†ç±»çš„æ‰€æœ‰ä¾èµ–é¡¹æ”¾å…¥å…¶æ„é€ å‡½æ•°ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨<code>kodein.newInstance</code>åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductApi</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> client: HttpClient, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> gson: Gson) : IProductApi <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Gson&gt;() with singleton { provideGson() } bind&lt;HttpClient&gt;() with singleton { provideHttpClient() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> productApi: IProductApi <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.newInstance { ProductApi(instance(), instance()) } }</code> </pre><br><h4> å¯ç©ºå±æ€§ä¸­çš„ä¾èµ–æ³¨å…¥ </h4><br> å¾ˆå¯èƒ½æ‚¨ä¸çŸ¥é“æ˜¯å¦å·²å£°æ˜ä¾èµ–é¡¹ã€‚ å¦‚æœæœªåœ¨<code>Kodein</code>å®ä¾‹ä¸­å£°æ˜ä¾èµ–<code>Kodein</code> ï¼Œåˆ™ä¸Šä¾‹ä¸­çš„ä»£ç å°†å¯¼è‡´<code>Kodein.NotFoundException</code> ã€‚ å¦‚æœè¦è·å¾—<code>null</code> ï¼ˆå¦‚æœæ²¡æœ‰ä¾èµ–å…³ç³»ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªè¾…åŠ©å‡½æ•°ï¼š <code>instanceOrNull()</code> ï¼Œ <code>factoryOrNull()</code>å’Œ<code>providerOrNull()</code> ã€‚ <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductApi</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> client: HttpClient?, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> gson: Gson) : IProductApi <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Gson&gt;() with singleton { provideGson() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> productApi: IProductApi <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.newInstance { ProductApi(instanceOrNull(), instance()) } }</code> </pre><br><h4> è·å–ç±»å†…éƒ¨çš„ä¾èµ–å…³ç³»ã€‚ </h4><br> å¦‚å‰æ‰€è¿°ï¼Œåœ¨ä½¿ç”¨<code>retrieval</code>çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰ä¾èµ–é¡¹çš„åˆå§‹åŒ–éƒ½æ˜¯å»¶è¿Ÿçš„ã€‚ è¿™ä½¿æ‚¨å¯ä»¥ä»…åœ¨éœ€è¦æ—¶è·å–ä¾èµ–å…³ç³»ï¼Œå¹¶åœ¨ç³»ç»Ÿåˆ›å»ºçš„ç±»ä¸­è·å–ä¾èµ–å…³ç³»ã€‚ <br><br>  <code>Activity</code> ï¼Œ <code>Fragment</code>å’Œå…¶ä»–å…·æœ‰å„è‡ªç”Ÿå‘½å‘¨æœŸçš„ç±»ï¼Œå…¨éƒ½ä¸å®ƒä»¬æœ‰å…³ã€‚ <br><br> è¦åœ¨<code>Activity</code>å®ç°ä¾èµ–å…³ç³»<code>Activity</code>æˆ‘ä»¬åªéœ€è¦é“¾æ¥åˆ°Kodeinå®ä¾‹ï¼Œæ­¤åä¾¿å¯ä»¥ä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„æ–¹æ³•ã€‚ å®é™…ä¸Šï¼Œæ‚¨å·²ç»åœ¨ä¸Šé¢çœ‹åˆ°äº†<code>retrieval</code>ç¤ºä¾‹ï¼Œæ‚¨åªéœ€è¦å£°æ˜ä¸€ä¸ªå±æ€§å¹¶å°†å…¶å§”æ‰˜ç»™ä»¥ä¸‹åŠŸèƒ½ä¹‹ä¸€ï¼š <code>instance()</code> ï¼Œ <code>factory()</code>æˆ–<code>provider()</code> <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> number: BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.instance(arg = <span class="hljs-string"><span class="hljs-string">"23.87"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numberFactory: (value: String) -&gt; BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.factory() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> random: Random? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.instanceOrNull() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> randomProvider: (() -&gt; Random)? <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.providerOrNull()</code> </pre><br><h4> å°†å‚æ•°ä¼ é€’ç»™å·¥å‚ </h4><br> æ‚¨å·²ç»çœ‹åˆ°ï¼Œä¸ºäº†å°†å‚æ•°ä¼ é€’ç»™å·¥å‚ï¼Œä½¿ç”¨<code>instance</code>å‡½æ•°çš„<code>arg</code>å‚æ•°å°±è¶³å¤Ÿäº†ã€‚<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¦‚æœæœ‰å‡ ä¸ªå‚æ•°ï¼ˆæˆ‘ä¹‹å‰è¯´è¿‡ä¸€ä¸ªå·¥å‚æœ€å¤šå¯ä»¥æœ‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5ä¸ª</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‚æ•°</font><font style="vertical-align: inherit;">ï¼‰æ€ä¹ˆåŠï¼Ÿ</font><font style="vertical-align: inherit;">æ‚¨åªéœ€è¦å°†ä¸€ä¸ª</font></font><code>arg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»</font><font style="vertical-align: inherit;">ä¼ é€’ç»™</font></font><code>M</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…·æœ‰é‡è½½æ„é€ å‡½æ•°</font><font style="vertical-align: inherit;">çš„å‚æ•°</font><font style="vertical-align: inherit;">ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨2åˆ°5ä¸ªå‚æ•°ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein { bind&lt;IColorPicker&gt;() with factory { r: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, g: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, b: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, a: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; RgbColorPicker(r, g, b, a) } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> picker: IColorPicker <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.instance(arg = M(<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">211</span></span>, <span class="hljs-number"><span class="hljs-number">175</span></span>, <span class="hljs-number"><span class="hljs-number">215</span></span>))</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¼ºåˆ¶ä¾èµ–åˆå§‹åŒ– </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­£å¦‚ä»–ä»¬æ‰€è¯´-é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆå§‹åŒ–æ˜¯æƒ°æ€§çš„ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªè§¦å‘å™¨ï¼Œå°†å…¶ç»‘å®šåˆ°ä¸€ä¸ªå±æ€§ï¼Œå¤šä¸ªå±æ€§æˆ–æ•´ä¸ªå®ä¾‹ä¸Š</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç„¶åå†æ‹‰åŠ¨è¯¥è§¦å‘å™¨ï¼Œå¹¶å°†åˆå§‹åŒ–ä¾èµ–é¡¹ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> myTrigger = KodeinTrigger() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> gson: Gson <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.on(trigger = myTrigger).instance() <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> myTrigger.trigger() <span class="hljs-comment"><span class="hljs-comment">//     Gson</span></span></code> </pre><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> myTrigger = KodeinTrigger() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodeinWithTrigger = kodein.on(trigger = myTrigger) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> gson: Gson <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodeinWithTrigger.instance() <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> myTrigger.trigger() <span class="hljs-comment"><span class="hljs-comment">//        kodeinWithTrigger</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ‡’æƒ°çš„Kodeinå®ä¾‹åˆ›å»º </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨æ˜¾å¼åˆ›å»ºä¸€ä¸ªå®ä¾‹</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨</font></font><code>LazyKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ„é€ å‡½æ•°ä¸­é‡‡ç”¨åº”è¿”å›ä¸€ä¸ªå¯¹è±¡çš„å‡½æ•°</font><font style="vertical-align: inherit;">çš„ç±»æ¥å»¶è¿Ÿæ­¤å±æ€§çš„åˆå§‹åŒ–</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå¦‚æœå®Œå…¨ä¸çŸ¥é“æ˜¯å¦éœ€è¦æ¥è‡ªç»™å®šKodeinå®ä¾‹çš„ä¾èµ–é¡¹ï¼Œåˆ™æ­¤æ–¹æ³•å¾ˆæœ‰ç”¨ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = LazyKodein { Kodein { bind&lt;BigDecimal&gt;() with factory { value: String -&gt; BigDecimal(value) } bind&lt;Random&gt;() with provider { Random() } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> number: BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.instance(arg = <span class="hljs-string"><span class="hljs-string">"13.4"</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> number.toPlainString() <span class="hljs-comment"><span class="hljs-comment">//     kodein   </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è°ƒç”¨Kodein.lazyå°†å¯¼è‡´ç±»ä¼¼çš„ç»“æœã€‚ </font></font><br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein.lazy { bind&lt;BigDecimal&gt;() with factory { value: String -&gt; BigDecimal(value) } bind&lt;Random&gt;() with provider { Random() } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> number: BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.instance(arg = <span class="hljs-string"><span class="hljs-string">"13.4"</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> number.toPlainString() <span class="hljs-comment"><span class="hljs-comment">//     kodein   </span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kodeinå»¶è¿Ÿåˆå§‹åŒ– </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹äºå»¶è¿Ÿçš„åˆå§‹åŒ–ï¼Œ</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­˜åœ¨ä¸€ä¸ªå¯¹è±¡</font></font><code>LateInitKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åˆ›å»ºè¯¥å¯¹è±¡ï¼Œå°†å…¶åˆ›å»ºå§”æ‰˜ç»™å®ƒï¼Œç„¶ååœ¨åˆå§‹åŒ–å¯¹è±¡æœ¬èº«ä¹‹åï¼Œå°†è¯¥å±æ€§è®¾ç½®ä¸º</font></font><code>baseKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä¹‹åæ‚¨å°±å¯ä»¥è®¿é—®ä¾èµ–é¡¹äº†ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = LateInitKodein() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> gson: Gson <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.instance() <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> kodein.baseKodein = <span class="hljs-comment"><span class="hljs-comment">/*     Kodein */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*...*/</span></span> gson.fromJson(someStr)</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è·å–æŒ‡å®šç±»å‹çš„æ‰€æœ‰å®ä¾‹ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¯ä»¥å‘Kodeinç´¢è¦æŒ‡å®šç±»å‹çš„å®ä¾‹åŠå…¶å½¢å¼çš„æ‰€æœ‰åä»£</font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¸€åˆ‡éƒ½åªåœ¨æŒ‡å®šçš„æ ‡è®°å†…ã€‚</font><font style="vertical-align: inherit;">è¦åšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•æœ‰</font></font><code>allInstances</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>allProviders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>allFactories</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Number&gt;() with singleton { <span class="hljs-built_in"><span class="hljs-built_in">Short</span></span>.MAX_VALUE } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Double</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">12.46</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Double</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"someTag"</span></span>) with singleton { <span class="hljs-number"><span class="hljs-number">43.89</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">4562</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">136.88f</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numbers: List&lt;Number&gt; <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.allInstances()</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæ‚¨æ‰“å°åˆ°æ—¥å¿—ï¼Œæ‚¨å°†åœ¨æ­¤å¤„çœ‹åˆ°[32767ï¼Œ136.88ï¼Œ4562ï¼Œ12.46]ã€‚</font><font style="vertical-align: inherit;">å¸¦æœ‰æ ‡ç­¾çš„ä¾èµ–é¡¹ä¸åœ¨åˆ—è¡¨ä¸­ã€‚</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä½¿ç”¨KodeinAwareç•Œé¢ç®€åŒ–ä¾èµ–è·å– </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤æ¥å£ä½¿æ‚¨å¿…é¡»é‡å†™typeå±æ€§</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶ä¸”ä½œä¸ºè¿”å›ï¼Œå®ƒæä¾›å¯¹å®ä¾‹å¯ç”¨çš„æ‰€æœ‰åŠŸèƒ½çš„è®¿é—®</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApplication</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Number&gt;() with singleton { <span class="hljs-built_in"><span class="hljs-built_in">Short</span></span>.MAX_VALUE } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Double</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">12.46</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Double</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"someTag"</span></span>) with singleton { <span class="hljs-number"><span class="hljs-number">43.89</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">4562</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">136.88f</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numbers: List&lt;Number&gt; <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> allInstances() }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æ‚¨æ‰€è§ï¼Œç°åœ¨æ‚¨å¯ä»¥ç®€å•åœ°ç¼–å†™</font></font><code>by allInstances()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è€Œä¸æ˜¯</font></font><code>by kodein.allInstances()</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥å‰çš„å†…å®¹ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº†æ¥æ”¶ä¾èµ–é¡¹çš„è§¦å‘å™¨ã€‚</font><font style="vertical-align: inherit;">åœ¨ç•Œé¢ä¸­ï¼Œ</font></font><code>KodeinAware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥è¦†ç›–è§¦å‘å™¨ï¼Œå¹¶åœ¨è°ƒç”¨æ­¤è§¦å‘å™¨æ—¶è·å–æ‰€æœ‰å£°æ˜çš„ä¾èµ–é¡¹ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApplication</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;Number&gt;() with singleton { <span class="hljs-built_in"><span class="hljs-built_in">Short</span></span>.MAX_VALUE } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Double</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">12.46</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Double</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"someTag"</span></span>) with singleton { <span class="hljs-number"><span class="hljs-number">43.89</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">4562</span></span> } bind&lt;<span class="hljs-built_in"><span class="hljs-built_in">Float</span></span>&gt;() with singleton { <span class="hljs-number"><span class="hljs-number">136.88f</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodeinTrigger = KodeinTrigger() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numbers: List&lt;Number&gt; <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> allInstances() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate() kodeinTrigger.trigger() } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”±äºå¯¹ä¾èµ–é¡¹å’Œå®ä¾‹çš„è®¿é—®</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å»¶è¿Ÿçš„ï¼Œå› æ­¤æ‚¨å¯ä»¥å°†å®ä¾‹åˆå§‹åŒ–å§”æ‰˜ç»™</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kotlinä¸­</font><font style="vertical-align: inherit;">çš„</font><font style="vertical-align: inherit;">å†…ç½®å‡½æ•°</font></font><code>lazy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ ¹æ®ç±»çš„ä¸Šä¸‹æ–‡ï¼Œè¿™ç§æ–¹æ³•åœ¨ç±»ä¸­å¯èƒ½å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚åœ¨ä¸­</font></font><code>Activity</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CategoriesActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> lazy { (application <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> MyApplication).kodein } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> myFloat: <span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> instance()</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ºäºç›¸åŒçš„åŸå› ï¼Œå¯ä»¥ä½¿ç”¨ä¿®é¥°ç¬¦</font></font><code>lateinit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CategoriesActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> kodein: Kodein <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> myFloat: <span class="hljs-built_in"><span class="hljs-built_in">Float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> instance() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) kodein = (application <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> MyApplication).kodein }</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ— éœ€å§”æ´¾å±æ€§å³å¯è®¿é—®ä¾èµ–é¡¹ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœç”±äºæŸç§åŸå› æ‚¨ä¸æƒ³ä½¿ç”¨å±æ€§å§”æ‰˜ï¼Œåˆ™å¯ä»¥é€šè¿‡</font></font><code>DKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆç›´æ¥ï¼‰</font><font style="vertical-align: inherit;">ä½¿ç”¨ç›´æ¥è®¿é—®</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä¸»è¦åŒºåˆ«åœ¨äºä¸å†æœ‰å»¶è¿Ÿåˆå§‹åŒ–ï¼Œåœ¨è°ƒç”¨æ—¶å°†ç«‹å³è·å¾—ç›¸å…³æ€§</font></font><code>instance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><code>provider</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶ä¸”å…·æœ‰ç±»ä¼¼çš„åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">æ‚¨</font></font><code>DKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯ä»¥ä»ç°æœ‰çš„Kodeinå®ä¾‹ä¸­</font><font style="vertical-align: inherit;">è·å–</font><font style="vertical-align: inherit;">å®ƒï¼Œä¹Ÿå¯ä»¥ä»å¤´å¼€å§‹æ„å»ºã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApplication</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;BigDecimal&gt;() with singleton { BigDecimal.TEN } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> directKodein: DKodein = kodein.direct <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> directKodein2: DKodein = Kodein.direct { bind&lt;BigDecimal&gt;() with singleton { BigDecimal.ONE } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> someNumber:BigDecimal = directKodein.instance() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> someNumber2:BigDecimal = directKodein2.instance()</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kodeinå¯ä»¥åœ¨æ¡†æ¶ä¸­ä½¿ç”¨</font></font><code>KodeinAware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶ä¸”å¯ä»¥</font></font><code>DKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ¡†æ¶ä¸­</font></font><code>DKodeinAware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿›è¡Œå®éªŒã€‚</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨ä»»ä½•ä¸Šä¸‹æ–‡ä¸­è·å–ä¾èµ–é¡¹ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†ä»ä¸€ä¸ªå¯¹è±¡ä¸­è·å–</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤šä¸ªç›¸åŒç±»å‹çš„ä¾èµ–é¡¹</font><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">æˆ‘ä»¬å·²ç»ç ”ç©¶äº†ä½¿ç”¨å¸¦å‚æ•°çš„æ ‡ç­¾å’Œå·¥å‚çš„é€‰æ‹©ï¼Œä½†æ˜¯è¿˜æœ‰å¦å¤–ä¸€ä»¶äº‹-ä½¿ç”¨ä¸Šä¸‹æ–‡ï¼ˆè¿™ä¸æ˜¯Androidä¸­çš„ä¸Šä¸‹æ–‡ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å¸¦æœ‰æ ‡ç­¾çš„ä¾èµ–é¡¹çš„åŒºåˆ«ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ ‡ç­¾ä¸èƒ½åœ¨æˆ‘ä»¬åˆ›å»ºä¾èµ–å…³ç³»çš„å‡½æ•°ä¸­ä½¿ç”¨ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä½¿ç”¨ä¸Šä¸‹æ–‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¾èµ–é¡¹åˆ›å»ºå‡½æ•°ä¸­è®¿é—®ä¸Šä¸‹æ–‡å®ä¾‹ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¸¦æœ‰å‚æ•°çš„å·¥å‚æ¥ä»£æ›¿ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœä¸ç¡®å®šä½¿ç”¨ä»€ä¹ˆ</font><font style="vertical-align: inherit;">ï¼Œå¼€å‘äººå‘˜</font><font style="vertical-align: inherit;">å»ºè®®æ‚¨è¿™æ ·åšã€‚ä½†æ˜¯ï¼Œä¾‹å¦‚å½“æ‚¨ä¸èƒ½å°†ä¸¤ä¸ªå‚æ•°å¼ºåˆ¶è½¬æ¢ä¸ºç›¸åŒç±»å‹æ—¶ï¼Œä¸Šä¸‹æ–‡å¯èƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œæ‚¨æ‹¥æœ‰</font></font><code>Activity</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>Presenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶ä¸”æ‚¨å¸Œæœ›ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæ ¹æ®æ¥æ”¶å®ƒä»¬çš„ç±»ï¼Œä»¥ä¸åŒçš„æ–¹å¼æä¾›å‡ ç§ä¸åŒç±»å‹çš„ä¾èµ–é¡¹ã€‚ä¸ºäº†é¢†å¯¼</font></font><code>Activity</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>Presenter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ç§ç±»å‹-ä½ éœ€è¦ä¸€ä¸ªå¯é€‰çš„æ¥å£ï¼Œå·¥å‚å°†ä¸å¾—ä¸æ£€æŸ¥æ‰€ç”Ÿæˆçš„å‚æ•°çš„ç±»å‹ã€‚è¯¥æ–¹æ¡ˆä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨ä¸Šä¸‹æ–‡ï¼š</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApplication</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein = Kodein { bind&lt;BigDecimal&gt;() with contexted&lt;CategoriesActivity&gt;().provider { context.getActivityBigDecimal() } bind&lt;BigDecimal&gt;() with contexted&lt;CategoriesPresenter&gt;().factory { initialValue:BigDecimal -&gt; context.getPresenterBigDecimal(initialValue) } } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CategoriesActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>(), AppKodeinAware { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getActivityBigDecimal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = BigDecimal(<span class="hljs-string"><span class="hljs-string">"16.34"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> activityBigDecimal: BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.on(context = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).instance() } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CategoriesPresenter</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppKodeinAware { fun getPresenterBigDecimal</span></span></span></span>(initialValue: BigDecimal) = initialValue * BigDecimal.TEN <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> presenterBigDecimal: BigDecimal <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.on(context = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).instance(arg = BigDecimal(<span class="hljs-string"><span class="hljs-string">"31.74"</span></span>)) }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“ç„¶ï¼Œæœ‰ä¸ªä¾‹å­ä¼šè®©äººè€³ç›®ä¸€æ–°ï¼Œå®é™…ä¸Šï¼Œæ‚¨ä¸å¤ªå¯èƒ½ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Œä½†æ˜¯è¿™ä¸ªä¾‹å­è¯´æ˜äº†ä¸Šä¸‹æ–‡æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦å£°æ˜ä¾èµ–å…³ç³»ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸æ˜¯</font></font><code>with provider()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè€Œæ˜¯</font><font style="vertical-align: inherit;">æŒ‡å®š</font></font><code>with contexted&lt;OurContextClass&gt;().provider</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå…¶ä¸­</font></font><code>OurContextClass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»çš„ç±»å‹ä¸ºï¼Œç±»çš„å®ä¾‹å°†ä½œä¸ºä¸Šä¸‹æ–‡ã€‚</font></font><code>contexted</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åªèƒ½æ˜¯æä¾›å•†æˆ–å·¥å‚ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡åä¸ºçš„å˜é‡è®¿é—®è¿”å›ä¾èµ–å…³ç³»çš„å‡½æ•°ä¸­çš„æ­¤ä¸Šä¸‹æ–‡</font></font><code>context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦è·å¾—ä¸ä¸Šä¸‹æ–‡çš„ä¾èµ–å…³ç³»ï¼Œæ‚¨é¦–å…ˆéœ€è¦</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡å‡½æ•°</font><font style="vertical-align: inherit;">æŒ‡å®šå¯¹è±¡çš„ä¸Šä¸‹æ–‡</font></font><code>on()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç„¶åè¯·æ±‚ä¾èµ–å…³ç³»ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»ä¼¼åœ°ï¼Œåœ¨ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡</font></font><code>injection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> productApi: IProductApi <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.on(context = someContext).newInstance { ProductApi(instance(), instance()) } }</code> </pre><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Androidæ‰©å±• </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ¬æ–‡å¼€å¤´ï¼Œæˆ‘ç­”åº”è€ƒè™‘çš„æ‰©å±•é€‰é¡¹</font></font><code>Android</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚ä¸Šæ‰€è¿°ï¼Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢æ‚¨ä½¿ç”¨</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒçš„ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä½¿ä¸€åˆ‡å˜å¾—æ›´æ–¹ä¾¿ã€‚</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å†…ç½®Androidçš„Kodein </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ä¸œè¥¿æ˜¯ä¸ºAndroidå‡†å¤‡çš„æ¨¡å—ã€‚</font><font style="vertical-align: inherit;">è¦è¿æ¥å®ƒï¼Œè¯¥ç±»æœ‰å¿…è¦</font><font style="vertical-align: inherit;">å»¶è¿Ÿ</font></font><code>Application</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ç°</font></font><code>KodeinAware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œåˆå§‹åŒ–å±æ€§</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆä»¥è®¿é—®å®ä¾‹</font></font><code>Application</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font><font style="vertical-align: inherit;">ä½œä¸ºå›æŠ¥ï¼Œæ‚¨å¯ä»¥ä»ç±»ä¸­è·å¾—å¤§é‡å·²å£°æ˜çš„ä¾èµ–å…³ç³»</font></font><code>Application</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ŒåŒ…æ‹¬æ‰€éœ€çš„ä¸€åˆ‡</font></font><code>Context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">å¦‚ä½•è¿æ¥-çœ‹ä¸€ä¸ªä¾‹å­ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyApplication</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Application</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein = Kodein.lazy { <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(androidModule(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span><span class="hljs-symbol"><span class="hljs-symbol">@MyApplication</span></span>)) <span class="hljs-comment"><span class="hljs-comment">//  } val inflater: LayoutInflater by instance() }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„-ä½ å¯ä»¥å¾—åˆ°çš„ï¼Œä¾‹å¦‚</font></font><code>LayoutInflater</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æœ‰å…³æ¨¡å—ä¸­å£°æ˜çš„ä¾èµ–å…³ç³»çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚è§</font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœè¦å°†è¿™äº›ä¾èµ–é¡¹ä»çŸ¥é“å…¶ä¸Šä¸‹æ–‡çš„Androidç±»ä¹‹å¤–è·å–ï¼Œè¯·æ˜¾å¼æŒ‡å®šä¸Šä¸‹æ–‡ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> inflater: LayoutInflater <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> kodein.on(context = getActivity()).instance()</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é€šè¿‡æœ€æ¥è¿‘çš„ç§‘å¾·ï¼ˆï¼‰å¿«é€Ÿè·å–çˆ¶çº§ç§‘ä¸ï¼ˆï¼‰ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ˆç®€å•ï¼Œåœ¨Androidä¸­ï¼ŒæŸäº›å¯¹è±¡ä¾èµ–äºå…¶ä»–å¯¹è±¡ã€‚</font><font style="vertical-align: inherit;">é¡¶å±‚æ˜¯åº”ç”¨ç¨‹åºï¼Œå…¶ä¸‹æ˜¯æ´»åŠ¨ï¼Œç„¶åæ˜¯ç‰‡æ®µã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åœ¨Activityä¸­å®ç°</font></font><code>KodeinAware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå¹¶ä½œä¸ºåˆå§‹åŒ–è¿›è¡Œè°ƒç”¨</font></font><code>closestKodein()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»è€Œ</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»</font><font style="vertical-align: inherit;">è·å–å®ä¾‹</font></font><code>Application</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> closestKodein() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> ds: DataSource <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> instance() }</code> </pre><br> <code>closestKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨ä¹Ÿå¯ä»¥åœ¨Androidç±»ä¹‹å¤–è·å–å®ƒï¼Œä½†æ˜¯æ‚¨éœ€è¦ä¸€ä¸ªAndroidä¸Šä¸‹æ–‡æ‰èƒ½ä»ä¸­è°ƒç”¨è¯¥å‡½æ•°ã€‚</font><font style="vertical-align: inherit;">å¦‚æœä½¿ç”¨å®ƒ</font></font><code>KodeinAware</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™è¿˜è¦ä¸ºå…¶æŒ‡å®šä¸Šä¸‹æ–‡ï¼ˆé‡å†™ç›¸åº”çš„å±æ€§ï¼Œå¹¶å°†Androidä¸Šä¸‹æ–‡ä¼ é€’ç»™å‡½æ•°</font></font><code>kcontext()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyController</span></span></span></span>(androidContext: Context) : KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> androidContext.closestKodein() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodeinContext = kcontext(androidContext) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> inflater: LayoutInflater <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> instance() }</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨æ´»åŠ¨ä¸­åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„Kodein </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾ˆæœ‰å¿…è¦ä»Activityä¸­çš„çˆ¶Kodeinç»§æ‰¿å¹¶è¿›è¡Œæ‰©å±•ã€‚</font><font style="vertical-align: inherit;">è§£å†³æ–¹æ¡ˆéå¸¸ç®€å•ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> parentKodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> closestKodein() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> Kodein.lazy { extend(parentKodein) <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> } }</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kodeinæ­£åœ¨è¿›è¡Œé…ç½®æ›´æ”¹ </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œå¯ä»¥ã€‚</font><font style="vertical-align: inherit;">æœ‰ä¸€ä¸ªåŠŸèƒ½</font></font><code>retainedKodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨å®ƒæ—¶ï¼Œ</font></font><code>Kodein</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ”¹é…ç½®åå°†ä¸ä¼šé‡æ–°åˆ›å»º</font><font style="vertical-align: inherit;">å¯¹è±¡</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Activity</span></span></span></span>(), KodeinAware { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> parentKodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> closestKodein() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> kodein: Kodein <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> retainedKodein { extend(parentKodein) } }</code> </pre><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ–‡ç« ä¸­æ²¡æœ‰è¯´ä»€ä¹ˆï¼Ÿ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å¹¶æ²¡æœ‰å‡è£…è‡ªå·±æ˜¯å®Œæ•´çš„ï¼Œè€Œä¸”æˆ‘æœ¬äººå¯¹æŸäº›äº‹æƒ…ä¹Ÿä¸äº†è§£ï¼Œæ— æ³•å°è¯•é™ˆè¿°å®ƒä»¬ã€‚</font><font style="vertical-align: inherit;">ä»¥ä¸‹åˆ—å‡ºäº†æ‚¨å¯ä»¥äº†è§£çš„åŸºæœ¬åŸç†ï¼Œå¯ä»¥è‡ªå·±å­¦ä¹ ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> èŒƒå›´ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å®ä¾‹ç»‘å®š </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¤šé‡è£…è®¢ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å³æ—¶å›è°ƒ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¤–éƒ¨æ¥æº </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ é™¤ç‰ˆæœ¬çš„é™·é˜± </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¯é…ç½®çš„Kodein </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> JSR-330å…¼å®¹æ€§ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä»¥åŠä¸æ–‡æ¡£çš„é“¾æ¥ï¼š </font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ ¸å¿ƒ5.3</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Android 5.3</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èµ·å§‹é¡µ</font></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¸Œæœ›æœ¬æ–‡å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼ </font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN431696/">https://habr.com/ru/post/zh-CN431696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN431686/index.html">ç‰©è”ç½‘é™¤å¤–ï¼šMiraiåƒµå°¸ç½‘ç»œå¯¹Linuxæœºå™¨å‘èµ·äº†æ”»å‡»</a></li>
<li><a href="../zh-CN431688/index.html">Clangå¦‚ä½•ç¼–è¯‘å‡½æ•°</a></li>
<li><a href="../zh-CN431690/index.html">è§£å†³å¡å·´æ–¯åŸºå®éªŒå®¤çš„éš¾é¢˜</a></li>
<li><a href="../zh-CN431692/index.html">å…ç–«ç–—æ³•åœ¨å¤šå‘æ€§ç¡¬åŒ–ç—‡æ²»ç–—ä¸­çš„è¿›å±•</a></li>
<li><a href="../zh-CN431694/index.html">æ’åºâ€œæ²³å†…å¡”â€</a></li>
<li><a href="../zh-CN431698/index.html">ï¼ƒHolyJS18å±•å°hh.ruä¸Šçš„é—®é¢˜åˆ†æ</a></li>
<li><a href="../zh-CN431700/index.html">æˆ‘åœ¨å¸‚åœºä¸Šæ‰¾ä¸åˆ°çš„å®¶ç”¨ä¸‡ç”¨è¡¨</a></li>
<li><a href="../zh-CN431702/index.html">è‹è”HI-FIåŠå…¶åˆ›é€ è€…ï¼šä¸€éƒ¨å”±ç‰‡çš„è€³æœºæˆ–ä¸€ä¸ªè¢«é—å¿˜çš„æ•…äº‹ç”µå­äº§å“TDK-3â€œ Quadâ€</a></li>
<li><a href="../zh-CN431704/index.html">å‘¨æœ«é˜…è¯»ï¼šå¦‚ä½•ä¸æŸå®³æ‚¨çš„å¬åŠ›å¹¶é¿å…åŸå¸‚å™ªéŸ³-17ç¯‡æ–‡ç« å’Œå®ç”¨æŒ‡å—</a></li>
<li><a href="../zh-CN431706/index.html">å¹¸ç¦ç†è®ºã€‚ äº‹æ•…ä¸æ˜¯å¶ç„¶çš„å—ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>