<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ô¶Ô∏è üèîÔ∏è üîó M√¥nadas em 15 minutos üë©üèª‚Äçü§ù‚Äçüë®üèº üçë ü§ü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Entrada 
 No YOW! 2013 um dos desenvolvedores da linguagem Haskell, prof. Philip Wadler mostrou como as m√¥nadas permitem que linguagens funcionais pur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>M√¥nadas em 15 minutos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445800/"><h2>  Entrada </h2><br>  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">YOW!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2013</a> um dos desenvolvedores da linguagem Haskell, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">prof.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Philip Wadler</a> mostrou como as m√¥nadas permitem que linguagens funcionais puras realizem opera√ß√µes essencialmente imperativas, como manipula√ß√£o de entrada e sa√≠da e exce√ß√£o.  N√£o √© de surpreender que o interesse do p√∫blico neste t√≥pico tenha gerado um crescimento explosivo em publica√ß√µes sobre m√¥nadas na Internet.  Infelizmente, a maioria dessas publica√ß√µes usa exemplos escritos em linguagens funcionais, o que implica que os novatos em programa√ß√£o funcional desejam aprender sobre m√¥nadas.  Mas as m√¥nadas n√£o s√£o espec√≠ficas para Haskell ou linguagens funcionais e podem muito bem ser ilustradas por exemplos em linguagens de programa√ß√£o imperativas.  Este √© o objetivo deste guia. <br><br>  Qual √© a diferen√ßa deste guia para o resto?  Vamos tentar abrir as m√¥nadas em n√£o mais de 15 minutos usando apenas intui√ß√£o e alguns exemplos elementares de c√≥digo Python.  Portanto, n√£o come√ßaremos a teorizar e aprofundar a filosofia, discutindo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">burritos</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=http://web.archive.org/web/20081206204420/">trajes espaciais</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mesas</a> e endofuncionadores. <br><a name="habracut"></a><br><h2>  Exemplos motivacionais </h2><br>  Vamos considerar tr√™s quest√µes relacionadas √† composi√ß√£o de fun√ß√µes.  Vamos resolv√™-los de duas maneiras: o imperativo usual e o uso de m√¥nadas.  Depois, comparamos as diferentes abordagens. <br><br><h3>  1. Registro </h3><br>  Suponha que temos tr√™s fun√ß√µes un√°rias: <code>f1</code> , <code>f2</code> e <code>f3</code> , que recebem um n√∫mero e o retornam aumentado em 1, 2 e 3, respectivamente.  Cada fun√ß√£o tamb√©m gera uma mensagem, que √© um relat√≥rio sobre a opera√ß√£o conclu√≠da. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x + <span class="hljs-number"><span class="hljs-number">1</span></span>, str(x) + <span class="hljs-string"><span class="hljs-string">"+1"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x + <span class="hljs-number"><span class="hljs-number">2</span></span>, str(x) + <span class="hljs-string"><span class="hljs-string">"+2"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x + <span class="hljs-number"><span class="hljs-number">3</span></span>, str(x) + <span class="hljs-string"><span class="hljs-string">"+3"</span></span>)</code> </pre> <br>  Gostar√≠amos de encade√°-los para processar o par√¢metro <code>x</code> , ou seja, gostar√≠amos de calcular <code>x+1+2+3</code> .  Al√©m disso, precisamos obter uma explica√ß√£o leg√≠vel por humanos do que cada fun√ß√£o fez. <br><br>  Podemos alcan√ßar o resultado que precisamos da seguinte maneira: <br><pre> <code class="python hljs">log = <span class="hljs-string"><span class="hljs-string">"Ops:"</span></span> res, log1 = f1(x) log += log1 + <span class="hljs-string"><span class="hljs-string">";"</span></span> res, log2 = f2(res) log += log2 + <span class="hljs-string"><span class="hljs-string">";"</span></span> res, log3 = f3(res) log += log3 + <span class="hljs-string"><span class="hljs-string">";"</span></span> print(res, log)</code> </pre> <br>  Esta solu√ß√£o n√£o √© ideal, pois consiste em um grande n√∫mero de middleware mon√≥tono.  Se quisermos adicionar uma nova fun√ß√£o √† nossa cadeia, seremos for√ßados a repetir esse c√≥digo de liga√ß√£o.  Al√©m disso, manipula√ß√µes com as vari√°veis <code>res</code> e <code>log</code> prejudicam a legibilidade do c√≥digo, dificultando o monitoramento da l√≥gica do programa principal. <br><br>  Idealmente, um programa deve parecer uma cadeia simples de fun√ß√µes, como <code>f3(f2(f1(x)))</code> .  Infelizmente, os tipos de dados retornados por <code>f1</code> e <code>f2</code> n√£o correspondem aos tipos de par√¢metro <code>f2</code> e <code>f3</code> .  Mas podemos adicionar novas fun√ß√µes √† cadeia: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x, <span class="hljs-string"><span class="hljs-string">"Ops:"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, f)</span></span></span><span class="hljs-function">:</span></span> res = f(t[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (res[<span class="hljs-number"><span class="hljs-number">0</span></span>], t[<span class="hljs-number"><span class="hljs-number">1</span></span>] + res[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-string"><span class="hljs-string">";"</span></span>)</code> </pre> <br>  Agora podemos resolver o problema da seguinte maneira: <br><pre> <code class="python hljs">print(bind(bind(bind(unit(x), f1), f2), f3))</code> </pre> <br>  O diagrama a seguir mostra o processo computacional que ocorre em <code>x=0</code> .  Aqui <code>v1</code> , <code>v2</code> e <code>v3</code> s√£o os valores obtidos como resultado de chamadas para <code>unit</code> e <code>bind</code> . <br><br><img src="https://habrastorage.org/webt/dy/ta/f0/dytaf0ku8j3y7ctrcrhjlqbs2ck.png"><br><br>  A fun√ß√£o da <code>unit</code> converte o par√¢metro de entrada <code>x</code> em uma tupla de um n√∫mero e uma string.  A fun√ß√£o de <code>bind</code> chama a fun√ß√£o passada para ele como um par√¢metro e acumula o resultado na vari√°vel intermedi√°ria <code>t</code> . <br><br>  Conseguimos evitar a repeti√ß√£o do middleware colocando-o na fun√ß√£o de <code>bind</code> .  Agora, se <code>f4</code> a fun√ß√£o <code>f4</code> , apenas a incluiremos na cadeia: <br><pre> <code class="python hljs">bind(f4, bind(f3, ... ))</code> </pre> <br>  E n√£o precisamos fazer outras altera√ß√µes. <br><br><h3>  2. Lista de valores intermedi√°rios </h3><br>  Tamb√©m iniciaremos este exemplo com fun√ß√µes un√°rias simples. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Como no exemplo anterior, precisamos compor essas fun√ß√µes para calcular <code>x+1+2+3</code> .  Tamb√©m precisamos obter uma lista de todos os valores obtidos como resultado do trabalho de nossas fun√ß√µes, ou seja, <code>x</code> , <code>x+1</code> , <code>x+1+2</code> <code>x+1+2+3</code> . <br><br>  Diferentemente do exemplo anterior, nossas fun√ß√µes s√£o compostas, ou seja, os tipos de seus par√¢metros de entrada coincidem com o tipo do resultado.  Portanto, uma cadeia simples <code>f3(f2(f1(x)))</code> retornar√° o resultado final.  Mas, neste caso, perdemos os valores intermedi√°rios. <br><br>  Vamos resolver o problema "de frente": <br><pre> <code class="python hljs">lst = [x] res = f1(x) lst.append(res) res = f2(res) lst.append(res) res = f3(res) lst.append(res) print(res, lst)</code> </pre> <br>  Infelizmente, esta solu√ß√£o tamb√©m cont√©m muitos middlewares.  E se decidirmos adicionar <code>f4</code> , teremos que repetir esse c√≥digo novamente para obter a lista correta de valores intermedi√°rios. <br><br>  Portanto, adicionamos duas fun√ß√µes adicionais, como no exemplo anterior: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x, [x]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, f)</span></span></span><span class="hljs-function">:</span></span> res = f(t[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (res, t[<span class="hljs-number"><span class="hljs-number">1</span></span>] + [res])</code> </pre> <br>  Agora reescrevemos o programa como uma cadeia de chamadas: <br><pre> <code class="python hljs">print(bind(bind(bind(unit(x), f1), f2), f3))</code> </pre> <br>  O diagrama a seguir mostra o processo computacional que ocorre em <code>x=0</code> .  Novamente, <code>v1</code> , <code>v2</code> e <code>v3</code> denotam os valores obtidos da <code>unit</code> e das chamadas de <code>bind</code> . <br><br><img src="https://habrastorage.org/webt/qh/uw/7y/qhuw7yx5fo1yjlcbce34kuhejj4.png"><br><br><h3>  3. Valores vazios </h3><br>  Vamos tentar dar um exemplo mais interessante, desta vez com classes e objetos.  Suponha que tenhamos uma classe <code>Employee</code> com dois m√©todos: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Employee</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_boss</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Return the employee's boss def get_wage(self): # Compute the wage</span></span></code> </pre> <br>  Cada objeto da classe <code>Employee</code> possui um gerente (outro objeto da classe <code>Employee</code> ) e um sal√°rio, que s√£o acessados ‚Äã‚Äãpor m√©todos apropriados.  Ambos os m√©todos tamb√©m podem retornar <code>None</code> (o funcion√°rio n√£o tem um gerente, o sal√°rio √© desconhecido). <br><br>  Neste exemplo, criaremos um programa que mostra o sal√°rio do l√≠der desse funcion√°rio.  Se o gerente n√£o for encontrado ou seu sal√°rio n√£o puder ser determinado, o programa retornar√° <code>None</code> . <br><br>  Idealmente, precisamos escrever algo como <br><pre> <code class="python hljs">print(john.get_boss().get_wage())</code> </pre> <br>  Mas, neste caso, se algum dos m√©todos retornar <code>None</code> , nosso programa terminar√° com um erro. <br><br>  Uma maneira √≥bvia de lidar com essa situa√ß√£o pode ser assim: <br><pre> <code class="python hljs">result = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> john <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> john.get_boss() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> john.get_boss().get_wage() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: result = john.get_boss().get_wage() print(result)</code> </pre> <br>  Nesse caso, permitimos chamadas extras para os <code>get_wage</code> e <code>get_wage</code> .  Se esses m√©todos forem pesados ‚Äã‚Äão suficiente (por exemplo, acessar o banco de dados), nossa solu√ß√£o n√£o funcionar√°.  Portanto, n√≥s mudamos: <br><pre> <code class="python hljs">result = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> john <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: boss = john.get_boss() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boss <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: wage = boss.get_wage() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> wage <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: result = wage print(result)</code> </pre> <br>  Esse c√≥digo √© ideal em termos de c√°lculo, mas √© mal lido devido a tr√™s <code>if</code> aninhados.  Portanto, tentaremos usar o mesmo truque dos exemplos anteriores.  Defina duas fun√ß√µes: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e, f)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> f(e)</code> </pre> <br>  E agora podemos colocar toda a solu√ß√£o em uma linha. <br><pre> <code class="python hljs">print(bind(bind(unit(john), Employee.get_boss), Employee.get_wage))</code> </pre> <br>  Como voc√™ provavelmente j√° percebeu, neste caso, n√£o precisamos escrever a fun√ß√£o da <code>unit</code> : ela simplesmente retorna o par√¢metro de entrada.  Mas deixaremos para que seja mais f√°cil para n√≥s generalizar nossa experi√™ncia. <br><br>  Observe tamb√©m que no Python podemos usar m√©todos como fun√ß√µes, o que nos permitiu escrever <code>Employee.get_boss(john)</code> vez de <code>john.get_boss()</code> . <br><br>  O diagrama a seguir mostra o processo de c√°lculo quando John n√£o possui um l√≠der, ou seja, <code>john.get_boss()</code> retorna <code>None</code> . <br><br><img src="https://habrastorage.org/webt/hm/ae/9r/hmae9rlrkzaorijygg-jg2u7wrq.png"><br><br><h2>  Conclus√µes </h2><br>  Suponha que desejemos combinar as fun√ß√µes do mesmo tipo <code>f1</code> , <code>f2</code> , <code>‚Ä¶</code> , <code>fn</code> .  Se seus par√¢metros de entrada forem os mesmos que os resultados, podemos usar uma cadeia simples do formato <code>fn(‚Ä¶ f2(f1(x)) ‚Ä¶)</code> .  O diagrama a seguir mostra um processo de c√°lculo generalizado com resultados intermedi√°rios, indicado como <code>v1</code> , <code>v2</code> , <code>‚Ä¶</code> , <code>vn</code> . <br><br><img src="https://habrastorage.org/webt/dl/yl/lp/dlyllpbpaltz_hwgjbugs8ti2zg.png"><br><br>  Muitas vezes, essa abordagem n√£o √© aplic√°vel.  Os tipos de valores de entrada e resultados da fun√ß√£o podem variar, como no primeiro exemplo.  Ou as fun√ß√µes podem ser compostas, mas queremos inserir l√≥gica adicional entre as chamadas, pois nos exemplos 2 e 3 inserimos uma agrega√ß√£o de valores intermedi√°rios e uma verifica√ß√£o de um valor vazio, respectivamente. <br><br><h3>  1. Decis√£o imperativa </h3><br>  Em todos os exemplos, primeiro usamos a abordagem mais direta, que pode ser representada pelo seguinte diagrama: <br><br><img src="https://habrastorage.org/webt/bo/2i/co/bo2ico2rhkvds3jmirwyzsyd3yc.png"><br><br>  Antes de chamar <code>f1</code> fizemos algumas inicializa√ß√µes.  No primeiro exemplo, inicializamos uma vari√°vel para armazenar um log comum, no segundo, para uma lista de valores intermedi√°rios.  Depois disso, intercalamos as chamadas de fun√ß√£o com um determinado c√≥digo de conex√£o: calculamos valores agregados, verificamos o resultado como <code>None</code> . <br><br><h3>  2. M√¥nadas </h3><br>  Como vimos nos exemplos, as decis√µes imperativas sempre sofriam de verbosidade, repeti√ß√£o e l√≥gica confusa.  Para obter um c√≥digo mais elegante, usamos um certo padr√£o de design, segundo o qual criamos duas fun√ß√µes: <code>unit</code> e <code>bind</code> .  Este modelo √© chamado de <b>m√¥nada</b> .  A fun√ß√£o de <code>bind</code> cont√©m middleware enquanto a <code>unit</code> implementa a inicializa√ß√£o.  Isso nos permite simplificar a solu√ß√£o final para uma linha: <br><pre> <code class="python hljs">bind(bind( ... bind(bind(unit(x), f1), f2) ... fn<span class="hljs-number"><span class="hljs-number">-1</span></span>), fn)</code> </pre> <br>  O processo de c√°lculo pode ser representado por um diagrama: <br><br><img src="https://habrastorage.org/webt/tw/n5/ro/twn5ro-lppmqs2rssnne7buoqxo.png"><br><br>  Uma chamada para a <code>unit(x)</code> gera um valor inicial de <code>v1</code> .  Em seguida, <code>bind(v1, f1)</code> gera um novo valor intermedi√°rio <code>v2</code> , que √© usado na pr√≥xima chamada para <code>bind(v2, f2)</code> .  Esse processo continua at√© que um resultado final seja obtido.  Ao definir v√°rias <code>unit</code> e <code>bind</code> -se √† estrutura deste modelo, podemos combinar v√°rias fun√ß√µes em uma cadeia de c√°lculos.  Bibliotecas <i>de m√¥nadas</i> ( <i>por exemplo, PyMonad ou OSlash - aprox. Transl.</i> ) Geralmente cont√™m m√¥nadas prontas para uso (pares de <code>unit</code> e fun√ß√µes de <code>bind</code> ) para implementar determinadas composi√ß√µes de fun√ß√µes. <br><br>  Para encadear fun√ß√µes, os valores retornados por <code>unit</code> e <code>bind</code> devem ser do mesmo tipo que os par√¢metros de entrada de <code>bind</code> .  Este tipo √© chamado <b>mon√°dico</b> .  Nos termos do diagrama acima, o tipo de vari√°veis <code>v1</code> , <code>v2</code> , <code>‚Ä¶</code> , <code>vn</code> deve ser do tipo mon√°dico. <br><br>  Por fim, considere como voc√™ pode melhorar o c√≥digo escrito usando m√¥nadas.  Obviamente, chamadas de <code>bind</code> repetidas parecem deselegantes.  Para evitar isso, defina outra fun√ß√£o externa: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pipeline</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e, *functions)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> f <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> functions: e = bind(e, f) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e</code> </pre> <br>  Agora em vez <br><pre> <code class="python hljs">bind(bind(bind(bind(unit(x), f1), f2), f3), f4)</code> </pre> <br>  podemos usar a seguinte abrevia√ß√£o: <br><pre> <code class="python hljs">pipeline(unit(x), f1, f2, f3, f4)</code> </pre> <br><br><h2>  Conclus√£o </h2><br>  M√¥nadas s√£o um padr√£o de design simples e poderoso usado para compor fun√ß√µes.  Em linguagens de programa√ß√£o declarativa, ajuda a implementar mecanismos imperativos, como registro em log ou entrada / sa√≠da.  Em l√≠nguas imperativas <br>  ajuda a generalizar e reduzir o c√≥digo que vincula uma s√©rie de chamadas de fun√ß√µes do mesmo tipo. <br><br>  Este artigo fornece apenas uma compreens√£o superficial e intuitiva das m√¥nadas.  Voc√™ pode descobrir mais entrando em contato com as seguintes fontes: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">M√¥nadas em Python (com boa sintaxe!)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linha do tempo dos tutoriais da M√¥nada</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445800/">https://habr.com/ru/post/pt445800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445788/index.html">Vigil√¢ncia por v√≠deo em nuvem fa√ßa voc√™ mesmo: novos recursos do Ivideon Web SDK</a></li>
<li><a href="../pt445792/index.html">Como desenvolvemos a documenta√ß√£o em um projeto aberto da Embox</a></li>
<li><a href="../pt445794/index.html">Gigantes de TI revelam uma solu√ß√£o h√≠brida de implanta√ß√£o de nuvem h√≠brida</a></li>
<li><a href="../pt445796/index.html">Fintech Digest: Dorsey paga com bitcoins, estrat√©gia de blockchain da Austr√°lia, IPO da Levi, prefeito de Chicago e a inevitabilidade do bitcoin</a></li>
<li><a href="../pt445798/index.html">Rinoceronte dentro do gato - execute o firmware no emulador Kopycat</a></li>
<li><a href="../pt445802/index.html">5 coisas que tend√™ncias da Internet que todos deveriam conhecer</a></li>
<li><a href="../pt445804/index.html">Encapsulamento para samurais reais ou as nuances associadas √† palavra-chave interna em C #</a></li>
<li><a href="../pt445806/index.html">Como a intelig√™ncia artificial est√° mudando a ci√™ncia</a></li>
<li><a href="../pt445808/index.html">N√≥s odiamos e ca√ßamos: a vida perigosa de um cracker de v√≠rus que est√° fazendo inimigos poderosos</a></li>
<li><a href="../pt445814/index.html">Como um rob√¥ de entrega mudou os h√°bitos culin√°rios dos estudantes americanos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>