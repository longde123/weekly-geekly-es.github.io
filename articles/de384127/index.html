<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌽 🍬 🚵🏼 Meine DIY-Uhrenoption mit NTP-Client 👩‍🎨 🤟🏿 👩🏽‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Da es in früheren Veröffentlichungen nie zum fertigen Produkt kam, schlage ich meine eigene Version vor. Eisen ist nicht meine Spezialisierung, also u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Meine DIY-Uhrenoption mit NTP-Client</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384127/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Da es in früheren Veröffentlichungen nie zum fertigen Produkt kam, schlage ich meine eigene Version vor. </font><font style="vertical-align: inherit;">Eisen ist nicht meine Spezialisierung, also urteilen Sie bitte nicht streng.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also in Ordnung. Als meine Liebe zu Uhren und die genaue Zeit das Endstadium erreichten, wurde beschlossen, den Traum zu verwirklichen. Die Suche nach erschwinglichen Entwicklungsplatinen mit Ethernet an Bord begann. Rapsberry mit Linux schien eine "Waffe auf Spatzen" zu sein, deshalb habe ich im Netduino-Forum eine Frage gestellt, weil ich jetzt fest auf C # sitze und es interessant war, Bytecode auf dem Mikrocontroller auszuführen. Aber leider ist der einzige Moderator des Forums anscheinend in den Urlaub gefahren, und er hat mehrere Wochen gebraucht, um meine erste Nachricht zu genehmigen und zu veröffentlichen. Nicht gut, nicht gut ... Ein Arch Pro Board und andere fehlende Bodykits wurden bei aliexpress bestellt. Dann war es die günstigste Lösung. Der NXP LPC1768-Mikrocontroller ist auf der Karte selbst (Cortex-M3-Kern) sowie LPC11U35 (Cortex-M0) installiert, um die Kommunikation mit der Software zu erleichtern. Der Hersteller selbst stellt eine Online-IDE zur Verfügung.Die Kompilierung befindet sich auch auf ihrem Server. Die Firmware wird heruntergeladen und als Datei auf einem USB-Stick auf das Board heruntergeladen. Es gibt keinen Debugger. Deshalb habe ich mit der Entwicklung des Projekts in Keil uVision begonnen, einer Testversion natürlich. Für die Firmware und das Debuggen des Mikrocontrollers ist nur ein Micro-USB-Kabel erforderlich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der DS3231 IC wurde als Echtzeituhr ausgewählt, die mir in Form eines vorgefertigten Moduls zur Verfügung stand, das über I2C kommuniziert:</font></font><br>
<br>
<img src="https://habrastorage.org/files/338/b5f/65d/338b5f65d74d494896befe8ed66c1301.jpg" alt="Rtc"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus irgendeinem Grund funktionierte das mysteriöse Modul nur, wenn der Logikanalysator angeschlossen und eingeschaltet war (ich verwende Logic-U ISL von den Jungs aus Kharkov): </font></font><br>
<br>
<img src="https://habrastorage.org/files/62e/5f4/261/62e5f42614aa43c8bcdd7ac5851d517c.jpg" alt="Erfahrungen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zwischen den Signalleitungen und V + sollten 10K-Widerstände sein, das Modul wählte Megaoms. </font><font style="vertical-align: inherit;">Welche Art von Dummy anstelle einer Widerstandsbaugruppe und einer LED, die niemals aufleuchtet, habe ich nicht verstanden. </font><font style="vertical-align: inherit;">Die gelöteten Widerstände des Moduls wurden wiederbelebt, aber die kollektive Farmschwelle überschritt eine bestimmte Linie, sodass eine Platine wie das Arduino-Schild entwickelt wurde: </font></font><br>
<br>
<img src="https://habrastorage.org/files/5c0/1d7/537/5c01d7537dbf40dda09dcc5ebfb0f5a8.jpg" alt="Schild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schema:</font></font><br>
<br>
<img src="https://habrastorage.org/files/431/fe6/8e8/431fe68e8a164561922eb9d8a550162b.PNG" alt="planen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Segmentanzeige wurde als Indikator genommen - diese Größe (0,8 Zoll in der Höhe) war nur mit weißen LEDs, aus allen Unterlagen darauf, die Chinesen stellten nur einen Jeep mit Pinbelegung zur Verfügung, einige unlesbare Zeichen mussten durch die Ausschlussmethode erraten werden. Die Steuerung dafür übernahm der bekannte MAX7219, der über SPI kommunizierte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fall ... In den Neujahrsferien gibt es natürlich keinen 3D-Drucker oder Laserschneiden. Ich selbst habe ein 8 mm Plexiglas gesägt, das herumlag. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Moment der Hoffnungslosigkeit in der Endphase: </font></font><br>
<br>
<img src="https://habrastorage.org/files/35e/3ff/15e/35e3ff15eec94c61af426f9b67b4a552.jpg" alt="Hoppla"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Endgültige Produktansicht:</font></font><br>
<br>
<img src="https://habrastorage.org/files/874/01d/b99/87401db995ee4975b06b0cfb6cedc4f1.jpg" alt="Ende"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Uhr empfängt eine IP-Adresse über DHCP (ein Router verteilt sie an mich). </font><font style="vertical-align: inherit;">Der NTP-Server wird zufällig ausgewählt. </font><font style="vertical-align: inherit;">Die Zeit wird alle 25 Stunden angefordert (mein Provider trennt sich abends zur gleichen Zeit vom Internet, sodass ich nicht in diesen Zeitraum einsteigen möchte). </font><font style="vertical-align: inherit;">Aufgrund der sich ständig ändernden Gesetzgebung mit Zeitzonen habe ich beschlossen, den Übergang zur Sommer- und Winterzeit nicht zu implementieren. Zwei Tasten verringern oder erhöhen einfach den Versatz von UTC um eine Stunde. </font><font style="vertical-align: inherit;">Der Offset wird im EEPROM des Mikrocontrollers aufgezeichnet. </font><font style="vertical-align: inherit;">Die Uhr wird zusätzlich durch eine 3-V-Lithiumbatterie gesichert, sodass Strom- und Internetausfälle kein Problem darstellen. </font><font style="vertical-align: inherit;">Vier Farb-LEDs auf der Platine weisen auf Probleme mit dem Internet, Hardware oder Laufzeitfehler hin. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Quellcode für die Firmware auf dem Github: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/sapozhnikov/eclock</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de384127/">https://habr.com/ru/post/de384127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de384109/index.html">Reisejacke: 15 Features für 10 Millionen US-Dollar</a></li>
<li><a href="../de384115/index.html">Leistungsstarke Gauss 12W LED-Lampe</a></li>
<li><a href="../de384117/index.html">Zackees Fahrradhandschuhe verbessern die Verkehrssicherheit</a></li>
<li><a href="../de384121/index.html">Kinder sollten keine Smartphones unter 16 Jahren bekommen, sagt der Schulpsychologe</a></li>
<li><a href="../de384125/index.html">Einsatz additiver Technologien bei der Herstellung komplexer Nichtstandardprodukte</a></li>
<li><a href="../de384129/index.html">Nützliche Apps für Schüler der Mittel- und Oberstufe</a></li>
<li><a href="../de384131/index.html">Russischer Helm der VRD der virtuellen Realität</a></li>
<li><a href="../de384133/index.html">Website mit elektronischen Petitionen an den Präsidenten der Ukraine</a></li>
<li><a href="../de384135/index.html">Eine Auswahl von Büchern im Genre der klassischen und alternativen Fantasie</a></li>
<li><a href="../de384137/index.html">Wie Automatisierung dazu beiträgt, die Effizienz von Mitarbeitern mit unterschiedlichen Qualifikationen zu steigern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>