<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÆ ü§öüèª ü§òüèΩ Escribimos nuestro protocolo encima de UDP „ÄΩÔ∏è üßëüèæ‚Äçü§ù‚Äçüßëüèº üëÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las primeras transmisiones en vivo de la escena aparecieron en Rusia hace casi 70 a√±os y se transmitieron desde una estaci√≥n de televisi√≥n m√≥vil (PTS)...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Escribimos nuestro protocolo encima de UDP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/413479/">  Las primeras transmisiones en vivo de la escena aparecieron en Rusia hace casi 70 a√±os y se transmitieron desde una estaci√≥n de televisi√≥n m√≥vil (PTS), que parec√≠a un troleb√∫s y le permit√≠a transmitir desde fuera del estudio.  Y hace solo tres a√±os, Periscope permiti√≥ usar un tel√©fono m√≥vil en lugar de un "troleb√∫s". <br><br>  Pero esta aplicaci√≥n ten√≠a una serie de problemas relacionados, por ejemplo, con demoras en la transmisi√≥n, la incapacidad de ver transmisiones en alta calidad, etc. <br><br><img src="https://habrastorage.org/webt/ah/bx/dh/ahbxdhk3rew0amnby0xhqmwct98.jpeg"><br>  Seis meses despu√©s, en el verano de 2016, Odnoklassniki lanz√≥ su aplicaci√≥n m√≥vil de transmisi√≥n OK Live, en la que intentaron resolver estos problemas. <br><br>  Alexander Tobol es responsable de la parte t√©cnica del video en Odnoklassniki y en Highload ++ 2017 habl√≥ sobre c√≥mo escribir su protocolo UDP y por qu√© podr√≠a ser necesario. <br><br>  De la transcripci√≥n de su informe, aprender√° todo sobre otros protocolos de transmisi√≥n de video, cu√°les son los matices y qu√© trucos a veces se requieren. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/1Ih0bL2Zp1c" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Dicen que siempre debemos comenzar con la arquitectura y los conocimientos tradicionales, ¬°supuestamente es imposible sin esto!  Entonces hag√°moslo. <br><a name="habracut"></a><br><h2>  Arquitectura y conocimientos tradicionales </h2><br>  En la siguiente diapositiva se encuentra el diagrama de arquitectura de cualquier servicio de transmisi√≥n: el <strong>video se alimenta a la entrada, se convierte y se transmite a la salida</strong> .  Agregamos un poco m√°s de requisitos a esta arquitectura: el video debe suministrarse desde computadoras de escritorio y tel√©fonos m√≥viles, y la salida debe ir a las mismas computadoras de escritorio, tel√©fonos m√≥viles, smartTV, Chromcast, AppleTV y otros dispositivos; todo ese video se puede reproducir. <br><br><img src="https://habrastorage.org/webt/g2/ju/k_/g2juk_sfrmjcu1hv_4ieulhse44.jpeg"><br>  A continuaci√≥n, pasamos a los t√©rminos de referencia.  Si tienes un cliente, tienes TK.  Si eres una red social, no tienes TK.  ¬øC√≥mo inventarlo? <br><br>  Por supuesto, puede entrevistar a los usuarios y descubrir todo lo que quieren.  Pero ser√° un mont√≥n de deseos que no se correlacionan con lo que la gente realmente necesita. <br><br>  Decidimos ir en sentido contrario y vimos lo que los usuarios NO quer√≠an ver desde el servicio de transmisi√≥n. <br><br><ul><li>  Lo primero que el usuario no quiere es ver el <strong>retraso al comienzo de la transmisi√≥n</strong> . <br></li><li>  El usuario no quiere ver una <strong>imagen de transmisi√≥n de baja calidad</strong> . <br></li><li>  Si la transmisi√≥n es interactiva cuando el usuario se comunica con su audiencia (transmisiones en vivo, llamadas, etc.), entonces no quiere ver el <strong>retraso entre el transmisor y el espectador</strong> . <br></li></ul><br>  As√≠ es como se ve un servicio de transmisi√≥n normal.  Veamos qu√© se puede hacer para hacer un servicio de transmisi√≥n regular en lugar del habitual. <br><br><img src="https://habrastorage.org/webt/ik/68/zp/ik68zpbfkto_uh2ukzdpdinqoqi.jpeg"><br>  Puede comenzar mirando todos los protocolos de transmisi√≥n, seleccionar los m√°s interesantes y compararlos.  Pero lo hicimos de manera diferente. <br><br><h2>  ¬øQu√© tienen los competidores? </h2><br>  Comenzamos explorando los servicios de la competencia.  <strong>Open Periscope: ¬øqu√© tienen?</strong> <br><br>  Como siempre, lo principal es la arquitectura. <br><br><img src="https://habrastorage.org/webt/ex/-e/xo/ex-exowlx_iyvaq5xvqmpsjnata.jpeg"><br>  Sara Hyder, ingeniera principal de Periscope, escribe que usan Wowza para el backend.  Si leemos un poco m√°s de art√≠culos, veremos qu√© transmiten utilizando el protocolo <strong>RTMP</strong> y lo distribuiremos en RTMP o en HLS.  Veamos cu√°les son estos protocolos y c√≥mo funcionan. <br><br>  Probamos Periscope en nuestros tres requisitos principales. <br><img src="https://habrastorage.org/webt/i5/6n/y-/i56ny-rn2pymgbg_pujoroehycm.jpeg"><br>  Tienen una <strong>velocidad de inicio</strong> aceptable (menos de un segundo en buenas redes), una <strong>calidad</strong> constante <strong>de</strong> aproximadamente 600 px (no HD) y, al mismo tiempo, los <strong>retrasos pueden ser de hasta 12 segundos</strong> . <br><br>  Por cierto, ¬øc√≥mo medir el retraso en la transmisi√≥n? <br><img src="https://habrastorage.org/webt/ug/hs/pa/ughspadkdie3xrgpmxt1vjwrmdm.jpeg"><br>  Esta es una fotograf√≠a de una medici√≥n de retraso.  Hay un tel√©fono m√≥vil con temporizador.  Encendemos la transmisi√≥n y vemos la imagen de este tel√©fono en la pantalla.  Durante 0,15 milisegundos, la imagen cay√≥ en el sensor de la c√°mara y se retir√≥ de la memoria de video a la pantalla del tel√©fono.  Despu√©s de eso, encendemos el navegador y vemos la transmisi√≥n. <br><br>  ¬°Ay!  Ella est√° un poco retrasada, unos 12 segundos. <br><br>  Para encontrar las razones del retraso, perfilamos la transmisi√≥n de video. <br><img src="https://habrastorage.org/webt/ce/3u/jg/ce3ujgyeow2snntsekcqqq6xcr4.jpeg"><br>  Entonces, hay un tel√©fono m√≥vil, el video sale de la c√°mara y entra al b√∫fer de video.  Aqu√≠ los retrasos son m√≠nimos (‚âà0.15 ms).  Luego, el codificador codifica la se√±al, la empaqueta en un paquete y la env√≠a al buffer del z√≥calo.  Todo vuela a la web.  Adem√°s, lo mismo sucede en el dispositivo receptor. <br><br>  B√°sicamente, hay dos puntos dif√≠ciles principales a considerar: <br><br><ul><li>  <strong>codificaci√≥n / decodificaci√≥n de video;</strong> <br></li><li>  <strong>protocolos de red</strong> <br></li></ul><br><h2>  Codificaci√≥n / Decodificaci√≥n de video </h2><br>  Les contar√© un poco sobre la codificaci√≥n.  Lo encontrar√°s de todos modos si haces transmisi√≥n en vivo de baja latencia. <br><img src="https://habrastorage.org/webt/gr/op/o_/gropo_fxvnlubkxnrwdjrbhrj-w.jpeg"><br>  ¬øQu√© es un video?  Este es un conjunto de marcos, pero no del todo simple.  Los marcos son de tres tipos: I, P y B-frame: <br><br><ul><li>  <strong>I-frame</strong> es solo jpg.  De hecho, este es un marco de referencia, no depende de nadie y contiene una imagen clara. <br></li><li>  <strong>El marco P</strong> depende √∫nicamente de los marcos anteriores. <br></li><li>  El complicado <strong>marco B</strong> puede depender del futuro.  Esto significa que para calcular el cuadro b, es necesario que los cuadros futuros tambi√©n provengan de la c√°mara.  Solo entonces se puede decodificar un b-frame con cierto retraso. <br></li></ul><br>  Esto muestra que los <strong>marcos</strong> <strong>B</strong> <strong>son perjudiciales</strong> .  Intentemos eliminarlos. <br><br><ol><li>  Si transmite desde un dispositivo m√≥vil, puede intentar <strong>habilitar el perfil de l√≠nea de base</strong> .  Deshabilitar√° el marco B. <br></li><li>  Puede intentar configurar el c√≥dec y reducir la demora para cuadros futuros para que los cuadros lleguen m√°s r√°pido. <br></li><li>  Otra cosa importante al ajustar el c√≥dec es la <strong>inclusi√≥n de CBR</strong> (velocidad de bits constante). <br></li></ol><br><img src="https://habrastorage.org/webt/yu/xr/0t/yuxr0tpvsdyvqzkfxd_c7k4rop4.jpeg"><br>  El funcionamiento de los c√≥decs se ilustra en la diapositiva anterior.  En este ejemplo, el video es una imagen est√°tica, su codificaci√≥n ahorra espacio en el disco, porque  casi nada cambia all√≠, y la tasa de bits del video es baja.  Se est√°n produciendo cambios: la entrop√≠a est√° creciendo, la tasa de bits de video est√° creciendo, es genial almacenarla en el disco. <br><br>  Pero en el momento en que comenzaron los cambios activos, y la tasa de bits aument√≥, lo m√°s probable es que todos los datos no ingresen a la red.  Esto es exactamente lo que sucede cuando haces una videollamada y comienzas a girar, y tu suscriptor ralentiza la imagen.  Esto se debe al hecho de que la red no tiene tiempo para adaptarse al cambio de la velocidad de bits. <br><br>  <strong>Uno debe incluir CBR</strong> .  No todos los c√≥decs de Android lo admitir√°n correctamente, pero se esforzar√°n por conseguirlo.  Es decir, debe comprender que con CBR no obtendr√° la imagen perfecta del mundo, como en la imagen inferior, pero vale la pena encenderla. <br><br>  4. Y en el backend necesita agregar el c√≥dec de <strong>latencia cero</strong> a H264; esto le permitir√° no hacer dependencias en marcos para el futuro. <br><br><h2>  Protocolos de transferencia de video </h2><br>  Considere qu√© protocolos de transmisi√≥n ofrece la industria.  Los divid√≠ condicionalmente en dos tipos: <br><br><ol><li>  protocolos de transmisi√≥n; <br></li><li>  protocolos de segmento. <br></li></ol><br><img src="https://habrastorage.org/webt/hc/fr/qn/hcfrqnga93h7wofbe6j8ojk1h4g.jpeg"><br>  <strong>Los protocolos de transmisi√≥n</strong> son protocolos del mundo de las llamadas p2p: <strong>RTMP, webRTC, RTSP / RTP</strong> .  Se diferencian en que los usuarios acuerdan qu√© canal tienen, seleccionan la tasa de bits del c√≥dec seg√∫n el canal.  Y tambi√©n tienen equipos adicionales de este tipo, como "dame un tiro de referencia".  Si perdi√≥ un marco, en estos protocolos puede solicitarlo nuevamente. <br><br>  La diferencia entre los <strong>protocolos de segmento</strong> es que nadie negocia con nadie.  Cortan el video en segmentos, almacenan cada segmento en varias calidades y el cliente puede elegir qu√© segmento mirar.  Cada segmento comienza con un marco de referencia. <br><br>  Considere los protocolos con m√°s detalle.  Comencemos con los protocolos de transmisi√≥n y descubramos qu√© problemas podemos encontrar si usamos protocolos de transmisi√≥n para la transmisi√≥n de transmisi√≥n. <br><br><h3>  Protocolos de transmisi√≥n </h3><br>  Periscope usa RTMP.  Este protocolo apareci√≥ en 2009, y al principio Adobe no lo especific√≥ por completo.  Luego tuvo un cierto tipo de dificultad con el hecho de que Adobe quer√≠a vender exclusivamente su servidor.  Es decir, RTMP se desarroll√≥ bastante dif√≠cil.  Su principal problema es que <strong>usa TCP</strong> , pero por alguna raz√≥n Periscope lo eligi√≥. <br><br><img src="https://habrastorage.org/webt/p3/qf/8x/p3qf8x_qmpcxxs1ydjzdrewzpv8.jpeg"><br><br>  Si lees en detalle, resulta que Periscope usa RTMP para transmitir con un peque√±o n√∫mero de espectadores.  Solo tales transmisiones, si tiene un canal insuficiente, lo m√°s probable es que no pueda verlo. <br><br><img src="https://habrastorage.org/webt/42/cc/oy/42ccoy-bvsta9_1wi47vsetzrpy.jpeg"><br><br>  Considere un ejemplo espec√≠fico.  Hay un usuario con un canal de comunicaci√≥n estrecho que est√° viendo su transmisi√≥n.  Usted est√° de acuerdo con √©l en RTMP sobre la baja tasa de bits y comienza a transmitirlo personalmente. <br><br>  Un usuario con Internet genial viene a ti, t√∫ tambi√©n tienes Internet genial, pero ya has acordado una baja calidad con alguien, y resulta que este tercero con Internet genial est√° viendo una transmisi√≥n de mala calidad, a pesar de que podr√≠a se ven bien <br><br>  Decidimos solucionar este problema.  Hicimos posible que RTMP se truncara individualmente para cada cliente, es decir, los streamers negocian con el servidor, transmiten con la mayor calidad posible y cada cliente recibe la calidad que la red le permite. <br><br>  Wow! <br><br>  Pero a√∫n as√≠, tenemos RTMP sobre TCP, y nadie nos ha asegurado que bloqueemos el comienzo de la cola. <br><br><img src="https://habrastorage.org/webt/pr/ri/db/prridbql3upjieh2baseexcnkoa.jpeg"><br><br>  Esto se ilustra en la figura: recibimos fotogramas de audio y video, RTMP los empaqueta, tal vez los mezclan de alguna manera y vuelan a la red. <br><br>  Pero supongamos que perdemos un paquete.  Es posible que se haya descartado el mismo paquete amarillo perdido, que generalmente es una trama P de alguna anterior.  Quiz√°s, como m√≠nimo, uno podr√≠a reproducir audio.  Pero TCP no nos dar√° el resto de los paquetes, ya que <strong>garantiza la entrega y la secuencia de los paquetes</strong> .  De alguna manera debemos lidiar con esto. <br><br><img src="https://habrastorage.org/webt/me/vz/at/mevzattuvqxtwrbnu61ubb40nm8.jpeg"><br>  Hay otro problema con el uso del protocolo TCP en la transmisi√≥n. <br><br>  Digamos que tenemos un b√∫fer y un alto ancho de banda de red.  Generamos paquetes de alta resoluci√≥n desde nuestro c√≥dec all√≠.  Entonces, ¬°op!  - La red comenz√≥ a funcionar peor.  En el c√≥dec, ya hemos indicado que la tasa de bits debe reducirse, pero los paquetes ya est√°n en la cola y <strong>no puede eliminarlos de all√≠</strong> de ninguna manera.  TCP est√° desesperado por impulsar paquetes HD a trav√©s de nuestro 3G. <br><br>  No tenemos administraci√≥n de b√∫fer, ni priorizaci√≥n, por lo que <strong>TCP es extremadamente inadecuado para la transmisi√≥n</strong> . <br><br><img src="https://habrastorage.org/webt/nh/ed/xr/nhedxrx0krpqjjtcq3txpq4a0_i.jpeg"><br><br>  Echemos un vistazo a las redes m√≥viles ahora.  Puede ser sorprendente para los residentes de las ciudades capitales, pero nuestra red m√≥vil promedio se ve as√≠: <br><br><ul><li>  Tr√°fico de 1.1 Mbps; <br></li><li>  0.1% de p√©rdida de paquetes; <br></li><li>  RTT promedio de 300 ms. <br></li></ul><br>  Y si observa algunas regiones y operadores espec√≠ficos, tienen un <strong>porcentaje promedio de p√©rdida de paquetes diarios de m√°s del 3%</strong> , y el RTT de 600 ms es normal. <br><br>  TCP es, por un lado, un protocolo genial: es muy dif√≠cil ense√±arle a un autom√≥vil a conducir de inmediato en carreteras y fuera de carretera.  Pero ense√±arle a ella tambi√©n a volar por redes inal√°mbricas fue muy dif√≠cil. <br><br><img src="https://habrastorage.org/webt/7d/1u/la/7d1ula7h-j6sf-4mb4xyw-pqi_m.jpeg"><br><br><blockquote>  Perder incluso el 0.001% de los paquetes resulta en una reducci√≥n del 30% en el rendimiento.  Es decir, nuestro usuario no utiliza el canal en un 30% debido a la ineficiencia del protocolo TCP en redes con p√©rdida aleatoria de paquetes. <br></blockquote><br>  En ciertas regiones, la p√©rdida de paquetes alcanza el 1%, luego el usuario tiene aproximadamente el 10% del ancho de banda. <br><br>  Por <strong>lo</strong> tanto, <strong>no haremos TCP</strong> . <br><br>  Veamos qu√© m√°s hay en el mundo de la transmisi√≥n desde UDP. <br><br>  <strong>El protocolo WebRTC</strong> ha funcionado muy bien para llamadas p2p.  En sitios muy populares escriben que usarlo para llamadas es muy bueno, pero para entregar videos y m√∫sica no es bueno. <br><br>  Su principal problema es que <strong>descuida las p√©rdidas</strong> .  Con todas las situaciones extra√±as, √©l simplemente cae. <br><br>  Todav√≠a hay alg√∫n problema en su apego a las llamadas, el hecho es que encripta todo.  Por lo tanto, si difunde transmisiones y no hay necesidad de encriptar toda la transmisi√≥n de audio / video al iniciar WebRTC, de todos modos pondr√° a prueba su procesador.  Puede que no necesites esto. <br><br><img src="https://habrastorage.org/webt/h4/qq/1o/h4qq1o8awojsly2-fo-mggjb30y.jpeg"><br><br>  <strong>La transmisi√≥n RTP</strong> es el protocolo b√°sico para transmitir datos a trav√©s de UDP.  A continuaci√≥n, en la diapositiva a la derecha, hay un conjunto de extensiones y RFC que tuvieron que implementarse en WebRTC para adaptar este protocolo a las llamadas.  En principio, puede intentar hacer algo como esto: marque un conjunto de extensiones a RTP y obtenga la transmisi√≥n UDP.  <strong>Pero es muy dificil</strong> . <br><br>  El segundo problema es que si uno de sus clientes no admite ninguna extensi√≥n, entonces el protocolo no funcionar√°. <br><br><img src="https://habrastorage.org/webt/vi/ny/wl/vinywlwh6wfdwrrfznzoiccjjzc.jpeg"><br><br><h3>  Protocolos de segmento </h3><br>  Un buen ejemplo de un protocolo de video segmentado es <strong>MPEG-Dash</strong> .  Consiste en un archivo de manifiesto que publica en su portal.  Contiene enlaces a archivos en diferentes calidades, al principio del archivo hay un √≠ndice que dice en qu√© lugar del archivo comienza qu√© segmento. <br><br><img src="https://habrastorage.org/webt/9x/kd/py/9xkdpywmis1cfrdrmx6peob2gag.jpeg"><br><br>  Todo el video se divide en segmentos, por ejemplo, durante 3 segundos, cada segmento comienza con un marco de referencia.  Si ve un video de este tipo y su tasa de bits cambia, entonces solo en el lado del cliente comienza a tomar el segmento de la calidad que necesita. <br><br>  Otro ejemplo de transmisi√≥n segmentada es <strong>HLS</strong> . <br><br>  MPEG-Dash es una soluci√≥n de Google, funciona bien en Android, y la soluci√≥n de Apple es m√°s antigua, tiene una serie de ciertas desventajas. <br><br><img src="https://habrastorage.org/webt/ed/jv/wv/edjvwvr9g_-n_tihydmscth_rym.jpeg"><br><br>  El primero de ellos es que el manifiesto principal contiene enlaces a manifiestos secundarios, los manifiestos secundarios para cada cualidad espec√≠fica contienen enlaces a cada segmento individual, y cada segmento individual est√° representado por un archivo separado. <br><br>  Si miras a√∫n m√°s en detalle, entonces dentro de cada segmento est√° MPEG2-TS.  Este protocolo tambi√©n se cre√≥ para el sat√©lite; su tama√±o de paquete es de <strong>188 bytes</strong> .  Es muy inc√≥modo empacar video en este tama√±o, especialmente porque siempre le proporciona un encabezado peque√±o. <br><br>  De hecho, esto es dif√≠cil no solo para los servidores, que para procesar 40 GB de tr√°fico deben recolectar <strong>26 millones de paquetes</strong> , sino que tambi√©n es dif√≠cil para el cliente.  Por lo tanto, cuando reescribimos el reproductor iOS en MPEG-Dash, incluso vimos algunas mejoras de rendimiento. <br><br><img src="https://habrastorage.org/webt/li/iy/-b/liiy-bk2b4hbreygtlsrypgykb4.jpeg"><br><br>  Pero Apple no se queda quieto.  En 2016, finalmente anunciaron que tienen la oportunidad de extraer un fragmento de MPEG4 en HLS.  Luego prometieron agregar esto solo para desarrolladores, pero parece que ahora deber√≠a aparecer soporte para macOS e iOS. <br><br>  Es decir, parece que la transmisi√≥n de fragmentos es conveniente: ven, toma el fragmento deseado, comienza desde el marco de referencia, funciona. <br><br>  Menos: est√° claro que el marco de referencia desde el que comenz√≥ no es el marco que el que transmite ahora lo tiene.  Por lo tanto, <strong>siempre hay un retraso</strong> . <br><br>  En general, es posible terminar HLS con demoras del orden de 5 segundos, alguien dice que logr√≥ obtener 4, pero en principio, la <strong>decisi√≥n de usar la transmisi√≥n de fragmentos para la traducci√≥n no es muy buena</strong> . <br><br><img src="https://habrastorage.org/webt/ot/5d/fx/ot5dfxmgkfjri9h6uqxttl7dwoo.jpeg"><br><br><h3>  Dificultad vs retraso </h3><br>  Veamos todos los protocolos disponibles y ord√©nelos por dos par√°metros: <br><br><ul><li>  la latencia que dan entre la transmisi√≥n y el espectador; </li><li>  complejidad </li></ul><br>  Cuanto m√°s corto es el retraso que garantiza el protocolo, m√°s complejo es. <br><br><img src="https://habrastorage.org/webt/va/or/jm/vaorjm1gkqcpwvxf1eos4uds90a.jpeg"><br><br><h3>  Que queremos </h3><br>  Queremos hacer un protocolo UDP para la transmisi√≥n de 1 a N con un retraso comparable a la comunicaci√≥n p2p, con la opci√≥n de cifrado opcional de paquetes dependiendo de si la transmisi√≥n es privada o p√∫blica. <br><br>  <strong>¬øQu√© otras opciones hay?</strong>  Puede esperar, por ejemplo, cuando Google lance su QUIC. <br><br>  Te dir√© un poco de qu√© se trata.  Google est√° posicionando Google QUIC como un reemplazo para TCP, una especie de TCP 2.0.  Se ha desarrollado desde 2013, ahora no tiene una especificaci√≥n, pero est√° completamente disponible en Google Chrome, y me parece que a veces lo encienden a algunos usuarios para ver c√≥mo funciona.  En principio, puede acceder a la configuraci√≥n, activar QUIC, ir a cualquier sitio de Google y obtener este recurso a trav√©s de UDP. <br><br>  Decidimos no esperar hasta que todos especifiquen y presentar nuestra decisi√≥n. <br><br>  Requisitos de protocolo: <br><br><ol><li>  <strong>Multithreading</strong> , es decir, tenemos varias transmisiones: control, video, audio. <br></li><li>  <strong>Una garant√≠a de entrega opcional</strong> : el flujo de control tiene una garant√≠a del 100%, el video que menos necesitamos, podemos dejar el cuadro all√≠, a√∫n nos gustar√≠a el audio. <br></li><li>  <strong>Priorizaci√≥n de transmisiones</strong> : para que el audio avance y el gerente generalmente vol√≥. <br></li><li>  <strong>Cifrado opcional</strong> : ya sea todos los datos o solo encabezados y datos cr√≠ticos. <br></li></ol><br><img src="https://habrastorage.org/webt/k6/un/6t/k6un6tc2qxdngdgbjgvycugso80.jpeg"><br><br>  Este es un tri√°ngulo est√°ndar: si es una buena red, alta calidad y baja latencia.  Tan pronto como aparece una red inestable, los paquetes comienzan a desaparecer, equilibramos la calidad y el retraso.  Tenemos una opci√≥n: esperar hasta que la red mejore y enviar todo lo que se ha acumulado, o dejarlo y vivir de alguna manera con √©l. <br><br>  Si clasifica los protocolos seg√∫n este principio, se puede ver que cuanto <strong>m√°s corto es el tiempo de espera, peor es la calidad</strong> , una conclusi√≥n bastante simple. <br><br>  Queremos introducir nuestro protocolo en la zona donde los retrasos est√°n cerca de WebRTC, pero al mismo tiempo poder impulsarlo un poco, porque despu√©s de todo no tenemos llamadas, sino transmisiones.  El usuario finalmente quiere recibir una transmisi√≥n de calidad. <br><br><h2>  Desarrollo </h2><br>  Comencemos a escribir el protocolo UDP, pero primero mire las estad√≠sticas. <br><br><img src="https://habrastorage.org/webt/7f/pa/g2/7fpag2oc-8grjh0sprl-xjok9hg.jpeg"><br><br>  Estas son nuestras estad√≠sticas sobre redes m√≥viles.  Se puede ver que el Internet promedio es un poco m√°s que megabit, la p√©rdida de paquetes de aproximadamente el 1% es normal y RTT en la regi√≥n de 600 ms, en 3G, estos son solo valores promedio. <br><br>  Nos centraremos en esto cuando escribamos el protocolo. ¬°Vamos! <br><br><h2>  Protocolo UDP </h2><br>  Abrimos el socket UDP, quitamos los datos, empacamos, enviamos.  Tomamos el segundo paquete del c√≥dec, a√∫n lo enviamos.  ¬°Todo parece ser genial! <br><br><img src="https://habrastorage.org/webt/_z/mn/pb/_zmnpbiqjqaylvgxteujqyehvi4.jpeg"><br><br>  Pero obtenemos la siguiente imagen: si comenzamos a enviar aleatoriamente paquetes UDP al socket, seg√∫n las estad√≠sticas, para el paquete 21, la probabilidad de que llegue ser√° del 85%.  Es decir, la p√©rdida de paquetes ya ser√° del 15%, lo que no es bueno.  Esto necesita ser arreglado. <br><br><img src="https://habrastorage.org/webt/-k/9x/yf/-k9xyfgw5atqxwbfgsoz4hwdzpo.jpeg"><br><br>  Esto se arregla como est√°ndar.  La ilustraci√≥n ilustra la vida sin Pacer y la vida con <strong>Pacer</strong> . <br><br>  Pacer es tal cosa que distribuye paquetes a tiempo y controla su p√©rdida;  Analiza qu√© es la p√©rdida de paquetes ahora, dependiendo de esto, se adapta a la velocidad del canal. <br><br>  Como recordamos, para las redes m√≥viles, la p√©rdida de paquetes del 1-3% es la norma.  En consecuencia, de alguna manera debemos trabajar con esto.  ¬øQu√© pasa si perdemos paquetes? <br><br><h3>  Retransmitir </h3><br><img src="https://habrastorage.org/webt/rm/6c/sn/rm6csnnevyp8uer3y_88usgnxvi.jpeg"><br><br>  En TCP, como saben, hay un algoritmo de retransmisi√≥n r√°pido: enviamos un paquete, el segundo, si el paquete se pierde, luego de un tiempo (per√≠odo de retransmisi√≥n) enviamos el mismo paquete. <br><br>  Cuales son las ventajas?  Sin problemas, sin redundancia, pero hay un punto negativo: algunos <strong>per√≠odos de retransmisi√≥n</strong> . <br><br><img src="https://habrastorage.org/webt/wa/91/8x/wa918xscu2p_r9dym0hxtexa-te.jpeg"><br><br>  Parece ser muy simple: despu√©s de un tiempo, debe repetir el paquete si no ha recibido la confirmaci√≥n.  L√≥gicamente, este puede ser un tiempo igual al tiempo de ping.  ping ‚Äî    ,      RTT time ,   ,   . <br><br>  ,    , ,   ,  jitter:       ping-. ,   ,    46 .     jitter ‚Äî 50. <br><br><img src="https://habrastorage.org/webt/tc/ut/qp/tcutqprunmcey5nsfas7jobk1ju.jpeg"><br><br>        .   RTT   ,      ,  acknowledge      .  ,  RFC6298,   TCP ,     . <br><br>     jitter.     jitter  ping  15%. ,  retransmit period  ,  ,  20% ,  RTT. <br><br><img src="https://habrastorage.org/webt/ro/0f/ut/ro0futlozzfwqp7frtgd4-26ufg.jpeg"><br><br>     retransmit.       acknowledge   .    ,  ,    .    retransmit period,       .    ,      . <br><br>       ,   retransmit   .   , , packet loss 5%,    400 ,   400    1      packet-drop,  ,    retransmit period  ,      . <br><br>    ,   .    , ,    acknowledge   . ,   ‚Äî   ,       ,  speculative retransmit   . <br><br>      retransmit,     . <br><br>      .  ,   <strong>Forward Error Correction</strong> ?      , , XOR.    ,       ,       . <br><br><img src="https://habrastorage.org/webt/zd/b1/pe/zdb1pedfxegynl5dx-m7qopdgqw.jpeg"><br><br>  Wow!     round trip,      . <br><br>  ,     ,   ?   XOR    ‚Äî ,   Reed-Solomon, Fountain codes  ..  :   K ,     N  ,   N   . <br><br>   ! <br><br> ,      ,     ,    Forward Error Correction    negative acknowledgement. <br><br><h3> NACK </h3><br><img src="https://habrastorage.org/webt/yy/6d/uv/yy6duvocxiqc43veskkksrfj7s0.jpeg"><br><br>     ,   parity protection (  )    ,    . <br><br>  NACK: <br><br><ul><li>   ,      negative acknowledgement,    . <br></li><li>    FEC. <br></li></ul><br> ,    : <br><br><ol><li>   , FEC + NACK; <br></li><li>   , Fast retransmit. <br></li></ol><br> ,    . <br><br><img src="https://habrastorage.org/webt/zs/tg/dr/zstgdrqijyhnsnbfx4xfpgfixa8.jpeg"><br><br> ,        ,   (  ).    , ,  11 ,     60-80 .  ,   ,   . <br><br>        6 . <br><br><img src="https://habrastorage.org/webt/7p/bm/1e/7pbm1elkbfopc4zogdohequo4zo.jpeg"><br><br>     ,    ,    .    ,    . , Wi-Fi  22    5 , 3G   34   8 . <br><br><img src="https://habrastorage.org/webt/-1/7_/sg/-17_sgwf_vd6x88lryeyqarozfq.jpeg"><br><br> :   ,    90% packet loss     10 ,     gap  25 ,     ‚Äî FEC + NACK  Fast retransmit? <br><br> , ,  ,  Google,     QUIC  2013 ,  Forward Error Correction  , ,     .   2015   . <br><br>           FEC + NACK,       . <br><br> ,   . <br><br><img src="https://habrastorage.org/webt/vo/vx/en/vovxendpcptrbqle5r-_dsphz7o.jpeg"><br><br>  ,    , c    : <br><br><ul><li> 1 / ; <br></li><li> 1% packet loss; <br></li><li> 300  RTT; <br></li><li> 1 000  ‚Äî   ; <br></li><li> 1 000    . <br></li></ul><br>        10 .   packet loss  1%    1 000   10.  ‚Äî    100   1 ‚Äî  ,        2 ,   . <br><br>     ,     .    500- ,      10 . <br><br>    : <br><br><ul><li>   500      Forward Error Correction.        ,     . <br></li><li>   NACK,   ,    . <br></li><li>      Fast Retransmit,           . <br></li></ul><br>  Forward Error Correction  ,       ‚Äî  gap      200-300     . <br><br><h3> Fast Retransmit </h3><br>   :  ,      10 ,    , ,    retransmit period ,     . <br><br><img src="https://habrastorage.org/webt/uf/8l/vu/uf8lvu8cm-golfpmgpng1rln25y.jpeg"><br><br>    ,  retransmit period     350 ,     packet gap ‚Äî 25-30 ,   100.  ,   ,  retransmit   ,         . <br><br>   ,       . <br><br><h3>   </h3><br>       UDP       ,    . <br><br><img src="https://habrastorage.org/webt/rh/lr/nf/rhlrnfukoaeiiy8vxnrku7qbopg.jpeg"><br><br>   ,     ,   p/b-.     .      ,      . <br><br>  ,      ,    ,     ,   , ,  0,5          . <br><br>  ,    ,       ,     ,    p/b,   ,       ,     . <br><br><h3> MTU </h3><br>  Como estamos escribiendo el protocolo nosotros mismos, tendremos que lidiar con la fragmentaci√≥n de IP.  Creo que mucha gente sabe sobre esto, pero por si acaso, te lo contar√© brevemente. <br><br><img src="https://habrastorage.org/webt/wy/wy/lt/wywyltg-bw2a3ypzpvmkpz1zcsw.jpeg"><br><br>  Tenemos un servidor, env√≠a algunos paquetes a la red, llegan al enrutador y, a su nivel, la MTU (unidad de transmisi√≥n m√°xima) se vuelve inferior al tama√±o del paquete que lleg√≥.  Divide el paquete en grande y peque√±o (aqu√≠ 1100 y 400 bytes) y lo env√≠a. <br><br>  En principio, no hay problema, todo se reunir√° en el cliente y funcionar√°.  Pero si perdemos 1 paquete, descartamos todos los paquetes, adem√°s obtenemos costos adicionales para los encabezados de paquetes.  Por lo tanto, si est√° escribiendo su protocolo, es ideal trabajar en la cantidad de MTU. <br><br>  <strong>¬øC√≥mo contarlo?</strong> <br><br>  De hecho, Google no se molesta, coloca alrededor de 1200 bytes en su QUIC y no lo selecciona, porque la fragmentaci√≥n de IP recopilar√° todos los paquetes. <br><br><img src="https://habrastorage.org/webt/lj/q0/eu/ljq0eutloqqgituniq6jhfodjwo.jpeg"><br><br>  Hacemos exactamente lo mismo: primero establecemos un tama√±o predeterminado y comenzamos a enviar paquetes, dejamos que los fragmente. <br><br>  Paralelamente, ejecute un subproceso separado y cree un socket con el indicador de prohibici√≥n de fragmentaci√≥n para todos los paquetes.  Si el enrutador encuentra dicho paquete y no puede fragmentar estos datos, lo descartar√° y posiblemente le enviar√° a trav√©s de ICMP que hay problemas, pero lo m√°s probable es que ICMP se cierre y esto no suceder√°.  Por lo tanto, simplemente, por ejemplo, intentamos enviar tres veces un paquete de cierto tama√±o en alg√∫n intervalo.  Si no alcanza, creemos que se supera la MTU y la reducimos a√∫n m√°s. <br><br>  Por lo tanto, al tener la MTU de la interfaz de Internet que est√° en el dispositivo, y alguna MTU m√≠nima, simplemente seleccionamos la MTU correcta mediante b√∫squeda unidimensional.  Despu√©s de eso, ajustamos el tama√±o del paquete en el protocolo. <br><br>  De hecho, a veces cambia.  Nos sorprendi√≥, pero en el proceso de cambiar Wi-Fi, etc. MTU est√° cambiando.  Es mejor no detener este proceso paralelo y corregir MTU de vez en cuando. <br><br><img src="https://habrastorage.org/webt/x5/db/hy/x5dbhy0sbgn990swfjmqp2s9z8w.jpeg"><br><br>  Mayor distribuci√≥n de MTU en el mundo.  Tenemos alrededor de 1100 bytes en el portal. <br><br><h3>  Cifrado </h3><br>  Dijimos que queremos gestionar opcionalmente el cifrado.  Hacemos la opci√≥n m√°s simple: Diffie-Hellman en curvas el√≠pticas.  Lo hacemos opcionalmente: encriptamos solo los paquetes de control y encabezados para que man-in-the-middle no pueda recibir la clave de transmisi√≥n, interceptarla, etc. <br><br><img src="https://habrastorage.org/webt/nn/sv/h3/nnsvh3c3wxoulkrg31ggc8kkvyg.jpeg"><br><br>  Si la transmisi√≥n es privada, tambi√©n podemos agregar cifrado de todos los datos. <br><br>  Los paquetes se cifran con AES-256 de forma independiente, por lo que la ca√≠da de paquetes no afecta el cifrado de paquetes adicionales. <br><br><h3>  Priorizaci√≥n </h3><br>  Recuerde, quer√≠amos m√°s priorizaci√≥n del protocolo. <br><br><img src="https://habrastorage.org/webt/cc/ob/hd/ccobhdbwn5xelxwurrvsz7rxttg.jpeg"><br><br>  Tenemos metadatos, marcos de audio y video, los enviamos con √©xito a la red.  Luego, nuestra red se incendia en el infierno y durante mucho tiempo no funciona: entendemos que necesitamos descartar paquetes. <br><br>  Principalmente descartamos los paquetes de video, luego tratamos de descartar el audio y nunca tocamos los paquetes de control, porque datos como cambios de resoluci√≥n y otros problemas importantes pueden pasar por ellos. <br><br><h3>  Bollo adicional sobre UDP </h3><br>  Si va a escribir su protocolo UDP, por ejemplo, con comunicaci√≥n bidireccional, debe comprender que existe NAT Unbinding y la posibilidad de que no pueda encontrar el cliente desde el servidor. <br><br><img src="https://habrastorage.org/webt/zs/my/ii/zsmyiips__dpgzghjbdeovvz_6g.jpeg"><br><br>  En la diapositiva, hay momentos en que no fue posible llegar al cliente desde el servidor a trav√©s de UDP. <br><br>  Muchos esc√©pticos dicen que los enrutadores est√°n dise√±ados de tal manera que NAT Unbinding principalmente desplaza las rutas UDP.  Pero lo anterior muestra que si Keep-Alive o ping son menos de 30 segundos, entonces con una probabilidad del 99% ser√° posible llegar al cliente. <br><br><h3>  Disponibilidad UDP en dispositivos m√≥viles en el mundo </h3><br><img src="https://habrastorage.org/webt/nt/mv/5u/ntmv5u_uv_pl1jdgabyewmmhk80.jpeg"><br><br>  Google dice que el 6%, pero result√≥ que el <strong>7% de los usuarios m√≥viles no pueden usar UDP</strong> .  En este caso, dejamos nuestro hermoso protocolo con priorizaci√≥n, cifrado y todo, solo en TCP. <br><br>  En UDP, VOIP ahora funciona en WebRTC, Google QUIC, y muchos juegos funcionan en UDP.  Por lo tanto, no creo que UDP se cierre en dispositivos m√≥viles. <br><br>  Como resultado, nosotros: <br><br><ul><li>  Reducido el retraso entre el streamer y el observador a 1 s. <br></li><li>  Eliminamos el efecto acumulativo en los buffers, es decir, la transmisi√≥n no se queda atr√°s. <br></li><li>  El n√∫mero de <strong>puestos</strong> en la audiencia ha <strong>disminuido</strong> . <br></li><li>  Pudieron soportar la transmisi√≥n en dispositivos m√≥viles FullHD. <br></li></ul><br><img src="https://habrastorage.org/webt/im/ql/le/imqlle87zr_gdvhaflkcxe-25_q.jpeg"><br><ul><li>  El retraso en nuestra aplicaci√≥n m√≥vil OK Live es de 25 ms - 10 ms m√°s largo que el esc√°ner de la c√°mara, pero no da tanto miedo. <br></li><li>  La transmisi√≥n por Internet muestra un retraso de solo 690 ms - ¬°espacio! <br></li></ul><br><h2>  ¬øQu√© m√°s se puede transmitir en Odnoklassniki? </h2><img src="https://habrastorage.org/webt/le/zu/zc/lezuzc64qct36iohbnoyukuab8o.jpeg"><br><br><ul><li>  Acepta nuestro protocolo OKMP desde dispositivos m√≥viles; <br></li><li>  puede aceptar RTMP y WebRTC; <br></li><li>  distribuye HLS, MPEG-Dash, etc. <br></li></ul><br>  Si tuvo cuidado, not√≥ que dije que podemos tomar, por ejemplo, WebRTC del usuario y convertirlo a RTMP. <br><br><img src="https://habrastorage.org/webt/me/hc/3c/mehc3cteyxhn2hcsrjd1vmx9z_y.jpeg"><br><br>  Hay un matiz.  De hecho, WebRTC es un protocolo orientado a paquetes y utiliza el c√≥dec de audio OPUS.  No puede usar OPUS en RTMP. <br><br>  En los servidores de back-end, utilizamos RTMP en todas partes.  Por lo tanto, tuvimos que hacer algunas correcciones m√°s en FF MPEG, lo que nos permite empujar OPUS a RTMP, convertirlo a AAC y d√°rselo a los usuarios que ya est√°n en HLS o algo m√°s. <br><br><h2>  ¬øC√≥mo se ve dentro de nosotros? </h2><img src="https://habrastorage.org/webt/v_/s2/z4/v_s2z4ja4xlfcuacadyelfpcdj0.jpeg"><br><br><ul><li>  Los usuarios que utilizan uno de los protocolos cargan el video original en nuestro servidor de carga. <br></li><li>  All√≠ implementamos el protocolo. <br></li><li>  Enviamos RTMP a uno de los servidores de transformaci√≥n de video. <br></li><li>  El original siempre se almacena en un almacenamiento distribuido para que no se pierda nada. <br></li><li>  Despu√©s de eso, todos los videos van al servidor de distribuci√≥n. <br></li></ul><br>  Para el hierro, tenemos lo siguiente: <br><br><img src="https://habrastorage.org/webt/hb/zc/nl/hbzcnl6smz5tevhx5ud_phg0m0q.jpeg"><br>  Te contar√© un poco m√°s sobre la tolerancia a fallas: <br><br><ul><li>  Los servidores de carga se distribuyen en diferentes centros de datos, respaldan diferentes IP. <br></li><li>  Los usuarios vienen, reciben IP en DNS. <br></li><li>  El servidor de carga env√≠a el video a los servidores de corte, ellos cortan y entregan a los servidores de distribuci√≥n. <br></li><li>  Para transmisiones m√°s populares, comenzamos a agregar una mayor cantidad de servidores de distribuci√≥n. <br></li><li>  Guardamos todo lo que vino del usuario en el repositorio, para que luego podamos crear un archivo de difusi√≥n y no perder nada. <br></li><li>  Almacenamiento tolerante a fallas distribuido en tres centros de datos. <br></li></ul><br>  Para determinar qu√© servidor es actualmente responsable de la traducci√≥n, utilizamos <strong>ZooKeeper</strong> .  Para cada traducci√≥n, almacenamos un nodo y hacemos nodos ef√≠meros para cada servidor.  De hecho, esto es lo que permite que una secuencia cree una cola de servidores que procesar√°.  Siempre el l√≠der actual en esta l√≠nea est√° involucrado en el procesamiento de flujo. <br><br>  Probaremos la tolerancia a fallas r√°pidamente.  Comenzamos de inmediato con la desaparici√≥n de todo el centro de datos. <br><br>  <strong>Que va a pasar</strong> <br><br><ul><li>  El usuario DNS tomar√° la siguiente IP de otro servidor de carga. <br></li><li>  En este momento, ZooKeeper comprender√° que el servidor en ese centro de datos ha muerto y seleccionar√° el servidor de corte para otro. <br></li><li>  Los servidores de descarga descubrir√°n qui√©n es ahora responsable de la transformaci√≥n de esta transmisi√≥n y la distribuir√°n. <br></li></ul><br>  En principio, todo esto suceder√° con retrasos m√≠nimos. <br><br><h2>  Usando el protocolo en el producto </h2>  Creamos la aplicaci√≥n m√≥vil OK Live streaming.  Est√° completamente integrado con el portal.  Los usuarios all√≠ pueden comunicarse, realizar transmisiones en vivo, hay un mapa de transmisiones, una lista de transmisiones populares, en general, todo lo que pueda desear. <br><br><img src="https://habrastorage.org/webt/kz/4n/on/kz4nonh4fuveoh5iilwwhipapl8.jpeg"><br><br>  Tambi√©n agregamos la capacidad de transmitir en FullHD.  Puede conectar una c√°mara de acci√≥n en Android a un dispositivo Android. <br><br><img src="https://habrastorage.org/webt/pi/ut/ga/piutgamml44x_nzqt41dlg3t9za.jpeg"><br><br>  Ahora tenemos un mecanismo que permite transmisiones en vivo.  Por ejemplo, trazamos una l√≠nea directa con el Presidente a trav√©s de OK Live y la transmitimos a <strong>todo el pa√≠s</strong> .  Los usuarios observados y a trav√©s de la transmisi√≥n entrante podr√≠an salir al aire y hacer sus preguntas. <br><br>  Es decir, de hecho, dos transmisiones entrantes con un retraso m√≠nimo proporcionan un cierto formato de conferencia p√∫blica. <br><br>  De hecho, nos encontramos en alg√∫n lugar en 2 segundos, un segundo all√≠ y otro segundo.  Recuerda ese "carro" del que habl√© al principio del art√≠culo, ahora se parece a 2 enormes camiones.  Para la transmisi√≥n de TV, eliminar de la c√°mara y simplemente mezclar todo con un retraso de aproximadamente 1-2 s es completamente normal. <br><br>  De hecho, logramos reproducir algo comparable con el TCP moderno actual. <br><br><img src="https://habrastorage.org/webt/si/io/dg/siiodgw1g17mn3b1jt8270ezuo8.jpeg"><br><br>  Las transmisiones en vivo son la tendencia actual.  Durante el √∫ltimo a√±o y medio en el portal OK, se han triplicado (no sin la ayuda de la aplicaci√≥n OK Live). <br><br><img src="https://habrastorage.org/webt/lx/sa/4w/lxsa4wk6ltmz8xefbsunlfbqjrq.jpeg"><br><br>  Todas las transmisiones se graban por defecto.  Tenemos alrededor de 50 mil transmisiones por d√≠a, esto genera alrededor de 17 terabytes de tr√°fico por d√≠a, pero en general todo el video en el portal genera aproximadamente un petabyte de datos por mes. <br><br><img src="https://habrastorage.org/webt/zg/n3/h6/zgn3h616zrtpcyw7dkgpuwconp4.jpeg"><br><br>  ¬øQu√© obtuvimos? <br><br><ul><li>  Podr√≠a garantizar la duraci√≥n de la demora entre el transmisor y la audiencia. <br></li><li>  Creamos la primera aplicaci√≥n m√≥vil FullHD para transmitir en un canal de Internet m√≥vil que cambia din√°micamente. <br></li><li>  Tenemos la oportunidad de perder centros de datos y al mismo tiempo no interrumpir la transmisi√≥n. <br></li></ul><br>  ¬øQu√© aprendiste? <br><br><ul><li>  Qu√© es el video y c√≥mo transmitirlo. <br></li><li>  Que puede escribir su protocolo UDP si sabe con certeza que tiene una tarea muy espec√≠fica y usuarios espec√≠ficos. <br></li><li>  Acerca de la arquitectura de cualquier servicio de transmisi√≥n: el video ingresa a la entrada, se convierte y sale. <br></li></ul><br><blockquote>  En <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Highload ++ Siberia,</a> Alexander Tobol promete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hablar</a> sobre el servicio de llamadas OK, ser√° interesante saber qu√© se logr√≥ aplicar a partir de lo que se discuti√≥ en este art√≠culo y qu√© tuvo que implementarse nuevamente. <br><br>  En la misma secci√≥n, se planean informes sobre temas altamente especializados: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Eugene Rossinsky</a> (ivi) en el sistema para recopilar estad√≠sticas detalladas sobre el funcionamiento de los nodos CDN. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Anton Rusakova</a> (Badoo) sobre la integraci√≥n de sistemas de pago sin utilizar su propia facturaci√≥n. <br></li></ul><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413479/">https://habr.com/ru/post/es413479/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413465/index.html">AMD anuncia Threadripper 2 de 32 n√∫cleos</a></li>
<li><a href="../es413467/index.html">Copia de seguridad de datos r√°pida y confiable en la nube</a></li>
<li><a href="../es413469/index.html">Una prueba de memoria que mata computadoras port√°tiles es casi una historia de detectives</a></li>
<li><a href="../es413471/index.html">Viernes Mini Tomy Fancy Toy Retrospectiva</a></li>
<li><a href="../es413473/index.html">Desarrollo de un interruptor t√°ctil Z-Wave en la bater√≠a con botones luminosos.</a></li>
<li><a href="../es413481/index.html">Exportar √°rbol de prueba de JMeter a texto</a></li>
<li><a href="../es413485/index.html">Lanzamiento de GitLab 10.8: duplicaci√≥n de inserci√≥n de c√≥digo abierto e implementaci√≥n incremental</a></li>
<li><a href="../es413487/index.html">¬øQu√© debe esperar un desarrollador en el campo de las finanzas: condiciones de trabajo, proyectos y habilidades necesarias?</a></li>
<li><a href="../es413489/index.html">C√≥mo elegir un mensajero verdaderamente seguro y qu√© tiene que ver la cadena de bloques con √©l</a></li>
<li><a href="../es413491/index.html">Food Design Digest, mayo de 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>