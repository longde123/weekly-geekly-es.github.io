<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥üèª ‚ùé üåπ Kontinuierliche Cloud-Infrastruktur üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ üåÄ üèùÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine Demonstration der Verwendung von Open Source-Tools wie Packer und Terraform, um kontinuierlich Infrastruktur√§nderungen an den bevorzugten Cloud-U...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kontinuierliche Cloud-Infrastruktur</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/420661/"> Eine Demonstration der Verwendung von Open Source-Tools wie Packer und Terraform, um kontinuierlich Infrastruktur√§nderungen an den bevorzugten Cloud-Umgebungen der Benutzer bereitzustellen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/FJvl13EYtBU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Das Material basiert auf einer Pr√§sentation von Paul Stack auf unserer Herbstkonferenz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DevOops</a> 2017. Paul ist ein Infrastrukturentwickler, der fr√ºher bei HashiCorp gearbeitet und an der Entwicklung von Tools mitgewirkt hat, die von Millionen von Menschen (z. B. Terraform) verwendet wurden.  Er spricht h√§ufig auf Konferenzen und vermittelt die Praxis von der Spitze der CI / CD-Implementierungen, den Prinzipien der ordnungsgem√§√üen Organisation des Betriebsteils, und kann klar erkl√§ren, warum Administratoren dies √ºberhaupt tun.  Der Rest des Artikels wird in der ersten Person erz√§hlt. <br><a name="habracut"></a><br>  Beginnen wir also gleich mit einigen wichtigen Erkenntnissen. <br><br><h3>  Lang laufender Server ist schei√üe </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/7f5/1dc/232/7f51dc232bf87288dc7f5c1bf7140a0d.jpg"><br><br>  Ich habe zuvor in einer Organisation gearbeitet, in der wir 2008 Windows Server 2003 bereitgestellt haben, und heute sind sie noch in Produktion.  Und ein solches Unternehmen ist nicht allein.  √úber den Remotedesktop auf diesen Servern installieren sie die Software manuell und laden Bin√§rdateien aus dem Internet herunter.  Dies ist eine sehr schlechte Idee, da die Server nicht typisch sind.  Sie k√∂nnen nicht garantieren, dass in der Produktion dasselbe passiert wie in Ihrer Entwicklungsumgebung, in der Zwischenumgebung, in der QS-Umgebung. <br><br><h3>  Unver√§nderliche Infrastruktur </h3><br>  Im Jahr 2013 erschien auf Chad Foilers Blog ein Artikel mit dem Titel ‚ÄûWirf deine Server und brenne deinen Code: unver√§nderliche Infrastruktur und Einwegkomponenten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚Äú</a> (Chad Foiler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚Äû</a> Mach <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">deine Server</a> kaputt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">und brenne deinen Code: Unver√§nderliche Infrastruktur und</a> Einwegkomponenten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚Äú</a> ).  Dies ist meistens ein Gespr√§ch dar√ºber, dass unver√§nderliche Infrastruktur der Weg in die Zukunft ist.  Wir haben die Infrastruktur geschaffen, und wenn wir sie √§ndern m√ºssen, schaffen wir eine neue Infrastruktur.  Dieser Ansatz ist in der Cloud sehr verbreitet, da er hier schnell und g√ºnstig ist.  Wenn Sie physische Rechenzentren haben, ist dies etwas schwieriger.  Wenn Sie die Virtualisierung von Rechenzentren ausf√ºhren, wird es nat√ºrlich einfacher.  Wenn Sie jedoch jedes Mal physische Server starten, dauert die Eingabe eines neuen Servers etwas l√§nger als die √Ñnderung eines vorhandenen. <br><br><h3>  Einweginfrastruktur </h3><br>  Laut funktionalen Programmierern ist ‚Äûunver√§nderlich‚Äú der falsche Begriff f√ºr dieses Ph√§nomen.  Denn um wirklich unver√§nderlich zu sein, ben√∂tigt Ihre Infrastruktur ein schreibgesch√ºtztes Dateisystem: Es werden keine Dateien lokal geschrieben, niemand kann SSH oder RDP usw. verwenden.  Somit scheint die Infrastruktur tats√§chlich nicht unver√§nderlich zu sein. <br><br>  Die Terminologie wurde sechs oder sogar acht Tage lang von mehreren Personen auf Twitter diskutiert.  Am Ende waren sie sich einig, dass eine ‚Äûeinmalige Infrastruktur‚Äú eine geeignetere Formulierung ist.  Wenn der Lebenszyklus der ‚Äûeinmaligen Infrastruktur‚Äú endet, kann er leicht zerst√∂rt werden.  Sie m√ºssen sich nicht daran festhalten. <br><br>  Ich werde eine Analogie geben.  Farmk√ºhe gelten im Allgemeinen nicht als Haustiere. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/be9/a17/baf/be9a17baf223a45e34c63684197cc2ce.png"><br><br>  Wenn Sie Rinder auf der Farm haben, geben Sie ihnen keine individuellen Namen.  Jede Person hat eine Nummer und ein Etikett.  So ist es auch mit Servern.  Wenn Sie 2006 noch manuell Server in der Produktion erstellt haben, haben diese signifikante Namen, z. B. "SQL-Datenbank in Produktion 01".  Und sie haben eine ganz bestimmte Bedeutung.  Und wenn einer der Server abst√ºrzt, beginnt die H√∂lle. <br><br>  Wenn eines der Tiere in der Herde stirbt, kauft der Bauer einfach ein neues.  Dies ist die "einmalige Infrastruktur". <br><br><h3>  Kontinuierliche Lieferung </h3><br>  Wie kombinieren Sie dies mit Continuous Delivery? <br>  Alles, wor√ºber ich jetzt spreche, gibt es schon seit einiger Zeit.  Ich versuche nur, die Ideen der Infrastrukturentwicklung und der Softwareentwicklung zu kombinieren. <br><br>  Softwareentwickler setzen sich seit langem f√ºr eine kontinuierliche Bereitstellung und Integration ein.  Zum Beispiel schrieb Martin Fowler Anfang der 2000er Jahre in seinem Blog √ºber kontinuierliche Integration.  Jez Humble f√∂rdert seit langem die kontinuierliche Lieferung. <br><br>  Bei n√§herer Betrachtung wird nichts speziell f√ºr den Quellcode der Software erstellt.  Es gibt eine Standarddefinition von Wikipedia: <i>Continuous Delivery ist eine Reihe von Praktiken und Prinzipien, die darauf abzielen, Software so schnell wie m√∂glich zu erstellen, zu testen und freizugeben</i> . <br><br>  Die Definition bedeutet nicht Webanwendungen oder APIs, sondern Software im Allgemeinen.  Das Erstellen einer Puzzlesoftware erfordert viele Puzzleteile.  Auf diese Weise k√∂nnen Sie auf die gleiche Weise die kontinuierliche Bereitstellung von Infrastrukturcode √ºben. <br><br>  Die Entwicklung von Infrastruktur und Anwendungen ist ziemlich eng.  Und Leute, die Anwendungscode schreiben, schreiben auch Infrastrukturcode (und umgekehrt).  Diese Welten beginnen sich zu vereinen.  Es gibt keine solche Trennung mehr und die spezifischen Fallen jeder der Welten. <br><br><h3>  Grunds√§tze und Praktiken f√ºr die kontinuierliche Lieferung </h3><br>  Kontinuierliche Lieferung hat eine Reihe von Prinzipien: <br><br><ul><li>  Der Software-Release- / Bereitstellungsprozess muss wiederholbar und zuverl√§ssig sein. <br></li><li>  Alles automatisieren! <br></li><li>  Wenn ein Eingriff schwierig oder schmerzhaft ist, tun Sie es √∂fter. <br></li><li>  Behalten Sie alles in der Quellcodeverwaltung. <br></li><li>  Fertig - bedeutet "unver√∂ffentlicht". <br></li><li>  Arbeit mit Qualit√§t verbinden! <br></li><li>  Jeder ist f√ºr den Release-Prozess verantwortlich. <br></li><li>  Erh√∂hen Sie die Kontinuit√§t. <br></li></ul><br>  Noch wichtiger ist jedoch, dass die kontinuierliche Lieferung vier Praktiken umfasst.  Nehmen Sie sie und √ºbertragen Sie sie direkt in die Infrastruktur: <br><br><ul><li>  Erstellen Sie Bin√§rdateien nur einmal.  Erstellen Sie Ihren Server einmal.  Hier geht es von Anfang an um ‚ÄûVerf√ºgbarkeit‚Äú. <br></li><li>  Verwenden Sie in jeder Umgebung denselben Bereitstellungsmechanismus.  √úben Sie keine unterschiedlichen Bereitstellungen in Entwicklung und Produktion.  Sie m√ºssen in jeder Umgebung denselben Pfad verwenden.  Es ist sehr wichtig. <br></li><li>  Testen Sie Ihre Bereitstellung.  Ich habe viele Anwendungen erstellt.  Ich habe viele Probleme verursacht, weil ich den Bereitstellungsmechanismus nicht befolgt habe.  Sie sollten immer √ºberpr√ºfen, was passiert.  Und ich sage nicht, dass Sie f√ºnf oder sechs Stunden f√ºr gro√ü angelegte Tests aufwenden sollten.  Genug "Rauchtest".  Sie haben einen wichtigen Teil des Systems, mit dem Sie und Ihr Unternehmen bekanntlich Geld verdienen k√∂nnen.  Seien Sie nicht zu faul, um mit dem Testen zu beginnen.  Wenn Sie dies nicht tun, kann es zu Unterbrechungen kommen, die Ihr Unternehmen Geld kosten. <br></li><li>  Und schlie√ülich das Wichtigste.  Wenn etwas kaputt geht, halten Sie an und reparieren Sie es sofort!  Sie k√∂nnen nicht zulassen, dass das Problem w√§chst und immer schlimmer wird.  Sie m√ºssen es reparieren.  Das ist wirklich wichtig. <br></li></ul><br>  Hat jemand das Buch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Continuous Delivery</a> gelesen? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cad/9eb/b6f/cad9ebb6f6c3562724d78ef5a0454e7e.png"><br><br>  Ich bin sicher, Ihre Unternehmen werden Ihnen eine Kopie bezahlen, die Sie innerhalb des Teams √ºbertragen k√∂nnen.  Ich sage nicht, dass Sie sich hinsetzen und einen Tag frei haben sollten, um es zu lesen.  Wenn Sie dies tun, m√∂chten Sie wahrscheinlich die IT beenden.  Ich empfehle jedoch, regelm√§√üig kleine Teile des Buches zu beherrschen, sie zu verarbeiten und dar√ºber nachzudenken, wie Sie dies auf Ihre Umgebung, Ihre Kultur und Ihren Prozess √ºbertragen k√∂nnen.  Ein kleines St√ºck nach dem anderen.  Denn kontinuierliche Versorgung ist ein Gespr√§ch √ºber kontinuierliche Verbesserung.  Es ist nicht einfach, sich mit Kollegen und dem Chef ins B√ºro zu setzen und ein Gespr√§ch mit der Frage zu beginnen: ‚ÄûWie implementieren wir die kontinuierliche Lieferung?‚Äú. Schreiben Sie dann 10 Dinge an die Tafel und verstehen Sie nach 10 Tagen, dass Sie sie implementiert haben.  Dies nimmt viel Zeit in Anspruch, verursacht viele Proteste, weil sich mit der Einf√ºhrung der Kultur Ver√§nderungen ergeben. <br><br>  Heute werden wir zwei Tools verwenden: Terraform und Packer (beide sind Hashicorp-Entwicklungen).  In einer weiteren Diskussion geht es darum, warum wir Terraform verwenden sollten und wie wir es in unsere Umgebung integrieren k√∂nnen.  Es ist kein Zufall, dass ich √ºber diese beiden Tools spreche.  Bis vor kurzem habe ich auch bei Hashicorp gearbeitet.  Aber selbst nachdem ich Hashicorp verlassen habe, trage ich immer noch zum Code dieser Tools bei, weil ich sie tats√§chlich sehr n√ºtzlich finde. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d0/4b0/807/5d04b08076e6d28da7cc17589d79de6d.png"><br><br>  Terraform unterst√ºtzt die Interaktion mit Anbietern.  Anbieter sind Clouds, Saas-Dienste usw. <br><br>  Innerhalb jedes Cloud-Dienstanbieters gibt es mehrere Ressourcen, z. B. ein Subnetz, eine VPC, einen Load Balancer usw. Mit DSL (dom√§nenspezifische Sprache) teilen Sie Terraform mit, wie Ihre Infrastruktur aussehen wird. <br><br>  Terraform verwendet die Graphentheorie. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c7/142/7d2/1c71427d2d18431acfe78d79797f9948.png"><br><br>  Sie kennen wahrscheinlich die Graphentheorie.  Knoten sind Teile unserer Infrastruktur, z. B. ein Load Balancer, ein Subnetz oder eine VPC.  Rippen sind die Beziehungen zwischen diesen Systemen.  Dies ist alles, was ich pers√∂nlich f√ºr notwendig halte, um etwas √ºber die Graphentheorie zu wissen, um Terraform verwenden zu k√∂nnen.  Den Rest √ºberlassen wir den Experten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8de/db7/fe6/8dedb7fe6a72bd36d371f3576e841cfa.png"><br><br>  Terraform verwendet tats√§chlich einen gerichteten Graphen, da es nicht nur die Beziehungen, sondern auch deren Reihenfolge kennt: A (angenommen, A ist VPC) muss auf B gesetzt werden, das ein Subnetz ist.  Und B muss vor C (Instanz) erstellt werden, da es ein vorgeschriebenes Verfahren zum Erstellen von Abstraktionen in Amazon oder einer anderen Cloud gibt. <br>  Weitere Informationen zu diesem Thema finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">YouTube von</a> Paul Hinze, der noch immer Infrastrukturdirektor bei Hashicorp ist.  Als Referenz - ein gro√üartiges Gespr√§ch √ºber Infrastruktur und Graphentheorie. <br><br><h3>  √úbe </h3><br>  Einen Code zu schreiben ist viel besser als eine Theorie zu diskutieren. <br><br>  Ich habe zuvor AMI (Amazon Machine Images) erstellt.  Ich benutze Packer, um sie zu erstellen und werde Ihnen zeigen, wie es geht. <br><br>  AMI ist eine Instanz eines virtuellen Servers in Amazon. Sie ist vordefiniert (in Bezug auf Konfiguration, Anwendungen usw.) und wird aus einem Image erstellt.  Ich finde es toll, dass ich neue AMIs erstellen kann.  AMIs sind im Wesentlichen meine Docker-Container. <br><br>  Also, ich habe AMI, sie haben einen Ausweis.  Wenn wir zur Amazon-Oberfl√§che gehen, sehen wir, dass wir nur einen AMI haben und nichts weiter: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4cb/b65/563/4cbb65563af0eea258e8c5cdc936a318.png"><br><br>  Ich kann Ihnen zeigen, was in diesem AMI steckt.  Alles ist sehr einfach. <br><br>  Ich habe eine JSON-Dateivorlage: <br><br><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"variables"</span></span>: { <span class="hljs-string"><span class="hljs-string">"source_ami"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"region"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }, <span class="hljs-string"><span class="hljs-string">"builders"</span></span>: [{ <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"amazon-ebs"</span></span>, <span class="hljs-string"><span class="hljs-string">"region"</span></span>: <span class="hljs-string"><span class="hljs-string">"{{user 'region'}}"</span></span>, <span class="hljs-string"><span class="hljs-string">"source_ami"</span></span>: <span class="hljs-string"><span class="hljs-string">"{{user 'source_ami'}}"</span></span>, <span class="hljs-string"><span class="hljs-string">"ssh_pty"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"instance_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"t2.micro"</span></span>, <span class="hljs-string"><span class="hljs-string">"ssh_username"</span></span>: <span class="hljs-string"><span class="hljs-string">"ubuntu"</span></span>, <span class="hljs-string"><span class="hljs-string">"ssh_timeout"</span></span>: <span class="hljs-string"><span class="hljs-string">"5m"</span></span>, <span class="hljs-string"><span class="hljs-string">"associate_public_ip_address"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"ami_virtualization_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"hvm"</span></span>, <span class="hljs-string"><span class="hljs-string">"ami_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"application_instance-{{isotime \"2006-01-02-1504\"}}"</span></span>, <span class="hljs-string"><span class="hljs-string">"tags"</span></span>: { <span class="hljs-string"><span class="hljs-string">"Version"</span></span>: <span class="hljs-string"><span class="hljs-string">"{{user 'version'}}"</span></span> } }], <span class="hljs-string"><span class="hljs-string">"provisioners"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"shell"</span></span>, <span class="hljs-string"><span class="hljs-string">"start_retry_timeout"</span></span>: <span class="hljs-string"><span class="hljs-string">"10m"</span></span>, <span class="hljs-string"><span class="hljs-string">"inline"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"sudo apt-get update -y"</span></span>, <span class="hljs-string"><span class="hljs-string">"sudo apt-get install -y ntp nginx"</span></span> ] }, { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"file"</span></span>, <span class="hljs-string"><span class="hljs-string">"source"</span></span>: <span class="hljs-string"><span class="hljs-string">"application-files/nginx.conf"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span>: <span class="hljs-string"><span class="hljs-string">"/tmp/nginx.conf"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"file"</span></span>, <span class="hljs-string"><span class="hljs-string">"source"</span></span>: <span class="hljs-string"><span class="hljs-string">"application-files/index.html"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span>: <span class="hljs-string"><span class="hljs-string">"/tmp/index.html"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"shell"</span></span>, <span class="hljs-string"><span class="hljs-string">"start_retry_timeout"</span></span>: <span class="hljs-string"><span class="hljs-string">"5m"</span></span>, <span class="hljs-string"><span class="hljs-string">"inline"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"sudo mkdir -p /usr/share/nginx/html"</span></span>, <span class="hljs-string"><span class="hljs-string">"sudo mv /tmp/index.html /usr/share/nginx/html/index.html"</span></span>, <span class="hljs-string"><span class="hljs-string">"sudo mv /tmp/nginx.conf /etc/nginx/nginx.conf"</span></span>, <span class="hljs-string"><span class="hljs-string">"sudo systemctl enable nginx.service"</span></span> ] } ] }</code> </pre> <br>  Wir haben Variablen, die wir √ºbergeben, und Packer hat eine Liste sogenannter Builder f√ºr verschiedene Bereiche.  es gibt viele von ihnen.  Builder verwendet eine spezielle AMI-Quelle, die ich in einer AMI-ID √ºbergebe.  Ich gebe ihm den SSH-Benutzernamen und das Passwort und gebe an, ob er eine √∂ffentliche IP-Adresse ben√∂tigt, damit die Leute von au√üen darauf zugreifen k√∂nnen.  In unserem Fall spielt dies keine Rolle, da es sich um eine AWS-Instanz f√ºr Packer handelt. <br>  Wir setzen auch den AMI-Namen und die Tags. <br><br>  Sie m√ºssen diesen Code nicht analysieren.  Er ist nur hier, um Ihnen zu zeigen, wie er arbeitet.  Der wichtigste Teil hier ist die Version.  Es wird sp√§ter relevant, wenn wir Terraform betreten. <br><br>  Nachdem der Builder die Instanz aufgerufen hat, werden die Bereitstellungsagenten darauf gestartet.  Ich installiere tats√§chlich NCP und Nginx, um Ihnen zu zeigen, was ich hier tun kann.  Ich kopiere einige Dateien und richte einfach die Nginx-Konfiguration ein.  Alles ist sehr einfach.  Dann aktiviere ich nginx so, dass es startet, wenn die Instanz startet. <br><br>  Ich habe also einen Anwendungsserver und es funktioniert.  Ich kann es in Zukunft verwenden.  Ich √ºberpr√ºfe jedoch immer meine Packer-Vorlagen.  Da es sich um eine JSON-Konfiguration handelt, bei der m√∂glicherweise Probleme auftreten. <br>  Dazu f√ºhre ich den folgenden Befehl aus: <br><br> <code>make validate <br></code> <br>  Ich erhalte die Antwort, dass die Packer-Vorlage erfolgreich √ºberpr√ºft wurde: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f0/aa3/1a7/2f0aa31a768c26246877688d0c81cc9e.png"><br><br>  Dies ist nur ein Befehl, damit ich ihn mit dem CI-Tool (jedem) verbinden kann.  Tats√§chlich handelt es sich um einen Prozess: Wenn der Entwickler die Vorlage √§ndert, wird die Pull-Anforderung generiert, das CI-Tool √ºberpr√ºft die Anforderung, f√ºhrt das √Ñquivalent zur √úberpr√ºfung der Vorlage durch und ver√∂ffentlicht die Vorlage bei erfolgreicher √úberpr√ºfung.  All dies kann im "Master" kombiniert werden. <br>  Wir erhalten einen Stream f√ºr AMI-Vorlagen - Sie m√ºssen nur die Version erh√∂hen. <br><br>  Angenommen, der Entwickler hat eine neue Version von AMI erstellt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc9/3b9/546/dc93b95464ccf7b7e6fbe959d4a5ddf0.png"><br><br>  Ich werde nur die Version in den Dateien von 1.0.0 bis 1.0.1 korrigieren, um Ihnen den Unterschied zu zeigen: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tittle</span></span></span><span class="hljs-tag">&gt;</span></span>Welcome to DevOops!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tittle</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Welcome!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Welcome to DevOops!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Version: 1.0.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Ich werde zur Befehlszeile zur√ºckkehren und mit der Erstellung von AMI beginnen. <br>  Ich mag es nicht, die gleichen Teams zu leiten.  Ich mag es, AMI schnell zu erstellen, also benutze ich Makefiles.  Werfen wir einen Blick mit <code>cat</code> in meinem Makefile: <br><br> <code>cat Makefile <br></code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/163/0e4/bea/1630e4bea410b10ffcbb5fce2a27d595.png"><br><br>  Das ist mein Makefile.  Ich habe sogar Hilfe bereitgestellt: Ich tippe <code>make</code> und klicke auf die Registerkarte. Daraufhin werden alle Ziele angezeigt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/74d/cbb/611/74dcbb6110c7350483735a0f96d9fe90.png"><br><br>  Also werden wir eine neue AMI Version 1.0.1 erstellen. <br><br> <code>make ami <br></code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/879/16c/482/87916c482f6410c8a2fc73c150308409.png"><br><br>  Zur√ºck zu Terraform. <br><br>  Ich betone, dass dies kein Produktionscode ist.  Dies ist eine Demonstration.  Es gibt M√∂glichkeiten, dasselbe besser zu machen. <br><br>  Ich benutze √ºberall Terraform-Module.  Da ich nicht mehr an Hashicorp arbeite, kann ich meine Meinung zu den Modulen √§u√üern.  F√ºr mich befinden sich die Module auf der Kapselungsebene.  Zum Beispiel m√∂chte ich alles zusammenfassen, was mit VPC zu tun hat: Netzwerke, Subnetze, Routing-Tabellen usw. <br><br>  Was ist drinnen los?  Entwickler, die damit arbeiten, interessieren sich m√∂glicherweise nicht daf√ºr.  Sie m√ºssen ein grundlegendes Verst√§ndnis daf√ºr haben, wie die Cloud funktioniert und was VPC ist.  Es ist jedoch nicht notwendig, sich mit den Details zu befassen.  Nur Leute, die ein Modul wirklich √§ndern m√ºssen, sollten es verstehen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a8/90c/b85/1a890cb85c3fb6a6580e8b6a25492f4f.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/177/a14/a24/177a14a241d80ee6bcc2cf64f194ce4e.png"><br><br>  Hier werde ich eine AWS-Ressource und ein VPC-Modul erstellen.  Was ist hier los?  Nehmen Sie <code>cidr_block</code> obersten Ebene und erstellen Sie drei private und drei √∂ffentliche Subnetze.  Das Folgende ist eine Liste von acailability_zones.  Wir wissen jedoch nicht, um welche Zug√§nglichkeitszonen es sich handelt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26b/ec1/4ea/26bec14eab18a025c33c2a871c4d3ed4.png"><br><br>  Wir werden ein VPN erstellen.  Verwenden Sie dieses VPN-Modul einfach nicht.  Dies ist openVPN, mit dem eine AWS-Instanz ohne Zertifikat erstellt wird.  Es verwendet nur die √∂ffentliche IP-Adresse und wird hier nur erw√§hnt, um Ihnen zu zeigen, dass wir eine Verbindung zum VPN herstellen k√∂nnen.  Es gibt bequemere Tools zum Erstellen eines VPN.  Ich brauchte ungef√§hr 20 Minuten und zwei Biere, um meine eigenen zu schreiben. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae3/a5f/8a6/ae3a5f8a6561b2b9f726e2e129dfcb2f.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/6a8/f0e/7b9/6a8f0e7b965f44255365d50ad64669e0.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/078/e4c/073/078e4c073df61b68e97372c7e4730f5b.png"><br><br>  Dann erstellen wir eine <code>application_tier</code> , eine automatische Skalierungsgruppe - einen Load Balancer.  Einige Startkonfigurationen basieren auf der AMI-ID, kombinieren mehrere Subnetze und Verf√ºgbarkeitszonen und verwenden auch einen SSH-Schl√ºssel. <br>  Kommen wir gleich darauf zur√ºck. <br><br>  Ich habe bereits Verf√ºgbarkeitszonen erw√§hnt.  Sie unterscheiden sich f√ºr verschiedene AWS-Konten.  Mein Konto in den USA im Osten hat m√∂glicherweise Zugriff auf die Zonen A, B und D. Ihr AWS-Konto hat m√∂glicherweise Zugriff auf B, C und E. Wenn Sie diese Werte im Code korrigieren, treten Probleme auf.  Wir von Hashicorp schlugen vor, solche Datenquellen zu erstellen, damit wir Amazon fragen k√∂nnen, was uns zur Verf√ºgung steht.  Unter der Haube fordern wir eine Beschreibung der Verf√ºgbarkeitszonen an und geben dann eine Liste aller Zonen f√ºr Ihr Konto zur√ºck.  Dank dessen k√∂nnen wir Datenquellen f√ºr AMI verwenden. <br><br>  Jetzt gehen wir meiner Demonstration auf den Grund.  Ich habe eine automatische Skalierungsgruppe erstellt, in der drei Instanzen ausgef√ºhrt werden.  Standardm√§√üig haben alle die Version 1.0.0. <br><br>  Wenn wir die neue Version von AMI bereitstellen, starte ich die Terraform-Konfiguration erneut, dies √§ndert die Startkonfiguration und der neue Dienst erh√§lt die n√§chste Version des Codes usw. Und wir k√∂nnen sie steuern. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/53e/030/d08/53e030d08a8820f28ce8970bdb2bcee8.png"><br><br>  Wir sehen, dass Packer fertig ist und wir haben einen neuen AMI. <br>  Ich gehe zur√ºck zu Amazon, aktualisiere die Seite und sehe einen zweiten AMI. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab7/966/88d/ab796688d7e117c00b12343d54547a3a.png"><br><br>  Zur√ºck zu Terraform. <br><br>  Ab Version 0.10 hat Terraform Anbieter in separate Repositorys aufgeteilt.  Der Befehl <code>init terraform</code> erh√§lt eine Kopie des Anbieters, der zum Ausf√ºhren ben√∂tigt wird. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a71/f24/5c1/a71f245c166bffd9cce8d2da21612bb3.png"><br><br>  Anbieter geladen.  Wir sind bereit, vorw√§rts zu kommen. <br>  Als n√§chstes m√ºssen wir <code>terraform get</code> ausf√ºhren - die notwendigen Module laden.  Sie sind jetzt auf meinem lokalen Computer.  Terraform erh√§lt also alle Module lokal.  Im Allgemeinen k√∂nnen Module in ihren eigenen Repositorys auf GitHub oder anderswo gespeichert werden.  Deshalb habe ich √ºber das VPC-Modul gesprochen.  Sie k√∂nnen dem Netzwerkteam Zugriff gew√§hren, um √Ñnderungen vorzunehmen.  Und dies ist die API, mit der das Entwicklungsteam zusammenarbeiten kann.  Wirklich hilfreich. <br><br>  Der n√§chste Schritt besteht darin, ein Diagramm zu erstellen. <br><br>  Beginnen Sie mit <br><br> <code>terraform plan <br></code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/854/852/ea8/854852ea82a25694dbef99af5832eb27.png"><br><br>  Terraform nimmt den aktuellen lokalen Status und vergleicht ihn mit dem AWS-Konto, wobei die Unterschiede angezeigt werden.  In unserem Fall wird er 35 neue Ressourcen erstellen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ce/d53/2cc/3ced532cc5cbe65758669980fda88f9e.png"><br><br>  Jetzt wenden wir die √Ñnderungen an: <br><br> <code>terraform apply <br></code> <br><br>  Sie m√ºssen dies nicht alles vom lokalen Computer aus tun.  Dies sind nur Befehle, die Variablen an Terraform √ºbergeben.  Sie k√∂nnen diesen Prozess auf CI-Tools portieren. <br>  Wenn Sie dies in CI verschieben m√∂chten, m√ºssen Sie den Remote-Status verwenden.  Ich m√∂chte, dass jeder, der Terraform jemals verwendet, mit Remote-Status arbeitet.  Bitte verwenden Sie nicht den lokalen Staat. <br><br>  Einer meiner Freunde bemerkte, dass er auch nach all den Jahren der Arbeit mit Terraform immer noch etwas Neues entdeckt.  Wenn Sie beispielsweise eine AWS-Instanz erstellen, m√ºssen Sie ihr ein Kennwort geben, damit sie in Ihrem Status gespeichert werden kann.  Als ich bei Hashicorp arbeitete, gingen wir davon aus, dass es einen kollaborativen Prozess geben w√ºrde, der dieses Passwort √§ndert.  Versuchen Sie daher nicht, alles lokal zu speichern.  Und dann k√∂nnen Sie all dies in die CI-Tools einf√ºgen. <br><br>  So wird die Infrastruktur f√ºr mich geschaffen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c55/040/c1d/c55040c1d4544a4d7c53f77a494c2be7.png"><br><br>  Terraform kann ein Diagramm erstellen: <br><br> <code>terraform graph <br></code> <br><br>  Wie ich schon sagte, er baut einen Baum.  In der Tat gibt es Ihnen die M√∂glichkeit zu bewerten, was in Ihrer Infrastruktur passiert.  Er zeigt Ihnen die Beziehung zwischen all den verschiedenen Teilen - allen Knoten und Kanten.  Da Verbindungen Richtungen haben, sprechen wir von einem gerichteten Graphen. <br><br>  Das Diagramm ist eine JSON-Liste, die in einer PNG- oder DOC-Datei gespeichert werden kann. <br><br>  Zur√ºck zu Terraform.  Wir erstellen wirklich eine automatische Skalierungsgruppe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fe/253/799/9fe253799368629b6c98d7472cbc3634.png"><br><br>  Die automatische Skalierungsgruppe hat eine Kapazit√§t von 3. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0dd/2a3/e47/0dd2a3e47ef49ba119c37c6ee1118fe9.png"><br><br>  Eine interessante Frage: K√∂nnen wir Vault verwenden, um Geheimnisse in Terraform zu verwalten?  Leider nein.  In Terraform gibt es keine Vault-Datenquelle zum Lesen von Geheimnissen.  Es gibt andere M√∂glichkeiten, z. B. Umgebungsvariablen.  Mit ihrer Hilfe m√ºssen Sie keine Geheimnisse in den Code eingeben, sondern k√∂nnen sie als Umgebungsvariablen lesen. <br><br>  Wir haben also einige Infrastruktureinrichtungen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/107/2ef/61e/1072ef61ea789635cb6e9894005734b2.png"><br><br>  Ich gebe mein sehr geheimes VPN ein (knacke meine VPNs nicht). <br><br>  Das Wichtigste dabei ist, dass wir drei Instanzen der Anwendung haben.  Es stimmt, ich h√§tte notieren sollen, welche Version der Anwendung auf ihnen ausgef√ºhrt wird.  Es ist sehr wichtig. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/009/bef/b7d/009befb7dcb30e11c9454e3b27f036cf.png"><br>  Alles steckt wirklich hinter dem VPN: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9f/5d3/e43/b9f5d3e436b981cfc21db8e42b782db5.png"><br><br>  Wenn ich dies nehme ( <code>application-elb-1069500747.eu-west-1.elb.amazonaws.com</code> ) und es in die Adressleiste des Browsers einf√ºge, erhalte ich Folgendes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/016/40e/203/01640e2034e1cd80ff454b5c6b74c386.png"><br><br>  Ich m√∂chte Sie daran erinnern, dass ich mit einem VPN verbunden bin.  Wenn ich mich abmelde, ist die angegebene Adresse nicht verf√ºgbar. <br>  Wir sehen Version 1.0.0.  Und egal wie oft wir die Seite aktualisieren, wir erhalten 1.0.0. <br>  Was passiert, wenn ich die Version im Code von 1.0.0 auf 1.0.1 √§ndere? <br><br><pre> <code class="javascript hljs">filter { name = <span class="hljs-string"><span class="hljs-string">"tag:Version"</span></span> values = [<span class="hljs-string"><span class="hljs-string">"1.0.1"</span></span>] }</code> </pre> <br>  Mit CI-Tools stellen Sie nat√ºrlich sicher, dass Sie die richtige Version erstellen. <br>  Ich stelle keine manuellen Updates fest!  Wir sind unvollkommen, machen Fehler und k√∂nnen bei manueller Aktualisierung Version 1.0.6 anstelle von 1.0.1 verwenden. <br><br><pre> <code class="javascript hljs">filter { name = <span class="hljs-string"><span class="hljs-string">"tag:Version"</span></span> values = [<span class="hljs-string"><span class="hljs-string">"1.0.6"</span></span>] }</code> </pre><br>  Aber fahren wir mit unserer Version (1.0.1) fort. <br><br> <code>terraform plan <br></code> <br><br>  Terraform aktualisiert den Status: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb8/7f5/221/fb87f522107164e64498825e1e4e0562.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c39/8ec/61b/c398ec61bfdbd060b526417c56631b14.png"><br><br>  In diesem Moment teilt er mir mit, dass er die Version in der Startkonfiguration √§ndern wird.  Aufgrund der √Ñnderung der Kennung wird ein Neustart der Konfiguration erzwungen, und die Gruppe f√ºr die automatische Skalierung √§ndert sich (dies ist erforderlich, um die neue Startkonfiguration zu aktivieren). <br><br>  Dies √§ndert keine laufenden Instanzen.  Das ist wirklich wichtig.  Sie k√∂nnen diesen Prozess verfolgen und testen, ohne die Instanzen in der Produktion zu √§ndern. <br><br>  Hinweis: Sie m√ºssen immer eine neue Startkonfiguration erstellen, bevor Sie die alte zerst√∂ren. Andernfalls tritt ein Fehler auf. <br><br>  Wenden wir die √Ñnderungen an: <br><br> <code>terraform apply <br></code> <br><br>  Nun zur√ºck zu AWS.  Wenn alle √Ñnderungen √ºbernommen wurden, wechseln wir zur Gruppe f√ºr die automatische Skalierung. <br>  Fahren wir mit der AWS-Konfiguration fort.  Wir sehen, dass es drei Instanzen mit einer Startkonfiguration gibt.  Sie sind die gleichen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/365/ae7/49c/365ae749cd5c77ea0634247410b58da6.png"><br><br>  Amazon garantiert, dass drei Instanzen des Dienstes tats√§chlich gestartet werden, wenn wir sie ausf√ºhren m√∂chten.  Deshalb zahlen wir ihnen Geld. <br><br>  Fahren wir mit den Experimenten fort. <br><br>  Eine neue Startkonfiguration wurde erstellt.  Wenn ich eine der Instanzen l√∂sche, wird der Rest nicht besch√§digt.  Es ist wichtig.  Wenn Sie die Instanzen jedoch direkt verwenden, w√§hrend Sie die Benutzerdaten √§ndern, werden die "Live" -Instanzen zerst√∂rt.  Bitte tu das nicht. <br><br>  L√∂schen Sie also eine der Instanzen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eb3/373/05a/eb337305af7a4e537d2f5963661f909f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/244/711/a7c/244711a7c5beb5edd4863239e2997fc1.png"><br><br>  Was passiert in der automatischen Skalierungsgruppe, wenn sie heruntergefahren wird?  An seiner Stelle wird eine neue Instanz angezeigt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/86d/1dd/8f5/86d1dd8f57f1af6e56ddf9054b777e91.png"><br><br>  Hier befinden Sie sich in einer interessanten Situation.  Die Instanz wird mit der neuen Konfiguration gestartet.  Das hei√üt, im System haben Sie m√∂glicherweise mehrere unterschiedliche Images (mit unterschiedlichen Konfigurationen).  Manchmal ist es besser, die alte Startkonfiguration nicht sofort zu l√∂schen, um bei Bedarf eine Verbindung herzustellen. <br><br>  Hier wird alles noch interessanter.  Warum nicht mit CI-Skripten und -Tools und nicht manuell, wie ich zeige?  Es gibt Tools, die dies tun k√∂nnen, z. B. die hervorragenden AWS-Missing-Tools auf GitHub. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/948/2b7/96d/9482b796d437daa84cf7c26dc85aa08f.png"><br><br>  Und was macht dieses Tool?  Dies ist ein Bash-Skript, das alle Instanzen im Load Balancer durchl√§uft, sie einzeln zerst√∂rt und sicherstellt, dass an ihrer Stelle neue erstellt werden. <br>  Wenn ich eine meiner Instanzen mit Version 1.0.0 verloren habe und eine neue erschien - 1.1.1, m√∂chte ich alle 1.0.0 beenden und alles auf die neue Version √ºbertragen.  Weil ich mich immer vorw√§rts bewege.  Ich m√∂chte Sie daran erinnern, dass es mir nicht gef√§llt, wenn der Anwendungsserver lange lebt. <br><br>  In einem der Projekte hatte ich alle sieben Tage ein Kontrollskript, das alle Instanzen in meinem Konto zerst√∂rte.  Der Server war also nicht √§lter als sieben Tage.  Eine andere Sache (mein Favorit) ist es, die Server mit SSH in einer Box als "befleckt" zu markieren und sie jede Stunde mit einem Skript zu zerst√∂ren. Wir m√∂chten nicht, dass die Leute dies manuell tun. <br><br>  Mit solchen Steuerungsskripten haben Sie immer die neueste Version mit behobenen Fehlern und Sicherheitsupdates. <br><br>  Sie k√∂nnen das Skript einfach verwenden, indem Sie Folgendes ausf√ºhren: <br><br> <code>aws-ha-relesae.sh -a my-scaling-group <br></code> <br><br>  <code>-a</code> ist Ihre automatische Skalierungsgruppe.  Das Skript durchl√§uft alle Instanzen Ihrer automatischen Skalierungsgruppe und ersetzt sie.  Sie k√∂nnen es nicht nur manuell, sondern auch √ºber das CI-Tool ausf√ºhren. <br>  Sie k√∂nnen dies in der Qualit√§tssicherung oder in der Produktion tun.  Sie k√∂nnen dies sogar in Ihrem lokalen AWS-Konto tun.  Sie tun jedes Mal, wenn Sie denselben Mechanismus verwenden, was Sie wollen. <br><br>  Zur√ºck zu Amazon.  Wir haben eine neue Instanz: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f4b/1aa/079/f4b1aa079ec971f111abce895d28c771.png"><br><br>  Nachdem wir die Seite im Browser aktualisiert haben, auf dem wir zuvor Version 1.0.0 gesehen haben, erhalten wir: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ff4/923/d78/ff4923d78d16d508c0e8bae753044c15.png"><br><br>  Das Interessante ist, dass wir seit der Erstellung des AMI-Erstellungsskripts die Erstellung von AMI testen k√∂nnen. <br><br>  Es gibt einige gro√üartige Tools wie ServerScript oder Serverspec. <br><br>  Mit Serverspec k√∂nnen Sie Spezifikationen im Ruby-Stil erstellen, um zu testen, wie Ihr Anwendungsserver aussieht.  Im Folgenden gebe ich zum Beispiel einen Test, der √ºberpr√ºft, ob nginx auf dem Server installiert ist. <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'spec_helper'</span></span> describe package(<span class="hljs-string"><span class="hljs-string">'nginx'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> it { should be_installed } <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> describe service(<span class="hljs-string"><span class="hljs-string">'nginx'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> it { sould be_enabled } it { sould be_running } <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> describe port(<span class="hljs-number"><span class="hljs-number">80</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> it { should be_listening } <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Nginx muss auf dem Server installiert sein und ausgef√ºhrt werden und Port 80 √ºberwachen.  Sie k√∂nnen sagen, dass Benutzer X auf dem Server verf√ºgbar sein muss.  Und Sie k√∂nnen all diese Tests an ihre Stelle setzen.  Wenn Sie also eine AMI erstellen, kann das CI-Tool pr√ºfen, ob diese AMI f√ºr einen bestimmten Zweck geeignet ist.  Sie werden wissen, dass AMI produktionsbereit ist. <br><br><h3>  Anstelle einer Schlussfolgerung </h3><br>  Mary Poppendieck ist wahrscheinlich eine der erstaunlichsten Frauen, von denen ich je geh√∂rt habe.  Einmal sprach sie dar√ºber, wie sich die schlanke Softwareentwicklung im Laufe der Jahre entwickelt hat.  Und wie sie in den 60er Jahren mit 3M in Verbindung gebracht wurde, als sich das Unternehmen wirklich mit Lean Development besch√§ftigte. <br><br>  Und sie stellte die Frage: Wie lange dauert es, bis Ihr Unternehmen die mit einer Codezeile verbundenen √Ñnderungen implementiert hat?  K√∂nnen Sie diesen Prozess zuverl√§ssig und wiederholbar machen? <br><br>  Diese Frage betraf in der Regel immer den Softwarecode.  Wie lange brauche ich, um einen Fehler in dieser Anwendung bei der Bereitstellung in der Produktion zu beheben?  Es gibt jedoch keinen Grund, warum wir nicht dieselbe Frage f√ºr Infrastruktur oder Datenbanken verwenden k√∂nnen. <br><br>  Ich habe f√ºr eine Firma namens OpenTable gearbeitet.  Darin nannten wir dies die Dauer des Zyklus.  Und in OpenTable war sie sieben Wochen alt.  Und das ist relativ gut.  Ich kenne Unternehmen, die Monate brauchen, um einen Code an die Produktion zu senden.  Bei OpenTable haben wir den Prozess vier Jahre lang √ºberpr√ºft.  Dies hat viel Zeit in Anspruch genommen, da die Organisation gro√ü ist - 200 Personen.  Und wir haben die Zykluszeit auf drei Minuten reduziert.  Dies war m√∂glich dank Messungen des Effekts unserer Transformationen. <br><br>  Jetzt ist alles in Skripten geschrieben.  Wir haben so viele Tools und Beispiele, dass es GitHub gibt.  Nehmen Sie daher Ideen von Konferenzen wie DevOops und implementieren Sie sie in Ihrem Unternehmen.  Versuchen Sie nicht, alles zu implementieren.  Nimm eine winzige Sache und verkaufe sie.  Zeigen Sie jemanden.  Die Auswirkungen einer kleinen √Ñnderung k√∂nnen gemessen, gemessen und fortgesetzt werden! <br><blockquote>  Paul Stack wird auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DevOops 2018-</a> Konferenz in St. Petersburg mit einem Bericht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûNachhaltige Systemtests mit Chaos‚Äú</a> eintreffen.  Paul wird √ºber die Chaos Engineering-Methodik sprechen und zeigen, wie diese Methodik in realen Projekten angewendet werden kann. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420661/">https://habr.com/ru/post/de420661/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de420651/index.html">Wissenschaftler finden Hinweise auf unangenehme Pr√§zedenzf√§lle im Zusammenhang mit dem Klimawandel</a></li>
<li><a href="../de420653/index.html">F√ºnf Dinge, die Sie tun m√ºssen, um Ihr Zuhause auf dem Mars auszur√ºsten</a></li>
<li><a href="../de420655/index.html">Roboter mieten Wohnungen √ºber Airbnb, um zu lernen, wie man Gegenst√§nde besser ergreift</a></li>
<li><a href="../de420657/index.html">Analyse: Auf wessen Geld kann Elon Musk Tesla vom Umtausch abheben</a></li>
<li><a href="../de420659/index.html">USB-Kampagne der HRF (Human Rights Foundation) ‚ÄûFlash Drives for Freedom‚Äú</a></li>
<li><a href="../de420663/index.html">Einfache Metriken und eine M√∂glichkeit, Zeit zu sparen, wenn Sie nach Problemen in der Infrastruktur suchen</a></li>
<li><a href="../de420665/index.html">Erstellen einer Anwendung auf .NET Core und Kubernetes: Unsere Erfahrung</a></li>
<li><a href="../de420667/index.html">Funktionsprinzipien des EIGRP-Protokolls</a></li>
<li><a href="../de420669/index.html">Markt√ºberblick √ºber Enterprise Automation: L√∂sungen f√ºr Bau- und Verwaltungsunternehmen f√ºr Wohnungsbau und Versorgungsunternehmen</a></li>
<li><a href="../de420671/index.html">[Ekaterinburg, Ank√ºndigung] UralJS # 9 - drei Berichte √ºber Microservices, Tests und Fehlerprotokollierung an der Vorderseite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>