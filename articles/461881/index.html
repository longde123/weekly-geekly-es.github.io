<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÖüèº üíÖüèº üòñ Gu√≠a de registro de Node.js üë®üèø‚Äç‚öñÔ∏è üë©üèø‚Äç‚öïÔ∏è üö¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La primera tarea a la que se enfrentan con mayor frecuencia los desarrolladores que comienzan a programar en JavaScript es c√≥mo registrar eventos en e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gu√≠a de registro de Node.js</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/funcorp/blog/461881/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/o7/dd/qs/o7ddqsvqk7dz2uljo7mz4e-ox2o.png"></div><br>  La primera tarea a la que se enfrentan con mayor frecuencia los desarrolladores que comienzan a programar en JavaScript es c√≥mo registrar eventos en el registro de la <code>console.log</code> utilizando el m√©todo <code>console.log</code> .  En la b√∫squeda de informaci√≥n sobre la depuraci√≥n del c√≥digo JavaScript, encontrar√° cientos de art√≠culos de blog, as√≠ como instrucciones sobre StackOverflow, que le aconsejan que "simplemente" env√≠e datos a la consola a trav√©s del m√©todo <code>console.log</code> .  Esta es una pr√°ctica tan com√∫n que tuve que introducir reglas para el control de calidad del c√≥digo, como <code>no-console</code> , para no dejar entradas de registro aleatorias en el c√≥digo de producci√≥n.  Pero, ¬øqu√© sucede si necesita registrar espec√≠ficamente un evento para proporcionar informaci√≥n adicional? <br><br>  Este art√≠culo analiza varias situaciones en las que necesita mantener registros;  Muestra la diferencia entre los m√©todos <code>console.log</code> y <code>console.error</code> en Node.js y muestra c√≥mo pasar la funci√≥n de registro a las bibliotecas sin sobrecargar la consola del usuario. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/fl/st/fl/flstflpirz79u4y-4nc0ot6yroe.png"><br><br><h3>  Fundamentos te√≥ricos de trabajar con Node.js </h3><br>  Los m√©todos <code>console.log</code> y <code>console.error</code> se pueden usar tanto en el navegador como en Node.js.  Sin embargo, al usar Node.js, hay una cosa importante para recordar.  Si crea el siguiente c√≥digo en Node.js usando un archivo llamado <code>index.js</code> , <br><br><img src="https://habrastorage.org/webt/9d/f8/fr/9df8fr10y-luiwbcqp6kizl8-ce.png"><br><br>  y luego ejecutarlo en la terminal usando el <code>node index.js</code> , luego los resultados de la ejecuci√≥n del comando se ubicar√°n uno encima del otro: <br><br><img src="https://habrastorage.org/webt/rf/n_/wi/rfn_wioub6pircw7tcrgvmt8g4w.png"><br><br>  A pesar de que parecen similares, el sistema los procesa de manera diferente.  Si mira la secci√≥n sobre el funcionamiento de la <code>console</code> en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n de Node.js</a> , resulta que <code>console.log</code> imprime el resultado a trav√©s de <code>stdout</code> , y <code>console.error</code> imprime a trav√©s de <code>stderr</code> . <br><br>  Cada proceso puede funcionar con tres flujos ( <code>stream</code> ) de forma predeterminada: <code>stdin</code> , <code>stdout</code> y <code>stderr</code> .  La secuencia <code>stdin</code> procesa la entrada para un proceso, por ejemplo, clics de bot√≥n o salida redirigida (m√°s sobre esto a continuaci√≥n).  El flujo de salida est√°ndar <code>stdout</code> es para la salida de datos de la aplicaci√≥n.  Finalmente, el flujo de error est√°ndar <code>stderr</code> est√° dise√±ado para mostrar mensajes de error.  Si necesita averiguar para qu√© <code>stderr</code> y cu√°ndo usarlo, lea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este art√≠culo</a> . <br><br>  En resumen, se puede usar para usar los operadores de redirecci√≥n ( <code>&gt;</code> ) y de canalizaci√≥n ( <code>|</code> ) para trabajar con errores e informaci√≥n de diagn√≥stico por separado de los resultados reales de la aplicaci√≥n.  Si el operador <code>&gt;</code> permite redirigir la salida del resultado del comando a un archivo, entonces usando el operador <code>2&gt;</code> puede redirigir la salida de la secuencia de error <code>stderr</code> a un archivo.  Por ejemplo, este comando env√≠a <i>Hello</i> al archivo <code>hello.log</code> y <i>Bye bye</i> al archivo <code>error.log</code> . <br><br><img src="https://habrastorage.org/webt/cf/xm/se/cfxmsetuf_6ohz4zqoeg_oqsojw.png"><br><br><img src="https://habrastorage.org/webt/ve/ji/i0/vejii0f6_q4zhetko-f9bg1pozy.png"><br><br><h3>  ¬øCu√°ndo necesito escribir eventos en el registro? </h3><br>  Ahora que hemos revisado los aspectos t√©cnicos que subyacen en el registro, pasemos a varios escenarios en los que necesita registrar eventos.  Por lo general, estos escenarios se dividen en una de varias categor√≠as: <br><br><ul><li>  depuraci√≥n r√°pida cuando comportamiento inesperado durante el desarrollo; </li><li>  registro basado en navegador para an√°lisis y diagn√≥stico; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">registro de aplicaciones de servidor</a> para registrar solicitudes entrantes y posibles errores; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mantener registros de depuraci√≥n adicionales para bibliotecas</a> para ayudar a los usuarios a resolver problemas; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">registro para la salida de la interfaz de l√≠nea de comandos</a> y para mostrar mensajes en la consola sobre el progreso de la operaci√≥n, confirmaciones y errores. </li></ul><br>  Este art√≠culo solo trata los √∫ltimos tres escenarios basados ‚Äã‚Äãen Node.js. <br><br><h3>  Registro para aplicaciones de servidor </h3><br>  Existen varios motivos para registrar eventos que ocurren en el servidor.  Por ejemplo, el registro de solicitudes entrantes le permite obtener estad√≠sticas sobre la frecuencia con la que los usuarios encuentran errores 404, cu√°l podr√≠a ser la raz√≥n de esto o qu√© aplicaci√≥n de cliente de <code>User-Agent</code> se est√° utilizando.  Tambi√©n puede averiguar la hora en que ocurri√≥ el error y su causa. <br><br>  Para experimentar con el material proporcionado en esta parte del art√≠culo, debe crear un nuevo cat√°logo para el proyecto.  En el directorio del proyecto, cree <code>index.js</code> para el c√≥digo que se utilizar√° y ejecute los siguientes comandos para iniciar el proyecto e instalar <code>express</code> : <br><br><img src="https://habrastorage.org/webt/ma/sw/qo/maswqo4k3lr9my_vnkcmrksqxme.png"><br><br>  Configuramos un servidor con middleware, que registrar√° cada solicitud en la consola utilizando el m√©todo <code>console.log</code> .  Ponemos las siguientes l√≠neas en el archivo <code>index.js</code> : <br><br><img src="https://habrastorage.org/webt/pr/y5/js/pry5js_udhlcqeurmmwyld57zky.png"><br><br>  Esto usa <code>console.log('%O', req)</code> para registrar todo el objeto en el registro.  Desde el punto de vista de la estructura interna, el m√©todo <code>util.forma</code> usa <code>util.forma</code> t, que, adem√°s de <code>%O</code> admite otros marcadores de posici√≥n.  Se puede encontrar informaci√≥n sobre ellos en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n de Node.js.</a> <br><br>  Al ejecutar el <code>node index.js</code> para iniciar el servidor y cambiar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 3000, la consola muestra mucha informaci√≥n innecesaria: <br><br><img src="https://habrastorage.org/webt/qy/c1/ta/qyc1ta1h1em_xkl0f9683zvesfe.png"><br><br>  Si en su lugar usa <code>console.log('%s', req)</code> para no mostrar el objeto por completo, no obtendr√° mucha informaci√≥n: <br><br><img src="https://habrastorage.org/webt/ru/ew/kz/ruewkz1ihxicigymk_oqta9s9gc.png"><br><br>  Puede escribir su propia funci√≥n de registro, que generar√° solo los datos necesarios, pero primero debe decidir qu√© informaci√≥n se necesita.  A pesar de que el enfoque generalmente est√° en el contenido del mensaje, en realidad a menudo es necesario obtener informaci√≥n adicional, que incluye: <br><br><ul><li>  marca de tiempo - para saber cu√°ndo ocurrieron los eventos; </li><li>  nombre de la computadora / servidor: si se est√° ejecutando un sistema distribuido; </li><li>  identificador de proceso: si se ejecutan varios procesos de Nodo utilizando, por ejemplo, <code>pm2</code> ; </li><li>  mensaje: un mensaje real con cierto contenido; </li><li>  seguimiento de pila: si se registra un error; </li><li>  Variables / informaci√≥n adicional. </li></ul><br>  Adem√°s, dado que, en cualquier caso, todo se env√≠a a las secuencias <code>stdout</code> y <code>stderr</code> , es necesario mantener un diario en diferentes niveles, as√≠ como configurar y filtrar las entradas de diario seg√∫n el nivel. <br><br>  Esto se puede lograr obteniendo acceso a diferentes partes del <code>process</code> y escribiendo varias l√≠neas de c√≥digo en JavaScript.  Sin embargo, Node.js es notable porque ya tiene un ecosistema <code>npm</code> y varias bibliotecas que se pueden usar para estos fines.  Estos incluyen: <br><br><ul><li>  <code>pino</code> </li><li>  <code>winston</code> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">roarr</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bunyan</a> (esta biblioteca no se ha actualizado durante dos a√±os). </li></ul><br>  A menudo se prefiere el pino porque es r√°pido y tiene su propio ecosistema.  Veamos c√≥mo <code>pino</code> puede ayudar con el registro.  Otra ventaja de esta biblioteca es el paquete <code>express-pino-logger</code> , que le permite registrar solicitudes. <br><br>  Instale <code>pino</code> y <code>express-pino-logger</code> : <br><br><img src="https://habrastorage.org/webt/nq/j_/jq/nqj_jqvxgyqqdmfgydf9740la-y.png"><br><br>  Despu√©s de eso, actualizamos el archivo <code>index.js</code> para usar el registrador de eventos y el middleware: <br><br><img src="https://habrastorage.org/webt/qw/ge/sq/qwgesqqth2bnxd447led_m35ud8.png"><br><br>  En este fragmento, creamos una instancia del <code>logger</code> eventos para <code>pino</code> y se lo pasamos a <code>express-pino-logger</code> para crear un nuevo software de registro de eventos multiplataforma con el que puede llamar a <code>app.use</code> .  Adem√°s, <code>console.log</code> reemplazado en <code>logger.info</code> por <code>logger.info</code> y <code>logger.debug</code> agregado a la ruta para mostrar diferentes niveles del registro. <br><br>  Si reinicia el servidor ejecutando repetidamente el <code>node index.js</code> , obtendr√° un resultado diferente en la salida, en el que cada l√≠nea / l√≠nea se generar√° en formato JSON.  Nuevamente, vaya a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 3000 para ver otra nueva l√≠nea en formato JSON. <br><br><img src="https://habrastorage.org/webt/tr/mh/0v/trmh0vi7-h9khu3355byqn5s-pg.png"><br><br>  Entre los datos en formato JSON, puede encontrar la informaci√≥n mencionada anteriormente, como una marca de tiempo.  Tambi√©n tenga en cuenta que el mensaje <code>logger.debug</code> no se mostr√≥.  Para hacerlo visible, debe cambiar el nivel de registro predeterminado.  Despu√©s de crear una instancia del registro de eventos del registrador, se estableci√≥ el valor <code>process.env.LOG_LEVEL</code> .  Esto significa que puede cambiar el valor o aceptar el valor de <code>info</code> predeterminado.  <code>LOG_LEVEL=debug node index.js</code> ejecutar <code>LOG_LEVEL=debug node index.js</code> , cambiamos el nivel de registro. <br><br>  Antes de hacer esto, es necesario resolver el problema del formato de salida, que no es muy conveniente para la percepci√≥n en este momento.  Este paso es intencional.  De acuerdo con la filosof√≠a <code>pino</code> , por razones de rendimiento, es necesario transferir el procesamiento de entradas de diario a un proceso separado, pasando la salida (utilizando el operador <code>|</code> ).  El proceso implica traducir el resultado a un formato m√°s conveniente para la percepci√≥n humana, o subirlo a la nube.  Esta tarea se realiza mediante herramientas de transferencia llamadas <code>transports</code> .  Consulte la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n del kit de herramientas de</a> <code>transports</code> y vea por qu√© los errores de <code>pino</code> no se <code>stderr</code> trav√©s de <code>stderr</code> . <br><br>  Para ver una versi√≥n m√°s legible de la revista, use la herramienta <code>pino-pretty</code> .  Ejecutar en la terminal: <br><br><img src="https://habrastorage.org/webt/yi/-b/v6/yi-bv6ct4r1zozscacob9xp5urc.png"><br><br>  Todas las entradas de registro se transfieren mediante <code>|</code>  a disposici√≥n de <code>pino-pretty</code> , debido a que la salida se "borra", que contendr√° solo informaci√≥n importante que se muestra en diferentes colores.  Si consulta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 3000 nuevamente, deber√≠a aparecer un mensaje de <code>debug</code> depuraci√≥n. <br><br><img src="https://habrastorage.org/webt/_p/lb/w1/_plbw1wcxgonrmw4lsyt5ls7cka.png"><br><br>  Para hacer que las entradas del diario sean m√°s legibles o convertirlas, existen muchas herramientas de transmisi√≥n.  Incluso se pueden mostrar usando emojis con <code>pino-colada</code> .  Estas herramientas ser√°n √∫tiles para el desarrollo local.  Cuando el servidor est√° en producci√≥n, puede ser necesario transferir datos de registro usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otra herramienta</a> , escribirlos en el disco usando <code>&gt;</code> para su posterior procesamiento, o hacer dos operaciones al mismo tiempo usando un comando espec√≠fico, por ejemplo <code>tee</code> . <br><br>  El <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documento</a> tambi√©n habla sobre la rotaci√≥n de archivos de registro, el filtrado y la escritura de datos de registro en otros archivos. <br><br><h3>  Diario de la biblioteca </h3><br>  Al explorar formas de organizar eficientemente el registro para las aplicaciones del servidor, puede usar la misma tecnolog√≠a para sus propias bibliotecas. <br><br>  El problema es que, en el caso de la biblioteca, es posible que deba mantener un registro con fines de depuraci√≥n sin cargar la aplicaci√≥n cliente.  Por el contrario, el cliente deber√≠a poder activar el registro si es necesario depurarlo.  De manera predeterminada, la biblioteca no debe registrar la salida, lo que le otorga al usuario este derecho. <br><br>  Un buen ejemplo de esto es el marco <code>express</code> .  Muchos procesos tienen lugar en la estructura interna del marco <code>express</code> , lo que puede causar inter√©s en estudiarlo m√°s profundamente durante la depuraci√≥n de la aplicaci√≥n.  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n del marco</a> <code>express</code> dice que puede agregar <code>DEBUG=express:*</code> al comienzo del comando de la siguiente manera: <br><br><img src="https://habrastorage.org/webt/ts/ht/a9/tshta9wjl_atyr3wrm11i11fuzu.png"><br><br>  Si aplica este comando a una aplicaci√≥n existente, puede ver una gran cantidad de resultados adicionales que ayudar√°n con la depuraci√≥n: <br><br><img src="https://habrastorage.org/webt/tn/ea/pl/tneaplymuzok_eenshb-zv50oiq.png"><br><br>  Esta informaci√≥n no se puede ver a menos que el registro de depuraci√≥n est√© activado.  Hay un paquete de <code>debug</code> para esto.  Se puede usar para escribir mensajes en el "espacio de nombres", y si el usuario de la biblioteca incluye este espacio de nombres o un comod√≠n que coincida con su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">variable de entorno</a> <code>DEBUG</code> , se mostrar√°n los mensajes.  Primero necesita instalar la biblioteca de <code>debug</code> : <br><br><img src="https://habrastorage.org/webt/gi/4h/mp/gi4hmppeawcqdpwsncu3g5rqlzs.png"><br><br>  Cree un nuevo archivo llamado <code>random-id.j</code> s que simule la biblioteca y coloque el siguiente c√≥digo: <br><br><img src="https://habrastorage.org/webt/le/fq/cn/lefqcnt7-3nft1klqsjuugnkupa.png"><br><br>  Como resultado, se crear√° un nuevo registrador de eventos de <code>debug</code> con el <code>mylib:randomid</code> , en el que se registrar√°n dos mensajes.  Lo usamos en <code>index.js</code> de la secci√≥n anterior: <br><br><img src="https://habrastorage.org/webt/bb/cj/ja/bbcjjan7ygf-9z26w8etpccfx8o.png"><br><br>  Si inicia el servidor nuevamente, agregando <code>DEBUG=mylib:randomid node index.js</code> esta vez, se mostrar√°n las entradas del registro de depuraci√≥n para nuestra "biblioteca": <br><br><img src="https://habrastorage.org/webt/fg/3c/8t/fg3c8tejhceciqntzcb-a1n2xd4.png"><br><br>  Si los usuarios de la biblioteca desean poner informaci√≥n de depuraci√≥n en las entradas de registro de <code>pino</code> , pueden usar una biblioteca llamada <code>pino-debug</code> creada por el comando <code>pino</code> para formatear estas entradas correctamente. <br><br>  Instala la biblioteca: <br><br><img src="https://habrastorage.org/webt/wg/dh/y1/wgdhy11xkqt-e8csfhcrjcctkl8.png"><br><br>  Antes de usar la <code>debug</code> por primera vez, se debe inicializar <code>pino-debug</code> .  La forma m√°s f√°cil de hacer esto es usar los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">indicadores</a> <code>-r</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">o</a> <code>--require</code> para solicitar un m√≥dulo antes de ejecutar el script.  Reiniciamos el servidor usando el comando (siempre que <code>pino-colada</code> instalado <code>pino-colada</code> ): <br><br><img src="https://habrastorage.org/webt/l-/ug/yn/l-ugyn16-kzn1hhye_zus2adfkk.png"><br><br>  Como resultado, las entradas del registro de depuraci√≥n de la biblioteca aparecer√°n igual que en el registro de la aplicaci√≥n: <br><br><img src="https://habrastorage.org/webt/-y/n8/7e/-yn87ertfjgensbyew95aaz8f7y.png"><br><br><h3>  Salida de la interfaz de l√≠nea de comando (CLI) </h3><br>  El √∫ltimo caso que trata este art√≠culo es el registro de la interfaz de l√≠nea de comandos.  Preferiblemente, el registro que registra eventos relacionados con la l√≥gica del programa se mantiene separado del registro para registrar datos de la interfaz de l√≠nea de comandos.  Para registrar cualquier evento relacionado con la l√≥gica del programa, debe usar una biblioteca espec√≠fica, por ejemplo, <code>debug</code> .  En este caso, puede reutilizar la l√≥gica del programa sin limitarse a un escenario utilizando la interfaz de l√≠nea de comandos. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Al crear una interfaz de l√≠nea de comando usando Node.js</a> , puede agregar varios colores, bloques de valores variables o herramientas de formato para darle a la interfaz un aspecto visualmente atractivo.  Sin embargo, debe tener en cuenta varios escenarios. <br><br>  Seg√∫n uno de ellos, la interfaz se puede utilizar en el contexto de un sistema de integraci√≥n continua (CI), en cuyo caso es mejor abandonar el formato de color y la presentaci√≥n de resultados visualmente sobrecargada.  Algunos sistemas de integraci√≥n continua tienen establecido el indicador <code>CI</code> .  Puede verificar que est√° en un sistema de integraci√≥n continua utilizando el paquete <code>is-ci</code> , que admite varios de estos sistemas. <br><br>  Algunas bibliotecas, como la <code>chalk</code> , definen sistemas de integraci√≥n continua y anulan la salida de texto en color a la consola.  Veamos como funciona. <br><br>  Instale <code>chalk</code> con el comando npm <code>install chalk</code> y cree un archivo llamado <code>cli.js</code>  Ponga las siguientes l√≠neas en el archivo: <br><br><img src="https://habrastorage.org/webt/6c/oa/u-/6coau-msy3lievszm36fvfaeffi.png"><br><br>  Ahora, si ejecuta este script usando el <code>node cli.js</code> , los resultados se presentar√°n con diferentes colores: <br><br><img src="https://habrastorage.org/webt/nn/zf/rl/nnzfrlbh5jqiyoqfn-m2b3j2ff8.png"><br><br>  Pero si ejecuta el script usando <code>CI=true node cli.js</code> , el formato de color de los textos se cancelar√°: <br><br><img src="https://habrastorage.org/webt/iz/fg/cs/izfgcsne498gjwybmd_3f7p9ap0.png"><br><br>  En otro escenario que vale la pena recordar, <code>stdout</code> ejecuta en modo terminal, es decir  los datos se env√≠an al terminal.  En este caso, los resultados se pueden mostrar muy bien con <code>boxen</code> .  De lo contrario, lo m√°s probable es que la salida se redirija a un archivo o a otro lugar. <br><br>  Puede comprobar el funcionamiento de las secuencias <code>stdin</code> , <code>stdout</code> o <code>stderr</code> en modo terminal mirando el atributo <code>isTTY</code> de la secuencia correspondiente.  Por ejemplo, <code>process.stdout.isTTY</code> .  <code>TTY</code> significa "teletipo" y en este caso est√° dise√±ado espec√≠ficamente para el terminal. <br><br>  Los valores pueden variar para cada uno de los tres subprocesos, dependiendo de c√≥mo se iniciaron los procesos Node.js.  Se puede encontrar informaci√≥n detallada sobre esto en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n de Node.js, en la secci√≥n "Entrada / salida de procesos"</a> . <br><br>  Veamos c√≥mo el valor de <code>process.stdout.isTTY</code> var√≠a en diferentes situaciones.  <code>cli.js</code> archivo <code>cli.js</code> para verificarlo: <br><br><img src="https://habrastorage.org/webt/ha/qh/gl/haqhglnf6rs38hn6gxl2_ihnntw.png"><br><br>  Ahora ejecute el <code>node cli.js</code> en el terminal y vea la palabra <code>true</code> , despu√©s de lo cual el mensaje se muestra en letra de color: <br><br><img src="https://habrastorage.org/webt/i8/z2/gx/i8z2gxbba0zk1cm5cnk4gxzkqbq.png"><br><br>  Despu√©s de eso, volvemos a ejecutar el comando, pero redirigimos la salida a un archivo y luego vemos el contenido: <br><br><img src="https://habrastorage.org/webt/sb/8b/sf/sb8bsftkufhbufqrmj_a2fkg4jk.png"><br><br>  Esta vez, la palabra <code>undefined</code> apareci√≥ en la terminal, seguida de un mensaje que se muestra en una fuente incolora, ya que la secuencia <code>stdout</code> redirigi√≥ fuera del modo terminal.  Aqu√≠ la <code>chalk</code> utiliza la herramienta de <code>supports-color</code> , que desde el punto de vista de la estructura interna verifica el <code>isTTY</code> secuencia correspondiente. <br><br><img src="https://habrastorage.org/webt/2n/8j/bs/2n8jbshyf2a9qdqpt7ihez8hcsy.png"><br><br>  Las herramientas como la <code>chalk</code> hacen estas cosas por su cuenta.  Sin embargo, al desarrollar una interfaz de l√≠nea de comandos, siempre debe estar atento a las situaciones en las que la interfaz funciona en un sistema de integraci√≥n continua o la salida se redirige.  Estas herramientas lo ayudan a usar la interfaz de l√≠nea de comandos en un nivel superior.  Por ejemplo, los datos en el terminal se pueden organizar de una manera m√°s estructurada, y si <code>isTTY</code> <code>undefined</code> est√° <code>undefined</code> , cambie a una forma m√°s simple de an√°lisis. <br><br><h3>  Conclusi√≥n </h3><br>  Comenzar a usar JavaScript e ingresar la primera l√≠nea en el registro de la consola usando <code>console.log</code> bastante simple.  Pero antes de implementar el c√≥digo en producci√≥n, debe considerar varios aspectos del uso del registro.  Este art√≠culo es solo una introducci√≥n a los diversos m√©todos y soluciones utilizados en la organizaci√≥n del registro de eventos.  No contiene todo lo que necesita saber.  Por lo tanto, se recomienda prestar atenci√≥n a los proyectos exitosos de c√≥digo abierto y monitorear c√≥mo resolvieron el problema de registro y qu√© herramientas se utilizan.  Y ahora intente iniciar sesi√≥n sin generar datos en la consola. <br><br><div style="text-align:center;"><img src="https://s3.amazonaws.com/com.twilio.prod.twilio-docs/original_images/mDf8ceyn8JviZCtuUmtELF8nB0-JFgfvtuRqE6kGRq_9OBdN54bcmQNMKDJ_YdFPOuqO5T_pSHHKV4"></div><br><br>  Si conoce otras herramientas que vale la pena mencionar, escr√≠balas en los comentarios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/461881/">https://habr.com/ru/post/461881/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461871/index.html">101 consejos para convertirte en un buen programador (y humano)</a></li>
<li><a href="../461873/index.html">ViewPager 2: nueva funcionalidad en el contenedor antiguo</a></li>
<li><a href="../461875/index.html">5 nm vs 3 nm</a></li>
<li><a href="../461877/index.html">Java vs Kotlin para Android: opiniones de desarrolladores</a></li>
<li><a href="../461879/index.html">El libro "Linux en acci√≥n"</a></li>
<li><a href="../461885/index.html">EDS es otro tipo de fraude</a></li>
<li><a href="../461887/index.html">Entrando en Aeronet Episodio 2: Homing Drone</a></li>
<li><a href="../461891/index.html">C√≥mo nos hicimos amigos en la infraestructura bancaria usando ManageIQ</a></li>
<li><a href="../461895/index.html">Aprenda mientras viaja: c√≥mo conducimos el 1er D√≠a Europeo del An√°lisis Empresarial</a></li>
<li><a href="../461897/index.html">C√≥mo mantenemos la estabilidad de la aplicaci√≥n Lamoda</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>