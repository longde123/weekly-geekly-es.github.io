<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçü§ù‚Äçüë®üèæ üò£ ü§∑üèº DynamicData: collections dynamiques, architecture MVVM et extensions r√©actives ‚ñ™Ô∏è ‚òùüèº ü§ôüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="F√©vrier 2019 a marqu√© la sortie de ReactiveUI 9 - le framework multiplateforme pour la construction d'applications GUI sur la plate-forme Microsoft .N...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DynamicData: collections dynamiques, architecture MVVM et extensions r√©actives</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454074/"><p>  F√©vrier 2019 a marqu√© la sortie de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ReactiveUI 9</a> - le framework multiplateforme pour la construction d'applications GUI sur la plate-forme Microsoft .NET.  ReactiveUI est un outil pour une int√©gration √©troite des extensions r√©actives avec le mod√®le de conception MVVM.  Vous pouvez vous familiariser avec le framework via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une s√©rie de vid√©os</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page d'accueil de la documentation</a> .  La mise √† jour ReactiveUI 9 comprend de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nombreuses corrections et am√©liorations</a> , mais la plus cruciale et la plus int√©ressante est probablement l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">int√©gration avec le cadre DynamicData</a> , vous permettant de travailler avec des collections dynamiques de fa√ßon r√©active.  Voyons √† quoi nous pouvons utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData</a> et comment ce puissant framework r√©actif fonctionne sous le capot! </p><a name="habracut"></a><br><h1 id="introduction">  Pr√©sentation </h1><br><p> D√©terminons d'abord les cas d'utilisation de DynamicData et d√©couvrons ce que nous n'aimons pas des outils par d√©faut pour travailler avec des jeux de donn√©es dynamiques √† partir de l'espace de noms <code>System.Collections.ObjectModel</code> . </p><br><p>  Comme nous le savons, le mod√®le MVVM assume la r√©partition des responsabilit√©s entre la couche mod√®le, la couche pr√©sentation et le mod√®le de pr√©sentation d'application, √©galement appel√© mod√®le de vue.  La couche de mod√®le est repr√©sent√©e par des entit√©s de domaine et des services et ne sait rien de la couche de mod√®le de vue.  Le mod√®le encapsule toute la logique complexe de l'application, tandis que le mod√®le de vue d√©l√®gue les op√©rations au mod√®le, fournissant l'acc√®s √† des informations sur l'√©tat actuel de l'application via des propri√©t√©s, commandes et collections observables, √† la vue.  L'outil par d√©faut pour travailler avec les propri√©t√©s dynamiques est l'interface <code>INotifyPropertyChanged</code> , pour travailler avec les actions utilisateur - <code>ICommand</code> , et pour travailler avec les collections - l'interface <code>INotifyCollectionChanged</code> , ainsi que de telles impl√©mentations, comme <code>ObservableCollection&lt;T&gt;</code> et <code>ReadOnlyObservableCollection&lt;T&gt;</code> . </p><br><img width="500" src="https://habrastorage.org/getpro/habr/post_images/504/c83/ab0/504c83ab04fe2e2d1eed037317b8aa2c.jpg"><br><p><br>  Les impl√©mentations des <code>INotifyPropertyChanged</code> et <code>ICommand</code> sont g√©n√©ralement √† la charge du d√©veloppeur et du framework MVVM utilis√©, mais l'utilisation de la <code>ObservableCollection&lt;T&gt;</code> par d√©faut impose un certain nombre de limitations!  Par exemple, nous ne pouvons pas muter la collection √† partir d'un thread d'arri√®re-plan sans <code>Dispatcher.Invoke</code> ou un appel similaire, et cela aurait √©t√© tr√®s utile pour synchroniser les tableaux de donn√©es avec le serveur via une op√©ration en arri√®re-plan.  Il convient de noter que lors de l'utilisation de l'architecture MVVM propre, la couche mod√®le ne doit rien savoir du cadre GUI utilis√© et doit √™tre compatible avec la couche mod√®le dans la terminologie MVC ou MVP.  C'est pourquoi ces nombreux appels <code>Dispatcher.Invoke</code> dans les services de domaine violent le principe de s√©paration des responsabilit√©s. </p><br><p>  Bien s√ªr, nous pourrions d√©clarer un √©v√©nement dans un service de domaine et transmettre un morceau avec des √©l√©ments modifi√©s comme arguments d'√©v√©nement, puis souscrire √† l'√©v√©nement, encapsuler l'appel <code>Dispatcher.Invoke</code> derri√®re une interface, afin que notre application ne d√©pende d'aucune interface graphique. , appelez cette interface √† partir du mod√®le de vue et modifiez <code>ObservableCollection&lt;T&gt;</code> cons√©quence, mais il existe une mani√®re beaucoup plus √©l√©gante de traiter ces probl√®mes sans avoir √† r√©inventer la roue.  Qu'attendons-nous donc? </p><br><h1 id="reactive-extensions-managing-observable-data-streams">  Extensions r√©actives.  Gestion des flux de donn√©es observables </h1><br><p>  Pour bien comprendre les abstractions introduites par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData</a> et comment travailler avec des ensembles de donn√©es r√©actifs changeants, rappelons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce qu'est la programmation r√©active et comment l'utiliser dans le contexte de la plate-forme Microsoft .NET et du mod√®le de conception MVVM</a> .  La mani√®re d'organiser l'interaction entre les composantes du programme peut √™tre interactive ou r√©active.  Avec l'approche interactive, le consommateur re√ßoit les donn√©es du producteur de mani√®re synchrone (bas√©e sur l'extraction, T, IEnumerable), et avec l'approche r√©active, le producteur envoie les donn√©es au consommateur de mani√®re asynchrone (bas√©e sur les push, Task, IObservable). </p><br><img width="500" src="https://habrastorage.org/webt/mb/ts/mj/mbtsmjfyhjqeeb4tv8ynotvkdms.png"><br><p><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La programmation r√©active</a> consiste √† programmer avec des flux de donn√©es asynchrones, et les extensions r√©actives sont l'impl√©mentation de programmation r√©active, bas√©e sur les interfaces <code>IObservable</code> et <code>IObserver</code> de l'espace de noms syst√®me, d√©finissant une s√©rie d'op√©rations de type LINQ sur l'interface <code>IObservable</code> , connue sous le nom de LINQ over Observable.  Les extensions r√©actives prennent en charge .NET Standard et s'ex√©cutent partout o√π Microsoft .NET s'ex√©cute. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ue/qe/80/ueqe80neq0ufivj-bq5hipdrldo.gif"></a> <br><br>  ReactiveUI propose aux d√©veloppeurs d'applications de tirer parti de l'utilisation des impl√©mentations r√©actives pour les interfaces <code>ICommand</code> et <code>INotifyPropertyChanged</code> , en fournissant des outils tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>ReactiveCommand&lt;TIn, TOut&gt;</code></a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>WhenAnyValue</code></a> .  <code>WhenAnyValue</code> vous permet de convertir une propri√©t√© d'une classe qui impl√©mente l'interface <code>INotifyPropertyChanged</code> en un flux d'√©v√©nements de type <code>IObservable&lt;T&gt;</code> , cela simplifie l'impl√©mentation des propri√©t√©s d√©pendantes. </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExampleViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span> { [Reactive] <span class="hljs-comment"><span class="hljs-comment">// Attribute from the ReactiveUI.Fody package, // takes care of aspect-oriented INPC implementation // for this particular property. public string Name { get; set; } public ExampleViewModel() { // Here we subscribe to OnPropertyChanged("Name") events. this.WhenAnyValue(x =&gt; x.Name) // IObservable&lt;string&gt; .Subscribe(Console.WriteLine); } }</span></span></code> </pre> <br><p>  <code>ReactiveCommand&lt;TIn, TOut&gt;</code> vous permet de travailler avec une commande comme avec <code>IObservable&lt;TOut&gt;</code> , qui est publi√©e chaque fois qu'une commande termine son ex√©cution.  En outre, toute commande poss√®de une propri√©t√© <code>ThrownExceptions</code> de type <code>IObservable&lt;Exception&gt;</code> . </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ReactiveCommand&lt;Unit, int&gt; var command = ReactiveCommand.Create(() =&gt; 42); command // IObservable&lt;int&gt; .Subscribe(Console.WriteLine); command .ThrownExceptions // IObservable&lt;Exception&gt; .Select(exception =&gt; exception.Message) // IObservable&lt;string&gt; .Subscribe(Console.WriteLine); command.Execute().Subscribe(); // Outputs: 42</span></span></code> </pre> <br><p>  Jusqu'√† cette √©poque, nous travaillions avec <code>IObservable&lt;T&gt;</code> , comme avec un √©v√©nement qui publie une nouvelle valeur de type <code>T</code> chaque fois que l'√©tat de l'objet observ√© change.  Autrement dit, <code>IObservable&lt;T&gt;</code> est un flux d'√©v√©nements, une collection de type <code>T</code> √©tir√©e dans le temps. </p><br><p>  Bien s√ªr, nous pourrions travailler avec des collections tout aussi facilement et naturellement - chaque fois qu'une collection change, nous pourrions publier une nouvelle collection avec des √©l√©ments modifi√©s.  Dans ce cas, la valeur publi√©e serait de type <code>IEnumerable&lt;T&gt;</code> ou plus sp√©cialis√©e, et le flux observable lui-m√™me serait de type <code>IObservable&lt;IEnumerable&lt;T&gt;&gt;</code> .  Mais, comme le note √† juste titre un lecteur critique, cela pose des probl√®mes de performances critiques, surtout s'il n'y a pas une douzaine d'√©l√©ments dans notre collection, mais une centaine, voire quelques milliers! </p><br><h1 id="introduction-to-dynamicdata">  Introduction √† DynamicData </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData</a> est une biblioth√®que qui vous permet d'utiliser la puissance des extensions r√©actives lorsque vous travaillez avec des collections.  Rx est extr√™mement puissant, mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pr√™t √† l'emploi</a> ne fournit rien pour aider √† la gestion des collections, et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData</a> corrige cela.  Dans la plupart des applications, il est n√©cessaire de mettre √† jour dynamiquement les collections - g√©n√©ralement, une collection est remplie d'√©l√©ments au d√©marrage de l'application, puis la collection est mise √† jour de mani√®re asynchrone, synchronisant les informations avec un serveur ou une base de donn√©es.  Les applications modernes sont assez complexes et il est souvent n√©cessaire de cr√©er des projections de collections - filtrer, transformer ou trier des √©l√©ments.  DynamicData a √©t√© con√ßu pour se d√©barrasser du code incroyablement complexe dont nous aurions besoin pour g√©rer des ensembles de donn√©es √† changement dynamique.  L'outil se d√©veloppe et s'affine activement, et maintenant plus de 60 op√©rateurs sont pris en charge pour travailler avec les collections. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/hn/7j/v3/hn7jv3fv1qgfxlhqrd9g6dokkao.gif"></a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData</a> n'est pas une impl√©mentation alternative d' <code>ObservableCollection&lt;T&gt;</code> .  L'architecture de DynamicData est bas√©e principalement sur des concepts de programmation pilot√©s par domaine.  L'id√©ologie d'utilisation est bas√©e sur le fait que vous contr√¥lez une certaine source de donn√©es, une collection √† laquelle le code responsable de la synchronisation et de la mutation des donn√©es a acc√®s.  Ensuite, vous appliquez une s√©rie d'op√©rateurs √† la source de donn√©es, avec l'aide de ces op√©rateurs, vous pouvez transformer les donn√©es de mani√®re d√©clarative sans avoir besoin de cr√©er et de modifier manuellement d'autres collections.  En fait, avec DynamicData, vous s√©parez les op√©rations de lecture et d'√©criture, et vous ne pouvez lire que de mani√®re r√©active - par cons√©quent, les collections h√©rit√©es resteront toujours synchronis√©es avec la source. </p><br><p>  Au lieu du classique <code>IObservable&lt;T&gt;</code> , DynamicData d√©finit les op√©rations sur <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> et <code>IObservable&lt;IChangeSet&lt;TValue, TKey&gt;&gt;</code> , o√π <code>IChangeSet</code> est un bloc contenant des informations sur le changement de la collection, y compris le type de changement et les √©l√©ments affect√©s.  Cette approche peut am√©liorer consid√©rablement les performances du code pour travailler avec des collections, √©crites de mani√®re r√©active.  Vous pouvez toujours transformer <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> en <code>IObservable&lt;IEnumerable&lt;T&gt;&gt;</code> , s'il devient n√©cessaire d'acc√©der √† tous les √©l√©ments d'une collection √† la fois.  Si cela semble difficile - ne vous inqui√©tez pas, les exemples de code ci-dessous clarifieront tout! </p><br><h1 id="dynamicdata-in-action">  Des donn√©es dynamiques en action </h1><br><p>  Examinons un certain nombre d'exemples afin de mieux comprendre comment DynamicData fonctionne, en quoi il diff√®re de System. Reactive et quelles t√¢ches les d√©veloppeurs ordinaires de logiciels GUI peuvent aider √† r√©soudre.  Commen√ßons par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un exemple complet publi√© sur GitHub</a> .  Dans cet exemple, la source de donn√©es est <code>SourceCache&lt;Trade, long&gt;</code> contenant une collection de transactions.  L'objectif est de n'afficher que les transactions actives, de transformer les mod√®les en objets proxy, de trier la collection. </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// The default collection from the System.Collections.ObjectModel // namespace, to which we bind XAML UI controls. ReadOnlyObservableCollection&lt;TradeProxy&gt; list; // The mutable data source, containing the list of transactions. // We can use Add, Remove, Insert and similar methods on it. var source = new SourceCache&lt;Trade, long&gt;(trade =&gt; trade.Id); var cancellation = source // Here we transform the data source to an observable change set. .Connect() // Now we have IObservable&lt;IChangeSet&lt;Trade, long&gt;&gt; here. // Filter only active transactions. .Filter(trade =&gt; trade.Status == TradeStatus.Live) // Transform the models into proxy objects. .Transform(trade =&gt; new TradeProxy(trade)) // No we have IObservable&lt;IChangeSet&lt;TrandeProxy, long&gt;&gt; // Order the trade proxies by timestamp. .Sort(SortExpressionComparer&lt;TradeProxy&gt; .Descending(trade =&gt; trade.Timestamp)) // Use the dispatcher scheduler to update the GUI. .ObserveOnDispatcher() // Bind the sorted objects to the collection from the // System.Collections.ObjectModel namespace. .Bind(out list) // Ensure that when deleting elements from the // collections, the resources will get disposed. .DisposeMany() .Subscribe();</span></span></code> </pre> <br><p>  Dans l'exemple ci-dessus, lors de la modification de <code>SourceCache</code> qui est la source des donn√©es, <code>ReadOnlyObservableCollection</code> change √©galement en cons√©quence.  Dans le m√™me temps, lors de la suppression d'√©l√©ments de la collection, la m√©thode <code>Dispose</code> sera appel√©e, la collection sera toujours mise √† jour uniquement √† partir du thread GUI et restera tri√©e et filtr√©e.  Cool, maintenant nous n'avons plus d'appels <code>Dispatcher.Invoke</code> et le code est simple et lisible! </p><br><h1 id="data-sources-sourcelist-and-sourcecache">  Sources de donn√©es.  SourceList et SourceCache </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData</a> fournit deux collections sp√©cialis√©es qui peuvent √™tre utilis√©es comme source de donn√©es mutable.  Ces collections sont <code>SourceList&lt;TObject&gt;</code> et <code>SourceCache&lt;TObject, TKey&gt;</code> .  Il est recommand√© d'utiliser <code>SourceCache</code> chaque fois que <code>TObject</code> a une cl√© unique, sinon utilisez <code>SourceList</code> .  Ces objets fournissent le familier pour les d√©veloppeurs .NET API pour la gestion de collection - des m√©thodes telles que <code>Add</code> , <code>Remove</code> , <code>Insert</code> .  Pour convertir des sources de donn√©es en <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> ou en <code>IObservable&lt;IChangeSet&lt;T, TKey&gt;&gt;</code> , utilisez l'op√©rateur <code>.Connect()</code> .  Par exemple, si vous disposez d'un service qui met √† jour p√©riodiquement une collection d'√©l√©ments en arri√®re-plan, vous pouvez facilement synchroniser la liste de ces √©l√©ments avec l'interface graphique, sans <code>Dispatcher.Invoke</code> et un code passe-partout similaire: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BackgroundService</span></span> : <span class="hljs-title"><span class="hljs-title">IBackgroundService</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Declare the mutable data source containing trades. private readonly SourceList&lt;Trade&gt; _trades; // Expose the observable change set to the outside world. // If we have more than one subscriber, it is recommended // to use the Publish() operator from reactive extensions. public IObservable&lt;IChangeSet&lt;Trade&gt;&gt; Connect() =&gt; _trades.Connect(); public BackgroundService() { _trades = new SourceList&lt;Trade&gt;(); _trades.Add(new Trade()); // Mutate the source list! // Even from the background thread. } }</span></span></code> </pre> <br><p>  Avec l'aide des puissants op√©rateurs DynamicData, nous pouvons transformer <code>IObservable&lt;IChangeSet&lt;Trade&gt;&gt;</code> en <code>ReadOnlyObservableCollection</code> d√©clar√© dans notre mod√®le de vue. </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TradesViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReadOnlyObservableCollection&lt;TradeVm&gt; _trades; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ReadOnlyObservableCollection&lt;TradeVm&gt; Trades =&gt; _trades; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TradesViewModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IBackgroundService background</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Connect to the data source, transform elements, bind // them to the read-only observable collection. background.Connect() .Transform(x =&gt; new TradeVm(x)) .ObserveOn(RxApp.MainThreadScheduler) .Bind(out _trades) .DisposeMany() .Subscribe(); } }</span></span></code> </pre> <br><p>  En plus des op√©rateurs de <code>Transform</code> , de <code>Filter</code> et de <code>Sort</code> , DynamicData prend en charge le regroupement, les op√©rations logiques, l'aplatissement de la collection, l'utilisation de fonctions d'agr√©gation, l'√©limination d'√©l√©ments identiques, le comptage d'√©l√©ments et m√™me la virtualisation au niveau du mod√®le de vue.  Vous pouvez en savoir plus sur tous les op√©rateurs dans <a href="">le fichier README du projet sur GitHub</a> . </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/jy/6-/4a/jy6-4azw__6rou9alucffpjhkrq.gif"></a> <br><br>  Outre <code>SourceList</code> et <code>SourceCache</code> , la biblioth√®que DynamicData comprend une impl√©mentation de collection mutable √† un seul thread - <code>ObservableCollectionExtended</code> .  Pour synchroniser deux collections dans votre mod√®le de vue, d√©clarez l'une d'entre elles comme <code>ObservableCollectionExtended</code> et l'autre comme <code>ReadOnlyObservableCollection</code> , puis utilisez l'op√©rateur <code>ToObservableChangeSet</code> , qui fait presque la m√™me chose que Connect, mais est destin√© √† fonctionner avec <code>ObservableCollection</code> . </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Declare the derived collection. ReadOnlyObservableCollection&lt;TradeVm&gt; _derived; // Declare and initialize the source collection. var source = new ObservableCollectionExtended&lt;Trade&gt;(); source.ToObservableChangeSet(trade =&gt; trade.Key) .Transform(trade =&gt; new TradeProxy(trade)) .Filter(proxy =&gt; proxy.IsChecked) .Bind(out _derived) .Subscribe();</span></span></code> </pre> <br><p>  DynamicData prend √©galement en charge le suivi des modifications dans les classes qui impl√©mentent l'interface <code>INotifyPropertyChanged</code> .  Par exemple, si vous souhaitez recevoir des notifications chaque fois qu'une propri√©t√© change, utilisez l'op√©rateur <code>AutoRefresh</code> et passez le s√©lecteur de propri√©t√© requis.  <code>AutoRefresh</code> et d'autres op√©rateurs DynamicData peuvent vous permettre de valider sans effort un grand nombre de formulaires et de formulaires imbriqu√©s affich√©s √† l'√©cran! </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// IObservable&lt;bool&gt; var isValid = databases .ToObservableChangeSet() // Subscribe only to IsValid property changes. .AutoRefresh(database =&gt; database.IsValid) // Materialize the collection. .ToCollection() // Determine if all forms are valid. .Select(x =&gt; x.All(y =&gt; y.IsValid)); // If ReactiveUI is used, you can transform the // IObservable&lt;bool&gt; variable to a property declared // as ObservableAsPropertyHelper&lt;bool&gt;, eg IsValid. _isValid = isValid .ObserveOn(RxApp.MainThreadScheduler) .ToProperty(this, x =&gt; x.IsValid);</span></span></code> </pre> <br><p>  Vous pouvez cr√©er des interfaces utilisateur complexes √† l'aide de la fonctionnalit√© DynamicData, et cela est particuli√®rement pertinent pour les syst√®mes affichant une grande quantit√© de donn√©es en temps r√©el, comme les applications de messagerie instantan√©e et les syst√®mes de surveillance. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/98/nh/ws/98nhws7gl4yzk8kgcovbpvvozoi.gif"></a> <br><br></p><br><h1 id="conclusion">  Conclusion </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ReactiveX</a> est un outil puissant vous permettant de travailler avec des flux d'√©v√©nements et avec l'interface utilisateur, d'√©crire du code portable et maintenable et de r√©soudre des t√¢ches complexes de mani√®re simple et √©l√©gante.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ReactiveUI</a> permet aux d√©veloppeurs .NET d'int√©grer des extensions r√©actives dans leurs projets √† l'aide de l'architecture MVVM avec des impl√©mentations r√©actives d' <code>INotifyPropertyChanged</code> et <code>ICommand</code> , tandis que DynamicData s'occupe de la gestion de la collection en impl√©mentant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>INotifyCollectionChanged</code></a> , √©tendant les capacit√©s des extensions r√©actives en mettant l'accent sur les performances. </p><br><p>  Les biblioth√®ques ReactiveUI et DynamicData sont enti√®rement compatibles avec tous les frameworks GUI sur la plate-forme .NET, y compris Windows Presentation Foundation, Universal Windows Platform, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Avalonia</a> , Xamarin.Android, Xamarin Forms et Xamarin iOS.  Vous pouvez commencer √† √©tudier DynamicData sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page correspondante de la documentation ReactiveUI</a> .  Veillez √©galement √† vous familiariser avec le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DynamicData Snippets</a> , qui contient des exemples de code pour presque tout ce dont vous pourriez avoir besoin. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454074/">https://habr.com/ru/post/fr454074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454062/index.html">T√©l√©phone d'entreprise - comme un couteau suisse: pour l'inventaire, le chat, les appels d'assistance et les demandes de renseignements</a></li>
<li><a href="../fr454064/index.html">L'histoire in√©dite de l'IA</a></li>
<li><a href="../fr454066/index.html">Comment arr√™ter d'oublier les index et commencer √† v√©rifier le plan d'ex√©cution dans les tests</a></li>
<li><a href="../fr454070/index.html">Choisir une monoroue pour les d√©placements</a></li>
<li><a href="../fr454072/index.html">Cinq plus grands exemples de mensonges concernant la 5G</a></li>
<li><a href="../fr454076/index.html">DotNext 2019 Piter: petit rapport</a></li>
<li><a href="../fr454078/index.html">"Contenu mobile" gratuitement, sans SMS ni inscription. D√©tails sur la fraude au m√©gaphone</a></li>
<li><a href="../fr454082/index.html">Vagues plastiques: d√©sastre √©cologique des oc√©ans</a></li>
<li><a href="../fr454084/index.html">Directives en direct - MDX et autres frameworks</a></li>
<li><a href="../fr454086/index.html">Que retenait RIT ++ 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>