<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úãüèΩ üë®‚Äçüç≥ üéÖüèº Usando Golang para criar microsservi√ßos no The Economist: uma retrospectiva üëÉüèæ üó°Ô∏è üôÖüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! J√° em 28 de maio, estamos lan√ßando o primeiro grupo no curso Golang Developer . E hoje estamos compartilhando com voc√™ a primeira publica...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Usando Golang para criar microsservi√ßos no The Economist: uma retrospectiva</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/451760/">  Ol√° pessoal!  J√° em 28 de maio, estamos lan√ßando o primeiro grupo no curso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Golang Developer</a> .  E hoje estamos compartilhando com voc√™ a primeira publica√ß√£o dedicada ao lan√ßamento deste curso.  Vamos l√° <br><br><img src="https://habrastorage.org/webt/3r/wa/jy/3rwajyps3se5vmahtiv_ioninq0.png"><br><br>  <b>Trechos principais</b> <br><br><ul><li>  O Economist precisava de mais flexibilidade para distribuir conte√∫do para um canal digital cada vez mais diversificado.  Para atingir esse objetivo e manter um alto n√≠vel de desempenho e confiabilidade, a plataforma mudou de uma arquitetura monol√≠tica para uma de microsservi√ßo. </li><li>  As ferramentas escritas em Go foram um componente-chave do novo sistema, o que permitiu √† The Economist fornecer servi√ßos escal√°veis ‚Äã‚Äãe de alto desempenho e criar rapidamente novos produtos. </li><li>  O Go, voltado para simultaneidade e suporte √† API, junto com a constru√ß√£o de uma linguagem est√°tica compilada, facilitou o desenvolvimento de sistemas de processamento de eventos distribu√≠dos que podiam ser escalados.  O suporte a testes tamb√©m foi uma vantagem. </li><li>  Em geral, a experi√™ncia da equipe da Economist com a Go foi positiva, e esse foi um dos fatores decisivos que ajudaram a escalar a plataforma de conte√∫do. </li><li>  O Go nem sempre ser√° uma ferramenta adequada, e isso √© normal.  O Economist possui uma plataforma poliglota e usa diferentes idiomas onde faz sentido. </li></ul><a name="habracut"></a><br>  Entrei para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a</a> equipe de desenvolvimento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do The Economist</a> como desenvolvedor do Drupal.  No entanto, minha verdadeira tarefa era participar de um projeto que mudaria fundamentalmente a tecnologia de entrega de conte√∫do da Economist.  Nos primeiros meses que passei estudando o Go, v√°rios meses trabalhando com um consultor externo para criar um MVP (produto m√≠nimo vi√°vel) e, em seguida, ingressei na equipe novamente para supervisionar sua imers√£o no Go. <br>  Essa mudan√ßa na tecnologia foi desencadeada pela miss√£o do The Economist de expandir sua audi√™ncia digital, √† medida que o consumo de not√≠cias se afastava da m√≠dia impressa.  O Economist precisava de mais flexibilidade para fornecer conte√∫do para canais digitais cada vez mais diversos.  Para atingir esse objetivo e manter um alto n√≠vel de desempenho e confiabilidade, a plataforma mudou de uma arquitetura monol√≠tica para uma de microsservi√ßo.  As ferramentas escritas em Go foram um componente-chave do novo sistema, o que permitiu √† The Economist fornecer servi√ßos escal√°veis ‚Äã‚Äãe de alto desempenho e criar rapidamente novos produtos. <br><br>  Implementando Go in The Economist: <br><br><ul><li>  Engenheiros autorizados a desenvolver e implementar rapidamente novas funcionalidades. </li><li>  Pr√°ticas recomendadas aprovadas para servi√ßos de falha r√°pida com manipula√ß√£o inteligente de erros. </li><li>  Forneceu suporte confi√°vel para simultaneidade e opera√ß√£o de rede em um sistema distribu√≠do. </li><li>  Mostrou falta de maturidade e suporte em algumas √°reas necess√°rias para conte√∫do e m√≠dia. </li><li>  Facilitou uma plataforma que poderia ser escalada para publica√ß√£o digital. </li></ul><br>  <b>Por que o The Economist escolheu Go?</b> <br><br>  Para responder a essa pergunta, ser√° √∫til destacar a arquitetura geral da nova plataforma.  A plataforma, chamada Plataforma de Conte√∫do, √© um sistema de manipula√ß√£o de eventos.  Ele responde a eventos de diferentes plataformas de cria√ß√£o de conte√∫do e inicia um fluxo de processos executados em microsservi√ßos que trabalham separadamente.  Esses servi√ßos executam fun√ß√µes como padronizar dados, analisar tags sem√¢nticas, indexar no ElasticSearch e enviar conte√∫do para plataformas externas, como Apple News ou Facebook.  A plataforma tamb√©m possui uma API RESTful, que em combina√ß√£o com o GraphQL √© o principal ponto de entrada para clientes e produtos front-end. <br><br>  Ao desenvolver uma arquitetura comum, a equipe investigou quais idiomas atenderiam √†s necessidades da plataforma.  O Go foi comparado com Python, Ruby, Node, PHP e Java.  Embora cada idioma tenha seus pr√≥prios pontos fortes, o Go √© mais adequado √† arquitetura da plataforma.  O Go, voltado para simultaneidade e suporte √† API, junto com a constru√ß√£o de uma linguagem est√°tica compilada, facilitou o desenvolvimento de sistemas de processamento de eventos distribu√≠dos que podiam ser escalados.  Al√©m disso, a sintaxe relativamente simples do Go tornou f√°cil se envolver no desenvolvimento e come√ßar a escrever o c√≥digo de trabalho, que prometia benef√≠cios imediatos para uma equipe que passava por uma transi√ß√£o tecnol√≥gica t√£o grande.  Em geral, foi determinado que o Go √© o idioma mais adequado para usabilidade e efici√™ncia em um sistema em nuvem distribu√≠do. <br><br>  <b>Tr√™s anos depois: a Go se encaixou nesses objetivos ambiciosos?</b> <br><br>  Alguns elementos de design da plataforma estavam bem alinhados com o idioma Go.  Failing Fast era uma parte cr√≠tica do sistema porque consistia em servi√ßos independentes distribu√≠dos.  De acordo com os princ√≠pios do aplicativo de doze fatores ("aplicativo de 12 fatores"), o aplicativo teve que iniciar com rapidez e rapidez (falha r√°pida).  O design da Go como uma linguagem est√°tica e compilada fornece tempos de inicializa√ß√£o r√°pidos, e o desempenho do compilador est√° constantemente melhorando e nunca foi um problema para o design ou a implanta√ß√£o.  Al√©m disso, o design de manipula√ß√£o de erros da Go permitiu que os aplicativos falhassem n√£o apenas mais rapidamente, mas tamb√©m de maneira mais inteligente. <br><br>  <b>Tratamento de erros</b> <br><br>  Um recurso que os engenheiros notam rapidamente no Go √© que ele √© do tipo Erro, e n√£o um sistema de exce√ß√£o.  No Go, todos os erros s√£o valores.  O tipo de erro √© predefinido e √© uma interface.  Uma interface no Go √© essencialmente uma cole√ß√£o de m√©todos nomeada e qualquer outro tipo de usu√°rio pode satisfazer uma interface se ela tiver os mesmos m√©todos.  O tipo de erro √© uma interface que pode se descrever como uma string. <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> error <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Error() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> }</code> </pre> <br>  Isso oferece aos engenheiros mais controle e funcionalidade no tratamento de erros.  Ao adicionar um m√©todo Error que retorna uma string em qualquer m√≥dulo do usu√°rio, voc√™ pode criar seus pr√≥prios erros e ger√°-los, por exemplo, usando a fun√ß√£o Novo abaixo, que vem do pacote de Erros. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> errorString <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { s <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e *errorString)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> es }</code> </pre> <br>  O que isso significa na pr√°tica?  No Go, as fun√ß√µes permitem v√°rios valores de retorno; portanto, se sua fun√ß√£o n√£o funcionar, provavelmente retornar√° um valor de erro.  O idioma o incentiva a verificar explicitamente os erros onde eles ocorrem (em vez de lan√ßar e capturar uma exce√ß√£o); portanto, seu c√≥digo geralmente deve incluir uma verifica√ß√£o ‚Äúif err!  = Nulo "  No in√≠cio, esse tratamento frequente de erros pode parecer mon√≥tono.  No entanto, erro como um valor permite que voc√™ use Erro para simplificar o tratamento de erros.  Por exemplo, em um sistema distribu√≠do, voc√™ pode implementar facilmente tentativas de repetir consultas quebrando erros. <br><br>  Problemas de rede sempre ocorrer√£o no sistema, seja enviando dados para outros servi√ßos internos ou transferindo-os para ferramentas de terceiros.  Este exemplo de pacote de rede mostra como voc√™ pode usar o erro como um tipo para distinguir erros tempor√°rios de rede de erros permanentes.  A equipe do Economist usou um inv√≥lucro de erro semelhante para criar novas tentativas incrementais ao enviar conte√∫do para APIs externas. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Error <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { error Timeout() <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-comment"><span class="hljs-comment">// Is the error a timeout? Temporary() bool // Is the error temporary? } if nerr, ok := err.(net.Error); ok &amp;&amp; nerr.Temporary() { time.Sleep(1e9) continue } if err != nil { log.Fatal(err) }</span></span></code> </pre> <br>  Os autores do Go acreditam que nem todas as exce√ß√µes s√£o excepcionais.  √â mais prov√°vel que os engenheiros se recuperem de forma inteligente de erros do que travem o aplicativo.  Al√©m disso, o tratamento de erros Go permite controlar melhor os erros, o que pode melhorar aspectos como depura√ß√£o ou usabilidade de erros.  Na plataforma de conte√∫do, esse recurso de design do Go permitiu que os desenvolvedores tomassem decis√µes informadas sobre erros, o que levou a um aumento na confiabilidade do sistema como um todo. <br><br>  <b>Consist√™ncia dos dados</b> <br><br>  A consist√™ncia dos dados √© um fator cr√≠tico na plataforma de conte√∫do.  Na The Economist, o conte√∫do √© a base dos neg√≥cios, e o objetivo da Plataforma de Conte√∫do √© garantir que o conte√∫do possa ser publicado uma vez e esteja dispon√≠vel em qualquer lugar.  Portanto, √© importante que cada produto e consumidor tenham consist√™ncia de dados com a API da plataforma de conte√∫do.  Os produtos usam principalmente o GraphQL para solicita√ß√µes de API, o que requer um esquema est√°tico, que serve como um tipo de contrato entre os consumidores e a plataforma.  O conte√∫do processado pela Plataforma deve ser consistente com este esquema.  A linguagem est√°tica ajudou a implementar isso e facilitou o alcance da consist√™ncia dos dados. <br><br>  <b>Testando com Go</b> <br><br>  Outro recurso que promove consist√™ncia √© o conjunto de testes Go.  O r√°pido tempo de compila√ß√£o da Go, combinado com os testes de primeira classe como um recurso do idioma, permitiu √† equipe incorporar m√©todos de teste eficazes nos fluxos de trabalho de projeto e falhas r√°pidas nos pipelines de montagem.  As ferramentas de teste da Go facilitam a configura√ß√£o e a execu√ß√£o.  A execu√ß√£o de "go test" executar√° todos os testes no diret√≥rio atual e o comando test possui v√°rios sinalizadores √∫teis.  O sinalizador de capa fornece um relat√≥rio detalhado de cobertura de c√≥digo.  O teste de bancada executa testes de benchmark, que s√£o indicados executando o nome da fun√ß√£o de teste com a palavra "Bench" em vez de "Test".  A fun√ß√£o TestMain fornece m√©todos para configura√ß√£o de teste adicional, como um servidor de autentica√ß√£o fict√≠cia. <br><br>  Al√©m disso, o Go tem a capacidade de criar testes tabulares com estruturas an√¥nimas e stubs com interfaces, melhorando a cobertura do teste.  Embora o teste n√£o seja novo em termos de recursos de idioma, o Go facilita a cria√ß√£o de testes robustos e a integra√ß√£o f√°cil nos fluxos de trabalho.  Desde o in√≠cio, os engenheiros da The Economist puderam executar testes como parte dos pipelines de montagem sem configura√ß√£o especial e at√© adicionaram o Git Hooks para executar os testes antes de inserir o c√≥digo no Github. <br><br>  No entanto, o projeto n√£o foi sem esfor√ßo para alcan√ßar a consist√™ncia dos dados.  O primeiro grande problema da plataforma foi gerenciar conte√∫do din√¢mico a partir de back-ends imprevis√≠veis.  A plataforma consome conte√∫do dos sistemas CMS originais principalmente por pontos de extremidade JSON, onde a estrutura e os tipos de dados n√£o s√£o garantidos.  Isso significa que a plataforma n√£o pode usar o pacote Go padr√£o para interpretar o json, que suporta a desserializa√ß√£o JSON em estruturas, mas soa um alarme se os tipos dos campos de dados struct e de entrada n√£o corresponderem. <br><br>  Para superar esse problema, foi necess√°rio um m√©todo especial para mapear a parte do servidor para o formato padr√£o.  Ap√≥s v√°rias itera√ß√µes da abordagem escolhida, a equipe introduziu seu pr√≥prio processo de desserializa√ß√£o.  Embora essa abordagem tenha sido um pouco como refazer um pacote de biblioteca padr√£o, ela deu aos engenheiros controle total sobre o processamento dos dados de origem. <br><br>  <b>Suporte de rede</b> <br><br>  A escalabilidade estava na vanguarda da nova plataforma, e isso foi fornecido pelas bibliotecas padr√£o Go para redes e APIs.  No Go, voc√™ pode implementar rapidamente pontos de extremidade HTTP escal√°veis ‚Äã‚Äãsem a necessidade de estruturas.  No exemplo abaixo, o pacote da biblioteca padr√£o net / http √© usado para configurar um manipulador que aceita um gravador de solicita√ß√£o e resposta.  Quando a API da plataforma de conte√∫do foi implementada pela primeira vez, ela usou a estrutura da API.  Ele acabou sendo substitu√≠do por uma biblioteca padr√£o, pois a equipe reconheceu que atende a todas as suas necessidades de rede sem compromissos desnecess√°rios adicionais.  Os manipuladores HTTP Golang s√£o dimensionados porque cada solicita√ß√£o ao manipulador √© executada em paralelo na Goroutine, um encadeamento leve, sem a necessidade de personaliza√ß√£o. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, handler) log.Fatal(http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)) }</code> </pre> <br>  <b>Modelo de simultaneidade</b> <br><br>  O modelo de concorr√™ncia Go ofereceu v√°rios benef√≠cios na melhoria do desempenho em toda a plataforma.  Trabalhar com dados distribu√≠dos envolve mexer com as garantias prometidas aos consumidores.  De acordo com o teorema da PAC, n√£o √© poss√≠vel fornecer mais de duas das tr√™s garantias a seguir ao mesmo tempo: Consist√™ncia dos dados.  Disponibilidade  Resistente √† separa√ß√£o.  Na plataforma Economist, a consist√™ncia foi finalmente adotada, o que significa que a leitura das fontes de dados ser√° consistente e atrasos moderados em todas as fontes de dados que atingem um estado consistente s√£o aceit√°veis.  Uma maneira de minimizar essa lacuna √© usar Goroutines. <br><br>  Goroutines s√£o threads leves, gerenciados pelo tempo de execu√ß√£o Go, para impedir que fiquem sem threads.  Goroutines permitiu otimizar tarefas ass√≠ncronas na plataforma.  Por exemplo, um dos reposit√≥rios de dados da plataforma √© o Elasticsearch.  Quando o conte√∫do √© atualizado no sistema, o conte√∫do que referencia esse item no Elasticsearch √© atualizado e reindexado.  Gra√ßas √† implementa√ß√£o das Goroutines, o tempo de processamento foi reduzido, o que garantiu a consist√™ncia r√°pida dos elementos.  Este exemplo mostra como os itens adequados para reprocessamento s√£o reprocessados ‚Äã‚Äãna Goroutine. <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reprocess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(searchResult *http.Response)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { responses := <span class="hljs-built_in"><span class="hljs-built_in">make</span></span>([]response, <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(searchResult.Hits)) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wg sync.WaitGroup wg.Add(<span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(responses)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, hit := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> searchResult.Hits { wg.Add(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(i </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, item elastic.SearchHit)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> wg.Done() code, err := reprocessItem(item) responses[i].code = code responses[i].err = err }(i, *hit) } wg.Wait <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> http.StatusOK, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  Projetar sistemas √© mais do que apenas programa√ß√£o.  Os engenheiros precisam entender quais ferramentas, onde e quando s√£o apropriadas.  Embora o Go fosse uma ferramenta poderosa para a maioria das necessidades da plataforma de conte√∫do do The Economist, algumas limita√ß√µes exigiam outras solu√ß√µes. <br><br>  <b>Gerenciamento de Depend√™ncias</b> <br><br>  Quando o Go foi lan√ßado, ele n√£o tinha um sistema de gerenciamento de depend√™ncias.  Dentro da comunidade, v√°rias ferramentas foram desenvolvidas para atender a essa necessidade.  O Economist usou sub-m√≥dulos Git, que faziam sentido no momento em que a comunidade estava promovendo ativamente uma ferramenta padr√£o de gerenciamento de depend√™ncias.  Hoje, embora a comunidade j√° esteja muito mais pr√≥xima de uma abordagem coerente ao gerenciamento de depend√™ncias, ela n√£o existe.  A abordagem The Economist usando subm√≥dulos n√£o apresentou problemas s√©rios, mas era dif√≠cil para outros desenvolvedores do Go, e isso deve ser levado em considera√ß√£o ao mudar para o Go. <br><br>  Tamb√©m havia requisitos de plataforma para os quais os recursos ou o design do Go n√£o eram a melhor solu√ß√£o.  Como a plataforma adicionou suporte ao processamento de √°udio, as ferramentas da Go para extrair metadados eram limitadas na √©poca e, portanto, a equipe escolheu o Exiftool Python.  Os servi√ßos de plataforma funcionam em cont√™ineres de docker, o que permitiu instalar o Exiftool e inici√°-lo a partir do aplicativo Go. <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runExif</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { cmdOut, err := exec.Command(<span class="hljs-string"><span class="hljs-string">"exiftool"</span></span>, args...).Output() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cmdOut, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  Outro cen√°rio comum para a plataforma √© a recep√ß√£o de c√≥digo HTML que n√£o funciona dos sistemas CMS de origem, an√°lise do c√≥digo HTML para corre√ß√£o e limpeza do c√≥digo HTML.  Inicialmente, o Go era usado para esse processo, mas como a biblioteca HTML padr√£o do Go requer HTML correto, era necess√°ria uma grande quantidade de c√≥digo personalizado para analisar o HTML antes do processamento.  Esse c√≥digo rapidamente se tornou fr√°gil e perdeu casos lim√≠trofes, ent√£o uma nova solu√ß√£o foi implementada em Javascript.  O Javascript forneceu grande flexibilidade e adaptabilidade para controlar o processo de verifica√ß√£o e limpeza do HTML. <br><br>  Javascript tamb√©m foi uma escolha comum para filtrar e rotear eventos na plataforma.  Os eventos s√£o filtrados usando o AWS Lambdas, que s√£o fun√ß√µes leves que s√≥ s√£o executadas quando chamadas.  Um caso de uso √© filtrar eventos em diferentes bandas, como r√°pida e lenta.  Essa filtragem √© baseada em um √∫nico campo de metadados no objeto JSON do shell do manipulador de eventos.  A implementa√ß√£o de filtragem usou um pacote de ponteiro JSON Javascript para capturar um elemento em um objeto JSON.  Essa abordagem foi muito mais eficiente em compara√ß√£o √† desmontagem completa do JSON que o Go precisaria.  Embora a funcionalidade desse tipo pudesse ser alcan√ßada com o Go, o uso de Javascript era mais f√°cil para os engenheiros e fornecia lambdas mais simples. <br><br>  <b>Retrospective Go</b> <br><br>  Depois de implementar a plataforma de contato e apoi√°-la na produ√ß√£o, se eu conduzir uma retrospectiva do Go e da plataforma de conte√∫do, meus coment√°rios ser√£o os seguintes: <br><br>  O que j√° √© bom? <br><br><ul><li>  Elementos chave de design de linguagem para sistemas distribu√≠dos. </li><li>  Um modelo de simultaneidade que √© relativamente f√°cil de implementar. </li><li>  Boa codifica√ß√£o e comunidade divertida. </li></ul><br>  O que pode ser melhorado? <br><br><ul><li>  Avan√ßo adicional nos padr√µes de controle de vers√£o e vendas. </li><li>  N√£o h√° maturidade suficiente em algumas √°reas. </li><li>  Detalhes para casos de usu√°rio espec√≠ficos. </li></ul><br>  Em geral, foi uma experi√™ncia positiva e o Go √© um dos elementos mais importantes que permitiram escalar a plataforma de conte√∫do.  O Go nem sempre ser√° uma ferramenta adequada, e isso √© normal.  O Economist possui uma plataforma poliglota e usa diferentes idiomas onde faz sentido.  Provavelmente, o Go nunca ser√° a melhor op√ß√£o quando voc√™ precisar mexer em objetos de texto e conte√∫do din√¢mico; portanto, o Javascript ainda est√° na caixa de ferramentas.  No entanto, os pontos fortes da Go s√£o a base que permite ao sistema escalar e crescer. <br>  Ao considerar se o Go √© adequado para voc√™, considere os principais problemas do design do sistema: <br><br><ul><li>  Quais s√£o as tarefas do seu sistema? </li><li>  Que garantias voc√™ oferece aos seus consumidores? </li><li>  Que arquitetura e padr√µes s√£o apropriados para o seu sistema? </li><li>  Como o seu sistema deve escalar? </li></ul><br>  Se voc√™ estiver desenvolvendo um sistema que lide com os desafios de dados distribu√≠dos, fluxos de trabalho ass√≠ncronos e alto desempenho e escalabilidade, recomendo que voc√™ considere o Go e seus recursos para acelerar seus objetivos de sistema. <br><br>  Amigos, aguardamos seus coment√°rios e convidamos todos para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">semin√°rio on-line aberto</a> , que ser√° realizado no dia 16 pelo desenvolvedor s√™nior da Yandex e, em conjunto, nosso professor √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dmitry Smal</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt451760/">https://habr.com/ru/post/pt451760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt451748/index.html">Monitorando o status do SSD em matrizes Qsan</a></li>
<li><a href="../pt451750/index.html">Livro "Elasticsearch, Kibana, Logstash e pr√≥xima gera√ß√£o de mecanismos de pesquisa"</a></li>
<li><a href="../pt451752/index.html">30¬∫ anivers√°rio de inseguran√ßa desenfreada</a></li>
<li><a href="../pt451754/index.html">Como encontramos express√µes lambda no IntelliJ IDEA</a></li>
<li><a href="../pt451758/index.html">Uplinks adicionais na arquitetura l√≥gica do sistema Intel C620</a></li>
<li><a href="../pt451766/index.html">Heisenbug 2019 Piter: o que acontecer√° na transmiss√£o gratuita e o que apenas no evento</a></li>
<li><a href="../pt451768/index.html">Melhorando o trabalho do Wi-Fi. Princ√≠pios gerais e coisas √∫teis</a></li>
<li><a href="../pt451770/index.html">Veeam Backup & Replication: Dicas √∫teis para viabilizar backups e r√©plicas</a></li>
<li><a href="../pt451772/index.html">O que h√° de especial em Cloudera e como cozinh√°-lo</a></li>
<li><a href="../pt451776/index.html">Como programo mecanismos de interpreta√ß√£o de pap√©is no Planilhas Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>