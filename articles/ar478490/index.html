<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤑 👩🏾‍🤝‍👨🏿 🔝 Levenshtein المسافة والبحث عن وحدات التحكم 🧓 ⛪️ 🐵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ربما ، في كل مدينة في بيلاروسيا حيث توجد عربات ترولي ، توجد مجموعات VK أو دردشات على Telegram يتعقب فيها الأشخاص موقع وحدات التحكم. يتم ذلك بشكل أساسي...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Levenshtein المسافة والبحث عن وحدات التحكم</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478490/" style=";text-align:right;direction:rtl">  ربما ، في كل مدينة في بيلاروسيا حيث توجد عربات ترولي ، توجد مجموعات VK أو دردشات على Telegram يتعقب فيها الأشخاص موقع وحدات التحكم.  يتم ذلك بشكل أساسي حتى لا تدفع مقابل السفر والسفر مجانًا ، على الرغم من أن وصف المجموعات دائمًا ما يحتوي على حاشية "الدفع مقابل السفر". <br><a name="habracut"></a><br>  في VC ، يبدو عادةً كما يلي: <br><br><img src="https://habrastorage.org/webt/ti/eh/cd/tiehcdyeskmccfofp3adt2ko_qe.png" alt="صورة"><br><br>  تعليق نموذجي يشبه هذا: <br><br><img src="https://habrastorage.org/webt/ki/kp/s0/kikps0wwqqptfwyro8hrf81rtzg.png" alt="صورة"><br><br>  الهيكل بسيط للغاية.  في التعليق ، توجد أسماء للإيقاف حيث تم ملاحظة وحدات التحكم حاليًا ، وهناك أيضًا الاتجاه الذي يقفون فيه: <br><br><img src="https://habrastorage.org/webt/no/gy/2l/nogy2l1lrraa8gte90lcyuwsume.png" alt="صورة"><br><br>  ونتيجة لذلك ، فإن التعليق هو كائن ذو توقف ووقت وتاريخ ، بالإضافة إلى معرف فريد يمكننا من خلاله التعرف عليه.  باستخدام هذا ، يمكنك حساب الموقع الأكثر احتمالًا حيث توجد وحدات التحكم الآن. <br><br><h4 style=";text-align:right;direction:rtl">  تدريب </h4><br>  تحتاج أولاً إلى تحديد الجمهور المستهدف ، الذي سنقوم من خلاله بتحليل البيانات.  يجب أن يكون للمجموعة نشاط كبير في التعليقات ، وإلا فإننا نجازف بالحصول على القليل جدًا من البيانات <br><br>  في حالتي ، هذه هي مجموعة "Control Gomel". <br><br>  سنقوم بتحليل التعليقات باستخدام واجهة VKontakte API الرسمية لبيثون <br><br>  نحن نقوم بالمصادقة باستخدام مفتاح وصول المستخدم ، حيث قد يتم إغلاق بعض المجموعات ، ولا يمكن الوصول إلى تعليقاتهم إلا إذا تم قبولك في المجموعة. <br>  بعد ذلك ، يمكنك البدء في استخراج التعليقات: <br><br><h4 style=";text-align:right;direction:rtl">  تلقي التعليقات </h4><br>  بادئ ذي بدء ، نحصل على آخر منشور متاح في المجموعة لسحب التعليقات من خلال vk.wall.getComments ، وتهيئة DataFrame ، حيث سنقوم بحفظ البيانات. <br><br>  يحتوي كل منشور للتعليق على نقش "أتمنى لك يومًا سعيدًا ، وادفع الأجرة ولا تقع تحت السيطرة" ، لذا قم بتنزيل التعليقات ، والتحقق من محتويات المنشور والحصول على مجموعة من التعليقات التي يمكنك من خلالها أخذ البيانات. <br><br>  أخذت تعليقات من المشاركات على مدار الثلاثة أشهر الماضية ، بالنظر إلى أن هناك منشورًا واحدًا يتم نشره يوميًا (الآن في نهاية نوفمبر ، وتبدأ السنة الدراسية في سبتمبر ، وعلى الأرجح أن يأخذ المتحكمون ذلك في الاعتبار ويغيرون أماكنهم العادية).  من حيث المبدأ ، يمكن أخذ علامات أخرى في الاعتبار ، مثل ، على سبيل المثال ، الوقت من السنة. <br><br>  بعض التعليقات مسدودة برسائل مثل "هل يوجد أحد على باريكين؟"  إذا نظرت إلى هذه التعليقات (غير الضرورية) ، يمكنك تسليط الضوء على بعض العلامات: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يحتوي النص على الكلمات "النظيفة" ، "اليسار" ، "لا أحد" وما شابه </li><li style=";text-align:right;direction:rtl">  الكلمات "قل لي" ، "من" ، "ماذا" ، "كيف" </li><li style=";text-align:right;direction:rtl">  الرموز ، مثل الرموز ، على سبيل المثال </li></ul><br>  بعد ذلك ، نتصفح مجموعة من التعليقات ونستخرج منها معرفًا فريدًا ونصًا ووقتًا وتاريخًا ويومًا من الأسبوع ، نضعها في DataFrame الذي تم إنشاؤه بالفعل. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">تلقي التعليقات</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vk_api <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> check_correctness <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> vk_session = vk_api.VkApi(lp.login, lp.password) vk_session.auth() vk = vk_session.get_api() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vk <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDataFromComments</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(vk, groupID)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     posts = vk.wall.get(owner_id=groupID, offset=1, count=90) print("\n") data = pd.DataFrame(columns=['text', 'post_id', "date", "day_in_week", "hour","minute", "day_in_month"]) for post in posts.get("items"): # id     postID = post.get("id") if "  ,       " not in post.get("text"): continue #  commentary       comments = vk.wall.getComments(owner_id=groupID, post_id=postID, count=200) #           dataframe for comment in comments.get("items"): text = comment.get("text") text = re.sub(r"A-Za-z--0123456789 ", "", str(text)) commentaryIsNice = check_correctness.detection(text) if commentaryIsNice: print(text) date = comment.get("date") time_struct = time.gmtime(date) post_id = comment.get("post_id") data = data.append({"text": text, "post_id" : post_id, "date": date,"day_in_week" : time_struct.tm_wday, "hour": (time_struct.tm_hour+3), "minute": time_struct.tm_min, "day_in_month": time_struct.tm_mday}, ignore_index=True) # print(data[:10]) # print(data.info()) print("dataset is ready") return data</span></span></code> </pre> <br></div></div><br>  وبالتالي ، تلقينا DataFrame مع نص التعليقات ومعرفهم ويوم الأسبوع والساعة والدقيقة التي كُتب فيها التعليق.  نحتاج فقط إلى يوم الأسبوع وساعة الكتابة والنص.  يبدو شيء مثل هذا: <br><br><img src="https://habrastorage.org/webt/cd/hs/cy/cdhscyg3rx4f5kejgvjdguuscui.png" alt="صورة"><br><br><h4 style=";text-align:right;direction:rtl">  تطهير البيانات </h4><br>  الآن نحن بحاجة لمسح البيانات.  من الضروري إزالة الاتجاه من التعليق من أجل تقليل الأخطاء عند البحث عن مسافة Levenshtein.  نجد التعبيرات "إلى الجانب" ، و "اذهب" ، و "كيف" ، و "قريب" ، حيث يتم اتباعها عادةً باسم المحطة الثانية ، ونحذفها مع ما يأتي بعدها ، وكذلك نستبدل بعض أسماء المصطلحات من المحطات بالآتي . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">مسح البيانات</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fuzzywuzzy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> process <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clear_commentary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    -     """</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span> splitted = text.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(splitted): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(splitted) == <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.NaN <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ( <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ( <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s)) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>): index = i <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> index <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> index &lt; len(splitted) - <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): splitted.remove(splitted[index]) string = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join(splitted) text = (string.lower()) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> index <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: splitted = splitted[:index] string = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join(splitted) text = string.lower() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: text = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join(splitted).lower() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clean_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> data.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>].map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: clear_commentary(s)) data.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) print(<span class="hljs-string"><span class="hljs-string">"cleaned"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data</code> </pre> <br></div></div><br><h4 style=";text-align:right;direction:rtl">  تحويل باستخدام المسافة Levenshtein </h4><br>  ننتقل مباشرة إلى مسافة ليفينشان.  القليل من المساعدة: مسافة Levenshtein - الحد الأدنى لعدد العمليات لإدخال حرف واحد ، وحذف حرف واحد واستبدال حرف واحد بآخر ، ضروري لتحويل سطر واحد إلى آخر. <br><br>  سوف نجدها باستخدام مكتبة <a href="https://github.com/seatgeek/fuzzywuzzy">fuzzywuzzy</a> .  انها تساعدك بسرعة وسهولة حساب المسافة Levenshtein.  لتسريع العمل ، يوصي مؤلفو المكتبة أيضًا بتثبيت مكتبة بيثون ليفينشتاين. <br><br>  من أجل الحصول على نقاط توقف من التعليقات ، نحتاج إلى قائمة من المحطات.  تم تقديمه لي من قبل مطور تطبيق GoTrans ، ألكسندر كوزلوف. <br><br>  يجب توسيع القائمة ، مع إضافة بعض التوقفات التي لم تكن موجودة ، وتغيير جزء من الأسماء بحيث تكون في موقع أفضل. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">توقف</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  توقف = ["سوبر ماركت" ، "مرج" ، "ريميبتخنيكا" ، "لينينغراد" ، "ياروسلافل" ، "بوليسكايا" ، <br>  "ياروسلافل" ، "تيموفينكو" ، "8 مارس" ، <br>  "بيت التجارة Rechitsky" ، "شارع Rechitsky" ، "السيرك" ، "متجر كبير" ، "Chongarskaya" ، <br>  "chongarka" ، "ggu" ، "skorina" ، "الجامعة" ، "الأجهزة" ، "1000 الأشياء الصغيرة" ، "maya" ، "station" ، <br>  "حديقة الخريجين" ، "التجارة والاقتصادية" ، "الذكرى" ، "المقاطعة الصغيرة 18" ، "المطار" ، "قدوم" ، <br>  "gomelgeodezcentr" ، "Crystal" ، "بحيرة lyubenskoye" ، "سوق davydovsky" ، "davydovka" ، <br>  "نهر sozh" ، "gomeldrev" ، <br>  "Sevruki" ، "gmu رقم 1" ، "إلخ Rechitsky" ، "الزي" ، "مستشفى الأمراض المعدية" ، "معسكر النورس" ، <br>  فولوتوفا ، كورال ، غوميلتورغماش ، غوميلبروكت ، فنشغوملستروي ، صحيفة ، <br>  "كالينيكوفا" ، "إريمينو" ، "تقطير" ، "أتمتة صناعية خاصة" ، "المدرسة الثانية" ، "باريكينا" ، <br>  "وحدات الآلة" ، "الشباب" ، "هيئة الصب" ، "الكيميائيون" ، "golovatsky" ، "budenny" ، <br>  "spu67" ، "35" ، "gagarin" ، و 50 عامًا إلى مصنع Gomselmash "،" التل "،" مصنع الراديو "، <br>  "الجدة" ، "الأعمال الزجاجية" ، "الكستناء" ، "تشغيل المحركات" ، "رواد الفضاء" ، <br>  "rtsrm الأولي" ، "bykhovskaya" ، "معهد وزارة حالات الطوارئ" ، "dk gomselmash" ، "store" ، "rechitsky" <br>  "Sevruks" ، "Osovtsy" ، "سائح" ، "مصنع لحوم" ، "Holy Trinity" ، "مدينة طبية" ، "أكتوبر" ، <br>  "مستودع الزيت" ، "gomelloblavtotrans" ، "milkavita" ، "bakunin" ، "zip" ، "oma" ، "الراتنج" ، <br>  "سوق البناء ksk" ، "بناء الطرق" ، "الحقل" ، "kamenetskaya" ، "البلشفية" ، "jakubovka" ، <br>  "Borodina" ، "هايبرو هايبر ماركت" ، "الأبطال السريون" ، "9 مايو" ، "الكستناء" ، "الأطراف الصناعية" ، <br>  "محطة iput" ، "شيوعية دولية" ، "كلية تربوية موسيقية" ، "شركة زراعية" ، "طريق الالتفاف" ، "النصر" ، <br>  "الغربي" ، "اللؤلؤ" ، "فلاديمير" ، "جاف" ، "مستوصف" ، "إيفانوفا" ، <br>  "بناء الآلات" ، "البتولاين" ، "60 عامًا" ، "مهندس كهرباء" ، "سنتروليت" ، <br>  "عيادة الأورام" ، "مجموعة الرماية" ، "golovintsy" ، "المرجان" ، "الجنوبية" ، "الربيع" ، <br>  Efremova ، الحدود ، Belgut ، جوميلستروي ، بوريسينكو ، قصر ألعاب القوى ، <br>  "Michurinsky" ، "الطاقة الشمسية" ، "gastello" ، "العسكرية" ، "مركز السيارات" ، "السباكة" ، "Uza" ، <br>  "كلية الطب" ، "رياض الأطفال 11" ، "البلشفية" ، "الجراء" ، "دافيدوفسكي" ، "المحيط" ، "التقدم" ، <br>  "Dobrushskaya" ، "الأبيض" ، "GSK" ، "davydovka" ، "المعدات الكهربائية" ، "الصداقة" ، <br>  "70 سنة" ، "إصلاح سيارة" ، "تل سويدي" ، "دائرة" ، "قناة مياه" ، "آلة غوميل" ، <br>  Volotova، Pioneer، RCM، Khimtorg، 2nd Meadow Lane، Bochkina، حمامات، <br>  "عيادة الأورام" ، "المربع" ، "لينين" ، "المدرسة الأولى" ، "المتجر الجنوبي" ، <br>  "gomelagrotrans" ، "millers" ، "lyubensky" ، "مكتب تجنيد عسكري" ، "مستشفى" ، "Uza" ، "rtsrm" ، <br>  'lysyukovyh' ، 'متجر iput' ، 'raton' ، 'محطة وقود' ، 'randovsky' ، 'مزرعة' ، 'كستناء' ، 'ropovsky' ، <br>  "رومانوفيتشي" ، "إيليتش" ، "التجديف" ، "مؤسسة البناء" ، "المعدية" ، <br>  "مصنع الدهون" ، "خدمة السيارات" ، "الخدمات الزراعية" ، "لزجة" ، "نيكولسكايا" ، <br>  "الحصادات ذاتية الدفع" ، "البنائين" ، "مواد البناء" ، "آلات الإصلاح" ، "الإدارة" ، <br>  "أكتوبر" ، "حكاية خرافية الغابات" ، "تاتيانا" ، "بوريس تساريكوف" ، "زاركوفسكي" ، "زايتسيفا" ، <br>  "النقل" ، "Karpovich" ، "محطة بناء المنازل" ، "النقل الكهربائي في المدينة" ، "zlin" ، <br>  "ملعب gomselmash" ، "ap 6" ، "محرك هيدروليكي" ، "مستودع قاطرة" ، "osovtsy سوق السيارات" ، <br>  "حياة جديدة" ، "جوكوفا" ، "وحدة عسكرية" ، "مدرسة ثالثة" ، "غابة" ، "منارة حمراء" ، <br>  "الإقليمية" ، "دافيدوفسكايا" ، "كاربيشيفا" ، "قمر العالم" ، "الشباب" ، "قاطرة الاستاد" ، <br>  "الطاقة الشمسية" ، "لاديسيرفيسي" ، "21 رر" ، "آريسا" ، "الدوليون" ، "كوساريفا" ، <br>  "بوغدانوفا" ، "غوميل للحديد والخرسانة" ، "20 أ" ، "ريتشيتسكي" ، "معدات طبية" ، "جورايفا" ، <br>  "كلية الحرف الفنية" ، "الجليد" ، "مهرجان دبي للتسوق" ، "مركز التسوق" ، <br>  "كويبيشيفسكي" ، "مهرجان" ، "مرآب كووب 27" ، "هندسة زلزالية" ، "ميلشا" ، "مستشفى أنبوب" ، <br>  "ptu179" ، "المنتجات الكيماوية" ، "إدارة الإطفاء" ، "المستشفى" ، "مستودع الحافلات" ، <br>  "مجمع الصحف" ، "النصر" ، "klenkovsky" ، "الماس" ، "إصلاح المحرك" ، "mkr 19"] <br></div></div><br>  باستخدام .map و fuzzywuzzy.process.extractOne ، نجد المحطة مع الحد الأدنى لمسافة Levenshtein في القائمة ، وبعد ذلك نستبدل نص التعليق باسم المحطة ، مما يسمح لنا بالحصول على مجموعة بيانات بأسماء المحطات. <br><br>  تبدو مجموعة البيانات الناتجة مثل هذا: <br><br><img src="https://habrastorage.org/webt/gd/pd/c8/gdpdc8lwdppzpastghnasxbqsbi.png"><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">التعليقات تتحول إلى توقف</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_category_from_comment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""              """</span></span> dict = process.extractOne(text.lower(), stops) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dict[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">75</span></span>: text = dict[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: text = np.nan print(<span class="hljs-string"><span class="hljs-string">"wait"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_category_dataset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      """</span></span> print(<span class="hljs-string"><span class="hljs-string">"remap started. wait"</span></span>) data.text = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> comment: get_category_from_comment(str(comment))) print(<span class="hljs-string"><span class="hljs-string">"remap ends"</span></span>) data.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data</code> </pre> <br></div></div><br><h4 style=";text-align:right;direction:rtl">  إخراج البيانات </h4><br>  الآن يمكننا أن نفترض أين ستكون وحدات التحكم على الأرجح في ساعة معينة. <br><br>  نحن نبحث في سجلات البيانات الناتجة لمدة ساعة ويوم معين من الأسبوع.  على سبيل المثال ، يوم الثلاثاء ، الساعة 9 صباحًا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">&lt;code&gt;data[(data[<span class="hljs-string"><span class="hljs-string">"day_in_week"</span></span>] == day) &amp; (data[<span class="hljs-string"><span class="hljs-string">"hour"</span></span>] == hour)]&lt;/code&gt;</code> </pre> <br><img src="https://habrastorage.org/webt/t4/gg/dg/t4ggdgmwezje8lgllisorbqrqwa.png"><br>  <i>(هذه ليست جميع البيانات)</i> <br><br>  بعد ذلك ، نجد عدد نقاط التوقف الفريدة ، ونعرض فقط نقاط التوقف وعددها: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">df[(df[<span class="hljs-string"><span class="hljs-string">"day_in_week"</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">"hour"</span></span>] == <span class="hljs-number"><span class="hljs-number">9</span></span>)][<span class="hljs-string"><span class="hljs-string">"text"</span></span>].value_counts()</code> </pre> <br><img src="https://habrastorage.org/webt/yq/az/if/yqazifl3gkclyqw4ifykvemsrky.png"><br><br>  الآن يمكننا أن نقول أنه في تمام الساعة التاسعة صباحًا ، يوم الثلاثاء ، من المرجح أن يتم رصد وحدات التحكم عند نقاط توقف Myasokombinat ، ul.  Lugovaya ، BelGUT ، TD "Oma". <br><br>  العيب الرئيسي في هذه الطريقة هو نقص البيانات.  ليس لكل الأيام والساعات ، هناك إدخالات في التعليقات المقدمة خلال ساعة الذروة ، عندما يستخدم الناس وسائل النقل العام أكثر من البيانات في ساعات أقل شعبية ، ولكن إذا قمت بإضافة البيانات ، على سبيل المثال ، ليس فقط من تعليقات مجموعة واحدة ، ولكن أيضًا من المجموعات البديلة ، أو محادثات الدردشات البرقية ، مع عدد الإدخالات ، سيصبح كل شيء أسهل. <br><br><h4 style=";text-align:right;direction:rtl">  بوت مع VK LongPoll API </h4><br>  لإتاحة الفرصة لتلقي البيانات على موقع وحدات التحكم ، بناءً على الوقت ، وبدون ربطه بجهاز كمبيوتر ، قمت بعمل روبوت لمجموعة على فكونتاكتي تستجيب لأي رسالة عن طريق إرسال عدد التوقفات في السجلات ، بالنظر إلى الساعة واليوم الحاليين من الأسبوع. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">رمز بوت</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> randint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vk_api <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> get_stops_from_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> get_stops_by_time <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_bot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, token)</span></span></span><span class="hljs-function">:</span></span> vk_session = vk_api.VkApi(token=token) vk = vk_session.get_api() print(<span class="hljs-string"><span class="hljs-string">"bot started"</span></span>) longPoll = vk.groups.getLongPollServer(group_id=<span class="hljs-number"><span class="hljs-number">183524419</span></span>) server, key, ts = longPoll[<span class="hljs-string"><span class="hljs-string">'server'</span></span>], longPoll[<span class="hljs-string"><span class="hljs-string">'key'</span></span>], longPoll[<span class="hljs-string"><span class="hljs-string">'ts'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  :   ts longPoll = post('%s' % server, data={'act': 'a_check', 'key': key, 'ts': ts, 'wait': 25}).json() if longPoll['updates'] and len(longPoll['updates']) != 0: for update in longPoll['updates']: if update['type'] == 'message_new': #        vk.messages.markAsRead(peer_id=update['object']['user_id']) user = update['object']["user_id"] text = get_stops_by_time(data) if text is None or text == {}: message = "íåò çàïèñåé" vk.messages.send(user_id=user, random_id=randint(-2147483648, 2147483647), message=message) print(message) ts = longPoll['ts'] continue message = "   -     \n" \ "\n \n" for i in text.items(): message += i[0] + " " message += str(i[1]) message += "\n" #    vk.messages.send(user_id=user, random_id=randint(-2147483648, 2147483647), message=message) ts = longPoll['ts']</span></span></code> </pre> <br></div></div><br><h4 style=";text-align:right;direction:rtl">  استنتاج </h4><br>  تم اختبار جودة هذه الفرضيات من قبلي أكثر من مرة في الممارسة ، وكل شيء يعمل بشكل جيد.  اتضح أن وحدات التحكم ، في الأساس ، هي في المحطات نفسها ، على الرغم من أنه لا يمكن إعطاء تنبؤات صحيحة تمامًا ، واحتمال النجاح ليس 100٪.  تشتمل مسافة Levenshtein على العديد من التطبيقات المختلفة ، بدءًا من تصحيح الأخطاء في كلمة واحدة ، مقارنة الجينات والكروموسومات والبروتينات ، ولكنها تنطوي أيضًا على إمكانات في مثل هذه المشكلات التطبيقية. <br><br>  أتمنى لك يومًا سعيدًا وادفع الأجرة. <br><br>  يتم نشر جميع التعليمات البرمجية وروبوتات التلاعب <a href="https://github.com/dingdongyouarewrong/vk_controllers_bot">هنا</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar478490/">https://habr.com/ru/post/ar478490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar478474/index.html">كما أصدر الأخ بابلو إسكوبار هاتفًا ذكيًا مرنًا</a></li>
<li><a href="../ar478480/index.html">الذكاء الاصطناعي ، ITSM ، وبشكل عام ، أين العجاف؟</a></li>
<li><a href="../ar478482/index.html">قام المطور بفتح شريط للمطورين واستضافة الاجتماعات هناك على الزاوي ، التخطيط ، PHP</a></li>
<li><a href="../ar478484/index.html">SCADA على توت العليق: أسطورة أم حقيقة؟</a></li>
<li><a href="../ar478486/index.html">عصر رقائق 10 نانومتر - الذي يطور هذه المعالجات وما ينتظر هذه الصناعة في المستقبل</a></li>
<li><a href="../ar478492/index.html">الإشريكية القولونية على نظام غذائي لثاني أكسيد الكربون: أداة جديدة في مكافحة ظاهرة الاحتباس الحراري؟</a></li>
<li><a href="../ar478494/index.html">Winnum TRP المعالجة الحرارية الحل: الإعداد والاستخدام</a></li>
<li><a href="../ar478496/index.html">قبل 50 عامًا في الغرفة رقم 3420 ، وُلد الإنترنت</a></li>
<li><a href="../ar478498/index.html">1. Fortinet بدء التشغيل 6.0. مقدمة</a></li>
<li><a href="../ar478500/index.html">لماذا لا يوجد سوى عدد قليل من المؤتمرات في الصيف؟</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>