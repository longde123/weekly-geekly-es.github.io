<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–¨ï¸ â›¸ï¸ ğŸŒ¥ï¸ Cï¼ƒ7ä¸­çš„æ¨¡å¼åŒ¹é… ğŸ§’ğŸ¼ ğŸ§ ğŸŒ¥ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cï¼ƒ7ç»ˆäºæœ‰äº†æœŸå¾…å·²ä¹…çš„åŠŸèƒ½ï¼Œç§°ä¸ºæ¨¡å¼åŒ¹é…ã€‚ å¦‚æœæ‚¨ç†Ÿæ‚‰è¯¸å¦‚Fï¼ƒä¹‹ç±»çš„åŠŸèƒ½è¯­è¨€ï¼Œé‚£ä¹ˆæ­¤åŠŸèƒ½ä»¥å½“å‰å­˜åœ¨çš„å½¢å¼å¯èƒ½ä¼šä½¿æ‚¨æœ‰äº›å¤±æœ›ã€‚ ä½†æ˜¯å³ä½¿åœ¨ä»Šå¤©ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨å„ç§æƒ…å†µä¸‹ç®€åŒ–ä»£ç ã€‚ å‰Šå‡æ›´å¤šç»†èŠ‚ï¼ 



 æ¯ä¸ªæ–°åŠŸèƒ½å¯¹äºå¼€å‘äººå‘˜è€Œè¨€å¯¹äºæ€§èƒ½è‡³å…³é‡è¦çš„åº”ç”¨ç¨‹åºæ¥è¯´éƒ½æ˜¯å±é™©çš„ã€‚ æ–°çš„æŠ½è±¡çº§åˆ«æ˜¯å¥½çš„ï¼Œä½†æ˜¯è¦æœ‰...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cï¼ƒ7ä¸­çš„æ¨¡å¼åŒ¹é…</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/423229/">  Cï¼ƒ7ç»ˆäºæœ‰äº†æœŸå¾…å·²ä¹…çš„åŠŸèƒ½ï¼Œç§°ä¸ºæ¨¡å¼åŒ¹é…ã€‚ å¦‚æœæ‚¨ç†Ÿæ‚‰è¯¸å¦‚Fï¼ƒä¹‹ç±»çš„åŠŸèƒ½è¯­è¨€ï¼Œé‚£ä¹ˆæ­¤åŠŸèƒ½ä»¥å½“å‰å­˜åœ¨çš„å½¢å¼å¯èƒ½ä¼šä½¿æ‚¨æœ‰äº›å¤±æœ›ã€‚ ä½†æ˜¯å³ä½¿åœ¨ä»Šå¤©ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨å„ç§æƒ…å†µä¸‹ç®€åŒ–ä»£ç ã€‚ å‰Šå‡æ›´å¤šç»†èŠ‚ï¼ <br><br><img src="https://habrastorage.org/webt/tw/bk/ck/twbkckursaas-xb76976szvpmm0.jpeg"><a name="habracut"></a><br><br> æ¯ä¸ªæ–°åŠŸèƒ½å¯¹äºå¼€å‘äººå‘˜è€Œè¨€å¯¹äºæ€§èƒ½è‡³å…³é‡è¦çš„åº”ç”¨ç¨‹åºæ¥è¯´éƒ½æ˜¯å±é™©çš„ã€‚ æ–°çš„æŠ½è±¡çº§åˆ«æ˜¯å¥½çš„ï¼Œä½†æ˜¯è¦æœ‰æ•ˆåœ°ä½¿ç”¨å®ƒä»¬ï¼Œæ‚¨éœ€è¦äº†è§£å®ƒä»¬çš„å®é™…å·¥ä½œæ–¹å¼ã€‚ æœ¬æ–‡è®¨è®ºäº†æ¨¡å¼åŒ¹é…åŠŸèƒ½åŠå…¶å·¥ä½œåŸç†ã€‚ <br><br>  Cï¼ƒä¸­çš„ç¤ºä¾‹å¯ä»¥åœ¨isè¡¨è¾¾å¼ä»¥åŠswitchè¯­å¥çš„caseå—ä¸­ä½¿ç”¨ã€‚ <br> å…±æœ‰ä¸‰ç§ç±»å‹çš„æ ·æœ¬ï¼š <br><br><ul><li> æ ·æœ¬å¸¸æ•° </li><li> ç±»å‹æ ·æœ¬ </li><li> æ ·æœ¬å˜é‡ã€‚ </li></ul><br><h2> è¡¨è¾¾å¼ä¸­çš„æ¨¡å¼åŒ¹é… </h2><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsExpressions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Alternative way checking for null if (o is null) Console.WriteLine("o is null"); // Const pattern can refer to a constant value const double value = double.NaN; if (o is value) Console.WriteLine("o is value"); // Const pattern can use a string literal if (o is "o") Console.WriteLine("o is \"o\""); // Type pattern if (o is int n) Console.WriteLine(n); // Type pattern and compound expressions if (o is string s &amp;&amp; s.Trim() != string.Empty) Console.WriteLine("o is not blank"); }</span></span></code> </pre> <br> ä½¿ç”¨isè¡¨è¾¾å¼ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥è¯¥å€¼æ˜¯å¦æ’å®šï¼Œä½¿ç”¨ç±»å‹æ£€æŸ¥ï¼Œæ‚¨è¿˜å¯ä»¥ç¡®å®šæ ·æœ¬å˜é‡ã€‚ <br><br> åœ¨isè¡¨è¾¾å¼ä¸­ä½¿ç”¨æ¨¡å¼åŒ¹é…æ—¶ï¼Œåº”æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š <br><br><ul><li>  ifè¯­å¥è¾“å…¥çš„å˜é‡å°†å‘é€åˆ°å¤–éƒ¨ä½œç”¨åŸŸã€‚ </li><li> ä»…å½“æ¨¡å¼åŒ¹é…æ—¶ï¼Œæ‰æ˜¾å¼åˆ†é…ifè¯­å¥è¾“å…¥çš„å˜é‡ã€‚ </li><li> è¡¨è¾¾å¼ä¸­æ¨¡å¼åŒ¹é…çš„å½“å‰å®ç°ä¸æ˜¯å¾ˆæœ‰æ•ˆã€‚ </li></ul><br> é¦–å…ˆï¼Œè¯·è€ƒè™‘å‰ä¸¤ç§æƒ…å†µï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ScopeAndDefiniteAssigning</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> s &amp;&amp; s.Length != <span class="hljs-number"><span class="hljs-number">0</span></span>) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"o is not empty string"</span></span>); } <span class="hljs-comment"><span class="hljs-comment">// Can't use 's' any more. 's' is already declared in the current scope. if (o is int n || (o is string s2 &amp;&amp; int.TryParse(s2, out n))) { Console.WriteLine(n); } }</span></span></code> </pre> <br> ç¬¬ä¸€ä¸ªifè¯­å¥å¼•å…¥å˜é‡sï¼Œè¯¥å˜é‡åœ¨æ•´ä¸ªæ–¹æ³•å†…éƒ¨å¯è§ã€‚ è¿™æ˜¯åˆç†çš„ï¼Œä½†æ˜¯å¦‚æœåŒä¸€å—ä¸­çš„å…¶ä»–ifè¯­å¥å°è¯•é‡ç”¨ç›¸åŒçš„åç§°ï¼Œåˆ™ä¼šä½¿é€»è¾‘å¤æ‚åŒ–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·ç¡®ä¿ä½¿ç”¨å…¶ä»–åç§°ä»¥é¿å…å†²çªã€‚ <br><br> ä»…å½“è°“è¯ä¸ºtrueæ—¶ï¼Œæ‰æ˜¾å¼åˆ†é…isè¡¨è¾¾å¼ä¸­è¾“å…¥çš„å˜é‡ã€‚ è¿™æ„å‘³ç€ç¬¬äºŒä¸ªifè¯­å¥ä¸­çš„å˜é‡næ²¡æœ‰åœ¨æ­£ç¡®çš„æ“ä½œæ•°ä¸­åˆ†é…ï¼Œä½†ç”±äºå·²ç»å£°æ˜ï¼Œå› æ­¤å¯ä»¥å°†å…¶ç”¨ä½œint.TryParseæ–¹æ³•ä¸­çš„outå˜é‡ã€‚ <br><br> ä¸Šé¢æåˆ°çš„ç¬¬ä¸‰ç‚¹æ˜¯æœ€é‡è¦çš„ã€‚ è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BoxTwice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span>) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"n is 42"</span></span>); }</code> </pre> <br> åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¡¨è¾¾å¼å°†è½¬æ¢ä¸ºobject.Equalsï¼ˆå¸¸é‡ï¼Œå˜é‡ï¼‰[å°½ç®¡ç‰¹æ€§è¡¨æ˜è¿ç®—ç¬¦==åº”è¯¥ç”¨äºç®€å•ç±»å‹]ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BoxTwice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>.Equals(<span class="hljs-number"><span class="hljs-number">42</span></span>, n)) { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"n is 42"</span></span>); } }</code> </pre> <br> æ­¤ä»£ç è°ƒç”¨ä¸¤ä¸ªæ‰“åŒ…è½¬æ¢è¿‡ç¨‹ï¼Œå¦‚æœåœ¨å…³é”®åº”ç”¨ç¨‹åºè·¯å¾„ä¸Šä½¿ç”¨å®ƒä»¬ä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚ ä»¥å‰ï¼Œå¦‚æœoå˜é‡ä¸ºå¯ä¸ºnullçš„ç±»å‹ï¼Œåˆ™oä¸ºç§°ä¸ºåŒ…è£…çš„nullè¡¨è¾¾å¼ï¼ˆè¯·å‚é˜…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eçš„æ¬¡ä¼˜ä»£ç ä¸ºnull</a> ï¼‰ï¼Œä½†å¸Œæœ›æ­¤é—®é¢˜å°†å¾—åˆ°è§£å†³ï¼ˆè¿™æ˜¯å¯¹åº”çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯·æ±‚åœ¨githubä¸Š</a> ï¼‰ã€‚ <br><br> å¦‚æœå˜é‡næ˜¯å¯¹è±¡ç±»å‹ï¼Œåˆ™è¡¨è¾¾å¼oä¸º42å°†å¯¼è‡´ä¸€ä¸ªâ€œæ‰“åŒ…è½¬æ¢â€è¿‡ç¨‹ï¼ˆå¯¹äºæ–‡å­—42ï¼‰ï¼Œå°½ç®¡åŸºäºswitchè¯­å¥çš„ç±»ä¼¼ä»£ç ä¸ä¼šå¯¼è‡´è¿™ç§æƒ…å†µã€‚ <br><br><h2> è¡¨è¾¾å¼ä¸­çš„æ ·æœ¬å˜é‡ </h2><br> å¯å˜æ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ç±»å‹ï¼ŒåŒºåˆ«å¾ˆå¤§ï¼šæ¨¡å¼å°†åŒ¹é…ä»»ä½•å€¼ï¼Œç”šè‡³ä¸ºnullã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsVar</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">$"x: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{x}</span></span></span><span class="hljs-string">"</span></span>); }</code> </pre> <br> å¦‚æœoä¸ä¸ºnullï¼Œåˆ™è¡¨è¾¾å¼o is objectå°†ä¸ºtrueï¼Œä½†æ˜¯è¡¨è¾¾å¼o is var xå°†å§‹ç»ˆä¸ºtrueã€‚ å› æ­¤ï¼Œå¤„äºå‘å¸ƒæ¨¡å¼çš„ç¼–è¯‘å™¨*å®Œå…¨æ’é™¤äº†ifè¯­å¥ï¼Œè€Œä»…ä¿ç•™Consoleæ–¹æ³•è°ƒç”¨ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šè­¦å‘Šä»£ç ä¸å¯ç”¨ï¼šifï¼ˆï¼ï¼ˆOæ˜¯var xï¼‰ï¼‰Console.WriteLineï¼ˆâ€œ Unreachableâ€ï¼‰ã€‚ å¸Œæœ›è¿™ä¸€é—®é¢˜ä¹Ÿå°†å¾—åˆ°è§£å†³ã€‚ <br><br>  <i>*å°šä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¡Œä¸ºä»…åœ¨å‘å¸ƒæ¨¡å¼ä¸‹æœ‰æ‰€ä¸åŒã€‚</i>  <i>ä¼¼ä¹æ‰€æœ‰é—®é¢˜çš„æ ¹æºéƒ½æ˜¯ç›¸åŒçš„ï¼šå‡½æ•°çš„åˆå§‹å®ç°ä¸æ˜¯æœ€ä½³çš„ã€‚</i>  <i>ä½†æ˜¯ï¼Œæ ¹æ®Neal Gafterçš„<a href="">è¯„è®º</a> ï¼Œä¸€åˆ‡å°†å¾ˆå¿«æ”¹å˜ï¼šâ€œä¸ç¤ºä¾‹åŒ¹é…çš„ä»£ç å°†è¢«é‡æ–°ç¼–å†™ï¼ˆä»¥æ”¯æŒé€’å½’ç¤ºä¾‹ï¼‰ã€‚</i>  <i>æˆ‘è®¤ä¸ºæ‚¨æ­£åœ¨è°ˆè®ºçš„å¤§å¤šæ•°æ”¹è¿›å°†åœ¨æ–°ä»£ç ä¸­å®ç°ï¼Œå¹¶ä¸”å¯ä»¥å…è´¹è·å¾—ã€‚</i>  <i>ä½†æ˜¯ï¼Œè¿™å°†éœ€è¦ä¸€äº›æ—¶é—´ã€‚â€</i> <br><br> æ²¡æœ‰ç©ºæ£€æŸ¥å°†ä½¿è¿™ç§æƒ…å†µå˜å¾—ç‰¹æ®Šï¼Œå¹¶å¯èƒ½å¯¼è‡´å±é™©ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ç¡®åˆ‡åœ°çŸ¥é“æ­¤ç¤ºä¾‹çš„å·¥ä½œæ–¹å¼ï¼Œé‚£ä¹ˆå®ƒå°†å¾ˆæœ‰ç”¨ã€‚ å®ƒå¯ä»¥ç”¨æ¥åœ¨è¡¨è¾¾å¼ä¸­å¼•å…¥ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VarPattern</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; s</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s.FirstOrDefault(o =&gt; o != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> v &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n)) { Console.WriteLine(n); } }</code> </pre> <br><h2> æ˜¯è¡¨è¾¾å’ŒçŒ«ç‹çš„å£°æ˜ </h2><br> è¿˜æœ‰å¦ä¸€ç§æƒ…å†µå¯èƒ½è¢«è¯æ˜æ˜¯æœ‰ç”¨çš„ã€‚ æ ·æœ¬ç±»å‹ä»…åœ¨ä¸ä¸ºç©ºæ—¶åŒ¹é…å€¼ã€‚ æˆ‘ä»¬å¯ä»¥å°†è¿™ç§â€œè¿‡æ»¤â€é€»è¾‘ä¸nullè¿ç®—ç¬¦ç»“åˆä½¿ç”¨ï¼Œä»¥ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithNullPropagation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; s</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s?.FirstOrDefault(str =&gt; str.Length &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>)?.Length <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length) { Console.WriteLine(length); } <span class="hljs-comment"><span class="hljs-comment">// Similar to if (s?.FirstOrDefault(str =&gt; str.Length &gt; 10)?.Length is var length2 &amp;&amp; length2 != null) { Console.WriteLine(length2); } // And similar to var length3 = s?.FirstOrDefault(str =&gt; str.Length &gt; 10)?.Length; if (length3 != null) { Console.WriteLine(length3); } }</span></span></code> </pre> <br> æ³¨æ„ï¼Œç›¸åŒçš„æ¨¡å¼å¯ç”¨äºå€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹ã€‚ <br><br><h2> æ¡ˆä¾‹å—ä¸­çš„æ¨¡å¼åŒ¹é… </h2><br>  switchè¯­å¥çš„åŠŸèƒ½å·²åœ¨Cï¼ƒ7ä¸­è¿›è¡Œäº†æ‰©å±•ï¼Œå› æ­¤ç°åœ¨å¯ä»¥åœ¨caseå­å¥ä¸­ä½¿ç”¨æ¨¡å¼ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Count&lt;T&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> IEnumerable&lt;T&gt; e) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (e) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ICollection&lt;T&gt; c: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c.Count; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IReadOnlyCollection&lt;T&gt; c: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c.Count; <span class="hljs-comment"><span class="hljs-comment">// Matches concurrent collections case IProducerConsumerCollection&lt;T&gt; pc: return pc.Count; // Matches if e is not null case IEnumerable&lt;T&gt; _: return e.Count(); // Default case is handled when e is null default: return 0; } }</span></span></code> </pre> <br> æœ¬ç¤ºä¾‹æ˜¾ç¤ºäº†switchè¯­å¥çš„ç¬¬ä¸€ç»„æ›´æ”¹ã€‚ <br><br><ol><li> ä»»ä½•ç±»å‹çš„å˜é‡éƒ½å¯ä»¥ä¸switchè¯­å¥ä¸€èµ·ä½¿ç”¨ã€‚ </li><li>  caseå­å¥å…è®¸æ‚¨æŒ‡å®šæ¨¡å¼ã€‚ </li><li>  caseå­å¥çš„é¡ºåºå¾ˆé‡è¦ã€‚ å¦‚æœå‰ä¸€ä¸ªå¥å­å¯¹åº”äºåŸºæœ¬ç±»å‹ï¼Œè€Œä¸‹ä¸€ä¸ªå¥å­å¯¹åº”äºæ´¾ç”Ÿç±»å‹ï¼Œåˆ™ç¼–è¯‘å™¨å°†å¼•å‘é”™è¯¯ã€‚ </li><li> éšå¼æ£€æŸ¥è‡ªå®šä¹‰å•†å“æ˜¯å¦ä¸ºç©º**ã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œlast caseå­å¥æœ‰æ•ˆï¼Œå› ä¸ºå®ƒä»…åœ¨å‚æ•°ä¸ä¸ºnullæ—¶æ‰åŒ¹é…ã€‚ </li></ol><br>  <i>**æ¡ˆä¾‹çš„æœ€åä¸€å¥æ˜¾ç¤ºäº†Cï¼ƒ7ä¸­æ·»åŠ çš„å¦ä¸€ä¸ªå‡½æ•°-ç©ºå˜é‡çš„æ ·æœ¬ã€‚</i>  <i>ç‰¹æ®Šåç§°_å‘Šè¯‰ç¼–è¯‘å™¨ä¸éœ€è¦è¯¥å˜é‡ã€‚</i>  <i>caseå­å¥ä¸­çš„ç±»å‹æ ·æœ¬éœ€è¦åˆ«åã€‚</i>  <i>ä½†æ˜¯ï¼Œå¦‚æœä¸éœ€è¦å®ƒï¼Œå¯ä»¥ä½¿ç”¨_ã€‚</i> <br><br> ä»¥ä¸‹ä»£ç æ®µæ˜¾ç¤ºäº†åŸºäºswitchè¯­å¥çš„æ¨¡å¼åŒ¹é…çš„å¦ä¸€ä¸ªåŠŸèƒ½-ä½¿ç”¨è°“è¯çš„èƒ½åŠ›ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FizzBuzz</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (o) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> s when s.Contains(<span class="hljs-string"><span class="hljs-string">"Fizz"</span></span>) || s.Contains(<span class="hljs-string"><span class="hljs-string">"Buzz"</span></span>): Console.WriteLine(s); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n when n % <span class="hljs-number"><span class="hljs-number">5</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; n % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"FizzBuzz"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n when n % <span class="hljs-number"><span class="hljs-number">5</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Fizz"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n when n % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Buzz"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n: Console.WriteLine(n); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre> <br> è¿™æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FizzBuâ€‹â€‹zz</a>ä»»åŠ¡çš„ä¸€ä¸ªå¥‡æ€ªç‰ˆæœ¬ï¼Œå®ƒå¤„ç†ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ•°å­—ã€‚ <br><br>  switchè¯­å¥å¯ä»¥åŒ…å«å¤šä¸ªç›¸åŒç±»å‹çš„caseå­å¥ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å°†æ‰€æœ‰ç±»å‹æ£€æŸ¥ç»“åˆèµ·æ¥ä»¥é¿å…ä¸å¿…è¦çš„è®¡ç®—ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FizzBuzz</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// All cases can match only if the value is not null if (o != null) { if (o is string s &amp;&amp; (s.Contains("Fizz") || s.Contains("Buzz"))) { Console.WriteLine(s); return; } bool isInt = o is int; int num = isInt ? ((int)o) : 0; if (isInt) { // The type check and unboxing happens only once per group if (num % 5 == 0 &amp;&amp; num % 3 == 0) { Console.WriteLine("FizzBuzz"); return; } if (num % 5 == 0) { Console.WriteLine("Fizz"); return; } if (num % 3 == 0) { Console.WriteLine("Buzz"); return; } Console.WriteLine(num); } } }</span></span></code> </pre> <br> ä½†æ˜¯æœ‰ä¸¤ä»¶äº‹è¦ç‰¢è®°ï¼š <br><br>  1.ç¼–è¯‘å™¨ä»…ç»“åˆé¡ºåºç±»å‹æ£€æŸ¥ï¼Œå¹¶ä¸”å¦‚æœå°†caseå­å¥ä¸ä¸åŒç±»å‹æ··åˆä½¿ç”¨ï¼Œåˆ™ä¼šç”Ÿæˆè´¨é‡è¾ƒä½çš„ä»£ç ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (o) { <span class="hljs-comment"><span class="hljs-comment">// The generated code is less optimal: // If o is int, then more than one type check and unboxing operation // may happen. case int n when n == 1: return 1; case string s when s == "": return 2; case int n when n == 2: return 3; default: return -1; }</span></span></code> </pre> <br> ç¼–è¯‘å™¨å°†å…¶è½¬æ¢å¦‚ä¸‹ï¼š <br><br> å¦‚æœï¼ˆoæ˜¯int n &amp;&amp; n == 1ï¼‰è¿”å›1; <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> s &amp;&amp; s == <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n2 &amp;&amp; n2 == <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>;</code> </pre> <br>  2.ç¼–è¯‘å™¨ä¼šå°½ä¸€åˆ‡å¯èƒ½é¿å…å…¸å‹çš„æ’åºé—®é¢˜ã€‚ <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (o) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Error: The switch case has already been handled by a previous case. case int n when n == 1: return 2; }</span></span></code> </pre> <br> ä½†æ˜¯ï¼Œç¼–è¯‘å™¨æ— æ³•ç¡®å®šä¸€ä¸ªè°“è¯å¼ºäºå¦ä¸€ä¸ªè°“è¯ï¼Œå› æ­¤æ— æ³•æœ‰æ•ˆæ›¿æ¢ä»¥ä¸‹caseå­å¥ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (o) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n when n &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Will never match, but the compiler won't warn you about it case int n when n &gt; 1: return 2; }</span></span></code> </pre> <br><h2> æ¨¡å¼åŒ¹é…ç®€ä»‹ </h2><br><ul><li> åœ¨Cï¼ƒ7ä¸­å‡ºç°äº†ä»¥ä¸‹æ¨¡å¼ï¼šæ’å®šæ¨¡å¼ï¼Œç±»å‹æ¨¡å¼ï¼Œå¯å˜æ¨¡å¼å’Œç©ºå¯å˜æ¨¡å¼ã€‚ </li><li> å¯ä»¥åœ¨isè¡¨è¾¾å¼å’Œcaseå—ä¸­ä½¿ç”¨æ ·æœ¬ã€‚ </li><li> è¡¨è¾¾å¼ä¸­å¸¸é‡æ¨¡å¼çš„å®ç°æ˜¯é’ˆå¯¹å€¼ç±»å‹çš„ï¼Œåœ¨æ€§èƒ½æ–¹é¢è¿œéç†æƒ³ã€‚ </li><li> å˜é‡çš„æ ·æœ¬å§‹ç»ˆåŒ¹é…ï¼Œå¿…é¡»è°¨æ…å¯¹å¾…å®ƒä»¬ã€‚ </li><li>  switchè¯­å¥å¯ç”¨äºåœ¨whenå­å¥ä¸­è®¾ç½®å¸¦æœ‰é™„åŠ è°“è¯çš„ç±»å‹æ£€æŸ¥ã€‚ </li></ul><br><h2> è«æ–¯ç§‘Unityæ´»åŠ¨-Unity Moscow Meetup 2018.1 </h2><br>  10æœˆ11æ—¥ï¼Œæ˜ŸæœŸå››ï¼ŒUnity Moscow Meetup 2018.1å°†åœ¨é«˜ç­‰ç»æµå­¦é™¢ä¸¾è¡Œã€‚ è¿™æ˜¯æœ¬å­£åº¦åœ¨è«æ–¯ç§‘ä¸¾è¡Œçš„Unityå¼€å‘äººå‘˜çš„ç¬¬ä¸€æ¬¡ä¼šè®®ã€‚ ç¬¬ä¸€ä¸ªmitapçš„ä¸»é¢˜å°†æ˜¯AR / VRã€‚ æ‚¨ä¼šå‘ç°æœ‰è¶£çš„æŠ¥å‘Šï¼Œä¸è¡Œä¸šä¸“å®¶çš„äº¤æµä»¥åŠMSIçš„ç‰¹æ®Šæ¼”ç¤ºåŒºã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯¦ç»†èµ„æ–™</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN423229/">https://habr.com/ru/post/zh-CN423229/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN423215/index.html">æˆ‘çš„é’±åœ¨å“ªé‡Œï¼Œè€å…„ï¼šSteamæ²‰é»˜ä¸è¯­</a></li>
<li><a href="../zh-CN423217/index.html">å›åˆ°æœªæ¥ï¼šå°†è¿‘56å¹´åçš„Tomonaga-Luttingerç†è®ºçš„å®è·µè¯æ˜</a></li>
<li><a href="../zh-CN423219/index.html">å…³äºæ”¹å–„æ ¸ç‡ƒæ–™</a></li>
<li><a href="../zh-CN423221/index.html">BioVivaé¦–å¸­æ‰§è¡Œå®˜Liz Parrishè®¿è°ˆ</a></li>
<li><a href="../zh-CN423225/index.html">æ°å¤«Â·è´ä½æ–¯åŸºé‡‘ä¼šç¬¬ä¸€å¤©</a></li>
<li><a href="../zh-CN423231/index.html">Frango Anomalyï¼Œé«˜æ½®</a></li>
<li><a href="../zh-CN423233/index.html">ç°å®ä¸–ç•Œä¸­çš„äººå·¥æ™ºèƒ½</a></li>
<li><a href="../zh-CN423235/index.html">ä»Dribbbleåˆ°Android Motion</a></li>
<li><a href="../zh-CN423237/index.html">ç®€å•ä½†å¤æ‚çš„æœºæ¢°è‡‚</a></li>
<li><a href="../zh-CN423239/index.html">ä½¿ç”¨Helmä¸ºKubernetesæ„å»ºè½¯ä»¶åŒ…ï¼šå›¾è¡¨ç»“æ„å’Œæ¨¡æ¿</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>