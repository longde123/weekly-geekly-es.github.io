<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚅 👈🏻 🛐 Der Kampf der Webserver. Teil 1 - HTTP von der Realität getrennt: 👵🏼 🍢 🖖🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werden wir uns im Reverse Engineering versuchen, könnte man sagen. Mit schmutzigen Händen schauen wir unter die Haube der einzelnen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Der Kampf der Webserver. Teil 1 - HTTP von der Realität getrennt:</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ultravds/blog/478854/">  In diesem Artikel werden wir uns im Reverse Engineering versuchen, könnte man sagen.  Mit schmutzigen Händen schauen wir unter die Haube der einzelnen Webserver und nutzen sie so aus, wie niemand es jemals getan hätte. <br><br>  Dieser Test ist eine Messung eines kugelförmigen Pferdes in einem Vakuum, nichts weiter als die Daten, die empfangen wurden, und jetzt wissen wir nicht, was wir damit machen sollen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3b/e3c/9a6/a3be3c9a63ac32025da9671172988f8b.png"></div><a name="habracut"></a><br><h2>  Methodik </h2><br>  Das Betriebssystem für Nginx und Apache ist Ubuntu 18.04 LTS für IIS Windows Server Core 2019. Alle Betriebssysteme vor den Tests erhielten die neuesten Updates am 04. Dezember 2019. <br><br>  Die Tests wurden ausschließlich über HTTP durchgeführt.  Jeder Webserver hatte dieselbe Seite, eine kostenlose Vorlage für Jekyll von Codrops.  <a href="https://tympanus.net/codrops/2018/04/20/freebie-oasis-jekyll-website-template/">Link</a>  Auf jedem Webserver wurde die gzip-Komprimierung deaktiviert. <br><br>  Der Bandbreitentest wurde mit Httpd-Tools mit folgenden Argumenten durchgeführt: <br><br><pre><code class="plaintext hljs">ab -n 50000 -c 500 http://192.168.76.204:80/</code> </pre> <br>  Die Server waren auf ein Limit von 10, 5 und 1 Prozent des Kerns für 8, 4 und einen Kern festgelegt.  Als Prüfstand gab es einen Computer mit 9900K @ 5400 MHz, was bedeutet, dass der Server, der eine 10% -Grenze erhielt, ungefähr 540 MHz pro Kern empfängt. <br><br>  Der TTFB-Test wurde beim ersten Start des Servers ausgeführt und mit DevTools gemessen. Nach Erhalt des Ergebnisses wurde der Server ausgeschaltet und auf den vorherigen Kontrollpunkt zurückgesetzt, um das Auftreten jeglicher Art von Cache auszuschließen. <br><br>  Der Tester und der Webserver befanden sich auf demselben Host und auf demselben virtuellen Switch. <br><br>  Um das Festplattensubsystem sofort zu bewerten, müssen die Ergebnisse der ATTO- und CrystalDIskMark-Benchmarks zum Verständnis der Engpässe herangezogen werden. <br><br><div class="spoiler">  <b class="spoiler_title">Daten, die von der virtuellen Maschine stammen:</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/987/071/ae3/987071ae309b892736edf426561390ad.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/177/d54/21a/177d5421a6fd02ba6248eb2e1424ddba.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f11/628/962/f11628962346d7fbcd3081b0a660d08b.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a6/a51/fcd/8a6a51fcd25882041aca693f86e6ad9f.png"></div><br></div></div><br><h2>  Ergebnisse: </h2><br>  TTFB: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc1/204/7f6/fc12047f65760db65a25549a1ff0bbc3.png"></div><br>  <i>Der durchschnittliche TTFB für IIS ist mit 0,5 ms der geringste, gegenüber 1,4 ms für Apache und 4 ms für Nginx.</i> <br><br>  <b>Durchsatz:</b> <br><br>  Überlegen Sie zunächst, wie gut sich jeder Server in Bezug auf die Anzahl der Kerne skalieren lässt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/010/fe7/179/010fe71793558345e22d1cea925402d5.png"></div><br>  Die Grafik zeigt die Anzahl der Tester-Aufrufe an den Webserver und die Latenz.  Die Grafik zeigt, dass NGINX 98% aller Treffer erzielte und die Site für 20 ms oder weniger lief.  Sowohl IIS als auch Apache haben 5% aller Anrufe für 76 ms bzw. 14 ms ausgeführt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c4/bed/4fd/5c4bed4fdb7a77ca8fb8ad7ca4ecca81.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/212/c07/d9f/212c07d9f863997f644e9c59d2080d0a.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/331/cba/9f2/331cba9f2ae9d4dbcf9a92dda98650ff.png"></div><br>  Die Grafik zeigt die durchschnittliche Bearbeitungszeit für eine Anfrage während eines Stresstests. <br><br>  Wie Sie aus den Diagrammen ersehen können, hat IIS sowohl Apache als auch Nginx in die Luft gesprengt und sich unter hoher Last erheblich verlangsamt. <br><br>  IIS bevorzugte eindeutig 4 Kerne gegenüber 8, was weniger Verzögerungen bei 4 Kernen zur Folge hatte, befürwortete jedoch auch nicht unbedingt einen Kern. <br><br>  NGINX lässt sich perfekt auf alle 8 Kerne skalieren, und für Apache scheint ein Single-Core-Skript die beste Wahl zu sein. <br><br><h2>  Skalierbarkeit: </h2><br>  <b>Nginx:</b> <br><br>  Betrachten Sie nun die Skalierbarkeit in Bezug auf Frequenz und Anzahl der Kerne. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dde/4ad/09d/dde4ad09db856dbe0e2e400b6db7779d.png"></div><br>  Tests mit einem Grenzwert von 1% für 4 und 1 Kernel wurden von Nginx nicht bestanden, so dass 2000 Anforderungen zurückblieben und die Verbindung zum Tester getrennt wurde. <br><br>  <b>Apache:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ccf/897/d8f/ccf897d8f3ba057f35a37e0dc3987241.png"></div><br>  Apache as Nginx hat 2500 Anfragen bearbeitet und sich ergeben und die Verbindung getrennt.  Apache hat den Test nicht mit 8, 4 und 1 Kernel mit einem Limit von 1% bestanden, aber zusätzlich hat der Test mit dem Limit von 5% für einen Kern nicht bestanden, was schlimmer ist als Nginx <br><br>  <b>IIS:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/30b/d79/a5e/30bd79a5e56fb568807fe6bac6fb87e0.png"></div><br>  Während der Tests sammelte IIS eine riesige Warteschlange von Anforderungen, verarbeitete jedoch jede einzelne.  Offensichtlich sind keine Standardzeitlimits für die Verarbeitung der Anforderung festgelegt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb3/f5b/afd/bb3f5bafd10834b8a352ae6518051991.png"></div><br>  Das Diagramm zeigt die Zeit, die zum Abschließen des Tests benötigt wurde.  Absurd absurde Testkonfigurationen wurden fallengelassen.  Das Diagramm zeigt, wie hoch die Anforderungen von IIS an die Hardware sind und wie schön NGINX ist. <br><br><h2>  Disk Skalierbarkeit: </h2><br>  <b>Nginx:</b> <br><br>  Betrachten Sie nun die Skalierbarkeit in Bezug auf Häufigkeit und Anzahl der Kerne sowie die Festplattengeschwindigkeit. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c5d/fbb/b95/c5dfbbb95be9109b43c02fcb02b7fd33.png"></div><br>  Diesmal hat Nginx 4 Tests nicht bestanden, sondern zwei. <br><br>  <b>Apache:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7cd/175/d52/7cd175d520fd742b1526ffe66e04e737.png"></div><br>  Apache hat die gleiche Anzahl von Tests wie beim letzten Mal nicht bestanden. <br><br>  <b>IIS:</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e8/f5a/f1b/4e8f5af1b790a7ea2b1f07429726d4a4.png"></div><br>  IIS zeigt ein fast identisches Diagramm, als gäbe es keine Datenträgereinschränkungen.  Im Allgemeinen haben sich die Grafiken aller Server nicht wesentlich geändert, was bedeutet, dass jeder von ihnen die Statik in den Arbeitsspeicher zwischengespeichert und von dort ausgegeben hat.  Hier sehen wir den Hauptengpass - den Webserver selbst. <br><br>  Es ist noch zu früh, um auf der Grundlage dieser Tests Schlussfolgerungen zu ziehen. Wir haben HTTPS, Komprimierung und HTTP / 2 noch nicht mit einem Live-Zertifikat von Let's Encrypt getestet.  Wir werden im nächsten Artikel darüber sprechen. <br><br>  Wir bieten einen aktualisierten UltraLite <a href="https://ultravds.com/">Windows VDS-</a> Tarif für 99 Rubel mit installiertem Windows Server 2019 Core an. <br> <a href="https://ultravds.com/"><img src="https://habrastorage.org/webt/ww/d4/ro/wwd4ro5_5a28hvdxyazf3enjxou.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de478854/">https://habr.com/ru/post/de478854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de478844/index.html">Angst und Abscheu vor IT</a></li>
<li><a href="../de478846/index.html">Systemd, interaktive Skripte und Timer</a></li>
<li><a href="../de478848/index.html">Die Evolution der digitalen Fotografie</a></li>
<li><a href="../de478850/index.html">CSS Grid Naming</a></li>
<li><a href="../de478852/index.html">Einführung in GitOps für OpenShift</a></li>
<li><a href="../de478856/index.html">SD-WAN - aktuelle Trends und Prognosen für 2020</a></li>
<li><a href="../de478858/index.html">Vergleichen von Profilierungssitzungen in XHProf Admin</a></li>
<li><a href="../de478862/index.html">Wie ist der Frontend-Test in Yandex.Market aufgebaut und warum lehnen wir wöchentliche Releases ab?</a></li>
<li><a href="../de478866/index.html">Meet Space - Neues Produkt von JetBrains</a></li>
<li><a href="../de478872/index.html">DIY: Wie wir die Lagerüberwachung automatisieren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>