<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï¥üèæ üëÉüèº ‚õπüèº Motor de renderizado angular 6 e Ivy üï∂Ô∏è üõ†Ô∏è ‚òùÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buenas tardes, colegas. Estamos considerando actualizar el libro de Jacob Fine y Anton Moiseev " Angular y TypeScript. Creaci√≥n de sitios web para pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Motor de renderizado angular 6 e Ivy</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/419389/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/wl/x_/u9/wlx_u9fwbjqm0in1o-f790lshsg.jpeg" align="left" alt="imagen"></a>  Buenas tardes, colegas.  Estamos considerando actualizar el libro de Jacob Fine y Anton Moiseev " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Angular y TypeScript. Creaci√≥n de sitios web para profesionales</a> ".  Este oto√±o sale <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una nueva edici√≥n</a> e incluye material en Angular 5 y 6. <br><br>  Al principio pensamos publicar material sobre el motor Ivy, que probablemente sea la innovaci√≥n m√°s interesante en Angular 6, pero luego nos detuvimos en una publicaci√≥n m√°s general de Cedric Exbright (el original fue lanzado en mayo). <br><br>  En Angular 6, hubo muchas innovaciones serias, adem√°s, la m√°s importante de ellas no puede nombrar caracter√≠sticas: este es Ivy, un nuevo motor de renderizado.  Dado que el motor todav√≠a es experimental, hablaremos sobre √©l al final de este art√≠culo y comenzaremos con otras caracter√≠sticas nuevas y cambios revolucionarios. <br><a name="habracut"></a><br>  <b>Proveedores sacudibles de √°rboles</b> <br><br>  Ahora hay una nueva forma recomendada de registrar al proveedor directamente en el decorador <code>@Injectable()</code> , utilizando el nuevo atributo <code>providedIn</code> .  Toma <code>'root'</code> como el valor de cualquier m√≥dulo en su aplicaci√≥n.  Al usar <code>'root'</code> objeto implementado se registrar√° en la aplicaci√≥n como un solitario, y no necesitar√° agregarlo a los proveedores en el m√≥dulo ra√≠z.  De manera similar, cuando se usa <code>providedIn: UsersModule</code> objeto implementado se registra como el proveedor <code>UsersModule</code> y no se agrega a los proveedores del m√≥dulo. <br><br><pre> <code class="javascript hljs">@Injectable({ <span class="hljs-attr"><span class="hljs-attr">providedIn</span></span>: <span class="hljs-string"><span class="hljs-string">'root'</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserService</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br>  Este nuevo m√©todo se introdujo para eliminar mejor el c√≥digo no funcional en la aplicaci√≥n (sacudida de √°rbol).  En la actualidad, la situaci√≥n es tal que el servicio que se agrega a los proveedores del m√≥dulo terminar√° en el conjunto final, incluso si no se usa en la aplicaci√≥n, y permitir esto es un poco triste.  Si utiliza la carga diferida, puede caer en varias trampas a la vez o encontrarse en una situaci√≥n en la que el servicio se ingresar√° en el conjunto incorrecto. <br><br>  Es poco probable que ocurra tal situaci√≥n en las aplicaciones (si escribe un servicio y luego lo usa), pero los m√≥dulos de terceros a veces ofrecen servicios que no necesitamos; como resultado, tenemos un mont√≥n de JavaScript in√∫til. <br><br>  Por lo tanto, esta caracter√≠stica ser√° especialmente √∫til para los desarrolladores de bibliotecas, pero ahora se recomienda registrar los objetos implementados de esta manera; esto tambi√©n se aplica a los desarrolladores de aplicaciones.  La nueva CLI ahora incluso utiliza el andamiaje <code>providedIn: 'root'</code> por defecto" cuando trabaja con servicios. <br><br>  En la misma l√≠nea, ahora puede declarar un <code>InjectionToken</code> , registrarlo directamente con <code>providedIn</code> y agregar una <code>factory</code> aqu√≠: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> baseUrl = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InjectionToken&lt;string&gt;<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'baseUrl'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, { providedIn: </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'root'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, factory: (</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'http://localhost:8080/'</span></span> });</code> </pre> <br>  Tenga en cuenta: esto tambi√©n simplifica las pruebas unitarias.  A los fines de tales pruebas, se utilizan para registrar el servicio con los proveedores del m√≥dulo de prueba.  Esto es lo que hicimos antes: <br><br><pre> <code class="javascript hljs">beforeEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> TestBed.configureTestingModule({ <span class="hljs-attr"><span class="hljs-attr">providers</span></span>: [UserService] }));</code> </pre><br>  Ahora, si el UserService usa provideIn <code>providedIn: 'root'</code> : <br><br><pre> <code class="javascript hljs">beforeEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> TestBed.configureTestingModule({}));</code> </pre> <br>  Simplemente no se preocupe: todos los servicios registrados con <code>providedIn</code> no se cargan en la prueba, sino que se crean instancias perezosamente, solo en los casos en que realmente se necesitan. <br><br>  <b>Rxjs 6</b> <br><br>  Angular 6 ahora usa RxJS 6 internamente, por lo que debe actualizar la aplicaci√≥n teniendo esto en cuenta. <br><br>  Y ... ¬°RxJS 6 est√° cambiando el enfoque para importar! <br><br>  En RxJS 5, podr√≠as escribir: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Observable } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/Observable'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/add/observable/of'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/add/operator/map'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> squares$: Observable&lt;number&gt; = Observable.of(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) .map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function"> =&gt;</span></span> n * n);</code> </pre> <br>  En RxJS 5.5, aparecieron declaraciones canalizables: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Observable } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/Observable'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/observable/of'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { map } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/operators'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> squares$: Observable&lt;number&gt; = <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>).pipe( map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function"> =&gt;</span></span> n * n) );</code> </pre><br>  Y en RxJS 6.0, las importaciones han cambiado: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Observable, <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { map } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/operators'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> squares$: Observable&lt;number&gt; = <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>).pipe( map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function"> =&gt;</span></span> n * n) );</code> </pre> <br>  Entonces, un d√≠a tendr√° que cambiar las importaciones dentro de toda la aplicaci√≥n.  Escribo "una vez", y no "en este momento", porque la biblioteca rxJs-compat se lanz√≥ en RxJS, que le permite descargar RxJS a la versi√≥n 6.0, incluso si las versiones anteriores todav√≠a se utilizan en toda su aplicaci√≥n o en una de las bibliotecas utilizadas sintaxis <br><br>  El equipo de Angular ha escrito un <a href="">documento completo</a> sobre este tema, y ‚Äã‚Äães absolutamente necesario leerlo antes de migrar a Angular 6.0. <br><br>  Tenga en cuenta: aqu√≠ hay un conjunto de reglas tslint muy bueno llamado <code>rxjs-tslint</code> .  Solo hay 4 reglas, y si las agrega al proyecto, el sistema migrar√° autom√°ticamente todas sus importaciones y c√≥digo RxJS, y esto se hace con la <code>tslint --fix</code> m√°s <code>tslint --fix</code> ¬° <code>tslint --fix</code> !  Despu√©s de todo, si a√∫n no lo sabe, ¬°en <code>tslint</code> hay una opci√≥n de <code>fix</code> que corrige autom√°ticamente todos los errores que encuentra!  Se puede usar a√∫n m√°s simple: instale globalmente <code>rxjs-tslint</code> y ejecute <code>rxjs-5-to-6-migrate -p src/tsconfig.app.json</code> .  <code>rxjs-tslint</code> en uno de nuestros proyectos y funcion√≥ bastante bien (ejec√∫telo al menos dos veces para colapsar tambi√©n todas las importaciones).  Consulte el archivo README de este proyecto para obtener m√°s detalles: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github.com/ReactiveX/rxjs-tslint</a> . <br><br>  Si est√° interesado en aprender m√°s sobre RxJS 6.0, le recomiendo el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pr√≥ximo informe de</a> Ben Lesch sobre ng-conf. <br><br>  <b>i18n</b> <br><br>  La perspectiva m√°s importante asociada con i18n es la capacidad de hacer "i18n en tiempo de ejecuci√≥n", sin tener que construir la aplicaci√≥n por separado para cada punto local.  Esta caracter√≠stica a√∫n no est√° disponible (solo hay prototipos), y se necesitar√° el motor Ivy para su funcionamiento (m√°s informaci√≥n a continuaci√≥n). <br><br>  Otro cambio relacionado con i18n ya ha tenido lugar y est√° disponible.  El canal de divisas est√° optimizado de la manera m√°s eficiente: ahora redondea todas las monedas no a 2 d√≠gitos, como antes, sino a la cantidad deseada de d√≠gitos (por ejemplo, a 3 en el caso del dinar bahrein√≠ o a 0 para el peso chileno). <br><br>  Si es necesario, este valor se puede recuperar mediante programaci√≥n utilizando la nueva funci√≥n i18n <code>getNumberOfCurrencyDigits</code> . <br><br>  Otras funciones de formateo convenientes, como <code>formatDate</code> , <code>formatCurrency</code> , <code>formatPercent</code> y <code>formatNumber</code> tambi√©n aparecieron en el <code>formatNumber</code> <code>formatPercent</code> . <br><br>  Convenientemente, si desea aplicar las mismas transformaciones que se realizan en los canales, pero hacerlo desde el c√≥digo TypeScript. <br><br>  <b>Animaciones</b> <br><br>  En Angular 6.0, las animaciones ya son posibles sin polyfill <code>web-animations-js</code> , a menos que use <code>AnimationBuilder</code> .  ¬°Su aplicaci√≥n puede ganar algunos bytes preciosos!  En caso de que el navegador no sea compatible con la API <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>element.animate</code></a> , Angular 6.0 retrocede al uso de fotogramas clave CSS. <br><br>  <b>Elementos angulares</b> <br><br>  Angular Elements es un proyecto que le permite envolver componentes angulares como componentes web e incrustarlos en una aplicaci√≥n que no utiliza Angular.  Al principio, este proyecto exist√≠a solo en el "Laboratorio Angular" (es decir, todav√≠a es experimental).  Con v6, se destaca un poco y se incluye oficialmente en el marco.  Este es un gran tema que merece un art√≠culo separado. <br><br>  <b>ElementRef &lt;T&gt;</b> <br><br>  Si desea tomar un enlace de elemento en su plantilla, puede usar <code>@ViewChild</code> o <code>@ViewChildren</code> , o incluso implementar directamente <code>ElementRef</code> .  El inconveniente en este caso es este: en Angular 5.0 o inferior, <code>ElementRef</code> especificado obtendr√° el tipo <code>any</code> para la propiedad <code>nativeElement</code> . <br><br>  En Angular 6.0 puede escribir ElementRef m√°s estricto si lo desea: <br><br><pre> <code class="javascript hljs">@ViewChild(<span class="hljs-string"><span class="hljs-string">'loginInput'</span></span>) loginInput: ElementRef&lt;HTMLInputElement&gt;; ngAfterViewInit() { <span class="hljs-comment"><span class="hljs-comment">// nativeElement  `HTMLInputElement` this.loginInput.nativeElement.focus(); }</span></span></code> </pre> <br>  <b>Lo que se reconoce como indeseable y lo que est√° cambiando fundamentalmente</b> <br><br>  ¬°Hablemos de lo que debe tener en cuenta al embarcarse en la migraci√≥n! <br><br>  <i><b><code>preserveWhitespaces</code> : valor predeterminado <code>false</code></b></i> <br><br>  En la secci√≥n "Problemas que pueden ocurrir durante la actualizaci√≥n", observamos que preserveWhitespaces ahora es <code>false</code> de forma predeterminada.  Esta opci√≥n apareci√≥ en Angular 4.4, y si se pregunta qu√© esperar al mismo tiempo, aqu√≠ hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una publicaci√≥n completa</a> sobre este tema.  Spoiler: todo puede hacer, o puede romper completamente tus plantillas. <br><br>  <i><b><code>ngModel</code> y formas reactivas</b></i> <br><br>  Anteriormente, era posible proporcionar el mismo campo de formulario con <code>ngModel</code> y <code>formControl</code> , pero hoy esta pr√°ctica se considera indeseable y ya no ser√° compatible con Angular 7.0. <br><br>  Aqu√≠ hay un poco de confusi√≥n, y todo el mecanismo funcion√≥, tal vez no como esperaba ( <code>ngModel</code> : esta era una directiva que no le resultaba familiar hace mucho tiempo, pero la entrada / salida de la directiva <code>formControl</code> , que realiza casi la misma tarea, pero no la misma). <br><br>  Entonces, si aplicamos el c√≥digo: <br><br><pre> <code class="javascript hljs">&lt;input [(ngModel)]=<span class="hljs-string"><span class="hljs-string">"user.name"</span></span> [formControl]=<span class="hljs-string"><span class="hljs-string">"nameCtrl"</span></span>&gt;</code> </pre> <br>  entonces recibimos una advertencia. <br><br>  Puede configurar la aplicaci√≥n para mostrar una advertencia de <code>always</code> ( <code>once</code> ), <code>once</code> (una vez) o <code>never</code> (nunca).  El valor predeterminado es <code>always</code> . <br><br><pre> <code class="javascript hljs">imports: [ ReactiveFormsModule.withConfig({ <span class="hljs-attr"><span class="hljs-attr">warnOnNgModelWithFormControl</span></span>: <span class="hljs-string"><span class="hljs-string">'never'</span></span> }); ]</code> </pre> <br>  De una forma u otra, al prepararse para la transici√≥n a Angular 7, debe adaptar el c√≥digo para usar formas orientadas a plantillas o formas reactivas. <br><br>  <b>Proyecto Ivy: nuevo (nuevo) motor de renderizado en Angular</b> <br><br>  Soooo ...  Esta es la cuarta versi√≥n principal de Angular (2, 4, 5, 6), ¬°y el motor de renderizado se est√° reescribiendo por tercera vez! <br><br>  Recuerde: Angular compila sus plantillas en c√≥digo TypeScript equivalente.  Luego, este TypeScript se compila con el TypeScript que escribi√≥ en JavaScript, y el resultado est√° a disposici√≥n del usuario.  Y ante nosotros ya est√° la tercera versi√≥n de este motor de renderizado en Angular (la primera fue en la versi√≥n inicial de Angular 2.0 y la segunda en Angular 4.0). <br><br>  En esta nueva versi√≥n del motor de renderizado, el enfoque para escribir plantillas no cambia, sin embargo, optimiza una serie de indicadores, en particular: <br><br><ul><li>  Tiempo de construcci√≥n </li><li>  Tama√±o del dial </li></ul><br>  Todo esto sigue siendo profundamente experimental, y el nuevo motor de renderizado Ivy se activa mediante una casilla de verificaci√≥n, que debe poner en las opciones del compilador (en el archivo <code>tsconfig.json</code> ) si desea probarlo. <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"angularCompilerOptions"</span></span>: { <span class="hljs-string"><span class="hljs-string">"enableIvy"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre><br>  Tenga en cuenta que este mecanismo quiz√°s no sea demasiado confiable, por lo tanto, no lo use en producci√≥n todav√≠a.  Quiz√°s √©l todav√≠a no trabaja.  Pero en el futuro cercano se aceptar√° como la opci√≥n predeterminada, por lo que debe probarlo una vez, ver si funciona en su aplicaci√≥n y qu√© beneficios le ofrece. <br><br>  Analicemos con m√°s detalle c√≥mo Ivy difiere del motor de renderizado anterior. <br><br>  <b>C√≥digo generado por el viejo motor</b> <br><br>  Veamos un peque√±o ejemplo: tengamos un componente <code>PonyComponent</code> que tome el modelo <code>PonyModel</code> (con los par√°metros de <code>name</code> y <code>color</code> ) y muestre la imagen del pony (dependiendo del traje), as√≠ como el nombre del pony. <br><br>  Se ve as√≠: <br><br><pre> <code class="javascript hljs">@Component({ <span class="hljs-attr"><span class="hljs-attr">selector</span></span>: <span class="hljs-string"><span class="hljs-string">'ns-pony'</span></span>, <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-string"><span class="hljs-string">`&lt;div&gt; &lt;ns-image [src]="getPonyImageUrl()"&gt;&lt;/ns-image&gt; &lt;div&gt;&lt;/div&gt; &lt;/div&gt;`</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PonyComponent</span></span></span><span class="hljs-class"> </span></span>{ @Input() ponyModel: PonyModel; getPonyImageUrl() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`images/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.ponyModel.color}</span></span></span><span class="hljs-string">.png`</span></span>; } }</code> </pre> <br>  El motor de renderizado introducido en Angular 4 gener√≥ una clase llamada <code>ngfactory</code> para cada plantilla.  La clase generalmente conten√≠a (c√≥digo simplificado): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">View_PonyComponent_0</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewDef(<span class="hljs-number"><span class="hljs-number">0</span></span>, [ elementDef(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">"div"</span></span>), elementDef(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"ns-image"</span></span>, View_ImageComponent_0), directiveDef(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">49152</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, i2.ImageComponent, { <span class="hljs-attr"><span class="hljs-attr">src</span></span>: [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"src"</span></span>] }), elementDef(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"div"</span></span>), elementDef(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>]) ], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">check, view</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> component = view.component; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currVal_0 = component.getPonyImageUrl(); check(view, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, currVal_0); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">check, view</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> component = view.component; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currVal_1 = component.ponyModel.name; check(view, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, currVal_1); }); }</code> </pre> <br>  Es dif√≠cil de leer, pero las partes principales de este c√≥digo se describen a continuaci√≥n: <br><br><ul><li>  La estructura del DOM creado, que contiene las definiciones de elementos ( <code>figure</code> , <code>img</code> , <code>figcaption</code> ), sus atributos y definiciones de nodos de texto.  Cada elemento de la estructura DOM en el conjunto de definiciones de vista est√° representado por su propio √≠ndice. </li><li>  Cambiar las funciones de detecci√≥n;  el c√≥digo contenido en ellos verifica si las expresiones utilizadas en la plantilla producen los mismos valores que antes.  Aqu√≠, se <code>getPonyImageUrl</code> el resultado del m√©todo <code>getPonyImageUrl</code> y, si cambia, se actualiza el valor de entrada para el componente de imagen.  Lo mismo se aplica al apodo de pony: si cambia, el nodo de texto que contiene este apodo se actualizar√°. </li></ul><br>  <b>Ivy gener√≥ c√≥digo</b> <br><br>  Si trabajamos con Angular 6, y el indicador <code>enableIvy</code> establece en <code>true</code> , no se generar√° una <code>ngfactory</code> separada en el mismo ejemplo;  La informaci√≥n se incrustar√° directamente en el campo est√°tico del componente en s√≠ (c√≥digo simplificado): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PonyComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ngComponentDef = defineComponent({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: PonyComponent, <span class="hljs-attr"><span class="hljs-attr">selector</span></span>: [[<span class="hljs-string"><span class="hljs-string">'ns-pony'</span></span>]], <span class="hljs-attr"><span class="hljs-attr">factory</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PonyComponent(), <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">renderFlag, component</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">if</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">renderFlag &amp; RenderFlags.Create</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elementStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'figure'</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elementStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'ns-image'</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elementEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elementStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'div'</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elementEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elementEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">if</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">renderFlag &amp; RenderFlags.Update</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">property</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'src'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, component.getPonyImageUrl(</span></span></span><span class="hljs-function">)); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, interpolate(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">, component.ponyModel.name, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span></span><span class="hljs-function">)); } }, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputs</span></span></span><span class="hljs-function">: { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ponyModel</span></span></span><span class="hljs-function">: '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ponyModel</span></span></span><span class="hljs-function">' }, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">directives</span></span></span><span class="hljs-function">: </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> [ImageComponent]; }); <span class="hljs-comment"><span class="hljs-comment">// ...   }</span></span></code> </pre> <br>  Ahora todo est√° contenido en este campo est√°tico.  El atributo de <code>template</code> contiene el equivalente de la <code>ngfactory</code> familiar, con una estructura ligeramente diferente.  La funci√≥n de <code>template</code> , como antes, se iniciar√° ante cualquier cambio, pero ahora tiene dos modos: <br><br><ul><li>  Modo de creaci√≥n: el componente reci√©n se est√° creando, contiene los nodos DOM est√°ticos que deben crearse </li><li>  El resto de la funci√≥n se ejecuta con cada cambio (si es necesario, actualiza la fuente de la imagen y el nodo de texto). </li></ul><br>  <b>¬øQu√© cambia eso?</b> <br><br>  Ahora todos los decoradores est√°n integrados directamente en sus clases (lo mismo para <code>@Injectable</code> , <code>@Pipe</code> , <code>@Directive</code> ), y para generarlos solo necesita saber sobre el decorador actual.  El equipo de Angular llama a este fen√≥meno el "principio de localidad": para volver a compilar un componente, no es necesario volver a analizar la aplicaci√≥n. <br><br>  El c√≥digo generado se reduce ligeramente, pero lo que es m√°s importante, es posible eliminar una serie de dependencias, lo que acelera la recompilaci√≥n si una de las partes de la aplicaci√≥n cambia.  Adem√°s, con los coleccionistas modernos, por ejemplo, Webpack, todo resulta mucho m√°s bonito: el c√≥digo no funcional se corta de forma segura, esas partes del marco que no se utilizan.  Por ejemplo, si no tiene canales en la aplicaci√≥n, el marco necesario para su interpretaci√≥n ni siquiera se incluye en el conjunto final. <br><br>  Estamos acostumbrados a hacer pesado el c√≥digo angular.  A veces no da miedo, pero Hello World pesa 37 kb despu√©s de la minificaci√≥n y la compresi√≥n es demasiado.  Cuando Ivy es responsable de generar el c√≥digo, el c√≥digo no funcional se corta de manera mucho m√°s eficiente.  Ahora Hello World despu√©s de la minificaci√≥n se comprime a 7.3 kb, y despu√©s de la compresi√≥n, solo a 2.7 kb, y esta es una gran diferencia.  Aplicaci√≥n TodoMVC despu√©s de la compresi√≥n: solo 12.2 kb.  Estos son datos del equipo de Angular, y otros no pudieron trabajar con nosotros, ya que para que Ivy funcione como se describe aqu√≠, a√∫n necesita parchearlo manualmente. <br><br>  Para m√°s detalles, mira esta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">charla</a> con ng-conf. <br><br>  <b>Compatibilidad con bibliotecas existentes.</b> <br><br>  Quiz√°s le interese: ¬øqu√© pasar√° con las bibliotecas que ya est√°n publicadas en el formato anterior si Ivy se usa en su proyecto?  No se preocupe: el motor crear√° una versi√≥n compatible con Ivy de las dependencias de su proyecto, incluso si se compilan sin Ivy.  No expondr√© el interior en este momento, pero todos los detalles deben ser transparentes. <br><br>  <i><b>Nuevas caracter√≠sticas</b></i> <br><br>  Consideremos qu√© nuevas oportunidades tendremos cuando trabajemos con este motor de visualizaci√≥n. <br><br>  <i>Propiedades privadas en plantillas</i> <br><br>  Un nuevo motor agrega una nueva caracter√≠stica o un posible cambio. <br>  Esta situaci√≥n est√° directamente relacionada con el hecho de que la funci√≥n de plantilla est√° incrustada en el campo est√°tico del componente: ahora podemos usar las propiedades privadas de nuestros componentes en las plantillas.  Esto era anteriormente imposible, por lo que nos vimos obligados a mantener p√∫blicos todos los campos y m√©todos del componente utilizado en la plantilla, y cayeron en una clase separada ( <code>ngfactory</code> ).  Al acceder a una propiedad privada desde otra clase, la compilaci√≥n de TypeScript fallar√°.  Ahora est√° en el pasado: dado que la funci√≥n de plantilla est√° en un campo est√°tico, tiene acceso a las propiedades privadas del componente. <br><br>  Vi un comentario de los miembros del equipo de Angular sobre el hecho de que no se recomienda usar propiedades privadas en las plantillas, aunque esto ahora es posible, ya que puede estar prohibido nuevamente en el futuro ... por lo tanto, ¬°probablemente sea m√°s prudente continuar usando solo campos p√∫blicos en las plantillas!  En cualquier caso, escribir pruebas unitarias ahora es m√°s f√°cil, porque la prueba puede verificar el estado de un componente sin siquiera generar y verificar el DOM para esto. <br><br>  <i>i18n en tiempo de ejecuci√≥n</i> <br><br>  Tenga en cuenta: el nuevo motor de renderizado finalmente abre una oportunidad muy esperada para nosotros y ofrece "i18n en tiempo de ejecuci√≥n".  Al momento de escribir, todav√≠a no estaba lista, pero vimos varias confirmaciones a la vez, ¬°y esta es una buena se√±al! <br>  Lo bueno es que no tiene que cambiar su aplicaci√≥n si ya est√° trabajando con i18n.  Pero ahora no necesita reconstruir la aplicaci√≥n para cada configuraci√≥n regional que planea admitir: simplemente cargue JSON con traducciones para cada configuraci√≥n regional, y Angular se encargar√° del resto. <br><br>  <i>Bibliotecas AoT</i> <br><br>  Actualmente, una biblioteca lanzada en NPM debe publicar el archivo metadata.json y no puede publicar el c√≥digo AoT de sus componentes.  Esto es triste, ya que los costos asociados con dicho ensamblado se transfieren a nuestra aplicaci√≥n.  Con Ivy, no hay necesidad de un archivo de metadatos, ¬°y los autores de la biblioteca ahora podr√°n publicar su c√≥digo AoT directamente en NPM! <br><br>  <i>Pistas de pila mejoradas</i> <br><br>  Ahora, el c√≥digo generado deber√≠a proporcionar trazas de pila mejoradas, si tiene un problema con sus plantillas, se genera un error claro que indica la l√≠nea de la plantilla en la que se produjo.  Incluso puede establecer puntos de interrupci√≥n en las plantillas y realizar un seguimiento de lo que realmente sucede en Angular. <br><br>  <i><code>NgModule</code> desaparecer√°?</i> <br><br>  Esto todav√≠a es una perspectiva lejana, pero quiz√°s en el futuro ser√° posible prescindir de NgModules.  Los primeros signos de tales cambios son los proveedores que se pueden sacudir en √°rbol, y es l√≥gico suponer que Ivy tiene todos los bloques b√°sicos necesarios para aquellos que est√°n listos para abandonar gradualmente NgModules (o, al menos, hacerlos menos receptivos).  Es cierto, todo esto todav√≠a est√° en el futuro, seremos pacientes. <br><br>  No habr√° muchas caracter√≠sticas nuevas en esta versi√≥n, pero Ivy es definitivamente interesante para el futuro.  Experimente con √©l. Me pregunto c√≥mo le gustar√°. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419389/">https://habr.com/ru/post/es419389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419379/index.html">Por qu√© Tesla y Deutsche Bank rechazan los contratos en papel</a></li>
<li><a href="../es419381/index.html">C√≥mo los muchachos de Storyline regresaron de Silicon Valley a Minsk con $ 770 mil para una startup</a></li>
<li><a href="../es419383/index.html">Nueva t√©cnica de ataque WPA2 que no requiere un cliente en el AP</a></li>
<li><a href="../es419385/index.html">Cirug√≠a card√≠aca: c√≥mo reescribimos el componente principal de un sistema DLP</a></li>
<li><a href="../es419387/index.html">Vulnerabilidades de OWASP Top 10. A1: 2017 - Inyecciones (Parte 1)</a></li>
<li><a href="../es419391/index.html">Poder, dinero y c√≥digo abierto. Contando c√≥mo funciona la comunidad con Apache Ignite</a></li>
<li><a href="../es419393/index.html">Cree una puerta de enlace API simple en ASP.NET Core</a></li>
<li><a href="../es419395/index.html">Explicaci√≥n de expresiones lambda</a></li>
<li><a href="../es419397/index.html">C√≥mo creamos una aplicaci√≥n m√≥vil para seis pa√≠ses</a></li>
<li><a href="../es419399/index.html">OpenAI Five derrota a un equipo de personas en un show show Dota 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>