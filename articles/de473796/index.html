<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¶üèΩ üëèüèª üêΩ Optischer HDMI Extender. 300 Meter ü§úüèº üöã üì¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag, Habr! 



 Entwicklung eines HDMI-Glasfaser-Verl√§ngerungskabels f√ºr 300 Meter. Verweigerung des R√ºckkanals (Daten√ºbertragung √ºber ein Glasf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optischer HDMI Extender. 300 Meter</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473796/"> Guten Tag, Habr! <br><br><img src="https://habrastorage.org/webt/mn/v0/c1/mnv0c1yzdk47cytsckizxbgnvxk.jpeg"><br><br>  Entwicklung eines HDMI-Glasfaser-Verl√§ngerungskabels f√ºr 300 Meter.  Verweigerung des R√ºckkanals (Daten√ºbertragung √ºber ein Glasfaserkabel).  EDID vom Monitor klonen. <br><a name="habracut"></a><br>  Der HDMI-Standard wird h√§ufig in vielen Bereichen verwendet, in denen Sie das Bild auf dem Bildschirm anzeigen m√∂chten.  Pers√∂nlich konnte ich das Signal √ºber ein HDMI-Kabel bis zu einer Entfernung von 10 Metern √ºbertragen (es war einfach nicht mehr erforderlich).  Ich denke, dass Sie das Bild ohne Qualit√§tsverlust auf eine Entfernung von 30-40 m √ºbertragen k√∂nnen.  Die Hauptnachteile beim Anbringen eines solchen Kabels sind der Durchmesser und die Gr√∂√üe der Steckverbinder direkt.  Der einfachste Weg, das Kabel auszuschlie√üen, ist die Verwendung eines drahtlosen Verl√§ngerungskabels. Ich denke, es wird m√∂glich sein, 100-150 Meter zu erreichen, aber ich werde nicht sicher sagen.  Leider erlauben nicht alle Objekte aus dem einen oder anderen Grund die Verwendung von drahtlosen Netzwerken.  Und wenn Sie noch weiter brauchen? <br><br><img src="https://habrastorage.org/webt/a0/bl/n5/a0bln5vodfqydql1puhfo7gwdjw.jpeg"><br>  <i>Abb. 1.</i>  <i>HDMI-Kabel und Optik (LC)</i> <br><br>  Nat√ºrlich ist die Optik wahrscheinlich nicht die beste Option f√ºr die √úbertragung von Videos, aber bei Verwendung von station√§ren PCs und Monitoren ist sie sogar nichts.  Die erste These ist der Durchmesser des optischen Kabels (in meinem Fall 2-3 mm) und der Durchmesser des Glasfaserkabelsteckers.  Das zweite ist nat√ºrlich die Entfernung.  Mit Blick auf die Zukunft werde ich sagen, dass die Tests an einem 300 m langen Kabel mit einem Durchmesser (extern) von 3 mm durchgef√ºhrt wurden. <br><br><h4>  Elementare Basis </h4><br>  Bei der Entwicklung der Elementbasis fiel die Wahl unerwartet auf das chinesische Unternehmen SiFotonics, das sich auf diese Art von Ausr√ºstung spezialisiert hat.  Zun√§chst haben wir ihre Produkte untersucht und zwei Debugs erhalten, die wir mit einem dreihundert Meter langen optischen Kabel verbunden und sichergestellt haben, dass alles einwandfrei funktioniert.  Sie haben auch optische SFP-Empf√§nger / Sender (ROSA / TOSA), Serializer / Deserializer, Treiber usw. <br><br><h4>  Arbeitsprinzip </h4><br>  Um die Ger√§te anzuschlie√üen und zu betreiben, m√ºssen Sie zwei optische Kabel anschlie√üen und Strom (Micro-USB-Kabel) anschlie√üen.  Wenn wir eine Analogie zu einem herk√∂mmlichen HDMI-Kabel geben, in dem I2C zum Austauschen einer EDID-Tabelle vorhanden ist, ist alles gleich - ein Kanal f√ºr die Daten√ºbertragung, der zweite - f√ºr die √úbertragung der EDID vom Monitor auf die Grafikkarte.  Daten werden mit einer Geschwindigkeit von 10 Gbit / s √ºbertragen.  Wenn Sie das Kabel des R√ºckkanals abrei√üen, verschwindet das Bild immer wieder.  In diesem Moment schlichen sich einige Zweifel ein und ob irgendwelche Servicedaten oder Synchronisationsmarkierungen im R√ºckkanal √ºbertragen werden oder ob die Ger√§te Verbindungen untereinander √ºberwachen ... <br><br><img src="https://habrastorage.org/webt/kr/zc/jj/krzcjjntpkohogy_33h8uf0nksk.png"><br>  <i>Abb. 2.</i>  <i>Die Zusammensetzung der Module</i> <br><br>  Die erste Iteration des Boards, auch ein Layout, hat eine Gr√∂√üe von 20 x 45 mm.  Mit einem ‚Äûseitlichen‚Äú Stromanschluss, um die Verteilung von Strombussen auf M√ºlldeponien zu vereinfachen.  Insgesamt 4 Schichten herausgestellt.  Warum diese Leiterplattenkonfiguration schlecht ist, werde ich sp√§ter schreiben.  Tricky Debugging-Entwickler verwendeten 0201 passiv, was ich absolut nicht wollte, also verwendete ich 0402 und einen Kondensatorbrei unter dem Chip. <br><br><img src="https://habrastorage.org/webt/qj/90/cf/qj90cfepirzf-imyui0ouuutqu8.png"><br>  <i>Abb. 3.</i>  <i>3D-Modell des Layouts der Quellmodulplatine</i> <br><br>  Wie ich oben schrieb, bestand meine Aufgabe nicht nur darin, ein Paar mit einem Arbeitsabstand von 300 Metern zu bilden, sondern auch den R√ºckkanal der Optik zu entfernen.  Schon in der Entwicklungsphase haben wir uns entschlossen, uns nicht auf die Fertigstellung der chinesischen Software einzulassen (obwohl uns freundlicherweise alle Quellen zur Verf√ºgung gestellt wurden), da dies zum einen eine Reihe seltsamer Codezeilen in einem unverst√§ndlichen Compiler ist und zum anderen SiFotonics Flash-Chips liefern kann Dies ist sehr praktisch, da es sehr schwierig ist, Ger√§te im Rahmen der Produktion zu flashen.  Damit der Leser nicht denkt, dass ich √ºbertreibe, wenn ich √ºber die Schwierigkeiten spreche, werde ich ein Foto des Programmierstandes geben. <br><br><img src="https://habrastorage.org/webt/n_/nm/fn/n_nmfnhsezuqt1q-ly4tg3kewms.jpeg"><br>  <i>Abb. 4.</i>  <i>Stehen Sie f√ºr Programmierung und Diagnose</i> <br><br>  Ja, ja, wie Sie wahrscheinlich bereits vermutet haben, werden die JTAG-Kontakte f√ºr die Programmierung an Micro-USB-Kontakte und an einige HDMI-Kontakte ausgegeben, die fr√ºher GND waren.  Ich muss sofort sagen, dass dies die Qualit√§t der Arbeit nicht beeintr√§chtigt hat.  Also steh auf.  Um den Chip zu programmieren, m√ºssen Sie zuerst eine Schaltung des St√§nders zusammenbauen und den Chip mit einer speziellen Software in den Programmiermodus versetzen.  Als n√§chstes m√ºssen Sie eine andere Schaltung zusammenbauen und die andere Software verwenden, um die Karte zu flashen.  Danach geht es automatisch in den Arbeitsmodus. <br>  Im Allgemeinen scheint es mir, dass dies selbst f√ºr 1000 St√ºck unpraktisch ist. <br><br>  Kehren wir zum umgekehrten Kanal zur√ºck.  Zum Speichern von EDID-Tabellen ben√∂tigen wir ein EEPROM, und wir m√ºssen seine Adresse im laufenden Betrieb √§ndern.  Er nahm den N24C02UDTG in einem US-8-Miniaturpaket.  Zum Programmieren verwende ich den Mikrocontroller STM32F031G4U6, ebenfalls in dem kleinsten Paket, das im √∂ffentlichen Bereich zu finden ist - UFQFPN-28.  Ich habe auch den Netzschalter TPS27081ADDCR genommen.  Und hier ist was ich habe: <br><br><img src="https://habrastorage.org/webt/h4/kb/gj/h4kbgj-h9ntrucsztkaiurs06do.jpeg"><br>  <i>Abb. 5.</i>  <i>Implementierungsschema f√ºr das EDID-Klonen</i> <br><br>  Die Idee ist wie folgt.  Diese Schaltung ist auf dem Sendemodul implementiert (dasjenige, das mit dem PC verbunden ist).  Um einen EDID-Monitor zu klonen, stellt das Ger√§t eine Verbindung zum Monitor her.  Standardm√§√üig sollte die EEPROM-Adresse auf unserem Modul nicht mit der EEPROM-Adresse im Monitor √ºbereinstimmen (w√§hrend des Lesens), dh es kann sich um eine andere handeln, z. B. habe ich das A0-Bein verwaltbar gemacht.  Zum Zeitpunkt des Anschlusses an den Monitor wird das EEPROM mit Strom versorgt und der Zweig A0 wird bis zum logischen Widerstand "0" hochgezogen.  Zwei EEPROMs mit denselben Adressen h√§ngen am i2c-Bus, dies ist jedoch nicht kritisch, da wir noch nicht mit ihnen arbeiten.  In meiner Schaltung gibt es auch eine Taste und eine LED zur Anzeige von Strom- / Firmware-EDID / Fehlern.  Durch kurzes Dr√ºcken der Taste wird die Adresse ge√§ndert und der Mikrocontroller kann mit dem Lesen / Schreiben der EDID beginnen.  Wir setzen das EEPROM mit Strom zur√ºck (nur f√ºr den Fall), wenn wir das Signal von der Taste empfangen haben, lesen die EDID des Monitors und schreiben es sofort auf unseren Chip.  Wir blinken dreimal mit der LED und schalten das EEPROM aus.  Das Lesen / Schreiben erfolgt sofort, sodass das Blinken erzwungen verz√∂gert wird, damit der Benutzer versteht, dass etwas passiert.  Das hei√üt, wir beginnen zu blinken, wenn es bereits m√∂glich ist, loszulassen.  Wenn etwas nicht stimmt, z√ºnden Sie die LED nicht an. <br><br>  Schlie√üen Sie als n√§chstes das Modul an den PC an und sehen Sie sofort den neuen Monitor in den Einstellungen.  Das Problem ist gel√∂st. <br><br>  Zur Programmierung brachte der Mikrocontroller den SWD-Bus mit. <br><br><img src="https://habrastorage.org/webt/oe/xl/ba/oexlbaajt8temn8aq4sdthg29dy.jpeg"><br>  <i>Abb. 6.</i>  <i>R√ºckseite der Modulplatine</i> <br><br><h4>  Eigenschaften </h4><br>  Nach all der Arbeit mit dem EDID-Klonen entfernte ich den umgekehrten optischen Kanal und alles funktionierte einwandfrei.  In diesen Experimenten kam die Stromversorgung von einem USB-PC.  W√§hrend des Startvorgangs schaltet der Computer (auf jeden Fall meiner) die USB-Stromversorgung f√ºr einen Moment aus und das BIOS-Bild blinkt auf dem Monitor - dies ist nicht kritisch.  Dann habe ich die R√ºckkanalmodule von den Ger√§ten entfernt und nach diesem Blinken hat sich das Bild nicht mehr erholt.  Und genau das lag am Fehlen eines TOSA-Moduls am Monitorger√§t.  Ich habe versucht, die Anwesenheit eines Lasers zu emulieren, aber alles ohne Erfolg.  Ich bin mir fast sicher, dass dieses Problem durch Firmware gel√∂st werden kann, aber wir haben uns entschieden, nicht darauf einzugehen.  Ein Wunder geschah, als ich beide Ger√§te (Empf√§nger und Sender) an Netzteile anschloss (wie es √ºbrigens in der Arbeitserkl√§rung angegeben wurde).  Das Bild h√∂rte auf zu blinken und verschwand dementsprechend.  Wenn Sie die Stromversorgung der Ger√§te w√§hrend des Betriebs verzerren, wird das Bild problemlos wiederhergestellt. <br><br><img src="https://habrastorage.org/webt/fz/00/35/fz0035l-7lplz-hgibwwnnkma8m.png"><br>  <i>Abb. 7.</i>  <i>Schaltkreis des Sendermoduls (Laser)</i> <br><br>  Nun zur√ºck zur Leiterplattenkonfiguration und zum seitlichen Stromanschluss.  Diese Implementierung war zun√§chst unpraktisch und nur f√ºr das Layout geeignet.  Im Freigabeger√§t habe ich die Breite der Platine auf 16,3 mm reduziert und den Stromanschluss anstelle des optischen Moduls des R√ºckkanals eingesetzt. Auf diese Weise k√∂nnen Sie mehrere Ger√§te in eine Grafikkarte aufnehmen.  Ansonsten hat mich der Stromanschluss gest√∂rt und die Platine war sehr breit. <br><br><img src="https://habrastorage.org/webt/9l/jd/_4/9ljd_4un4tsnidmubcxb2pjgiz4.jpeg"><br>  <i>Abb. 8.</i>  <i>Schmale Empf√§nger- und Senderplatinen</i> <br><br>  Hier gab es nat√ºrlich viele Umverdrahtungen und Umlagerungen von Bauteilen.  Die Versorgungsbereiche wurden komplett √ºberarbeitet, um diese Gr√∂√üen zu optimieren und den Micro-USB-Anschluss zu √ºbertragen.  Wie Sie sich vorstellen k√∂nnen, sind die Geh√§use f√ºr beide Ger√§te identisch, daher befinden sich die Platinenkonfiguration, die Anschl√ºsse und das optische Modul gleich.  Das Geh√§use ist aus Aluminium gefr√§st und ein K√ºhlk√∂rper f√ºr Prozessor und Treiber.  Die Vorspr√ºnge f√ºr diese Komponenten sind innen gefr√§st, sodass sie auch auf die gleiche Weise angeordnet sind. <br><br><h4>  Fazit </h4><br>  Derzeit werden vier Ger√§tepaare verl√∂tet, Tests werden an einem langen Kabel auf verschiedenen Monitoren und Fernsehger√§ten durchgef√ºhrt.  Es gibt keine Beschwerden √ºber die Arbeit.  Wir pr√ºfen nur auf FullHD und darunter. <br><br>  Vielen Dank und bis bald! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473796/">https://habr.com/ru/post/de473796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473784/index.html">Wie schreibe ich einen intelligenten Vertrag f√ºr WebAssembly in einem Ontology-Netzwerk? Teil 2: C ++</a></li>
<li><a href="../de473786/index.html">Die Registrierung f√ºr den Hackathon in Riga endet. Preis - Kurzzeittraining bei PhysTech</a></li>
<li><a href="../de473788/index.html">Mikroproteine ‚Äã‚Äãentdecken unbekannte Aspekte der modernen Biologie</a></li>
<li><a href="../de473790/index.html">Splines in 3D-Grafiken, die am meisten automatisierte Option</a></li>
<li><a href="../de473794/index.html">Mobile Phishing - Endlose Bedrohungen</a></li>
<li><a href="../de473798/index.html">Protokollorientierte Programmierung. Teil 1</a></li>
<li><a href="../de473800/index.html">Bio-Radar, Pappdrohne und Flugwurst - Nikita Kalinovsky √ºber gute und schlechte Suchtechnologien</a></li>
<li><a href="../de473802/index.html">Alain Bombar - Fall nach Triumph</a></li>
<li><a href="../de473804/index.html">Was ist das Gehalt von Junior QA?</a></li>
<li><a href="../de473806/index.html">Dies ist die Art von Internet, die wir wollen: Wie Social Media zu einer t√∂dlichen Waffe wurde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>