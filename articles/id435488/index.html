<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♦️ 🧒 🤮 Mengolok-olok, bertopik dan mata-mata di Kerangka Kerja Spock 🕺🏾 🎟️ 🥕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spock menyediakan 3 alat yang ampuh (tetapi berbeda intinya) yang menyederhanakan tes penulisan: Mock, Stub dan Spy. 



 Cukup sering, kode yang perl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mengolok-olok, bertopik dan mata-mata di Kerangka Kerja Spock</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/435488/"><p>  Spock menyediakan 3 alat yang ampuh (tetapi berbeda intinya) yang menyederhanakan tes penulisan: Mock, Stub dan Spy. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mp/b1/16/mpb116loygy7rcfeicuihzm8oym.jpeg"></div><br><p>  Cukup sering, kode yang perlu diuji perlu berinteraksi dengan modul eksternal yang disebut dependensi (artikel asli menggunakan istilah kolaborator, yang tidak terlalu umum di lingkungan berbahasa Rusia). </p><br><p>  Tes unit paling sering dirancang untuk menguji satu kelas terisolasi menggunakan berbagai varian mok: Mock, Stub dan Spy.  Jadi tes akan lebih dapat diandalkan dan lebih kecil kemungkinannya untuk pecah ketika kode dependensi berkembang. </p><br><p>  Tes terisolasi seperti itu kurang rentan terhadap masalah ketika mengubah detail internal implementasi ketergantungan. </p><br><p>  <em>Dari seorang penerjemah:</em> setiap kali saya menggunakan Kerangka Kerja Spock untuk menulis tes, saya merasa seperti saya bisa membuat kesalahan ketika memilih cara untuk mengganti dependensi.  Artikel ini memiliki lembar contekan sesingkat mungkin untuk memilih mekanisme pembuatan mokas. </p><a name="habracut"></a><br><h2 id="tldr">  TL; DR </h2><br><h3 id="mocks">  Mengejek </h3><br><p>  Gunakan Mock untuk: </p><br><ul><li>  kontrak cek antara kode tes dan dependensi </li><li>  memeriksa bahwa metode ketergantungan disebut jumlah yang benar kali </li><li>  validasi parameter yang dengannya kode dependensi dipanggil </li></ul><br><h3 id="stubs">  Rintisan bertopik </h3><br><p>  Gunakan Stub untuk: </p><br><ul><li>  memberikan hasil panggilan yang telah ditentukan sebelumnya </li><li>  melakukan tindakan yang telah ditentukan sebelumnya yang diharapkan dari dependensi, seperti melempar pengecualian </li></ul><br><h3 id="spies">  Mata-mata </h3><br><p>  Mata-mata Takut.  Seperti yang dikatakan dalam dokumentasi Spock: </p><br><blockquote>  Berpikir dua kali sebelum menggunakan mekanisme ini.  Mungkin Anda harus mendesain ulang solusi Anda dan mengatur ulang kode Anda. </blockquote><p>  Tetapi kebetulan bahwa ada situasi ketika kita harus bekerja dengan kode warisan.  Kode lama bisa sulit atau bahkan tidak mungkin untuk diuji dengan massa dan stub.  Dalam hal ini, hanya ada satu solusi: gunakan Spy. </p><br><p>  Lebih baik memiliki kode warisan yang ditutupi dengan tes menggunakan Spy daripada tidak memiliki tes warisan sama sekali. </p><br><p>  Gunakan Spy untuk: </p><br><ul><li>  menguji kode lama yang tidak dapat diuji dengan metode lain </li><li>  memeriksa bahwa metode ketergantungan disebut jumlah yang benar kali </li><li>  validasi parameter yang diteruskan </li><li>  memberikan respons ketergantungan yang telah ditentukan sebelumnya </li><li>  melakukan tindakan yang telah ditetapkan sebagai respons terhadap panggilan ke metode ketergantungan </li></ul><br><h2 id="mocks-1">  Mengejek </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zi/3q/vj/zi3qvjii7ug7tkq4bczo5f-jo7u.jpeg"></div><br><p> Semua kekuatan moxas dimanifestasikan ketika tugas uji unit adalah untuk memverifikasi kontrak antara kode yang diuji dan dependensi.  Mari kita lihat contoh berikut ini, di mana kita memiliki pengontrol <code>FooController</code> yang menggunakan <code>FooService</code> sebagai ketergantungan, dan uji fungsi ini dengan mengejek. </p><br><p> <code>FooController.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FooService fooService def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ render fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) } }</code> </pre> <br><p> <code>FooService.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">"Hi ${name}, FooService did something"</span></span> } }</code> </pre> <br><p>  Dalam skenario ini, kami ingin menulis tes yang akan menguji: </p><br><ul><li>  kontrak antara <code>FooController</code> dan <code>FooService</code> </li><li>  <code>FooService.doSomething(name)</code> disebut jumlah kali yang benar </li><li>  <code>FooService.doSomething(name)</code> dipanggil dengan parameter yang benar </li></ul><br><p>  Lihatlah tes ini: </p><br><p> <code>MockSpec.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> grails.testing.web.controllers.ControllerUnitTest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spock.lang.Specification <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MockSpec</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControllerUnitTest</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-string"><span class="hljs-string">"Mock FooService"</span></span>() { given: <span class="hljs-string"><span class="hljs-string">"  "</span></span> def fooService = Mock(FooService) and: <span class="hljs-string"><span class="hljs-string">"    "</span></span> controller.fooService = fooService when: <span class="hljs-string"><span class="hljs-string">"  "</span></span> controller.doSomething() then: <span class="hljs-string"><span class="hljs-string">"         "</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) and: <span class="hljs-string"><span class="hljs-string">"  ''    - 'null'"</span></span> response.text == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>.toString() } }</code> </pre> <br><p>  Tes di atas membuat tiruan layanan: </p><br><pre> <code class="java hljs">def fooService = Mock(FooService)</code> </pre> <br><p>  Tes ini juga memeriksa apakah <code>FooService.doSomething(name)</code> dipanggil satu kali, dan parameter yang dilewatinya cocok dengan string <code>"Sally"</code> . </p><br><pre> <code class="java hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>)</code> </pre> <br><p>  Kode di atas memecahkan 4 masalah penting: </p><br><ul><li>  menciptakan tiruan untuk <code>FooService</code> </li><li>  memverifikasi bahwa <code>FooService.doSomething(String name)</code> dipanggil tepat sekali dengan parameter <code>String</code> dan nilai <code>"Sally"</code> </li><li>  mengisolasi kode uji, menggantikan implementasi ketergantungan </li></ul><br><h2 id="stubs-1">  Rintisan bertopik </h2><br><p>  Apakah kode yang diuji menggunakan dependensi?  Apakah tujuan pengujian untuk memastikan bahwa kode yang diuji berfungsi dengan benar ketika berinteraksi dengan dependensi?  Apakah hasil panggilan ke metode ketergantungan nilai input untuk kode yang diuji? </p><br><p>  Jika perilaku kode yang diuji berubah tergantung pada perilaku dependensi, maka Anda harus menggunakan stub (Stub). </p><br><p>  Mari kita lihat contoh berikut dengan <code>FooController</code> dan <code>FooService</code> dan uji fungsionalitas pengontrol menggunakan bertopik. </p><br><p> <code>FooController.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FooService fooService def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ render fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) } }</code> </pre> <br><p> <code>FooService.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">"Hi ${name}, FooService did something"</span></span> } }</code> </pre> <br><p>  Kode Tes: </p><br><p> <code>StubSpec.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> grails.testing.web.controllers.ControllerUnitTest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spock.lang.Specification <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StubSpec</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControllerUnitTest</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-string"><span class="hljs-string">"Stub FooService"</span></span>() { given: <span class="hljs-string"><span class="hljs-string">"  "</span></span> def fooService = Stub(FooService) { doSomething(_) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"Stub did something"</span></span> } and: <span class="hljs-string"><span class="hljs-string">"    "</span></span> controller.fooService = fooService when: <span class="hljs-string"><span class="hljs-string">"  "</span></span> controller.doSomething() then: <span class="hljs-string"><span class="hljs-string">"   "</span></span> <span class="hljs-comment"><span class="hljs-comment">// 1 * fooService.doSomething() //        response.text == "Stub did something" } }</span></span></code> </pre> <br><p>  Anda dapat membuat rintisan seperti ini: </p><br><pre> <code class="java hljs">def fooService = Stub(FooService) { doSomething(_) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"Stub did something"</span></span> }</code> </pre> <br><p>  Kode di atas memecahkan 4 masalah penting: </p><br><ul><li>  menciptakan <code>FooService</code> rintisan </li><li>  memastikan bahwa <code>FooService.doSomething(String name)</code> akan mengembalikan string <code>"Stub did something"</code> <code>FooService.doSomething(String name)</code> <code>"Stub did something"</code> terlepas dari parameter yang dikirimkan (jadi kami menggunakan karakter <code>_</code> ) </li><li>  mengisolasi kode yang diuji, menggantikan implementasi dependensi dengan sebuah rintisan </li></ul><br><h2 id="spies-1">  Mata-mata </h2><br><p>  Tolong jangan baca bagian ini. </p><br><p>  Jangan lihat. </p><br><p>  Lewati ke yang berikutnya. </p><br><p>  Masih membaca?  Kalau begitu, oke, mari kita berurusan dengan Spy. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b9/sj/lk/b9sjlk13izmu8rbtb4yv4zncwvm.jpeg"></div><br><p>  Jangan gunakan Spy.  Seperti yang dikatakan dalam dokumentasi Spock: </p><br><blockquote>  Berpikir dua kali sebelum menggunakan mekanisme ini.  Mungkin Anda harus mendesain ulang solusi Anda dan mengatur ulang kode Anda. </blockquote><p>  Dalam hal ini, ada beberapa situasi ketika kita harus bekerja dengan kode lawas.  Kode lawas tidak dapat diuji menggunakan massa atau stub.  Dalam hal ini, mata-mata tetap menjadi satu-satunya pilihan. </p><br><p>  Mata-mata berbeda dari mokas atau bertopik karena tidak berfungsi seperti bertopik. </p><br><p>  Ketika ketergantungan diganti dengan mok atau rintisan, objek uji dibuat, dan kode sumber nyata dari ketergantungan tidak dieksekusi. </p><br><p>  Mata-mata, di sisi lain, akan mengeksekusi kode sumber utama dari ketergantungan mata-mata yang dibuat, tetapi mata-mata akan memungkinkan Anda untuk mengubah apa yang mata-mata kembali dan memeriksa panggilan metode, seperti halnya mokas dan bertopik.  (Karena itulah namanya Spy). </p><br><p>  Mari kita lihat contoh <code>FooController</code> berikut, yang menggunakan <code>FooService</code> , dan kemudian menguji fungsionalitas dengan mata-mata. </p><br><p> <code>FooController.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FooService fooService def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ render fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) } }</code> </pre> <br><p> <code>FooService.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">"Hi ${name}, FooService did something"</span></span> } }</code> </pre> <br><p>  Kode Tes: </p><br><p> <code>SpySpec.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> grails.testing.web.controllers.ControllerUnitTest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spock.lang.Specification <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpySpec</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControllerUnitTest</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-string"><span class="hljs-string">"Spy FooService"</span></span>() { given: <span class="hljs-string"><span class="hljs-string">" -"</span></span> def fooService = Spy(FooService) and: <span class="hljs-string"><span class="hljs-string">"   "</span></span> controller.fooService = fooService when: <span class="hljs-string"><span class="hljs-string">"  "</span></span> controller.doSomething() then: <span class="hljs-string"><span class="hljs-string">"     "</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"A Spy can modify implementation"</span></span> and: <span class="hljs-string"><span class="hljs-string">'     '</span></span> response.text == <span class="hljs-string"><span class="hljs-string">"A Spy can modify implementation"</span></span> } }</code> </pre> <br><p>  Membuat instance mata-mata cukup sederhana: </p><br><pre> <code class="java hljs">def fooService = Spy(FooService)</code> </pre> <br><p>  Dalam kode di atas, mata-mata memungkinkan kita untuk memeriksa panggilan ke <code>FooService.doSomething(name)</code> , jumlah panggilan dan nilai parameter.  Selain itu, mata-mata mengubah implementasi metode untuk mengembalikan nilai yang berbeda. </p><br><pre> <code class="java hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"A Spy can modify implementation"</span></span></code> </pre> <br><p>  Kode di atas memecahkan 4 masalah penting: </p><br><ul><li>  membuat contoh mata-mata untuk <code>FooService</code> </li><li>  memeriksa interaksi ketergantungan </li><li>  memeriksa cara kerja aplikasi sesuai dengan hasil panggilan metode ketergantungan tertentu </li><li>  mengisolasi kode yang diuji, menggantikan implementasi dependensi dengan sebuah rintisan </li></ul><br><h2 id="faq">  Faq </h2><br><p>  <strong>Opsi mana yang digunakan: Mock, Stub atau Spy?</strong> </p><br><p>  Ini adalah pertanyaan yang dihadapi banyak pengembang.  FAQ ini dapat membantu jika Anda tidak yakin pendekatan mana yang digunakan. </p><br><p>  <strong>T:</strong> Apakah tujuan pengujian verifikasi kontrak antara kode yang diuji dan dependensi? </p><br><p>  <strong>A:</strong> Jika Anda menjawab Ya, gunakan Mock </p><br><p>  <strong>T:</strong> Apakah tujuan pengujian untuk memastikan bahwa kode yang diuji berfungsi dengan benar ketika berinteraksi dengan dependensi? </p><br><p>  <strong>A:</strong> Jika Anda menjawab Ya, gunakan rintisan </p><br><p>  <strong>T:</strong> Apakah hasil pemanggilan metode ketergantungan memasukkan nilai untuk kode yang sedang diuji? </p><br><p>  <strong>A:</strong> Jika Anda menjawab Ya, gunakan rintisan </p><br><p>  <strong>T:</strong> Apakah Anda bekerja dengan kode lawas, yang sangat sulit untuk diuji, dan Anda tidak memiliki opsi tersisa? </p><br><p>  <strong>A:</strong> Coba gunakan Spy </p><br><h2 id="kod-primerov">  Contoh kode </h2><br><p>  Anda dapat menemukan kode untuk semua contoh dalam artikel ini di: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/ddelponte/mock-stub-spy</a> </p><br><h2 id="poleznye-ssylki">  Tautan yang bermanfaat </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http://spockframework.org/spock/docs/1.1/all_in_one.html#_interaction_based_testing</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://martinfowler.com/bliki/UnitTest.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://martinfowler.com/articles/mocksArentStubs.html</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id435488/">https://habr.com/ru/post/id435488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id435470/index.html">Bereaksi Tutorial, Bagian 8: Melanjutkan Pekerjaan pada Aplikasi TODO, Memperkenalkan Properti Komponen</a></li>
<li><a href="../id435476/index.html">Mkcert: sertifikat HTTPS yang valid untuk localhost</a></li>
<li><a href="../id435480/index.html">Microsoft dan Kroger akan memberikan perlawanan kepada Amazon di bidang ... perdagangan makanan</a></li>
<li><a href="../id435482/index.html">Sorot zirkon: vDSO (Objek Bersama Dinamis virtual)</a></li>
<li><a href="../id435484/index.html">Gaya fuzzing 1989</a></li>
<li><a href="../id435490/index.html">Perubahan pajak Google pada 2019</a></li>
<li><a href="../id435494/index.html">Server klien yang mulus</a></li>
<li><a href="../id435496/index.html">Tesla menggugat karena kecelakaan di mana pengemudi dan penumpang Model S meninggal</a></li>
<li><a href="../id435498/index.html">Perpanjangan Direktur vCloud: Migrasi</a></li>
<li><a href="../id435500/index.html">Sarung tangan biometrik di motorsport</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>