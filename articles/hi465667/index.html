<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯОЖ ЁЯЫ╕ ЁЯС╡ЁЯП╜ рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢: рдХреИрд╢рд┐рдВрдЧ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдХреЗ рд▓рдЪреАрд▓реЗ рд╡рд┐рдиреНрдпрд╛рд╕ рддрдХ ЁЯез ЁЯНл ЁЯСитАНЁЯЪТ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореБрдЭреЗ рдХреИрд╢рд┐рдВрдЧ рд╕реЗ рдбрд░ рд▓рдЧрддрд╛ рдерд╛ред рдореИрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЪрдврд╝рдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддрд╛ рдерд╛ рдФрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИ, рдореИрдВрдиреЗ рддреБрд░рдВрдд рдХреБрдЫ рдЗрдВрдЬрди рдХрдореНрдкрд╛рд░реНрдЯрдореЗрдВрдЯ рд▓реБрдЯреНрдЯреЛ-рдПрдВрдЯрд░рдкреНрд░...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢: рдХреИрд╢рд┐рдВрдЧ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдХреЗ рд▓рдЪреАрд▓реЗ рд╡рд┐рдиреНрдпрд╛рд╕ рддрдХ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465667/"> рдореБрдЭреЗ рдХреИрд╢рд┐рдВрдЧ рд╕реЗ рдбрд░ рд▓рдЧрддрд╛ рдерд╛ред  рдореИрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЪрдврд╝рдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддрд╛ рдерд╛ рдФрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИ, рдореИрдВрдиреЗ рддреБрд░рдВрдд рдХреБрдЫ рдЗрдВрдЬрди рдХрдореНрдкрд╛рд░реНрдЯрдореЗрдВрдЯ рд▓реБрдЯреНрдЯреЛ-рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬрд╝ рдЪреАрдЬреЛрдВ рдХреА рдХрд▓реНрдкрдирд╛ рдХреА, рдЬреЛ рдХреЗрд╡рд▓ рдЧрдгрд┐рдд рдХреЗ рд╡рд┐рдЬреЗрддрд╛ рдУрд▓рдВрдкрд┐рдпрд╛рдб рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рдереЗред  рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИред  рдХреИрд╢рд┐рдВрдЧ рдХрд┐рд╕реА рднреА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд░рд▓, рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рдФрд░ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд░реВрдк рд╕реЗ рдЖрд╕рд╛рди рдирд┐рдХрд▓рд╛ред <br><br><img src="https://habrastorage.org/webt/1f/my/g2/1fmyg2ofjbgqmyf3lorqqkan85u.jpeg"><br><br>  рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ, рдореИрдВ рд╕рд░рд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдХреИрд╢рд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдордЭрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реВрдВрдЧрд╛ рдЬреИрд╕рд╛ рдХрд┐ рдЕрдм рдореИрдВ рд╕рдордЭрддрд╛ рд╣реВрдВред  рдЖрдк 1 рдорд┐рдирдЯ рдореЗрдВ рдХреИрд╢рд┐рдВрдЧ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд░реЗрдВ, рдХреБрдВрдЬреА рд╕реЗ рдХреИрд╢ рдХреИрд╕реЗ рдХрд░реЗрдВ, рдХреИрд╢ рд▓рд╛рдЗрдлрдЯрд╛рдЗрдо рд╕реЗрдЯ рдХрд░реЗрдВ, рдФрд░ рдХрдИ рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдХрд╛рд░реНрдпрд╢реАрд▓ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдХреБрдЫ рдХреИрд╢ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрджреЗрд╢ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЖрдк рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЪреЗрд╣рд░рд╛ред <br><a name="habracut"></a><br>  рдореИрдВ "рд╕реМрдВрдкрд╛" рдХреНрдпреЛрдВ рдХрд╣рддрд╛ рд╣реВрдВ?  рдХреНрдпреЛрдВрдХрд┐ рдХреИрд╢рд┐рдВрдЧ, рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдпрд╣ рдмрдбрд╝реЗ, рдЕрддреНрдпрдзрд┐рдХ рднрд░реА рд╣реБрдИ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдкреНрд░рддрд┐ рдорд┐рдирдЯ рд╣рдЬрд╛рд░реЛрдВ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рдеред  рдРрд╕реА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ, рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЕрдзрд┐рднрд╛рд░ рдирд╣реАрдВ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рд╡реЗ рдЖрдо рддреМрд░ рдкрд░ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЙрд▓ рдХреЛ рдХреИрд╢ рдХрд░рддреЗ рд╣реИрдВред  рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЕрдЧрд░ рдпрд╣ рдЬреНрдЮрд╛рдд рд╣реИ рдХрд┐ рдХреБрдЫ рдорд╛рд╕реНрдЯрд░ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдбреЗрдЯрд╛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЖрд╡реГрддреНрддрд┐ рдкрд░ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣рдо рдЦреБрдж рдЗрд╕ рддрд░рд╣ рдХреА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЛ рдирд╣реАрдВ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рд╣рдо рдЙрди рдкрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред  рдпрджрд┐ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЫреЛрдЯрд╛ рд╣реИ рдФрд░ рдУрд╡рд░рд▓реЛрдб рдХрд╛ рдЦрддрд░рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ, рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рдХреБрдЫ рднреА рдХреИрд╢ рдирд╣реАрдВ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ - рд╣рдореЗрд╢рд╛ рддрд╛рдЬрд╛ рдбреЗрдЯрд╛ рд╣рдореЗрд╢рд╛ рд╕рдордп-рд╕рдордп рдкрд░ рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЧрдП рд▓реЛрдЧреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИред <br><br>  рдЖрдорддреМрд░ рдкрд░, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдкрджреЛрдВ рдореЗрдВ, рд╕реНрдкреАрдХрд░ рдкрд╣рд▓реЗ рд╣реБрдб рдХреЗ рдиреАрдЪреЗ рдХреНрд░реЙрд▓ рдХрд░рддрд╛ рд╣реИ, рддрдХрдиреАрдХ рдХреА рд╣рд┐рдореНрдордд рдореЗрдВ рджреЗрд░реА рдХрд░рдиреЗ рд▓рдЧрддрд╛ рд╣реИ, рдЬреЛ рдкрд╛рдардХ рдХреЛ рдмрд╣реБрдд рдкрд░реЗрд╢рд╛рди рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдХреЗрд╡рд▓ рддрдм, рдЬрдм рд╡рд╣ рд▓реЗрдЦ рдХреЗ рдПрдХ рдЕрдЪреНрдЫреЗ рдЖрдзреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рдХрд▓рддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ рднреА рдирд╣реАрдВ рд╕рдордЭрддрд╛ рд╣реИ, рдпрд╣ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╕рдм рдХреБрдЫ рдЕрд▓рдЧ рд╣реЛрдЧрд╛ред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЗрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдЕрдзрд┐рдорд╛рдирддрдГ, рдХрдо рд╕реЗ рдХрдо рдкреНрд░рдпрд╛рд╕ рдХреЗ рд╕рд╛рде, рдФрд░ рдлрд┐рд░, рдпрджрд┐ рдЖрдк рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХреИрд╢ рд╣реБрдб рдХреЗ рдиреАрдЪреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд┐рди рдХреЗ рдЕрдВрджрд░ рд╣реА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд╛рдЗрди-рдЯреНрдпреВрд╢рди рдХреИрд╢рд┐рдВрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рднрд▓реЗ рд╣реА рдЖрдк (рдФрд░ рдпрд╣ рдмрд┐рдВрджреБ 6 рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ), рдЖрдкрдХреА рдХреИрд╢рд┐рдВрдЧ рдЙрд╕реА рддрд░рд╣ рдХрд╛рдо рдХрд░реЗрдЧреАред <br><br>  рд╣рдо рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдХреИрд╢рд┐рдВрдЧ рдХреЗ рд╕рднреА рдкрд╣рд▓реБрдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдореИрдВрдиреЗ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ рдерд╛ред  рдЕрдВрдд рдореЗрдВ, рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рд╣реЛрдЧрд╛ред <br><br><h2>  0. рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдирд╛ </h2><br>  рд╣рдо рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЗрдХрд╛рдИ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред  рдореИрдВрдиреЗ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рд▓реЛрдореНрдмреЛрдХ, рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢, рд╕реНрдкреНрд░рд┐рдВрдЧ рдбреЗрдЯрд╛ рдЬреЗрдкреАрдП рдФрд░ рдПрдЪ 2 рдХреЛ рдЬреЛрдбрд╝рд╛ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреЗрд╡рд▓ рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢ рдХреЗ рд╕рд╛рде рд╣реА рдЦрджреЗрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><pre><code class="java hljs">plugins { id <span class="hljs-string"><span class="hljs-string">'org.springframework.boot'</span></span> version <span class="hljs-string"><span class="hljs-string">'2.1.7.RELEASE'</span></span> id <span class="hljs-string"><span class="hljs-string">'io.spring.dependency-management'</span></span> version <span class="hljs-string"><span class="hljs-string">'1.0.8.RELEASE'</span></span> id <span class="hljs-string"><span class="hljs-string">'java'</span></span> } group = <span class="hljs-string"><span class="hljs-string">'ru.xpendence'</span></span> version = <span class="hljs-string"><span class="hljs-string">'0.0.1-SNAPSHOT'</span></span> sourceCompatibility = <span class="hljs-string"><span class="hljs-string">'1.8'</span></span> configurations { compileOnly { extendsFrom annotationProcessor } } repositories { mavenCentral() } dependencies { implementation <span class="hljs-string"><span class="hljs-string">'org.springframework.boot:spring-boot-starter-cache'</span></span> implementation <span class="hljs-string"><span class="hljs-string">'org.springframework.boot:spring-boot-starter-data-jpa'</span></span> compileOnly <span class="hljs-string"><span class="hljs-string">'org.projectlombok:lombok'</span></span> runtimeOnly <span class="hljs-string"><span class="hljs-string">'com.h2database:h2'</span></span> annotationProcessor <span class="hljs-string"><span class="hljs-string">'org.projectlombok:lombok'</span></span> testImplementation <span class="hljs-string"><span class="hljs-string">'org.springframework.boot:spring-boot-starter-test'</span></span> }</code> </pre> <br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рдПрдХ рдЗрдХрд╛рдИ рд╣реЛрдЧреА, рдЪрд▓реЛ рдЗрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╣рддреЗ рд╣реИрдВред <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name = <span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Data</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@ToString</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.IDENTITY) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Long id; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"name"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"email"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String email; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String email)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.email = email; } }</code> </pre> <br>  рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдФрд░ рд╕реЗрд╡рд╛ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JpaRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Long</span></span></span><span class="hljs-class">&gt; </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Slf</span></span>4j <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserServiceImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> UserRepository repository; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserServiceImpl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserRepository repository)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repository = repository; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(user); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"getting user by id: {}"</span></span>, id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.findById(id) .orElseThrow(() -&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EntityNotFoundException(<span class="hljs-string"><span class="hljs-string">"User not found by id "</span></span> + id)); } }</code> </pre> <br>  рдЬрдм рд╣рдо рдЧреЗрдЯ () рд╕реЗрд╡рд╛ рдкрджреНрдзрддрд┐ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд▓реЙрдЧ рдореЗрдВ рд▓рд┐рдЦрддреЗ рд╣реИрдВред <br><br>  рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВред <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableCaching</span></span> <span class="hljs-comment"><span class="hljs-comment">// Spring Cache public class CacheApplication { public static void main(String[] args) { SpringApplication.run(CacheApplication.class, args); } }</span></span></code> </pre> <br>  рдкреНрд░реЛрдЬреЗрдХреНрдЯ рддреИрдпрд╛рд░ рд╣реИред <br><br><h2>  1. рд░рд┐рдЯрд░реНрди рдкрд░рд┐рдгрд╛рдо рдХреИрд╢рд┐рдВрдЧ </h2><br>  рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢ рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ?  рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢ рдмрд╕ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЗрдирдкреБрдЯ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП рд░рд┐рдЯрд░реНрди рдкрд░рд┐рдгрд╛рдо рдХреЛ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИред  рдЖрдЗрдП рдЗрд╕реЗ рджреЗрдЦреЗрдВред  рд╣рдо рд▓реМрдЯрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП () рд╕реЗрд╡рд╛ рдкрджреНрдзрддрд┐ рдкрд░ @ рд╡реНрдпрд╡рд╣рд╛рд░ рдпреЛрдЧреНрдп рдПрдиреЛрдЯреЗрд╢рди рдбрд╛рд▓реЗрдВрдЧреЗред  рд╣рдо рдЗрд╕ рдПрдиреЛрдЯреЗрд╢рди рдХреЛ "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛" рдирд╛рдо рджреЗрддреЗ рд╣реИрдВ (рд╣рдо рдЖрдЧреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдпрд╣ рдЕрд▓рдЧ рд╕реЗ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"getting user by id: {}"</span></span>, id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.findById(id) .orElseThrow(() -&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EntityNotFoundException(<span class="hljs-string"><span class="hljs-string">"User not found by id "</span></span> + id)); }</code> </pre> <br>  рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдкрд░реАрдХреНрд╖рдг рд▓рд┐рдЦреЗрдВрдЧреЗред <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(SpringRunner.class) <span class="hljs-meta"><span class="hljs-meta">@SpringBootTest</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractTest</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Slf</span></span>4j <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserServiceTest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> UserService service; <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User user1 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); User user2 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Kolya"</span></span>, <span class="hljs-string"><span class="hljs-string">"kolya@mail.ru"</span></span>)); getAndPrint(user1.getId()); getAndPrint(user2.getId()); getAndPrint(user1.getId()); getAndPrint(user2.getId()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAndPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"user found: {}"</span></span>, service.get(id)); } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рдЫреЛрдЯрд╛ рд╡рд┐рд╖рдпрд╛рдВрддрд░, рдореИрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдмреНрд╕рдЯреНрд░реИрдХреНрдЯ рдХреНрдпреЛрдВ рд▓рд┐рдЦрддрд╛ рд╣реВрдВ рдФрд░ рдЗрд╕рд╕реЗ рд╕рднреА рдкрд░реАрдХреНрд╖рдг рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓рддреЗ рд╣реИрдВред</b> <div class="spoiler_text">  рдпрджрд┐ рдХреНрд▓рд╛рд╕ рдХрд╛ рдЕрдкрдирд╛ @SpringBootTest рдПрдиреЛрдЯреЗрд╢рди рд╣реИ, рддреЛ рд╣рд░ рдмрд╛рд░ рдРрд╕реА рдХреНрд▓рд╛рд╕ рдХреЗ рд▓рд┐рдП рд╕рдВрджрд░реНрдн рдлрд┐рд░ рд╕реЗ рдЙрдард╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рд╕рдВрджрд░реНрдн 5 рд╕реЗрдХрдВрдб, рдпрд╛ рд╢рд╛рдпрдж 40 рд╕реЗрдХрдВрдб рддрдХ рдмрдврд╝ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрд╣реБрдд рдмрд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕реА рд╕рдордп, рдЖрдорддреМрд░ рдкрд░ рд╕рдВрджрд░реНрдн рдореЗрдВ рдХреЛрдИ рдЕрдВрддрд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдЖрдк рдПрдХ рд╣реА рдХрдХреНрд╖рд╛ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕рдореВрд╣ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдЪрд▓рд╛рддреЗ рд╣реИрдВ, рддреЛ рд╕рдВрджрд░реНрдн рдХреЛ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдпрджрд┐ рд╣рдо рдХреЗрд╡рд▓ рдПрдХ рдПрдиреЛрдЯреЗрд╢рди рдХрд╣рддреЗ рд╣реИрдВ, рддреЛ рдПрдХ рдЕрдореВрд░реНрдд рд╡рд░реНрдЧ рдХреЗ рдКрдкрд░, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣реИ, рдпрд╣ рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рд╕рдВрджрд░реНрдн рдмрдврд╝рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br>  рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рдореИрдВ рдкрд░реАрдХреНрд╖рдг / рдЕрд╕реЗрдВрдмрд▓реА рдХреЗ рджреМрд░рд╛рди рдЙрдард╛рдП рдЧрдП рд╕рдВрджрд░реНрднреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░рдирд╛ рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реВрдВред <br></div></div><br>  рд╣рдорд╛рд░рд╛ рдкрд░реАрдХреНрд╖рдг рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ?  рд╡рд╣ рджреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ 2 рдмрд╛рд░ рдЦреАрдВрдЪрддрд╛ рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ, рд╣рдо @ рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рдПрдиреЛрдЯреЗрд╢рди рдбрд╛рд▓рддреЗ рд╣реИрдВ, рдЬреЛ рд▓реМрдЯреЗ рд╣реБрдП рдореВрд▓реНрдпреЛрдВ рдХреЛ рдХреИрд╢ рдХрд░реЗрдЧрд╛ред  рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдкреНрд░рд╛рдкреНрдд () рд╡рд┐рдзрд┐ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЙрдЧ рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддреЗ рд╣реИрдВред  рд╕рд╛рде рд╣реА, рд╣рдо рдЖрд╡реЗрджрди (рдкреНрд░рд╛рдкреНрдд) рд╡рд┐рдзрд┐ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддреНрдпреЗрдХ рдпрд╛рддреНрд░рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд▓реЙрдЧ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдкрд░реАрдХреНрд╖рдг рдЪрд▓рд╛рдПрдВред  рдпрд╣ рд╣рдореЗрдВ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдорд┐рд▓рддрд╛ рд╣реИред <br><br><pre> <code class="java hljs">getting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> user found: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> user found: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Kolya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) user found: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) user found: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Kolya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ, рдкрд╣рд▓реЗ рджреЛ рдмрд╛рд░ рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд () рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдЧрдП рдереЗ рдФрд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдорд┐рд▓рд╛ рдерд╛ред  рдЕрдиреНрдп рд╕рднреА рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХреЙрд▓ рдирд╣реАрдВ рдерд╛, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ рдХреБрдВрдЬреА рджреНрд╡рд╛рд░рд╛ рдХреИрд╢ рдбреЗрдЯрд╛ рд▓рд┐рдпрд╛ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдЖрдИрдбреА рд╣реИ)ред <br><br><h2>  2. рдХреИрд╢рд┐рдВрдЧ рдХреБрдВрдЬреА рдШреЛрд╖рдгрд╛ </h2><br>  рдХрдИ рдкреИрд░рд╛рдореАрдЯрд░ рдХреИрд╢реНрдб рдкрджреНрдзрддрд┐ рдореЗрдВ рдЖрддреЗ рд╣реИрдВред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдкреИрд░рд╛рдореАрдЯрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХреИрд╢рд┐рдВрдЧ рд╣реЛрдЧрд╛ред  рд╣рдо рдПрдХ рдРрд╕реА рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЗрдХрдЯреНрдареА рд╣реБрдИ рдЗрдХрд╛рдИ рдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдЧреА, рд▓реЗрдХрд┐рди рдпрджрд┐ рд╕рдорд╛рди рдирд╛рдо рд╡рд╛рд▓реА рдХреЛрдИ рдЗрдХрд╛рдИ рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рд╣реИ, рддреЛ рд╣рдо рдЙрд╕реЗ рд╕рд╣реЗрдЬреЗрдВрдЧреЗ рдирд╣реАрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдХреИрд╢рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдирд╛рдо рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВрдЧреЗред  рдпрд╣ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(value = <span class="hljs-string"><span class="hljs-string">"users"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#name"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String email)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"creating user with parameters: {}, {}"</span></span>, name, email); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(name, email)); }</code> </pre> <br>  рдЪрд▓реЛ рдЗрд╕реА рдкрд░реАрдХреНрд╖рдг рд▓рд┐рдЦреЗрдВ: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan1122@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Sergey"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); log.info(<span class="hljs-string"><span class="hljs-string">"all entries are below:"</span></span>); service.getAll().forEach(u -&gt; log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, u.toString())); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAndPrint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String email)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"created user: {}"</span></span>, service.create(name, email)); }</code> </pre> <br>  рд╣рдо рддреАрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рджреЛ рдХреЗ рд▓рд┐рдП рдирд╛рдо рд╕рдорд╛рди рд╣реЛрдЧрд╛ <br><br><pre> <code class="java hljs"> createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan1122@mail.ru"</span></span>);</code> </pre> <br>  рдФрд░ рджреЛ рдореЗрдВ рд╕реЗ рдЬреЛ рдИрдореЗрд▓ рд╕реЗ рдореЗрд▓ рдЦрд╛рдПрдЧрд╛ <br><br><pre> <code class="java hljs"> createAndPrint(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>); createAndPrint(<span class="hljs-string"><span class="hljs-string">"Sergey"</span></span>, <span class="hljs-string"><span class="hljs-string">"ivan@mail.ru"</span></span>);</code> </pre> <br>  рдирд┐рд░реНрдорд╛рдг рд╡рд┐рдзрд┐ рдореЗрдВ, рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рддрдереНрдп рдХреЛ рд▓реЙрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡рд┐рдзрд┐ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдЙрди рд╕рднреА рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЛ рд▓реЙрдЧ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдпрд╣ рд╡рд┐рдзрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд▓реМрдЯреА рд╣реИред  рдкрд░рд┐рдгрд╛рдо рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛрдЧрд╛: <br><br><pre> <code class="java hljs">creating user with parameters: Ivan, ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru created user: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Ivan, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Ivan, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) creating user with parameters: Sergey, ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru created user: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Sergey, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) all entries are below: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Ivan, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Sergey, email=ivan<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ 3 рдмрд╛рд░ рд╡рд┐рдзрд┐ рдХреЛ рдмреБрд▓рд╛рдпрд╛, рдФрд░ рдХреЗрд╡рд▓ рджреЛ рдмрд╛рд░ рдЗрд╕рдореЗрдВ рдЪрд▓рд╛ рдЧрдпрд╛ред  рдПрдХ рдмрд╛рд░ рдПрдХ рдХреБрдВрдЬреА рдПрдХ рд╡рд┐рдзрд┐ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ, рдФрд░ рдпрд╣ рдмрд╕ рдПрдХ рдХреИрд╢реНрдб рдорд╛рди рд╡рд╛рдкрд╕ рдХрд░ рджрд┐рдпрд╛ред <br><br><h2>  3. рдордЬрдмреВрд░ рдХреИрд╢рд┐рдВрдЧред  @CachePut </h2><br>  рдРрд╕реА рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рд╣рдо рдХрд┐рд╕реА рдЗрдХрд╛рдИ рдХреЗ рд▓рд┐рдП рд░рд┐рдЯрд░реНрди рд╡реИрд▓реНрдпреВ рдХреИрд╢ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рд╛рде рд╣реА рд╣рдореЗрдВ рдХреИрд╢ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЗрд╕ рддрд░рд╣ рдХреА рдЬрд░реВрд░рддреЛрдВ рдХреЗ рд▓рд┐рдП, @ рдХреИрд╢ рдПрдиреЛрдЯреЗрд╢рди рдореМрдЬреВрдж рд╣реИред  рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╡рд┐рдзрд┐ рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рд░рд┐рдЯрд░реНрди рд╡реИрд▓реНрдпреВ рдХреЗ рд▓рд┐рдП рдХреИрд╢ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реБрдП, рднрд▓реЗ рд╣реА рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреИрд╢ рд╣реЛред <br><br>  рдХреБрдЫ рддрд░реАрдХреЗ рдЬреЛрдбрд╝реЗрдВ рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмрдЪрд╛рдПрдВрдЧреЗред  рд╣рдо рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рд╣рдореЗрд╢рд╛ рдХреЗ рд▓рд┐рдП @Cacheable рдПрдиреЛрдЯреЗрд╢рди рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдВрдЧреЗ, рджреВрд╕рд░рд╛ @CachePut рдХреЗ рд╕рд╛рдеред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(value = <span class="hljs-string"><span class="hljs-string">"users"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.name"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createOrReturnCached</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"creating user: {}"</span></span>, user); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(user); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(value = <span class="hljs-string"><span class="hljs-string">"users"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.name"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAndRefreshCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"creating user: {}"</span></span>, user); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> repository.save(user); }</code> </pre> <br>  рдкрд╣рд▓реА рд╡рд┐рдзрд┐ рдХреЗрд╡рд▓ рдХреИрд╢ рдХрд┐рдП рдЧрдП рдорд╛рдиреЛрдВ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░реЗрдЧреА, рджреВрд╕рд░рд╛ рдХреИрд╢ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдЧрд╛ред  рдХреИрд╢рд┐рдВрдЧ рдХреБрдВрдЬреА # user.name рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╣рдо рдЗрд╕реА рдкрд░реАрдХреНрд╖рдг рдХреЛ рд▓рд┐рдЦреЗрдВрдЧреЗред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAndRefresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User user1 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user1: {}"</span></span>, user1); User user2 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"misha@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user2: {}"</span></span>, user2); User user3 = service.createAndRefreshCache(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"kolya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user3: {}"</span></span>, user3); User user4 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"petya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"created user4: {}"</span></span>, user4); }</code> </pre> <br>  рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╡рд░реНрдгрд┐рдд рддрд░реНрдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдкрд╣рд▓реА рдмрд╛рд░ "рд╡рд╛рд╕реНрдпрд╛" рдирд╛рдо рд╡рд╛рд▓рд╛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ createOrReturnCached () рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо рддрдм рдПрдХ рдХреИрд╢реНрдб рдЗрдХрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗ, рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрд╡рдпрдВ рд╡рд┐рдзрд┐ рдореЗрдВ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ред  рдЕрдЧрд░ рд╣рдо createAndRefreshCache () рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреИрд╢ "рд╡рд╛рд╕реНрдпрд╛" рдирд╛рдо рдХреА рдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП рдХреИрд╢реНрдб рдЗрдХрд╛рдИ рдХреЛ рдХреИрд╢ рдореЗрдВ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдЪрд▓реЛ рдкрд░реАрдХреНрд╖рдг рдЪрд▓рд╛рддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдХреНрдпрд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><pre> <code class="java hljs">creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user1: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user2: User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user3: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) created user4: User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=kolya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ user1 рдиреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдФрд░ рдХреИрд╢ рдкрд░ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓рд┐рдЦрд╛ рд╣реИред  рдЬрдм рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЙрд╕реА рдирд╛рдо рд╕реЗ рд░рд┐рдХреЙрд░реНрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдкрд╣рд▓реЗ рдХреЙрд▓ (user2) рдХрд╛ рдХреИрд╢реЗрдб рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП id user1 рдЬреИрд╕реА рд╣реА рд╣реЛрддреА рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рдмрддрд╛рддреА рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓рд┐рдЦрд┐рдд рдирд╣реАрдВ рдерд╛, рдФрд░ рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рдХреИрд╢ рд╣реИ)ред  рдЕрдЧрд▓рд╛, рд╣рдо рддреАрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рджреВрд╕рд░реА рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рдХреИрд╢реНрдб рдкрд░рд┐рдгрд╛рдо рдХреЗ рд╕рд╛рде рднреА, рдлрд┐рд░ рднреА рд╡рд┐рдзрд┐ рдХреЛ рдмреБрд▓рд╛рддрд╛ рд╣реИ рдФрд░ рдХреИрд╢ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдкрд░рд┐рдгрд╛рдо рд▓рд┐рдЦрддрд╛ рд╣реИред  рдпрд╣ user3 рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдирдИ рдЖрдИрдбреА рд╣реИред  рдЬрд┐рд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдкрд╣рд▓реА рд╡рд┐рдзрд┐ рдХрд╣рддреЗ рд╣реИрдВ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ 3 рджреНрд╡рд╛рд░рд╛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдирдпрд╛ рдХреИрд╢ рд▓реЗрддрд╛ рд╣реИред <br><br><h2>  4. рдХреИрд╢ рд╕реЗ рд╣рдЯрд╛рдирд╛ред  @CacheEvict </h2><br>  рдХрднреА-рдХрднреА рдХреИрд╢ рдореЗрдВ рдХреБрдЫ рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рдХрдард┐рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдЗрдХрд╛рдИ рдкрд╣рд▓реЗ рд╣реА рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рд╣рдЯрд╛ рджреА рдЧрдИ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрднреА рднреА рдХреИрд╢ рд╕реЗ рд╕реБрд▓рдн рд╣реИред  рдбреЗрдЯрд╛ рд╕реНрдерд┐рд░рддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рд╣рдЯрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред <br><br>  рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдФрд░ рд╡рд┐рдзрд┐рдпрд╛рдБ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"deleting user by id: {}"</span></span>, id); repository.deleteById(id); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteAndEvict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Long id)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"deleting user by id: {}"</span></span>, id); repository.deleteById(id); }</code> </pre> <br>  рдкрд╣рд▓рд╛ рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╣рдЯрд╛ рджреЗрдЧрд╛, рджреВрд╕рд░рд╛ рднреА рдЗрд╕реЗ рд╣рдЯрд╛ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ @CacheEvict рдПрдиреЛрдЯреЗрд╢рди рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдВрдЧреЗред  рдПрдХ рдкрд░реАрдХреНрд╖рдг рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рджреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмрдирд╛рдПрдЧрд╛, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдПрдХ рдХреЛ рдПрдХ рд╕рд░рд▓ рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рджреВрд╕рд░рд╛ рдПрдХ рдПрдиреЛрдЯреЗрдЯ рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд () рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User user1 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user1.getId())); User user2 = service.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user2.getId())); service.delete(user1.getId()); service.deleteAndEvict(user2.getId()); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user1.getId())); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user2.getId())); }</code> </pre> <br>  рдпрд╣ рддрд░реНрдХрд╕рдВрдЧрдд рд╣реИ рдХрд┐ рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреИрд╢ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдирд┐рд╖реНрдХрд╛рд╕рди рд╣рдореЗрдВ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╕реЗ рдирд╣реАрдВ рд░реЛрдХреЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреИрд╢ рд╣реИред  рдЖрдЗрдП рджреЗрдЦрддреЗ рд╣реИрдВ рд▓реЙрдЧреНрд╕ред <br><br><pre> <code class="java hljs">getting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) deleting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> deleting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> javax.persistence.EntityNotFoundException: User not found by id <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЖрд╡реЗрджрди рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рджреЛрдиреЛрдВ рдмрд╛рд░ () рд╡рд┐рдзрд┐ рд╕реЗ рдЧрдпрд╛ рдФрд░ рд╕реНрдкреНрд░рд┐рдВрдЧ рдиреЗ рдЗрди рд╕рдВрд╕реНрдерд╛рдУрдВ рдХреЛ рдХреИрд╢ рдХрд░ рджрд┐рдпрд╛ред  рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдордиреЗ рдЙрдиреНрд╣реЗрдВ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ред  рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛, рдФрд░ рдХреИрд╢реНрдб рдорд╛рди рдмрдирд╛ рд░рд╣рд╛, рдЗрд╕рд▓рд┐рдП рдЬрдм рд╣рдордиреЗ id 1 рдХреЗ рддрд╣рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛, рддреЛ рд╣рдо рд╕рдлрд▓ рд╣реБрдПред  рдЬрдм рд╣рдордиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ 2 рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛, рддреЛ рд╡рд┐рдзрд┐ рдиреЗ EntityNotFoundException рд▓реМрдЯрд╛ рджреА - рдХреИрд╢ рдореЗрдВ рдРрд╕рд╛ рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╣реАрдВ рдерд╛ред <br><br><h2>  5. рд╕рдореВрд╣ рдмрдирд╛рдирд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ред  @Caching </h2><br>  рдХрднреА-рдХрднреА рдПрдХ рдПрдХрд▓ рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдХрдИ рдХреИрд╢рд┐рдВрдЧ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЗрди рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП @ рдХреЛрдЪрд┐рдВрдЧ рдПрдиреЛрдЯреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Caching</span></span>( cacheable = { <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@Cacheable</span></span>(<span class="hljs-string"><span class="hljs-string">"contacts"</span></span>) }, put = { <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(<span class="hljs-string"><span class="hljs-string">"tables"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(<span class="hljs-string"><span class="hljs-string">"chairs"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@CachePut</span></span>(value = <span class="hljs-string"><span class="hljs-string">"meals"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.email"</span></span>) }, evict = { <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(value = <span class="hljs-string"><span class="hljs-string">"services"</span></span>, key = <span class="hljs-string"><span class="hljs-string">"#user.name"</span></span>) } ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheExample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br>  рдпрд╣ рд╕рдореВрд╣ рдПрдиреЛрдЯреЗрд╢рди рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рд╣реИред  рдЕрдЧрд░ рдЖрдк рдХрд┐рд╕реА рдЪреАрдЬрд╝ рдХреЛ рдвреЗрд░ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"meals"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"contacts"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@CacheEvict</span></span>(<span class="hljs-string"><span class="hljs-string">"tables"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheExample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(User user)</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br>  рддрдм IDEA рдЖрдкрдХреЛ рдмрддрд╛рдПрдЧрд╛ рдХрд┐ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИред <br><br><h2>  6. рд▓рдЪреАрд▓рд╛ рд╡рд┐рдиреНрдпрд╛рд╕ред  CacheManager </h2><br>  рдЕрдВрдд рдореЗрдВ, рд╣рдордиреЗ рдХреИрд╢ рдирд┐рдХрд╛рд▓рд╛, рдФрд░ рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХреБрдЫ рд╕рдордЭ рд╕реЗ рдкрд░реЗ рдФрд░ рдбрд░рд╛рд╡рдирд╛ рдерд╛ред  рдЕрдм рдЪрд▓реЛ рд╣реБрдб рдХреЗ рдиреАрдЪреЗ рджреЗрдЦреЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рд╣рдо рдХреИрд╢рд┐рдВрдЧ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдХреИрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдРрд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, рдПрдХ CacheManager рд╣реИред  рдпрд╣ рдЬрд╣рд╛рдБ рднреА рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреИрд╢ рд╣реИ рд╡рд╣рд╛рдБ рдореМрдЬреВрдж рд╣реИред  рдЬрдм рд╣рдордиреЗ @EnableCache рдПрдиреЛрдЯреЗрд╢рди рдЬреЛрдбрд╝рд╛, рддреЛ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдХреЛ рд╕реНрдкреНрд░рд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╣рдо рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рд╣рдо ApplicationContext рдХреЛ рдСрдЯреЛ-рд░реИрдк рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдкрд░ рдЦреЛрд▓рддреЗ рд╣реИрдВред  рдЕрдиреНрдп рдбрд┐рдмреНрдмреЗ рдореЗрдВ, рдХреИрд╢рдореИрдиреЗрдЬрд░ рдмреАрди рд╣реЛрдЧрд╛ред <br><br><img src="https://habrastorage.org/webt/nc/bn/vp/ncbnvpwm57vw-2i9t7xpaiwr29s.png"><br><br>  рдореИрдВрдиреЗ рдЙрд╕ рд╕рдордп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕реНрдЯреЗрдЬ рдкрд░ рд░реЛрдХ рджрд┐рдпрд╛ рдерд╛ рдЬрдм рджреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рд▓реЗ рд╣реА рдмрдирд╛рдП рдЬрд╛ рдЪреБрдХреЗ рдереЗ рдФрд░ рдХреИрд╢ рдореЗрдВ рдбрд╛рд▓ рджрд┐рдП рдЧрдП рдереЗред  рдпрджрд┐ рд╣рдо рд╕реЗрдо рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╝рд░реВрд░рдд рд╣реЛрддреА рд╣реИ, рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдРрд╕реА рдмреАрди рд╣реИ, рдЗрд╕рдореЗрдВ "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛" рдХреБрдВрдЬреА рдФрд░ рдореВрд▓реНрдп рд╕рдорд╡рд░реНрддреА рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреИрд╢реНрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/7-/xt/s9/7-xts9jrjipidhtsls1nv4gr2o0.png"><br><br>  рд╣рдо, рдмрджрд▓реЗ рдореЗрдВ, рд╣реИрдмрд░ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╣рдорд╛рд░реЗ рд╕реНрд╡рд╛рдж рдХреЗ рд▓рд┐рдП рдареАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(<span class="hljs-string"><span class="hljs-string">"habrCacheManager"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CacheManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre> <br>  рдпрд╣ рдХреЗрд╡рд▓ рдпрд╣ рдЪреБрдирдирд╛ рд╣реИ рдХрд┐ рд╣рдо рдХрд┐рд╕ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐ рдЙрдирдореЗрдВ рд╕реЗ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╣реИрдВред  рдореИрдВ рд╕рднреА рдХреИрд╢ рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛, рдпрд╣ рдЬрд╛рдирдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛ рдХрд┐ рдРрд╕реЗ рд╣реИрдВ: <br><br><ul><li>  <i><b>SimpleCacheManager</b></i> рд╕рдмрд╕реЗ рд╕рд░рд▓ рдХреИрд╢ рдкреНрд░рдмрдВрдзрдХ рд╣реИ, рдЬреЛ рд╕реАрдЦрдиреЗ рдФрд░ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред </li><li>  <i><b>ConcurrentMapCacheManager</b></i> - Lazily рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рджрд┐рдП рдЧрдП рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдкрд░реАрдХреНрд╖рдг рдФрд░ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рднреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдХреИрд╢ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд┐рдпрд╛ рдЬрд╛рдП, рд╕рд╛рде рд╣реА рд╣рдорд╛рд░реЗ рдЬреИрд╕реЗ рдХреБрдЫ рд╕рд░рд▓ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рднреАред  рдХреИрд╢ рдХреЗ рд╕рд╛рде рдЧрдВрднреАрд░ рдХрд╛рдо рдХреЗ рд▓рд┐рдП, рдиреАрдЪреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЧрдИ рд╣реИред </li><li>  <i><b>JCacheCacheManager</b></i> , <i><b>EhCacheCacheManager</b></i> , <i><b>CaffeineCacheManager</b></i> рдЧрдВрднреАрд░ "рдкрд╛рд░реНрдЯрдирд░ рдкрд╛рд░реНрдЯрдирд░" рдХреИрд╢ рдореИрдиреЗрдЬрд░ рд╣реИрдВ, рдЬреЛ рд▓рдЪреАрд▓реЗ рд░реВрдк рд╕реЗ рдЕрдиреБрдХреВрд▓рди рдпреЛрдЧреНрдп рд╣реИрдВ рдФрд░ рдмрд╣реБрдд рд╡рд┐рд╕реНрддреГрдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред </li></ul><br>  рдореЗрд░реА рд╡рд┐рдирдореНрд░ рдкреЛрд╕реНрдЯ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВ рдкрд┐рдЫрд▓реЗ рддреАрди рдХреЗ рдХреИрд╢ рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХрд╛ рд╡рд░реНрдгрди рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╣рдо рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЪреБрдЕрд▓ рдХреИрд╢реЗрдореИрдиреЗрдЬрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рдХрдИ рдкрд╣рд▓реБрдУрдВ рдХреЛ рджреЗрдЦреЗрдВрдЧреЗред <br><br>  рддреЛ, рдЪрд▓реЛ рд╣рдорд╛рд░реЗ рдХреИрд╢ рдкреНрд░рдмрдВрдзрдХ рдХреЛ рдлрд┐рд░ рд╕реЗ рдмрдирд╛рдПрдБред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(<span class="hljs-string"><span class="hljs-string">"habrCacheManager"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CacheManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentMapCacheManager(); }</code> </pre> <br>  рд╣рдорд╛рд░рд╛ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рддреИрдпрд╛рд░ рд╣реИред <br><br><h2>  7. рдХреИрд╢ рд╕реЗрдЯрдЕрдкред  рдЬреАрд╡рди рд╕рдордп, рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдФрд░ рдЗрддрдиреЗ рдкрд░ред </h2><br>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рдХрд╛рдлреА рд▓реЛрдХрдкреНрд░рд┐рдп Google рдЕрдорд░реВрдж рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдореИрдВрдиреЗ рд╕рдмрд╕реЗ рдЖрдЦрд┐рд░реА рд▓рд┐рдпрд╛ред <br><br><pre> <code class="java hljs">compile group: <span class="hljs-string"><span class="hljs-string">'com.google.guava'</span></span>, name: <span class="hljs-string"><span class="hljs-string">'guava'</span></span>, version: <span class="hljs-string"><span class="hljs-string">'28.1-jre'</span></span></code> </pre> <br>  рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдмрдирд╛рддреЗ рд╕рдордп, рд╣рдо createConcurrentMapCache рд╡рд┐рдзрд┐ рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдЕрдорд░реВрдж рд╕реЗ CacheBuilder рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗред  рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЛрдВ рдХреЛ рд╢реБрд░реВ рдХрд░рдХреЗ рдХреИрд╢ рдореИрдиреЗрдЬрд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ рдЬрд╛рдПрдЧрд╛: <br><br><ul><li>  maxSize - рдЙрди рдорд╛рдиреЛрдВ рдХрд╛ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдЬреЛ рдХреИрд╢ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕ рдФрд░ рдЬреЗрд╡реАрдПрдо рд░реИрдо рдкрд░ рд▓реЛрдб рдХреЗ рдмреАрдЪ рдПрдХ рд╕рдордЭреМрддрд╛ рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </li><li>  refreshAfterWrite - рдХреИрд╢ рдореЗрдВ рдореВрд▓реНрдп рд▓рд┐рдЦрдиреЗ рдХреЗ рдмрд╛рдж рдХрд╛ рд╕рдордп, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </li><li>  expireAfterAccess - рдЕрдВрддрд┐рдо рдХреЙрд▓ рдХреЗ рдмрд╛рдж рдореВрд▓реНрдп рдХрд╛ рдЬреАрд╡рдирдХрд╛рд▓ред </li><li>  expireAfterWrite - рдХреИрд╢ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреЗ рдмрд╛рдж рдореВрд▓реНрдп рдХрд╛ рдЬреАрд╡рдирдХрд╛рд▓ред  рдпрд╣ рд╡рд╣ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВрдЧреЗред </li></ul><br>  рдФрд░ рдЕрдиреНрдпред <br><br>  рд╣рдо рдкреНрд░рдмрдВрдзрдХ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рдЬреАрд╡рдирдХрд╛рд▓ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЗрдВрддрдЬрд╛рд░ рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, 1 рд╕реЗрдХрдВрдб рд╕реЗрдЯ рдХрд░реЗрдВред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span>(<span class="hljs-string"><span class="hljs-string">"habrCacheManager"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> CacheManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentMapCacheManager() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Cache </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createConcurrentMapCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentMapCache( name, CacheBuilder.newBuilder() .expireAfterWrite(<span class="hljs-number"><span class="hljs-number">1</span></span>, TimeUnit.SECONDS) .build().asMap(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }; }</code> </pre> <br>  рд╣рдо рдЗрд╕ рдорд╛рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд░реАрдХреНрд╖рдг рд▓рд┐рдЦрддреЗ рд╣реИрдВред <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkSettings</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> InterruptedException </span></span>{ User user1 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user1.getId())); User user2 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user2.getId())); Thread.sleep(<span class="hljs-number"><span class="hljs-number">1000L</span></span>); User user3 = service.createOrReturnCached(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> User(<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"vasya@mail.ru"</span></span>)); log.info(<span class="hljs-string"><span class="hljs-string">"{}"</span></span>, service.get(user3.getId())); }</code> </pre> <br>  рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд▓рд┐рдП рдХрдИ рдорд╛рди рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВ, рдФрд░ рдпрджрд┐ рдбреЗрдЯрд╛ рдХреИрд╢ рд╣реИ, рддреЛ рд╣рдо рдХреБрдЫ рднреА рдирд╣реАрдВ рдмрдЪрд╛рддреЗ рд╣реИрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рджреЛ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдмрдЪрд╛рддреЗ рд╣реИрдВ, рдлрд┐рд░ рд╣рдо 1 рд╕реЗрдХрдВрдб рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдХреИрд╢ рдореГрдд рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╣рдо рдПрдХ рдФрд░ рдореВрд▓реНрдп рдмрдЪрд╛рддреЗ рд╣реИрдВред <br><br><pre> <code class="java hljs">creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">1</span></span> User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) User(id=<span class="hljs-number"><span class="hljs-number">1</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) creating user: User(id=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru) getting user by id: <span class="hljs-number"><span class="hljs-number">2</span></span> User(id=<span class="hljs-number"><span class="hljs-number">2</span></span>, name=Vasya, email=vasya<span class="hljs-meta"><span class="hljs-meta">@mail</span></span>.ru)</code> </pre> <br>  рд▓реЙрдЧ рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ рдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдпрд╛ рдерд╛, рдлрд┐рд░ рд╣рдордиреЗ рдПрдХ рдФрд░ рдХреЛрд╢рд┐рд╢ рдХреА, рд▓реЗрдХрд┐рди рдЪреВрдВрдХрд┐ рдбреЗрдЯрд╛ рдХреИрд╢ рдерд╛, рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдЗрд╕реЗ рдХреИрд╢ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ (рджреЛрдиреЛрдВ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЬрдм рдмрдЪрдд рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛ рд░рд╣рд╛ рд╣реИ)ред  рдлрд┐рд░ рдХреИрд╢ рдЦрд░рд╛рдм рд╣реЛ рдЧрдпрд╛, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рд░рд┐рдХреЙрд░реНрдб рд╣рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрдЪрдд рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИред <br><br><h2>  8. рд╕рдВрдХреНрд╖реЗрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП </h2><br>  рдЬрд▓реНрджреА рдпрд╛ рдмрд╛рдж рдореЗрдВ, рдбреЗрд╡рд▓рдкрд░ рдХреЛ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдХреИрд╢рд┐рдВрдЧ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИред  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдпрд╣ рд▓реЗрдЦ рдЖрдкрдХреЛ рд╡рд┐рд╖рдп рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдХреИрд╢рд┐рдВрдЧ рдореБрджреНрджреЛрдВ рдХреЛ рдЕрдзрд┐рдХ рд╕рд╛рд╣рд╕рдкреВрд░реНрд╡рдХ рджреЗрдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред <br><br>  рдпрд╣рд╛рдБ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рдЧрд┐рддреНрдмрдо: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/promoscow/cache</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi465667/">https://habr.com/ru/post/hi465667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi465655/index.html">OpenStreetMap рд╕рдВред 474 (08.13.2019-19.08.2019) рдХреА рджреБрдирд┐рдпрд╛ рд╕реЗ рд╕рдорд╛рдЪрд╛рд░</a></li>
<li><a href="../hi465657/index.html">рдкрд╛рд░реНрдХрд┐рдВрд╕рдВрд╕ рдХрд╛рдиреВрди: рдЖрдк рдЗрд╕реЗ рд╣рд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi465659/index.html">"рдорд╕рдХрд╛рдЗрдЯ рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдЗрдмреЗрд░рд┐рдпрд╛ рдХреА рд╡рд┐рдЬрдп," рдпрд╛ рдмреАрд╕ рд╕рд╛рд▓ рдмрд╛рдж рдХреЗ рд▓реЗрдЦ рдХрд╛ рдЬрд╡рд╛рдм</a></li>
<li><a href="../hi465661/index.html">рдХреНрдпрд╛ рдЖрдкрдХрд╛ рднреА рдРрд╕рд╛ рдХреЛрдИ рджреЛрд╕реНрдд рд╣реИ? рдпрд╛ рд╢рд╛рдпрдж рдпрд╣ рдЖрдк рд╣реИрдВ?</a></li>
<li><a href="../hi465663/index.html">рд╕реБрдкрд░рдЬреЙрдм рдПрдкреАрдЖрдИ рдПрдлрдПрдХреНрдпреВ (рдЬреЙрдм рдкреЛрд╕реНрдЯрд┐рдВрдЧ)</a></li>
<li><a href="../hi465669/index.html">рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдбрд┐рдВрдЧ рдЧрддрд┐ рдХреА рдЧрдгрдирд╛</a></li>
<li><a href="../hi465673/index.html">рд╣реЗрдбреА рд▓рд╛рдорд░: рд╣реЙрд▓реАрд╡реБрдб рдХреЗ рдЖрд╡рд┐рд╖реНрдХрд╛рд░рдХ</a></li>
<li><a href="../hi465675/index.html">рдирд╛рд╕рд╛ рдХреЛ рдЕрдкрдиреЗ рдЕрдВрддрд░рд┐рдХреНрд╖ рдпрд╛рддреНрд░рд┐рдпреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЦреБрдлрд┐рдпрд╛ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдкрд░рд╡рд╛рд╣ рдХреИрд╕реЗ рд╣реИ</a></li>
<li><a href="../hi465677/index.html">рд╡реЙрдХрдореИрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓ рдЬрд╛рдУ: рдпрд╣ рд╕рднреА рд╣реЗрдбрдлрд╝реЛрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИ</a></li>
<li><a href="../hi465679/index.html">рд╕рдордп рджрд┐рдЦрд╛рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдПрдХ рдШрдбрд╝реА рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреА рд╣реИ рдФрд░ рдЕрдкрдиреА рдкрд╣рд▓реА рдШрдбрд╝реА рдХрд╛ рдЪрдпрди рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>