<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèΩ üßëüèΩ‚Äçü§ù‚Äçüßëüèº üçá Automatisierung von Gesch√§ftsprozessen in Excel oder wie man ein M√§dchen vor der Verarbeitung bewahrt ü§õüèø ü§∏üèø üßëüèø‚Äçü§ù‚ÄçüßëüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Meine Freundin kauft im Vertriebsnetz ein. In j√ºngster Zeit wurde das Unternehmen stark reduziert, sodass der Arbeitsaufwand pro Mitarbeiter dramatisc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung von Gesch√§ftsprozessen in Excel oder wie man ein M√§dchen vor der Verarbeitung bewahrt</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447346/">  Meine Freundin kauft im Vertriebsnetz ein.  In j√ºngster Zeit wurde das Unternehmen stark reduziert, sodass der Arbeitsaufwand pro Mitarbeiter dramatisch gestiegen ist.  Deshalb musste sie regelm√§√üig bei der Arbeit bleiben, manchmal sogar samstags ausgehen.  Ihre Kollegen hatten das gleiche Problem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/725/1cf/243/7251cf24339c88fbb1448a17850bb254.jpg" alt="Bild"><br><br>  √úber die Entscheidung, die es meiner Freundin erm√∂glichte, p√ºnktlich nach Hause zur√ºckzukehren, k√∂nnen Sie unter dem Schnitt lesen. <br><a name="habracut"></a><br>  Dar√ºber hinaus kann ein wesentlicher Teil ihrer Arbeit automatisiert werden: Empfangen von Daten von vorne, Ausf√ºllen von Excel-Dokumenten, Aktualisieren von Daten von vorne usw. <br><br>  In dieser Situation ist es am vern√ºnftigsten, eine Arbeitserkl√§rung zur Entwicklung der erforderlichen Funktionalit√§t zu verfassen und diese √ºber die Beh√∂rden an die Entwickler weiterzugeben.  Die Reduzierung betraf jedoch alle, einschlie√ülich der Entwickler.  Infolgedessen verf√ºgten sie nicht √ºber gen√ºgend Ressourcen, um diese Automatisierung zu implementieren.  Und das Unternehmen hatte in absehbarer Zeit nicht vor, spezialisierte RPA-Systeme zu kaufen. <br><br>  Dar√ºber hinaus wurde verst√§rkt √ºberwacht, was Mitarbeiter bei der Arbeit tun und in welchen Anwendungen sie arbeiten. <br><br>  Aufgrund all dieser widrigen Umst√§nde und meines verzweifelten Wunsches zu helfen, entschied ich mich, Funktionen f√ºr Excel in VBA zu schreiben, dank derer es m√∂glich w√§re, die Routineoperationen meiner Freundin und ihrer Kollegen zu automatisieren. <br><br><h3>  Produktanforderungen </h3><br>  Als Ausgangspunkt w√§hlte ich die Aufgabe, f√ºr die das M√§dchen die meiste Zeit nach ihren Gef√ºhlen verbrachte.  Im Rahmen dieser Aufgabe brauchte das M√§dchen: <br><br><ul><li>  √úbertragen Sie die Artikelnummer aus der Excel-Datei in die Suchleiste des Front-Office-Systems. </li><li>  F√ºr diesen Artikel erhalten Sie aus den Suchergebnissen den Kauf- und Verkaufspreis sowie eine Reihe zus√§tzlicher Werte. </li><li>  Verarbeiten Sie die gesammelten Daten in Excel, um den endg√ºltigen Produktpreis zu erstellen. </li><li>  Laden Sie die Preise zur√ºck in das System. </li><li>  Das Entladen und anschlie√üende Laden der Daten pro Tag dauerte ca. 3 Stunden. </li></ul><br>  Da meine Freundin keine Programmierkenntnisse hatte, war es notwendig, ein Tool mit einer einfachen und vertrauten Oberfl√§che in Form von Funktionen in Excel zu erstellen.  Aktionssequenzen sollten einfach als eine Sequenz von Funktionen definiert werden.  Mit einem Wort, <b>KISS</b> . <br><br>  Basierend auf diesem Fall habe ich die folgenden funktionalen Anforderungen gebildet: <br><br><ul><li>  Steuern Sie die Maus (bewegen, Tastendruck), um die entsprechenden Elemente auf dem Bildschirm hervorzuheben. </li><li>  Simulieren Sie einen Tastendruck auf der Tastatur, um Daten einzugeben. </li><li>  √úbertragen Sie Daten von Excel an Anwendungen von Drittanbietern. </li><li>  Abrufen von Daten aus einer Anwendung in Excel; </li><li>  Ausf√ºhren derselben Vorg√§nge beim Abrufen einer Formel in Excel. </li></ul><br><h3>  Die Maus und die ersten Schwierigkeiten </h3><br>  Bevor Sie den Cursor irgendwohin bewegen, m√ºssen Sie genau wissen, wohin Sie ihn bewegen m√ºssen.  In dieser Situation erscheint es mir am besten, sich einfach an die Position des Cursors zu erinnern, wenn er sich √ºber einem bestimmten Element befindet.  Um mich an die Koordinaten zu erinnern, habe ich die Funktion GetCursorPos aus der user32-Bibliothek verwendet. <br><br>  Nun, wir haben die Koordinaten, jetzt w√§re es sch√∂n, sich an sie zu erinnern.  Nun, es gibt nichts Kompliziertes, dachte ich, z√§hle einfach ein oder zwei Zellen aus der aktiven Zelle und schreibe die Koordinaten X und Y auf. ActiveCell.Offset (0, 1) .Value = x hat jedoch nicht funktioniert.  Der Wert hat sich nicht ge√§ndert.  Und als Ergebnis der Ausf√ºhrung ein Fehler.  Nach √úberpr√ºfung verschiedener Annahmen stellte sich heraus, dass das √Ñndern des Werts auf dem Blatt zu einer Nachz√§hlung des gesamten Blattes und damit der Formel f√ºhrt, die diese Nachz√§hlung verursacht.  Um diese Einschr√§nkung zu umgehen, war es anstelle eines direkten Aufrufs einer Funktion bestimmter Aktionen erforderlich, diese Aufrufe durch Auswerten zu ersetzen, wodurch wir das gew√ºnschte Ergebnis erzielen konnten. <br><br>  Das Ergebnis war die Funktion PrintCursorPosition (), die in zwei Zellen rechts die Cursorposition zum Zeitpunkt der Ausf√ºhrung der Funktion aufzeichnete.  Es war notwendig, PrintCursorPosition () in den Bereich f√ºr die Eingabe von Formeln einzugeben, den Cursor zu bewegen und die Eingabetaste auf der Tastatur zu dr√ºcken. <br><br>  Um die Maus zu bewegen, habe ich SetCursorPos aus derselben user32-Bibliothek verwendet.  Um diese Funktion verwenden zu k√∂nnen, musste der Wert der zuvor gespeicherten x- und y-Koordinaten als Eingabe √ºbergeben werden.  Mit SetCursorPosition (x, y) konnte ich den Cursor √ºber zuvor gespeicherte Koordinaten bewegen.  Das erste sichtbare Ergebnis.  Hurra! <br><br>  Um Mausaktionen zu simulieren, habe ich mouse_event aus derselben user32-Bibliothek verwendet.  Durch √úbergeben der Flags der Tasten an den Eingang konnte ich die Tastenanschl√§ge der entsprechenden Tasten simulieren.  Urspr√ºnglich wollte ich eine Funktion MouseButtonPrees (Flag) schreiben, wobei Flag die Bezeichnung der gedr√ºckten Taste ist. Nach der ersten Demonstration erkannte das M√§dchen jedoch, dass es besser ist, die Funktionsgruppe LeftClick (), RightClick () und DoubleClick () zu ersetzen.  Dieser Ansatz erleichtert das Lesen der resultierenden Funktion. <br><br><h3>  Tastatur </h3><br>  In VBA gibt es eine SendKeys-Anweisung, die alle erforderlichen Aktionen ausf√ºhrt.  Der Text wird unter Bezugnahme auf die Zelle leicht an die Funktion √ºbergeben und erf√ºllt problemlos.  Das Dr√ºcken von Sondertasten (Eingabetaste, Tabulatortaste, Alt, Strg, Tastaturpfeile usw.) f√ºhrte jedoch zu einer Ablehnung (um sie zu dr√ºcken, mussten sie in geschweiften Klammern {ENTER} geschrieben werden).  Daher habe ich f√ºr die am h√§ufigsten verwendeten Funktionen wie PressEnter () geschrieben.  F√ºr selten verwendete habe ich im selben Dokument einen Spickzettel erstellt. <br><br>  Informationen wurden zwischen dem System und Excel √ºbertragen, indem sie in den Puffer kopiert und aus dem Puffer eingef√ºgt wurden.  Das Kopieren in den Puffer wurde im Wesentlichen durch Simulieren des Dr√ºckens von Strg + C durchgef√ºhrt, wonach Daten aus dem Puffer in das MSForms.DataObject √ºbernommen und in eine bestimmte Zelle √ºbertragen wurden. <br><br><h3>  Test- und Leistungsprobleme </h3><br>  Die Probleme begannen sofort. <br><br>  Das Schreiben einer Skriptsequenz von Aktionen besteht darin, kleine Gruppen von Aktionen zu erarbeiten und zu einer zu kombinieren.  Beim Wechsel zu einer freien Zelle wurde jedoch sofort die gesamte Sequenz ausgearbeitet, was √§u√üerst √§rgerlich war, insbesondere wenn die Zeit, die die Gruppe von Aktionen ben√∂tigte, mehr als 10 Sekunden dauerte.  Um dieses Problem zu l√∂sen, habe ich √ºberpr√ºft, ob im Funktionstext der aktiven Zelle der Funktionsname vorhanden ist.  Es hat geholfen. <br><br>  W√§hrend des Tests f√ºgte er au√üerdem die Wartefunktionen WaitS (Sekunden) und WaitMS (Millisekunden) hinzu, um zu verfolgen, was funktionierte und was nicht.  Es basiert auf Sleep aus der Kernel32-Bibliothek.  Der Unterschied zwischen WaitS und WaitMS besteht darin, dass in WaitMS die Zeit in Millisekunden und in WaitS in Sekunden angegeben wird. <br><br>  Ein weiteres Problem war die inkonsistente Ausf√ºhrung von Funktionen beim Ziehen in Zellen.  Dies lag an der asynchronen Berechnung von Excel.  Er verteilte die Berechnung jeder Zelle an verschiedene Prozessoren.  Infolgedessen wird die Sequenz zuerst in Zelle zwei, dann in der f√ºnften, dann in der dritten usw. ausgef√ºhrt.  Dar√ºber hinaus wurden die Sequenzen selbst von Anfang bis Ende ohne Probleme durchgef√ºhrt.  Um dieses Verhalten zu beseitigen, habe ich Multithread-Berechnungen in den Excel-Einstellungen (Excel-Einstellungen -&gt; Erweitert -&gt; Formeln) deaktiviert. <br><br><h3>  Ergebnisse </h3><br>  Nachdem er erkl√§rt hatte, wie man mit all dem umgeht und wie man es benutzt, lie√ü er seine Freundin los, um die Prozesse im Unternehmen auf solch undankbare Weise zu automatisieren. <br><br>  Dank dieser Automatisierung konnte die Zeit von drei Stunden auf 30 Minuten verk√ºrzt werden.  Gleichzeitig erm√∂glichte die Automatisierung eine geringf√ºgige √Ñnderung des Ansatzes zum Hoch- und Herunterladen von Daten.  Jetzt erfolgt das Entladen w√§hrend der Zeit, in der meine Freundin zum Mittagessen abreist und nachts l√§dt.  Wir k√∂nnen also sagen, dass die Last um fast die H√§lfte des Arbeitstages abgenommen hat, wodurch meine Freundin p√ºnktlich nach Hause zur√ºckkehren konnte und wir interessantere Dinge als die Automatisierung tun k√∂nnen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de447346/">https://habr.com/ru/post/de447346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de447334/index.html">Ein Beispiel f√ºr eine Inhaltsstrategie zur F√∂rderung eines Online-Waffenfachgesch√§fts</a></li>
<li><a href="../de447336/index.html">√úberwachung der Kubernetes-Clusterressourcen</a></li>
<li><a href="../de447338/index.html">Intel 0x7E3 Sommerpraktikum wartet auf Studenten</a></li>
<li><a href="../de447342/index.html">Nicht-Mars-Pyramiden: Untersuchung der Form nanokristalliner Cluster unter einer Graphenschicht</a></li>
<li><a href="../de447344/index.html">Neue Funktionen in Webmaster</a></li>
<li><a href="../de447348/index.html">Eine Studie zur Konnektivit√§t von Weltw√§hrungen durch die Korrelation absoluter Kurse</a></li>
<li><a href="../de447350/index.html">Robot Operating System Meetup Russisch 2019</a></li>
<li><a href="../de447352/index.html">Parsing: Was sind redundante Ausdr√ºcke in Englisch?</a></li>
<li><a href="../de447354/index.html">Eine universelle Methode zur L√∂sung von Problemen am Beispiel des Puzzles "12 M√ºnzen, 3 W√§gungen"</a></li>
<li><a href="../de447356/index.html">Themen Top 3D Expo: 3D-Druck in Auto-Tuning, Artem Solomnikov, Impressum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>