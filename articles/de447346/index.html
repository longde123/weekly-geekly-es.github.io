<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏽 🧑🏽‍🤝‍🧑🏼 🍇 Automatisierung von Geschäftsprozessen in Excel oder wie man ein Mädchen vor der Verarbeitung bewahrt 🤛🏿 🤸🏿 🧑🏿‍🤝‍🧑🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Meine Freundin kauft im Vertriebsnetz ein. In jüngster Zeit wurde das Unternehmen stark reduziert, sodass der Arbeitsaufwand pro Mitarbeiter dramatisc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung von Geschäftsprozessen in Excel oder wie man ein Mädchen vor der Verarbeitung bewahrt</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447346/">  Meine Freundin kauft im Vertriebsnetz ein.  In jüngster Zeit wurde das Unternehmen stark reduziert, sodass der Arbeitsaufwand pro Mitarbeiter dramatisch gestiegen ist.  Deshalb musste sie regelmäßig bei der Arbeit bleiben, manchmal sogar samstags ausgehen.  Ihre Kollegen hatten das gleiche Problem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/725/1cf/243/7251cf24339c88fbb1448a17850bb254.jpg" alt="Bild"><br><br>  Über die Entscheidung, die es meiner Freundin ermöglichte, pünktlich nach Hause zurückzukehren, können Sie unter dem Schnitt lesen. <br><a name="habracut"></a><br>  Darüber hinaus kann ein wesentlicher Teil ihrer Arbeit automatisiert werden: Empfangen von Daten von vorne, Ausfüllen von Excel-Dokumenten, Aktualisieren von Daten von vorne usw. <br><br>  In dieser Situation ist es am vernünftigsten, eine Arbeitserklärung zur Entwicklung der erforderlichen Funktionalität zu verfassen und diese über die Behörden an die Entwickler weiterzugeben.  Die Reduzierung betraf jedoch alle, einschließlich der Entwickler.  Infolgedessen verfügten sie nicht über genügend Ressourcen, um diese Automatisierung zu implementieren.  Und das Unternehmen hatte in absehbarer Zeit nicht vor, spezialisierte RPA-Systeme zu kaufen. <br><br>  Darüber hinaus wurde verstärkt überwacht, was Mitarbeiter bei der Arbeit tun und in welchen Anwendungen sie arbeiten. <br><br>  Aufgrund all dieser widrigen Umstände und meines verzweifelten Wunsches zu helfen, entschied ich mich, Funktionen für Excel in VBA zu schreiben, dank derer es möglich wäre, die Routineoperationen meiner Freundin und ihrer Kollegen zu automatisieren. <br><br><h3>  Produktanforderungen </h3><br>  Als Ausgangspunkt wählte ich die Aufgabe, für die das Mädchen die meiste Zeit nach ihren Gefühlen verbrachte.  Im Rahmen dieser Aufgabe brauchte das Mädchen: <br><br><ul><li>  Übertragen Sie die Artikelnummer aus der Excel-Datei in die Suchleiste des Front-Office-Systems. </li><li>  Für diesen Artikel erhalten Sie aus den Suchergebnissen den Kauf- und Verkaufspreis sowie eine Reihe zusätzlicher Werte. </li><li>  Verarbeiten Sie die gesammelten Daten in Excel, um den endgültigen Produktpreis zu erstellen. </li><li>  Laden Sie die Preise zurück in das System. </li><li>  Das Entladen und anschließende Laden der Daten pro Tag dauerte ca. 3 Stunden. </li></ul><br>  Da meine Freundin keine Programmierkenntnisse hatte, war es notwendig, ein Tool mit einer einfachen und vertrauten Oberfläche in Form von Funktionen in Excel zu erstellen.  Aktionssequenzen sollten einfach als eine Sequenz von Funktionen definiert werden.  Mit einem Wort, <b>KISS</b> . <br><br>  Basierend auf diesem Fall habe ich die folgenden funktionalen Anforderungen gebildet: <br><br><ul><li>  Steuern Sie die Maus (bewegen, Tastendruck), um die entsprechenden Elemente auf dem Bildschirm hervorzuheben. </li><li>  Simulieren Sie einen Tastendruck auf der Tastatur, um Daten einzugeben. </li><li>  Übertragen Sie Daten von Excel an Anwendungen von Drittanbietern. </li><li>  Abrufen von Daten aus einer Anwendung in Excel; </li><li>  Ausführen derselben Vorgänge beim Abrufen einer Formel in Excel. </li></ul><br><h3>  Die Maus und die ersten Schwierigkeiten </h3><br>  Bevor Sie den Cursor irgendwohin bewegen, müssen Sie genau wissen, wohin Sie ihn bewegen müssen.  In dieser Situation erscheint es mir am besten, sich einfach an die Position des Cursors zu erinnern, wenn er sich über einem bestimmten Element befindet.  Um mich an die Koordinaten zu erinnern, habe ich die Funktion GetCursorPos aus der user32-Bibliothek verwendet. <br><br>  Nun, wir haben die Koordinaten, jetzt wäre es schön, sich an sie zu erinnern.  Nun, es gibt nichts Kompliziertes, dachte ich, zähle einfach ein oder zwei Zellen aus der aktiven Zelle und schreibe die Koordinaten X und Y auf. ActiveCell.Offset (0, 1) .Value = x hat jedoch nicht funktioniert.  Der Wert hat sich nicht geändert.  Und als Ergebnis der Ausführung ein Fehler.  Nach Überprüfung verschiedener Annahmen stellte sich heraus, dass das Ändern des Werts auf dem Blatt zu einer Nachzählung des gesamten Blattes und damit der Formel führt, die diese Nachzählung verursacht.  Um diese Einschränkung zu umgehen, war es anstelle eines direkten Aufrufs einer Funktion bestimmter Aktionen erforderlich, diese Aufrufe durch Auswerten zu ersetzen, wodurch wir das gewünschte Ergebnis erzielen konnten. <br><br>  Das Ergebnis war die Funktion PrintCursorPosition (), die in zwei Zellen rechts die Cursorposition zum Zeitpunkt der Ausführung der Funktion aufzeichnete.  Es war notwendig, PrintCursorPosition () in den Bereich für die Eingabe von Formeln einzugeben, den Cursor zu bewegen und die Eingabetaste auf der Tastatur zu drücken. <br><br>  Um die Maus zu bewegen, habe ich SetCursorPos aus derselben user32-Bibliothek verwendet.  Um diese Funktion verwenden zu können, musste der Wert der zuvor gespeicherten x- und y-Koordinaten als Eingabe übergeben werden.  Mit SetCursorPosition (x, y) konnte ich den Cursor über zuvor gespeicherte Koordinaten bewegen.  Das erste sichtbare Ergebnis.  Hurra! <br><br>  Um Mausaktionen zu simulieren, habe ich mouse_event aus derselben user32-Bibliothek verwendet.  Durch Übergeben der Flags der Tasten an den Eingang konnte ich die Tastenanschläge der entsprechenden Tasten simulieren.  Ursprünglich wollte ich eine Funktion MouseButtonPrees (Flag) schreiben, wobei Flag die Bezeichnung der gedrückten Taste ist. Nach der ersten Demonstration erkannte das Mädchen jedoch, dass es besser ist, die Funktionsgruppe LeftClick (), RightClick () und DoubleClick () zu ersetzen.  Dieser Ansatz erleichtert das Lesen der resultierenden Funktion. <br><br><h3>  Tastatur </h3><br>  In VBA gibt es eine SendKeys-Anweisung, die alle erforderlichen Aktionen ausführt.  Der Text wird unter Bezugnahme auf die Zelle leicht an die Funktion übergeben und erfüllt problemlos.  Das Drücken von Sondertasten (Eingabetaste, Tabulatortaste, Alt, Strg, Tastaturpfeile usw.) führte jedoch zu einer Ablehnung (um sie zu drücken, mussten sie in geschweiften Klammern {ENTER} geschrieben werden).  Daher habe ich für die am häufigsten verwendeten Funktionen wie PressEnter () geschrieben.  Für selten verwendete habe ich im selben Dokument einen Spickzettel erstellt. <br><br>  Informationen wurden zwischen dem System und Excel übertragen, indem sie in den Puffer kopiert und aus dem Puffer eingefügt wurden.  Das Kopieren in den Puffer wurde im Wesentlichen durch Simulieren des Drückens von Strg + C durchgeführt, wonach Daten aus dem Puffer in das MSForms.DataObject übernommen und in eine bestimmte Zelle übertragen wurden. <br><br><h3>  Test- und Leistungsprobleme </h3><br>  Die Probleme begannen sofort. <br><br>  Das Schreiben einer Skriptsequenz von Aktionen besteht darin, kleine Gruppen von Aktionen zu erarbeiten und zu einer zu kombinieren.  Beim Wechsel zu einer freien Zelle wurde jedoch sofort die gesamte Sequenz ausgearbeitet, was äußerst ärgerlich war, insbesondere wenn die Zeit, die die Gruppe von Aktionen benötigte, mehr als 10 Sekunden dauerte.  Um dieses Problem zu lösen, habe ich überprüft, ob im Funktionstext der aktiven Zelle der Funktionsname vorhanden ist.  Es hat geholfen. <br><br>  Während des Tests fügte er außerdem die Wartefunktionen WaitS (Sekunden) und WaitMS (Millisekunden) hinzu, um zu verfolgen, was funktionierte und was nicht.  Es basiert auf Sleep aus der Kernel32-Bibliothek.  Der Unterschied zwischen WaitS und WaitMS besteht darin, dass in WaitMS die Zeit in Millisekunden und in WaitS in Sekunden angegeben wird. <br><br>  Ein weiteres Problem war die inkonsistente Ausführung von Funktionen beim Ziehen in Zellen.  Dies lag an der asynchronen Berechnung von Excel.  Er verteilte die Berechnung jeder Zelle an verschiedene Prozessoren.  Infolgedessen wird die Sequenz zuerst in Zelle zwei, dann in der fünften, dann in der dritten usw. ausgeführt.  Darüber hinaus wurden die Sequenzen selbst von Anfang bis Ende ohne Probleme durchgeführt.  Um dieses Verhalten zu beseitigen, habe ich Multithread-Berechnungen in den Excel-Einstellungen (Excel-Einstellungen -&gt; Erweitert -&gt; Formeln) deaktiviert. <br><br><h3>  Ergebnisse </h3><br>  Nachdem er erklärt hatte, wie man mit all dem umgeht und wie man es benutzt, ließ er seine Freundin los, um die Prozesse im Unternehmen auf solch undankbare Weise zu automatisieren. <br><br>  Dank dieser Automatisierung konnte die Zeit von drei Stunden auf 30 Minuten verkürzt werden.  Gleichzeitig ermöglichte die Automatisierung eine geringfügige Änderung des Ansatzes zum Hoch- und Herunterladen von Daten.  Jetzt erfolgt das Entladen während der Zeit, in der meine Freundin zum Mittagessen abreist und nachts lädt.  Wir können also sagen, dass die Last um fast die Hälfte des Arbeitstages abgenommen hat, wodurch meine Freundin pünktlich nach Hause zurückkehren konnte und wir interessantere Dinge als die Automatisierung tun können. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de447346/">https://habr.com/ru/post/de447346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de447334/index.html">Ein Beispiel für eine Inhaltsstrategie zur Förderung eines Online-Waffenfachgeschäfts</a></li>
<li><a href="../de447336/index.html">Überwachung der Kubernetes-Clusterressourcen</a></li>
<li><a href="../de447338/index.html">Intel 0x7E3 Sommerpraktikum wartet auf Studenten</a></li>
<li><a href="../de447342/index.html">Nicht-Mars-Pyramiden: Untersuchung der Form nanokristalliner Cluster unter einer Graphenschicht</a></li>
<li><a href="../de447344/index.html">Neue Funktionen in Webmaster</a></li>
<li><a href="../de447348/index.html">Eine Studie zur Konnektivität von Weltwährungen durch die Korrelation absoluter Kurse</a></li>
<li><a href="../de447350/index.html">Robot Operating System Meetup Russisch 2019</a></li>
<li><a href="../de447352/index.html">Parsing: Was sind redundante Ausdrücke in Englisch?</a></li>
<li><a href="../de447354/index.html">Eine universelle Methode zur Lösung von Problemen am Beispiel des Puzzles "12 Münzen, 3 Wägungen"</a></li>
<li><a href="../de447356/index.html">Themen Top 3D Expo: 3D-Druck in Auto-Tuning, Artem Solomnikov, Impressum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>