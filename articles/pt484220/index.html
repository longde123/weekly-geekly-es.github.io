<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèáüèæ ‚úñÔ∏è ‚õµÔ∏è Voc√™ j√° encomendou a entrega? Como a Crossroads entrega 6.000 pedidos por dia üíáüèΩ üé∏ üèß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As pessoas adoram entrega. Por uma pequena taxa, voc√™ compra a oportunidade de obter os bens necess√°rios sem sair de casa: comida do seu restaurante f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Voc√™ j√° encomendou a entrega? Como a Crossroads entrega 6.000 pedidos por dia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/X5RetailGroup/blog/484220/">  As pessoas adoram entrega.  Por uma pequena taxa, voc√™ compra a oportunidade de obter os bens necess√°rios sem sair de casa: comida do seu restaurante favorito, m√≥veis grandes, um livro que voc√™ queria ler por um longo tempo e, de fato, qualquer coisa.  E o aumento no n√∫mero de servi√ßos para entrega r√°pida de tudo no mundo apenas confirma esta tese.  Sim, e para as lojas √© uma vantagem - ele fez uma parceria com qualquer entrega de mercadorias at√© a porta e aumentou seu cheque. <br><br>  N√≥s da ‚ÄúCrossroads‚Äù temos nossa pr√≥pria entrega.  Para uma pessoa de fora, o processo de entrega da loja para a casa √© mais ou menos assim: <br><br><ol><li>  Eu escolhi algo no site e coloquei na cesta. </li><li>  Digitei o endere√ßo e paguei o pedido. </li><li>  A loja rapidamente deu o pedido ao correio. </li><li>  O correio entregou o pedido. </li></ol><br>  De fato, tudo √© um pouco mais complicado.  Meu nome √© Vitaliy, sou o chefe do departamento de desenvolvimento e hoje vou lhe contar como tudo funciona para n√≥s.  E sobre o que. <br><br><img src="https://habrastorage.org/webt/vo/rn/u7/vornu7hu0kjkmk1jwluuqb1usj4.jpeg"><br><a name="habracut"></a><br>  Duas aplica√ß√µes s√£o respons√°veis ‚Äã‚Äãpela estabilidade do processo - uma vitrine e uma aplica√ß√£o m√≥vel do usu√°rio.  Tudo √© cl√°ssico com a vitrine - o comprador visita o site, passa algum tempo escolhendo produtos e enchendo a cesta, examinando os cart√µes de produtos.  A etapa final aqui √© fazer um pedido.  Depois disso, o pedido √© transferido para processamento posterior no back office. <br><br>  Em geral, o back office de uma loja on-line √© um sistema no qual muitas a√ß√µes s√£o realizadas em mercadorias: prescrevemos a participa√ß√£o de mercadorias em determinadas promo√ß√µes, vinculamos faixas a isso, destacamos zonas de marca e muito mais.  Obviamente, os pedidos s√£o processados ‚Äã‚Äãaqui.  Quando o comprador conclui o processo de pedido e o pedido chega na retaguarda, ele deve ser confirmado.  Isso acontece automaticamente se j√° conhecemos esse comprador ou pelo operador no modo manual, de acordo com o esquema usual ‚ÄúOl√°, voc√™ pediu alguma coisa aqui, confirme, os dados est√£o corretos?‚Äù E assim por diante.  E aqui a participa√ß√£o do back office no processo de forma√ß√£o da entrega j√° est√° terminando, o pedido √© confirmado, o status √© alterado de "Processado" para "Em andamento".  Um pedido no WMS (onde s√£o reservados, coletados, encomendados produtos que n√£o est√£o dispon√≠veis e que s√£o feitos sob encomenda do fornecedor) e, ao mesmo tempo, pode come√ßar a ser roteado pelos log√≠sticos.  Em geral, WMS e log√≠stica s√£o sistemas independentes que trabalham com pedidos em paralelo. <br><br><h3>  Enquanto isso, em estoque </h3><br>  O sistema WMS √© uma combina√ß√£o de nosso software, armaz√©ns, funcion√°rios desses armaz√©ns e dispositivos, o que simplifica significativamente a vida desses funcion√°rios.  Um pequeno terminal, montado no pulso de um funcion√°rio, permite montar rapidamente um pedido na sequ√™ncia desejada. <br><br><img src="https://habrastorage.org/webt/fb/bj/sj/fbbjsjtm6z0gt3l5zx4yi6zcjz4.jpeg"><br><br>  A consist√™ncia √© importante porque entregamos pedidos aos nossos clientes em caixas especiais da Crossroads.  E com uma caixa uma coisa - √© retangular.  Como a maioria das caixas. <br><br>  Portanto, √© necess√°rio observar duas condi√ß√µes ao mesmo tempo - e encher a caixa o m√°ximo poss√≠vel, para que o cliente n√£o receba duas caixas apenas pela metade (√© antiecon√¥mica, ecol√≥gica e geralmente estranha) e encha a caixa de acordo com o princ√≠pio ‚Äúdo pesado ao leve‚Äù "  O sistema leva em considera√ß√£o o tamanho do produto e sua embalagem.  Conhecendo este e os par√¢metros da caixa, √© poss√≠vel formar pedidos para que a caixa seja preenchida ao m√°ximo.  Isso tamb√©m permite que voc√™ se livre de situa√ß√µes em que o carro do correio parece ter deixado para substituir todos os 100% carregados com caixas, mas meio vazios. <br><br>  E o sistema grava para o trabalhador do armaz√©m em que ordem coletar o pedido.  Poucas pessoas querem uma caixa em que um funcion√°rio de um armaz√©m am√°vel coloque tr√™s d√∫zias de ovos no fundo, colocando cuidadosamente em cima de 10 pacotes de leite e alguns quilos de vegetais, por exemplo.  Com leite, com certeza, tudo ficar√° bem, o que n√£o se pode dizer sobre os ovos.  Todos os tipos de cookies fr√°geis tamb√©m est√£o sempre no topo. <br><br><img src="https://habrastorage.org/webt/nq/hd/ml/nqhdmlyl2ybszay3eo2jocrd7sg.jpeg"><br><br>  Al√©m disso, voc√™ deve seguir as regras da vizinhan√ßa de mercadorias.  Digamos que ser√° um pouco triste para voc√™, se voc√™ pediu duas variedades de ma√ß√£s, p√£ezinhos e peixe, e todo esse material fede n√£o com peixe, mas com detergente em geral, porque tudo chegou em uma caixa.  Portanto, alimentos - separadamente, produtos qu√≠micos dom√©sticos - separadamente.  A vizinhan√ßa de mercadorias √© determinada pelos padr√µes SanPiN, a prop√≥sito.  E n√≥s os observamos.  Do ponto de vista humano, esse √© um modelo l√≥gico e verdadeiro.  Do ponto de vista do armaz√©m, essas s√£o vari√°veis ‚Äã‚Äãadicionais ao construir a rota do trabalhador do armaz√©m. <br><br>  O sistema leva tudo em considera√ß√£o e constr√≥i uma rota, gra√ßas √† qual o funcion√°rio coleta a ordem na sequ√™ncia desejada - o terminal o leva √†s prateleiras corretas.  Se voc√™ exagerar, parece que o trabalho da parte do cliente do aplicativo √© o seguinte: ‚ÄúCara, v√° para B4, leve 5 pacotes de farinha com eles, coloque-os no fundo da caixa.  Depois da A2, pegue o leite.  N√£o, n√£o este, est√° nessa cela. <br><br><img src="https://habrastorage.org/webt/r7/tr/ve/r7trvey_hhcwxgzqtcnq9p4fsag.jpeg"><br><br>  Depois que eles fizeram um pedido para os funcion√°rios do armaz√©m, foi necess√°rio fazer um pedido para os correios.  Isso ajuda n√£o apenas a criar rotas, mas tamb√©m no processo de imprimir cheques rapidamente e observar novos status dos pedidos.  Bem, m√©tricas, onde n√£o existem m√©tricas - vemos onde um mensageiro espec√≠fico est√° localizado, ele normalmente se encaixa no cronograma ou n√£o, ele imprimiu um cheque ao transferir o pedido ao comprador ou n√£o, e assim por diante. <br><br><img src="https://habrastorage.org/webt/gc/ni/r9/gcnir9cqhhgmsyhsclvpqy-ylkw.png"><br><br>  A prop√≥sito, por que n√£o imprimimos cheques de uma s√≥ vez: quando levamos nossas caixas para o cliente, ele pode recusar qualquer produto por qualquer motivo.  Por exemplo, ele conseguiu sair para comprar sorvete para si mesmo, ou imediatamente ferveu dois litros de leite e decidiu que peixe e pepino em conserva para hoje √† noite era apenas uma id√©ia.  Em geral, pode haver muitas raz√µes para rejeitar qualquer posi√ß√£o, incluindo uma "mudan√ßa de opini√£o".  Portanto, o correio exclui as posi√ß√µes que o cliente recusou e imprime o cheque final. <br><br><h3>  Sob o cap√¥ </h3><br>  N√≥s escrevemos nossos aplicativos no Swift e Kotlin (iOS e Android, respectivamente).  Nesse caso, todo o back-end est√° girando em PHP, decidimos fazer o banco de dados no Postgres, para o broker que temos o Rabbit mq. <br><br>  Sim, √© claro que em 2019 todo mundo faz tudo com base no princ√≠pio do celular primeiro, mas, de alguma forma, o site √© mais pr√≥ximo e mais caro.  Ele trabalha na Lavarel.  Na dire√ß√£o dos microsservi√ßos, tamb√©m estamos apenas come√ßando a nos mover; portanto, agora o site e o aplicativo s√£o um mon√≥lito t√£o robusto que fica parado e espera que ele j√° seja retirado para os microsservi√ßos. <br><br>  O Postgres mencionado, a prop√≥sito, mostra-se como um gargalo de tempos em tempos, ent√£o vamos mudar alguma coisa.  Utilizamos ativamente balanceadores, porque a carga nos sistemas pode assumir valores muito diferentes. <br><br>  Todo esse material est√° convenientemente localizado nos servidores neste formato: <br>  16 servidores de aplicativos com PHP-FPM e Postgres, o Postgres possui 1 mestre e 4 escravos.  Como voc√™ pode ver, n√£o h√° bicicletas.  Todo o back office √© completamente integrado aos sistemas internos - WMS, armaz√©m, log√≠stica, contabilidade e marketing. <br><br>  Lan√ßamos o aplicativo e o site para celular em 2017.  Hoje, a carga m√©dia no sistema √© de cerca de 6.000 pedidos por dia.  Por um lado, n√£o √© muito, por outro lado, ainda vale a pena considerar que isso n√£o √© distribu√≠do uniformemente por 24 horas, as pessoas n√£o pedem comida o tempo todo, h√° tamb√©m uma liga para a atividade padr√£o durante o hor√°rio de trabalho.  As pr√≥prias consultas PHP (incluindo a API) s√£o de cerca de 70.000 em 5 minutos. <br><br><h3>  Caminho do pedido </h3><br>  Assim que o pedido √© montado com sucesso no armaz√©m e pronto para a viagem, ele √© roteado.  Agora, come√ßamos a usar o Yandex.Rotando para isso - um bom produto que nos permite construir rapidamente a rota ideal para os motoristas, levando em considera√ß√£o as situa√ß√µes de tr√¢nsito - engarrafamentos, clima, pisos, barreiras e outras alegrias.  Isso nos ajuda a economizar combust√≠vel, para que os correios n√£o fa√ßam c√≠rculos pela cidade.  O motorista tem uma rota clara, uma lista da ordem na qual as ordens devem ser transportadas, as pr√≥prias encomendas s√£o colocadas no carro de forma a serem entregues na mesma ordem. <br><br><img src="https://habrastorage.org/webt/ad/lw/-n/adlw-nhq5gqszohajkwaymwqnsm.jpeg"><br><br>  Fizemos o pedido de correios para Android, como eu j√° escrevi, no Kotlin.  √â nele que o roteamento √© costurado, a capacidade de se comunicar com o cliente (ocultamos o n√∫mero do cliente, o motorista tem apenas o bot√£o "Ligar"), a capacidade de editar o pedido e remover algo, imprimir o cheque e tamb√©m pagar pelo pedido. <br><br><img src="https://habrastorage.org/webt/xt/1f/aq/xt1faql6nzdxupzg_vz4pjmtvj8.png"><br><br>  Separadamente, sobre telemetria: o aplicativo considera tudo: o tempo de viagem, a hora de chegada ao cliente e a hora da partida, isso ajuda muito a criar muitos relat√≥rios anal√≠ticos e rastrear a log√≠stica.  Por exemplo, o correio n√£o se move h√° algum tempo, mas em geral ele deveria - eles entram em contato com ele e especificam se est√° tudo bem.  A conex√£o com a log√≠stica a esse respeito √© muito importante, porque h√° situa√ß√µes em que o correio, por exemplo, √†s 15h00 deve estar em um endere√ßo e √†s 15h30 - em outro.  Mas, no primeiro endere√ßo, houve um problema devido ao controle de acesso no quintal, uma barreira ou port√£o, tive que gastar mais 10 minutos para entrar em contato com o cliente, para que o cliente contatasse a seguran√ßa e assim por diante, voc√™ sabe como isso acontece. <br><br><img src="https://habrastorage.org/webt/cb/jr/pv/cbjrpvltj1-mgahk1ww7dvvtevw.jpeg"><br><br>  Mas, do ponto de vista do cliente, √†s 15h30, isso nunca √© problema dele, ele est√° aguardando o pedido no hor√°rio indicado.  Portanto, o motorista contata os log√≠sticos, eles monitoram de perto especificamente sua telemetria e eles mesmos entram em contato com o pr√≥ximo cliente, especificando o intervalo de tempo para entrega devido a um problema na barreira.  √â claro que, em qualquer caso, √© triste quando o correio chega atrasado.  Mas quando ele est√° atrasado e n√£o avisa sobre isso - √© ainda pior. <br><br>  Em geral, se √© b√°sico, √© assim que trabalhamos.  Voc√™ pode estar mais interessado em aprender sobre a opera√ß√£o do armaz√©m e do WMS, ou sobre aplicativos para os trabalhadores do motorista ou do armaz√©m, ou sobre o roteamento; em seguida, basta escrever sobre isso nos coment√°rios e farei uma postagem separada. <br><br>  Obrigado pela leitura. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484220/">https://habr.com/ru/post/pt484220/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484208/index.html">Usando o aprendizado de m√°quina na an√°lise est√°tica do c√≥digo-fonte do programa</a></li>
<li><a href="../pt484212/index.html">Material gratuito para karma - a hist√≥ria de uma startup bielorrussa que muda o princ√≠pio do consumo</a></li>
<li><a href="../pt484214/index.html">Tensores em TensorFlow</a></li>
<li><a href="../pt484216/index.html">Segunda confer√™ncia Zabbix na R√∫ssia: inscri√ß√µes e datas importantes</a></li>
<li><a href="../pt484218/index.html">Otimizamos a automa√ß√£o: como aceleramos os autotestes em 3 a 4 vezes, preservando os desenvolvimentos antigos</a></li>
<li><a href="../pt484222/index.html">Uma tentativa de resolver o problema de escolher bilhetes antes das f√©rias</a></li>
<li><a href="../pt484224/index.html">Classifica√ß√£o LSD bit a bit (classifica√ß√£o Radix)</a></li>
<li><a href="../pt484236/index.html">Fantasmas nas nuvens: detalhes de invadir muitas empresas</a></li>
<li><a href="../pt484238/index.html">O aprendizado de m√°quina enfrentou um problema de matem√°tica n√£o resolvido</a></li>
<li><a href="../pt484240/index.html">Torne-se um palestrante no Positive Hack Days 10. Come√ßa a chamada de trabalhos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>