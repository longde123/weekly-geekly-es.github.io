<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèª üìú üëßüèª Wie wir die AR-Anwendung zur √úberpr√ºfung historischer Orte entwickelt haben üêä üå∫ üëÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor kurzem haben wir alte Technologien mit modernen Technologien kombiniert, was dabei herauskam. 

 Augmented Reality 
 Augmented Reality-Apps als St...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie wir die AR-Anwendung zur √úberpr√ºfung historischer Orte entwickelt haben</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lodoss/blog/421067/"><img src="https://habrastorage.org/webt/iy/gx/ir/iygxirzoaz4v6phrwhfplokazzu.jpeg"><br><br>  Vor kurzem haben wir alte Technologien mit modernen Technologien kombiniert, was dabei herauskam. <br><a name="habracut"></a><br><h2>  Augmented Reality </h2><br>  Augmented Reality-Apps als Stadtf√ºhrer sind ein bekanntes Thema und werden von vielen Entwicklern implementiert.  Diese Richtung der Verwendung von AR war eine der ersten, da Sie alle offensichtlichen M√∂glichkeiten der Augmented Reality nutzen k√∂nnen: Zeigen Sie den Benutzern Informationen √ºber Geb√§ude, geben Sie Informationen √ºber die Arbeit der Institution und machen Sie sich mit den Sehensw√ºrdigkeiten vertraut.  Beim letzten Hackathon, der innerhalb des Unternehmens stattfand, wurden mehrere Projekte mit Augmented Reality vorgestellt, und wir kamen auf die Idee, eine AR-Anwendung zu erstellen, die zeigt, wie ein Wahrzeichen oder ein historischer Ort in der Vergangenheit aussah.  Kombinieren Sie dazu moderne Augmented Reality-Technologien mit alten Fotografien.  Mit Blick auf die Isaakskathedrale k√∂nnen Sie beispielsweise eine Smartphone-Kamera auf ihn richten und sein erstes Holzgeb√§ude sehen, das 1715 abgerissen wurde. <br><br>  Die Arbeitsmechanismen sind wie folgt: Die Anwendung zeigt die angegebenen historischen Orte und Sehensw√ºrdigkeiten der Stadt auf der Karte an, zeigt kurze Informationen dar√ºber an und benachrichtigt den Benutzer mithilfe von Benachrichtigungen, dass er nicht weit von einem interessanten Punkt entfernt ist.  Wenn sich eine Person einem historischen Denkmal in einer Entfernung von 40 Metern n√§hert, wird der AR-Modus verf√ºgbar.  Gleichzeitig √∂ffnet sich die Kamera und kurze Informationen zu den Objekten werden direkt in der Umgebung des Benutzers angezeigt.  Letzterer kann mit virtuellen Objekten interagieren: Durch Ber√ºhren der Karte eines historischen Ortes k√∂nnen Sie das Album mit Bildern anzeigen. <br><br>  Es scheint, dass die Anwendung sehr einfach ist, aber selbst hier gab es einige Fallstricke.  Ich werde Sie nicht mit einer Geschichte √ºber die Implementierung trivialer Dinge wie das Herunterladen von Daten von einem Server oder das Anzeigen von Punkten auf einer Karte langweilen. Ich werde direkt zu den Funktionen gehen, die die Probleme verursacht haben. <br><br><h2>  Problem 1. Gleitkommazahlen </h2><br>  Das erste, was zu tun war, war, Markierungspunkte im Raum entsprechend der tats√§chlichen Position historischer Orte relativ zum aktuellen Standort und der Blickrichtung des Benutzers zu platzieren. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zun√§chst haben</a> wir uns f√ºr die bereits vorbereitete Bibliothek f√ºr iOS entschieden: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ARKit-CoreLocation</a> .  Das Projekt liegt auf GitHub im √∂ffentlichen Bereich, enth√§lt neben dem Code der Hauptklassen Integrationsbeispiele und erm√∂glicht es uns, die interessierte Aufgabe in ein paar Stunden zu erledigen.  Die Bibliothek muss nur die Koordinaten der Punkte und das als Marker verwendete Bild eingeben. <br><br>  Es √ºberrascht nicht, dass diese Leichtigkeit bezahlt werden musste.  Markierungspunkte schwebten st√§ndig im Raum: Sie kletterten entweder an die Decke oder wurden irgendwo unter den F√º√üen gezeichnet.  Nicht jeder Benutzer w√ºrde zustimmen, das AR-Objekt einige Minuten lang scharf zu stellen, um sich mit den Informationen vertraut zu machen, die ihn interessieren. <br><br>  Wie sich herausstellte, waren viele mit diesem Bibliotheksfehler konfrontiert, aber eine L√∂sung wurde noch nicht gefunden.  Der Code auf GitHub wurde leider seit mehr als sechs Monaten nicht mehr aktualisiert, daher musste ich ihn umgehen. <br><br>  Wir haben versucht, die H√∂he anstelle der festen H√∂he in Koordinaten zu verwenden, die der LocationManager f√ºr die aktuelle Position des Benutzers zur√ºckgegeben hat.  Dies beseitigte das Problem jedoch nicht vollst√§ndig.  Die vom Standortmanager stammenden Daten sprangen mit einer Ausbreitung von bis zu 60 Metern, sobald das Ger√§t in der Hand gedreht wurde.  Infolgedessen war das Bild instabil, was uns nat√ºrlich nicht mehr zusagte. <br><br>  Infolgedessen wurde beschlossen, die ARKit-CoreLocation-Bibliothek aufzugeben und Punkte selbst im Raum zu platzieren.  Der Artikel ARKit und CoreLocation von Christopher Web-Orenstein hat dabei sehr geholfen.  Ich musste etwas mehr Zeit aufwenden und einige mathematische Aspekte in meinem Ged√§chtnis auffrischen, aber das Ergebnis war es wert: AR-Objekte waren endlich an ihren Pl√§tzen.  Danach m√ºssen sie nur noch entlang der Y-Achse gestreut werden, damit die Beschriftungen und Punkte besser lesbar sind, und eine Entsprechung zwischen dem Abstand von der aktuellen Position zum Punkt und der Z-Koordinate des AR-Objekts hergestellt werden, sodass Informationen √ºber die n√§chsten historischen Orte im Vordergrund stehen. <br><br>  Es war notwendig, die neue SCNNode-Position im Raum zu berechnen, wobei der Schwerpunkt auf den Koordinaten lag: <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> place = PlaceNode() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> locationTransform = MatrixHelper.transformMatrix(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: matrix_identity_float4x4, originLocation: curUserLocation, location: nodeLocation, yPosition: pin.yPos, shouldScaleByDistance: <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nodeAnchor = ARAnchor(transform: locationTransform) scene.session.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(anchor: nodeAnchor) scene.scene.rootNode.addChildNode(place)</code> </pre> <br>  Die folgenden Funktionen wurden der MatrixHelper-Klasse hinzugef√ºgt: <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MatrixHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transformMatrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> matrix: simd_float4x4, originLocation: CLLocation, location: CLLocation, yPosition: Float)</span></span></span></span> -&gt; simd_float4x4 { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> distanceToPoint = <span class="hljs-type"><span class="hljs-type">Float</span></span>(location.<span class="hljs-built_in"><span class="hljs-built_in">distance</span></span>(from: originLocation)) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> distanceToNode = (<span class="hljs-number"><span class="hljs-number">10</span></span> + distanceToPoint/<span class="hljs-number"><span class="hljs-number">1000.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bearing = <span class="hljs-type"><span class="hljs-type">GLKMathDegreesToRadians</span></span>(<span class="hljs-type"><span class="hljs-type">Float</span></span>(originLocation.coordinate.direction(to: location.coordinate))) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> position = vector_float4(<span class="hljs-number"><span class="hljs-number">0.0</span></span>, yPosition, -distanceToNode, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> translationMatrix = <span class="hljs-type"><span class="hljs-type">MatrixHelper</span></span>.translationMatrix(with: matrix_identity_float4x4, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: position) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rotationMatrix = <span class="hljs-type"><span class="hljs-type">MatrixHelper</span></span>.rotateAroundY(with: matrix_identity_float4x4, <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: bearing) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> transformMatrix = simd_mul(rotationMatrix, translationMatrix) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> simd_mul(matrix, transformMatrix) } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translationMatrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with matrix: matrix_float4x4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> translation : vector_float4)</span></span></span></span> -&gt; matrix_float4x4 { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matrix = matrix matrix.columns.<span class="hljs-number"><span class="hljs-number">3</span></span> = translation <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> matrix } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rotateAroundY</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with matrix: matrix_float4x4, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params"> degrees: Float)</span></span></span></span> -&gt; matrix_float4x4 { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matrix : matrix_float4x4 = matrix matrix.columns.<span class="hljs-number"><span class="hljs-number">0</span></span>.x = cos(degrees) matrix.columns.<span class="hljs-number"><span class="hljs-number">0</span></span>.z = -sin(degrees) matrix.columns.<span class="hljs-number"><span class="hljs-number">2</span></span>.x = sin(degrees) matrix.columns.<span class="hljs-number"><span class="hljs-number">2</span></span>.z = cos(degrees) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> matrix.inverse } }</code> </pre><br>  Zur Berechnung des Azimuts wurde die Erweiterung <b>CLLocationCoordinate2D</b> hinzugef√ºgt <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CLLocationCoordinate2D</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateBearing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to coordinate: CLLocationCoordinate2D)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Double</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> a = sin(coordinate.longitude.toRadians() - longitude.toRadians()) * cos(coordinate.latitude.toRadians()) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = cos(latitude.toRadians()) * sin(coordinate.latitude.toRadians()) - sin(latitude.toRadians()) * cos(coordinate.latitude.toRadians()) * cos(coordinate.longitude.toRadians() - longitude.toRadians()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> atan2(a, b) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">direction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to coordinate: CLLocationCoordinate2D)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">CLLocationDirection</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.calculateBearing(to: coordinate).toDegrees() } }</code> </pre><br><h2>  Problem 2. √úbersch√ºssige AR-Objekte </h2><br>  Das n√§chste Problem war eine gro√üe Anzahl von AR-Objekten.  Es gibt viele historische Orte und Sehensw√ºrdigkeiten in unserer Stadt, daher W√ºrfel mit Informationen, die zusammengef√ºhrt und √ºbereinander gekrochen werden.  Es w√§re f√ºr den Benutzer sehr schwierig, einen Teil der Inschriften zu erkennen, und dies k√∂nnte einen absto√üenden Eindruck hinterlassen.  Nach der Besprechung haben wir beschlossen, die Anzahl der gleichzeitig angezeigten AR-Objekte zu begrenzen und nur Punkte in einem Radius von 500 Metern vom aktuellen Standort zu belassen. <br><br>  In einigen Bereichen war die Punktekonzentration jedoch immer noch zu hoch.  Um die Sichtbarkeit zu erh√∂hen, entschieden sie sich daher f√ºr Clustering.  Auf dem Kartenbildschirm ist diese Funktion aufgrund der in MapKit eingebetteten Logik standardm√§√üig verf√ºgbar. Im AR-Modus musste sie jedoch manuell implementiert werden. <br><br>  Das Clustering basierte auf der Entfernung von der aktuellen Position zum Ziel.  Wenn der Punkt in die Zone mit einem Radius fiel, der der halben Entfernung zwischen dem Benutzer und der vorherigen Attraktion aus der Liste entspricht, versteckte er sich einfach und war Teil des Clusters.  Als sich der Benutzer n√§herte, nahm die Entfernung ab und der Radius der Clusterzone nahm entsprechend ab, sodass die in der N√§he befindlichen Sehensw√ºrdigkeiten nicht zu Clustern verschmolzen.  Um Cluster visuell von einzelnen Punkten zu unterscheiden, haben wir beschlossen, die Markierungsfarbe zu √§ndern und die Anzahl der Objekte in AR anstelle des Ortsnamens anzuzeigen. <br><br><img src="https://habrastorage.org/webt/xp/pd/t2/xppdt23ercvm5gapt8bmsh0df3g.png" alt="Bild"><br><br>  Um die Interaktivit√§t von AR-Objekten sicherzustellen, wurde ein UITapGestureRecognizer an ARSCNView angeh√§ngt und im Handler mithilfe der hitTest-Methode √ºberpr√ºft, auf welches der SCNNode-Objekte der Benutzer geklickt hat.  Wenn sich herausstellte, dass es sich um ein Foto von nahe gelegenen Sehensw√ºrdigkeiten handelt, √∂ffnete die Anwendung das entsprechende Album im Vollbildmodus. <br><br><h2>  Problem 3. Radar </h2><br>  W√§hrend der Implementierung der Anwendung war es notwendig, die Punkte auf einem kleinen Radar anzuzeigen.  Theoretisch sollte es keine Missverst√§ndnisse geben, da wir bereits den Azimut und die Entfernung zum Punkt berechnet und es sogar geschafft haben, sie in 3D-Koordinaten umzuwandeln.  Es blieb nur, die Punkte im zweidimensionalen Raum auf dem Bildschirm zu platzieren. <br><br><img src="https://habrastorage.org/webt/xz/kk/4f/xzkk4fdfzasalo_b8bsb7x-geri.png"><br><br>  Um das Rad nicht neu zu erfinden, wandten sie sich an die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Radar-</a> Bibliothek, deren Open Source-Code auf GitHub ver√∂ffentlicht wurde.  Die lebendigen Vorschauen und flexiblen Einstellungen des Beispiels waren ermutigend, aber in Wirklichkeit wurden die Punkte relativ zum tats√§chlichen Ort im Raum verschoben.  Nachdem wir einige Zeit damit verbracht hatten, die Formeln zu korrigieren, wandten wir uns der weniger sch√∂nen, aber zuverl√§ssigeren Option zu, die im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">iPhone Augmented Reality Toolkit beschrieben ist</a> : <br><br><pre> <code class="hljs pgsql">func place(dot: Dot) { var y: CGFloat = <span class="hljs-number"><span class="hljs-number">0.0</span></span> var x: CGFloat = <span class="hljs-number"><span class="hljs-number">0.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> degree &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> { degree += <span class="hljs-number"><span class="hljs-number">360</span></span> } let bearing = dot.bearing.toRadians() let radius: CGFloat = <span class="hljs-number"><span class="hljs-number">60.0</span></span> // radius <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; bearing &lt; .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) { //the <span class="hljs-number"><span class="hljs-number">1</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius + CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius - CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; .pi / <span class="hljs-number"><span class="hljs-number">2.0</span></span> &amp;&amp; bearing &lt; .pi) { //the <span class="hljs-number"><span class="hljs-number">2</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius + CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius + CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (.pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; .pi &amp;&amp; bearing &lt; (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>)) { //the <span class="hljs-number"><span class="hljs-number">3</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius - CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius + CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>((<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) - bearing)) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing &gt; (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2.0</span></span>) &amp;&amp; bearing &lt; (<span class="hljs-number"><span class="hljs-number">2</span></span> * .pi)) { //the <span class="hljs-number"><span class="hljs-number">4</span></span> quadrant <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the radar x = radius - CGFloat(cosf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) y = radius - CGFloat(sinf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(bearing - (<span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>))) * <span class="hljs-type"><span class="hljs-type">Float</span></span>(dot.distance)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == <span class="hljs-number"><span class="hljs-number">0</span></span>) { x = radius y = radius - CGFloat(dot.distance) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) { x = radius + CGFloat(dot.distance) y = radius } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == .pi) { x = radius y = radius + CGFloat(dot.distance) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bearing == <span class="hljs-number"><span class="hljs-number">3</span></span> * .pi / <span class="hljs-number"><span class="hljs-number">2</span></span>) { x = radius - CGFloat(dot.distance) y = radius } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { x = radius y = radius - CGFloat(dot.distance) } let newPosition = CGPoint(x: x, y: y) dot.layer.position = newPosition</code> </pre><br><h2>  Backend </h2><br>  Es bleibt das Problem der Speicherung von Punkten und Fotos zu l√∂sen.  F√ºr diese Zwecke wurde beschlossen, Contentful zu verwenden, und in der aktuellen Implementierung des Projekts passte er vollst√§ndig zu uns. <br><img src="https://habrastorage.org/webt/dx/zj/pm/dxzjpmfq_zibj3w7sjmu9wjobyi.png"><br><img src="https://habrastorage.org/webt/iz/bm/4f/izbm4f3bxnrouqtwxs-rmkmdyds.png"><br>  Zum Zeitpunkt der Entwicklung der mobilen Anwendung waren alle Token an kommerziellen Projekten beteiligt und durften mehrere Stunden lang inhaltlich Folgendes bereitstellen: <br><br><ul><li>  mobiler Entwickler - praktisches Backend </li><li>  Content Manager - ein praktischer Administrationsbereich zum Ausf√ºllen von Daten </li></ul><br>  Die √§hnliche Implementierung des Backends wurde urspr√ºnglich von den Teams verwendet, die am Hackathon teilgenommen haben (wie am Anfang des Artikels erw√§hnt). Dies zeigt einmal mehr, dass Dinge wie Hackathons es Ihnen erm√∂glichen, Ihre dringenden Probleme bei Projekten zu l√∂sen, etwas neu zu erstellen und auszuprobieren brandneu. <br><br><h2>  Fazit </h2><br><br>  Es war sehr interessant, eine <nobr>AR-Anwendung</nobr> zu entwickeln. Dabei haben wir mehrere vorgefertigte Bibliotheken ausprobiert, aber wir mussten uns auch an die Mathematik erinnern und viele Dinge selbst schreiben. <br><br>  Das Projekt war auf den ersten Blick einfach und erforderte viele Arbeitsstunden, um die Algorithmen zu implementieren und zu verfeinern, obwohl wir das Standard-SDK von Apple verwendet haben. <br><br>  Wir haben die Anwendung k√ºrzlich im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AppStore ver√∂ffentlicht</a> .  So sieht es bei der Arbeit aus. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Sjyy8FJUyQI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Bisher gibt es in unserer Datenbank nur Punkte f√ºr Taganrog, jedoch kann jeder an der Erweiterung des ‚ÄûVersorgungsgebiets‚Äú teilnehmen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de421067/">https://habr.com/ru/post/de421067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de421057/index.html">So montieren Sie Wagen f√ºr Personenz√ºge</a></li>
<li><a href="../de421059/index.html">Beschleunigung von Websites mit fr√ºhen Tipps</a></li>
<li><a href="../de421061/index.html">PostgreSQL: Wie und warum schwillt WAL an</a></li>
<li><a href="../de421063/index.html">Neue B√ºcher √ºber Kinderprogrammierung bei Scratch</a></li>
<li><a href="../de421065/index.html">Wie ich AI beigebracht habe, Tetris f√ºr NES zu spielen. Teil 2: KI</a></li>
<li><a href="../de421069/index.html">Bobby Urban Rucksack: Im Schloss</a></li>
<li><a href="../de421071/index.html">Mod und Rest sind nicht gleich</a></li>
<li><a href="../de421073/index.html">Folge 1. Hackkosten</a></li>
<li><a href="../de421075/index.html">Digitales W√∂rterbuch von A bis Z.</a></li>
<li><a href="../de421077/index.html">In Kemerowo ersetzen sich die Jahreszeiten von Jahr zu Jahr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>