<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐯 🚣🏻 👩🏾‍🤝‍👨🏽 Docker lernen, Teil 3: Docker-Dateien 🍖 🤜 💞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Übersetzung des dritten Teils der Docker-Reihe werden wir uns weiterhin von Gebäck, nämlich Bagels, inspirieren lassen. Unser heutiges Hauptthe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker lernen, Teil 3: Docker-Dateien</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/439980/">  In der Übersetzung des dritten Teils der Docker-Reihe werden wir uns weiterhin von Gebäck, nämlich Bagels, inspirieren lassen.  Unser heutiges Hauptthema wird die Arbeit mit Dockerfiles sein.  Wir werden die Anweisungen analysieren, die in diesen Dateien verwendet werden. <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1: die Grundlagen</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2: Begriffe und Konzepte</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3: Dockerfile-Dateien</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 4: Verkleinern von Bildern und Beschleunigen ihrer Montage</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 5: Teams</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 6: Arbeiten mit Daten</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/29b/15a/6bf/29b15a6bfff06c617017301b30ed95c2.jpg"></div><br>  <i><font color="#999999">Bagels sind Anweisungen in einer Docker-Datei.</font></i> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Docker-Bilder</font> </h2><br>  Denken Sie daran, dass ein Docker-Container ein Docker-Image ist, das zum Leben erweckt wird.  Dies ist ein in sich geschlossenes Betriebssystem, in dem nur der am meisten erforderliche Anwendungscode vorhanden ist. <br><br>  Docker-Images sind das Ergebnis des Erstellungsprozesses, und Docker-Container führen Images aus.  Das Herzstück von Docker sind Dockerfiles.  Dateien wie diese teilen Docker mit, wie die Bilder zusammengesetzt werden sollen, aus denen die Container erstellt werden. <br><br>  Jedes Docker-Image verfügt über eine Datei namens Dockerfile.  Sein Name ist so geschrieben - ohne Erweiterung.  Wenn Sie den <code>docker build</code> ausführen, um ein neues Image zu erstellen, wird davon ausgegangen, dass sich die Docker-Datei im aktuellen Arbeitsverzeichnis befindet.  Wenn sich diese Datei an einem anderen Ort befindet, kann ihr Speicherort mit dem Flag <code>-f</code> angegeben werden. <br><br>  Behälter bestehen, wie wir im ersten Material dieser Serie herausgefunden haben, aus Schichten.  Jede Ebene mit Ausnahme der letzten, die sich über allen anderen befindet, ist schreibgeschützt.  Dockerfile teilt dem Docker-System mit, welche Ebenen und in welcher Reihenfolge dem Bild hinzugefügt werden sollen. <br><br>  Tatsächlich ist jede Ebene nur eine Datei, die die Änderung des Bildzustands im Vergleich zu dem Zustand beschreibt, in dem sie sich nach dem Hinzufügen der vorherigen Ebene befand.  Unter Unix ist übrigens fast alles eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datei</a> . <br><br>  Ein Basisbild ist die Quellenebene (oder die Quellenebenen) des zu erstellenden Bildes.  Das Basisbild wird auch als übergeordnetes Bild bezeichnet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a0/b89/6aa/6a0b896aa35c1f735103ae8924d5371d.jpg"></div><br>  <i><font color="#999999">Im Basis-Image beginnt das Docker-Image.</font></i> <br><br>  Wenn ein Image von einem Remote-Repository auf einen lokalen Computer heruntergeladen wird, werden nur Ebenen heruntergeladen, die auf diesem Computer nicht verfügbar sind.  Docker möchte Platz und Zeit sparen, indem vorhandene Ebenen wiederverwendet werden. <br><br><h2>  <font color="#3AC1EF">Dockerfile-Dateien</font> </h2><br>  Docker-Dateien enthalten Anweisungen zum Erstellen eines Bildes.  In Großbuchstaben beginnen die Zeilen dieser Datei.  Den Anweisungen folgen sind ihre Argumente.  Anweisungen werden beim Erstellen des Bildes von oben nach unten verarbeitet.  So sieht es aus: <br><br><pre> <code class="plaintext hljs">FROM ubuntu:18.04 COPY . /app</code> </pre> <br>  Ebenen im endgültigen Bild werden nur mit den Anweisungen <code>FROM</code> , <code>RUN</code> , <code>COPY</code> und <code>ADD</code> .  Andere Anweisungen richten etwas ein, beschreiben Metadaten oder teilen Docker mit, dass Sie während der Ausführung des Containers etwas tun müssen, z. B. einen Port öffnen oder einen Befehl ausführen. <br><br>  Hier gehen wir von der Annahme aus, dass ein Docker-Image verwendet wird, das auf einem Unix-ähnlichen Betriebssystem basiert.  Natürlich können Sie hier auch ein auf Windows basierendes Bild verwenden, aber die Verwendung von Windows ist weniger üblich. Die Arbeit mit solchen Bildern ist schwieriger.  Wenn Sie die Möglichkeit haben, verwenden Sie daher Unix. <br><br>  Hier ist eine Liste der Dockerfile-Anweisungen mit kurzen Kommentaren. <br><br><h2>  <font color="#3AC1EF">Dutzend Dockerfile-Anweisungen</font> </h2><br><ol><li>  <code>FROM</code> - Legt das Basisbild (übergeordnetes Bild) fest. </li><li>  <code>LABEL</code> - beschreibt Metadaten.  Zum Beispiel Informationen darüber, wer das Image erstellt und verwaltet. </li><li>  <code>ENV</code> - Legt persistente Umgebungsvariablen fest. </li><li>  <code>RUN</code> - führt einen Befehl aus und erstellt eine Bildebene.  Wird verwendet, um Pakete in einem Container zu installieren. </li><li>  <code>COPY</code> - kopiert Dateien und Ordner in den Container. </li><li>  <code>ADD</code> - kopiert Dateien und Ordner in einen Container und kann lokale .tar-Dateien entpacken. </li><li>  <code>CMD</code> - beschreibt einen Befehl mit Argumenten, der beim Starten des Containers ausgeführt werden muss.  Argumente können beim Start des Containers überschrieben werden.  Eine Datei kann nur eine <code>CMD</code> Anweisung enthalten. </li><li>  <code>WORKDIR</code> - <code>WORKDIR</code> das Arbeitsverzeichnis für die nächste Anweisung fest. </li><li>  <code>ARG</code> - Legt Variablen für die Übergabe von Docker während der Image-Erstellung fest. </li><li>  <code>ENTRYPOINT</code> - Stellt einen Befehl mit Argumenten <code>ENTRYPOINT</code> , die während der Containerausführung <code>ENTRYPOINT</code> .  Argumente werden nicht überschrieben. </li><li>  <code>EXPOSE</code> - zeigt an, dass der Port geöffnet werden muss. </li><li>  <code>VOLUME</code> - Erstellt einen Einhängepunkt für die Arbeit mit persistentem Speicher. </li></ol><br>  Lassen Sie uns nun über diese Anweisungen sprechen. <br><br><h2>  <font color="#3AC1EF">Anweisungen und Beispiele für ihre Verwendung</font> </h2><br><h3>  <font color="#3AC1EF">▍Einfache Docker-Datei</font> </h3><br>  Dockerfile kann sehr einfach und kurz sein.  Zum Beispiel - so: <br><br><pre> <code class="plaintext hljs">FROM ubuntu:18.04</code> </pre> <br><h3>  <font color="#3AC1EF">▍Aus der Anweisung</font> </h3><br>  Die Docker-Datei muss mit einer <code>FROM</code> Anweisung oder mit einer <code>ARG</code> Anweisung gefolgt von einer <code>FROM</code> Anweisung beginnen. <br><br>  Das Schlüsselwort <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FROM</a> weist Docker an, beim Erstellen des Bildes ein Basis-Image zu verwenden, das dem angegebenen Namen und Tag entspricht.  Das Grundbild wird außerdem auch als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">übergeordnetes Bild bezeichnet</a> . <br><br>  In diesem Beispiel wird das Basis-Image im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ubuntu-</a> Repository gespeichert.  Ubuntu ist der Name des offiziellen Docker-Repositorys, das die Basisversion der beliebten Linux-Betriebssystemfamilie Ubuntu bereitstellt. <br><br>  Bitte beachten Sie, dass die betreffende Docker-Datei ein <code>18.04</code> Tag enthält, das angibt, welches Basis-Image wir benötigen.  Dieses Bild wird beim Erstellen unseres Bildes geladen.  Wenn das Tag nicht in der Anweisung enthalten ist, geht Docker davon aus, dass das neueste Image aus dem Repository erforderlich ist.  Um ihre Absichten klarer auszudrücken, wird empfohlen, dass der Dockerfile-Autor angibt, welches Bild er benötigt. <br><br>  Wenn die obige Docker-Datei auf dem lokalen Computer zum ersten Mal zum Erstellen des Images verwendet wird, lädt Docker die durch das <code>ubuntu</code> Image definierten Ebenen.  Man kann sich vorstellen, dass sie einander überlagert sind.  Jede nächste Ebene ist eine Datei, die die Unterschiede des Bildes im Vergleich zu dem Zustand beschreibt, in dem es sich nach dem Hinzufügen der vorherigen Ebene befand. <br><br>  Wenn Sie einen Container erstellen, wird zusätzlich zu allen anderen Ebenen eine Ebene hinzugefügt, in der Sie Änderungen vornehmen können.  Die Daten in den verbleibenden Schichten können nur gelesen werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/912/530/d4f/912530d4f3468f0bff2a064d58d62caf.jpg"></div><br>  <i><font color="#999999">Containerstruktur (aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> entnommen)</font></i> <br><br>  Docker verwendet aus Gründen der Effizienz eine Copy-on-Write-Strategie.  Wenn die Ebene im Bild auf der vorherigen Ebene vorhanden ist und eine Ebene Daten daraus lesen muss, verwendet Docker die vorhandene Datei.  Sie müssen nichts herunterladen. <br><br>  Wenn das Bild ausgeführt wird und die Ebene mithilfe des Containers geändert werden muss, wird die entsprechende Datei in die oberste veränderbare Ebene kopiert.  Weitere Informationen zur Copy-on-Write-Strategie finden Sie in der Docker-Dokumentation. <br><br>  Wir setzen die Diskussion der in der Docker-Datei verwendeten Anweisungen fort und geben ein Beispiel für eine solche Datei mit einer komplexeren Struktur. <br><br><h3>  <font color="#3AC1EF">▍Mehr anspruchsvolle Docker-Datei</font> </h3><br>  Obwohl sich die Docker-Datei, die wir gerade überprüft haben, als ordentlich und verständlich herausgestellt hat, ist sie zu einfach und verwendet nur eine Anweisung.  Außerdem werden während der Containerausführung keine Anweisungen aufgerufen.  Schauen Sie sich eine andere Datei an, die ein kleines Bild sammelt.  Es verfügt über Mechanismen, die die Befehle bestimmen, die während der Ausführung des Containers aufgerufen werden. <br><br><pre> <code class="plaintext hljs">FROM python:3.7.2-alpine3.8 LABEL maintainer="jeffmshale@gmail.com" ENV ADMIN="jeff" RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add bash COPY . ./app ADD https://raw.githubusercontent.com/discdiver/pachy-vid/master/sample_vids/vid1.mp4 \ /my_app_directory RUN ["mkdir", "/a_directory"] CMD ["python", "./my_script.py"]</code> </pre> <br>  Vielleicht erscheint diese Datei auf den ersten Blick ziemlich kompliziert.  Lassen Sie uns deshalb mit ihm umgehen. <br><br>  Die Basis dieses Bildes ist das offizielle Python-Bild mit dem Tag 3.7.2-alpine3.8.  Nach der Analyse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses</a> Codes können Sie feststellen, dass dieses Basisimage Linux, Python und im Großen und Ganzen nur seine Zusammensetzung enthält.  Alpine OS-Images sind in der Docker-Welt sehr beliebt.  Die Tatsache, dass sie klein, schnell und sicher sind.  Alpine Bilder unterscheiden sich jedoch nicht in den für herkömmliche Betriebssysteme typischen umfassenden Funktionen.  Um auf der Grundlage eines solchen Images etwas Nützliches zu sammeln, muss der Ersteller des Images die von ihm benötigten Pakete installieren. <br><br><h3>  <font color="#3AC1EF">▍Anweisungsetikett</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/839/d5d/720/839d5d7205849f8dee228dcd7a42eaf7.jpg"></div><br>  <i><font color="#999999">Tags</font></i> <br><br>  Mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LABEL-Anweisung</a> (Label) können Sie dem Bild Metadaten hinzufügen.  Im Fall der jetzt betrachteten Datei enthält sie die Kontaktinformationen des Erstellers des Bildes.  Durch das Deklarieren von Etiketten wird der Bildassemblierungsprozess nicht verlangsamt oder vergrößert.  Sie enthalten nur nützliche Informationen zum Docker-Image. Es wird daher empfohlen, sie in die Datei aufzunehmen.  Details zum Arbeiten mit Metadaten in der Docker-Datei finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br><h3>  <font color="#3AC1EF">▍Inv-Anweisung</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d85/1a1/4d7/d851a14d7b7f4db671afe3b375cb4596.jpg"></div><br>  <i><font color="#999999">Umgebung</font></i> <br><br>  Mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ENV-</a> Anweisung können Sie konstante Umgebungsvariablen festlegen, die während der Ausführung im Container verfügbar sind.  Im vorherigen Beispiel können Sie nach dem Erstellen des Containers die Variable <code>ADMIN</code> . <br><br>  Der <code>ENV</code> Befehl eignet sich gut zum Einstellen von Konstanten.  Wenn Sie einen bestimmten Wert in der Docker-Datei mehrmals verwenden, z. B. wenn Sie die Befehle beschreiben, die im Container ausgeführt werden, und vermuten, dass Sie ihn eines Tages in einen anderen ändern müssen, ist es sinnvoll, ihn in eine ähnliche Konstante zu schreiben. <br><br>  Es ist zu beachten, dass es in Dockerfile-Dateien häufig verschiedene Möglichkeiten gibt, dieselben Probleme zu lösen.  Was genau zu verwenden ist, ist eine Frage, deren Entscheidung durch den Wunsch beeinflusst wird, die in der Docker-Umgebung angewandten Arbeitsmethoden einzuhalten, um die Transparenz der Lösung und ihre hohe Leistung sicherzustellen.  Beispielsweise dienen die <code>ENTRYPOINT</code> <code>RUN</code> , <code>CMD</code> und <code>ENTRYPOINT</code> unterschiedlichen Zwecken, werden jedoch alle zum Ausführen von Befehlen verwendet. <br><br><h3>  <font color="#3AC1EF">▍RUN-Anweisung</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/910/a89/72b/910a8972b92a69418d859a1fbd550ae5.jpg"></div><br>  <i><font color="#999999">RUN-Anweisung</font></i> <br><br>  Mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RUN-</a> Anweisung können Sie während der Image-Erstellung eine Ebene erstellen.  Nach seiner Ausführung wird dem Bild eine neue Ebene hinzugefügt, deren Status festgelegt ist.  Die <code>RUN</code> Anweisung wird häufig verwendet, um zusätzliche Pakete in Images zu installieren.  Im vorherigen Beispiel teilt die Anweisung <code>RUN apk update &amp;&amp; apk upgrade</code> Docker mit, dass das System Pakete vom <code>RUN apk update &amp;&amp; apk upgrade</code> muss.  Nach diesen beiden Befehlen folgt der Befehl <code>&amp;&amp; apk add bash</code> , der angibt, dass bash im Image installiert werden muss. <br><br>  Was in Teams wie <code>apk</code> aussieht, ist eine Abkürzung für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Alpine Linux package manager</a> .  Wenn Sie das Basis-Image eines anderen Betriebssystems der Linux-Familie verwenden, benötigen Sie beispielsweise bei Verwendung von Ubuntu möglicherweise einen Befehl des Formulars <code>RUN apt-get</code> , um Pakete zu installieren.  Später werden wir über andere Möglichkeiten zur Installation von Paketen sprechen. <br><br>  Die <code>RUN</code> Anweisung und ähnliche Anweisungen wie <code>CMD</code> und <code>ENTRYPOINT</code> können entweder in der Exec-Form oder in der Shell-Form verwendet werden.  Das exec-Formular verwendet eine Syntax, die der Beschreibung eines JSON-Arrays ähnelt.  Zum Beispiel könnte es so aussehen: <code>RUN ["my_executable", "my_first_param1", "my_second_param2"]</code> . <br><br>  Im vorherigen Beispiel haben wir die Shell-Form der RUN-Anweisung wie folgt verwendet: <code>RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add bash</code> . <br><br>  Später in unserer Docker-Datei haben wir die Exec-Form der <code>RUN</code> Anweisung in Form von <code>RUN ["mkdir", "/a_directory"]</code> , um ein Verzeichnis zu erstellen.  Wenn Sie Anweisungen in diesem Formular verwenden, müssen Sie sich gleichzeitig daran erinnern, dass Zeichenfolgen mit doppelten Anführungszeichen formatiert werden müssen, wie dies im JSON-Format üblich ist. <br><br><h3>  <font color="#3AC1EF">▍Anweisung KOPIEREN</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ba/8b7/b82/5ba8b7b82e09854f7ba3ac1d2ad5b404.jpg"></div><br>  <i><font color="#999999">COPY-Anweisung</font></i> <br><br>  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">COPY-</a> Anweisung wird in unserer Datei folgendermaßen dargestellt: <code>COPY . ./app</code>  <code>COPY . ./app</code> .  Sie teilt Docker mit, dass sie Dateien und Ordner aus dem lokalen Kontext der Assembly entnehmen und zum aktuellen Arbeitsverzeichnis des Images hinzufügen muss.  Wenn das Zielverzeichnis nicht vorhanden ist, wird es durch diese Anweisung erstellt. <br><br><h3>  <font color="#3AC1EF">▍Anweisung HINZUFÜGEN</font> </h3><br>  Mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ADD-</a> Anweisung können Sie dieselben Probleme wie mit <code>COPY</code> lösen, es sind jedoch einige weitere Anwendungsfälle damit verbunden.  Mit dieser Anweisung können Sie also Dateien hinzufügen, die von Remote-Quellen heruntergeladen wurden, sowie lokale .tar-Dateien entpacken. <br><br>  In diesem Beispiel wurde die Anweisung <code>ADD</code> verwendet, um eine URL-zugängliche Datei in das Containerverzeichnis <code>my_app_directory</code> zu kopieren.  Es ist jedoch zu beachten, dass in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-Dokumentation</a> die Verwendung solcher per URL erhaltenen Dateien nicht empfohlen wird, da sie nicht gelöscht werden können und das Bild vergrößert werden. <br><br>  Darüber hinaus wird in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation nach</a> Möglichkeit empfohlen, die <code>COPY</code> Anweisung anstelle der <code>ADD</code> Anweisung zu verwenden, um das Verständnis der Docker-Datei zu erleichtern.  Ich denke, das Docker-Entwicklungsteam sollte <code>ADD</code> und <code>COPY</code> in einer Anweisung kombinieren, damit sich diejenigen, die die Bilder erstellen, nicht an zu viele Anweisungen erinnern müssen. <br><br>  Beachten Sie, dass die <code>ADD</code> Anweisung das Zeilenumbruchzeichen - <code>\</code> .  Solche Zeichen werden verwendet, um die Lesbarkeit langer Befehle zu verbessern, indem sie in mehrere Zeilen aufgeteilt werden. <br><br><h3>  <font color="#3AC1EF">▍ CMD-Anweisung</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/505/835/d13/505835d13cd3c9300f0d95681b3dbf93.jpg"></div><br>  <i><font color="#999999">CMD-Anweisung</font></i> <br><br>  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CMD-</a> Anweisung stellt Docker einen Befehl zur Verfügung, der ausgeführt wird, wenn der Container gestartet wird.  Die Ergebnisse dieses Befehls werden dem Image während seiner Montage nicht hinzugefügt.  In unserem Beispiel startet dieser Befehl das Skript <code>my_script.py</code> zur Laufzeit. <br><br>  Folgendes müssen Sie noch über die <code>CMD</code> Anweisung wissen: <br><br><ul><li>  In einer Docker-Datei kann nur ein <code>CMD</code> Befehl vorhanden sein.  Wenn die Datei mehrere solcher Anweisungen enthält, ignoriert das System alles außer der letzten. </li><li>  Ein <code>CMD</code> Befehl kann eine Ausführungsform haben.  Wenn die Anweisung keinen Verweis auf die ausführbare Datei enthält, muss die Anweisung <code>ENTRYPOINT</code> in der Datei vorhanden sein.  In diesem Fall müssen beide Anweisungen im <code>JSON</code> . </li><li>  Die an <code>docker run</code> Befehlszeilenargumente überschreiben die Argumente, die von der <code>CMD</code> Anweisung in der Docker-Datei bereitgestellt werden. </li></ul><br><h3>  <font color="#3AC1EF">▍Eine noch komplexere Docker-Datei</font> </h3><br>  Stellen Sie sich eine andere Docker-Datei vor, in der einige neue Befehle verwendet werden. <br><br><pre> <code class="plaintext hljs">FROM python:3.7.2-alpine3.8 LABEL maintainer="jeffmshale@gmail.com" #   RUN apk add --update git #     WORKDIR /usr/src/my_app_directory #          COPY . . #       ARG my_var=my_default_value #  ,           ENTRYPOINT ["python", "./app/my_script.py", "my_var"] #   EXPOSE 8000 #      VOLUME /my_volume</code> </pre> <br>  In diesem Beispiel sehen Sie unter anderem Kommentare, die mit dem Zeichen <code>#</code> . <br>  Eines der wichtigsten Dinge, die Dockerfile tut, ist die Installation von Paketen.  Wie bereits erwähnt, gibt es verschiedene Möglichkeiten, Pakete mithilfe der <code>RUN</code> Anweisung zu installieren. <br><br>  Pakete im Alpine Docker-Image können mit <code>apk</code> installiert werden.  Hierzu wird, wie bereits gesagt, ein Befehl des Formulars <code>RUN apk update &amp;&amp; apk upgrade &amp;&amp; apk add bash</code> . <br><br>  Darüber hinaus können Python-Pakete im Image mithilfe von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pip</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wheel</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Conda</a> installiert werden.  Wenn es sich nicht um Python handelt, sondern um andere Programmiersprachen, können andere Paketmanager verwendet werden, um die entsprechenden Images vorzubereiten. <br><br>  Gleichzeitig muss die zugrunde liegende Schicht dem Paketmanager einen geeigneten Paketmanager zur Verfügung stellen, damit eine Installation möglich ist.  Wenn Sie Probleme beim Installieren von Paketen haben, stellen Sie daher sicher, dass der Paketmanager installiert ist, bevor Sie versuchen, ihn zu verwenden. <br><br>  Beispielsweise können Sie die <code>RUN</code> Anweisung in einer Docker-Datei verwenden, um eine Liste von Paketen mit <code>pip</code> zu installieren.  Wenn Sie dies tun, kombinieren Sie alle Befehle zu einer Anweisung und trennen Sie sie mit Zeilenumbruchzeichen unter Verwendung des Zeichens <code>\</code> .  Dank dieses Ansatzes sehen die Dateien ordentlich aus und dies führt dazu, dass dem Bild weniger Ebenen hinzugefügt werden, als mit mehreren <code>RUN</code> Anweisungen hinzugefügt würden. <br><br>  Darüber hinaus können Sie verschiedene Schritte ausführen, um mehrere Pakete zu installieren.  Sie können sie in einer Datei auflisten und diese Datei mit <code>RUN</code> an den Paketmanager übertragen.  In der Regel werden diese Dateien als <code>requirements.txt</code> . <br><br><h3>  <font color="#3AC1EF">▍ WORKDIR-Anweisung</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/528/9ef/88f/5289ef88f3bc5fc7e4856fdc13d9872e.jpg"></div><br>  <i><font color="#999999">Arbeitsverzeichnisse</font></i> <br><br>  Mit der Anweisung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WORKDIR</a> können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie</a> das Arbeitsverzeichnis des Containers ändern.  Die <code>ENTRYPOINT</code> <code>WORKDIR</code> <code>COPY</code> , <code>ADD</code> , <code>RUN</code> , <code>CMD</code> und <code>WORKDIR</code> funktionieren mit diesem Verzeichnis.  Hier sind einige Funktionen im Zusammenhang mit dieser Anleitung: <br><br><ul><li>  Es ist besser, mit <code>WORKDIR</code> absolute Pfade zu Ordnern <code>WORKDIR</code> als mit den <code>cd</code> Befehlen in der Docker-Datei im Dateisystem zu navigieren. </li><li>  Die Anweisung <code>WORKDIR</code> erstellt automatisch ein Verzeichnis, wenn es nicht vorhanden ist. </li><li>  Sie können mehrere <code>WORKDIR</code> Anweisungen verwenden.  Wenn für solche Anweisungen relative Anweisungen bereitgestellt werden, ändert jede von ihnen das aktuelle Arbeitsverzeichnis. </li></ul><br><h3>  <font color="#3AC1EF">▍Guide ARG</font> </h3><br>  Mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ARG-</a> Anweisung können Sie eine Variable festlegen, deren Wert während der Assemblierung von der Befehlszeile an das Image übergeben werden kann.  Der Wert für die Standardvariable kann in der Docker-Datei dargestellt werden.  Zum Beispiel: <code>ARG my_var=my_default_value</code> . <br><br>  Im Gegensatz zu <code>ENV</code> Variablen sind <code>ARG</code> Variablen zur Laufzeit nicht verfügbar.  <code>ARG</code> Variablen können jedoch verwendet werden, um Standardwerte für <code>ENV</code> Variablen über die Befehlszeile während der Image- <code>ENV</code> .  Und <code>ENV</code> Variablen sind bereits während der Ausführung im Container verfügbar.  Details zu dieser Technik des Arbeitens mit Variablen finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br><h3>  <font color="#3AC1EF">▍Anweisung ENTRYPOINT</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2f/8b8/e95/c2f8b8e95436c097571b44810ac97a7a.jpg"></div><br>  <i><font color="#999999">Übergangspunkt zu einem Ort</font></i> <br><br>  Mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ENTRYPOINT-Anweisung</a> können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie</a> einen Befehl mit Argumenten angeben, die beim <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Starten</a> des Containers ausgeführt werden sollen.  Es ähnelt dem <code>CMD</code> Befehl, aber die in <code>ENTRYPOINT</code> angegebenen <code>ENTRYPOINT</code> werden nicht überschrieben, wenn der Container mit Befehlszeilenparametern gestartet wird. <br><br>  Stattdessen werden die in den Konstruktionen des Formular- <code>docker run my_image_name</code> zu den in der <code>ENTRYPOINT</code> angegebenen Argumenten <code>ENTRYPOINT</code> .  Nach dem Ausführen eines Befehls des Formular- <code>docker run my_image bash</code> Argument <code>docker run my_image bash</code> beispielsweise am Ende der von <code>ENTRYPOINT</code> angegebenen Liste von Argumenten <code>ENTRYPOINT</code> .  Vergessen Sie bei der Vorbereitung Ihrer Docker-Datei nicht die <code>ENTRYPOINT</code> <code>CMD</code> oder <code>ENTRYPOINT</code> . <br><br>  In der Dokumentation zu Docker finden Sie verschiedene Empfehlungen dazu, welche Anweisung, <code>CMD</code> oder <code>ENTRYPOINT</code> , beim <code>ENTRYPOINT</code> des Containers als Werkzeug zum Ausführen von Befehlen ausgewählt werden soll: <br><br><ul><li>  Wenn Sie bei jedem Start des Containers denselben Befehl <code>ENTRYPOINT</code> , verwenden Sie <code>ENTRYPOINT</code> . </li><li>  Wenn der Container als Anwendung verwendet wird, verwenden Sie <code>ENTRYPOINT</code> . </li><li>  Wenn Sie wissen, dass Sie beim Starten des Containers Argumente übergeben müssen, die die in der Docker-Datei angegebenen Argumente überschreiben können, verwenden Sie <code>CMD</code> . </li></ul><br>  In unserem Beispiel führt die Verwendung der <code>ENTRYPOINT ["python", "my_script.py", "my_var"]</code> Anweisung <code>ENTRYPOINT ["python", "my_script.py", "my_var"]</code> dass der Container beim Start das Python-Skript <code>my_script.py</code> mit dem Argument <code>my_var</code> .  Der durch <code>my_var</code> dargestellte <code>my_var</code> kann dann mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">argparse</a> im Skript verwendet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> .    ,   Dockerfile  <code>my_var</code> ,   ,       <code>ARG</code> .  ,         ,     . <br><br>  Docker   exec- <code>ENTRYPOINT</code> : <code>ENTRYPOINT ["executable", "param1", "param2"]</code> . <br><br><h3> <font color="#3AC1EF">▍ EXPOSE</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee1/cca/45e/ee1cca45e3fd7e9be988556536fb1633.jpg"></div><br> <i><font color="#999999"> EXPOSE</font></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EXPOSE</a>   ,      ,          .     . , ,     ,   ,   ,  ,   . <br><br>      ( )    ,    <code>docker run</code>   <code>-p</code> .      <code>-P</code> (   <code>P</code> ),     ,    <code>EXPOSE</code> . <br><br><h3> <font color="#3AC1EF">▍ VOLUME</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c1/ff6/a57/7c1ff6a5765f28cbd3d68cbf60d6b4aa.jpg"></div><br> <i><font color="#999999"> VOLUME</font></i> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VOLUME</a>   ,              .     . <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>     ,       Dockerfile.      .  ,      ,  <code>USER</code> , <code>ONBUILD</code> , <code>STOPSIGNAL</code> , <code>SHELL</code>  <code>HEALTHCHECK</code> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>     Dockerfile. <br><br> ,  Dockerfile —     Docker,      ,        .          ,       . <br><br>  <b>Liebe Leser!</b>    Docker  ,    ,    Docker-. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439980/">https://habr.com/ru/post/de439980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439970/index.html">Bericht über Probleme und Zugänglichkeit des Internets im Zeitraum 2018-2019</a></li>
<li><a href="../de439972/index.html">io_submit: Eine Alternative zu Epoll, von der Sie noch nie gehört haben</a></li>
<li><a href="../de439974/index.html">Persönliche agile Transformation: Eine flexible Reise zur Produktivität</a></li>
<li><a href="../de439976/index.html">Wird Node.js immer langsamer sein als Golang?</a></li>
<li><a href="../de439978/index.html">Docker lernen, Teil 2: Begriffe und Konzepte</a></li>
<li><a href="../de439982/index.html">React Tutorial, Teil 16: Die vierte Phase der Arbeit an einer TODO-Anwendung, Ereignisverarbeitung</a></li>
<li><a href="../de439984/index.html">React Tutorial, Teil 17: Die fünfte Phase der Arbeit an einer TODO-Anwendung, Ändern des Status von Komponenten</a></li>
<li><a href="../de439986/index.html">Chips VS Bedrohungen für die Containerisierungstechnologie</a></li>
<li><a href="../de439988/index.html">Technosphäre fünf Jahre</a></li>
<li><a href="../de439990/index.html">Das Buch „Pragmatische KI. Maschinelles Lernen und Cloud-Technologie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>