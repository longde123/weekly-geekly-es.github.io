<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äç‚öñÔ∏è üç™ üèÇüèº Saya perlu meningkatkan cluster Kubernetes, tapi saya hanya seorang programmer kode. Ada jalan keluar ‚ôäÔ∏è üê∑ üîû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari yang baik Catatan lain dari pengalaman saya. Kali ini dangkal tentang infrastruktur dasar, yang saya gunakan jika saya perlu membongkar sesuatu, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Saya perlu meningkatkan cluster Kubernetes, tapi saya hanya seorang programmer kode. Ada jalan keluar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423481/"><img src="https://habrastorage.org/webt/j9/qc/fb/j9qcfbdq_raamw7rwyt02ci1an8.png"><br><br>  Hari yang baik  Catatan lain dari pengalaman saya.  Kali ini dangkal tentang infrastruktur dasar, yang saya gunakan jika saya perlu membongkar sesuatu, tetapi tidak ada orang <b>-</b> orang <b>devOps di dekatnya</b> .  Tetapi tingkat abstraksi saat ini, dalam teknologi, memungkinkan sekitar satu tahun untuk hidup dengan infrastruktur ini, dinaikkan pada malam hari, menggunakan Internet dan hal-hal yang sudah jadi. <br><br>  Kata kunci - <b>AWS</b> + <b>Terraform</b> + <b>kops</b> .  Jika ini berguna bagi saya, mungkin akan bermanfaat bagi orang lain.  Selamat datang di komentar. <br><a name="habracut"></a><br><h2>  -1.  Apa yang kita hadapi </h2><br>  Situasi klasik - proyek ditulis ke tahap seperti itu ketika perlu untuk membongkar di suatu tempat dan mulai menggunakannya.  Dan proyek ini lebih rumit daripada halaman html sederhana.  Saya ingin kemungkinan penskalaan horizontal, identitas lingkungan pada pengujian lokal, produk, dan proses penyebaran yang lebih atau kurang normal. <br><blockquote>  Ini tentang aplikasi pada <b>Laravel</b> untuk menunjukkan seluruh proses dari awal hingga akhir.  Tetapi dengan cara yang serupa, Anda dapat menggunakan layanan yang tersebar di mana saja, aplikasi python, situs kecil di WP, halaman html dan banyak lagi.  Untuk tingkat tertentu, ini sudah cukup, dan kemudian orang yang terpisah muncul di tim, yang akan meningkatkan dan melengkapinya. </blockquote>  Baru-baru ini, saya sampai pada kenyataan bahwa saya menginstal <b>GoLand, PhpStorm, Docker, Git</b> pada mesin lokal dan saya benar <b>-</b> benar siap untuk bekerja.  Ya, dan Anda dapat mengelola dari satu mesin dalam kelompok curah, jadi saya akan menjelaskan seluruh proses tanpa memperhitungkan OS tempat Anda bekerja, mengemas semua hal dalam wadah buruh pelabuhan. <br><br><h2>  0. Bersiap untuk bekerja. </h2><br>  Mari kita bayangkan bahwa kita telah mendaftarkan akun di <b>AWS</b> , diminta melalui dukungan teknis untuk meningkatkan batas akun dengan jumlah server yang berjalan secara bersamaan, menciptakan pengguna <b>IAM</b> dan sekarang kita memiliki <b>Kunci Akses</b> + <b>Kunci Rahasia</b> .  Zone - <b>us-east-1</b> . <br><br>  Apa yang kita butuhkan di komputer lokal?  <b>AWS CLI</b> , <b>Terraform</b> untuk manajemen deklaratif <b>AWS</b> , <b>kubectl</b> , <b>kops</b> untuk mengkonfigurasi cluster dan <b>Helm</b> , untuk menyebarkan beberapa layanan.  Kami mengumpulkan <b>Dockerfile</b> (yang saya temukan jauh sebelumnya di suatu tempat di luasnya github, tetapi saya tidak dapat menemukan di mana).  Kami menulis <b>docker-compose.yml kami</b> untuk me-mount direktori dan <b>Makefile</b> untuk alias. <br><br><div class="spoiler">  <b class="spoiler_title">Dockerfile</b> <div class="spoiler_text"><pre><code class="plaintext hljs">FROM ubuntu:16.04 ARG AWSCLI_VERSION=1.12.1 ARG HELM_VERSION=2.8.2 ARG ISTIO_VERSION=0.6.0 ARG KOPS_VERSION=1.9.0 ARG KUBECTL_VERSION=1.10.1 ARG TERRAFORM_VERSION=0.11.0 # Install generally useful things RUN apt-get update \ &amp;&amp; apt-get -y --force-yes install --no-install-recommends \ curl \ dnsutils \ git \ jq \ net-tools \ ssh \ telnet \ unzip \ vim \ wget \ &amp;&amp; apt-get clean \ &amp;&amp; apt-get autoclean \ &amp;&amp; apt-get autoremove \ &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* # Install AWS CLI RUN apt-get update \ &amp;&amp; apt-get -y --force-yes install \ python-pip \ &amp;&amp; pip install awscli==${AWSCLI_VERSION} \ &amp;&amp; apt-get clean \ &amp;&amp; apt-get autoclean \ &amp;&amp; apt-get autoremove \ &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* # Install Terraform RUN wget -O terraform.zip https://releases.hashicorp.com/terraform/${TERRAFORM_VERSION}/terraform_${TERRAFORM_VERSION}_linux_amd64.zip \ &amp;&amp; unzip terraform.zip \ &amp;&amp; mv terraform /usr/local/bin/terraform \ &amp;&amp; chmod +x /usr/local/bin/terraform \ &amp;&amp; rm terraform.zip # Install kubectl ADD https://storage.googleapis.com/kubernetes-release/release/v${KUBECTL_VERSION}/bin/linux/amd64/kubectl /usr/local/bin/kubectl RUN chmod +x /usr/local/bin/kubectl # Install Kops ADD https://github.com/kubernetes/kops/releases/download/${KOPS_VERSION}/kops-linux-amd64 /usr/local/bin/kops RUN chmod +x /usr/local/bin/kops # Install Helm RUN wget -O helm.tar.gz https://storage.googleapis.com/kubernetes-helm/helm-v${HELM_VERSION}-linux-amd64.tar.gz \ &amp;&amp; tar xfz helm.tar.gz \ &amp;&amp; mv linux-amd64/helm /usr/local/bin/helm \ &amp;&amp; chmod +x /usr/local/bin/helm \ &amp;&amp; rm -Rf linux-amd64 \ &amp;&amp; rm helm.tar.gz # Create default user "kops" RUN useradd -ms /bin/bash kops WORKDIR /home/kops USER kops # Ensure the prompt doesn't break if we don't mount the ~/.kube directory RUN mkdir /home/kops/.kube \ &amp;&amp; touch /home/kops/.kube/config</code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">docker-compose.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: '2.1' services: cluster-main: container_name: cluster.com image: cluster.com user: root stdin_open: true volumes: - ./data:/data - ./.ssh:/root/.ssh - ./.kube:/root/.kube - ./.aws:/root/.aws cluster-proxy: container_name: cluster.com-kubectl-proxy image: cluster.com user: root entrypoint: kubectl proxy --address='0.0.0.0' --port=8001 --accept-hosts='.*' ports: - "8001:8001" stdin_open: true volumes: - ./data:/data - ./.ssh:/root/.ssh - ./.kube:/root/.kube - ./.aws:/root/.aws</code> </pre><br></div></div><div class="spoiler">  <b class="spoiler_title">Makefile</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">docker.build: docker build -t cluster.com . docker.run: docker-compose up -d docker.bash: docker exec -it cluster.com bash</code> </pre> <br></div></div><br>  <b>Dockerfile</b> - ambil gambar ubuntu dasar dan instal semua perangkat lunak.  <b>Makefile</b> - hanya untuk kenyamanan, Anda dapat menggunakan mekanisme alias biasa.  <b>Docker-compose.yml</b> - kami menambahkan wadah tambahan yang akan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">melemparkan</a> kami ke browser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dashboard K8S</a> jika Anda perlu melihat sesuatu secara visual. <br><br>  Kami membuat <b>data</b> , <b>.ssh</b> , <b>.kube</b> , <b>.aws folder</b> di root dan menempatkan konfigurasi kami untuk aws, kunci ssh di sana dan kami dapat mengumpulkan dan menjalankan wadah kami melalui <b>make docker.build &amp; make docker.run</b> . <br><br>  Nah, di folder <b>data</b> , buat folder tempat kita meletakkan file <b>yaml k8s</b> , dan di sebelah yang kedua, di mana kita akan menyimpan status <b>terraform dari</b> cluster.  Saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>menempatkan</b></a> hasil perkiraan tahap ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>di github</b></a> . <br><br><h2>  1. Angkat cluster kami. </h2><br><blockquote>  Selanjutnya akan menjadi terjemahan gratis dari catatan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> .  Saya akan menghilangkan banyak poin teoretis, mencoba menggambarkan pemerasan singkat.  Semua sama, format catatan saya adalah tldr. </blockquote><br>  Dalam <b>folder data / aws-cluster-init-kops-terraform kami, kami</b> mengkloning apa yang ada di repositori <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> dan pergi ke konsol kontainer melalui <b>make docker.bash</b> .  Penyebaran tim yang membosankan dimulai. <br><br><h4>  AWS CLI </h4><br>  Kami membuat pengguna <b>kops</b> , menambahkan hak akses dan mengkonfigurasi <b>AWS CLI</b> di atasnya agar tidak menjalankan perintah dari superuser. <br><br><pre> <code class="bash hljs">aws iam create-group --group-name kops <span class="hljs-comment"><span class="hljs-comment">#   aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonEC2FullAccess --group-name kops aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonRoute53FullAccess --group-name kops aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess --group-name kops aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/IAMFullAccess --group-name kops aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AWSCertificateManagerFullAccess --group-name kops aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AmazonVPCFullAccess --group-name kops aws iam create-user --user-name kops aws iam add-user-to-group --user-name kops --group-name kops aws iam create-access-key --user-name kops</span></span></code> </pre><br><pre> <code class="bash hljs">aws configure</code> </pre><br><h4>  Inisialisasi Terraform </h4><br>  Dalam file <b>data / aws-cluster-init-kops-terraform / variable.tf, ubah</b> nama cluster ke yang diinginkan.  Jangan lupa untuk mengambil server dns kami dari file <b>update.json</b> dan perbarui di mana Anda membeli domain Anda. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#    cd /data/aws-cluster-init-kops-terraform #    AWS CLI export AWS_ACCESS_KEY_ID=$(aws configure get aws_access_key_id) export AWS_SECRET_ACCESS_KEY=$(aws configure get aws_secret_access_key) #  terraform terraform init terraform get terraform apply #  NS  cat update-zone.json \ | jq ".Changes[].ResourceRecordSet.Name=\"$(terraform output name).\"" \ | jq ".Changes[].ResourceRecordSet.ResourceRecords=$(terraform output -json name_servers | jq '.value|[{"Value": .[]}]')" \ &gt; update-zone.json</span></span></code> </pre><br><h4>  Kops </h4><br>  Kami membuat cluster melalui <b>kops</b> , mengekspor konfigurasi ke file <b>.tf</b> . <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> NAME=$(terraform output cluster_name) <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> KOPS_STATE_STORE=$(terraform output state_store) <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> ZONES=$(terraform output -json availability_zones | jq -r <span class="hljs-string"><span class="hljs-string">'.value|join(",")'</span></span>) kops create cluster \ --master-zones <span class="hljs-variable"><span class="hljs-variable">$ZONES</span></span> \ --zones <span class="hljs-variable"><span class="hljs-variable">$ZONES</span></span> \ --topology private \ --dns-zone $(terraform output public_zone_id) \ --networking calico \ --vpc $(terraform output vpc_id) \ --target=terraform \ --out=. \ <span class="hljs-variable"><span class="hljs-variable">${NAME}</span></span></code> </pre><br><blockquote>  Dibutuhkan sedikit komentar di sini.  <b>Terraform</b> akan membuat <b>VPC</b> , dan kita perlu sedikit mengubah konfigurasi yang diberikan oleh <b>kita</b> .  Ini dilakukan cukup sederhana melalui helper <b>ryane / gensubnets</b> image <b>: 0,1</b> <br></blockquote><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   terraform output -json &gt; subnets.json</span></span></code> </pre><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     echo subnets.json | docker run --rm -i ryane/gensubnets:0.1</span></span></code> </pre><br>  Anda dapat menambahkan kebijakan langsung untuk route53. <br><br><pre> <code class="plaintext hljs">additionalPolicies: master: | [ { "Effect": "Allow", "Action": ["route53:ListHostedZonesByName"], "Resource": ["*"] }, { "Effect": "Allow", "Action": ["elasticloadbalancing:DescribeLoadBalancers"], "Resource": ["*"] }, { "Effect": "Allow", "Action": ["route53:ChangeResourceRecordSets"], "Resource": ["*"] } ] node: | [ { "Effect": "Allow", "Action": ["route53:ListHostedZonesByName"], "Resource": ["*"] }, { "Effect": "Allow", "Action": ["elasticloadbalancing:DescribeLoadBalancers"], "Resource": ["*"] }, { "Effect": "Allow", "Action": ["route53:ChangeResourceRecordSets"], "Resource": ["*"] } ]</code> </pre><br>  Mengedit melalui <b>kops, mengedit cluster $ {NAME}</b> . <br><br><img src="https://habrastorage.org/webt/yw/wg/w4/ywwgw42_afdmr__elg0og_yjruk.png"><br><br>  Sekarang kita bisa menaikkan cluster itu sendiri. <br><br><pre> <code class="bash hljs">kops update cluster \ --out=. \ --target=terraform \ <span class="hljs-variable"><span class="hljs-variable">${NAME}</span></span> terraform apply</code> </pre><br>  Semuanya akan berjalan dengan baik, konteks <b>kubectl</b> akan berubah.  Di folder <b>data / aws-cluster-init-kops-terraform</b> , kami akan menyimpan status cluster.  Anda bisa meletakkan semuanya di <b>git</b> dan mengirimkannya ke repositori bitpack pribadi. <br><br><pre> <code class="bash hljs">$ kubectl get nodes NAME STATUS AGE ip-10-20-101-252.ec2.internal Ready,master 7m ip-10-20-103-232.ec2.internal Ready,master 7m ip-10-20-103-75.ec2.internal Ready 5m ip-10-20-104-127.ec2.internal Ready,master 6m ip-10-20-104-6.ec2.internal Ready 5m</code> </pre><br><h2>  2. Angkat aplikasi kita </h2><br>  Sekarang kami memiliki sesuatu, kami dapat menggunakan layanan kami dalam sebuah cluster.  Saya akan menempatkan perkiraan konfigurasi di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori yang sama</a> .  Mereka dapat dimasukkan ke dalam paket di <b>data / k8s</b> . <br><br><h4>  Lelucon servis </h4><br>  Mari kita mulai dengan hal-hal layanan.  Kami membutuhkan <b>helm</b> , <b>route53</b> , <b>kelas penyimpanan</b> , dan akses ke <b>registri</b> pribadi kami di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hub.docker.com</a> .  Baik, atau untuk yang lain, jika ada keinginan seperti itu. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Init helm kubectl create serviceaccount --namespace kube-system tiller kubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller kubectl patch deploy --namespace kube-system tiller-deploy -p '{"spec":{"template":{"spec":{"serviceAccount":"tiller"}}}}' helm init</span></span></code> </pre><br><pre> <code class="bash hljs">kubectl apply -f default-namespace.yaml kubectl apply -f storage-classes.yaml kubectl apply -f route53.yaml kubectl apply -f docker-hub-secret.yml kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/master/src/deploy/recommended/kubernetes-dashboard.yaml</code> </pre><br><h4>  PostgreSQL + Redis </h4><br>  Saya membakar berkali-kali menggunakan buruh pelabuhan bukan untuk wadah <b>stateless</b> , tetapi konfigurasi terakhir sejauh ini terbukti paling cocok.  Saya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>Stolon</b></a> untuk memberikan skalabilitas.  Sekitar setahun penerbangannya normal. <br><br>  Kami menggunakan <b>helm-chart</b> dan beberapa konfigurasi <b>Redis</b> cepat. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  etcd  stolon cd etcd-chart helm install --name global-etcd . #   stolon cd stolon-chart helm dep build helm install --name global-postgres . #  redis kubectl apply -f redis</span></span></code> </pre><br><h4>  Nginx + php </h4><br>  Tandan biasa.  <b>Nginx</b> dan <b>php-fpm</b> .  Saya tidak secara khusus membersihkan konfigurasi, tetapi semua orang dapat mengonfigurasi sendiri.  Sebelum mendaftar, Anda harus menentukan gambar dari mana kami akan mengambil kode + menambahkan garis sertifikat dari <b>AWS Certificate Manager</b> .  Php sendiri - Anda dapat mengambilnya dari dockerhab, tapi saya membangun yang pribadi dengan menambahkan beberapa perpustakaan. <br><br><pre> <code class="bash hljs">kubectl apply -f nginx kubectl apply -f php</code> </pre><br>  Pada gambar kita dengan kode, kita menyimpannya di folder <b>/ crm-code</b> .  Kami menggantinya dengan gambar Anda dan itu akan berfungsi dengan benar.  File tersebut adalah <b>nginx / deployment.yml</b> . <br><br><img src="https://habrastorage.org/webt/xy/0k/0a/xy0k0axs4muxujs3b-dyp8ncske.png"><br><br>  Keluarkan domain.  <b>Layanan Route53</b> akan mengambilnya, mengubah / menambah catatan DNS, sertifikat akan <b>diunggah</b> ke <b>ELB</b> dari <b>AWS Certificate Manager</b> .  File tersebut adalah <b>nginx / service.yml</b> . <br><br><img src="https://habrastorage.org/webt/aw/nl/ya/awnlyaieynoajtmb_feavw2_qke.png"><br><br>  Teruskan variabel env di php untuk memilikinya di dalam dan terhubung ke <b>PostgreSQL / Redis</b> .  File tersebut adalah <b>php / deployment.yml</b> . <br><br><img src="https://habrastorage.org/webt/ry/n9/v4/ryn9v42o_jvzafh16vr3m2rcpo4.png"><br><br>  Sebagai hasilnya, kami memiliki kluster <b>K8S</b> , yang pada tingkat dasar kami dapat meningkatkan skala, menambahkan layanan baru, server baru (node), mengubah jumlah instance <b>PostgreSQL, PHP, Nginx</b> dan hidup sebelum orang yang berbeda muncul di tim yang akan melakukan ini . <br><br>  Sebagai bagian dari catatan singkat ini, saya tidak akan menyentuh masalah cadangan / pemantauan semua hal ini.  Pada tahap awal, <b>localhost</b> akan cukup <b>: 8001 / ui</b> dari layanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dashboard K8S</a> .  Nantinya akan dimungkinkan untuk mengikat <b>Prometheus</b> , <b>Grafana</b> , <b>Barman</b> , atau solusi serupa lainnya. <br><br>  Menggunakan terminal atau <b>Teamcity</b> , <b>Jenkins</b> memperbarui kode akan melakukan sesuatu seperti ini. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     -      Teamcity docker build -t GROUP/crm-code:latest . docker push GROUP/crm-code:latest #   (  ) kubectl set image deployment/php-fpm php-fpm=GROUP/php-fpm kubectl rollout status deployment/php-fpm kubectl set image deployment/php-fpm php-fpm=GROUP/php-fpm:latest kubectl set image deployment/nginx nginx=danday74/nginx-lua kubectl rollout status deployment/nginx kubectl set image deployment/nginx nginx=danday74/nginx-lua:latest kubectl rollout status deployment/php-fpm kubectl rollout status deployment/nginx</span></span></code> </pre><br>  Saya akan senang jika itu akan menarik bagi seseorang dan dua kali lipat senang jika itu membantu siapa pun.  Terima kasih atas perhatian anda  Sekali lagi, saya melampirkan tautan ke repositori <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">satu</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dua</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423481/">https://habr.com/ru/post/id423481/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423467/index.html">Pengembang Rusia akan merilis katalog kompatibilitas produk</a></li>
<li><a href="../id423469/index.html">Nomor floating point liar barat tercepat</a></li>
<li><a href="../id423475/index.html">Meretas kode penuaan: ilmu baru tentang penuaan dan apa artinya tetap muda</a></li>
<li><a href="../id423477/index.html">Jadilah seorang ninja keamanan: mulai jalan Anda ke ketinggian IB</a></li>
<li><a href="../id423479/index.html">"Pertama": apakah akan terbang ke Mars</a></li>
<li><a href="../id423483/index.html">Menemukan Cara yang Tepat untuk Memisahkan Konten Situs Web Menggunakan Webpack</a></li>
<li><a href="../id423485/index.html">Malas memuat gambar menggunakan IntersectionObserver</a></li>
<li><a href="../id423487/index.html">Node.js tanpa node_modules</a></li>
<li><a href="../id423489/index.html">Saya seorang dokter darurat dan saya ingin berbicara tentang elektrokardiogram Apple Watch yang baru</a></li>
<li><a href="../id423491/index.html">PHP Digest No. 139 (3 - 17 September 2018)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>