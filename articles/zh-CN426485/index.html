<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜‘ ğŸŒ† ğŸ‘©ğŸ¼â€âš–ï¸ PVS-Studioè¿›è¡Œçš„ç¬¬ä¸‰æ¬¡Qt 5æµ‹è¯• ğŸ•µğŸ¼ ğŸŒ˜ ğŸ‘°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬çš„å›¢é˜Ÿä¼šä¸æ—¶åœ°é‡æ–°æ£€æŸ¥æˆ‘ä»¬å·²ç»å†™è¿‡çš„é¡¹ç›®ã€‚ å¦ä¸€ä¸ªç»è¿‡é‡æ–°æ£€æŸ¥çš„é¡¹ç›®æ˜¯Qtã€‚ æˆ‘ä»¬ä¸Šä¸€æ¬¡åœ¨2014å¹´ç”¨PVS-Studioæµ‹è¯•å®ƒã€‚ è‡ª2014å¹´ä»¥æ¥ï¼Œåœ¨Coverityçš„å¸®åŠ©ä¸‹å¼€å§‹å®šæœŸæ£€æŸ¥è¯¥é¡¹ç›®ã€‚ è¿™å¾ˆæœ‰è¶£ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦ç°åœ¨å¯ä»¥ä½¿ç”¨PVS-StudioæŸ¥æ‰¾ä»»ä½•æœ‰è¶£çš„é”™è¯¯ã€‚ 

 t 
 ä»¥å‰...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studioè¿›è¡Œçš„ç¬¬ä¸‰æ¬¡Qt 5æµ‹è¯•</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/426485/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd9/87d/907/dd987d90784865f850555bc198a97b81.png" alt="PVS-Studioå’ŒQt"></div><br> æˆ‘ä»¬çš„å›¢é˜Ÿä¼šä¸æ—¶åœ°é‡æ–°æ£€æŸ¥æˆ‘ä»¬å·²ç»å†™è¿‡çš„é¡¹ç›®ã€‚ å¦ä¸€ä¸ªç»è¿‡é‡æ–°æ£€æŸ¥çš„é¡¹ç›®æ˜¯Qtã€‚ æˆ‘ä»¬ä¸Šä¸€æ¬¡åœ¨2014å¹´ç”¨PVS-Studioæµ‹è¯•å®ƒã€‚ è‡ª2014å¹´ä»¥æ¥ï¼Œåœ¨Coverityçš„å¸®åŠ©ä¸‹å¼€å§‹å®šæœŸæ£€æŸ¥è¯¥é¡¹ç›®ã€‚ è¿™å¾ˆæœ‰è¶£ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦ç°åœ¨å¯ä»¥ä½¿ç”¨PVS-StudioæŸ¥æ‰¾ä»»ä½•æœ‰è¶£çš„é”™è¯¯ã€‚ <br><a name="habracut"></a><br><h2>  t </h2><br> ä»¥å‰çš„æ–‡ç« ï¼š <br><br><ul><li>  â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¦‚ä½•å‡å°‘åœ¨ç¼–å†™ä»£ç é˜¶æ®µå‡ºç°é”™è¯¯çš„å¯èƒ½æ€§</a> â€ï¼Œ2011å¹´7æœˆã€‚ </li><li>  â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Qt 5æ¡†æ¶æ£€æŸ¥</a> â€ï¼Œ2014å¹´4æœˆã€‚ </li></ul><br> è¿™æ¬¡æµ‹è¯•äº†<a href="">Qt Base</a> ï¼ˆCoreï¼ŒGuiï¼ŒWidgetsï¼ŒNetworkç­‰ï¼‰å’Œ<a href="">Qt5è¶…çº§æ¨¡å—</a> ã€‚ å…³äºQt Creatorï¼Œæˆ‘ä»¬è®¡åˆ’ç¨åå†å†™ä¸€ç¯‡å•ç‹¬çš„æ–‡ç« ã€‚ ä¸ºäº†è¿›è¡ŒéªŒè¯ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†PVS-Studioé™æ€åˆ†æä»ªï¼Œæ‚¨å¯ä»¥ä»ç½‘ç«™ä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹è½½</a>å…¶è¯•ç”¨ç‰ˆã€‚ <br><br> åœ¨æˆ‘çœ‹æ¥ï¼ŒQtä»£ç å·²ç»å˜å¾—æ›´å¥½ã€‚ è‡ªä¸Šæ¬¡æµ‹è¯•ä»¥æ¥ï¼Œå¤šå¹´æ¥ï¼ŒPVS-Studioåˆ†æä»ªä¸­å‡ºç°äº†è®¸å¤šæ–°çš„è¯Šæ–­æ–¹æ³•ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œåœ¨å¯¹è­¦å‘Šçš„å›é¡¾ç ”ç©¶ä¸­ï¼Œæˆ‘å‘ç°è¿™ä¸ªè§„æ¨¡çš„é¡¹ç›®æ²¡æœ‰å¤ªå¤šé”™è¯¯ã€‚ æˆ‘å†è¯´ä¸€éï¼Œè¿™æ˜¯æˆ‘ä¸ªäººçš„å°è±¡ã€‚ æˆ‘é‚£æ—¶æˆ–ç°åœ¨éƒ½æ²¡æœ‰å¯¹é”™è¯¯çš„å¯†åº¦åšä»»ä½•ç‰¹æ®Šçš„ç ”ç©¶ã€‚ <br><br> æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œä½¿ç”¨Coverityé™æ€åˆ†æå™¨è¿›è¡Œçš„å®šæœŸæ£€æŸ¥å¾ˆå¯èƒ½ä¼šå½±å“ä»£ç çš„è´¨é‡ã€‚  2014å¹´ï¼Œåœ¨Coverityçš„å¸®åŠ©ä¸‹ï¼Œå¼€å§‹æ£€æŸ¥Qté¡¹ç›®ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">qt-project</a> ï¼‰ï¼Œå¹¶åœ¨2016å¹´æ£€æŸ¥äº†Qt Creatorï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">qt-creator</a> ï¼‰ã€‚ æˆ‘çš„çœ‹æ³•ï¼šå¦‚æœæ‚¨æ­£åœ¨å¼€å‘ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œé‚£ä¹ˆ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Coverity Scan</a>å¯ä»¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å…è´¹è§£å†³æ–¹æ¡ˆï¼Œå®ƒå°†æ˜¾ç€æé«˜é¡¹ç›®çš„è´¨é‡å’Œå¯é æ€§ã€‚ <br><br> ä½†æ˜¯ï¼Œæ­£å¦‚è¯»è€…å¯ä»¥çŒœæµ‹çš„é‚£æ ·ï¼Œå¦‚æœæˆ‘æ²¡æœ‰åœ¨PVS-StudioæŠ¥å‘Šä¸­æ³¨æ„åˆ°ä»»ä½•æœ‰è¶£çš„äº‹æƒ…ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæœ‰æ–‡ç« äº†ï¼šï¼‰ã€‚ æ—¢ç„¶æœ‰ä¸€ç¯‡æ–‡ç« ï¼Œé‚£å°±æ˜¯ç¼ºé™·ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬ã€‚ æ€»å…±æˆ‘å†™å‡º96ä¸ªé”™è¯¯ã€‚ <br><br><h2> å¤åˆ¶ç²˜è´´å’Œé”™å­—ä¸æˆåŠŸ </h2><br> è®©æˆ‘ä»¬ä»æµæ´¾çš„ç»å…¸å¼€å§‹ï¼Œå½“é”™è¯¯çš„åŸå› æ˜¯æ³¨æ„åŠ›ä¸é›†ä¸­æ—¶ã€‚ è¿™äº›é”™è¯¯è¢«ç¨‹åºå‘˜ä½ä¼°äº†ã€‚ å¯¹äºé‚£äº›å°šæœªé˜…è¯»çš„äººï¼Œå»ºè®®æ‚¨é˜…è¯»ä»¥ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ€åä¸€è¡Œæ•ˆæœ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‚ªæ¶ç”Ÿæ´»åœ¨æ¯”è¾ƒåŠŸèƒ½ä¸­</a> </li></ul><br> è¿™äº›é”™è¯¯æ˜¯ä¸­é—´è¯­è¨€ã€‚ ä¾‹å¦‚ï¼Œç¬¬äºŒç¯‡æ–‡ç« æä¾›äº†è®¸å¤šç”¨Cï¼ŒC ++å’ŒCï¼ƒç¼–å†™çš„æ¯”è¾ƒå‡½æ•°ä¸­çš„é”™è¯¯ç¤ºä¾‹ã€‚ ç°åœ¨ï¼Œåœ¨PVS-Studioä¸­å®ç°Javaè¯­è¨€æ”¯æŒæ—¶ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°ç›¸åŒçš„é”™è¯¯æ¨¡å¼ã€‚ ä¾‹å¦‚ï¼Œè¿™æ˜¯æˆ‘ä»¬æœ€è¿‘åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Hibernate</a>åº“ä¸­å‘ç°çš„é”™è¯¯ï¼š <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object other)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (other instanceof Id) { Id that = (Id) other; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> purchaseSequence.equals(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.purchaseSequence) &amp;&amp; that.purchaseNumber == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.purchaseNumber; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br> å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œç»“æœæ˜¯å°†<i>purchaseSequence</i>å­—æ®µä¸å…¶è‡ªèº«è¿›è¡Œäº†æ¯”è¾ƒã€‚ æ­£ç¡®çš„é€‰é¡¹ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> that.purchaseSequence.equals(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.purchaseSequence) &amp;&amp; that.purchaseNumber == <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.purchaseNumber;</code> </pre> <br> æ€»çš„æ¥è¯´ï¼Œä¸€åˆ‡éƒ½ä¸€å¦‚æ—¢å¾€ï¼ŒPVS-Studioåˆ†æä»ªå°†ä¸å¾—ä¸åœ¨Javaé¡¹ç›®ä¸­â€œå¤ºå–Augeané©¬â€œâ€ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘ä»¬é‚€è¯·æ‰€æœ‰äººå‚åŠ æµ‹è¯•PVS-Studio for Javaçš„Betaç‰ˆï¼Œè¯¥ç‰ˆæœ¬å°†åœ¨ä¸ä¹…çš„å°†æ¥å‡ºç°ã€‚ ä¸ºæ­¤ï¼Œè¯·<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å†™ä¿¡ç»™æˆ‘ä»¬</a> ï¼ˆé€‰æ‹©â€œæˆ‘æƒ³è¦Javaçš„åˆ†æå™¨â€ï¼‰ã€‚ <br><br> ç°åœ¨å›åˆ°Qté¡¹ç›®ä¸­çš„é”™è¯¯ã€‚ <br><br>  <b>ç¼ºé™·N1</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">windowDpiAwareness</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HWND hwnd)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QWindowsContext::user32dll.getWindowDpiAwarenessContext &amp;&amp; QWindowsContext::user32dll.getWindowDpiAwarenessContext ? QWindowsContext::user32dll.getAwarenessFromDpiAwarenessContext( QWindowsContext::user32dll.getWindowDpiAwarenessContext(hwnd)) : <span class="hljs-number"><span class="hljs-number">-1</span></span>; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV501 CWE-571åœ¨'&amp;&amp;'è¿ç®—ç¬¦çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼'QWindowsContext :: user32dll.getWindowDpiAwarenessContext'ã€‚  qwindowscontext.cpp 150 <br><br> é™¤äº†åˆ†æä»ªæ¶ˆæ¯å¤–ï¼Œæ­¤å¤„ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šè¯´æ˜ã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œè¯¥è¡¨è¾¾å¼åº”è¯¥åƒè¿™æ ·ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QWindowsContext::user32dll.getAwarenessFromDpiAwarenessContext &amp;&amp; QWindowsContext::user32dll.getWindowDpiAwarenessContext ? QWindowsContext::user32dll.getAwarenessFromDpiAwarenessContext( QWindowsContext::user32dll.getWindowDpiAwarenessContext(hwnd)) : <span class="hljs-number"><span class="hljs-number">-1</span></span>;</code> </pre> <br>  <b>ç¼ºé™·N2ï¼ŒN3</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QReadWriteLockPrivate::release() { Q_ASSERT(!recursive); Q_ASSERT(!waitingReaders &amp;&amp; !waitingReaders &amp;&amp; !readerCount &amp;&amp; !writerCount); freelist-&gt;release(id); }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV501 CWE-571'&amp;&amp;'è¿ç®—ç¬¦çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼ï¼šï¼WaitingReaders &amp;&amp; !! WaitingReaders qreadwritelock.cpp 632 <br><br> è¯¥é”™è¯¯åœ¨<i>Q_ASSERT</i>å®<i>æ¡ä»¶</i>å†…éƒ¨ï¼Œå› æ­¤ä¸é‡è¦ã€‚ ä½†è¿™ä»ç„¶æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚  <i>ä»”ç»†</i>æ£€æŸ¥äº†<i>waitingReaders</i>å˜é‡ã€‚ æ˜¾ç„¶ä»–ä»¬å¿˜è®°äº†æ£€æŸ¥å…¶ä»–å˜é‡ã€‚ <br><br> åœ¨qreadwritelock.cppæ–‡ä»¶çš„625è¡Œä¸­å‘ç°äº†ç›¸åŒçš„é”™è¯¯ã€‚ å¤åˆ¶ç²˜è´´ä¸‡å²ï¼  :) <br><br>  <b>ç¼ºé™·N4</b> <br><br><pre> <code class="cpp hljs">QString QGraphicsSceneBspTree::debug(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node-&gt;type == Node::Horizontal) { tmp += debug(firstChildIndex(index)); tmp += debug(firstChildIndex(index) + <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { tmp += debug(firstChildIndex(index)); tmp += debug(firstChildIndex(index) + <span class="hljs-number"><span class="hljs-number">1</span></span>); } .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV523 CWE-691'then'è¯­å¥ç­‰æ•ˆäº'else'è¯­å¥ã€‚  qgraphicsscene_bsp.cpp 179 <br><br> æœ€æœ‰å¯èƒ½å¤åˆ¶äº†è¯¥æ–‡æœ¬å—ï¼Œä½†ä»–ä»¬å¿˜è®°äº†å¯¹å…¶è¿›è¡Œæ›´æ­£ã€‚ <br><br>  <b>ç¼ºé™·N5</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> FillRule { OddEvenFill, WindingFill }; QDataStream &amp;<span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>&gt;&gt;(QDataStream &amp;s, QPainterPath &amp;p) { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fillRule; s &gt;&gt; fillRule; Q_ASSERT(fillRule == Qt::OddEvenFill || Qt::WindingFill); .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV768 CWE-571æšä¸¾å¸¸é‡'WindingFill'ç”¨ä½œå¸ƒå°”å‹å˜é‡ã€‚  qpainterpath.cpp 2479 <br><br> åŒæ„ï¼Œè¿™æ˜¯ä¸€ä¸ªç¾ä¸½çš„å®¶ä¼™ï¼  <i>Q_ASSERT</i>ä¸æ£€æŸ¥ä»»ä½•å†…å®¹ï¼Œå› ä¸ºæ¡ä»¶å§‹ç»ˆä¸ºtrueã€‚ æ¡ä»¶æˆç«‹ï¼Œå› ä¸ºå‘½åå¸¸é‡<i>Qt :: WindingFill</i>ä¸º1ã€‚ <br><br>  <b>ç¼ºé™·N6</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QVariant::canConvert(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> targetTypeId) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == QMetaType::SChar || currentType == QMetaType::Char) currentType = QMetaType::UInt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (targetTypeId == QMetaType::SChar || currentType == QMetaType::Char) targetTypeId = QMetaType::UInt; .... }</code> </pre> <br> é˜…è¯»è­¦å‘Šä¹‹å‰ï¼Œè¯·å°è¯•è‡ªå·±æ‰¾å‡ºä¸€ä¸ªé”™å­—ã€‚ é€šè¿‡æ·»åŠ å›¾ç‰‡ï¼Œæˆ‘å°†å¸®åŠ©æ‚¨ä¸è¦ç«‹å³é˜…è¯»åˆ†æå™¨æ¶ˆæ¯:)ã€‚ <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/86f/f1d/7c5/86ff1d7c55cdc0fb71cbce45f2f84f05.png" alt="è¯¥æ€è€ƒäº†"></div><br><br>  PVS-Studioè­¦å‘Šï¼šV560 CWE-570æ¡ä»¶è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†å§‹ç»ˆä¸ºfalseï¼šcurrentType == QMetaType :: Charã€‚  qvariant.cpp 3529 <br><br> åœ¨æ¡ä»¶<i>if</i>ä¸­é¦–å…ˆæ£€æŸ¥æ¡ä»¶â€œ currentType == QMetaType :: Charâ€ã€‚ å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸ºå˜é‡<i>currentType</i>åˆ†é…å€¼<i>QMetaType :: UInt</i> ã€‚ å› æ­¤ï¼Œå˜é‡<i>currentType</i>ä¸å†å¯ä»¥ç­‰äº<i>QMetaType :: Char</i> ã€‚ å› æ­¤ï¼Œåˆ†æå™¨æŠ¥å‘Šç¬¬äºŒä¸ªå­è¡¨è¾¾å¼â€œ currentType == QMetaType :: Charâ€å§‹ç»ˆä¸ºå‡ã€‚ <br><br> å®é™…ä¸Šï¼Œç¬¬äºŒä¸ª<i>if</i>åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (targetTypeId == QMetaType::SChar || targetTypeId == QMetaType::Char) targetTypeId = QMetaType::UInt;</code> </pre> <br><br>  <b>V560è¯Šæ–­è¯´æ˜</b> <br><br> è¯¥æŠ¥å‘Šå‘ç°äº†è®¸å¤šV560è­¦å‘Šã€‚ ä½†æ˜¯ï¼Œä¸€æ—¦å‘ç°è¿™ç¯‡æ–‡ç« çš„æœ‰è¶£æ¡ˆä¾‹ï¼Œæˆ‘å°±ä¸å†æŸ¥çœ‹å®ƒä»¬äº†ï¼Œè¯¥æ¡ˆä¾‹åœ¨ä¸Šé¢è¢«è®¤ä¸ºæ˜¯ç¼ºé™·N6ã€‚ <br><br> ç»å¤§å¤šæ•°æ¶ˆæ¯V560ä¸èƒ½è¢«ç§°ä¸ºå‡ï¼Œä½†æ˜¯å®ƒä»¬æ²¡æœ‰ç”¨ã€‚ æ¢å¥è¯è¯´ï¼Œåœ¨æ–‡ç« ä¸­æè¿°å®ƒä»¬å¹¶ä¸æœ‰è¶£ã€‚ ä¸ºäº†å¼„æ¸…æ¥šæˆ‘åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Œè¯·è€ƒè™‘ä¸€ç§è¿™æ ·çš„æƒ…å†µã€‚ <br><br><pre> <code class="cpp hljs">QString QTextHtmlExporter::findUrlForImage(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QTextDocument *doc, ....) { QString url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!doc) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (QTextDocument *parent = qobject_cast&lt;QTextDocument *&gt;(doc-&gt;parent())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> findUrlForImage(parent, cacheKey, isPixmap); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doc &amp;&amp; doc-&gt;docHandle()) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br> è­¦å‘ŠPVS-Stuidioï¼šV560 CWE-571æ¡ä»¶è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†å§‹ç»ˆä¸ºtrueï¼šdocã€‚  qtextdocument.cpp 2992 <br><br> åˆ†æå™¨æ˜¯ç»å¯¹æ­£ç¡®çš„ï¼Œå®ƒåœ¨é‡æ–°æ£€æŸ¥æ—¶<i>doc</i>æŒ‡é’ˆå¹¶ä¸æ€»æ˜¯ä¸º<i>nullptr</i> ã€‚ ä½†è¿™ä¸æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œåªæ˜¯ç¨‹åºå‘˜æ˜¯å®‰å…¨çš„ã€‚ æ‚¨å¯ä»¥é€šè¿‡ç¼–å†™ä»¥ä¸‹ä»£ç æ¥ç®€åŒ–ä»£ç ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doc-&gt;docHandle()) {</code> </pre> <br>  <b>ç¼ºé™·N7</b> <br><br> æœ€åä¸€ç§æƒ…å†µï¼Œå¯ä»¥å½’ç±»ä¸ºé”™åˆ«å­—ã€‚ å‡ºç°é”™è¯¯æ˜¯ç”±äºå¸¸é‡åç§°æ··ä¹±ï¼Œä»…åœ¨é¦–å­—æ¯ä¸åŒçš„æƒ…å†µä¸‹ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QWindowsCursor</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> QPlatformCursor { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> CursorState { CursorShowing, CursorHidden, CursorSuppressed }; .... } QWindowsCursor::CursorState QWindowsCursor::cursorState() { <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { cursorShowing = <span class="hljs-number"><span class="hljs-number">0x1</span></span>, cursorSuppressed = <span class="hljs-number"><span class="hljs-number">0x2</span></span> }; CURSORINFO cursorInfo; cursorInfo.cbSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(CURSORINFO); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GetCursorInfo(&amp;cursorInfo)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cursorInfo.flags &amp; CursorShowing) .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV616 CWE-480åœ¨æŒ‰ä½æ“ä½œä¸­ä½¿ç”¨åä¸ºâ€œ CursorShowingâ€çš„å¸¸é‡ï¼Œå€¼ä¸º0ã€‚  qwindowscursor.cpp 669 <br><br> æ›´è¯¦ç»†åœ°è®²ï¼Œæˆ‘å·²ç»åœ¨ä¸€ä¸ªå•ç‹¬çš„å°ç¬”è®°ä¸­åˆ†æäº†æ­¤é”™è¯¯ï¼šâ€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å†æ¬¡è¯æ˜ï¼ŒPVS-Studioåˆ†æä»ª</a>æ¯”<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äººæ›´ä¸“å¿ƒ</a> ã€‚â€ <br><br><h2> å®‰å…¨æ¼æ´ </h2><br> å®é™…ä¸Šï¼Œæœ¬æ–‡ä¸­è®¨è®ºçš„æ‰€æœ‰é”™è¯¯éƒ½å¯ä»¥ç§°ä¸ºå®‰å…¨ç¼ºé™·ã€‚ å®ƒä»¬å‡æ ¹æ®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¸¸è§å¼±ç‚¹æšä¸¾</a>è¿›è¡Œåˆ†ç±»ï¼ˆè¯·å‚é˜…åˆ†æå™¨æ¶ˆæ¯ä¸­çš„CWE IDï¼‰ã€‚ å¦‚æœå°†é”™è¯¯åˆ†ç±»ä¸ºCWEï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚ åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio SASTé¡µ</a>ä¸Šå¯¹æ­¤è¿›è¡Œäº†è¯¦ç»†è¯´æ˜ã€‚ <br><br> ä½†æ˜¯ï¼Œæˆ‘æƒ³å°†ä¸€äº›é”™è¯¯å½’ä¸ºä¸€ä¸ªå•ç‹¬çš„å°ç»„ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬ã€‚ <br><br>  <b>ç¼ºé™·N8ï¼ŒN9</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QLocalServerPrivate::addListener() { .... SetSecurityDescriptorOwner(pSD.data(), pTokenUser-&gt;User.Sid, FALSE); SetSecurityDescriptorGroup(pSD.data(), pTokenGroup-&gt;PrimaryGroup, FALSE); .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <br><br><ul><li>  V530 CWE-252éœ€è¦ä½¿ç”¨å‡½æ•°'SetSecurityDescriptorOwner'çš„è¿”å›å€¼ã€‚  qlocalserver_win.cpp 167 </li><li>  V530 CWE-252éœ€è¦ä½¿ç”¨åŠŸèƒ½'SetSecurityDescriptorGroup'çš„è¿”å›å€¼ã€‚  qlocalserver_win.cpp 168 </li></ul><br> æœ‰ä¸è®¿é—®æ§åˆ¶æœ‰å…³çš„å„ç§åŠŸèƒ½ã€‚ å‡½æ•°<i>SetSecurityDescriptorOwner</i>å’Œ<i>SetSecurityDescriptorGroup</i>å°±åœ¨å…¶ä¸­ã€‚ <br><br> ä½¿ç”¨æ­¤ç±»åŠŸèƒ½ï¼Œæ‚¨éœ€è¦éå¸¸å°å¿ƒåœ°å·¥ä½œã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¿…é¡»æ£€æŸ¥å®ƒä»¬è¿”å›çš„çŠ¶æ€ã€‚ å¦‚æœå¯¹è¿™äº›å‡½æ•°çš„è°ƒç”¨å¤±è´¥ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ çŒœæµ‹ä¸æ˜¯å¿…éœ€çš„ï¼Œæœ‰å¿…è¦ç¼–å†™ä»£ç æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚ <br><br> ä¸å¿…åˆ©ç”¨ç¼ºä¹éªŒè¯çš„ä¼˜åŠ¿å¹¶å°†æ­¤ç±»é”™è¯¯è½¬åŒ–ä¸ºæ¼æ´ã€‚ ä½†æ˜¯ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å­˜åœ¨é£é™©ï¼Œæ‚¨éœ€è¦ç¼–å†™æ›´å®‰å…¨çš„ä»£ç ã€‚ <br><br>  <b>ç¼ºé™·N10</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QLocalServerPrivate::addListener() { .... InitializeAcl(acl, aclSize, ACL_REVISION_DS); .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV530 CWE-252éœ€è¦ä½¿ç”¨å‡½æ•°â€œ InitializeAclâ€çš„è¿”å›å€¼ã€‚  qlocalserver_win.cpp 144 <br><br> è¿™ç§æƒ…å†µç±»ä¼¼äºä¸Šé¢è®¨è®ºçš„æƒ…å†µã€‚ <br><br>  <b>ç¼ºé™·N11ï¼ŒN12</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sha1ProcessChunk</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... quint8 chunkBuffer[<span class="hljs-number"><span class="hljs-number">64</span></span>]; .... <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> SHA1_WIPE_VARIABLES .... memset(chunkBuffer, 0, 64); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> }</span></span></code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV597 CWE-14ç¼–è¯‘å™¨å¯èƒ½ä¼šåˆ é™¤â€œ memsetâ€å‡½æ•°è°ƒç”¨ï¼Œè¯¥å‡½æ•°è°ƒç”¨ç”¨äºåˆ·æ–°â€œ chunkBufferâ€ç¼“å†²åŒºã€‚  RtlSecureZeroMemoryï¼ˆï¼‰å‡½æ•°åº”ç”¨äºæ“¦é™¤ç§æœ‰æ•°æ®ã€‚ ç¬¬189ç«  <br><br> ç¼–è¯‘å™¨å°†åˆ é™¤<i>memset</i>å‡½æ•°è°ƒç”¨ã€‚ æˆ‘å·²ç»åœ¨æ–‡ç« ä¸­å¤šæ¬¡åˆ†æäº†è¿™ç§æƒ…å†µã€‚ æˆ‘ä¸æƒ³é‡å¤è‡ªå·±ã€‚ æˆ‘æŒ‡çš„æ˜¯â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®‰å…¨æ¸…é™¤ç§æœ‰æ•°æ®</a> â€ä¸€æ–‡ã€‚ <br><br> å¦ä¸€ä¸ªé”™è¯¯æ˜¯åœ¨åŒä¸€ä¸ªsha1.cppæ–‡ä»¶ä¸­ï¼Œåœ¨ç¬¬247è¡Œã€‚ <br><br><h2> ç©ºæŒ‡é’ˆ </h2><br> ç°åœ¨è¯¥è°ˆè®ºæŒ‡é’ˆäº†ã€‚ åœ¨è¿™ä¸ªè¯é¢˜ä¸Šæœ‰å¾ˆå¤šé”™è¯¯ã€‚ <br><br>  <b>ç¼ºé™·N13</b> <br><br><pre> <code class="cpp hljs">QByteArray &amp;QByteArray::append(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *str, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> len) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (len &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) len = qstrlen(str); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str &amp;&amp; len) { .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV595 CWE-476åœ¨é’ˆå¯¹nullptrè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'str'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š2118ï¼Œ2119ã€‚qbytearray.cpp 2118 <br><br> å…¸å‹çš„æƒ…å†µæ˜¯ï¼Œåœ¨å¼€å§‹æ—¶ä½¿ç”¨æŒ‡é’ˆï¼Œç„¶åæ£€æŸ¥<i>nullptræ˜¯å¦</i>ç›¸ç­‰ã€‚ è¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„é”™è¯¯æ¨¡å¼ï¼Œæˆ‘ä»¬å‡ ä¹åœ¨æ‰€æœ‰é¡¹ç›®ä¸­éƒ½ç»å¸¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çœ‹åˆ°</a>å®ƒã€‚ <br><br>  <b>ç¼ºé™·N14ï¼ŒN15</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> QMetaObjectPrivate *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">priv</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> uint* data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">reinterpret_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QMetaObjectPrivate*&gt;(data); } <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QMetaEnum::isFlag() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = priv(mobj-&gt;d.data)-&gt;revision &gt;= <span class="hljs-number"><span class="hljs-number">8</span></span> ? <span class="hljs-number"><span class="hljs-number">2</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mobj &amp;&amp; mobj-&gt;d.data[handle + offset] &amp; EnumIsFlag; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV595 CWE-476åœ¨é’ˆå¯¹nullptrè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'mobj'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š2671ï¼Œ2672ã€‚qmetaobject.cpp 2671 <br><br> ä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘å¸¦æ¥äº†<i>priv</i>å‡½æ•°çš„ä¸»ä½“ã€‚ ç”±äºæŸäº›åŸå› ï¼Œæœ‰æ—¶è¯»è€…ä¼šæƒ³å‡ºä»£ç å¯ä»¥å·¥ä½œçš„æƒ…å†µã€‚ æˆ‘ä¸çŸ¥é“è¿™ç§ä¸ä¿¡ä»»æ¥è‡ªä½•å¤„ï¼Œä¹Ÿä¸å¸Œæœ›çœ‹åˆ°é”™è¯¯çš„æ£˜æ‰‹åŠŸèƒ½:)ã€‚ ä¾‹å¦‚ï¼ŒæŸäººå¯èƒ½åœ¨è¯„è®ºä¸­å»ºè®®<i>priv</i>æ˜¯ä»¥ä¸‹å½¢å¼çš„å®ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> priv(A) foo(sizeof(A))</span></span></code> </pre> <br> ç„¶åä¸€åˆ‡éƒ½ä¼šæ­£å¸¸ã€‚ <br><br> ä¸ºäº†é¿å…æ­¤ç±»è®¨è®ºï¼Œæˆ‘å°è¯•å¼•ç”¨ä»£ç ç‰‡æ®µï¼Œå…¶ä¸­æä¾›äº†æ‰€æœ‰ç¡®è®¤é”™è¯¯å­˜åœ¨çš„ä¿¡æ¯ã€‚ <br><br> å› æ­¤ï¼Œ <i>modj</i>æŒ‡é’ˆ<i>è¢«</i>å–æ¶ˆå¼•ç”¨ï¼Œç„¶åæ£€æŸ¥ã€‚ <br><br> ç°åœºè¿˜å‡ºç°äº†â€œå¼ºå¤§è€Œå¯æ€•çš„â€å¤åˆ¶ç²˜è´´ã€‚ ç”±äºåœ¨<i>isScoped</i>å‡½æ•°ä¸­æ£€æµ‹åˆ°å®Œå…¨ç›¸åŒçš„é”™è¯¯ï¼Œå› æ­¤ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QMetaEnum::isScoped() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = priv(mobj-&gt;d.data)-&gt;revision &gt;= <span class="hljs-number"><span class="hljs-number">8</span></span> ? <span class="hljs-number"><span class="hljs-number">2</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mobj &amp;&amp; mobj-&gt;d.data[handle + offset] &amp; EnumIsScoped; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV595 CWE-476åœ¨é’ˆå¯¹nullptrè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'mobj'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š2683ã€2684ã€‚qmetaobject.cpp 2683 <br><br>  <b>ç¼ºé™·N16-N21</b> <br><br> è€ƒè™‘å¦ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘è®¤ä¸ºè¶³å¤Ÿäº†ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QTextCursor::insertFragment(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QTextDocumentFragment &amp;fragment) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!d || !d-&gt;priv || fragment.isEmpty()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; d-&gt;priv-&gt;beginEditBlock(); d-&gt;remove(); fragment.d-&gt;insert(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); d-&gt;priv-&gt;endEditBlock(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fragment.d &amp;&amp; fragment.d-&gt;doc) d-&gt;priv-&gt;mergeCachedResources(fragment.d-&gt;doc-&gt;docHandle()); }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV595 CWE-476åœ¨å¯¹nullptrè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'fragment.d'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š2238ã€2241ã€‚qtextcursor.cpp 2238 <br><br> éƒ½ä¸€æ · æ³¨æ„å­˜å‚¨åœ¨å˜é‡<i>fragment.dä¸­</i>çš„æŒ‡é’ˆçš„å·¥ä½œé¡ºåºã€‚ <br><br> æ­¤ç±»å‹çš„å…¶ä»–é”™è¯¯ï¼š <br><br><ul><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptréªŒè¯ä¹‹å‰ä½¿ç”¨äº†â€œçª—å£â€æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š1846ã€1848ã€‚qapplication.cpp 1846 </li><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptréªŒè¯ä¹‹å‰ä½¿ç”¨äº†â€œçª—å£â€æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š1858ã€1860ã€‚qapplication.cpp 1858 </li><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptrè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†â€œç­”å¤â€æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š492ã€502ã€‚qhttpnetworkconnectionchannel.cpp 492 </li><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptrå¯¹å…¶è¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'newHandle'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š877ï¼Œ883ã€‚qsplitter.cpp 877 </li><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptrå¯¹å…¶è¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†â€œå°éƒ¨ä»¶â€æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š2320ã€2322ã€‚qwindowsvistastyle.cpp 2320 </li><li> å®é™…ä¸Šï¼Œè¿˜æœ‰æ›´å¤šé”™è¯¯ã€‚ æˆ‘å¾ˆå¿«å°±åŒå€¦äº†å­¦ä¹ V595è­¦å‘Šï¼Œå¯¹äºè¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å·²ç»å†™å‡ºäº†è¶³å¤Ÿçš„ä»£ç ç‰‡æ®µã€‚ </li></ul><br>  <b>ç¼ºé™·N22-N33</b> <br><br> åœ¨ä»£ç ä¸­æ£€æŸ¥äº†<i>æ–°</i>æ“ä½œç¬¦è¿”å›çš„æŒ‡é’ˆã€‚ åœ¨å¾ˆå¤šåœ°æ–¹ä¸æ£€æŸ¥<i>malloc</i>å‡½æ•°ç»“æœçš„æƒ…å†µä¸‹ï¼Œè¿™å°¤å…¶æœ‰è¶£ï¼ˆè¯·å‚é˜…ä»¥ä¸‹é”™è¯¯ç»„ï¼‰ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QTranslatorPrivate::do_load(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QString &amp;realname, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QString &amp;directory) { .... d-&gt;unmapPointer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[d-&gt;unmapLength]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (d-&gt;unmapPointer) { file.seek(<span class="hljs-number"><span class="hljs-number">0</span></span>); qint64 readResult = file.read(d-&gt;unmapPointer, d-&gt;unmapLength); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (readResult == qint64(unmapLength)) ok = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV668 CWE-571å¯¹'d-&gt; unmap Pointer'æŒ‡é’ˆé’ˆå¯¹nullè¿›è¡Œæµ‹è¯•æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºä½¿ç”¨'new'è¿ç®—ç¬¦åˆ†é…äº†å†…å­˜ã€‚ å¦‚æœå†…å­˜åˆ†é…é”™è¯¯ï¼Œå°†ç”Ÿæˆå¼‚å¸¸ã€‚  qtranslator.cpp 596 <br><br> æ£€æŸ¥æŒ‡é’ˆæ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºåœ¨å‘ç”Ÿå†…å­˜åˆ†é…é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œå°†<i>å¼•å‘</i>å¼‚å¸¸<i>std :: bad_alloc</i> ã€‚ å¦‚æœè¦è®©<i>æ–°</i>è¿ç®—ç¬¦åœ¨æ²¡æœ‰è¶³å¤Ÿå†…å­˜çš„æƒ…å†µä¸‹è¿”å›<i>nullptr</i> ï¼Œåˆ™åº”ç¼–å†™ï¼š <br><br><pre> <code class="cpp hljs">d-&gt;unmapPointer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::nothrow) <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[d-&gt;unmapLength];</code> </pre> <br> åˆ†æå™¨çŸ¥é“ä½¿ç”¨<i>æ–°</i>è¿ç®—ç¬¦çš„æƒ…å†µï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ä¼šå‘å‡ºè­¦å‘Šã€‚ <br><br> å…¶ä»–é”™è¯¯ï¼šæˆ‘å°†ç»™ä»–ä»¬<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">qt-V668.txtæ–‡ä»¶</a> ã€‚ <br><br>  <b>ç¼ºé™·N34-N70</b> <br><br> å¦‚æ‰€æ‰¿è¯ºçš„ï¼Œç°åœ¨è½®åˆ°å®ƒä»¬ä¸æ£€æŸ¥è°ƒç”¨<i>malloc</i> ï¼Œ <i>calloc</i> ï¼Œ <i>strdup</i>ç­‰å‡½æ•°çš„ç»“æœæ—¶äº†ã€‚ è¿™äº›é”™è¯¯æ¯”ä¹çœ‹ä¹‹ä¸‹è¦ä¸¥é‡å¾—å¤šã€‚ æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼šâ€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ£€æŸ¥mallocå‡½æ•°è¿”å›ä»€ä¹ˆä¸ºä»€ä¹ˆå¾ˆé‡è¦</a> ã€‚â€ <br><br><pre> <code class="cpp hljs">SourceFiles::SourceFiles() { nodes = (SourceFileNode**)<span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SourceFileNode*)*(num_nodes=<span class="hljs-number"><span class="hljs-number">3037</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; num_nodes; n++) nodes[n] = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV522 CWE-690å¯èƒ½ä¼šå–æ¶ˆå¼•ç”¨æ½œåœ¨çš„ç©ºæŒ‡é’ˆâ€œèŠ‚ç‚¹â€ã€‚ æ£€æŸ¥è¡Œï¼š138ï¼Œ136ã€‚makefiledeps.cpp 138 <br><br> è¯¥æŒ‡é’ˆæ— éœ€äº‹å…ˆéªŒè¯å³å¯ä½¿ç”¨ã€‚ <br><br> æ‰€æœ‰è¿™äº›é”™è¯¯å±äºåŒä¸€ç±»å‹ï¼Œå› æ­¤æˆ‘å°†ä¸å¯¹å…¶è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚ æˆ‘å°†ç»™å‡ºå…¶ä»–è­¦å‘Šåˆ—è¡¨ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">qt-V522-V575.txt</a> ã€‚ <br><br><h2> æ¡ä»¶ä¸­çš„é€»è¾‘é”™è¯¯ </h2><br>  <b>ç¼ºé™·N71</b> <br><br><pre> <code class="cpp hljs">QString QEdidParser::parseEdidString(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> quint8 *data) { <span class="hljs-function"><span class="hljs-function">QByteArray </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buffer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">reinterpret_cast</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *&gt;(data), </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">13</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// Erase carriage return and line feed buffer = buffer.replace('\r', '\0').replace('\n', '\0'); // Replace non-printable characters with dash for (int i = 0; i &lt; buffer.count(); ++i) { if (buffer[i] &lt; '\040' &amp;&amp; buffer[i] &gt; '\176') buffer[i] = '-'; } return QString::fromLatin1(buffer.trimmed()); }</span></span></code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV547 CWE-570è¡¨è¾¾å¼'buffer [i] &lt;'\ 040'&amp;&amp; buffer [i]&gt;'\ 176'å§‹ç»ˆä¸ºå‡ã€‚  qedidparser.cpp 169 <br><br> è¯¥åŠŸèƒ½å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ“ä½œâ€œç”¨ç ´æŠ˜å·æ›¿æ¢ä¸å¯æ‰“å°çš„å­—ç¬¦â€ã€‚ ä½†æ˜¯ï¼Œå¥¹æ²¡æœ‰ã€‚ è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™ç§æƒ…å†µï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[i] &lt; <span class="hljs-string"><span class="hljs-string">'\040'</span></span> &amp;&amp; buffer[i] &gt; <span class="hljs-string"><span class="hljs-string">'\176'</span></span>)</code> </pre> <br> è¿™æ²¡æœ‰é“ç†ã€‚ å­—ç¬¦ä¸èƒ½åŒæ—¶å°äºâ€œ \ 040â€å¹¶å¤§äºâ€œ \ 176â€ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»ä½¿ç”¨è¿ç®—ç¬¦â€œ ||â€ã€‚ æ­£ç¡®çš„ä»£ç æ˜¯ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[i] &lt; <span class="hljs-string"><span class="hljs-string">'\040'</span></span> || buffer[i] &gt; <span class="hljs-string"><span class="hljs-string">'\176'</span></span>)</code> </pre> <br>  <b>ç¼ºé™·N72</b> <br><br> ç”±äºWindowsç”¨æˆ·ä¸èµ°è¿ï¼Œå‡ºç°äº†ç±»ä¼¼çš„é”™è¯¯ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(Q_OS_WIN) static QString driveSpec(const QString &amp;path) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (path.size() </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; 2) return QString(); char c = path.at(0).toLatin1(); if (c &lt; 'a' &amp;&amp; c &gt; 'z' &amp;&amp; c &lt; 'A' &amp;&amp; c &gt; 'Z') return QString(); if (path.at(1).toLatin1() != ':') return QString(); return path.mid(0, 2); } #endif</span></span></span></span></code> </pre> <br> åˆ†æä»ªç«‹å³ç”Ÿæˆä¸¤ä¸ªè­¦å‘Šï¼š <br><br><ul><li>  V590 CWE-571è€ƒè™‘æ£€æŸ¥'c &lt;'a'&amp;&amp; c&gt;'z'&amp;&amp; c &lt;'A'&amp;&amp; c&gt;'Z''è¡¨è¾¾å¼ã€‚ è¡¨è¾¾å¼è¿‡å¤šæˆ–æ‰“å°é”™è¯¯ã€‚  qdir.cpp 77 </li><li>  V560 CWE-570æ¡ä»¶è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†å§‹ç»ˆä¸ºfalseï¼šc&gt;'z'ã€‚  qdir.cpp 77 </li></ul><br> é€»è¾‘é”™è¯¯å¤„äºä»¥ä¸‹æƒ…å†µï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c &lt; <span class="hljs-string"><span class="hljs-string">'a'</span></span> &amp;&amp; c &gt; <span class="hljs-string"><span class="hljs-string">'z'</span></span> &amp;&amp; c &lt; <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; c &gt; <span class="hljs-string"><span class="hljs-string">'Z'</span></span>)</code> </pre> <br> æ®æˆ‘äº†è§£ï¼Œç¨‹åºå‘˜å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªä¸æ˜¯æ‹‰ä¸å­—æ¯çš„å­—ç¬¦ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¡ä»¶åº”å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((c &lt; <span class="hljs-string"><span class="hljs-string">'a'</span></span> || c &gt; <span class="hljs-string"><span class="hljs-string">'z'</span></span>) &amp;&amp; (c &lt; <span class="hljs-string"><span class="hljs-string">'A'</span></span> || c &gt; <span class="hljs-string"><span class="hljs-string">'Z'</span></span>))</code> </pre> <br>  <b>ç¼ºé™·N73</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> SelectionMode { NoSelection, SingleSelection, MultiSelection, ExtendedSelection, ContiguousSelection }; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QAccessibleTableCell::unselectCell() { QAbstractItemView::SelectionMode selectionMode = view-&gt;selectionMode(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!m_index.isValid() || (selectionMode &amp; QAbstractItemView::NoSelection)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV616 CWE-480åœ¨æŒ‰ä½è¿ç®—ä¸­ä½¿ç”¨åä¸ºâ€œ QAbstractItemView :: NoSelectionâ€çš„å¸¸é‡ï¼ˆå€¼ä¸º0ï¼‰ã€‚  itemviews.cpp 976 <br><br> å‘½åå¸¸é‡<i>QAbstractItemView :: NoSelection</i>ä¸ºé›¶ã€‚ å› æ­¤ï¼Œå­è¡¨è¾¾å¼<i>ï¼ˆselectionModeå’ŒQAbstractItemView :: NoSelectionï¼‰</i>æ²¡æœ‰æ„ä¹‰ã€‚ æ°¸è¿œä¸º0ã€‚ <br><br> æˆ‘è®¤ä¸ºåº”è¯¥åœ¨è¿™é‡Œå†™ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!m_index.isValid() || (selectionMode == QAbstractItemView::NoSelection))</code> </pre> <br>  <b>ç¼ºé™·N74</b> <br><br> ä»¥ä¸‹ä»£ç ä½¿æˆ‘éš¾ä»¥ç†è§£ã€‚ ä»–é”™äº†ï¼Œä½†æˆ‘ä¸çŸ¥é“ä»–åº”è¯¥æ˜¯ä»€ä¹ˆã€‚ å¯¹å‡½æ•°è¿›è¡Œæ³¨é‡Šä¹Ÿæ— æµäºäº‹ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Re-engineered from the inline function _com_error::ErrorMessage(). // We cannot use it directly since it uses swprintf_s(), which is not // present in the MSVCRT.DLL found on Windows XP (QTBUG-35617). static inline QString errorMessageFromComError(const _com_error &amp;comError) { TCHAR *message = nullptr; FormatMessage( FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM, NULL, DWORD(comError.Error()), MAKELANGID(LANG_NEUTRAL,SUBLANG_DEFAULT), message, 0, NULL); if (message) { const QString result = QString::fromWCharArray(message).trimmed(); LocalFree(static_cast&lt;HLOCAL&gt;(message)); return result; } if (const WORD wCode = comError.WCode()) return QString::asprintf("IDispatch error #%u", uint(wCode)); return QString::asprintf("Unknown error 0x0%x", uint(comError.Error())); }</span></span></code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV547 CWE-570è¡¨è¾¾å¼â€œæ¶ˆæ¯â€å§‹ç»ˆä¸ºå‡ã€‚  qwindowscontext.cpp 802 <br><br> ç¨‹åºå‘˜å¯èƒ½å‡è®¾<i>FormatMessage</i>å‡½æ•°å°†æ›´æ”¹<i>æ¶ˆæ¯</i>æŒ‡é’ˆçš„å€¼ã€‚ ä½†æ˜¯äº‹å®å¹¶éå¦‚æ­¤ã€‚  <i>FormatMessageå‡½æ•°</i>ä¸èƒ½æ›´æ”¹æŒ‡é’ˆçš„å€¼ï¼Œå› ä¸ºå®ƒæ˜¯æŒ‰å€¼ä¼ é€’ç»™å‡½æ•°çš„ã€‚ è¿™æ˜¯æ­¤å‡½æ•°çš„åŸå‹ï¼š <br><br><pre> <code class="cpp hljs">DWORD __<span class="hljs-function"><span class="hljs-function">stdcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormatMessageW</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPWSTR lpBuffer, DWORD nSize, va_list *Arguments )</span></span></span></span>;</code> </pre> <br><br><h2> æ½œåœ¨çš„å†…å­˜æ³„æ¼ </h2><br>  <b>ç¼ºé™·N75-N92</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SourceDependChildren</span></span></span><span class="hljs-class"> {</span></span> SourceFile **children; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> num_nodes, used_nodes; SourceDependChildren() : children(<span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>), num_nodes(<span class="hljs-number"><span class="hljs-number">0</span></span>), used_nodes(<span class="hljs-number"><span class="hljs-number">0</span></span>) { } ~SourceDependChildren() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (children) <span class="hljs-built_in"><span class="hljs-built_in">free</span></span>(children); children = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SourceFile *s)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(num_nodes &lt;= used_nodes) { num_nodes += <span class="hljs-number"><span class="hljs-number">200</span></span>; children = (SourceFile**)<span class="hljs-built_in"><span class="hljs-built_in">realloc</span></span>(children, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SourceFile*)*(num_nodes)); } children[used_nodes++] = s; } };</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV701 CWE-401 reallocï¼ˆï¼‰å¯èƒ½æ³„æ¼ï¼šå½“reallocï¼ˆï¼‰åˆ†é…å†…å­˜å¤±è´¥æ—¶ï¼ŒåŸå§‹æŒ‡é’ˆ'children'ä¸¢å¤±ã€‚ è€ƒè™‘å°†reallocï¼ˆï¼‰åˆ†é…ç»™ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆã€‚  makefiledeps.cpp 103 <br><br> ç¼“å†²åŒºæ‰©å±•ä»¥å±é™©çš„æ–¹å¼å®ç°ã€‚ å¦‚æœ<i>realloc</i>å‡½æ•°æ— æ³•åˆ†é…å†…å­˜ï¼Œå®ƒå°†è¿”å›<i>NULL</i> ã€‚ æ­¤<i>NULL</i>å°†ç«‹å³æ”¾ç½®åœ¨<i>children</i>å˜é‡ä¸­ï¼Œå¹¶ä¸”ä¸å¯èƒ½ä»¥æŸç§æ–¹å¼é‡Šæ”¾è¾ƒæ—©åˆ†é…çš„ç¼“å†²åŒºã€‚ å°†ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ <br><br> ç±»ä¼¼é”™è¯¯ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">qt-701.txt</a> ã€‚ <br><br><h2> æ‚é¡¹ </h2><br>  <b>ç¼ºé™·N93</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GradientBase</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BlendType</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inline</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BlendType</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QT_FASTCALL</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">qt_fetch_linear_gradient_template</span></span></span><span class="hljs-class">(....) {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t+inc*length &lt; qreal(INT_MAX &gt;&gt; (FIXPT_BITS + <span class="hljs-number"><span class="hljs-number">1</span></span>)) &amp;&amp; t+inc*length &gt; qreal(INT_MIN &gt;&gt; (FIXPT_BITS + <span class="hljs-number"><span class="hljs-number">1</span></span>))) { .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV610 CWE-758æœªæŒ‡å®šçš„è¡Œä¸ºã€‚ æ£€æŸ¥ç§»ä½è¿ç®—ç¬¦â€œ &gt;&gt;â€ã€‚ å·¦æ“ä½œæ•°'ï¼ˆ-2147483647-1ï¼‰'ä¸ºè´Ÿã€‚  qdrawhelper.cpp 4015 <br><br>  <i>INT_MIN</i>çš„è´Ÿå€¼ä¸èƒ½ç§»ä½ã€‚ è¿™æ˜¯æœªæŒ‡å®šçš„è¡Œä¸ºï¼Œå› æ­¤æ‚¨ä¸èƒ½ä¾èµ–æ­¤æ“ä½œçš„ç»“æœã€‚ æœ€é«˜æœ‰æ•ˆä½å¯ä»¥ç­‰äº0æˆ–1ã€‚ <br><br>  <b>ç¼ºé™·N94</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QObjectPrivate::addConnection(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> signal, Connection *c) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (signal &gt;= connectionLists-&gt;count()) connectionLists-&gt;resize(signal + <span class="hljs-number"><span class="hljs-number">1</span></span>); ConnectionList &amp;connectionList = (*connectionLists)[signal]; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (signal &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV781 CWE-129ä½¿ç”¨åï¼Œå°†æ£€æŸ¥â€œä¿¡å·â€å˜é‡çš„å€¼ã€‚ ç¨‹åºé€»è¾‘ä¸­å¯èƒ½æœ‰ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š397ï¼Œ413ã€‚qobject.cpp 397 <br><br> æ ¡éªŒ<i>ï¼ˆä¿¡å·&lt;0ï¼‰</i>è¡¨ç¤º<i>ä¿¡å·è‡ª</i>å˜é‡çš„å€¼å¯èƒ½ä¸ºè´Ÿã€‚ ä½†æ˜¯ï¼Œæ­¤å‚æ•°ä»¥å‰æ›¾ç”¨äºç´¢å¼•æ•°ç»„ã€‚ äº‹å®è¯æ˜ï¼Œæ£€æŸ¥æ‰§è¡Œå¾—å¤ªè¿Ÿäº†ã€‚ è¯¥ç¨‹åºå°†è¢«ç ´åã€‚ <br><br>  <b>ç¼ºé™·N95</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> QXmlStreamWriterPrivate::finishStartElement(<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> contents) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inEmptyElement) { write(<span class="hljs-string"><span class="hljs-string">"/&gt;"</span></span>); QXmlStreamWriterPrivate::Tag &amp;tag = tagStack_pop(); lastNamespaceDeclaration = tag.namespaceDeclarationsSize; lastWasStartElement = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { write(<span class="hljs-string"><span class="hljs-string">"&gt;"</span></span>); } inStartElement = inEmptyElement = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; lastNamespaceDeclaration = namespaceDeclarations.size(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hadSomethingWritten; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV519 CWE-563'lastNamespaceDeclaration'å˜é‡å·²è¿ç»­ä¸¤æ¬¡åˆ†é…å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š3188ã€3194ã€‚qxmlstream.cpp 3194 <br><br> æˆ‘å°†å¼ºè°ƒé”™è¯¯çš„å®è´¨ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inEmptyElement) { lastNamespaceDeclaration = tag.namespaceDeclarationsSize; } lastNamespaceDeclaration = namespaceDeclarations.size();</code> </pre> <br>  <b>ç¼ºé™·N96</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> QRollEffect::scroll() { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentHeight != totalHeight) { currentHeight = totalHeight * (elapsed/duration) + (<span class="hljs-number"><span class="hljs-number">2</span></span> * totalHeight * (elapsed%duration) + duration) / (<span class="hljs-number"><span class="hljs-number">2</span></span> * duration); <span class="hljs-comment"><span class="hljs-comment">// equiv. to int((totalHeight*elapsed) / duration + 0.5) done = (currentHeight &gt;= totalHeight); } done = (currentHeight &gt;= totalHeight) &amp;&amp; (currentWidth &gt;= totalWidth); .... }</span></span></code> </pre> <br>  V519 CWE-563â€œå®Œæˆâ€å˜é‡è¿ç»­ä¸¤æ¬¡åˆ†é…äº†å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š509ã€511ã€‚qeffects.cpp 511 <br><br> ä¸€åˆ‡ä¸å‰é¢çš„æƒ…å†µç›¸åŒã€‚ æ³¨æ„<i>å®Œæˆ</i>å˜é‡ã€‚ <br><br><h2> ç»“è®º </h2><br> å³ä½¿ä»è¡¨é¢ä¸Šæµè§ˆæŠ¥å‘Šï¼Œæˆ‘ä¹Ÿå†™å‡ºäº†è¿‘100ä¸ªé”™è¯¯ã€‚ æˆ‘å¯¹PVS-Studioçš„ç»“æœæ„Ÿåˆ°æ»¡æ„ã€‚ <br><br> å½“ç„¶ï¼Œè¿™ç§ç½•è§çš„ä»£ç æ£€æŸ¥ä¸æé«˜ä»£ç çš„è´¨é‡å’Œå¯é æ€§æ— å…³ã€‚ å®ƒä»¬ä»…æ¼”ç¤ºä»£ç åˆ†æå™¨çš„åŠŸèƒ½ã€‚ é™æ€åˆ†æå·¥å…·åº”å®šæœŸä½¿ç”¨ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä»¬å‡å°‘äº†ä¿®å¤é”™è¯¯çš„æˆæœ¬ï¼Œå¹¶ä¿æŠ¤äº†åº”ç”¨ç¨‹åºå…å—è®¸å¤šæ½œåœ¨æ¼æ´çš„ä¾µå®³ã€‚ <br><br> è°¢è°¢æ‚¨çš„å…³æ³¨ã€‚ ä¸ºäº†ä¸æˆ‘ä»¬çš„æ–°å‡ºç‰ˆç‰©ä¿æŒåŒæ­¥ï¼Œæˆ‘é‚€è¯·æ‚¨è®¢é˜…æˆ‘ä»¬çš„ä¸€ç§æ¸ é“ï¼š <ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VK.comï¼špvsstudio_rus</a> </li><li>  â€œè€æ´¾â€ RSSï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">viva64-blog-ru</a> </li><li> æ¨ç‰¹ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@pvsstudio_rus</a> </li><li>  Instagramçš„ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@pvsstudio_rus</a> </li><li> ç”µæŠ¥ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@pvsstudio_rus</a> </li></ol><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br> å¦‚æœæ‚¨æƒ³ä¸è¯´è‹±è¯­çš„è¯»è€…åˆ†äº«è¿™ç¯‡æ–‡ç« ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥ï¼šAndrey Karpovã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨PVS-Studioå¯¹Qt 5è¿›è¡Œç¬¬ä¸‰æ¬¡æ£€æŸ¥</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN426485/">https://habr.com/ru/post/zh-CN426485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN426475/index.html">å®«-æ™ºèƒ½æ‰‹æœºåŠ©æ‰‹</a></li>
<li><a href="../zh-CN426477/index.html">å…³äºRTOSçš„å…¨éƒ¨çœŸç›¸ã€‚ ç¬¬åäº”æ¡ å†…å­˜åˆ†åŒºï¼šæœåŠ¡å’Œæ•°æ®ç»“æ„</a></li>
<li><a href="../zh-CN426479/index.html">è‡ªåˆ¶ä¸»æ¿æµ‹è¯•å°</a></li>
<li><a href="../zh-CN426481/index.html">Unityä¸­çš„å…­è¾¹å½¢å›¾ï¼šè·¯å¾„æŸ¥æ‰¾å™¨ï¼Œæ’­æ”¾å™¨å°é˜Ÿï¼ŒåŠ¨ç”»</a></li>
<li><a href="../zh-CN426483/index.html">ä¸€ä¸ªè¶…è¶Šç‰¹æ–¯æ‹‰çš„äººã€‚ ä¸ºäº†æ›´æœ‰åˆ©å¯å›¾</a></li>
<li><a href="../zh-CN426487/index.html">ä»å¤´å¼€å§‹æµ‹è¯•è‡ªåŠ¨åŒ–ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN426489/index.html">å…³äºç´ æ•°å’Œæ— ç†æ•°çš„å…³ç³»</a></li>
<li><a href="../zh-CN426491/index.html">å®‰å…¨å‘¨39ï¼šå…³äºGoogle+çš„æ­»äº¡</a></li>
<li><a href="../zh-CN426493/index.html">VPSå’ŒVPSæ‰˜ç®¡æœåŠ¡å•†çš„å›ºå®šæŠ˜æ‰£ã€‚</a></li>
<li><a href="../zh-CN426495/index.html">ç‹¬å¥è®¾è®¡å¸ˆã€‚ ç‹¬è‡ªå·¥ä½œæ—¶å¦‚ä½•å»ºç«‹äº‹ä¸š</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>