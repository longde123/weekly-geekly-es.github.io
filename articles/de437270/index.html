<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèª ü§¥üèæ üèΩ Wir stellen eine virtuelle Windows-Maschine mit einer virtuellen Grafikkartenweiterleitung unter Verwendung von QEMU und Intel GVT-g bereit üíØ üè≥Ô∏è üë©üèª‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So funktioniert Intel GVT-g 


 Hallo allerseits! Intel bot eine hervorragende L√∂sung f√ºr das ewige Problem: "Ich habe einen Laptop unter Linux und mu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir stellen eine virtuelle Windows-Maschine mit einer virtuellen Grafikkartenweiterleitung unter Verwendung von QEMU und Intel GVT-g bereit</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437270/"><h1 id="kak-zastavit-intel-gvt-g-rabotat">  So funktioniert Intel GVT-g </h1><br><p>  Hallo allerseits!  Intel bot eine hervorragende L√∂sung f√ºr das ewige Problem: "Ich habe einen Laptop unter Linux und muss Windows mit Hardwarebeschleunigung ausf√ºhren, aber ich habe keinen schweren Laptop mit zwei GPUs und Fl√ºssigkeitsk√ºhlung."  Mithilfe der Architektur ihrer GPUs oder etwas anderem haben sie es geschafft, Ihre integrierte Intel-GPU in zwei oder mehr GPUs aufzuteilen. </p><br><p>  Leider ist dies keineswegs so einfach ... Die Dokumentation ist etwas veraltet und einige Dinge brechen ohne ersichtlichen Grund auf unverst√§ndliche Weise.  Daher werde ich Ihnen in diesem Beitrag erkl√§ren, wie Sie eine hardwarebeschleunigte virtuelle Windows-Maschine mit coolen virtio- und Intel GVT-g-Schnelltreibern konfigurieren. </p><br><p>  Dazu ben√∂tigen Sie eine mehr oder weniger moderne GPU ( <em>Anmerkung des √úbersetzers</em> : <em>Laut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offizieller Dokumentation</a> unterst√ºtzt GVT-g integrierte Grafikkarten, beginnend mit der f√ºnften Generation von Intel Core und der vierten Generation von Xeon</em> ). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/760/a80/d5e/760a80d5edea70d7ba2eb33458205f89.jpg" alt="Windows-Screenshot"></p><a name="habracut"></a><br><h2 id="shag-1-nastraivaem-yadro">  Schritt 1: Konfigurieren Sie den Kernel </h2><br><p>  Stellen Sie sicher, dass Sie eine neue Kernelversion haben.  Es scheint, dass die Optionen f√ºr GVT-g vor Version 4.8 enthalten waren, aber dann funktionierten sie definitiv schlechter, daher empfehle ich die Verwendung des neuesten verf√ºgbaren Kernels.  Wenn Sie originell genug sind, um Ihren Kernel zu erstellen, aktivieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diese Optionen</a> .  Deaktivieren Sie auch das Entfernen nicht verwendeter ksyms, da diese Option <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Fehler verursacht</a> . </p><br><p>  Jetzt m√ºssen Sie die Kernel-Befehlszeilenargumente korrigieren.  Wichtige Optionen sind: </p><br><pre><code class="plaintext hljs">i915.enable_gvt=1 kvm.ignore_msrs=1 intel_iommu=on i915.enable_guc=0</code> </pre> <br><p>  <code>enable_guc=0</code> Sie sicher, dass Sie <code>enable_guc=0</code> mit etwas √ºberschreiben, das das Laden von GuC erm√∂glicht, da dies zu einem deprimierenden Absturz des i915-Treibers f√ºhrt.  <code>/sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/</code> Sie beim Booten in Ihre Arbeitsumgebung und √ºberpr√ºfen Sie das Verzeichnis <code>/sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/</code> .  Wenn es nicht existiert, funktioniert GVT-g nicht.  √úberpr√ºfen Sie die Protokolle und / oder weinen Sie im Kissen. </p><br><p>  Als L√∂sung f√ºr das Problem k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diese</a> Module zu initramfs hinzuf√ºgen und den i915 von dort entfernen. </p><br><p>  F√ºr eine detailliertere Protokollierung k√∂nnen Sie die Variable <code>drm.debug</code> auf einen bestimmten Wert setzen. <code>drm.debug</code> Sie sie beispielsweise auf 0x02 setzen, werden Nachrichten von den Treibern <code>drm.debug</code> . </p><br><h2 id="shag-2-sozdayom-virtualnogo-druga">  Schritt 2: Erstellen Sie einen virtuellen Freund </h2><br><p>  In <code>mdev_supported_types</code> finden Sie eine ganze Reihe von Verzeichnissen.  Dieser Satz wird durch die Gr√∂√üe Ihres Grafikspeichers bestimmt. Jedes Unterverzeichnis entspricht einer Art virtueller GPU.  Die darin enthaltene <code>description</code> enth√§lt Informationen zum Speicher und zu den von dieser virtuellen GPU unterst√ºtzten Aufl√∂sungen.  Wenn beim Erstellen einer virtuellen GPU mit gro√üem Speicher mithilfe der UUID-Ausgabe in der Datei <code>/create</code> ein unverst√§ndlicher Fehler auftritt, haben Sie mehrere M√∂glichkeiten.  Gehen Sie zuerst zum BIOS und f√ºgen Sie nach M√∂glichkeit Videospeicher hinzu.  Wenn dies nicht funktioniert, k√∂nnen Sie Ihre DM stoppen, zum Framebuffer wechseln, von dort aus die gew√ºnschte vGPU erstellen und dann zu x11 zur√ºckkehren.  Leider f√ºhrt diese Methode zu vielen Fehlern und erlaubt es nicht, 60 FPS auf meinem Laptop zu erreichen.  Eine Alternative besteht darin, eine kleinere vGPU zu erstellen und ein spezielles Programm zu verwenden, um die Aufl√∂sung (CRU) zu erh√∂hen.  Auf diese Weise gelang es mir, 60 FPS zu erreichen, und es gab viel weniger Fehler und Einfrierungen. </p><br><p>  Sie k√∂nnen vGPU mit diesem Befehl erstellen: </p><br><pre> <code class="plaintext hljs">$ echo ${vGPU_UUID} | sudo tee /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/${vGPU_TYPE}/create</code> </pre> <br><p>  Und l√∂schen - das: </p><br><pre> <code class="plaintext hljs">$ echo 1 | sudo tee /sys/bus/mdev/devices/${vGPU_UUID}/remove</code> </pre> <br><p>  <em>Anmerkung des √úbersetzers</em> : <br>  <em>Sie k√∂nnen eine UUID f√ºr vGPU mit dem Befehl <code>uuidgen</code> ohne Argumente generieren.</em>  <em>Die Variable $ {vGPU_TYPE} bezeichnet einen der im Verzeichnis <code>mdev_supported_types</code> aufgef√ºhrten Typen.</em>  <em>Es ist auch erw√§hnenswert, dass vGPU bei jedem Neustart neu erstellt werden muss. Sie werden nicht zwischen den Betriebssystemstarts gespeichert.</em> </p><br><h2 id="shag-3-cortana-krichit-na-vas">  Schritt 3: Cortana schreit dich an </h2><br><p>  Der n√§chste Schritt wird viel besser unterst√ºtzt und ist viel langsamer und schmerzhafter - die Installation von Windows 10. Verwenden Sie keine Torrents oder inoffiziellen Downloads oder die alte Version von Windows. Der richtige Link ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Es lohnt sich auch, das Disk-Image mit virtio-Treibern herunterzuladen, die speziell daf√ºr entwickelt wurden, die G√§ste <a href="">hier</a> zu beschleunigen.  Installieren Sie <code>libvirt</code> und <code>virt-manager</code> und f√ºhren Sie <code>libvirtd</code> : </p><br><pre> <code class="plaintext hljs"># systemctl start libvirtd</code> </pre> <br><p>  F√ºhren Sie <code>virt-manager</code> und stellen Sie sicher, dass Sie mit der <code>libvirt</code> Systemsitzung verbunden sind, nicht mit der Benutzersitzung: <br><img src="https://habrastorage.org/getpro/habr/post_images/8e3/ca9/b29/8e3ca9b29bd86d43d7a79a2aecdaadd9.png" alt="Virt-Manager-Fenster"></p><br><p>  <em>Anmerkung des √úbersetzers</em> : <br>  <em>Damit virt-manager eine Verbindung zur Systemsitzung herstellen kann, k√∂nnen Sie es als root ausf√ºhren. Es ist jedoch besser, die Autorisierung zu konfigurieren, z. B. wie im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Arch-Wiki vorgeschlagen</a> .</em> </p><br><p>  Sobald Sie dies getan haben, k√∂nnen Sie mit dem Erstellen einer virtuellen Maschine beginnen.  W√§hlen Sie im Einstellungsdialog den Download aus dem lokalen ISO-Image aus und suchen Sie das heruntergeladene Image.  Wenn <code>virt-manager</code> es nicht als Windows 10-Image erkennt, w√§hlen Sie es manuell aus, da dies Windows beschleunigt, da <code>virt-manager</code> in diesem Fall einige Virtualisierungsschnittstellen von Microsoft bereitstellt.  Erstellen Sie ein Disk-Image oder eine LVM-Partition und konfigurieren Sie sie nach Bedarf.  Die Setup-Oberfl√§che vor der Installation ist sehr eingeschr√§nkt, daher starte ich normalerweise die Installation und stoppe sie sofort, um alles vollst√§ndig zu konfigurieren.  Hier sind einige Einstellungen: <br><img src="https://habrastorage.org/getpro/habr/post_images/a55/104/cca/a55104cca39b9a94e2ec55fb5248a6c0.png" alt="CPU-Einstellungen der virtuellen Maschine"><br><img src="https://habrastorage.org/getpro/habr/post_images/256/bde/55c/256bde55c4d6f438667ca75458ba1ab3.png" alt="Netzwerkeinstellungen der virtuellen Maschine"></p><br><p>  <em>Anmerkung des √úbersetzers</em> : <br>  <em>Trotz des Beitrags zum Einrichten einer virtuellen Maschine auf einem Laptop entf√§llt aus irgendeinem Grund die Frage nach der Verteilung des Netzwerks mithilfe eines drahtlosen Adapters.</em>  <em>Tatsache ist, dass die Standardnetzwerkeinstellungen in virt-manager nicht f√ºr ein drahtloses Netzwerk geeignet sind.</em>  <em>In dieser Situation kann die Antwort auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diese</a> Frage und Kommentare dazu hilfreich sein.</em>  <em>Der Autor schl√§gt au√üerdem vor, das BIOS anstelle von UEFI zu verwenden, wahrscheinlich aufgrund der Tatsache, dass UEFI eine zus√§tzliche Konfiguration erfordert.</em>  <em>Au√üerdem scheint Tianocore noch nicht mit GVT-g zu funktionieren, siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehler 935</a> .</em>  <em>In meinem Fall wurde die VM jedoch gestartet, aber Windows erkannte den Monitor, an den die integrierte Grafikkarte angeschlossen war, nicht.</em> </p><br><p>  Wenn Sie beim L√∂schen von Dateien der virtuellen Maschine einen schnellen Zugriff auf die Festplatte oder sogar die F√§higkeit der virtuellen Maschine ben√∂tigen, das Festplatten-Image zu komprimieren (TRIM-Pr√ºfung, m√ºssen Sie dazu das Image mit dem Befehl <code>qemu-img create -f qcow2 -o preallocation=metadata,lazy_refcounts</code> , die vollst√§ndige Anweisung finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ). Konfigurieren Sie das prim√§re Laufwerk f√ºr die Verwendung von SCSI.  Sie ben√∂tigen Treiber f√ºr die virtuelle Maschine f√ºr Windows, um dieses Format zu verstehen. Schlie√üen Sie daher die zuvor heruntergeladene virtio-Treiberdiskette f√ºr Windows 10 an. Standardm√§√üig wird eine IDE verwendet. Sie k√∂nnen die Installation jedoch um ein Vielfaches beschleunigen und weniger Legacy-Code verwenden, wenn Sie stattdessen verwenden f√ºr SCSI-DVDs.  Windows unterst√ºtzt dies sofort.  Sie k√∂nnen auch: </p><br><ul><li>  Erzwingen Sie, dass USB USB 3.0 verwendet </li><li>  F√ºgen Sie die Kan√§le spice, spice-webdav und qemu-ga hinzu, damit das Kopieren und Einf√ºgen sowie die gemeinsame Nutzung von Dateien zwischen der VM und dem Host funktionieren </li><li>  Entfernen Sie nicht verwendete virtuelle Hardware </li><li>  Schalten Sie die emulierte Grafikkarte auf QXL und die Anzeige auf SPICE, ohne das Netzwerk zu h√∂ren (auch kein Loopback) ( <em>Anmerkung des √úbersetzers: Andernfalls st√ºrzt die VM einfach ab</em> ). </li><li>  Schalten Sie den Chip-Typ auf Q35 und stellen Sie ihn neben den BIOS-Einstellungen ein. </li><li>  F√ºttere den Hund </li></ul><br><p>  Sie k√∂nnen sich auch an die <code>virsh edit</code> Ihres neuen Freundes <code>virsh edit</code> .  Wenn Sie es mit <code>sudo -E</code> ausf√ºhren, werden Ihre Umgebungsvariablen, insbesondere EDITOR, zum Bearbeiten verwendet, und Sie verwenden die libvirt-Systemsitzung, nicht die Benutzersitzung.  In dieser Datei k√∂nnen Sie beispielsweise eine Korrespondenz zwischen physischen und virtuellen Prozessoren zuweisen, wodurch die Prozessor-Caches konsistenter sind und sich der Scheduler nicht so seltsam verh√§lt.  Hier ist ein Beispiel-XML, das Sie dort ablegen k√∂nnen: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpu</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placement</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'static'</span></span></span><span class="hljs-tag">&gt;</span></span>6<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpu</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cputune</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpupin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vcpu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'0'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpuset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'1'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpupin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vcpu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'1'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpuset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'2'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpupin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vcpu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'2'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpuset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'3'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpupin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vcpu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'3'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpuset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'5'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpupin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vcpu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'4'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpuset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'6'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vcpupin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">vcpu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'5'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cpuset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'7'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cputune</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">features</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hyperv</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">relaxed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vapic</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">spinlocks</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">retries</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'8191'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">runtime</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">synic</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stimer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hyperv</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">features</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cpu</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'host-passthrough'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">check</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'none'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">topology</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sockets</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'1'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cores</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'3'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">threads</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'2'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cpu</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In diesem Snippet konfiguriere ich die VM so, dass sie einen Prozessor mit drei physischen Kernen sieht, von denen jeder zwei Hyperthreads hat.  Ferner wird jeder Prozessor / Hyper-Thread an seinen eigenen Hyper-Thread angeh√§ngt, und diese Entsprechung √§ndert sich nicht.  Windows Scheduler kennt Hyperthreads und kann sie korrekt verwenden, ohne sie als separate Prozessoren zu z√§hlen.  Ich aktiviere auch einige Hyper-V-Schnittstellen, die standardm√§√üig deaktiviert sind und m√∂glicherweise keine Auswirkungen haben.  Wenn Sie SPICE verwenden, k√∂nnen Sie die folgenden Zeilen hinzuf√ºgen, um die Komprimierung zu deaktivieren, da das externe Netzwerk immer noch nicht f√ºr den Zugriff auf die VM verwendet wird. </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">graphics</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'spice'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listen</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'none'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compression</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'off'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jpeg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compression</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'never'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zlib</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compression</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'never'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">playback</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compression</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'off'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">streaming</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'off'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;gl enable='yes' rendernode='/dev/dri/by-path/pci-0000:00:02.0-render'/&gt;     ,     libvirt --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">graphics</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Jetzt k√∂nnen Sie die Startreihenfolge konfigurieren und die Installation von Windows starten.  Wenn Sie ein <code>virtio</code> oder SCSI-Laufwerk verwenden, wird Windows es nicht finden.  Sie m√ºssen den SCSI-Treiber von dem Laufwerk installieren, das Sie verbunden haben. Er befindet sich im <code>virtscsi/amd64</code> .  Alles sollte reibungslos verlaufen und Windows sollte in einem langsamen und miserablen, nicht beschleunigten Modus starten.  Cortana wird Sie anschreien und Ihr Netzwerk wird nicht funktionieren.  Brechen Sie alles auf dem Desktop durch.  Starten Sie dort den Ger√§te-Manager, suchen Sie alle nicht identifizierten Ger√§te und aktualisieren Sie die Treiber f√ºr sie von der Festplatte, die Sie verbunden haben.  Sie erhalten ein etwas schnelleres Windows. </p><br><h2 id="shag-4-vesyolaya-chast">  Schritt 4: Der lustige Teil </h2><br><p>  Es gibt drei M√∂glichkeiten, die beschleunigte Anzeige virtueller VMs von Windows auf dem Bildschirm Ihres Computers anzuzeigen. </p><br><ul><li>  VNC oder ein anderes RAS-Protokoll (normalerweise ist dies eine sehr schlechte L√∂sung).  Bei dieser Option m√ºssen Sie nur die vGPU anschlie√üen und alle anderen Anzeigen und Grafikkarten deaktivieren.  Stellen <code>display='off'</code> Einstellung <code>display='off'</code> .  Sie ben√∂tigen die <code>igd-opregion</code> Option <code>igd-opregion</code> nicht. </li><li>  SPICE (Ich konnte keine 30 FPS oder mehr erreichen, aber die allgemeine Zwischenablage und die Datei√ºbertragung zwischen der VM und dem Host funktionieren). </li><li>  Integrierte QEMU-Schnittstelle in GTK + (gemeinsame Zwischenablage und Datei√ºbertragung funktionieren nicht, aber Sie k√∂nnen mit einem Patch 60 FPS erreichen). </li></ul><br><p>  Was auch immer Sie verwenden m√∂chten, Sie m√ºssen immer noch die zweite Option verwenden, um die Treiber f√ºr die GPU zu installieren.  Die integrierten Treiber von Microsoft funktionieren zum Zeitpunkt des Schreibens nicht sehr gut mit GVT-g und sind h√§ufig fehlerhaft.  Bevor Sie die vGPU mit der VM verbinden, ist es ratsam, den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neuesten Treiber von Intel</a> herunterzuladen (anscheinend <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√§ndert Intel seinen Ansatz zur Verteilung von Treibern</a> , sodass dieser Schritt in Zukunft m√∂glicherweise anders oder gar nicht erforderlich ist).  Stellen Sie nun sicher, dass Sie eine vGPU erstellt haben.  √ñffnen Sie <code>virt-manager</code> und ersetzen Sie das gute schnelle QXL durch ein langsames Cirrus, um Konflikte zu vermeiden.  Um vGPU mit der VM zu verbinden, m√ºssen Sie <code>virsh edit</code> √∂ffnen und irgendwo das folgende Fragment hinzuf√ºgen: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'kvm'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:qemu</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'http://libvirt.org/schemas/domain/qemu/1.0'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostdev</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'subsystem'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'mdev'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">managed</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'no'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'vfio-pci'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">display</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'on'</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="plaintext hljs">&lt;address uuid='fff6f017-3417-4ad3-b05e-17ae3e1a4615'/&gt;</code> </pre> <br><pre> <code class="plaintext hljs"> &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x09' function='0x0'/&gt; &lt;rom enabled='no'/&gt; &lt;/hostdev&gt; &lt;graphics type='spice'&gt; &lt;listen type='none'/&gt; &lt;image compression='off'/&gt; &lt;jpeg compression='never'/&gt; &lt;zlib compression='never'/&gt; &lt;playback compression='off'/&gt; &lt;streaming mode='off'/&gt; &lt;gl enable='yes' rendernode='/dev/dri/by-path/pci-0000:00:02.0-render'/&gt; &lt;!--      , virt-manager     ,        GL. ,      ,   auto. --&gt; &lt;/graphics&gt; &lt;qemu:commandline&gt; &lt;qemu:arg value='-set'/&gt; &lt;qemu:arg value='device.hostdev0.x-igd-opregion=on'/&gt; &lt;!-- libvirt     ,      --&gt; &lt;/qemu:commandline&gt; &lt;/domain&gt;</code> </pre> <br><p>  Hinweis: Wenn ich ein XML-Snippet wie dieses bereitstelle, sollten Sie es nach M√∂glichkeit dem aktuellen hinzuf√ºgen, ohne etwas zu ersetzen. </p><br><p>  Stellen Sie sicher, dass Sie eindeutige UUIDs f√ºr alle von Ihnen verwendeten vGPUs erstellt haben und dass die Steckplatznummern nicht mit den anderen PCI-Ger√§ten in Konflikt stehen.  Wenn die Steckplatznummer hinter der Cirrus-GPU liegt, st√ºrzt die virtuelle Maschine ab.  Jetzt k√∂nnen Sie die virtuelle Maschine starten.  <strong>Sie m√ºssen <code>virt-viewer</code> installieren, um beide Anzeigen zu sehen!</strong>  Mit dem Befehl k√∂nnen Sie eine Verbindung zu einer VM herstellen </p><br><pre> <code class="plaintext hljs">$ sudo -E virt-viewer --attach</code> </pre> <br><p>  Eine der Anzeigen ist leer oder nicht initialisiert, die zweite ist eine vertraute, kleine, nicht beschleunigte Anzeige.  Erweitern Sie es und installieren Sie nach der Eingabe den Treiber f√ºr die GPU.  Wenn Sie Gl√ºck haben, wird alles sofort funktionieren.  Andernfalls m√ºssen Sie die VM √ºber den Arbeitsbildschirm ausschalten und neu starten (nicht neu starten).  Jetzt ist es Zeit, ein Terminal zu √∂ffnen und <code>dmesg -w</code> Inneren <code>dmesg -w</code> .  Dieser Befehl gibt Ihnen einige n√ºtzliche Informationen zu Problemen und zum allgemeinen Fortschritt bei der Verwendung von vGPU.  Beispielsweise beschwert sich KVM beim Booten √ºber blockierte MSRs. Bei der Initialisierung von vGPU sollten dann einige falsche Zugriffsmeldungen angezeigt werden.  Wenn es zu viele gibt, stimmt etwas nicht. </p><br><p>  Wenn das System startet, k√∂nnen Sie die Anzeigeeinstellungen √∂ffnen und den nicht beschleunigten Bildschirm ausschalten.  Ein leerer Bildschirm kann im <code>virt-viewer</code> √ºber das Men√º <em>Ansicht</em> ausgeblendet werden.  Im Prinzip k√∂nnen VMs bereits verwendet werden, aber es gibt einige M√∂glichkeiten, um eine h√∂here Aufl√∂sung und Geschwindigkeit zu erzielen. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das CRU-Dienstprogramm ist</a> sehr n√ºtzlich.  Sie k√∂nnen damit <code>Restart64.exe</code> , und selbst wenn Sie auf grafische Artefakte oder sogar auf einen fast vollst√§ndig schwarzen Bildschirm <code>Restart64.exe</code> , wie sich f√ºr mich herausstellte, k√∂nnen Sie die mit dem Programm <code>Restart64.exe</code> Datei <code>Restart64.exe</code> , um das Windows-Grafiksubsystem neu zu starten.  Pers√∂nlich verwende ich dieses Dienstprogramm, um eine h√∂here Aufl√∂sung auf einer bescheideneren vGPU zu verwenden. </p><br><p>  Um hervorragende 60 FPS zu erzielen, m√ºssen Sie auf den integrierten QEMU-Monitor in GTK + umschalten, ohne eine gemeinsame Zwischenablage mit dem Host und √§hnlichen Br√∂tchen zu unterst√ºtzen. Au√üerdem m√ºssen Sie eine Zeile darin √§ndern und QEMU neu erstellen.  Sie m√ºssen Ihrem XML auch eine Reihe b√∂ser Befehlszeilenargumente hinzuf√ºgen.  Entfernen Sie das SPICE-Display und die Cirrus-Grafikkarte und setzen Sie das <code>display</code> Ihrer vGPU auf <code>off</code> (libvirt unterst√ºtzt die Anzeige auf GTK + nicht und erlaubt kein Booten von <code>display='on'</code> ohne Anzeige). </p><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:commandline</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:arg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'-set'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:arg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'device.hostdev0.x-igd-opregion=on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:arg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'-set'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:arg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'device.hostdev0.display=on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:arg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'-display'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:arg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'gtk,gl=on'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:env</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'DISPLAY'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">':1'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:env</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'GDK_SCALE'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'1.0'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu:commandline</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Die Skalierung f√ºr HiDPI auf dem QEMU-Monitor funktioniert sehr schlecht, daher werden wir sie deaktivieren.  Au√üerdem m√ºssen Sie die Variable <code>DISPLAY</code> auf die von Ihnen verwendete Anzeigenummer setzen.  Verwenden Sie den folgenden Befehl, um dem Benutzer, der qemu ausf√ºhrt, Zugriff auf den X-Server zu gew√§hren: </p><br><pre> <code class="plaintext hljs"># xhost si:localuser:nobody</code> </pre> <br><p>  Wenn dies nicht funktioniert, versuchen Sie es mit <code>xhost +</code> , stellen Sie jedoch sicher, dass Sie eine Firewall verwenden.  Versuchen Sie es andernfalls mit einer sichereren Methode. </p><br><p>  Mit solchen Tricks werden Sie aufgrund dieses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dummen Fehlers</a> in QEMU immer noch nicht √ºber 30 FPS kommen, wenn Sie ihn nicht durch √Ñndern der Zeile patchen, wie im Kommentar-Link angegeben.  Stellen Sie sicher, dass Sie QEMU nur f√ºr x86-64 erstellen, es sei denn, Sie m√∂chten es auf einer anderen Plattform verwenden.  Ich habe mein PKGBUILD angeh√§ngt, das die Zeile nicht √§ndert, sondern nur QEMU f√ºr x86_64 ohne Netzwerkspeicherunterst√ºtzung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> sammelt. </p><br><p>  Wenn Sie sich unterwegs irgendwo verlaufen, k√∂nnen Sie mein aktuelles <a href="">XML f√ºr libvirt sehen</a> . </p><br><h2 id="poleznye-ssylki">  N√ºtzliche Links </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Offizieller GVT-g Tuning Guide</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dma-buf Benutzerhandbuch</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Intel GVT-g Setup-Artikel im NixOS-Wiki</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Arch Wiki Artikel √ºber libvirt</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Netzwerkeinrichtung in KVM auf der drahtlosen Schnittstelle</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Intel GVT-g Website</a> </p><br><p>  PS: Vielen Dank an <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">aNNiMON</a> f√ºr die Hilfe beim Korrekturlesen des √úbersetzungstextes und beim Korrigieren von Fehlern. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de437270/">https://habr.com/ru/post/de437270/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de437256/index.html">√úberpr√ºfen der Speicheradressen auf einem Cortex-M0 / M3 / M4 / M7</a></li>
<li><a href="../de437258/index.html">Einzigartiges Projekt des CATIA DESIGN-Teams: Bleu Concept Car</a></li>
<li><a href="../de437260/index.html">Windows Phone 8.1: Nostalgie nach der Entwicklung. Einzelanwendungsverlauf</a></li>
<li><a href="../de437262/index.html">Wie wird Flusswasser trinkbar?</a></li>
<li><a href="../de437264/index.html">Professionelles Burnout in der IT (My Circle-Studienergebnisse)</a></li>
<li><a href="../de437274/index.html">Eine Vision zur Beobachtbarkeit in der Praxis</a></li>
<li><a href="../de437276/index.html">Remilicht Tischleuchten mit sonnen√§hnlichen LEDs</a></li>
<li><a href="../de437280/index.html">Einfache Logistik zum Selbermachen</a></li>
<li><a href="../de437282/index.html">Eine Einf√ºhrung in Kubernetes f√ºr VMware-Benutzer. Teil 2. √úbung</a></li>
<li><a href="../de437284/index.html">Zoo-Berufe im Zusammenhang mit der Audioindustrie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>