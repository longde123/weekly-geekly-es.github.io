<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ∑ üßìüèæ üëçüèª 1. An√°lise do log do Check Point: o aplicativo oficial do Check Point para Splunk ü§≥üèæ üïé üëÉüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ao trabalhar com gateways de seguran√ßa da Check Point, muitas vezes surge a tarefa de analisar logs para detectar e analisar incidentes de seguran√ßa d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>1. An√°lise do log do Check Point: o aplicativo oficial do Check Point para Splunk</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/431146/"><img src="https://habrastorage.org/webt/bq/gl/8f/bqgl8fhc3r4o-hr5aox1vkwq-ou.png"><br><br>  Ao trabalhar com gateways de seguran√ßa da Check Point, muitas vezes surge a tarefa de analisar logs para detectar e analisar incidentes de seguran√ßa da informa√ß√£o.  Normalmente, as organiza√ß√µes j√° possuem algum tipo de sistema de log, e a tarefa √© transportar logs do servidor de gerenciamento Check Point e configurar filtros para logs, criar pain√©is, agendas e assim por diante.  Neste curso, consideraremos v√°rias op√ß√µes para analisar os logs do Check Point usando a funcionalidade interna e aplicativos de terceiros, considerar as informa√ß√µes √∫teis que podemos extrair e como elas ajudar√£o na configura√ß√£o do firewall. <br><a name="habracut"></a><br>  Como parte dos produtos da Check Point, a funcionalidade SmartEvent √© respons√°vel por isso, o que criar√° relat√≥rios sobre modelos.Voc√™ tamb√©m pode configurar um conjunto limitado de a√ß√µes autom√°ticas, mas n√£o √© isso, retornaremos a esse problema mais tarde.  Tamb√©m h√° outras solu√ß√µes para esse problema, discutidas em outros artigos: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Splunk + Check Point, um exemplo de an√°lise dos logs do seu firewall</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Evento inteligente de ponto de verifica√ß√£o.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mini guia</a> </li></ul><br>  A configura√ß√£o de todas as solu√ß√µes acima requer uma certa qualifica√ß√£o e muito tempo para implementa√ß√£o.  E se voc√™ precisar de uma solu√ß√£o aqui e agora?  A Check Point lan√ßou recentemente um aplicativo que √© ideal para este caso - o Check Point App for Splunk, para o qual os dados s√£o enviados via syslog usando a ferramenta exportadora de logs em tempo real para o sistema de log Splunk.  Neste artigo, consideraremos em detalhes essa solu√ß√£o, instala√ß√£o e as informa√ß√µes que obtemos na sa√≠da. <br><br><h3>  <b>Requisitos de instala√ß√£o</b> </h3><br>  O servidor de gerenciamento do Check Point requer a ferramenta Exportador de Logs instalada para enviar logs usando o protocolo syslog.  No GAIA R80.20, o Log Exporter √© instalado por padr√£o, mas para oferecer suporte ao formato de log do Splunk, √© necess√°rio instalar o Jumbo Hotfix, em outras vers√µes, antes de instalar o Log Exporter, voc√™ deve primeiro instal√°-lo para oferecer suporte ao Jumbo Hotfix. <br>  Todos os requisitos para a vers√£o do hotfix s√£o indicados abaixo: <br><br><ol><li>  R80.20 - Hotfix Jumbo Tome 5 ou superior; </li><li>  R80.10 - Hotfix Jumbo Tome 56 ou superior; </li><li>  R77.30 - Hotfix Jumbo Tome 292 ou superior. </li></ol><br>  Para que o aplicativo funcione, a vers√£o m√≠nima do sistema deve ser pelo menos o Splunk 6.5, o pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CIM (Modelo de Informa√ß√µes Comuns</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Splunk)</a> tamb√©m deve ser instalado. <br><br><h3>  <b>Instala√ß√£o e lan√ßamento</b> </h3><br>  O processo de instala√ß√£o √© bastante trivial, primeiro instalamos o Log Exporter, depois o aplicativo no Splunk, configuramos o processo de envio de logs para o servidor de gerenciamento e o processo de aceita√ß√£o no sistema de log e, no ponto final, iniciamos o envio do log, verifique se tudo funciona como esperado.  Considere todos os pontos em mais detalhes. <br><br>  <b>1.Instala√ß√£o do Jumbo Hotfix, conforme necess√°rio.</b> <br>  Entramos no portal do GAIA em um navegador da Web, no menu esquerdo Atualiza√ß√µes (CPUSE), Status e A√ß√µes, selecionamos o pacote Jumbo Hotfix recomendado, que obviamente ter√° uma vers√£o mais alta que o limite mais baixo nos requisitos ou procuramos a vers√£o desejada em Adicionar Hotfixes da Nuvem, instale , o processo exigir√° uma reinicializa√ß√£o do servidor de gerenciamento. <br><br>  <b>2. Instale o Exportador de Log se a sua vers√£o do Check Point for menor que R80.20.</b> <br>  Para instalar o Log Exporter no gerenciamento, primeiro fa√ßa o download do arquivo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">morto no portal Check Point</a> . <br><br><img src="https://habrastorage.org/webt/14/xo/xv/14xoxvdmuob7dmrpeyh-g6ro7om.png"><br><br>  Ent√£o, novamente, v√° para o menu CPUSE-&gt; Status e a√ß√µes, selecione Importar Pacote, especifique o caminho para o arquivo morto, importe.  Depois disso, altere a exibi√ß√£o dos pacotes de Mostrando pacotes recomendados para Mostrando todos os pacotes, selecione o arquivo importado, instale. <br><br>  <b>3. Instale o CIM se n√£o estiver instalado anteriormente.</b> <br>  V√° para o Splunk WebUI, localize o pacote CIM em Gerenciar aplicativos -&gt; Procurar mais aplicativos, instale. <br><br><img src="https://habrastorage.org/webt/rq/qm/kf/rqqmkfbyxpzo2mwjjajbsohngre.png"><br><br>  <b>4.Instale o aplicativo Check Point para Splunk</b> <br>  Fa√ßa o download do arquivo morto do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">portal</a> e v√° para Splunk WebUI, Gerenciar aplicativos, Instalar aplicativo do arquivo, selecione o arquivo desejado, clique em fazer upload.  Estamos aguardando a notifica√ß√£o da opera√ß√£o bem-sucedida, verifique se o aplicativo agora est√° vis√≠vel na lista de aplicativos. <br><br><img src="https://habrastorage.org/webt/t7/dd/vo/t7ddvo5g4c5dqzuunqyyxwm0w8a.png"><br><br>  √â parecido com o aplicativo instalado, √© claro, entre outros aplicativos: <br><br><img src="https://habrastorage.org/webt/hs/iy/y0/hsiyy0qqcvjxqhqss9pg96pi7a4.png"><br><br>  Para enviar logs via syslog, voc√™ deve primeiro criar um processo Exportador de Logs, configurar a Entrada de Dados no Splunk e iniciar o processo criado no servidor de gerenciamento Check Point. <br><br>  <b>5. Configure o Exportador de Log</b> <br>  No servidor de gerenciamento Check Point na CLI, no modo expert, execute o comando: <br>  cp_log_export add name [servidor de dom√≠nio &lt;servidor de dom√≠nio&gt;] servidor de destino &lt;servidor de destino&gt; protocolo de porta de destino &lt;porto de destino&gt; protocolo &lt;tcp |  formato udp&gt; modo de leitura de splunk &lt;bruto |  semi-unificado&gt; <br>  onde √© o nome da configura√ß√£o, &lt;target-server&gt; √© o endere√ßo IP do sistema Splunk para o qual estamos enviando dados, &lt;target-port&gt; √© a porta para a qual estamos enviando dados. <br>  Exemplo: cp_log_export add name check_point_syslog target-server 10.10.1.159 target-port 9000 protocol tcp format splc modo de leitura semi-unificado <br><br>  <b>6. Configure a entrada de dados no Splunk</b> <br>  V√° para o Splunk WebUI, selecione Configura√ß√µes no menu, selecione Entradas de dados na se√ß√£o Dados. <br><img src="https://habrastorage.org/webt/9j/-g/do/9j-gdoyfjdfes3plbidjrupnzmw.png"><br>  Selecionamos o protocolo pelo qual os dados ser√£o enviados ao Splunk; neste exemplo, tcp, selecione + Adicionar novo. <br><br><img src="https://habrastorage.org/webt/je/99/gt/je99gt6ztojek43mp95-soczzx4.png"><br><br>  Em seguida, insira a porta &lt;target-port&gt;, especificada no Log Exporter, nesse caso 9000, voc√™ pode especificar adicionalmente de qual endere√ßo IP aceitar as conex√µes e aguardar o bot√£o Avan√ßar. <br><br><img src="https://habrastorage.org/webt/ah/5r/vq/ah5rvqiqseck0vnig3k0qgq2u_u.png"><br><br>  No tipo de origem, especifique cp_log, method - IP, index e mantenha-se como padr√£o, todos os dados ser√£o indexados como index = Main e se voc√™ tiver outros dados para esse √≠ndice, o tempo de pesquisa poder√° aumentar significativamente, voc√™ poder√° especificar um √≠ndice diferente ou criar um novo e, em seguida, no pr√≥prio aplicativo, voc√™ deve especificar diretamente em qual √≠ndice executar opera√ß√µes de pesquisa. <br><img src="https://habrastorage.org/webt/vk/50/9b/vk509b8nlj3bzibmhei3ypbe1g8.png"><br>  Depois de clicar em Revisar, veremos que todas as configura√ß√µes s√£o verdadeiras, selecione Enviar, a configura√ß√£o de Entradas de dados est√° conclu√≠da, voc√™ s√≥ precisa enviar os logs do servidor de gerenciamento de Check Point. <br><br>  <b>7. Iniciamos o processo de upload de logs para o Splunk</b> <br>  No modo especialista, digite o comando: <br>  cp_log_export restart name, em que √© o nome da configura√ß√£o criada na primeira etapa <br>  Exemplo: cp_log_export restart check_point_syslog <br>  A configura√ß√£o est√° conclu√≠da, depois disso resta apenas garantir que os logs sejam enviados ao Splunk, usando os mecanismos de consulta de pesquisa padr√£o do Splunk. <br><br><img src="https://habrastorage.org/webt/ma/jo/sb/majosbg53muvbjt5m3hskshscaa.png"><br><br>  Agora voc√™ pode analisar a opera√ß√£o do pr√≥prio aplicativo, quais pain√©is e relat√≥rios ele cont√©m, quais informa√ß√µes importantes podem ser obtidas e quais conclus√µes podem ser tiradas. <br><br><h3>  <b>An√°lise de Log</b> </h3><br>  O aplicativo √© dividido em 2 se√ß√µes - Vis√£o geral geral e prote√ß√£o contra preven√ß√£o de amea√ßas, que por sua vez √© dividida em Vis√£o geral do ataque cibern√©tico, prote√ß√£o contra jato de areia e eventos adicionais de preven√ß√£o de amea√ßas.  Consideramos cada se√ß√£o separadamente. <br><br>  <b>Vis√£o geral</b> <br><br><img src="https://habrastorage.org/webt/lh/qx/dt/lhqxdtflctlgbgvjr__psy5lj7c.png"><br><br>  A p√°gina principal do aplicativo apresenta v√°rias tabelas, estat√≠sticas e gr√°ficos.  Algumas informa√ß√µes neste caso s√£o b√°sicas, por exemplo, quantos gateways e servidores de gerenciamento ou o n√∫mero de logs nos blades, voc√™ provavelmente n√£o aprende nada de novo e, com base nessas informa√ß√µes, n√£o pode tirar conclus√µes que ter√£o um efeito positivo. <br>  Do meu ponto de vista, os elementos mais interessantes aqui s√£o Tipos de Ataques Cr√≠ticos, Ataques Cr√≠ticos Permitidos pela Pol√≠tica, Hosts Infectados, Aplicativos de Alto Risco Permitidos, explicarei por qu√™. <br>  De acordo com os tipos de ataques cr√≠ticos, os ataques cr√≠ticos permitidos pela pol√≠tica podem melhorar a pol√≠tica de seguran√ßa de preven√ß√£o de amea√ßas (movendo a√ß√µes de detec√ß√£o para preven√ß√£o por assinaturas espec√≠ficas ou aumentando o n√≠vel de resposta), aumentando assim o n√≠vel de seguran√ßa para prote√ß√£o contra amea√ßas de v√≠rus, tentativas de introduzir e invadir seu computador. infraestrutura.  Hosts infectados indica os usu√°rios que podem estar infectados e, portanto, devem ser verificados separadamente por antiv√≠rus ou isolados da rede, impedindo a passagem do v√≠rus pela rede da organiza√ß√£o.  Com base no diagrama Aplicativos de alto risco permitidos, voc√™ pode bloquear os aplicativos potencialmente perigosos mais visitados que atualmente t√™m permiss√£o para os usu√°rios bloquearem. <br>  Os diagramas Aplicativos e Filtragem de URL por Risco, Incidentes de Seguran√ßa por Gravidade e A√ß√µes de Ataque por Pol√≠tica s√£o de natureza sistem√°tica e indicam se o status de seguran√ßa em sua organiza√ß√£o melhora com o tempo, ou seja, se as altera√ß√µes feitas na pol√≠tica de seguran√ßa ajudaram a proteger mais a infraestrutura. <br><br>  <b>Vis√£o geral do ataque cibern√©tico</b> <br><br><img src="https://habrastorage.org/webt/al/qz/kj/alqzkjrz65gjhfsekfnrfew0pde.png"><br><br><img src="https://habrastorage.org/webt/34/vd/ae/34vdae6rpbgtnp6sg6vmjh5tzuk.png"><br><br><img src="https://habrastorage.org/webt/mi/-d/rt/mi-drtnm-zab4dofjx240gyaaua.png"><br><br>  Este painel mostra informa√ß√µes mais detalhadas sobre hosts infectados e sobre usu√°rios que baixam v√≠rus.  √â muito conveniente distinguir entre arquivos infectados baixados e mensagens infectadas, voc√™ pode identificar amea√ßas e criar uma pol√≠tica de seguran√ßa de Preven√ß√£o de Amea√ßas para servi√ßos individuais, um perfil de seguran√ßa para o tr√°fego smtp e outro para http e https.  O SandBlast Protection fornece informa√ß√µes mais detalhadas sobre arquivos infectados, voc√™ pode examinar a Gravidade e identificar as defici√™ncias do seu perfil de seguran√ßa em Preven√ß√£o contra amea√ßas. <br><br><h3>  <b>Conclus√£o</b> </h3><br>  Gra√ßas a esse aplicativo, √© muito r√°pido e conveniente obter informa√ß√µes sobre pontos fracos da sua pol√≠tica de seguran√ßa, a configura√ß√£o do aplicativo leva um pouco de tempo e n√£o requer muita habilidade nessas solu√ß√µes.  Ou seja, se voc√™ duvida de suas configura√ß√µes de seguran√ßa e precisa de algumas an√°lises sem muito tempo, essa √© uma solu√ß√£o muito conveniente.  No entanto, √© claro que o aplicativo ainda precisa ser aprimorado seriamente, n√£o h√° estat√≠sticas sobre os usu√°rios, √© muito interessante ver uma lista dos aplicativos mais usados ‚Äã‚Äãe a quantidade de tr√°fego dispon√≠vel, etc.  Como essa √© apenas a primeira vers√£o, o aplicativo ser√° atualizado e, provavelmente, ser√° uma solu√ß√£o de an√°lise muito boa ao longo do tempo, mas agora, se considerarmos esse aplicativo apenas como uma an√°lise de log, ser√° muito inferior a outras solu√ß√µes.  Nos artigos subsequentes, consideraremos e comparamos os recursos do SmartEvent e outros aplicativos Splunk para analisar os logs do Check Point, incluindo o aplicativo criado por nossos engenheiros. <br><br>  Se voc√™ n√£o tentou o Splunk analisar os logs do Check Point, √© hora de come√ßar.  Se voc√™ tiver d√∫vidas ou problemas com o Splunk ou o Check Point - pode nos perguntar e n√≥s ajudaremos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt431146/">https://habr.com/ru/post/pt431146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt431136/index.html">Terabytes sem peso no bolso - o futuro est√° aqui? Explorando os recursos do HyperX SAVAGE EXO</a></li>
<li><a href="../pt431138/index.html">Biometria com a chave Rostelecom: como o FSB lan√ßou a criptografia russa pela primeira vez em lojas de aplicativos</a></li>
<li><a href="../pt431140/index.html">Relat√≥rio da metapa Go in Production: v√≠deo, fotos, apresenta√ß√µes</a></li>
<li><a href="../pt431142/index.html">Como executar o SQL Profiler Trace √† noite, em um hor√°rio espec√≠fico?</a></li>
<li><a href="../pt431144/index.html">Microfone Far Fields (matriz de microfone) - her√≥i impercept√≠vel em uma coluna inteligente</a></li>
<li><a href="../pt431148/index.html">A nova empresa m√≥vel iOS. Parte # 1: Gera√ß√£o de c√≥digo para recursos</a></li>
<li><a href="../pt431152/index.html">O metr√¥ 4 √© uma viagem de 6 anos. Uma Breve Hist√≥ria do Metro UI CSS</a></li>
<li><a href="../pt431154/index.html">Defici√™ncias nas miss√µes de Fallout 76 permitiram aos jogadores fazer o inferno nuclear</a></li>
<li><a href="../pt431156/index.html">CHOQUE! Novo software de phishing ganha segundo fator</a></li>
<li><a href="../pt431158/index.html">Mais caf√©, menos cafe√≠na: Intel 9a gera√ß√£o (parte 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>