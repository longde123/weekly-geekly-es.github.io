<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐คฝ๐ฝ ๐ฆ๐ฟ ูุฎุทุท ูุนูู ุฃู ุงููููู ุนู ExpressionTrees ๐ฉโ๐ญ ๐ง๐พโ๐คโ๐ง๐พ ๐๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูููู ุณูุชุญุฏุซ ุนู ููููุฉ ูุชุงุจุฉ AutoMapper . ูุนู ุ ุฃูุฏ ุญูุงู ุฅุฎุจุงุฑู ุจูุฐุง ุ ููู ูุง ูููููู ุฐูู. ูุงูุญูููุฉ ูู ุฃู ูุฐู ุงูุญููู ูุจูุฑุฉ ููุบุงูุฉ ุ ูููุง ุชุงุฑูุฎ ูู ุงูุชุฌุฑุจ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุฎุทุท ูุนูู ุฃู ุงููููู ุนู ExpressionTrees</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463961/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ry/x_/sj/ryx_sj0phsfsrlfz1tcxy2_8izs.jpeg" alt="ุตูุฑุฉ"><br><br>  ุงูููู ุณูุชุญุฏุซ ุนู ููููุฉ ูุชุงุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">AutoMapper</a> .  ูุนู ุ ุฃูุฏ ุญูุงู ุฅุฎุจุงุฑู ุจูุฐุง ุ ููู ูุง ูููููู ุฐูู.  ูุงูุญูููุฉ ูู ุฃู ูุฐู ุงูุญููู ูุจูุฑุฉ ููุบุงูุฉ ุ ูููุง ุชุงุฑูุฎ ูู ุงูุชุฌุฑุจุฉ ูุงูุฎุทุฃ ุ ููุง ูุทุนุช ุดูุทูุง ุทูููุงู ูู ุงูุชุทุจูู.  ูุง ูููููู ุฅูุง ุฃู ุฃููู ููู ูุนูู ูุฐุง ุ ูุฃุถู ููุทุฉ ุงูุทูุงู ูุฃููุฆู ุงูุฐูู ูุฑุบุจูู ูู ููู ุขููุฉ ุนูู "ุงููุตูููู".  ููููู ุฃู ุชููู ุฃููุง ุณููุชุจ ุฏุฑุงุฌุชูุง. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ุชูุตู </h3><br>  ุฃุฐูุฑู ูุฑุฉ ุฃุฎุฑู: ุณููุชุจ ูุฎุทุทูุง ุจุฏุงุฆููุง.  ุฅุฐุง ูุฑุฑุช ูุฌุฃุฉ ุชุนุฏููู ูุงุณุชุฎุฏุงูู ูู ุงูููุชุฌ - ููุง ุชูุนู ูุฐุง.  ุฎุฐ ุญูุงู ุฌุงูุฒูุง ูุนุฑู ูุฌููุนุฉ ุงููุดุงูู ูู ูุฐุง ุงูููุถูุน <i>ููุนุฑู ุจุงููุนู ููููุฉ</i> ุญููุง.  ููุงู ุงูุนุฏูุฏ ูู ุงูุฃุณุจุงุจ ุงูุฃูุซุฑ ุฃูููุฉ ุฃู ุฃูู ููุชุงุจุฉ ูุงุณุชุฎุฏุงู ูุตูู ุงูุฏุฑุงุฌุฉ ุงูุฎุงุต ุจู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุงูู ุจุนุถ ุงูุชุฎุตูุต ุงูุฎุงุต. </li><li style=";text-align:right;direction:rtl"> ุฃูุช ุจุญุงุฌุฉ ุฅูู ุฃูุตู ุฏุฑุฌุงุช ุงูุฃุฏุงุก ูู ุธุฑููู ูุฃูุช ูุณุชุนุฏ ูููุก ุงูุฃููุงุน. </li><li style=";text-align:right;direction:rtl">  ุชุฑูุฏ ุฃู ุชููู ููู ูุนูู ูุนูู. </li><li style=";text-align:right;direction:rtl">  ุฃูุช ููุท ุชุญุจ ุฑููุจ ุงูุฏุฑุงุฌุงุช. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ูุง ูุณูู ูููุฉ "ูุนูู"ุ </h3><br>  ูุฐุง ูู ุงููุธุงู ุงููุฑุนู ุงููุณุคูู ุนู ุฃุฎุฐ ูุงุฆู ูุชุญูููู (ูุณุฎ ูููู) ุฅูู ูุงุฆู ุขุฎุฑ.  ุงููููุฉ ุงููููุฐุฌูุฉ ูู ุชุญููู DTO ุฅูู ูุงุฆู ุทุจูุฉ ุนูู.  ูุนูู "ุงููุฎุทุท" ุงูุฃูุซุฑ ุจุฏุงุฆูุฉ ุนุจุฑ ุฎุตุงุฆุต ูุตุฏุฑ ุงูุจูุงูุงุช ูููุงุฑููุง ุจุฎุตุงุฆุต ููุน ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุฅุฎุฑุงุฌูุง.  ุจุนุฏ ุงููุทุงุจูุฉ ุ ูุชู ุงุณุชุฎุฑุงุฌ ุงูููู ูู ุงููุตุฏุฑ ููุชุงุจุชูุง ุฅูู ุงููุงุฆู ุ ูุงูุชู ุณุชููู ูุชูุฌุฉ ุงูุชุญููู.  ูู ููุงู ูุง ุ ุนูู ุงูุฃุฑุฌุญ ุ ุณูููู ูู ุงูุถุฑูุฑู ุฅูุดุงุก ูุฐู "ุงููุชูุฌุฉ" ุฐุงุชูุง. <br><br>  ุจุงููุณุจุฉ ูููุณุชููู ุ ูุฅู ุงููุฎุทุท ูู ุฎุฏูุฉ ุชููุฑ ุงููุงุฌูุฉ ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IMapper</span></span>&lt;<span class="hljs-title"><span class="hljs-title">out</span></span> <span class="hljs-title"><span class="hljs-title">TOut</span></span>&gt; { <span class="hljs-function"><span class="hljs-function">TOut </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> source</span></span></span><span class="hljs-function">)</span></span>; }</code> </pre> <br>  ูุฃุคูุฏ: ูุฐู ูู ุงููุงุฌูุฉ ุงูุฃูุซุฑ ุจุฏุงุฆูุฉ ูุงูุชู ุ ูู ูุฌูุฉ ูุธุฑู ุ ูุฑูุญุฉ ููุชูุณูุฑ.  ูู ุงููุงูุน ุ ูู ุงููุญุชูู ุฃู ูุชุนุงูู ูุน ูุนูู ุฃูุซุฑ ุชุญุฏูุฏูุง (IMapper &lt;TIn ุ TOut&gt;) ุฃู ูุน ูุงุฌูุฉ ุฃูุซุฑ ุนููููุฉ (IMapper) ุ ูุงูุชู ุณุชุญุฏุฏ ุจููุณูุง ูุนูููุง ูุญุฏุฏูุง ููุฃููุงุน ุงููุญุฏุฏุฉ ูู ูุงุฆูุงุช ุงูุฅุฏุฎุงู ูุงูุฅุฎุฑุงุฌ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูููุฐ ุณุงุฐุฌ </h3><br>  ููุงุญุธุฉ: ุญุชู ุงูุชูููุฐ ุงูุณุงุฐุฌ ููุฎุทุท ูุนูู ูุชุทูุจ ูุนุฑูุฉ ุฃุณุงุณูุฉ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Reflection</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ExpressionTrees</a> .  ุฅุฐุง ูู ุชูู ูุฏ ุงุชุจุนุช ุงูุฑูุงุจุท ุฃู ุณูุนุช ุฃู ุดูุก ุนู ูุฐู ุงูุชูููุงุช - ููู ุจุฐูู ุ ุงูุฑุฃูุง.  ุฃุนุฏู ุฃู ุงูุนุงูู ูู ูููู ูู ููุณู. <br><br>  ููุน ุฐูู ุ ููุชุจ ูุตูู ุงูุฎุฑุงุฆุท ุงูุฎุงุต ุจู.  ููุจุฏุก ุ ุฏุนููุง ูุญุตู ุนูู ุฌููุน ุงูุฎุตุงุฆุต ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PropertyInfo</a> ) ูููุน ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุฅุฎุฑุงุฌูุง (ูููุง ููู ุณูู ุฃุณูููุง <b>TOut</b> ).  ูุฐุง ุจุณูุท ููุบุงูุฉ: ูุญู ูุนุฑู ุงูููุน ุ ุญูุซ ููุชุจ ุชูููุฐ ูุฆุฉ ุนุงูุฉ ุฐุงุช ูุนููุงุช ุจููุน TOut.  ุจุนุฏ ุฐูู ุ ุจุงุณุชุฎุฏุงู ูุซูู ููุฆุฉ Type ุ ูุญุตู ุนูู ุฌููุน ุฎุตุงุฆุตู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Type outType = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TOut); PropertyInfo[] outProperties = outType.GetProperties();</code> </pre><br>  ุนูุฏ ุงูุญุตูู ุนูู ุงูุนูุงุฑุงุช ุ ุฃุบูู ุงูููุฒุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูููู ุจุนุถูุง ุจุฏูู ูุธููุฉ setter ุ ููุฏ ูุชู ุชุนููู ุงูุจุนุถ ุนูู ุฃููุง ูุชุฌุงููุฉ ูู ูุจู ุงูุณูุฉ ุ ููุฏ ูููู ุจุนุถูุง ูุน ูุตูู ุฎุงุต.  ูุญู ูุฏุฑุณ ุฃุจุณุท ุฎูุงุฑ. <br><br>  ูุฐูุจ ุฃุจุนุฏ ูู ุฐูู.  ุณูููู ูู ุงูุฌูุฏ ุฃู ุชููู ูุงุฏุฑูุง ุนูู ุฅูุดุงุก ูุซูู ูู ุงูููุน TOut ุ ุฃู ุงููุงุฆู ููุณู ุงูุฐู "ูููู" ุจุชุฎุทูุท ุงููุงุฆู ุงููุงุฑุฏ ููู.  ูู C # ุ ููุงู ุนุฏุฉ ุทุฑู ููููุงู ุจุฐูู.  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุงูููุงู ุจุฐูู: System.Activator.CreateInstance ().  ุฃู ุญุชู ููุท TOut () ุฌุฏูุฏ ุ ูููู ููุฐุง ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ุชูููุฏ ูู TOut ุ ูุงูุฐู ูุง ุชุฑูุฏ ุงูููุงู ุจู ูู ุงููุงุฌูุฉ ุงูุนุงูุฉ.  ููุน ุฐูู ุ ููุงูุง ูุนุฑู ุดูุฆูุง ุนู ExpressionTrees ุ ููุง ูุนูู ุฃูู ูููููุง ุงูููุงู ุจุฐูู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">ConstructorInfo outConstructor = outType.GetConstructor(Array.Empty&lt;Type&gt;()); Func&lt;TOut&gt; activator = outConstructor == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(<span class="hljs-string"><span class="hljs-string">$"Default constructor for </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{outType.Name}</span></span></span><span class="hljs-string"> not found"</span></span>) : Expression.Lambda&lt;Func&lt;TOut&gt;&gt;(Expression.New(outConstructor)).Compile();</code> </pre><br>  ููุงุฐุง ููุฐุงุ  ูุธุฑูุง ูุฃููุง ูุนูู ุฃู ูุซูู ูุฆุฉ Type ูููู ุฃู ููุฏู ูุนูููุงุช ุญูู ุงูููุดุฆุงุช ุงูููุฌูุฏุฉ ุจู - ููุฐุง ููุงุณุจ ุฌุฏูุง ููุญุงูุงุช ุงูุชู ููุฑุฑ ูููุง ุชุทููุฑ ูุนูููุง ุญุชู ูุชููู ูู ุชูุฑูุฑ ุฃู ุจูุงูุงุช ุฅูู ุงููููุดุฆ.  ุฃูุถูุง ุ ุชุนูููุง ุงููุฒูุฏ ุญูู ExpressionTrees ุ ุฃู ุฃููุง ุชุณูุญ ูููุญุฉ ุจุฅูุดุงุก ูุชุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูุงูุชู ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง ุจุนุฏ ุฐูู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูุธููุฉ ุชุจุฏู ุจุงููุนู () =&gt; TOut () ุฌุฏูุฏุฉ. <br><br>  ุฃูุช ุงูุขู ุจุญุงุฌุฉ ุฅูู ูุชุงุจุฉ ุทุฑููุฉ ูุนูู ูุนูู ุ ูุงูุชู ุณูู ุชูุณุฎ ุงูููู.  ุณูููู ุจูุชุงุจุนุฉ ุฃุจุณุท ุงูุทุฑู: ุชุตูุญ ุฎุตุงุฆุต ุงููุงุฆู ุงูุฐู ุฌุงุก ุฅูููุง ุนูุฏ ุงููุฏุฎู ุ ูุงุจุญุซ ุนู ุงูุฎุตุงุฆุต ุงูุชู ุชุญูู ุงูุงุณู ููุณู ุจูู ุฎุตุงุฆุต ุงููุงุฆู ุงูุตุงุฏุฑ.  ุฅุฐุง ูุฌุฏุช - ูุณุฎุฉ ุ ุฅู ูู ููู - ุงููุถู ูุฏูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">TOut outInstance = _activator(); PropertyInfo[] sourceProperties = source.GetType().GetProperties(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; sourceProperties.Length; i++) { PropertyInfo sourceProperty = sourceProperties[i]; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> propertyName = sourceProperty.Name; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_outProperties.TryGetValue(propertyName, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> PropertyInfo outProperty)) { <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> sourceValue = sourceProperty.GetValue(source); outProperty.SetValue(outInstance, sourceValue); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outInstance;</code> </pre><br>  ูุจุงูุชุงูู ุ ูููุง ุจุชูููู ูุฆุฉ <a href="">BasicMapper</a> ุจุงููุงูู.  ููููู ุงูุชุนุฑู ุนูู ุงุฎุชุจุงุฑุงุชู <a href="">ููุง</a> .  ูุฑุฌู ููุงุญุธุฉ ุฃู ุงููุตุฏุฑ ูููู ุฃู ูููู ุฅูุง ูุงุฆููุง ูู ุฃู ููุน ูุนูู ุฃู ูุงุฆููุง ูุฌููู ุงููููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฃุฏุงุก ูุงูููุงููุฉ </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุนูุงุณ</a> ูุจูุฑ ุ ูููู ุจุทูุฆุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุคุฏู ุงูุงุณุชุฎุฏุงู ุงููุชูุฑุฑ ุฅูู ุฒูุงุฏุฉ ุญุฑูุฉ ุงูุฐุงูุฑุฉ ุ ููุง ูุนูู ุฃูู ูููู ุจุชุญููู GC ุ ููุง ูุนูู ุฃูู ูุจุทุฆ ุงูุชุทุจูู ุฃูุซุฑ.  ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุฎุฏููุง ููุท ุฃุณุงููุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PropertyInfo.SetValue</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PropertyInfo.GetValue</a> .  ุฅุฑุฌุงุน ุงูุฃุณููุจ GetValue ูุงุฆู ููู ุงูุชูุงู ูููุฉ ูุนููุฉ (ุงูููุงููุฉ).  ูุฐุง ูุนูู ุฃููุง ุชููููุง ูุฎุตุตูุง ูู ุงูุจุฏุงูุฉ. <br><br>  ุนุงุฏุฉู ูุง ุชูุฌุฏ ุงููุฎุทุทุงุช ุญูุซ ุชุญุชุงุฌ ุฅูู ุชุญููู ูุงุฆู ุฅูู ูุงุฆู ุขุฎุฑ ... ูุง ุ ููุณ ูุงุฆููุง ูุงุญุฏูุง ุ ูููู ููุฌุฏ ุงูุนุฏูุฏ ูู ุงููุงุฆูุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ูุฃุฎุฐ ุดูุฆุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ูู ูุฐุง ุงูููุงู ุ ุฃูุฏ ุฃู ุฃุฑู ุงูุฃุฏุงุก ุงูุนุงุฏู ูุฃูุง ุฃููุฏ ุงูุฐุงูุฑุฉ ูู ุงูุนูููุฉ ุงูุฃูููุฉ. <br><br>  ูุงุฐุง ูููููุง ุฃู ููุนูุ  ุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ExpressionTrees</a> ูุณุงุนุฏุชูุง ูุฑุฉ ุฃุฎุฑู.  ูุงูุญูููุฉ ูู ุฃู .NET ูุณูุญ ูู ุจุฅูุดุงุก ูุชุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ "ุณุฑูุนูุง": ูุตููุง ูู ุชูุซูู ุงููุงุฆู ููููู ูุงุฐุง ูุฃูู ุณูุณุชุฎุฏูู ... ูุชุฌููุนู.  ุชูุฑูุจุง ูุง ุงูุณุญุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุฎุทุท ูุนูู </h3><br>  ูู ุงููุงูุน ุ ูู ุดูุก ุจุณูุท ูุณุจููุง: ููุฏ ูุนููุง ุฌุฏูุฏูุง ุจุงููุนู ูุน Expression.New (ConstructorInfo).  ุฑุจูุง ูุงุญุธุช ุฃู ุงูุทุฑููุฉ ุงูุฌุฏูุฏุฉ ุงูุซุงุจุชุฉ ุชุณูู ุจุงูุถุจุท ููุณ ุงููุดุบู.  ุงูุญูููุฉ ูู ุฃู ูู ูุบุฉ C # ุชูุฑูุจูุง ุชูุนูุณ ูู ุดูู ุทุฑู ุซุงุจุชุฉ ููุฆุฉ ุงูุชุนุจูุฑ.  ุฅุฐุง ูุงู ููุงู ุดูุก ููููุฏ ุ ููุฐุง ูุนูู ุฃูู ุชุจุญุซ ุนู ูุง ูุณูู  "ุงูุณูุฑ ุงููุญูู." <br><br>  ุฅููู ุจุนุถ ุงูุนูููุงุช ุงูุชู ุณูุณุชุฎุฏููุง ูู ูุฎุทุทูุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุนูุงู ูุชุบูุฑ - Expression.Variable (ุงูููุน ุ ุณูุณูุฉ).  ุชุฎุจุฑ ูุณูุทุฉ Type ููุน ุงููุชุบูุฑ ุงูุฐู ุณูุชู ุฅูุดุงุคู ุ ูุงูุณูุณูุฉ ูู ุงุณู ุงููุชุบูุฑ. </li><li style=";text-align:right;direction:rtl">  ุงููุงุฌุจ - ุงูุชุนุจูุฑ. ุงูุชุนููู (ุงูุชุนุจูุฑ ุ ุงูุชุนุจูุฑ).  ุงููุณูุทุฉ ุงูุฃููู ูู ูุง ูุฎุตุตู ุ ูุงูุญุฌุฉ ุงูุซุงููุฉ ูู ูุง ูุฎุตุตู. </li><li style=";text-align:right;direction:rtl">  ุงููุตูู ุฅูู ุฎุงุตูุฉ ูุงุฆู ูู Expression.Property (ุงูุชุนุจูุฑ ุ PropertyInfo).  Expression ูู ูุงูู ุงูุนูุงุฑ ุ ู PropertyInfo ูู ุชูุซูู ูุงุฆู ุงูุฎุงุตูุฉ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุฎูุงู Reflection. </li></ul><br>  ูุน ูุฐู ุงููุนุฑูุฉ ุ ูููููุง ุฅูุดุงุก ูุชุบูุฑุงุช ุ ูุงููุตูู ุฅูู ุฎุตุงุฆุต ุงููุงุฆูุงุช ุ ูุชุนููู ููู ูุฎุตุงุฆุต ุงููุงุฆูุงุช.  ุนูู ุงูุฃุฑุฌุญ ุ ูุญู ูููู ุฃูุถูุง ุฃู ExpressionTree ูุญุชุงุฌ ุฅูู ุชุฑุฌูุฉ ุฅูู ูููุถ ุงููููุฐุฌ <b>Func &lt;objectุ TOut&gt;</b> .  ุงูุฎุทุฉ ูู: ูุญุตู ุนูู ูุชุบูุฑ ูุญุชูู ุนูู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุ ูุฅูุดุงุก ูุซูู ูู ููุน TOut ูุฅูุดุงุก ุชุนุจูุฑุงุช ุชุนูู ุฎุงุตูุฉ ูุงุญุฏุฉ ุฅูู ุฃุฎุฑู. <br><br>  ูุณูุก ุงูุญุธ ุ ุงูููุฏ ููุณ ูุถุบูุทูุง ุฌุฏูุง ุ ูุฐูู ุฃูุชุฑุญ ุนููู ุฅููุงุก ูุธุฑุฉ ุนูู ุชุทุจูู <a href="">CompiledMapper ุนูู</a> ุงูููุฑ.  ุงุญุถุฑุช ููุง ููุท ุงูููุงุท ุงูุฑุฆูุณูุฉ. <br><br>  ุฃููุงู ุ ูููู ุจุฅูุดุงุก ุชูุซูู ูุงุฆู ููุนููุฉ ูุธููุชูุง.  ูุธุฑูุง ูุฃูู ูุฃุฎุฐ ูุงุฆููุง ููุฏุฎู ุ ูุฅู ุงููุงุฆู ุณูููู ูุนููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parameter = Expression.Parameter(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>), <span class="hljs-string"><span class="hljs-string">"source"</span></span>);</code> </pre><br>  ุจุนุฏ ุฐูู ุ ููุดุฆ ูุชุบูุฑูู ููุงุฆูุฉ ุชุนุจูุฑุงุช ูุถูู ุฅูููุง ุชุนุจูุฑุงุช ุงูุชุนููู ุจุงูุชุณูุณู.  ุงูุชุฑุชูุจ ููู ุ ูุฃู ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ุณูุชู ุจูุง ุชูููุฐ ุงูุฃูุงูุฑ ุนูุฏูุง ูุณูููุง ุงูุทุฑููุฉ ุงููุชุฑุฌูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุง ูููููุง ุชุนููู ูููุฉ ููุชุบูุฑ ูู ูุชู ุงูุฅุนูุงู ุนูู ุจุนุฏ. <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ุจุงูุทุฑููุฉ ููุณูุง ููุง ูู ุญุงูุฉ ุงูุชุทุจูู ุงูุณุงุฐุฌ ุ ูุฐูุจ ุฅูู ูุงุฆูุฉ ุฎุตุงุฆุต ุงูููุน ููุญุงูู ูุทุงุจูุชูุง ุจุงูุงุณู.  ููุน ุฐูู ุ ุจุฏูุงู ูู ุชุนููู ุงูููู ุนูู ุงูููุฑ ุ ูููู ุจุฅูุดุงุก ุชุนุจูุฑุงุช ูุงุณุชุฎุฑุงุฌ ุงูููู ูุชุนููู ุงูููู ููู ุฎุงุตูุฉ ูุฑุชุจุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Expression sourceValue = Expression.Property(sourceInstance, sourceProperty); Expression outValue = Expression.Property(outInstance, outProperty); expressions.Add(Expression.Assign(outValue, sourceValue));</code> </pre><br>  ููุทุฉ ูููุฉ: ุจุนุฏ ุฃู ุฃูุดุฃูุง ุฌููุน ุนูููุงุช ุงูุชุนููู ุ ูุญุชุงุฌ ุฅูู ุฅุฑุฌุงุน ุงููุชูุฌุฉ ูู ุงููุธููุฉ.  ููููุงู ุจุฐูู ุ ูุฌุจ ุฃู ูููู ุงูุชุนุจูุฑ ุงูุฃุฎูุฑ ูู ุงููุงุฆูุฉ ูู ุงูุชุนุจูุฑ ุ ูุงูุฐู ูุญุชูู ุนูู ูุซูู ุงููุฆุฉ ุงูุชู ุฃูุดุฃูุงูุง.  ุชุฑูุช ุชุนููู ุจุฌุงูุจ ูุฐุง ุงูุฎุท.  ููุงุฐุง ูุจุฏู ุงูุณููู ุงูููุงุจู ูููููุฉ ุงูุฑุฆูุณูุฉ ุงููุฑุชุฌุนุฉ ูู ExpressionTree ุจูุฐุง ุงูุดููุ  ุฃุฎุดู ุฃู ูุฐู ูุถูุฉ ูููุตูุฉ.  ุงูุขู ุฃูุชุฑุญ ุฃูู ูู ุงูุณูู ุฃู ูุชุฐูุฑ. <br><br>  ุญุณููุง ุ ูู ุงูููุงูุฉ ุ ุนูููุง ุฃู ูุฌูุน ูู ุงูุชุนุจูุฑุงุช ุงูุชู ุจูููุงูุง.  ูุง ุงูุฐู ููููุง ููุงุ  ูุญุชูู ูุชุบูุฑ ุงูุฌุณู ุนูู "ูุต" ุงููุธููุฉ.  "ูุธุงุฆู ุนุงุฏูุฉ" ููุง ุฌุณู ุ ุฃููุณ ูุฐููุ  ุญุณูุง ุ ุงูุฐู ูุฑููู ูู ุงูุฃููุงุณ.  ูุฐูู ุ Expression.Block ูู ุฐูู ุจุงูุถุจุท.  ูุธุฑูุง ูุฃู ุงูุฃููุงุณ ุงููุชุนุฑุฌุฉ ูู ุฃูุถูุง ูุทุงู ุ ูุฌุจ ุฃู ููุฑ ููุงู ุฅูู ุงููุชุบูุฑุงุช ุงูุชู ุณูุชู ุงุณุชุฎุฏุงููุง ููุงู - ูู ุญุงูุชูุง sourceInstance ู outInstance. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">var body = Expression.Block(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {sourceInstance, outInstance}, expressions); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Expression.Lambda&lt;Func&lt;object, TOut&gt;&gt;(body, parameter).Compile();</code> </pre><br>  ูู ุงูุฅุฎุฑุงุฌ ุ ูุญุตู ุนูู Func &lt;object ุ TOut&gt; ุ ุฃู  ุฏุงูุฉ ูููููุง ุชุญููู ุงูุจูุงูุงุช ูู ูุงุฆู ุฅูู ุขุฎุฑ.  ููุงุฐุง ูุฐู ุงูุตุนูุจุงุช ุ ุชุณุฃูุ  ุฃุฐูุฑู ุจุฃููุง ุฃููุงู ุ ุฃุฑุฏูุง ุชุฌูุจ ุงูููุงููุฉ ุนูุฏ ูุณุฎ ููู ValueType ุ ูุซุงููุงู ุ ุฃุฑุฏูุง ุงูุชุฎูู ุนู ุฃุณุงููุจ PropertyInfo.GetValue ู PropertyInfo.SetValue ุ ูุฃููุง ุจุทูุฆุฉ ุจุนุถ ุงูุดูุก. <br><br>  ููุงุฐุง ูุง ุงูููุงููุฉุ  ูุธุฑูุง ูุฃู ExpressionTree ุงููุชุฑุฌูุฉ ุนุจุงุฑุฉ ุนู IL ุญูููู ุ ููุฃูู ูุดุจู ููุช ุงูุชุดุบูู (ุชูุฑูุจูุง) ูุซู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู.  ููุงุฐุง "ูุฎุทุท ุงููุชุฑุฌูุฉ" ุฃุณุฑุนุ  ูุฑุฉ ุฃุฎุฑู: ูุฃููุง ูุฌุฑุฏ IL IL.  ุจุงูููุงุณุจุฉ ุ ูููููุง ุจุณูููุฉ ุชุฃููุฏ ุงูุณุฑุนุฉ ุจุงุณุชุฎุฏุงู ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">BenchmarkDotNet</a> ุ ููููู ุงูุงุทูุงุน ุนูู ุงููุคุดุฑ ููุณู <a href="">ููุง</a> . <br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><thead><tr><th>  ุทุฑููุฉ </th><th>  ูุชูุณุท </th><th>  ุฎุทุฃ </th><th>  StdDev </th><th>  ูุณุจุฉ </th><th>  ุชุฎุตูุต </th></tr></thead><tbody><tr><td>  AutoMapper </td><td>  1291.6 ููุง </td><td>  3.3173 ููุง </td><td>  3.1030 ููุง </td><td>  1.00 </td><td>  312.5 ููููุจุงูุช </td></tr><tr><td>  Velo_BasicMapper </td><td>  11ุ987.0 ููุง </td><td>  33.8389 ููุง </td><td>  28.2570 ููุง </td><td>  9.28 </td><td>  3437.5 ููููุจุงูุช </td></tr><tr><td>  Velo_CompiledMapper </td><td>  341.3 ููุง </td><td>  2.8230 ููุง </td><td>  2.6407 ููุง </td><td>  0.26 </td><td>  312.5 ููููุจุงูุช </td></tr></tbody></table></div><br>  ูู ุนููุฏ "ุงููุณุจุฉ" ุฃุธูุฑ "ูุฎุทุท ุงููุชุฑุฌูุฉ" (CompiledMapper) ูุชูุฌุฉ ุฌูุฏุฉ ููุบุงูุฉ ุ ุญุชู ุจุงูููุงุฑูุฉ ูุน "ุฑุณู ุชููุงุฆู" (ููู ุงูุฃุณุงุณ ุ ุฃู 1).  ููุน ุฐูู ุ ุฏุนููุง ูุง ููุฑุญ: ูุชูุชุน AutoMapper ุจูุฏุฑุงุช ุฃูุจุฑ ุจูุซูุฑ ููุงุฑูุฉ ุจุงูุฏุฑุงุฌุฉ.  ูุน ูุฐู ุงูููุญุฉ ุ ุฃุฑุฏุช ููุท ุฃู ุฃูุถุญ ุฃู ExpressionTrees ุฃุณุฑุน ุจูุซูุฑ ูู "ุทุฑููุฉ ุงูุชูููุฑ ุงูููุงุณูููุฉ". <br><br><h3 style=";text-align:right;direction:rtl">  ููุฎุต </h3><br>  ุขูู ุฃู ุฃุชููู ูู ุฅุธูุงุฑ ุฃู ูุชุงุจุฉ ูุฎุทุทู ุจุณูุท ููุบุงูุฉ.  ุฅู Reflection ู ExpressionTrees ุฃุฏูุงุช ูููุฉ ููุบุงูุฉ ูุณุชุฎุฏููุง ุงููุทูุฑูู ูุญู ุงูุนุฏูุฏ ูู ุงูููุงู ุงููุฎุชููุฉ.  ุญูู ุงูุชุจุนูุฉ ุ ุงูุชุณูุณู / ุฅูุบุงุก ุงูุชุณูุณู ุ ูุณุชูุฏุนุงุช CRUD ุ ุฅูุดุงุก ุงุณุชุนูุงูุงุช SQL ุ ุจุงุณุชุฎุฏุงู ูุบุงุช ุฃุฎุฑู ููุตูุต ุจุฑูุฌูุฉ ูุชุทุจููุงุช .NET - ูู ูุฐุง ูุชู ุจุงุณุชุฎุฏุงู Reflection ู Reflection.Emit ู ExpressionTrees. <br><br>  ูุงุฐุง ุนู ูุฎุทุทุ  ูุนุฏ ูุฎุทุท ุงูุฎุฑุงุฆุท ูุซุงููุง ุฑุงุฆุนูุง ุญูุซ ููููู ุชุนูู ูู ูุฐุง. <br><br>  ููุงุญุธุฉ: ุฅุฐุง ููุช ุชุฑูุฏ ุงููุฒูุฏ ูู ExpressionTrees ุ ุฃูุชุฑุญ ุงููุฑุงุกุฉ ุญูู ููููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌุนู ูุญูู JSON ุงูุฎุงุต ุจู</a> ุจุงุณุชุฎุฏุงู ูุฐู ุงูุชูููุฉ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar463961/">https://habr.com/ru/post/ar463961/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar463943/index.html">ูุบุงูุฑุงุช ููููููุฑู ุงูุณูุฏุงุก</a></li>
<li><a href="../ar463951/index.html">c.tech: ูุงุณุงูุฏุฑุง ููุชูุจ # 2</a></li>
<li><a href="../ar463953/index.html">ุชุทุจูู ููุท ุชุตููู ุงูููุงุฏุฉ ูู ุงููุญุฏุฉ</a></li>
<li><a href="../ar463955/index.html">ููููุฉ ุชุทููุฑ ููููู ูุชุบููุฑ ููุตุฉ IPุ ุชุนูููุงุช ููุงุณุชุฎุฏุงู</a></li>
<li><a href="../ar463957/index.html">ููููุฉ ูุดุฑ ูุงุฆูุฉ ููุงุจูุฉ ูุฑุชุจุทุฉ ูููุฑุฏุฉ</a></li>
<li><a href="../ar463963/index.html">ุงูุชุนุฑู ุนูู ุงููุฌูู ูู ูููุน ุงูุจูุงุก</a></li>
<li><a href="../ar463965/index.html">ุชุทุจูู Typeset ูู LaTeX</a></li>
<li><a href="../ar463969/index.html">ููุฒุงููุฉ ุงูุฃุณุฑุฉ ุจุฑููุฉ</a></li>
<li><a href="../ar463971/index.html">ููุงุญุธุงุช Pentester: ุญุงูุงุช ุงูุตูุฏ</a></li>
<li><a href="../ar463975/index.html">ุงูุจูุฆุฉ ุงูุญุฏูุซุฉ ููุชุทุจููุงุช ุงูุฃุตููุฉ ููุชูุงุนู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>