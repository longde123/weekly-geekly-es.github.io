<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คณ๐ฟ โน๐ผ ๐จโ๐ง ูู ุญุฐุฑุง ูู ููุงุท ุงูุถุนู ุงูุชู ุชุฌูุจ ุงูุญููู. ุงูุฌุฒุก 1: FragmentSmack / SegmentSmack ๐ง๐ผโ๐คโ๐ง๐ป โ๏ธ โ๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ุจุงูุฌููุน! ุงุณูู ุฏููุชุฑู ุณุงูุณูููู ุ ุฃุนูู ููุณุคูู ูุธุงู ุฑุงุฆุฏ ูู Odnoklassniki. ูุฏููุง ุฃูุซุฑ ูู 7 ุขูุงู ุฎุงุฏู ูุนูู ุ ู 11 ุฃูู ุญุงููุฉ ูู ุงูุณุญุงุจุฉ ูุฏููุง ู 200 ุช...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูู ุญุฐุฑุง ูู ููุงุท ุงูุถุนู ุงูุชู ุชุฌูุจ ุงูุญููู. ุงูุฌุฒุก 1: FragmentSmack / SegmentSmack</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/475540/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kc/qy/tg/kcqytg4znoagvdqffwtwxhwzcjs.jpeg"></div><br><br>  ูุฑุญุจุง ุจุงูุฌููุน!  ุงุณูู ุฏููุชุฑู ุณุงูุณูููู ุ ุฃุนูู ููุณุคูู ูุธุงู ุฑุงุฆุฏ ูู Odnoklassniki.  ูุฏููุง ุฃูุซุฑ ูู 7 ุขูุงู ุฎุงุฏู ูุนูู ุ ู 11 ุฃูู ุญุงููุฉ ูู ุงูุณุญุงุจุฉ ูุฏููุง ู 200 ุชุทุจูู ุ ูุงูุชู ุชุดูู ุจุชููููุงุช ูุฎุชููุฉ 700 ูุฌููุนุฉ ูุฎุชููุฉ.  ุงูุบุงูุจูุฉ ุงูุนุธูู ูู ุงูุฎูุงุฏู ุชุนูู ุจูุธุงู CentOS 7. <br>  ูุนูููุงุช ุงูุถุนู FragmentSmack ุชู ุฅุตุฏุงุฑูุง ูู 14 ุฃุบุณุทุณ 2018 <br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CVE-2018-5391</a> ) ู SegmentSmack ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CVE-2018-5390</a> ).  ูุฐู ุซุบุฑุงุช ุฃูููุฉ ูุน ูุงูู ุงููุฌูู ุนูู ุงูุดุจูุฉ ูุชุตููู ูุฑุชูุน ุฅูู ุญุฏ ูุง (7.5) ุ ููุง ููุฏุฏ ุจุฑูุถ ุงูุฎุฏูุฉ (DoS) ุจุณุจุจ ุงุณุชููุงุฏ ุงูููุงุฑุฏ (CPU).  ูู ูุชู ุงูุชุฑุงุญ ุฅุตูุงุญ ูู kernel ูู FragmentSmack ูู ุฐูู ุงูููุช ุ ุนูุงูุฉ ุนูู ุฐูู ุ ููุฏ ุฌุงุก ุจุนุฏ ููุช ุทููู ูู ูุดุฑ ุงููุนูููุงุช ุญูู ูุดููุฉ ุนุฏู ุงูุญุตุงูุฉ.  ูููุถุงุก ุนูู SegmentSmack ุ ุชู ุงูุชุฑุงุญ ุชุญุฏูุซ ุงูููุงุฉ.  ุชู ุฅุตุฏุงุฑ ุญุฒูุฉ ุงูุชุญุฏูุซ ููุณูุง ูู ููุณ ุงูููู ุ ููุงู ูู ูุง ุชุจูู ูู ุชุซุจูุชู. <br>  ูุง ุ ูุญู ูุณูุง ุนูู ุงูุฅุทูุงู ุถุฏ ุชุญุฏูุซ ุงูููุงุฉ!  ููุน ุฐูู ุ ููุงู ูุฑูู ุฏูููุฉ ... <br><a name="habracut"></a><br><h4 style=";text-align:right;direction:rtl">  ููู ูููููุง ุชุญุฏูุซ ุงูุฃุณุงุณูุฉ ุนูู ููุฒ </h4><br>  ุจุดูู ุนุงู ุ ูุง ุดูุก ูุนูุฏ: <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญููู ุงูุญุฒู </li><li style=";text-align:right;direction:rtl">  ุชุซุจูุชูุง ุนูู ุนุฏุฏ ูู ุงูุฎูุงุฏู (ุจูุง ูู ุฐูู ุงูุฎูุงุฏู ุงูุชู ุชุณุชุถูู ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูุง) ุ </li><li style=";text-align:right;direction:rtl">  ุชุฃูุฏ ูู ุนุฏู ูุณุฑ ุฃู ุดูุก ุ </li><li style=";text-align:right;direction:rtl">  ุชุฃูุฏ ูู ุชุทุจูู ุฌููุน ุฅุนุฏุงุฏุงุช kernel ุงูููุงุณูุฉ ุฏูู ุฃุฎุทุงุก ุ </li><li style=";text-align:right;direction:rtl">  ุงูุชุธุฑ ุจุถุนุฉ ุงูุงู </li><li style=";text-align:right;direction:rtl">  ุชุญูู ุฃุฏุงุก ุงูุฎุงุฏู ุ </li><li style=";text-align:right;direction:rtl">  ุชุจุฏูู ูุดุฑ ุฎูุงุฏู ุฌุฏูุฏุฉ ุฅูู ููุงุฉ ุฌุฏูุฏุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชุญุฏูุซ ุฌููุน ุงูุฎูุงุฏู ุจูุงุณุทุฉ ูุฑุงูุฒ ุงูุจูุงูุงุช (ูุฑูุฒ ุจูุงูุงุช ูุงุญุฏ ูู ูู ูุฑุฉ ูุชูููู ุงูุชุฃุซูุฑ ูููุณุชุฎุฏููู ูู ุญุงูุฉ ุญุฏูุซ ูุดููุงุช) ุ </li><li style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุชุดุบูู ุฌููุน ุงูุฎูุงุฏู. </li></ol><br>  ูุฑุฑ ุฌููุน ูุฑูุน ุงูููู ูุฏููุง.  ูู ูุฐู ุงููุญุธุฉ ูุฐุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Stock CentOS 7 3.10 - ููุนุธู ุงูุฎูุงุฏู ุงูุนุงุฏูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงููุงููููุง 4.19 ูุฎุตุตุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุญุงุจุฉ ูุงุญุฏุฉ</a> ูุฃููุง ูุญุชุงุฌ ุฅูู BFQ ุ BBR ุ ุฅูุฎ ุ </li><li style=";text-align:right;direction:rtl">  Elrepo kernel-ml 5.2 ูุฎุตุต <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููุฒุนูู ุฐูู ุงูุชุญููู ุงูุนุงูู</a> ุ ูุฃู 4.19 ูุงู ูุชุตุฑู ุจุดูู ุบูุฑ ูุณุชูุฑ ุ ูุงูููุฒุงุช ุชุญุชุงุฌ ุฅูู ููุณ ุงูุนูุงุตุฑ. </li></ul><br>  ููุง ููุช ูุฏ ุฎููุช ุ ูุฅู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุขูุงู ูู ุงูุฎูุงุฏู ุชุณุชุบุฑู ูุนุธู ุงูููุช.  ูุธุฑูุง ูุฃู ุฌููุน ููุงุท ุงูุถุนู ููุณุช ุญุงุณูุฉ ุจุงููุณุจุฉ ูุฌููุน ุงูุฎูุงุฏู ุ ูุฅููุง ูุนูุฏ ุชุดุบูู ุชูู ุงูุชู ูููู ุงููุตูู ุฅูููุง ูุจุงุดุฑุฉ ูู ุงูุฅูุชุฑูุช ููุท.  ูู ุงูุณุญุงุจุฉ ุ ุญุชู ูุง ูุญุฏ ูู ุงููุฑููุฉ ุ ูุง ูุฑุจุท ุงูุญุงููุงุช ุงูุชู ูููู ุงููุตูู ุฅูููุง ุฎุงุฑุฌููุง ุจุงูุฎูุงุฏู ุงููุฑุฏูุฉ ุจููุงุฉ ุฌุฏูุฏุฉ ุ ูููููุง ูุนูุฏ ุชุดุบูู ุฌููุน ุงูุฃุฌูุฒุฉ ุงููุถููุฉ ุฏูู ุงุณุชุซูุงุก.  ูุญุณู ุงูุญุธ ุ ูููู ุงูุฅุฌุฑุงุก ุฃุณูู ูู ุงูุฎูุงุฏู ุงูุนุงุฏูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ุชูุชูู ุญุงููุงุช ุนุฏููู ุงูุฌูุณูุฉ ุจุจุณุงุทุฉ ุฅูู ุฎุงุฏู ุขุฎุฑ ุฃุซูุงุก ุฅุนุงุฏุฉ ุงูุชุดุบูู. <br><br>  ููุน ุฐูู ุ ูุง ูุฒุงู ููุงู ุงููุซูุฑ ูู ุงูุนูู ุ ููุฏ ูุณุชุบุฑู ุงูุฃูุฑ ุนุฏุฉ ุฃุณุงุจูุน ุ ููู ุญุงูุฉ ูุฌูุฏ ุฃู ูุดููุฉ ูู ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ - ุญุชู ุนุฏุฉ ุฃุดูุฑ.  ูุฏุฑู ุงูููุงุฌููู ูุฐุง ุฌูุฏูุง ุ ูุฐูู ููุงู ุญุงุฌุฉ ุฅูู ุงูุฎุทุฉ B. <br><br><h4 style=";text-align:right;direction:rtl">  FragmentSmack / SegmentSmack.  ุงูุญู </h4><br>  ูุญุณู ุงูุญุธ ุ ุจุงููุณุจุฉ ูุจุนุถ ููุงุท ุงูุถุนู ุ ุชูุฌุฏ ูุซู ูุฐู ุงูุฎุทุฉ "B" ุ ููุณูู Workaround.  ุบุงูุจูุง ูุง ูููู ูุฐุง ุชุบููุฑูุง ูู ุฅุนุฏุงุฏุงุช kernel / application ุ ููุง ูููู ุฃู ูููู ูู ุงูุชุฃุซูุฑ ุงููุญุชูู ุฃู ูุฒูู ุงุณุชุบูุงู ุงูุซุบุฑุงุช ุจุงููุงูู. <br><br>  ูู ุญุงูุฉ FragmentSmack / SegmentSmack <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุ</a> ุชู ุงูุชุฑุงุญ ุงูุญู ุงูุจุฏูู ุงูุชุงูู: <br><br><blockquote style=";text-align:right;direction:rtl">  " <i>ููููู ุชุบููุฑ ุงูููู ุงูุงูุชุฑุงุถูุฉ ููู 4 ููุฌุงุจุงูุช ู 3 ููุฌุงุจุงูุช ูู net.ipv4.ipfrag_high_thresh ู net.ipv4.ipfrag_low_thresh (ููุธุงุฆุฑูุง ุงูุฎุงุตุฉ ุจู ipv6 net.ipv6.ipfrag_high_thresh ู net.ipv6.ipfrag_low_thresh) ุฅูู 256 ูููู ุจุงูุช ู 192 ูููู ุจุงูุช ุนูู ุงูุชูุงูู.</i>  <i>ุชูุธูุฑ ุงูุงุฎุชุจุงุฑุงุช ุงูุฎูุงุถูุง ุจุณูุทูุง ุฅูู ุงูุฎูุงุถ ูุจูุฑ ูู ุงุณุชุฎุฏุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุฃุซูุงุก ุงููุฌูู ุ ุงุนุชูุงุฏูุง ุนูู ุงููุนุฏุงุช ูุงูุฅุนุฏุงุฏุงุช ูุงูุธุฑูู.</i>  <i>ููุน ุฐูู ุ ูุฏ ูููู ููุงู ุจุนุถ ุงูุชุฃุซูุฑ ูู ุงูุฃุฏุงุก ุจุณุจุจ ipfrag_high_thresh = 262144 ุจุงูุช ุ ูุธุฑูุง ูุฃู ุดุธุงูุง 64 ูููู ููุท ููุท ูููู ุฃู ุชูุฏุฑุฌ ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ุฅุนุงุฏุฉ ุงูุจูุงุก ูู ูู ูุฑุฉ.</i>  <i>ุนูู ุณุจูู ุงููุซุงู ุ ููุงู ุฎุทุฑ ูู ุชุนุทู ุงูุชุทุจููุงุช ุงูุชู ุชุนูู ูุน ุญุฒู UDP ุงููุจูุฑุฉ</i> . " </blockquote><br>  ูุชู ูุตู ุงููุนููุงุช ููุณูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ูุซุงุฆู kernel</a> ููุง ููู: <br><br><blockquote style=";text-align:right;direction:rtl"><code>ipfrag_high_thresh - LONG INTEGER <br> Maximum memory used to reassemble IP fragments.</code> </blockquote> <br><p style=";text-align:right;direction:rtl"></p><blockquote style=";text-align:right;direction:rtl"> <code>ipfrag_low_thresh - LONG INTEGER <br> Maximum memory used to reassemble IP fragments before the kernel <br> begins to remove incomplete fragment queues to free up resources. <br> The kernel still accepts new fragments for defragmentation.</code> </blockquote> <br>  ููุณ ูุฏููุง UDP ูุจูุฑุฉ ุนูู ุฎุฏูุงุช ุงูุฅูุชุงุฌ.  ูุง ุชูุฌุฏ ุญุฑูุฉ ูุฑูุฑ ูุฌุฒุฃุฉ ุนูู ุดุจูุฉ LAN ุ ูููุงู ุ ูููู ููุณ ุ ุญุฑูุฉ ูุฑูุฑ ูุจูุฑุฉ ุนูู ุดุจูุฉ WAN.  ูุง ุดูุก bodes - ููููู ููุฉ Workaround! <br><br><h4 style=";text-align:right;direction:rtl">  FragmentSmack / SegmentSmack.  ุงูุฏู ุงูุฃูู </h4><br>  ุงููุดููุฉ ุงูุฃููู ุงูุชู ูุงุฌููุงูุง ูู ุฃู ุงูุญุงููุงุช ุงูุณุญุงุจูุฉ ูุงูุช ุชุทุจู ุฌุฒุฆููุง ุงูุฅุนุฏุงุฏุงุช ุงูุฌุฏูุฏุฉ ูู ุจุนุถ ุงูุฃุญูุงู ููุท (ipfrag_low_thresh ููุท) ุ ูุฃุญูุงููุง ูู ุชุณุชุฎุฏููุง ุนูู ุงูุฅุทูุงู - ููุฏ ุชุนุทูุช ููุท ูู ุงูุจุฏุงูุฉ.  ูู ููู ูู ุงููููู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุดููุฉ ุจุซุจุงุช (ูุฏููุงู ุชู ุชุทุจูู ูุงูุฉ ุงูุฅุนุฏุงุฏุงุช ุฏูู ุฃู ุตุนูุจุงุช).  ููุง ุฃู ููู ุณุจุจ ุณููุท ุงูุญุงููุฉ ูู ุงูุจุฏุงูุฉ ููุณ ุจูุฐู ุงูุจุณุงุทุฉ: ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃุฎุทุงุก.  ูุงู ููุงู ุดูุก ูุงุญุฏ ูุคูุฏ: ุงูุชุฑุงุฌุน ุนู ุงูุฅุนุฏุงุฏุงุช ูุญู ูุดููุฉ ุฅุณูุงุท ุงูุญุงููุงุช. <br><br>  ููุงุฐุง ูุง ูููู ุงุณุชุฎุฏุงู Sysctl ุนูู ุงููุถููุ  ุชุนูุด ุงูุญุงููุฉ ูู Namespace <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฎุงุตุฉ ุจุดุจูุชูุง</a> ุ ูุฐูู ูุฏ ูุฎุชูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌุฒุก ูู ูุนููุงุช Sysctl</a> ุงูููุฌูุฏุฉ ูู ุงูุญุงููุฉ ุนูู ุงูุฃูู ุนู ุงููุถูู. <br><br>  ููู ุจุงูุถุจุท ุฅุนุฏุงุฏุงุช Sysctl ูู ุงูุญุงููุฉ ุชูุทุจูุ  ูุธุฑูุง ููุฌูุฏ ุญุงููุงุช ุบูุฑ ูููุณูุฉ ุ ูุฅู ุชุบููุฑ ุฃู ุฅุนุฏุงุฏ Sysctl ูู ุฎูุงู ุงูุฏุฎูู ุฅูู ุงูุญุงููุฉ ููุณูุง ุณูู ููุดู - ุจุจุณุงุทุฉ ูู ุชููู ููุงู ุญููู ูุงููุฉ.  ูู ุฐูู ุงูููุช ุ ุงุณุชุฎุฏูุช ุงูุณุญุงุจุฉ ุงูุฎุงุตุฉ ุจูุง Docker (ุงูุขู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Podman</a> ) ูุฅุทูุงู ุงูุญุงููุงุช.  ุชุฌุงูุฒ ุนุงูู ุงูููู ุนุจุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ูุนููุงุช ุงูุญุงููุฉ ุงูุฌุฏูุฏุฉ ุ ุจูุง ูู ุฐูู ุฅุนุฏุงุฏุงุช Sysctl ุงููุงุฒูุฉ. <br>  ุฃุซูุงุก ุชุนุฏุงุฏ ุงูุฅุตุฏุงุฑุงุช ุ ุงุชุถุญ ุฃู ูุงุฌูุฉ Docker API ูู ุชุฑูู ูู ุงูุฃุฎุทุงุก (ุนูู ุงูุฃูู ูู ุงูุฅุตุฏุงุฑ 1.10).  ุนูุฏ ูุญุงููุฉ ุจุฏุก ุชุดุบูู ุงูุญุงููุฉ ูู ุฎูุงู "ุชุดุบูู ุนุงูู ุงูุฅุฑุณุงุก" ุ ุฑุฃููุง ุฃุฎูุฑูุง ุดูุฆูุง ุนูู ุงูุฃูู: <br><br> <code>write /proc/sys/net/ipv4/ipfrag_high_thresh: invalid argument docker: Error response from daemon: Cannot start container &lt;...&gt;: [9] System error: could not synchronise with container process.</code> <br> <br>  ูููุฉ ุงููุนููุฉ ุบูุฑ ุตุงูุญุฉ.  ููู ููุงุฐุงุ  ูููุงุฐุง ูุง ูุตูุญ ููุท ูู ุจุนุถ ุงูุฃุญูุงูุ  ุงุชุถุญ ุฃู Docker ูู ูุถูู ุชุทุจูู ูุนููุงุช Sysctl (ุฃุญุฏุซ ุฅุตุฏุงุฑ ุชู ุงุฎุชุจุงุฑู ูุงู 1.13.1) ุ ูุฐูู ูู ุจุนุถ ุงูุฃุญูุงู ุญุงูู ipfrag_high_thresh ุชุนููู ููุณู ุนูู 256 ูููู ุจุงูุช ุนูุฏูุง ูุงู ipfrag_low_thresh ูุง ูุฒุงู 3M ุ ุฃู ุฃู ุงูุญุฏ ุงูุนููู ูุงู ุฃูู ูู ุงูุญุฏ ุงูุฃุฏูู ุ ููุง ุฃุฏู ุฅูู ุญุฏูุซ ุฎุทุฃ. <br><br>  ูู ุฐูู ุงูููุช ุ ุงุณุชุฎุฏููุง ุจุงููุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุขููุชูุง</a> ุงูุฎุงุตุฉ ูุฅุนุงุฏุฉ ุชูููู ุงูุญุงููุฉ ุจุนุฏ ุงูุจุฏุก (ุชุฌููุฏ ุงูุญุงููุฉ ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุฌูุฏ cgroup</a> ูุชูููุฐ ุงูุฃูุงูุฑ ูู ูุณุงุญุฉ ุงุณู ุงูุญุงููุฉ ุนุจุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดุจูุงุช IP</a> ) ุ ูุฃุถููุง ุฃูุถูุง ูุนููุงุช Sysctl ุฅูู ูุฐุง ุงูุฌุฒุก.  ุชู ุญู ุงููุดููุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  FragmentSmack / SegmentSmack.  ุงูุฏู ุงูุฃูู 2 </h4><br>  ูุจู ุฃู ูุนุฑู ููู ูุณุชุฎุฏู Workaround ูู ุงูุณุญุงุจุฉ ุ ุจุฏุฃุช ุฃูู ุดูุงูู ูุงุฏุฑุฉ ูู ุงููุณุชุฎุฏููู ูู ุงููุตูู.  ูู ุฐูู ุงูููุช ุ ูุฑุช ุนุฏุฉ ุฃุณุงุจูุน ููุฐ ุจุฏุงูุฉ Workaround ุนูู ุงูุฎูุงุฏู ุงูุฃููู.  ุฃุธูุฑ ุงูุชุญููู ุงูุฃููู ุฃูู ุชู ุชููู ุดูุงูู ุญูู ุงูุฎุฏูุงุช ุงููุฑุฏูุฉ ุ ูููุณ ุฌููุน ุฎูุงุฏู ูุฐู ุงูุฎุฏูุงุช.  ุงุณุชุนุงุฏุช ุงููุดููุฉ ุดุฎุตูุฉ ุบุงูุถุฉ ููุบุงูุฉ. <br><br>  ุฃููุงู ููุจู ูู ุดูุก ุ ุจุงูุทุจุน ุ ุญุงูููุง ุงุณุชุนุงุฏุฉ ุฅุนุฏุงุฏุงุช Sysctl ุ ููู ูุฐุง ูู ูุนุทู ุฃู ุชุฃุซูุฑ.  ูู ูุณุงุนุฏ ุงูุชูุงุนุจ ุงููุฎุชููุฉ ูุน ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู ูุงูุชุทุจูู.  ุณุงุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู.  ูุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ููุธุงู ุงูุชุดุบูู Linux ุฃูุฑูุง ุบูุฑ ุทุจูุนู ุจูุฏุฑ ูุง ูุงู ุญุงูุฉ ุนุงุฏูุฉ ููุนูู ูุน Windows ูู ุงูุฃูุงู ุงูุฎูุงูู.  ููุน ุฐูู ุ ููุฏ ุณุงุนุฏูุง ุ ูููุง ุดุทุจูุง ูู ุดูุก ุฅูู "ุฎูู ูู ุงูููุงุฉ" ุนูุฏ ุชุทุจูู ุงูุฅุนุฏุงุฏุงุช ุงูุฌุฏูุฏุฉ ูู Sysctl.  ูู ูุงูุช ุชุงููุฉ ... <br><br>  ุจุนุฏ ุซูุงุซุฉ ุฃุณุงุจูุน ุ ุชูุฑุฑุช ุงููุดููุฉ.  ูุงู ุชูููู ูุฐู ุงูุฎูุงุฏู ุจุณูุทูุง ุฌุฏูุง: Nginx ูู ูุถุน ุงููููู / ุงูููุงุฒู.  ุญุฑูุฉ ุงููุฑูุฑ ููููุง.  ุชูููุฏู ุฌุฏูุฏ: ุนุฏุฏ ุงูุฃุฎุทุงุก 504 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนุจูุงุฑุฉ ุงููููุฉ</a> ) ูุชุฒุงูุฏ ูู ููู ุนูู ุงูุนููุงุก.  ููุถุญ ุงูุฑุณู ุงูุจูุงูู ุนุฏุฏ ุงูุฃุฎุทุงุก 504 ูููููุง ููุฐู ุงูุฎุฏูุฉ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xk/hk/rj/xkhkrjedsakcdrx6m_z8hgcgjsw.png"></div><br><br>  ุฌููุน ุงูุฃุฎุทุงุก ุชุฏูุฑ ุญูู ููุณ ุงูุฎูููุฉ - ุนู ุงูุฎุทุฃ ุงูููุฌูุฏ ูู ุงูุณุญุงุจุฉ.  ูุงู ุงูุฑุณู ุงูุจูุงูู ูุงุณุชููุงู ุงูุฐุงูุฑุฉ ูุดุธุงูุง ุงูุญุฒูุฉ ูู ูุฐู ุงูุฎูููุฉ ููุง ููู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jy/fb/gt/jyfbgtoqrbqwv6cird2zawvatza.png"></div><br><br>  ูุนุฏ ูุฐุง ุฃุญุฏ ุฃูุซุฑ ูุธุงูุฑ ุงููุดููุฉ ุจุฑูุฒูุง ุนูู ุฑุณููุงุช ูุธุงู ุงูุชุดุบูู.  ูู ุงูุณุญุงุจุฉ ุ ูู ููุณ ุงูููุช ุ ุชู ุฅุตูุงุญ ูุดููุฉ ุฃุฎุฑู ูู ุงูุดุจูุฉ ุจุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ุฌูุฏุฉ ุงูุฎุฏูุฉ (ุงูุชุญูู ูู ุญุฑูุฉ ุงููุฑูุฑ).  ูู ุงูุฑุณู ุงูุจูุงูู ูุงุณุชููุงู ุงูุฐุงูุฑุฉ ูุดุธุงูุง ุงูุญุฒูุฉ ุ ุจุฏุง ุงูุฃูุฑ ููุง ูู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/09/nf/4r/09nf4rxogxv9xppeumwujvmcr3m.png"></div><br><br>  ูุงู ุงูุงูุชุฑุงุถ ุจุณูุทูุง: ุฅุฐุง ูุงูุช ุชุจุฏู ูุชุดุงุจูุฉ ูู ุงูุฑุณูู ุงูุจูุงููุฉ ุ ุนูุฏูุง ูููู ููุง ููุณ ุงูุณุจุจ.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ุฃู ูุดุงูู ูุน ูุฐุง ุงูููุน ูู ุงูุฐุงูุฑุฉ ูุงุฏุฑุฉ ููุบุงูุฉ. <br><br>  ูุงู ุฌููุฑ ุงููุดููุฉ ุงูุซุงุจุชุฉ ูู ุฃููุง ุงุณุชุฎุฏููุง sheduler ุญุฒูุฉ fq ูุน ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ูู ุฌูุฏุฉ ุงูุฎุฏูุฉ.  ุงูุชุฑุงุถููุง ุ ุจุงููุณุจุฉ ูุงุชุตุงู ูุงุญุฏ ุ ูุณูุญ ูู ุจุฅุถุงูุฉ 100 ุญุฒูุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูุจุฏุฃุช ุจุนุถ ุงูุงุชุตุงูุงุช ูู ุญุงูุฉ ููุต ุงูููุงุฉ ุชุณุฏ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฅูู ุงููุดู.  ูู ูุฐู ุงูุญุงูุฉ ุ ุชูุฎูุถ ุงูุญุฒู.  ูู ุฅุญุตุงุฆูุงุช tc (tc -s qdisc) ุ ูููู ููุงุญุธุฉ ุฐูู ุนูู ุงููุญู ุงูุชุงูู: <br><br> <code>qdisc fq 2c6c: parent 1:2c6c limit 10000p flow_limit 100p buckets 1024 orphan_mask 1023 quantum 3028 initial_quantum 15140 refill_delay 40.0ms <br> Sent 454701676345 bytes 491683359 pkt (dropped 464545, overlimits 0 requeues 0) <br> backlog 0b 0p requeues 0 <br> 1024 flows (1021 inactive, 0 throttled) <br> 0 gc, 0 highprio, 0 throttled, 464545 flows_plimit</code> <br> <br>  "464545 flow_plimit" ูู ุงูุญุฒู ุงูุชู ุชู ุฅุณูุงุทูุง ุจุณุจุจ ุชุฌุงูุฒ ุญุฏ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุงุชุตุงู ูุงุญุฏ ุ ู "ุงูุชู ุชู ุฅุณูุงุทูุง 464545" ูู ูุฌููุน ูู ุงูุญุฒู ุงูุชู ุชู ุฅุณูุงุทูุง ูู ูุญุฏุฉ ุงูุญูุงูุฉ ูุฐู.  ุจุนุฏ ุฒูุงุฏุฉ ุทูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุฅูู 1000 ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุงุช ุ ุชูููุช ุงููุดููุฉ ุนู ุงูุธููุฑ.  ููููู ุงูุฌููุณ ุนูู ูุฑุณู ูุงูุญุตูู ุนูู ุนุตูุฑ. <br><br><h4 style=";text-align:right;direction:rtl">  FragmentSmack / SegmentSmack.  ุงูุฏู ุงููุงุถู </h4><br>  ุฃููุงู ุ ุจุนุฏ ุฃุดูุฑ ููููุฉ ูู ุฅุนูุงู ุงูุซุบุฑุงุช ุงูุฃูููุฉ ูู ุงูููุงุฉ ุ ุธูุฑ ุฃุฎูุฑูุง ุฅุตูุงุญ ูู FragmentSmack (ุฃุฐูุฑ ุฃูู ูุน ุงูุฅุนูุงู ูู ุฃุบุณุทุณ ุชู ุฅุตุฏุงุฑ ุฅุตูุงุญ ููุท ูู SegmentSmack) ุ ููุง ุฃุนุทุงูุง ูุฑุตุฉ ููุชุฎูู ุนู Workaround ุ ููุง ุชุณุจุจ ููุง ูู ุงููุซูุฑ ูู ุงููุชุงุนุจ.  ููุฏ ุชูููุง ุจุงููุนู ูู ููู ุจุนุถ ุงูุฎูุงุฏู ุฎูุงู ูุฐุง ุงูููุช ุฅูู ููุงุฉ ุฌุฏูุฏุฉ ุ ูุงูุขู ูุฌุจ ุฃู ูุจุฏุฃ ูู ุงูุจุฏุงูุฉ.  ููุงุฐุง ูููุง ุจุชุญุฏูุซ kernel ุฏูู ุงูุชุธุงุฑ ุฅุตูุงุญ FragmentSmackุ  ูุงูุญูููุฉ ูู ุฃู ุนูููุฉ ุงูุญูุงูุฉ ูู ููุงุท ุงูุถุนู ูุฐู ุชุฒุงููุช (ูุฏูุฌุช) ูุน ุนูููุฉ ุชุญุฏูุซ CentOS ููุณูุง (ูุงูุชู ุชุณุชุบุฑู ููุชูุง ุฃุทูู ูู ุชุญุฏูุซ ุงูููุงุฉ ููุท).  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุนุชุจุฑ SegmentSmack ูุดููุฉ ุนุฏู ุญุตุงูุฉ ุฃูุซุฑ ุฎุทูุฑุฉ ุ ููุฏ ุธูุฑ ุฅุตูุงุญ ููุง ุนูู ุงูููุฑ ุ ูุฐูู ูุงูุช ุงูููุทุฉ ูู ุฃู ุญุงู.  ููุน ุฐูู ุ ูุง ูููููุง ุจุจุณุงุทุฉ ุชุญุฏูุซ ุงูููุงุฉ ุนูู CentOS ุ ูุฃู ุซุบุฑุฉ FragmentSmack ุ ุงูุชู ุธูุฑุช ุฎูุงู CentOS 7.5 ุ ุชู ุฅุตูุงุญูุง ููุท ูู ุงูุฅุตุฏุงุฑ 7.6 ุ ูุฐูู ุงุถุทุฑุฑูุง ุฅูู ุฅููุงู ุงูุชุฑููุฉ ุฅูู 7.5 ูุงูุจุฏุก ูู ุฌุฏูุฏ ูุฑุฉ ุฃุฎุฑู ูุน ุงูุชุฑููุฉ ุฅูู 7.6.  ููุฐุง ูู ุงูุญุงู ูุฐูู. <br><br>  ุซุงููุงู ุ ุนุงุฏุช ุฅูููุง ุดูุงูู ุงููุณุชุฎุฏููู ุงููุงุฏุฑุฉ ุญูู ุงููุดููุงุช.  ุงูุขู ูุญู ูุนุฑู ุจุงููุนู ุฃู ุฌููุนูู ูุชุตููู ุจุชูุฒูู ุงููููุงุช ูู ุงูุนููุงุก ุฅูู ุจุนุถ ุฎูุงุฏููุง.  ููู ุฎูุงู ูุฐู ุงูุฎูุงุฏู ูุงู ููุงู ุนุฏุฏ ูููู ุฌุฏูุง ูู ุงูุชุญูููุงุช ูู ุฅุฌูุงูู ุงููุชูุฉ. <br><br>  ููุง ูุชุฐูุฑ ูู ุงููุตุฉ ุฃุนูุงู ุ ูู ูุณุงุนุฏ ุชุฑุงุฌุน Sysctl.  ุณุงุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ูููู ูุคูุชุง. <br>  ูู ูุชู ุฑูุน ุงูุดููู ุญูู Sysctl ุ ูููู ูุฐู ุงููุฑุฉ ูุงู ูุทููุจูุง ุฌูุน ุฃูุจุฑ ูุฏุฑ ูููู ูู ุงููุนูููุงุช.  ูุฐูู ุ ูุงู ููุงู ููุต ุดุฏูุฏ ูู ุงููุฏุฑุฉ ุนูู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุดููุฉ ูุน ุชุญููู ุงูุนููู ูู ุฃุฌู ูุญุต ูุง ูุงู ูุญุฏุซ ุจุฏูุฉ ุฃูุจุฑ. <br><br>  ุชุญููู ุฌููุน ุงูุฅุญุตุงุกุงุช ูุงูุณุฌูุงุช ุงููุชุงุญุฉ ูู ุชูุฑุจูุง ูู ููู ูุง ูุงู ูุญุฏุซ.  ูุงู ููุงู ููุต ุญุงุฏ ูู ุงููุฏุฑุฉ ุนูู ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุงููุดููุฉ ูู ุฃุฌู "ุงูุดุนูุฑ" ุจุงุชุตุงู ูุนูู.  ุฃุฎูุฑูุง ุ ุชููู ุงููุทูุฑูู ุนูู ุงูุฅุตุฏุงุฑ ุงูุฎุงุต ููุชุทุจูู ูู ุชุญููู ุงุณุชูุณุงุฎ ูุณุชูุฑ ูููุดุงูู ุนูู ุฌูุงุฒ ุงูุงุฎุชุจุงุฑ ุนูุฏ ุงูุงุชุตุงู ุนุจุฑ Wi-Fi.  ูุงู ูุฐุง ุทูุฑุฉ ูู ุงูุชุญููู.  ุงูุนููู ุงููุชุตู ุจู Nginx ุ ููุฏ ุชูุฑูุจูุง ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ููู ุชุทุจูู Java ุงูุฎุงุต ุจูุง. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xw/g8/4a/xwg84aziibg7aaglsv6hdc2vyn8.png"></div><br><br>  ูุงู ูุฑุจุน ุงูุญูุงุฑ ูุน ุงููุดููุงุช ููุง ููู (ุซุงุจุช ุนูู ุฌุงูุจ ูููู Nginx): <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุนููู: ุทูุจ ููุญุตูู ุนูู ูุนูููุงุช ุญูู ุชูุฒูู ููู. </li><li style=";text-align:right;direction:rtl">  ุฎุงุฏู ุฌุงูุง: ุงูุฌูุงุจ. </li><li style=";text-align:right;direction:rtl">  ุงูุนููู: POST ูุน ุงูููู. </li><li style=";text-align:right;direction:rtl">  ุฎุงุฏู ุฌุงูุง: ุฎุทุฃ. </li></ol><br>  ูู ุงูููุช ููุณู ุ ููุชุจ ุฎุงุฏู Java ุฅูู ุงูุณุฌู ุฃูู ุชู ุงุณุชูุงู 0 ุจุงูุช ูู ุงูุจูุงูุงุช ูู ุงูุนููู ุ ูุฃู ูููู Nginx ุงูุฐู ุงุณุชุบุฑู ุงูุทูุจ ุฃูุซุฑ ูู 30 ุซุงููุฉ (30 ุซุงููุฉ ูู ูููุฉ ุชุทุจูู ุงูุนููู).  ููุงุฐุง ุงููููุฉ ูููุงุฐุง 0 ุจุงูุชุ  ูู ูุฌูุฉ ูุธุฑ HTTP ุ ูู ุดูุก ูุนูู ููุง ูุฌุจ ุ ูููู ูุจุฏู ุฃู POST ูุน ุงูููู ูุฎุชูู ูู ุงูุดุจูุฉ.  ููุฎุชูู ุจูู ุงูุนููู ู Nginx.  ุญุงู ุงูููุช ูุชุณููุญ ููุณู ูุน Tcpdump!  ูููู ุฃููุงู ุชุญุชุงุฌ ุฅูู ููู ุชูููู ุงูุดุจูุฉ.  ุงููููู nginx ูู ูุฑุงุก ููุงุฒู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">N3ware</a> L3.  ูุณุชุฎุฏู ุงูููู ูุชุณููู ุงูุญุฒู ูู ููุงุฒู L3 ุฅูู ุงูุฎุงุฏู ุ ููุง ูุถูู ุฑุคูุณู ุฅูู ุงูุญุฒู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hs/ge/mf/hsgemfebrlkpjzvtz-cdrghudxu.png"></div><br><br>  ูู ุงูููุช ููุณู ุ ุชุฃุชู ุงูุดุจูุฉ ุฅูู ูุฐุง ุงูุฎุงุฏู ูู ุดูู ุญุฑูุฉ ูุฑูุฑ ุนูู ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ ุ ูุงูุชู ุชุถูู ุฃูุถูุง ุญููููุง ุฅูู ุญุฒู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-a/ns/ap/-ansap0a5oyjsnqrf0onvsxg0tw.png"></div><br><br>  ููููู ุชุฌุฒุฆุฉ ุญุฑูุฉ ุงููุฑูุฑ ูุฐู (ุงููุณุจุฉ ุงููุฆููุฉ ุงูุตุบูุฑุฉ ุฌุฏูุง ูุญุฑูุฉ ุงููุฑูุฑ ุงููุฌุฒุฃุฉ ุงููุงุฑุฏุฉ ุงูุชู ุชุญุฏุซูุง ุนููุง ุนูุฏ ุชูููู ุงููุฎุงุทุฑ ูู Workaround) ุ ููุง ูุคุฏู ุฃูุถูุง ุฅูู ุชุบููุฑ ูุญุชูู ุงูุฑุคูุณ: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gd/yx/48/gdyx48_bc15aj2xmhn5kb0_omci.png"></div><br><br>  ูุฑุฉ ุฃุฎุฑู: ูุชู ุชุบููู ุงูุญุฒู ุจูุงุณุทุฉ ุนูุงูุฉ ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ (Vlan tag) ุ ูุบููุฉ ุจูุงุณุทุฉ ููู ุ ูุฌุฒุฃ.  ูููู ููููุฉ ุญุฏูุซ ุฐูู ุจุดูู ุฃูุถู ุ ุฏุนูุง ูุชุชุจุน ูุณุงุฑ ุงูุญุฒูุฉ ูู ุงูุนููู ุฅูู ูููู Nginx. <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุตู ุงูุญุฒูุฉ ุฅูู L3-balancer.  ููุชูุฌูู ุงูุตุญูุญ ุฏุงุฎู ูุฑูุฒ ุงูุจูุงูุงุช ุ ูุชู ุชุบููู ุงูุญุฒูุฉ ูู ุงูููู ูุฅุฑุณุงููุง ุฅูู ุจุทุงูุฉ ุงูุดุจูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุนุฏู ุงุญุชูุงุก ุฑุคูุณ ุงูุญุฒูุฉ + ุงูููู ุนูู ูุญุฏุฉ ุงูุฅุฑุณุงู ุงููุจุฑู ุ ูุชู ูุทุน ุงูุญุฒูุฉ ุฅูู ุฃุฌุฒุงุก ูุฅุฑุณุงููุง ุฅูู ุงูุดุจูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุถูู ุงูููุชุงุญ ุจุนุฏ L3-balancer ุนูุฏ ุงุณุชูุงู ุงูุญุฒูุฉ ุนูุงูุฉ Vlan ุฅูููุง ููุฑุณููุง ุฃูุซุฑ. </li><li style=";text-align:right;direction:rtl">  ุฑูุฒ ุงูุชุจุฏูู ูุจู ูููู Nginx ูุฑู (ููููุง ูุฅุนุฏุงุฏุงุช ุงููููุฐ) ุฃู ุงูุฎุงุฏู ูุชููุน ุญุฒูุฉ ูุบููุฉ ุจุงูุดุจูุฉ ุงููุญููุฉ ุงูุธุงูุฑูุฉ ุ ูุฐูู ูุฑุณููุง ููุง ูู ุ ุฏูู ุฅุฒุงูุฉ ุนูุงูุฉ Vlan. </li><li style=";text-align:right;direction:rtl">  ูุชููู Linux ุฃุฌุฒุงุก ูู ุงูุญุฒู ุงููุฑุฏูุฉ ููุตููุง ูู ุญุฒูุฉ ูุงุญุฏุฉ ูุจูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ุซู ุชุตู ุงูุญุฒูุฉ ุฅูู ูุงุฌูุฉ ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ ุ ุญูุซ ุชุชู ุฅุฒุงูุฉ ุงูุทุจูุฉ ุงูุฃููู ูููุง - ุบูุงู ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฑุณู Linux ุจุนุฏ ุฐูู ุฅูู ูุงุฌูุฉ Tunnel ุ ุญูุซ ุชุชู ุฅุฒุงูุฉ ุทุจูุฉ ุฃุฎุฑู ููู - ุชุบููู Tunnel. </li></ol><br>  ุงูุตุนูุจุฉ ุชููู ูู ุชูุฑูุฑ ูู ูุฐุง ููุนููุงุช ุฅูู tcpdump. <br>  ููุจุฏุฃ ูู ุงูููุงูุฉ: ูู ููุงู ุฃู ุญุฒู IP ูุธููุฉ (ุจุฏูู ุฑุคูุณ ุฅุถุงููุฉ) ูู ุนููุงุก ูุน ุฅุฒุงูุฉ ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ ูุชุบููู ุงููููุ <br><br> <code>tcpdump host &lt;ip &gt;</code> <br> <br>  ูุง ุ ูู ููู ููุงู ูุซู ูุฐู ุงูุญุฒู ุนูู ุงูุฎุงุฏู.  ูุฐูู ุ ูุฌุจ ุฃู ุชููู ุงููุดููุฉ ูู ููุช ุณุงุจู.  ูู ููุงู ุญุฒู ูุน ุฅุฒุงูุฉ ุชุบููู ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ ููุทุ <br><br> <code>tcpdump ip[32:4]=0xx390x2xx</code> <br> <br>  0xx390x2xx ูู ุนููุงู IP ููุนููู ุจุชูุณูู ุณุช ุนุดุฑู. <br>  32: 4 - ุนููุงู ูุทูู ุงูุญูู ุงูุฐู ูุชุจ ููู SCR IP ูู ุญุฒูุฉ Tunnel. <br><br>  ูุงู ูุฌุจ ุชุญุฏูุฏ ุนููุงู ุงูุญูู ุนู ุทุฑูู ุงูููุฉ ุงูุบุงุดูุฉ ุ ุญูุซ ุฃู ุงูุฅูุชุฑูุช ููุชุจ ุญูุงูู 40 ุ 44 ุ 50 ุ 54 ุ ูููู ูู ููู ููุงู ุนููุงู IP.  ููููู ุฃูุถูุง ุฅููุงุก ูุธุฑุฉ ุนูู ุฅุญุฏู ุงูุญุฒู ูู ุณุช ุนุดุฑู (ุงููุนููุฉ -xx ุฃู -XX ูู tcpdump) ูุญุณุงุจ ุนููุงู IP ุงููุนุฑูู. <br><br>  ูู ููุงู ุฃู ุดุธุงูุง ุญุฒูุฉ ุฏูู ุชุบููู Vlan ู Tunnelุ <br><br> <code>tcpdump ((ip[6:2] &gt; 0) and (not ip[6] = 64)) <br></code> <br>  ูุฐุง ุงูุณุญุฑ ุณููุธูุฑ ููุง ุฌููุน ุงูุดุธุงูุง ุ ุจูุง ูู ุฐูู ุงูุฃุฎูุฑ.  ุฑุจูุง ุ ูููู ุชุตููุฉ ููุณ ุงูุดูุก ุนู ุทุฑูู IP ุ ููููู ูู ุฃุญุงูู ุ ูุฃูู ูุง ููุฌุฏ ุนุฏุฏ ูุจูุฑ ุฌุฏูุง ูู ูุฐู ุงูุญุฒู ุ ููููู ุงูุนุซูุฑ ุจุณูููุฉ ุนูู ุงูุญุฒู ุงูุชู ุงุญุชุงุฌูุง ูู ุงูุฏูู ุงูุนุงู.  ูุง ูู: <br><br> <code>14:02:58.471063 In 00:de:ff:1a:94:11 ethertype IPv4 (0x0800), length 1516: (tos 0x0, ttl 63, <b>id 53652, offset 0</b> , flags [+], proto IPIP (4), length 1500) <br> 11.11.11.11 &gt; 22.22.22.22: truncated-ip - 20 bytes missing! (tos 0x0, ttl 50, id 57750, offset 0, flags [DF], proto TCP (6), length 1500) <br> 33.33.33.33.33333 &gt; 44.44.44.44.80: Flags [.], seq 0:1448, ack 1, win 343, options [nop,nop,TS val 11660691 ecr 2998165860], length 1448 <br> 0x0000: 0000 0001 0006 00de fb1a 9441 0000 0800 ...........A.... <br> 0x0010: 4500 05dc d194 2000 3f09 d5fb 0a66 387d E.......?....f8} <br> 0x0020: 1x67 7899 4500 06xx e198 4000 3206 6xx4 .faEE.....@.2.m. <br> 0x0030: b291 x9xx x345 2541 83b9 0050 9740 0x04 .......A...P.@.. <br> 0x0040: 6444 4939 8010 0257 8c3c 0000 0101 080x dDI9...W.\...... <br> 0x0050: 00b1 ed93 b2b4 6964 xxd8 ffe1 006a 4578 ......ad.....j <b>Ex</b> <br> 0x0060: 6966 0000 4x4d 002a 0500 0008 0004 0100 <b>if</b> ..MM.*........ <br> <br> 14:02:58.471103 In 00:de:ff:1a:94:11 ethertype IPv4 (0x0800), length 62: (tos 0x0, ttl 63, <b>id 53652, offset 1480</b> , flags [none], proto IPIP (4), length 40) <br> 11.11.11.11 &gt; 22.22.22.22: ip-proto-4 <br> 0x0000: 0000 0001 0006 00de fb1a 9441 0000 0800 ...........A.... <br> 0x0010: 4500 0028 d194 00b9 3f04 faf6 2x76 385x E..(....?....f8} <br> 0x0020: 1x76 6545 xxxx 1x11 2d2c 0c21 8016 8e43 .faE...D-,.!...C <br> 0x0030: x978 e91d x9b0 d608 0000 0000 0000 7c31 .x............|Q <br> 0x0040: 881d c4b6 0000 0000 0000 0000 0000 ..............</code> <br> <br>  ูุฐู ุดุธุงูุง ุญุฒูุฉ ูุงุญุฏุฉ (ูุนุฑู ูุชุทุงุจู 53652) ูุน ุตูุฑุฉ (ูููุฉ Exif ูู ุงูุญุฒูุฉ ุงูุฃููู ูุฑุฆูุฉ).  ูุธุฑูุง ูุญูููุฉ ูุฌูุฏ ุญุฒู ุนูู ูุฐุง ุงููุณุชูู ุ ูููู ูุง ูุชู ูุตููุง ูู ููุงูุจ ุ ูุฅู ุงููุดููุฉ ุชููู ุจูุถูุญ ูู ุงูุชุฌููุน.  ุฃุฎูุฑูุง ุ ููุงู ุฏููู ูุซุงุฆูู ุนูู ูุฐุง! <br><br>  ูุญุฏุฉ ูู ุชุฑููุฒ ุงูุญุฒูุฉ ูู ุชูุดู ุนู ุฃู ูุดููุงุช ุชููุน ุงูุชุฌููุน.  ุญุงูู ููุง: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">hpd.gasmi.net</a> .  ูู ุงูุจุฏุงูุฉ ุ ุนูุฏ ูุญุงููุฉ ุญุดุฑ ุดูุก ููุงู ุ ูุง ูุญุจ ูุญุฏุฉ ูู ุงูุชุฑููุฒ ุชูุณูู ุงูุญุฒูุฉ.  ุงุชุถุญ ุฃู ููุงู ุจุนุถ ุงูุซูุงูููุงุช ุงูุฅุถุงููุฉ ุจูู Srcmac ู Ethertype (ูุง ุนูุงูุฉ ููุง ุจูุนูููุงุช ุงูุฃุฌุฒุงุก).  ุจุนุฏ ุฅุฒุงูุชูุง ุ ุนููุช ูุญุฏุฉ ูู ุงูุชุฑููุฒ.  ููุน ุฐูู ุ ููุงู ุงูู ูู ุชุธูุฑ ุฃู ูุดุงูู. <br>  ูู ูุง ุชุฑูุฏ ุ ุจุงุณุชุซูุงุก ุฃููุฆู ุงูุฐูู ุงูุชุดููุง Sysctl ุฌุฏูุง.  ุจูู ูุฅูุฌุงุฏ ุทุฑููุฉ ูุชุญุฏูุฏ ุงูุฎูุงุฏู ุฐุงุช ุงููุดุงูู ูู ุฃุฌู ููู ุงููุทุงู ูุงุชุฎุงุฐ ูุฑุงุฑ ุจุดุฃู ุงููุฒูุฏ ูู ุงูุฅุฌุฑุงุกุงุช.  ุจุณุฑุนุฉ ูุงููุฉ ูุฌุฏุช ุงูุนุฏุงุฏ ุงูุตุญูุญ: <br><br> <code>netstat -s | grep "packet reassembles failedโ</code> <br> <br>  ูู snmpd ุชุญุช OID = 1.3.6.1.2.1.4.31.1.1.16.1 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ipSystemStatsReasmFails</a> ). <br><br><blockquote style=";text-align:right;direction:rtl">  <i>"ุนุฏุฏ ุญุงูุงุช ุงููุดู ุงูุชู ุงูุชุดูุชูุง ุฎูุงุฑุฒููุฉ ุฅุนุงุฏุฉ ุชุฌููุน IP (ูุฃู ุณุจุจ ูุงู: ูููุฉ ุ ุฃุฎุทุงุก ุ ุฅูุฎ)."</i> </blockquote><br>  ูู ุจูู ูุฌููุนุฉ ุงูุฎูุงุฏู ุงูุชู ุชูุช ุฏุฑุงุณุฉ ุงููุดููุฉ ุนูููุง ุ ุฒุงุฏ ูุฐุง ุงูุนุฏุงุฏ ุนูู ุงุซููู ุจุดูู ุฃุณุฑุน ุ ูุนูู ุงุซููู ุฃุจุทุฃ ุ ููู ูุฒุฏุงุฏ ุนูู ุงุซููู ุนูู ุงูุฅุทูุงู.  ูุดูุช ููุงุฑูุฉ ุจูู ุฏููุงููุงุช ูุฐุง ุงูุนุฏุงุฏ ูุฏููุงููููุงุช ุฃุฎุทุงุก HTTP ุนูู ุฎุงุฏู Java ุนู ูุฌูุฏ ุนูุงูุฉ.  ููุฐุง ูู ุ ูููู ุชุนููู ุงูุนุฏุงุฏ ูููุฑุงูุจุฉ. <br><br>  ูู ุงูููู ุฌุฏูุง ูุฌูุฏ ูุคุดุฑ ููุซูู ูููุดุงูู ุญุชู ุชุชููู ูู ุชุญุฏูุฏ ุจุฏูุฉ ูุง ุฅุฐุง ูุงูุช Sysctl rollback ุชุณุงุนุฏ ุ ูุฃููุง ูุนูู ูู ุงููุตุฉ ุงูุณุงุจูุฉ ุฃู ูุฐุง ุบูุฑ ูุงุถุญ ุนูู ุงูููุฑ ูู ุงูุชุทุจูู.  ุณูุณูุญ ูุฐุง ุงููุคุดุฑ ุจุชุญุฏูุฏ ุฌููุน ูุฌุงูุงุช ุงููุดููุงุช ูู ุงูุฅูุชุงุฌ ูุจู ุฃู ููุชุดููุง ุงููุณุชุฎุฏููู. <br>  ุจุนุฏ ุงูุชุฑุงุฌุน Sysctl ุ ุชูููุช ุฃุฎุทุงุก ุงููุฑุงูุจุฉ ุ ูุจุงูุชุงูู ุซุจุช ุณุจุจ ุงููุดุงูู ุ ููุฐูู ุญูููุฉ ุฃู ุงูุชุฑุงุฌุน ูุณุงุนุฏ. <br><br>  ููุฏ ุงุณุชุนุฏูุง ุฅุนุฏุงุฏุงุช ุงูุชุฌุฒุฆุฉ ุนูู ุฎูุงุฏู ุฃุฎุฑู ุ ุญูุซ ุงุดุชุนูุช ูุฑุงูุจุฉ ุฌุฏูุฏุฉ ุ ููู ููุงู ูุง ุฎุตุตูุง ุฐุงูุฑุฉ ุฃูุจุฑ ููุดุธุงูุง ุฃูุซุฑ ูู ุฐู ูุจู ุจุดูู ุงูุชุฑุงุถู (ูุงูุช ูุฐู ุฅุญุตุงุฆูุงุช udp ุ ููู ููู ููุฏุงููุง ุงูุฌุฒุฆู ููุญูุธูุง ูู ุงูุฎูููุฉ ุงูุนุงูุฉ). <br><br><h4 style=";text-align:right;direction:rtl">  ุฃูู ุงูุฃุณุฆูุฉ </h4><br>  ููุงุฐุง ุญุฒู ุฌุฒุก ุนูู ููุงุฒู L3 ูุฏููุงุ  ูุนุธู ุงูุญุฒู ุงูุชู ุชุตู ูู ุงููุณุชุฎุฏููู ุฅูู ุงูููุงุฒูุงุช ูู SYN ู ACK.  ุฃุญุฌุงู ูุฐู ุงูุญูุงุฆุจ ุตุบูุฑุฉ.  ูููู ูุธุฑูุง ูุฃู ุญุตุฉ ูุฐู ุงูุญุฒู ูุจูุฑุฉ ุฌุฏูุง ุ ูู ููุงุญุธ ูุฌูุฏ ุญุฒู ูุจูุฑุฉ ุจุฏุฃุช ุชุชูุชุช ุนูู ุฎูููุฉ ูุฐู ุงูุฎูููุฉ. <br><br>  ูุงูุณุจุจ ูู ุฐูู ูู ุฃูู ุชู ุชุนุทูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฑูุงูุฌ ุงููุตู</a> ูุชูููู advmss ุนูู ุงูุฎูุงุฏู ุงููุฒูุฏุฉ ุจูุงุฌูุงุช ุดุจูุฉ ูุญููุฉ ุธุงูุฑูุฉ (ูุงู ููุงู ุนุฏุฏ ูููู ุฌุฏูุง ูู ุงูุฎูุงุฏู ุฐุงุช ุญุฑูุฉ ุงููุฑูุฑ ุงูููุณููุฉ ูู ุงูุฅูุชุงุฌ ูู ุฐูู ุงูููุช).  ุชุชูุญ ูู Advmss ุฃู ุชููู ุฅูู ูุนูููุงุช ุงูุนููู ุฃู ุงูุญุฒู ูู ุงุชุฌุงููุง ูุฌุจ ุฃู ุชููู ุฃุตุบุฑ ุจุญูุซ ุฃูู ุจุนุฏ ูุตู ุฑุคูุณ ุงูููู ุนูููุง ุ ูุง ูุฌุจ ุชุฌุฒุฆุชูุง. <br><br>  ููุงุฐุง ูู ูุณุงุนุฏ Sysctl ุงูุงุณุชุนุงุฏุฉ ุ ูููู ุฅุนุงุฏุฉ ุชุดุบูู ุงููุณุงุนุฏุฉุ  ุงูุชุฑุงุฌุน Sysctl ุชุบููุฑ ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุชููุฑุฉ ูุญุฒู ุงูุฅูุชุตุงู.  ูู ุงูููุช ููุณู ุ ุนูู ูุง ูุจุฏู ุ ุฃุฏุช ุญูููุฉ ุชุฌุงูุฒ ุณุนุฉ ุงูุฐุงูุฑุฉ ูุดุธุงูุง ุฅูู ุชุซุจูุท ุงูุงุชุตุงูุงุช ุ ููุง ุฃุฏู ุฅูู ุญูููุฉ ุฃู ุดุธุงูุง ุชุฃุฎุฑุช ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ููุชุฑุฉ ุทูููุฉ.  ููุฐุง ูู ุ ูุงูุนูููุฉ ูู ุญููุงุช. <br>  ุฑูุถ ุฏุญุถ ุงูุฐุงูุฑุฉ ููุงู ูู ุดูุก ูู ูุญูู. <br><br>  ูู ูููู ุฃู ุชูุนู ุฏูู Workaroundุ  ูุนู ุ ูููู ููุงู ุฎุทุฑ ูุจูุฑ ูู ุชุฑู ุงููุณุชุฎุฏููู ุฏูู ูุฑุงูุจุฉ ูู ุญุงูุฉ ุญุฏูุซ ูุฌูู.  ุจุงูุทุจุน ุ ุฃุฏู ุงุณุชุฎุฏุงู Workaround ููุชูุฌุฉ ุฅูู ุงูุนุฏูุฏ ูู ุงููุดููุงุช ุ ุจูุง ูู ุฐูู ุชุซุจูุท ุฅุญุฏู ุงูุฎุฏูุงุช ูู ููุจู ุงููุณุชุฎุฏููู ุ ูููู ูุน ุฐูู ุ ูุนุชูุฏ ุฃู ุงูุฅุฌุฑุงุกุงุช ูุฏ ุชู ุชุจุฑูุฑูุง. <br><br>  ุดูุฑุงู ุฌุฒููุงู ูุฃูุฏุฑูู ุชูููููู ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">atimofeyev</a> ) ุนูู ุงููุณุงุนุฏุฉ ูู ุงูุชุญููู ุ ูุฅูู Alexei Krenev ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">devicex</a> ) ุนูู ุงูุนูู ุงูุถุฎู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">ุงููุชูุซู</a> ูู ุชุญุฏูุซ Centos ูุงูููุงุฉ ุนูู ุงูุฎูุงุฏู.  ูุฐู ุงูุนูููุฉ ุ ูุงูุชู ูู ูุฐู ุงูุญุงูุฉ ูุฌุจ ุฃู ุชุจุฏุฃ ุนุฏุฉ ูุฑุงุช ูู ุงูุจุฏุงูุฉ ุ ูุงูุชู ุงุณุชูุฑุช ุจุณุจุจูุง ูุนุฏุฉ ุฃุดูุฑ. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar475540/">https://habr.com/ru/post/ar475540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar475518/index.html">ูุงูุช ุงูุดุฑูุฉ ุงูููุฏูุฉ ุจุชุทููุฑ ุงูููุงุฏ ุงูุชู ุชุฌุนูู ุบูุฑ ูุฑุฆู</a></li>
<li><a href="../ar475520/index.html">ุงูุชูุงู CSS ูุฎุงุตูุฉ ุงูุงุฑุชูุงุน ูู 0px ุฅูู ุชููุงุฆู</a></li>
<li><a href="../ar475522/index.html">HP: ูุญุฑู ุงูุฃูุฑุงุต ุงูุฃุตูู ููุณ ุฃุตูุงู ุนูู ุงูุฅุทูุงู. ุนูู ูู ููุน ุงูููู ููุงุฐุง ููุนูุ</a></li>
<li><a href="../ar475536/index.html">ุงุณุชุฆูุงู ููุชุฑุฌู ูุณุชูู</a></li>
<li><a href="../ar475538/index.html">ูู ุฃูู ูุจุฏุฃ ุฅูุดุงุก ุงูุณูู. ุงูุฌุฒุก ุงูุฃูู</a></li>
<li><a href="../ar475542/index.html">ููู ุชุบูุฑ ุงูุชุณููู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุฐ ุนุงู 2013: 4 ุงุชุฌุงูุงุช ุฑุฆูุณูุฉ ูุฅุญุตุงุกุงุช ุญุงููุฉ</a></li>
<li><a href="../ar475544/index.html">ูุชุงููุฌุงุช ุงูููุชุฌุงุช ูุงูุฎุฏูุงุช ูุฃูุซุฑ ูู ุฐูู</a></li>
<li><a href="../ar475546/index.html">ูุชูุงุฒูุงุช ุงูุงุฏูุงู</a></li>
<li><a href="../ar475548/index.html">ุงูุชูููู ุจูู ุงูููู ุฏูู ุงุฎุชูุงู ุงูุชูุงุฒู ูููุงุฆู ุงูุงูุชุธุงุฑ: ุฏููู ุนููู</a></li>
<li><a href="../ar475550/index.html">ุงูุฃูุธูุฉ ุงูุตูุชูุฉ ููุบุฑู ุงูููุชูุญุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>