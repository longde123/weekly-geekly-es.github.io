<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌌 ☝🏽 👌🏿 VR sem fio e captura de movimento no hardware HTC Vive 👩🏾‍🏭 🎞️ 🎗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prefácio 
 Eu costumava escrever sobre meu projeto de impulso - um processo de captura de movimento baseado em sensores inerciais. Antes de tudo, quer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VR sem fio e captura de movimento no hardware HTC Vive</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/406843/"><iframe width="560" height="315" src="https://www.youtube.com/embed/5hQimVTOCVg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  Prefácio </h4><br>  Eu costumava escrever sobre meu projeto de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">impulso</a> - um processo de captura de movimento baseado em sensores inerciais.  Antes de tudo, quero agradecer a todos que deixaram seus comentários, de um jeito ou de outro, ajudaram o projeto.  Devo dizer que o projeto não recebeu muito desenvolvimento, o problema da deriva não foi resolvido pelos sensores de 9 eixos, mas as compensações usando uma bússola digital ajudaram muito, e o uso de rastreamento óptico simples (por exemplo, 2 marcadores de LED na cabeça) permite obter o valor médio da deriva.  Mas hoje não é sobre isso.  Quero falar sobre uma maneira relativamente barata de capturar movimento para sistemas de realidade virtual baseados no HTC Vive sem uma fazenda coletiva e um ferro de solda, bem como como se livrar do fio que inevitavelmente conecta a cabeça e o computador, o que cria muitos inconvenientes.  Também vou contar como conseguimos alcançar uma área de rastreamento de ~ 80 metros quadrados. <br><a name="habracut"></a><br><h3>  Vamos começar </h3><br>  O sistema funcionará no equipamento HTC Vive, este é um capacete em tempo integral, 2 controladores e 2 estações base. Recomendo a compra do <b>HTC Vive 2</b> , ele teve um bom desempenho, provavelmente devido às estações base atualizadas.  Agora, o preço foi reduzido para 50 mil rublos. <br><br>  Além do conjunto padrão, recomendo o complemento <b>VIVE Deluxe Audio</b> , não são apenas fones de ouvido (o que já é conveniente), é uma solução extremamente conveniente para um uso mais confortável do capacete, especialmente essa adição é relevante ao usar o capacete por vários jogadores ou visitantes da atração.  Além disso, esta montagem permite que você monte com segurança o sistema sem fio, e parece legal: <br><div style="text-align:center;"><img src="https://habrastorage.org/web/656/15a/f81/65615af817cb46b88ed294f91380cea1.jpg" alt="imagem"></div><br>  <i><b>Áudio VIVE Deluxe</b> .</i>  <i>O preço de emissão é de 10 mil rublos.</i> <br><br><h3>  Abaixo o fio </h3><br>  Primeiro de tudo, você precisa quebrar essa "trela" e sentir a verdadeira liberdade no espaço de realidade virtual sem laptops pesados ​​e aquecidos por trás.  Para fazer isso, você precisa do complemento <b>TPCast</b> - um dispositivo que permite colocar o Vive no modo sem fio. <br><div style="text-align:center;"><img src="https://habrastorage.org/web/32f/afb/f62/32fafbf622c34f77b0dc5e3e1dd2bcad.jpg" alt="imagem"></div><br>  <i><b>TPCast</b></i>  <i>Opções</i> <br><br>  Todo o sistema consiste em vários módulos, mais sobre cada um: <br><br><div class="spoiler">  <b class="spoiler_title">Receptor</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/c8d/66d/7c3/c8d66d7c3d594dc6b7b5d76303362c81.jpg" alt="imagem"></div></div><br>  Monta perfeitamente no VIVE Deluxe Audio.  Ele é conectado ao capacete com fios curtos USB e HDMI, os outros 2 fios (USB e alimentação) são conectados ao adaptador na bateria. <br><br><div class="spoiler">  <b class="spoiler_title">Caixa de energia</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/c9e/d86/875/c9ed86875fdc49058a03e40c0ab3f34e.jpg" alt="imagem"></div></div><br>  Em seguida, você deve deixar de lado o linkbox padrão do Vive e conectar o seguinte módulo (transmissor) diretamente ao computador via HDMI: <br><br><div class="spoiler">  <b class="spoiler_title">Transmissor</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/18b/4fa/e89/18b4fae894af485f8a4191d282e99bd3.jpg" alt="imagem"></div></div>  Você pode usar o fio padrão ou HDMI de 10 metros.  A fonte de alimentação de um linkbox padrão deve estar conectada ao transmissor TPCast.  Devo dizer que você pode usar uma combinação com um linkbox, apenas conectando um transmissor em vez de um capacete (sem conectar um dos três fios - USB).  O transmissor deve ser colocado em um ponto na sala onde o capacete estará sempre visível, como  Se o transmissor operar em altas frequências, qualquer obstrução será um obstáculo para a transmissão de um sinal, a mesma cabeça se uma pessoa se afastar.  Em outras palavras, forneça visibilidade direta.  A melhor opção é colocar o transmissor exatamente no centro da sala, no teto, enviando-o perpendicular ao chão. <br><br>  Isso não é tudo, o kit também possui um roteador que deve ser conectado à conexão à Internet do PC.  Simplificando, o cabo Ethernet está na porta WAN do roteador e o PC está conectado ao roteador via LAN.  Se essa conexão for inaceitável, use uma placa de rede adicional.  Agora, quase tudo está pronto, resta apenas o download do software e drivers do site oficial do TPCast: <br><br><div class="spoiler">  <b class="spoiler_title">Assistente de conexão sem fio para o VIVE</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/b42/901/548/b4290154811f49b99554fc6d0654c6a9.png" alt="imagem"></div></div><br>  Após a instalação, o aplicativo solicitará que você insira os dados para conectar-se ao ponto de acesso, o nome de usuário e a senha serão indicados no adesivo no adaptador da bateria.  Tudo o que resta é clicar em Iniciar e iniciar o SteamVR após uma conexão bem-sucedida.  Se algo der errado, no menu superior direito há um item do canal Switch.  Em geral, a perda de conexão é fácil de restaurar com o toque de um botão, você também pode trocar a bateria rapidamente. <br><br><div class="spoiler">  <b class="spoiler_title">Diagrama de fiação</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/cce/401/26c/cce40126c1e54c8cbff55583d7e6e119.png" alt="imagem"></div></div><br><img src="https://habrastorage.org/web/1ca/145/27b/1ca14527be4f45abaaa10904ded5d8b5.jpg" alt="imagem"><br>  <i>Montagem <b>TPCast</b> .</i>  <i>O preço de emissão é de 35 a 40 mil rublos, mas aqui estão as características:</i> <br><br><ul><li>  Resolução 2K (normal para HTC Vive) </li><li>  90 FPS </li><li>  Atraso inferior a 2 ms </li></ul><br>  Obviamente, para uso doméstico isso é impraticável, você pode tolerar o fio, mas para uma solução comercial - uma excelente opção, especialmente se você expandir o campo de rastreamento. <br><br>  Agora você pode tentar andar no Steam Home e não se lembrar dos fios, dobras, nós e muito mais, exceto que a bateria está carregada, mas é melhor comprar outros.  Eles são suficientes para 4-5 horas de uso ativo. <br><br><h3>  Nós vamos além dos limites do que é permitido </h3><br>  Sem um fio, você rapidamente se sentirá apertado, fará uma pequena caminhada, mas no padrão de 16 metros quadrados, isso não funcionará.  A primeira coisa que você precisa é de uma sala (100 metros quadrados são adequados) e com tetos mais altos (3,5 metros).  Esta é a parte mais difícil.  No centro do teto da sala está o transmissor TPCast.  Nas laterais, as estações base HTC Vive estão montadas sob o teto.  a distância entre - 5 metros, de modo que as estações estejam localizadas em uma linha (perpendicular a duas paredes e paralela às outras duas), passando pelo centro da sala (no centro do transmissor).  Além disso, as estações precisam ser inclinadas em um ângulo de 30 graus entre si (ou seja, são mais direcionadas para o chão). <br><br>  As estações devem ser conectadas com um fio para sincronização (a óptica não funcionará de maneira estável), os canais das estações devem ser definidos como A e b.  Após a instalação, calibre a sala usando ferramentas padrão.  Vale a pena notar que, na fase de construção do acompanhante (uma grade azul indicando os limites de uma sala real), vale a pena escolher o modo avançado, que permitirá especificar apenas os cantos da sala, a grade será um quadrado uniforme.  A área de jogo está melhor posicionada no centro.  Essa configuração fornecerá uma grande área de rastreamento suficientemente preciso com um número mínimo de pontos cegos e permitirá o uso eficiente de estações regulares.  Antes de mergulhar, recomendo instalar <b>as configurações do OpenVR Advanced</b> , sua interface estará disponível diretamente no espaço VR no menu padrão.  Essas configurações melhoram a resolução, a superamostragem e configuram o acompanhante (área de ativação, cor, altura, visibilidade etc.) É claro que você ainda pode brincar com o posicionamento das estações base, alterar o ângulo ou uma pequena distância entre elas para uma determinada sala.  O resultado é impressionante, de acordo com o Steam Home padrão, é possível navegar sem chamar o teletransporte.  Na maioria dos jogos, essa área é mais do que suficiente.  Em novembro, o Vive ameaça adicionar suporte para trabalhar com um grande número de estações-base, mas ainda não está claro se o equipamento atual poderá aceitar mais de dois ou apenas novos capacetes e controladores serão capazes disso. <br><br><h3>  Pare de ser um fantasma </h3><br>  Em geral, todos os jogos de realidade virtual podem ser definidos como um único subgênero - “simulador de fantasmas”, você pode pegar objetos, jogá-los e assim por diante.  Há exceções nas quais você pode ver seu corpo imóvel, o que é muito dissonante.  De uma forma ou de outra, para desenhar um protagonista virtual em um corpo em movimento confiável, você precisa de algo da área de captura de movimento.  Capturar movimento não é o prazer mais barato se você descartar o kinekt míope e outros semelhantes, que são ineficazes nessa área de rastreamento.  Duas coisas vêm ao resgate: <b>HTC Vive Tracker</b> e cinemática inversa (IR).  O primeiro é necessário para determinar a posição de qualquer coisa na área de rastreamento; o segundo é recriar a posição do corpo no espaço virtual, sabendo a posição de apenas 6 pontos (este é o mínimo para o corpo inteiro). <br><br><img src="https://habrastorage.org/web/f5c/4c1/0c5/f5c4c10c5a484acc91d3d3d7015a8f96.png" alt="imagem"><br>  <i><b>Vive Tracker</b> .</i>  <i>Um rastreador custa cerca de 8 mil rublos</i> <br><br>  Para um conjunto mínimo, você precisará de 3 desses rastreadores.  Em geral, esses são os mesmos controladores padrão, apenas aparados e em um caso ligeiramente diferente.  Cada rastreador é definido no SteamVR, a única diferença é que eles precisam de dongles especiais (incluídos) para conectá-los, embora você possa conectá-los a um capacete em vez de controladores.  Na parte traseira, há uma área de contato para conectar botões personalizados (você também pode usar o conector USB no rastreador).  Pode ser um gatilho de arma, um botão de ativação do sabre de luz, qualquer coisa.  Pressionar esses botões é processado da mesma forma que o botão é pressionado no controlador; do ponto de vista do desenvolvimento de software, não há diferença.  Em geral, eles podem ser usados ​​para rastrear objetos de jogos, como armas ou ferramentas, até móveis e portas, mas estamos interessados ​​na captura de movimento. <br><br><img src="https://habrastorage.org/web/d0c/e11/d7f/d0ce11d7f6654937b182c12110062bd7.png" alt="imagem"><br><br>  É possível determinar a posição da cabeça usando um capacete, mãos - usando controladores.  2 rastreadores devem ser colocados no sapato (acima dos pés), o restante ficará bem no cinto na parte de trás.  Essa configuração já permitirá que você jogue alguns jogos que suportam essa configuração, mas se falarmos sobre o desenvolvimento de seu próprio software, você precisará de soluções de IR para animar o personagem.  A diferença fundamental entre a cinemática inversa e uma linha reta é que, no caso de uma linha reta, a posição é calculada, conhecendo os ângulos, e no caso da inversa, os ângulos são calculados, conhecendo a posição.  Assim, você pode criar um modelo muito simples, conhecendo a posição de dois pontos para calcular o intermediário, considerando a forma como o corpo humano geralmente se dobra.  Mas existem soluções prontas, como <b>Final IK</b> , <b>VRIK</b> e outras ferramentas de animação processual.  Existem estúdios que fornecem soluções desse tipo.  Um deles é o <b>IKinema</b> e seu produto chamado <b>Project Orion</b> - software que permite capturar movimento com base nos dados recebidos do SteamVR e transmiti-lo via protocolo <b>VRPN</b> para qualquer outro aplicativo (existem plugins e ativos prontos para Unity e Unreal).  Para uma solução de orçamento, é melhor usar os meios anteriores, que se mostram muito bem. <br><br><img src="https://habrastorage.org/web/620/596/86b/62059686b70e4be2b1db0489e3f624cf.jpg" alt="imagem"><br><br><div class="spoiler">  <b class="spoiler_title">IKinema Orion (vídeo)</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/Khoer5DpQkE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  Além disso, já no mecanismo, a animação resultante pode ser um pouco limpa, embora o Orion lide com isso, remova as paradas de escorregamento, calcule a compensação pela rugosidade do piso virtual.  O IKinema possui uma solução de plugins para o Unreal: <br><br><div class="spoiler">  <b class="spoiler_title">Ação ao vivo</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/oWqKCdFpyfI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  Em geral, os plug-ins são mais fáceis de lidar com tarefas semelhantes, ainda mais fáceis. <br>  Essas luvas, por exemplo: <br><br><img src="https://habrastorage.org/web/fa3/9c3/8ac/fa39c38ac2a04714b982323a9d7c4958.jpg" alt="imagem"><br>  <i><b>Manus vr</b></i> <br><br><h3>  Conclusão </h3><br>  Hoje, a captura de movimento está se tornando mais acessível, assim como a realidade virtual, o que é certamente agradável.  Estão chegando vários jogos, nos quais haverá suporte para rastreadores e animações do protagonista, de acordo com os movimentos do jogador.  Obviamente, tudo isso ainda não é tão conveniente e acessível quanto gostaríamos, mas agora é possível montar esse sistema por um custo relativamente baixo.  Não é necessário dizer que o jogador de massa pode se dar ao luxo de equipar seu espaço de jogo dessa maneira, mas na forma de uma atração, esse será um nível totalmente novo. <br><br>  Algumas observações: <br><br>  Para abandonar o fio, havia mais fios em geral. <br>  Depois de adquirir um corpo virtual, parece que o grau de realismo está aumentando, mas ver sua sombra em movimento no espaço virtual é outra tarefa para o cérebro, a tontura começa, então é melhor desativá-lo (isso é individual) <br><br>  O rastreamento do corpo e dos objetos abre um grande número de oportunidades para a criação de mecânica de jogo e o efeito da imersão em geral. <br><br>  O resultado da montagem desse sistema em vídeo no início do post.  Também um exemplo de animação de personagem em tempo real: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/AQuCKXnuqKM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt406843/">https://habr.com/ru/post/pt406843/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt406833/index.html">“Apesar da idade”: como proteger sua audição</a></li>
<li><a href="../pt406835/index.html">Pode haver dois tipos de medicamento: cientistas criticam a homeopatia e alertam para riscos significativos à saúde</a></li>
<li><a href="../pt406837/index.html">Batalha: assassinos de drones contra o "imortal" DJI Phantom 4</a></li>
<li><a href="../pt406839/index.html">Introdução Estudo do STM32 ou Gerenciamento inteligente da luz</a></li>
<li><a href="../pt406841/index.html">Modelagem - para as massas</a></li>
<li><a href="../pt406845/index.html">Equação de Poisson e distribuição de Boltzmann (parte 2.1)</a></li>
<li><a href="../pt406847/index.html">Agregador de criptomoedas XRONOS lança pré-venda de moedas</a></li>
<li><a href="../pt406851/index.html">Mini-sistema Denon D-M41: um retorno ao conceito de um centro de música, Hi-Fi para a classe média</a></li>
<li><a href="../pt406853/index.html">ESA convida empresas comerciais a participarem na exploração da lua</a></li>
<li><a href="../pt406855/index.html">"Oportunidades" invisíveis no estudo de Marte</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>