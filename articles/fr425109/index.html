<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî© ü•î ‚ÜñÔ∏è Le livre ¬´Java dans le cloud. Spring Boot, Spring Cloud, Cloud Foundry ¬ª üèø ‚ñ™Ô∏è üöª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! Ce livre est principalement destin√© aux d√©veloppeurs de machines Java et JVM qui recherchent des moyens de cr√©er de meilleurs logiciel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le livre ¬´Java dans le cloud. Spring Boot, Spring Cloud, Cloud Foundry ¬ª</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/425109/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/g5/vp/gz/g5vpgzgoyh2hlalmrajcysuwvwo.jpeg" align="left" alt="image"></a>  Bonjour √† tous!  Ce livre est principalement destin√© aux d√©veloppeurs de machines Java et JVM qui recherchent des moyens de cr√©er de meilleurs logiciels en peu de temps en utilisant Spring Boot, Spring Cloud et Cloud Foundry.  C'est pour ceux qui ont d√©j√† entendu le bruit monter autour des microservices.  Vous avez peut-√™tre d√©j√† r√©alis√© quelle hauteur stratosph√©rique Spring Boot a d√©coll√©, et vous √™tes surpris que les entreprises utilisent aujourd'hui la plate-forme Cloud Foundry.  Si oui, alors ce livre est pour vous. <br><br><h3>  Extrait.  3. Style de configuration d'application √† douze facteurs </h3><br>  Ce chapitre explique comment impl√©menter la configuration de l'application. <br><a name="habracut"></a><br>  D√©finissez un certain nombre de termes de vocabulaire.  En ce qui concerne la configuration dans Spring, ce que je veux souvent dire, c'est d'introduire diverses impl√©mentations du contexte d'application, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ApplicationContext</a> , dans l'environnement Spring, ce qui aide le conteneur √† comprendre comment connecter les composants du bean.  Cette configuration peut √™tre repr√©sent√©e sous la forme d'un fichier XML √† soumettre √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ClassPathXmlApplicationContext</a> ou √† des classes Java annot√©es d'une mani√®re qui vous permet d'√™tre fourni √† l'objet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AnnotationConfigApplicationContext</a> .  Et bien s√ªr, lorsque nous √©tudierons la derni√®re option, nous ferons r√©f√©rence √† <i>la configuration Java.</i> <br><br>  Mais dans ce chapitre, nous allons examiner la configuration sous la forme dans laquelle elle est d√©finie dans le manifeste de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">application √† 12 facteurs</a> .  Dans ce cas, il s'agit de valeurs litt√©rales qui peuvent changer d'un environnement √† un autre: nous parlons de mots de passe, de ports et de noms d'h√¥tes, ou d'indicateurs de propri√©t√©.  La configuration ignore les constantes magiques int√©gr√©es au code.  Le manifeste comprend un excellent crit√®re pour la configuration correcte: la base de code de l'application peut-elle √™tre open source √† tout moment sans divulguer et compromettre les informations d'identification importantes?  Ce type de configuration fait exclusivement r√©f√©rence aux valeurs qui varient d'un environnement √† l'autre et ne s'appliquent pas, par exemple, √† la connexion des beans Spring ou √† la configuration des routes Ruby. <br><br><h3>  Support dans le cadre Spring </h3> <br>  Au printemps, un style de configuration √† 12 facteurs est pris en charge depuis l'av√®nement de la classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PropertyPlaceholderConfigurer</a> .  Une fois son instance d√©finie, il remplace les litt√©raux de la configuration XML par les valeurs extraites du fichier avec l'extension .properties.  Dans l'environnement Spring, la classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PropertyPlaceholderConfigurer</a> est propos√©e depuis 2003.  Spring 2.5 a introduit la prise en charge de l'espace de noms XML et en m√™me temps la prise en charge de la substitution de propri√©t√©s dans cet espace.  Cela permet la substitution dans la configuration XML des valeurs litt√©rales des d√©finitions des composants du bean par les valeurs affect√©es aux cl√©s dans le fichier de propri√©t√©s externes (dans ce cas, dans le fichier simple.properties, qui peut appara√Ætre dans le chemin d'acc√®s aux classes ou √™tre externe √† l'application). <br><br>  La configuration dans le style de 12 facteurs vise √† √©liminer le manque de fiabilit√© des lignes magiques existantes, c'est-√†-dire des valeurs comme les adresses des bases de donn√©es et les comptes pour s'y connecter, les ports, etc., cod√©s en dur dans une application compil√©e.  Si la configuration est d√©plac√©e en dehors de l'application, elle peut √™tre remplac√©e sans recourir √† un nouvel assemblage de code. <br><br><h3>  Classe PropertyPlaceholderConfigurer </h3><br>  Examinons un exemple d'utilisation de la classe PropertyPlaceholderConfigurer, les d√©finitions XML des composants du bean Spring et un fichier avec l'extension .properties prise hors des limites de l'application.  Il suffit d'imprimer la valeur disponible dans ce fichier de propri√©t√©s.  Cela vous aidera √† faire le code montr√© dans l'exemple 3.1. <br><br>  Exemple 3.1  Fichier de propri√©t√©s: some.properties <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span>.projectName=Spring Framework</code> </pre> <br>  Il s'agit de la classe ClassPathXmlApplicationContext de Spring, nous utilisons donc l'espace de noms XML du contexte Spring et pointons vers notre fichier some.properties.  Ensuite, nous utilisons des litt√©raux sous la forme de $ {configuration.projectName} dans les d√©finitions des composants du bean, et Spring les remplacera par les valeurs de notre fichier de propri√©t√©s lors de l'ex√©cution (exemple 3.2). <br><br>  Exemple 3.2.  Fichier XML de configuration Spring <br><br><pre> <code class="hljs pgsql">&lt;context:property-placeholder <span class="hljs-keyword"><span class="hljs-keyword">location</span></span>="classpath:some.properties"/&gt; (<span class="hljs-number"><span class="hljs-number">1</span></span>) &lt;bean <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>="classic.Application"&gt; &lt;property <span class="hljs-type"><span class="hljs-type">name</span></span>="configurationProjectName" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="${configuration.projectName}"/&gt; &lt;/bean&gt;</code> </pre> <br>  (1) classpath: un emplacement qui fait r√©f√©rence √† un fichier dans le bloc de code compil√© actuel (.jar, .war, etc.).  Spring prend en charge de nombreuses alternatives, notamment file: et url :, qui permettent au fichier d'exister en dehors du bloc de code. <br><br>  Enfin, regardons √† quoi ressemble la classe Java, gr√¢ce √† laquelle il est possible de rassembler tout cela (exemple 3.3). <br><br>  Exemple 3.3  La classe Java qui doit √™tre configur√©e avec la valeur de propri√©t√© <br>  paquet classique; <br><br><pre> <code class="hljs actionscript"><span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.apache.commons.logging.LogFactory;</span></span> <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.springframework.context.support.ClassPathXmlApplicationContext;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> main(String[] args) { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ClassPathXmlApplicationContext(<span class="hljs-string"><span class="hljs-string">"classic.xml"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> setConfigurationProjectName(String pn) { LogFactory.getLog(getClass()).info(<span class="hljs-string"><span class="hljs-string">"the configuration project name is "</span></span> + pn); } }</code> </pre> <br>  Le premier exemple utilise le format XML de configuration du bean Spring.  Dans Spring 3.0 et 3.1, la situation des d√©veloppeurs utilisant la configuration Java s'est consid√©rablement am√©lior√©e.  L'annotation de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">valeur</a> et l'abstraction d'environnement ont √©t√© introduites dans ces versions. <br><br><h3>  Environnement abstrait et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">valeur</a> </h3><br>  L'abstraction d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">environnement</a> repr√©sente, lors de l'ex√©cution du code, sa relation indirecte avec l'environnement dans lequel il s'ex√©cute, et permet √† l'application de poser la question (¬´Quel s√©parateur de ligne est line.separator sur cette plateforme?¬ª) A propos des propri√©t√©s de l'environnement.  Une abstraction agit comme un mappage √† partir de cl√©s et de valeurs.  En configurant le PropertySource dans l'environnement, vous pouvez configurer d'o√π ces valeurs seront lues.  Par d√©faut, Spring charge les cl√©s syst√®me et les valeurs d'environnement, telles que line.separator.  Vous pouvez demander √† Spring de charger les cl√©s de configuration √† partir d'un fichier dans le m√™me ordre que celui utilis√© dans les versions ant√©rieures de la solution de substitution de propri√©t√©s de Spring √† l'aide de l'annotation @PropertySource. <br><br>  L'annotation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Value</a> fournit un moyen d'incorporer des valeurs d'environnement dans les constructeurs, les setters, les champs, etc. Ces valeurs peuvent √™tre calcul√©es √† l'aide du Spring Expression Language ou de la syntaxe de substitution de propri√©t√© √† condition que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PropertySourcesPlaceholderConfigurer soit</a> enregistr√©, comme dans l'exemple 3.4. <br><br>  Exemple 3.4.  Enregistrer PropertySourcesPlaceholderConfigurer <br>  package env; <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.logging.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.logging.LogFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.InitializingBean; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Value; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.AnnotationConfigApplicationContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Bean; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.PropertySource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.support.PropertySourcesPlaceholderConfigurer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.env.Environment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.PostConstruct; (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@PropertySource(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"some.properties"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Log log = LogFactory.getLog(getClass()); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> static void main(String[] args) throws Throwable { new AnnotationConfigApplicationContext(Application.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>); } (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> static PropertySourcesPlaceholderConfigurer pspc() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new PropertySourcesPlaceholderConfigurer(); } (<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"</span></span><span class="hljs-subst"><span class="hljs-meta"><span class="hljs-meta-string"><span class="hljs-subst">${configuration.projectName}</span></span></span></span><span class="hljs-meta"><span class="hljs-meta-string">"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String fieldValue; (<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> Application(<span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"</span></span><span class="hljs-subst"><span class="hljs-meta"><span class="hljs-meta-string"><span class="hljs-subst">${configuration.projectName}</span></span></span></span><span class="hljs-meta"><span class="hljs-meta-string">"</span></span></span><span class="hljs-meta">)</span></span> String pn) { log.info(<span class="hljs-string"><span class="hljs-string">"Application constructor: "</span></span> + pn); } (<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"</span></span><span class="hljs-subst"><span class="hljs-meta"><span class="hljs-meta-string"><span class="hljs-subst">${configuration.projectName}</span></span></span></span><span class="hljs-meta"><span class="hljs-meta-string">"</span></span></span><span class="hljs-meta">)</span></span> void setProjectName(String projectName) { log.info(<span class="hljs-string"><span class="hljs-string">"setProjectName: "</span></span> + projectName); } (<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> void setEnvironment(Environment env) { log.info(<span class="hljs-string"><span class="hljs-string">"setEnvironment: "</span></span> + env.getProperty(<span class="hljs-string"><span class="hljs-string">"configuration.projectName"</span></span>)); } (<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> InitializingBean both(Environment env, <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"</span></span><span class="hljs-subst"><span class="hljs-meta"><span class="hljs-meta-string"><span class="hljs-subst">${configuration.projectName}</span></span></span></span><span class="hljs-meta"><span class="hljs-meta-string">"</span></span></span><span class="hljs-meta">)</span></span> String projectName) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> () -&gt; { log.info(<span class="hljs-string"><span class="hljs-string">"@Bean with both dependencies (projectName): "</span></span> + projectName); log.info(<span class="hljs-string"><span class="hljs-string">"@Bean with both dependencies (env): "</span></span> + env.getProperty(<span class="hljs-string"><span class="hljs-string">"configuration.projectName"</span></span>)); }; } <span class="hljs-meta"><span class="hljs-meta">@PostConstruct</span></span> void afterPropertiesSet() throws Throwable { log.info(<span class="hljs-string"><span class="hljs-string">"fieldValue: "</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fieldValue); } }</code> </pre> <br>  (1) Annotation @PropertySource est un raccourci similaire √† property-placeholder, qui configure un PropertySource √† partir d'un fichier avec l'extension .properties. <br><br>  (2) PropertySourcesPlaceholderConfigurer doit √™tre enregistr√© en tant que bean statique, car il s'agit d'une impl√©mentation de BeanFactoryPostProcessor et doit √™tre appel√© √† un stade pr√©coce du cycle de vie d'initialisation dans le bean Spring.  Lorsque vous utilisez des composants de bean dans une configuration Spring XML, cette nuance n'est pas visible. <br><br>  (3) Vous pouvez d√©corer les champs avec l'annotation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Value</a> (mais ne le faites pas, sinon le code ne passera pas le test!) ... <br><br>  (4) ... ou l'annotation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Value</a> peut d√©corer les param√®tres du constructeur ... <br><br>  (5) ... ou utilisez des m√©thodes d'installation ... <br><br>  (6) ... ou int√©grez un objet Spring Environment et effectuez la r√©solution des cl√©s manuellement. <br><br>  (7) Les param√®tres avec l'annotation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Value</a> peuvent √©galement √™tre utilis√©s dans le fournisseur d'arguments de la m√©thode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Bean</a> dans la configuration Spring Java. <br><br>  Dans cet exemple, les valeurs sont charg√©es √† partir du fichier simple.properties, puis il a la valeur configuration.projectName, qui est fournie de diff√©rentes mani√®res. <br><br><h3>  Profils </h3><br>  Entre autres, l'abstraction Environnement introduit des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">profils</a> .  Cela vous permet d'attribuer des √©tiquettes (profils) afin de regrouper les composants du bean.  Les profils doivent √™tre utilis√©s pour d√©crire les composants du bean et les graphiques de bean qui varient d'un environnement √† l'autre.  Plusieurs profils peuvent √™tre activ√©s simultan√©ment.  Les beans auxquels aucun profil n'est affect√© sont toujours activ√©s.  Les beans qui ont un profil par d√©faut ne sont activ√©s que s'ils n'ont pas d'autres profils actifs.  L'attribut profile peut √™tre sp√©cifi√© dans la d√©finition du composant bean en XML ou dans les classes de balises, les classes de configuration, les composants bean individuels ou dans les m√©thodes du fournisseur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Bean</a> utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Profile</a> . <br><br>  Les profils vous permettent de d√©crire des ensembles de composants de bean qui doivent √™tre cr√©√©s dans un environnement quelque peu diff√©remment que dans un autre.  Dans un profil de d√©veloppement local, par exemple, vous pouvez utiliser la source de donn√©es H2 int√©gr√©e javax.sql.DataSource, puis, lorsque le profil prod est actif, basculez vers la source de donn√©es javax.sql.DataSource obtenue √† l'aide de la recherche JNDI ou en lisant les propri√©t√©s d'une variable d'environnement dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cloud Foundry</a> .  Dans les deux cas, votre code fonctionnera: vous obtenez javax.sql.DataSource, mais la d√©cision concernant l'instance particuli√®re √† utiliser est prise en activant un ou plusieurs profils (exemple 3.5). <br><br>  Exemple 3.5  D√©monstration que les classes @Configuration peuvent charger divers fichiers de configuration et fournir diff√©rents beans en fonction de <br>  profil actif <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> profiles; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.logging.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.logging.LogFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.InitializingBean; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Value; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.support.PropertySourcesPlaceholderConfigurer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.env.Environment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.util.StringUtils; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Log log = LogFactory.getLog(getClass()); <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> static PropertySourcesPlaceholderConfigurer pspc() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new PropertySourcesPlaceholderConfigurer(); } (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@Profile(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"prod"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@PropertySource(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"some-prod.properties"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> static <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProdConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> InitializingBean <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> () -&gt; LogFactory.getLog(getClass()).info(<span class="hljs-string"><span class="hljs-string">"prod InitializingBean"</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@Profile({ </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"default"</span></span></span><span class="hljs-meta">, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"dev"</span></span></span><span class="hljs-meta"> })</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-meta"><span class="hljs-meta">@PropertySource(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"some.properties"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> static <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DefaultConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> InitializingBean <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> () -&gt; LogFactory.getLog(getClass()).info(<span class="hljs-string"><span class="hljs-string">"default InitializingBean"</span></span>); } } (<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> InitializingBean which(Environment e, <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"</span></span><span class="hljs-subst"><span class="hljs-meta"><span class="hljs-meta-string"><span class="hljs-subst">${configuration.projectName}</span></span></span></span><span class="hljs-meta"><span class="hljs-meta-string">"</span></span></span><span class="hljs-meta">)</span></span> String projectName) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> () -&gt; { log.info(<span class="hljs-string"><span class="hljs-string">"activeProfiles: '"</span></span> + StringUtils.arrayToCommaDelimitedString(e.getActiveProfiles()) + <span class="hljs-string"><span class="hljs-string">"'"</span></span>); log.info(<span class="hljs-string"><span class="hljs-string">"configuration.projectName: "</span></span> + projectName); }; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> static void main(String[] args) { AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(); ac.getEnvironment().setActiveProfiles(<span class="hljs-string"><span class="hljs-string">"dev"</span></span>); (<span class="hljs-number"><span class="hljs-number">4</span></span>) ac.register(Application.<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>); ac.refresh(); } }</code> </pre> <br>  (1) Cette classe de configuration et toutes les d√©finitions de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">bean qu'elle</a> contient ne seront calcul√©es que si le profil prod est actif. <br><br>  (2) Cette classe de configuration et toutes les d√©finitions de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">bean qu'elle</a> contient ne seront calcul√©es que si le profil de d√©veloppement est actif ou qu'aucun profil n'est actif, y compris le d√©veloppement. <br><br>  (3) Ce composant InitializingBean enregistre simplement le profil actuellement actif et saisit la valeur qui a finalement √©t√© entr√©e dans le fichier de propri√©t√©s. <br><br>  (4) L'activation d'un ou plusieurs profils par programmation est assez simple. <br><br>  Spring r√©pond √† plusieurs autres m√©thodes d'activation de profil √† l'aide du jeton spring_profiles_active ou spring.profiles.active.  Un profil peut √™tre d√©fini √† l'aide d'une variable d'environnement (par exemple, SPRING_PROFILES_ACTIVE), une propri√©t√© JVM (‚ÄëDspring.profiles.active = ...), un param√®tre d'initialisation d'application de servlet ou par programme. <br><br><h3>  Configuration bootiful </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring Boot</a> am√©liore consid√©rablement la situation.  L'environnement charge initialement automatiquement les propri√©t√©s √† partir d'une hi√©rarchie d'emplacements pr√©d√©finis.  Les arguments de ligne de commande remplacent les valeurs de propri√©t√© d√©riv√©es de JNDI, qui remplacent les propri√©t√©s obtenues √† partir de System.getProperties (), etc. <br><br>  - Arguments de ligne de commande. <br>  - Attributs JNDI de java: comp / env. <br>  - Propri√©t√©s de System.getProperties (). <br>  - Variables d'environnement du syst√®me d'exploitation. <br>  - Fichiers de propri√©t√©s externes dans le syst√®me de fichiers: (config /)? Application. (Yml.properties). <br>  - Fichiers de propri√©t√©s internes dans l'archive (config /)? Application. (Yml.properties). <br>  - Annotation @PropertySource dans les classes de configuration. <br>  - Propri√©t√©s source de SpringApplication.getDefaultProperties (). <br><br>  Si le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">profil est actif, les</a> donn√©es des fichiers de configuration bas√©s sur le nom du profil seront automatiquement lues, par exemple, √† partir d'un fichier tel que src / main / resources / application-foo.properties, o√π foo est le profil actuel. <br><br>  Si la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SnakeYAML est</a> mentionn√©e dans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chemins de classe</a> , les fichiers YAML seront √©galement charg√©s automatiquement, suivant essentiellement la m√™me convention. <br><br><blockquote>  La page de sp√©cification <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">YAML</a> indique que ¬´YAML est une norme lisible par l'homme pour la s√©rialisation des donn√©es pour tous les langages de programmation¬ª.  YAML est une repr√©sentation hi√©rarchique des valeurs.  Dans les fichiers normaux avec l'extension .properties, la hi√©rarchie est indiqu√©e par un point (¬´.¬ª), Et dans les fichiers YAML, une nouvelle ligne et un niveau de retrait suppl√©mentaire sont utilis√©s.  Il serait int√©ressant d'utiliser ces fichiers pour √©viter d'avoir √† sp√©cifier des racines communes en pr√©sence d'arbres de configuration hautement ramifi√©s. </blockquote><br>  Le contenu d'un fichier avec l'extension .yml est illustr√© dans l'exemple 3.6. <br><br>  Exemple 3.6  Fichier de propri√©t√©s Application.yml.  Les donn√©es sont pr√©sent√©es par ordre hi√©rarchique. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span>: projectName : Spring Boot management: <span class="hljs-keyword"><span class="hljs-keyword">security</span></span>: enabled: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> </pre> <br>  De plus, l'environnement Spring Boot permet d'obtenir beaucoup plus facilement le bon r√©sultat dans les cas g√©n√©raux.  Il transforme les arguments -D en variables d'environnement de processus et java disponibles en tant que propri√©t√©s.  Il effectue m√™me leur normalisation, dans laquelle la variable d'environnement $ CONFIGURATION_PROJECTNAME (PROJECT_NAME CONFIGURATION) ou l'argument -D sous la forme ‚ÄìDconfiguration.projectName (configuration.project_name) sont rendus disponibles en utilisant la cl√© configuration.projectName (configuration.project_name) comme avant. le jeton spring_profiles_active est disponible. <br><br>  Les valeurs de configuration sont des cha√Ænes et si elles sont suffisantes, elles peuvent devenir illisibles lorsque vous essayez de vous assurer que ces cl√©s ne deviennent pas elles-m√™mes des cha√Ænes magiques dans le code.  Spring Boot pr√©sente le type de composant @ConfigurationProperties.  Lors de l'annotation d'un POJO - Plain Old Java Object - √† l'aide de @ConfigurationProperties et en sp√©cifiant un pr√©fixe, Spring tentera de mapper toutes les propri√©t√©s commen√ßant par ce pr√©fixe aux propri√©t√©s POJO.  Dans l'exemple ci-dessous, la valeur de configuration.projectName sera mapp√©e sur une instance POJO, que tout le code peut ensuite injecter et d√©r√©f√©rencer pour lire les valeurs de type s√©curis√©.  Par cons√©quent, vous n'aurez qu'un mappage de la cl√© (String) en un seul endroit (exemple 3.7). <br><br>  Exemple 3.7.  R√©solution automatique des propri√©t√©s depuis src / main / resources / application.yml <br>  d√©marrage du package; <br><br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.logging.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.logging.LogFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.SpringApplication; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.SpringBootApplication; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.context.properties.ConfigurationProperties; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.context.properties.EnableConfigurationProperties; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Component; (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-meta"><span class="hljs-meta">@EnableConfigurationProperties</span></span> <span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Log log = LogFactory.getLog(getClass()); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class); } <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ConfigurationProjectProperties cp)</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"configurationProjectProperties.projectName = "</span></span> + cp.getProjectName()); } } (<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConfigurationProperties</span></span>(<span class="hljs-string"><span class="hljs-string">"configuration"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConfigurationProjectProperties</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String projectName; (<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getProjectName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> projectName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setProjectName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String projectName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.projectName = projectName; } }</code> </pre> <br>  (1) L'annotation @EnableConfigurationProperties indique √† Spring de mapper les propri√©t√©s aux POJO annot√©s avec @ConfigurationProperties. <br><br>  (2) L'annotation @ConfigurationProperties montre √† Spring que ce bean doit √™tre utilis√© comme racine pour toutes les propri√©t√©s √† partir de la configuration., Suivi par des jetons qui correspondent aux propri√©t√©s de l'objet. <br><br>  (3) Le champ projectName aura finalement la valeur affect√©e √† la cl√© de propri√©t√© configuration.projectName. <br><br>  Spring Boot utilise activement le m√©canisme @ConfigurationProperties pour donner aux utilisateurs la possibilit√© de remplacer les composants √©l√©mentaires du syst√®me.  Vous pouvez remarquer que les cl√©s de propri√©t√©s vous permettent d'apporter des modifications, par exemple, en ajoutant la d√©pendance org.springframework.boot: spring-boot-starter-actuator √† une application Web Spring Boot, puis en visitant la page <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">127.0.0.1</a> : 8080 / configprops. <br><br><blockquote>  Les points de terminaison de l'actionneur seront abord√©s plus en d√©tail au chapitre 13. Ils sont verrouill√©s et n√©cessitent un nom d'utilisateur et un mot de passe par d√©faut.  Les mesures de s√©curit√© peuvent √™tre d√©sactiv√©es (mais uniquement pour examiner ces points) en sp√©cifiant management.security.enabled = false dans le fichier application.properties (ou dans application.yml). </blockquote><br>  Vous obtiendrez une liste des propri√©t√©s de configuration prises en charge en fonction des types pr√©sent√©s dans les chemins de classe lors de l'ex√©cution.  √Ä mesure que le nombre de types de Spring Boot augmente, des propri√©t√©s suppl√©mentaires s'affichent.  Ce point de terminaison affichera √©galement les propri√©t√©s export√©es par vos POJO qui ont l'annotation @ConfigurationProperties. <br><br><h3>  Configuration enregistr√©e centralis√©e √† l'aide de Spring Cloud Configuration Server </h3><br>  Jusqu'√† pr√©sent, tout va bien, mais les choses doivent √™tre encore plus r√©ussies.  Nous n'avons toujours pas r√©pondu aux questions concernant les cas d'utilisation courants: <br><br><ul><li>  apr√®s les modifications apport√©es √† la configuration de l'application, un red√©marrage est n√©cessaire; </li><li>  pas de tra√ßabilit√©: comment d√©terminer les modifications mises en service et si besoin les annuler? </li><li>  la configuration est d√©centralis√©e;  on ne sait pas imm√©diatement o√π les modifications doivent √™tre apport√©es afin de changer l'un ou l'autre aspect; </li><li>  aucune prise en charge d'installation pour l'encodage et le d√©codage √† des fins de s√©curit√©. </li></ul><br><h3>  Serveur de configuration Spring Cloud </h3><br>  Le probl√®me de la centralisation de la configuration peut √™tre r√©solu en enregistrant la configuration dans un r√©pertoire et en y pointant toutes les applications.  Vous pouvez √©galement installer le contr√¥le de version de ce r√©pertoire en utilisant Git ou Subversion.  Ensuite, le soutien n√©cessaire √† la v√©rification et √† l'enregistrement sera re√ßu.  Mais les deux derni√®res exigences ne seront toujours pas remplies, donc quelque chose de plus sophistiqu√© est n√©cessaire.  Passez au serveur de configuration <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring Cloud</a> .  La plateforme Spring Cloud propose un serveur de configuration et un client pour ce serveur. <br><br>  Le serveur Spring Cloud Config est une API REST √† laquelle nos clients se connecteront pour r√©cup√©rer leur configuration.  Le serveur g√®re √©galement le r√©f√©rentiel de configuration du contr√¥le de version.  Il est un interm√©diaire entre nos clients et le r√©f√©rentiel de configuration, et est donc dans une position favorable pour impl√©menter des outils de s√©curit√© pour connecter les connexions des clients au service et les connexions du service aux r√©f√©rentiels de configuration avec contr√¥le de version.  Le client Spring Cloud Config fournit aux applications clientes une nouvelle √©tendue, actualis√©e, qui vous permet de reconfigurer les composants Spring sans avoir √† red√©marrer l'application. <br><br><blockquote>  Des technologies telles que le serveur Spring Cloud Config jouent un r√¥le important, mais entra√Ænent des frais suppl√©mentaires.  Id√©alement, cette responsabilit√© devrait √™tre transf√©r√©e √† la plateforme et automatis√©e.  Lorsque vous utilisez Cloud Foundry, vous pouvez trouver le service Config Server dans le catalogue de services, dont les actions sont bas√©es sur l'utilisation du serveur Spring Cloud Config. </blockquote><br>  Prenons un exemple simple.  Tout d'abord, configurez le serveur Spring Cloud Config.  Un tel service est accessible par plusieurs applications Spring Boot √† la fois.  Vous devez le faire fonctionner quelque part et d'une mani√®re ou d'une autre.  Il ne reste alors qu'√† informer l'ensemble de nos services o√π trouver le service de configuration.  Il fonctionne comme une sorte d'interm√©diaire pour les cl√©s de configuration et les valeurs qu'il lit √† partir du stockage Git sur le r√©seau ou √† partir du disque.  Ajoutez la cha√Æne org.springframework.cloud: spring-cloud-config-server √† l'assembly de votre application Spring Boot pour acc√©der au serveur Spring Cloud Config (exemple 3.8). <br><br>  Exemple 3.8.  Pour incorporer un serveur de configuration dans l'assembly, utilisez l'annotation @EnableConfigServer <br><br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> demo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.SpringApplication; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.SpringBootApplication; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.cloud.config.server.EnableConfigServer; (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableConfigServer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class, args); } }</code> </pre> <br>  (1) L'utilisation de l'annotation @EnableConfigServer entra√Æne l'installation du serveur Spring Cloud Config. <br><br>  L'exemple 3.9 montre la configuration du service de configuration. <br><br>  Exemple 3.9.  Configuration du serveur de configuration Src / main / resources / application.yml <br><br>  server.port = 8888 <br>  spring.cloud.config.server.git.uri = \ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/cloud-native-java/config-server-configuration-repository</a> (1) <br><br>  (1) Une indication d'un r√©f√©rentiel Git fonctionnel de nature locale ou accessible sur le r√©seau (par exemple, sur GitHub (https://github.com/)) et utilis√© par le serveur Spring Cloud Config. <br><br>  Ici, le service de configuration Spring Cloud est charg√© de rechercher des fichiers de configuration pour des clients individuels dans le r√©f√©rentiel Git sur GitHub.  Nous avons point√© ce r√©f√©rentiel, mais un lien vers n'importe quel URI Git valide ferait l'affaire.  Bien s√ªr, il n'a m√™me pas besoin de postuler au syst√®me Git, vous pouvez utiliser Subversion ou m√™me des r√©pertoires non g√©r√©s (bien que nous vous d√©conseillons fortement de le faire).  Dans ce cas, l'URI de stockage est cod√© en dur, mais rien ne l'emp√™che d'obtenir de l'argument -D, de l'argument ou d'une variable d'environnement. <br><br>  ¬ªPlus d'informations sur le livre sont disponibles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le site Web de l'√©diteur</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Contenu</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extrait</a> <br><br>  20% de r√©duction sur le coupon pour <b>les</b> fermenteurs <b>Java</b> - <b>Java</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425109/">https://habr.com/ru/post/fr425109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425099/index.html">Ce que j'ai compris et quels probl√®mes j'ai rencontr√©s lors de la cr√©ation d'un clone de Hacker News</a></li>
<li><a href="../fr425101/index.html">Docker + Laravel = ‚ù§</a></li>
<li><a href="../fr425103/index.html">Emp√™chez Google Predators de poursuivre vos enfants</a></li>
<li><a href="../fr425105/index.html">Intel ME Manufacturing Mode - une menace cach√©e ou ce qui se cache derri√®re la vuln√©rabilit√© CVE-2018-4251 du MacBook</a></li>
<li><a href="../fr425107/index.html">Digest Fintech: probl√®mes de biom√©trie sur mobile, location de t√©l√©phones Samsung, titres sur la blockchain</a></li>
<li><a href="../fr425111/index.html">Astuces publicitaires qui peuvent vous co√ªter de l'argent et de la r√©putation</a></li>
<li><a href="../fr425113/index.html">¬´Typographie num√©rique¬ª ou mon exp√©rience dans la num√©risation mobile de livres</a></li>
<li><a href="../fr425115/index.html">DevOps √† part enti√®re: trag√©die grecque en trois actes</a></li>
<li><a href="../fr425117/index.html">Deux bits par transistor: ROM haute densit√© dans une puce √† virgule flottante Intel 8087</a></li>
<li><a href="../fr425123/index.html">Le c≈ìur myst√©rieux de la bo√Æte √† rythmes Roland TR-808</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>