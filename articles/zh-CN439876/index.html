<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤³ ğŸ¤¾ğŸ¿ ğŸ’‡ğŸ½ å°†æ•°æ®ä»Greenplum 4è¿ç§»åˆ°Greenplum 5æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•å…‹æœä¸å…¼å®¹æ€§ ğŸš‚ ğŸ›ï¸ ğŸ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å½“æˆ‘ä»¬é€‰æ‹©ä¸€ç§å¤„ç†å¤§æ•°æ®çš„å·¥å…·æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä¸åŒçš„é€‰æ‹©-ä¸“æœ‰å’Œå¼€æºã€‚ æˆ‘ä»¬è¯„ä¼°äº†æŠ€æœ¯çš„å¿«é€Ÿé€‚åº”ï¼Œå¯è®¿é—®æ€§å’Œçµæ´»æ€§çš„å¯èƒ½æ€§ã€‚ åŒ…æ‹¬ç‰ˆæœ¬ä¹‹é—´çš„è¿ç§»ã€‚ ç»“æœï¼Œæˆ‘ä»¬é€‰æ‹©äº†æœ€ç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„Greenplumå¼€æºè§£å†³æ–¹æ¡ˆï¼Œä½†éœ€è¦è§£å†³ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚ 



 äº‹å®æ˜¯Greenplumæ•°æ®åº“æ–‡ä»¶ç‰ˆæœ¬4å’Œ5å½¼æ­¤ä¸å…¼å®¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å°†æ•°æ®ä»Greenplum 4è¿ç§»åˆ°Greenplum 5æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•å…‹æœä¸å…¼å®¹æ€§</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/439876/"> å½“æˆ‘ä»¬é€‰æ‹©ä¸€ç§å¤„ç†å¤§æ•°æ®çš„å·¥å…·æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä¸åŒçš„é€‰æ‹©-ä¸“æœ‰å’Œå¼€æºã€‚ æˆ‘ä»¬è¯„ä¼°äº†æŠ€æœ¯çš„å¿«é€Ÿé€‚åº”ï¼Œå¯è®¿é—®æ€§å’Œçµæ´»æ€§çš„å¯èƒ½æ€§ã€‚ åŒ…æ‹¬ç‰ˆæœ¬ä¹‹é—´çš„è¿ç§»ã€‚ ç»“æœï¼Œæˆ‘ä»¬é€‰æ‹©äº†æœ€ç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„Greenplumå¼€æºè§£å†³æ–¹æ¡ˆï¼Œä½†éœ€è¦è§£å†³ä¸€ä¸ªé‡è¦é—®é¢˜ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ff/69c/0d9/9ff69c0d9031f0afb897244dd0778e9e.png"><br><br> äº‹å®æ˜¯Greenplumæ•°æ®åº“æ–‡ä»¶ç‰ˆæœ¬4å’Œ5å½¼æ­¤ä¸å…¼å®¹ï¼Œå› æ­¤ä¸å¯èƒ½ä»ä¸€ä¸ªç‰ˆæœ¬ç®€å•å‡çº§åˆ°å¦ä¸€ä¸ªç‰ˆæœ¬ã€‚ æ•°æ®è¿ç§»åªèƒ½é€šè¿‡ä¸Šè½½å’Œä¸‹è½½æ•°æ®æ¥å®Œæˆã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºæ­¤è¿ç§»çš„å¯èƒ½é€‰é¡¹ã€‚ <br><a name="habracut"></a><br><h2> è¯„ä¼°è¿ç§»é€‰é¡¹ </h2><br><h3>  pg_dumpå’Œpsqlï¼ˆæˆ–pg_restoreï¼‰ </h3><br> å½“è¾¾åˆ°æ•°åå…†å­—èŠ‚æ—¶ï¼Œè¿™å¤ªæ…¢äº†ï¼Œå› ä¸ºæ‰€æœ‰æ•°æ®éƒ½æ˜¯é€šè¿‡ä¸»èŠ‚ç‚¹ä¸Šè½½å’Œä¸‹è½½çš„ã€‚ ä½†æ˜¯è¶³å¤Ÿå¿«ï¼Œå¯ä»¥è¿ç§»DDLå’Œå°å‹è¡¨ã€‚ æ‚¨å¯ä»¥å°†ä¸¤è€…ä¸Šä¼ åˆ°æ–‡ä»¶ï¼Œå¹¶é€šè¿‡æºé›†ç¾¤å’Œç›®æ ‡é›†ç¾¤ä¸Šçš„ç®¡é“åŒæ—¶è¿è¡Œpg_dumpå’Œpsqlã€‚  pg_dumpåªéœ€ä¸Šä¼ åˆ°åŒ…å«DDLå‘½ä»¤å’ŒCOPYæ•°æ®å‘½ä»¤çš„å•ä¸ªæ–‡ä»¶ä¸­ã€‚ å¯ä»¥æ–¹ä¾¿åœ°å¤„ç†è·å¾—çš„æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/482/f47/cd8/482f47cd86df49125689c5360b6d060e.png"><br><br><h3>  gptransfer </h3><br> éœ€è¦ç‰ˆæœ¬Greenplum 4.2æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ æºç¾¤é›†å’Œç›®æ ‡ç¾¤é›†å¿…é¡»åŒæ—¶å·¥ä½œã€‚ ä¸ºå¼€æºç‰ˆæœ¬è¿ç§»å¤§å‹æ•°æ®è¡¨çš„æœ€å¿«æ–¹æ³•ã€‚ ä½†æ˜¯ç”±äºå¼€é”€å¤§ï¼Œè¿™ç§æ–¹æ³•åœ¨ä¼ è¾“ç©ºè¡¨å’Œå°è¡¨æ—¶éå¸¸æ…¢ã€‚ <br><br>  gptransferä½¿ç”¨pg_dumpä¼ è¾“DDLï¼Œä½¿ç”¨gpfdistä¼ è¾“æ•°æ®ã€‚ ç›®æ ‡ç¾¤é›†ä¸Šçš„ä¸»è¦æ®µçš„æ•°é‡å¿…é¡»ä¸å°‘äºæºç¾¤é›†ä¸Šçš„ä¸»æœºæ®µã€‚ åœ¨åˆ›å»ºâ€œæ²™ç®±â€ç¾¤é›†æ—¶ï¼Œè¦è€ƒè™‘æ˜¯å¦è¦å°†ä¸»è¦ç¾¤é›†ä¸­çš„æ•°æ®ä¼ è¾“åˆ°å®ƒä»¬ï¼Œå¹¶è®¡åˆ’ä½¿ç”¨gptransferå®ç”¨ç¨‹åºï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚ å³ä½¿åˆ†æ®µä¸»æœºå¾ˆå°‘ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æ¯ä¸ªåˆ†æ®µä¸»æœºä¸Šéƒ¨ç½²æ‰€éœ€æ•°é‡çš„åˆ†æ®µã€‚ ç›®æ ‡ç¾¤é›†ä¸Šçš„æ®µæ•°å¯èƒ½å°‘äºæºç¾¤é›†ä¸Šçš„æ®µæ•°ï¼Œä½†è¿™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†ä¸åˆ©åœ°å½±å“</a>æ•°æ®ä¼ è¾“é€Ÿåº¦ã€‚ åœ¨ç¾¤é›†ä¹‹é—´ï¼Œå¿…é¡»é…ç½®è¯ä¹¦çš„sshèº«ä»½éªŒè¯ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84b/a0a/f53/84ba0af53e82d2a4e861fe19c6f9be9a.png"><br><br> å½“ç›®æ ‡ç¾¤é›†ä¸Šçš„æ®µæ•°å¤§äºæˆ–ç­‰äºæºç¾¤é›†ä¸Šçš„æ®µæ•°æ—¶ï¼Œè¿™æ˜¯ç”¨äºå¿«é€Ÿæ¨¡å¼çš„æ–¹æ¡ˆã€‚ å®ç”¨ç¨‹åºæœ¬èº«çš„å¯åŠ¨æ˜¾ç¤ºåœ¨æ¥æ”¶å™¨ç¾¤é›†çš„ä¸»èŠ‚ç‚¹ä¸Šçš„å›¾ä¸­ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå°†åœ¨æºç¾¤é›†ä¸Šåˆ›å»ºä¸€ä¸ªå¤–éƒ¨å†™è¡¨ï¼Œè¯¥è¡¨å°†æ¯ä¸ªæ®µä¸Šçš„æ•°æ®å†™åˆ°å‘½åç®¡é“ã€‚ æ‰§è¡Œå‘½ä»¤INSERT INTO writable_external_table SELECT * FROM source_tableã€‚  gpfdistè¯»å–å‘½åç®¡é“ä¸­çš„æ•°æ®ã€‚ è¿˜åœ¨ç›®æ ‡ç¾¤é›†ä¸Šåˆ›å»ºäº†ä¸€ä¸ªå¤–éƒ¨è¡¨ï¼Œä»…ä¾›è¯»å–ã€‚ è¯¥è¡¨æŒ‡ç¤ºgpfdisté€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŒååè®®</a>æä¾›çš„æ•°æ®ã€‚ æ‰§è¡ŒINSERT INTO target_table SELECT * FROM external_gpfdist_tableå‘½ä»¤ã€‚ æ•°æ®è‡ªåŠ¨åœ¨ç›®æ ‡ç¾¤é›†çš„å„æ®µä¹‹é—´é‡æ–°åˆ†é…ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/13f/b61/cfb/13fb61cfba946fbea0649c1df1cbf28c.png"><br><br> è¿™æ˜¯æ…¢é€Ÿæ¨¡å¼çš„æ–¹æ¡ˆï¼Œæˆ–è€…æ˜¯gptransferè‡ªå·±ç»™å‡ºçš„æ ‡å‡†æ¨¡å¼çš„æ–¹æ¡ˆã€‚ ä¸»è¦åŒºåˆ«åœ¨äºï¼Œåœ¨æºç¾¤é›†çš„æ¯ä¸ªåˆ†æ®µä¸»æœºä¸Šï¼Œéƒ½ä¼šä¸ºè¯¥åˆ†æ®µä¸»æœºçš„æ‰€æœ‰åˆ†æ®µå¯åŠ¨ä¸€ä¸ªgpfdistå¯¹ã€‚ å¤–éƒ¨è®°å½•è¡¨æ˜¯æŒ‡gpfdistå……å½“æ•°æ®æ¥æ”¶å™¨ã€‚ æ­¤å¤–ï¼Œå¦‚æœåœ¨å¤–éƒ¨è¡¨çš„LOCATIONå‚æ•°ä¸­æŒ‡ç¤ºè¦å†™å…¥çš„å¤šä¸ªå€¼ï¼Œåˆ™åœ¨å†™å…¥æ•°æ®æ—¶ï¼Œæ®µä¼šè¢«gpfdistå¹³å‡åˆ†é…ã€‚ ä¸»æœºæ®µä¸Šgpfdistä¹‹é—´çš„æ•°æ®é€šè¿‡å‘½åç®¡é“ä¼ é€’ã€‚ å› æ­¤ï¼Œæ•°æ®ä¼ è¾“é€Ÿåº¦è¾ƒä½ï¼Œä½†æ˜¯ä¸ä»…é€šè¿‡ä¸»èŠ‚ç‚¹ä¼ è¾“æ•°æ®æ—¶ç›¸æ¯”ï¼Œå®ƒçš„ä¼ è¾“é€Ÿåº¦ä»ç„¶æ›´å¿«ã€‚ <br><br> å°†æ•°æ®ä»Greenplum 4è¿ç§»åˆ°Greenplum 5æ—¶ï¼Œå¿…é¡»åœ¨ç›®æ ‡ç¾¤é›†çš„ä¸»èŠ‚ç‚¹ä¸Šè¿è¡Œgptransferã€‚ å¦‚æœåœ¨æºé›†ç¾¤ä¸Šè¿è¡Œgptransferï¼Œåˆ™ä¼šå¾—åˆ°<code>pg_catalog.gp_segment_configuration</code>è¡¨ä¸­ç¼ºå°‘<code>san_mounts</code>å­—æ®µçš„é”™è¯¯ï¼š <br><br><pre> <code class="plaintext hljs">gptransfer -t big_db.public.test_table --dest-host=gpdb-target-master.local --dest-database=big_db --source-map-file=/data/master/gpseg-1/host_and_IP_segments --batch-size=10 --sub-batch-size=50 --truncate 20190109:12:46:13:010893 gptransfer:gpdb-source-master.local:gpadmin-[INFO]:-Starting gptransfer with args: -t big_db.public.test_table --dest-host=gpdb-target-master.local --dest-database=big_db --source-map-file=/data/master/gpseg-1/host_and_IP_segments --batch-size=10 --sub-batch-size=50 --truncate 20190109:12:46:13:010893 gptransfer:gpdb-source-master.local:gpadmin-[INFO]:-Validating options... 20190109:12:46:13:010893 gptransfer:gpdb-source-master.local:gpadmin-[INFO]:-Retrieving configuration of source Greenplum Database... 20190109:12:46:13:010893 gptransfer:gpdb-source-master.local:gpadmin-[INFO]:-Retrieving configuration of destination Greenplum Database... 20190109:12:46:14:010893 gptransfer:gpdb-source-master.local:gpadmin-[CRITICAL]:-gptransfer failed. (Reason='error 'ERROR: column "san_mounts" does not exist LINE 2: ... SELECT dbid, content, status, unnest(san_mounts... ^ ' in ' SELECT dbid, content, status, unnest(san_mounts) FROM pg_catalog.gp_segment_configuration WHERE content &gt;= 0 ORDER BY content, dbid '') exiting...</code> </pre> <br> æ‚¨è¿˜éœ€è¦æ£€æŸ¥GPHOMEå˜é‡ï¼Œä»¥ä¾¿å®ƒä»¬åœ¨æºç¾¤é›†å’Œç›®æ ‡ç¾¤é›†ä¹‹é—´åŒ¹é…ã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬å°†æ”¶åˆ°ä¸€ä¸ªç›¸å½“å¥‡æ€ªçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é”™è¯¯</a> ï¼ˆå½“æºå’Œç›®æ ‡å…·æœ‰ä¸åŒçš„GPHOMEè·¯å¾„æ—¶ï¼Œgptransferå®ç”¨ç¨‹åºå°†å¤±è´¥ï¼‰ã€‚ <br><br><pre> <code class="plaintext hljs">gptransfer -t big_db.public.test_table --source-host=gpdb-source-master.local --dest-database=big_db --source-map-file=/data1/master/gpseg-1/source_host_and_IP_segments --b atch-size=10 --sub-batch-size=50 --truncate 20190109:14:12:07:031438 gptransfer:mdw:gpadmin-[INFO]:-Starting gptransfer with args: -t big_db.public.test_table --source-host=gpdb-spurce-master.local --dest-database=big_db --source-map-file=/data1/master/gpseg-1/source_host_and_IP_segments --b atch-size=10 --sub-batch-size=50 --truncate 20190109:14:12:07:031438 gptransfer:mdw:gpadmin-[INFO]:-Validating options... 20190109:14:12:07:031438 gptransfer:mdw:gpadmin-[ERROR]:-gptransfer: error: GPHOME directory does not exist on gpdb-source-master.local</code> </pre> <br> æ‚¨å¯ä»¥ç®€å•åœ°åˆ›å»ºç›¸åº”çš„ç¬¦å·é“¾æ¥ï¼Œå¹¶åœ¨å¯åŠ¨gptransferçš„ä¼šè¯ä¸­è¦†ç›–GPHOMEå˜é‡ã€‚ <br><br> åœ¨ç›®æ ‡ç¾¤é›†ä¸Šå¯åŠ¨gptransferæ—¶ï¼Œé€‰é¡¹â€œ --source-map-fileâ€åº”æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸»æœºåˆ—è¡¨åŠå…¶IPåœ°å€ä»¥åŠæºç¾¤é›†çš„ä¸»è¦ç½‘æ®µã€‚ ä¾‹å¦‚ï¼š <br><br><pre> <code class="plaintext hljs">sdw1,192.0.2.1 sdw2,192.0.2.2 sdw3,192.0.2.3 sdw4,192.0.2.4</code> </pre> <br> ä½¿ç”¨é€‰é¡¹â€œ --fullâ€ï¼Œä¸ä»…å¯ä»¥ä¼ è¾“è¡¨ï¼Œè¿˜å¯ä»¥ä¼ è¾“æ•´ä¸ªæ•°æ®åº“ï¼Œä½†æ˜¯ï¼Œä¸åº”åœ¨ç›®æ ‡ç¾¤é›†ä¸Šåˆ›å»ºç”¨æˆ·æ•°æ®åº“ã€‚ æ‚¨è¿˜åº”è¯¥è®°ä½ï¼Œç§»åŠ¨å¤–éƒ¨è¡¨æ—¶ç”±äºè¯­æ³•æ›´æ”¹è€Œå­˜åœ¨é—®é¢˜ã€‚ <br><br> è®©æˆ‘ä»¬è¯„ä¼°ä¸€ä¸‹é¢å¤–çš„å¼€é”€ï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨gptarnsferå¤åˆ¶10ä¸ªç©ºè¡¨ï¼ˆè¡¨ä»big_db.public.test_table_2åˆ°big_db.public.test_table_11ï¼‰ï¼š <br><br><pre> <code class="plaintext hljs">gptransfer -f temp_filelist.txt --source-host=gpdb-source-master.local --dest-database=big_db --source-map-file=/data1/master/gpseg-1/source_host_and_IP_segments_dev --batch-size=10 --sub-ba tch-size=50 --truncate 20190118:06:14:08:031521 gptransfer:mdw:gpadmin-[INFO]:-Starting gptransfer with args: -f temp_filelist.txt --source-host=gpdb-source-master.local --dest-database=big_db --source-map-file=/data1/master/gpseg-1/source_host_and_IP_segments_dev --batch-size=10 --sub-batch-size=50 --truncate 20190118:06:14:08:031521 gptransfer:mdw:gpadmin-[INFO]:-Validating options... 20190118:06:14:08:031521 gptransfer:mdw:gpadmin-[INFO]:-Retrieving configuration of source Greenplum Database... 20190118:06:14:08:031521 gptransfer:mdw:gpadmin-[INFO]:-Retrieving configuration of destination Greenplum Database... 20190118:06:14:09:031521 gptransfer:mdw:gpadmin-[INFO]:-Retrieving source tables... 20190118:06:14:12:031521 gptransfer:mdw:gpadmin-[INFO]:-Checking for gptransfer schemas... 20190118:06:14:22:031521 gptransfer:mdw:gpadmin-[INFO]:-Retrieving list of destination tables... 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-Reading source host map file... 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-Building list of source tables to transfer... 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-Number of tables to transfer: 10 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-gptransfer will use "standard" mode for transfer. 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-Validating source host map... 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-Validating transfer table set... 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-The following tables on the destination system will be truncated: 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_2 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_3 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_4 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_5 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_6 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_7 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_8 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_9 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_10 20190118:06:14:25:031521 gptransfer:mdw:gpadmin-[INFO]:-   big_db.public.test_table_11 â€¦ 20190118:06:14:34:031521 gptransfer:mdw:gpadmin-[INFO]:-Using batch size of 10 20190118:06:14:34:031521 gptransfer:mdw:gpadmin-[INFO]:-Using sub-batch size of 16 20190118:06:14:34:031521 gptransfer:mdw:gpadmin-[INFO]:-Creating work directory '/home/gpadmin/gptransfer_31521' 20190118:06:14:34:031521 gptransfer:mdw:gpadmin-[INFO]:-Creating schema public in database edw_prod... 20190118:06:14:40:031521 gptransfer:mdw:gpadmin-[INFO]:-Starting transfer of big_db.public.test_table_5 to big_db.public.test_table_5... â€¦ 20190118:06:15:02:031521 gptransfer:mdw:gpadmin-[INFO]:-Validation of big_db.public.test_table_4 successful 20190118:06:15:02:031521 gptransfer:mdw:gpadmin-[INFO]:-Removing work directories... 20190118:06:15:02:031521 gptransfer:mdw:gpadmin-[INFO]:-Finished.</code> </pre> <br> ç»“æœï¼Œä¼ è¾“10å¼ ç©ºè¡¨å¤§çº¦éœ€è¦16ç§’ï¼ˆ14ï¼š40-15ï¼š02ï¼‰ï¼Œå³ä¸€å¼ è¡¨-1.6ç§’ã€‚ åœ¨æœ¬ä¾‹ä¸­ï¼Œä½¿ç”¨pg_dumpå’Œpsqlå¯ä»¥ä¸‹è½½å¤§çº¦100 MBçš„æ•°æ®ã€‚ <br><br><h3>  gp_dumpå’Œgp_restore </h3><br> ä½œä¸ºä¸€ç§é€‰æ‹©ï¼šç”±äºå·²å£°æ˜å¼ƒç”¨äº†gp_dumpå’Œgp_restoreï¼Œå› æ­¤è¯·åœ¨gpcrondumpå’Œgpdbrestoreä¸Šä½¿ç”¨é™„åŠ ç»„ä»¶ã€‚ å°½ç®¡gpcrondumpå’Œgpdbrestoreæœ¬èº«åœ¨æ­¤è¿‡ç¨‹ä¸­ä½¿ç”¨gp_dumpå’Œgp_restoreã€‚ è¿™æ˜¯æœ€é€šç”¨çš„æ–¹æ³•ï¼Œä½†ä¸æ˜¯æœ€å¿«çš„æ–¹æ³•ã€‚ ä½¿ç”¨gp_dumpåˆ›å»ºçš„å¤‡ä»½æ–‡ä»¶åœ¨ä¸»èŠ‚ç‚¹ä¸Šä»£è¡¨ä¸€ç»„DDLå‘½ä»¤ï¼Œåœ¨ä¸»è¦æ®µä¸Šï¼Œä¸»è¦æ˜¯COPYå‘½ä»¤å’Œæ•°æ®é›†ã€‚ é€‚ç”¨äºæ— æ³•åŒæ—¶è¿è¡Œç›®æ ‡ç¾¤é›†å’Œæºç¾¤é›†çš„æƒ…å†µã€‚ åœ¨Greenplumçš„æ—§ç‰ˆæœ¬å’Œæ–°ç‰ˆæœ¬ä¸­éƒ½æœ‰ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gp_dump</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gp_restore</a> ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/141/1b7/8e8/1411b78e893176ef21de383e78c0b87f.png"><br><br><h3>  gpbackupå’Œgprestoreå®ç”¨ç¨‹åº </h3><br> åˆ›å»ºä»¥æ›¿ä»£gp_dumpå’Œgp_restoreã€‚ å¯¹äºä»–ä»¬çš„å·¥ä½œï¼Œéœ€è¦Greenplumç‰ˆæœ¬æœ€ä½ä¸º4.3.17ï¼ˆ <a href="">const MINIMUM_GPDB4_VERSION =â€œ 4.3.17â€</a> ï¼‰ã€‚ æ“ä½œæ–¹æ¡ˆç±»ä¼¼äºgpbackupå’Œgprestoreï¼Œä½†æ˜¯å·¥ä½œé€Ÿåº¦è¦å¿«å¾—å¤šã€‚ è·å–å¤§å‹æ•°æ®åº“çš„DDLå‘½ä»¤çš„æœ€å¿«æ–¹æ³•ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼ è¾“å…¨å±€å¯¹è±¡ï¼Œè¦è¿›è¡Œæ¢å¤ï¼Œæ‚¨éœ€è¦æŒ‡å®šâ€œ gprestore --with-globalsâ€ã€‚ å¯é€‰å‚æ•°â€œ --jobsâ€å¯ä»¥è®¾ç½®åˆ›å»ºå¤‡ä»½æ—¶çš„ä½œä¸šæ•°ï¼ˆä»¥åŠä¸æ•°æ®åº“çš„ä¼šè¯ï¼‰ã€‚ ç”±äºåˆ›å»ºäº†å¤šä¸ªä¼šè¯ï¼Œå› æ­¤åœ¨æ¥æ”¶åˆ°æ‰€æœ‰é”ä¹‹å‰ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§éå¸¸é‡è¦ã€‚ è¿˜æœ‰ä¸€ä¸ªæœ‰ç”¨çš„é€‰é¡¹â€œ --with-statsâ€ï¼Œå®ƒå…è®¸æ‚¨ä¼ è¾“æœ‰å…³ç”¨äºæ„å»ºæ‰§è¡Œè®¡åˆ’çš„å¯¹è±¡çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ æ›´å¤šä¿¡æ¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨è¿™é‡Œ</a> ã€‚ <br><br><h3>  gpcopyå®ç”¨ç¨‹åº </h3><br> ä¸ºäº†å¤åˆ¶æ•°æ®åº“ï¼Œæœ‰ä¸€ä¸ªå®ç”¨ç¨‹åºgpcopy-gptansferçš„æ›¿ä»£å“ã€‚ ä½†å®ƒä»…åŒ…å«åœ¨Pivotalçš„Greenplumä¸“æœ‰ç‰ˆæœ¬ä¸­ï¼Œä»4.3.26å¼€å§‹-åœ¨å¼€æºç‰ˆæœ¬ä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å®ç”¨ç¨‹åºä¸æä¾›</a> ã€‚ åœ¨æºé›†ç¾¤ä¸Šå·¥ä½œæ—¶ï¼Œå°†æ‰§è¡Œå‘½ä»¤COPY source_table TO PROGRAM'gpcopy_helper ...'ON SEGMENT CSV IGNORE EXTERNAL PARTITIONSã€‚ åœ¨æ¥æ”¶ç¾¤é›†ç«¯ï¼Œåˆ›å»ºä¸€ä¸ªä¸´æ—¶å¤–éƒ¨è¡¨CREATE EXTERNAL WEB TEMP TABLE external_temp_tableï¼ˆLIKE target_tableï¼‰EXECUTE'... gpcopy_helper â€“listen ...'ï¼Œå¹¶æ‰§è¡ŒINSERT INTO target_table SELECT * FROM external_temp_tableå‘½ä»¤ã€‚ ç»“æœï¼Œåœ¨ç›®æ ‡ç¾¤é›†çš„æ¯ä¸ªæ®µä¸Šéƒ½ä¼šå¯åŠ¨å¸¦æœ‰â€“listenå‚æ•°çš„gpcopy_helperï¼Œå®ƒä»¬å°†ä»æºç¾¤é›†çš„æ®µä¸­æ¥æ”¶æ¥è‡ªgpcopy_helperçš„æ•°æ®ã€‚ ç”±äºè¿™ç§æ•°æ®ä¼ è¾“æ–¹æ¡ˆä»¥åŠå‹ç¼©ï¼Œå› æ­¤ä¼ è¾“é€Ÿåº¦è¦é«˜å¾—å¤šã€‚ åœ¨ç¾¤é›†ä¹‹é—´ï¼Œè¿˜å¿…é¡»é…ç½®è¯ä¹¦çš„sshèº«ä»½éªŒè¯ã€‚ æˆ‘è¿˜æƒ³æŒ‡å‡ºï¼Œå¯¹äºæºç¾¤é›†å’Œç›®æ ‡ç¾¤é›†ä½äºåŒä¸€æœåŠ¡å™¨ä¸Šçš„æƒ…å†µï¼Œgpcopyæœ‰ä¸€ä¸ªæ–¹ä¾¿çš„é€‰é¡¹â€œ --truncate-source-afterâ€ï¼ˆå’Œâ€œ --validateâ€ï¼‰ã€‚ <br><br><h2> æ•°æ®ä¼ è¾“ç­–ç•¥ </h2><br> ä¸ºäº†ç¡®å®šä¼ è¾“ç­–ç•¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå¯¹æˆ‘ä»¬è€Œè¨€æ›´é‡è¦çš„æ˜¯ï¼šå¿«é€Ÿä¼ è¾“æ•°æ®ï¼Œä½†éœ€è¦æ›´å¤šçš„äººå·¥ï¼Œå¯é æ€§å¯èƒ½è¾ƒä½ï¼ˆgpbackupï¼Œgptransferæˆ–å…¶ç»„åˆï¼‰ï¼Œæˆ–è€…éœ€è¦è¾ƒå°‘çš„äººå·¥ï¼Œä½†ä¼ è¾“é€Ÿåº¦è¾ƒæ…¢ï¼ˆgpbackupæˆ–gptransferè€Œä¸åˆå¹¶ï¼‰ã€‚ <br><br> æœ€å¿«çš„æ•°æ®ä¼ è¾“æ–¹å¼-å½“æœ‰æºç¾¤é›†å’Œç›®æ ‡ç¾¤é›†æ—¶-ä»¥ä¸‹å†…å®¹ï¼š <br><br><ul><li> ä½¿ç”¨gpbackup-ä»…å…ƒæ•°æ®è·å–DDLï¼Œä½¿ç”¨psqlè½¬æ¢å¹¶é€šè¿‡ç®¡é“åŠ è½½ <br></li><li> åˆ é™¤ç´¢å¼• <br></li><li> ä½¿ç”¨gptransferä¼ è¾“å¤§å°ä¸º100 MBæˆ–æ›´å¤§çš„è¡¨ <br></li><li> ä½¿ç”¨pg_dumpä¼ è¾“å¤§å°å°äº100 MBçš„è¡¨| å¦‚ç¬¬ä¸€æ®µä¸­çš„psql <br></li><li> åˆ›å»ºå›åˆ é™¤çš„ç´¢å¼• <br></li></ul><br> äº‹å®è¯æ˜ï¼Œè¿™ç§æ–¹æ³•æ¯”gp_dumpå’Œgp_restoreå¿«è‡³å°‘2å€ã€‚ æ›¿ä»£æ–¹æ³•ï¼šä½¿ç”¨gptransfer â€“fullï¼Œgpbackupå’Œgprestoreæˆ–gp_dumpå’Œgp_restoreä¼ è¾“æ‰€æœ‰æ•°æ®åº“ã€‚ <br><br> è¡¨å¤§å°å¯ä»¥é€šè¿‡ä»¥ä¸‹æŸ¥è¯¢è·å¾—ï¼š <br><br><pre> <code class="plaintext hljs">SELECT nspname AS "schema", coalesce(tablename, relname) AS "name", SUM(pg_total_relation_size(class.oid)) AS "size" FROM pg_class class JOIN pg_namespace namespace ON namespace.oid = class.relnamespace LEFT JOIN pg_partitions parts ON class.relname = parts.partitiontablename AND namespace.nspname = parts.schemaname WHERE nspname NOT IN ('pg_catalog', 'information_schema', 'pg_toast', 'pg_bitmapindex', 'pg_aoseg', 'gp_toolkit') GROUP BY nspname, relkind, coalesce(tablename, relname), pg_get_userbyid(class.relowner) ORDER BY 1,2;</code> </pre><br><br><h3> å¿…è¦çš„è½¬æ¢ </h3><br>  Greenplumç‰ˆæœ¬4å’Œ5ä¸­çš„å¤‡ä»½æ–‡ä»¶ä¹Ÿä¸å®Œå…¨å…¼å®¹ã€‚ å› æ­¤ï¼Œåœ¨Greenplum 5ä¸­ï¼Œç”±äºè¯­æ³•çš„æ›´æ”¹ï¼ŒCREATE EXTERNAL TABLEå’ŒCOPYå‘½ä»¤æ²¡æœ‰INTO ERROR TABLEå‚æ•°ï¼Œå› æ­¤æ‚¨éœ€è¦å°†SET gp_ignore_error_tableå‚æ•°è®¾ç½®ä¸ºtrueï¼Œä»¥ä½¿å¤‡ä»½è¿˜åŸä¸ä¼šå¤±è´¥ã€‚ è®¾ç½®å¥½å‚æ•°åï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ°ä¸€æ¡è­¦å‘Šã€‚ <br><br> æ­¤å¤–ï¼Œç¬¬äº”ç‰ˆå¼•å…¥äº†ä¸å¤–éƒ¨pxfè¡¨è¿›è¡Œäº¤äº’çš„ä¸åŒåè®®ï¼Œå¹¶ä¸”è¦ä½¿ç”¨è¯¥åè®®ï¼Œæ‚¨éœ€è¦æ›´æ”¹LOCATIONå‚æ•°å¹¶é…ç½®pxfæœåŠ¡ã€‚ <br> è¿˜å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸»èŠ‚ç‚¹å’Œæ¯ä¸ªä¸»æ®µä¸Šçš„gp_dumpå’Œgp_restoreå¤‡ä»½æ–‡ä»¶ä¸­ï¼ŒSET gp_strict_xml_parseå‚æ•°éƒ½è®¾ç½®ä¸ºfalseã€‚  Greenplum 5ä¸­æ²¡æœ‰è¿™æ ·çš„å‚æ•°ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ”¶åˆ°ä¸€æ¡é”™è¯¯æ¶ˆæ¯ã€‚ <br><br> å¦‚æœå°†gphdfsåè®®ç”¨äºå¤–éƒ¨è¡¨ï¼Œåˆ™éœ€è¦åœ¨å¤‡ä»½æ–‡ä»¶ä¸­'gphdfsï¼š//'è¡Œä¸­åœ¨LOCATIONå‚æ•°ä¸­ä¸ºå¤–éƒ¨è¡¨æ£€æŸ¥æºåˆ—è¡¨ã€‚ ä¾‹å¦‚ï¼Œåº”è¯¥åªæœ‰â€œ gphdfsï¼š//hadoop.localï¼š8020â€ã€‚ å¦‚æœè¿˜æœ‰å…¶ä»–è¡Œï¼Œåˆ™éœ€è¦ç±»ä¼¼åœ°å°†å®ƒä»¬æ·»åŠ åˆ°ä¸»èŠ‚ç‚¹ä¸Šçš„æ›¿æ¢è„šæœ¬ä¸­ã€‚ <br><br><pre> <code class="plaintext hljs">grep -o gphdfs\:\/\/.*\/ /data1/master/gpseg-1/db_dumps/20181206/gp_dump_-1_1_20181206122002.gz | cut -d/ -f1-3 | sort | uniq gphdfs://hadoop.local:8020</code> </pre> <br> æˆ‘ä»¬æ›¿æ¢ä¸»èŠ‚ç‚¹ï¼ˆä»¥gp_dumpæ•°æ®æ–‡ä»¶ä¸ºä¾‹ï¼‰ï¼š <br><br><pre> <code class="plaintext hljs">mv /data1/master/gpseg-1/db_dumps/20181206/big_db_gp_dump_1_1_20181206080001.gz /data1/master/gpseg-1/db_dumps/20181206/big_db_gp_dump_1_1_20181206080001.old.gz gunzip -c /data1/master/gpseg-1/db_dumps/20181206/big_db_gp_dump_1_1_20181206080001.old.gz | sed "s#'gphdfs://hadoop.local:8020#'pxf:/#g" | sed "s/\(^.*pxf\:\/\/.*'\)/\1\\&amp;\&amp;\?PROFILE=HdfsTextSimple'/" |sed "s#'&amp;#g" | sed 's/SET gp_strict_xml_parse = false;/SET gp_ignore_error_table = true;/g' | gzip -1 &gt; /data1/master/gpseg-1/db_dumps/20181206/big_db_gp_dump_1_1_20181206080001.gz nets</code> </pre> <br> åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ï¼ŒHdfsTextSimpleé…ç½®æ–‡ä»¶åç§°è¢«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å£°æ˜ä¸ºå¼ƒç”¨</a> ï¼Œæ–°åç§°ä¸ºhdfsï¼štextã€‚ <br><br><h2> æ€»ç»“ </h2><br> åœ¨æœ¬æ–‡ä¹‹å¤–ï¼Œä»ç„¶éœ€è¦æ˜¾å¼è½¬æ¢ä¸ºæ–‡æœ¬ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">éšå¼æ–‡æœ¬è½¬æ¢</a> ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§æ–°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">èµ„æºç»„</a>é›†ç¾¤èµ„æºç®¡ç†æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å–ä»£äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GPORCA</a>ä¼˜åŒ–å™¨Resource Queuesï¼ŒGreenplum 5ä¸­é»˜è®¤åŒ…å«è¯¥æœºåˆ¶ï¼Œä¸å®¢æˆ·ç«¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ— å…³</a> ã€‚ <br><br> æˆ‘æœŸå¾…Greenplumçš„ç¬¬å…­ç‰ˆå‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬è®¡åˆ’äº2019å¹´æ˜¥å­£å‘å¸ƒï¼šä¸PostgreSQL 9.4çš„å…¼å®¹æ€§çº§åˆ«ï¼Œå…¨æ–‡æœç´¢ï¼ŒGINç´¢å¼•æ”¯æŒï¼ŒèŒƒå›´ç±»å‹ï¼ŒJSONBï¼ŒzStdå‹ç¼©ã€‚ æ­¤å¤–ï¼ŒGreenplum 7çš„åˆæ­¥è®¡åˆ’ä¹Ÿå¹¿ä¸ºäººçŸ¥ï¼šä¸PostgreSQLæœ€ä½9.6çš„å…¼å®¹çº§åˆ«ï¼Œè¡Œçº§å®‰å…¨æ€§ï¼Œè‡ªåŠ¨ä¸»æ•…éšœè½¬ç§»ã€‚ å¼€å‘äººå‘˜è¿˜æ‰¿è¯ºå¯ä»¥ä½¿ç”¨æ•°æ®åº“å‡çº§å®ç”¨ç¨‹åºåœ¨ä¸»è¦ç‰ˆæœ¬ä¹‹é—´è¿›è¡Œæ›´æ–°ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥ä¼šæ›´åŠ å®¹æ˜“ã€‚ <br><br>  <i>æœ¬æ–‡ç”±Rostelecomæ•°æ®ç®¡ç†å›¢é˜Ÿç¼–å†™</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN439876/">https://habr.com/ru/post/zh-CN439876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN439864/index.html">çŸ¥è¯†ç®¡ç†ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•åšåˆ°</a></li>
<li><a href="../zh-CN439866/index.html">1Cä¼ä¸šç®¡ç†2ï¼ˆERP 2.4.6ï¼‰ä¸­è®¾è®¡ç›®å½•çš„è®¾è®¡åŸåˆ™</a></li>
<li><a href="../zh-CN439868/index.html">æ²¡æœ‰Facebookçš„ç”Ÿæ´»ï¼šä¸å¤ªæ¿€è¿›çš„è§‚ç‚¹ï¼Œè‰¯å¥½çš„å¿ƒæƒ…ï¼Œæ›´å¤šçš„æ—¶é—´ç»™äº²äººã€‚ ç°åœ¨å·²ç»è¢«ç§‘å­¦è¯æ˜</a></li>
<li><a href="../zh-CN439870/index.html">è§†é¢‘æ˜¯è¿›æ­¥çš„åŠ¨åŠ›ï¼šç›‘è§†ç³»ç»Ÿçš„å‘å±•</a></li>
<li><a href="../zh-CN439874/index.html">SVGè¿‡æ»¤æ•ˆæœã€‚ ç¬¬3éƒ¨åˆ†ã€‚ä½¿ç”¨feComponentTransferçš„å›¾åƒåä»£åŒ–æ•ˆæœ</a></li>
<li><a href="../zh-CN439878/index.html">åœ¨2019å¹´ä¸ºæ–°çš„é«˜è´Ÿè½½åˆ›ä¸šå…¬å¸åˆ›å»ºæ¶æ„</a></li>
<li><a href="../zh-CN439880/index.html">å®‰å…¨å‘¨07ï¼šç‰©è”ç½‘è®¾å¤‡çš„æœ¬åœ°æ¼æ´</a></li>
<li><a href="../zh-CN439882/index.html">ptraceå†’é™©ï¼ˆ2ï¼‰</a></li>
<li><a href="../zh-CN439884/index.html">å¦‚ä½•é€šè¿‡ä¸€ä¸ªæŒ‰é’®æ‹’ç»ä¸å¿…è¦çš„æ–°é—»é€šè®¯ã€‚ Yandex.Mailå›¢é˜Ÿç»éªŒ</a></li>
<li><a href="../zh-CN439886/index.html">æˆ‘å¦‚ä½•åœ¨2018å¹´ä¿„ç½—æ–¯AI Cup CodeBallä¸Šæ•™ç¥ç»ç½‘ç»œå®ç°ä½ç½®è¯„ä¼°åŠŸèƒ½</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>