<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌀 🎗️ 🛑 Varonis menemukan virus penambangan crypto: penyelidikan kami ♻️ 👗 🙅🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unit investigasi keamanan kami baru-baru ini melakukan kasus jaringan virus penambangan crypto yang hampir sepenuhnya di salah satu perusahaan menenga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varonis menemukan virus penambangan crypto: penyelidikan kami</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/466817/"><img src="https://habrastorage.org/webt/b3/fo/_5/b3fo_5ib64rlap_izdap4paolls.jpeg"><br><br>  Unit investigasi keamanan kami baru-baru ini melakukan kasus jaringan virus penambangan crypto yang hampir sepenuhnya di salah satu perusahaan menengah.  Analisis <br>  sampel malware yang dikumpulkan menunjukkan bahwa modifikasi baru ditemukan <br>  virus semacam itu, yang dinamakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Norman</a> , menggunakan berbagai metode untuk menyembunyikan keberadaan mereka.  Selain itu, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">shell web interaktif</a> ditemukan, yang mungkin terkait dengan operator penambangan. <br><a name="habracut"></a><br><h2>  <font color="#D21927">Tinjauan Studi</font> </h2><br><ul><li>  Varonis mendeteksi infeksi skala besar dengan cryptominers: hampir semua server dan workstation di perusahaan itu terinfeksi dengan perangkat lunak tersebut </li><li>  Sejak infeksi awal yang terjadi lebih dari setahun yang lalu, jumlah modifikasi dan perangkat yang terinfeksi terus meningkat </li><li>  Jenis baru penambang crypto Monero (Norman) yang kami temukan menggunakan berbagai metode untuk menyembunyikannya dari analisis oleh perangkat lunak keamanan untuk menghindari deteksi </li><li>  Sebagian besar varian malware menggunakan DuckDNS (DNS Dinamis gratis) untuk terhubung ke pusat kontrol (server C&amp;C), serta untuk mendapatkan parameter konfigurasi atau mengirim data baru </li><li>  Norman - penambang open source berbasis sumber tinggi, Monero cryptocurrency miner - XMRig </li><li>  Kami tidak memiliki bukti konklusif tentang koneksi crypto miners dengan shell PHP interaktif.  Namun, ada alasan bagus untuk meyakini bahwa sumber mereka adalah penyerang yang sama.  Peneliti mengumpulkan bukti tambahan untuk ada atau tidak adanya hubungan semacam itu. </li><li>  Pada artikel ini, Anda dapat menemukan rekomendasi Varonis mengenai perlindungan terhadap cangkang web jarak jauh dan penambang crypto. </li></ul><br><h2>  <font color="#D21927">Investigasi</font> </h2><br>  Penyelidikan dimulai selama proyek percontohan berikutnya dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Platform</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><br></a>  Keamanan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">cybersecara Varonis</a> (Platform Keamanan Data Varonis), yang memungkinkan Anda untuk dengan cepat mengidentifikasi beberapa peristiwa anomali yang mencurigakan di tingkat jaringan selama permintaan Internet (melalui proxy web) yang terkait dengan tindakan abnormal pada sistem file. <br>  Pelanggan segera menunjukkan bahwa perangkat yang diidentifikasi oleh Platform kami, <br>  milik pengguna yang sama yang baru-baru ini melaporkan crash dan perlambatan aplikasi. <br><br>  Tim kami memeriksa lingkungan pelanggan secara manual, bergerak dari satu stasiun yang terinfeksi ke yang lain sesuai dengan peringatan yang dihasilkan oleh Platform Varonis.  Tim respon insiden juga mengembangkan aturan khusus dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul DatAlert</a> untuk mendeteksi komputer yang aktif menambang, yang membantu menghilangkan ancaman dengan cepat.  Sampel dari malware yang dikumpulkan dikirim ke tim forensik dan departemen pengembangan, yang mengatakan bahwa penelitian tambahan dari sampel diperlukan. <br>  Situs yang terinfeksi ditemukan melalui penggunaan <b>panggilan DuckDNS</b> , Dynamic DNS, yang memungkinkan para penggunanya untuk membuat nama domain mereka sendiri dan dengan cepat memetakannya untuk mengubah alamat IP.  Seperti disebutkan di atas, sebagian besar malware dalam insiden tersebut beralih ke DuckDNS untuk terhubung ke pusat kontrol (C&amp;C), yang lain untuk mendapatkan parameter konfigurasi atau mengirim data baru. <br><br>  Hampir semua server dan komputer terinfeksi malware.  Sebagian besar diterapkan <br>  opsi penambang crypto umum.  Malware lain termasuk alat pembuangan kata sandi, kerangka PHP, dan sejumlah alat telah bekerja selama beberapa tahun. <br><br>  Kami memberikan hasilnya kepada pelanggan, menghapus malware dari lingkungan mereka, dan menghentikan infeksi lebih lanjut. <br><br>  Di antara semua sampel cryptominers yang ditemukan, satu berdiri terpisah.  Kami memanggilnya <strong>Norman</strong> . <br><br><h2>  <font color="#D21927">Temui aku!</font>  <font color="#D21927">Norman</font>  <font color="#D21927">Cryptominer</font> </h2><br>  Norman adalah penambang cryptocurrency Monero berkinerja tinggi berdasarkan kode XMRig.  Tidak seperti sampel penambang lain yang ditemukan, Norman menggunakan metode untuk menyembunyikannya dari analisis dengan perangkat lunak keamanan untuk menghindari deteksi dan mencegah distribusi lebih lanjut. <br><br>  Sepintas, malware ini adalah penambang biasa yang bersembunyi di bawah nama svchost.exe.  Namun, penelitian menunjukkan bahwa ia menggunakan metode persembunyian yang lebih menarik dari deteksi dan pemeliharaan pekerjaan. <br><br>  Proses penyebaran malware ini dapat dibagi menjadi tiga tahap: <br><br><ul><li>  pemenuhan; </li><li>  implementasi; </li><li>  penambangan. </li></ul><br><h2>  <font color="#D21927">Analisis langkah demi langkah</font> </h2><br><h3>  Tahap 1. Eksekusi </h3><br>  Langkah pertama dimulai dengan file executable svchost.exe. <br><br>  Perangkat lunak berbahaya mengkompilasi dengan NSIS (Nullsoft Scriptable Install System), yang tidak biasa.  NSIS adalah sistem open source yang digunakan untuk membuat installer Windows.  Seperti SFX, sistem ini membuat arsip file dan file skrip yang dijalankan selama installer.  File skrip memberitahu program file mana yang akan dijalankan, dan dapat berinteraksi dengan file lain dalam arsip. <br><br>  <i><strong>Catatan:</strong> Untuk mendapatkan file skrip NSIS dari file yang dapat dieksekusi, Anda harus menggunakan 7zip versi 9.38, karena fungsi ini tidak diterapkan di versi yang lebih baru.</i> <br><br>  Malware yang diarsipkan NSIS berisi file-file berikut: <br><br><ul><li>  CallAnsiPlugin.dll, CLR.dll - modul NSIS untuk memanggil fungsi .NET DLL; </li><li>  5zmjbxUIOVQ58qPR.dll - DLL payload utama; </li><li>  4jy4sobf.acz, es1qdxg2.5pk, OIM1iVhZ.txt - file payload; </li><li>  Retreat.mp3, Cropped_controller_config_controller_i_lb.png hanyalah file yang sama sekali tidak terkait dengan aktivitas berbahaya selanjutnya. </li></ul><br>  Perintah dari file skrip NSIS yang menjalankan payload diberikan di bawah ini. <br><br><img src="https://habrastorage.org/webt/dc/ch/st/dcchst5kvffhufreb1smhmw3lzs.png"><br><br>  Perangkat lunak berbahaya dijalankan dengan memanggil fungsi 5zmjbxUIOVQ58qPR.dll, yang mengambil file lain sebagai parameter. <br><br><h3>  Tahap 2. Implementasi </h3><br>  File 5zmjbxUIOVQ58qPR.dll adalah muatan utama, yang mengikuti dari skrip NSIS di atas.  Analisis cepat metadata menunjukkan bahwa DLL awalnya bernama Norman.dll, itulah sebabnya kami menyebutnya begitu. <br><br>  File DLL dikembangkan di .NET dan dilindungi terhadap rekayasa terbalik dengan tiga kebingungan <br>  menggunakan produk komersial terkenal Agile .NET Obfuscator. <br><br>  Dalam proses eksekusi, banyak operasi implementasi pengenalan diri terlibat dalam proses sendiri, serta dalam proses lainnya.  Tergantung pada kedalaman bit OS, malware akan <br>  pilih jalur yang berbeda ke folder sistem dan mulai proses yang berbeda. <br><br><img src="https://habrastorage.org/webt/jp/sy/zn/jpsyzngdt-zv5qoswztui4odjrs.png"><br><br>  Berdasarkan jalur ke folder sistem, malware akan memilih proses yang berbeda untuk memulai. <br><br><img src="https://habrastorage.org/webt/wp/q9/jc/wpq9jcqxrvwvbfkgh9-wca2qmsi.png"><br><br>  Payload yang dikerahkan memiliki dua fungsi utama: mengeksekusi penambang crypto dan mencegah deteksi. <br><br><h4>  Jika OS-nya 64-bit </h4><br>  Ketika mengeksekusi file sumber svchosts.exe (file NSIS), itu menciptakan proses baru sendiri dan menyuntikkan muatan ke dalamnya (1).  Segera setelah itu, ia meluncurkan notepad.exe atau explorer.exe, dan menyuntikkan cryptominer ke dalamnya (2). <br><br><img src="https://habrastorage.org/webt/3n/rc/bt/3nrcbtfzkotbmjp_zqdvrzt9r_0.jpeg"><br><br>  Setelah itu, file svchost.exe asli dimatikan, dan file svchost.exe baru digunakan sebagai program yang memantau operasi proses penambang. <br><br><img src="https://habrastorage.org/webt/ng/ze/bq/ngzebqxper1bhxzwrqxvygimlac.png"><br><br><h4>  Jika OS-nya 32-bit </h4><br>  Selama eksekusi file svchosts.exe asli (file NSIS), itu menduplikasi prosesnya sendiri dan menyuntikkan muatan ke dalamnya, seperti dalam versi 64-bit. <br><br>  Dalam hal ini, malware menyuntikkan muatan ke dalam proses pengguna explorer.exe.  Sudah darinya, kode jahat memulai proses baru (wuapp.exe atau vchost.exe), dan menyuntikkan penambang ke dalamnya. <br><br><img src="https://habrastorage.org/webt/kb/c3/2q/kbc32qdqrmcwqzciy5vhesry224.png"><br><br>  Perangkat lunak berbahaya menyembunyikan fakta implementasi di explorer.exe, menimpa kode yang sebelumnya diterapkan dengan cara wuapp.exe dan mengosongkan nilai. <br><br><img src="https://habrastorage.org/webt/dz/uz/ct/dzuzct_donm4jroc54uj4bqzy2i.png"><br><br>  Seperti dalam kasus eksekusi di lingkungan 64-bit, proses svchost.exe asli keluar, dan yang kedua digunakan untuk menyuntikkan kembali kode berbahaya ke explorer.exe jika proses tersebut dihentikan oleh pengguna. <br><br>  Di akhir algoritma eksekusi, malware selalu menyuntikkan cryptominer ke dalam proses yang sah. <br><br>  Ini dirancang untuk mencegah deteksi dengan mematikan penambang ketika pengguna meluncurkan Task Manager. <br><br>  Harap perhatikan bahwa setelah memulai Pengelola Tugas, proses wuapp.exe berakhir. <br><br><img src="https://habrastorage.org/webt/nm/dw/y0/nmdwy02bz2qho6dgotsq_wprv6a.gif"><br><br>  Setelah menutup task manager, malware memulai proses wuapp.exe berulang kali <br>  memperkenalkan seorang penambang ke dalamnya. <br><br><h3>  Tahap 3. Penambang </h3><br>  Pertimbangkan penambang XMRig yang disebutkan di atas. <br><br>  Perangkat lunak berbahaya menyuntikkan versi UPX yang disamarkan dari penambang di notepad, exe, explorer.exe, <br>  svchost.exe atau wuapp.exe, tergantung pada kedalaman bit OS dan tahap algoritma eksekusi. <br><br>  Header PE di penambang telah dihapus, dan pada screenshot di bawah ini kita dapat melihat bahwa itu disembunyikan menggunakan UPX. <br><br><img src="https://habrastorage.org/webt/u0/es/8g/u0es8g-pm5lpx7bov_hwarxv-ws.png"><br><br>  Setelah membuat dump dan membangun kembali executable, kami berhasil menjalankannya: <br><br><img src="https://habrastorage.org/webt/il/nl/c-/ilnlc-lauzxcgsjrkg0pggo1wik.png"><br><br>  Perlu dicatat bahwa akses ke situs target XMR dilarang, yang secara efektif menetralkan penambang ini. <br><br>  <strong>Konfigurasi penambang:</strong> <br><br><pre><code class="plaintext hljs">"url": "pool.minexmr.com:5555","user": "49WvfokdnuK6ojQePe6x2M3UCD59v3BQiBszkuTGE7wmNJuyAvHM9ojedgxMwNx9tZA33P84EeMLte7t6qZhxNHqHyfq9xA","pass":"x"</code> </pre> <br><h2>  <font color="#D21927">PHP shell misterius mentransfer data ke C&amp;C</font> </h2><br>  Dalam perjalanan penyelidikan ini, ahli forensik kami menemukan file XSL yang menarik perhatian mereka.  Setelah analisis mendalam sampel, shell PHP baru ditemukan yang secara konstan terhubung ke pusat kontrol (server C&amp;C). <br><br>  Pada beberapa server di lingkungan pelanggan, ditemukan file XSL yang diluncurkan oleh executable Windows (mscorsv.exe) yang terkenal dari folder di direktori sysWOW64. <br><br>  Folder malware disebut AutoRecover dan berisi <b>beberapa file:</b> <br><br><ul><li>  File XSL: xml.XSL </li><li>  sembilan file dll </li></ul><br>  <b>File yang dapat dieksekusi:</b> <br><ul><li>  Msscorsv.exe </li><li>  Wmiprvse.exe </li></ul><br><img src="https://habrastorage.org/webt/dr/bc/nv/drbcnvij4atirz8jn_tncb6ndkc.png"><br><br><h2>  <font color="#D21927">File XSL</font> </h2><br>  File XSL adalah style sheet yang mirip dengan tabel yang digunakan dalam CSS yang menjelaskan cara menampilkan dokumen XML. <br><br>  Menggunakan Notepad, kami menemukan bahwa itu sebenarnya bukan file XSL, tetapi kode PHP Zend Guard yang dikaburkan.  Fakta aneh ini menyarankan hal ini <br>  payload malware berdasarkan algoritma eksekusi. <br><br><img src="https://habrastorage.org/webt/b9/gx/z5/b9gxz56io5zcmlgbtephvyuxyn8.png"><br><br><h2>  <font color="#D21927">Sembilan DLL</font> </h2><br>  Analisis awal file XSL membuat kami menyimpulkan bahwa memiliki begitu banyak <br>  DLL masuk akal.  Folder utama berisi DLL yang disebut php.dll dan tiga perpustakaan lain yang terkait dengan SSL dan MySQL.  Dalam subfolder, para ahli menemukan empat perpustakaan PHP dan satu perpustakaan Zend Guard.  Semuanya sah, dan diperoleh dari paket instalasi PHP atau sebagai dll eksternal. <br><br>  Pada tahap ini, asumsi dibuat bahwa malware didasarkan pada PHP dan dikaburkan oleh Zend Guard. <br><br><h2>  <font color="#D21927">Dapat dieksekusi</font> </h2><br>  Juga di folder ini ada dua file yang dapat dieksekusi: Mscorsv.exe dan Wmiprvse.exe. <br><br>  Setelah menganalisis file mscorsv.exe, kami menemukan bahwa itu tidak ditandatangani oleh Microsoft, meskipun parameter ProductName-nya diatur ke "Microsoft.  Kerangka Kerja Bersih. " <br>  Pada awalnya, itu tampak aneh, tetapi analisis Wmiprvse.exe memungkinkan untuk lebih memahami situasinya. <br><br>  File Wmiprvse.exe juga tidak ditandatangani, tetapi berisi simbol hak cipta grup PHP dan ikon PHP.  Selama pemindaian sepintas, perintah dari bantuan PHP ditemukan di barisnya.  Saat mengeksekusinya dengan sakelar -versi, ditemukan bahwa ini adalah file yang dapat dieksekusi yang dirancang untuk menjalankan Zend Guard. <br><br><img src="https://habrastorage.org/webt/9c/xw/ju/9cxwjuu7xoqggrzco-tgun7kpsw.png"><br><br>  Ketika mscorsv.exe diluncurkan dengan cara yang sama, data yang sama ditampilkan.  Kami membandingkan data biner dari dua file ini dan melihat bahwa keduanya identik, dengan pengecualian metadata <br>  Hak Cipta dan Nama Perusahaan / Nama Produk. <br><br><img src="https://habrastorage.org/webt/mp/7y/qk/mp7yqkfz6uqusknzixm5vrwun9e.png"><br><br>  Berdasarkan ini, disimpulkan bahwa file XSL berisi kode PHP yang berjalan menggunakan Zend Guard yang dapat dieksekusi, disembunyikan di bawah nama mscorsv.exe. <br><br><h2>  <font color="#D21927">Parsing File XSL</font> </h2><br>  Dengan menggunakan pencarian di Internet, para ahli dengan cepat menerima alat untuk mendobobekan Zend Guard dan mengembalikan file xml.XSL asli: <br><br><img src="https://habrastorage.org/webt/5a/ek/nj/5aeknjt7mwgxx96m3t5twger2h0.png"><br><br>  Ternyata malware itu sendiri adalah shell PHP yang terus-menerus terhubung ke pusat kontrol (server C&amp;C). <br><br>  Perintah dan output yang dikirim dan diterima dienkripsi.  Karena kami menerima kode sumber, kami memiliki kunci dan perintah enkripsi. <br><br>  Malware ini berisi fungsi bawaan berikut: <br><br><ul><li>  Eval - biasa digunakan untuk memodifikasi variabel yang ada dalam kode </li><li>  Catatan file lokal </li><li>  Fitur Basis Data </li><li>  Fitur PSEXEC </li><li>  Eksekusi tersembunyi </li><li>  Pemetaan Proses dan Layanan </li></ul><br>  Variabel berikut menunjukkan bahwa malware memiliki beberapa versi. <br><br><img src="https://habrastorage.org/webt/al/id/bs/alidbstswyy1huff1onuh5ma7bg.png"><br><br>  Saat mengumpulkan sampel, versi-versi berikut ini ditemukan: <br><br><ul><li>  0.5f </li><li>  0.4p </li><li>  0.4o </li></ul><br>  Satu-satunya fungsi memastikan keberadaan malware yang konstan dalam sistem adalah ketika dieksekusi, ia menciptakan layanan yang mengeksekusi dirinya sendiri, dan namanya <br>  bervariasi dari versi ke versi. <br><br>  Spesialis mencoba menemukan sampel serupa di Internet dan menemukan malware, <br>  yang, menurut pendapat mereka, adalah versi sebelumnya dari sampel yang ada.  Isi folder serupa, tetapi file XSL berbeda dan nomor versi yang berbeda ditentukan di dalamnya. <br><br><h2>  <font color="#D21927">Parle Wu Malvare?</font> </h2><br>  Mungkin tempat kelahiran malware ini adalah Prancis atau negara berbahasa Perancis lainnya: file SFX berisi komentar dalam bahasa Prancis yang menunjukkan bahwa penulis menggunakan WinRAR versi Perancis untuk membuatnya. <br><br><img src="https://habrastorage.org/webt/xq/e2/cd/xqe2cddtfruhzwvz3mro0iqglpm.png"><br><br>  Selain itu, beberapa variabel dan fungsi dalam kode juga dinamai dalam bahasa Prancis. <br><br><img src="https://habrastorage.org/webt/vx/95/9d/vx959dqslson6ybxzoawqzzyvog.png"><br><br><img src="https://habrastorage.org/webt/sk/cv/rd/skcvrd_tj6ntrgghhjzl1fhpjy8.png"><br><br><h2>  <font color="#D21927">Memantau pelaksanaan dan menunggu tim baru</font> </h2><br>  Spesialis memodifikasi kode malware, dan dengan aman meluncurkan yang sudah dimodifikasi <br>  versi untuk mengumpulkan informasi tentang tim yang diterima. <br><br><img src="https://habrastorage.org/webt/xv/tf/uf/xvtfufticasuciea8sfzqyrpppc.png"><br><br>  Pada akhir sesi komunikasi pertama, spesialis melihat bahwa malware menerima perintah yang disandikan dengan Base64 sebagai argumen untuk kunci startup EVAL64. <br>  Perintah ini diterjemahkan dan dieksekusi.  Ini mengubah beberapa variabel internal (ukuran buffer baca dan tulis), setelah itu malware memasuki siklus kerja menunggu perintah. <br><br>  Tidak ada tim baru yang diterima saat ini. <br><br><h2>  <font color="#D21927">Shell PHP dan penambang crypto interaktif: apakah semuanya terkait?</font> </h2><br>  Para ahli Varonis tidak yakin apakah Norman dikaitkan dengan shell PHP, karena ada argumen signifikan untuk dan menentang asumsi ini: <br><br><h3>  Mengapa mereka bisa saling berhubungan </h3><br><ul><li>  Tak satu pun dari sampel perangkat lunak penambangan crypto berbahaya memiliki kemampuan untuk mendistribusikan secara independen ke sistem lain, meskipun mereka ditemukan pada berbagai perangkat di segmen jaringan yang berbeda.  Ada kemungkinan bahwa penyerang menginfeksi setiap node secara terpisah (mungkin menggunakan vektor serangan yang sama seperti ketika menginfeksi "nol pasien"), meskipun akan lebih efisien untuk menggunakan shell PHP untuk menyebar ke jaringan yang menjadi target serangan. </li><li>  Kampanye otomatis bertarget berskala besar yang diarahkan pada organisasi tertentu seringkali meninggalkan artefak teknis atau jejak ancaman cybersecurity yang dapat dikenali dalam implementasinya.  Dalam hal ini, tidak ada yang ditemukan. </li><li>  Baik Norman dan PHP shell menggunakan layanan DuckDNS. </li></ul><br><h3>  Mengapa mereka tidak terkait </h3><br><ul><li>  Tidak ada kesamaan teknis antara opsi malware penambangan crypto dan shell PHP.  Cryptominer berbahaya dibuat di C ++, dan shell di PHP.  Juga, tidak ada kesamaan dalam struktur kode, dan fungsi jaringan diimplementasikan secara berbeda. </li><li>  Tidak ada interaksi langsung antara opsi malware dan shell PHP untuk bertukar data. </li><li>  Mereka tidak memiliki komentar pengembang umum, file, metadata atau sidik jari. </li></ul><br><h3>  Tiga rekomendasi untuk perlindungan terhadap cangkang yang dilepas </h3><br>  Perangkat lunak berbahaya, yang memerlukan perintah dari pusat kontrol (server C&amp;C), tidak terlihat seperti virus biasa.  Tindakannya tidak dapat diprediksi dan lebih menyerupai tindakan peretas atau pentester yang dilakukan tanpa alat atau skrip otomatis.  Oleh karena itu, mendeteksi serangan ini tanpa tanda tangan malware adalah tugas yang lebih kompleks daripada pemindaian antivirus konvensional. <br><br>  <strong>Berikut adalah tiga rekomendasi untuk melindungi perusahaan dari cangkang jarak jauh:</strong> <br><ol><li>  <b>Tetap perbarui semua perangkat lunak</b> <br>  Penyerang sering mengeksploitasi kerentanan dalam perangkat lunak dan sistem operasi untuk menyebar di seluruh jaringan organisasi dan mencari data yang menarik untuk <br>  pencurian.  Pemasangan tambalan yang tepat waktu secara signifikan mengurangi risiko ancaman semacam itu. </li><li>  <b>Lacak acara akses data yang tidak normal</b> <br>  Kemungkinan besar, penyerang akan mencoba untuk menampilkan data rahasia organisasi di sekelilingnya.  Pemantauan kejadian abnormal dari akses ke data ini akan memungkinkan <br>  mendeteksi pengguna yang dikompromikan dan seluruh set folder dan file yang sebenarnya bisa jatuh ke tangan penyerang, dan tidak hanya mempertimbangkan semua data yang tersedia untuk para pengguna ini. </li><li>  <b>Lacak lalu lintas jaringan</b> <br>  Berkat penggunaan firewall dan / atau server proxy, dimungkinkan untuk mendeteksi dan memblokir koneksi jahat ke pusat kendali malware (C&amp;C server), yang akan mencegah penyerang mengeksekusi perintah dan mempersulit tugas keluaran <br>  data perimeter. </li></ol><br>  <strong>Prihatin dengan masalah penambangan abu-abu?</strong>  <strong>Enam rekomendasi untuk perlindungan:</strong> <br><br><ol><li>  <b>Tetap perbarui semua sistem operasi.</b> <br>  Manajemen tambalan sangat penting untuk mencegah penyalahgunaan sumber daya dan infeksi malware. </li><li>  <b>Monitor lalu lintas jaringan dan proksi web</b> <br>  Lakukan ini untuk mendeteksi beberapa serangan, dan untuk mencegahnya, Anda dapat memblokir lalu lintas berdasarkan informasi tentang domain jahat atau membatasi saluran transmisi data yang tidak perlu. </li><li>  <b>Gunakan dan pertahankan solusi anti-virus dan sistem keamanan titik akhir</b> (tetapi jangan sampai Anda hanya menggunakan lapisan perlindungan ini). <br>  Produk pada perangkat akhir memungkinkan deteksi cryptominers yang terkenal dan pencegahan infeksi sebelum kinerja sistem dan penggunaan listrik dikompromikan.  Harus diingat bahwa modifikasi baru atau metode baru untuk mencegah deteksi dapat menyebabkan fitur keamanan pada perangkat akhir tidak mendeteksi versi baru dari malware yang sama. </li><li>  <b>Monitor aktivitas CPU komputer</b> <br>  Sebagai aturan, crypto miners menggunakan prosesor sentral komputer untuk menambang.  Penting untuk menganalisis pesan apa pun tentang penurunan kinerja ("Komputer saya mulai melambat."). </li><li>  <b>Monitor DNS untuk penggunaan layanan Dynamic DNS yang tidak biasa (seperti DuckDNS)</b> \ <br><br>  Terlepas dari kenyataan bahwa DuckDNS dan layanan Dynamic DNS lainnya sendiri tidak berbahaya bagi sistem, penggunaan malware DuckDNS menyederhanakan deteksi node yang terinfeksi untuk tim spesialis yang terlibat dalam penyelidikan. </li><li>  <b>Kembangkan rencana respons insiden</b> <br>  Pastikan Anda memiliki prosedur yang diperlukan untuk insiden yang secara otomatis mendeteksi, membatasi, dan menghilangkan ancaman penambangan kripto abu-abu. </li></ol><br>  <strong>Catatan untuk pelanggan Varonis.</strong> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Varonis DatAlert</a> termasuk model ancaman yang mendeteksi malware untuk penambangan crypto.  Pelanggan juga dapat membuat aturan mereka sendiri untuk penemuan perangkat lunak yang ditargetkan berdasarkan domain yang merupakan kandidat untuk daftar hitam.  Untuk memastikan bahwa Anda menggunakan versi terbaru dari DatAlert dan menerapkan model ancaman yang sesuai, hubungi perwakilan penjualan Anda atau Dukungan Varonis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id466817/">https://habr.com/ru/post/id466817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id466807/index.html">Python, melahap dunia: sebagai proyek sampingan dari satu pengembang telah menjadi bahasa pemrograman yang populer</a></li>
<li><a href="../id466809/index.html">Lingkaran ditutup. Bagaimana mitaps membantu saya menemukan pekerjaan impian</a></li>
<li><a href="../id466811/index.html">Sejarah dan alternatif untuk platform .NET</a></li>
<li><a href="../id466813/index.html">Posit-arithmetic: mengalahkan floating point di bidangnya sendiri. Bagian 2</a></li>
<li><a href="../id466815/index.html">Ikhtisar Teknis NEC HYDRAstor HS8 dan banyak lagi</a></li>
<li><a href="../id466819/index.html">Implementasi penawaran promosi di iOS. Bagaimana cara menghasilkan lebih dari langganan?</a></li>
<li><a href="../id466821/index.html">Instal 3CX dari Amazon AWS Marketplace</a></li>
<li><a href="../id466823/index.html">Bagaimana kami mengatur migrasi untuk proses bisnis di Bitrix24</a></li>
<li><a href="../id466829/index.html">Beberapa sentuhan untuk bekerja dengan ID bigint di R</a></li>
<li><a href="../id466831/index.html">Mengembangkan OS seperti Unix yang monolitik - Heap (4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>