<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòó üìò ‚öóÔ∏è Erbe des Zeus: Warum der IcedID-Trojaner f√ºr Bankkunden gef√§hrlich ist üëäüèΩ üëâüèΩ ü§∏üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Group-IB-Experten analysierten den Trojaner, der US-Bankkunden angreift, und stellten die Ergebnisse einer eingehenden Analyse des dynamischen Konfigu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erbe des Zeus: Warum der IcedID-Trojaner f√ºr Bankkunden gef√§hrlich ist</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/418189/">  <b>Group-IB-Experten analysierten den Trojaner, der US-Bankkunden angreift, und stellten die Ergebnisse einer eingehenden Analyse des dynamischen Konfigurationsdatenformats mit Python-Skripten und Informationen auf CnC-Servern √∂ffentlich zur Verf√ºgung.</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b0/4i/rd/b04ird-g1xlcbwcd27zrl3rzg90.png" alt="Bild"></div><br>  Im November 2017 ver√∂ffentlichte ein Forscherteam von IBM X-Force einen Bericht √ºber einen neuen Trojaner - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IcedID</a> , der sich haupts√§chlich an Kunden von US-Banken richtet.  Der Bot verf√ºgt √ºber viele Funktionen der ber√ºchtigten Zeus-Malware, darunter das Herunterladen und Ausf√ºhren von Modulen, das Sammeln und √úbertragen von Authentifizierungsdaten an den Server, Informationen √ºber das infizierte Ger√§t und das Ausf√ºhren eines Man-in-the-Browser-Angriffs (MITB).  Trotz der Tatsache, dass sich herausstellte, dass der neue Trojaner in seiner Funktionalit√§t anderen beliebten Bankern - Trickbot, GOZI, Dridex - √§hnelt, die Bankkunden aktiv angreifen, verwendet IcedID ein nicht standardm√§√üiges Bin√§rformat zum Speichern von Konfigurationsdaten.  Ein weiteres Unterscheidungsmerkmal dieser Malware ist die M√∂glichkeit, einen Proxyserver direkt auf dem infizierten Computer bereitzustellen, um einen MITB-Angriff durchzuf√ºhren. <a name="habracut"></a><br><br>  <b>Text: Ivan Pisarev, Spezialist f√ºr Malware-Analyse der Gruppe IB</b> <b><br></b> <br>  Sofort ist IcedID im Vergleich zu anderen Trojanern nicht so weit verbreitet, aber jetzt verf√ºgt es √ºber gen√ºgend Funktionen, um seine Ziele zu erreichen, wobei der Diebstahl der Anmeldeinformationen des Opfers die Hauptursache ist.  Dies kann auf viele Arten erreicht werden, angefangen beim banalen Diebstahl von Dateien und Registrierungseintr√§gen von einem infizierten Computer bis hin zum Abfangen und √Ñndern des verschl√ºsselten Browserverkehrs (Man-in-the-Browser-Angriff). <br><br>  Im Fall von IcedID wurden Daten von Konten gestohlen: Windows Live Mail, Windows Mail, RimArts, Poco Systems Inc., IncrediMail, The Bat!  und Ausblick.  MITB-Angriffe werden √ºber einen Proxyserver ausgef√ºhrt, der einen Trojaner auf einem infizierten Ger√§t aufnimmt, wodurch der gesamte Netzwerkverkehr durch sich selbst geleitet und ge√§ndert wird.  IcedID verf√ºgt au√üerdem √ºber ein Serverbefehlsverarbeitungsmodul, mit dem Sie die Datei remote herunterladen und ausf√ºhren k√∂nnen (im untersuchten Fall hat das Beispiel beispielsweise das VNC-Modul geladen, dessen Programmcode √§hnliche Codeabschnitte mit IcedID enth√§lt). <br><br>  Die Verwendung eines Proxyservers f√ºr MITB ist ein atypisches Verhalten f√ºr diesen Trojanertyp.  H√§ufiger wird Malware in den Browserkontext eingebettet und Funktionsaufrufe von Standardbibliotheken an ihre <b>Handlerfunktionen</b> umgeleitet (Beispiel: <b>WinHttpConnect ()</b> , <b>InternetConnect ()</b> , <b>InternetReadFile ()</b> , <b>WinHttpReadData ()</b> usw.).  Zuvor wurde der Proxy-Trick bereits in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GootKit verwendet</a> . <br><br>  IcedID wurde mit einer anderen Malware, Emotet, verbreitet (es wird derzeit h√§ufig als Bootloader verwendet, obwohl es √ºber erweiterte Funktionen verf√ºgt) und enthielt bereits zu Beginn eine umfangreiche Liste moderner Methoden zum Stehlen von Benutzerdaten. <br><br>  Jetzt hat der Trojaner eher schwache Anti-Parsing-Mechanismen (String-Verschl√ºsselung, Header besch√§digt) und keine VM-Erkennungsmethoden.  Aus Sicht des Forschers befindet sich Malware noch in der Entwicklung und diese Schutzmechanismen werden sp√§ter hinzugef√ºgt. <br><br>  Das Cyber-Intelligence-System von Group-IB Threat Intelligence hat keine IcedID-Verk√§ufe in thematischen Foren festgestellt. Dies bedeutet entweder die Entstehung einer neuen Gruppe in der Arena der Bankentrojaner oder den Verkauf des Trojaners √ºber private Kan√§le.  Die Ziele des Bots, gemessen an den dynamischen Konfigurationsdaten (im Folgenden als Konfigurationen bezeichnet), liegen haupts√§chlich in den USA. <br><br><div class="spoiler">  <b class="spoiler_title">Zielliste</b> <div class="spoiler_text">  Chase <br>  Charles schwab <br>  Bank of America <br>  USAA <br>  Amerikanischer Express <br>  Wells Fargo <br>  Kapital eins <br>  Td Commercial Banking <br>  TD Bank <br>  Zentralbank <br>  US Bank <br>  Union Bank von Kalifornien <br>  Amazon <br>  PNC Online Banking <br>  Synovus <br>  BB &amp; T Bank <br>  Citibank <br>  eBanking <br>  Huntington <br>  ashanalyzer <br>  E-Trade <br>  JPMorgan Chase <br>  Cibc <br>  Regionen OnePass <br>  Post Eiche Bank <br>  Comerica <br>  Bank entdecken <br>  Keybank <br>  Frost Cash Manager <br>  Hsbc <br>  Rbc <br>  Halifax <br>  Verizon Wireless <br>  Lloyds Bank <br>  M &amp; T Bank <br>  Virwox <br>  ADP <br></div></div><br>  Dieser Artikel enth√§lt eine detaillierte Analyse des Trojaners, eine gr√ºndliche Analyse des Formats dynamischer Konfigurationen mit Python-Skripten sowie Informationen zu CnC. <br><br><h2>  Technischer Teil </h2><br><h3>  Allgemeine Beschreibung der Arbeit des Trojaners </h3><br>  Zun√§chst wird der Abschnitt <b>.data</b> des Trojaners verschl√ºsselt.  Zun√§chst wird der Abschnitt nach dem Start gem√§√ü dem Algorithmus entschl√ºsselt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a-/q0/ix/a-q0ixeg0onp--szzafmr9on6os.png" alt="Bild"></div><br>  Die Variablen <b>initial_seed</b> und <b>size_seed</b> befinden sich am Anfang des <b>Datenabschnitts</b> (die ersten 8 Bytes des Abschnitts). <b>Danach</b> werden verschl√ºsselte Daten mit Gr√∂√üengr√∂√üenbytes gefunden.  Die Funktion <b>make_seed ()</b> ist eine eindeutige <b>PRNG-</b> Funktion (Pseudo Random Number Generator <b>)</b> f√ºr IcedID, auf die wir mehrmals zur√ºckkommen werden.  Die Python-Version der Funktion finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  Der Bot enth√§lt zun√§chst verschl√ºsselte Strings.  Um die Analyse zu erleichtern, wurde f√ºr IDA Pro ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript</a> zum Entschl√ºsseln der Zeichenfolgen dekodiert (Sie m√ºssen die Adresse der Entschl√ºsselungsfunktion in Ihr Beispiel einf√ºgen). <br><br>  Der n√§chste Schritt ist das Hinzuf√ºgen eines Ausnahmebehandlers mit der Funktion <b>SetUnhandledExceptionFilter ()</b> .  Wenn w√§hrend des Anwendungsbetriebs eine Ausnahme auftritt, wird sie einfach neu gestartet. <br><br>  Nach dem Hinzuf√ºgen eines Ausnahmebehandlers sammelt der Trojaner Informationen √ºber das infizierte System: <br><br><ol><li>  Betriebssystemversion </li><li>  OS-Build-Nummer </li><li>  Service Pack-Version </li><li>  Systemkapazit√§t </li><li>  Betriebssystemtyp </li></ol><br>  Die Anwendung erzeugt eine <b>Sicherheitsbeschreibung: D: (A ;; GA ;;;</b> WD) (A ;; GA ;;; AN) S: (ML ;; NW ;;; S-1-16-0), und weist dann Speicher zum Protokollieren von Informationen w√§hrend des Betriebs des Trojaners.  Beispiel f√ºr protokollierte Zeichenfolgen (Zeichenfolgen wurden mithilfe eines Skripts in der IDA abgerufen): <br><br><ol><li>  E | C | IN | INS | ISF | CP% u </li><li>  I | C | IN | INT | CI |  % u </li><li>  W | C | IN | INT | CI | CRLL </li></ol><br>  IcedID kann mehrere Parameter annehmen.  Unter ihnen: <br><br><ul><li>  <b>--svc =</b> - speichert die Zeichenfolge vom Parameter in der Registrierung nach Schl√ºssel mit dem Namen <b>IcedID_reg ("* p *")</b> , wobei <b>IcedID_reg (str)</b> die Funktion zum Generieren des Schl√ºsselnamens aus der Zeichenfolge <b>str ist</b> (der Algorithmus zum Generieren von Registrierungsschl√ºsselnamen wird sp√§ter beschrieben) Der Trojaner greift auf ein Ereignis mit dem Namen <b>Global \ &lt;% Zeichenfolge zuf√§lliger Zeichen%&gt; zu</b> .  Im Fehlerfall erstellt der Bot eine Kopie seines Prozesses mit dem Parameter <b>/ w =</b> .  Wenn dies nicht m√∂glich ist, wird ein Wert in der Registrierung erstellt: </li></ul><br><blockquote>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ &lt;% Eine Zeichenfolge der L√§nge 9 aus zuf√§lligen Zeichen im Alphabet [az]%&gt; </blockquote><br>  Dadurch wird eine Persistenz im System sichergestellt.  Dieser Schl√ºssel ist f√ºr den ersten Start des Trojaners vorgesehen. <br><br><ul><li>  <b>/ u</b> - Standardm√§√üig versucht Malware, sich selbst als Dom√§nenadministrator <b>auszuf√ºhren</b> (mithilfe des <b>Runas-</b> Programms).  Wenn dieses Flag vorhanden ist, f√ºhrt der Trojaner diesen Vorgang nicht aus und erstellt einfach seine Kopie im Verzeichnis <b>C: \ Benutzer \ &lt;% Benutzername%&gt; \ AppData \ Local \ &lt;% Eine Zeichenfolge der L√§nge 9 aus zuf√§lligen Zeichen des Alphabets [az]%&gt;</b> mit dem Namen <b>&lt;% Eine Zeichenfolge mit einer L√§nge von 9 aus zuf√§lligen Zeichen des Alphabets [az]%&gt;. Exe</b> und schreibt den Pfad zur Datei in die Registrierung, wodurch eine Persistenz im System sichergestellt wird. </li></ul><br><blockquote>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ &lt;% Eine Zeichenfolge der L√§nge 9 aus zuf√§lligen Zeichen im Alphabet [az]%&gt; </blockquote><br>  Es scheint, dass dieser Schl√ºssel beim Aktualisieren eines Bankiers verwendet wird.  Vor dem Neustart ‚Äûschl√§ft‚Äú der Trojaner 5 Sekunden lang ein. <br><br><ul><li>  <b>/ c</b> - Vor dem Ausf√ºhren b√∂sartiger Funktionen ‚Äûschl√§ft‚Äú der Trojaner 5 Sekunden lang ein </li><li>  <b>/ w =</b> - speichert eine Zeichenfolge aus dem Parameter in der Registrierung per Schl√ºssel mit dem Namen <b>IcedID_reg ("* p *")</b> </li></ul><br>  Nach der Verarbeitung der Parameter greift die Anwendung auf die Registrierung zu und ruft die dynamischen Konfigurationsdaten ab, die CnC-Adressen sowie Web-Injects enthalten.  Das Format zum Speichern von Daten in der Registrierung wird in den folgenden Abschnitten beschrieben. <br><br>  Nach dem Zugriff auf die Registrierung erstellt das Programm einen Thread, der alle 5 oder 10 Minuten (abh√§ngig vom internen Flag) CnC kontaktiert, um Befehle zu empfangen.  Hier ist der nicht standardm√§√üige Mechanismus des ‚ÄûEinschlafens‚Äú des Bots zwischen Aufrufen von CnC zu beachten: Die Entwickler haben nicht die Standardfunktion <b>Sleep ()</b> verwendet, sondern ein Ereignis in einem Nicht-Signalzustand erstellt und ohne es im Signalzustand aufzurufen, die Funktion <b>WaitForSingleObject () aufgerufen</b> .  Funktion zur Erstellung des CnC-Anrufverlaufs: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vu/bg/1_/vubg1_zk61_dw8auvz80yi1lhxc.png" alt="Bild"></div><br>  Analogfunktionen <b>Sleep ()</b> in IcedID: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yd/if/f3/ydiff39eemw9rymerxmj82rintw.png" alt="Bild"></div><br>  Der lange Zugriff auf den Server sowie die nicht standardm√§√üige ‚ÄûSchlaffunktion‚Äú sollen der Analyse h√∂chstwahrscheinlich entgegenwirken. <br><br>  SSL wird verwendet, um den Datenverkehr zwischen dem Server und der Anwendung auszublenden. <br><br>  Nach dem Starten des Threads "hebt" der Bot den Proxyserver auf dem lokalen Computer an, um den Datenverkehr auf dem infizierten Computer zu verarbeiten. <br><br>  Das Kommunikationsprotokoll des Servers und des infizierten Ger√§ts wird in den folgenden Abschnitten erl√§utert.  Es ist jedoch zu beachten, dass die Malware auf Befehl des Servers Konfigurationen aktualisieren, den VNC-Server starten und stoppen, Befehle cmd.exe ausf√ºhren und Dateien herunterladen kann. <br><br><h3>  Interaktion zwischen IcedID und CnC Server </h3><br>  Die Liste der CnC-Adressen wird in verschl√ºsselter Form im Hauptteil des Bankiers sowie in Form einer dynamischen Konfiguration in der Registrierung gespeichert.  Die Interaktion zwischen dem Server und dem Trojaner erfolgt √ºber das HTTPS-Protokoll.  Sendet Daten mit POST-Anforderungen an den Server und verwendet GET zum Empfangen von Daten. <br><br>  Die Server-Abfragezeichenfolge lautet wie folgt: <br><br><blockquote>  &lt;% CnC%&gt; /forum/viewtopic.php?a=&lt;%Integer%&gt;&amp;b=&lt;%Lange Ganzzahl%&gt; &amp; d = &lt;% Integer%&gt; &amp; e = &lt;% Integer%&gt; &amp; &lt;% Andere Daten%&gt; </blockquote><br>  Feldwert: <br><br><ul><li>  a - Art der Anforderung, dieses Feld kann Werte annehmen: <br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>Wert</nobr> </th><th>  Aktion </th></tr><tr><td>  0,1 </td><td>  Senden Sie Informationen zu einem infizierten Computer </td></tr><tr><td>  2,3 </td><td>  Senden Sie andere Daten an den Server </td></tr><tr><td>  4 </td><td>  Holen Sie sich die neueste Version von dynamischen Konfigurationen und f√ºgen Sie sie mit dem Schl√ºssel mit dem Namen <b>IcedID_reg ("* cfg1")</b> in die Registrierung ein. <br></td></tr><tr><td>  5 </td><td>  Holen Sie sich die neueste Version von dynamischen Konfigurationen und f√ºgen Sie sie mit dem Schl√ºssel mit dem Namen <b>IcedID_reg ("* cfg0")</b> in die Registrierung ein. <br></td></tr><tr><td>  6 </td><td>  Holen Sie sich die neueste Version von dynamischen Konfigurationen und f√ºgen Sie sie mit dem Schl√ºssel mit dem Namen <b>IcedID_reg ("* rtd")</b> (CnC-Adressen) in die Registrierung ein. <br></td></tr><tr><td>  7 </td><td>  Holen Sie sich die neueste Version des VNC-Moduls </td></tr><tr><td>  8 </td><td>  Holen Sie sich die neueste Bot-Version </td></tr></tbody></table></div></li><li>  b - Bot ID </li><li>  d - Flagge </li><li>  e - Konstante, direkt im Bot-Code </li></ul><br>  Ferner h√§ngen die Feldwerte vom Feld "a" ab.  Wenn es 0 oder 1 ist, sieht die Abfrage folgenderma√üen aus: <br><br><blockquote>  POST /forum/viewtopic.php?a=&lt;%0 oder 1%&gt; &amp; b = &lt;% BotID%&gt; &amp; d = &lt;% Integer%&gt; &amp; e = &lt;% Konstante%&gt; &amp; f = &lt;% Cfg1 Pr√ºfsumme%&gt; &amp; g = &lt;% Cfg0 Pr√ºfsumme%&gt; &amp; h = &lt;% Rtd Pr√ºfsumme%&gt; &amp; r = &lt;% VNC Pr√ºfsumme%&gt; &amp; i = &lt;% Anforderungszeit%&gt; HTTP / 1.1 <br>  Verbindung: schlie√üen <br>  Inhaltstyp: application / x-www-form-urlencoded <br>  Inhaltsl√§nge: </blockquote><br>  Der Anforderungshauptteil enth√§lt Informationen zum infizierten Computer.  Informationen werden bereitgestellt in Form von: <br><br><blockquote>  k = &lt;% String%&gt; &amp; l = &lt;% String%&gt;% j = &lt;% Integer%&gt; &amp; n = &lt;% Integer%&gt; &amp; m = &lt;% String%&gt; </blockquote><br>  Wo: <br><br><ul><li>  k - Computername in UNICODE </li><li>  l - Domainmitglied in UNICODE </li><li>  m - Systeminformationen: <br><ol><li>  Betriebssystemversion </li><li>  OS-Build-Nummer </li><li>  Service Pack-Version </li><li>  Systemkapazit√§t </li><li>  Betriebssystemtyp </li></ol></li></ul><br>  Wenn das Feld 2 oder 3 ist, sieht die Abfrage folgenderma√üen aus: <br><br><blockquote>  POST /forum/viewtopic.php?a=&lt;%3 oder 2%&gt; &amp; b = &lt;% BotID%&gt; &amp; d = &lt;% Integer%&gt; &amp; e = &lt;% Konstante%&gt; HTTP / 1.1 <br>  Verbindung: schlie√üen <br>  Inhaltstyp: Anwendung / Oktett-Stream <br>  Inhaltsl√§nge: </blockquote><br>  Andernfalls lautet die Anforderung wie folgt: <br><br><blockquote>  GET /forum/viewtopic.php?a=&lt;%4-8%&gt;&amp;b=&lt;%BotID%&gt;&amp;d=&lt;%Integer%&gt;&amp;e=&lt;%Constant%&gt;&amp;o=&lt;%Object Pr√ºfsumme%&gt; <br>  HTTP / 1.1 <br>  Verbindung: schlie√üen <br><br>  Inhaltstyp: application / x-www-form-urlencoded <br>  Inhaltsl√§nge: </blockquote><br>  Beispiele f√ºr Abfragen sind in den folgenden Abbildungen dargestellt.  Paket-Header beim Zugriff auf den Server: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4t/yj/cw/4tyjcwlgccfqrer5fkblehqaza0.png" alt="Bild"></div><br>  Nachrichtentext: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nx/iu/7r/nxiu7r72nmfovwhqcz85fdjwoga.png" alt="Bild"></div><br>  Der Trojaner kann Befehle vom Server empfangen.  Befehle werden als ganzzahlige Werte dargestellt.  Alle Befehle kommen in Form von Zeichenfolgen zum Bot, deren Parameter durch das Symbol ‚Äû;‚Äú getrennt sind.  Das Programm kann 23 Befehle verarbeiten: <br><br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>Das Team</nobr> </th><th>  Wert </th></tr><tr><td>  0 </td><td>  Tut nichts (wahrscheinlich wird in Zukunft Funktionalit√§t hinzugef√ºgt) <br></td></tr><tr><td>  1 </td><td>  Aktualisieren Sie den Wert mit dem Registrierungsschl√ºssel <b>IcedID_reg ("* cfg0").</b> <br></td></tr><tr><td>  2 </td><td>  Aktualisieren Sie den Wert mit einem Registrierungsschl√ºssel namens <b>IcedID_reg ("* cfg1").</b> <br></td></tr><tr><td>  3 </td><td>  Aktualisieren Sie den Wert des Registrierungsschl√ºssels mit dem Namen <b>IcedID_reg ("* rtd").</b> <br></td></tr><tr><td>  4 </td><td>  Datei herunterladen, im AppData-Verzeichnis speichern und ausf√ºhren <br></td></tr><tr><td>  5 </td><td>  F√ºhren Sie das Programm aus. Der Name und die Startargumente werden als Parameter angegeben <br></td></tr><tr><td>  6 </td><td>  Informationen zum Ausf√ºhren von Prozessen erhalten, einschlie√ülich: PID und Prozessname <br></td></tr><tr><td>  7 </td><td>  Schalten Sie den Computer mit den Informationen als Funktionsparameter aus: <br>  <b>SHTDN_REASON_FLAG_PLANNED</b> <b><br></b>  <b>SHTDN_REASON_MINOR_INSTALLATION</b> <b><br></b>  <b>SHTDN_REASON_MAJOR_APPLICATION</b> <br></td></tr><tr><td>  8 </td><td>  Schreiben Sie den Wert in die Registrierung (der Name wird basierend auf dem unten beschriebenen Algorithmus generiert). <br></td></tr><tr><td>  9 </td><td>  Lesen Sie den Wert in der Registrierung (der Name wird basierend auf dem unten beschriebenen Algorithmus generiert). <br></td></tr><tr><td>  10 </td><td>  L√∂schen Sie den Schl√ºssel aus der Registrierung (der Name wird basierend auf dem unten beschriebenen Algorithmus generiert). <br></td></tr><tr><td>  11 </td><td>  F√ºhren Sie das erweiterte Modul zum Verarbeiten von Befehlen vom Server aus <br></td></tr><tr><td>  12 </td><td>  Stoppen Sie das erweiterte Modul f√ºr die Verarbeitung von Befehlen vom Server <br></td></tr><tr><td>  13 </td><td>  Aktualisieren Sie das VNC-Modul (im Verzeichnis% TEMP%). <br></td></tr><tr><td>  14 </td><td>  Rufen Sie eine Liste der Dateien auf dem Desktop eines infizierten Ger√§ts ab <br></td></tr><tr><td>  15 </td><td>  Laden Sie die Datei herunter, speichern Sie sie unter dem Namen <b>&lt;% String of random Zeichen%&gt;. Tmp</b> und f√ºhren Sie sie mit dem Schl√ºssel <b>\ u aus</b> .  Dieser Befehl scheint erforderlich zu sein, um die Bot-Version auf einem infizierten Ger√§t zu aktualisieren. <br></td></tr><tr><td>  16 </td><td>  L√∂schen Sie eine Datei, deren Name eine Zeichenfolge enth√§lt (als Parameter). <br></td></tr><tr><td>  17 </td><td>  Starten Sie das Netzwerkverteilungsmodul.  Die Verteilung erfolgt durch Kopieren und Starten des Bots in das Windows-Verzeichnis auf einem anderen Ger√§t mithilfe des LDAP-Protokolls. <br></td></tr><tr><td>  18 </td><td>  Holen Sie sich Bot-Protokolldaten <br></td></tr><tr><td>  19 </td><td>  Setzen Sie das Serverzugriffsereignis auf den Alarmstatus <br></td></tr><tr><td>  20 </td><td>  Erhalten Sie Kontoinformationen f√ºr die folgenden Anwendungen: Windows Live Mail, Windows Mail, RimArts, Poco Systems Inc., IncrediMail, The Bat!  und Ausblick <br></td></tr><tr><td>  21 </td><td>  √Ñndern Sie das Intervall zwischen Serveraufrufen <br></td></tr><tr><td>  22 </td><td>  Rufen Sie den Pfad aus der Umgebungsvariablen ab, laden Sie die Datei herunter und speichern Sie sie unter diesem Pfad <br></td></tr><tr><td>  21 </td><td>  Laden Sie die Datei in das AppData-Verzeichnis hoch und f√ºhren Sie sie mit den Parametern <b>/ t = &lt;% Handle des speziell generierten Ereignisses%&gt; / f = &lt;% Handle 2 des speziell generierten Ereignisses%&gt; aus</b> .  Nach dem √úbersetzen von Ereignissen in einen Alarmstatus wird die heruntergeladene Datei aus dem AppData-Verzeichnis gel√∂scht <br></td></tr></tbody></table></div><br>  Wenn der Befehl erfolgreich ausgef√ºhrt wurde, sendet der Trojaner die Zeichenfolge "True" an den Server, andernfalls "False". <br><br>  Wenn ein Befehl zum Starten des Moduls f√ºr erweiterte Befehle empfangen wird, sendet die Anwendung zwei Bytes an den Server und wartet anschlie√üend auf eine Antwort.  Das erste vom Server empfangene Byte entspricht dem erweiterten Befehl aus der Tabelle: <br><br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>Das Team</nobr> </th><th>  Wert </th></tr><tr><td>  5 </td><td>  Starten Sie einen Thread, der die Befehle cmd.exe auf dem infizierten Computer ausf√ºhrt. <br></td></tr><tr><td>  6 </td><td>  Starten Sie den VNC-Server.  Im untersuchten Fall wurde der VNC-Server als DLL-Bibliothek mit einem √§hnlichen String-Verschl√ºsselungsalgorithmus vorgestellt. <br></td></tr><tr><td>  7 </td><td>  F√ºhren Sie den Befehl aus der obigen Tabelle aus.  Um einen normalen Befehl zu erhalten, sendet der Trojaner zwei Zeichen an den Server und benachrichtigt den Server √ºber die Bereitschaft, indem er einen Befehlsbot akzeptiert. <br></td></tr></tbody></table></div><br>  Ein VNC-Server kann auf zwei Arten gestartet werden (abh√§ngig vom internen Flag): <br><br><ol><li>  Verwenden der Funktion <b>CreateProcessA ()</b> mit dem <b>Kernel32-</b> Parameter <b>rundll32.exe, Sleep -s &lt;% param%&gt;</b> </li><li>  Mit Hilfe von <b>CreateProcessA ()</b> Funktion mit einem Parameter <b>svchost.exe es &lt;% param%&gt;</b> </li></ol><br>  Dabei ist <b>&lt;% param%&gt;</b> 16 Byte in der Zeichenfolgendarstellung und wird wie folgt gef√ºllt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4o/st/i2/4osti2buinqlg7gegp8decyoiio.png" alt="Bild"></div><br>  Unmittelbar nach dem Start pr√ºft das VNC-Modul, <b>ob der Schalter -s vorhanden ist. Anschlie√üend</b> liest es den √ºbergebenen Parameter und pr√ºft die Bedingung: <br><pre><code class="cpp hljs">paramValue[<span class="hljs-number"><span class="hljs-number">0</span></span>] == paramValue[<span class="hljs-number"><span class="hljs-number">1</span></span>] ^ (paramValue[<span class="hljs-number"><span class="hljs-number">3</span></span>] | (paramValue[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>))</code> </pre> <br>  Mit der Funktion <b>DuplicateHandle ()</b> wird eine Kopie des Socket-Handles f√ºr die weitere Interaktion mit dem Server erstellt. <br><br>  Der Parameter <b>StartupInfo der</b> Funktion <b>CreateProcessA ()</b> enth√§lt den Namen des speziell generierten Desktop'a: <b>Standard &lt;% flag%&gt;</b> .  Au√üerdem wird die Adresse des VNC-Moduls vor dem Funktionsaufruf im Parameter <b>ProcessInformation</b> abgelegt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/na/fd/zu/nafdzutb3bptvxfmbis9ver33v8.png" alt="Bild"></div><br><br>  Wie aus der Liste hervorgeht, verf√ºgt IcedID √ºber eine breite Palette von Funktionen zur vollst√§ndigen Kontrolle des infizierten Computers.  Selbst wenn der Bediener auf das Problem des Fehlens einer Funktion st√∂√üt, l√§dt er einfach mit Hilfe eines Trojaners ein anderes Programm herunter und f√ºhrt die ihm zugewiesenen Aufgaben aus.  Zum Beispiel haben wir Ende Dezember 2017 die Verteilung von TrickBot durch diesen Bankier aufgezeichnet. <br><br><h3>  Konfigurationsinformationen </h3><br><h4>  Generierung von Namen f√ºr Registrierungseintr√§ge </h4><br>  Alle Konfigurationsdaten, die das Programm vom Server empf√§ngt, werden in der Registrierung des infizierten Ger√§ts gespeichert (mit Ausnahme des VNC-Moduls, das im Verzeichnis% TEMP% im Format <b>tmp% 0.8X01.dat gespeichert ist</b> ). <br><br>  Die Namen der Registrierungsschl√ºssel, in denen die f√ºr uns interessanten Konfigurationsdaten gespeichert sind, werden mit der folgenden Funktion berechnet: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v5/bf/nj/v5bfnjuhkwpc3koekqfmclrrffk.png" alt="Bild"></div><br>  Wie Sie der Abbildung entnehmen k√∂nnen, ist der Schl√ºsselname ein MD5-Hashwert aus zwei Variablen - <b>str</b> und <b>computerSeed</b> .  Welcher Datentyp in der Registrierungsvariablen gespeichert ist, h√§ngt vom Wert der ersten Variablen ab.  Bei einem Variablenwert von <b>* cfg0</b> oder <b>* cfg1</b> speichert der Registrierungsschl√ºssel beispielsweise Web-Injects, bei einem Wert von <b>* rtd</b> speichert <b>der</b> Schl√ºssel eine CnC-Liste. <br><br>  <b>computerSeed</b> ist eine benutzerspezifische Variable.  Sie wird basierend auf der SID des Benutzers berechnet.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript</a> bietet eine Python-Version der Berechnung dieser Variablen. <br><br>  Vollst√§ndiger Pfad zu Konfigurationseintr√§gen in der Registrierung: <br><br><blockquote>  HKEY_CLASSES_ROOT \ CLSID \ &lt;% MD5-Wert im Format: {% 0.8X-% 0.4X-% 0.4X-% 0.4X-% 0.4X% 0.8X}%&gt; <br></blockquote><br>  Der oben beschriebene Algorithmus ist genau der Algorithmus zum Erzeugen des Namens <b>IcedID_reg ()</b> , der oben wiederholt erw√§hnt wurde. <br><br>  Wir haben die folgenden Zeichenfolgenwerte gefunden, die beim Generieren von Registrierungsnamen von Informationen beteiligt sind, die f√ºr den Bankier wichtig sind: <br><br><ul><li>  <b>* cfg0</b> - enth√§lt eine allgemeine Liste von Web-Injects </li><li>  <b>* cfg1</b> - enth√§lt eine Liste von Adressen und Zeichenfolgen, um Seitendaten vollst√§ndig zu stehlen </li><li>  <b>* rtd</b> - eine Liste von CnC-Adressen </li><li>  <b>* bc *</b> - benachrichtigt den Status des Moduls zur Verarbeitung erweiterter Befehle vom Server.  Wenn sich dieser Eintrag in der Registrierung befindet, wird das Modul ausgef√ºhrt </li><li>  <b>* p *</b> - speichert <b>Startparameter</b> mit den Tasten <b>--svc =</b> und <b>/ w =</b> </li></ul><br><h4>  Speicherstruktur dynamischer Konfigurationsdateien </h4><br>  Dynamische Konfigurationen werden in verschl√ºsselter Form in der Registrierung gespeichert.  Der VNC-Server, der sich im Verzeichnis% TEMP% befindet, wird auf die gleiche Weise verschl√ºsselt. <br><br>  F√ºr die Datenverschl√ºsselung werden zwei Algorithmen verwendet: der propriet√§re Trojaner-Algorithmus und RC4.  Entschl√ºsselungsalgorithmus-Schema: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j8/2j/g8/j82jg8lcmeg3l9tv9cmge5erbbs.png" alt="Bild"></div><br>  Gehen wir von der Theorie zur Praxis.  Anfangs verschl√ºsselte Daten nach dem Lesen aus der Registrierung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q5/2f/7r/q52f7rrl9zsv9wqv9lf6anr9-hq.png" alt="Bild"></div><br>  Nach dem Empfang der Daten entschl√ºsselt die Malware sie mit einem eigenen Algorithmus: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ji/fx/ik/jifxik3og5ezrfp9wufshxhbc5k.png" alt="Bild"></div><br>  Und wieder treffen wir die Funktion <b>make_seed ()</b> ! <br><br>  Nach der Entschl√ºsselung haben wir (achten Sie auf die Adressen - es wird im gleichen Speicherbereich entschl√ºsselt): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ok/-1/ek/ok-1ek0zschromjam2tbv2am-um.png" alt="Bild"></div><br>  Nach der zweiten Entschl√ºsselung im Speicher sehen wir Folgendes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kx/ct/nb/kxctnbronnbv-hovhydbmqb9wx4.png" alt="Bild"></div><br>  Nachdem die Daten entpackt und analysiert wurden.  Es ist bemerkenswert, dass die Daten vor dem Freigeben von Daten mit RC4 zur√ºckverschl√ºsselt werden - Schutz vor dynamischer Analyse der Anwendung. <br><br>  Die weitere Datenstruktur h√§ngt von der Art der Konfigurationsdaten ab.  Beispielsweise werden Konfigurationsdaten mit dem Pr√§fix <b>rtd</b> im folgenden Format gespeichert: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CNCStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> signedMD5sum[<span class="hljs-number"><span class="hljs-number">128</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checksum; BStrings cnc[N]; } CNCStruct; <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BStrings</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> str[length]; } BStrings;</code> </pre><br>  Liste der CnC-Adressen in einer Studie: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ne/xi/ta/nexitapjnsiyirmq7heoidb2jcw.png" alt="Bild"></div><br>  Vor dem Zugriff auf die CnC-Adressen aus der empfangenen Liste √ºberpr√ºft der Bot die digitale Signatur.  Der √∂ffentliche Schl√ºssel zur √úberpr√ºfung der Signatur wird in verschl√ºsselter Form im K√∂rper des Bots gespeichert.  Nach dem Verfahren zur √úberpr√ºfung der Signatur ‚Äû√ºberschreibt‚Äú die Anwendung den √∂ffentlichen Schl√ºssel, zuerst mit zuf√§lligen Daten und dann mit Nullen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oa/ns/tt/oansttaenay3ehss5praybpcenw.png" alt="Bild"></div><br>  Konfigurationen mit dem Pr√§fix <b>cfg</b> werden im folgenden Format gespeichert: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CfgStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checksum; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> elements_count; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> config[]; } CfgStruct;</code> </pre> <br>  Im untersuchten Fall haben wir folgende Daten gesehen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o3/wj/qp/o3wjqphnlymrn0yeydqqsxu8-ca.png" alt="Bild"></div><br>  Die Daten werden in einem eindeutigen Bin√§rformat gespeichert, auf das sp√§ter noch eingegangen wird. <br><br>  Sie k√∂nnen den Algorithmus zum Generieren von Registrierungsschl√ºsseln und zum Entschl√ºsseln von Konfigurationsdaten in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript anzeigen</a> . <br><br><h4>  Algorithmus zum Parsen von Konfigurationsdaten </h4><br>  Nach dem Entschl√ºsseln der Daten analysiert das Programm sie und speichert sie in Form einer verkn√ºpften Liste, die sp√§ter an der Analyse des Datenverkehrs auf dem infizierten Ger√§t (MITB) teilnimmt.  Zun√§chst werden die Daten in Bl√∂cke mit folgender Struktur unterteilt: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseBlock</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> type; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> global_flag; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> data[size - <span class="hljs-number"><span class="hljs-number">6</span></span>]; } BaseBlock;</code> </pre> <br>  Die Struktur des <b>Datenfeldes</b> h√§ngt vom <b>Typ-</b> Flag ab.  Das Flag in dieser Struktur gibt an, was passiert, wenn eine Zeichenfolge in der URL / im Hauptteil der Anforderung gefunden wird.  Das Feld kann folgende Werte annehmen: <br><br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>Flagge</nobr> </th><th>  Wert </th></tr><tr><td>  0x10 </td><td>  Teilweises Ersetzen des Seitenk√∂rpers als Parameter - Tags, zwischen denen ersetzt werden muss, sowie der Wert, durch den der K√∂rper ersetzt wird <br></td></tr><tr><td>  <nobr>0x11.0x13</nobr> </td><td>  Teilweises Ersetzen des Seitenk√∂rpers als Parameter - der Teil der Seite, der ersetzt werden muss, sowie der Wert, durch den der K√∂rper ersetzt wird <br></td></tr><tr><td>  0x12 </td><td>  Ganzseitiger K√∂rperersatz <br></td></tr><tr><td>  0x20 </td><td>  Diebstahl des Seitenk√∂rpers.  Als Parameter - Tags, zwischen denen sich ein interessierender Seitenabschnitt befindet </td></tr><tr><td>  0x21 </td><td>  Ganzseitiger Diebstahl </td></tr><tr><td>  0x22 </td><td>  Vollst√§ndiger Diebstahl des Seitenk√∂rpers, der K√∂rper wird in der Registrierung gespeichert </td></tr><tr><td>  0x2E </td><td>  Suchen Sie im Seitenk√∂rper nach Zeilen mit den Tags 0x40 und 0x41, falls diese erkannt werden - Diebstahl des Seitenk√∂rpers </td></tr><tr><td>  0x30 </td><td>  Blockierung anfordern </td></tr><tr><td>  0x31 </td><td>  Machen Sie einen Screenshot der Seite </td></tr><tr><td>  <nobr>0x32,0x33</nobr> </td><td>  Auf eine andere Seite umleiten (der Pfad zur Seite ist einer der Parameter).  Au√üerdem ist der Parameter die Zeichenfolge <b>&lt;% Registry Salt%&gt; # &lt;% URL%&gt;</b> , der Bot greift auf <b>&lt;% URL%&gt; zu</b> , l√§dt Daten von dort und speichert sie dann mit dem Schl√ºssel <b>IcedID_reg (&lt;% Registry Salt%&gt;)</b> in der Registrierung. </td></tr><tr><td>  0x34 </td><td>  Auf eine andere Seite umleiten (der Pfad zur Seite ist einer der Parameter) </td></tr><tr><td>  <nobr>0x40,0x41</nobr> </td><td>  Body-Strings im Seitenk√∂rper </td></tr><tr><td>  0x51 </td><td>  Seite ignorieren </td></tr><tr><td>  0x60 </td><td>  Speichern Sie den Wert der Variablen in der Registrierung (ersetzt den Seitenk√∂rper durch "True" oder "False", je nach Ergebnis des Befehls. Der Name wird basierend auf dem oben beschriebenen Algorithmus generiert.) </td></tr><tr><td>  0x61 </td><td>  Demonstrieren Sie eine Variable aus der Registrierung (der Name wird basierend auf dem oben beschriebenen Algorithmus generiert). </td></tr><tr><td>  0x62 </td><td>  L√∂schen Sie eine Variable aus der Registrierung (ersetzt den Seitenk√∂rper durch "True" oder "False", abh√§ngig vom Ergebnis des Befehls. Der Name wird basierend auf dem oben beschriebenen Algorithmus generiert.) </td></tr><tr><td>  0x63 </td><td>  F√ºhren Sie das erweiterte Modul zum Verarbeiten von Befehlen vom Server aus (ersetzt den Seitenk√∂rper je nach Ergebnis des Befehls durch "True" oder "False"). </td></tr><tr><td>  0x64 </td><td>  Speichern Sie den Seitenk√∂rper im Speicher des Bots (ersetzt den Seitenk√∂rper je nach Ergebnis des Befehls durch "True" oder "False"). </td></tr></tbody></table></div>  Die Struktur des <b>Datenfelds</b> , wenn der <b>Typ</b> 0x40 oder 0x41 ist: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConfigBlock</span></span></span><span class="hljs-class"> {</span></span> BStrings patterns[N]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } ConfigBlock;</code> </pre> <br>  Ansonsten ist die Feldstruktur: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseBlock</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> typeSizeStr; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> urlStr; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> flagSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> flag[flagSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> firstOptStr[firstOptStrSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> secondOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> secondOptStr[secondOptStrSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> thirdOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> thirdOptStr[thirdOptStrSize]; } BaseBlock;</code> </pre> <br>  Schauen wir uns einen der Beispielbl√∂cke genauer an: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k2/um/x_/k2umx_oc-ftptuundim8rft1yaw.png" alt="Bild"></div><br>  Beachten Sie zun√§chst das Feld "Config block type" im Block "Config block common information".  Es ist 0x11, was bedeutet, dass beim Laden einer Seite, deren URL unter die Regel f√ºr regul√§re Ausdr√ºcke f√§llt <b>^ [^ =] * \ / wcmfd \ / wcmpw \ / CustomerLogin $</b> , die Zeile <b>&lt;body</b> (zweites Argument) durch die Zeile <b>&lt;ersetzt wird body style = "Anzeige: keine;"</b>  (drittes Argument). <br><br>  Im Anwendungsspeicher wird f√ºr jeden Typ eine verkn√ºpfte Liste erstellt.  Der Parsing-Algorithmus f√ºr verkn√ºpfte Listen ist in der folgenden Abbildung als IDA Pro-Bildschirm dargestellt.  Sie k√∂nnen das Python-Skript f√ºr die Konfigurationsdaten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier sehen</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e9/5m/ke/e95mkeu6eqisfys7fnhe63fqvtg.png" alt="Bild"></div><br><h3>  CnC-Informationen </h3><br>  Nach mehreren Monaten der √úberwachung der Entwicklung von IcedID haben wir viele Dom√§nen gefunden, die der Trojaner in die Liste der dynamischen Konfigurationen im Abschnitt CnC aufgenommen hat.  Wir werden Domains in Form von Korrespondenz vertreten (E-Mail, von der aus die Registrierung erfolgte ‚Üí Domain): <br><div class="scrollable-table"><table><tbody><tr><th>  <nobr>Mail</nobr> </th><th>  Dom√§nen </th></tr><tr><td>  davidphugley@jourrapide.com </td><td>  percalabia.com <br>  borrespons.com <br>  scheidung.com <br>  eyrannon.com <br>  britically.com <br></td></tr><tr><td>  joshuastaube@dayrep.com </td><td>  manismay.com <br>  Deterhood.com <br>  marrivate.com <br>  greatoric.com <br>  phonetarif.com <br></td></tr><tr><td>  CynthiaTHeller@grr.la </td><td>  binncu.net </td></tr><tr><td>  PatriceAAdams@grr.la </td><td>  arcadyflyff.com </td></tr><tr><td>  LindaJRowan@dayrep.com </td><td>  yutlitsi.com </td></tr><tr><td>  SeanHumphreys@pokemail.net </td><td>  urnachay.com </td></tr><tr><td>  RuthFThigpen@pokemail.net </td><td>  oksigur.net </td></tr><tr><td>  FlorenceTButler@pokemail.net </td><td>  rfisoty.com </td></tr><tr><td>  FreidaDDelgado@pokemail.net </td><td>  urnisim.net </td></tr><tr><td>  TinaLHobson@grr.la </td><td>  cupicratings.com </td></tr><tr><td>  ElisaRTucker@pokemail.net </td><td>  freegameshacks.net </td></tr><tr><td>  DaleKMontes@pokemail.net </td><td>  gordondeen.net </td></tr><tr><td>  patrickggutierez@dayrep.com </td><td>  Poorloo.com <br>  dismissey.com <br>  euphratt.com <br>  detrole.com <br></td></tr><tr><td>  JustineRBoatner@pokemail.net </td><td>  lumpyve.com </td></tr><tr><td>  MatthewAPerkins@grr.la </td><td>  gooblesooq.com <br>  fzlajsf.net <br></td></tr><tr><td>  JosephLSmith@grr.la </td><td>  newpctoday.com <br>  triodgt.com <br></td></tr><tr><td>  DominicNDecker@pokemail.net </td><td>  onsunga.net </td></tr><tr><td>  MarcellaBCraighead@pokemail.net </td><td>  rybatas.com </td></tr><tr><td>  KellyJMaldonado@grr.la </td><td>  netocraze.net <br>  irtazin.net <br></td></tr></tbody></table></div><br>  Schauen wir uns nun die Benutzer genauer an, bei denen die Domains registriert wurden: <br><br><div class="spoiler">  <b class="spoiler_title">Informationen zu Registranten</b> <div class="spoiler_text">  E-Mail <b>davidphugley@jourrapide.com</b> : <br><br><ul><li>  Registrar: PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li>  Name: David P. Hugley (Registrant, Administrator, Techniker) </li><li>  Stra√üe: 2453 Round Table Drive (Registrant, Administrator, Techniker) </li><li>  Stadt: Hamilton (Registrant, Administrator, Techniker) </li><li>  Bundesstaat: Ohio (Registrant, Administrator, Techniker) </li><li>  Post: 45011 (Registrant, Administrator, Techniker) </li><li>  Land: USA (Registrant, Administrator, Techniker) </li><li>  Telefon: 15138878784 (Registrant, Administrator, Techniker) </li></ul><br>  E-Mail an <b>joshuastaube@dayrep.com</b> : <br><br><ul><li>  Registrar: PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li>  Name: Joshua S. Taube (Registrant, Administrator, Techniker) </li><li>  Organisation: </li><li>  Stra√üe: 2173 Kyle Street (Registrant, Administrator, Techniker) </li><li>  Stadt: Hay Springs (Registrant, Administrator, Techniker) </li><li>  Bundesstaat: Nevada (Registrant, Administrator, Techniker) </li><li>  Post: 69347 (Registrant, Administrator, Techniker) </li><li>  Land: USA (Registrant, Administrator, Techniker) </li><li>  Telefon: 13086385612 (Registrant, Administrator, Techniker) </li></ul><br>  E-Mail <b>CynthiaTHeller@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Cynthia Heller (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 396 Tennessee Avenue (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Southfield (Registrant, Administrator, Abrechnung, Technik) </li><li>  Status: MX (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 48034 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 12482469621 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>PatriceAAdams@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Patrice Adams (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation </li><li>  Stra√üe: 3997 Marietta Street (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Cazadero (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: JL (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 95421 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 17076322681 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>LindaJRowan@dayrep.com</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Linda Rowan (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 1908 Luke Lane (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Elk City (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: EK (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 73644 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 15802259140 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail an <b>SeanHumphreys@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Sean Humphreys (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation: </li><li>  Stra√üe: 4661 Kincheloe Road (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Portland (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: EL (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 97205 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 16384273711 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>RuthFThigpen@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Ruth Thigpen (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation </li><li>  Stra√üe: 765 Michael Street (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Houston (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: DK (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 77021 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 17137485876 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail an <b>FlorenceTButler@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Florence Butler (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 4554 Par Drive (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Lompoc (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: JL (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 93436 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 198058660048 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail an <b>FreidaDDelgado@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Freida Delgado (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 4439 Burning Memory Lane (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Philadelphia (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: BX (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 19115 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 12153306416 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>TinaLHobson@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Tina Hobson (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 3960 Woodridge Lane (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Memphis (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: TN (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 38110 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 19012994734 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail an <b>ElisaRTucker@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Elisa Tucker (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation </li><li>  Stra√üe: 3316 Corbin Branch Road (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Johnson City (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: TN (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 37601 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 14234332211 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail an <b>DaleKMontes@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Dale Montes (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation: </li><li>  Stra√üe: 2719 Norman Street (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Los Angeles (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: JL (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 90008 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 13232919311 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>patrickggutierez@dayrep.com</b> : <br><br><ul><li>  Registrar: PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li>  Name: Patrick G. Gutierez (Registrant, Administrator, Techniker) </li><li>  Organisation: </li><li>  Stra√üe: 1146 Mount Olive Road (Registrant, Administrator, Techniker) </li><li>  Stadt: Atlanta (Registrant, Administrator, Techniker) </li><li>  Bundesstaat: Georgia (Registrant, Administrator, Techniker) </li><li>  Post: 30328 (Registrant, Administrator, Techniker) </li><li>  Land: USA (Registrant, Administrator, Techniker) </li><li>  Telefon: 16789874672 (Registrant, Administrator, Techniker) </li></ul><br>  E-Mail <b>JustineRBoatner@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Justine Boatner (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 2875 Kemper Lane (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Kearns (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: YT (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 84118 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 18019026902 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>MatthewAPerkins@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Matthew Perkins (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation: </li><li>  Stra√üe: 2507 Locust Street (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Ellaville (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: QZ (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 31806 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 12299379022 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>JosephLSmith@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Joseph Smith (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation: </li><li>  Stra√üe: 2808 Ruckman Road (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Oklahoma City (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: EK (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 73102 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 14058506091 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>DominicNDecker@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Dominic Decker (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation: </li><li>  Stra√üe: 1169 Golden Ridge Road (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Gloversville (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: NY (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 12078 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 15187485876 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>MarcellaBCraighead@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Marcella Craighead (Registrantin, Administratorin, Abrechnung, Technikerin) </li><li>  Organisation: </li><li>  Stra√üe: 1659 Lilac Lane (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Savannah (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesland: QZ (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 31401 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 19125956971 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br>  E-Mail <b>KellyJMaldonado@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Kelly Maldonado (Registrant, Administrator, Abrechnung, Technik) </li><li>  Organisation: NA </li><li>  Stra√üe: 4391 Ben Street (Registrant, Administrator, Abrechnung, Technik) </li><li>  Stadt: Albany (Registrant, Administrator, Abrechnung, Technik) </li><li>  Bundesstaat: NY (Registrant, Administrator, Abrechnung, Technik) </li><li>  Post: 12207 (Registrant, Administrator, Abrechnung, Technik) </li><li>  Land: USA (Registrant, Administrator, Abrechnung, Technik) </li><li>  Telefon: 15182623616 (Registrant, Administrator, Abrechnung, Technik) </li></ul><br></div></div><br>  Betrachten Sie abschlie√üend die Chronologie der √Ñnderung der Dom√§nen-IP-Adressen.  Alle IP-Adressen wurden der Tabelle seit November 2017 hinzugef√ºgt: <br><br><div class="spoiler">  <b class="spoiler_title">IP-Adresstabelle</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th>  Domain </th><th>  IP </th><th>  Land </th><th>  Zum ersten Mal in freier Wildbahn gesehen </th></tr><tr><td>  gooblesooq.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  07/11/2017 </td></tr><tr><td>  irtazin.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  07/11/2017 </td></tr><tr><td>  netocraze.net </td><td>  185.5.251.33 </td><td>  RU </td><td>  07/11/2017 </td></tr><tr><td>  triodgt.com </td><td>  185.5.251.33 </td><td>  RU </td><td>  07/11/2017 </td></tr><tr><td>  newpctoday.com </td><td>  185.5.251.33 </td><td>  RU </td><td>  07/11/2017 </td></tr><tr><td>  fzlajsf.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  25.11.2017 </td></tr><tr><td>  netocraze.net </td><td>  185,48,56,139 </td><td>  Nl </td><td>  27.11.2017 </td></tr><tr><td>  triodgt.com </td><td>  185,48,56,139 </td><td>  Nl </td><td>  27.11.2017 </td></tr><tr><td>  newpctoday.com </td><td>  185,48,56,139 </td><td>  Nl </td><td>  29.11.2017 </td></tr><tr><td>  netocraze.net </td><td>  185.22.65.17 </td><td>  KZ </td><td>  01.12.2017 </td></tr><tr><td>  triodgt.com </td><td>  185.22.65.17 </td><td>  KZ </td><td>  01.12.2017 </td></tr><tr><td>  newpctoday.com </td><td>  185.22.65.17 </td><td>  KZ </td><td>  01.12.2017 </td></tr><tr><td>  gordondeen.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  11/11/2017 </td></tr><tr><td>  netocraze.net </td><td>  46.148.26.106 </td><td>  UA </td><td>  11/11/2017 </td></tr><tr><td>  arcadyflyff.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/12/2017 </td></tr><tr><td>  cupicratings.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/12/2017 </td></tr><tr><td>  freegameshacks.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  12/12/2017 </td></tr><tr><td>  newpctoday.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/12/2018 </td></tr><tr><td>  onsunga.net </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/12/2017 </td></tr><tr><td>  oksigur.net </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/12/2017 </td></tr><tr><td>  rfisoty.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/12/2017 </td></tr><tr><td>  rybatas.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/12/2017 </td></tr><tr><td>  urnachay.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/12/2017 </td></tr><tr><td>  rfisoty.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  24.01.2008 </td></tr><tr><td>  rybatas.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  24.01.2008 </td></tr><tr><td>  urnachay.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  24.01.2008 </td></tr><tr><td>  yutlitsi.com </td><td>  185.127.26.227 </td><td>  RU </td><td>  24.01.2008 </td></tr><tr><td>  urnisim.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  24.01.2008 </td></tr><tr><td>  oksigur.net </td><td>  185.127.26.227 </td><td>  RU </td><td>  26.01.2008 </td></tr><tr><td>  urnachay.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  31.01.2008 </td></tr><tr><td>  oksigur.net </td><td>  109.234.35.121 </td><td>  RU </td><td>  31.01.2008 </td></tr><tr><td>  yutlitsi.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/2/2018 </td></tr><tr><td>  urnisim.net </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/2/2018 </td></tr><tr><td>  scheidung.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  21.02.2008 </td></tr><tr><td>  percalabia.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  22.02.2008 </td></tr><tr><td>  borrespons.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  26.02.2008 </td></tr><tr><td>  britically.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  26.02.2008 </td></tr><tr><td>  eyrannon.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  26.02.2008 </td></tr><tr><td>  Deterhood.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/3/2018 </td></tr><tr><td>  greatoric.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/3/2018 </td></tr><tr><td>  manismay.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/3/2018 </td></tr><tr><td>  marrivate.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  1/3/2018 </td></tr><tr><td>  moindal.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/3/2018 </td></tr><tr><td>  phonetarif.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/3/2018 </td></tr><tr><td>  moindal.com </td><td>  185.169.229.119 </td><td>  CH </td><td>  3/5/2018 </td></tr><tr><td>  dismissey.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  3/4/2018 </td></tr><tr><td>  euphratt.com </td><td>  109.234.35.121 </td><td>  RU </td><td>  4/4/2018 </td></tr><tr><td>  percalabia.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  3/4/2018 </td></tr><tr><td>  Deterhood.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  24.04.2008 </td></tr><tr><td>  eyrannon.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  24.04.2008 </td></tr><tr><td>  greatoric.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  24.04.2008 </td></tr><tr><td>  marrivate.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  24.04.2008 </td></tr><tr><td>  euphratt.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  25.04.2008 </td></tr><tr><td>  borrespons.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  07.05.2008 </td></tr><tr><td>  britically.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  07.05.2008 </td></tr><tr><td>  dismissey.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  07.05.2008 </td></tr><tr><td>  scheidung.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  07.05.2008 </td></tr><tr><td>  rfisoty.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  07.05.2008 </td></tr><tr><td>  detrole.com </td><td>  109,236,87,25 </td><td>  Nl </td><td>  08.05.2008 </td></tr><tr><td>  manismay.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  08.05.2008 </td></tr><tr><td>  phonetarif.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  13.05.2008 </td></tr><tr><td>  binncu.net </td><td>  46.148.26.106 </td><td>  UA </td><td>  17.05.2008 </td></tr><tr><td>  urnisim.net </td><td>  46.148.26.11 </td><td>  UA </td><td>  17.05.2008 </td></tr><tr><td>  urnachay.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  18.05.2008 </td></tr><tr><td>  yutlitsi.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  18.05.2008 </td></tr><tr><td>  oksigur.net </td><td>  46.148.26.11 </td><td>  UA </td><td>  21.05.2008 </td></tr><tr><td>  greatoric.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  22.05.2008 </td></tr><tr><td>  marrivate.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  22.05.2008 </td></tr><tr><td>  percalabia.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  22.05.2008 </td></tr><tr><td>  urnachay.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  22.05.2008 </td></tr><tr><td>  yutlitsi.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  22.05.2008 </td></tr><tr><td>  lumpyve.com </td><td>  185,48,56,134 </td><td>  Nl </td><td>  24.05.2008 </td></tr><tr><td>  urnisim.net </td><td>  5.187.0.158 </td><td>  DE </td><td>  27.05.2008 </td></tr><tr><td>  borrespons.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  7/6/2018 </td></tr><tr><td>  manismay.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  7/6/2018 </td></tr><tr><td>  phonetarif.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  7/6/2018 </td></tr><tr><td>  rfisoty.com </td><td>  85.143.202.82 </td><td>  RU </td><td>  7/6/2018 </td></tr><tr><td>  borrespons.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  20.06.2008 </td></tr><tr><td>  manismay.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  20.06.2008 </td></tr><tr><td>  rfisoty.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  20.06.2008 </td></tr><tr><td>  lumpyve.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  20.06.2008 </td></tr><tr><td>  phonetarif.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  20.06.2008 </td></tr></tbody></table></div><br></div></div><br>  Nachdem wir die pr√§sentierten Daten untersucht haben, k√∂nnen wir zusammenfassen, dass alle Dom√§nen f√ºr E-Mails registriert sind, die mit dem tempor√§ren E-Mail-Dienst generiert wurden.  Der Standort des fiktiven Registranten befindet sich in den USA, w√§hrend sich die Domains selbst in Russland, der Ukraine, den Niederlanden, China, Kasachstan und Deutschland befinden (in letzter Zeit besteht die Tendenz, Domains in die Ukraine und nach Deutschland zu ‚Äûverschieben‚Äú).  Alle Domains befinden sich in den Domainzonen "com" und "net".  Das Alphabet, aus dem die Domain besteht, enth√§lt nur die Buchstaben des englischen Alphabets.  Auf der CnC-Seite wird der OpenResty-Webserver ausgel√∂st. <br><br><h2>  Fazit </h2><br>  Trotz der ‚ÄûAntike‚Äú zeus√§hnlicher Trojaner sinkt ihre Relevanz nicht.  Infolgedessen erscheint IcedID in der Arena der Trojaner, die sich an Bankkunden richten.  Obwohl der Bankier zu Beginn bereits eine umfangreiche Liste von M√∂glichkeiten hatte, verbessert er sich immer noch: Die Auspackmethoden werden immer komplizierter und die Liste der Ziele wird erweitert.  H√∂chstwahrscheinlich wird die Malware in Zukunft Anti-Analyse-Mechanismen erwerben, und der CnC-Server wird infizierten Ger√§ten selektiv Web-Injektionen geben.  In der Zwischenzeit erf√ºllen die Trojaner nicht alle Anforderungen ihrer "Benutzer", wie die Verwendung von TrickBot im Dezember zusammen mit IcedID zeigt. <br><br>  Group-IB wei√ü alles √ºber Cyberkriminalit√§t, erz√§hlt aber die interessantesten Dinge. <br><br>  Der actionreiche Telegrammkanal (https://t.me/Group_IB) √ºber Informationssicherheit, Hacker und Cyberangriffe, Hacktivisten und Internetpiraten.  Schrittweise Untersuchung sensationeller Cyberkriminalit√§t, praktische F√§lle mit Group-IB-Technologien und nat√ºrlich Empfehlungen, wie man im Internet kein Opfer wird. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">YouTube Channel</a> Group-IB <br>  Group-IB Photowire auf Instagram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.instagram.com/group_ib</a> <br>  Twitter Kurznachrichten twitter.com/GroupIB <br><br>  Group-IB ist einer der f√ºhrenden Entwickler von L√∂sungen zur Erkennung und Verhinderung von Cyberangriffen, zur Aufdeckung von Betrug und zum Schutz des geistigen Eigentums in einem Netzwerk mit Hauptsitz in Singapur. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418189/">https://habr.com/ru/post/de418189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418173/index.html">Roundtrip f√ºr neuronale Netze oder eine √úberpr√ºfung der Verwendung von Auto-Encodern in der Textanalyse</a></li>
<li><a href="../de418177/index.html">Bearbeiten von .heic-Bildern ohne Farbverlust</a></li>
<li><a href="../de418183/index.html">Anwendung der Sprachanalyse in der Wirtschaft</a></li>
<li><a href="../de418185/index.html">Eine Autopsie-Geschichte: Wie wir Hancitor r√ºckg√§ngig gemacht haben</a></li>
<li><a href="../de418187/index.html">In Amerika wurde vorgeschlagen, alle Bibliotheken durch Amazon-Hubs zu ersetzen. Die √ñffentlichkeit ist emp√∂rt</a></li>
<li><a href="../de418191/index.html">Analoge in Python und JavaScript. Teil drei</a></li>
<li><a href="../de418193/index.html">Wie f√ºhlt es sich an, 2017 ein Spiel f√ºr Game Boy zu erstellen?</a></li>
<li><a href="../de418195/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 4: ‚ÄûPrivilegien teilen‚Äú, Teil 1</a></li>
<li><a href="../de418197/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 4: ‚ÄûPrivilegien teilen‚Äú, Teil 2</a></li>
<li><a href="../de418199/index.html">Wie man eine einfache technische Aufgabe macht und nicht Geld und Nerven verliert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>