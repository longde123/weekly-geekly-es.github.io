<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ  ğŸ‰ ğŸ˜¦ ç»„åˆ2Dä¸­çš„æœ‰ç¬¦å·è·ç¦»åœº âš•ï¸ ğŸ“£ ğŸ§œğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨ä¸Šä¸€æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨å¸¦ç¬¦å·çš„è·ç¦»å‡½æ•°åˆ›å»ºå’Œç§»åŠ¨ç®€å•å½¢çŠ¶ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç»„åˆå¤šä¸ªå½¢çŠ¶ä»¥åˆ›å»ºæ›´å¤æ‚çš„è·ç¦»åœºã€‚ æˆ‘ä»è·ç¦»å‡½æ•°çš„glsl-signåº“ä¸­å­¦ä¹ äº†è¿™é‡Œæè¿°çš„å¤§å¤šæ•°æŠ€æœ¯ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚ è¿˜æœ‰å‡ ç§ç»„åˆå½¢çŠ¶çš„æ–¹æ³•ï¼Œåœ¨æ­¤ä¸åšè®¨è®ºã€‚ 


 å‡†å¤‡å·¥ä½œ 
 ä¸ºäº†å¯è§†åŒ–å¸¦ç¬¦å·è·ç¦»å­—æ®µï¼ˆ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç»„åˆ2Dä¸­çš„æœ‰ç¬¦å·è·ç¦»åœº</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438954/"> åœ¨ä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€æ•™ç¨‹ä¸­ï¼Œ</a>æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨å¸¦ç¬¦å·çš„è·ç¦»å‡½æ•°åˆ›å»ºå’Œç§»åŠ¨ç®€å•å½¢çŠ¶ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç»„åˆå¤šä¸ªå½¢çŠ¶ä»¥åˆ›å»ºæ›´å¤æ‚çš„è·ç¦»åœºã€‚ æˆ‘ä»è·ç¦»å‡½æ•°çš„glsl-signåº“ä¸­å­¦ä¹ äº†è¿™é‡Œæè¿°çš„å¤§å¤šæ•°æŠ€æœ¯ï¼Œå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚ è¿˜æœ‰å‡ ç§ç»„åˆå½¢çŠ¶çš„æ–¹æ³•ï¼Œåœ¨æ­¤ä¸åšè®¨è®ºã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n2/xg/4h/n2xg4h0rwnyo-k6s8f6yrkhihps.gif"></div><br><h2> å‡†å¤‡å·¥ä½œ </h2><br> ä¸ºäº†å¯è§†åŒ–å¸¦ç¬¦å·è·ç¦»å­—æ®µï¼ˆå¸¦ç¬¦å·è·ç¦»å­—æ®µï¼ŒSDFï¼‰ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ç§ç®€å•çš„é…ç½®ï¼Œç„¶åå°†è¿ç®—ç¬¦åº”ç”¨äºè¯¥é…ç½®ã€‚ ä¸ºäº†æ˜¾ç¤ºè·ç¦»åœºï¼Œå®ƒå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªæ•™ç¨‹ä¸­çš„è·ç¦»çº¿å¯è§†åŒ–ã€‚ ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†åœ¨ä»£ç ä¸­è®¾ç½®é™¤å¯è§†åŒ–å‚æ•°ä»¥å¤–çš„æ‰€æœ‰å‚æ•°ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ç”¨å±æ€§æ›¿æ¢ä»»ä½•å€¼ä»¥ä½¿å…¶å¯è‡ªå®šä¹‰ã€‚ <br><a name="habracut"></a><br> æˆ‘ä»¬å°†ä»ä»¥ä¸‹å†…å®¹å¼€å§‹çš„ä¸»è¦ç€è‰²å™¨å¦‚ä¸‹ï¼š <br><br><pre><code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"Tutorial/035_2D_SDF_Combinations/Champfer Union"</span></span>{ Properties{ _InsideColor(<span class="hljs-string"><span class="hljs-string">"Inside Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) _OutsideColor(<span class="hljs-string"><span class="hljs-string">"Outside Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) _LineDistance(<span class="hljs-string"><span class="hljs-string">"Mayor Line Distance"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) = <span class="hljs-number"><span class="hljs-number">1</span></span> _LineThickness(<span class="hljs-string"><span class="hljs-string">"Mayor Line Thickness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.05</span></span> [IntRange]_SubLines(<span class="hljs-string"><span class="hljs-string">"Lines between major lines"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) = <span class="hljs-number"><span class="hljs-number">4</span></span> _SubLineThickness(<span class="hljs-string"><span class="hljs-string">"Thickness of inbetween lines"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.05</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.01</span></span> } SubShader{ <span class="hljs-comment"><span class="hljs-comment">//the material is completely non-transparent and is rendered at the same time as the other opaque geometry Tags{ "RenderType"="Opaque" "Queue"="Geometry"} Pass{ CGPROGRAM #include "UnityCG.cginc" #include "2D_SDF.cginc" #pragma vertex vert #pragma fragment frag struct appdata{ float4 vertex : POSITION; }; struct v2f{ float4 position : SV_POSITION; float4 worldPos : TEXCOORD0; }; v2f vert(appdata v){ v2f o; //calculate the position in clip space to render the object o.position = UnityObjectToClipPos(v.vertex); //calculate world position of vertex o.worldPos = mul(unity_ObjectToWorld, v.vertex); return o; } float scene(float2 position) { const float PI = 3.14159; float2 squarePosition = position; squarePosition = translate(squarePosition, float2(1, 0)); squarePosition = rotate(squarePosition, .125); float squareShape = rectangle(squarePosition, float2(2, 2)); float2 circlePosition = position; circlePosition = translate(circlePosition, float2(-1.5, 0)); float circleShape = circle(circlePosition, 2.5); float combination = combination_function(circleShape, squareShape); return combination; } float4 _InsideColor; float4 _OutsideColor; float _LineDistance; float _LineThickness; float _SubLines; float _SubLineThickness; fixed4 frag(v2f i) : SV_TARGET{ float dist = scene(i.worldPos.xz); fixed4 col = lerp(_InsideColor, _OutsideColor, step(0, dist)); float distanceChange = fwidth(dist) * 0.5; float majorLineDistance = abs(frac(dist / _LineDistance + 0.5) - 0.5) * _LineDistance; float majorLines = smoothstep(_LineThickness - distanceChange, _LineThickness + distanceChange, majorLineDistance); float distanceBetweenSubLines = _LineDistance / _SubLines; float subLineDistance = abs(frac(dist / distanceBetweenSubLines + 0.5) - 0.5) * distanceBetweenSubLines; float subLines = smoothstep(_SubLineThickness - distanceChange, _SubLineThickness + distanceChange, subLineDistance); return col * majorLines * subLines; } ENDCG } } FallBack "Standard" //fallback adds a shadow pass so we get shadows on other objects }</span></span></code> </pre> <br> å’Œ2D_SDF.cgincå‡½æ•°ä½äºç€è‰²å™¨æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œæ‰©å±•ï¼Œé¦–å…ˆçœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> SDF_2D #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SDF_2D </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//transforms float2 rotate(float2 samplePosition, float rotation){ const float PI = 3.14159; float angle = rotation * PI * 2 * -1; float sine, cosine; sincos(angle, sine, cosine); return float2(cosine * samplePosition.x + sine * samplePosition.y, cosine * samplePosition.y - sine * samplePosition.x); } float2 translate(float2 samplePosition, float2 offset){ //move samplepoint in the opposite direction that we want to move shapes in return samplePosition - offset; } float2 scale(float2 samplePosition, float scale){ return samplePosition / scale; } //shapes float circle(float2 samplePosition, float radius){ //get distance from center and grow it according to radius return length(samplePosition) - radius; } float rectangle(float2 samplePosition, float2 halfSize){ float2 componentWiseEdgeDistance = abs(samplePosition) - halfSize; float outsideDistance = length(max(componentWiseEdgeDistance, 0)); float insideDistance = min(max(componentWiseEdgeDistance.x, componentWiseEdgeDistance.y), 0); return outsideDistance + insideDistance; } #endif</span></span></span></span></code> </pre> <br><h2> ç®€å•ç»„åˆ </h2><br> æˆ‘ä»¬å°†ä»å‡ ç§ç®€å•çš„æ–¹æ³•å¼€å§‹ï¼Œå°†ä¸¤ä¸ªå½¢çŠ¶ç»“åˆèµ·æ¥ä»¥åˆ›å»ºä¸€ä¸ªå¤§å½¢çŠ¶ï¼Œå…±è½­ï¼Œäº¤ç‚¹å’Œå‡æ³•ï¼Œä»¥åŠå°†ä¸€ä¸ªå½¢çŠ¶è½¬æ¢ä¸ºå¦ä¸€ç§å½¢çŠ¶çš„æ–¹æ³•ã€‚ <br><br><h3> é…å¯¹ </h3><br> æœ€ç®€å•çš„è¿ç®—ç¬¦æ˜¯é…å¯¹ã€‚ æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªå›¾å½¢æ”¾åœ¨ä¸€èµ·ï¼Œå¹¶è·å¾—å…·æœ‰è¿æ¥å›¾å½¢ç¬¦å·çš„è·ç¦»ã€‚ å½“æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ•°å­—çš„ç¬¦å·çš„è·ç¦»æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>min</code>å‡½æ•°å°†ä¸¤ä¸ªæ•°å­—ä¸­çš„è¾ƒå°è€…åˆå¹¶èµ·æ¥ã€‚ <br><br> ç”±äºé€‰æ‹©äº†ä¸¤ä¸ªå€¼ä¸­è¾ƒå°çš„ä¸€ä¸ªï¼Œå› æ­¤æœ€ç»ˆå›¾å½¢å°†ä½äº0ï¼ˆå¯è§ï¼‰ï¼Œå…¶ä¸­ä¸¤ä¸ªè¾“å…¥å›¾å½¢ä¹‹ä¸€ä¸è¾¹ç¼˜çš„è·ç¦»å°äº0ï¼› åŒæ ·é€‚ç”¨äºæ‰€æœ‰å…¶ä»–è·ç¦»å€¼ï¼Œæ˜¾ç¤ºä¸¤ä¸ªæ•°å­—çš„ç»„åˆã€‚ <br><br> åœ¨è¿™é‡Œï¼Œæˆ‘å°†å‘½åç”¨äºåˆ›å»ºå…±è½­â€œåˆå¹¶â€çš„å‡½æ•°ï¼Œéƒ¨åˆ†æ˜¯å› ä¸ºæˆ‘ä»¬æ­£åœ¨åˆå¹¶å®ƒä»¬ï¼Œéƒ¨åˆ†æ˜¯å› ä¸ºhlslä¸­çš„unionå…³é”®å­—æ˜¯ä¿ç•™çš„ï¼Œå› æ­¤å®ƒä¸èƒ½ç”¨ä½œå‡½æ•°çš„åç§°ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in 2D_SDF.cginc include file float merge(float shape1, float shape2){ return min(shape1, shape2); }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in scene function in shader float combination = merge(circleShape, squareShape);</span></span></code> </pre> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/66d/888/a58/66d888a586750b51cede307c21d61a40.png"></div><br><br><h3> äº¤å‰å£ </h3><br> è¿æ¥å½¢çŠ¶çš„å¦ä¸€ç§å¸¸ç”¨æ–¹æ³•æ˜¯ä½¿ç”¨ä¸¤ä¸ªå½¢çŠ¶é‡å çš„åŒºåŸŸã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å–è¦åˆå¹¶çš„ä¸¤ä¸ªå›¾å½¢çš„è·ç¦»çš„æœ€å¤§å€¼ã€‚ å½“ä½¿ç”¨ä¸¤ä¸ªå€¼ä¸­çš„æœ€å¤§å€¼æ—¶ï¼Œå¦‚æœåˆ°ä¸¤ä¸ªå›¾å½¢çš„ä»»ä½•è·ç¦»éƒ½åœ¨å›¾å½¢å¤–éƒ¨ï¼Œå¹¶ä¸”å…¶ä»–è·ç¦»ä¹Ÿä»¥ç›¸åŒçš„æ–¹å¼å¯¹é½ï¼Œåˆ™å¾—åˆ°çš„å€¼å¤§äº0ï¼ˆåœ¨å›¾å½¢å¤–éƒ¨ï¼‰ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in 2D_SDF.cginc include file float intersect(float shape1, float shape2){ return max(shape1, shape2); }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in scene function in shader float combination = intersect(circleShape, squareShape);</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f64/2be/6c0/f642be6c047b740e74f062cec23c3040.png"></div><br><h3> å‡æ³• </h3><br> ä½†æ˜¯ï¼Œé€šå¸¸æˆ‘ä»¬ä¸æƒ³ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†è¿™ä¸¤ä¸ªå½¢çŠ¶ï¼Œè€Œéœ€è¦ä»ä¸€ä¸ªå½¢çŠ¶ä¸­å‡å»å¦ä¸€ä¸ªå½¢çŠ¶ã€‚ é€šè¿‡åœ¨æˆ‘ä»¬è¦æ›´æ”¹çš„å½¢çŠ¶ä¸é™¤æˆ‘ä»¬è¦å‡å»çš„å½¢çŠ¶ä¹‹å¤–çš„æ‰€æœ‰å½¢çŠ¶ä¹‹é—´ç›¸äº¤ï¼Œè¿™å¾ˆå®¹æ˜“åšåˆ°ã€‚ å¯¹äºå›¾çš„å†…éƒ¨å’Œå¤–éƒ¨ï¼Œæˆ‘ä»¬å¾—åˆ°ç›¸åçš„å€¼ï¼Œå¹¶ç”¨ç¬¦å·åè½¬è·ç¦»ã€‚ è¯¥å›¾å¤–é¢çš„1ä¸ªå•ä½ç°åœ¨å˜æˆäº†é‡Œé¢çš„1ä¸ªå•ä½ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in 2D_SDF.cginc include file float subtract(float base, float subtraction){ return intersect(base, -subtraction); }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in scene function in shader float combination = subtract(squareShape, circleShape);</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/495/7b2/258/4957b2258a8b8f8724e7daf8ba503d64.png"></div><br><h3> æ’è¡¥ </h3><br> ç»„åˆä¸¤ä¸ªå›¾å½¢çš„ä¸€ç§æ˜æ˜¾æ–¹æ³•æ˜¯åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œæ’å€¼ã€‚ å…·æœ‰æ··åˆå½¢çŠ¶çš„å¤šè¾¹å½¢ç½‘æ ¼åœ¨æŸç§ç¨‹åº¦ä¸Šä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯æ¯”æˆ‘ä»¬å¯¹æœ‰ç¬¦å·è·ç¦»åœºçš„é™åˆ¶è¦å¤§å¾—å¤šã€‚ é€šè¿‡åœ¨ä¸¤ä¸ªå›¾å½¢çš„è·ç¦»ä¹‹é—´è¿›è¡Œç®€å•çš„æ’å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ä¸€ä¸ªå›¾å½¢å¹³ç¨³åœ°æµå…¥å¦ä¸€ä¸ªå›¾å½¢ã€‚ å¯¹äºæ’å€¼ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨<code>lerp</code>æ–¹æ³•ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in 2D_SDF.cginc include file float interpolate(float shape1, float shape2, float amount){ return lerp(shape1, shape2, amount); }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//in scene function in shader float pulse = sin(_Time.y) * 0.5 + 0.5; float combination = interpolate(circleShape, pulse);</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b06/3cf/2ec/b063cf2ece8b291553e941acc487f478.gif"></div><br><h2> å…¶ä»–åŒ–åˆç‰© </h2><br> æ”¶åˆ°ç®€å•çš„è¿æ¥åï¼Œæˆ‘ä»¬å·²ç»å…·å¤‡äº†ç®€å•åœ°ç»„åˆå›¾å½¢æ‰€éœ€çš„ä¸€åˆ‡ï¼Œä½†æ˜¯è·ç¦»ç¬¦å·å­—æ®µçš„æƒŠäººç‰¹æ€§æ˜¯æˆ‘ä»¬ä¸ä»…é™äºæ­¤ï¼Œå¯ä»¥é€šè¿‡å¤šç§ä¸åŒçš„æ–¹å¼ç»„åˆå›¾å½¢å¹¶åœ¨å…¶è¿æ¥å¤„æ‰§è¡Œæœ‰è¶£çš„æ“ä½œã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘å°†ä»…å†æ¬¡è§£é‡Šå…¶ä¸­çš„ä¸€äº›æŠ€æœ¯ï¼Œä½†æ˜¯æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://mercury.sexy/hg_sdf</a>åº“ä¸­æ‰¾åˆ°è®¸å¤šå…¶ä»–æŠ€æœ¯ï¼ˆå¦‚æœæ‚¨çŸ¥é“å…¶ä»–æœ‰ç”¨çš„SDFåº“ï¼Œè¯·å†™ä¿¡ç»™æˆ‘ï¼‰ã€‚ <br><br><h3> å››èˆäº”å…¥ </h3><br> æˆ‘ä»¬å¯ä»¥å°†ä¸¤ä¸ªç»„åˆå›¾å½¢çš„è¡¨é¢è§£é‡Šä¸ºåæ ‡ç³»ä¸­è¯¥ä½ç½®çš„xè½´å’Œyè½´ï¼Œç„¶åè®¡ç®—åˆ°è¯¥ä½ç½®çš„åæ ‡åŸç‚¹çš„è·ç¦»ã€‚ å¦‚æœè¿™æ ·åšï¼Œå°†å¾—åˆ°ä¸€ä¸ªéå¸¸å¥‡æ€ªçš„å›¾å½¢ï¼Œä½†æ˜¯å¦‚æœå°†è½´é™åˆ¶ä¸ºå°äº0çš„å€¼ï¼Œåˆ™å°†å¾—åˆ°ç±»ä¼¼äºä¸¤ä¸ªå›¾å½¢çš„å†…éƒ¨è·ç¦»çš„å¹³æ»‘å…±è½­çš„ä¸œè¥¿ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_merge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ float2 intersectionSpace = float2(shape1, shape2); intersectionSpace = min(intersectionSpace, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> length(intersectionSpace); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f76/a37/693/f76a37693bd0ac5aa8b7d41b784931a6.png"></div><br> è¿™å¾ˆæ¼‚äº®ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç”¨å®ƒæ¥æ›´æ”¹è·ç¦»ä¸º0çš„è¡Œï¼Œå› æ­¤æ­¤æ“ä½œæ²¡æœ‰æ¯”æ™®é€šé…å¯¹æ›´æœ‰ä»·å€¼ã€‚ ä½†æ˜¯åœ¨å°†ä¸¤ä¸ªæ•°å­—è”ç³»èµ·æ¥ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ç¨å¾®å¢åŠ ä¸€ç‚¹ã€‚ ä»¥ä¸åˆ›å»ºåœ†ç›¸åŒçš„æ–¹å¼ï¼Œè¦æ”¾å¤§å›¾å½¢ï¼Œè¯·ä»å…¶è·ç¦»ä¸­å‡å»å®ƒï¼Œä»¥ä¾¿è¿›ä¸€æ­¥æ¨å‡ºä¸€æ¡çº¿ï¼Œå…¶ä¸­å¸¦æœ‰ç¬¦å·çš„è·ç¦»ä¸º0ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> radius = max(<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Time.y * <span class="hljs-number"><span class="hljs-number">5</span></span>) * <span class="hljs-number"><span class="hljs-number">0.5</span></span> + <span class="hljs-number"><span class="hljs-number">0.4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> combination = round_intersect(squareShape, circleShape, radius);</code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_merge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ float2 intersectionSpace = float2(shape1 - radius, shape2 - radius); intersectionSpace = min(intersectionSpace, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> length(intersectionSpace); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e5f/507/a6d/e5f507a6dd0fb29da209c760889497fa.gif"></div><br> å®ƒåªæ˜¯æ”¾å¤§å›¾å½¢å¹¶ç¡®ä¿å†…éƒ¨å¹³æ»‘è¿‡æ¸¡ï¼Œä½†æˆ‘ä»¬ä¸æƒ³å¢åŠ å›¾å½¢ï¼Œæˆ‘ä»¬åªéœ€è¦å¹³æ»‘è¿‡æ¸¡å³å¯ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯åœ¨è®¡ç®—é•¿åº¦åå†æ¬¡å‡å»åŠå¾„ã€‚ é™¤äº†å›¾å½¢ä¹‹é—´çš„è¿‡æ¸¡ï¼ˆæ ¹æ®åŠå¾„è¿›è¡Œäº†å¹³æ»‘çš„å¹³æ»‘å¤„ç†ï¼‰å¤–ï¼Œå¤§å¤šæ•°é›¶ä»¶çš„å¤–è§‚ä¸ä»¥å‰ç›¸åŒã€‚ ç°åœ¨æˆ‘ä»¬å°†å¿½ç•¥è¯¥å›¾çš„å¤–éƒ¨ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_merge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ float2 intersectionSpace = float2(shape1 - radius, shape2 - radius); intersectionSpace = min(intersectionSpace, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> length(intersectionSpace) - radius; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b4b/09d/0d5/b4b09d0d5e0d0dd92a8c120225dbe73a.gif"></div><br> æœ€åä¸€æ­¥æ˜¯å¯¹å›¾çš„å¤–éƒ¨éƒ¨åˆ†çš„æ ¡æ­£ã€‚ å¦å¤–ï¼Œå›¾ä¸­çš„å†…éƒ¨ä¸ºç»¿è‰²ï¼Œè€Œå¤–éƒ¨åˆ™ä½¿ç”¨è¯¥é¢œè‰²ã€‚ ç¬¬ä¸€æ­¥æ˜¯ç®€å•åœ°é€šè¿‡ç”¨ç¬¦å·åè½¬å®ƒä»¬çš„è·ç¦»æ¥äº¤æ¢å¤–éƒ¨å’Œå†…éƒ¨é›¶ä»¶ã€‚ ç„¶åæˆ‘ä»¬æ›¿æ¢å‡å»åŠå¾„çš„éƒ¨åˆ†ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†å…¶ä»å‡æ³•æ›´æ”¹ä¸ºåŠ æ³•ã€‚ è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºåœ¨ä¸åŠå¾„ç»„åˆä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»˜åˆ¶äº†çŸ¢é‡çš„è·ç¦»ï¼Œå› æ­¤ï¼Œæ ¹æ®æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åè½¬æ‰€ä½¿ç”¨çš„æ•°å­¦è¿ç®—ã€‚ ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¸¸è§„é…åˆæ›¿æ¢åŠå¾„ï¼Œè¿™å°†ä¸ºæˆ‘ä»¬æä¾›å›¾å½¢å¤–éƒ¨çš„æ­£ç¡®å€¼ï¼Œä½†ä¸ä¼šé è¿‘å›¾å½¢çš„è¾¹ç¼˜å’Œå†…éƒ¨ã€‚ ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åœ¨å€¼å’ŒåŠå¾„ä¹‹é—´å–æœ€å¤§å€¼ï¼Œä»è€Œåœ¨å›¾å½¢å¤–éƒ¨è·å¾—æ­£ç¡®å€¼çš„æ­£å€¼ï¼Œå¹¶åœ¨å›¾å½¢å†…éƒ¨è·å¾—æ‰€éœ€çš„åŠå¾„ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_merge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ float2 intersectionSpace = float2(shape1 - radius, shape2 - radius); intersectionSpace = min(intersectionSpace, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> insideDistance = -length(intersectionSpace); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> simpleUnion = merge(shape1, shape2); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> outsideDistance = max(simpleUnion, radius); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> insideDistance + outsideDistance; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5e/079/968/b5e079968ff81efdccdde19d7a07aeeb.gif"></div><br> è¦åˆ›å»ºç›¸äº¤ï¼Œæˆ‘ä»¬éœ€è¦åšç›¸åçš„äº‹æƒ…-å°†å›¾å½¢å‡å°åŠå¾„ï¼Œç¡®ä¿çŸ¢é‡çš„æ‰€æœ‰åˆ†é‡éƒ½å¤§äº0ï¼Œé‡‡ç”¨é•¿åº¦ä¸”ä¸æ›´æ”¹å…¶ç¬¦å·ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå›¾çš„å¤–éƒ¨ã€‚ ç„¶åï¼Œè¦åˆ›å»ºå†…éƒ¨é›¶ä»¶ï¼Œæˆ‘ä»¬é‡‡ç”¨é€šå¸¸çš„ç›¸äº¤å¹¶ç¡®ä¿å…¶ä¸å°äºåŠå¾„ã€‚ ç„¶åï¼Œåƒä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬æ·»åŠ å†…éƒ¨å’Œå¤–éƒ¨å€¼ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ float2 intersectionSpace = float2(shape1 + radius, shape2 + radius); intersectionSpace = max(intersectionSpace, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> outsideDistance = length(intersectionSpace); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> simpleIntersection = intersect(shape1, shape2); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> insideDistance = min(simpleIntersection, -radius); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outsideDistance + insideDistance; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/326/08f/268/32608f2685455f44a602a2c5ad12babf.gif"></div><br> æœ€åä¸€ç‚¹ï¼Œå‡æ³•å¯ä»¥å†æ¬¡æè¿°ä¸ºåŸºæœ¬å›¾å½¢ä¸é™¤æˆ‘ä»¬è¦å‡å»çš„å›¾å½¢ä»¥å¤–çš„æ‰€æœ‰å›¾å½¢ä¹‹é—´çš„äº¤é›†ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_subtract</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> base, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> subtraction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ round_intersect(base, -subtraction, radius); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/888/6b6/ea9/8886b6ea90411b4cffdf901160498de5.gif"></div><br> åœ¨è¿™é‡Œï¼Œå°¤å…¶æ˜¯åœ¨è¿›è¡Œå‡æ³•æ—¶ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ç”±äºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ•°å­—ä½œä¸ºåæ ‡è€Œäº§ç”Ÿçš„å‡è±¡ï¼Œä½†æ˜¯å¯¹äºå¤§å¤šæ•°åº”ç”¨è€Œè¨€ï¼Œè·ç¦»åœºä»ç„¶è¶³å¤Ÿå¥½ã€‚ <br><br><h3> æ–œè§’ </h3><br> æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®å‰ªè¿‡æ¸¡ä»¥ä½¿å…¶åƒå€’è§’ä¸€æ ·å€¾æ–œã€‚ ä¸ºäº†è¾¾åˆ°è¿™ç§æ•ˆæœï¼Œæˆ‘ä»¬é¦–å…ˆé€šè¿‡æ·»åŠ ç°æœ‰å½¢çŠ¶æ¥åˆ›å»ºä¸€ä¸ªæ–°å½¢çŠ¶ã€‚ å¦‚æœæˆ‘ä»¬å†æ¬¡å‡è®¾ä¸¤ä¸ªå›¾å½¢ç›¸äº¤çš„ç‚¹æ˜¯æ­£äº¤çš„ï¼Œé‚£ä¹ˆæ­¤æ“ä½œå°†ç»™æˆ‘ä»¬ä¸€æ¡ç©¿è¿‡ä¸¤ä¸ªæ›²é¢ç›¸äº¤ç‚¹çš„å¯¹è§’çº¿ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab0/fa1/e52/ab0fa1e525ecc833f006cb23fc9c1748.png"></div><br> ç”±äºæˆ‘ä»¬åªæ˜¯ç®€å•åœ°æ·»åŠ äº†è¿™ä¸¤ä¸ªåˆ†é‡ï¼Œæ‰€ä»¥å¸¦æœ‰æ–°çº¿ç¬¦å·çš„è·ç¦»çš„æ¯”ä¾‹å°ºä¸æ­£ç¡®ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å…¶é™¤ä»¥å•ä½å¹³æ–¹çš„å¯¹è§’çº¿å³2çš„å¹³æ–¹æ ¹æ¥å›ºå®šå®ƒï¼Œå°†å…¶é™¤ä»¥2çš„æ ¹ç­‰äºä¹˜ä»¥0.5çš„å¹³æ–¹æ ¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†æ­¤å€¼å†™å…¥ä»£ç ï¼Œä»¥å…æ¯æ¬¡éƒ½ä¸è®¡ç®—ç›¸åŒçš„æ ¹ã€‚ <br><br> ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå…·æœ‰æ‰€éœ€æ–œè§’å½¢çŠ¶çš„å½¢çŠ¶ï¼Œæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œæ‰©å±•ï¼Œä»¥ä½¿æ–œè§’å»¶ä¼¸åˆ°å›¾å½¢çš„è¾¹ç•Œä¹‹å¤–ã€‚ ä¸ä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬å‡å»å¢åŠ æ•°å€¼æ‰€éœ€çš„å€¼ã€‚ ç„¶åï¼Œå°†æ–œè§’å½¢çŠ¶ä¸å¸¸è§„åˆå¹¶çš„è¾“å‡ºç»“åˆèµ·æ¥ï¼Œä»è€Œäº§ç”Ÿæ–œè§’è¿‡æ¸¡ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> champferSize = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Time.y * <span class="hljs-number"><span class="hljs-number">5</span></span>) * <span class="hljs-number"><span class="hljs-number">0.3</span></span> + <span class="hljs-number"><span class="hljs-number">0.3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> combination = champfer_merge(circleShape, squareShape, champferSize);</code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">champfer_merge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> champferSize)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SQRT_05 = <span class="hljs-number"><span class="hljs-number">0.70710678118</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> simpleMerge = merge(shape1, shape2); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> champfer = (shape1 + shape2) * SQRT_05; champfer = champfer - champferSize; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> merge(simpleMerge, champfer); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4fc/103/174/4fc103174057617093fc3b3511f734b1.gif"></div><br> è¦è·å¾—ä¸€ä¸ªæ–œåˆ‡çš„æ–œè§’ï¼Œæˆ‘ä»¬åƒä»¥å‰ä¸€æ ·æ·»åŠ ä¸¤ä¸ªå›¾å½¢ï¼Œä½†æ˜¯éšåæˆ‘ä»¬é€šè¿‡æ·»åŠ æ–œåˆ‡çš„å€¼æ¥ç¼©å°å›¾å½¢ï¼Œå¹¶ä¸è§„åˆ™çš„æ–œäº¤å½¢ç›¸äº¤ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">champfer_intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> champferSize)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SQRT_05 = <span class="hljs-number"><span class="hljs-number">0.70710678118</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> simpleIntersect = intersect(shape1, shape2); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> champfer = (shape1 + shape2) * SQRT_05; champfer = champfer + champferSize; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> intersect(simpleIntersect, champfer); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ca/36f/b07/1ca36fb07d7b3943b6ebfbab12fe098a.gif"></div><br> ä¸å‰é¢çš„å‡æ³•ç›¸ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ­¤å¤„ä¸å€’æ•°ç¬¬äºŒä¸ªå›¾å½¢è¿›è¡Œäº¤ç‚¹ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">champfer_subtract</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> base, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> subtraction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> champferSize)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> champfer_intersect(base, -subtraction, champferSize); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/28e/63a/5ca/28e63a5ca39ac18b239b8101df781410.gif"></div><br><h3> åœ†äº¤é›† </h3><br> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»…ä½¿ç”¨å¸ƒå°”è¿ç®—ç¬¦ï¼ˆæ’å€¼é™¤å¤–ï¼‰ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨å…¶ä»–æ–¹å¼ç»„åˆå½¢çŠ¶ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸¤ä¸ªå½¢çŠ¶çš„è¾¹ç•Œé‡å çš„åœ°æ–¹åˆ›å»ºæ–°çš„åœ†å½¢å½¢çŠ¶ã€‚ <br><br> ä¸ºæ­¤ï¼Œæˆ‘ä»¬å†æ¬¡éœ€è¦å°†ä¸¤ä¸ªæ•°å­—è§£é‡Šä¸ºè¯¥ç‚¹çš„xè½´å’Œyè½´ã€‚ ç„¶åï¼Œæˆ‘ä»¬ä»…è®¡ç®—è¯¥ç‚¹åˆ°åŸç‚¹çš„è·ç¦»ã€‚ å¦‚æœä¸¤ä¸ªå›¾å½¢çš„è¾¹ç•Œé‡å ï¼Œåˆ™åˆ°ä¸¤ä¸ªå›¾å½¢çš„è·ç¦»å°†ä¸º0ï¼Œè¿™ä½¿æˆ‘ä»¬åˆ°è™šæ„åæ ‡ç³»çš„åŸç‚¹çš„è·ç¦»ä¸º0ã€‚ ç„¶åï¼Œå¦‚æœåˆ°åŸç‚¹æœ‰ä¸€æ®µè·ç¦»ï¼Œåˆ™å¯ä»¥ç”¨å®ƒæ‰§è¡Œä¸åœ†ç›¸åŒçš„æ“ä½œï¼Œç„¶åå‡å»åŠå¾„ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round_border</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> shape2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius)</span></span></span></span>{ float2 position = float2(shape1, shape2); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> distanceFromBorderIntersection = length(position); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distanceFromBorderIntersection - radius; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf6/64b/ad1/bf664bad1818151d8736cbf686aec0bd.png"></div><br><h3> è¾¹æ¡†ç¼ºå£ </h3><br> æˆ‘è¦è§£é‡Šçš„æœ€åä¸€ä»¶äº‹æ˜¯åœ¨å¦ä¸€ä¸ªå½¢çŠ¶çš„è¾¹ç•Œä½ç½®åœ¨ä¸€ä¸ªå½¢çŠ¶ä¸­åˆ›å»ºç¼ºå£çš„æ–¹æ³•ã€‚ <br><br> æˆ‘ä»¬é¦–å…ˆè®¡ç®—åœ†çš„è¾¹ç•Œå½¢çŠ¶ã€‚ è¿™å¯ä»¥é€šè¿‡è·å–ç¬¬ä¸€ä¸ªå›¾å½¢çš„è·ç¦»çš„ç»å¯¹å€¼æ¥å®Œæˆï¼Œè€Œå†…éƒ¨å’Œå¤–éƒ¨éƒ½å°†è¢«è§†ä¸ºå›¾å½¢çš„å†…éƒ¨ï¼Œä½†è¾¹ç•Œä»ä¸º0ã€‚å¦‚æœæˆ‘ä»¬é€šè¿‡å‡å»åˆ‡å£å®½åº¦æ¥å¢åŠ æ­¤å›¾å½¢ï¼Œåˆ™å°†æ²¿ä¸Šä¸€ä¸ªå›¾å½¢çš„è¾¹ç•Œè·å¾—å›¾å½¢ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> depth = max(<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(_Time.y * <span class="hljs-number"><span class="hljs-number">5</span></span>) * <span class="hljs-number"><span class="hljs-number">0.5</span></span> + <span class="hljs-number"><span class="hljs-number">0.4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> combination = groove_border(squareShape, circleShape, <span class="hljs-number"><span class="hljs-number">.3</span></span>, depth);</code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">groove_border</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> base, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> groove, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> circleBorder = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(groove) - width; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> circleBorder; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a87/d6d/f27/a87d6df2778599af9e321a4f09beb019.png"></div><br> ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰æŒ‡å®šçš„å€¼ä½¿åœ†çš„è¾¹ç•Œæ›´æ·±å³å¯ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä»ä¸­å‡å»åŸºæœ¬å›¾å½¢çš„ç®€åŒ–ç‰ˆæœ¬ã€‚ åŸºæœ¬å½¢çŠ¶çš„å‡å°é‡å°±æ˜¯åˆ‡å£çš„æ·±åº¦ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">groove_border</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> base, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> groove, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> circleBorder = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(groove) - width; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> grooveShape = subtract(circleBorder, base + depth); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> grooveShape; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/175/81d/25917581df8a9f60193af32c6972f8b9.gif"></div><br> æœ€åä¸€æ­¥æ˜¯ä»åŸºæœ¬å½¢çŠ¶ä¸­å‡å»ç¼ºå£ï¼Œç„¶åè¿”å›ç»“æœã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">groove_border</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> base, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> groove, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> depth)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> circleBorder = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(groove) - width; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> grooveShape = subtract(circleBorder, base + depth); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subtract(base, grooveShape); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bbf/569/f3b/bbf569f3b98efc61fa60228940a4b593.gif"></div><br><h2> æºä»£ç  </h2><br><h3> å›¾ä¹¦é¦† </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Fancy/2D_SDF.cginc</a> </li></ul><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> SDF_2D #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SDF_2D </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//transforms float2 rotate(float2 samplePosition, float rotation){ const float PI = 3.14159; float angle = rotation * PI * 2 * -1; float sine, cosine; sincos(angle, sine, cosine); return float2(cosine * samplePosition.x + sine * samplePosition.y, cosine * samplePosition.y - sine * samplePosition.x); } float2 translate(float2 samplePosition, float2 offset){ //move samplepoint in the opposite direction that we want to move shapes in return samplePosition - offset; } float2 scale(float2 samplePosition, float scale){ return samplePosition / scale; } //combinations ///basic float merge(float shape1, float shape2){ return min(shape1, shape2); } float intersect(float shape1, float shape2){ return max(shape1, shape2); } float subtract(float base, float subtraction){ return intersect(base, -subtraction); } float interpolate(float shape1, float shape2, float amount){ return lerp(shape1, shape2, amount); } /// round float round_merge(float shape1, float shape2, float radius){ float2 intersectionSpace = float2(shape1 - radius, shape2 - radius); intersectionSpace = min(intersectionSpace, 0); float insideDistance = -length(intersectionSpace); float simpleUnion = merge(shape1, shape2); float outsideDistance = max(simpleUnion, radius); return insideDistance + outsideDistance; } float round_intersect(float shape1, float shape2, float radius){ float2 intersectionSpace = float2(shape1 + radius, shape2 + radius); intersectionSpace = max(intersectionSpace, 0); float outsideDistance = length(intersectionSpace); float simpleIntersection = intersect(shape1, shape2); float insideDistance = min(simpleIntersection, -radius); return outsideDistance + insideDistance; } float round_subtract(float base, float subtraction, float radius){ return round_intersect(base, -subtraction, radius); } ///champfer float champfer_merge(float shape1, float shape2, float champferSize){ const float SQRT_05 = 0.70710678118; float simpleMerge = merge(shape1, shape2); float champfer = (shape1 + shape2) * SQRT_05; champfer = champfer - champferSize; return merge(simpleMerge, champfer); } float champfer_intersect(float shape1, float shape2, float champferSize){ const float SQRT_05 = 0.70710678118; float simpleIntersect = intersect(shape1, shape2); float champfer = (shape1 + shape2) * SQRT_05; champfer = champfer + champferSize; return intersect(simpleIntersect, champfer); } float champfer_subtract(float base, float subtraction, float champferSize){ return champfer_intersect(base, -subtraction, champferSize); } /// round border intersection float round_border(float shape1, float shape2, float radius){ float2 position = float2(shape1, shape2); float distanceFromBorderIntersection = length(position); return distanceFromBorderIntersection - radius; } float groove_border(float base, float groove, float width, float depth){ float circleBorder = abs(groove) - width; float grooveShape = subtract(circleBorder, base + depth); return subtract(base, grooveShape); } //shapes float circle(float2 samplePosition, float radius){ //get distance from center and grow it according to radius return length(samplePosition) - radius; } float rectangle(float2 samplePosition, float2 halfSize){ float2 componentWiseEdgeDistance = abs(samplePosition) - halfSize; float outsideDistance = length(max(componentWiseEdgeDistance, 0)); float insideDistance = min(max(componentWiseEdgeDistance.x, componentWiseEdgeDistance.y), 0); return outsideDistance + insideDistance; } #endif</span></span></span></span></code> </pre> <br><h3> ç€è‰²å™¨åº•åº§ </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Simple/sdf_union.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Simple/sdf_intersect.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Simple/sdf_subtract.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Simple/sdf_interpolate.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Fancy/sdf_round.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Fancy/sdf_champfer.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Fancy/sdf_border_intersection.shader</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/ronja-tutorials/ShaderTutorials/blob/master/Assets/035_SDF_combining_repeating/Fancy/sdf_groove.shader</a> </li></ul><br><pre> <code class="cpp hljs">Shader <span class="hljs-string"><span class="hljs-string">"Tutorial/035_2D_SDF_Combinations/Round"</span></span>{ Properties{ _InsideColor(<span class="hljs-string"><span class="hljs-string">"Inside Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) _OutsideColor(<span class="hljs-string"><span class="hljs-string">"Outside Color"</span></span>, Color) = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) _LineDistance(<span class="hljs-string"><span class="hljs-string">"Mayor Line Distance"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) = <span class="hljs-number"><span class="hljs-number">1</span></span> _LineThickness(<span class="hljs-string"><span class="hljs-string">"Mayor Line Thickness"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.05</span></span> [IntRange]_SubLines(<span class="hljs-string"><span class="hljs-string">"Lines between major lines"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) = <span class="hljs-number"><span class="hljs-number">4</span></span> _SubLineThickness(<span class="hljs-string"><span class="hljs-string">"Thickness of inbetween lines"</span></span>, Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.05</span></span>)) = <span class="hljs-number"><span class="hljs-number">0.01</span></span> } SubShader{ <span class="hljs-comment"><span class="hljs-comment">//the material is completely non-transparent and is rendered at the same time as the other opaque geometry Tags{ "RenderType"="Opaque" "Queue"="Geometry"} Pass{ CGPROGRAM #include "UnityCG.cginc" #include "2D_SDF.cginc" #pragma vertex vert #pragma fragment frag struct appdata{ float4 vertex : POSITION; }; struct v2f{ float4 position : SV_POSITION; float4 worldPos : TEXCOORD0; }; v2f vert(appdata v){ v2f o; //calculate the position in clip space to render the object o.position = UnityObjectToClipPos(v.vertex); //calculate world position of vertex o.worldPos = mul(unity_ObjectToWorld, v.vertex); return o; } float scene(float2 position) { const float PI = 3.14159; float2 squarePosition = position; squarePosition = translate(squarePosition, float2(1, 0)); squarePosition = rotate(squarePosition, .125); float squareShape = rectangle(squarePosition, float2(2, 2)); float2 circlePosition = position; circlePosition = translate(circlePosition, float2(-1.5, 0)); float circleShape = circle(circlePosition, 2.5); float combination = /* combination calculation here */; return combination; } float4 _InsideColor; float4 _OutsideColor; float _LineDistance; float _LineThickness; float _SubLines; float _SubLineThickness; fixed4 frag(v2f i) : SV_TARGET{ float dist = scene(i.worldPos.xz); fixed4 col = lerp(_InsideColor, _OutsideColor, step(0, dist)); float distanceChange = fwidth(dist) * 0.5; float majorLineDistance = abs(frac(dist / _LineDistance + 0.5) - 0.5) * _LineDistance; float majorLines = smoothstep(_LineThickness - distanceChange, _LineThickness + distanceChange, majorLineDistance); float distanceBetweenSubLines = _LineDistance / _SubLines; float subLineDistance = abs(frac(dist / distanceBetweenSubLines + 0.5) - 0.5) * distanceBetweenSubLines; float subLines = smoothstep(_SubLineThickness - distanceChange, _SubLineThickness + distanceChange, subLineDistance); return col * majorLines * subLines; } ENDCG } } FallBack "Standard" //fallback adds a shadow pass so we get shadows on other objects }</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN438954/">https://habr.com/ru/post/zh-CN438954/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN438942/index.html">æœ‰ç¬¦å·è·ç¦»åœºä¸Šçš„2Dé˜´å½±</a></li>
<li><a href="../zh-CN438946/index.html">DateTimeOffsetï¼ˆä¸¥æ ¼ï¼‰</a></li>
<li><a href="../zh-CN438948/index.html">ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨Elbrusä¸Šè¿›è¡Œä½çº§ä¼˜åŒ–ï¼Œæˆ–è€…å¦‚ä½•å°†è¯†åˆ«ç³»ç»ŸåŠ é€Ÿä¸€å€åŠ</a></li>
<li><a href="../zh-CN438950/index.html">ä¸­å¤®é“¶è¡Œå¯åŠ¨äº†ä¸€ä¸ªæœºå™¨äººï¼Œå¯ä»¥åœ¨äº’è”ç½‘ä¸Šæœç´¢æ”¶å…¥è®¡åˆ’</a></li>
<li><a href="../zh-CN438952/index.html">ä¸ºä¸åŒçš„æµè§ˆå™¨å¼€å‘éŸ³é¢‘æ’­æ”¾å™¨æ—¶å¯ä»¥å­¦åˆ°ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN438956/index.html">ç‰™é½¿ä¸­çš„ç£ç‚ï¼šå£³è½¯ä½“åŠ¨ç‰©çš„ç»„ç»‡è½¬å½•ç»„æµ‹åº</a></li>
<li><a href="../zh-CN438958/index.html">ILVç¡®è®¤å…¶â€œç©ºé—´ç«™â€çš„å­˜åœ¨</a></li>
<li><a href="../zh-CN438960/index.html">åœ¨åç«¯å·¥ä½œæ—¶ï¼Œæˆ‘å¦‚ä½•æ”¾å¼ƒRubyå–è€Œä»£ä¹‹çš„æ˜¯Python</a></li>
<li><a href="../zh-CN438962/index.html">åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒèŠ¯ç‰‡çš„æœªæ¥å‰æ™¯ä¹è§‚</a></li>
<li><a href="../zh-CN438964/index.html">è°çœŸæ­£èƒŒåæµè¡Œçš„å…è´¹VPNï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>