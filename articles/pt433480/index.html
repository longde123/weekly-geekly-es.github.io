<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë¶ üïõ ‚ò∏Ô∏è Hist√≥ria de Holivarny sobre linter ‚ÑπÔ∏è üìé üíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todos n√≥s escrevemos c√≥digo. Muito c√≥digo. Claro, h√° erros. √Äs vezes, √© apenas um c√≥digo torto, e √†s vezes o pre√ßo de um erro √© uma nave espacial expl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hist√≥ria de Holivarny sobre linter</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/433480/">  Todos n√≥s escrevemos c√≥digo.  Muito c√≥digo.  Claro, h√° erros.  √Äs vezes, √© apenas um c√≥digo torto, e √†s vezes o pre√ßo de um erro √© uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nave espacial</a> explodida.  Obviamente, ningu√©m faz batidas intencionais, todos tentam monitorar a qualidade da melhor maneira poss√≠vel, mas sem ferramentas de an√°lise est√°tica, dificilmente √© poss√≠vel ter certeza de que tudo est√° perfeito. <br><br>  Os linters ajudam a trazer o c√≥digo para um √∫nico estilo e evitam erros.  √â verdade, apenas se voc√™ estiver pronto para sofrer e, no final, n√£o descartar "pylint: disable", apenas para ficar para tr√°s.  O que deveria ser um linter, e por que Pylint n√£o pode fazer isso, conhece Nikita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Sobolevn</a> , que entende e ama tanto os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">linters</a> que at√© nomeou sua empresa para n√£o incomod√°-los - wemake.services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56f/5cb/946/56f5cb9466bea0d6fd71b319f5165c2a.png" alt="imagem"><br><br>  Abaixo est√° a vers√£o em texto do relat√≥rio sobre o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moscow Python Conf ++</a> sobre linters, como faz√™-los corretamente e como n√£o faz√™-lo.  A apresenta√ß√£o teve muita interatividade, online e comunica√ß√£o com o p√∫blico.  O orador, ao longo do caminho, conduziu pesquisas e tentou convencer o p√∫blico: ele olhou para a tend√™ncia e, como no debate, tentou igualar a propor√ß√£o e mudar a opini√£o p√∫blica.  Uma parte das pesquisas caiu em descriptografia, mas n√£o todas, ent√£o um v√≠deo √© anexado para completar a imagem. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/7IVCOzL41Lk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Por que precisamos de linters? <br></h2><br>  A tarefa mais importante do linter √© <strong>trazer o c√≥digo para a uniformidade</strong> .  Existem muitas op√ß√µes para escrever a mesma coisa no Python: coloque uma v√≠rgula aqui ou ali, esque√ßa de fechar os colchetes ou n√£o.  Quando as pessoas escrevem c√≥digo por um longo tempo, torna-se uma colcha de retalhos de pe√ßas diferentes costuradas em momentos diferentes.  √â desagrad√°vel trabalhar com um cobertor desses, desencoraja a leitura do c√≥digo, o que √© muito ruim. <br><br>  <strong>Linters tornam a vida mais f√°cil em uma revis√£o</strong> .  Venho para a revis√£o de c√≥digo e penso: ‚ÄúEu n√£o quero fazer isso!  Agora haver√° espa√ßos extras e outras bobagens! ‚Äù  Gostaria que outra pessoa preparasse um bom c√≥digo e depois disso eu aprecio as grandes coisas conceituais. <br><br>  √Äs vezes, olho para o c√≥digo e acho que est√° tudo bem, e ent√£o vejo em alguma fun√ß√£o muitas vari√°veis ‚Äã‚Äãou um erro que n√£o prestei aten√ß√£o.  A automa√ß√£o encontraria esse erro, mas eu olhei.  Para n√£o cair nessas situa√ß√µes - eu uso o <strong>linter</strong> - ele <strong>encontra tudo o que est√° oculto e dif√≠cil de encontrar.</strong> <br><br><h2>  O que s√£o linters? </h2><br>  <strong>Os mais simples verificam apenas o estilo</strong> , por exemplo, <strong>Flake8</strong> .  At√© certo ponto, tamb√©m preto, mas √© um autoformer-linter.  <strong>Os linters testam a sem√¢ntica mais dif√≠cil</strong> , e n√£o apenas a estil√≠stica: o que voc√™ faz, por que e o vence nas m√£os se voc√™ escreve com erros.  Um bom exemplo √© o <strong>Pylint</strong> , que todos conhecemos, usamos e amamos.  Eu chamo esses linters - <strong>Melhores pr√°ticas</strong> .  O terceiro tipo √© a <strong>verifica√ß√£o de tipo</strong> , esses linter est√£o um pouco afastados.  A verifica√ß√£o de tipo no Python √© nova, agora est√° sendo feita por duas plataformas concorrentes: <strong>Mypy</strong> e <strong>Pyre</strong> . <br><br><h2>  Como usar o linter? </h2><br>  N√£o afirmo que o linter seja uma panac√©ia e um substituto para tudo.  Isto n√£o √© verdade.  Linter - o primeiro passo da pir√¢mide, pelo qual o c√≥digo entra em produ√ß√£o. <br><br>  Existem tr√™s etapas na pir√¢mide: <br><br><ul><li>  <strong>Iniciar o linter</strong> .  √â muito r√°pido e n√£o precisa de nada al√©m do c√≥digo fonte - sem infraestrutura, sem configura√ß√µes.  Verifica√ß√£o: a primeira <strong>verifica√ß√£o de sanidade</strong> passou - tudo est√° bem, estamos trabalhando. </li><li>  <strong>Est√°gio de teste</strong> .  Esse processo √© mais complicado e mais longo devido a erros que n√£o s√£o de c√≥digo.  J√° precisaremos da configura√ß√£o correta e completa de todo o aplicativo. </li><li>  <strong>Revis√£o de palco</strong> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/f40/e1c/77cf40e1cbfb54f312e98c7af63ac9d0.png"><br><br>  <b>Essas s√£o as etapas necess√°rias</b> para o c√≥digo entrar em produ√ß√£o.  Se voc√™ n√£o passou por uma etapa, esqueceu alguma coisa ou o revisor disse que n√£o funcionaria, voc√™ ver√° a mensagem: falhou - o c√≥digo incorreto n√£o entra em produ√ß√£o. <br><br><h3>  Voc√™ usa um linter no trabalho? </h3><br>  Se voc√™ perguntar aos desenvolvedores de uma empresa severa, na qual trabalham 7 dias por semana, se usam um linter, acontece que pelo menos um ter√ßo deles usa linters de maneira muito rigorosa: o <strong>IC cai, as verifica√ß√µes s√£o severas</strong> .  O restante aplica igualmente o linter <strong>ao estilo de teste</strong> , <strong>nunca</strong> e como um <strong>sistema de relat√≥rios</strong> : eles iniciam o linter, geram um relat√≥rio e v√™em como tudo est√° ruim.  Linters s√£o usados, e isso √© bom.  Em nossa empresa, tudo foi constru√≠do de maneira muito severa: v√≠nculos f√≠sicos, muitas verifica√ß√µes, revis√£o dupla de c√≥digo. <br><br><h3>  Revis√£o de c√≥digo <br></h3><br>  Os problemas surgem exatamente nesta fase.  Este √© o passo mais dif√≠cil e mais dif√≠cil da pir√¢mide: a revis√£o de c√≥digo n√£o pode ser automatizada e, se poss√≠vel, levar√° √† automa√ß√£o da escrita do c√≥digo.  Ent√£o os programadores n√£o ser√£o necess√°rios. <br><br>  Por padr√£o, o processo se parece com o seguinte: o c√≥digo entra para uma revis√£o, encontro erros e n√£o quero mais faz√™-los.  Por exemplo, vi que o desenvolvedor capturou o BaseException: ‚ÄúN√£o fa√ßa isso.  Por favor, n√£o pegue! "  Ap√≥s 10 dias, a mesma coisa.  Lembro novamente: <br><br>  - <em>N√≥s n√£o capturamos BaseException.</em> <br>  " <em>Bom, eu entendi."</em> <br><br>  Um ano se passa - o mesmo erro.  Um novo homem vem - o mesmo erro.  Eu penso - como podemos automatizar tudo para que a situa√ß√£o n√£o aconte√ßa novamente, e s√≥ nos lembre: ‚Äú <strong>Vamos cortar nosso linter?</strong>  ¬ªVamos criar um pacote aberto, colocar l√° todas as regras que usamos no trabalho e automatizar a verifica√ß√£o de regras, para que cada vez que n√£o escrevamos √† m√£o.  Automatizamos tudo bem e imediatamente! <br><br>  Naturalmente, voc√™ pode dizer: ‚Äú <strong>Linters prontos j√° existem,</strong> eles funcionam, todo mundo os usa - por que os pr√≥prios?‚Äù, E voc√™ estar√° absolutamente certo, porque existem realmente linters.  Vamos ver quais e o que eles fazem. <br><br><h3>  Pylint <br></h3><br>  No cabe√ßalho " <strong>Por que n√£o Pylint?"</strong>  "Eu ouvi essa pergunta muitas vezes.  Eu responderei mais suavemente.  O Pylint √© uma √≥tima ferramenta de estrela do rock para c√≥digo Python, mas possui recursos que eu n√£o quero ver no meu linter. <br><br>  <strong>Ele combina tudo: verifica√ß√µes estil√≠sticas, pr√°ticas recomendadas e verifica√ß√£o de tipo</strong> .  A verifica√ß√£o de tipo Pylint √© subdesenvolvida porque n√£o h√° informa√ß√µes de tipo: tenta exibi-la de alguma forma, mas n√£o funciona muito bem.  Portanto, frequentemente quando escrevo <code>model_name.some_property</code> no Django, vejo o erro: "Desculpe, n√£o existe essa propriedade - voc√™ n√£o pode us√°-la!"  Lembro que existe um plugin, eu instalo, depois uso o Celery, tamb√©m inicia algum tipo de problema, instalo o plugin para o Celery, uso alguma outra biblioteca m√°gica e, como resultado, escrevo em todos os lugares: ‚Äúpylint: disable‚Äù ... N√£o √© isso o que eu quero obter do linter. <br><br>  Outro recurso oculto do usu√°rio √© <strong>que o Pylint possui sua pr√≥pria implementa√ß√£o da √°rvore de sintaxe Abstrata no Python</strong> .  √â assim que o c√≥digo fica quando voc√™ o analisa e obt√©m informa√ß√µes sobre a √°rvore de n√≥s que comp√µem o c√≥digo.  Eu realmente n√£o confio em minhas pr√≥prias implementa√ß√µes, porque elas est√£o sempre erradas. <br><br>  Al√©m do Pylint, existem outros linters que tamb√©m fazem seu trabalho. <br><br><h3>  Sonarquube <br></h3><br>  Uma ferramenta maravilhosa, mas separada, que mora em algum lugar pr√≥ximo ao seu projeto. <br><br><ul><li>  <strong>O SonarQube n√£o poder√° ser executado com freq√º√™ncia</strong> : ele precisa ser implantado em algum lugar, assistir, monitorar, configurar. </li><li>  Est√° <strong>escrito em Java</strong> .  Se voc√™ deseja consertar seu linter para Python, voc√™ escrever√° c√≥digo em Java.  Eu acho que conceitualmente isso est√° errado - um desenvolvedor que possa escrever em Python deve ser capaz de escrever c√≥digo para testar o Python. </li></ul><br>  A empresa que desenvolve o SonarQube analisa especificamente o conceito de desenvolvimento de produtos.  Isso pode ser um problema. <br><br>  A vantagem do SonarQube √© que ele possui verifica√ß√µes muito interessantes que mostram complexidade, poss√≠veis erros e erros ocultos.  Gosto dos cheques, os deixaria e mudaria a plataforma. <br><br><h3>  Flake8 <br></h3><br>  Um linter maravilhoso √© muito simples, mas com um problema: <strong>existem poucas regras</strong> pelas quais ele verifica qu√£o bem o c√≥digo √© escrito.  Ao mesmo tempo, o Flake8 possui muitos plugins muito simples: o plug-in m√≠nimo √© de 2 m√©todos que precisam ser implementados.  Eu pensei - vamos tomar o Flake8 como base e escrever plugins, mas com nosso entendimento dos benef√≠cios para a empresa.  E assim fizemos. <br><br><h3>  O linter mais rigoroso do mundo <br></h3><br>  Criamos uma ferramenta na qual coletamos tudo o que achamos certo para o Python e chamamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>wemake-python-styleguide</strong></a> .  O plug-in foi publicado publicamente, pois acredito que o <strong>c√≥digo-fonte aberto por padr√£o √© uma boa pr√°tica</strong> .  Estou profundamente convencido de que muitas ferramentas ser√£o beneficiadas se forem carregadas no Open Source.  Para o nosso instrumento, criamos o slogan: <strong>"O linter mais rigoroso do mundo!"</strong> <br><br><blockquote>  A palavra-chave em nosso linter √© estrita, o que significa dor e sofrimento. </blockquote><br>  Se voc√™ usa o linter, e ele n√£o o faz sofrer, ent√£o voc√™ aperta a cabe√ßa: "Por que voc√™ n√£o gosta, caramba?", Ent√£o este √© um mau linter.  Ignora erros, n√£o monitora suficientemente a qualidade do c√≥digo e n√£o precisamos dele.  Precisamos do mais rigoroso do mundo, o que verifica muito.  Agora, temos cerca de <strong>250 testes diferentes em ambas as categorias</strong> : estil√≠stica e pr√°ticas recomendadas, mas sem a verifica√ß√£o de tipo.  Mypy est√° envolvido nisso, n√£o o preocupamos de forma alguma. <br><br>  Nosso linter <strong>n√£o</strong> tem <strong>compromisso</strong> .  N√£o temos regras da categoria "Eu n√£o gostaria de fazer isso, mas se voc√™ realmente quiser, poder√°."  N√£o, sempre falamos severamente - n√£o fazemos isso porque √© ruim.  Em seguida, as pessoas v√™m e dizem: "H√° 2,5 casos de uso em que isso √© poss√≠vel em princ√≠pio!".  Se houver tais casos, escreva claramente que essa linha √© permitida pelo linter ignor√°-la, mas explique o porqu√™.  Deve ser um coment√°rio sobre por que voc√™ permitiu uma pr√°tica estranha e por que est√° fazendo isso.  Essa abordagem tamb√©m √© √∫til para documentar c√≥digo. <br><br>  O linter mais rigoroso <strong>n√£o requer configura√ß√µes (WIP)</strong> .  Ainda temos configura√ß√µes, mas queremos nos livrar delas: tendo liberdade, o usu√°rio certamente ir√° configurar para que o linter n√£o funcione corretamente. <br><br><blockquote>  Uma boa ferramenta n√£o precisa de configura√ß√µes - possui bons valores padr√£o. </blockquote><br>  Com essa abordagem, o c√≥digo ser√° consistente e funcionar√° da mesma maneira para todos, pelo menos em teoria.  Ainda estamos trabalhando nisso e, enquanto houver configura√ß√µes, voc√™ pode usar nossa ferramenta e personaliz√°-la por si mesmo. <br><br><h2>  De quem somos dependentes? </h2><br>  De um grande n√∫mero de ferramentas. <br><br><ul><li>  <strong>Flake8</strong> . </li><li>  <strong>Eradicate</strong> √© um plugin legal que encontra fragmentos comentados no c√≥digo e faz com que voc√™ os exclua, porque armazenar c√≥digo morto em um projeto √© ruim.  N√£o temos permiss√£o para faz√™-lo. </li><li>  <strong>O Isort</strong> √© uma ferramenta que o for√ßa a classificar as importa√ß√µes corretamente: em ordem, recuando, cita√ß√µes bonitas. </li><li>  <strong>O Bandit</strong> √© uma √≥tima ferramenta para verificar a seguran√ßa do c√≥digo estaticamente.  Ele encontra senhas com fio, uso desajeitado de <code>assert</code> no c√≥digo, chama <code>Popen</code> , <code>sys.exit</code> e diz que tudo isso n√£o pode ser usado, mas se voc√™ quiser, ele pede para escrever o motivo. </li><li>  E mais de <strong>20 plugins</strong> que verificam colchetes, cita√ß√µes e v√≠rgulas. </li></ul><br><h2>  O que estamos verificando? </h2><br>  Existem 4 grupos de regras que usamos e aplicamos. <br><br>  <strong>A complexidade</strong> √© o maior problema.  N√£o sabemos o que √© complexidade e n√£o a vemos no c√≥digo.  Observamos o c√≥digo com o qual trabalhamos todos os dias e parece que n√£o √© complicado - pegue, leia, tudo funciona.  Isto n√£o √© verdade.  C√≥digo simples √© um c√≥digo familiar.  A complexidade tem crit√©rios claros que testamos.  Sobre os pr√≥prios crit√©rios - mais tarde.  Se o c√≥digo violar os crit√©rios, dizemos: "O c√≥digo √© complexo, reescreva!" <br><br>  <strong>Os nomes</strong> de vari√°veis ‚Äã‚Äãs√£o um problema de programa√ß√£o n√£o resolvido.  Quem vai ler quando e em que contexto n√£o est√° claro.  Tentamos tornar os nomes o mais consistente e compreens√≠vel poss√≠vel, mas, embora tentemos, o problema ainda n√£o foi totalmente resolvido. <br><br>  Por <strong>consist√™ncia</strong> , temos uma regra simples - escreva a mesma em todos os lugares.  Se houver alguma abordagem aprovada, use-a em qualquer lugar.  N√£o importa se voc√™ gosta ou n√£o, a consist√™ncia √© mais importante. <br><br>  Tentamos usar apenas as <strong>melhores pr√°ticas.</strong>  Se sabemos que alguma pr√°tica n√£o √© muito boa, proibimos seu uso.  Se o desenvolvedor quiser usar pr√°ticas proibidas, esperamos argumentos dele: por que e por que aplicar.  Talvez, durante o processo de descri√ß√£o, venha a entender por que isso √© ruim. <br><br><h3>  O que √© complexidade? <br></h3><br>  A complexidade tem m√©tricas espec√≠ficas que voc√™ pode analisar e dizer se √© dif√≠cil ou n√£o.  Existem muitos deles. <br><br>  <strong>Complexidade ciclom√°tica</strong> - a complexidade ciclom√°tica favorita de todos.  Ele encontra no c√≥digo um grande n√∫mero de estruturas aninhadas <code>if</code> , <code>for</code> outras estruturas, e indica muita ramifica√ß√£o do c√≥digo e dificuldade na leitura.  Tudo est√° ruim com o c√≥digo incorporado: voc√™ l√™, l√™, l√™ - voltou, leu, leu, leu - pulou e depois entrou em outro ciclo.  √â imposs√≠vel passar com seguran√ßa esse c√≥digo de cima para baixo. <br><br>  <strong>Argumentos, instru√ß√µes e retornos.</strong>  Essas s√£o m√©tricas quantitativas: quantos argumentos est√£o na fun√ß√£o ou no m√©todo, quantos est√£o dentro do corpo dessa fun√ß√£o ou no m√©todo de instru√ß√µes e retornos. <br><br>  <strong>Coes√£o e acoplamento</strong> s√£o m√©tricas populares de POO.  <strong>Coes√£o</strong> mostra a conex√£o da classe dentro.  Por exemplo, h√° uma classe e, dentro de voc√™, usam todos os m√©todos e propriedades - tudo o que voc√™ declarou.  Esta √© uma boa aula com alta conectividade interna.  <strong>Acoplamento</strong> √© o quanto as diferentes partes do sistema est√£o conectadas: m√≥dulos e classes.  Queremos alcan√ßar conectividade m√°xima dentro da classe e conectividade m√≠nima fora.  Em seguida, o sistema √© facilmente mantido e funciona bem. <br><br>  <strong>Complexidade de Jones</strong> - peguei emprestada essa m√©trica, mas apenas porque √© uma bomba!  A complexidade de Jones determina a complexidade de uma linha - quanto mais complexa, mais dif√≠cil √© entender, porque a mem√≥ria humana de curto prazo n√£o pode processar mais de 5 a 9 objetos de uma s√≥ vez.  Essa √© a chamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">carteira de Miller</a> . <br><br>  Examinamos essas m√©tricas importantes e outras que s√£o muito maiores e determinamos se o c√≥digo √© adequado ou n√£o.  No nosso entendimento, a <strong>complexidade √© uma cachoeira</strong> . <br><br><h3>  Dificuldade da cachoeira <br></h3><br>  A dificuldade come√ßa com o fato de termos escrito a linha e ainda √© boa.  Mas ent√£o a empresa chega e diz que os pre√ßos dobraram e n√≥s multiplicamos por 2. Nesse momento, a Jones Complexity enlouquece e relata que agora a linha √© muito complicada - h√° muita l√≥gica. <br><br>  Bem, come√ßamos uma nova vari√°vel, e o analisador de complexidade da fun√ß√£o diz: <br><br>  - <em>N√£o, n√£o √© assim - agora existem muitas vari√°veis ‚Äã‚Äãdentro da fun√ß√£o.</em> <br><br>  Farei um novo <strong>m√©todo</strong> e passarei argumentos para ele.  Agora, verificar o n√∫mero de argumentos da fun√ß√£o ou o n√∫mero de m√©todos dentro da <strong>classe</strong> diz que isso tamb√©m √© imposs√≠vel - a classe √© muito complexa e deve ser dividida em duas partes.  Falhando ao destacar outra classe.  Agora, existem mais classes e tudo est√° bem, mas a verifica√ß√£o da complexidade do <strong>m√≥dulo</strong> informa que o m√≥dulo agora √© muito complexo e precisa ser refatorado.  Porqu√™ ?! <br><br>  Isso se chama sofrimento.  √â por isso que digo que um linter deve fazer voc√™ sofrer.  Come√ßamos multiplicando por 2 em uma linha e acabamos <strong>refatorando todo o sistema</strong> .  Adicionar um pequeno peda√ßo de c√≥digo leva √† refatora√ß√£o de m√≥dulos inteiros, porque a complexidade se espalha como uma cascata e cobre tudo o que √© poss√≠vel. <br><br>  <strong>"Precisa refatorar"</strong> - isso faz voc√™ refatorar o c√≥digo.  Voc√™ n√£o pode simplesmente ficar sentado: "Eu n√£o toco esse c√≥digo, parece funcionar".  N√£o, um dia voc√™ mudar√° o c√≥digo em outro lugar, e uma cascata de complexidade inundar√° o m√≥dulo que voc√™ n√£o tocou e ter√° que refator√°-lo.  Acredito que a refatora√ß√£o √© boa e, quanto mais, mais est√°vel e melhor o seu sistema funciona.  <strong>E tudo o resto √© subjetivo!</strong> <br><br>  Agora vamos falar sobre gostos.  Esta √© uma parte hol√≠stica e interativa! <br><br><h2>  Holivar <br></h2><br>  Vamos apoiar, os coment√°rios est√£o abertos.  Primeiro, deixe-me lembr√°-lo de que os nomes s√£o um problema complexo e n√£o resolvido.  Voc√™ pode discutir como nomear uma vari√°vel, mas temos algumas abordagens que ajudam pelo menos a n√£o cometer erros √≥bvios. <br><br><h3>  Nomes <br></h3><br>  Como voc√™ gosta: <strong>var, valor, item, obj, dados, resultado</strong> ?  O que s√£o <strong>dados</strong> ?  Alguns dados.  O que √© <strong>resultado</strong> ?  Algum tipo de resultado.  Muitas vezes, vejo a vari√°vel <strong>resultado</strong> e uma chamada para algum m√©todo infernal em uma classe incompreens√≠vel - e penso: ‚ÄúQual √© esse resultado?  Por que ele est√° aqui? <br><br>  Muitos desenvolvedores discordam de mim e dizem que <strong>valor</strong> √© um nome de vari√°vel perfeitamente normal: <br><br>  - <em>Eu sempre uso chave e valor!</em> <br>  - <em>Por que n√£o usar chave e valor, mas diga que a chave √© o nome e o valor √© o sobrenome?</em>  <em>Por que √© imposs√≠vel nomear nome e sobrenome - agora existe um contexto.</em> <br><br>  Geralmente as pessoas concordam, mas argumentam de qualquer maneira.  Isso √© uma coisa muito hol√≠stica: pelo menos tr√™s pessoas passaram uma hora de sua vida comigo para discutir isso comigo. <br><br><h3>  √â correto nomear vari√°veis ‚Äã‚Äãcom uma letra? <br></h3><br>  Por exemplo, <strong>q</strong> ?  Todos conhecemos o caso cl√°ssico: <code>for i in some_iterable:</code>  O que <strong>eu sou</strong> ?  Em C, essa √© uma pr√°tica padr√£o e tudo vem dela.  Mas em Python, cole√ß√µes e iteradores.  As cole√ß√µes cont√™m elementos que t√™m nomes - vamos cham√°-los de alguma maneira diferente. <br><br><blockquote>  Metade dos desenvolvedores acha que chamar vari√°veis ‚Äã‚Äãi, x, y, z √© normal. </blockquote><br>  Eu acredito que voc√™ n√£o pode nomear nomes com uma letra.  Quero mais contexto e √© bom que a segunda metade dos desenvolvedores concorde comigo.  Se em C isso ainda √© permitido de alguma forma devido ao patrim√¥nio hist√≥rico, ent√£o, em Python, esse √© um problema muito grande e voc√™ n√£o precisa fazer isso. <br><br><h3>  Consist√™ncia <br></h3><br>  Vamos apenas escolher uma maneira dentre muitas e dizer: "Vamos fazer isso".  Se √© bom ou ruim - n√£o importa mais - √© simplesmente consistente. <br><br>  Estamos falando apenas de Python 3, o Legacy n√£o √© considerado. <br><br>  Eu tenho um argumento: quando herdarmos de alguma coisa, dever√≠amos saber do que seria bom ver o nome do pai.  O engra√ßado √© que geralmente vemos o nome dos pais, exceto quando este √© um <strong>objeto</strong> .  Portanto, formulei uma regra para mim: quando escrevo uma classe, herdo de algo - sempre escrevo o nome do pai.  N√£o importa como ser√°: modelo, objeto ou outra coisa. <br><br>  Se houver uma op√ß√£o para escrever <code>Class Some(object)</code> ou <code>class Some</code> , ent√£o eu escolherei a primeira.  Por um lado, mostra que claramente sempre escrevemos do que herdamos.  Por outro lado, n√£o h√° <strong>verbosidade</strong> espec√≠fica: n√£o perdemos nada com algumas teclas adicionais. <br><br>  Dois ter√ßos dos desenvolvedores est√£o mais familiarizados com a segunda op√ß√£o, e eu at√© sei o porqu√™.  Minha hip√≥tese: tudo porque h√° muito tempo migramos da segunda vers√£o do Python para a terceira e agora mostramos que estamos escrevendo no terceiro Python.  N√£o sei como a hip√≥tese est√° correta, mas me parece que sim. <br><br><h3>  Linhas F s√£o terr√≠veis? <br></h3><br>  Op√ß√µes de resposta: <br><br><ul><li>  Sim: eles perdem o contexto, colocam l√≥gica no modelo e n√£o fiam - (38%). </li><li>  N√£o!  Eles s√£o um milagre!  - (62%). </li></ul><br>  Existe uma hip√≥tese de que as linhas f sejam terr√≠veis.  Eles enfiam qualquer coisa neles!  As linhas f n√£o s√£o as mesmas que <code>.format</code> , as diferen√ßas s√£o dram√°ticas.  Quando declaramos um modelo e o formatamos, realizamos duas a√ß√µes separadamente: primeiro, definimos o modelo e, em seguida, formatamos.  Quando declaramos uma linha f, executamos duas a√ß√µes simultaneamente: declaramos imediatamente o modelo e o formatamos no mesmo momento. <br><br>  Existem dois problemas com as linhas f.  Declaramos um modelo para a linha f e tudo funciona.  E ent√£o decidimos mover as linhas do modelo 2 ou mov√™-lo para outra fun√ß√£o - e tudo quebra.  <strong>Agora n√£o h√° contexto que nos permita formatar seq√º√™ncias de caracteres</strong> e n√£o podemos process√°-las corretamente.  O segundo grande problema das linhas f: elas permitem que voc√™ fa√ßa a coisa terr√≠vel - <strong>insira a l√≥gica no modelo</strong> .  Suponha que exista uma linha na qual simplesmente inserimos o nome de usu√°rio e a palavra "Ol√°" - isso √© normal.  N√£o h√° nada particularmente terr√≠vel, mas depois vemos que o nome de usu√°rio vem em mai√∫sculas, decidimos traduzi-lo para um caso de T√≠tulo e escrevemos diretamente no modelo <code>username.title()</code> .  Em seguida, condi√ß√µes, ciclos, importa√ß√µes aparecem no modelo.  E todas as outras partes do php. <br><br>  Todos esses problemas me fazem dizer que <strong>as linhas f s√£o um t√≥pico ruim</strong> , n√£o as usamos.  O engra√ßado √© que n√£o temos um caso em que apenas as linhas f sejam adequadas para n√≥s.  Normalmente, qualquer formata√ß√£o √© adequada, mas escolhemos <code>.format</code> - tudo o mais √© imposs√≠vel - nem <code>%</code> , nem f-lines.  O trabalho de .format tamb√©m <code>.format</code> indicado, porque dentro dele voc√™ pode colocar aspas e escrever o nome da vari√°vel ou sua ordem. <br><br><blockquote>  Durante o relat√≥rio, o n√∫mero de oponentes da linha f aumentou de 33 para 38% - essa √© uma vit√≥ria pequena, mas positiva. </blockquote><br><h3>  Os n√∫meros <br></h3><br>  Voc√™ gosta de n√∫meros como este: <code>final_score = 69 * previous result / 3.14</code> .  Parece uma linha de c√≥digo padr√£o, mas o que √© 69?  Tais perguntas geralmente surgem quando olho para o c√≥digo que escrevi h√° algum tempo e o gerente naquele momento diz: <br><br>  - <em>Por favor, multiplique por 147.</em> <br>  - <em>Por que aos 147?</em> <br>  - <em>N√≥s temos essas tarifas.</em> <br><br>  Eu me multipliquei e esqueci, ou por muito tempo peguei algum valor do coeficiente para que tudo funcionasse - e ent√£o esqueci como o peguei e por qu√™.  Acontece que importantes trabalhos de pesquisa permaneceram escondidos atr√°s de um n√∫mero sem t√≠tulo.  Eu nem sei qual √© esse n√∫mero, mas s√≥ consigo encontr√°-lo, recuper√°-lo e restaur√°-lo de alguma forma, confirmando mais tarde <br><br>  Por que n√£o fazer isso de maneira diferente - coloque todos os n√∫meros complexos em sua pr√≥pria vari√°vel com o nome e a documenta√ß√£o?  Por exemplo, para o n√∫mero 69, escreva que este √© o indicador m√©dio no mercado e agora a constante tem um nome e um contexto.  Vou escrever um coment√°rio que tomei a constante no local desse estudo.  Se a pesquisa mudar no futuro, irei atualizar os dados. <br><br>  Assim, garantimos que nenhum n√∫mero m√°gico passar√° pelo nosso c√≥digo e o complicaria por dentro.  Eles passam pela verifica√ß√£o da complexidade de cada linha e dizem: "Aqui est√° o n√∫mero 4766. N√£o sei, resolva voc√™ mesmo!"  Essa foi uma √≥tima descoberta para mim. <br><br><blockquote>  Como resultado, percebemos que precisamos seguir isso e n√£o perdemos nenhum n√∫mero m√°gico no c√≥digo.  √â bom que quase 100% dos nossos colegas concordem conosco e tamb√©m n√£o usem esses n√∫meros. </blockquote><br>  Mas h√° exce√ß√µes - esses s√£o n√∫meros de -10 a 10, n√∫meros 100, 1000 e similares, simplesmente porque s√£o frequentemente encontrados e sem eles √© dif√≠cil.  <strong>Somos dur√µes, mas n√£o s√°dicos</strong> e pensamos um pouco. <br><br><h3>  Voc√™ usa '@staticmethod'? <br></h3><br>  Vamos pensar sobre o que <strong>√©</strong> o <strong>m√©todo est√°tico</strong> .  Voc√™ j√° se perguntou por que est√° em Python?  Eu n√£o  Eu tinha um lindo Pylint que dizia: <br><br>  - <em>Olha, voc√™ n√£o est√° usando</em> <code>self</code> , <code>cls</code> - <em>fa√ßa um</em> <em>m√©todo</em> <em>est√°tico!</em> <br>  - <em>Ok, Pylint, eu vou fazer um m√©todo est√°tico.</em> <br><br>  Depois, ensinei Python para iniciantes, e eles perguntaram o que √© o m√©todo est√°tico e por que √© necess√°rio.  Eu n√£o sabia a resposta e pensei se √© poss√≠vel escrever o mesmo com uma fun√ß√£o ou n√£o usar o <code>self</code> em uma fun√ß√£o regular, simplesmente porque √© uma classe dessas e algo est√° acontecendo.  Por que precisamos de uma constru√ß√£o de m√©todo static? <br><br>  Pesquisei a pergunta no Google e ela acabou sendo t√£o profunda quanto uma toca de coelho.  Existem muitas outras linguagens de programa√ß√£o nas quais o m√©todo static tamb√©m n√£o √© apreciado.  E bem fundamentado - o m√©todo static quebra o modelo de objeto.  Como resultado, eu percebi - o <strong>m√©todo est√°tico n√£o √© o lugar aqui</strong> , e n√≥s o cortamos.  Agora, se usarmos o decorador staticmethod, o linter dir√°: "N√£o, desculpe, refatorar!" <br><br>  A maioria dos desenvolvedores discorda de mim, mas cerca da metade ainda pensa que √© melhor escrever m√©todos ou fun√ß√µes regulares em vez do m√©todo static. <br><br><h3>  L√≥gica em __init __. Ru - bom ou ruim? <br></h3><br>  Este √© o meu t√≥pico favorito.  Certamente, quando voc√™ cria um novo pacote e o chama de alguma forma - ele cria __init __. Ru e voc√™ quer saber o que colocar nele?  O que colocar em __init __. Ru e o que - nos arquivos lado a lado?  Para mim, essa era uma pergunta n√£o trivial, e eu sempre estava perdido: provavelmente algo mais importante?  Ent√£o pensei - n√£o, pelo contr√°rio, colocarei o mais importante no contexto mais compreens√≠vel.  Se voc√™ colocar algo em __init __. Ru e depois importar tudo, as importa√ß√µes c√≠clicas tamb√©m ser√£o ruins. <br><br>  Eu olhei para v√°rias bibliotecas populares, subi o __init __. Ru e notei que basicamente h√° compatibilidade com vers√µes anteriores ou com lixo.  Para mim, essa quest√£o surgiu bastante quando comecei a criar pacotes grandes com muitos subpacotes - voc√™ se perde.           ,   .    Python,  ,   ,   __init__.  ,  90%     . <br><br>   ‚Äî ,   API,  ,   -  ,  ,   ? ,  ,      .      API   .   ,    __init__.   - : ,  ,   . <br><br>   ,   <code>I_CONTROL_CODE</code> ‚Äî   .   ,   .    ,  ,  __init__.   ‚Äî  .     ,    ,    , - ,       . <br><br><h3>  hasattr   ? <br></h3><br>     <strong>hasattr</strong> ?  ,   ,    Python   ‚Äî .  hasattr  ,         (). <br><br>   ,  ,   hasattr  ,     ,   .       ,   hasattr,   ,      . - ,  Python   -, hasattr      .       ,        .    <strong>getattr</strong>   ¬´  ,  ¬ª.          hasattr ‚Äî  getattr,  <strong>exception</strong> . <br><br>     50  50 ‚Äî ,        ,        . <br><br><h2>        <br></h2><br>     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>layer-linter</strong></a> .   ?      :   ,   ,     ,    .     ,     -    .         - .  . <br><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>cohesion</strong></a> .       ,    . Cohesion ,     .      False Positive       ,       ‚Äî ,   ,  . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>vulture</strong></a>      Python    . - ,  Python   ,    .      ohesion. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><strong>Radon</strong></a>      ,   : <strong>Halstead</strong> , <strong>Maintainability Index</strong> ,  . ,       ‚Äî  . <br><br><h2> Final type <br></h2><br>   <strong>Final-</strong>  Python.     Typing Extensions,        ,    .  ,     - ,      ‚Äî  ,      .   ,   -  - ,  ?  N√£o precisa.  .  -  ‚Äî  ,  , , . <br><br><h2> Gratis <br></h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>     ,     . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b90/e6c/e5d/b90e6ce5dc2ef3c00c83e73fa162447e.png"><br><br>       ,     . <br><br>      ,     .   ,   .      ,    Python-   ,   . <br><br><blockquote> ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moscow Python Conf++</a> ,      .    ,        ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>         Python-. </blockquote><br>       .       .   ,      ,   ,      . <br><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/2fd/ed2/6fa/2fded26fa11ac61fb98e0b729b6bd0c6.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/01e/18a/d2d/01e18ad2d4184a42079552671a8957d8.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f87/653/af3/f87653af3f7b6c6baca449b3c81b564f.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1e/5a8/576/d1e5a8576f1a724683a57f2c2861950e.png"><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt433480/">https://habr.com/ru/post/pt433480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt433462/index.html">Verifica√ß√µes de sa√∫de e degrada√ß√£o gradual de sistemas distribu√≠dos</a></li>
<li><a href="../pt433472/index.html">Lan√ßamento do Unity 2018.3</a></li>
<li><a href="../pt433474/index.html">Pil√£o de dentro para fora. Como ele faz isso</a></li>
<li><a href="../pt433476/index.html">50 tons de aipo</a></li>
<li><a href="../pt433478/index.html">Por que o Django √© escolhido na Revista Tinkoff</a></li>
<li><a href="../pt433482/index.html">Django sob microsc√≥pio</a></li>
<li><a href="../pt433486/index.html">O que de novo? A recupera√ß√£o de cart√µes de d√©bito n√£o banc√°rios</a></li>
<li><a href="../pt433488/index.html">Christmas Scrum Meetup Transmiss√£o UPD mitap</a></li>
<li><a href="../pt433490/index.html">Revis√£o da impressora 3D Creality CR-X</a></li>
<li><a href="../pt433494/index.html">10 idiomas ingleses que voc√™ nunca conhecer√°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>