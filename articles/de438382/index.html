<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍💻 🧓🏻 👨🏾‍🔬 Organisation einer Suche auf einer Webseite in JavaScript (ohne jQuery) 🍳 🌩️ 📪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor ein paar Tagen erhielt ich von der Firma eine Testaufgabe für die freie Stelle Front-End-Entwickler. Natürlich bestand die Aufgabe aus mehreren Pu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Organisation einer Suche auf einer Webseite in JavaScript (ohne jQuery)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438382/">  Vor ein paar Tagen erhielt ich von der Firma eine Testaufgabe für die freie Stelle Front-End-Entwickler.  Natürlich bestand die Aufgabe aus mehreren Punkten.  Aber jetzt konzentrieren wir uns nur auf eine davon - die Organisation der Suche auf der Seite.  Das heißt,  banale Suche nach dem in das Feld eingegebenen Text (analog zu Strg + F im Browser).  Die Besonderheit der Aufgabe war, dass die Verwendung von JS-Frameworks oder -Bibliotheken verboten ist.  <strong>Alle schreiben in nativem nativem JavaScript</strong> . <br><br>  <i>(Aus Gründen der Klarheit werde ich den gesamten Artikel weiterhin mit Screenshots und Code begleiten, damit Sie und ich verstehen, wovon ich in einem bestimmten Moment spreche.)</i> <br><a name="habracut"></a><br><h2>  Eine Lösung finden </h2><br>  Erster Gedanke: Jemand hat genau das bereits geschrieben, Sie müssen googeln und kopieren und einfügen.  Also habe ich es getan.  In einer Stunde fand ich zwei gute Skripte, die im Wesentlichen auf die gleiche Weise funktionierten, aber unterschiedlich geschrieben waren.  Ich habe den ausgewählt, dessen Code ich besser verstanden und in die Seite meines alten Mannes eingefügt habe. <br><br>  <i>Wenn jemand interessiert ist, habe ich den Code <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier genommen</a> .</i> <br><br>  Das Skript hat sofort funktioniert.  Ich dachte, dass das Problem behoben war, aber wie sich herausstellte, war es kein Vergehen für den Autor des Skripts, dass es einen großen Fehler gab.  Das Skript hat den gesamten Inhalt des Tags durchsucht <code>...</code> und, wie Sie wahrscheinlich bereits vermutet haben, wird bei der Suche nach einer Kombination von Zeichen, die einem Tag oder seinen Attributen ähneln, die gesamte HTML-Seite unterbrochen. <br><br><h2>  Warum hat das Skript nicht richtig funktioniert? </h2><br>  Alles ist einfach.  Das Skript funktioniert wie folgt.  Zuerst schreiben wir den gesamten Inhalt des <strong>Body-</strong> Tags in eine Variable, suchen dann nach Übereinstimmungen mit dem regulären Ausdruck (der Benutzer legt ihn beim Eingeben in das Textfeld fest) und ersetzen dann alle Übereinstimmungen durch den folgenden Code: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"background-color: yellow;"</span></span></span><span class="hljs-tag">&gt;</span></span>... ...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Und dann ersetzen wir das aktuelle <strong>Body-</strong> Tag durch das neu erhaltene.  Das Markup wird aktualisiert, die Stile ändern sich und alle gefundenen Ergebnisse werden auf dem Bildschirm gelb hervorgehoben. <br><br>  Sie haben wahrscheinlich bereits verstanden, wo das Problem liegt, aber ich werde es dennoch genauer erläutern.  Stellen Sie sich vor, Sie geben das Wort <strong>"div"</strong> in das Suchfeld ein.  Wie Sie verstehen, gibt es im <strong>Körper</strong> viele andere Tags, einschließlich <strong>div</strong> .  Und wenn wir alle die oben genannten Stile auf das <strong>„div“</strong> anwenden, ist dies kein Block, aber es ist nicht klar, was, da das Design bricht.  Als Ergebnis erhalten wir nach dem Überschreiben des Markups eine vollständig fehlerhafte Webseite.  Es sieht so aus. <br><br>  Es war vor der Suche: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="http://saveimg.ru/thumbnails/30-04-16/b43ea456d1d7d278464d613f7eec8630.png" alt="Fotos ins Internet hochladen"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vollständig verblassen</a> <br>  Es wurde nach der Suche: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="http://saveimg.ru/thumbnails/30-04-16/4fcd7c7461510c748fc002a616883b14.png" alt="Foto kostenlos hochladen"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vollständig verblassen</a> <br><br>  Wie Sie sehen können, bricht die Seite vollständig.  Kurz gesagt, das Skript erwies sich als nicht funktionsfähig, und ich beschloss, mein eigenes von Grund auf neu zu schreiben, worum es in diesem Artikel geht. <br><br><h1>  Also schreiben wir ein Skript von Grund auf neu </h1><br>  Wie alles für mich aussieht. <br><br><img src="https://habrastorage.org/files/e63/fe9/3f0/e63fe93f07ad4fe59872d26a0fc93e2d.png"><br><br>  Jetzt interessiert uns das Suchformular.  Er umkreiste sie mit einer roten Linie. <br><br>  Lass uns ein bisschen schauen.  Ich habe dies wie folgt implementiert (bisher reines HTML).  Ein Formular mit drei Tags. <br><br>  <strong>Der erste</strong> dient zur Eingabe von Text; <br>  <strong>Die zweite</strong> - um die Suche abzubrechen (abwählen); <br>  <strong>Der dritte</strong> dient zur Suche (markieren Sie die gefundenen Ergebnisse). <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Wir haben also ein Eingabefeld und 2 Schaltflächen.  Ich werde JavaScript in die js.js schreiben.  Angenommen, Sie haben es bereits erstellt und verbunden. <br><br>  Das erste, was wir tun werden: Registrieren Sie die Funktionsaufrufe, wenn Sie auf die Schaltfläche Suchen und Abbrechen klicken.  Es wird so aussehen: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"place_for_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text-to-find"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button_for_turn_back"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript: FindOnPage('text-to-find',false); return false;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button_for_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript: FindOnPage('text-to-find',true); return false;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Lassen Sie uns ein wenig erklären, was hier ist und warum. <br><br>  Wir geben das Textfeld <strong>id = "zu findender Text"</strong> ( <i>diese ID bezieht sich auf das Element von js</i> ). <br><br>  Wir geben der Abbrechen- <strong>Schaltfläche die</strong> folgenden Attribute: <strong>type = "button" onclick = "javascript: FindOnPage ('text-to-find', false);</strong>  <strong>return false; "</strong> <br><br>  - <i>Typ: Schaltfläche</i> <br>  - <i>Wenn diese Taste gedrückt wird, wird die FindOnPage-Funktion aufgerufen ('text-to-find', false).</i>  <i>und übergibt die ID des Feldes mit dem Text <strong>false</strong></i> <br><br>  Wir geben der <strong>Suchschaltfläche die</strong> folgenden Attribute: <strong>type = "button" onclick = "javascript: FindOnPage ('text-to-find', true);</strong>  <strong>return false; "</strong> <br><br>  - <i>Geben Sie Folgendes ein: Senden (keine Schaltfläche, da Sie hier nach Eingabe des Felds die Eingabetaste oder auch die Schaltfläche verwenden können)</i> <br>  - <i>Wenn diese Taste gedrückt wird, wird die FindOnPage-Funktion aufgerufen ('text-to-find', true).</i>  <i>und übergibt die ID des Feldes mit dem Text <strong>true</strong></i> <br><br>  Sie haben wahrscheinlich noch ein Attribut bemerkt: <strong><i>wahr / falsch</i></strong> .  Wir werden es verwenden, um zu bestimmen, welche Taste gedrückt wurde (Suche abbrechen oder Suche starten).  Wenn wir auf Abbrechen klicken, übergeben Sie <strong>false</strong> .  Wenn wir auf die Suche klicken, übergeben Sie <strong>true</strong> . <br><br><h4>  OK, mach weiter.  Gehen Sie zu JavaScript </h4><h4>  Wir gehen davon aus, dass Sie die js-Datei bereits erstellt und mit dem DOM verbunden haben. <br><br>  Bevor wir mit dem Schreiben von Code beginnen, machen wir eine Pause und besprechen zunächst, wie alles funktionieren soll.  Das heißt,  Im Wesentlichen werden wir einen Aktionsplan erstellen.  Daher müssen wir bei der Eingabe von Text in das Feld eine Suche auf der Seite durchführen, Tags und Attribute sollten jedoch nicht betroffen sein.  Das heißt,  Nur Textobjekte.  Wie man das erreicht - ich bin sicher, es gibt viele Möglichkeiten.  Aber jetzt werden wir reguläre Ausdrücke verwenden. <br><br>  Der nächste reguläre Ausdruck sucht also nur nach der Textspur.  Typ: "&gt; ... Text ... &lt;".  Das heißt,  Es werden nur Textobjekte durchsucht, während Tags und Attribute unberührt bleiben. <br><br><pre> <code class="javascript hljs">/&gt;(.*?)&lt;<span class="hljs-regexp"><span class="hljs-regexp">/g</span></span></code> </pre><br>  So finden wir die erforderlichen Teile des Codes, die wir analysieren und nach Übereinstimmungen mit dem vom Benutzer eingegebenen Text suchen.  Anschließend fügen wir den gefundenen Objekten Stile hinzu und ersetzen anschließend den HTML-Code durch einen neuen. <br><br>  Fangen wir an.  Erstens die Variablen, die wir brauchen. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; <span class="hljs-comment"><span class="hljs-comment">//input -  ,    //search -      //pr -     &lt;body&gt;&lt;/body&gt; //result -    pr (..    ) //result_arr -  pr,      //locale_HTML -  &lt;body&gt;&lt;/body&gt;    ,    </span></span></code> </pre><br>  Und bestimmen <strong>Sie</strong> sofort den Wert <strong>locale_HTML</strong> , unabhängig davon, ob wir nach etwas suchen oder nicht.  Dies ist erforderlich, um die Originalseite sofort zu speichern und die Stile zurücksetzen zu können. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body ()</span></span></code> </pre><br>  Ok, jetzt lohnt es sich, eine Funktion zu erstellen, die vom <strong>DOM</strong> aufgerufen wird.  Schätzen Sie sofort, dass wir im Inneren 2 Funktionen haben sollten, von denen jede abhängig von der gedrückten Taste funktioniert.  Schließlich führen wir entweder eine Suche durch oder setzen sie auf Null.  Und dies wird, wie Sie sich erinnern, durch das Attribut <strong>true / false</strong> gesteuert.  Sie müssen auch verstehen, dass bei einer erneuten Suche die alten Stile zurückgesetzt werden müssen.  Somit erhalten wir folgendes: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Ok, ein Teil der Logik ist implementiert, mach weiter.  Das empfangene Wort muss auf die Anzahl der Zeichen überprüft werden.  Warum müssen wir schließlich nach 1 Buchstaben / Symbol suchen?  Im Allgemeinen habe ich beschlossen, dies auf 3+ Zeichen zu beschränken. <br><br>  Also nehmen wir zuerst den Wert, den der Benutzer eingegeben hat, und führen abhängig von seiner Länge entweder die Hauptsuchfunktion oder die Warn- und Nullstellungsfunktion aus.  Es wird so aussehen: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { input = document.getElementById(name).value; //     html if(input.length&lt;3&amp;&amp;status==true) { alert('        '); function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  } if(input.length&gt;=3) { //  } function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Jetzt werde ich diesen Abschnitt des Codes erklären.  Das einzige, was nicht klar sein konnte, ist diese Zeile: <br><br>  <i>Funktion FindOnPageBack () {document.body.innerHTML = locale_HTML;</i>  <i>}}</i> <br><br>  Hier ist alles einfach: Die <strong>innerHTML-</strong> Methode gibt den <strong>HTML-</strong> Code des Objekts zurück.  In diesem Fall ersetzen wir einfach den aktuellen <strong>Text</strong> durch den ursprünglichen, den wir beim Laden der gesamten Seite gespeichert haben. <br><br>  Wir gehen weiter.  Wir geben den Hauptvariablen Werte. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { input = document.getElementById(name).value; //     html if(input.length&lt;3&amp;&amp;status==true) { alert('        '); function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  } if(input.length&gt;=3) { function FindOnPageGo() { search = '/'+input+'/g'; //     pr = document.body.innerHTML; //     body result = pr.match(/&gt;(.*?)&lt;/g); //       result_arr = []; //       () } } function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Zu diesem Zeitpunkt haben wir also bereits die wichtigsten Variablen und Werte.  Jetzt müssen wir die erforderlichen Teile der Codestile mit einem hervorgehobenen Hintergrund angeben.  Das heißt,  Überprüfen des ausgewählten Textes auf einen regulären Ausdruck (tatsächlich wird der vom regulären Ausdruck ausgewählte Text erneut vom regulären Ausdruck analysiert)  Dazu müssen Sie aus dem eingegebenen Text (erledigt) einen regulären Ausdruck erstellen und dann die als Takt übergebene Methode ausführen.  Hier hilft uns die <strong>eval ()</strong> -Methode. <br><br>  Nachdem wir den Text ersetzt und das Ergebnis durch Stile erhalten haben, müssen wir im Allgemeinen das aktuelle <strong>HTML</strong> durch das empfangene ersetzen.  Wir machen es <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input,search,pr,result,result_arr, locale_HTML, result_store; locale_HTML = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML; <span class="hljs-comment"><span class="hljs-comment">//     body () function FindOnPage(name, status) { input = document.getElementById(name).value; //     html if(input.length&lt;3&amp;&amp;status==true) { alert('        '); function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  } if(input.length&gt;=3) { function FindOnPageGo() { search = '/'+input+'/g'; //     pr = document.body.innerHTML; //     body result = pr.match(/&gt;(.*?)&lt;/g); //       result_arr = []; //       () for(var i=0; i&lt;result.length;i++) { result_arr[i] = result[i].replace(eval(search), '&lt;span style="background-color:yellow;"&gt;'+input+'&lt;/span&gt;'); //  ,        } for(var i=0; i&lt;result.length;i++) { pr=pr.replace(result[i],result_arr[i]) //    html       } document.body.innerHTML = pr; // html  } } function FindOnPageBack() { document.body.innerHTML = locale_HTML; } //  if(status) { FindOnPageBack(); FindOnPageGo(); } //     if(!status) { FindOnPageBack(); } //  }</span></span></code> </pre><br>  Im Wesentlichen ist alles fertig und das Skript funktioniert bereits.  Aber fügen Sie ein paar weitere Details für die Schönheit hinzu. <br><br>  1) Schneiden Sie die Leerzeichen im Text, den der Benutzer eingibt.  Fügen Sie diesen Code ein: <br><br><pre> <code class="javascript hljs"> input = numer.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^\s+/g</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>); input = numer.replace(<span class="hljs-regexp"><span class="hljs-regexp">/[ ]{1,}/g</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>);</code> </pre><br>  Nach dieser Zeile: <br><br><pre> <code class="javascript hljs"> input = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(name).value; <span class="hljs-comment"><span class="hljs-comment">//     html</span></span></code> </pre><br>  2) Wir werden nach Zufällen suchen (wenn keine Übereinstimmungen gefunden werden, werden wir darüber informieren).  Dieser Code wird nach Variablen in die Funktion FindOnPageGo () eingefügt. <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> warning = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;result.length;i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(result[i].match(<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(search))!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { warning = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(warning == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { alert(<span class="hljs-string"><span class="hljs-string">'    '</span></span>); }</code> </pre><br>  Sie können die Quelle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier sehen</a> . <br>  Sie können die Quelle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> herunterladen. <br><br>  Nun alles.  Natürlich können Sie dem ersten gefundenen Ergebnis eine Schriftrolle hinzufügen, eine Live-Ajax-Suche, und Sie können sich sogar endlos verbessern.  Dies ist eine eher primitive Suche auf der Website.  Der Zweck des Artikels war es, Anfängern zu helfen, wenn die gleiche Frage wie bei mir auftaucht.  Immerhin habe ich keine einfache fertige Lösung gefunden. <br><br>  PS: Für einen korrekten Betrieb ist es erforderlich, die Silbentrennung im HTML-Dokument an den Stellen zu entfernen, an denen sich zwischen den Tags Klartext befindet. <br><br>  Zum Beispiel anstelle von <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Muss <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Dies ist nicht wichtig. Sie können diese Übertragungen automatisch im Dienst entfernen, aber Sie können mir gleichzeitig mitteilen, wie das Problem behoben werden soll, wenn Sie dies vor mir verstehen. <br><br>  Wenn jemand dies geschrieben hat, aber bei einer Live-Suche die Quelle teilt, ist es interessant zu analysieren. <br><br>  Ich freue mich über konstruktive Kritik, Meinungen, vielleicht Empfehlungen. <br><br>  Kürzlich habe ich einen kleinen Code hinzugefügt und eine Live-Suche auf der Seite durchgeführt.  Damit ist die Frage geklärt.  <strong>HTML-</strong> Code hat sich nicht geändert.  <strong>JS</strong> kann <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> schauen. <br><br>  Die Suche wird mit Tags der Klasse "place_for_live_search" durchgeführt.  Damit der Algorithmus den gewünschten Inhalt analysiert, fügen Sie die Klasse hinzu und fertig. </h4></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de438382/">https://habr.com/ru/post/de438382/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de438370/index.html">Cyberkriminalität als Dienstleistung: Dienstleistungen und Preise</a></li>
<li><a href="../de438372/index.html">Die NASA versucht weiterhin, Kontakt zu Opportunity aufzunehmen</a></li>
<li><a href="../de438374/index.html">Wie lade ich OpenStreetMap in Hive?</a></li>
<li><a href="../de438376/index.html">Reverse Engineering. Die Geschichte. Meins</a></li>
<li><a href="../de438380/index.html">Männchen, Pause bei gefangenen Ausnahmen</a></li>
<li><a href="../de438384/index.html">Chemieunterricht: Wie man den Kristall eines Mikrochips für die Fotografie freilegt</a></li>
<li><a href="../de438386/index.html">Auf dem Weg zu den physikalischen Prinzipien der biologischen Evolution</a></li>
<li><a href="../de438388/index.html">Push-Nachrichtenserver</a></li>
<li><a href="../de438390/index.html">Warum Entwickler teurer sind als Geld, wie man sie spart und erhöht</a></li>
<li><a href="../de438392/index.html">Eine kurze Geschichte eines „Smart Tape“</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>