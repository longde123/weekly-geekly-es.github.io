<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëª üë©‚Äç‚úàÔ∏è üîû Programmieren von LibreOffice Base. Teil 2 üßñüèø üëã üë©üèø‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Teil 2 wird die Beziehung zwischen Datenbanktabellen und Formularen er√∂rtert. Insbesondere, wie Sie eine Beziehung zwischen zwei Tabellen definiere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmieren von LibreOffice Base. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445304/"> In Teil 2 wird die Beziehung zwischen Datenbanktabellen und Formularen er√∂rtert.  Insbesondere, wie Sie eine Beziehung zwischen zwei Tabellen definieren und ‚ÄûReferenztabellen‚Äú als Datenquelle f√ºr Dropdown-Listen verwenden. <br><a name="habracut"></a><br>  Versionen von OpenOffice und LibreOffice, f√ºr die diese Nachricht relevant ist, von 3.0 bis 6.2 (die aktuelle Version von LibreOffice).  Ab Version 3.0 kann OpenOffice Base jetzt Skripte in einer Datenbankdatei (mit der Erweiterung .odb) speichern, wodurch die Verteilung von OO Basic-Makrocode bequem wird <br><br>  Es gab einige Verwirrung mit den Formularen in der OpenOffice Base.  Tatsache ist, dass sich im Verlauf der Softwareentwicklung von einer Office-Suite zu einer Datenbankumgebung herausstellte, dass Formulare, Formulare, Formulare und Formulare nicht dasselbe sind.  Und Form ist nicht nur Form.  Ich werde es genauer erkl√§ren. <br><br>  Wenn Sie die OpenOffice Base-Datenbank im Bearbeitungsmodus √∂ffnen, werden auf der linken Seite des Bildschirms vier Lesezeichen angezeigt.  In der russischen Version wird es so klingen <br><br><ul><li>  Tabellen </li><li>  Anfragen </li><li>  Formulare </li><li>  Berichte </li></ul><br>  In diesem Sinne ist das Formular eine separate Anwendung, die in einem separaten Fenster ausgef√ºhrt wird.  Ich stelle auch fest, dass dies tats√§chlich das Fenster ist, in dem die Instanz von OpenOffice Writer gestartet wird. <br><br>  <i>Hinweis</i>  <i>Da das Formular tats√§chlich eine Instanz von OpenOffice Writer ist, k√∂nnen Sie eine Anwendung erstellen, ohne die OpenOffice Base-Komponente zu laden - direkt in OpenOffice Writer.</i> <br><br>  Jedes Formular verf√ºgt √ºber eine Sammlung von Formularen von Formularobjekten.  Zu Beginn ist diese Sammlung leer.  Trotzdem k√∂nnen Sie das Formular √∂ffnen und schlie√üen.  Und sogar Textinformationen darin anzeigen.  Und nur wenn Sie ein neues Steuerelement hinzuf√ºgen (z. B. Schaltfl√§che), erstellt das System ein Formularobjekt mit dem Standardnamen Formular, wenn Sie zu diesem Zeitpunkt noch kein solches Objekt selbst erstellt haben. <br><br>  Am bequemsten ist es, neue Formulare √ºber den Formularnavigator (in der Palette als Kompass angezeigt) zu erstellen, der auch √ºber das Men√º Ansicht | Symbolleiste | Formularnavigation aufgerufen werden kann.  Formularobjekte werden entweder auf der obersten Ebene in der Forms-Auflistung erstellt oder einem anderen Formularobjekt untergeordnet.  Dies hat keine Auswirkungen auf das Erscheinungsbild des Formulars, kann jedoch beim Definieren von Beziehungen zwischen Tabellen hilfreich sein. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/e4b/db1/cebe4bdb1f339866597f8c0ba95736fb.png" alt="Bild"><br></div></div><br><br>  Hier sollten wir eine Anomalie des Form-Objekts beachten.  Dieses Objekt ist in erster Linie ein Objekt, das einer Datenbanktabelle oder einer SQL-Abfrage zugeordnet ist.  Sie k√∂nnen sich Form als ResultSet-Objekt vorstellen (so wie es wirklich ist).  Form hingegen ist ein Container f√ºr Steuerelemente wie FORM in einem HTML-Dokument (und dies gilt auch). <br><br>  √ñffnen Sie das neu erstellte Formular im Bearbeitungsmodus (rechte Maustaste | Bearbeiten).  Erstellen Sie darin ein neues Formularobjekt mit dem Namen Formular oder einem anderen Namen, den Sie m√∂gen.  Erstellen Sie in diesem Formularelement ein untergeordnetes Formularelement. <br><br>  Jedes Formular muss einer vorhandenen Datenbanktabelle, Abfrage oder SQL-Abfrage zugeordnet sein.  Im Slave-Formular k√∂nnen Sie die Regeln so festlegen, dass die nach dem Wert der zugeh√∂rigen Felder im Hauptformular gefilterten Daten als Master / Slave angezeigt werden.  F√ºllen Sie dazu im Eigenschafteneditor des untergeordneten Formulars die Eigenschaften Link-Master-Felder und Link-Slave-Felder aus. <br><br>  Jetzt f√ºgen wir jedem Formular ein Tabellensteuerungselement hinzu, indem wir im Formularnavigator&gt; das entsprechende Formular ausw√§hlen.  Das Tabellensteuerungselement befindet sich nicht im Bereich der verf√ºgbaren Elemente.  Um eine erweiterte Liste von Elementen anzuzeigen, m√ºssen Sie die Schaltfl√§che Weitere Steuerelemente in der Elementpalette aktivieren.  Nach dem Hinzuf√ºgen des Table Control-Elements m√ºssen Sie den Bearbeitungsmodus dieses Elements aufrufen und die f√ºr die Anzeige der Tabelle erforderlichen Spalten hinzuf√ºgen (rechte Maustaste -&gt; Spalte einf√ºgen / ersetzen / l√∂schen). <br><br>  Der zweite Typ ist der in der Praxis h√§ufig anzutreffende Beziehungstyp zwischen Tabellen (nach Master / Slave), den wir betrachten werden - eine Beziehung vom Typ Verzeichnis.  Wir speichern in der Datentabelle den Schl√ºssel des GUID-Objekts, die automatische Inkrementierung, und in der angezeigten Tabelle zeigen wir den vollst√§ndigen Namen aus der verkn√ºpften Tabelle, dem ‚ÄûVerzeichnis‚Äú.  Hierf√ºr gibt es einen bequemen Mechanismus.  F√ºgen Sie im visuellen Tabellen-Designer eine Spalte vom Typ Listenfeld hinzu.  Wenn bereits eine Spalte vom Typ Numerisch / Text erstellt wurde, in der der Schl√ºssel (und nicht der Name) angezeigt wird, kann der Typ in Listenfeld ge√§ndert werden (Rechtsklick | Ersetzen durch | Listenfeld).  Bearbeiten Sie als N√§chstes die Liste der Spalteneigenschaften.  Setzen Sie auf der Registerkarte Daten die Eigenschaft Typ des Listeninhalts auf SQL.  Die Abfrage in der Eigenschaft "Listeninhalt" sollte den angezeigten Wert in der ersten Spalte enthalten, und die Eigenschaft "Gebundenes Feld" ist der Index der Spalte mit dem Schl√ºsselfeld (vorausgesetzt, die erste Spalte hat den Index 0).  Das hei√üt, in der √ºberwiegenden Mehrheit der Abfragen ist dies 1 f√ºr Abfragen vom Typ <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> USERNAME, USERID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USERS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> USERNAME</code> </pre> <br>  Bisher wurde die Arbeit im Konfiguratormodus ohne Programmierung beschrieben.  F√ºgen Sie Funktionen mit OO Basic-Makros hinzu. <br><br>  Erstellen Sie einen Filter f√ºr die Datenbanktabelle nach dem im Textfeld eingegebenen Wert.  Dazu schreiben wir in der Sprache OO Basic eine Prozedur, die ein Ereignis √ºber die Tastatur verarbeitet. <br><br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> TextBox_onKeyUp(oEvent) oDocument = ThisComponent oDocument.LockControllers sText = oEvent.Source.text <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(sText) &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> oForm = ThisComponent.Drawpage.Forms.getByName(<span class="hljs-string"><span class="hljs-string">"MyForm"</span></span>) oForm.<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> = <span class="hljs-string"><span class="hljs-string">"USERNAME LIKE '"</span></span> + sText + <span class="hljs-string"><span class="hljs-string">"%'"</span></span> oForm.reload() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> oDocument.UnlockControllers <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  Wir verkn√ºpfen diese Prozedur mit dem Ereignis "Schl√ºssel freigegeben" des Textfelds (auf der Registerkarte "Ereignis" der Eigenschaftsliste des Elements).  Beachten Sie, dass sich dieses Textfeld in einem anderen Formular befinden muss (nicht in dem, dem der Filter √ºberlagert ist), damit beim erneuten Laden von oForm.reload () der √ºber die Tastatur eingegebene aktuelle Wert nicht "ung√ºltig" wird. <br><br>  Fortsetzung folgt. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de445304/">https://habr.com/ru/post/de445304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de445292/index.html">Was mir noch nie √ºber CSS gesagt wurde</a></li>
<li><a href="../de445294/index.html">Und nochmal zum zweiten Monitor vom Tablet ...</a></li>
<li><a href="../de445298/index.html">Sicherheitswoche 13: Passw√∂rter auf Facebook √∂ffnen</a></li>
<li><a href="../de445300/index.html">Nachrichten aus der Spielebranche (11.-25. M√§rz 2019)</a></li>
<li><a href="../de445302/index.html">"Game of Thrones, mach weiter." Was Apple heute bei seinem Show Time Event gezeigt hat</a></li>
<li><a href="../de445308/index.html">Merkmale des Hypothesentests f√ºr mobile Anwendungen</a></li>
<li><a href="../de445310/index.html">Der Preis f√ºr Sovereign Runet stieg auf 30 Milliarden Pfund</a></li>
<li><a href="../de445312/index.html">JVM-Speicherzuordnung</a></li>
<li><a href="../de445314/index.html">Warum ist es schwierig, Asteroiden abzubauen?</a></li>
<li><a href="../de445316/index.html">DevDay IT verwalten. Leistungsaufzeichnung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>