<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëπ üßú üòÆ Analyse des t√¢ches CTF ü•ä üëã ‚óÄÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="D√©but d√©cembre, nous avons organis√© un concours par √©quipe en s√©curit√© de l'information. Outre OTUS , les organisateurs de l'√©v√©nement pour les ¬´hacke...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analyse des t√¢ches CTF</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/482538/">  <i>D√©but d√©cembre, nous avons organis√© un <a href="https://habr.com/ru/news/t/476892/">concours par √©quipe</a> en s√©curit√© de l'information.</i>  <i>Outre <a href="https://otus.pw/q7Ro/">OTUS</a> , les organisateurs de l'√©v√©nement pour les ¬´hackers blancs¬ª √©taient <a href="https://volgactf.ru/">Volga CTF</a> et <a href="https://ctf.moscow/">CTF.Moscow</a> .</i>  <i>Le moment est peut-√™tre venu de r√©sumer et de parler en d√©tail des t√¢ches.</i> <i><a name="habracut"></a></i> <br><br>  <b>Tout d'abord, l'√©v√©nement a r√©ussi:</b> <br><br><ul><li>  9 t√¢ches ont √©t√© pr√©par√©es dans trois domaines: Pentest, Reverse Engineering, Linux Security and Secure Development; </li><li>  217 √©quipes y ont particip√©; </li><li>  Plus de 800 tentatives de franchissement de drapeaux ont √©t√© enregistr√©es; </li><li>  plus de 300 drapeaux pass√©s ont √©t√© enregistr√©s. </li></ul><br><img src="https://habrastorage.org/webt/wz/hb/ul/wzhbulaaw9vhnblzhk4w9jzpche.png"><br><br>  <b>Deuxi√®mement</b> , les t√¢ches √©taient de complexit√© diff√©rente, donc tout le monde ne pouvait pas r√©soudre le probl√®me: <br><br><img src="https://habrastorage.org/webt/2e/uh/v3/2euhv3gwoznv4womber0-o-513w.png"><br><br>  <b>Troisi√®mement</b> , imm√©diatement apr√®s la fin du marathon en ligne, nous avons organis√© <b>trois webinaires</b> o√π nous avons parl√© des gagnants, donn√© les bonnes r√©ponses et annonc√© les r√©sultats finaux: <br><br>  - R√©sultats CTF: ¬´Linux Security and Secure Development¬ª; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/5tt8xsAhYBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - R√©sultats CTF: Pentest; <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/6Dm-gk86yJk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - les r√©sultats du CTF: "reverse engineering". <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Cx-ALK8laXI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Quatri√®mement</b> , nous vous proposons les <b>conditions des t√¢ches et des descriptions textuelles de leurs solutions</b> .  Veuillez noter que certaines t√¢ches incluaient des fichiers. <br><br><h3>  Direction 1: Pentest </h3><br>  <b>T√¢che 1 - Bases de donn√©es</b> <br><br>  <i>100</i> <i><br><br></i>  <i>Le site utilise activement des bases de donn√©es.</i>  <i>Essayez de faire des injections SQL.</i> <i><br></i>  <i>Lien vers le site: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Solution:</b> <br><br>  Nous allons dans la section principale du magasin / boutique / produits /, apr√®s avoir coll√© dans le champ de recherche, nous trouvons injection sql. <br><br>  Entrez 1 "OU" 1 "=" 1 "-, faites d√©filer vers le bas et voyez un produit qui manquait auparavant, le drapeau est dans sa description. <br><br>  <b><i>Indicateur: indicateur {5ql_1nject10n_15_t00_51mpl3_f0r_y0u}</i></b> <br><br>  <b>T√¢che 2 - Cookies</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Mon ami a d√©velopp√© une plateforme de boutique en ligne.</i>  <i>Il a demand√© un test de bo√Æte noire.</i>  <i>V√©rifiez la s√©curit√© des cookies, vous pourrez peut-√™tre obtenir des droits d'administrateur.</i> <i><br><br></i>  <i>Lien vers le site: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Solution:</b> <br><br>  Connectez-vous, regardez les cookies et voyez les cookies secrets: <br><br>  ¬´MTExMTAxMSAxMDAwMTAgMTExMDEwMSAxMTEwMDExIDExMDAxMDEgMTExMDAxMCAxMTAxMTEwIDExMDAwMDEgMTEwMTEwMSAxMTAwMTAxIDEwMDAxMCAxMTEwMTAgMTAwMDEwIDExMTAxMDEgMTExMDAxMSAxMTAwMTAxIDExMTAwMTAgMTAwMDEwIDEwMTEwMCAxMDAwMDAgMTAwMDEwIDExMDEwMDEgMTExMDAxMSAxMDExMTExIDExMDAwMDEgMTEwMDEwMCAxMTAxMTAxIDExMDEwMDEgMTEwMTExMCAxMDAwMTAgMTExMDEwIDEwMDAxMCAxMDAwMTEwIDExMDAwMDEgMTEwMTEwMCAxMTEwMDExIDExMDAxMDEgMTAwMDEwIDExMTExMDE =¬ª <br><br>  base64 Decode, nous obtenons les donn√©es binaires: 100010 1110101 1110011 1111011 1100101 1110010 1101110 1100001 1101101 1100101 100010 111010 100010 1110101 1110011 1100101 1110010 100010 101100 100000 100010 1101001 1110011 1011111 1100001 1100100 1101101 1101001 1101110 100010 111010 100010 1000110 1100001 1101100 1110011 1100101 100010 1111101 <br><br>  Nous traduisons en texte et obtenons: <code>{"username":"user", "is_admin":"False"}</code> , changez False en True et d√©codez-le √† nouveau: <br><br>  01111011 00100010 01110101 01110011 01100101 01110010 01101110 01100001 01101101 01100101 00100010 00111010 00100010 01110101 01110011 01100101 01110010 00100010 00101100 00100000 00100010 01101001 01110011 01011111 01100001 01100100 01101101 01101001 01101110 00100010 00111010 00100010 01010100 01110010 01110101 01100101 00100010 01111101 <br><br>  ¬´MDExMTEwMTEgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDExMDExMTAgMDExMDAwMDEgMDExMDExMDEgMDExMDAxMDEgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDExMTAxMDEgMDExMTAwMTEgMDExMDAxMDEgMDExMTAwMTAgMDAxMDAwMTAgMDAxMDExMDAgMDAxMDAwMDAgMDAxMDAwMTAgMDExMDEwMDEgMDExMTAwMTEgMDEwMTExMTEgMDExMDAwMDEgMDExMDAxMDAgMDExMDExMDEgMDExMDEwMDEgMDExMDExMTAgMDAxMDAwMTAgMDAxMTEwMTAgMDAxMDAwMTAgMDEwMTAxMDAgMDExMTAwMTAgMDExMTAxMDEgMDExMDAxMDEgMDAxMDAwMTAgMDExMTExMDE =¬ª <br><br>  Remplacez la valeur des cookies par une nouvelle et acc√©dez au profil utilisateur. <br>  <i><b>Drapeau: flag {d0_y0u_l1k3_c00k13s}</b></i> <br><br>  <b>T√¢che 3 - Lecture de fichiers</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Nous rencontrons souvent des sources qui fuient et une √©trange logique de travail.</i>  <i>Les vecteurs d'attaque possibles sont g√©n√©ralement trouv√©s par fuzzing.</i>  <i>Je vous sugg√®re de faire √ßa.</i> <i><br><br></i>  <i>Lien vers le site: <code>http://193.41.142.9:8001/shop/login</code></i> <br><br>  <b>Solution:</b> <br><br>  On d√©marre dirb (common.txt habituel suffit), on trouve les pages <code>/shop/_source/</code> et <code>/shop/files/</code> . <br><br>  Ayant familiaris√© avec la source <code>_source</code> nous comprenons que nous avons la vuln√©rabilit√© Path Traversal + quelques filtres simples. <br><br>  Pour obtenir l'indicateur, vous devez faire une demande POST √† <code>/shop/files/</code> avec le param√®tre "file", dont la valeur doit √™tre <code>%2E%2E/%2E%2E/flag</code> . <br><br>  En r√©ponse √† la demande, il y aura un drapeau. <br><br>  <i><b>Drapeau: flag {y0u_g0t_0ur_s3cr3t}</b></i> <br><br><h3>  Direction 2: ¬´Linux Security and Secure Development¬ª </h3><br>  <b>T√¢che 1 - VCS</b> <br><br>  50 <br><br>  <i>Mais le client nous a-t-il donn√© quelque chose de superflu?</i> <i><br></i>  <i>L'archive contient le code source d'une partie du site.</i> <i><br></i>  <i>Lien vers le site: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Pi√®ce jointe: task.7z</i> <br><br>  <b>Solution:</b> <br><br>  Nous avons acc√®s au code source.  Il s'est av√©r√© que les d√©veloppeurs ont √©galement mis un r√©f√©rentiel git.  Nous regardons git log, nous voyons commit avec des correctifs.  Nous utilisons git show &lt;hash commit&gt;, nous voyons les fichiers modifi√©s et leur contenu, un drapeau est stock√© dans l'une des lignes. <br><br>  <i><b>drapeau {22717297f6a3603608d260c9e5f69e0a}</b></i> <br><br>  <b>T√¢che 2 - Algo</b> <br><br>  <i>50</i> <i><br><br></i>  <i>Nous avons un nouveau d√©fi.</i>  <i>Effectuez une v√©rification de d√©veloppement en toute s√©curit√©.</i>  <i>Le client a fourni une archive avec la partie ouverte du site en cours de d√©veloppement.</i>  <i>Pour tester son algorithme de hachage, il a fourni un hachage: 666c61677b32646733326473323334327d.</i>  <i>V√©rifiez l'algorithme pour la possibilit√© de transformation inverse.</i> <i><br><br></i>  <i>L'archive contient le code source d'une partie du site.</i> <i><br></i>  <i>Lien vers le site: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Pi√®ce jointe: task.7z</i> <br><br>  <b>Solution:</b> <br><br>  Le code source a un algorithme de hachage de mot de passe.  En fait, ce n'est pas un algorithme de hachage, mais simplement la conversion de donn√©es d'un format de cha√Æne en hexad√©cimal. <br><br>  Nous utilisons Python: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> binascii binascii.unhexlify(<span class="hljs-string"><span class="hljs-string">"666c61677b32646733326473323334327d"</span></span>)</code> </pre> <br>  Nous <i><b>obtenons le</b></i> drapeau: <i><b>flag {2dg32ds2342}</b></i> <br><br>  <b>T√¢che 3 - Fichiers fichiers fichiers</b> <br><br>  <i>150</i> <i><br><br></i>  <i>Terminons l'audit.</i>  <i>Voyez-vous √©galement cette vuln√©rabilit√©?</i>  <i>Super.</i>  <i>Ainsi, obtenir un fichier secret est facile pour vous.</i> <i><br></i>  <i>L'archive contient le code source d'une partie du site.</i> <i><br></i>  <i>Lien vers le site: <code>http://193.41.142.9:8002/</code></i> <i><br></i>  <i>Pi√®ce jointe: task.7z</i> <br><br>  <b>Solution:</b> <br><br>  Dans le code source du module principal du programme, vous pouvez remarquer le lecteur de fichiers (c'est l'application principale de ce service).  La fonction de v√©rification de l'existence d'un fichier ne v√©rifie en aucun cas les caract√®res sp√©ciaux et concat√®ne simplement deux lignes =&gt; vuln√©rabilit√© de chemin d'acc√®s. <br><br>  Toujours dans Dockerfile, docker-compose.yml, vous pouvez voir les mappages de fichiers et la structure de chargement dans le conteneur.  En utilisant ces connaissances, nous g√©n√©rons une charge utile: <br><br><pre> <code class="plaintext hljs">http://193.41.142.9:8002/files?password=qgzc6!78zxcbkj123fdgd234&amp;filename=../../../../../../src/secret_files/flag.txt</code> </pre> <br>  <i><b>drapeau {a0a7c3fff21f2aea3cfa1d0316dd816c}</b></i> <i><b><br></b></i> <br><h3>  Direction 3: "reverse engineering" </h3><br>  <b>T√¢che 1 - Serpent</b> <br>  <i>100</i> <i><br><br></i>  <i>Notre entreprise essaie toujours de contourner toute protection logicielle.</i>  <i>Aidez-nous cette fois √† g√©rer Python.</i> <i><br></i>  <i>Fichier attach√©: task.pyc</i> <br><br>  <b>Solution:</b> <br><br>  Nous utilisons le bytecode Python d√©compil√© par le module uncompyle6: <br>  uncompyle6 task.pyc. <br>  On d√©compile, on obtient un drapeau: <br><br>  <i><b>indicateur {w3l1_pyth0n}</b></i> <i><b><br></b></i> <br>  <b>T√¢che 2 - Robot</b> <br>  <i>150</i> <i><br><br></i>  <i>Cette fois, nous sommes tomb√©s sur une application √©trange, aidez-moi √† trouver le mot de passe √† saisir.</i> <i><br></i>  <i>Pi√®ce jointe: app.apk</i> <br><br>  <b>Solution:</b> <br><br>  L'application est sur Android, il suffit donc de la charger dans un analyseur statique tel que BytecodeViewer et de voir le code source restaur√© du programme.  Notez qu'il s'agit de Kotiln, et il utilise souvent une programmation fonctionnelle, comme dans ce cas.  Dans l'une des fonctions anonymes d√©compil√©es, nous trouvons la v√©rification du drapeau, la v√©rification elle-m√™me: <br><br><pre> <code class="kotlin hljs">(String)paramFunction1.invoke(<span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>.valueOf(Arrays.equals(paramString, h)));  invoke: ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">"flag{"</span></span>); ((StringBuilder)localObject).append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$m); ((StringBuilder)localObject).append(<span class="hljs-string"><span class="hljs-string">'}'</span></span>);</code> </pre> <br>  variable h: {102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50, 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55}; <br><br>  On voit qu'il ressemble √† des caract√®res imprim√©s cod√©s.  Nous utilisons Python: <br><br>  '' .join (chr (x) pour x in [102, 97, 50, 98, 102, 54, 52, 54, 101, 52, 57, 97, 98, 53, 101, 53, 54, 102, 50 , 98, 55, 52, 52, 56, 48, 98, 97, 54, 49, 48, 49, 55]) <br><br>  Nous obtenons le drapeau: <br><br>  <i><b>drapeau {fa2bf646e49ab5e56f2b74480ba61017}</b></i> <i><b><br></b></i> <br>  <b>Qu√™te 3 - Bin</b> <br><br>  <i>200</i> <i><br><br></i>  <i>Cette fois, nous sommes tomb√©s sur un fichier binaire.</i>  <i>La t√¢che est la m√™me, obtenez le mot de passe secret.</i> <i><br></i>  <i>Pi√®ce jointe: t√¢che</i> <br><br>  <b>Solution:</b> <br>  Un fichier binaire est donn√©.  Nous chargeons dans le d√©sassembleur et voyons six fonctions de validation √©crites en C ++. <br><br>  Ils sont ex√©cut√©s de mani√®re identique et sont appel√©s les uns dans les autres, v√©rifiant le drapeau en morceaux de 5 √©l√©ments. <br><br>  Nous le restaurons par √©tapes en utilisant les informations du d√©monteur.  Nous obtenons le drapeau en plusieurs parties: <br><br>  0) v√©rification de la longueur <br>  1) drapeau { <br>  2) feefa <br>  3) _172a <br>  4) k14sc <br>  5) _eee} <br><br>  Combinez et obtenez le drapeau: <br><br>  <i><b>drapeau {feefa_172ak14sc_eee}</b></i> <br><br>  C'est tout, chers coll√®gues!  Merci √† tous pour votre participation, prenez soin de vous, de vos proches et de vos donn√©es!  Bonne ann√©e! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482538/">https://habr.com/ru/post/fr482538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482526/index.html">Conf√©rence jubilaire de Donald Knuth "√Ä l'arbre de No√´l"</a></li>
<li><a href="../fr482530/index.html">D√©di√© √†: une technologie morte en 2019</a></li>
<li><a href="../fr482532/index.html">Impulsion de sprint: cr√©er un travail efficace au sein d'une grande √©quipe</a></li>
<li><a href="../fr482534/index.html">Encore une fois sur la complexit√© de l'architecture et le seuil d'entr√©e</a></li>
<li><a href="../fr482536/index.html">Pixel art pour d√©butants: mode d'emploi</a></li>
<li><a href="../fr482540/index.html">Software VS Hardware: quelle est la tendance et qui est le futur?</a></li>
<li><a href="../fr482544/index.html">Rassembler une √©quipe de d√©marrage avec ¬´0¬ª - instructions √©tape par √©tape pour les plus petits</a></li>
<li><a href="../fr482546/index.html">VK Tech: une ann√©e de d√©veloppement en chiffres Git</a></li>
<li><a href="../fr482548/index.html">Security Week 52 + 1: les 3 principales nouvelles non standard de l'ann√©e</a></li>
<li><a href="../fr482550/index.html">Le myst√©rieux programme LyX. 2e partie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>