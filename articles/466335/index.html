<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéΩ ü¶í üë®‚Äçüëß Crear una aplicaci√≥n Slack usando las caracter√≠sticas de 8base üë®‚Äçüë¶‚Äçüë¶ üßëüèΩ‚Äçü§ù‚Äçüßëüèº üëç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Slack es una gran aplicaci√≥n para la comunicaci√≥n interna entre equipos. Una de las caracter√≠sticas que podemos expandir f√°cilmente al crear e integra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Crear una aplicaci√≥n Slack usando las caracter√≠sticas de 8base</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466335/"><img src="https://habrastorage.org/getpro/habr/post_images/ee8/574/873/ee8574873908032aed87f5703682d618.png" alt="imagen"><br><br>  Slack es una gran aplicaci√≥n para la comunicaci√≥n interna entre equipos.  Una de las caracter√≠sticas que podemos expandir f√°cilmente al crear e integrar bots de chat y comandos de barra de chat que permiten a los usuarios interactuar con servicios externos.  Un excelente bot de Slack, muy popular y √∫til, es el bot de GitHub, que publica actualizaciones sobre solicitudes de extracci√≥n, confirmaciones e ish en el canal. <br><br>  En este art√≠culo, crearemos un bot Slack que publicar√° actualizaciones al crear un pedido en la plataforma de comercio electr√≥nico inventada que administramos. <br><br>  La plataforma de comercio electr√≥nico es una aplicaci√≥n sin servidor creada con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">8base</a> .  En este art√≠culo, utilizaremos las funciones de 8base para escuchar Crear eventos en un modelo de datos usando disparadores. <br><br>  Un activador es un tipo de funci√≥n que se activa en respuesta a un evento de mutaci√≥n de datos: <i>crear</i> , <i>actualizar</i> o eliminar un objeto.  8base proporciona dos tipos de disparadores, dependiendo de si el desarrollador desea ejecutar la funci√≥n antes o despu√©s de cambiar los datos: trigger.before y trigger.after. <br><br><h4>  Necesitar√°s </h4><br><ul><li>  Comprensi√≥n b√°sica de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">React</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Node.js.</a>  Antes de comenzar, aseg√∫rese de tener Nodo y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">npm</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hilo instalados</a> . </li><li>  Usaremos algunas consultas GraphQL en el proyecto, por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lo que es √∫til estar</a> familiarizado con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GraphQL</a> . </li><li>  Cree una cuenta de 8base (si a√∫n no lo ha hecho) visitando su <a href="http://">sitio web</a> . </li></ul><br><h3>  Preparaci√≥n del entorno 8base </h3><br>  Cree una cuenta o inicie sesi√≥n en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://auth.8base.com/login%3Fstate%3Dg6Fo2SBpTkZiUGl6QXJ5VFVkZS16U09yanNQU3dxNlJlQlV2NqN0aWTZIC04bGxiaENJU05ha0MzVUduT2ZuU19senhlbE5VN1l1o2NpZNkgcUdIWlZ1NUN4WTVrbGl2bTI4T1BMam9wdnNZcDBiYUQ%26client%3DqGHZVu5CxY5klivm28OPLjopvsYp0baD%26protocol%3Doauth2%26response_type%3Dtoken%2520id_token%26redirect_uri%3D">8base</a> .  Para cuentas nuevas, 8base proporciona acceso gratuito de 30 d√≠as. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/064/449/5e8/0644495e868a6e3b11bf27df93d61080.png" alt="imagen"><br>  ‚Äç2.  Despu√©s de iniciar sesi√≥n, vaya a la p√°gina de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">datos</a> y haga clic en "Nueva tabla" para comenzar a configurar el back-end. <br><img src="https://habrastorage.org/getpro/habr/post_images/011/8e4/ce6/0118e4ce63f1da4bc98b872b1e76a260.png" alt="imagen"><br>  ‚Äç3.  Despu√©s de cargar una nueva tabla, ver√° un diagrama y podr√° comenzar a definir los campos.  A continuaci√≥n, cree una tabla llamada Pedidos, que consta de los siguientes campos: <br>  - <b>usuario</b> : el tipo de campo es Tabla.  En la secci√≥n derecha, seleccione la tabla Usuarios y en el campo Nombre del campo de relaci√≥n especifique "pedidos".  Luego marque la casilla "Permitir m√∫ltiples <b>pedidos</b> por <b>usuario</b> ". <br><img src="https://habrastorage.org/getpro/habr/post_images/64f/24f/8d0/64f24f8d0f5f626c397708980ef822ea.png" alt="imagen"><br>  - elementos: el tipo de campo es JSON.  Este campo contiene informaci√≥n sobre los productos que el usuario compra, por ejemplo, precio, nombre e imagen. <br>  Nuestro esquema es bastante simple y debe cubrir las funciones necesarias.  A continuaci√≥n, configuremos la aplicaci√≥n Slack e inst√°lela. <br><br><h3>  Crear una aplicaci√≥n floja </h3><br>  Comience iniciando sesi√≥n en su Slack o cree uno nuevo para esta gu√≠a.  Visite la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">consola Slack API Console</a> para crear una nueva aplicaci√≥n Slack. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/870/fb8/956/870fb8956f2b3b4dabceadf602df6d0d.png" alt="imagen"><br><br>  Llame a esta aplicaci√≥n Slack despu√©s de nuestra plataforma ficticia de comercio electr√≥nico llamada <b>Shop Quick</b> . <br><br>  Despu√©s de crear la aplicaci√≥n en nuestro taller, podemos posponer temporalmente la aplicaci√≥n Slack y trabajar en la creaci√≥n de la funci√≥n 8base, que escuchar√° los eventos de la creaci√≥n de nuevos pedidos en la plataforma <b>Shop Quick</b> . <br><br><h4>  Crear una funci√≥n 8base </h4><br>  La plataforma 8base ofrece caracter√≠sticas que facilitan la creaci√≥n de aplicaciones sin servidor.  Para esta aplicaci√≥n de Slack, necesitamos integraciones y l√≥gica personalizada que no puedan implementarse solo con CRUD.  En nuestro caso, queremos enviar mensajes a Slack al crear un nuevo pedido.  Podemos lograr esto usando las funciones de 8base, escuchando los eventos Crear, Actualizar y Eliminar, usaremos disparadores. <br><br>  Un desencadenante es una funci√≥n que se desencadena en respuesta a un evento de mutaci√≥n de datos: cuando se crea, actualiza o elimina un objeto.  Hay dos tipos de disparadores, dependiendo de si se ejecutan antes o despu√©s de los cambios de datos: trigger.before y trigger.after. <br><br>  En nuestro caso, llamaremos a nuestra funci√≥n despu√©s de crear el pedido.  Por lo tanto, debemos especificar Orders.create.  Los valores posibles para el evento de datos son crear, actualizar y eliminar. <br><br><h4>  8base CLI </h4><br>  CLI 8base le permite escribir JavaScript personalizado o TypeScript para agregar efectivamente la l√≥gica, enfoc√°ndose solo en lo que es exclusivo de su aplicaci√≥n, mientras evita el c√≥digo repetitivo. <br><br>  La interfaz de l√≠nea de comandos (CLI) de 8base facilita agregar l√≥gica de servidor personalizada a sus aplicaciones directamente desde la terminal.  Instale la CLI ejecutando el siguiente comando en una terminal: <br><br><pre><code class="javascript hljs">npm install -g <span class="hljs-number"><span class="hljs-number">8</span></span>base</code> </pre> <br>  Despu√©s de instalar la CLI a nivel mundial, debe iniciar sesi√≥n para poder acceder a su cuenta de 8base.  Ejecute el siguiente comando para iniciar sesi√≥n: <br>  ‚Äç <br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">8</span></span>base login</code> </pre><br>  Cuando ejecute este comando, aparecer√° una ventana del navegador para la autorizaci√≥n de la CLI.  Iniciar sesi√≥n le da acceso a la CLI a su cuenta de 8base.  Puede encontrar otros comandos ofrecidos por la CLI ejecutando el comando de ayuda: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">8</span></span>base help</code> </pre><br>  A continuaci√≥n, inicializamos el proyecto 8base usando la CLI ejecutando el siguiente comando en su terminal: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">8</span></span>base init shop-quick-functions</code> </pre><br>  Despu√©s de ejecutar el comando, se crear√° una nueva carpeta.  La estructura de la carpeta deber√≠a verse as√≠: <br><br><pre> <code class="javascript hljs">‚îú‚îÄ‚îÄ src/ | ‚îú‚îÄ‚îÄ function1.ts | ‚îî‚îÄ‚îÄ function2.js ‚îú‚îÄ‚îÄ <span class="hljs-number"><span class="hljs-number">8</span></span>base.yml ‚îî‚îÄ‚îÄ package.json</code> </pre> <br>  La CLI carga un proyecto de nodo regular, que le permite instalar dependencias usando npm o yarn.  Adem√°s, la CLI de 8base viene con Webpack y TypeScript preconfigurados de f√°brica para que pueda escribir c√≥digo JavaScript o TypeScript. <br><br>  Configuramos caracter√≠sticas y permisos personalizados en 8base.yml.  Cambiamos la configuraci√≥n actual del archivo 8base.yml de acuerdo con nuestras necesidades.  Abra el archivo y realice los siguientes cambios: <br><br><pre> <code class="javascript hljs">functions: notifySlack: handler: code: src/notifySlack.js type: trigger.after operation: Orders.create</code> </pre> <br>  La estructura del archivo es similar a cualquier archivo YAML.  El primer bloque que veremos es un bloque de funci√≥n;  Pondremos todas las definiciones de funciones que crearemos en este bloque.  Por ejemplo, la funci√≥n notifySlack que creamos;  La funci√≥n tiene las siguientes propiedades: <br><br><ul><li>  <b>manejador</b> : ruta de archivo relativa al manejador de la funci√≥n notifySlack. </li><li>  <b>operaci√≥n</b> : el par√°metro determina qu√© tipo de datos y evento debe escuchar el disparador. </li><li>  <b>tipo</b> : si se inician antes o despu√©s de los cambios de datos.  Hay dos tipos: trigger.before y trigger.after. </li></ul><br>  El siguiente paso es crear un archivo de controlador para comenzar a recibir eventos despu√©s del desencadenante.  Para enviar actualizaciones a Slack usaremos el m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">chat.postMessage</a> .  Los mensajes se enviar√°n utilizando el m√©todo de publicaci√≥n HTTP: cada solicitud al m√©todo chat.postMessage estar√° firmada por el token de acceso OAuth de su bot.  Visite la p√°gina de detalles de su aplicaci√≥n, haga clic en el enlace OAuth &amp; Permissions en la barra de navegaci√≥n lateral. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/180/c54/94d/180c5494dcf0df2c5de56fcefbc65c2a.png" alt="imagen"><br><br>  ‚Äç Copie el token y vaya a la pesta√±a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Variables de entorno</a> en la p√°gina de configuraci√≥n de 8base.  Sus funciones tienen acceso a todas las variables de entorno creadas.  <b>Siempre</b> almacene sus valores y credenciales confidenciales aqu√≠, y no los coloque directamente en la base de datos del c√≥digo fuente.  Cree una nueva variable llamada SLACK_ACCESS_TOKEN, pegue el token copiado y gu√°rdelo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84a/b45/96b/84ab4596bc04520f2ae6da4675274dc4.png" alt="imagen"><br><br>  Ahora agreguemos el c√≥digo al editor.  Cree un archivo llamado utils.js en el directorio src.  Abra el archivo en su editor favorito y copie lo siguiente en √©l: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils.js */</span></span><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sendMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> message = <span class="hljs-string"><span class="hljs-string">`A new order was just created`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> messageBody = dataBuilder(order); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> body = { <span class="hljs-attr"><span class="hljs-attr">channel</span></span>: <span class="hljs-string"><span class="hljs-string">'general'</span></span>, <span class="hljs-attr"><span class="hljs-attr">attachments</span></span>: messageBody, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: message }; ‚Äç <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Message body'</span></span>, { body }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Sending message request'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> makeRequest(body); };‚Äç</code> </pre> <br>  Por lo tanto, la funci√≥n sendMessage acepta un pedido con un argumento, que es un objeto que contiene los campos que creamos para el modelo de pedido.  Ahora necesitamos crear un nuevo mensaje usando el objeto de orden, por lo que pasamos el objeto a una funci√≥n llamada dataBuilder.  La funci√≥n dataBuilder devuelve un objeto en el formato de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">archivos adjuntos</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Slack</a> . <br><br>  Luego creamos un cuerpo de solicitud que contiene el canal del espacio de trabajo en el que publicamos el mensaje, los archivos adjuntos devueltos por dataBuilder y finalmente el texto.  Luego, la solicitud para publicar el mensaje es enviada por la funci√≥n makeRequest. <br><br>  Creemos la funci√≥n dataBuilder, copie el fragmento a continuaci√≥n y actualice el archivo utils.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sendMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { ...}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dataBuilder = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { items } = order; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> itemSections = items.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'section'</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: item.name, <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-string"><span class="hljs-string">'#3AA3E3'</span></span>, <span class="hljs-attr"><span class="hljs-attr">accessory</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'image'</span></span>, <span class="hljs-attr"><span class="hljs-attr">image_url</span></span>: item.image, <span class="hljs-attr"><span class="hljs-attr">alt_text</span></span>: item.name, }, }; }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = [ { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'section'</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'mrkdwn'</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">`*There are </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${items.length}</span></span></span><span class="hljs-string"> items in the order*`</span></span>, }, }, ...itemSections, ]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; };</code> </pre> <br>  La funci√≥n dataBuilder acepta un objeto de pedido y crea una secci√≥n para cada art√≠culo del pedido utilizando el nombre y la imagen del art√≠culo.  Puede usar el generador de mensajes para obtener una vista previa del formato de los mensajes y archivos adjuntos en tiempo real. <br><br>  A continuaci√≥n, agregamos la funci√≥n makeRequest, que env√≠a el cuerpo del mensaje al taller de Slack. <br><br>  Copie el siguiente fragmento en el archivo utils.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fetch <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'node-fetch'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sendMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { ... }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dataBuilder = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { ... }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeRequest = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://slack.com/api/chat.postMessage'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> headers = { <span class="hljs-attr"><span class="hljs-attr">Authorization</span></span>: <span class="hljs-string"><span class="hljs-string">`Bearer </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${process.env.SLACK_ACCESS_TOKEN}</span></span></span><span class="hljs-string">`</span></span>, <span class="hljs-string"><span class="hljs-string">'Content-type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fetch(url, { <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'post'</span></span>, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(data), headers, }); };</code> </pre> <br>  Primero instale el paquete node-fetch ejecutando el siguiente comando: <br><br><pre> <code class="javascript hljs">npm install node-fetch</code> </pre><br>  Importamos el paquete y lo usamos en la funci√≥n makeRequest.  Como parte de la funci√≥n, agregaremos todos los encabezados necesarios a la solicitud.  La solicitud debe firmarse con el encabezado Autorizaci√≥n de portador.  El token se obtendr√° de la variable de entorno que creamos anteriormente.  Finalmente, devolvemos la solicitud POST usando la API fetch. <br><br>  Ahora tenemos todo lo que necesita para enviar un mensaje al Slack warspace usando un bot.  Creemos un controlador de funciones al que hagamos referencia en el archivo 8base.yml anterior. <br><br>  Cree un archivo llamado notifySlack.js en el directorio src, abra el archivo y copie el c√≥digo en √©l: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/notifySlack.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { sendMessage } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./utils'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (event) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Sending notification to slack'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> res = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sendMessage(event.data); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Notification sent successfully'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: event.data, }; };</code> </pre> <br>  En el archivo, utilizamos la funci√≥n de utilidad sendMessage que creamos.  El manejador de funciones 8base pasa dos argumentos: un evento y un contexto.  La estructura del objeto de evento depende del tipo de funci√≥n, y el objeto de contexto contiene propiedades y m√©todos √∫tiles, que puede leer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br>  En nuestro caso, el objeto de evento contendr√° la Orden creada, que consta de dos campos de usuario y elementos.  El objeto Order es una propiedad de los datos del objeto de evento, y pasamos este objeto a la funci√≥n sendMessage para notificar a Slack. <br><br>  La llamada a la funci√≥n est√° envuelta en try / catch, porque no queremos que ning√∫n error provoque que la funci√≥n finalice.  Finalmente, devolvemos los datos del evento al final de la funci√≥n. <br>  Con estos datos, podemos indicar el asunto y el cuerpo del mensaje, y luego enviar el correo utilizando el transportador que creamos.  Guarde el archivo e implemente la funci√≥n utilizando la CLI de 8base ejecutando el siguiente comando: <br><br>  ‚Äç <pre> <code class="javascript hljs"># deploy <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> project root directory <span class="hljs-number"><span class="hljs-number">8</span></span>base deploy</code> </pre> <br>  Despu√©s de dise√±ar con √©xito la funci√≥n, deber√≠a ver la siguiente salida del terminal: <br>  ‚Äç <br><pre> <code class="javascript hljs">‚ûú <span class="hljs-number"><span class="hljs-number">8</span></span>base deploy deploy done. Time: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">553</span></span> ms.</code> </pre> <br><h4>  Funciones de depuraci√≥n </h4><br>  Es importante tener registros en sus funciones para que pueda depurar f√°cilmente las funciones y realizar un seguimiento de lo que est√° sucediendo all√≠.  8base tiene una p√°gina para ver todas las funciones adjuntas a su perfil.  Puede ver f√°cilmente todos los registros procedentes de cada funci√≥n. <br><br>  Vaya a 8base <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dashboard</a> y haga clic en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">L√≥gica</a> en el men√∫ lateral.  En la p√°gina l√≥gica, puede ver todas las funciones establecidas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a2/c20/38a/1a2c2038afb3be1b65769a05cda9482b.png" alt="imagen"><br>  Para una funci√≥n espec√≠fica, haga clic en <b>Ver registros</b> para ver todos los registros.  A continuaci√≥n, instalamos la aplicaci√≥n Slack y la probamos. <br><br><h3>  Instalar y probar la aplicaci√≥n Slack </h3><br>  Terminemos el √∫ltimo paso e instalemos la aplicaci√≥n Slack en el espacio de trabajo.  Para hacer esto, regrese a la consola de la aplicaci√≥n Slack y haga clic en <b>Instalar aplicaci√≥n</b> en la barra de navegaci√≥n lateral. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/76e/212/b74/76e212b74709411272256b422a77f653.png" alt="imagen"><br><br>  En la p√°gina, ver√° una advertencia sobre c√≥mo agregar una funci√≥n o autoridad para instalar la aplicaci√≥n.  Haga clic en √©l y agregue el permiso. <br><br>  Despu√©s de instalar con √©xito la aplicaci√≥n, podemos probar la funci√≥n y la aplicaci√≥n.  Vaya a la p√°gina de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Datos de</a> 8base, haga clic en la tabla Pedidos en la barra lateral.  En el visor de la tabla de pedidos, haga clic en la pesta√±a <b>DATOS</b> , aqu√≠ podemos agregar nuevas filas a la tabla. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c0/fab/84c/7c0fab84c009f1f3620ab57e41086a55.png" alt="imagen"><br><br>  En la tabla de datos, presione el bot√≥n {+} y cree una nueva fila. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1a/015/2bf/b1a0152bf7dad2951b3ef2d1e0a07310.png" alt="imagen"><br><br>  Puede completar el campo del producto con los siguientes datos: <br><br><pre> <code class="javascript hljs">[{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Food product"</span></span>, <span class="hljs-string"><span class="hljs-string">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://static.pexels.com/photos/368893/pexels-photo-368893.jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"The real fruit"</span></span>, <span class="hljs-string"><span class="hljs-string">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://static.pexels.com/photos/368893/pexels-photo-368883.jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }]</code> </pre> <br>  Haga clic en <b>Agregar fila</b> para crear un nuevo pedido.  Luego vaya al taller donde instal√≥ la aplicaci√≥n Slack, haga clic en el canal general y ver√° un nuevo mensaje del bot. <br><br>  Deber√≠a verse as√≠: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/739/025/ef1/739025ef157a8879e5a1aa63595036de.png" alt="imagen"><br><br>  Nueva notificaci√≥n del bot 8base en el canal Slack <br><br><h3>  Palabras finales </h3><br>  Crear una aplicaci√≥n Slack es una buena idea;  Slack es el principal medio de comunicaci√≥n para la mayor√≠a de los equipos, y puede permitirle tener toda la informaci√≥n que necesita para el trabajo diario. <br><br>  Para este art√≠culo, utilizando la funcionalidad 8base, creamos una aplicaci√≥n Slack simple que env√≠a mensajes sobre nuevos pedidos en el sistema.  Los mensajes enviados fueron bastante simples.  Slack tiene un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">formato</a> enriquecido para sus mensajes, y puede complicarlos para que contengan m√°s informaci√≥n.  Lea m√°s sobre las caracter√≠sticas de 8base <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Vea el c√≥digo en este art√≠culo en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> . <br><br>  Gracias por leer </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/466335/">https://habr.com/ru/post/466335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../466317/index.html">Consejos y trucos de mi canal de Telegram @pythonetc, agosto de 2019</a></li>
<li><a href="../466319/index.html">Oferta: VMware compra inicio basado en la nube</a></li>
<li><a href="../466323/index.html">Creamos un juego de plataforma port√°til en el microcontrolador Cortex M0 +</a></li>
<li><a href="../466329/index.html">Mapa electr√≥nico de la vinificaci√≥n en Rusia. Dise√±o y contenido.</a></li>
<li><a href="../466333/index.html">C√≥mo organizar un lugar de trabajo para ti</a></li>
<li><a href="../466337/index.html">¬øDe qu√© color es tu funci√≥n?</a></li>
<li><a href="../466341/index.html">Entrenamiento Cisco 200-125 CCNA v3.0. D√≠a 33. Preparaci√≥n para el examen ICND1</a></li>
<li><a href="../466345/index.html">M√©todo de onda para construir un esquema de color.</a></li>
<li><a href="../466347/index.html">Entrenamiento Cisco 200-125 CCNA v3.0. D√≠a 34. Concepto avanzado de VLAN</a></li>
<li><a href="../466349/index.html">C√≥mo realizar pruebas A / B en 15,000 tiendas sin conexi√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>