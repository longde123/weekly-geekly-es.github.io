<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💵 🌐 👩🏽‍💻 5 pelajaran yang kami pelajari dengan menulis lebih dari 300.000 baris kode infrastruktur 😲 👩🏽‍✈️ 👩🏽‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kelas master singkat tentang pengembangan kode infrastruktur 





 Pada bulan Oktober tahun ini, saya membuat presentasi di konferensi HashiConf 2018...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>5 pelajaran yang kami pelajari dengan menulis lebih dari 300.000 baris kode infrastruktur</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/434774/"><h3 id="kratkiy-master-klass-po-razrabotke-infrastrukturnogo-koda">  Kelas master singkat tentang pengembangan kode infrastruktur </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1f2/0b9/17f/1f20b917f7f598d845324b4b8ce18bbf.jpg" alt="gambar"></p><br><p>  Pada bulan Oktober tahun ini, saya membuat presentasi di konferensi HashiConf 2018, di mana saya berbicara tentang 5 pelajaran utama yang saya dan rekan Gruntwork pelajari dalam proses menciptakan dan memelihara <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perpustakaan lebih dari 300.000 baris kode infrastruktur yang</a> digunakan oleh ratusan perusahaan dalam sistem produksi.  Dalam publikasi ini, saya akan berbagi video dan slide dari presentasi, serta versi teks singkat dari deskripsi 5 pelajaran utama. </p><br><h3 id="video-i-slaydy">  Video dan slide </h3><br><iframe width="560" height="315" src="https://www.youtube.com/embed/RTEgE2lcyk4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3 id="vstuplenie-devops-seychas--v-kamennom-veke">  Intro: DevOps Now in the Zaman Batu </h3><br><p>  Terlepas dari kenyataan bahwa industri ini penuh dengan kata-kata progresif yang modis: Kubernetes, layanan mikro, kisi-kisi layanan, infrastruktur yang tidak dapat diubah, data besar, danau data, dll. Kenyataannya adalah bahwa ketika Anda terbenam dalam penciptaan infrastruktur, Anda tidak akan merasa sangat modis dan progresif. </p><a name="habracut"></a><br><p>  Secara pribadi, DevOps lebih mengingatkan saya pada ini: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/299/9f7/51e/2999f751eb309e5f9ee967deb56fb907.jpg" alt="gambar"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2a0/ddc/a9d/2a0ddca9d9f1ee2f83e1130e84788fb2.jpg" alt="gambar"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9d2/69e/1b4/9d269e1b44d8bd7bc65cc35accd2531f.jpg" alt="gambar"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/dad/458/a97/dad458a97d189cfad6ec939a535f1722.jpg" alt="gambar"></p><br><p>  Membuat infrastruktur tingkat produksi sulit.  Ini adalah stres nyata.  Dan makan banyak waktu.  Banyak waktu. </p><br><p>  Ini menunjukkan berapa banyak waktu yang diperlukan untuk mengimplementasikan proyek infrastruktur berikutnya.  Kami mengandalkan data empiris yang kami kumpulkan selama bekerja dengan ratusan perusahaan yang berbeda: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e1b/84c/72c/e1b84c72c3dfa22ddbe8653f94e38fa9.png" alt="gambar"></p><br><h3 id="urok-1-cheklist-dlya-infrastruktury-proizvodstvennogo-urovnya">  Pelajaran 1. Daftar Periksa untuk Infrastruktur Manufaktur </h3><br><p>  Proyek DevOps selalu memakan waktu lebih lama dari yang Anda harapkan.  Selalu.  Kenapa begitu <br>  Alasan pertama adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">potongan rambut yak</a> .  Di bawah ini adalah ilustrasi yang jelas tentang fenomena ini, (ini adalah kutipan dari seri "Malcolm in the Spotlight") </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Alasan kedua adalah bahwa proses menciptakan infrastruktur tingkat produksi (misalnya, infrastruktur tempat perusahaan Anda akan pakai) terdiri dari ribuan komponen kecil.  Sebagian besar pengembang tidak mengetahui detail ini, oleh karena itu, ketika mengevaluasi suatu proyek, Anda biasanya melupakan banyak tugas penting (dan memakan waktu). <br>  Untuk menghindarinya, setiap kali mulai mengerjakan bagian baru dari infrastruktur, gunakan daftar periksa berikut: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/o2/xu/wu/o2xuwumkfwrh9epcydpmk-b76ru.jpeg"></a> </p><br><p>  Tidak semua elemen daftar akan diperlukan untuk setiap bagian infrastruktur, tetapi Anda harus secara sadar dan eksplisit mendokumentasikan elemen mana yang Anda terapkan, dan yang Anda putuskan untuk dilewati dan mengapa. </p><br><h3 id="urok-2-nabor-instrumentov">  Pelajaran 2. Kotak Alat </h3><br><p>  Kami mencantumkan alat utama yang kami di Gruntwork gunakan untuk membuat dan mengelola infrastruktur (per 2018): </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b9c/656/c19/b9c656c197abcd9892102cc947e525fa.png" alt="gambar"></p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bentuk Terra</a> .  Kami menggunakan Terraform untuk menyebarkan seluruh infrastruktur yang mendasarinya, termasuk jaringan, subsistem penyeimbangan beban, basis data, alat manajemen pengguna dan izin, dan semua server kami. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Packer</a> .  Kami menggunakan Packer untuk mengonfigurasi dan membuat gambar mesin virtual yang kami jalankan di server kami. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Docker</a> .  Beberapa server kami membentuk kluster tempat kami menjalankan aplikasi sebagai wadah Docker.  Untuk cluster Docker, kami terutama menggunakan alat-alat berikut: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kubernetes</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ECS,</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Fargate</a> . </li></ul><br><p>  Semua alat ini berguna, tetapi bukan itu intinya.  Anda perlu memahami bahwa beberapa alat tidak cukup.  Penting juga untuk mengubah perilaku tim. </p><br><p>  Secara khusus, bahkan alat terbaik di dunia tidak akan membantu tim Anda jika mereka tidak ingin menggunakannya atau mereka tidak punya cukup waktu untuk belajar cara menggunakannya.  Jadi, kesimpulan kuncinya adalah bahwa penggunaan "infrastruktur sebagai kode" adalah investasi, yaitu, biaya awal tertentu akan diperlukan untuk Anda.  Jika Anda berinvestasi dengan bijak, Anda akan menerima dividen besar dalam jangka panjang. </p><br><h3 id="urok-3-bolshie-moduli--eto-zlo">  Pelajaran 3. Modul besar itu jahat </h3><br><p>  Pendatang baru untuk penerapan "infrastruktur sebagai kode" sering mendefinisikan seluruh infrastruktur mereka untuk semua lingkungan mereka (lingkungan pengembangan, lingkungan menengah, lingkungan produksi, dll.) Dalam satu file atau satu set file yang digunakan secara keseluruhan.  Sia-sia. </p><br><p>  Berikut adalah beberapa kelemahan dari pendekatan ini: </p><br><ul><li> <strong>Kecepatan rendah</strong>  Jika seluruh infrastruktur didefinisikan di satu tempat, maka pelaksanaan perintah apa pun akan memakan banyak waktu.  Kami menghadapi situasi di perusahaan ketika tim <code>terraform plan</code> membutuhkan waktu 5-6 menit untuk menyelesaikannya! </li><li>  <strong>Keamanan rendah</strong> .  Jika Anda mengelola seluruh infrastruktur bersama, maka untuk mengubah sesuatu Anda memerlukan izin untuk mengakses semuanya.  Artinya, hampir setiap pengguna harus menjadi administrator, dan ini juga sangat merepotkan. </li><li>  <strong>Risiko tinggi</strong> .  Jika Anda meletakkan semua telur dalam satu keranjang, maka buat situasi di mana satu kesalahan lokal dapat mengganggu operasi seluruh infrastruktur.  Misalnya, ketika Anda membuat perubahan kecil ke aplikasi eksternal di lingkungan pengembangan, kesalahan ketik tunggal atau perintah yang salah dapat menyebabkan penghapusan database produksi. </li><li>  <strong>Sulit dimengerti</strong> .  Semakin banyak kode ditempatkan di satu tempat, semakin sulit bagi satu orang untuk memahami semua ini.  Dan ketika semua ini terhubung, bagian-bagian yang tidak dapat dipahami akan memainkan lelucon kejam dengan Anda. </li><li>  <strong>Sulit untuk diuji</strong> .  Menguji kode infrastruktur sulit;  menguji sejumlah besar kode infrastruktur hampir tidak mungkin.  Kami akan kembali ke sini nanti. </li><li>  <strong>Sulit untuk dianalisis</strong> .  Output dari perintah seperti rencana terraform menjadi tidak berguna, karena tidak ada yang mengganggu untuk melihat ribuan baris.  Selain itu, analisis kode menjadi tidak berguna. </li></ul><br><p>  Singkatnya, Anda harus membuat kode dari modul komposit kecil, berdiri sendiri, dan dapat digunakan kembali.  Ini bukan berita atau penemuan.  Anda telah mendengar ini ribuan kali, meskipun dalam situasi yang sedikit berbeda: </p><br><blockquote>  "Lakukan satu hal dan lakukan dengan baik" - Filsafat Unix. <br>  “Aturan fungsi pertama adalah mereka harus kecil.  Aturan kedua menyatakan bahwa fungsi harus lebih kecil. "  - "Kode bersih" </blockquote><br><h3 id="urok-4-infrastrukturnyy-kod-bez-avtomaticheskih-testov-neispraven">  Pelajaran 4. Kode infrastruktur tanpa tes otomatis salah </h3><br><p>  Jika kode infrastruktur Anda tidak memiliki tes otomatis, itu tidak berfungsi dengan benar.  Anda belum tahu tentang itu.  Tetapi menguji kode infrastruktur sulit.  Anda tidak memiliki "host lokal" (misalnya, Anda tidak dapat menggunakan cloud pribadi virtual AWS VPC di laptop Anda), atau "unit test" nyata (misalnya, Anda tidak dapat mengisolasi kode Terraform dari dunia "luar", karena seperti kali dan dirancang untuk berkomunikasi dengan dunia luar). </p><br><p>  Oleh karena itu, untuk menguji kode infrastruktur dengan benar, Anda biasanya harus menyebarkannya di lingkungan nyata, menjalankan infrastruktur nyata, memverifikasi bahwa kode tersebut berfungsi, dan kemudian memecahkannya (untuk deskripsi gaya pengujian ini: lihat Terratest, ini adalah pustaka sumber terbuka yang menyertakan alat untuk menguji kode Terraform , Packer dan Docker, bekerja dengan AWS, GCP, dan Kubernetes API, menjalankan perintah shell secara lokal dan pada server jarak jauh melalui SSH, serta banyak fitur lainnya).  Jadi, saat menguji infrastruktur, Anda perlu sedikit mendefinisikan kembali kondisinya: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e38/f8a/24d/e38f8a24dedcc2de2eec19291f885ccd.png" alt="gambar"></p><br><p>  <strong>Tes unit</strong> menggunakan dan menguji satu atau lebih modul infrastruktur yang terkait erat dari jenis yang sama (misalnya, modul untuk satu basis data). </p><br><p>  <strong>Tes integrasi</strong> menggunakan dan menguji beberapa modul infrastruktur dari berbagai jenis untuk memverifikasi bahwa mereka bekerja bersama (misalnya, modul basis data dan modul layanan web). </p><br><p>  <strong>Tes ujung ke ujung</strong> (e2e) menyebarkan dan menguji seluruh arsitektur. <br>  Harap perhatikan bahwa diagram adalah piramida: kami memiliki banyak unit test, lebih sedikit tes integrasi dan sangat sedikit tes e2e.  Mengapa  Itu tergantung pada durasi masing-masing jenis tes: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/071/040/730/07104073030dd617e05ad563d698e7b5.png" alt="gambar"></p><br><p>  Tes infrastruktur membutuhkan banyak waktu, terutama di tingkat atas piramida, dan, tentu saja, Anda akan ingin menemukan dan memperbaiki kesalahan sebanyak mungkin di bagian paling bawah.  Untuk melakukan ini, Anda perlu: </p><br><ol><li>  Buat modul mandiri yang kecil dan sederhana (lihat Pelajaran 3) dan tulis banyak unit test untuk mereka - pastikan modul itu berfungsi dengan benar. </li><li>  Gabungkan blok-blok kecil, sederhana, dan teruji ini untuk menciptakan infrastruktur yang lebih canggih yang Anda uji dengan uji integrasi dan E2E yang lebih sedikit. </li></ol><br><h3 id="urok-5-process-reliza">  Pelajaran 5. Proses Pelepasan </h3><br><p>  Untuk merangkum semua hal di atas.  Inilah cara Anda sekarang akan membuat dan mengelola infrastruktur Anda: </p><br><ul><li>  Periksa daftar periksa untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">infrastruktur tingkat produksi</a> dan pastikan Anda bekerja ke arah yang benar. </li><li>  Tentukan "infrastruktur sebagai kode" Anda dengan alat-alat seperti Terraform, Packer, dan Docker.  Pastikan tim Anda memiliki cukup waktu untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mempelajari</a> alat-alat ini (lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sumber Daya DevOps</a> ). </li><li>  Buat kode dari modul komposit kecil dan berdiri sendiri (atau gunakan modul standar dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Infrastruktur sebagai Perpustakaan Kode</a> ). </li><li>  Siapkan tes otomatis untuk modul Anda dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Terratest</a> . </li><li>  Lengkapi permintaan untuk memasukkan perubahan Anda untuk meninjau kode Anda. </li><li>  Lepaskan versi kode yang baru. </li><li>  Salin versi kode baru dari satu lingkungan ke lingkungan lain. </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/43f/57b/1b6/43f57b1b6721ef8dd14eb583ffca2d66.png" alt="gambar"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id434774/">https://habr.com/ru/post/id434774/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id434756/index.html">Masa depan Kubernetes adalah dengan mesin virtual</a></li>
<li><a href="../id434758/index.html">Panduan Moderator Facebook: Lebih dari 1.400 halaman slide yang bertentangan</a></li>
<li><a href="../id434760/index.html">Intisari berita PostgreSQL. Tahun Baru (singkat) nomor 13</a></li>
<li><a href="../id434762/index.html">Catatan seorang phytochemist. Pisang Hijau, atau Ingatlah untuk Memberi Makan Mikrobiota</a></li>
<li><a href="../id434770/index.html">Energi terbarukan: kata-kata dan artinya</a></li>
<li><a href="../id434776/index.html">VK menghitung lokasi Anda dengan IP</a></li>
<li><a href="../id434780/index.html">Robotisasi dapat menyebabkan kediktatoran</a></li>
<li><a href="../id434782/index.html">Bagaimana saya memilih sistem CRM</a></li>
<li><a href="../id434784/index.html">Bagaimana memprioritaskan pengembangan. Pengalaman dalam mengimplementasikan GIST + ICE di Yandex.Market</a></li>
<li><a href="../id434786/index.html">Tujuh platform penyelesaian masalah otomatis gratis untuk keterampilan pemrograman leveling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>