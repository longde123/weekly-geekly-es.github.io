<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèΩ üôå üëÇüèΩ Protocoles de r√©servation transparente de PRP et HSR ‚úäüèæ üôèüèø üëµüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans l'industrie, les exigences du LAN deviennent de plus en plus ICS prend de plus en plus de fonctionnalit√©s et la perte de donn√©es peut entra√Æner d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Protocoles de r√©servation transparente de PRP et HSR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/phoenix_contact/blog/443248/">  Dans l'industrie, les exigences du LAN deviennent de plus en plus  ICS prend de plus en plus de fonctionnalit√©s et la perte de donn√©es peut entra√Æner des co√ªts importants. <br><br>  Par exemple, dans le secteur de l'√©nergie, si les donn√©es des transducteurs de mesure n'atteignent pas la borne de relais √† temps, cela peut conduire √† un court-circuit se propageant aux sections adjacentes du r√©seau √©lectrique, ce qui entra√Ænera des pertes beaucoup plus graves qu'en cas de d√©connexion opportune de la section du court-circuit.  Par cons√©quent, souvent dans les projets √©nerg√©tiques, vous pouvez r√©pondre √† l'exigence "Temps de r√©cup√©ration inf√©rieur √† 1 ms". <br><a name="habracut"></a><br>  La redondance du r√©seau bas√©e sur des protocoles √† l'√©chelle de l'industrie tels que RSTP, MRP, DLR et similaires, est bas√©e sur un changement de topologie en cas de dysfonctionnement dans le transfert de donn√©es.  La modification de la topologie prend un certain temps (de quelques millisecondes √† quelques secondes, selon le protocole), appel√© "temps de r√©cup√©ration".  Pendant ce temps, il n'y a pas de communication avec une partie du r√©seau et, par cons√©quent, les donn√©es sont perdues.  C'est-√†-dire  les technologies classiques de redondance en anneau ne permettent pas des temps de r√©cup√©ration inf√©rieurs √† 1 ms. <br><br>  Dans ce contexte, les technologies de redondance dites ¬´sans couture¬ª - PRP et HSR - gagnent en popularit√©.  La redondance bas√©e sur PRP et HSR est effectu√©e, contrairement aux protocoles ci-dessus, non pas en reconstruisant la topologie, mais en dupliquant les trames.  Chaque trame est dupliqu√©e par l'exp√©diteur, et les deux trames sont transmises de diff√©rentes mani√®res, et le n≈ìud de r√©ception traite la trame entr√©e en premier et rejette la seconde.  Ce principe de fonctionnement ne n√©cessite pas de restructuration de la topologie et, par cons√©quent, ce protocole fonctionne presque ¬´de mani√®re transparente¬ª.  Sous la coupe, vous trouverez des d√©tails sur la mise en ≈ìuvre de ces protocoles. <br><br><h4>  Structure du r√©seau </h4><br>  La redondance transparente est impl√©ment√©e sur les n≈ìuds d'extr√©mit√©, pas sur les composants r√©seau.  C'est l'une des principales diff√©rences entre PRP et HSR par rapport √† d'autres protocoles de sauvegarde tels que RSTP ou MRP.  Tenez compte des caract√©ristiques de la structure du r√©seau pour PRP et HSR. <br><br><h4>  PRP - structure du r√©seau </h4><br>  Le n≈ìud d'extr√©mit√© a deux interfaces Ethernet qui se connectent √† deux r√©seaux isol√©s l'un de l'autre, fonctionnant en parall√®le et ayant une topologie ind√©pendante (c'est-√†-dire que les topologies de ces deux r√©seaux peuvent √™tre identiques ou diff√©rentes).  Les r√©seaux doivent √™tre isol√©s de sorte que tout dysfonctionnement et arr√™t de la transmission de donn√©es dans un r√©seau n'affectent pas le second, c'est-√†-dire  m√™me l'alimentation r√©seau est fournie par diff√©rentes sources.  Il ne devrait pas y avoir de connexion directe entre ces r√©seaux. <br><br><img src="https://habrastorage.org/webt/rc/19/go/rc19go3yzzhhcc8ej24_7pbxhb4.png"><br><br>  <i>Structure du r√©seau PRP</i> <br><br>  Ces deux r√©seaux sont g√©n√©ralement appel√©s LAN A et LAN B. Comme d√©j√† indiqu√©, ils peuvent avoir des topologies diff√©rentes ainsi que des performances diff√©rentes.  Les retards dans la transmission des donn√©es peuvent √©galement varier. <br><br>  Le r√©seau peut contenir les √©l√©ments suivants: <br><br><ul><li>  DAN (Dual Attached Node) - un n≈ìud qui se connecte aux deux r√©seaux et envoie / re√ßoit des trames en double. </li><li>  SAN (Single Attached Node) - un n≈ìud qui se connecte √† un seul r√©seau (LAN A ou LAN B) et envoie / re√ßoit des trames normales. </li><li>  Dans le cas o√π il est n√©cessaire de connecter de mani√®re redondante un appareil qui poss√®de une interface Ethernet et ne prend pas en charge le protocole PRP au r√©seau RPR, le soi-disant Redundancy Box (g√©n√©ralement RedBox) est utilis√©.  Sur RedBox, le paquet de l'appareil est dupliqu√© et transmis au r√©seau PRP, comme si les donn√©es √©taient transmises depuis le DAN.  De plus, l'appareil derri√®re RedBox est consid√©r√© comme un DAN pour d'autres appareils.  Un tel n≈ìud est appel√© DAN virtuel ou VDAN (Virtual DAN). </li></ul><br><br><img src="https://habrastorage.org/webt/ko/1f/ye/ko1fyehyesxd7zlz5qs-_q2zs_e.png"><br><br>  <i>Principe de fonctionnement de RedBox</i> <br><br><h4>  HSR - structure du r√©seau </h4><br><img src="https://habrastorage.org/webt/sd/mi/hd/sdmihdk3aqfpandamwmu3artwf0.png"><br><br>  <i>Structure du r√©seau HSR</i> <br><br>  Le principe de fonctionnement de HSR est que tous les appareils sont combin√©s en anneau et tous les messages, ainsi que dans PRP, sont dupliqu√©s.  L'appareil envoie les deux images √† travers l'anneau: une copie dans le sens horaire, l'autre dans le sens antihoraire.  Le r√©cepteur re√ßoit les deux copies, mais traite uniquement la premi√®re et supprime la seconde.  Si quelque chose arrive √† l'un des liens et que l'un des cadres dupliqu√©s ne vient pas, alors l'autre est simplement accept√©.  Tous les p√©riph√©riques HSR ont deux interfaces Ethernet - le port A et le port B. <br><br>  Selon le protocole HSR, les √©l√©ments suivants peuvent exister dans un r√©seau: <br><br><ul><li>  SAN est un n≈ìud qui n'a qu'une seule interface Ethernet.  Un tel n≈ìud peut √™tre connect√© au r√©seau HSR exclusivement via RedBox. </li><li>  DAN - un n≈ìud qui peut √©changer des donn√©es √† l'int√©rieur d'un anneau HSR (peut envoyer / recevoir des trames en double). </li><li>  RedBox - tout comme dans PRP, RedBox vous permet de connecter un appareil dot√© d'une interface Ethernet √† un r√©seau HSR.  L'appareil derri√®re RedBox est consid√©r√© comme un DAN pour d'autres appareils.  Un tel n≈ìud est appel√© DAN virtuel ou VDAN (Virtual DAN). </li><li>  QuadBox - HSR pr√©sente √©galement un nouvel √©l√©ment - QuadBox.  Cet appareil poss√®de quatre ports HSR.  Il vous permet de combiner deux anneaux HSR.  Dans chaque anneau, la QuadBox agit comme un DAN et peut transf√©rer des donn√©es d'un anneau √† un autre. </li></ul><br><img src="https://habrastorage.org/webt/we/7n/dc/we7ndcshvu_8oefjqm9ykvrc8a8.png"><br><br>  <i>Exemple QuadBox</i> <br><br><h4>  Structure DAN </h4><br>  Pour PRP et HSR, la structure DAN est similaire.  Chaque DAN poss√®de deux interfaces fonctionnant en parall√®le et connect√©es au niveau sup√©rieur d'une pile de communication via la couche dite LRE - entit√© de redondance de liaison.  √Ä ce niveau, toutes les fonctions de sauvegarde sont ex√©cut√©es. <br><br>  Les deux interfaces DAN ont la m√™me adresse MAC et une seule adresse IP.  Cela vous permet de rendre la r√©servation transparente au plus haut niveau.  Particuli√®rement important est le fait que cela permet l'utilisation d'ARP pour DAN ainsi que pour tout n≈ìud non redondant. <br><br>  Cependant, bien s√ªr, il existe des nuances dans la structure DAN pour PRP et HSR. <br><br><h4>  PRP - Structure DAN </h4><br>  Lorsqu'une trame est envoy√©e √† partir du niveau sup√©rieur, le LRE la duplique et envoie les deux paquets via les ports presque simultan√©ment.  Les deux trames sont transmises en parall√®le via deux r√©seaux avec des retards diff√©rents.  Dans une situation id√©ale, ils sont livr√©s au n≈ìud de destination avec un d√©calage horaire minimum.  A la r√©ception du LRE, le r√©cepteur envoie la premi√®re trame re√ßue √† la couche sup√©rieure et rejette la seconde. <br><br>  LRE cr√©e des trames en double lors de l'envoi et les traite d√®s r√©ception.  Ce niveau, par rapport au niveau sup√©rieur, repr√©sente l'interface habituelle d'une carte r√©seau non redondante.  LRE effectue deux t√¢ches: g√©rer les trames en double et g√©rer la redondance.  Pour impl√©menter le contr√¥le, LRE ajoute une remorque de contr√¥le de redondance (RCT) 32 bits √† chaque trame et la supprime lorsque la trame est re√ßue. <br><br><img src="https://habrastorage.org/webt/7v/tf/p7/7vtfp7drkalyuxwvs7c1fnbdewy.png"><br><br>  <i>Transfert de donn√©es entre deux DAN dans PRP</i> <br><br><h4>  HSR - Structure DAN </h4><br>  Une trame envoy√©e depuis la couche sup√©rieure est dupliqu√©e par la couche LRE, et les paquets sont envoy√©s via le port A et le port B presque simultan√©ment.  (1 et 2 sur le sch√©ma). <br><br>  √Ä la r√©ception de la trame, le r√©cepteur la transf√®re au niveau LRE, la redirige √©galement vers un autre port et la transmet plus loin dans l'anneau.  (3, 4). <br><br>  Si une trame arrive √† l'exp√©diteur, alors cette trame n'est pas transmise plus loin, mais d√©truite (5, 6). <br><br>  Les deux trames arrivent au niveau LRE, mais celle qui a √©t√© envoy√©e plus rapidement est transf√©r√©e au niveau sup√©rieur et la trame dupliqu√©e est supprim√©e. <br><br>  LRE ajoute une balise HSR 48 bits √† chaque trame (semblable √† l'ajout d'une balise VLAN) et supprime cette balise √† la r√©ception. <br><br><img src="https://habrastorage.org/webt/k9/xl/pj/k9xlpj2jf76juzewex9ocyuze_k.png"><br><br>  <i>Transfert de donn√©es entre deux DAN dans un HSR</i> <br><br><h4>  Interop√©rabilit√© entre SAN et DAN </h4><br>  Dans PRP, un SAN peut √™tre connect√© √† n'importe quel r√©seau - LAN A ou LAN B, mais un tel n≈ìud ne prend pas en charge les fonctions de sauvegarde.  Par cons√©quent, un SAN connect√© √† un r√©seau ne peut pas communiquer avec un autre n≈ìud similaire connect√© √† un deuxi√®me r√©seau.  Pour interagir avec SAN, DAN g√©n√®re des trames sp√©ciales.  Ce besoin est d√ª au fait que le SAN dans la trame normale du p√©riph√©rique redondant doit ignorer le RCT, ce qui n'est pas possible, car le SAN ne peut pas distinguer le RCT du bloc de donn√©es IEEE 802.3 normal.  √Ä son tour, le DAN comprend qu'il envoie la trame au SAN et n'ajoute pas de RCT √† la trame.  Il transf√®re simplement une trame du niveau sup√©rieur √† l'interface √† laquelle le SAN est connect√©.  En d'autres termes, si le DAN ne peut pas d√©terminer ce qui √©change des donn√©es avec un autre DAN, il n'ajoute pas RCT √† la trame. <br><br>  Dans HSR, un SAN ne peut pas √™tre connect√© directement au r√©seau.  Il peut √™tre connect√© exclusivement via RedBox. <br><br><h4>  Modes DAN </h4><br>  Lorsque vous travaillez avec des trames en double re√ßues sur les deux interfaces (si elles sont utilisables), le DAN doit accepter l'une des trames et √©liminer la seconde.  Il existe deux m√©thodes de traitement dans PRP: <br><br><ul><li>  L'acceptation en double est une m√©thode dans laquelle les deux trames entrantes sont re√ßues et redirig√©es vers le niveau sup√©rieur. </li><li>  Duplicate discard - une m√©thode dans laquelle le n≈ìud r√©cepteur lit les informations du RCT de la trame entrante afin de d√©terminer la trame √† rejeter. </li></ul><br>  Pour HSR, consid√©rez les modes U et X les plus populaires. <br><br><h4>  Accepter en double </h4><br>  Un DAN fonctionnant dans ce mode ne supprime aucune trame lors du traitement au niveau de la couche liaison de donn√©es. <br><br>  Les trames sont envoy√©es au LAN A et au LAN B sans RCT.  Le LRE du r√©cepteur redirige simplement les deux trames vers la couche sup√©rieure, en supposant qu'une transmission ult√©rieure d√©truira les doublons (IEEE 802.1D indique clairement que les protocoles de couche sup√©rieure doivent √™tre capables de g√©rer les trames en double). <br><br>  Par exemple, TCP et UDP ont un haut niveau de r√©silience aux trames en double. <br><br>  Cette m√©thode est tr√®s simple √† mettre en ≈ìuvre, mais pr√©sente un s√©rieux inconv√©nient - elle ne fournit aucune capacit√© de contr√¥le du r√©seau, car  la r√©ception des deux trames n'est en aucun cas surveill√©e. <br><br><h4>  Rejet en double au niveau du canal </h4><br>  Lors de l'utilisation de la deuxi√®me m√©thode, un champ compos√© de quatre octets est ajout√© √† la trame - RCT (remorque de contr√¥le de redondance).  Une bande-annonce est ajout√©e au niveau LRE lorsque la trame est re√ßue du niveau sup√©rieur.  RCT se compose des param√®tres suivants: <br><br><ul><li>  Num√©ro de s√©quence de 16 bits; </li><li>  Identifiant de r√©seau 4 bits, 1010 (0xA) pour LAN A et 1011 (0xB) pour LAN B; </li><li>  Taille d'image 12 bits. </li></ul><br>  En raison de l'ajout d'une remorque RCT au ch√¢ssis, sa taille est sup√©rieure √† la taille maximale du ch√¢ssis d√©finie dans la norme IEEE 802.3-2005.  Pour transmettre des donn√©es au sein du r√©seau avec PRP, l'√©quipement doit √™tre configur√© pour transmettre des donn√©es d'une taille de 1496 octets.  Pour cette raison, tous les commutateurs ne conviennent pas √† une utilisation sur LAN A ou LAN B. <br><br><img src="https://habrastorage.org/webt/-c/sa/9z/-csa9zpwutrbhyuemwfexrw6xki.png"><br><br>  <i>Cadre avec RCT ajout√©</i> <br><br>  Chaque fois que la couche liaison envoie une trame √† une adresse sp√©cifique, l'exp√©diteur augmente le num√©ro de s√©quence du n≈ìud correspondant et envoie des trames identiques via les deux interfaces. <br><br>  Le n≈ìud r√©cepteur doit d√©terminer les doublons sur la base des informations provenant du RCT. <br><br><h4>  Algorithme de m√©thode de suppression des doublons </h4><br>  Le r√©cepteur suppose que les trames envoy√©es √† partir de n'importe quelle source utilisant le protocole PRP sont envoy√©es s√©quentiellement avec un nombre sans cesse croissant.  Le num√©ro de s√©quence attendu pour la trame suivante est stock√© dans les variables ExpectedSeqA et, en cons√©quence, ExpectedSeqB. <br><br>  √Ä la r√©ception, l'exactitude de la s√©quence peut √™tre v√©rifi√©e en comparant la valeur de ExpectedSeqA (ExpectedSeqB) avec le num√©ro de s√©quence de la trame re√ßue, stock√© dans la variable currentSeq dans RCT.  Si le r√©sultat est positif, la variable ExpectedSeq est d√©finie sur un de plus que currentSeq afin qu'il soit possible d'effectuer un contr√¥le correct sur cette ligne. <br><br><img src="https://habrastorage.org/webt/6q/ty/-p/6qty-pwnzatajmck0f9ciyzu4so.png"><br><br>  <i>Intervalle de d√©p√¥t de trame (fen√™tre de d√©p√¥t)</i> <br><br>  Pour les deux interfaces, il existe un intervalle de chute de trame dynamique pour les num√©ros de s√©quence appari√©s.  La limite sup√©rieure de cet intervalle est ExpectedSeq (le prochain num√©ro de s√©quence attendu sur cette interface), √† ‚Äã‚Äãl'exclusion de la valeur donn√©e elle-m√™me, et la limite inf√©rieure de cet intervalle est startSeq (le plus petit num√©ro de s√©quence auquel la trame dupliqu√©e avec ce num√©ro de s√©quence est ignor√©e). <br><br>  Apr√®s avoir v√©rifi√© le num√©ro de s√©quence, le r√©cepteur d√©cide de rejeter la trame ou non.  Supposons que le LAN A ait une taille d'intervalle de chute de trame non nulle (Fig. 5).  Une trame du LAN B dont le num√©ro se situe dans cet intervalle sera rejet√©e.  Toutes les autres trames du LAN B seront accept√©es et envoy√©es au niveau sup√©rieur. <br><br>  La suppression d'une trame du LAN B r√©duit la taille du LAN A, car  apr√®s avoir re√ßu cette trame, aucune trame avec un nombre inf√©rieur sur cette interface n'est attendue.  Par cons√©quent, startSeqA est d√©fini sur un de plus que currentSeqB.  Dans ce cas, la taille de l'intervalle de suppression de la trame LAN B est r√©initialis√©e √† 0 (startSeqB = attenduSeqB), car  De toute √©vidence, les trames LAN B sont ¬´derri√®re¬ª le LAN LAN et aucune trame du LAN A ne doit √™tre supprim√©e. <br><br><img src="https://habrastorage.org/webt/px/8a/l5/px8al5_iebz0d8qr-atw4zepiy0.png"><br><br>  <i>Diminuez l'intervalle LAN A apr√®s la suppression de la trame du LAN B</i> <br><br>  Dans la situation de la figure 7, lorsque plusieurs trames du LAN A viennent en ligne, mais que rien ne vient du LAN B, elles sont accept√©es, car  leur currentSeq est en dehors de l'intervalle de rejet de la trame LAN B et l'intervalle LAN A est augment√© d'une position.  Si les trames du LAN A continuent d'arriver, mais que rien ne vient toujours du LAN B, lorsque la taille d'intervalle maximale est atteinte, startSeqA commence √©galement √† augmenter d'une unit√©. <br><br>  Lorsque la trame re√ßue est en dehors de l'intervalle de suppression de la trame d'un autre LAN, cette trame est enregistr√©e et la taille de l'intervalle de cette interface est d√©finie sur 1, ce qui signifie que seule une trame d'un autre LAN avec le m√™me num√©ro de s√©quence sera ignor√©e, tandis que la fen√™tre de d√©p√¥t de l'autre interface est r√©gl√© sur 0, ce qui signifie qu'aucune trame ne sera supprim√©e (Fig. 7). <br><br><img src="https://habrastorage.org/webt/_r/gy/b2/_rgyb2_tufbtbbi3wfr18yqby6a.png"><br><br>  La trame du LAN B n'a pas √©t√© supprim√©e <br><br>  La situation la plus courante est lorsque les deux interfaces sont synchronis√©es et que la taille des deux intervalles est 0 (Fig.8), ce qui signifie que la trame de l'interface qui vient en premier sera accept√©e et l'intervalle de cette interface sera augment√© √† 1, ce qui permettra √† la trame d'√™tre supprim√©e d'une autre interface avec m√™me num√©ro de s√©quence. <br><br><img src="https://habrastorage.org/webt/x5/sj/n9/x5sjn9q0lxkcg6xbc6jwgzopvpa.png"><br><br>  <i>LAN synchronis√©</i> <br><br>  En raison de la pr√©sence d'un identifiant LAN dans RCT, les trames en double diff√®rent d'un bit (et ont des sommes de contr√¥le diff√©rentes).  Le r√©cepteur v√©rifie que la trame appartient √† l'interface (c'est-√†-dire qu'il v√©rifie que la trame avec l'identifiant LAN A est arriv√©e √† l'interface A).  Le r√©cepteur ne laissera pas tomber cette trame, car  il peut contenir des informations utiles dans le bloc de donn√©es, mais dans ce cas, le compteur cntWrongLanA ou cntWrongLanB sera augment√© d'une unit√©.  Ces erreurs n'√©tant pas ponctuelles (m√©lang√©es par LAN A et LAN B), le compteur augmentera constamment. <br><br><h4>  Lier le trafic HSR </h4><br>  Lors du transfert de donn√©es au sein du r√©seau HSR, une balise HSR est ajout√©e √† chaque trame. <br>  La balise HSR comprend les param√®tres suivants: <br><br><ul><li>  Type d'√©ther HSR 16 bits </li><li>  Indicateur de chemin 4 bits </li><li>  Taille d'image 12 bits </li><li>  Num√©ro de s√©quence 16 bits </li></ul><br>  L'exp√©diteur ins√®re les m√™mes num√©ros de s√©quence dans les trames en double envoy√©es, puis incr√©mente le num√©ro de s√©quence pour chaque message envoy√© √† partir de ce n≈ìud. <br><br>  Le r√©cepteur surveille les num√©ros de s√©quence de toutes les trames de chaque source √† partir de laquelle il re√ßoit des donn√©es (il distingue les sources par adresse MAC).  Si les trames proviennent de diff√©rentes lignes et ont la m√™me source et le m√™me num√©ro de s√©quence, l'une d'elles est accept√©e et la seconde est rejet√©e. <br><br>  Pour contr√¥ler le r√©seau, chaque p√©riph√©rique conserve une table de tous les n≈ìuds du r√©seau √† partir desquels il re√ßoit des donn√©es.  Cela vous permet de d√©tecter la disparition des n≈ìuds et les erreurs sur le bus. <br><br>  Le n≈ìud d√©finit la trame qu'il a envoy√©e par source et par num√©ro de s√©quence. <br><br><img src="https://habrastorage.org/webt/0w/al/xj/0walxjqivh2nvo3ae-dr20d7b7e.png"><br><br>  <i>Cadre avec √©tiquette HSR ajout√©e</i> <br><br>  Un n≈ìud HSR ne rejette jamais une trame qu'il n'a pas re√ßue pr√©c√©demment.  Le n≈ìud d√©finit presque toutes les trames dupliqu√©es, mais s'il y en a peu, il ne les supprime pas, c'est-√†-dire  le cadre traverse tout l'anneau et est d√©truit sur l'exp√©diteur. <br><br>  Dans la norme, l'algorithme de d√©termination des trames en double n'est pas d√©fini.  Comme m√©thodes possibles, des tables de hachage, des files d'attente et le suivi des num√©ros de s√©quence peuvent √™tre utilis√©s. <br><br><h4>  Mode U </h4><br>  Dans ce mode, le n≈ìud qui re√ßoit la trame d√©truit le doublon et ne lui permet pas de se propager davantage.  Si la trame a n√©anmoins √©t√© transf√©r√©e plus loin, elle est d√©truite sur les n≈ìuds suivants.  Ce mode vous permet de d√©charger l'anneau du trafic Unicast. <br><br>  Dans le diagramme, les fl√®ches rouges indiquent les paquets avec la balise HSR envoy√©s depuis le port "A" (ci-apr√®s - trame "A"). <br><br>  Les fl√®ches vertes indiquent les paquets avec une √©tiquette HSR envoy√©s depuis le port "B" (ci-apr√®s - trame "B"). <br><br>  Les fl√®ches vides indiquent une baisse de trafic, c.-√†-d.  les trames qui seraient transmises pendant le fonctionnement normal, mais dans ce mode ont √©t√© rejet√©es. <br>  La croix indique la suppression du trafic sur le ring (en tout cas). <br><br><img src="https://habrastorage.org/webt/sk/yk/14/skyk14uoacfn9l4y1hcdnvvytwe.png"><br><br><h4>  Mode X </h4><br>  Dans ce mode, le n≈ìud ne transmet pas la trame plus loin et la rejette si une telle trame a √©t√© re√ßue d'une autre direction. <br><br>  Par exemple, DAN 1 dans l'image ne fera pas avancer l'image "B" plus loin, car  il a d√©j√† re√ßu la trame "A", et DAN 2 ne transmettra plus la trame "A", car  d√©j√† re√ßu la trame ¬´B¬ª. <br><br>  Dans le cas o√π une erreur s'est produite quelque part dans l'algorithme et que les trames ont √©t√© transmises plus loin, elles seront rejet√©es sur les n≈ìuds suivants ou sur le n≈ìud sur lequel elles ont √©t√© cr√©√©es. <br><br>  Le mode X n'est pas applicable pour les messages PTP et pour la transmission de trame de supervision. <br><br><img src="https://habrastorage.org/webt/tn/jk/ih/tnjkihj4soziqhacnpxdfh7soeo.png"><br><br><h3>  Contr√¥le r√©seau </h3><br><h4>  PRP </h4><br>  Le r√©cepteur v√©rifie que toutes les trames arrivent s√©quentiellement et sont correctement re√ßues sur les deux canaux.  Il prend en charge les compteurs d'erreurs qui peuvent √™tre lus, par exemple, via SNMP. <br><br>  Tous les appareils prennent en charge les tables de n≈ìuds avec lesquelles ils √©changent des donn√©es.  Ces tableaux contiennent des informations sur l'heure √† laquelle la derni√®re trame a √©t√© envoy√©e ou re√ßue d'un n≈ìud particulier et d'autres informations concernant le protocole PRP. <br><br>  En m√™me temps, ces tableaux permettent de d√©tecter des compos√©s dans lesquels il est n√©cessaire de synchroniser des num√©ros de s√©quence, ainsi que de d√©tecter des s√©quences cass√©es et des n≈ìuds manquants. <br><br>  Le diagnostic est bas√© sur le fait que chaque DAN envoie p√©riodiquement une trame de diagnostic (trame de supervision), qui vous permet de v√©rifier l'int√©grit√© du r√©seau et la pr√©sence de n≈ìuds.  Dans le m√™me temps, ces trames vous permettent de v√©rifier quels p√©riph√©riques agissent en tant que DAN, de d√©terminer leurs adresses MAC et dans quel mode ils fonctionnent - dupliquer accepter ou dupliquer rejeter. <br><br><h4>  Hsr </h4><br>  Chaque n≈ìud v√©rifie constamment tous les liens. <br><br>  Chaque n≈ìud envoie p√©riodiquement une trame de diagnostic (aux deux ports) contenant des informations sur l'√©tat du n≈ìud.  Cette trame est accept√©e par tous les n≈ìuds, y compris l'exp√©diteur.  Lorsque l'exp√©diteur re√ßoit son propre message de diagnostic, une v√©rification d'int√©grit√© du canal physique est effectu√©e. <br><br>  L'intervalle d'envoi d'une trame de diagnostic est relativement long (quelques secondes), car  il n'est pas n√©cessaire de fournir une redondance, mais n'est n√©cessaire qu'√† des fins de diagnostic. <br><br>  Tous les n≈ìuds sont entr√©s dans la table de tous les partenaires trouv√©s et l'heure est enregistr√©e lorsque le n≈ìud a √©t√© activ√© pour la derni√®re fois, ainsi que toutes les trames ignor√©es et les trames qui n'ont pas √©t√© envoy√©es s√©quentiellement. <br><br>  Toutes les modifications de topologie qui se sont produites sont √©galement enregistr√©es et toutes les informations peuvent √™tre obtenues via SNMP. <br><br>  HSR et PRP: avantages et inconv√©nients <br><br><img src="https://habrastorage.org/webt/90/zj/xf/90zjxfixfn8ixq80tbqdf8s4lem.png"><br><br><h4>  Conclusion </h4><br>  Cela ne veut pas dire qu'un protocole est meilleur qu'un autre - ils sont con√ßus un peu pour diff√©rentes applications.  HSR et PRP permettent une redondance de r√©seau transparente, mais HSR vous permet de cr√©er des solutions plus rentables.  Mais cette rentabilit√© entra√Æne des difficult√©s, car  un r√©seau HSR est difficile √† mettre √† l'√©chelle et les applications ne sont pas tr√®s flexibles.  Une faible flexibilit√© est due √† une topologie limit√©e (anneau, appariement d'anneaux), ainsi qu'√† une mauvaise compatibilit√© du protocole avec d'autres technologies.  Par cons√©quent, HSR est mieux adapt√© pour la redondance de petits syst√®mes et l'int√©gration dans un grand r√©seau.  La sauvegarde HSR de l'ensemble du r√©seau est probl√©matique.  PRP, √† son tour, est une solution plus co√ªteuse, mais vous permet d'organiser un r√©seau √† assez grande √©chelle, qui √† l'avenir peut √™tre √©tendu sans probl√®me, car<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce protocole permet d'int√©grer facilement presque toutes les technologies et de mettre en ≈ìuvre des topologies compl√®tement diff√©rentes. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouvez une solution</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr443248/">https://habr.com/ru/post/fr443248/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr443238/index.html">Comment ne pas devenir une libellule si vous avez de nombreuses bases de donn√©es diff√©rentes</a></li>
<li><a href="../fr443240/index.html">Comprendre le Q-learning, le probl√®me ¬´Marcher sur un rocher¬ª</a></li>
<li><a href="../fr443242/index.html">Quarkus est un Java subatomique supersonique. Un bref aper√ßu du cadre</a></li>
<li><a href="../fr443244/index.html">T√¢ches de d√©briefing. Beanpoisk_1</a></li>
<li><a href="../fr443246/index.html">Comment nous avons r√©invent√© le PBX IP Askozia apr√®s la vente et la cl√¥ture du projet par le d√©veloppeur</a></li>
<li><a href="../fr443250/index.html">Collecteur de d√©chets fait maison pour OpenJDK</a></li>
<li><a href="../fr443252/index.html">Bots de fourmis modulaires avec m√©moire</a></li>
<li><a href="../fr443254/index.html">Triton est le virus le plus mortel</a></li>
<li><a href="../fr443256/index.html">PowerShell, vidage de mon exp√©rience</a></li>
<li><a href="../fr443258/index.html">Gotify - un projet open source pour d√©livrer des notifications et envoyer des messages au serveur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>