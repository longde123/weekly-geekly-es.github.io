<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¶üèΩ üà≥ üîõ √â poss√≠vel usar o Tibero em vez do Oracle. E √© necess√°rio üì¨ ü§§ üìâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, mostrarei como pensei seriamente em uma alternativa ao Oracle. Mas e o Postgre, voc√™ diz? Sim, mas existem nuances. Primeiro, lidaremos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√â poss√≠vel usar o Tibero em vez do Oracle. E √© necess√°rio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413147/">  Neste artigo, mostrarei como pensei seriamente em uma alternativa ao Oracle.  Mas e o Postgre, voc√™ diz?  Sim, mas existem nuances.  Primeiro, lidaremos com a pergunta "Por que Oracle?" <br>  L√≥gica de neg√≥cios em nosso banco de dados.  No livro da Oracle para profissionais, Tom Kite escreve <br><blockquote>  Ao desenvolver aplicativos de banco de dados, utilizo um mantra muito simples: <br><br>  se poss√≠vel, fa√ßa-o com uma √∫nica instru√ß√£o SQL; <br>  se isso n√£o puder ser feito com uma √∫nica instru√ß√£o SQL, fa√ßa-o em PL / SQL; <br>  se isso n√£o puder ser feito no PL / SQL, tente usar um procedimento armazenado Java; <br>  se isso n√£o puder ser feito em Java, fa√ßa-o como um procedimento externo em C; <br>  se isso n√£o puder ser implementado como um procedimento externo em C, voc√™ precisar√° pensar seriamente sobre o motivo de isso ser feito ... </blockquote>  e no design do sistema, sigo esta regra.  Os tipos de objetos no Oracle s√£o especialmente agrad√°veis: com a ajuda deles, uma l√≥gica de neg√≥cios complexa √© implementada de maneira conveniente e conveniente de acordo com todos os c√¢nones do OOP. <br><br>  Oracle √© caro.  Compr√°-lo e n√£o usar tudo o que est√° nele ser√° um erro. <br>  E, no entanto, sempre h√° um fator de equipe e compet√™ncias.  Se sua equipe desenvolve tudo na Oracle h√° dez anos, a libera√ß√£o do Postgre pode ser dolorosa. <br><br>  Oracle √© caro.  T√£o caro que voc√™ pode escrever sobre isso v√°rias vezes e n√£o pensar na necessidade de Oracle em um novo projeto ser√° um erro. <br><br>  V√°rias vezes j√° me deparei com publica√ß√µes sobre o produto coreano Tibero, supostamente criado para substituir o Oracle.  E agora eles t√™m uma atra√ß√£o por generosidade sem precedentes - as licen√ßas padr√£o s√£o distribu√≠das para desenvolvedores quase de gra√ßa, por um d√≥lar por soquete.  Ent√£o, entendemos: o que os coreanos podem oferecer no momento.  Com os carros, afinal, eles j√° (quase) conseguiram! <br><a name="habracut"></a><br><h3>  Descri√ß√£o da experi√™ncia </h3><br>  Os representantes da TMaxSoft dizem que o Tibero √© quase 100% compat√≠vel com o Oracle, e existe um utilit√°rio para a migra√ß√£o de bancos de dados.  Decidi pegar minha base de produtos, com l√≥gica de neg√≥cios no Oracle, usando todo o charme do OOP em PL \ SQL e transferi-lo para o Tibero.  Nesta publica√ß√£o, n√£o consideramos a migra√ß√£o dos dados em si, √© menos interessante e ainda n√£o tentei uma migra√ß√£o completa. <br><br>  A tarefa √© esta: <br><br>  1. Transferir tabelas. <br>  2. Transfer√™ncia de √≠ndices, chaves, etc. <br>  3. Transfira pacotes e gatilhos. <br>  4. Transfer√™ncia de tipos de objetos. <br><br>  Mas primeiro, vamos lidar com as ferramentas. <br><br><h3>  As ferramentas </h3><br>  O Google conhece pouco sobre Tibero.  Baixamos o pr√≥prio banco de dados na forma de uma m√°quina virtual na qual tudo j√° foi implantado.  Existem apenas duas ferramentas: um utilit√°rio para migrar o T-UP e um IDE para DBA e o desenvolvedor do tbAdmin.  Tudo √© feito em Java, roda em qualquer lugar, em teoria. <br><br>  O T-UP se parece com isso: <br><br><img src="https://habrastorage.org/webt/oi/gn/_a/oign_ablqrxbbwtiutwczw6adi0.jpeg"><br>  <i>Janela principal: conex√µes com o banco de dados.</i> <br><br><img src="https://habrastorage.org/webt/yz/3f/cx/yz3fcxrlhslegdkikvd_9iv5qx4.jpeg"><br>  <i>Se voc√™ clicar em Op√ß√µes, poder√° configurar alguma coisa.</i> <br><br><img src="https://habrastorage.org/webt/vt/rb/9a/vtrb9a6od2ep0tjh_mhczcd9zv8.jpeg"><br>  <i>Mais importante, voc√™ pode selecionar os tipos de objetos a serem migrados.</i> <br><br>  N√£o foram encontradas instru√ß√µes, ajuda, dicas. <br>  Faz a impress√£o de um utilit√°rio caseiro.  √Äs vezes, ela voava com execu√ß√µes, mas basicamente trabalhava conforme necess√°rio. <br><br>  A segunda ferramenta √© o Tibero Admin IDE.  Pode ser baixado do site da TMaxSoft se voc√™ se registrar primeiro.  Voc√™ tamb√©m pode obter uma licen√ßa demo l√°. <br><br><img src="https://habrastorage.org/webt/7n/fh/py/7nfhpypymbdibdgxbntldsa0jrm.jpeg"><br>  <i>O Tibero Admin parece um IDE antigo t√≠pico</i> <br><br>  Estou acostumado √† excelente ferramenta PL / SQL Developer da Allround Automations.  No Tibero Admin, esque√ßa as instru√ß√µes contextuais, nada aparecer√° na tela depois de clicar no "ponto"; ele n√£o anexar√° os nomes de tabelas e objetos a voc√™.  Basta digitar o c√≥digo, voc√™s programadores.  Ajuda, documenta√ß√£o?  N√£o.  H√° documenta√ß√£o no DBMS no site do fabricante, t√£o interessante ... sem uma pesquisa.  Nenhuma documenta√ß√£o foi encontrada para o IDE.  No entanto, n√£o h√° nada complicado.  Houve problemas com a autoriza√ß√£o - descobriu-se que o usu√°rio precisa receber direitos de DBA para entrar no tbAdmin.  E interessante com as portas <b>, 8630 √© para SYS, para todos os outros 8629</b> . <br><br>  Erros de IDE.  De tempos em tempos, quando voc√™ cutuca em algum lugar, o <i>√≠ndice de</i> mensagens <i>fora dos limites desaparece</i> , uma mensagem como <b>java.lang.Exception: Compromisso com √™xito √©</b> muito assustador.  √â necess√°rio levar em considera√ß√£o diferentes tipos de janelas SQL e PSM: na primeira, √© improv√°vel que voc√™ compile o c√≥digo do programa; na segunda, voc√™ n√£o executar√° a solicita√ß√£o.  Ap√≥s PL / SQL Developer - uma apar√™ncia miser√°vel da m√£o esquerda ... <br><br>  Chegando ao experimento. <br><br><h3>  Migra√ß√£o de tabela </h3><br>  Selecionamos o esquema no T-UP, clique em Migrar, primeiro selecione as ‚Äútabelas‚Äù nas op√ß√µes e o processo de transfer√™ncia ser√° iniciado.  Eu tive dois problemas. <br><br>  TABLESPACES.  Decidi transferi-los para as tabelas, mas o Tibero parece ter tentado reservar tanto espa√ßo para eles quanto eles ocupam no banco de dados de origem.  E isso √© muito, e ele n√£o podia.  Criei os espa√ßos de tabela manualmente e tudo correu bem. <br><br>  Al√©m de tabelas com valores de data PADR√ÉO do tipo '31 .12.2019 '.  Nas configura√ß√µes do Oracle, temos este formato registrado, para o Tibero ajuda <pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> nls_date_format=<span class="hljs-string"><span class="hljs-string">'DD.MM.YYYY'</span></span>;</code> </pre>  mas n√£o h√° lugar para o T-UP fazer isso.  Colegas da TMaxSoft recomendaram definir a vari√°vel TB_NLS_DATE_FORMAT = "DD.MM.YYYY", mas isso n√£o me ajudou pessoalmente.  Talvez eu tenha feito algo errado.  Eu tive que criar tabelas com esses par√¢metros manualmente, n√£o h√° muitos deles. <br><br>  Resultado do primeiro passo: mover a estrutura da tabela do Oracle para o Tibero funciona bem. <br><br><h3>  Chaves e √≠ndices. </h3><br>  Marcamos as caixas de sele√ß√£o INDEX, CONSTRAINT em T-UP e encaminhamos.Os problemas surgiram com CHECK devido √† mesma situa√ß√£o da data.  Em geral, √≠ndices, chaves prim√°rias, cheques - foram criados.  Mas n√£o consegui encontrar chaves estrangeiras no banco de dados rec√©m-criado.  E a migra√ß√£o de constantes termina no log do T-UP com a mensagem <b><i>"Falha na migra√ß√£o: java.lang.NullPointerException".</i></b>  Coincid√™ncia?  Eu acho que n√£o ... <br><br><h3>  Pacotes e gatilhos. </h3><br>  Nos gatilhos n√£o tenho nada complicado, eles foram criados perfeitamente.  √â verdade que eu n√£o verifiquei como eles funcionam, essa ser√° uma hist√≥ria separada. <br><br>  Vamos falar sobre procedimentos e fun√ß√µes que implementam parte da l√≥gica.  Aqui, infelizmente, nem tudo correu perfeitamente. <br><br>  De um simples: no <s>ex√©rcito de</s> Tibero n√£o h√° palavra <b>NOVA</b> .  A constru√ß√£o o: = NEW t_my_type () n√£o ser√° compilada.  No Oracle, √© verdade, n√£o √© obrigat√≥rio, mas eu sempre escrevi por algum motivo.  Eu tive que excluir. <br><br>  A fun√ß√£o DBA permite que o SQL Window acesse todas as tabelas.  No entanto, ao compilar um pacote ou procedimento em um esquema com essa fun√ß√£o, ao usar tabelas e objetos de outro esquema, voc√™ precisa conceder a concess√£o correspondente ao objeto.  A m√°gica do papel do DBA n√£o ajuda aqui. <br><br>  Do espec√≠fico.  Eu tenho um FORALL estranho no meu banco de dados, que, no entanto, funciona. <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--     PROCEDURE save_tar_test AS TYPE number_table IS TABLE OF NUMBER INDEX BY BINARY_INTEGER; TYPE date_table IS TABLE OF DATE INDEX BY BINARY_INTEGER; TYPE varchar50_table IS TABLE OF VARCHAR2(50) INDEX BY BINARY_INTEGER; TYPE char1_table IS TABLE OF CHAR(1) INDEX BY BINARY_INTEGER; TYPE t_tar_det_out_upd_rec_test IS RECORD ( --   cmr_tar_det_id number_table, in_stamp date_table, err_code_id number_table ); tdou_rec t_tar_det_out_upd_rec_test; BEGIN --   ,  tdou_rec  :      Oracle FORALL j IN 1 .. tdou_rec.cmr_tar_det_id.COUNT UPDATE cmr_tar_det dd SET err_code_id = tdou_rec.err_code_id(j) WHERE dd.cmr_tar_det_id = tdou_rec.cmr_tar_det_id(j) AND in_stamp = tdou_rec.in_stamp(j); END;</span></span></code> </pre><br>  Tibero diz que <i>‚Äúa instru√ß√£o dml deve ter o par√¢metro de entrada em massa ia forall close‚Äù</i> .  E eu entendo isso no fundo, mas esse c√≥digo teve que ser refeito em um ciclo regular. <br><br>  A situa√ß√£o com tabelas contendo objetos √© pior. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> S1.TYPE_PAY_HIST <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OBJECT</span></span> ( pay_status_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), stamp <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> S1.TABLE_PAY_HIST <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VARRAY</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> type_pay_hist; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> S2.RECEIPT ( receipt_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, pay_sum <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, receipt_hist S1.TABLE_PAY_HIST ); FUNCTION receipt_status_change(p_cmr_receipt_id NUMBER, p_new_status NUMBER) RETURN NUMBER AS l_receipt_hist s1.table_pay_hist; l_type_pay_hist s1.type_pay_hist; l_status NUMBER; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> receipt_hist <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> l_receipt_hist <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> receipt p <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> p.receipt_id = p_cmr_receipt_id <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span>; EXCEPTION WHEN NO_DATA_FOUND THEN RETURN c_err_not_find_status; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  Temos um erro de compila√ß√£o, digite mistmatch. <br><br>  Os caras da TMaxSoft propuseram esta vers√£o do c√≥digo: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> l_receipt_hist table_pay_hist; l_type_pay_hist type_pay_hist; l_status NUMBER; cmr_receipt_row cmr_receipt%rowtype; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> cmr_receipt_row <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> cmr_receipt p <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> p.cmr_receipt_id = p_cmr_receipt_id <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TYPE_PAY_HIST(r.pay_status_id,r.stamp) <span class="hljs-keyword"><span class="hljs-keyword">bulk</span></span> <span class="hljs-keyword"><span class="hljs-keyword">collect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> l_receipt_hist <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> cmr_receipt p,<span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(p.receipt_hist) r <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> p.cmr_receipt_id = p_cmr_receipt_id; EXCEPTION WHEN NO_DATA_FOUND THEN dbms_output.put_line('NO_DATA_FOUND'); RETURN null;<span class="hljs-comment"><span class="hljs-comment">--c_err_not_find_status; END; ... END;</span></span></code> </pre><br>  Trabalho, provavelmente funciona.  Mas n√£o √© t√£o conveniente, e voc√™ precisa refazer o c√≥digo. <br><br>  O restante √© compilado normalmente, exceto por coisas espec√≠ficas como SDO_GEOM.  E, a prop√≥sito, Tibero tem um an√°logo.  Suas m√£os ainda n√£o haviam chegado ao escrit√≥rio. <br><br><h3>  Tipos </h3><br>  Em um dos projetos, usamos o poder do OOP da Oracle hollow. <br>  A pergunta mais emocionante para Tibero foi sobre isso. <br><br>  Criamos um certo tipo, que √© b√°sico para um conjunto de outros tipos. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> t_tar_object <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OBJECT</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>), smth <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRUCTOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> t_tar_object <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RESULT</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> target(param <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> inside(o t_tar_object) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">clone</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> t_tar_object ) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FINAL</span></span>; <span class="hljs-comment"><span class="hljs-comment">--  CREATE OR REPLACE TYPE BODY t_tar_object AS CONSTRUCTOR FUNCTION t_tar_object RETURN SELF AS RESULT AS BEGIN RETURN; END; MEMBER FUNCTION target(param IN NUMBER DEFAULT NULL) RETURN NUMBER AS BEGIN RETURN id; END; MEMBER FUNCTION clone RETURN t_tar_object AS BEGIN RETURN NULL ; END; END;</span></span></code> </pre><br>  E agora estamos tentando criar um herdeiro digno para ele. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> t_tar_service <span class="hljs-keyword"><span class="hljs-keyword">UNDER</span></span> t_tar_object ( is_virtual <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRUCTOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> t_tar_service (p_serv_obj t_tar_object, p_main_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, p_pack_id <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RESULT</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">OVERRIDING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> target(param <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">OVERRIDING</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MEMBER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">clone</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> t_tar_object ) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FINAL</span></span>;</code> </pre><br>  O compilador se recusar√° a substituir a fun√ß√£o de destino.  Entretanto, n√£o h√° perguntas sobre a fun√ß√£o clone.  Verificou-se que Tibero n√£o gostou de OVERRIDING quando o m√©todo possui par√¢metros.  Ok, remova a palavra SUBSTITUI√á√ÉO.  Mas isso √© alarmante, e escrevemos scripts de teste.  At√© agora, com o tipo pai. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> o1 t_tar_object; i1 number := 100; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> o1 := t_tar_object; o1.id := 1; i1 := o1.target; <span class="hljs-comment"><span class="hljs-comment">-- dbms_output.put_line (i1)   . --      ,  ,     i1   -- if i1 &gt; 0 then dbms_output.put_line ('big'); end if; if i1 &lt; 0 then dbms_output.put_line ('small'); end if; if i1 = 0 then dbms_output.put_line ('zero'); end if; if i1 is null then dbms_output.put_line ('null'); end if; end;</span></span></code> </pre> <br>  Parece que n√£o deixamos uma escolha para o programa, independentemente do valor que a vari√°vel i1 assume, algo deve aparecer na sa√≠da.  Mas ... nada aparece! <br><br><img src="https://habrastorage.org/webt/tx/bf/he/txbfhe1mekorl0o6ormecblpbj8.jpeg"><br>  <i>Lembrei-me imediatamente de um √≥timo filme</i> <br><br>  Essa estranheza n√£o termina a√≠.  Tornando o experimento pior <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> o1 t_tar_object; i1 number := 100; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> o1 := t_tar_object; o1.id := 1; i1 := o1.target; <span class="hljs-comment"><span class="hljs-comment">--  ,      -    i1 := 2; if i1 &gt; 0 then dbms_output.put_line ('big'); end if; if i1 &lt; 0 then dbms_output.put_line ('small'); end if; if i1 = 0 then dbms_output.put_line ('zero'); end if; if i1 is null then dbms_output.put_line ('null'); end if; end;</span></span></code> </pre> <br>  Mesmo o fato de que, depois de todas as manipula√ß√µes com os m√©todos do objeto, definimos rigidamente o valor da vari√°vel, n√£o muda nada - a sa√≠da est√° vazia. <br><br>  Controle o experimento, teste a si mesmo quanto √† insanidade: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> o1 t_tar_object; i1 number ; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> o1 := t_tar_object; o1.id := 1; <span class="hljs-comment"><span class="hljs-comment">--i1 := o1.target;    i1 := 2; if i1 &gt; 0 then dbms_output.put_line ('big'); end if; if i1 &lt; 0 then dbms_output.put_line ('small'); end if; if i1 = 0 then dbms_output.put_line ('zero'); end if; if i1 is null then dbms_output.put_line ('null'); end if; end;</span></span></code> </pre><br>  O estimado "grande" aparece na sa√≠da.  Assustador, n√£o √©?  Usando uma cutucada cient√≠fica, os caras da TMaxSoft descobriram que, se voc√™ remover a nuance ‚ÄúNOT FINAL‚Äù da especifica√ß√£o t_tar_object, o objeto se comportar√° adequadamente.  Mas por que ent√£o precisamos de tal ... sem herdeiros. <br><br>  N√£o faz sentido falar mais sobre POO em Tibero.  Como, de fato, o OOP em Tibero.  Depois disso, surge outra pergunta: e o c√≥digo de procedimentos e fun√ß√µes que compilou - funciona corretamente?  Ainda n√£o sei.  Uma enorme quantidade de c√≥digo imigrou e compilou.  Para um projeto que n√£o cont√©m os tipos de exerc√≠cios acima, este √© um sucesso definitivo.  Mas testar a execu√ß√£o correta do c√≥digo √© uma tarefa s√©ria.  E para ser sincero, n√£o esperava encontr√°-la.  N√£o estarei pronto para dizer se terei um projeto neste DBMS.  Mas, se isso acontecer, o desenvolvimento ocorrer√° no Oracle, usando ferramentas convenientes normais e com migra√ß√£o regular para o Tibero.  Escrever c√≥digo no IDE sem avisos contextuais e com erros peri√≥dicos da pr√≥pria interface √© um prazer abaixo da m√©dia. <br><br><h3>  Conclus√µes </h3><br>  Tibero tem um futuro em seu estado atual?  N√£o tenho certeza.  Afinal, se voc√™ observar o custo das licen√ßas, excluindo a escala de mega escala, um soquete padr√£o custa cerca de 800.000, o que √© mais barato que o Oracle, mas √†s vezes n√£o.  E como eu estava convencido de minha pr√≥pria experi√™ncia, at√© agora isso n√£o √© nem perto da Oracle. <br><br>  Faz sentido usar o Tibero quase gratuito que est√° sendo oferecido agora?  Talvez sim.  Eles dizem que, ao pagar pelo custo do suporte t√©cnico (99.000 rublos por ano para um soquete), √© permitido o uso dessa base em projetos comerciais.  Se voc√™ tem uma equipe de oracleists dispon√≠vel e precisa criar e colocar algo n√£o muito complicado em seu servidor, mas mais barato e mais r√°pido - uma op√ß√£o interessante.  Voc√™ ainda pode jogar o cart√£o de san√ß√µes, dizendo aos clientes preocupados que a Cor√©ia n√£o √© os Estados Unidos. <br><br>  Devo traduzir projetos existentes do Oracle para o Tibero?  De jeito nenhum.  N√£o h√° raz√£o para procurar essa aventura.  √â mais f√°cil desistir do suporte t√©cnico da Oracle e n√£o pagar nada a ningu√©m. <br><br>  E se voc√™ precisar criar uma nova inst√¢ncia de um projeto antigo em execu√ß√£o no Oracle?  E, como resultado, comprar novas licen√ßas?  Pense aqui.  √â poss√≠vel que sua base migre e funcione qualitativamente.  Mas pense imediatamente em apoiar duas √°reas do projeto ou traduza tudo para o Tibero.  Consideramos custos, riscos e benef√≠cios trabalhistas de licen√ßas mais baratas.  Compare, decida. <br><br>  Talvez na pr√≥xima vers√£o do Tibero tudo seja diferente.  S√≥ √© necess√°rio finalizar os tipos, criar um IDE normal, talvez alterar a pol√≠tica de pre√ßos.  E se o DBMS for o mesmo que com os carros, depois de cinco anos os coreanos poder√£o ocupar uma fatia significativa do mercado e suplantar a hegemonia.  Vamos ver. <br><br><h3>  PS </h3><br>  Uma vantagem s√©ria ao escolher um DBMS para um novo projeto pode ser o trabalho do suporte t√©cnico da TMaxSoft.  Eu nem comprei uma licen√ßa por um d√≥lar e os caras me responderam prontamente, claramente interessados.  Eles ajudaram com perguntas est√∫pidas e com as descritas aqui.  O feedback √© excelente. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt413147/">https://habr.com/ru/post/pt413147/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt413137/index.html">Classifique grandes quantidades de dados no Apache Spark usando modelos arbitr√°rios de aprendizado de m√°quina</a></li>
<li><a href="../pt413139/index.html">Carros el√©tricos: a revolu√ß√£o est√° chegando</a></li>
<li><a href="../pt413141/index.html">Classifique grandes quantidades de dados no Apache Spark usando modelos arbitr√°rios de aprendizado de m√°quina</a></li>
<li><a href="../pt413143/index.html">Bobby Urban Lite: A nova mochila urbana da XD Design</a></li>
<li><a href="../pt413145/index.html">Analista ajuda empresas a ganhar dinheiro</a></li>
<li><a href="../pt413149/index.html">Data warehouse distribu√≠do no conceito Data Lake: por onde come√ßar</a></li>
<li><a href="../pt413151/index.html">A NSA prop√¥s um padr√£o de criptografia para dispositivos IoT, mas a ISO o rejeitou</a></li>
<li><a href="../pt413155/index.html">Guia de estilos de shell do Google (em russo)</a></li>
<li><a href="../pt413157/index.html">Sobre o armazenamento de senhas no banco de dados</a></li>
<li><a href="../pt413159/index.html">UI clara ou escura? Dicas para escolher um esquema de cores para sua interface</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>