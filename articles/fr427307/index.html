<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥üèø üõµ üòò Pratique de test du backend Java + Rest-Assured üò® üë©üèø‚ÄçüöÄ üõãÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans un article pr√©c√©dent, j'ai partag√© mon exp√©rience d'automatisation sur Robot Framework. Nous allons maintenant parler d'une approche l√©g√®rement d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pratique de test du backend Java + Rest-Assured</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/maxilect/blog/427307/">  Dans un article pr√©c√©dent, j'ai partag√© mon exp√©rience d'automatisation sur Robot Framework.  Nous allons maintenant parler d'une approche l√©g√®rement diff√©rente pour tester l'API d'un projet sur Kotlin. <br><br>  Profitant de la libert√© de choisir la pile technologique et comptant sur le d√©sir d'essayer quelque chose de nouveau ¬´au combat¬ª, je me suis tourn√© vers Rest-Assured.  Non sans quelques difficult√©s, mes coll√®gues et moi avons lanc√© des tests, et suite au d√©veloppement de l'approche, nous l'avons enregistr√©e dans la liste des t√¢ches cl√©s pour ce type de t√¢che. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dp/fb/py/dpfbpyb84ceqlsxp7b0ixsvo9wq.jpeg" alt="image"></div><br>  <i>(image utilis√©e comme parodie)</i> <br><a name="habracut"></a><br>  Tout a commenc√© avec le fait qu'il y avait une demande d'automatisation des tests d'API sur l'un des nouveaux projets <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du segment Ad-tech</a> .  Nous avons fait Campaign Manager, DMP et plusieurs int√©grations avec des syst√®mes tiers.  Et les testeurs avaient une t√¢che extr√™mement simple: automatiser les tests de fum√©e pour une int√©gration plus pouss√©e dans CI et une surveillance constante de l'√©tat de cette API, car des syst√®mes tiers y sont li√©s et un fonctionnement correct est essentiel.  Dans ce cas, la v√©rification de la logique m√©tier n'√©tait pas requise, car le service test√© est essentiellement une interface proxy. <br><br><h2>  Pourquoi √™tre rassur√©? </h2><br>  Du point de vue de l'automatisation des tests, nous avons r√©ussi √† travailler dans une vari√©t√© de domaines - UI, web, mobile, desktop, backend, REST API, SOAP.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le projet pr√©c√©dent</a> nous a donn√© beaucoup d'exp√©rience sur Robot Framework, il serait donc plus logique de l'utiliser.  La plupart de l'√©quipe de test le connaissent, et si un remplacement urgent est n√©cessaire, cela se fera rapidement et pratiquement sans douleur.  Mais une d√©cision diff√©rente a √©t√© prise. <br><br>  Tout d'abord, le projet lui-m√™me a √©t√© √©crit en Kotlin et construit en utilisant Gradle.  Dans le m√™me temps, au stade de la conception, les autotests ont √©t√© d√©cid√©s de ne pas attribuer de projet distinct.  Comme indiqu√© dans les commentaires de l'article pr√©c√©dent, coller Java (Kotlin) et le cadre de robot est une grande douleur, il √©tait donc inutile de se r√©f√©rer √† RF.  De plus, en repensant √† travailler avec un robot, j'√©tais int√©ress√© √† essayer une approche diff√©rente.  De plus, sur ce projet, nous avons pu choisir ind√©pendamment une pile technologique - l'entreprise n'a pas fix√© ses propres conditions. <br><br>  √Ä la recherche d'id√©es, je me suis tourn√© vers notre √©quipe de d√©veloppement, ainsi que des coll√®gues des tests, et le CTO <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">m'a</a> conseill√© de regarder Rest-Assured ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rest-assured.io</a> ).  Apr√®s avoir lu la documentation et les exemples de tests en open source, l'approche propos√©e par Rest-Assured m'a paru tr√®s attractive.  Cela signifie recevoir une r√©ponse du backend sous la forme de JSON, que nous d√©s√©rialisons en bons vieux objets Java. <br><br>  De plus, avec cette structure, vous pouvez travailler comme avec un objet normal.  En cons√©quence, nous avons une approche orient√©e objet tout √† fait normale pour valider la correspondance de la r√©ponse de l'API avec la structure d'objet d√©crite.  En prime, nous obtenons un test rapide et sans √©chec de la structure de r√©ponse - si l'objet re√ßu en d√©s√©rialisant la r√©ponse de l'API diff√®re par le nombre de champs ou leurs noms, les tests chuteront m√™me avant de v√©rifier les donn√©es avec une erreur de d√©s√©rialisation.  Nous comprendrons donc si nous devons r√©parer le backend ou mettre √† jour les tests conform√©ment aux nouvelles exigences de l'API.  Dans notre cas, cela √©tait important car, comme je l'ai mentionn√© ci-dessus, de nombreux sous-syst√®mes tiers sont li√©s √† l'API. <br><br>  Pour plus de pr√©cision, je note qu'environ le m√™me test de s√©curit√© peut √™tre obtenu sur RF, mais d'une mani√®re l√©g√®rement diff√©rente.  Cependant, l'histoire d'aujourd'hui n'est pas √† ce sujet.  Personnellement, il √©tait plus pratique et compr√©hensible pour moi d'entrer du c√¥t√© de Rest-Assured avec une entit√© qui a certains champs et m√©thodes. <br><br><h2>  Test de plumes </h2><br>  Avant de commencer √† utiliser la pile sur un vrai projet, j'ai d√©cid√© de l'essayer sur un petit service CRUD.  Afin de ne pas pratiquer imm√©diatement ses propres erreurs, j'ai d√©cid√© de rechercher les meilleures pratiques dans cette pile et j'ai rapidement trouv√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article de Philip Hauer</a> , o√π il refl√©tait son exp√©rience d'automatisation sur Rest-Assured.  Apr√®s avoir √©tudi√© l'article, √©crire une version de travail des tests de mon service n'a pas √©t√© difficile.  Ils se sont av√©r√©s simples, faciles √† lire et √† comprendre. <br><br><h2>  √Ä la bataille! </h2><br>  Le projet a d√©marr√© et lorsque les premi√®res structures de r√©ponse ont √©t√© d√©crites, la pr√©paration de la documentation de test et la r√©daction des autotests ont commenc√©.  Pour comprendre la situation dans son ensemble, je vais donner une pile compl√®te d'autotests: <br><br><ul><li>  Java </li><li>  JUnit4 - ex√©cution et param√©trage de scripts de test (annotation standard @Parametrize), <br></li><li>  Rest-Assured - construction et ex√©cution de requ√™tes, </li><li>  AssertJ - validation des valeurs re√ßues, </li><li>  Allure - immeuble de rapport, </li><li>  Gradle - montage </li><li>  Jackson - d√©s√©rialisation. </li></ul><br>  Lorsque les premiers tests ont √©t√© √©crits, le probl√®me du param√©trage correct est devenu apparent.  Transmettre des valeurs simples de donn√©es et le r√©sultat attendu semblait extr√™mement inefficace et moche.  Je n'ai pas eu le temps de r√©soudre ce probl√®me avant les vacances, mais mes coll√®gues, qui ont √©t√© impliqu√©s pendant mon absence, ont tout r√©gl√©.  Pour un param√©trage beau et facile √† lire, ils ont d√©cid√© de cr√©er une classe de base avec les fonctions d'ajout, de r√©ception et de suppression de param√®tres d'objet, dont toutes les classes dont les objets ont √©t√© utilis√©s pour appeler les m√©thodes API correspondantes ont √©t√© h√©rit√©es. <br><br><img src="https://habrastorage.org/webt/9j/vt/7r/9jvt7rmcd1w3wddoqmomp-_cpz4.png" alt="image"><br><br>  Cela a permis litt√©ralement √† la vol√©e de cr√©er les donn√©es n√©cessaires et de les transmettre dans les param√®tres de test. <br><br><img src="https://habrastorage.org/webt/ll/rx/5o/llrx5opu0wbwa29_nmbywqxsubq.png" alt="image"><br><br>  Rest-Assured vous permet de d√©s√©rialiser la r√©ponse √† la classe requise.  La r√©ponse r√©sultante est d√©compos√©e en une structure pr√©c√©demment connue √† l'aide de Jackson.  Les classes de d√©s√©rialisation semblent aussi simples que possible - tous les champs attendus avec leurs types sont d√©crits. <br><br><img src="https://habrastorage.org/webt/kw/kh/jr/kwkhjrtsj5zd6kxm0lkhcnaewqy.png" alt="image"><br><br>  De plus, un travail simple avec des objets et l'affirmation de champs sp√©cifiques et de leurs valeurs se poursuit. <br>  La chose la plus difficile et non √©vidente que j'ai rencontr√©e dans cette approche est l'incapacit√© de passer null √† Rest-Assured comme l'un des param√®tres (le r√©sultat est une baisse de NullPointerException).  Apparemment, c'est un probl√®me connu, mais le d√©veloppeur ne va pas corriger la situation, recommandant d'envoyer le champ vide ou de ne pas l'envoyer du tout.  Nous √©tions d√©j√† confront√©s √† ce probl√®me au stade o√π la base du projet √©tait pr√™te et il ne restait plus qu'√† ajouter des classes de test.  Par cons√©quent, nous avons juste l√©g√®rement corrig√© notre code. <br><br>  En g√©n√©ral, j'ai aim√© l'approche.  Il est curieux que, apr√®s un certain temps, il ait commenc√© √† √™tre appliqu√© sur le projet d'un autre client (mais pas de notre approvisionnement).  Et nous avons plac√© la pile assembl√©e pour les API de test d'automatisation (JUnit + AssertJ + Rest-Assured) dans la cat√©gorie des cl√©s pour les projets Java / Kotlin.  En Python, le tirer sera contre-intuitif, car il vaut mieux que les comp√©tences de d√©veloppement et de test se chevauchent. <br><br>  Il convient √©galement de noter que l'un des avantages de cette solution est son √©volutivit√© et son adaptabilit√© √† une logique complexe.  Cela signifie qu'il convient le mieux aux projets s√©rieux o√π il est vraiment logique de d√©crire de grands objets, de nettoyer le code et l'architecture de bloc, lorsqu'il existe des √©l√©ments distincts charg√©s de pr√©parer, de transmettre et de recevoir des donn√©es sous une forme lisible, ainsi que de v√©rifier ult√©rieurement la conformit√© des donn√©es certaines conditions.  Dans les petits projets, tout cela n'a aucun sens √† tirer. <br><br><h2>  R√©sum√© </h2><br>  En environ un mois, nous avons pu automatiser environ 250 tests et fournir le niveau de couverture requis.  Bien s√ªr, apr√®s la fin du processus d'automatisation, une pr√©sentation interne a √©t√© organis√©e pour tout le monde, afin que les employ√©s aient une id√©e du travail effectu√© et puissent tirer profit de l'exp√©rience acquise sur ce projet. <br><br>  Auteur de l'article: Dmitry Masters <br><br>  PS Nous publions nos articles sur plusieurs sites du Runet.  Abonnez-vous √† nos pages sur les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Ænes</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VK</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FB</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Telegram</a> pour d√©couvrir toutes nos publications et autres actualit√©s Maxilect. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427307/">https://habr.com/ru/post/fr427307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427295/index.html">Fonctions de currying JavaScript</a></li>
<li><a href="../fr427297/index.html">Apache Ignite + Apache Spark Data Frames: ensemble plus de plaisir</a></li>
<li><a href="../fr427299/index.html">Allons chercher autre chose √† collectionner? Constructeur 3 en 1 "Flotte Lunaire"</a></li>
<li><a href="../fr427301/index.html">Base de donn√©es crash de GitHub</a></li>
<li><a href="../fr427303/index.html">Ralentissement de Windows, partie 2: cr√©ation de processus</a></li>
<li><a href="../fr427309/index.html">Comment PVS-Studio s'est av√©r√© plus attentif que trois programmeurs et demi</a></li>
<li><a href="../fr427311/index.html">Comment devenir un centre de donn√©es si vous avez plus de 40 ans et que vous n'√™tes pas programmeur</a></li>
<li><a href="../fr427313/index.html">Comment SoftBank investit 50 milliards de dollars par an dans les startups et pourquoi cela d√©concerte les investisseurs</a></li>
<li><a href="../fr427315/index.html">Salle de lecture Izba ou une s√©lection de litt√©rature professionnelle</a></li>
<li><a href="../fr427317/index.html">Pour r√©ussir dans le domaine de l'informatique ou qu'est-ce qui tue IT'shnikov?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>