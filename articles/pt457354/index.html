<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö• üë©üèº‚Äçüè≠ üé∞ Ofusca√ß√£o de dados para testes de desempenho üéí üë®üèª‚Äçüåæ üòä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os usu√°rios do ClickHouse sabem que sua principal vantagem √© a alta velocidade de processamento de consultas anal√≠ticas. Mas como podemos fazer essas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ofusca√ß√£o de dados para testes de desempenho</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/457354/">  Os usu√°rios do ClickHouse sabem que sua principal vantagem √© a alta velocidade de processamento de consultas anal√≠ticas.  Mas como podemos fazer essas afirma√ß√µes?  Isso deve ser suportado por testes de desempenho confi√°veis.  Hoje falaremos sobre eles. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/ds/2m/sd/ds2msd5-4zeahpzlzptlqz8wgs8.png"></a> <br><br>  Come√ßamos a realizar esses testes em 2013, muito antes de o produto ficar dispon√≠vel em c√≥digo aberto.  Como agora, est√°vamos mais interessados ‚Äã‚Äãna velocidade do servi√ßo de dados Yandex.Metrica.  J√° armazenamos dados no ClickHouse desde janeiro de 2009.  Parte dos dados foi gravada no banco de dados desde 2012 e parte - foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">convertida</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OLAPServer e Metrage</a> - estruturas de dados que foram usadas no Yandex.Metrica anteriormente.  Portanto, para os testes, fizemos o primeiro subconjunto dispon√≠vel de 1 bilh√£o de dados de visualiza√ß√£o de p√°gina.  Ainda n√£o havia consultas no Metric, e criamos as consultas que s√£o mais interessantes para n√≥s (todos os tipos de filtragem, agrega√ß√£o e classifica√ß√£o). <br><br>  O ClickHouse foi testado em compara√ß√£o com sistemas similares, por exemplo, Vertica e MonetDB.  Para ser sincero, foi conduzido por um funcion√°rio que n√£o era desenvolvedor do ClickHouse e casos espec√≠ficos no c√≥digo n√£o foram otimizados at√© que os resultados fossem obtidos.  Da mesma forma, obtivemos um conjunto de dados para testes funcionais. <br><br>  Depois que o ClickHouse entrou no c√≥digo aberto em 2016, houve mais perguntas para os testes. <br><br><a name="habracut"></a><h2>  Desvantagens dos testes em dados propriet√°rios </h2><br>  Testes de desempenho: <br><br><ol><li> Eles n√£o s√£o reproduz√≠veis de fora, porque para execut√°-los, voc√™ precisa de dados particulares que n√£o podem ser publicados.  Pelo mesmo motivo, alguns testes funcionais n√£o est√£o dispon√≠veis para usu√°rios externos. </li><li>  N√£o desenvolva.  H√° uma necessidade de uma expans√£o significativa de seu conjunto, para que seja poss√≠vel verificar de maneira isolada as altera√ß√µes na velocidade de partes individuais do sistema. </li><li>  Eles n√£o executam de forma comprometida as solicita√ß√µes de pool, os desenvolvedores externos n√£o podem verificar o c√≥digo quanto √† regress√£o de desempenho. </li></ol><br>  Voc√™ pode resolver esses problemas - fa√ßa testes antigos e fa√ßa novos com base em dados abertos.  Entre os dados abertos, voc√™ pode coletar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dados de voos para os EUA</a> , de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">t√°xi em Nova York</a> ou usar os benchmarks prontos TPC-H, TPC-DS, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Star Schema Benchmark</a> .  O inconveniente √© que esses dados est√£o longe dos dados do Yandex.Metrica e eu gostaria de salvar as solicita√ß√µes de teste. <br><br><h2>  √â importante usar dados reais. </h2><br>  Voc√™ precisa testar o desempenho do servi√ßo apenas em dados reais da produ√ß√£o.  Vejamos alguns exemplos. <br><br>  <strong>Exemplo 1</strong> <br><br>  Suponha que voc√™ preencha um banco de dados com n√∫meros pseudo-aleat√≥rios distribu√≠dos igualmente.  Nesse caso, a compacta√ß√£o de dados n√£o funcionar√°.  Mas a compacta√ß√£o de dados √© uma propriedade importante para DBMSs anal√≠ticos.  Escolher o algoritmo de compacta√ß√£o correto e a maneira correta de integr√°-lo ao sistema √© uma tarefa n√£o trivial na qual n√£o existe uma solu√ß√£o correta, porque a compacta√ß√£o de dados requer um compromisso entre a velocidade de compacta√ß√£o e descompacta√ß√£o e a taxa de compacta√ß√£o potencial.  Os sistemas que n√£o sabem como compactar dados perdem a garantia.  Mas se usarmos n√∫meros pseudo-aleat√≥rios uniformemente distribu√≠dos para testes, esse fator n√£o ser√° considerado e todos os outros resultados ser√£o distorcidos. <br><br>  Conclus√£o: os dados de teste devem ter uma taxa de compress√£o realista. <br><br>  Sobre a otimiza√ß√£o de algoritmos de compacta√ß√£o de dados no ClickHouse, sobre os quais falei em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">post anterior</a> . <br><br>  <strong>Exemplo 2</strong> <br><br>  Vamos nos interessar pela velocidade da consulta SQL: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> RegionID, uniq(UserID) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> visitors     <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> test.hits     <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> RegionID     <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> visitors <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br>  Essa √© uma solicita√ß√£o t√≠pica para o Yandex.Metrica.  O que √© importante para a sua velocidade? <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como √© realizado o GROUP BY</a> ? </li><li>  Qual estrutura de dados √© usada para calcular a fun√ß√£o agregada uniq. </li><li>  Quantas RegionIDs diferentes s√£o e quanta RAM cada estado da fun√ß√£o uniq requer. </li></ul><br>  Mas tamb√©m √© muito importante que a quantidade de dados para diferentes regi√µes seja distribu√≠da de maneira desigual.  (Provavelmente, ele √© distribu√≠do de acordo com a lei da energia. Criei um gr√°fico na escala de log-log, mas n√£o tenho certeza.)  Quando existem muitas chaves de agrega√ß√£o diferentes, a contagem vai para unidades de bytes.  Como obter os dados gerados que possuem todas essas propriedades?  Obviamente, √© melhor usar dados reais. <br><br>  Muitos DBMSs implementam uma estrutura de dados HyperLogLog para o c√°lculo aproximado de COUNT (DISTINCT), mas todos funcionam relativamente mal porque essa estrutura de dados usa uma quantidade fixa de mem√≥ria.  E o ClickHouse possui uma fun√ß√£o que usa uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combina√ß√£o de tr√™s estruturas de dados diferentes</a> , dependendo do tamanho do conjunto. <br><br>  Conclus√£o: os dados de teste devem representar as propriedades da distribui√ß√£o dos valores nos dados - cardinalidade (o n√∫mero de valores nas colunas) e cardinalidade m√∫tua de v√°rias colunas diferentes. <br><br>  <strong>Exemplo 3</strong> <br><br>  Bem, vamos testar o desempenho n√£o do DBMS anal√≠tico do ClickHouse, mas de algo mais simples, por exemplo, tabelas de hash.  Para tabelas de hash, a escolha da fun√ß√£o de hash correta √© muito importante.  Para std :: unordered_map, √© um pouco menos importante, porque √© uma tabela de hash baseada em cadeia e um n√∫mero primo √© usado como o tamanho da matriz.  Na implementa√ß√£o da biblioteca padr√£o em gcc e clang, uma fun√ß√£o de hash trivial √© usada como a fun√ß√£o de hash padr√£o para tipos num√©ricos.  Mas std :: unordered_map n√£o √© a melhor op√ß√£o quando queremos obter velocidade m√°xima.  Ao usar tabelas de hash de endere√ßamento aberto, a escolha correta da fun√ß√£o de hash se torna um fator decisivo e n√£o podemos usar a fun√ß√£o de hash trivial. <br><br>  √â f√°cil encontrar testes de desempenho da tabela de hash em dados aleat√≥rios, sem considerar as fun√ß√µes de hash usadas.  Tamb√©m √© f√°cil encontrar testes de fun√ß√£o de hash com √™nfase na velocidade de computa√ß√£o e em alguns crit√©rios de qualidade, no entanto, isoladamente das estruturas de dados utilizadas.  Mas o fato √© que tabelas de hash e HyperLogLog exigem crit√©rios de qualidade diferentes para fun√ß√µes de hash. <br><br><img src="https://habrastorage.org/webt/bp/3h/32/bp3h320eztrirqzhm-lexeuhmbq.png"><br><br>  Leia mais sobre isso no relat√≥rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Como as tabelas de hash no ClickHouse s√£o organizadas"</a> .  Est√° um pouco desatualizado, pois n√£o considera <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tabelas su√≠√ßas</a> . <br><br><h2>  Desafio </h2><br>  Queremos obter os dados para o teste de desempenho por estrutura, o mesmo que os dados do Yandex.Metrica, para os quais todas as propriedades importantes para benchmarks s√£o armazenadas, mas para que nenhum vest√≠gio de visitantes reais do site seja deixado nesses dados.  Ou seja, os dados devem ser anonimizados e o seguinte deve ser armazenado: <br><br><ul><li>  taxas de compress√£o </li><li>  cardinalidade (n√∫mero de valores diferentes), </li><li>  cardinalidades m√∫tuas de v√°rias colunas diferentes, </li><li>  propriedades de distribui√ß√µes de probabilidade com as quais voc√™ pode simular dados (por exemplo, se acreditamos que as regi√µes s√£o distribu√≠das de acordo com uma lei de energia, o expoente - par√¢metro de distribui√ß√£o - para dados artificiais deve ser o mesmo que para real). </li></ul><br>  E o que √© necess√°rio para que os dados tenham uma taxa de compacta√ß√£o semelhante?  Por exemplo, se LZ4 for usado, as substrings nos dados bin√°rios devem ser repetidas aproximadamente nas mesmas dist√¢ncias e as repeti√ß√µes devem ter aproximadamente o mesmo comprimento.  Para o ZSTD, uma correspond√™ncia de entropia de bytes √© adicionada. <br><br>  O objetivo m√°ximo: disponibilizar uma ferramenta para pessoas externas, com a qual todos podem anonimizar seu conjunto de dados para publica√ß√£o.  Para que depuremos e testemos o desempenho nos dados de outras pessoas semelhantes aos da produ√ß√£o.  E eu gostaria que fosse interessante observar os dados gerados. <br><br>  Esta √© uma declara√ß√£o informal do problema.  No entanto, ningu√©m iria dar uma declara√ß√£o formal. <br><br><h2>  Tentativas de resolver </h2><br>  A import√¢ncia desta tarefa n√£o deve ser exagerada para n√≥s.  Na verdade, nunca estava nos planos e ningu√©m iria faz√™-lo.  Eu simplesmente n√£o perdi a esperan√ßa de que algo surgisse e, de repente, eu teria um bom humor e muitas coisas que poderiam ser adiadas para mais tarde. <br><br><h2>  Modelos probabil√≠sticos expl√≠citos </h2><br>  A primeira id√©ia √© selecionar uma fam√≠lia de distribui√ß√µes de probabilidade que a modele para cada coluna da tabela.  Em seguida, com base nas estat√≠sticas dos dados, selecione os par√¢metros de ajuste do modelo e gere novos dados usando a distribui√ß√£o selecionada.  Voc√™ pode usar um gerador de n√∫meros pseudo-aleat√≥rios com uma semente predefinida para obter um resultado reproduz√≠vel. <br><br>  Para campos de texto, voc√™ pode usar cadeias de Markov - um modelo compreens√≠vel para o qual voc√™ pode fazer uma implementa√ß√£o eficaz. <br><br>  √â verdade que alguns truques s√£o necess√°rios: <br><br><ul><li>  Queremos preservar a continuidade das s√©ries temporais - o que significa que, para alguns tipos de dados, √© necess√°rio modelar n√£o o valor em si, mas a diferen√ßa entre os vizinhos. </li><li>  Para simular a cardinalidade condicional das colunas (por exemplo, que geralmente existem poucos endere√ßos IP por identificador de visitante), voc√™ tamb√©m precisar√° anotar explicitamente as depend√™ncias entre as colunas (por exemplo, para gerar um endere√ßo IP, um hash do identificador de visitante √© usado, mas tamb√©m alguns outros dados pseudo-aleat√≥rios s√£o adicionados). </li><li>  N√£o est√° claro como expressar a depend√™ncia que um visitante, ao mesmo tempo, costuma visitar URLs com dom√≠nios correspondentes. </li></ul><br>  Tudo isso √© apresentado na forma de um programa no qual todas as distribui√ß√µes e depend√™ncias s√£o codificadas - o chamado "script C ++".  No entanto, os modelos de Markov ainda s√£o calculados a partir da soma das estat√≠sticas, suaviza√ß√£o e desbaste usando ru√≠do.  Comecei a escrever esse script, mas, por algum motivo, depois que escrevi explicitamente o modelo para dez colunas, de repente ele se tornou insuportavelmente chato.  E na tabela de hits no Yandex.Metrica em 2012, havia mais de 100 colunas. <br><br><pre> <code class="cpp hljs">EventTime.day(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::discrete_distribution&lt;&gt;({    <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, ...})(random)); EventTime.hour(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::discrete_distribution&lt;&gt;({    <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, ...})(random)); EventTime.minute(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;UInt8&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>)(random)); EventTime.second(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::uniform_int_distribution&lt;UInt8&gt;(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>)(random)); UInt64 UserID = hash(<span class="hljs-number"><span class="hljs-number">4</span></span>, powerLaw(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); UserID = UserID / <span class="hljs-number"><span class="hljs-number">10000000000U</span></span>LL * <span class="hljs-number"><span class="hljs-number">10000000000U</span></span>LL    + <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span>&gt;(EventTime) + UserID % <span class="hljs-number"><span class="hljs-number">1000000</span></span>; random_with_seed.seed(powerLaw(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> get_random_with_seed = [&amp;]{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random_with_seed(); };</code> </pre><br>  Essa abordagem da tarefa foi um fracasso.  Se eu a abordasse com mais dilig√™ncia, com certeza o roteiro teria sido escrito. <br><br>  Vantagens: <br><br><ul><li>  simplicidade ideol√≥gica. </li></ul><br>  Desvantagens: <br><br><ul><li>  a complexidade da implementa√ß√£o, </li><li>  a solu√ß√£o implementada √© adequada para apenas um tipo de dados. </li></ul><br>  E eu gostaria de uma solu√ß√£o mais geral - para que possa ser aplicada n√£o apenas aos dados do Yandex.Metrica, mas tamb√©m para ofuscar outros dados. <br><br>  No entanto, melhorias s√£o poss√≠veis aqui.  Voc√™ n√£o pode selecionar modelos manualmente, mas implementar um cat√°logo de modelos e escolher o melhor dentre eles (melhor ajuste + algum tipo de regulariza√ß√£o).  Ou talvez voc√™ possa usar os modelos de Markov para todos os tipos de campos, e n√£o apenas para texto.  Depend√™ncias entre dados tamb√©m podem ser entendidas automaticamente.  Para fazer isso, √© necess√°rio calcular as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entropias relativas</a> (quantidade relativa de informa√ß√µes) entre as colunas ou, mais simplesmente, as cardinalidades relativas (algo como ‚Äúquantos valores A diferentes, em m√©dia, para um valor B fixo‚Äù) para cada par de colunas.  Isso deixar√° claro, por exemplo, que URLDomain √© completamente dependente da URL, e n√£o vice-versa. <br><br>  Mas eu tamb√©m recusei essa id√©ia, porque h√° muitas op√ß√µes para o que precisa ser levado em considera√ß√£o e levar√° muito tempo para ser escrito. <br><br><h2>  Redes neurais </h2><br>  Eu j√° disse como essa tarefa √© importante para n√≥s.  Ningu√©m sequer pensou em fazer alguma amea√ßa √† sua implementa√ß√£o.  Felizmente, o colega Ivan Puzyrevsky trabalhou como professor no HSE e, ao mesmo tempo, estava desenvolvendo o n√∫cleo do YT.  Ele perguntou se eu tinha alguma tarefa interessante que pudesse ser oferecida aos alunos como um t√≥pico de diploma.  Ofereci-lhe este e ele me garantiu que era adequado.  Ent√£o, entreguei essa tarefa a uma boa pessoa ‚Äúda rua‚Äù - Sharif Anvardinov (a NDA est√° assinada para trabalhar com dados). <br><br>  Ele contou a ele todas as suas id√©ias, mas, o mais importante, explicou que o problema pode ser resolvido de qualquer maneira.  E apenas uma boa op√ß√£o seria usar as abordagens que eu n√£o entendo: por exemplo, gerar um despejo de dados de texto usando LSTM.  Pareceu encorajador gra√ßas ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo A efic√°cia irracional das redes neurais recorrentes</a> , que depois me chamou a aten√ß√£o. <br><br>  O primeiro recurso da tarefa √© que voc√™ precisa gerar dados estruturados, n√£o apenas texto.  N√£o era √≥bvio se uma rede neural recorrente seria capaz de gerar dados com a estrutura desejada.  Existem duas maneiras de resolver isso.  O primeiro √© usar modelos separados para gerar a estrutura e para o "preenchedor": a rede neural deve gerar apenas valores.  Mas essa op√ß√£o foi adiada para mais tarde, ap√≥s o que nunca o foram.  A segunda maneira √© simplesmente gerar um despejo de TSV como texto.  A pr√°tica demonstrou que, no texto, parte das linhas n√£o corresponde √† estrutura, mas essas linhas podem ser descartadas no carregamento. <br><br>  O segundo recurso - uma rede neural recorrente gera uma sequ√™ncia de dados, e as depend√™ncias nos dados s√≥ podem seguir na ordem dessa sequ√™ncia.  Mas, em nossos dados, talvez a ordem das colunas seja revertida em rela√ß√£o √†s depend√™ncias entre elas.  N√£o fizemos nada com esse recurso. <br><br>  No ver√£o, apareceu o primeiro script Python que gerou dados.  √Ä primeira vista, a qualidade dos dados √© decente: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f4/816/f70/6f4816f70912c3fb348f505d3073eded.jpg"><br><br>  √â verdade que as dificuldades foram reveladas: <br><br><ol><li>  O tamanho do modelo √© de cerca de um gigabyte.  E tentamos criar um modelo para dados cujo tamanho estava na ordem de v√°rios gigabytes (para iniciantes).  O fato de o modelo resultante ser t√£o grande suscita preocupa√ß√µes: repentinamente ser√° poss√≠vel obter dados reais sobre os quais ele foi treinado.  Provavelmente n√£o.  Mas eu n√£o entendo aprendizado de m√°quina e redes neurais e n√£o li o c√≥digo Python dessa pessoa, ent√£o como posso ter certeza?  Depois, havia artigos sobre como compactar redes neurais sem perder a qualidade, mas isso foi deixado sem implementa√ß√£o.  Por um lado, isso n√£o parece um problema - voc√™ pode se recusar a publicar o modelo e publicar apenas os dados gerados.  Por outro lado, no caso de reciclagem, os dados gerados podem conter parte dos dados de origem. </li><li>  Em uma √∫nica m√°quina com uma CPU, a taxa de gera√ß√£o de dados √© de aproximadamente 100 linhas por segundo.  Tivemos uma tarefa - gerar pelo menos um bilh√£o de linhas.  O c√°lculo mostrou que isso n√£o poderia ser feito antes da defesa do diploma.  E usar outro hardware n√£o √© pr√°tico, porque eu tinha um objetivo - disponibilizar a ferramenta de gera√ß√£o de dados para uso amplo. </li></ol><br>  Sharif tentou estudar a qualidade dos dados comparando estat√≠sticas.  Por exemplo, calculei a frequ√™ncia com que s√≠mbolos diferentes aparecem na fonte e nos dados gerados.  O resultado foi impressionante - os caracteres mais comuns s√£o √ê e √ë. <br><br>  N√£o se preocupe - ele defendeu seu diploma perfeitamente, depois do qual esquecemos com seguran√ßa esse trabalho. <br><br><h2>  Muta√ß√£o de dados compactados </h2><br>  Suponha que a declara√ß√£o do problema seja reduzida a um ponto: voc√™ precisa gerar dados para os quais as taxas de compacta√ß√£o ser√£o exatamente iguais aos dados originais, enquanto os dados devem ser expandidos exatamente na mesma velocidade.  Como fazer isso?  Precisa editar bytes de dados compactados diretamente!  Em seguida, o tamanho dos dados compactados n√£o ser√° alterado, mas os dados em si ser√£o alterados.  Sim, e tudo funcionar√° rapidamente.  Quando essa ideia apareceu, eu imediatamente quis implement√°-la, apesar de resolver outro problema em vez do original.  Isso sempre acontece. <br><br>  Como editar um arquivo compactado diretamente?  Suponha que estamos interessados ‚Äã‚Äãapenas em LZ4.  Os dados compactados usando LZ4 consistem em dois tipos de instru√ß√µes: <br><br><ol><li>  Literais: copie os pr√≥ximos N bytes como est√£o. </li><li>  Correspond√™ncia (correspond√™ncia, o tamanho m√≠nimo de repeti√ß√£o √© 4): repita N bytes que estavam no arquivo a uma dist√¢ncia de M. </li></ol><br>  Dados de origem: <br>  <code>Hello world Hello</code> . <br><br>  Dados compactados (condicionalmente): <br>  <code>literals 12 "Hello world " match 5 12</code> . <br><br>  No arquivo compactado, deixe match como est√° e, nos literais, alteraremos os valores dos bytes.  Como resultado, ap√≥s a descompress√£o, obtemos um arquivo no qual todas as seq√º√™ncias repetidas de pelo menos 4 tamb√©m s√£o repetidas e repetidas nas mesmas dist√¢ncias, mas ao mesmo tempo consistem em um conjunto diferente de bytes (falando figurativamente, nenhum byte foi retirado do arquivo original no arquivo modificado ) <br><br>  Mas como mudar bytes?  Isso n√£o √© √≥bvio porque, al√©m dos tipos de coluna, os dados tamb√©m t√™m sua pr√≥pria estrutura impl√≠cita e interna, que gostar√≠amos de preservar.  Por exemplo, o texto √© frequentemente armazenado na codifica√ß√£o UTF-8 - e tamb√©m queremos UTF-8 v√°lido nos dados gerados.  Fiz uma heur√≠stica simples para satisfazer v√°rias condi√ß√µes: <br><br><ul><li>  bytes nulos e caracteres de controle ASCII foram armazenados como est√£o, </li><li>  alguma pontua√ß√£o persistiu, </li><li>  O ASCII foi convertido em ASCII e, para o resto, o bit mais significativo foi salvo (ou voc√™ pode escrever explicitamente um se configurado para diferentes comprimentos UTF-8).  Entre uma classe de bytes, um novo valor √© selecionado uniformemente aleatoriamente; </li><li>  e tamb√©m para salvar fragmentos de <code>https://</code> e similares, caso contr√°rio, tudo parece muito bobo. </li></ul><br>  A peculiaridade dessa abordagem √© que os pr√≥prios dados iniciais atuam como um modelo para os dados, o que significa que o modelo n√£o pode ser publicado.  Permite gerar a quantidade de dados n√£o mais do que o original.  Para compara√ß√£o, nas abordagens anteriores, foi poss√≠vel criar um modelo e gerar uma quantidade ilimitada de dados em sua base. <br><br>  Exemplo para URL: <br><br> <code>http://ljc.she/kdoqdqwpgafe/klwlpm&amp;qw=962788775I0E7bs7OXeAyAx <br> http://ljc.she/kdoqdqwdffhant.am/wcpoyodjit/cbytjgeoocvdtclac <br> http://ljc.she/kdoqdqwpgafe/klwlpm&amp;qw=962788775I0E7bs7OXe <br> http://ljc.she/kdoqdqwdffhant.am/wcpoyodjit/cbytjgeoocvdtclac <br> http://ljc.she/kdoqdqwdbknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu_qxht <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu_qxht <br> http://ljc.she/kdoqdqw-bknvj.s/hmqhpsavon.yf#aortxqdvjja <br> http://ljc.she/kdoqdqwpdtu-Unu-Rjanjna-bbcohu-702130 <br></code> <br>  O resultado me agradou - foi interessante olhar para os dados.  Mas ainda assim, algo estava errado.  Os URLs ainda est√£o estruturados, mas em alguns lugares era f√°cil adivinhar yandex ou avito.  Fez uma heur√≠stica que √†s vezes reorganiza alguns bytes em alguns lugares. <br><br>  Outras considera√ß√µes preocupadas.  Por exemplo, informa√ß√µes confidenciais podem ser representadas em uma coluna do tipo FixedString em formato bin√°rio e, por algum motivo, consistir em caracteres de controle ASCII e pontua√ß√£o, que decidi salvar.  E eu n√£o considero tipos de dados. <br><br>  Outro problema: se os dados do tipo "comprimento, valor" s√£o armazenados em uma coluna (√© assim que as colunas do tipo String s√£o armazenadas), como garantir que o comprimento permane√ßa correto ap√≥s a muta√ß√£o?  Quando tentei consertar, a tarefa imediatamente se tornou desinteressante. <br><br><h2>  Permuta√ß√µes aleat√≥rias </h2><br>  Mas o problema n√£o est√° resolvido.  Realizamos v√°rias experi√™ncias, e s√≥ piorou.  Resta apenas n√£o fazer nada e ler p√°ginas aleat√≥rias na Internet, porque o clima j√° est√° estragado.  Felizmente, em uma dessas p√°ginas havia uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">an√°lise do algoritmo para</a> renderizar a cena da morte do protagonista no jogo Wolfenstein 3D. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5d/8a2/291/a5d8a229119786bc45f48fb74cfb956d.gif" width="640" height="480"><br><br>  Bela anima√ß√£o - a tela se enche de sangue.  O artigo explica que essa √© realmente uma permuta√ß√£o pseudo-aleat√≥ria.  Permuta√ß√£o aleat√≥ria - uma transforma√ß√£o individual selecionada aleatoriamente de um conjunto.  Ou seja, a exibi√ß√£o de todo o conjunto no qual os resultados para diferentes argumentos n√£o s√£o repetidos.  Em outras palavras, essa √© uma maneira de iterar todos os elementos de um conjunto em uma ordem aleat√≥ria.  √â esse processo que √© mostrado na figura - pintamos sobre cada pixel, selecionados aleatoriamente de todos, sem repeti√ß√£o.  Se escolhermos um pixel aleat√≥rio a cada passo, levaremos muito tempo para pintar o √∫ltimo. <br><br>  O jogo usa um algoritmo muito simples para permuta√ß√£o pseudo-aleat√≥ria - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LFSR</a> (registro de deslocamento de feedback linear).  Como geradores de n√∫meros pseudo-aleat√≥rios, permuta√ß√µes aleat√≥rias, ou melhor, suas fam√≠lias, parametrizadas por uma chave, podem ser criptograficamente fortes - √© exatamente isso que precisamos para a convers√£o de dados.  Embora possa haver detalhes n√£o √≥bvios.  Por exemplo, a criptografia criptograficamente forte de N bytes a N bytes com uma chave pr√©-fixada e o vetor de inicializa√ß√£o, ao que parece, pode ser usada como uma permuta√ß√£o pseudo-aleat√≥ria de muitas seq√º√™ncias de N bytes.  De fato, essa transforma√ß√£o √© individual e parece aleat√≥ria.  Mas se usarmos a mesma transforma√ß√£o para todos os nossos dados, o resultado poder√° ser analisado, porque o mesmo vetor de inicializa√ß√£o e valores-chave s√£o usados ‚Äã‚Äãv√°rias vezes.  √â semelhante ao modo de cifra de bloco do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">livro de c√≥digos eletr√¥nico</a> . <br><br>  Quais s√£o as maneiras de obter uma permuta√ß√£o pseudo-aleat√≥ria?  Voc√™ pode realizar transforma√ß√µes simples e individuais e montar uma fun√ß√£o bastante complexa a partir delas que parecer√° aleat√≥ria.  Deixe-me dar um exemplo de algumas das minhas transforma√ß√µes individuais favoritas: <br><br><ul><li>  multiplica√ß√£o por um n√∫mero √≠mpar (por exemplo, um grande primo) na aritm√©tica do complemento de dois, </li><li>  xor-shift: <code>x ^= x &gt;&gt; N</code> , </li><li>  CRC-N, onde N √© o n√∫mero de bits do argumento. </li></ul><br>  Assim, por exemplo, a partir de tr√™s multiplica√ß√µes e duas opera√ß√µes xor-shift, o finalizador <a href="">murmurhash</a> √© <a href="">montado</a> .  Esta opera√ß√£o √© uma permuta√ß√£o pseudo-aleat√≥ria.  Mas, apenas no caso, observo que as fun√ß√µes de hash, mesmo N bits em N bits, n√£o precisam ser mutuamente exclusivos. <br><br>  Ou aqui est√° outro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplo</a> interessante <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">da teoria elementar dos n√∫meros</a> no site de Jeff Preshing. <br><br>  Como podemos usar permuta√ß√µes pseudo-aleat√≥rias para nossa tarefa?  Voc√™ pode converter todos os campos num√©ricos usando-os.  Ent√£o ser√° poss√≠vel preservar todas as cardinalidades e cardinalidades m√∫tuas de todas as combina√ß√µes de campos.  Ou seja, COUNT (DISTINCT) retornar√° o mesmo valor que antes da convers√£o e com qualquer GROUP BY. <br><br>  Vale ressaltar que a preserva√ß√£o de todas as cardinalidades √© levemente contr√°ria √† afirma√ß√£o do problema da anonimiza√ß√£o dos dados. ,  ,         ,      10  ,        .           10   ‚Äî   ,    .    ,    ,     ,         ‚Äî ,    ,    .       . ,    ,         ,     Google,       ,  -          Google.       ‚Äî ,      ,          ( )     ( ).  ,        ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . <br><br>           ,      . ,       10,        .   ? <br><br> ,       size classes         (  ).       size class        ,    .  0  1    .  2  3   1/2        1/2      .   1024..2047     1024! () .  E assim por diante        . <br><br>  ,     . ,      -.    ,      . <br><br>       ,     ,      ,             . <br><br>    ‚Äî             ,       .   .            .   Fabien Sanglard   c <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hackers News</a> ,      .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">    Redis</a> ‚Äî  .    ,            <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a> . <br><br>     .   ‚Äî  ,        . ,   . <br><br><ol><li>      : <br> <code>arg: xxxxyyyy <br> <font color="#0fc000">arg_l</font> : xxxx <br> <font color="#0000ff">arg_r</font> : yyyy</code> </li> <li>      .      xor        : <br> <code>res: yyyyzzzz <br> <font color="#0000ff">res_l</font> = yyyy = <font color="#0000ff">arg_r</font> <br> <font color="#FF6600">res_r</font> = zzzz = <font color="#0fc000">arg_l</font> ^ F( <font color="#0000ff">arg_r</font> )</code> </li> </ol><br>   ,     F            4 ,      . <br><br>   :  ,       ,      ‚Äî      ,       ,     ! <br><br>         .  ,    ,      ,    .     : <br><br><ul><li>     ,  ,  Electronic Codebook mode of operation; </li><li>        (  )   ,     ,      . </li></ul><br>           . ,     LZ4     ,             ,        . <br><br><h2>   </h2><br>    ,  ,  ,         .   ‚Äî     .  , ,      ,    .                ( ,    ).          ? <br><br> -,         : ,  256^10     10 ,      ,          . -,      ,     . <br><br>        ,      . ,    ,       .    ,       .    ,   -   . <br><br>             ,       ‚Äî  ,     N   . N ‚Äî   . , N = 5,       ¬´¬ª   ¬´¬ª.       Order-N. <br><br> <code>P( <font color="#ff0000"></font> | ) = 0.9 <br> P( <font color="#ff0000"></font> | ) = 0.05 <br> P( <font color="#ff0000"></font> | ) = 0.01 <br> ...</code> <br> <br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">.</a> ( vesna.yandex.ru).      LSTM,           N,    ,  .          ‚Äî           ,    .  :      ,  ,      . <br><br>   Title: <br><br><blockquote>   ‚Äî . ‚Äî     ,   .   ,   ,      ‚Äî .@Mail.Ru ‚Äî   ‚Äî -    . ) ‚Äî AUTO.ria.ua        </blockquote><br> ,       ,          .       () ,           ‚Äî   .        0  N,         N    N ‚àí 1). <br><br>       . ,      123456   URL,          .                    .      -.       .      ,    . <br><br>   :         URL,        ,   -. : <code>https://www.yandex.ru/images/cats/?id=xxxxxx</code> .  ,      URL,      ,   . : <code>http://ftp.google.kz/cgi-bin/index.phtml?item=xxxxxx</code> .                  -     ,      8    . <br><br> <code>https://www.yandex.ru/ <font color="#0fc000">images/c</font> ats/?id=12345 <br> ^^^^^^^^ <br> <br> distribution: [aaaa][b][cc][dddd][e][ff][g <font color="#ff0000">g</font> ggg][h]... <br> hash(" <font color="#0fc000">images/c</font> ") % total_count:           ^ <br> <br></code> <code>http://ftp.google.kz/c <font color="#ff0000">g</font> ...</code> <br> <br>    ,  .     : <br><br><blockquote><pre> -        | . -    <font></font>
-  ‚Äî .:      Lore - dfghf ‚Äî . -   )  473682  -  <font></font>
- !   ¬ª  -  ‚Äî      <font></font>
- !   ¬ª , <font></font>
-  .  c      @Mail.Ru - <font></font>
-     ,  2010 |  . <font></font>
- !    : 820 0000 .,    -<font></font>
-   - DoramaTv.ru -   . -  ..    <font></font>
-  .  2013 ,       -&gt;  80 .<font></font>
-  -    (.    , ,  <font></font>
-   . 5, 69,  W* - ., ,      World of Tanks<font></font>
- ,     . 2     @Mail.Ru<font></font>
-      ,  .   <font></font>
</pre></blockquote><br><h2>  Resultado </h2><br>        ,     - ,        -   .          ,  .      clickhouse obfuscator,     :          (, CSV, JSONEachRow),        (   )    ( ,       ).         . <br><br>     clickhouse-client,         Linux.        ,   ClickHouse. ,         MySQL  PostgreSQL ,        . <br><br> <code>clickhouse obfuscator \ <br> --seed "$(head -c16 /dev/urandom | base64)" \ <br> --input-format TSV --output-format TSV \ <br> --structure 'CounterID UInt32, URLDomain String, \ <br> URL String, SearchPhrase String, Title String' \ <br> &lt; table.tsv &gt; result.tsv <br> <br> clickhouse obfuscator --help <br></code> <br>    ,        .     ,   ?      ,        ,    .        ,    ,      .   ,     (  <code>--help</code> )   . <br><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   </a> ,        . <br><br> <a href="">clickhouse-datasets.s3.yandex.net/hits/tsv/hits_v1.tsv.xz</a> <br> <a href="">clickhouse-datasets.s3.yandex.net/visits/tsv/visits_v1.tsv.xz</a> <br><br>                ClickHouse.          ,       ClickHouse  . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457354/">https://habr.com/ru/post/pt457354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457340/index.html">10 plugins PostCSS que economizar√£o seu tempo de layout</a></li>
<li><a href="../pt457342/index.html">Sinais do alto: como salvamos os cart√≥grafos de trabalho desnecess√°rio e olhos vermelhos</a></li>
<li><a href="../pt457348/index.html">Implanta√ß√£o no PythonAnywhere do GitHub</a></li>
<li><a href="../pt457350/index.html">Por que o oscilosc√≥pio precisa de suporte de criptografia?</a></li>
<li><a href="../pt457352/index.html">Conclus√£o de informa√ß√µes na tela do comprador</a></li>
<li><a href="../pt457362/index.html">Promo√ß√£o da RUVDS: prepare o servidor no ver√£o</a></li>
<li><a href="../pt457366/index.html">Um fan√°tico, um peda√ßo de ferro ou um espectador - que tipo de jogador voc√™ √©?</a></li>
<li><a href="../pt457374/index.html">Reduza o tempo de compila√ß√£o de seus projetos Android</a></li>
<li><a href="../pt457378/index.html">Como a id Software criou o Wolfenstein 3D com base na tecnologia do Commander Keen</a></li>
<li><a href="../pt457380/index.html">OpenGL ultramoderno. Parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>