<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ûüèª üïØÔ∏è üéª Obtenez la d√©claration USRN de Rosreestr en utilisant python, en contournant l'api üçç üë©üèª‚Äç‚öïÔ∏è üìé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pas la premi√®re connaissance du portail Rosreestr 
 Tout avocat a d√©j√† fait une demande √† Rosreestr (Service f√©d√©ral d'enregistrement des √©tats, de ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Obtenez la d√©claration USRN de Rosreestr en utilisant python, en contournant l'api</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460040/"><h3>  Pas la premi√®re connaissance du portail Rosreestr </h3><br>  Tout avocat a d√©j√† fait une demande √† Rosreestr (Service f√©d√©ral d'enregistrement des √©tats, de cadastre et de cartographie).  Le temps o√π pour une demande il fallait se pr√©senter √† la succursale Rosreestr et d√©poser une demande sur papier appartient au pass√©.  Rosreestr a lanc√© plusieurs services en ligne que vous pouvez utiliser sans quitter votre domicile.  Ces services comprennent une demande d'extrait du Registre d'√âtat unifi√© de l'immobilier.  Site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">officiel</a> pour commencer. <br><br>  Quiconque a d√©j√† r√©ussi √† travailler avec le site sait que pour recevoir un extrait de l'USRN, qui contiendra des informations non seulement sur les caract√©ristiques g√©n√©rales de l'installation, mais √©galement sur le d√©tenteur des droits d'auteur de cette installation, il est n√©cessaire de se rendre sur le compte personnel de Rosreestr. <br><br>  C'est peut-√™tre un moyen pratique d'obtenir une ou plusieurs d√©clarations.  Cependant, que faire si vous avez besoin d'un paquet d'extraits d'USRN?  Supposons que vous travaillez avec des biens immobiliers ou que vous poss√©dez un certain nombre d'objets, dont le nombre total est sup√©rieur √† 10. En r√®gle g√©n√©rale, vous devez recevoir un extrait de l'USRN au moins 1 fois par an afin de pouvoir r√©agir rapidement dans le plan juridique aux modifications ind√©sirables du registre f√©d√©ral si elles se produisent en plus des v√¥tres la volont√©. <br><br><a name="habracut"></a><br>  Vous pouvez soumettre manuellement des demandes via votre compte personnel, ou vous pouvez utiliser l'API Rosreestr.  La premi√®re option est extr√™mement fatigante.  En plus du fait que le service en ligne Rosreestra lui-m√™me fonctionne tr√®s lentement avec des blocages constants, l'utilisateur ordinaire est √©galement invit√© √† soumettre un arsenal de champs pour l'objet lors de la soumission de chaque demande.  Par exemple, une demande de terrain: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u9/tg/mm/u9tgmm4q3jkkaxgzabu9ktaf3_a.jpeg"></div><br>  Autrement dit, pour trouver des informations sur l'objet et en obtenir un extrait, physique.  la personne doit d√©j√† conna√Ætre toutes les caract√©ristiques de l'objet!  Et chaque fois que vous demandez des informations, vous devez remplir tous les champs.  Que dire est tr√®s g√™nant.  Merci d'avoir au moins pr√©vu que le terrain puisse √™tre mesur√© en millim√®tres carr√©s. <br><br>  La deuxi√®me option pour obtenir des extraits de l'USRN est l'API Rosreestr.  Api est un ensemble d'instructions du programme, selon lequel votre partie logicielle et partie de Rosreestr √©changent des informations sans votre participation.  Une chose pratique si tout fonctionne correctement.  Et on pourrait finir. <br><br>  Cependant, si vous regardez la page o√π Rosreestr explique comment impl√©menter une API pratique, vous vous sentez mal √† l'aise. <br><br>  Un document avec une description est publi√© ici - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rosreestr.ru/wps/portal/cc_ib_documents?documentId=1521</a> <br><br>  Il ne prend que 19 pages, mais est √©crit en langage technique et sugg√®re que nous ne pouvons pas nous passer d'une signature num√©rique.  En g√©n√©ral, pendant longtemps, c'est incompr√©hensible et incommode.  Allons plus loin. <br><br>  Lorsque nous travaillons avec le site suspendu de Rosreestr, nous avons besoin d'une compr√©hension d'un tel outil Python que les attentes.  L'outil le plus appropri√© pour travailler avec ce site, au moins au stade actuel de d√©veloppement de ce service Rosreestra. <br><br>  Lorsqu'une page se charge lentement charg√©e dans un navigateur, les √©l√©ments de cette page peuvent appara√Ætre √† diff√©rents intervalles de temps (ou ne pas appara√Ætre du tout).  Cela rend difficile la recherche d'√©l√©ments; une exception ElementNotVisibleException ou NoSuchElement est lev√©e p√©riodiquement.  En utilisant les attentes, nous pouvons r√©soudre ce probl√®me. <br><br>  L'attente donne un certain intervalle de temps entre les actions effectu√©es - la recherche d'un √©l√©ment ou toute autre op√©ration avec l'√©l√©ment. <br><br>  Puisque nous utilisons le module s√©l√©nium dans notre travail, nous travaillerons avec ce qu'il offre.  Le s√©l√©nium fournit deux types d'attentes - implicites et explicites. <br><br>  L'attente explicite est le code par lequel vous d√©terminez quelle condition doit se produire pour que du code suppl√©mentaire soit ex√©cut√©.  Plus t√¥t, nous avons utilis√© time.sleep (), qui d√©finit le d√©lai d'expiration exact.  Mais cette option n'est pas enti√®rement r√©ussie.  L'inconv√©nient est que si vous ne devinez pas le temps d'arr√™t (sommeil), le programme plantera.  Il existe des m√©thodes plus pratiques qui peuvent vous aider √† √©crire du code qui attend autant que vous en avez besoin. <br><br><h3>  Nous √©crivons un programme pour travailler avec le Rosreestr en ligne </h3><br>  Passons √† notre programme. <br><br>  Son essence est que lorsqu'elle acc√®de au site Web de Rosreestr, elle se connecte via le compte personnel d'une personne physique.  personnes et a en outre commenc√© √† soumettre de mani√®re ind√©pendante des demandes d'extraits de l'USRN.  Notre programme recevra des donn√©es pour les demandes d'un fichier Excel (o√π serait-il sans lui).  Une mise en garde.  Lors de la soumission d'une demande, le site Web Rosreestr dispose d'un champ avec l'adresse de l'objet.  Il y aura des difficult√©s, car les adresses de Rosreestr sont ouvertes de mani√®re sp√©ciale.  Cela devra √™tre pris en compte dans le programme. <br><br>  Commen√ßons. <br><br>  Avant de commencer, pr√©parez un tableau Excel avec les donn√©es source au format suivant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3r/l4/v6/3rl4v6quswpmwbrzd-23pb6uk2o.jpeg"></div><br>  Num√©ro-nom du titulaire du droit d'auteur-adresse de la propri√©t√©-type de propri√©t√©-num√©ro cadastral-zone.  Sur demande, nous aurons besoin de tous les champs du tableau √† l'exception de ¬´num√©ro¬ª et ¬´nom du titulaire du droit d'auteur¬ª. <br><br>  Cr√©ez maintenant un nouveau fichier python - rosreestr.py.  Et nous importons les modules n√©cessaires: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webbrowser,time <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webdriver <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.webdriver.common.keys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Keys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.common.exceptions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NoSuchElementException <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl</code> </pre> <br>  Ouvrez le fichier Excel avec des donn√©es sur l'immobilier: <br><br><pre> <code class="python hljs">wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'activ2.xlsx'</span></span>) sheet=wb.get_active_sheet()</code> </pre> <br>  Nous allons sur le site Web de Rosreestr.  √âtant donn√© que l'entr√©e du site lui-m√™me peut d√©j√† √™tre retard√©e, vous devez d√©finir une attente: <br><br><pre> <code class="python hljs">browser = webdriver.Firefox() browser.get (<span class="hljs-string"><span class="hljs-string">'https://rosreestr.ru/'</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br>  Ici, vous pouvez laisser juste time.sleep 5 secondes.  Mais mieux, en utilisant les attentes, √©crivez comme ceci: <br><br><pre> <code class="python hljs">browser.implicitly_wait(<span class="hljs-number"><span class="hljs-number">40</span></span>)</code> </pre> <br>  Maintenant, nous devons attendre que le bouton apparaisse dans votre compte personnel et cliquez dessus: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#top_panel &gt; a:nth-child(4)'</span></span>) act.click()</code> </pre><br>  √âtant donn√© que l'enregistrement dans votre compte personnel s'effectue via le portail des services d'√âtat, le site redirige vers les services d'√âtat et cela se produit √©galement avec un retard, consid√©rez ceci: <br><br><pre> <code class="python hljs">browser.implicitly_wait(<span class="hljs-number"><span class="hljs-number">40</span></span>) act = browser.find_element_by_id(<span class="hljs-string"><span class="hljs-string">'mobileOrEmail'</span></span>) act.click()</code> </pre> <br>  Maintenant, le programme nous autorisera sur le site Web du Service d'√âtat en entrant un nom d'utilisateur et un mot de passe (au lieu d'un nom d'utilisateur et d'un mot de passe, entrez vos donn√©es): <br><br><pre> <code class="python hljs">i=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">'@mail.ru'</span></span>: act.send_keys(i) time.sleep (<span class="hljs-number"><span class="hljs-number">0.1</span></span>) act = browser.find_element_by_id(<span class="hljs-string"><span class="hljs-string">'password'</span></span>) act.click() i=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>: act.send_keys(i) time.sleep (<span class="hljs-number"><span class="hljs-number">0.1</span></span>) act = browser.find_element_by_id(<span class="hljs-string"><span class="hljs-string">'loginByPwdButton'</span></span>) act.click()</code> </pre> <br>  Une fois que le programme a appuy√© sur le bouton Entr√©e, la fen√™tre suivante peut appara√Ætre avant l'autorisation: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rj/sd/o5/rjsdo5yqe7qqf0-92ihgbii99mm.jpeg"></div><br><br>  Ici, vous devez s√©lectionner le s√©lecteur CSS nat.  visages.  Rappelez-vous comment faire?  Faites un clic droit sur l'ic√¥ne Personne priv√©e ... - explorez l'√©l√©ment: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mb/k9/y2/mbk9y2jai48t7h7cbwo5m-pzqzw.jpeg"></div><br><br>  Et copiez le s√©lecteur CSS: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ow/x8/5c/owx85cjb9x2sptrqhuxbmkxw-5a.jpeg"></div><br><br>  Nous l'ajouterons √† notre programme: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'tr.not-border:nth-child(1) &gt; td:nth-child(2) &gt; div:nth-child(2)'</span></span>) act.click()</code> </pre> <br>  Maintenant que nous sommes connect√©s, le navigateur nous redirigera du site Web des services d'√âtat vers le site Web de Rosreestr.  L√†, notre programme doit cliquer sur l'√©l√©ment "Demande d'informations sur l'immobilier et (ou) leurs propri√©taires": <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lo/v5/o6/lov5o6q89bkbtsywd2y6farnrae.jpeg"></div><br><br>  Nous entrerons le code appropri√©: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'div.services-item:nth-child(5) &gt; div:nth-child(1) &gt; span:nth-child(2)'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'div.services-item:nth-child(5) &gt; table:nth-child(2) &gt; tbody:nth-child(1) &gt; tr:nth-child(2) &gt; td:nth-child(2) &gt; a:nth-child(1)'</span></span>) act.click()</code> </pre> <br>  Nous sommes arriv√©s √† la page de d√©marrage de la soumission d'une demande, o√π 5 √©tapes sont attendues de notre part: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/41/gk/m_/41gkm_5njcfbvg51unp52ezdqnc.jpeg"></div><br><br>  Pour passer √† la deuxi√®me √©tape, vous devez v√©rifier la page et cliquer sur suivant.  Notons cela dans le code: <br><br><pre> <code class="python hljs">act = browser.find_element_by_class_name(<span class="hljs-string"><span class="hljs-string">'PGU-LabelIcon'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#__nextStep'</span></span>) act.click()</code> </pre><br>  Nous sommes √† la 2√®me √©tape du site Rosreestr.  Ici, il est n√©cessaire de remplir la cat√©gorie de champ du demandeur, toutes les autres donn√©es sont automatiquement extraites de la fonction publique.  Cliquez ensuite sur ¬´Suivant¬ª: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/no/tc/km/notckmfto_dccwi-qqtb1zgps9u.jpeg"></div><br><br>  En code, cela ressemble √† ceci: <br><br><pre> <code class="python hljs">act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#Form7\.step2\.specialDeclarantKind\.code &gt; div:nth-child(2) &gt; div:nth-child(1)'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)'</span></span>) act.click() act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'#__nextStep'</span></span>) act.click()</code> </pre> <br>  Si nous ex√©cutons notre programme, nous obtiendrons tr√®s probablement une erreur: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gs/xc/gv/gsxcgvd0p65--6yjfg_4v-4jscy.jpeg"></div><br><br>  Nous traitons cette erreur comme suit: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: act = browser.find_element_by_class_name(<span class="hljs-string"><span class="hljs-string">'PGU-LabelIcon'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: browser.refresh() time.sleep (<span class="hljs-number"><span class="hljs-number">40</span></span>) act = browser.find_element_by_class_name(<span class="hljs-string"><span class="hljs-string">'PGU-LabelIcon'</span></span>)</code> </pre> <br>  Maintenant, si une situation survient dans laquelle la page ne se charge pas, le programme mettra √† jour le navigateur et r√©essayera de cliquer sur l'ic√¥ne souhait√©e.  Malheureusement, les attentes ne fonctionnent pas ici et vous devez utiliser l'ancien time.sleep () √©prouv√©. <br><br>  Nous sommes √† la troisi√®me √©tape et c'est la plus laborieuse: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ef/bp/gy/efbpgyhkkjfjhl3djkt4_firx4y.jpeg"></div><br><br>  Il est n√©cessaire de remplir tous les champs avec le signe "*". <br><br>  Commen√ßons par saisir l'objet: <br><br><pre> <code class="python hljs">n=<span class="hljs-number"><span class="hljs-number">1</span></span> i=sheet[<span class="hljs-string"><span class="hljs-string">'B'</span></span>+str(n)].value <span class="hljs-comment"><span class="hljs-comment">#i=input(". 1- .2-.3-.4-.5- : ") if i==' ': #1- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() #  act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.area &gt; div:nth-child(1) &gt; div:nth-child(4) &gt; div:nth-child(1) &gt; div:nth-child(2) &gt; input:nth-child(1)') act.click() for i in str(sheet['E'+str(n)].value): act.send_keys(i) time.sleep (0.1) act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.area\.unit &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() elif i=='': #2- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(3)') act.click() act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectPurposeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() elif i=='': #3- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(4)') act.click() act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.roomPurposeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(3)') act.click() elif i=='': #4- act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(5)') act.click() elif i==' ': #5-  act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.objectTypeCode &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(6)') act.click()</span></span></code> </pre><br>  Ici, nous commen√ßons avec une cellule dans Excel, o√π nous avons le nom de l'objet √©crit.  Si, par exemple, ¬´Terrain¬ª est entr√© dans la cellule, le programme s√©lectionne l'√©l√©ment appropri√© √† l'aide du s√©lecteur css.  Tout se passe √©galement avec d'autres types d'objets dans la cellule - le programme les traite. <br><br>  Ensuite, nous cliquons sur les s√©lecteurs css du num√©ro cadastral, du type de relev√© et de l'adresse des objets, ces s√©lecteurs sont les m√™mes pour tous les objets: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  -   excel  act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180 &gt; div:nth-child(1) &gt; div:nth-child(4) &gt; div:nth-child(6) &gt; div:nth-child(2) &gt; input:nth-child(1)') act.click() for i in sheet['C'+str(n)].value: act.send_keys(i) time.sleep (0.1) time.sleep(2) #  act = browser.find_element_by_css_selector('#Form7\.step3\.extractDataRequestType1 &gt; div:nth-child(2) &gt; div:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.opened &gt; div:nth-child(3) &gt; div:nth-child(1) &gt; div:nth-child(2)') act.click() #   act = browser.find_element_by_css_selector('#Form7\.step3\.objectsList\.panel1180\.addressesList\[0\]\.address &gt; div:nth-child(2) &gt; div:nth-child(2) &gt; a:nth-child(1) &gt; span:nth-child(1)') act.click() act = browser.find_element_by_css_selector('.fias_input_search') act.click()</span></span></code> </pre><br>  Vous devez maintenant conduire l'adresse: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'D'</span></span>+str(n)].value: act.send_keys(i) time.sleep (<span class="hljs-number"><span class="hljs-number">0.1</span></span>) print(sheet[<span class="hljs-string"><span class="hljs-string">'D'</span></span>+str(n)].value) i=input(<span class="hljs-string"><span class="hljs-string">" eneter            enter: "</span></span>) act = browser.find_element_by_css_selector(<span class="hljs-string"><span class="hljs-string">'a.button-custom:nth-child(2)'</span></span>) act.click()</code> </pre><br>  L'adresse est extraite de la colonne C du tableau Excel.  Il y a une pause sous la forme d'une relance des actions des utilisateurs.  Cela est d√ª au fait que l'adresse dans Rosreestr peut diff√©rer de l'adresse que vous avez et tr√®s probablement.  Par cons√©quent, le programme, en entrant l'adresse √† partir du tableau sur le site, attendra de l'utilisateur qu'il appuie sur Entr√©e dans l'interpr√©teur pour continuer. <br><br>  Les √©tapes restantes sur le portail Rosreestr sont les moins remarquables, l√† le programme clique simplement sur les boutons du portail "Suivant" et envoie la demande au Rosreestr: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  act = browser.find_element_by_css_selector('#__nextStep &gt; span:nth-child(1)') act.click() #   ,     act = browser.find_element_by_css_selector('#__nextStep &gt; span:nth-child(1)') act.click() time.sleep (1) # ,    act = browser.find_element_by_css_selector('#__nextStep &gt; span:nth-child(1)') act.click()</span></span></code> </pre><br>  √Ä la fin du programme, ajoutez une mise √† jour du navigateur: <br><br><pre> <code class="python hljs">browser.refresh() time.sleep (<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>  Si le programme a fonctionn√© correctement, il ne reste plus qu'√† d√©marrer un cycle √† travers toutes les cellules avec des objets dans notre fichier Excel.  Pour ce faire, ajoutez au d√©but du bloc avant <code>i=sheet['B'+str(n)].value</code> <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n&lt;<span class="hljs-number"><span class="hljs-number">36</span></span>:</code> </pre><br>  et √† la fin: <code>n+=1</code> , o√π n est le nombre de biens immobiliers dans le tableau Excel. <br><br>  Le texte int√©gral du programme peut √™tre consult√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr460040/">https://habr.com/ru/post/fr460040/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460022/index.html">PHP Digest n ¬∞ 160 (1 - 15 juillet 2019)</a></li>
<li><a href="../fr460028/index.html">R√©solution de probl√®mes avec pwnable.kr 04 - flag. Fichiers ex√©cutables empaquet√©s</a></li>
<li><a href="../fr460030/index.html">D√©veloppement natif, React Native et Flutter: crit√®res de s√©lection</a></li>
<li><a href="../fr460036/index.html">Comp√©tence B2B d'Alice: du prototype au premier rouble sauv√©</a></li>
<li><a href="../fr460038/index.html">G√©n√©ration de donjons dans Diablo 1</a></li>
<li><a href="../fr460044/index.html">Contr√¥le de la temp√©rature du four, avec minuterie sur Arduino</a></li>
<li><a href="../fr460046/index.html">Comparaison du cadre Python BDD: avantages et inconv√©nients</a></li>
<li><a href="../fr460048/index.html">Comment nous avons construit la gestion des vuln√©rabilit√©s</a></li>
<li><a href="../fr460050/index.html">Face √† face NeoQUEST 2019: dans le monde de la cybers√©curit√©</a></li>
<li><a href="../fr460052/index.html">Interaction des solutions Cisco dans GosSOPKoy et FinCERT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>