<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶É üïô üï∏Ô∏è Aprendizaje de refuerzo profundo: c√≥mo ense√±ar a las ara√±as a caminar üê™ üïö üè¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoy les contar√© c√≥mo apliqu√© algoritmos de refuerzo de aprendizaje profundo para controlar un robot. En resumen, le dir√© c√≥mo crear una "caja negra co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizaje de refuerzo profundo: c√≥mo ense√±ar a las ara√±as a caminar</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483078/"><iframe width="560" height="315" src="https://www.youtube.com/embed/rxWmEnWR3jw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Hoy les contar√© c√≥mo apliqu√© algoritmos de refuerzo de aprendizaje profundo para controlar un robot.  En resumen, le dir√© c√≥mo crear una "caja negra con redes neuronales", que acepta la arquitectura del robot en la entrada y genera un algoritmo que puede controlarlo en la salida. </p><br><p>  El n√∫cleo de la soluci√≥n es el algoritmo <b>Advantage Actor Critic</b> (A2C) con puntajes <b>Advantage a</b> trav√©s de la <b>Estimaci√≥n de ventaja generalizada</b> (GAE). </p><br><p>  Bajo el corte, las matem√°ticas, una implementaci√≥n de TensorFlow y muchas demostraciones de qu√© tipo de algoritmos de caminar se redujeron. </p><br><a name="habracut"></a><p>  Contenido: </p><br>  - <a href="https://habr.com/ru/post/483078/">desaf√≠o</a> <br>  - <a href="https://habr.com/ru/post/483078/">¬øPor qu√© el aprendizaje por refuerzo?</a> <br>  - <a href="https://habr.com/ru/post/483078/">Declaraci√≥n de aprendizaje por refuerzo</a> <br>  - <a href="https://habr.com/ru/post/483078/">gradiente de pol√≠tica</a> <br>  - <a href="https://habr.com/ru/post/483078/">Pol√≠ticas diagonales gaussianas</a> <br>  - <a href="https://habr.com/ru/post/483078/">Reduzca la varianza agregando cr√≠ticas</a> <br>  - <a href="https://habr.com/ru/post/483078/">trampas</a> <br><p>  - <a href="https://habr.com/ru/post/483078/">Conclusi√≥n</a> </p><br><a name="problem"></a><h2>  Desaf√≠o </h2><br><p>  En este art√≠culo, le ense√±aremos al robot a caminar en la simulaci√≥n MuJoCo.  Omitiremos la descripci√≥n del paso al crear un modelo del robot y la interfaz de Python con el entorno, porque  No hay nada interesante all√≠.  Para entenderlo, solo mire las demostraciones en MuJoCo y las fuentes de los entornos MuJoCo en <a href="https://gym.openai.com/envs/">Gym OpenAI</a> . </p><br><p>  En la entrada, el agente tendr√° muchos n√∫meros de MuJoCo: posiciones relativas, √°ngulos de rotaci√≥n, velocidad, aceleraci√≥n de partes del cuerpo del robot, etc.  En total, el orden de ~ 800 caracter√≠sticas.  Utilizamos el enfoque de aprendizaje profundo y no entenderemos lo que realmente significan.  Lo principal es que en este conjunto de n√∫meros habr√° suficiente informaci√≥n para que el agente pueda entender lo que le est√° sucediendo. </p><br><p>  En la salida, esperaremos 18 n√∫meros, el n√∫mero de grados de libertad del robot, lo que significa los √°ngulos de rotaci√≥n de las bisagras en las que se fijan las extremidades. </p><br><p>  Finalmente, el objetivo del agente es maximizar la <b>recompensa</b> total por el episodio.  Terminaremos el episodio si el robot falla o si han pasado 3000 pasos (15 segundos).  Cada paso recompensar√° al agente de acuerdo con la siguiente f√≥rmula: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">d</span><span class="MJXp-mrow" id="MJXp-Span-13"><span class="MJXp-mtext" id="MJXp-Span-14">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">E</span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">p</span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mtext" id="MJXp-Span-25">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">b</span><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">E</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-34">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">d</span><span class="MJXp-mrow" id="MJXp-Span-45"><span class="MJXp-mtext" id="MJXp-Span-46">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">R</span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mtext" id="MJXp-Span-49">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">p</span><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">b</span><span class="MJXp-mrow" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">R</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-70">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">x</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mn" id="MJXp-Span-78">1000</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-80">0.5</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="95.81ex" height="2.419ex" viewBox="0 -780.1 41251.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-65" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-77" x="1317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-63" x="2033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="2467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="2952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="3831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="4709" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="5239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-64" x="5839" y="0"></use><g transform="translate(6363,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-45" x="250" y="0"></use></g><g transform="translate(7377,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-70" x="3081" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-45" x="3455" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="15432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-65" x="16032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-77" x="16499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-63" x="17215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="17649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="18134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="19013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="19891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="20421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-64" x="21021" y="0"></use><g transform="translate(21545,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-52" x="250" y="0"></use></g><g transform="translate(22554,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-70" x="3081" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-52" x="3455" y="0"></use></g></g><g transform="translate(30354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-3D" x="31438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-44" x="32745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-65" x="33573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6C" x="34040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="34338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="34700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-78" x="35229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2217" x="36024" y="0"></use><g transform="translate(36747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="1501" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2B" x="38971" y="0"></use><g transform="translate(39972,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-35" x="779" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ newcommand {\ E} {\ mathop {\ mathbb {E}}} \ newcommand {\ R} {\ mathop {\ mathbb {R}}} r_t = \ Delta x * 1000 + 0.5 </script></p><p>  Es decir  el objetivo del agente aumentar√° su coordenada <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> x </script>  y no caigas hasta el final del episodio. </p><br><p>  Entonces, la tarea est√° establecida: <b>encontrar la funci√≥n</b> <math> </math><b><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">i</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-88">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-91" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-92">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-93">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">o</span><span class="MJXp-mtext" id="MJXp-Span-96">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-99" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-100">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.301ex" height="2.78ex" viewBox="0 -935.7 7018.6 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-3A" x="1376" y="0"></use><g transform="translate(2183,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-38"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="4354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="4715" y="0"></use><g transform="translate(5451,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-38" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ pi: \ R ^ {800} \ to \ R ^ {18} </script></b>   <b>para lo cual la recompensa por el episodio ser√° la mayor</b> .  Eso no suena muy bien?  :) Veamos c√≥mo <b>Deep Reinforcement Learning maneja</b> esta tarea. </p><br><a name="why-rl"></a><h2>  ¬øPor qu√© el aprendizaje por refuerzo? </h2><br><p>  Los enfoques modernos para resolver el problema del movimiento de los robots que caminan consisten en pr√°cticas de rob√≥tica cl√°sica de las secciones de <b>control √≥ptimo</b> y <b>optimizaci√≥n de trayectoria</b> : LQR, QP, optimizaci√≥n convexa.  Leer m√°s: <a href="https://dspace.mit.edu/handle/1721.1/110533">Publicaci√≥n del equipo de Boston Dynamics en Atlas</a> . </p><br><p>  Estas t√©cnicas son una especie de "codificaci√≥n r√≠gida" porque requieren la introducci√≥n de muchos detalles de la tarea directamente en el algoritmo de control.  No hay sistemas de aprendizaje en ellos, la optimizaci√≥n se lleva a cabo "en el acto". </p><br><p>  Por otro lado, el aprendizaje por refuerzo (en adelante RL) no requiere hip√≥tesis en el algoritmo, lo que hace que la soluci√≥n al problema sea m√°s general y escalable. </p><br><a name="rl-formulation"></a><h2>  Declaraci√≥n de aprendizaje por refuerzo </h2><br><img src="https://habrastorage.org/webt/i8/gl/yf/i8glyfujascwmexl2qu6sypmpt0.png"><br><p>  <a href="https://simple.wikipedia.org/wiki/Reinforcement_learning"><i>Fuente</i></a> </p><br><p>  En el problema de RL, consideramos la interacci√≥n del agente y el entorno como una secuencia de pares <b>(estado, recompensa)</b> y las transiciones entre ellos: <b>acci√≥n</b> . </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-101"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-107">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">w</span><span class="MJXp-mrow" id="MJXp-Span-119"><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-126" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-130" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-132">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">w</span><span class="MJXp-mrow" id="MJXp-Span-144"><span class="MJXp-msubsup" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-148">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">w</span><span class="MJXp-mrow" id="MJXp-Span-164"><span class="MJXp-msubsup" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-167" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">n</span><span class="MJXp-mo" id="MJXp-Span-169">‚àí</span><span class="MJXp-mn" id="MJXp-Span-170">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-174" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-178" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.207ex" height="2.66ex" viewBox="0 -832 30228.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-29" x="1312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-78" x="1952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="2524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="2976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-67" x="3321" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="3802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="4378" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="4740" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="5269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="5721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="6172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-77" x="6658" y="0"></use><g transform="translate(7374,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-28" x="8358" y="0"></use><g transform="translate(8747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2C" x="9671" y="0"></use><g transform="translate(10116,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-29" x="11021" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-78" x="11661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="12233" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="12685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-67" x="13030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="13511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="14087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="14449" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="14978" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="15430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="15881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-77" x="16367" y="0"></use><g transform="translate(17083,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2E" x="18067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2E" x="18512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2E" x="18957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-78" x="19652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="20225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="20676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-67" x="21022" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-68" x="21502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="22079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="22440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="22970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="23421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="23873" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-77" x="24358" y="0"></use><g transform="translate(25075,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-28" x="27033" y="0"></use><g transform="translate(27423,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-2C" x="28417" y="0"></use><g transform="translate(28862,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6E" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-29" x="29838" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> (s_0) \ xrightarrow {a_0} (s_1, r_1) \ xrightarrow {a_ {1}} ... \ xrightarrow {a_ {n-1}} (s_n, r_n) </script></p><p>  Definir la terminolog√≠a: </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-180"><span class="MJXp-mtext" id="MJXp-Span-181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">i</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-192" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.981ex" height="2.66ex" viewBox="0 -832 3866.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-28" x="1099" y="0"></use><g transform="translate(1488,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-7C" x="2373" y="0"></use><g transform="translate(2652,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-29" x="3477" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> \ pi (a_t | s_t) </script>  - <b>pol√≠tica</b> , estrategia de comportamiento del agente, probabilidad condicional, </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-197" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">m</span><span class="MJXp-mtext" id="MJXp-Span-202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">i</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">t</span><span class="MJXp-mrow" id="MJXp-Span-211"><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.265ex" height="2.66ex" viewBox="0 -832 7864.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="748" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-73" x="1135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="1604" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6D" x="1950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-70" x="3078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-69" x="3582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-28" x="3927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-63" x="4567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-64" x="5000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-6F" x="5524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="6009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-7C" x="6371" y="0"></use><g transform="translate(6649,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMATHI-74" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/483078/&amp;xid=25657,15700022,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhiS6ASCedSaTSwi3N-WV5B55GKmxA#MJMAIN-29" x="7474" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> a_t \ sim \ pi (\ cdot | s_t) </script>  - la <b>acci√≥n se</b> considera una variable aleatoria de la distribuci√≥n <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mtext" id="MJXp-Span-218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ pi </script>  , <br>  <i>Podr√≠amos considerar la pol√≠tica como una funci√≥n</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-221"><span class="MJXp-mtext" id="MJXp-Span-222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">i</span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">s</span><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ pi: Estados \ a acciones </script></i>   <i>, pero queremos que las acciones de los agentes sean estoc√°sticas, lo que facilita la <b>exploraci√≥n</b> .</i>  <i>Es decir</i>  <i>con cierta probabilidad no hacemos las acciones que el agente elige.</i> </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mtext" id="MJXp-Span-244">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ tau </script>  - trayectoria trazada por el agente, secuencia <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-252" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-256" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-264" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> (s_1, s_2, ..., s_n) </script>  . </li></ul><br><p>  La tarea del agente es maximizar el <b>rendimiento esperado</b> : </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">J</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-269">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">i</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-274">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-277" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">u</span><span class="MJXp-mtext" id="MJXp-Span-282">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">m</span><span class="MJXp-mtext" id="MJXp-Span-286">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">R</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-292">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">u</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-299">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-302" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">u</span><span class="MJXp-mtext" id="MJXp-Span-307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">m</span><span class="MJXp-mtext" id="MJXp-Span-311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">t</span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">u</span><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">t</span><span class="MJXp-mo" id="MJXp-Span-327">=</span><span class="MJXp-mn" id="MJXp-Span-328">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-332" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">t</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> J (\ pi) = \ E _ {\ tau \ sim \ pi} [R (\ tau)] = \ E _ {\ tau \ sim \ pi} \ left [\ sum_ {t = 0} ^ n r_t \ right ] </script></p><p>  Ahora podemos formular el problema RL, encontrar: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-340"><span class="MJXp-mtext" id="MJXp-Span-341">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">p</span><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-345" style="vertical-align: 0.5em;">‚àó</span></span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">g</span><span class="MJXp-mtext" id="MJXp-Span-350">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">p</span><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mrow" id="MJXp-Span-358" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">x</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-362" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">J</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">i</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \ pi ^ * = arg \ mathop {max} _ \ pi J (\ pi) </script></p><p>  donde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">p</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-376" style="vertical-align: 0.5em;">‚àó</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ pi ^ * </script>  Es la pol√≠tica √≥ptima. </p><br><p>  Lea m√°s en el material de OpenAI: <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">OpenAI Spinning Up</a> . </p><br><a name="policy-gradient"></a><h2>  Gradiente de pol√≠tica </h2><br><p>  Es de destacar que una declaraci√≥n rigurosa del problema de RL como un problema de optimizaci√≥n nos da la oportunidad de utilizar los m√©todos de optimizaci√≥n ya conocidos, por ejemplo, el <b>descenso de gradiente</b> .  Solo imagine lo genial que ser√≠a si pudi√©ramos <b>tomar el gradiente de retorno esperado por los par√°metros del modelo</b> : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-mtext" id="MJXp-Span-378">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">l</span><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-385" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">J</span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-393">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">p</span><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-397" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">a</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> \ nabla_ \ theta J (\ pi_ \ theta) </script>  .  En este caso, la regla para actualizar las escalas ser√≠a simple: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-404"><span class="MJXp-mtext" id="MJXp-Span-405">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">a</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">t</span><span class="MJXp-msubsup" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-419" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-424">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">a</span><span class="MJXp-mtext" id="MJXp-Span-430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">l</span><span class="MJXp-msubsup" id="MJXp-Span-435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-437" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">J</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-445">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">p</span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-449" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">a</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \ theta = \ theta_ {old} + \ alpha \ nabla_ \ theta J (\ pi_ \ theta) </script></p><p>  Esta es precisamente la idea de todos <b>los</b> m√©todos de <b>gradiente de pol√≠ticas</b> .  La conclusi√≥n estricta de este gradiente es algo incondicional.  No lo escribiremos aqu√≠, pero dejamos un enlace al <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">maravilloso material de OpenAI</a> .  El gradiente se ve as√≠: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-456"><span class="MJXp-mtext" id="MJXp-Span-457">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">l</span><span class="MJXp-msubsup" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-464" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">J</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-472">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">p</span><span class="MJXp-msubsup" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-476" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">a</span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-484">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-487" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-488">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">u</span><span class="MJXp-mtext" id="MJXp-Span-492">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">m</span><span class="MJXp-mtext" id="MJXp-Span-496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">p</span><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-506">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">t</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-512">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">u</span><span class="MJXp-msubsup" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">t</span><span class="MJXp-mo" id="MJXp-Span-519">=</span><span class="MJXp-mn" id="MJXp-Span-520">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-522">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">l</span><span class="MJXp-msubsup" id="MJXp-Span-527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-529" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">a</span><span class="MJXp-mtext" id="MJXp-Span-535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">g</span><span class="MJXp-mtext" id="MJXp-Span-539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">p</span><span class="MJXp-msubsup" id="MJXp-Span-541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-543" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">a</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-553"><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-557" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">R</span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">u</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-566">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">t</span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) R (\ tau) \ right] </script></p><p>  Por lo tanto, la <b>p√©rdida de</b> nuestro modelo ser√° as√≠: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">s</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-580">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">g</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-585">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">p</span><span class="MJXp-msubsup" id="MJXp-Span-587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-589" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">a</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-598" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-599"><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-603" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">R</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">u</span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> loss = - \ log (\ pi_ \ theta (a_t | s_t)) R (\ tau) </script></p><p>  Recordemos que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">R</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-616">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">u</span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-622">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">u</span><span class="MJXp-msubsup" id="MJXp-Span-625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">t</span><span class="MJXp-mo" id="MJXp-Span-629">=</span><span class="MJXp-mn" id="MJXp-Span-630">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-634" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> R (\ tau) = \ sum_ {t = 0} ^ T r_t </script>  y <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mtext" id="MJXp-Span-636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">p</span><span class="MJXp-msubsup" id="MJXp-Span-638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-640" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">a</span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-650"><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-654" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ pi_ \ theta (a_t | s_t) </script>  - esta es la salida de nuestra modelo en el momento en que ella estaba en <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-656"><span class="MJXp-msubsup" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-659" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> s_t </script>  .  El menos apareci√≥ debido al hecho de que queremos maximizar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">J</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> J </script>  .  Durante el entrenamiento, consideraremos el gradiente en lotes y los agregaremos para reducir la <b>variaci√≥n</b> (ruido de datos debido al entorno estoc√°stico). </p><br><p>  Este es un algoritmo de trabajo llamado <b>REINFORCE</b> .  Y sabe c√≥mo encontrar soluciones para algunos entornos simples.  Por ejemplo, <a href="https://gym.openai.com/envs/CartPole-v1/">"CartPole-v1"</a> . </p><br><p>  Considere el c√≥digo del agente: </p><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkDiscrete</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">20</span></span>, activation=tf.nn.relu) output_linear = tf.layers.dense(l1, units=action_space) output = tf.nn.softmax(output_linear) self.action_op = tf.squeeze(tf.multinomial(logits=output_linear,num_samples=<span class="hljs-number"><span class="hljs-number">1</span></span>), axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training output_log = tf.nn.log_softmax(output_linear) self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None], dtype=tf.int32) action_one_hot = tf.one_hot(self.action_ph, action_space) responsible_output_log = tf.reduce_sum(output_log * action_one_hot, axis=1) self.loss = -tf.reduce_mean(responsible_output_log * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss) actor = ActorNetworkDiscrete()</span></span></code> </pre> <br><p>  Tenemos un peque√±o perceptr√≥n de esta arquitectura: (observaci√≥n_espacio, 10, espacio_acci√≥n) [para CartPole esto es (4, 10, 2)].  <b>tf.multinomial le</b> permite elegir una acci√≥n ponderada al azar.  Para obtener una acci√≥n, debe llamar: </p><br><pre> <code class="python hljs">action = sess.run(actor.action_op, feed_dict={actor.state_ph: observation})</code> </pre><br><p>  Y as√≠ lo entrenaremos: </p><br><pre> <code class="python hljs">batch_generator = generate_batch(environments, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, total reward] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]})</span></span></code> </pre><br><p>  El generador de lotes ejecuta el agente en el entorno y acumula datos para la capacitaci√≥n.  Los elementos del lote son tuplas de este tipo: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-662"><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">R</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-674">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">u</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> (s_t, a_t, R (\ tau)) </script>  . </p><br><p>  Escribir un buen generador es una tarea separada, donde la dificultad principal es el costo relativamente alto de llamar a <b>sess.run () en</b> comparaci√≥n con un solo paso de simulaci√≥n (incluso MuJoCo).  Para acelerar el trabajo, puede aprovechar el hecho de que las redes neuronales se ejecutan en lotes y utilizan muchos entornos paralelos.  <b>Incluso lanzarlos secuencialmente en un hilo dar√° una aceleraci√≥n significativa en comparaci√≥n con un solo entorno.</b> </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo generador utilizando DummyVecEnv de l√≠neas base OpenAI</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Vectorized environments with gym-like interface from baselines.common.vec_env.subproc_vec_env import SubprocVecEnv from baselines.common.vec_env.dummy_vec_env import DummyVecEnv def make_env(env_id, seed): def _f(): env = gym.make(env_name) env.reset() # Desync environments for i in range(int(200 * seed // environments_count)): env.step(env.action_space.sample()) return env return _f envs = [make_env(env_name, seed) for seed in range(environments_count)] # Can be switched to SubprocVecEnv to parallelize on cores # (for computationally heavy envs) envs = DummyVecEnv(envs) # Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py def discount_cumsum(x, coef): """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def generate_batch(envs, batch_size, replay_buffer_size): envs_number = envs.num_envs observations = [[0 for i in range(observation_space)] for i in range(envs_number)] # [state, action, discounted reward-to-go] replay_buffer = np.empty((0,3), np.float32) # [state, action, reward] rollout lists for every environment instance rollouts = [np.empty((0, 3)) for i in range(envs_number)] while True: history = {'reward': [], 'max_action': []} replay_buffer = replay_buffer[batch_size:] # Main sampling cycle while len(replay_buffer) &lt; replay_buffer_size: # Here policy acts in environments. Note that it chooses actions for all # environments in one batch, therefore expensive sess.run is called once. actions = sess.run(actor.action_op, feed_dict={actor.state_ph: observations}) observations_old = observations observations, rewards, dones, _ = envs.step(actions) history['max_action'].append(np.abs(actions).max()) time_point = np.array(list(zip(observations_old, actions, rewards))) for i in range(envs_number): # Regular python-like append rollouts[i] = np.append(rollouts[i], [time_point[i]], axis=0) # Process done==True environments if dones.all(): print('WARNING: envs are in sync!! This makes sampling inefficient!') done_indexes = np.arange(envs_number)[dones] for i in done_indexes: rewards_trajectory = rollouts[i][:, 2].copy() history['reward'].append(rewards_trajectory.sum()) rollouts[i][:, 2] = discount_cumsum(rewards_trajectory, coef=discount_factor) replay_buffer = np.append(replay_buffer, rollouts[i], axis=0) rollouts[i] = np.empty((0, 3)) # Shuffle before yield to become closer to iid np.random.shuffle(replay_buffer) # Truncate replay_buffer to get the most relevant feedback from environment replay_buffer = replay_buffer[:replay_buffer_size] yield replay_buffer[:batch_size], history # Make a test yield a = generate_batch(envs, 8, 64) # Makes them of equal lenght for i in range(10): next(a) next(a)[0]</span></span></code> </pre></div></div><br><p>  El agente resultante puede jugar en entornos con un <b>espacio finito de acciones</b> .  Este formato no es adecuado para nuestra tarea.  El agente que controla el robot debe emitir un vector de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mtext" id="MJXp-Span-681">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-684" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ R ^ n </script>  donde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> n </script>  - El n√∫mero de grados de libertad.  ( <a href="https://arxiv.org/abs/1910.07113">o puede dividir el espacio de acci√≥n en espacios y obtener una tarea con una salida discreta</a> ) </p><br><a name="diagonal-gaussian-policies"></a><h2>  Pol√≠ticas Diagonales Gaussianas </h2><br><p>  La esencia del enfoque de las <b>Pol√≠ticas Diagonales Gaussianas</b> es que el modelo produzca par√°metros de la distribuci√≥n normal n-dimensional, a saber <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-687"><span class="MJXp-mtext" id="MJXp-Span-688">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">m</span><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;">u</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-692" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ mu_ \ theta </script>  - mat.  esperando y <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-698"><span class="MJXp-mtext" id="MJXp-Span-699">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">m</span><span class="MJXp-msubsup" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-706" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ sigma_ \ theta </script>  - desviaci√≥n est√°ndar.  <b>Tan pronto como el agente necesite tomar una acci√≥n, le pediremos estos par√°metros al modelo y tomaremos una variable aleatoria de esta distribuci√≥n.</b>  Entonces hicimos salir al agente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mtext" id="MJXp-Span-713">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-716" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ R ^ n </script>  y lo hizo estoc√°stico.  Lo m√°s importante es que despu√©s de haber fijado la clase de distribuci√≥n en la salida, podemos calcular <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-717"><span class="MJXp-mtext" id="MJXp-Span-718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">g</span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-723">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">p</span><span class="MJXp-msubsup" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-727" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">a</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-736" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-737"><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-741" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ log (\ pi_ \ theta (a_t | s_t)) </script>  y, por lo tanto, gradiente de pol√≠ticas. </p><br><p>  Nota: se puede arreglar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-744"><span class="MJXp-mtext" id="MJXp-Span-745">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">m</span><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-752" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ sigma_ \ theta </script>  como hiperpar√°metro, reduciendo as√≠ la dimensi√≥n de salida.  La pr√°ctica muestra que esto no causa mucho da√±o, sino que, por el contrario, estabiliza el aprendizaje. </p><br><p>  <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">Lea m√°s sobre la pol√≠tica estoc√°stica</a> . </p><br><p>  C√≥digo de agente: </p><br><pre> <code class="python hljs">epsilon = <span class="hljs-number"><span class="hljs-number">1e-8</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gaussian_loglikelihood</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, mu, log_std)</span></span></span><span class="hljs-function">:</span></span> pre_sum = <span class="hljs-number"><span class="hljs-number">-0.5</span></span> * (((x - mu) / (tf.exp(log_std) + epsilon))**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span> * log_std + np.log(<span class="hljs-number"><span class="hljs-number">2</span></span> * np.pi)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.reduce_sum(pre_sum, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkContinuous</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) mu = tf.layers.dense(l3, units=action_space) log_std = tf.get_variable(name=<span class="hljs-string"><span class="hljs-string">'log_std'</span></span>, initializer=<span class="hljs-number"><span class="hljs-number">-0.5</span></span> * np.ones(action_space, std = tf.exp(log_std) self.action_op = mu + tf.random.normal(shape=tf.shape(mu)) * std <span class="hljs-comment"><span class="hljs-comment"># Training self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None, action_space], dtype=tf.float32) action_logprob = gaussian_loglikelihood(self.action_ph, mu, log_std) self.loss = -tf.reduce_mean(action_logprob * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p>  La parte de entrenamiento no es diferente. </p><br><p>  Ahora finalmente podemos ver c√≥mo REINFORCE har√° frente a nuestra tarea.  En adelante, el objetivo del agente es moverse hacia la derecha. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eH8cFxYHhQg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Lenta pero seguramente arrastr√°ndose hacia su objetivo. </p><br><h3>  Recompensa para llevar </h3><br><p>  Tenga en cuenta que hay miembros adicionales en nuestro gradiente.  A saber para cada paso <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> t </script>  Al pesar el gradiente del logaritmo, usamos la recompensa total <b>para toda la trayectoria</b> .  Por lo tanto, evaluar las acciones del agente por sus logros del pasado.  Suena mal, ¬øno?  Por lo tanto esto </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-760"><span class="MJXp-mtext" id="MJXp-Span-761">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">l</span><span class="MJXp-msubsup" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-768" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">J</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-776">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">p</span><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-780" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">a</span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-788">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-791" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-792">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">u</span><span class="MJXp-mtext" id="MJXp-Span-796">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">m</span><span class="MJXp-mtext" id="MJXp-Span-800">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">p</span><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-804" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-810">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">t</span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-816">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">u</span><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">t</span><span class="MJXp-mo" id="MJXp-Span-823">=</span><span class="MJXp-mn" id="MJXp-Span-824">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-826">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">l</span><span class="MJXp-msubsup" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-833" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">a</span><span class="MJXp-mtext" id="MJXp-Span-839">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">g</span><span class="MJXp-mtext" id="MJXp-Span-843">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">p</span><span class="MJXp-msubsup" id="MJXp-Span-845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-847" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">a</span><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-856" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-857"><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-861" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-863">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">u</span><span class="MJXp-msubsup" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-868"><span class="MJXp-msup" id="MJXp-Span-869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-871" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-872">=</span><span class="MJXp-mn" id="MJXp-Span-873">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-877" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-880" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-881">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">t</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= 0} ^ T r_ {t'} \ right] </script></p><p>  se convertir√° en esto </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-888"><span class="MJXp-mtext" id="MJXp-Span-889">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">l</span><span class="MJXp-msubsup" id="MJXp-Span-894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-896" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">J</span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">p</span><span class="MJXp-msubsup" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-908" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">a</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-916">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-919" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-920">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">u</span><span class="MJXp-mtext" id="MJXp-Span-924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">m</span><span class="MJXp-mtext" id="MJXp-Span-928">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">p</span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-932" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-938">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">t</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-944">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">u</span><span class="MJXp-msubsup" id="MJXp-Span-947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">t</span><span class="MJXp-mo" id="MJXp-Span-951">=</span><span class="MJXp-mn" id="MJXp-Span-952">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-954">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">l</span><span class="MJXp-msubsup" id="MJXp-Span-959"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-961" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">a</span><span class="MJXp-mtext" id="MJXp-Span-967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">g</span><span class="MJXp-mtext" id="MJXp-Span-971">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">p</span><span class="MJXp-msubsup" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-975" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">a</span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-984" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-989" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-991">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">u</span><span class="MJXp-msubsup" id="MJXp-Span-994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-996"><span class="MJXp-msup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-999" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1000">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1005" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1008" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1009">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">t</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ T r_ {t'} \ right] </script></p><p>  Encuentra 10 diferencias :) </p><br><p>  Si bien la presencia de estos miembros no estropea nada matem√°ticamente, hace mucho ruido para nosotros.  Ahora, durante el entrenamiento, el agente prestar√° atenci√≥n solo a las recompensas que recibi√≥ <b>despu√©s de una acci√≥n espec√≠fica</b> . </p><br><p>  Debido a esta mejora, la recompensa promedio ha crecido.  Uno de los agentes recibidos aprendi√≥ a usar las extremidades anteriores para lograr su objetivo: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8sN-VaQsnVU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="add-critic"></a><h2>  Reduzca la varianza agregando cr√≠ticas </h2><br><p>  La esencia de otras mejoras es la reducci√≥n del ruido (varianza) que surge debido a las transiciones estoc√°sticas entre los estados del medio. </p><br><p>  Esto nos ayudar√° a agregar un <b>modelo que prediga la cantidad promedio de recompensas</b> recibidas por el agente, comenzando por el estado <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> s </script>  hasta el final de la trayectoria, es decir  Funci√≥n de valor. </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1018"><span class="MJXp-msubsup" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1021" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">i</span><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">s</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1028">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1031" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1032">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">u</span><span class="MJXp-mtext" id="MJXp-Span-1036">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">m</span><span class="MJXp-mtext" id="MJXp-Span-1040">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1043">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">t</span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">R</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1051">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">u</span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1056"><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1060" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">s</span><span class="MJXp-mtext" id="MJXp-Span-1063">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">t</span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1070">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">t</span><span class="MJXp-mrow" id="MJXp-Span-1075"><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">i</span><span class="MJXp-mrow" id="MJXp-Span-1082"><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">√≥</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">r</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> V ^ \ pi (s) = \ E _ {\ tau \ sim \ pi} \ left [R (\ tau) | s_0 = s \ right] \ text {- Funci√≥n de valor} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1092"><span class="MJXp-msubsup" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1095" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">i</span><span class="MJXp-mo" id="MJXp-Span-1098" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">s</span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">a</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1104">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1107" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">u</span><span class="MJXp-mtext" id="MJXp-Span-1112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">m</span><span class="MJXp-mtext" id="MJXp-Span-1116">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1119">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">t</span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">R</span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">u</span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1136" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">s</span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1142" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">a</span><span class="MJXp-mtext" id="MJXp-Span-1145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">t</span><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">t</span><span class="MJXp-mrow" id="MJXp-Span-1157"><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">i</span><span class="MJXp-mrow" id="MJXp-Span-1164"><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0em; margin-right: 0em;">√≥</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">i</span><span class="MJXp-mrow" id="MJXp-Span-1173"><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">√≥</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">n</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">r</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> Q ^ \ pi (s, a) = \ E _ {\ tau \ sim \ pi} \ left [R (\ tau) | s_0 = s, a_0 = a \ right] \ text {- Funci√≥n de acci√≥n-valor} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1182"><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1185" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">i</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">s</span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">a</span><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1196" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">i</span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">s</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">a</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1207" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">i</span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">s</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">t</span><span class="MJXp-mrow" id="MJXp-Span-1218"><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">i</span><span class="MJXp-mrow" id="MJXp-Span-1225"><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em;">√≥</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">a</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> A ^ \ pi (s, a) = Q ^ \ pi (s, a) -V ^ \ pi (s) \ text {- Funci√≥n de ventaja} </script></p><p>  La funci√≥n Valor muestra el rendimiento esperado si nuestra pol√≠tica inicia el juego desde un estado espec√≠fico.  Lo mismo con la funci√≥n Q, solo arregle la primera acci√≥n. </p><br><h3>  A√±adir cr√≠tica </h3><br><p>  As√≠ es como se ve el gradiente cuando se usa recompensa para llevar: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1237"><span class="MJXp-mtext" id="MJXp-Span-1238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">l</span><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1245" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">a</span><span class="MJXp-mtext" id="MJXp-Span-1251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">g</span><span class="MJXp-mtext" id="MJXp-Span-1255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">p</span><span class="MJXp-msubsup" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1259" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">a</span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1268" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1269"><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1273" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">u</span><span class="MJXp-msubsup" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1280"><span class="MJXp-msup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1283" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1284">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1289" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1292" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ T r_ {t'} </script></p><p>  Ahora el coeficiente para el gradiente del logaritmo no es m√°s que una muestra de la funci√≥n Valor. </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1293"><span class="MJXp-mtext" id="MJXp-Span-1294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">u</span><span class="MJXp-msubsup" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1299"><span class="MJXp-msup" id="MJXp-Span-1300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1302" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1303">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1308" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1311" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1312">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">m</span><span class="MJXp-msubsup" id="MJXp-Span-1316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1318" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">i</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1324" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ sum_ {t '= t} ^ T r_ {t'} \ sim V ^ \ pi (s_t) </script></p><p>  Pesamos el gradiente de logaritmo con una muestra de una trayectoria particular, lo que no es bueno.  <b>Podemos aproximar la funci√≥n Valor con alg√∫n modelo, por ejemplo, una red neuronal, y pedirle el valor necesario, reduciendo as√≠ la varianza.</b>  Llamaremos a este modelo <b>cr√≠tico (Cr√≠tico)</b> y lo estudiaremos en paralelo con la pol√≠tica.  Por lo tanto, la f√≥rmula del gradiente se puede escribir como: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1326"><span class="MJXp-mtext" id="MJXp-Span-1327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">l</span><span class="MJXp-msubsup" id="MJXp-Span-1332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1334" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">a</span><span class="MJXp-mtext" id="MJXp-Span-1340">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">g</span><span class="MJXp-mtext" id="MJXp-Span-1344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">p</span><span class="MJXp-msubsup" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1348" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">a</span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1358"><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1362" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1364">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">u</span><span class="MJXp-msubsup" id="MJXp-Span-1367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1369"><span class="MJXp-msup" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1372" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1373">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1378" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1381" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">x</span><span class="MJXp-mtext" id="MJXp-Span-1389">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">l</span><span class="MJXp-msubsup" id="MJXp-Span-1394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1396" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">a</span><span class="MJXp-mtext" id="MJXp-Span-1402">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">g</span><span class="MJXp-mtext" id="MJXp-Span-1406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">p</span><span class="MJXp-msubsup" id="MJXp-Span-1408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1410" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">a</span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1419" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1420"><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1424" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1428" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">i</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1432">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">u</span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ T r_ {t'} \ approx \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) V ^ \ pi (\ tau) </script></p><p>  Redujimos la varianza, pero al mismo tiempo, introdujimos <b>sesgo</b> en nuestro algoritmo, ya que las redes neuronales pueden cometer errores de aproximaci√≥n.  Pero el compromiso en esta situaci√≥n es bueno.  Dichas situaciones en el aprendizaje autom√°tico se denominan <b><a href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229">compensaci√≥n de sesgo-varianza</a></b> . </p><br><p>  El cr√≠tico ense√±ar√° la regresi√≥n de la funci√≥n de valor en muestras de recompensa para llevar recolectadas en el entorno.  Como una funci√≥n de error, tomamos MSE.  Es decir  la p√©rdida se ve as√≠: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">p</span><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0em; margin-right: 0em;">√©</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">a</span><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1447" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1448"><span class="MJXp-mrow" id="MJXp-Span-1449" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">V</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1451" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">p</span><span class="MJXp-msubsup" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1455" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">i</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1462" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1465">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">u</span><span class="MJXp-msubsup" id="MJXp-Span-1468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1470"><span class="MJXp-msup" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1473" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1474">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1482" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1483"><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1485" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> p√©rdida = ({V} ^ \ pi_ \ psi (s_t) - \ sum_ {t '= t} ^ T r_ {t'}) ^ 2 </script></p><p>  C√≥digo cr√≠tico: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CriticNetwork</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) output = tf.layers.dense(l3, units=<span class="hljs-number"><span class="hljs-number">1</span></span>) self.value_op = tf.squeeze(output, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training self.value_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.loss = tf.losses.mean_squared_error(self.value_ph, self.value_op) optimizer = tf.train.AdamOptimizer(learning_rate=critic_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p>  El ciclo de entrenamiento ahora se ve as√≠: </p><br><pre> <code class="python hljs">batch_generator = generate_batch(envs, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, value, reward-to-go] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]}) # Train critic for j in range(10): _, critic_loss = sess.run([critic.update_op, critic.loss], feed_dict={critic.state_ph: batch[:, 0], critic.value_ph: batch[:, 3]})</span></span></code> </pre><br><p>  Ahora el lote contiene otro valor, valor, calculado por el cr√≠tico en el generador. <br>  Es decir  El tipo de lote es este: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1486"><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1490" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1494" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1498" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">p</span><span class="MJXp-msubsup" id="MJXp-Span-1500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1502" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">i</span><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1509" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1512">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">u</span><span class="MJXp-msubsup" id="MJXp-Span-1515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1517"><span class="MJXp-msup" id="MJXp-Span-1518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1520" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1521">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1526" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1529" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> (s_t, a_t, V ^ \ pi_ \ psi (s_t), \ sum_ {t '= t} ^ T r_ {t'}) </script>  . </p><br><p>  En el ciclo, nada nos limita de <b>entrenar al cr√≠tico a la convergencia</b> , por lo que tomamos varios pasos de descenso de gradiente, mejorando as√≠ la aproximaci√≥n de la funci√≥n Valor y reduciendo el sesgo.  Sin embargo, este enfoque requiere un gran tama√±o de lote para evitar el reciclaje.  <b>Una afirmaci√≥n similar sobre la pol√≠tica de aprendizaje no es cierta.</b>  Deber√≠a tener retroalimentaci√≥n instant√°nea del entorno de aprendizaje, de lo contrario, podr√≠amos encontrarnos en una situaci√≥n en la que multemos la pol√≠tica por acciones que no hubiera tomado.  Los algoritmos con esta propiedad se denominan <b>on-policy</b> . </p><br><h3>  L√≠neas de base en gradientes de pol√≠ticas </h3><br><p>  Se puede demostrar que en el gradiente es permisible poner una amplia clase de otras funciones √∫tiles de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> t </script>  .  Dichas funciones se denominan <b>l√≠neas de base</b> .  ( <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">Conclusi√≥n de este hecho</a> ) Las siguientes funciones funcionan bien como l√≠neas de base: </p><br><img src="https://habrastorage.org/webt/c8/ah/l7/c8ahl70po6_pgcud0jxdfbmubi8.png"><br><p>  <i>Fuente: <a href="https://arxiv.org/pdf/1506.02438.pdf">documento GAE</a> .</i> </p><br><p>  Diferentes l√≠neas de base dan diferentes resultados dependiendo de la tarea.  Como regla general, la mayor <b>ventaja</b> viene dada por la <b>funci√≥n Ventaja</b> y sus aproximaciones. </p><br><p>  Incluso hay una peque√±a intuici√≥n detr√°s de esto.  Cuando usamos Advantage, multamos al agente en proporci√≥n a cu√°nto mejor o peor que el promedio que el agente considera la acci√≥n que realiz√≥.  Y cuanto mejor juega el agente en el medio ambiente, <b>m√°s altos se vuelven sus est√°ndares</b> .  El agente ideal jugar√° bien y evaluar√° todas sus acciones como teniendo una ventaja igual a 0 y, por lo tanto, tendr√° un gradiente igual a 0. </p><br><h3>  Evaluaci√≥n de ventajas a trav√©s de la funci√≥n de valor </h3><br><p>  Recordemos la definici√≥n de ventaja: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1533"><span class="MJXp-msubsup" id="MJXp-Span-1534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1536" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">i</span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">s</span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">a</span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1547" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">i</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">s</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">a</span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1558" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">i</span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">s</span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">t</span><span class="MJXp-mrow" id="MJXp-Span-1569"><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">i</span><span class="MJXp-mrow" id="MJXp-Span-1576"><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">√≥</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">a</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-43"> A ^ \ pi (s, a) = Q ^ \ pi (s, a) -V ^ \ pi (s) \ text {- Funci√≥n de ventaja} </script></p><p>  No est√° claro c√≥mo aprender dicha funci√≥n expl√≠citamente.  Un truco vendr√° al rescate, que reducir√° el c√°lculo de la funci√≥n Advantage al c√°lculo de la funci√≥n Value. </p><br><p>  Definir <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1588"><span class="MJXp-mtext" id="MJXp-Span-1589">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">t</span><span class="MJXp-msubsup" id="MJXp-Span-1594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1601" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">V</span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1607" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">t</span><span class="MJXp-mo" id="MJXp-Span-1609">+</span><span class="MJXp-mn" id="MJXp-Span-1610">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">V</span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1617" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ delta_t ^ V = r_t + V (s_ {t + 1}) - V (s_t) </script>  - Diferencia temporal residual ( <b>TD-residual</b> ).  No es dif√≠cil deducir que dicha funci√≥n se aproxima a la Ventaja: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1619"><span class="MJXp-mtext" id="MJXp-Span-1620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">E</span><span class="MJXp-mtext" id="MJXp-Span-1622">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">t</span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">t</span><span class="MJXp-msubsup" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">t</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">t</span><span class="MJXp-mo" id="MJXp-Span-1643" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1645">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">E</span><span class="MJXp-mtext" id="MJXp-Span-1647">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">t</span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1655" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">V</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1661" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">t</span><span class="MJXp-mo" id="MJXp-Span-1663">+</span><span class="MJXp-mn" id="MJXp-Span-1664">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">V</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1671" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">t</span><span class="MJXp-mo" id="MJXp-Span-1679" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1681">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">E</span><span class="MJXp-mtext" id="MJXp-Span-1683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">t</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">Q</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1693" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1697" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">V</span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1704" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1705" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">t</span><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">A</span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1718" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1722" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-45"> \ E \ left [\ delta ^ V_t \ right] = \ E \ left [r_t + V (s_ {t + 1}) - V (s_t) \ right] = \ E \ left [Q (s_t, a_t) -V (s_t) \ right] = A (s_t, a_t) </script></p><p>  Tal cambio conceptualmente complejo provoca un cambio no tan grande en el c√≥digo.  Ahora, en lugar de evaluar la funci√≥n Value, el cr√≠tico presentar√° una evaluaci√≥n Advantage para capacitaci√≥n en pol√≠ticas. </p><br><p>  El algoritmo resultante se llama <b>Advantage Actor-Critic</b> . </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate_advantage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(states, rewards)</span></span></span><span class="hljs-function">:</span></span> values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + np.append(values[<span class="hljs-number"><span class="hljs-number">1</span></span>:], np.array([<span class="hljs-number"><span class="hljs-number">0</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deltas, values</code> </pre><br><p>  Los agentes obtenidos pueden observarse con confianza en la marcha y el uso sincr√≥nico de las extremidades: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GCbPl3dOLmQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Estimaci√≥n de ventaja generalizada </h3><br><p>  Un art√≠culo relativamente reciente (2018), " <a href="https://arxiv.org/pdf/1506.02438.pdf">Control continuo de alta dimensi√≥n utilizando el establecimiento de ventajas generalizadas</a> ", ofrece una evaluaci√≥n a√∫n m√°s eficiente de Advantage mediante la funci√≥n Value.  Reduce la varianza a√∫n m√°s: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1724"><span class="MJXp-msubsup" id="MJXp-Span-1725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726" style="margin-right: 0.05em;">A</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">E</span><span class="MJXp-mo" id="MJXp-Span-1732">(</span><span class="MJXp-mtext" id="MJXp-Span-1733">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">a</span><span class="MJXp-mo" id="MJXp-Span-1739">,</span><span class="MJXp-mtext" id="MJXp-Span-1740">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">a</span><span class="MJXp-mo" id="MJXp-Span-1747">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1748" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1749">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">u</span><span class="MJXp-msubsup" id="MJXp-Span-1752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-1758">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">l</span><span class="MJXp-mo" id="MJXp-Span-1756">=</span><span class="MJXp-mn" id="MJXp-Span-1757">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">y</span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1765">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">a</span><span class="MJXp-mtext" id="MJXp-Span-1771">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">a</span><span class="MJXp-msubsup" id="MJXp-Span-1778"><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1780" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mtext" id="MJXp-Span-1781">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">t</span><span class="MJXp-msubsup" id="MJXp-Span-1786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">t</span><span class="MJXp-mo" id="MJXp-Span-1790">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">l</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-46"> A_t ^ {GAE (\ gamma, \ lambda)} = \ sum_ {l = 0} ^ \ infty (\ gamma \ lambda) ^ l \ delta ^ V_ {t + l} </script></p><p>  donde: </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mtext" id="MJXp-Span-1794">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">t</span><span class="MJXp-msubsup" id="MJXp-Span-1799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1806" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1807" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">V</span><span class="MJXp-mo" id="MJXp-Span-1809" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1812" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">t</span><span class="MJXp-mo" id="MJXp-Span-1814">+</span><span class="MJXp-mn" id="MJXp-Span-1815">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">V</span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1822" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ delta_t ^ V = r_t + V (s_ {t + 1}) - V (s_t) </script>  - TD-residual, </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1824"><span class="MJXp-mtext" id="MJXp-Span-1825">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> \ gamma </script>  - factor de descuento (hiperpar√°metro), </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1831"><span class="MJXp-mtext" id="MJXp-Span-1832">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> \ lambda </script>  - hiperpar√°metro. </li></ul><br><p>  La interpretaci√≥n se puede encontrar en la publicaci√≥n misma. </p><br><p>  Implementaci√≥n </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">discount_cumsum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, coef)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def estimate_advantage(states, rewards): values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + discount_factor * np.append(values[1:], np.array([0])) advantage = discount_cumsum(deltas, coef=lambda_factor * discount_factor) return advantage, values</span></span></code> </pre><br><p>  Cuando se utiliza un tama√±o de lote peque√±o, el algoritmo converge a algunos √≥ptimos locales.  Aqu√≠, el agente usa una pata como bast√≥n, y el resto empuja: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3f4rRbqnuxg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Aqu√≠, el agente no recurri√≥ al uso de saltos, sino que simplemente toc√≥ r√°pidamente las extremidades.  Y tambi√©n puedes ver c√≥mo se comporta, si duda, se dar√° la vuelta y continuar√° corriendo: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/O5aJoj16ZDM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  El mejor agente, √©l est√° al comienzo del art√≠culo.  Salto estable, durante el cual todas las extremidades salen de la superficie.  La capacidad desarrollada para equilibrar le permite al agente corregir la trayectoria a toda velocidad si se cometi√≥ un error: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xT9KKnpxxo8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="pitfalls"></a><h2>  Trampas </h2><br><p>  El aprendizaje autom√°tico es famoso por la dimensi√≥n del espacio de errores que se pueden cometer y obtener un algoritmo que no funciona.  Pero RL lleva el problema a un nivel completamente nuevo. </p><br><img src="https://habrastorage.org/webt/rq/w0/fl/rqw0flwtyhb3getoyjwyraaf7na.png"><br><p>  <a href="http://ai.stanford.edu/~zayd/why-is-machine-learning-hard.html"><i>Fuente</i></a> </p><br><p>  Estas son algunas de las dificultades encontradas durante el desarrollo. </p><br><ol><li>  El algoritmo es sorprendentemente sensible a los hiperpar√°metros.  Hubo un cambio en la calidad del aprendizaje al cambiar la tasa de aprendizaje de 3e-4 a 1e-4.  Y la imagen cambi√≥ radicalmente, de un algoritmo completamente no convergente al mejor que hay en el video. </li><li>  El tama√±o del lote no es el mismo que en otras √°reas de DL.  Si en la clasificaci√≥n de im√°genes puede permitirse elegir el tama√±o del lote 32-256 y el resultado no cambiar√° especialmente al aumentarlo, entonces es mejor tomar unos pocos miles, 3000 trabajos para nuestra tarea. Y nuevamente, desde la falta de convergencia hasta un buen algoritmo. </li><li>  Aprender es mejor correr varias veces, a veces con semilla aleatoria no es afortunado. </li><li>  Aprender en un entorno tan complejo lleva mucho tiempo y el progreso no es uniforme.  Por ejemplo, el mejor algoritmo aprendido durante 8 horas, 3 de los cuales mostraron un peor resultado que una l√≠nea base aleatoria.  Por lo tanto, al probar los algoritmos, es mejor comenzar con uno peque√±o, como los entornos de juguete del gimnasio. <img src="https://habrastorage.org/webt/ol/ml/yx/olmlyxvpvt8lroty8kllva2igz4.png"></li><li>  Un buen enfoque para encontrar hiperpar√°metros y arquitecturas de modelos ser√≠a mirar art√≠culos e implementaciones relacionados.  (Lo principal es no volver a entrenar) </li></ol><br><p>  Puede aprender m√°s sobre los matices de Deep RL en este art√≠culo: <a href="https://www.alexirpan.com/2018/02/14/rl-hard.html">Deep Reinforcement Learning a√∫n no funciona</a> . </p><br><a name="conclusion"></a><h2>  Conclusi√≥n </h2><br><p>  El algoritmo resultante resuelve convincentemente el problema.  Funci√≥n encontrada <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1839"><span class="MJXp-mtext" id="MJXp-Span-1840">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">i</span><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1844">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1847" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1848">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1849">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">o</span><span class="MJXp-mtext" id="MJXp-Span-1852">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1855" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1856">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> \ pi: \ R ^ {800} \ to \ R ^ {18} </script>  , controlando con agilidad y confianza el robot. </p><br><p>  Una continuaci√≥n l√≥gica ser√° el estudio de parientes cercanos de los algoritmos A2C, PPO y TRPO.  Mejoran la <b>eficiencia de la muestra</b> , es decir  tiempo de convergencia del algoritmo, y son capaces de resolver problemas m√°s complejos.  Fue la aleatorizaci√≥n autom√°tica de dominios PPO + la que recientemente <a href="https://openai.com/blog/solving-rubiks-cube/">ensambl√≥ el cubo de Rubik en un robot</a> . </p><br><p>  Aqu√≠ puede encontrar el c√≥digo del art√≠culo: <a href="https://github.com/LeonidMurashov/advantage-actor-critic-gae">repositorio</a> . </p><br><p>  Espero que hayas disfrutado el art√≠culo y te hayas inspirado en lo que Deep Reinforcement Learning puede hacer hoy. </p><br><p>  <b>Gracias por su atencion!</b> </p><br><h2>  Enlaces utiles: </h2><br><ul><li>  <a href="https://spinningup.openai.com/en/latest/index.html">¬°Bienvenido a Spinning Up en Deep RL!</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse-fa17/index.html">CS 294: Aprendizaje de refuerzo profundo, oto√±o de 2017</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse/">CS 285: Aprendizaje de refuerzo profundo, toma de decisiones y control</a> </li><li>  <a href="https://arxiv.org/pdf/1506.02438.pdf">Control continuo de alta dimensi√≥n utilizando la ventaja de ventaja generalizada</a> </li><li>  <a href="https://github.com/openai/baselines/">OpenAI Baselines: implementaciones de alta calidad de algoritmos de aprendizaje de refuerzo</a> </li></ul><br><p>  <i>Gracias a <a href="https://habr.com/ru/users/pinkotter/" class="user_link">pinkotter</a> , <a href="https://habr.com/ru/users/vambala/" class="user_link">Vambala</a> , <a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">andrey_probochkin</a> , <a href="https://habr.com/ru/users/pollyfom/" class="user_link">pollyfom</a> y <a href="https://habr.com/ru/users/suriknik/" class="user_link">suriknik</a> por ayudar con el proyecto.</i> <br>  <i>En particular, <a href="https://habr.com/ru/users/vambala/" class="user_link">Vambala</a> y <a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">andrey_probochkin</a> para crear un ambiente genial de MuJoCo.</i> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/483078/">https://habr.com/ru/post/483078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../483064/index.html">Vue para el blog m√°s peque√±o conocido como peque√±o en todos los c√°nones</a></li>
<li><a href="../483066/index.html">Los 5 libros tradicionales de Bill Gates</a></li>
<li><a href="../483068/index.html">Ingenier√≠a inversa del popular BattlEye anti-trampa</a></li>
<li><a href="../483074/index.html">TensorRT 6.xxx: inferencia de alto rendimiento para modelos de aprendizaje profundo (detecci√≥n y segmentaci√≥n de objetos)</a></li>
<li><a href="../483076/index.html">Principales lenguajes de programaci√≥n para el desarrollo de aplicaciones de Android en 2020</a></li>
<li><a href="../483082/index.html">La caza de vulnerabilidades es un 7% m√°s efectiva</a></li>
<li><a href="../483084/index.html">C√°mara con funci√≥n de seguimiento</a></li>
<li><a href="../483086/index.html">Resultados de 2019: qu√© activos resultaron ser los m√°s rentables para los inversores rusos</a></li>
<li><a href="../483094/index.html">C√≥mo hice realidad mi sue√±o cuando visit√© la oficina rusa de Microsoft</a></li>
<li><a href="../483110/index.html">Rostov del Don: empresas de TI, comunidades y eventos en 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>