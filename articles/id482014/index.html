<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ˆ ğŸ’® ğŸ™‡ğŸ¼ Terima dan dekode TV analog menggunakan SDR dan Python ğŸ¤› ğŸ‘¨â€ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦ ğŸš‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai, Habr. 

 Hari ini kami melanjutkan topik penerimaan SDR dan pemrosesan sinyal. Saya menjadi tertarik pada penerimaan TV analog secara tidak senga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Terima dan dekode TV analog menggunakan SDR dan Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482014/">  Hai, Habr. <br><br>  Hari ini kami melanjutkan topik penerimaan SDR dan pemrosesan sinyal.  Saya menjadi tertarik pada penerimaan TV analog secara tidak sengaja, setelah pertanyaan dari salah satu pembaca.  Namun, ini ternyata tidak begitu sederhana, karena kurangnya sampel sinyal dangkal - di banyak tempat TV analog telah dimatikan.  Pembaca bahkan mengirim rekaman dengan RTL-SDR, namun, lebar rekaman di RTL sekitar 2 MHz, sedangkan bandwidth sinyal TV sekitar 8 MHz, dan tidak ada yang jelas pada rekaman.  Akibatnya, topik itu lama sekali ditinggalkan, dan akhirnya, baru saja, pada perjalanan berikutnya ke kerabat saya, saya membawa SDRPlay, dan mendengarkan frekuensi saluran TV, saya melihat sinyal yang diinginkan di layar. <br><br>  Program Python kecil, dan semuanya berfungsi: <br><br><img src="https://habrastorage.org/webt/o4/t9/y4/o4t9y4lcex9vssgmpgc2vssujvu.jpeg"><br><br>  Bagi yang tertarik dengan detail, lanjutkan di bawah cut. <a name="habracut"></a><br><br><h2>  Teori </h2><br>  Pada tahun-tahun pasca-perang, ketika laboratorium digital tahu tentang transmisi sinyal digital hanya di laboratorium rahasia, tetapi orang-orang sudah ingin menonton TV, ada tiga standar analog yang bersaing.  Yang pertama adalah <a href="https://en.wikipedia.org/wiki/NTSC">NTSC</a> Amerika (Komite Sistem Sistem Televisi Nasional), yang telah dikembangkan sejak tahun 40-an, "dipertajam" untuk frekuensi jaringan Amerika 60Hz dan memiliki resolusi vertikal hanya 486 baris.  Beberapa saat kemudian di Jerman, standar <a href="https://en.wikipedia.org/wiki/PAL">PAL</a> (Phase Alternating Line) mulai dikembangkan, yang sedikit lebih baik daripada yang Amerika (resolusi "keseluruhan" 576 baris dan fokus pada frekuensi jaringan 50Hz Eropa), dan sedikit kemudian <a href="https://en.wikipedia.org/wiki/SECAM">SECAM</a> Perancis (SÃ©quentiel couleur Ã  mÃ©moire) muncul.  Ini menghilangkan beberapa kekurangan PAL yang terkait dengan reproduksi warna, dan ada versi yang mengadopsi dua standar juga merupakan keputusan politik, sehingga penduduk di beberapa negara tidak dapat menonton program dari negara lain (sekitar 50 tahun sebelum Uni Eropa dan Schengen bersatu) .  Satu atau lain cara, tetapi seluruh dunia terbagi seperti ini: <br><br><img src="https://habrastorage.org/webt/i3/w7/qy/i3w7qyt3opicaz0prpryn9-9ha4.png"><br><br>  Karena  Habr masih merupakan situs berbahasa Rusia, maka di masa depan kami akan mempertimbangkan SECAM, meskipun jika seseorang mengirim sampel sinyal PAL, itu juga akan menarik. <br><br>  Spektrum SECAM, <s>menurut gulungan lama</s> , adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/m-/t1/l9/m-t1l9ntpksl9ul6zoi4evslxac.png"><br><br>  Di sebelah kiri, pada frekuensi F0, adalah sinyal amplitudo termodulasi (L).  Ini sebenarnya adalah gambar hitam dan putih, yang masih dapat ditampilkan pada TV hitam putih <s>hangat dan lampu</s> .  Masalah Legacy dan keberadaan perangkat lama di kalangan pengguna sudah ada saat itu, sehingga saluran warna ditambahkan secara terpisah, tanpa kehilangan kompatibilitas dengan perangkat televisi lama.  Dua saluran warna dikirim secara bergantian dalam modulasi frekuensi pada frekuensi 4,25 dan 4,406 MHz.  Dan akhirnya, frekuensi yang lebih tinggi, suara dipancarkan secara terpisah, juga dalam modulasi frekuensi. <br><br>  Omong-omong, dengan penerimaan TV di St. Petersburg ada momen lucu.  Seperti yang dilaporkan media Rusia, TV analog dimatikan pada bulan Oktober: <br><br><img src="https://habrastorage.org/webt/e_/ql/pm/e_qlpmgp7ukmcw5ag9ial0gozic.png"><br><br>  Namun, ini hanya berlaku untuk <i>saluran negara</i> , tidak ada yang memaksa <i>saluran</i> komersial <i>untuk</i> mematikan siaran mereka.  Setidaknya pada saat penulisan (Desember 2019), sekitar 5-6 saluran masih tersedia di "analog" tepat di pusat St. Petersburg.  Tapi berapa lama itu tidak akan diketahui, jadi mereka yang ingin merekam sampel sinyal "untuk sejarah" harus tetap terburu-buru. <br><br>  Akhirnya, saatnya menghidupkan SDR dan melihat apa yang kita miliki dalam kehidupan nyata: <br><br><img src="https://habrastorage.org/webt/gl/pc/6m/glpc6midlpecggjb4nknxhcvdkc.png"><br><br>  Saluran audio tidak sulit, Anda bisa mengarahkannya dengan "mouse" di HDSDR, pilih FM dengan bandwidth sekitar 50KHz dan dengarkan.  Kami akan mulai decoding dari saluran kecerahan, ini akan memungkinkan kami untuk mendapatkan "gambar" yang sudah jadi. <br><br><h2>  Decoding </h2><br>  Seperti dijelaskan di atas, sinyal pencahayaan ditransmisikan ke AM.  Agar Anda tidak dapat menulis dekoder sendiri, kami menggunakan GNU Radio - kami mentransfer spektrum ke frekuensi nol, memulai dekoder AM dan menyimpan hasilnya ke file. <br><br><img src="https://habrastorage.org/webt/xp/n2/wf/xpn2wfbovg--y915lex2kesd1we.png"><br><br>  Sekarang kita dapat membuka file yang disimpan dengan Python: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt lum_data = np.fromfile(<span class="hljs-string"><span class="hljs-string">"pal_lum.raw"</span></span>, dtype=<span class="hljs-string"><span class="hljs-string">'int32'</span></span>) lum_data = -lum_data - <span class="hljs-number"><span class="hljs-number">4700</span></span> fs = <span class="hljs-number"><span class="hljs-number">9000000</span></span>//<span class="hljs-number"><span class="hljs-number">2</span></span> x_time = np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, len(lum_data)/fs, num=len(lum_data)) plt.plot(x_time, lum_data)</code> </pre> <br>  Kami melihat urutan 4 frame di layar. <br><br><img src="https://habrastorage.org/webt/f5/yq/4a/f5yq4aeks144gso4-_73qcmn0t8.png"><br><br>  Panjang satu frame 0,02s - ini hanya 1/50 - adalah kelipatan dari frekuensi jaringan 50Hz, yang sinyalnya berfungsi sebagai "clock generator" (jangan lupa bahwa sinyalnya analog).  Untuk setiap frame, 320 baris ditransmisikan - kami memiliki pemindaian interlaced, sehingga frame rate akhir adalah 25 Hz. <br><br>  Mari kita lihat masing-masing baris secara lebih rinci: <br><br><img src="https://habrastorage.org/webt/j6/ly/7g/j6ly7gfmqmev6rlumkfudjgc8k4.png"><br><br>  Seperti yang Anda lihat, awal setiap baris berhubungan dengan "jam", kemudian ayunan sinyal sesuai dengan nilai kecerahan saat ini di baris ini.  Semuanya cukup sederhana, dan mungkin dengan hampir tidak ada perubahan, sinyal seperti itu diterapkan pada tabung sinar katoda TV. <br><br>  Sisanya adalah masalah teknologi.  Kami membuat gambar di memori dan menyalin dua frame ke dalamnya, karena  kami telah interlaced.  Rentang sinyal tidak melebihi +200, yang memungkinkan kita untuk menulis nilai-nilai ini secara langsung sebagai warna RGB. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Output image frame_size = fs*1//50 img_x, img_y = 320, 650 img_size = (img_y, img_x, 3) img_data = np.zeros(img_size, dtype=np.uint8) img_data.fill(255) frame_num = 0 # Frame #1 pos_x, pos_y = 0, 0 for px in range(frame_num*frame_size, (frame_num+1)*frame_size): val = lum_data[px] if val &lt; 0: val = 0 if val &gt; 255: val = 255 img_data[pos_y][pos_x] = (0, val, 0) pos_x += 1 if lum_data[px] &lt;= 0 and lum_data[px+1] &gt; 0: pos_x = 0 pos_y += 2 print("Scan lines 1:", pos_y) # Frame #2 pos_x, pos_y = 0, 0 for px in range((frame_num+1)*frame_size, (frame_num+2)*frame_size): val = lum_data[px] if val &lt; 0: val = 0 if val &gt; 255: val = 255 img_data[pos_y+1][pos_x] = (0, val, 0) pos_x += 1 if lum_data[px] &lt;= 0 and lum_data[px+1] &gt; 0: pos_x = 0 pos_y += 2 img_resized = cv2.resize(img_data, dsize=(3*img_x, img_y), interpolation=cv2.INTER_CUBIC) plt.imshow(img_resized, interpolation='nearest')</span></span></code> </pre><br>  Seperti yang Anda lihat, saya menggunakan zero crossing untuk mendeteksi awal baris baru.  Gambar ternyata dikompresi secara vertikal, dalam hal ini tergantung pada frekuensi pengambilan sampel SDR, pada akhirnya saya hanya mengubah ukuran lebar. <br><br>  Hasil akhir pada animasi 10 frame (tidak lagi menerima arsip file Habr): <br><br><img src="https://habrastorage.org/webt/k0/ah/ri/k0ahrixczcntxnwflutgq-aihpy.gif"><br><br><h2>  Kesimpulan </h2><br>  Sangat menarik untuk menganalisis standar tersebut, karena  pertama, mereka cukup sederhana untuk diterapkan, dan kedua, studi mereka juga merupakan bagian dari kepentingan sejarah.  Tentu saja, saya tidak memiliki tujuan untuk membuat TV tuner perangkat lunak lengkap, sehingga kode ditampilkan dalam bentuk yang dapat dioperasikan secara minimal. <br><br>  Jika peringkat artikelnya positif, di bagian kedua akan dimungkinkan untuk mempertimbangkan bekerja dengan warna dan menampilkan gambar warna yang lengkap. <br><br>  Bagi mereka yang ingin bereksperimen sendiri, file IQ dapat diunduh di <a href="https://cloud.mail.ru/public/2gSx/5LfQSJwDZ">sini</a> . <br><br>  Semua percobaan berhasil. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id482014/">https://habr.com/ru/post/id482014/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id482002/index.html">Menulis Blog Layanan Mikro - Bagian 3 â€œPenggunaâ€</a></li>
<li><a href="../id482004/index.html">Kami menguji 1C di server VPS</a></li>
<li><a href="../id482008/index.html">Konstruktor LEGO dan nol absolut</a></li>
<li><a href="../id482010/index.html">"Epik Baru". Untuk dev, ops dan orang yang ingin tahu</a></li>
<li><a href="../id482012/index.html">Raspberry Pi dan iperf - penguji bandwidth untuk perangkat Smart Home dan IoT</a></li>
<li><a href="../id482020/index.html">R, Monte Carlo, dan tugas perusahaan</a></li>
<li><a href="../id482022/index.html">Lihat saja! 20 film tentang sains dan ilmuwan</a></li>
<li><a href="../id482028/index.html">Dua tombol merah, besi solder dan React: bagaimana kami membuat langkah untuk konferensi IT</a></li>
<li><a href="../id482030/index.html">Vue.js: Kait siklus hidup komponen Anda dan pihak ketiga</a></li>
<li><a href="../id482032/index.html">Kami bermain dengan api: kami menjalankan kode arbitrer pada pengembangan iPhone 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>