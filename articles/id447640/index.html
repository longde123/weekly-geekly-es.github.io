<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¬ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ¼ ğŸŒ Cloud Firestore + Android adil â› ğŸ†š ğŸ¤˜ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Belum lama ini, Google meluncurkan Cloud Firestore. Cloud Firestore adalah basis data NoSQL berbasis cloud yang Google posisikan sebagai pengganti unt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cloud Firestore + Android adil</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447640/"><p><img src="https://habrastorage.org/webt/b7/qr/_j/b7qr_jowxs8lo___rp9mfyn_phe.png" width="350" align="left">  Belum lama ini, Google meluncurkan Cloud Firestore.  Cloud Firestore adalah basis data NoSQL berbasis cloud yang Google posisikan sebagai pengganti untuk Realtime Database.  Pada artikel ini saya ingin memberi tahu bagaimana cara menggunakannya. <br><br clear="all"></p><a name="habracut"></a><br><h4 id="vozmozhnosti">  Kemungkinan </h4><br><p>  Cloud Firestore memungkinkan Anda untuk menyimpan data di server jarak jauh, dengan mudah mengaksesnya dan memantau perubahan secara real time.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dokumentasi ini</a> memiliki perbandingan Cloud Firestore dan Realtime Database yang sangat baik. </p><br><h4 id="sozdanie-i-podklyuchenie-k-proektu">  Membuat dan menghubungkan ke proyek </h4><br><p>  Di Firebase console, pilih Database dan klik Create database.  Selanjutnya, pilih pengaturan akses.  Untuk pengenalan, mode uji akan cukup bagi kita, tetapi pada prod lebih baik untuk mendekati masalah ini dengan lebih serius.  Baca lebih lanjut tentang mode akses di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </p><br><img src="https://habrastorage.org/webt/l8/sw/cq/l8swcqne5ia2furg-1jonuvci6c.png"><br><p>  Untuk mengkonfigurasi proyek, lakukan langkah-langkah berikut: </p><br><ol><li> Tambahkan Firebase ke proyek sesuai dengan instruksi dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini.</a> </li><li> Tambahkan dependensi ke app / build.gradle <br> <code>implementation 'com.google.firebase:firebase-firestore:18.1.0'</code> </li> </ol><br><p>  Sekarang semuanya sudah siap. </p><br><p>  Untuk berkenalan dengan teknik dasar bekerja dengan Cloud Firestore, saya menulis sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">aplikasi</a> sederhana.  Agar berhasil, Anda perlu membuat proyek di Firebase console dan menambahkan file google-services.json ke proyek di Android Studio. </p><br><h4 id="struktura-hraneniya-dannyh">  Struktur penyimpanan data </h4><br><p>  Firestore menggunakan koleksi dan dokumen untuk menyimpan data.  Dokumen adalah catatan yang berisi bidang apa pun.  Dokumen digabungkan menjadi koleksi.  Dokumen juga dapat berisi koleksi bersarang, tetapi ini tidak didukung di android.  Jika kita menggambar analogi dengan database SQL, maka koleksi adalah tabel, dan dokumen adalah entri dalam tabel ini.  Satu koleksi dapat berisi dokumen dengan kumpulan bidang yang berbeda. </p><br><h4 id="poluchenie-i-zapis-dannyh">  Menerima dan merekam data </h4><br><p>  Untuk mendapatkan semua dokumen koleksi, kode berikut cukup </p><br><pre> <code class="kotlin hljs">remoteDB.collection(â€œTasksâ€) .<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() .addOnSuccessListener { querySnapshot -&gt; <span class="hljs-comment"><span class="hljs-comment">//   .   querySnapshot.documents } .addOnFailureListener { exception -&gt; //      } }</span></span></code> </pre> <br><p>  Di sini kami meminta semua dokumen dari koleksi <em>Tugas</em> . </p><br><p>  Perpustakaan memungkinkan Anda untuk menghasilkan kueri dengan parameter.  Kode berikut menunjukkan cara mendapatkan dokumen dari koleksi berdasarkan kondisi </p><br><pre> <code class="kotlin hljs">remoteDB.collection(â€œTasksâ€) .whereEqualTo(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, <span class="hljs-string"><span class="hljs-string">"Task1"</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() .addOnSuccessListener { querySnapshot -&gt; <span class="hljs-comment"><span class="hljs-comment">//   .   querySnapshot.documents } .addOnFailureListener { exception -&gt; //      } }</span></span></code> </pre> <br><p>  Di sini kami meminta semua dokumen dari koleksi <em>Tugas</em> yang bidang <em>judulnya</em> sesuai dengan nilai <em>Tugas1</em> . </p><br><p>  Setelah menerima dokumen, mereka dapat segera dikonversi ke kelas data kami </p><br><pre> <code class="kotlin hljs">remoteDB.collection(â€œTasksâ€) .<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() .addOnSuccessListener { querySnapshot -&gt; <span class="hljs-comment"><span class="hljs-comment">//   .   querySnapshot.documents val taskList: List&lt;RemoteTask&gt; = querySnapshot.toObjects(RemoteTask::class.java) } .addOnFailureListener { exception -&gt; //      } }</span></span></code> </pre> <br><p>  Untuk menulis, Anda perlu membuat Hashmap dengan data (di mana nama bidang bertindak sebagai kunci, dan nilai bidang ini sebagai nilai) dan mentransfernya ke perpustakaan.  Kode berikut menunjukkan ini </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> taskData = HashMap&lt;String, Any&gt;() taskData[<span class="hljs-string"><span class="hljs-string">"title"</span></span>] = task.title taskData[<span class="hljs-string"><span class="hljs-string">"created"</span></span>] = Timestamp(task.created.time / <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) remoteDB.collection(<span class="hljs-string"><span class="hljs-string">"Tasks"</span></span>) .add(taskData) .addOnSuccessListener { <span class="hljs-comment"><span class="hljs-comment">//   } .addOnFailureListener { //     }</span></span></code> </pre> <br><p>  Dalam contoh ini, dokumen baru akan dibuat dan Firestore akan menghasilkan id untuk itu.  Untuk mengatur id Anda sendiri lakukan hal berikut </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> taskData = HashMap&lt;String, Any&gt;() taskData[<span class="hljs-string"><span class="hljs-string">"title"</span></span>] = task.title taskData[<span class="hljs-string"><span class="hljs-string">"created"</span></span>] = Timestamp(task.created.time / <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) remoteDB.collection(<span class="hljs-string"><span class="hljs-string">"Tasks"</span></span>) .document(<span class="hljs-string"><span class="hljs-string">"New task"</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(taskData) .addOnSuccessListener { <span class="hljs-comment"><span class="hljs-comment">//   } .addOnFailureListener { //     }</span></span></code> </pre> <br><p>  Dalam hal ini, jika tidak ada dokumen dengan id sama dengan <em>tugas baru</em> , maka akan dibuat, dan jika ada, maka bidang yang ditentukan akan diperbarui. </p><br><p>  Opsi lain untuk membuat / memperbarui dokumen </p><br><pre> <code class="kotlin hljs">remoteDB.collection(<span class="hljs-string"><span class="hljs-string">"Tasks"</span></span>) .document(<span class="hljs-string"><span class="hljs-string">"New task"</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(mapToRemoteTask(task)) .addOnSuccessListener { <span class="hljs-comment"><span class="hljs-comment">//   } .addOnFailureListener { //     }</span></span></code> </pre> <br><h4 id="podpisyvaemsya-na-izmeneniya">  Berlangganan perubahan </h4><br><p>  Firestore memungkinkan Anda untuk berlangganan perubahan data.  Anda dapat berlangganan perubahan pada koleksi serta perubahan pada dokumen tertentu </p><br><pre> <code class="kotlin hljs">remoteDB.collection(<span class="hljs-string"><span class="hljs-string">"Tasks"</span></span>) .addSnapshotListener { querySnapshot, error -&gt; <span class="hljs-comment"><span class="hljs-comment">// querySnapshot -   // error -  }</span></span></code> </pre> <br><p>  querySnapshot.documents - berisi daftar terbaru dari semua dokumen <br>  querySnapshot.documentChanges - berisi daftar perubahan.  Setiap objek berisi dokumen yang dimodifikasi dan jenis perubahan.  3 jenis perubahan dimungkinkan <br>  TAMBAH - dokumen ditambahkan, <br>  DIUBAH - dokumen telah diubah, <br>  DIHAPUS - dokumen dihapus </p><br><h4 id="zagruzka-bolshogo-kolichestva-dannyh">  Memuat sejumlah besar data </h4><br><p>  Realtime Database menyediakan mekanisme yang kurang nyaman untuk mengunduh data dalam jumlah besar, yang terdiri dari pengeditan file json secara manual dan mengunduhnya.  Di luar kotak, Firestore tidak menyediakan hal semacam itu.  Sangat tidak nyaman untuk menambahkan dokumen baru sampai saya menemukan cara untuk dengan mudah memuat sejumlah besar informasi.  Agar Anda tidak memiliki masalah seperti milik saya, di bawah ini saya akan melampirkan instruksi tentang cara mengunduh data dalam jumlah besar dengan cepat dan mudah.  Instruksi ditemukan di Internet. </p><br><ol><li>  Instal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Node.js dan npm</a> </li><li>  Instal paket firebase-admin dengan menjalankan perintah <br> <code>npm install firebase-admin --save</code> </li> <li>  Hasilkan file json dengan data koleksi.  Contohnya dapat ditemukan di file <a href="">Tasks.json.</a> </li><li>  Untuk mengunduh, kita memerlukan kunci akses.  Cara mendapatkannya dijelaskan dengan baik di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">.</a> </li><li>  Dalam file <a href="">export.js</a> tuliskan data Anda <br>  memerlukan ('./ firestore_key.json') - file dengan kunci akses.  Saya berada di folder dengan skrip <br>  &lt;YOU_DATABASE&gt; - nama basis firestore Anda <br>  "./json/Tasks.json" - path ke file tempat data <br>  ['dibuat'] - daftar nama bidang dengan tipe Timestamp </li><li>  Jalankan skrip <br> <code>node export.js</code> <br>  Script menggunakan perkembangan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dalenguyen</a> </li></ol><br><h4 id="zaklyuchenie">  Kesimpulan </h4><br><p>  Saya menggunakan Cloud Firestore di salah satu proyek saya dan tidak mengalami masalah serius.  Salah satu koleksi saya berisi sekitar 15.000 dokumen dan pertanyaan tentangnya cukup cepat dan ini tanpa menggunakan indeks.  Menggunakan Cloud Firestore bersama dengan Room dan Remote Config, Anda dapat secara signifikan mengurangi jumlah panggilan ke basis data dan tidak melampaui batas bebas.  Dengan tarif gratis per hari, Anda dapat membaca 50.000 dokumen, mencatat 20.000 dan menghapus 20.000. </p><br><div class="spoiler">  <b class="spoiler_title">Kinerja aplikasi</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ed/f5/jm/edf5jmqtkoofqkxtomitfduda4w.gif"></p></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id447640/">https://habr.com/ru/post/id447640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id447630/index.html">SpaceX: peluncuran Falcon Heavy dan pendaratan tiga akselerator, dua di antaranya bersamaan [01: 35MSK, 12 Apr 2019]</a></li>
<li><a href="../id447632/index.html">Infrastruktur sepeda di Belanda - bagaimana cara kerjanya?</a></li>
<li><a href="../id447634/index.html">Stimulasi dengan listrik menyebabkan peningkatan signifikan dalam memori lansia</a></li>
<li><a href="../id447636/index.html">Bagaimana menjadi perancang hidup Anda: kiat-kiat dari Bill Burnett, Manajer Program Desain Stanford dan Apple Veteran</a></li>
<li><a href="../id447638/index.html">Ponsel pintar Audiophile: kriteria pemilihan dan beberapa perwakilan kelas yang khas</a></li>
<li><a href="../id447650/index.html">Bagaimana memisahkan frontend dan backend sambil mempertahankan saling pengertian</a></li>
<li><a href="../id447652/index.html">Desain Akhir Pekan: Adaptor MIDI Sederhana</a></li>
<li><a href="../id447654/index.html">Raspberry-pi-tank dan navigasi GPS</a></li>
<li><a href="../id447656/index.html">Variabilitas evolusi: kelahiran hidup dan bertelur secara serentak di kadal spesies Saiphos equalis</a></li>
<li><a href="../id447658/index.html">Game pemrograman aksi - hiburan atau cara untuk memperkenalkan anak-anak pada algoritma dan robotika</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>