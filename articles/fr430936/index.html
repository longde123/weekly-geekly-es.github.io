<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßúüèø ‚úäüèæ üî∞ DEFCON 21. La conf√©rence DNS peut √™tre dangereuse pour votre sant√©. 2e partie üíÖüèª üë©‚Äçüé§ üëÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DEFCON 21. La conf√©rence DNS peut √™tre dangereuse pour votre sant√©. Partie 1 

 Il a √©t√© suppos√© que les limites de domaine de l'organisation √©taient ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON 21. La conf√©rence DNS peut √™tre dangereuse pour votre sant√©. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/430936/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DEFCON 21. La conf√©rence DNS peut √™tre dangereuse pour votre sant√©.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1</a> <br><br>  Il a √©t√© suppos√© que les limites de domaine de l'organisation √©taient foo.com et que vous ne voudriez jamais utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.com</a> .  Microsoft a modifi√© ce comportement DNS car, de toute √©vidence, toutes les organisations n'ont pas deux niveaux pour les noms de domaine. <br><br><img src="https://habrastorage.org/webt/vf/vl/75/vfvl75firrgcfnxkplyxadipigi.jpeg"><br><br>  Si votre domaine de premier niveau est le Royaume-Uni, lors de la connexion √† un domaine ad.foo.co.uk sp√©cifique, le comportement DNS par d√©faut ressemblera √† ceci: <br><br><img src="https://habrastorage.org/webt/2o/_3/y6/2o_3y6rzyxg1a6uzbnxxrdzqnvk.jpeg"><br><br>  Autrement dit, la demande sera envoy√©e en dehors des fronti√®res de votre nom de domaine sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.co.uk.</a>  Par cons√©quent, un correctif al√©atoire a √©t√© cr√©√©, un correctif de s√©curit√© qui a r√©duit les limites organisationnelles du domaine √† 3, auquel cas la d√©volution DNS s'est arr√™t√©e apr√®s la deuxi√®me demande <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.foo.co.uk.</a> <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/p1/v5/3f/p1v53f72bjrrddwozdqzth3fpms.jpeg"><br><br>  Mais dans notre exemple de nom de domaine, ce correctif de s√©curit√©, con√ßu pour arr√™ter la publicit√© inutile, a bris√© des centaines de milliers d'entreprises clientes dont la conception du nom de domaine d√©pendait du comportement DNS d'origine.  Que font ces entreprises?  Modifient-ils la conception de l'infrastructure pour correspondre au nouveau comportement qui prend en compte ce correctif al√©atoire?  Non, ils changent le comportement √† ce qu'il √©tait avant. <br><br>  La diapositive suivante montre l'arbre de d√©cision que Microsoft utilise avant de cr√©er une requ√™te DNS. <br><br>  Je sais que cela a l'air simple (rires), et bien s√ªr, vous √™tes surpris que quelqu'un puisse le mal comprendre. <br><br><img src="https://habrastorage.org/webt/6p/6k/u6/6p6ku64sfpnrz1hzrxuk9frchsi.jpeg"><br><br>  Apr√®s cela, il y a eu des dizaines de correctifs et de mises √† jour de ce comportement DNS, qui ont chang√© d'une version √† l'autre.  Mais ils l'ont document√© une fois, et si l'une des branches de cet arbre a chang√©, cela a compl√®tement cass√© votre fa√ßon d'utiliser DNS, et vous ne pouvez pas modifier les param√®tres pour restaurer le comportement d'origine.  Vous avez eu un probl√®me car √† chaque nouvelle mise √† jour, vos param√®tres se comportent diff√©remment.  Peut-√™tre que quelque chose va se casser, ou peut-√™tre pas, c'est-√†-dire que quelque chose auquel vous ne vous attendez pas du tout peut arriver. <br><br>  Ainsi, les entreprises apportent des modifications par le biais de la modification des registres ou des strat√©gies de groupe, essayant de restaurer le comportement DNS d'origine, mais certaines d'entre elles ne peuvent pas le faire correctement lorsque le comportement a √©t√© modifi√© par un autre groupe de correctifs.  Ils tentent d'annuler les modifications pour restaurer ce comportement perdu, car ils souhaitent que les clients puissent √† nouveau acc√©der √† foo.com. <br><br><img src="https://habrastorage.org/webt/b0/tp/wu/b0tpwujwuzovazxhj0zlm1bh_so.jpeg"><br><br>  Mais dans la plupart des cas, lorsqu'ils ne peuvent pas restaurer une d√©volution √† deux niveaux, ils se d√©barrassent simplement de la restriction √† deux niveaux d'origine.  Merci, Microsoft, pour Windows 7 - vous pouvez maintenant modifier les trois niveaux de domaine par d√©faut par 2, mais le syst√®me ne vous permet pas de les r√©duire √† un. <br><br><img src="https://habrastorage.org/webt/tz/kw/jl/tzkwjlaf1zpmbv2lz5mk8ma1zva.jpeg"><br><br>  Vous pourriez penser que maintenant tout est corrig√©, mais qu'en est-il des appareils BYOD et des appareils mobiles utilisant la configuration XP?  J'ai d√©cid√© de v√©rifier combien de configurations endommag√©es peuvent encore exister l√†-bas.  J'ai enregistr√© plusieurs domaines qui sont couramment utilis√©s uniquement dans un environnement d'entreprise. <br><br>  Le premier domaine est l'acronyme de Microsoft Office Communicator, qui demande un serveur SIP interne.  Les deux noms suivants que j'ai trouv√©s sur Google sont les noms abr√©g√©s des cl√©s de registre cl√©s que contient le proxy Web, j'ai donc attribu√© ces noms √† mes serveurs et attendu que les clients me contactent.  Et ils l'ont fait. <br><br><img src="https://habrastorage.org/webt/fg/gc/lg/fggclg28hcqs7pcmzfbn5vo02eq.jpeg"><br><br>  Apr√®s avoir enregistr√© sipinternal.com, j'ai commenc√© √† recevoir des demandes des clients du communicateur de bureau - la diapositive montre un exemple d'une demande d'enregistrement d'une des ressources de DHL, et il s'est av√©r√© qu'il y a des milliers d'appareils al√©atoires dans le monde qui ont essay√© de s'inscrire avec moi. <br><br><img src="https://habrastorage.org/webt/ts/cr/fu/tscrfup8wbhfkzj5oui4zveuzfg.jpeg"><br><br>  J'ai jou√© un peu avec eux, et cela ressemblait √† plusieurs attaques qu'un serveur SIP malveillant m√®ne contre les communicateurs clients.  Ce sera ma prochaine histoire sur proxy-phoenix.com <br><br><img src="https://habrastorage.org/webt/qd/sa/zr/qdsazrdrokpuopnnqnssrxv1nai.jpeg"><br><br>  Il y avait plusieurs utilisateurs finaux d'IBM et de HP qui ont commenc√© √† me demander de devenir leur serveur proxy, et maintenant ils ont un client √† Phoenix qui "bouscule" proxy-phoenix comme un nom court pour ses utilisateurs.  Je pensais que c'√©tait int√©ressant.  Mais set-proxy.com s'est av√©r√© encore plus int√©ressant. <br><br>  Les premi√®res demandes que j'ai re√ßues √©taient des tentatives de milliers de clients Windows de t√©l√©charger un fichier de package d'installation de proxy.  J'ai d√©couvert que l'adresse IP source √©tait enregistr√©e aupr√®s d'Arthur Andersen, une firme comptable infructueuse qui a fait faillite avec Enron. <br><br><img src="https://habrastorage.org/webt/jt/tk/du/jttkdu_otn6oyqtmdsb9r21naky.jpeg"><br><br>  Accenture s'est s√©par√© de son groupe de consultants, ce qui est plus logique dans la partie suivante.  Cela montre que leur politique d'utilisation des appareils mobiles s'est effondr√©e (rires). <br><br><img src="https://habrastorage.org/webt/ra/xy/52/raxy5209fuvmmn4jjbg7xh9wvmu.jpeg"><br><br>  Ils promeuvent une configuration qui fait r√©f√©rence √† l'emplacement du package proxy par le nom de domaine abr√©g√©.  Et des milliers d'iPhone et d'iPad ont r√©pondu √† ce nom court et ont commenc√© √† me demander de leur fournir ces packages de fichiers.  M√™me le fait que cette configuration ne permette pas aux clients d'obtenir ce qu'ils ont demand√© ne les a pas fait r√©fl√©chir, et ils sont all√©s directement sur Internet, contournant le proxy, pour me demander ces fichiers. <br><br>  Apr√®s avoir regard√© de plus pr√®s, j'ai remarqu√© que je recevais des demandes non seulement d'Accenture, mais aussi de leurs clients connect√©s au r√©seau de cette entreprise.  Ainsi, √† travers un DNS incorrect, Accenture a compromis non seulement son r√©seau local, mais aussi les r√©seaux de tous les clients qui y sont connect√©s, permettant le piratage de tous les appareils qui s'y trouvent.  J'ai √©t√© directement contact√© par des appareils appartenant √† des employ√©s d'IBM, HP, Dow, Nokia, GE, Merck, Medco.  Ils m'ont tous demand√© d'√™tre leur mandataire, et je vous dirai que j'attendais le meilleur d'Accenture. <br><br><img src="https://habrastorage.org/webt/30/cp/ce/30cpcedocnjq2uwrbi52whb6w7s.jpeg"><br><br>  De telles le√ßons peuvent en √™tre tir√©es.  Surveillez votre trafic DNS, car si Windows se comporte de la m√™me mani√®re maintenant, cela ne signifie pas du tout qu'il se comportera de la m√™me mani√®re apr√®s le deuxi√®me mardi du mois (rires). <br><br>  Ne faites pas confiance aux attentes bas√©es sur le fait que les choses se passeront comme elles le devraient, regardez le trafic et apprenez √† comprendre √† quoi devrait ressembler le trafic DNS normal sur votre r√©seau.  Vous devez comprendre clairement √† quoi ressemble le trafic normal avant d'apporter des modifications aux param√®tres afin de pouvoir les comparer ult√©rieurement. <br><br><img src="https://habrastorage.org/webt/zh/2h/0a/zh2h0afmnkcw3li9x5hy94nhpcw.jpeg"><br><br>  L√©gende: ¬´Vous n'√™tes pas propri√©taire de ce domaine.  Je le suis. " <br><br>  J'ai d√©montr√© quelques fa√ßons assez uniques dans lesquelles un bit ¬´flip¬ª dans DNS peut √™tre dangereux.  Cependant, le squattage de bits n'est pas une menace √©norme, il est donc plus int√©ressant d'effectuer des tours avec un comportement DNS inattendu provoqu√© par une combinaison de ¬´correctifs¬ª Microsoft avec la configuration d'origine, ce qui le rend compl√®tement inintelligible. <br><br>  Cependant, l'une des pires choses que les entreprises font en mati√®re de DNS est l'automutilation √† 100% par n√©gligence. <br><br>  J'ai vu des entreprises qui √† plusieurs reprises, au cours de plusieurs ann√©es, parfois par accident, et parfois intentionnellement, ont cr√©√© toutes les conditions pour qu'un attaquant puisse prendre le contr√¥le de toutes les parties de leur infrastructure. <br><br>  Le probl√®me est qu'en fait, les entreprises utilisent les domaines dont elles ne sont pas propri√©taires.  Ces domaines, plac√©s dans les cha√Ænes de recherche de suffixes, ¬´poussent¬ª tous leurs clients √† acc√©der in√©vitablement √† Internet externe lorsqu'ils ont besoin d'une assistance technique. <br><br>  J'ai d√©cid√© d'√©tudier combien d'entreprises sont oblig√©es de le faire, et cela n'a pas √©t√© difficile pour moi.  J'ai commenc√© par demander de l'aide √† Google pour trouver les noms de cl√©s de registre qui stockent la liste de recherche pour la sortie de la configuration IP de Windows et la liste de recherche de suffixe DNS. <br><br><img src="https://habrastorage.org/webt/us/lv/rv/uslvrvao2-dpoodwfs4wulpfmv0.jpeg"><br><br>  Les forums de support technique encouragent les utilisateurs √† publier des informations sur la configuration du poste de travail pour obtenir de l'aide sur le d√©pannage. <br><br><img src="https://habrastorage.org/webt/f2/hv/b8/f2hvb8a8hgdxm_qtaveacz_2o2k.jpeg"><br><br>  J'ai √©tudi√© Google et cr√©√© une liste unique de domaines, puis j'ai commenc√© √† les enregistrer.  En regardant la configuration IP, je suis tomb√© sur le suffixe DNS rsquanta et en ai fait la base de ma liste d'enregistrement de domaine. <br><br><img src="https://habrastorage.org/webt/tc/o3/mh/tco3mharjdukpwup-zm4g3xkfu4.jpeg"><br><br>  Apr√®s avoir enregistr√© les domaines avec les noms d√©form√©s indiqu√©s sur la diapositive suivante, j'ai commenc√© √† recevoir des milliers de demandes d'appareils mobiles qui ne savaient m√™me pas quelle entreprise ils contactaient.  Mais je l'ai d√©couvert.  Il s'est av√©r√© que le suffixe de nom de domaine rsquanta.com appartient √† une grande entreprise ta√Øwanaise de mat√©riel informatique, Quanta Computer, qui emploie 60 000 personnes. <br><br><img src="https://habrastorage.org/webt/jd/oc/np/jdocnpwh2bzb0gics-adlvpyaiy.jpeg"><br><br>  Ils ont con√ßu et fabriqu√© l'ordinateur portable de cent dollars pour enfants OLPC et ont collabor√© avec Facebook pour concevoir et assembler leurs nouveaux serveurs en fonction de leurs appareils.  J'ai re√ßu des demandes d'auto-d√©tection de proxys, serveurs SMS, serveurs de messagerie, serveurs de transfert de fichiers.  Il y avait des dizaines de fa√ßons dont je pouvais calmement saisir ces appareils en Tha√Ølande et introduire des exploits pour voler des informations d'identification ou intercepter des fichiers transf√©r√©s.  Apr√®s m'avoir demand√© de les aider √† trouver les bonnes ressources, une attaque d'homme au milieu aurait l'air banale. <br><br>  Mais quand j'ai d√©termin√© les sources des demandes que j'ai re√ßues √† mes serveurs factices, cela m'a vraiment frapp√©.  J'ai constat√© que le trafic r√©gulier provenait des r√©seaux clients, ce qui indiquait l'existence de p√©riph√©riques Quanta Computer chez Cisco, Apple, 3m et Dell. <br><br><img src="https://habrastorage.org/webt/oq/tt/jl/oqttjloopihnzszsk_yvl1swy8k.jpeg"><br><br>  Par cons√©quent, ils √©taient cens√©s avoir du personnel sur le terrain dont le devoir √©tait d'aider √† mettre en ≈ìuvre l'√©quipement Quanta.  Et ce ne sont que quelques-uns des clients de cette entreprise qui ont des employ√©s de Quanta Computer travaillant dans le domaine - je les ai connus parce qu'ils m'ont tous demand√© de donner acc√®s aux actifs de l'entreprise. <br><br><img src="https://habrastorage.org/webt/bk/fo/lv/bkfolvgcq_x0mdzwwa2aaejblay.jpeg"><br><br>  Leur mat√©riel √©tait solidement implant√© dans l'√©quipement de soci√©t√©s renomm√©es et li√© √† la propri√©t√© intellectuelle confidentielle.  Ainsi, il y avait beaucoup d'informations passives que je pouvais extraire de leur trafic.  Je poss√©dais une liste des noms de chaque appareil sur leur r√©seau, j'ai vu le trafic de l'entreprise cach√© au public, ce qui indiquait la pr√©sence d'un nouveau contrat.  Si la circulation s'arr√™tait soudainement, je pouvais supposer qu'ils avaient perdu le contrat et je pouvais suivre o√π ils iraient ensuite, o√π ces employ√©s voyageraient et o√π ils iraient. <br><br><img src="https://habrastorage.org/webt/l5/-1/mh/l5-1mhi4a6g6jj0iqcdjn5uxu58.jpeg"><br><br>  Par exemple, je constate qu‚Äôun service de nettoyage √† sec Wi-Fi s‚Äôest ouvert pr√®s du bureau de la soci√©t√©, car des centaines d‚Äôappareils m'envoient de temps en temps des demandes.  Je vois m√™me que dans cette ville il y a des gens pour Black Hat et DefCon, plus tard on en parlera (rires). <br><br>  Une erreur de ce type est donc assez grave.  Pour l'√©viter, veuillez v√©rifier votre configuration DNS.  Utilisez Internet pour d√©couvrir les d√©tails de votre configuration interne √† l'aide de ressources telles que Pastebin et Bleeping Computer. <br><br>  Surveillez vos journaux DNS et assurez-vous que vos clients et les clients de vos partenaires et fabricants r√©pondent aux demandes exactement comme vous vous y attendez.  Si vous suivez les journaux, identifiez facilement les domaines fr√©quemment demand√©s pour chaque appareil, chaque actif d'entreprise. <br><br>  Il y a quelques ann√©es, j'ai commenc√© √† acheter des domaines expir√©s, qui √©taient auparavant utilis√©s comme serveurs C&amp;C.  (rires).  C'√©tait tr√®s amusant, donc au d√©but, je voulais comprendre combien il restait d'infection, puis savoir quel type de dispositifs √©taient encore infect√©s et o√π ils se trouvaient. <br><br>  La recherche de domaines √† partir de la ¬´liste noire¬ª n'a pas √©t√© difficile, j'ai donc eu le choix entre des milliers de domaines au prix de 99 cents et j'en ai achet√© plusieurs.  La diapositive suivante montre le premier domaine que j'ai achet√© - microsoft-windows-security.com.  Il √©tait infect√© par le virus Win32: EyeStye, un bot trojan, un intercepteur de clavier utilis√© pour voler des informations confidentielles.  Il a intercept√© l'entr√©e, puis l'a envoy√©e √† ce domaine sous la forme de messages non chiffr√©s.  Je n'ai rien fait avec lui, je lui ai juste envoy√© une erreur 404 √† chaque fois qu'il voulait me contacter, mais il a quand m√™me essay√© de m'envoyer les donn√©es vol√©es. <br><br><img src="https://habrastorage.org/webt/g7/el/ih/g7elihaxxzz7kqjfkqa0hhchzcw.jpeg"><br><br>  Ce bot rapporte son identifiant unique, le nom du processus qui contr√¥le, la fonction intercept√©e, les donn√©es qu'il contient et la charge utile sous la forme du nom d'utilisateur et du mot de passe de l'utilisateur. <br><br><img src="https://habrastorage.org/webt/my/g1/ky/myg1ky-n-o5sfcggfwaycmpfyzy.jpeg"><br><br>  Beaucoup de ces robots continuent de livrer aveugl√©ment des charges utiles √† leur domaine.  J'ai enregistr√© des dizaines de ces domaines, couvrant des milliers d'appareils infect√©s.  Ces repr√©sentants du r√©seau de botnet ont simplement √©t√© abandonn√©s par leurs anciens propri√©taires, qui ne voulaient pas faire d'effort pour les fermer, mais les ont simplement laiss√©s sur le r√©seau jusqu'√† l'expiration du domaine.  J'ai donc d√©pens√© mes 6 premiers dollars sur ces domaines infect√©s par des virus (applaudissements dans le hall). <br><br><img src="https://habrastorage.org/webt/ai/bk/zr/aibkzrs36ipq1f963hlkwt2wcsm.jpeg"><br><br>  J'avais 23 000 appareils envoyant des rapports √† mon serveur, et tous ces domaines √©taient tir√©s de listes noires publi√©es.  Pourquoi tant d'entreprises ont-elles permis √† leurs clients de contacter des domaines longtemps consid√©r√©s comme malveillants? <br><br>  Nous pouvons tous am√©liorer notre travail en contr√¥lant l'un des m√©canismes les plus simples, donc en fouillant simplement dans les journaux de mes domaines, je suis tomb√© sur un qui semblait vraiment inhabituel. <br><br><img src="https://habrastorage.org/webt/je/zg/rv/jezgrvyjs16ezlty6pirdol3vp0.jpeg"><br><br>  L'un des clients de 82 000 appareils sur mon r√©seau le demandait r√©guli√®rement, et quand j'ai commenc√© √† le trier, j'ai constat√© que ce domaine √©tait expir√© depuis six mois et ne figurait sur aucune "liste noire" et qu'il n'y en avait pas une seule mention sur Google.  Il semblait trop suspect, alors je l'ai achet√© et il a √©t√© imm√©diatement inond√© de clients.  C'√©tait un grabber ordinaire qui envoyait sa charge utile sous forme non crypt√©e et contr√¥lait 10 000 appareils infect√©s √† travers le monde.  Certains d'entre eux se trouvaient dans des zones b√©n√©ficiant du r√©gime de s√©curit√© le plus √©lev√©, et j'ai constat√© que l'un des appareils infect√©s appartenait aux installations de traitement de la ville de Phoenix. <br><br>  Je me suis tourn√© vers quelqu'un de cette soci√©t√© et j'ai dit que je pourrais identifier le virus s'ils m'envoyaient un √©chantillon du fichier infect√©.  D√®s qu'ils m'ont envoy√© un √©chantillon, je l'ai t√©l√©charg√© sur Virustotal et j'ai constat√© qu'aucun des 42 scanners antivirus ne pouvait identifier ce virus.  Ce malware avait 2 ans, et il me semblait √©trange qu'il n'ait √©t√© identifi√© comme une menace dans aucun antivirus.  Mais ce qui √©tait encore plus √©trange, c'est pourquoi il a √©t√© abandonn√©?  Compl√®tement invisible aux antivirus, c'√©tait vraiment une infection virale tr√®s pr√©cieuse.  Et voici un exemple ironique - c'√©tait un ing√©nieur QA chez Symantec, j'esp√®re qu'il n'est pas l√†. <br><br><img src="https://habrastorage.org/webt/ll/mx/q4/llmxq42ijulwwwrgk3fzrazdwia.jpeg"><br><br>  Ici, je vois comment cela fonctionne dans le syst√®me de billetterie en ligne, et dans ce cas, il ferme le ticket en raison du probl√®me de s√©curit√© de la carte SIM du produit.  Je pense qu'il est plut√¥t triste qu'une partie du malware, qui a d√©j√† 2 ans, soit toujours incluse dans la liste d'exclusion du programme antivirus de l'entreprise par un ing√©nieur qui travaille pour √©liminer les d√©fauts dangereux et assurer la s√©curit√© des produits de l'entreprise. <br>  Il y a pas mal d'appareils infect√©s appartenant √† des hauts fonctionnaires et des repr√©sentants du gouvernement, tels que le greffier du tribunal, la chambre basse du Congr√®s am√©ricain, les bureaux de transfert d'argent, les journaux et m√™me le caissier de la Federal Servants Union √† Langley!  Ce sont certainement les meilleurs 99 cents que j'ai jamais d√©pens√©s. <br><br>  Il est effrayant de penser qu'il y a probablement des millions d'appareils infect√©s qui tentent d'atteindre les serveurs Command &amp; Control, dont l'acc√®s n'est plus autoris√©.  Si vous utilisez le DNS ouvert ou local de presque n'importe quel grand fournisseur, ne donnez pas aux appareils infect√©s la possibilit√© de r√©aliser tout ce qu'ils essaient de r√©soudre, peu importe si un tel domaine existe ou non.  Parce qu'ils simulent une r√©ponse qui n'existe pas et vous donnent l'adresse IP par d√©faut de la page de destination.  Ainsi, le journal du serveur qui h√©berge cette page contient une myriade de donn√©es vol√©es.  Pensez-vous que les propri√©taires d'h√¥tes font quelque chose pour emp√™cher cela? <br><br>  Ils essaient simplement de mon√©tiser le trafic inappropri√© avec des publicit√©s qui volent par inadvertance vos donn√©es personnelles.  Vous vous attendez √† ce que si un programme malveillant essaie de vous permettre de contacter un serveur C&amp;C qui a √©t√© d√©connect√©, vous n'irez nulle part, vous ne serez simplement pas autoris√© √† y aller. <br><br><img src="https://habrastorage.org/webt/xr/m-/0q/xrm-0qzte3qd1jnm31esgwn1res.jpeg"><br><br>  En r√©alit√©, cela se produit comme indiqu√© dans les diapositives suivantes - les DNS ouverts sont si gentils qu'ils vous donneront une r√©ponse √† n'importe quoi, peu importe si ce domaine existe ou non, et ils vous fourniront avec plaisir l'adresse IP d'un site malveillant qui volera vos donn√©es. <br><br><img src="https://habrastorage.org/webt/_z/8f/j-/_z8fj-172xf7nedkhr96miby-5g.jpeg"><br><br><img src="https://habrastorage.org/webt/ka/w1/2s/kaw12s4xqu1_ww_r0h9plfwkc_w.jpeg"><br><br>  J'ai enregistr√© plusieurs domaines qui ne figurent actuellement sur aucune liste noire.  J'ai trouv√© tous les √©chantillons de logiciels malveillants pass√©s inaper√ßus par les principaux fournisseurs d'antivirus en analysant les journaux DNS.  Afin de d√©tecter de tels virus, j'agis comme ceci: <br><br><ul><li>  Je collecte les journaux DNS que les gens me fournissent dans une base de donn√©es commune; </li><li>  surveiller r√©guli√®rement les noms demand√©s qui sont apparus pour la premi√®re fois dans mon environnement; </li><li>  Je trouve les noms demand√©s par un seul client; </li><li>  Je regarde les dates d'enregistrement et d√©termine les propri√©taires et le pays d'enregistrement du nouveau domaine; </li><li>  Je recherche des domaines qui permettent l'utilisation de l'adresse IP 127.0.0.1, ils sont probablement cr√©√©s par des "nerds". </li></ul><br>  Sur le net, il est assez facile de rep√©rer des choses qui se distinguent par leur caract√®re inhabituel.  Vous pouvez g√©n√©rer une liste tous les jours, elle est suffisamment petite pour √™tre trait√©e manuellement.  Dans la diapositive suivante, je fournirai des liens vers certaines ressources que vous devriez visiter et utiliser si vous pr√©voyez de d√©marrer l'exploration DNS. <br><br>  Le site Bro prend en charge l'enregistrement des requ√™tes DNS et stocke les journaux de requ√™tes.     DNS Anomaly Detection ‚Äì   ,         ,  ,  ,  - . <br><br> Passive DNS ‚Äì     Microsoft,     ¬´¬ª   ,   ¬´¬ª        .pcap   . <br><br><img src="https://habrastorage.org/webt/bo/z9/qi/boz9qifx5wf225qkmyhekeaoryu.jpeg"><br><br> Response Policy Zones   ,            ,       .       DNS Sinkholes,         ,      . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La derni√®re diapositive fournit des liens vers une documentation qui vous aidera √† ¬´creuser¬ª le trafic DNS, o√π vous pourrez trouver bien plus que ce √† quoi vous vous attendiez. </font></font><br><br><img src="https://habrastorage.org/webt/vm/sh/hh/vmshhhzvurq6lpdk8d4blyogbta.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Merci d'avoir pass√© votre temps sur moi! </font><font style="vertical-align: inherit;">Vous pouvez me contacter √† tout moment √† cette adresse: bobx@rot26.net.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/9Sgaq6OYLX8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en le recommandant √† vos amis, une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√©s pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment diviser le serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbit / s jusqu'en d√©cembre gratuitement</b> en payant pour une p√©riode de six mois, vous pouvez commander <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 Go DDR4 6x480 Go SSD 1 Gbps 100 TV √† partir de 249 $</a> aux Pays-Bas et aux √âtats-Unis!</b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430936/">https://habr.com/ru/post/fr430936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430926/index.html">Le temps est fragment√©; un peu sur la similitude des syst√®mes distribu√©s et un mod√®le de m√©moire faible</a></li>
<li><a href="../fr430928/index.html">√Ä propos de la "maison intelligente": comment cr√©er un r√©tro-√©clairage "intelligent"</a></li>
<li><a href="../fr430930/index.html">√Ä propos des graphiques 3D en mots simples</a></li>
<li><a href="../fr430932/index.html">Les pirates ont vol√© plus de 21 millions de roubles d'une banque russe</a></li>
<li><a href="../fr430934/index.html">G√©n√©rateur de masque d'extension de plan de num√©rotation Asterisk</a></li>
<li><a href="../fr430938/index.html">Comment obtenir les premi√®res commandes en conception lorsqu'il n'y a pas de portefeuille et d'exp√©rience</a></li>
<li><a href="../fr430940/index.html">SDK pour vous, SDK pour moi, SDK pour tout le monde! Comment cr√©er un SDK et pourquoi est-il n√©cessaire</a></li>
<li><a href="../fr430942/index.html">Julia. Scripts et analyse des arguments de ligne de commande</a></li>
<li><a href="../fr430944/index.html">La NASA a choisi les participants pour sa comp√©tition de mini-moon rover</a></li>
<li><a href="../fr430948/index.html">Le minist√®re des Communications propose de renforcer le contr√¥le des donn√©es personnelles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>