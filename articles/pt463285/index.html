<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèîÔ∏è ‚ù§Ô∏è üõÄüèº ShIoTiny: n√≥s, links e eventos ou recursos de programas de desenho ‚ôêÔ∏è üë®üèæ‚ÄçüöÄ üë©üèº‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pontos principais ou sobre o que √© este artigo 
 O t√≥pico do artigo √© a programa√ß√£o visual do ShIoTiny PLC para a casa inteligente descrita aqui: ShIo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny: n√≥s, links e eventos ou recursos de programas de desenho</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463285/"><img src="https://habrastorage.org/webt/s3/ym/wy/s3ymwykg-no-z12-gk5znf02hrs.jpeg"><br><br><h4>  Pontos principais ou sobre o que √© este artigo </h4><br>  O t√≥pico do artigo √© a programa√ß√£o visual do <b>ShIoTiny</b> PLC para a casa inteligente descrita aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: automa√ß√£o pequena, Internet das coisas ou "seis meses antes das f√©rias"</a> . <br><br>  Conceitos como <b>n√≥s</b> , <b>comunica√ß√µes</b> , <b>eventos</b> , bem como recursos para carregar e executar um programa visual no <b>ESP8266</b> , que √© a base do <b>ShIoTiny</b> PLC, s√£o <b>revisados ‚Äã‚Äãmuito brevemente</b> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Site do</b> Projeto <b>ShIoTiny</b></a> <br><br><a name="habracut"></a><br><h4>  Introdu√ß√£o ou algumas perguntas organizacionais </h4><br>  Em um artigo anterior sobre o meu desenvolvimento, dei uma breve vis√£o geral dos recursos do controlador <b>ShIoTiny</b> . <br><br>  Curiosamente, o p√∫blico mostrou um interesse bastante forte e me fez muitas perguntas.  Alguns camaradas me ofereceram imediatamente para comprar um controle.  N√£o, n√£o me oponho a ganhar um pouco de dinheiro, mas minha consci√™ncia n√£o me permite vender uma coisa que ainda √© muito grosseira em termos de software. <br><br>  Portanto, publiquei nos bin√°rios de firmware do GitHub e no diagrama do dispositivo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">firmware + instru√ß√£o mais curta + circuito + exemplos</a> . <br><br>  Agora todos podem piscar o ESP-07 e jogar com o firmware por conta pr√≥pria.  Se algu√©m realmente quer apenas um quadro como na foto, ent√£o eu tenho v√°rios deles.  Escreva para <b>shiotiny@yandex.ru</b> .  Mas, como costumavam dizer os inesquec√≠veis pepinos: "Eu n√£o sou respons√°vel por nada!" <br><br>  Ent√£o, vamos direto ao ponto: o que √© um " <b>n√≥</b> " (n√≥) e " <b>evento</b> "?  Como o programa √© executado? <br><br>  Como sempre - vamos come√ßar em ordem: baixando o programa. <br><br><h4>  Como o programa carrega </h4><br>  Para come√ßar, o que acontece quando clicamos no bot√£o <b>Upload</b> no editor <b>ElDraw</b> e nosso esquema de programa, composto de quadrados bonitos, voa para o dispositivo. <br><br>  Primeiramente, com base no diagrama desenhado por n√≥s, sua descri√ß√£o em forma de texto √© constru√≠da. <br>  Em segundo lugar, √© verificado se todas as entradas dos n√≥s est√£o conectadas √†s sa√≠das.  N√£o deve haver entradas "penduradas".  Se uma entrada desse tipo for detectada, o circuito no ShIoTiny n√£o ser√° carregado e o editor exibir√° um aviso. <br><br>  Se tudo der certo, o editor envia uma descri√ß√£o em texto do circuito para um n√≥ no ShIoTiny.  Obviamente, o esquema existente do ShIoTiny foi removido anteriormente.  A descri√ß√£o do texto resultante √© salva na mem√≥ria FLASH. <br><br>  A prop√≥sito, se voc√™ deseja remover o circuito do dispositivo, basta carregar um circuito vazio (que n√£o cont√©m nenhum elemento do n√≥) nele. <br><br>  Assim que todo o circuito do programa √© carregado no PLC ShIoTiny, ele come√ßa a "funcionar".  O que isso significa? <br><br>  Observe que os processos de carregamento do circuito da mem√≥ria FLASH quando a energia √© ligada e quando o circuito √© recebido do editor s√£o id√™nticos. <br><br>  Primeiro, a cria√ß√£o dos objetos do n√≥ com base em sua descri√ß√£o. <br>  Em seguida, √© feita a organiza√ß√£o das conex√µes entre os n√≥s.  Ou seja, s√£o gerados links de sa√≠das para entradas e entradas para sa√≠das. <br><br>  E somente depois de tudo isso, o ciclo principal de execu√ß√£o do programa √© iniciado. <br><br>  Escrevi por um longo tempo, mas todo o processo - de "carregar" o circuito da mem√≥ria FLASH at√© o in√≠cio do loop principal - leva uma fra√ß√£o de segundo para um circuito de 60 a 80 n√≥s. <br><br>  Como funciona o loop principal?  Muito simples  Primeiro, ele espera que o <b>evento ocorra</b> em qualquer n√≥ e depois processa esse evento.  E assim sem fim.  Bem, ou at√© que eles enviem um novo esquema para o ShIoTiny. <br><br>  J√° v√°rias vezes mencionei coisas como <b>eventos</b> , <b>n√≥s</b> e <b>conex√µes</b> .  Mas o que √© isso do ponto de vista do software?  Vamos falar sobre isso hoje. <br><br><h4>  N√≥s, conex√µes e eventos </h4><br>  Veja os exemplos de programas de circuito do <b>ShIoTiny</b> para entender que um circuito consiste em apenas duas entidades - n√≥s (ou elementos) e os relacionamentos entre eles. <br><br>  <b>Um n√≥</b> , <b>n√≥</b> ou <b>elemento do circuito</b> √© uma representa√ß√£o virtual de alguma <b>a√ß√£o</b> nos dados.  Pode ser uma opera√ß√£o aritm√©tica, uma opera√ß√£o l√≥gica ou qualquer opera√ß√£o que nos ocorra.  O principal √© que o n√≥ tenha uma entrada e uma sa√≠da. <br><br>  <b>Uma entrada</b> √© onde o n√≥ recebe dados.  Imagens de entrada s√£o pontos que est√£o sempre no lado esquerdo do n√≥. <br><br>  <b>A sa√≠da</b> √© o local de onde o resultado da opera√ß√£o do n√≥ √© extra√≠do.  Imagens de sa√≠da s√£o pontos que est√£o sempre no lado direito do n√≥. <br><br>  Alguns n√≥s n√£o t√™m entradas.  Esses n√≥s geram um resultado dentro de si.  Por exemplo, um n√≥ constante ou um sensor: eles n√£o precisam de dados de outros n√≥s para relatar o resultado. <br><br>  Outros n√≥s, por outro lado, n√£o t√™m sa√≠das.  Estes s√£o os n√≥s que exibem, por exemplo, atuadores (rel√©s ou outros dispositivos similares).  Eles aceitam dados, mas n√£o geram o resultado de c√°lculos dispon√≠veis para outros n√≥s. <br><br>  Al√©m disso, tamb√©m h√° um n√≥ de coment√°rio exclusivo.  Ele n√£o faz nada, n√£o tem entradas nem sa√≠das.  Seu objetivo √© ser uma explica√ß√£o no diagrama. <br><br>  O que √© um " <b>evento</b> "?  <b>Um evento</b> √© a ocorr√™ncia de novos dados em um n√≥.  Por exemplo, os eventos incluem: altera√ß√£o do estado de entrada (n√≥ de <b>entrada</b> ), recebimento de dados de outro dispositivo (n√≥s <b>MQTT</b> e <b>UDP</b> ), expira√ß√£o de um per√≠odo especificado (n√≥s <b>Timer</b> e <b>Delay</b> ) e assim por diante. <br><br>  Para que servem os eventos?  Sim, para determinar em qual n√≥ os novos dados apareceram e os estados de quais n√≥s precisam ser alterados em conex√£o com o recebimento de novos dados.  O evento, por assim dizer, "passa" ao longo da cadeia de n√≥s at√© ultrapassar todos os n√≥s cujo estado deve ser verificado e alterado. <br><br>  Todos os n√≥s podem ser divididos em duas categorias. <br>  Os n√≥s que podem gerar eventos s√£o chamados de " <b>n√≥s ativos</b> ". <br>  Os n√≥s que n√£o podem gerar eventos s√£o chamados de " <b>n√≥s passivos</b> ". <br><br>  Quando um n√≥ gera um evento (ou seja, novos dados aparecem em sua sa√≠da), em geral, o estado de toda a cadeia de n√≥s conectados √† sa√≠da do n√≥ do gerador de eventos √© alterado. <br><br>  Para deixar claro, considere o exemplo na figura. <br><br><img src="https://habrastorage.org/webt/mi/vd/kz/mivdkz3cx_wvzdhnd4fflb9t1xu.png"><br><br>  Os n√≥s ativos aqui s√£o Entrada1, Entrada2 e Entrada3.  Os n√≥s restantes s√£o passivos.  Considere o que acontece quando essa ou aquela entrada √© fechada.  Por conveni√™ncia, os resultados s√£o tabulados. <br><br><img src="https://habrastorage.org/webt/er/eh/wn/erehwn5_nqschmn03cnblvlbdbk.jpeg"><br><br>  Como voc√™ pode ver, quando um evento ocorre, uma cadeia √© constru√≠da do n√≥ de origem do evento para o n√≥ final.  O estado desses n√≥s que n√£o se enquadram na cadeia n√£o muda. <br><br>  Uma pergunta leg√≠tima surge, mas o que acontecer√° se dois ou at√© v√°rios eventos ocorrerem simultaneamente? <br><br>  Como amante do trabalho de Gleb Anfilov, sou tentado a enviar um curioso questionador ao seu livro "Flight from Surprise".  Essa √© uma "teoria da relatividade para o menor", na qual se sabe bem o que √© "simultaneamente" e como conviver com ela. <br><br>  Mas puramente quase tudo √© muito mais simples: quando dois ou mesmo v√°rios eventos ocorrem, todas as cadeias de cada fonte de eventos s√£o sequencialmente constru√≠das e processadas sucessivamente, sem milagres. <br><br>  A pr√≥xima pergunta bastante leg√≠tima de um leitor curioso √© o que acontecer√° se os n√≥s estiverem conectados em um anel?  Ou, como √© costume dizer entre seus s√°bios, introduzir feedback.  Ou seja, conecte a sa√≠da de um dos n√≥s √† entrada do n√≥ anterior para que o estado de sa√≠da desse n√≥ afete o estado de sua entrada.  <b>O</b> editor <b>ElDraw</b> n√£o permitir√° que voc√™ conecte diretamente a sa√≠da do n√≥ √† sua pr√≥pria entrada.  Mas indiretamente, como na figura abaixo - isso pode ser feito. <br><br>  Ent√£o, o que ser√° neste caso?  A resposta ser√° muito "definida": dependendo de quais n√≥s.  Considere o exemplo na figura. <br><br><img src="https://habrastorage.org/webt/ta/rr/wd/tarrwdvrk01cizkl5xg9x4ilfym.png"><br><br>  Quando os contatos da entrada Input1 est√£o abertos na entrada superior do n√≥ A - 0. Na sa√≠da do n√≥ A, tamb√©m 0. Na sa√≠da do n√≥ B - 1. E, finalmente, na entrada inferior do n√≥ A - 1. Tudo est√° claro.  E para quem n√£o est√° claro - procure abaixo uma descri√ß√£o de como os n√≥s "AND" e "NOT" funcionam. <br><br>  Agora feche os contatos da entrada Input1, ou seja, forneceremos um √† entrada superior do n√≥ A.  Quem conhece a eletr√¥nica sabe que, na verdade, temos um circuito gerador de l√≥gica cl√°ssica.  E, em teoria, esse esquema deve produzir infinitamente na sa√≠da dos elementos A e B as seq√º√™ncias 1-0-1-0-1-0.  e 0-1-0-1-0-1-1 ....  Afinal, um evento deve mudar constantemente o estado dos n√≥s A e B, executando um c√≠rculo 2-3-2-3- ...! <br><br>  Mas isso realmente n√£o acontece.  O circuito entrar√° em um estado aleat√≥rio - ou o rel√© permanecer√° ligado ou desligado, ou poder√° tocar levemente e desligar v√°rias vezes seguidas.  Tudo depende do clima no p√≥lo sul de Marte.  E √© por isso que isso acontece. <br><br>  Um evento do n√≥ Input1 altera o estado do n√≥ A, depois o n√≥ B e assim por diante em um c√≠rculo v√°rias vezes.  O programa determina o "looping" do evento e termina for√ßosamente este carnaval.  Depois disso, as altera√ß√µes de estado dos n√≥s A e B s√£o bloqueadas at√© que um novo evento ocorra.  O momento em que o programa decide - "pare de girar em c√≠rculo!"  - no caso geral, depende de muitos fatores e pode ser considerado aleat√≥rio. <br><blockquote>  Cuidado ao conectar n√≥s em um anel - os efeitos nem sempre ser√£o √≥bvios!  Bem, imagine o que e por que voc√™ est√° fazendo! </blockquote>  Mas √© poss√≠vel construir um gerador nos n√≥s acess√≠veis a n√≥s?  Sim voc√™ pode!  Mas isso requer um n√≥ que saiba gerar eventos.  E existe esse n√≥ - essa √© uma "linha de atraso".  Vamos ver como o gerador funciona com um per√≠odo de 6 segundos na figura abaixo. <br><br><img src="https://habrastorage.org/webt/xy/ng/xc/xyngxczc6i7ryhc2ssrygfdtcwy.png"><br><br>  Um elemento chave do gerador √© o n√≥ A, a linha de atraso.  Se voc√™ alterar o estado de entrada da linha de atraso de 0 para 1, 1 na sa√≠da n√£o aparecer√° imediatamente, mas somente ap√≥s um tempo especificado.  No nosso caso, s√£o 3 segundos.  Da mesma forma, se voc√™ alterar o estado de entrada da linha de atraso de 1 para 0, 0 aparecer√° na sa√≠da ap√≥s os mesmos 3 segundos.  O tempo de atraso √© definido em d√©cimos de segundo.  Ou seja, o valor √© 30 e significa - 3 segundos. <br><br>  Uma caracter√≠stica da linha de atraso √© que ela gera um evento ap√≥s o tempo de atraso. <br><br>  Suponha que inicialmente a sa√≠da da linha de atraso fosse 0. Ap√≥s passar pelo n√≥ B, o inversor, este 0 se transforma em 1 e vai para a entrada da linha de atraso.  Nada acontece imediatamente.  Na sa√≠da da linha de atraso, por assim dizer, 0 permanecer√°, mas a contagem regressiva do tempo de atraso ser√° ativada.  Demora 3 segundos.  E ent√£o a linha de atraso gera um evento.  Na sa√≠da, ela possui 1. Esta unidade, depois de passar pelo n√≥ B, o inversor, se transforma em 0 e vai para a entrada da linha de atraso.  Mais 3 segundos se passam ... e o processo se repete.  Ou seja, a cada 3 segundos o estado de sa√≠da da linha de atraso muda de 0 para 1 e depois de 1 para 0. O rel√© clica.  O gerador est√° funcionando.  O per√≠odo de pulso √© de 6 segundos (3 segundos na sa√≠da de zero e 3 segundos - um). <br><br>  Mas, em circuitos reais, voc√™ geralmente n√£o precisa usar este exemplo.  Existem n√≥s de timer especiais que perfeitamente e sem ajuda externa geram uma sequ√™ncia de pulsos com um determinado per√≠odo.  A dura√ß√£o de "zero" e "unidades" nesses pulsos √© igual √† metade do per√≠odo. <br><blockquote>  Para definir a√ß√µes peri√≥dicas, use n√≥s de timer. </blockquote>  Observo que esses sinais digitais, onde a dura√ß√£o de "zero" e "unidades" s√£o iguais, s√£o chamados de "meandros". <br><br>  Espero ter esclarecido um pouco a quest√£o sobre como os eventos s√£o distribu√≠dos entre os n√≥s e o que n√£o deve ser feito. <br><br><h4>  Conclus√£o e refer√™ncias </h4><br>  O artigo acabou sendo curto, mas este √© a resposta para as perguntas levantadas em n√≥s e eventos. <br><br>  √Ä medida que o firmware evolui e novos exemplos aparecem, escreverei sobre como programar pequenos artigos <b>ShIoTiny</b> , desde que seja interessante para as pessoas. <br><br>  Como antes, o esquema, firmware, exemplos, descri√ß√£o de n√≥s e tudo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mais est√£o aqui</a> . <br><br>  Perguntas, desejos, cr√≠ticas - aqui est√°: <b>shiotiny@yandex.ru</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt463285/">https://habr.com/ru/post/pt463285/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt463273/index.html">Frontend Weekly Digest (5 a 11 de agosto de 2019)</a></li>
<li><a href="../pt463275/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 375 (5 a 11 de agosto de 2019)</a></li>
<li><a href="../pt463277/index.html">Tarefa para autodesenvolvimento: formul√°rio HTML com uma lista de sequ√™ncias aleat√≥rias e sele√ß√£o por elas</a></li>
<li><a href="../pt463279/index.html">PHP Digest No. 162 (1 a 12 de agosto de 2019)</a></li>
<li><a href="../pt463281/index.html">Por que existem poucas aplica√ß√µes inovadoras no Google Play ou por que √†s vezes a programa√ß√£o √© m√°gica</a></li>
<li><a href="../pt463289/index.html">Matem√°tica discreta para WMS: lotes de armazenamento em cluster</a></li>
<li><a href="../pt463291/index.html">Dados ou Ossos</a></li>
<li><a href="../pt463293/index.html">Coletor de Lixo. Curso completo + transfer√™ncia do BOTR</a></li>
<li><a href="../pt463295/index.html">C ++ e CMake - Brothers Forever, Parte II</a></li>
<li><a href="../pt463297/index.html">Lealdade ao seu gosto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>