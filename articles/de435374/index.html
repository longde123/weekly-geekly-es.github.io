<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ó üòô ü§∏üèº Mathe in Gamedev ist einfach. Triangulation und Triangle.Net in Unity üë©‚Äçüéì üêÄ ü¶ë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! Mein Name ist Grisha und ich bin der Gr√ºnder von CGDevs. Mathe ist ein sehr cooles Werkzeug bei der Entwicklung von Spielen. Wenn wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mathe in Gamedev ist einfach. Triangulation und Triangle.Net in Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435374/"> Hallo allerseits!  Mein Name ist Grisha und ich bin der Gr√ºnder von CGDevs.  Mathe ist ein sehr cooles Werkzeug bei der Entwicklung von Spielen.  Wenn wir jedoch sagen, dass es schwierig ist, ohne das Verst√§ndnis von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vektoren</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Matrizen auszukommen</a> , sind Triangulationsalgorithmen nicht so notwendig, aber mit ihnen wird eine ziemlich gro√üe Anzahl interessanter Probleme gel√∂st.  Heute m√∂chte ich √ºber ein ziemlich wichtiges Werkzeug in der Computergeometrie sprechen, wie Triangulationen und ihre Anwendung in der Spielebranche.  Au√üerdem habe ich einen Port und einige Wrapper f√ºr die hervorragende Triangle.Net-Bibliothek f√ºr Unity geschrieben.  Bei Interesse - willkommen bei cat.  Link zum Github beigef√ºgt. <br><br><img src="https://habrastorage.org/webt/4b/se/ny/4bsenyx2deo5lmmtgaubiqi5kwy.jpeg"><br><a name="habracut"></a><br><h3>  Was ist Triangulation? </h3><br>  Im allgemeinen Fall ist die <b>Triangulation</b> eine Aufteilung eines geometrischen Objekts in Dreiecke.  Dieses Konzept an sich ist recht einfach.  Ein grundlegendes Beispiel f√ºr Triangulation bei Spiel-Engines ist ein Netz.  Genau genommen kann ein Netz nicht nur aus Dreiecken bestehen, sondern in Spiel-Engines werden aus verschiedenen Gr√ºnden Netze aus Dreiecken genommen. <br><br><img src="https://habrastorage.org/webt/vm/zo/-o/vmzo-o4hsa5vx472qkg5nxqvxku.jpeg"><br><br>  Triangulationen sind unterschiedlich, aber eine der beliebtesten Arten von Triangulationen ist die <b>Delaunay-Triangulation.</b>  Diese Art der Triangulation zeichnet sich durch die Eigenschaft aus, dass in dem um jedes Dreieck umschriebenen Kreis nur die Eckpunkte dieses Dreiecks liegen. <br><br><img src="https://habrastorage.org/webt/nx/ss/pp/nxssppvieg3beuq6bqiazugvhn8.png"><br><br><h3>  Warum werden sie gebraucht? </h3><br>  Au√üerhalb der Spielebranche werden im Allgemeinen eine Vielzahl von Aufgaben mithilfe von Triangulationen gel√∂st.  In Game Dev ist die erste Aufgabe, die mir in den Sinn kommt, das Navigationsnetz.  Navmesh ist eine Datenstruktur, die bestimmt, wie viel Platz ein Spieler gehen kann.  Es vermeidet so komplexe Rechenaufgaben wie das Bestimmen von Kollisionen mit einem Teil der Umgebung. <br><br>  Das zweite interessante Problem, das mithilfe der Delaunay-Triangulation in der Spieleentwicklung gel√∂st werden kann, ist die Erzeugung von Terrains und Objekten, die als eine Reihe von Punkten dargestellt werden.  Der Hauptvorteil der Delaunay-Triangulation in diesem Fall besteht darin, dass Sie aufgrund ihrer Eigenschaften sehr scharfe Dreiecke vermeiden k√∂nnen, die st√∂ren und Artefakte auf dem Tirrain erzeugen. <br><br><img src="https://habrastorage.org/webt/78/yl/d1/78yld1jdecftxumbistwdmc-gaw.jpeg"><br><br>  Dar√ºber hinaus k√∂nnen Sie mithilfe der eingeschr√§nkten Delaunay-Triangulation und Algorithmen wie dem zweiten Algorithmus von Chew und dem Algorithmus von Ruppert noch bessere Netze f√ºr Tirrains und gute Netze f√ºr eine andere Anwendung erzeugen - die Finite-Elemente-Methode. <br><br>  Die Finite-Elemente-Methode selbst ist eine der Methoden, mit denen die Probleme der angewandten Physik gel√∂st werden.  In Gamedev k√∂nnen Sie viele Probleme l√∂sen, die mit der Simulation von Verformungen, Fl√ºssigkeitssimulationen und anderen speziellen Problemen verbunden sind.  Effekte.  Normalerweise f√ºr die Aufzeichnung von Effekten in Animationen, da die Methode f√ºr Echtzeit einen zu hohen Rechenaufwand aufweist.  Ein wichtiges Detail bei der Verwendung der Methode ist, dass der Fehler der Methode von den Winkeln der Dreiecke im Raster abh√§ngt.  Wenn das Gitter sehr scharfe Winkel enth√§lt, gibt die Methode einen gro√üen Fehler aus. Aus diesem Grund werden die oben aufgef√ºhrten Algorithmen ben√∂tigt. <br><br><img src="https://habrastorage.org/webt/jx/ei/x8/jxeix82aopn6q0hjsj3te1beb6u.png"><br><br>  Und nat√ºrlich im Allgemeinen die prozedurale Netzgenerierung.  Ein Github-Projekt zeigt beispielsweise eine Szene mit der F√§higkeit, Netze zu zeichnen.  Einige physikalische R√§tsel verwenden diese Anwendung als grundlegende Mechanik.  Dar√ºber hinaus erm√∂glichen Triangulationsalgorithmen die Verwendung der prozeduralen Generierung, um Probleme wie die prozedurale Zerst√∂rbarkeit usw. zu l√∂sen. <br><br>  Zus√§tzlich zu Gamedev werden Triangulationen in Netzwerken, Computer Vision, verschiedenen analytischen Algorithmen sowie bei Problemen der Rechengeometrie verwendet, z. B. beim Kombinieren und Entfernen von Polygonen (was h√§ufig bei Problemen bei der Entwicklung von Spielen hilfreich ist). <br><br><h3>  Ohrschneiden mit L√∂chern </h3><br><img src="https://habrastorage.org/webt/6p/5l/je/6p5ljenmksewgdzp12ini57va-w.png"><br><br>  Vielleicht einer der einfachsten Triangulationsalgorithmen.  Es ergibt nicht das beste Gitter und hat im schlimmsten Fall die gr√∂√üte Rechenkomplexit√§t O (n ^ 2). <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie k√∂nnen mehr dar√ºber in diesem Artikel lesen.</a> <br><br><h3>  Bowyer-Watson-Algorithmus </h3><br><img src="https://habrastorage.org/webt/pv/hy/hn/pvhyhn8ktwwigdkxfazttur14gi.jpeg"><br><br>  Ein Algorithmus, der eine Delaunay-Triangulation √ºber eine Reihe von Punkten generiert.  Wie bei den meisten Delaunay-Algorithmen betr√§gt die algorithmische Komplexit√§t bei korrekter Implementierung im Allgemeinen O (n log n), wobei n die Anzahl der Eckpunkte ist.  In einigen F√§llen kann jedoch O (n ^ 2) erforderlich sein. <br><br>  Die Nachteile beim Ohrschneiden bestehen darin, dass dieser Algorithmus eine konvexe Triangulation erstellt und in der Basisimplementierung keine L√∂cher im resultierenden Gitter enth√§lt. <br><br><h3>  Delaunay-Verfeinerungsverarbeitung </h3><br><img src="https://habrastorage.org/webt/va/hh/oo/vahhooegdpz-2vhs9b7e3qaesmi.gif"><br><br>  Der zweite Algorithmus von Chew und der Algorithmus von Ruppert sind Algorithmen, mit denen Sie Einschr√§nkungen in die Delaunay-Triangulation eingeben und den Mindestwinkel des Dreiecks im Raster festlegen k√∂nnen.  Ein wichtiges Detail der Algorithmen ist, dass sie in eine Endlosschleife gehen k√∂nnen und garantiert Ergebnisse bei Winkeln zwischen ungef√§hr 20,7 Grad und 29 Grad liefern.  Die F√§higkeit, einen minimalen Winkel einzustellen, ist wichtig f√ºr die L√∂sung der oben beschriebenen Probleme. <br><br>  Der zweite Algorithmus von Chew ist im kostenlosen Paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.cs.cmu.edu/~quake/triangle.html</a> und seinem Port auf .Net <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">archive.codeplex.com/?p=triangle</a> implementiert <br><br><h3>  Triangle.Net f√ºr die Einheit </h3><br>  Nun, da Sie mit Hilfe von Triangulationen so viele coole Aufgaben l√∂sen k√∂nnen, wollte ich in den Ferien meinen Wrapper f√ºr Unity implementieren, damit ich immer ein handliches Werkzeug zur Hand habe.  In dieser Implementierung arbeitet der Triangulationsalgorithmus im Durchschnitt f√ºr O (n) und im schlimmsten Fall f√ºr O (n * log n), wobei n die Anzahl der Eckpunkte ist.  Beim Testen auf 1kk-Scheitelpunkte, die zuf√§llig √ºber ein Quadrat verteilt sind, haben die Einheiten im Editor des Intel Core i7-8700 beispielsweise in durchschnittlich 7,56 Sekunden ein Raster erstellt. <br><br>  Die Hauptunterschiede zur urspr√ºnglichen Bibliothek in Bezug auf auf Unity zugeschnittene Erweiterungsmethoden sowie das Ersetzen von double durch float in der gesamten Bibliothek (+ einige spezifische Operatoren f√ºr das Casting) Double in der Einheit sind wenig sinnvoll.  Wenn wir physikalische Simulationen betrachten, w√ºrde ich eine separate Anwendung f√ºr eine Plus-Bibliothek verwenden, und das Ergebnis der Berechnungen gab Unity bereits nur zur Visualisierung.  Au√üerdem wurde der Mesh-Typ in TriangleNetMesh umbenannt, um nicht relativ zum Mesh von Unity herunterzufahren.  Ja, sie befinden sich bereits in einem anderen Namespace, aber ich denke, die Neuank√∂mmlinge w√§ren ein bisschen niedergeschlagen von der Tatsache, dass wir mit Hilfe eines Mesh ein anderes bekommen. <br><br>  Das Wesentliche der Bibliothek ist, dass Sie zuerst das sogenannte Polygon angeben m√ºssen.  Generieren Sie dann darauf basierend bereits das Netz.  Damit dies mit Einheitendatenstrukturen funktioniert, wurden verschiedene Erweiterungsmethoden eingef√ºhrt. <br><br><div class="spoiler">  <b class="spoiler_title">Anwendungsbeispiel</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMesh</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_CurrentState != MeshDrawerState.Nothing) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; Polygon poly = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Polygon(); poly.Add(_Contour); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hole <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _Holes) { poly.Add(hole, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> triangleNetMesh = (TriangleNetMesh) poly.Triangulate(); GameObject go = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameObject(<span class="hljs-string"><span class="hljs-string">"Generated mesh"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mf = go.AddComponent&lt;MeshFilter&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mesh = triangleNetMesh.GenerateUnityMesh(); mesh.uv = GenerateUv(mesh.vertices); mf.mesh = mesh; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mr = go.AddComponent&lt;MeshRenderer&gt;(); mr.sharedMaterial = _MeshMaterial; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collider = go.AddComponent&lt;PolygonCollider2D&gt;(); collider.points = _Contour.ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rb = go.AddComponent&lt;Rigidbody2D&gt;(); rb.mass = triangleNetMesh.Triangles.Sum(tris =&gt; tris.Area); Clear(); }</code> </pre> <br></div></div><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Zur Demonstration und Verwendung wurde eine spezielle Demoszene mit der M√∂glichkeit erstellt, Netze zu zeichnen.  Sie k√∂nnen es und den Port der Bibliothek im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github-Projekt kennenlernen.</a> <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit!  Ich hoffe, dass der Port und der Artikel f√ºr jemanden n√ºtzlich sind und ein wenig klarer wird, warum Triangulation und Kenntnisse der Mathematik als Ganzes erforderlich sind.  Ich werde weiterhin versuchen, Anwendungen und Methoden zur L√∂sung verschiedener mathematischer Probleme in der Spieleentwicklung offenzulegen.  In der Computergeometrie selbst gibt es noch viele interessante Dinge, aber au√üerdem gibt es noch viele andere interessante Abschnitte der h√∂heren Mathematik. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435374/">https://habr.com/ru/post/de435374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435360/index.html">Snippets vs Clover - Schlie√üe das beliebteste Echtzeit-Quiz ab</a></li>
<li><a href="../de435362/index.html">Geschwindigkeits-Hash</a></li>
<li><a href="../de435364/index.html">Anpassen der Abh√§ngigkeitsaufl√∂sung im Fr√ºhjahr</a></li>
<li><a href="../de435368/index.html">Pathologische Anatomie am Arbeitsplatz</a></li>
<li><a href="../de435372/index.html">Ein paar Worte zu FastPath und FastTrack bei MikroTik</a></li>
<li><a href="../de435376/index.html">Weltraum 2019: bemannte Schiffe, neue Raketen und Mondsonden</a></li>
<li><a href="../de435380/index.html">Kostenlose Konten auf GitHub k√∂nnen [fast] ohne Einschr√§nkungen mit privaten Repositories arbeiten</a></li>
<li><a href="../de435384/index.html">Wie ich mein Online-Spiel erstellt habe. Teil 1: Vernetzung</a></li>
<li><a href="../de435386/index.html">So teilen Sie Architektur und Implementierung ohne Streit</a></li>
<li><a href="../de435390/index.html">3D-Engine in SQL-Abfrage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>