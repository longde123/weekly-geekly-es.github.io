<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏺️ 📤 🧑🏾 Yandex推出RPKI 👩‍👩‍👦 🎺 😺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="嗨，我叫Alexander Azimov。 在Yandex，我正在开发各种监视系统以及传输网络体系结构。 但是今天我们将讨论BGP。 



 一周前，Yandex在与所有对等伙伴以及交通交换点的交界处包括ROV（路由起源验证）。 关于这样做的原因及其对电信运营商互动的影响，请阅读下文。 

 BG...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Yandex推出RPKI</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/467391/"> 嗨，我叫Alexander Azimov。 在Yandex，我正在开发各种监视系统以及传输网络体系结构。 但是今天我们将讨论BGP。 <br><br><img src="https://habrastorage.org/webt/se/fl/c6/seflc6gr46dhwzh_g-9ywy7ucb0.png"><br><br> 一周前，Yandex在与所有对等伙伴以及交通交换点的交界处包括ROV（路由起源验证）。 关于这样做的原因及其对电信运营商互动的影响，请阅读下文。 <br><br><a name="habracut"></a><h3>  BGP及其出了什么问题 </h3><br> 您可能知道BGP被认为是跨域路由协议。 但是，在此过程中，用户案例的数量设法增长：如今，由于众多扩展，BGP已变成一条消息总线，涵盖了从运营商的VPN到现在流行的SD-WAN的任务，甚至还被用作类似SDN的控制器的传输。距离矢量BGP进入类似于链接状态协议的协议。 <br><br><img src="https://habrastorage.org/webt/8j/zv/vm/8jzvvm3jevj3u8oc_f-oazc2vdc.png"><br><h5>  <sub>图</sub>  <sub>1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BGP SAFI</a></sub> </h5><br> 为什么BGP收到（并继续收到）这么多用途？ 主要有两个原因： <br><br><ul><li>  BGP是在自治系统（AS）之间起作用的唯一协议。 </li><li>  BGP支持TLV格式（type-length-value）的属性。 是的，协议并不是唯一的协议，但是由于在电信运营商之间并没有什么可以替代的协议，因此将更多的功能元素附加到协议上总是比支持附加的路由协议更有利可图。 </li></ul><br> 他怎么了 简而言之，该协议缺乏用于验证接收到的信息的正确性的内置机制。 也就是说，BGP是先验信任的协议：如果您想告诉世界，您现在拥有Rostelecom，MTS或Yandex网络，请！ <br><br><h3>  IRRDB筛选器-最坏的选择 </h3><br> 问题来了-为什么Internet在这种情况下仍能正常工作？ 是的，它在大多数时间都有效，但是它会定期爆炸，使整个国家/地区无法进入。 尽管BGP中的黑客攻击活动也在增长，但大多数异常仍然是由于错误而发生的。 今年的一个例子是白俄罗斯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的一家小型运营商</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">错误，该运营商</a>在半小时内使MegaFon用户无法访问互联网的很大一部分。 另一个例子-被<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">激怒的BGP优化器</a>破坏了世界上最大的CDN网络之一。 <br><br><img src="https://habrastorage.org/webt/mw/0y/lo/mw0yloyk-a3m8j3dzod7acrqx6q.png" width="600"><br><h5>  <sub>图</sub>  <sub>2. Cloudflare流量拦截</sub> </h5><br> 但是，为什么这种异常每六个月而不是每天发生一次？ 因为电信运营商使用外部路由信息数据库来验证邻居从BGP得到的信息。 有许多这样的数据库，其中一些由注册服务商（RIPE，APNIC，ARIN，AFRINIC）管理，一些是独立参与者（最著名的是RADB），还有大公司拥有的全套注册服务商（Level3，NTT等）。 由于有了这些数据库，跨域路由可以保持其工作的相对稳定性。 <br><br> 但是，有细微差别。 路由信息基于ROUTE-OBJECTS和AS-SET对象进行验证。 而且，如果前者暗示对IRRDB的授权，则第二类的授权将不存在。 也就是说，任何人都可以将任何人添加到他们的集合中，从而绕过高级供应商的筛选器。 而且，不能保证不同IRR基之间的AS-SET命名的唯一性，这会导致惊人的效果，并导致电信运营商之间的连接突然中断，而这本身并没有改变。 <br><br> 另一个问题是AS-SET使用模型。 有两点： <br><br><ul><li> 当操作员拥有新客户时，他会将其添加到AS-SET中，但几乎从不删除它； </li><li> 过滤器本身仅在与客户端的连接处配置。 </li></ul><br> 结果，现代的BGP过滤器格式正在逐步降低与客户的接口处的过滤器的性能，并逐渐信任对等合作伙伴和IP传输提供商的服务。 <br><br> 什么是替换基于AS-SET的前缀过滤器？ 最有趣的是短期内-什么都没有。 但是，还有其他机制可以补充基于IRRDB的过滤器的操作，首先当然是RPKI。 <br><br><h3>  RPKI </h3><br> 简化后，您可以将RPKI体系结构想象成一个分布式数据库，其记录可以通过密码验证。 对于ROA（路由对象授权），地址空间的所有者是签名者，而记录本身是三元组（前缀，asn，max_length）。 实际上，此条目假设以下内容-地址空间$前缀的所有者允许编号为$ asn的AS声明长度不超过$ max_length的前缀。 使用RPKI高速缓存的路由器能够<i>在旅途中</i>检查是否有一对<i>前缀优先的扬声器</i> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pc/ir/5f/pcir5ftpb07o2prtpop5mdtdae4.png" width="600"></div><br><h5>  <sub>图3. RPKI体系结构</sub> </h5><br>  ROA对象已经标准化很长时间了，但是直到最近，实际上，它仅保留在IETF期刊的纸上。 我认为，这样做的原因听起来很可怕-行销不良。 标准化完成后，有人认为ROA可以防止BGP劫持是一种诱因-事实并非如此。 攻击者可以通过在路径的开头插入正确的扬声器编号来轻松绕过ROA过滤器。 一旦意识到这一点，接下来的逻辑步骤就是拒绝使用ROA。 真的，如果技术不起作用，为什么我们需要技术？ <br><br> 为什么现在该改变主意了？ 因为这不是全部事实。  ROA不能防止BGP中的黑客活动，但<b>可以防止意外的流量劫持</b> ，例如防止BGP中的静态泄漏（这种情况越来越普遍）。 此外，与基于IRR的过滤器不同，ROV不仅可以用于与客户的接口，还可以用于与对等方和更高供应商的接口。 即，随着RPKI的引入，BGP逐渐留下了先验的信心。 <br><br> 现在，主要参与者逐渐引入了基于ROA的路由检查：欧洲最大的IX已经在丢弃不正确的路由，在1级运营商中，值得强调的是AT＆T，后者在与对等合作伙伴的交界处启用了过滤器。 同样，最大的内容提供者也适用于外壳。 数十家中型公交运营商已经悄悄实施了该计划，而没有告诉任何人。 为什么所有这些运营商都在实施RPKI？ 答案很简单：保护您的传出流量免遭其他人的错误。 因此，Yandex是俄罗斯联邦首批在其网络边界添加ROV的国家之一。 <br><br><h3> 接下来会发生什么？ </h3><br> 现在，我们已经包括在与流量交换点和专用对等点的路口处检查路由信息。 在不久的将来，验证还将包含在上游流量提供商中。 <br><br><img src="https://habrastorage.org/webt/wm/kt/8c/wmkt8cnykp91dxaote-qw6ko9vu.png"><br><br> 这对您有什么变化？ 如果要提高网络与Yandex之间的流量路由的安全性，我们建议： <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在RIPE门户中</a>签署地址空间很容易，平均需要5到10分钟。 如果有人不由自主地劫持了您的地址空间，这将保护我们的连通性（这种情况迟早会发生）； </li><li> 将一个开源RPKI缓存（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">成熟验证器</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">routinator</a> ）放在网络边界并启用路由检查将花费更多时间，但不会再次造成技术困难。 </li></ul><br>  Yandex还支持基于新的RPKI对象<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ASPA</a> （自治系统提供者授权）的过滤系统的开发。 基于ASPA和ROA对象的过滤器不仅可以替换“泄漏的” AS-SET，还可以使用BGP关闭MiTM攻击。 <br><br> 我将在下一跳会议上一个月内详细讨论ASPA。 还将有来自Netflix，Facebook，Dropbox，Juniper，Mellanox和Yandex的同事。 如果您对网络堆栈及其将来的发展感兴趣，可以进行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">注册</a> 。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN467391/">https://habr.com/ru/post/zh-CN467391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN467381/index.html">多层LED，智能灯和灯泡，价格为18卢布</a></li>
<li><a href="../zh-CN467383/index.html">“经理需要保持编码”：采访Stephen Chin</a></li>
<li><a href="../zh-CN467385/index.html">Java开发人员访谈中精选的心理和非典型技术问题</a></li>
<li><a href="../zh-CN467387/index.html">提供反馈和客户体验的解决方案：从小型服务到重型平台</a></li>
<li><a href="../zh-CN467389/index.html">Pinterest分片：我们如何扩展MySQL公园</a></li>
<li><a href="../zh-CN467393/index.html">NX Bootcamp将于10月启动</a></li>
<li><a href="../zh-CN467395/index.html">《哈勃周刊》第18期/新的Apple小工具，全模块化智能手机，白俄罗斯的程序员之乡，XY现象</a></li>
<li><a href="../zh-CN467399/index.html">您不能禁止携带：如何实施BYOD概念且不损害信息安全</a></li>
<li><a href="../zh-CN467401/index.html">特斯拉Model S和保时捷Taycan的比较</a></li>
<li><a href="../zh-CN467403/index.html">您可以和不能从Web组件中挤出的内容</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>