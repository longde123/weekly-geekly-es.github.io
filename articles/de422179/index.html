<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíâ ü¶à ü•ö Von den Wolken zur Erde: So erstellen Sie Kubernetes in Produktionsqualit√§t in jeder Umgebung ü§≠ ü§¥ üåµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gut zu allen! Nun, es ist Zeit f√ºr unseren n√§chsten Devops-Kurs . Wahrscheinlich ist dies einer der stabilsten und Referenzkurse, aber gleichzeitig de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Von den Wolken zur Erde: So erstellen Sie Kubernetes in Produktionsqualit√§t in jeder Umgebung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/422179/">  Gut zu allen!  Nun, es ist Zeit f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unseren</a> n√§chsten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Devops-Kurs</a> .  Wahrscheinlich ist dies einer der stabilsten und Referenzkurse, aber gleichzeitig der vielf√§ltigste in Bezug auf Studenten, da keine Gruppe jemals so ausgesehen hat wie die andere: In einem sind die Entwickler fast vollst√§ndig, dann in den n√§chsten Ingenieuren, dann in den Administratoren und so weiter.  Dies bedeutet auch, dass die Zeit f√ºr interessante und n√ºtzliche Materialien sowie f√ºr Online-Meetings gekommen ist. <br><br><img src="https://habrastorage.org/webt/v-/xe/oi/v-xeoia0xxkvb6vuzmclcvknrys.png" alt="Bild"><a name="habracut"></a><br><br>  Dieser Artikel enth√§lt Empfehlungen zum Starten eines Kubernetes-Clusters in Produktionsqualit√§t in einem lokalen Rechenzentrum oder einem peripheren Standort (Edge-Standort). <br>  Was bedeutet Produktionsqualit√§t? <br><br><ul><li>  Sichere Installation </li><li>  Das Bereitstellungsmanagement wird mithilfe eines sich wiederholenden und aufgezeichneten Prozesses durchgef√ºhrt. </li><li>  Die Arbeit ist vorhersehbar und konsequent; </li><li>  Es ist sicher, Aktualisierungen und Optimierungen durchzuf√ºhren. </li><li>  Um Fehler und Ressourcenmangel zu erkennen und zu diagnostizieren, werden Protokolle erstellt und √ºberwacht. </li><li>  Der Dienst verf√ºgt √ºber eine ausreichende ‚ÄûHochverf√ºgbarkeit‚Äú unter Ber√ºcksichtigung der verf√ºgbaren Ressourcen, einschlie√ülich Einschr√§nkungen in Bezug auf Geld, physischen Speicherplatz, Stromversorgung usw. </li><li>  Der Wiederherstellungsprozess ist verf√ºgbar, dokumentiert und wird f√ºr den Fall eines Fehlers getestet. </li></ul><br>  Kurz gesagt bedeutet Produktionsqualit√§t, Fehler zu antizipieren und die Wiederherstellung mit einem Minimum an Problemen und Verz√∂gerungen vorzubereiten. <br><br><img src="https://habrastorage.org/webt/ji/b8/je/jib8jeiekbsaflpgjsteescumgg.png"><br><br>  In diesem Artikel geht es um die On-Premise-Bereitstellung von Kubernetes auf einem Hypervisor oder einer Bare-Metal-Plattform, da im Vergleich zur Zunahme der gro√üen √∂ffentlichen Clouds nur begrenzte Supportressourcen zur Verf√ºgung stehen.  Einige dieser Empfehlungen k√∂nnen jedoch f√ºr die √∂ffentliche Cloud n√ºtzlich sein, wenn das Budget die ausgew√§hlten Ressourcen begrenzt. <br><br>  Die Bereitstellung eines Single-Bare-Metal-Bare-Metal-Minikubes kann ein einfacher und kosteng√ºnstiger Prozess sein, ist jedoch nicht f√ºr die Produktion geeignet.  Umgekehrt k√∂nnen Sie mit Borg in einem Offline-Gesch√§ft, einer Filiale oder einem peripheren Standort nicht das Niveau von Google erreichen, obwohl es unwahrscheinlich ist, dass Sie es ben√∂tigen. <br><br>  Dieser Artikel beschreibt Tipps zum Erreichen einer Kubernetes-Bereitstellung auf Produktionsebene, selbst in Situationen mit begrenzten Ressourcen. <br><br>  <b>Wichtige Komponenten im Kubernetes-Cluster</b> <br><br>  Bevor Sie sich mit den Details befassen, ist es wichtig, die Gesamtarchitektur von Kubernetes zu verstehen. <br>  Der Kubernetes-Cluster ist ein stark verteiltes System, das auf der Steuerebene und der Architektur der Cluster-Worker-Knoten basiert (siehe unten): <br><br><img src="https://habrastorage.org/webt/_9/zu/xd/_9zuxdnulbsg6axshrcnxah2x_o.png"><br><br>  In der Regel befinden sich die Komponenten des API-Servers, des Controller-Managers und des Schedulers in mehreren Instanzen von Knoten auf Steuerungsebene (als Master bezeichnet).  Masterknoten enthalten normalerweise auch etcd. Es gibt jedoch gro√üe und leicht zug√§ngliche Skripte, bei denen etcd auf unabh√§ngigen Hosts ausgef√ºhrt werden muss.  Komponenten k√∂nnen als Container ausgef√ºhrt werden und optional unter der Aufsicht von Kubernetes als statische Herde eingesetzt werden. <br><br>  Redundante Instanzen dieser Komponenten werden f√ºr eine hohe Verf√ºgbarkeit verwendet.  Die Bedeutung und der erforderliche Redundanzgrad k√∂nnen variieren. <br><table><tbody><tr><th>  <nobr>Komponente</nobr> </th><th>  Rollen </th><th>  Folgen des Verlustes </th><th>  Empfohlene Instanzen </th></tr><tr><td>  etcd </td><td>  Beh√§lt den Status aller Kubernetes-Objekte bei </td><td>  Katastrophaler Speicherverlust.  Verlust der meisten = Kubernetes verliert die Kontrollebene, API-Server h√§ngt von etcd ab, schreibgesch√ºtzte API-Aufrufe, die kein Quorum ben√∂tigen, wie bereits erstellte Workloads, k√∂nnen weiterhin funktionieren. </td><td>  ungerade Zahl, 3+ </td></tr><tr><td>  API-Server </td><td>  Bietet API f√ºr den externen und internen Gebrauch </td><td>  Neue Pods k√∂nnen nicht gestoppt, gestartet und aktualisiert werden.  Scheduler und Controller Manager sind API Server-abh√§ngig.  Das Laden wird fortgesetzt, wenn sie nicht von API-Aufrufen abh√§ngig sind (Operatoren, benutzerdefinierte Controller, CRD usw.). </td><td>  2+ </td></tr><tr><td>  kube-scheduler </td><td>  Platziert Pods auf Knoten </td><td>  Pods k√∂nnen nicht zwischen ihnen platziert, priorisiert oder verschoben werden. </td><td>  2+ </td></tr><tr><td>  kube-controller-manager </td><td>  Steuert viele Controller </td><td>  Die f√ºr den Zustand verantwortlichen Hauptregelkreise funktionieren nicht mehr.  Die In-Tree-Integration des Cloud-Anbieters bricht ab. </td><td>  2+ </td></tr><tr><td>  Cloud-Controller-Manager (CCM) </td><td>  Integration von Cloud-Anbietern au√üerhalb des Baums </td><td>  Die Integration des Cloud-Anbieters bricht ab </td><td>  1 </td></tr><tr><td>  Erg√§nzungen (z. B. DNS) </td><td>  Anders </td><td>  Anders </td><td>  H√§ngt vom Add-On ab (z. B. 2+ f√ºr DNS) </td></tr></tbody></table><br>  Zu den Risiken dieser Komponenten z√§hlen Hardwarefehler, Softwarefehler, fehlerhafte Updates, menschliche Fehler, Netzwerkunterbrechungen und System√ºberlastung, die zu einer Ersch√∂pfung der Ressourcen f√ºhren.  Redundanz kann die Auswirkungen dieser Gefahren verringern.  Dank der Funktionen der Hypervisor-Plattform (Ressourcenplanung, Hochverf√ºgbarkeit) k√∂nnen Sie die Ergebnisse au√üerdem mit dem Linux-Betriebssystem, Kubernetes und der Container-Laufzeit multiplizieren. <br><br>  Der API-Server verwendet mehrere Load-Balancer-Instanzen, um Skalierbarkeit und Verf√ºgbarkeit zu erreichen.  Ein Load Balancer ist eine wesentliche Komponente f√ºr eine hohe Verf√ºgbarkeit.  In Abwesenheit eines Balancers k√∂nnen mehrere A-Eintr√§ge des DNS-API-Servers als Alternative dienen. <br><br>  kube-scheduler und kube-controller-manager sind an der Auswahl eines Leiters beteiligt, anstatt einen Load Balancer zu verwenden.  Da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud-Controller-Manager</a> f√ºr bestimmte Arten von Hosting-Infrastrukturen verwendet wird, deren Implementierung variieren kann, werden wir sie nicht diskutieren - wir geben nur an, dass sie Bestandteil der Managementebene sind. <br><br>  Auf Kubernetes ausgef√ºhrte Pods werden vom Kubelet-Agenten verwaltet.  Jede Instanz des Workers f√ºhrt einen Kubelet-Agenten und eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CRI-</a> kompatible Container- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Startumgebung aus</a> .  Kubernetes selbst wurde entwickelt, um Worker-Node-Fehler zu √ºberwachen und zu beheben.  F√ºr kritische Ladefunktionen, Hypervisor-Ressourcenmanagement und Lastisolation kann es jedoch verwendet werden, um die Zug√§nglichkeit zu verbessern und die Vorhersagbarkeit ihrer Arbeit zu verbessern. <br><br>  <b>etcd</b> <br><br>  etcd ist ein dauerhafter Speicher f√ºr alle Kubernetes-Objekte.  Die Verf√ºgbarkeit und Wiederherstellbarkeit des etcd-Clusters sollte bei der Bereitstellung von Kubernetes in Produktionsqualit√§t oberste Priorit√§t haben. <br><br>  Ein aus f√ºnf Knoten bestehender etcd-Cluster ist die beste Option, wenn Sie dies zulassen k√∂nnen.  Warum?  Weil Sie einen warten k√∂nnen und gleichzeitig einem Ausfall standhalten.  Ein Cluster von drei Knoten ist das Minimum, das wir f√ºr einen Service auf Produktionsebene empfehlen k√∂nnen, selbst wenn nur ein Host-Hypervisor verf√ºgbar ist.  Mehr als sieben Knoten werden ebenfalls nicht empfohlen, mit Ausnahme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sehr gro√üer Installationen,</a> die mehrere Zugriffszonen abdecken. <br><br>  Die Mindestempfehlungen f√ºr das Hosten eines etcd-Clusterknotens sind 2 GB RAM und eine 8 GB SSD-Festplatte.  In der Regel sind 8 GB RAM und 20 GB Festplattenspeicher ausreichend.  Die Festplattenleistung wirkt sich auf die Wiederherstellungszeit eines Knotens nach einem Fehler aus.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberpr√ºfen Sie</a> f√ºr Details. <br><br>  <i>Denken Sie in besonderen F√§llen an mehrere etcd-Cluster</i> <br><br>  Bei sehr gro√üen Kubernetes-Clustern sollten Sie einen separaten etcd-Cluster f√ºr Kubernetes-Ereignisse verwenden, damit zu viele Ereignisse den Kerndienst der Kubernetes-API nicht beeintr√§chtigen.  Bei Verwendung des Flanell-Netzwerks wird die Konfiguration in etcd gespeichert, und die Versionsanforderungen k√∂nnen von denen von Kubernetes abweichen.  Dies kann die Sicherung von etcd erschweren. Wir empfehlen daher, einen separaten etcd-Cluster speziell f√ºr Flanell zu verwenden. <br><br>  <b>Bereitstellung eines einzelnen Hosts</b> <br><br>  Die Liste der Barrierefreiheitsrisiken umfasst Hardware, Software und den Faktor Mensch.  Wenn Sie auf einen einzelnen Host beschr√§nkt sind, kann die Verwendung von redundantem Speicher, fehlerkorrigierendem Speicher und einer doppelten Stromversorgung den Schutz vor Hardwarefehlern verbessern.  Durch Ausf√ºhren eines Hypervisors auf einem physischen Host k√∂nnen Sie redundante Softwarekomponenten verwenden und betriebliche Vorteile hinzuf√ºgen, die mit der Bereitstellung, Aktualisierung und √úberwachung der Ressourcennutzung verbunden sind.  Selbst in Stresssituationen bleibt das Verhalten wiederholbar und vorhersehbar.  Selbst wenn Sie beispielsweise nur das Starten von Singletones von Masterdiensten zulassen k√∂nnen, sollten diese vor √úberlastung und Ressourcenverarmung gesch√ºtzt sein und mit der Arbeitslast Ihrer Anwendung konkurrieren.  Ein Hypervisor kann effizienter und einfacher zu verwenden sein als die Priorisierung im Linux-Scheduler, in cgroups, Kubernetes-Flags usw. <br><br>  Sie k√∂nnen drei virtuelle etcd-Maschinen bereitstellen, wenn die Hostressourcen dies zulassen.  Jede VM muss von einem separaten physischen Speicherger√§t unterst√ºtzt werden oder separate Teile des Speichers mithilfe von Redundanz (Spiegelung, RAID usw.) verwenden. <br>  Doppelt redundante Instanzen der Server-API, des Schedulers und des Controller-Managers sind das n√§chste Upgrade, wenn Ihr einziger Host √ºber gen√ºgend Ressourcen daf√ºr verf√ºgt. <br><br>  <i>Bereitstellungsoptionen f√ºr einen einzelnen Host, von am wenigsten f√ºr die Produktion geeignet bis zu den meisten</i> <br><table><tbody><tr><th>  Typ </th><th>  Eigenschaften </th><th>  Ergebnis </th></tr><tr><td>  <nobr>Mindestausstattung</nobr> </td><td>  Singleton etcd und Master-Komponenten. </td><td>  Heimlabor, √ºberhaupt nicht in Produktionsqualit√§t.  Multiple Single Point of Failure (SPOF).  Die Wiederherstellung ist langsam, und wenn Speicherplatz verloren geht, fehlt er vollst√§ndig. </td></tr><tr><td>  Verbesserung der Speicherredundanz </td><td>  etcd Singleton- und Master-Komponenten, etcd-Speicher ist redundant. </td><td>  Sie k√∂nnen mindestens einen Speicherger√§tefehler beheben. </td></tr><tr><td>  Redundanz auf verwalteter Ebene </td><td>  Es gibt keinen Hypervisor, mehrere Instanzen von Komponenten auf verwalteter Ebene in statischen Pods. </td><td>  Der Schutz vor Softwarefehlern ist erschienen, aber das Betriebssystem und die Container-Startumgebung sind immer noch die gleichen Fehlerquellen mit verheerenden Updates. </td></tr><tr><td>  Hinzuf√ºgen eines Hypervisors </td><td>  Ausf√ºhren von drei redundanten Instanzen auf verwalteter Ebene in der VM. </td><td>  Es gibt Schutz vor Softwarefehlern und menschlichen Fehlern sowie einen betrieblichen Vorteil bei Installation, Ressourcenverwaltung, √úberwachung und Sicherheit.  Betriebssystem-Updates und Container-Startumgebungen sind weniger st√∂rend.  Der Hypervisor ist der einzige einzelne Fehlerpunkt. </td></tr></tbody></table><br>  <b>Dual-Host-Bereitstellung</b> <br><br>  Bei zwei Hosts √§hneln die Speicherprobleme bei etcd der Option f√ºr einen einzelnen Host - Sie ben√∂tigen Redundanz.  Es ist vorzuziehen, drei encd-Instanzen auszuf√ºhren.  Es mag nicht intuitiv erscheinen, aber es ist besser, alle etcd-Knoten auf einen Host zu konzentrieren.  Sie erh√∂hen die Zuverl√§ssigkeit nicht, indem Sie sie durch 2 + 1 zwischen zwei Hosts teilen. Ein Verlust eines Knotens mit den meisten encd-Instanzen f√ºhrt zu einem Fehler, unabh√§ngig davon, ob es sich um eine Mehrheit von 2 oder 3 handelt. Wenn die Hosts nicht identisch sind, platzieren Sie den gesamten etcd-Cluster auf dem zuverl√§ssigeren. <br><br>  Es wird empfohlen, redundante API-Server, Kube-Scheduler und Kube-Controller-Manager auszuf√ºhren.  Sie sollten von Hosts gemeinsam genutzt werden, um das Risiko von Fehlern in der Container-Startumgebung, im Betriebssystem und in der Hardware zu minimieren. <br><br>  Durch Starten einer Hypervisor-Schicht auf physischen Hosts k√∂nnen Sie mit redundanten Programmkomponenten arbeiten und Ressourcen verwalten.  Es hat auch den betrieblichen Vorteil einer geplanten Wartung. <br><br>  <i>Bereitstellungsoptionen f√ºr zwei Hosts, von den am wenigsten f√ºr die Produktion geeigneten bis zu den meisten</i> <br><table><tbody><tr><th>  Typ </th><th>  Eigenschaften </th><th>  Ergebnis </th></tr><tr><td>  <nobr>Mindestausstattung</nobr> </td><td>  Zwei Hosts ohne redundanten Speicher.  Singleton etcd und Master-Komponenten auf demselben Host. </td><td>  etcd - ein einzelner Fehlerpunkt, es macht keinen Sinn, zwei auf anderen Masterdiensten auszuf√ºhren.  Die gemeinsame Nutzung zwischen zwei Hosts erh√∂ht das Risiko von Ausf√§llen auf verwalteten Ebenen.  Der potenzielle Vorteil der Isolierung von Ressourcen durch Ausf√ºhren einer verwalteten Schicht auf einem Host und von Anwendungs-Workloads auf einem anderen.  Wenn der Speicher verloren geht, erfolgt keine Wiederherstellung. </td></tr><tr><td>  Verbesserung der Speicherredundanz </td><td>  Singleton etcd- und Master-Komponenten auf demselben Host, etcd-Speicher redundant. </td><td>  Sie k√∂nnen mindestens einen Speicherger√§tefehler beheben. </td></tr><tr><td>  Redundanz auf verwalteter Ebene </td><td>  Es gibt keinen Hypervisor, mehrere Instanzen von Komponenten auf verwalteter Ebene in statischen Pods.  etcd Cluster auf einem Host, andere Komponenten auf verwalteter Ebene werden getrennt. </td><td>  Ein Hardwarefehler, das Aktualisieren der Firmware, des Betriebssystems und der Container-Startumgebung auf einem Host ohne etcd ist weniger sch√§dlich. </td></tr><tr><td>  Hinzuf√ºgen eines Hypervisors zu beiden Hosts </td><td>  Drei redundante Komponenten auf verwalteter Ebene werden in virtuellen Maschinen usw. auf einem Host ausgef√ºhrt, und Komponenten auf verwalteter Ebene werden getrennt.  Anwendungs-Workloads k√∂nnen sich auf beiden VM-Knoten befinden. </td><td>  Verbesserte Isolation der Anwendungslast.  Aktualisierungen des Betriebssystems und der Container-Startumgebung sind weniger st√∂rend.  Die geplante Wartung von Hardware / Firmware wird zerst√∂rungsfrei, wenn der Hypervisor die VM-Migration unterst√ºtzt. </td></tr></tbody></table><br>  <b>Bereitstellung auf drei (oder mehr) Hosts</b> <br><br>  √úbergang zu kompromisslosem Service in Produktionsqualit√§t.  Wir empfehlen, etcd zwischen den drei Hosts aufzuteilen.  Ein Hardwarefehler verringert die Anzahl m√∂glicher Anwendungs-Workloads, f√ºhrt jedoch nicht zu einem vollst√§ndigen Serviceausfall. <br><br>  Sehr gro√üe Cluster erfordern mehr Instanzen. <br><br>  Das Starten einer Hypervisor-Schicht bietet betriebliche Vorteile und eine verbesserte Isolierung der Anwendungs-Workloads.  Dies w√ºrde den Rahmen des Artikels sprengen, aber auf der Ebene von drei oder mehr Hosts sind m√∂glicherweise verbesserte Funktionen verf√ºgbar (Clustered Redundant Shared Storage, Ressourcenverwaltung mit einem dynamischen Load Balancer, automatisierte Status√ºberwachung mit Live-Migration und Failover). <br><br>  <i>Bereitstellungsoptionen f√ºr drei (oder mehr) Hosts, von den am wenigsten f√ºr die Produktion geeigneten bis zu den am meisten geeigneten</i> <br><table><tbody><tr><th>  Typ </th><th>  Eigenschaften </th><th>  Ergebnis </th></tr><tr><td>  <nobr>Minimum</nobr> </td><td>  Drei Gastgeber.  Instanz etcd auf jedem Knoten.  Hauptkomponenten auf jedem Knoten. </td><td>  Der Verlust eines Knotens verringert die Leistung, f√ºhrt jedoch nicht zu einem R√ºckgang von Kubernetes.  Die M√∂glichkeit der Wiederherstellung bleibt bestehen. </td></tr><tr><td>  Hinzuf√ºgen eines Hypervisors zu Hosts </td><td>  In virtuellen Maschinen auf drei Hosts usw. werden ein API-Server, Scheduler und ein Controller-Manager ausgef√ºhrt.  Auf jedem Host werden Workloads in der VM ausgef√ºhrt. </td><td>  Schutz vor Betriebssystemfehlern / Container / Software-Startumgebung und menschlichen Fehlern hinzugef√ºgt.  Betriebliche Vorteile von Installation, Upgrade, Ressourcenverwaltung, √úberwachung und Sicherheit. </td></tr></tbody></table><br>  <b>Konfigurieren Sie Kubernetes</b> <br><br>  Master- und Worker-Knoten m√ºssen vor √úberlastung und Ressourcenverarmung gesch√ºtzt werden.  Hypervisor-Funktionen k√∂nnen verwendet werden, um kritische Komponenten zu isolieren und Ressourcen zu reservieren.  Es gibt auch Kubernetes-Konfigurationseinstellungen, die beispielsweise die Geschwindigkeit von API-Aufrufen verlangsamen k√∂nnen.  Einige Installationskits und kommerzielle Distributionen k√ºmmern sich darum. Wenn Sie Kubernetes jedoch selbst bereitstellen, sind die Standardeinstellungen m√∂glicherweise nicht geeignet, insbesondere f√ºr kleine Ressourcen oder f√ºr einen zu gro√üen Cluster. <br><br>  Der Ressourcenverbrauch auf √ºberschaubarem Niveau korreliert mit der Anzahl der Herde und der Abflussrate der Herde.  Sehr gro√üe und sehr kleine Cluster profitieren von den ge√§nderten Einstellungen f√ºr die Kube-Apiserver-Anforderung und die Speicherverlangsamung. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Node</a> Allocatable sollte auf den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Worker-Knoten</a> basierend auf der angemessenen unterst√ºtzten Lastdichte f√ºr jeden Knoten konfiguriert werden.  Namespaces k√∂nnen erstellt werden, um einen Cluster von Arbeitsknoten in mehrere virtuelle Cluster mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kontingenten</a> f√ºr CPU und Speicher aufzuteilen. <br><br>  <b>Sicherheit</b> <br><br>  Jeder Kubernetes-Cluster verf√ºgt √ºber eine Stammzertifizierungsstelle (CA).  Die Zertifikate Controller Manager, API Server, Scheduler, Kubelet Client, Kube-Proxy und Administrator m√ºssen generiert und installiert werden.  Wenn Sie ein Installationstool oder eine Distribution verwenden, m√ºssen Sie sich m√∂glicherweise nicht selbst darum k√ºmmern.  Der manuelle Vorgang wird <a href="">hier</a> beschrieben.  Sie sollten bereit sein, Zertifikate neu zu installieren, wenn Sie die Knoten erweitern oder ersetzen. <br><br>  Da Kubernetes vollst√§ndig von der API verwaltet wird, muss die Liste der Personen, die Zugriff auf den Cluster haben, unbedingt gesteuert und eingeschr√§nkt werden.  Verschl√ºsselungs- und Authentifizierungsoptionen werden in dieser Dokumentation erl√§utert. <br><br>  Kubernetes-Anwendungs-Workloads basieren auf Container-Images.  Sie ben√∂tigen die Quelle und den Inhalt dieser Bilder, um zuverl√§ssig zu sein.  Dies bedeutet fast immer, dass Sie das Container-Image im lokalen Repository hosten.  Die Verwendung von Bildern aus dem √∂ffentlichen Internet kann zu Zuverl√§ssigkeits- und Sicherheitsproblemen f√ºhren.  Sie m√ºssen ein Repository ausw√§hlen, das das Signieren des Bildes, das Scannen der Sicherheit, das Steuern des Zugriffs zum Senden und Herunterladen von Bildern und das Protokollieren von Aktivit√§ten unterst√ºtzt. <br><br>  Prozesse m√ºssen so konfiguriert sein, dass sie die Verwendung von Host-, Hypervisor-, OS6-, Kubernetes- und anderen Abh√§ngigkeits-Firmware-Updates unterst√ºtzen.  Die Versions√ºberwachung ist erforderlich, um die √úberwachung zu unterst√ºtzen. <br><br>  Empfehlungen: <br><br><ul><li>  Verbessern Sie die Standardsicherheitseinstellungen f√ºr Komponenten auf verwalteter Ebene (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Blockieren von Worker-Knoten</a> ). </li><li>  Verwenden Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Herd-Sicherheitsrichtlinie</a> . </li><li>  Denken Sie an die f√ºr Ihre Netzwerkl√∂sung verf√ºgbare <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NetworkPolicy-</a> Integration, einschlie√ülich Nachverfolgung, √úberwachung und Fehlerbehebung. </li><li>  Verwenden Sie RBAC, um Autorisierungsentscheidungen zu treffen. </li><li>  Denken Sie an die physische Sicherheit, insbesondere bei der Bereitstellung an peripheren oder Remote-Standorten, die m√∂glicherweise √ºbersehen werden.  F√ºgen Sie Speicherverschl√ºsselung hinzu, um die Folgen von Ger√§tediebstahl zu begrenzen, und sch√ºtzen Sie sich vor dem Anschlie√üen b√∂sartiger Ger√§te wie USB-Sticks. </li><li>  Sch√ºtzen Sie die Textanmeldeinformationen des Cloud-Anbieters (Zugriffsschl√ºssel, Token, Kennw√∂rter usw.). </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Geheime</a> Objekte von Kubernetes eignen sich zum Speichern kleiner Mengen sensibler Daten.  Sie werden in etcd gespeichert.  Sie k√∂nnen sicher zum Speichern von Anmeldeinformationen der Kubernetes-API verwendet werden. Manchmal erfordert jedoch eine Workload oder die Erweiterung des Clusters selbst eine umfassendere L√∂sung.  Das HashiCorp Vault-Projekt ist eine beliebte L√∂sung, wenn Sie mehr ben√∂tigen, als die integrierten geheimen Objekte bieten k√∂nnen. <br><br>  <b>Notfallwiederherstellung und -sicherung</b> <br><br><img src="https://habrastorage.org/webt/gv/xp/kd/gvxpkd1qgpap0wosdhv-r4uu-9s.png"><br><br>  Durch die Implementierung von Redundanz durch die Verwendung mehrerer Hosts und VMs wird die Anzahl bestimmter Arten von Fehlern verringert.  Szenarien wie eine Naturkatastrophe, ein schlechtes Update, ein Hackerangriff, Softwarefehler oder ein menschlicher Fehler k√∂nnen jedoch immer noch zu Abst√ºrzen f√ºhren. <br><br>  Ein kritischer Teil einer Produktionsbereitstellung ist die Erwartung einer zuk√ºnftigen Wiederherstellung. <br><br>  Es ist auch erw√§hnenswert, dass ein Teil Ihrer Investition in Design, Dokumentation und Automatisierung des Wiederherstellungsprozesses wiederverwendet werden kann, wenn Sie umfangreiche replizierte Bereitstellungen an mehreren Standorten ben√∂tigen. <br><br>  Unter den Elementen der Notfallwiederherstellung sind Backups (und m√∂glicherweise Replikate), Ersetzungen, der geplante Prozess, die Personen, die diesen Prozess durchf√ºhren, und regelm√§√üige Schulungen erw√§hnenswert.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die</a> h√§ufigen Test√ºbungen und -prinzipien von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chaos Engineering</a> k√∂nnen verwendet werden, um Ihre Bereitschaft zu testen. <br><br>  Aufgrund der Verf√ºgbarkeitsanforderungen m√ºssen Sie m√∂glicherweise lokale Kopien des Betriebssystems, der Kubernetes-Komponenten und der Container-Images speichern, um die Wiederherstellung auch bei einem Absturz des Internets zu erm√∂glichen.  Die M√∂glichkeit, Ersatzhosts und -knoten in einer Situation der ‚Äûphysischen Isolation‚Äú bereitzustellen, verbessert die Sicherheit und erh√∂ht die Bereitstellungsgeschwindigkeit. <br><br>  Alle Kubernetes-Objekte werden in etcd gespeichert.  Das regelm√§√üige Sichern von etcd-Clusterdaten ist ein wichtiges Element beim Wiederherstellen von Kubernetes-Clustern in Notfallszenarien, z. B. wenn alle Masterknoten verloren gehen. <br><br>   etcd       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>  etcd           .      Kubernetes    .   ,     Kubernetes. <br><br>   ,    Kubernetes      etcd ,      -  .     ,         . <br><br>       etcd. ,  ,    ,   ,     /.       ,        .           : <br><br><ul><li>    : CA, API Server, Apiserver-kubelet-client,  ServiceAccount, ‚ÄúFront proxy‚Äù,  Front proxy; </li><li>   DNS; </li><li>    IP/; </li><li>   ; </li><li>  kubeconfig; </li><li> LDAP    ; </li><li>      . </li></ul><br> <b>   </b> <br><br> Anti-affinity           .      ,    .  ,  Kubernetes         ,          .     ,              ,    -   . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">    </a>          ,  . <br><br>   stateful-,    ‚Äî   Kubernetes    (,   SQL  ). ,   ,  Kubernetes,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">roadmap feature request</a> , ,  ,    Container Storage Interface (CSI).  ,       - ,    ,      . ,      Kubernetes      ,          ,    ,    Kubernetes . <br><br>  stateful- (, Cassandra)        ,    ,    .      - Kubernetes (    -)      . <br><br> <b> </b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> (    )    ,      ,        .     ,      , . <br><br>        ,    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ansible</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BOSH</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chef</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Juju</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kubeadm</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Puppet</a>  .).        ,          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> , ,          , ,          ,  ,        .       ,  Git,      . <br><br> <b></b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> ,     ,       ‚Äî   .     2   ,  ‚Äî   .          ‚Äî         ,    . <br><br> <b> </b> <br><br><img src="https://habrastorage.org/webt/a5/m-/gx/a5m-gxsrhmwpyxxwmcfsnfc8umm.png"><br><br>       ‚Äî    .          - ,    Airbus A320 ‚Äî  .   ,      .    ,   . <br><br>   ,       .   , ,    ,   . Kubernetes     ,    - ,     ,       (, FedEx, Amazon). <br><br>   production-grade  Kubernetes       .               .   , ,     ,    ,     .  ,    (,   Kubernetes   <a href="">self-hosting</a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keine statischen Herde). </font><font style="vertical-align: inherit;">Vielleicht sollten sie in den folgenden Artikeln besprochen werden, wenn gen√ºgend Interesse besteht. </font><font style="vertical-align: inherit;">Aufgrund der hohen Geschwindigkeit der Verbesserung von Kubernetes sind einige Materialien m√∂glicherweise bereits sehr veraltet, wenn Ihre Suchmaschine diesen Artikel nach 2019 gefunden hat.</font></font><br><br>  DAS ENDE <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie immer warten wir hier auf Ihre Fragen und Kommentare, und Sie k√∂nnen </font><font style="vertical-align: inherit;">zum </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tag der offenen T√ºr</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Titov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gehen </font><font style="vertical-align: inherit;">.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422179/">https://habr.com/ru/post/de422179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422169/index.html">Was hat das Ada Lovelace-Programm eigentlich gemacht?</a></li>
<li><a href="../de422171/index.html">Als h√§tte ich eine leitungsinteraktive USV gemacht. Teil 3</a></li>
<li><a href="../de422173/index.html">Maschinelles Lernen wird zunehmend in der Teilchenphysik eingesetzt.</a></li>
<li><a href="../de422175/index.html">Umweltverschmutzung verringert die kognitiven F√§higkeiten des Menschen</a></li>
<li><a href="../de422177/index.html">Warum ist Arduino so langsam und was kann man dagegen tun?</a></li>
<li><a href="../de422181/index.html">So sammeln Sie Unternehmensdienste auf einer Online-Plattform: der Geschichte von MegaFon. Business</a></li>
<li><a href="../de422183/index.html">Und was, k√∂nnte es billiger sein?</a></li>
<li><a href="../de422185/index.html">Inwieweit √§hneln die Daten f√ºr das Modelltraining (nicht) einer Testprobe?</a></li>
<li><a href="../de422187/index.html">Sberseasons: wie ich diesen Sommer verbracht habe</a></li>
<li><a href="../de422189/index.html">Die Wahrheit √ºber die Implementierung des Intranet-Portals</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>