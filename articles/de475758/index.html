<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìö üõçÔ∏è üöè Automatisch erneuerbare Abonnementstufen in der iOS-App ‚ôèÔ∏è üö¥üèæ ‚óªÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo, das ist Renat von Apphud . In diesem Artikel erfahren Sie, wie hoch die Anzahl der automatisch erneuerbaren Abonnements ist, wie sie richtig ko...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisch erneuerbare Abonnementstufen in der iOS-App</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/apphud/blog/475758/"><p><img src="https://habrastorage.org/webt/ak/pz/18/akpz184-wzln3efdt6el6whs19o.png" alt="Bild"></p><br><p> Hallo, das ist Renat von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apphud</a> .  In diesem Artikel erfahren Sie, wie hoch die Anzahl der automatisch erneuerbaren Abonnements ist, wie sie richtig konfiguriert werden und in welchen F√§llen dem Benutzer eine R√ºckerstattung f√ºr einen nicht genutzten bezahlten Zeitraum gew√§hrt wird. <a name="habracut"></a></p><br><h2 id="chto-takoe-uroven-podpiski">  Was ist der Abonnement-Level? </h2><br><p>  Dies ist die Bezeichnung der Abonnementklasse, abh√§ngig von der angebotenen Servicestufe.  Das Abonnement der ersten Klasse bedeutet das h√∂chste Serviceniveau, das Abonnement der zweiten Klasse - das niedrigere und so weiter.  In der Tat, selten in welcher Anwendung finden Sie zwei Ebenen von Abonnements, ganz zu schweigen von drei oder mehr. </p><br><img src="https://habrastorage.org/webt/ek/ow/4r/ekow4rj6bw6nunu1yi078dzat1c.png"><br><p>  <em>Zwei Abonnementstufen in der New York Times App.</em> </p><br><h2 id="kak-nastroit-urovni-podpiski">  Wie richte ich ein Abonnement ein? </h2><br><p>  Um Ihre Abonnementstufen zu konfigurieren, rufen Sie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">App Store Connect auf</a> , w√§hlen Sie Ihre Anwendung aus und klicken Sie auf die Registerkarte <em>Funktionen</em> .  Verschieben Sie Ihr Abonnement im Bereich In-App-K√§ufe eine Ebene nach oben oder unten.  W√§hlen Sie dazu das gew√ºnschte Abonnement aus, indem Sie das Drag &amp; Drop-Symbol gedr√ºckt halten und das Abonnement auf die gew√ºnschte Ebene verschieben. </p><br><img src="https://habrastorage.org/webt/mq/aq/8v/mqaq8vvrm_z0hkqsn8gvqso9fdc.gif"><br><p>  <em>Ziehen Sie ein Abonnement auf eine h√∂here Ebene und legen Sie es dort ab.</em> </p><br><p>  Abonnement Nummer 1 sollte das h√∂chste Serviceniveau bieten, z. B. Abonnement f√ºr alle Kategorien von Zeitschriften.  Es besteht keine Abh√§ngigkeit zwischen der Laufzeit des Abonnements und seiner H√∂he.  Das h√∂chste Abonnement kann also ein Jahresabonnement sein und ein Abonnement auf einer Ebene, die unter einem Monat liegt. </p><br><h2 id="izmenenie-podpiski">  Abo √§ndern </h2><br><p>  Der Benutzer kann das Abonnement in der App Store-Anwendung nach seiner Registrierung √§ndern.  Es kann ein Level erh√∂hen (Upgrade), senken (Downgrade) oder ein Abonnement innerhalb eines Levels √§ndern (Cross-Grade). </p><br><h4 id="povyshenie-urovnya-podpiski-apgreyd">  Abo-Upgrade (Upgrade) </h4><br><p>  Wenn das aktuelle Abonnement des Benutzers aktiv ist, wechselt er sofort zu einem neuen Tarif, und der nicht verwendete Teil des bezahlten Zeitraums wird auf die Karte zur√ºckgeschickt. </p><br><img src="https://habrastorage.org/webt/y-/fl/7d/y-fl7dwabjscib2zi6wwkwnwmdq.png"><br><p>  <em>Benachrichtigung, dass ein Teil des Geldes beim Upgrade des Abonnements zur√ºckerstattet wird.</em> </p><br><p>  Am Ende des Artikels werden wir uns ansehen, wie wir die Erh√∂hung des Abonnement-Levels erfassen und die H√∂he der Rendite berechnen k√∂nnen. </p><br><h4 id="ponizhenie-urovnya-podpiski-daungreyd">  Abo-Downgrade (Downgrade) </h4><br><p>  Durch Verringern des Levels wechselt der Benutzer am Ende der aktuellen bezahlten Periode zu einem neuen.  Gelder werden nicht zur√ºckerstattet und die Kosten eines neuen Abonnements werden bei Aktivierung abgebucht. </p><br><h4 id="smena-podpiski-v-ramkah-odnogo-urovnya-krossgreyd">  Abonnementwechsel auf gleichem Niveau (grade√ºbergreifend) </h4><br><p>  Dies ist eine h√§ufige Situation, die in zwei Arten unterteilt ist: eine Abonnement√§nderung von einer Dauer und eine andere.  Wenn Sie ein Abonnement mit einer anderen Laufzeit √§ndern, geschieht dasselbe wie bei einem Downgrade: Das Abonnement wird am Ende des aktuellen bezahlten Zeitraums angewendet. </p><br><p>  Wenn die Dauer √ºbereinstimmt, wird das aktuelle Abonnement gek√ºndigt und ein neues Abonnement wird sofort gestartet.  Das Geld wird f√ºr das neue Abonnement abgebucht, und der nicht verwendete Teil des alten Abonnements wird an den Benutzer zur√ºckgegeben. </p><br><h2 id="kak-uznat-o-smene-podpiski-na-servere">  Wie erfahre ich, wie ich das Abonnement auf dem Server √§ndere? </h2><br><p>  Sie k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die App Store-√úberpr√ºfung validieren</a> oder Apple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Server-Benachrichtigungen abh√∂ren</a> . </p><br><p>  W√§hrend Sie jede neue Transaktion √ºberpr√ºfen, m√ºssen Sie nachsehen, ob sich <em>product_id</em> ge√§ndert hat.  Das √Ñndern von <em>product_id</em> bedeutet, dass der Benutzer sein Abonnement in den App Store-Einstellungen ge√§ndert hat. </p><br><p> Dar√ºber hinaus k√∂nnen Sie den Wert von <code>auto_renew_product_id</code> in <code>pending_renewal_info</code> .  Sie erhalten <em>Informationen zu</em> einer √Ñnderung an <em>product_id,</em> bevor ein neues Abonnement wirksam wird. </p><br><p>  Wenn Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Serverbenachrichtigungen</a> konfiguriert haben, lauschen Sie der <em>DID_CHANGE_RENEWAL_PREF-</em> Benachrichtigung, die aufgerufen wird, wenn ein Produkt <em>ge√§ndert wird</em> .  Sie k√∂nnen sich auf diese Benachrichtigung beschr√§nken und die neue <em>product_id</em> aus den Anforderungsparametern <em>abrufen</em> oder die App Store-Quittung erneut √ºberpr√ºfen.  Im letzteren Fall dienen Apple Server-Benachrichtigungen nur als Ausl√∂ser f√ºr eine au√üerplanm√§√üige √úberpr√ºfung. </p><br><h2 id="kak-vychislit-summu-vozvrata-pri-apgreydah">  Wie berechnet man die Rendite f√ºr Upgrades? </h2><br><p>  Um zu verstehen, ob ein Upgrade durchgef√ºhrt wurde, m√ºssen Sie den Wert des <code>is_upgraded</code> √ºberpr√ºfen.  Der Wert <code>true</code> bedeutet, dass die n√§chste Transaktion bereits im neuen Abonnement enthalten ist. </p><br><p>  Beachten Sie, dass <code>is_upgraded</code> auch dann <code>is_upgraded</code> ist, wenn Sie ein Abonnement mit derselben Dauer innerhalb derselben Stufe √§ndern.  Das hei√üt, <code>is_upgraded = true</code> bedeutet keine <code>is_upgraded = true</code> , sondern die Tatsache, dass eine Abonnement√§nderung mit einer R√ºckerstattung vorgenommen wurde. </p><br><p>  Zus√§tzlich zum Feld <code>is_upgraded</code> wird in dieser Transaktion das Feld <code>is_upgraded</code> angezeigt, das den Zeitpunkt der Stornierung angibt.  Sie entspricht dem Startdatum der n√§chsten Transaktion oder stimmt fast mit diesem √ºberein. </p><br><p>  Es stellt sich heraus, dass das Feld cancel_date <strong>nicht nur bei der R√ºckgabe des Abonnements</strong> angezeigt <strong>wird</strong> , sondern auch beim Upgrade. </p><br><p>  Beachten Sie, dass <strong>beim Upgrade von Sandbox-Abonnements das Feld cancel_date fehlt</strong> .  Daher m√ºssen Sie beim Testen in Sandbox das <code>purchase_date</code> n√§chsten Transaktion anstelle des <code>cancellation_date</code> .  Weitere Informationen zum K√ºndigungsdatum finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in der Apple-Dokumentation</a> . </p><br><p>  Um den Betrag zu berechnen, der an den Benutzer zur√ºckgegeben werden soll, m√ºssen Sie den nicht verwendeten Zeitraum durch den vollen Zeitraum des vorherigen Abonnements dividieren und mit dessen Kosten multiplizieren: </p><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># upgrade_date is `cancellation_date` in prodiction or `purchase_date` of new transaction in sandbox # to_f converts date to float timestamp value prorate_amount = price * (upgrade_date.to_f - cancellation_date.to_f) / (expires_date.to_f - purchase_date.to_f)</span></span></code> </pre> <br><h2 id="kak-eto-realizovano-v-apphud">  Wie ist dies in Apphud implementiert? </h2><br><p>  Apphud verfolgt automatisch √Ñnderungen in Abonnements und berechnet die R√ºckgabe nicht verwendeter Teile. </p><br><img src="https://habrastorage.org/webt/i-/ni/wk/i-niwkapdw5jjoaztapmznegq-c.png"><br><p>  <em>Ein Beispiel f√ºr eine Zeichnungs√§nderung auf gleicher H√∂he mit der R√ºckgabe eines Teils der Fonds in Apphud.</em> </p><br><p>  Ein iOS-Entwickler muss diese Situationen nicht selbst behandeln.  Sie m√ºssen nur das SDK integrieren, der Rest wird von Apphud erledigt. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Es stellt sich heraus, dass <code>product_id</code> nicht ausreicht, nur den Wert von <code>product_id</code> aktualisieren: Sie m√ºssen auch die R√ºckerstattung f√ºr Upgrades in Betracht ziehen.  F√ºr die Arbeit mit Abonnements sind viele Grenzsituationen erforderlich.  Wir machen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apphud</a> - ein Service, der die Arbeit mit Abonnements erheblich vereinfacht.  Sie k√∂nnen es kostenlos nutzen.  Anmeldung - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unter diesem Link</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de475758/">https://habr.com/ru/post/de475758/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de475746/index.html">Anatomie akustischer Systeme: Cermets und Komposite - √úber Monitor-Audiodiffusoren</a></li>
<li><a href="../de475748/index.html">22. November Moskau - AnalyzeIT MeetUp Nr. 3</a></li>
<li><a href="../de475750/index.html">Wissenstransfer und neuronale maschinelle √úbersetzung in der Praxis</a></li>
<li><a href="../de475754/index.html">Shorts √ºber Scrum</a></li>
<li><a href="../de475756/index.html">Food Design Digest Oktober 2019</a></li>
<li><a href="../de475760/index.html">Nachwuchsentwickler - warum wir sie einstellen und wie wir mit ihnen arbeiten</a></li>
<li><a href="../de475762/index.html">Ein Lebenslauf mit einem Foto fliegt in eine Urne. Merkmale der Jobsuche in den USA</a></li>
<li><a href="../de475764/index.html">Markov-Ketten zur prozeduralen Geb√§udeerzeugung</a></li>
<li><a href="../de475768/index.html">Kotlin: Wie ist es eine gute Wahl f√ºr die Entwicklung von Android-Apps?</a></li>
<li><a href="../de475770/index.html">Stanford University - Besuch und R√ºckblick</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>