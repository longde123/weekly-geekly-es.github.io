<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫üèª üê≤ üéä La bataille des serveurs WEB. Partie 2 - Sc√©nario HTTPS r√©aliste: üàÇÔ∏è üçò üòì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous avons parl√© de la technique dans la premi√®re partie de l' article, dans laquelle nous testons HTTPS, mais dans des sc√©narios plus r√©alistes. Pour...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La bataille des serveurs WEB. Partie 2 - Sc√©nario HTTPS r√©aliste:</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ultravds/blog/482230/"><img src="https://habrastorage.org/getpro/habr/post_images/e98/b4f/df1/e98b4fdf1818cb6bfaf1d464ee87e3ac.png"><br><br>  Nous avons parl√© de la technique dans la <a href="https://habr.com/ru/company/ultravds/blog/478854/">premi√®re partie de l'</a> article, dans laquelle nous testons HTTPS, mais dans des sc√©narios plus r√©alistes.  Pour les tests, le certificat Let's Encrypt a √©t√© re√ßu, la compression Brotli par 11 a √©t√© activ√©e. <br><br>  Cette fois, nous allons essayer de reproduire le sc√©nario de d√©ploiement du serveur sur VDS ou en tant que machine virtuelle sur un h√¥te avec un processeur typique.  Pour ce faire, d√©finissez la limite sur: <br><br><ul><li>  25% - ce qui en termes de fr√©quence ~ 1350 MHz </li><li>  35% -1890 MHz </li><li>  41% - 2214 MHz </li><li>  65% - 3510 MHz </li></ul><br>  Le nombre de connexions uniques est pass√© de 500 √† 1, 3, 5, 7 et 9, <br><a name="habracut"></a><br><h2>  R√©sultats: </h2><br><h3>  Retards: </h3><br>  TTFB a √©t√© sp√©cialement con√ßu comme test s√©par√©, car les outils HTTPD cr√©ent un nouvel utilisateur pour chaque demande individuelle.  Ce test est encore assez √©loign√© de la r√©alit√©, car l'utilisateur clique sur quelques pages de toute fa√ßon, et en r√©alit√© TTFP jouera le r√¥le principal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d16/3a9/a21/d163a9a21730a7837ec6adccb4758e4d.png"></div><br>  La premi√®re, g√©n√©ralement la toute premi√®re requ√™te, apr√®s le premier d√©marrage de la machine virtuelle, IIS traite en moyenne 120 ms. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/586/dcb/0c9/586dcb0c9eeb8443c4cd52fd49a3d5c3.png"></div><br>  Toutes les demandes suivantes affichent un TTFP de 1,5 ms.  Apache et Nginx sont √† la tra√Æne.  Personnellement, l'auteur consid√®re ce test comme le plus r√©v√©lateur et choisirait un gagnant uniquement sur celui-ci. <br>  Le r√©sultat n'est pas surprenant, car IIS met en cache le contenu statique d√©j√† compress√© et ne le pince pas √† chaque acc√®s. <br><br><h3>  Temps pass√© sur un client </h3><br>  Pour √©valuer les performances, un test avec 1 connexion unique est suffisant. <br>  Par exemple, IIS a termin√© les tests avec une longueur de 5 000 utilisateurs en 40 secondes, soit 123 requ√™tes par seconde. <br><br>  Les graphiques ci-dessous indiquent le temps n√©cessaire au transfert complet du contenu du site.  Il s'agit du pourcentage de demandes trait√©es √† un moment pr√©cis.  Dans notre cas, 80% de toutes les demandes ont √©t√© trait√©es en 8 ms sur IIS et en 4,5 ms sur Apache et Nginx, et 98% de toutes les demandes sur Apache et Nginx ont √©t√© ex√©cut√©es dans un intervalle de 8 millisecondes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/305/e49/03c/305e4903cc0a2abf597b14132c8cdd85.png"></div><br>  Le temps n√©cessaire pour traiter 5000 demandes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f29/ef5/871/f29ef587182d7dd5e7df53af806855b0.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c52/60b/c4a/c5260bc4a393960d4116fb843ea7ffb1.png"></div><br>  Le temps n√©cessaire pour traiter 5000 demandes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/753/d66/f67/753d66f67f474f3c86c1fee8883b2a70.png"></div><br>  Si vous avez une machine virtuelle avec un processeur 3,5 GHz et 8 c≈ìurs, choisissez ce que vous voulez.  Tous les serveurs Web sont tr√®s similaires dans ce test.  Nous parlerons ci-dessous du serveur Web √† choisir pour chaque h√¥te. <br><br>  Lorsqu'il s'agit d'une situation un peu plus r√©elle, tous les serveurs Web se font face. <br><br><h3>  D√©bit: </h3><br>  Calendrier des retards sur le nombre de connexions simultan√©es.  Plus lisse et plus bas, c'est mieux.  Les 2% restants ont √©t√© supprim√©s des graphiques car ils les rendraient illisibles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/504/0ba/06a5040ba38a1ce27336a473f875a6a9.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/030/ac4/25a/030ac425a43f2508d1c8ce2235be30a2.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ea/caf/960/6eacaf96036c0cb5032908b98977b1ef.png"></div><br>  Consid√©rez maintenant l'option o√π le serveur est h√©berg√© sur un h√©bergement partag√©.  Prenez 4 c≈ìurs √† 2,2 GHz et un c≈ìur √† 1,8 GHz. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4b3/220/859/4b3220859223d1388b4c00b3eeb55194.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c1/d28/e1c/0c1d28e1cd67942fbc54a472bd28942a.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ee/bec/40e/1eebec40e354a86a11b9324449fa49cf.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2f3/a99/53b/2f3a9953b0c7812932669f0b83a95c1b.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f7/f98/f4f/6f7f98f4f4182b6560b653e4a0e8f6ac.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2e/ca6/632/f2eca66320f4b03d34772fe7cf3403d6.png"></div><br><h2>  Comment √©voluer </h2><br>  Si vous avez d√©j√† vu √† quoi ressemblent les caract√©ristiques I - V des triodes √©lectro-vide, des pentodes, etc., ces graphiques vous seront familiers.  C'est ce que nous essayons de saisir - la sati√©t√©.  La limite est, lorsque vous ne lancez pas combien de c≈ìurs, la croissance de la productivit√© ne sera pas perceptible. <br><br>  Auparavant, tout le d√©fi consistait √† traiter 98% des demandes avec le moins de retard sur toutes les demandes, pour garder la courbe aussi uniforme que possible.  Maintenant, en utilisant la construction d'une autre courbe, nous trouvons le point de fonctionnement optimal pour chacun des serveurs. <br><br>  Pour ce faire, prenez la m√©trique Demandes par seconde (RPR).  Fr√©quence horizontale, verticale - le nombre de demandes trait√©es par seconde, lignes - le nombre de c≈ìurs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b49/5b4/1e2/b495b41e2ce0c33e84ed23b5ff3820d7.png"></div><br>  Une corr√©lation est montr√©e de la fa√ßon dont Nginx g√®re les demandes une par une.  8 c≈ìurs dans de tels tests se montrent mieux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0fc/73f/540/0fc73f5402df4d787ecffd3e838323d2.png"></div><br>  Ce graphique montre clairement combien mieux (pas beaucoup) Nginx fonctionne sur un seul c≈ìur.  Si vous avez Nginx, vous devriez envisager de r√©duire le nombre de c≈ìurs √† un si vous h√©bergez uniquement des statiques. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/201/608/276/201608276469ea155f7d151bae839d7f.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45b/a4c/311/45ba4c311df1dc07220af9cc9c78a711.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ea/dd6/831/4eadd68312d67d4579c9596b62cd6cb1.png"></div><br>  IIS, bien qu'il ait le TTFB le plus bas selon DevTools dans Chrome, parvient √† perdre √† la fois Nginx et Apache dans une lutte s√©rieuse contre le test de stress de la Fondation Apache. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d95/f30/1a8/d95f301a854c9ebbd20aada507b7194c.png"></div><br>  La courbure compl√®te des graphiques est reproduite par train. <br><br><h2>  Une sorte de conclusion: </h2><br>  Oui, Apache fonctionne moins bien sur les noyaux 1 et 8, et sur 4 √ßa marche un peu mieux. <br><br>  Oui, Nginx sur 8 c≈ìurs g√®re mieux les demandes les unes apr√®s les autres, sur 1 et 4 c≈ìurs, et fonctionne moins bien quand il y a beaucoup de connexions. <br><br>  Oui, IIS pr√©f√®re 4 c≈ìurs pour une charge multithread et pr√©f√®re 8 c≈ìurs pour un seul thread.  Au final, IIS √©tait un peu plus rapide que tous sur 8 c≈ìurs sous forte charge, bien que tous les serveurs aient √©t√© vid√©s. <br><br>  Ce n'est pas une erreur de mesure, l'erreur ici n'est pas sup√©rieure √† + -1 ms.  dans les retards et pas plus de + - 2-3 demandes par seconde pour RPR. <br><br>  Les r√©sultats, lorsque 8 c≈ìurs sont pires, ne sont pas du tout surprenants, de nombreux c≈ìurs et SMT / Hyperthreading d√©gradent gravement les performances si nous avons le d√©lai pour lequel nous devons terminer l'ensemble du pipeline. <br><br>  Nous proposons un tarif UltraLite <a href="https://ultravds.com/">Windows VDS</a> mis √† jour pour 99 roubles avec Windows Server 2019 Core install√©. <br> <a href="https://ultravds.com/"><img src="https://habrastorage.org/webt/ww/d4/ro/wwd4ro5_5a28hvdxyazf3enjxou.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482230/">https://habr.com/ru/post/fr482230/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482216/index.html">23 r√©ponses √† la d√©pression d'un psychiatre professionnel Maxim Malyavin (dpmmax)</a></li>
<li><a href="../fr482220/index.html">Localisation du marqueur Aruco</a></li>
<li><a href="../fr482222/index.html">Application Web sur Kotlin + Spring Boot + Vue.js (module compl√©mentaire)</a></li>
<li><a href="../fr482224/index.html">Quand un designer doit √™tre un petit programmeur</a></li>
<li><a href="../fr482228/index.html">Nous √©crivons une ¬´calculatrice¬ª en C #. Partie I. Calcul de la valeur, d√©riv√©, simplification et autres oies</a></li>
<li><a href="../fr482232/index.html">StackOverflow est plus qu'un simple r√©f√©rentiel de r√©ponses √† des questions stupides</a></li>
<li><a href="../fr482234/index.html">Mod√©lisation num√©rique √† analogique et mixte dans PADS Professional</a></li>
<li><a href="../fr482240/index.html">Nous d√©montons les premiers appareils TP-Link avec Wi-Fi 6: routeur Archer AX6000 et adaptateur Archer TX3000E</a></li>
<li><a href="../fr482244/index.html">R√©sultats des tests de cam√©ras aveugles: iPhone, Pixel, Huawei, Samsung</a></li>
<li><a href="../fr482246/index.html">R√©ponses correctes et annonce du gagnant</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>