<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💪🏼 🌒 👩🏾‍🎓 Profondeurs SIEM: corrélations prêtes à l'emploi. Partie 3.1. Catégorisation des événements 📚 😷 ➕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Est-il possible de catégoriser tous les événements arrivant au SIEM et quel système de catégorisation utiliser pour cela? Comment appliquer des catégo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profondeurs SIEM: corrélations prêtes à l'emploi. Partie 3.1. Catégorisation des événements</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432352/">  Est-il possible de catégoriser tous les événements arrivant au SIEM et quel système de catégorisation utiliser pour cela?  Comment appliquer des catégories dans les règles de corrélation et la recherche d'événements?  Nous analyserons ces questions et d'autres dans un nouvel article du cycle consacré à la méthodologie de création de règles de corrélation prêtes à l'emploi pour les systèmes SIEM. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wp/ok/om/wpokomy1rlw1e495pzqk6uujan4.png" alt="Catégorie de événements"></div><br>  <i>Image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Worktrooper</a></i> <br><a name="habracut"></a><br>  Cet article a été co-écrit avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mikhail Maximov</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alexander Kovtun</a> . <br><br>  Nous vous avertissons: l'article est volumineux, car il décrit la construction du système de catégorisation et nos chaînes de raisonnement.  Si vous êtes trop paresseux pour le lire dans son intégralité, alors vous pouvez immédiatement aller à la section avec des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conclusions</a> - là, nous avons résumé tout ce qui a été discuté dans l'article et résumé les résultats. <br><br>  Dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article précédent,</a> nous avons constaté que les événements contiennent de nombreuses informations importantes qui ne peuvent pas être perdues dans le processus de normalisation.  La description du schéma d'interaction fait référence à ce type de données.  Pour systématiser les types d'interaction, nous avons fait ce qui suit: <br><br><ul><li>  identifié les principaux schémas inhérents à tout type d'événement; </li><li>  déterminé quelles entités participent aux programmes; </li><li>  formé l'ensemble de base des champs nécessaires pour décrire toutes les entités trouvées dans l'événement initial et le canal d'interactions entre elles. </li></ul><br>  À la suite de l'analyse des journaux de divers types de logiciels et de matériel, nous avons pu distinguer les entités: sujet, objet d'interaction, source et émetteur. <br><br>  Parlons maintenant de la sémantique de l'interaction de ces entités et de sa réflexion dans la catégorisation des événements.  Avant de décrire l'approche de la formation et des catégories, il est nécessaire de répondre à deux questions: pourquoi il est nécessaire de déterminer les catégories d'événements et quelles propriétés le système de cathétérisme devrait avoir. <br><br>  Déterminons d'abord pourquoi les événements doivent être classés.  En bref: une catégorisation est nécessaire pour fonctionner aussi bien avec des événements sémantiquement similaires, quel que soit le type de source.  Nous nous référons aux types de sources dont l'objectif principal est la source: équipements réseau, systèmes d'exploitation, logiciels d'application.  L'expression «travailler de la même manière avec des événements sémantiquement similaires» doit être comprise comme suit: <br><br><ol><li>  Les événements sémantiquement similaires de tout type de source ont une catégorie commune. </li><li> Pour les événements de chaque catégorie, des règles claires pour remplir les champs du schéma sont définies.  Nous combattons donc efficacement le chaos qui se produit au stade de la normalisation des événements et conduit souvent à de multiples faux positifs des règles de corrélation. </li><li>  La gestion des catégories vous permet d'éviter les vérifications inutiles dans le code des règles de corrélation afin de comprendre la sémantique de l'événement.  Par exemple, il n'est pas nécessaire de vérifier la disponibilité des données dans certains champs pour déterminer que l'événement décrit l'entrée de l'utilisateur et non la sauvegarde du système. </li><li>  La catégorisation est une base terminologique générale qui aide à rédiger les règles de corrélation et d'enquête sur les incidents, à opérer avec un seul ensemble de termes et leurs significations généralement acceptées.  Par exemple, pour bien comprendre que la modification de la configuration réseau et la modification de la configuration logicielle sont des types d'événements complètement différents qui ont des significations complètement différentes. </li></ol><br>  Pour obtenir tout cela, vous devez créer un système de catégorisation des événements et l'utiliser lors de l'écriture de règles de corrélation, des enquêtes sur les incidents et dans les cas où plusieurs personnes travaillent dans une organisation dotée d'un système SIEM. <br><a name="Requirements"></a><br>  Quant aux exigences du système de catégorisation, il doit satisfaire quatre propriétés: <br><br><ol><li>  <b>Sans ambiguïté</b> .  Un même événement doit être assigné à une et une seule catégorie. </li><li>  <b>Compacité</b> .  Le nombre total de catégories doit être tel qu'elles puissent être facilement mémorisées par un expert. </li><li>  <b>Hiérarchie</b> .  Le système doit être construit sur un schéma hiérarchique et se composer de plusieurs niveaux, car il s'agit de la structure la plus simple à retenir.  De plus, la hiérarchie devrait être construite sur le principe du «du général au particulier»: au premier niveau, il y a des catégories plus «générales» et au dernier - des catégories hautement spécialisées. </li><li>  <b>Extensibilité</b> .  Les principes selon lesquels il est construit devraient permettre de mettre à jour le système de catégorisation lorsque de nouveaux types d'événements apparaissent nécessitant des catégories distinctes, sans changer l'approche principale. </li></ol><br>  Passons à la description du système de catégorisation: nous allons commencer par deux grands domaines, qui incluent des sources d'événements connectés à SIEM et dans lesquels ils génèrent des événements. <br><br><a name="MainDomains"></a><h1>  Domaines source et événement </h1><br>  Le déploiement de SIEM commence souvent par la connexion de sources qui génèrent des événements disparates.  Une propriété importante de ces événements est qu'ils reflètent la fonctionnalité des sources elles-mêmes. <br><br>  On distingue deux domaines globaux: <br><br><ol><li>  Sources informatiques - logiciels d'application et matériel à l'échelle du système qui génèrent des événements informatiques. </li><li>  Sources IB - logiciels et matériels spécialisés pour la sécurité des informations de l'entreprise qui génèrent des événements IB. </li></ol><br>  Considérez les différences fondamentales entre les événements de ces domaines. <br><br>  Les sources informatiques signalent la survenance de tout phénomène dans le système automatisé, sans leur évaluation du niveau de sécurité - «bon» ou «mauvais».  Exemples: application d'une nouvelle configuration par un appareil, sauvegarde de données, transfert d'un fichier sur un réseau, désactivation d'un port réseau sur un commutateur. <br><br>  Contrairement aux sources informatiques, les sources SI ont des connaissances externes supplémentaires sur la façon d'interpréter certains événements du point de vue de la sécurité - la politique.  Ainsi, l'utilisation de politiques permet aux sources du SI de prendre des décisions - si le phénomène observé est «bon» ou «mauvais» - et de le signaler au SIEM via les événements IB générés. <br><br>  Prenons l'exemple suivant: Ainsi, en général, un pare-feu de niveau nouvelle génération considère un événement de transfert de fichiers sur le réseau comme «mauvais»: il s'avère que le fichier est un document Word qui est transféré du réseau interne de l'entreprise à un serveur externe via FTP, et la stratégie configurée interdit de telles interactions informationnelles.  La désactivation du port réseau est interprétée comme une violation des droits d'accès par la décision de contrôler les actions des administrateurs: puisque la déconnexion du port est effectuée par l'utilisateur Alex, qui n'y a pas de droits, et se produit pendant ses heures non travaillées, selon la politique de sécurité configurée. <br><br>  Cependant, il n'est pas tout à fait vrai de dire que les sources de sécurité de l'information ne génèrent que des événements de sécurité de l'information.  Les sources IB génèrent des événements IB et IT.  Les sources SI génèrent des événements informatiques, en règle générale, lorsqu'elles signalent un changement dans leur état: changements de configuration, commutation de nœuds de cluster et sauvegardes.  En général, ces événements peuvent être attribués à l'audit interne des actions et à l'état de la source.  Dans le même temps, lorsque l'activité concerne l'application de politiques de sécurité, la même source génère déjà des événements de sécurité des informations, rapportant ainsi les résultats de leur application. <br><br>  Nous avons délibérément décrit les différences entre les deux domaines avec autant de détails.  Les événements de chaque domaine ont leur propre signification et peuvent parfois différer fondamentalement les uns des autres.  Ces différences ont conduit à l'existence de deux systèmes de catégorisation d'événements distincts responsables des événements informatiques et des événements de sécurité de l'information. <br><br><img src="https://habrastorage.org/webt/lh/q6/2j/lhq62jphooh6zal7eks_kohztki.png" alt="Catégorie de événements.  Domaines d'événements."><br>  <i>Domaines d'événements</i> <br><br>  Il existe un autre type rare de sources qui génèrent des événements d'un troisième domaine distinct - le domaine des attaques.  Les événements de ce domaine peuvent être obtenus à partir de sources du niveau de protection des points d'extrémité (Endpoint Protection), d'autres SIEM subordonnés (s'ils sont organisés dans une hiérarchie) ou d'autres solutions capables de déterminer, sur la base de l'analyse d'événements informatiques et (ou) de sécurité des informations, qu'un système automatisé ou une partie est soumise à une attaque de pirate. <br><br>  Dans le cadre de cette série d'articles, nous utiliserons les concepts suivants pour séparer les attaques et les événements de sécurité de l'information des moyens de défense de bout en bout: <br><br><ol><li>  Une attaque est une séquence malveillante d'actions d'un attaquant visant à atteindre un objectif spécifique au sein d'une entreprise. </li><li>  Une attaque peut consister en un ou plusieurs événements - une chaîne d'événements de sécurité des informations et / ou des événements informatiques qui constituent des violations des politiques de sécurité des informations. </li></ol><br>  Il existe plusieurs approches pour catégoriser les attaques, par exemple, la popularité croissante de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITER Adversarial Tactics, Techniques, and Common Knowledge (ATT &amp; CK)</a> , mais nous ne considérerons pas ce domaine dans nos articles. <br><br><a name="ITCategorization"></a><h1>  Système de catégorisation des événements informatiques </h1><br>  Les logiciels et le matériel d'application à l'échelle du système, que nous attribuons aux sources informatiques des événements, sont conçus pour mettre en œuvre ou prendre en charge certains processus pour remplir ses tâches.  Au cours de leur décision, les faits commis sont enregistrés par des événements informatiques distincts.  Ils peuvent être attribués au processus dans lequel chacun d'eux s'est produit. <br><br>  En isolant les processus se produisant dans les sources informatiques, nous pouvons former le premier niveau de catégorisation (que nous appellerons plus tard le contexte).  Il définira un champ sémantique qui interprétera correctement les événements informatiques. <br><br>  Lors de l'analyse des événements, il apparaît clairement que chacun d'eux décrit l'interaction de plusieurs entités dans le cadre d'un processus déjà défini.  En sélectionnant la principale de ces entités comme objet d'interaction, nous formons le deuxième niveau de catégorisation. <br><br>  Le comportement de l'entité principale dans l'événement dans le cadre d'un processus spécifique jouera le rôle du troisième niveau de catégorisation des événements informatiques. <br>  Au total, à la sortie, nous avons obtenu les niveaux suivants: <br><br><ol><li>  Contexte (processus) dans lequel l'événement s'est produit. </li><li>  L'objet (entité principale) décrit par l'événement. </li><li>  La nature du comportement de l'objet dans le contexte. </li></ol><br>  Ainsi, nous avons formé trois niveaux de catégorisation des événements informatiques, vous permettant d'opérer facilement sur des événements sémantiquement similaires provenant de différents types de sources dans l'infrastructure informatique. <br><br>  Pour garantir l'unicité du système de catégorisation résultant, nous formerons des domaines distincts pour chaque niveau. <br><br><img src="https://habrastorage.org/webt/yj/8h/qo/yj8hqoi_fevntq2utkvczwh5g_o.png" alt="Catégorie des événements informatiques.  Premier niveau."><br>  <i>Système de catégorisation des événements informatiques.</i>  <i>Premier niveau.</i> <br><br>  Une approche de processus similaire pour travailler avec les systèmes informatiques est également utilisée dans ITSM (IT Service Management, IT service management), qui postule certains processus de base qui ont lieu dans les services informatiques.  Nous nous appuierons sur cette approche lors de la formation de processus possibles, ou en d'autres termes, de contextes, lors de l'examen des sources d'événements informatiques. <br><br>  Nous distinguons les principaux processus de ce niveau: <br><br><ul><li>  <b>Gestion de la continuité des activités</b> - événements liés aux opérations pour maintenir le fonctionnement continu des systèmes: processus de réplication, migration et synchronisation des machines virtuelles, des bases de données et des stockages, opérations de sauvegarde et de restauration; </li><li>  <b>Gestion des</b> utilisateurs et des droits ( <b>gestion des</b> utilisateurs et des droits) - événements liés à l'utilisation des groupes et des comptes d'utilisateurs; </li><li>  <b>Gestion des accès</b> - événements associés aux processus d'authentification, d'autorisation, de comptabilité (AAA) et à toute tentative d'accès au système; </li><li>  <b>Gestion de la disponibilité</b> - événements associés à toutes les actions pour démarrer, arrêter, allumer, éteindre, arrêter des entités, y compris les messages d'information des systèmes de contrôle d'accès aux entités; </li><li>  <b>Gestion du déploiement</b> (gestion des événements) - événements associés à l'introduction de nouvelles entités dans le système de l'extérieur, ainsi qu'à la suppression de l'entité de ce système; </li><li>  <b>Gestion des interactions réseau</b> - événements liés à la transmission de données via le réseau, y compris l'établissement de connexions, l'ouverture et la fermeture de tunnels; </li><li>  <b>Gestion du réseau</b> - événements liés à la pile réseau: y compris toutes les actions avec des politiques et des règles pour le filtrage du réseau; </li><li>  <b>Gestion</b> de l'infrastructure virtuelle (gestion de l'infrastructure virtuelle) - événements liés à l'infrastructure de virtualisation; </li><li>  <b>Gestion de la base de données</b> - événements liés au fonctionnement du SGBD et aux actions des utilisateurs et des processus qu'il contient; </li><li>  <b>Gestion du système</b> - événements liés au fonctionnement du système d'exploitation et des logiciels qui font partie du système d'exploitation; </li><li>  <b>Generic Application Management</b> (gestion d'autres applications) - événements associés au fonctionnement d'autres applications installées par l'utilisateur et ne faisant pas partie du système d'exploitation. </li></ul><br>  Il est important de comprendre que différents processus peuvent se produire sur la même source informatique.  Ainsi, par exemple, dans le service DHCP déployé sur Unix, le processus de gestion du réseau (générant, par exemple, un événement de mise à jour d'adresse IP sur les nœuds) et le processus de gestion du système, générant un événement de redémarrage du service ou une erreur d'analyse du fichier de configuration, peuvent se produire. <br><br><h2>  Le deuxième niveau de catégorisation des événements informatiques (entités) </h2><br><img src="https://habrastorage.org/webt/k_/rn/s6/k_rns6dddokqnddjqsdz9kjfdnk.png" alt="Système de catégorisation des événements IB.  Les premier et deuxième niveaux."><br>  <i>Système de catégorisation des événements IB.</i>  <i>Les premier et deuxième niveaux.</i> <br><br>  Le deuxième niveau reflète l'objet d'interaction décrit dans l'événement.  Notez qu'un événement peut décrire plusieurs entités.  Par exemple, prenez l'événement suivant: "l'utilisateur a envoyé une demande au serveur de certificats pour l'émission d'un certificat personnel."  Dans les événements de ce type, il est nécessaire de choisir une entité de base comme objet d'interaction, qui est centrale dans l'événement.  Ici, nous pouvons déterminer que l'entité principale est une «demande à un serveur de certification», car l'utilisateur est évidemment le sujet de l'interaction, et le certificat personnel est le résultat de l'interaction du sujet et de l'objet.  En collectant et en analysant un large éventail d'événements, nous pouvons distinguer des groupes d'entités: <br><br><ul><li>  <b>identification</b> : compte d'utilisateur, groupe d'utilisateurs, certificat - entités qui vous permettent d'identifier l'utilisateur ou le système; </li><li>  <b>exécutable</b> : application, module exécutable - tout ce qui peut être lancé par le système d'exploitation et contient un certain algorithme; </li><li>  <b>règles et stratégies</b> : toutes les règles, stratégies d'accès, y compris les stratégies de groupe Windows OC; </li><li>  <b>l'essence du stockage d'informations dans le système d'exploitation</b> : un fichier, une clé de registre, un objet d'un groupe de répertoires - tout ce qui peut servir de stockage d'informations au niveau de l'application; </li><li>  <b>connexions réseau</b> : sessions, flux, tunnels - entités qui transportent un flux de données d'un nœud à un autre; </li><li>  <b>Entités d'identification réseau du nœud</b> : adresse réseau, socket, directement le nœud réseau lui-même - toutes ces entités dont aucun système de surveillance ne peut se passer; </li><li>  <b>réseau L5-L7</b> : message électronique, flux multimédia, liste de distribution - entités qui transmettent des informations aux niveaux L5-L7 du modèle OSI; </li><li>  <b>réseau de service</b> : zone DNS, table de routage.  Ces entités sont responsables du bon fonctionnement du réseau, sans porter de charge utile pour l'utilisateur final; </li><li>  <b>entités de configurations tolérantes aux pannes</b> : RAID, éléments de réseau de cluster; </li><li>  <b>l'essence des systèmes de virtualisation</b> : machines virtuelles, disques durs virtuels, instantanés de machines virtuelles; </li><li>  <b>entités de base de données</b> : tables, bases de données, SGBD; </li><li>  <b>équipements physiques</b> : <b>appareils</b> enfichables, éléments ACS (tourniquets, caméras IP); </li><li>  <b>autres entités OS</b> : une commande dans la console de gestion, la console système, le journal système - les entités OS qui ne rentrent pas dans d'autres catégories; </li><li>  <b>autres entités de réseau</b> : interface de réseau, ressource de réseau public - les entités du sous-système de réseau qui ne rentrent pas dans d'autres catégories. </li></ul><br>  Ces groupes ne prétendent pas être exhaustifs, mais couvrent les principales tâches d'attribution des catégories de deuxième niveau.  Si nécessaire, les groupes représentés peuvent s'étendre. <br><br><h2>  Le troisième niveau de catégorisation des événements informatiques (nature de l'interaction) </h2><br><img src="https://habrastorage.org/webt/x5/wc/ja/x5wcja8h3u9jrersnj_au4im9ke.png" alt="Système de catégorisation des événements informatiques.  Les premier, deuxième et troisième niveaux."><br>  <i>Système de catégorisation des événements informatiques.</i>  <i>Les premier, deuxième et troisième niveaux.</i> <br><br>  Dans un processus spécifique, le comportement de l'entité principale peut être réduit aux valeurs suivantes: <br><br><ul><li>  <b>Contrôle</b> - interaction qui affecte le fonctionnement de l'entité; </li><li>  <b>Communication</b> - communication entre entités; </li><li>  <b>Manipulation</b> - actions pour travailler avec l'entité elle-même, y compris la manipulation de ses données; </li><li>  <b>Incorporation</b> - interaction, à la suite de laquelle une nouvelle entité est ajoutée au contexte (ou l'entité est supprimée du contexte); </li><li>  <b>État</b> - événements d'information sur les changements d'état d'une entité. </li></ul><br>  Le dernier domaine se distingue entre autres: il comprend des événements qui ne décrivent en fait aucune interaction, mais contiennent des informations sur l'entité ou les transitions d'entité entre états.  Par exemple, un événement qui décrit uniquement l'état actuel du système (sur l'heure actuelle du système, sur un changement de statut d'une licence de produit). <br><br>  Les événements décrivent non seulement l'interaction elle-même, mais aussi son résultat.  Il est important de comprendre que le contexte, l'essence principale et le comportement d'un objet dans le contexte ne dépendent pas du résultat de l'interaction.  Le résultat peut être «succès» et «échec».  Un événement peut également décrire le processus continu d'interaction incomplète.  Nous appellerons ce statut «en cours». <br><br><h2>  Formation d'un ensemble de données basé sur trois niveaux </h2><br>  Pour chaque domaine de chaque niveau, vous pouvez sélectionner un ensemble de données spécifique contenant des événements. <br><br>  Analysons un exemple d'événement: <br><br><img src="https://habrastorage.org/webt/0j/e6/so/0je6sogj5o9rk3dbfr4qjylafac.png"><br><br>  Il peut être interprété comme «la connexion du nœud 10.0.1.5 au nœud 192.168.149.2 a été déconnectée».  En regardant le contexte d'un événement, vous pouvez voir qu'il décrit une connexion réseau.  En conséquence, nous tombons dans le contexte de la «gestion des interactions réseau». <br><br>  Ensuite, nous déterminons l'entité principale de l'événement.  Évidemment, l'événement décrit trois entités: deux nœuds et une connexion réseau.  Sur la base des recommandations ci-dessus, nous comprenons que l'entité principale dans ce cas n'est qu'une connexion réseau et que les nœuds sont des participants à l'interaction, des points de terminaison qui effectuent des actions sur l'entité.  Au total, nous obtenons l'entité principale du domaine Connexions réseau, et l'action effectuée sur l'entité est la «fermeture du canal de communication», qui peut être attribuée au domaine de la communication. <br><br>  Cependant, nous avons encore beaucoup de données qui pourraient être enregistrées à partir de l'événement.  Ainsi, un ensemble d'entités du deuxième niveau «Connexions réseau» ont des propriétés communes: <br><br><ul><li>  initiateur de connexion (adresse + port + interface); </li><li>  récepteur (cible) de la connexion (adresse + port + interface); </li><li>  Protocole sur lequel la connexion est établie. </li></ul><br>  De plus, par exemple, l'action du troisième niveau de catégorisation «fermeture de la connexion», appartenant au domaine Communication, peut contenir les données suivantes, quelle que soit la connexion fermée et quelle source l'a signalé: <br><br><ul><li>  nombre d'octets envoyés / envoyés; </li><li>  nombre de paquets transmis / envoyés; </li><li>  durée. </li></ul><br>  A titre d'exemple, on peut distinguer un ensemble d'entités de base «Entités de stockage d'informations dans l'OS», qui se caractérisent par les données suivantes: <br><br><ul><li>  nom de l'entité; </li><li>  le chemin de localisation de l'entité dans le système d'exploitation; </li><li>  taille de l'entité; </li><li>  privilèges d'accès à l'entité. </li></ul><br>  Un ensemble d'actions liées à cette entité, par exemple la «copie», qui est incluse dans le domaine de troisième niveau «Manipulation», peut être caractérisé par les propriétés suivantes: <br><br><ul><li>  Le nouveau nom de l'entité </li><li>  une nouvelle façon d'organiser l'entité; </li><li>  Nouveaux privilèges d'accès aux entités. </li></ul><br>  En option, nous pouvons obtenir toutes ces données de l'événement.  L'essentiel est que la catégorie que nous avons définie nous permet de mettre en évidence un ensemble spécifique de données qui peuvent être extraites de l'événement, sachant à l'avance que ces données seront sémantiquement similaires. <br><br>  Et à cet égard, les catégories deviennent un outil pratique.  En comparant un certain ensemble de ces données à chaque niveau de domaine, nous avons la possibilité de stocker des données sémantiquement similaires dans les mêmes champs d'un événement normalisé, quels que soient le fabricant et le modèle de la source d'événement.  Cela simplifie considérablement la recherche de données dans un grand volume d'événements et, par conséquent, la mise en œuvre de corrélations pour de tels événements. <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exemples de système de catégorisation </font></font></h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situation 1: Vous</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devez trouver tous les événements qui décrivent la connexion et la déconnexion des périphériques de toutes les sources. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chacune des sources génère des événements, après normalisation dont les </font><font style="vertical-align: inherit;">catégories contiennent les catégories </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (premier niveau de catégorisation), </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (deuxième niveau) et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (troisième niveau). </font><font style="vertical-align: inherit;">Dans la situation décrite, tous les événements d'intérêt contiendront des catégories:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 2: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">équipement physique;</font></font></b> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 3: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intégration.</font></font></b> </li></ul><br>      ,          . <br><br>  ,        : <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 = “&lt;      &gt;” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = “Embedding” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  <b>Situation 2:</b> Il est nécessaire de trouver tous les événements qui décrivent une tentative de modification des objets du système de fichiers avec un nom commençant par «boot». <br><br>  Les sources connectées à SIEM peuvent produire des événements de modification de fichier complètement différents.  Cependant, l'attribution des catégories appropriées aux événements vous permet de sélectionner le nécessaire dans l'ensemble du tableau: <br><br><ul><li>  Niveau 1: <b>gestion du système;</b> </li><li>  Niveau 2: <b>Entités de stockage d'informations dans le système d'exploitation;</b> </li><li>  Niveau 3: <b>Manipulation.</b> </li></ul><br>  De plus, une condition est spécifiée par le nom de fichier: en utilisant des ensembles de données prédéfinis, nous pouvons nous attendre à ce que pour cette catégorie le nom de fichier soit dans le champ object.name.  Par conséquent, pour sélectionner des événements, vous pouvez former la requête suivante: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 = “<span class="hljs-keyword"><span class="hljs-keyword">System</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Management</span></span>” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level2 = “&lt;        &gt;” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = “Manipulation” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (object.name <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> “boot.%”)</code> </pre> <br>  Si une entité a été copiée, nous trouverons des informations à son sujet et qu'elle a été copiée à partir d'une autre entité - cela donnera un élan à une enquête plus approfondie. <br><br>  <b>Cas 3:</b> Il est nécessaire de fournir un profilage simple des connexions réseau sur les routeurs frontaliers de différents fabricants installés dans les succursales de l'entreprise.  SIEM reçoit des événements de chacun de ces routeurs de périphérie. <br><br>  Chacun des routeurs génère des événements informatiques, après normalisation dont les champs Niveau 1, Niveau 2, Niveau 3 contiennent des catégories.  Dans l'exemple décrit, pour le profilage, il est nécessaire et suffisant d'analyser les événements concernant l'ouverture et la fermeture des connexions réseau.  Selon le système de catégorisation présenté, ces événements contiendront les champs de catégorie suivants: <br><br><ul><li>  Niveau 1: <b>gestion des interactions réseau;</b> </li><li>  Niveau 2: <b>Connexions réseau;</b> </li><li>  Niveau 3: <b>Communication.</b> </li></ul><br>  De plus, pour les opérations d'ouverture et de fermeture de connexions, vous pouvez spécifier les actions «ouvrir» et «fermer», ainsi que le statut de l'action «succès». <br><br>  De plus, ayant des ensembles de données pour chacune des catégories de la catégorie, vous pouvez être sûr que l'heure de début de la connexion sera enregistrée dans l'événement d'ouverture de connexion et que les informations sur les nœuds participant à l'interaction réseau seront placées dans l'événement de fermeture de connexion, ainsi que dans les champs «Nombre d'octets transmis», «nombre de paquets transmis» et «durée» seront placés les données correspondantes sur la durée de la connexion et la quantité d'informations transmises, respectivement. <br><br>  Ainsi, en filtrant le flux d'événements par les catégories et actions spécifiées, vous pouvez sélectionner uniquement les événements nécessaires pour l'opération de profilage, sans avoir à spécifier une liste d'identificateurs d'événements spécifiques. <br><br><h1>  Système de catégorisation des événements IB </h1><br>  Avant de parler du système de catégorisation, notons que nous ne considérerons que les événements provenant des défenses.  La catégorisation des attaques de pirates en tant que chaînes d'actions malveillantes est un domaine distinct avec son propre système de catégorisation. <br><br>  Le système de catégorisation des événements de sécurité de l'information est basé sur un certain paradigme.  Il est formulé comme suit: tout incident qui se produit dans un système automatisé se reflète sur un ou plusieurs supports à la fois: le niveau d'un hôte spécifique, le niveau du réseau et le niveau de l'environnement physique. <br><br>  Les outils de sécurité opérant à ces niveaux identifient l'incident ou ses «échos» et génèrent des événements de sécurité de l'information qui entrent dans le SIEM. <br><br>  Par exemple, la transmission d'un fichier malveillant sur un réseau à un hôte spécifique peut être détectée au niveau du réseau et de l'hôte, dans le processus de traitement du trafic réseau au moyen de la protection du réseau ou en analysant les zones de mémoire RAM avec les modules de protection antivirus appropriés. <br><br>  L'accès physique non autorisé aux locaux peut être détecté au niveau de l'environnement physique au moyen de systèmes de contrôle d'accès et au niveau de l'hôte, au moyen de SZI de la NSD lorsque l'utilisateur est autorisé à héberger pendant les heures creuses. <br><br>  Lorsque vous travaillez avec des événements SI, il est souvent nécessaire de comprendre dans quel environnement l'incident a été enregistré.  Et déjà en partant de là, construisez un nouveau chemin d'investigation ou formez la logique de la règle de corrélation.  Ainsi, l'environnement de détection est le premier niveau d'un système de catégorisation. <br><br><h2>  Le premier niveau du système de catégorisation des événements de l'IB </h2><br><img src="https://habrastorage.org/webt/ig/ay/vz/igayvzurcou73lz_txlya7rqyya.png" alt="Système de catégorisation des événements IB.  Premier niveau."><br>  <i>Système de catégorisation des événements IB.</i>  <i>Premier niveau.</i> <br><br><ul><li>  <b>Violations</b> de l'hôte (événements du niveau hôte) - événements provenant des moyens de protection installés sur les postes de travail et serveurs finaux.  En règle générale, les événements de sécurité de l'information de ce niveau décrivent le déclenchement de politiques de sécurité à la suite de l'analyse de l'état interne de l'hôte au moyen d'une protection.  Sous l'analyse de l'état interne, on entend ici l'analyse des processus en cours, des données dans les domaines de la RAM, des fichiers sur le disque. <br>  <b>Types de sources d'événements</b> : outils de protection antivirus, systèmes de surveillance de l'intégrité, systèmes de détection d'intrusion au niveau de l'hôte, contrôle d'accès et systèmes de contrôle d'accès. </li><li>  <b>Violations de réseau</b> - événements provenant de systèmes qui analysent le trafic réseau et lui appliquent un ensemble de politiques de sécurité établies. <br>  <b>Types de sources d'événements</b> : pare-feu, systèmes de détection et de prévention des intrusions, systèmes de détection DDoS.  Certaines protections d'hôte disposent également de modules d'analyse du trafic réseau distincts.  Par exemple, des outils de protection antivirus et certains dispositifs antivirus domestiques de NSD. </li><li>  <b>Violations physiques</b> (violations du niveau de l'environnement physique) - événements provenant de la sécurité physique. <br>  <b>Types de sources d'événements</b> : systèmes de sécurité de périmètre, systèmes de contrôle d'accès, systèmes de protection contre les fuites d'informations via des canaux vibro-acoustiques et des canaux PEMIN. <br>  Cette catégorie comprend également les incidents identifiés par le service de sécurité physique ou économique au cours des activités internes et introduits dans les bases de données internes de l'entreprise, dont les informations peuvent être collectées par le SIEM.  Pour des raisons d'organisation, il s'agit d'un événement extrêmement rare, mais toujours possible. </li></ul><br><h2>  Les deuxième et troisième niveaux du système de catégorisation des événements de l'IB </h2><br>  Le deuxième niveau du système de catégorisation est associé au premier, mais présente des fonctionnalités en raison des conditions préalables suivantes: <br><br><ul><li>  les incidents de sécurité des informations ne se produisent pas toujours dans l'environnement physique; </li><li>  les incidents dans l'environnement physique ne sont pas toujours associés à des incidents de sécurité de l'information, mais il y a aussi des intersections; </li><li>  les incidents au niveau du réseau et de l'hôte final ont souvent une structure et une sémantique similaires. </li></ul><br>  Par conséquent, au deuxième niveau, un groupe de catégories correspondant aux violations du niveau de l'environnement physique et des groupes de catégories communes aux violations du réseau et du niveau hôte sont distingués. <br><br>  Le troisième niveau du système de catégorisation clarifie le second et décrit directement les violations elles-mêmes, dont l'essence se reflète dans les événements de sécurité de l'information. <br><br>  Nous avons analysé les systèmes de catégorisation d'événements pour les solutions de sécurité IBM QRadar, Micro Focus Arcsight et Maxpatrol SIEM pour les violations au niveau du réseau et de l'hôte.  Selon les résultats, ils ont conclu: ils sont tous très similaires et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">eCSIRT.net mkVI</a> peut servir de système de catégorisation le plus complet et unificateur.  C'est elle qui a été prise comme base dans le système de catégorisation ci-dessous. <br><br><img src="https://habrastorage.org/webt/eh/-e/gs/eh-egskwu2pfw2sjhrlucrdii80.png" alt="Système de catégorisation des événements IB.  Violations au niveau de l'hôte et au niveau du réseau."><br>  <i>Système de catégorisation des événements IB.</i>  <i>Violations au niveau de l'hôte et au niveau du réseau.</i> <br><br><ul><li>  <b>Contenu abusif</b> - contenu livré légalement à l'utilisateur final, provoquant des actions illégales (intentionnelles ou non intentionnelles) ou contenant des données malveillantes / indésirables. <br>  <b>Catégories de troisième niveau</b> : Spam, Phishing. <br>  <b>Types de sources d'événements</b> : serveurs proxy avec contrôle de contenu (Microsoft Threat Management Gateway), outils de protection du trafic Web (Cisco Web Security Appliance, lame de filtrage Check Point URL), outils de protection du courrier (Cisco Email Security Appliance, Kaspersky Secure Mail Gateway), Sécurité de l'hôte final avec des modules de contrôle Web et de messagerie intégrés (McAfee Internet Security, Kaspersky Internet Security). </li><li>  <b>Collecte d'informations</b> - collecte de données sur l'objet de la protection contre les sources d'information ouvertes et fermées, en utilisant des méthodes de collecte actives et passives. <br>  <b>Catégories de troisième niveau</b> : empreinte digitale, reniflement, numérisation, Bruteforce. <br>  <b>Types de sources d'événements</b> : en règle générale, fonctionnalités de sécurité réseau, à savoir: pare-feu (Cisco Adaptive Security Appliance, lame Checkpoint Firewall), outils de détection et de prévention des intrusions (Cisco Firepower Next-Generation IPS, lame Check Point IPS). </li><li>  <b>Disponibilité</b> - une violation malveillante ou accidentelle de la disponibilité des services et systèmes individuels en général. <br>  <b>Catégories de troisième niveau</b> : DDoS, DoS, Flood. <br>  <b>Types de sources d'événements</b> : pare-feu et systèmes de détection et de prévention des intrusions, ainsi que des systèmes de détection et de blocage des attaques DoS réseau (Arbor Pravail APS, Arbour Peakflow SP, Radware DefensePro, IFI Soft APK «Perimeter»). </li><li>  <b>Exploration des vulnérabilités</b> - Identifie une vulnérabilité ou un groupe de vulnérabilités.  Il est important de noter que cette catégorie décrit les événements de sécurité des informations concernant la détection de vulnérabilité, mais pas son fonctionnement. <br>  <b>Catégories de troisième niveau</b> : Firmware, Software. <br>  <b>Types de sources d'</b> événements: événements du SIEM intégré ou du scanner d'audit et de sécurité externe intégré (Tenable Nessus Vulnerability Scanner, Positive Technologies Maxpatrol 8, Positive Technologies XSpider, Qualys Vulnerability Scanner, Burp Suit). </li><li>  <b>Exploitation de la vulnérabilité</b> (exploitation de la vulnérabilité) - identification de l'impact négatif délibéré sur le système ou exploitation de la vulnérabilité du système.  Dans ce cas, les catégories de troisième niveau peuvent souvent inclure des techniques d'attaque individuelles répertoriées dans MITRE ATT &amp; CK (lien) et définies par des fonctions de sécurité. <br>  <b>Catégories de troisième niveau</b> : entités externes XML, script intersite, désérialisation non sécurisée, empoisonnement du routage, etc. <br>  <b>Types de sources d'événements</b> : systèmes de détection et de prévention des intrusions au niveau du réseau (Positive Technologies Network Attack Discovery, Positive Technologies Web Application Firewall, Imperva Web Application Firewall, Cisco Firepower Next Generation IPS, Check Point IPS blade)) ou au niveau de l'hôte (Carbon Black Cb Defense, Modules de protection antivirus HIPS, OSSEC). </li><li>  <b>Hacktool</b> (hacking utilities): utilisation d'utilitaires utilisés pour pirater des systèmes ou mettre en œuvre d'autres actions illégales pour obtenir des informations confidentielles et contourner les outils de sécurité. <br>  <b>Catégories de troisième niveau</b> : Scanner, Bruteforcer, Exploit Kit, Password dumper, Vulnerability scanner, TOR client, Sniffer, Shellcode, Keylogger. <br>  <b>Types de sources d'événements</b> : systèmes de détection et de prévention des intrusions au niveau du réseau et au niveau de l'hôte, scanners de sécurité et d'audit, outils de protection antivirus. </li><li>  <b>Code malveillant</b> - Détecte l'utilisation de code malveillant. <br>  <b>Catégories de troisième niveau</b> : Virus, Ver, Botnet, Rootkit, Bootkit, Trojan, Backdoor, Cryptor. <br>  <b>Types de sources d'événements</b> : tous les outils de protection antivirus du réseau et de l'hôte, systèmes de détection et de prévention des intrusions au niveau du réseau. </li><li>  <b>Conformité</b> (violation de la conformité) - l'identification des faits de non-conformité aux contrôles définis dans les politiques de conformité.  Dans ce cas, les politiques de conformité signifient les exigences PCI DSS, la commande FSTEC n ° 21 et les normes de sécurité de l'entreprise. <br>  <b>Catégories de troisième niveau</b> : contrôle d'intégrité, contrôle des paramètres du système d'exploitation, contrôle des paramètres de l'application. <br>  <b>Types de sources d'événements</b> : scanners de sécurité et d'audit. </li><li>  <b>Fuite d'informations</b> - fuite de données confidentielles via n'importe quel canal de communication. <br>  <b>Catégories de troisième niveau</b> : e-mail, Messenger, réseau social, appareil mobile, stockage amovible. <br>  <b>Types de sources d'événements</b> : systèmes de prévention des fuites de données (Rostelecom - Solar Dozor, InfoWatch Traffic Monitor). </li><li>  <b>Anomalie</b> (anomalies) - une déviation significative des paramètres de l'objet de protection ou de son comportement par rapport à la norme précédemment établie. <br>  <b>Catégories de troisième niveau</b> : statistiques, comportementales. <br>  <b>Types de sources d'événements</b> : outils de protection réseau de nouvelle génération, systèmes de prévention des fuites de données, systèmes de classe d'analyse du comportement des utilisateurs et des entités (Splunk User Behavior Analytics, Securonix User and Entity Behavior Analytics, Exabeam Advanced Analytics). </li></ul><br><img src="https://habrastorage.org/webt/d8/zs/xq/d8zsxq3vzpqv8xa8p9415yzs_eg.png" alt="Système de catégorisation des événements IB.  Violations du niveau de l'environnement physique."><br>  <i>Système de catégorisation des événements IB.</i>  <i>Violations du niveau de l'environnement physique.</i> <br><br>  Les violations de l'environnement physique, importantes du point de vue de la sécurité de l'information, ont leur propre "branche" distincte dans le système de catégorisation.  Il est important que dans ce cas le système de catégorisation ne comporte qu'un seul niveau. <br><br>  Une telle représentation «tronquée» du système de catégorisation est principalement due à des cas extrêmement rares d'intégration de SIEM avec des équipements de sécurité physique.  Les exceptions sont les systèmes de contrôle d'accès et de comptabilité (ACS), qui sont souvent connectés au SIEM.  Sinon, lors de la compilation de cette «branche» du système de catégorisation, nous n'avions pas suffisamment de données statistiques pour systématiser cette direction particulière. <br><br><ul><li>  <b>Vol</b> (vol) - vol de supports physiques ou d'appareils informatiques (ordinateurs portables, tablettes, smartphones) contenant des informations confidentielles sur le territoire de l'entreprise ou des employés de l'entreprise. <br>  <b>Types de sources d'événements</b> : bases d'incidents des services de sécurité physique, systèmes du personnel. </li><li>  <b>Intrusion</b> (pénétration physique) - contournement non autorisé ou non réglementé du système de protection physique. <br>  <b>Types de sources d'événements</b> : bases d'incidents des services de sécurité physique, ACS, systèmes de sécurité de périmètre. </li><li>  <b>Dommages</b> (dommages) - dommages ciblés, destruction, réduction de la durée de vie de l'équipement ou des canaux de communication. <br>  <b>Types de sources d'événements</b> : base de données des incidents de sécurité physique. </li></ul><br><h2>  Exemples d'utilisation de systèmes de catégorisation </h2><br>  Nous appliquons le système de catégorisation décrit pour écrire des règles de corrélation de haut niveau et rechercher des événements dans le processus d'enquête.  Considérez deux situations. <br><br>  <b>Situation 1</b> : au moyen de la règle de corrélation, il est nécessaire d'identifier une fuite d'informations confidentielles due au piratage des actifs du système automatisé.  SIEM reçoit des événements des fonctionnalités de sécurité suivantes: <br><br><ul><li>  systèmes de prévention des fuites de données; </li><li>  systèmes de détection et de prévention des intrusions au niveau du réseau; </li><li>  systèmes de détection et de prévention des intrusions au niveau de l'hôte; </li><li>  outil de protection antivirus. </li></ul><br>  Chacun d'eux génère des événements IB, après normalisation dans les <b>champs Level1</b> , <b>Level2</b> , <b>Level3</b> dont les catégories sont apposées. <br>  Le texte de la règle de corrélation en pseudo-code peut ressembler à ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#         .    «Host_poisoning event Host_poisoning»: #          ,        group by dst.host #     hostname/fqdn/ip ,     filter { Level2 = “Malicious Code” OR Level2 = “Vulnerability Exploitation” } #           : event Data_leak: group by dst.host filter { Level2 = “Information Leak” AND Level3 = “Email” #        } #      Host_poisoning_and_data_leakage:   «Host_poisoning»,   «Data_leak»   24       : rule Host_poisoning_and_data_leakage: (Host_poisoning —&gt; Data_leak) within 24h emit { #  —    }</span></span></code> </pre> <br>  <b>Situation 2:</b> nous enquêtons sur l'incident sur un hôte spécifique - alexhost.company.local.  Vous devez comprendre ce qui lui est arrivé entre 04h00 et 06h00 le 11/08/2018.  Pendant ce temps, il y a environ 21,6 millions d'événements de cet hôte dans le SIEM lui-même (le flux d'événements moyen est de 3000 EPS).  Il est maintenant 11h00 le 09/09/2018, tous les événements sont dans la base de données SIEM, au moment de l'incident, aucune règle de corrélation n'a été établie dans SIEM. <br><br>  De toute évidence, l'analyse manuelle de tous les événements est une mauvaise idée.  Il faut en quelque sorte réduire leur volume et localiser le problème.  Essayons de rechercher des événements qui nous intéressent dans cet ensemble.  Un exemple de requête utilisera une syntaxe de type SQL. <br><br><ol><li>  Nous apprenons que nous avons «vu» des remèdes à ce moment: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (“Host violations”, “Network violations”, “<span class="hljs-keyword"><span class="hljs-keyword">Physical</span></span> violations”) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=“alexhost.company.local” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Supposons que nous ayons reçu 10 000 événements de domaines de violations d'hôte et de violations de réseau pour cette demande.  Quoi qu'il en soit, beaucoup, pour une analyse manuelle. </li><li>  Essayons de comprendre si l'hôte aurait pu être piraté pendant l'incident, et peu importe pour nous quel type de protection cela signifie. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (“Vulnerability Exploitation”) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=“alexhost.company.local” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Supposons que nous ayons reçu 500 événements pour cette demande des systèmes de détection et de prévention des intrusions au niveau du réseau et de l'hôte.  Super!  Vous pouvez déjà travailler avec cela manuellement. </li><li>  Au cours de l'enquête, nous avons réalisé que le piratage avait eu lieu au sein de l'entreprise.  Nous essaierons de savoir si l'un des outils de protection a «vu» l'installation ou l'exécution d'outils de piratage sur l'un des hôtes de l'entreprise. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level3 = “Exploit kit” <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;)</code> </pre> </li></ol><br><a name="Conclusion"></a><h1>  Conclusions </h1><br>  Nous avons décrit les principes de construction d'un système de catégorisation des événements et mis en avant les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exigences</a> qui ont déterminé les approches et les principes de sa formation.  Sur la base des spécificités des sources d'événements liées au SIEM, le système de catégorisation a été divisé en deux domaines: la catégorisation des événements à partir de sources informatiques et la catégorisation des événements à partir de sources d'informations. <br><br>  Le système de catégorisation des événements informatiques a été formé sur la base des principes suivants: <br><br><ol><li>  Les événements informatiques reflètent les étapes ou les détails des processus informatiques pris en charge ou mis en œuvre par les sources d'événements. </li><li>  Le système de catégorisation se compose de 3 niveaux principaux et d'un niveau supplémentaire qui détermine le succès ou l'échec de l'action décrite dans l'événement. </li><li>  Au premier niveau, on distingue les processus informatiques au sein desquels opère la source des événements. </li><li>  Le deuxième niveau décrit les entités de base impliquées dans ce processus. </li><li>  Le troisième niveau détermine quelles actions sont effectuées par telle ou telle entité dans le processus. </li><li>  Un niveau supplémentaire décrit le statut de ces actions (succès, échec). </li></ol><br>  Le système de catégorisation des événements de l'IB est basé sur les principes suivants: <br><br><ol><li>  La catégorisation s'applique exclusivement aux événements de sécurité des informations collectés à partir des équipements de sécurité et n'affecte pas la catégorisation des attaques contre les systèmes automatisés.  Des différences entre les attaques et les événements de sécurité de l'information ont été données au début de l'article. </li><li>  Le système de catégorisation se compose de 3 niveaux. </li><li>  Au premier niveau, des domaines sont identifiés dans lesquels des violations de SI peuvent être enregistrées: violations du niveau d'hôte, du réseau et de l'environnement physique. </li><li>  Le deuxième niveau de catégorisation est formé par des classes spécifiques de violations. </li><li>      ,     . </li></ol><br>                 . <br><br><img src="https://habrastorage.org/webt/_z/3m/ah/_z3mahc8mgidrucoua4fzcbwmgq.png" alt="Schéma général du système de catégorisation"><br> <i>   </i> <br><br>        .       ,        .         ,       ,     . <br><br><hr><br>  <b>Série d'articles:</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corrélations prêtes à l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1: Marketing pur ou problème insoluble?</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corrélations prêtes à l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. Le schéma de données comme reflet du modèle «monde»</a> <br><br>  Profondeurs SIEM: corrélations prêtes à l'emploi.  3.1.   ( <i> </i> ) <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corrélations prêtes à l'emploi.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 3.2.   </a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corrélations prêtes à l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 4. Modèle de système comme contexte de règles de corrélation</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corrélations prêtes à l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 5. Méthodologie pour développer des règles de corrélation</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432352/">https://habr.com/ru/post/fr432352/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432342/index.html">Camunda BPM Meetup Raiffeisenbank UPD Broadcast</a></li>
<li><a href="../fr432344/index.html">Quatre étapes de développement des ingénieurs</a></li>
<li><a href="../fr432346/index.html">Nouvelles du monde d'OpenStreetMap n ° 436 (20/11/2018 - 26/06/2018)</a></li>
<li><a href="../fr432348/index.html">Master class: moulage sous vide de plastiques en silicone</a></li>
<li><a href="../fr432350/index.html">Pourquoi les éléments React ont-ils une propriété $$ typeof?</a></li>
<li><a href="../fr432354/index.html">Les fuites de données les plus importantes en 2018. Première partie (janvier-juin)</a></li>
<li><a href="../fr432356/index.html">Comment rédiger un excellent fil d'actualités VKontakte en 20 heures</a></li>
<li><a href="../fr432360/index.html">"Descendant" AlphaGo a indépendamment appris à jouer aux échecs, au shogi et à aller</a></li>
<li><a href="../fr432362/index.html">Chang'e 4 - La mission de l'autre côté de la lune commence aujourd'hui</a></li>
<li><a href="../fr432364/index.html">Alphabet phonétique: comment une solution pour l'aviation aidera à transférer une connexion par téléphone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>