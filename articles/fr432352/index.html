<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí™üèº üåí üë©üèæ‚Äçüéì Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi. Partie 3.1. Cat√©gorisation des √©v√©nements üìö üò∑ ‚ûï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Est-il possible de cat√©goriser tous les √©v√©nements arrivant au SIEM et quel syst√®me de cat√©gorisation utiliser pour cela? Comment appliquer des cat√©go...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi. Partie 3.1. Cat√©gorisation des √©v√©nements</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432352/">  Est-il possible de cat√©goriser tous les √©v√©nements arrivant au SIEM et quel syst√®me de cat√©gorisation utiliser pour cela?  Comment appliquer des cat√©gories dans les r√®gles de corr√©lation et la recherche d'√©v√©nements?  Nous analyserons ces questions et d'autres dans un nouvel article du cycle consacr√© √† la m√©thodologie de cr√©ation de r√®gles de corr√©lation pr√™tes √† l'emploi pour les syst√®mes SIEM. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wp/ok/om/wpokomy1rlw1e495pzqk6uujan4.png" alt="Cat√©gorie de √©v√©nements"></div><br>  <i>Image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Worktrooper</a></i> <br><a name="habracut"></a><br>  Cet article a √©t√© co-√©crit avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mikhail Maximov</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Alexander Kovtun</a> . <br><br>  Nous vous avertissons: l'article est volumineux, car il d√©crit la construction du syst√®me de cat√©gorisation et nos cha√Ænes de raisonnement.  Si vous √™tes trop paresseux pour le lire dans son int√©gralit√©, alors vous pouvez imm√©diatement aller √† la section avec des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conclusions</a> - l√†, nous avons r√©sum√© tout ce qui a √©t√© discut√© dans l'article et r√©sum√© les r√©sultats. <br><br>  Dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article pr√©c√©dent,</a> nous avons constat√© que les √©v√©nements contiennent de nombreuses informations importantes qui ne peuvent pas √™tre perdues dans le processus de normalisation.  La description du sch√©ma d'interaction fait r√©f√©rence √† ce type de donn√©es.  Pour syst√©matiser les types d'interaction, nous avons fait ce qui suit: <br><br><ul><li>  identifi√© les principaux sch√©mas inh√©rents √† tout type d'√©v√©nement; </li><li>  d√©termin√© quelles entit√©s participent aux programmes; </li><li>  form√© l'ensemble de base des champs n√©cessaires pour d√©crire toutes les entit√©s trouv√©es dans l'√©v√©nement initial et le canal d'interactions entre elles. </li></ul><br>  √Ä la suite de l'analyse des journaux de divers types de logiciels et de mat√©riel, nous avons pu distinguer les entit√©s: sujet, objet d'interaction, source et √©metteur. <br><br>  Parlons maintenant de la s√©mantique de l'interaction de ces entit√©s et de sa r√©flexion dans la cat√©gorisation des √©v√©nements.  Avant de d√©crire l'approche de la formation et des cat√©gories, il est n√©cessaire de r√©pondre √† deux questions: pourquoi il est n√©cessaire de d√©terminer les cat√©gories d'√©v√©nements et quelles propri√©t√©s le syst√®me de cath√©t√©risme devrait avoir. <br><br>  D√©terminons d'abord pourquoi les √©v√©nements doivent √™tre class√©s.  En bref: une cat√©gorisation est n√©cessaire pour fonctionner aussi bien avec des √©v√©nements s√©mantiquement similaires, quel que soit le type de source.  Nous nous r√©f√©rons aux types de sources dont l'objectif principal est la source: √©quipements r√©seau, syst√®mes d'exploitation, logiciels d'application.  L'expression ¬´travailler de la m√™me mani√®re avec des √©v√©nements s√©mantiquement similaires¬ª doit √™tre comprise comme suit: <br><br><ol><li>  Les √©v√©nements s√©mantiquement similaires de tout type de source ont une cat√©gorie commune. </li><li> Pour les √©v√©nements de chaque cat√©gorie, des r√®gles claires pour remplir les champs du sch√©ma sont d√©finies.  Nous combattons donc efficacement le chaos qui se produit au stade de la normalisation des √©v√©nements et conduit souvent √† de multiples faux positifs des r√®gles de corr√©lation. </li><li>  La gestion des cat√©gories vous permet d'√©viter les v√©rifications inutiles dans le code des r√®gles de corr√©lation afin de comprendre la s√©mantique de l'√©v√©nement.  Par exemple, il n'est pas n√©cessaire de v√©rifier la disponibilit√© des donn√©es dans certains champs pour d√©terminer que l'√©v√©nement d√©crit l'entr√©e de l'utilisateur et non la sauvegarde du syst√®me. </li><li>  La cat√©gorisation est une base terminologique g√©n√©rale qui aide √† r√©diger les r√®gles de corr√©lation et d'enqu√™te sur les incidents, √† op√©rer avec un seul ensemble de termes et leurs significations g√©n√©ralement accept√©es.  Par exemple, pour bien comprendre que la modification de la configuration r√©seau et la modification de la configuration logicielle sont des types d'√©v√©nements compl√®tement diff√©rents qui ont des significations compl√®tement diff√©rentes. </li></ol><br>  Pour obtenir tout cela, vous devez cr√©er un syst√®me de cat√©gorisation des √©v√©nements et l'utiliser lors de l'√©criture de r√®gles de corr√©lation, des enqu√™tes sur les incidents et dans les cas o√π plusieurs personnes travaillent dans une organisation dot√©e d'un syst√®me SIEM. <br><a name="Requirements"></a><br>  Quant aux exigences du syst√®me de cat√©gorisation, il doit satisfaire quatre propri√©t√©s: <br><br><ol><li>  <b>Sans ambigu√Øt√©</b> .  Un m√™me √©v√©nement doit √™tre assign√© √† une et une seule cat√©gorie. </li><li>  <b>Compacit√©</b> .  Le nombre total de cat√©gories doit √™tre tel qu'elles puissent √™tre facilement m√©moris√©es par un expert. </li><li>  <b>Hi√©rarchie</b> .  Le syst√®me doit √™tre construit sur un sch√©ma hi√©rarchique et se composer de plusieurs niveaux, car il s'agit de la structure la plus simple √† retenir.  De plus, la hi√©rarchie devrait √™tre construite sur le principe du ¬´du g√©n√©ral au particulier¬ª: au premier niveau, il y a des cat√©gories plus ¬´g√©n√©rales¬ª et au dernier - des cat√©gories hautement sp√©cialis√©es. </li><li>  <b>Extensibilit√©</b> .  Les principes selon lesquels il est construit devraient permettre de mettre √† jour le syst√®me de cat√©gorisation lorsque de nouveaux types d'√©v√©nements apparaissent n√©cessitant des cat√©gories distinctes, sans changer l'approche principale. </li></ol><br>  Passons √† la description du syst√®me de cat√©gorisation: nous allons commencer par deux grands domaines, qui incluent des sources d'√©v√©nements connect√©s √† SIEM et dans lesquels ils g√©n√®rent des √©v√©nements. <br><br><a name="MainDomains"></a><h1>  Domaines source et √©v√©nement </h1><br>  Le d√©ploiement de SIEM commence souvent par la connexion de sources qui g√©n√®rent des √©v√©nements disparates.  Une propri√©t√© importante de ces √©v√©nements est qu'ils refl√®tent la fonctionnalit√© des sources elles-m√™mes. <br><br>  On distingue deux domaines globaux: <br><br><ol><li>  Sources informatiques - logiciels d'application et mat√©riel √† l'√©chelle du syst√®me qui g√©n√®rent des √©v√©nements informatiques. </li><li>  Sources IB - logiciels et mat√©riels sp√©cialis√©s pour la s√©curit√© des informations de l'entreprise qui g√©n√®rent des √©v√©nements IB. </li></ol><br>  Consid√©rez les diff√©rences fondamentales entre les √©v√©nements de ces domaines. <br><br>  Les sources informatiques signalent la survenance de tout ph√©nom√®ne dans le syst√®me automatis√©, sans leur √©valuation du niveau de s√©curit√© - ¬´bon¬ª ou ¬´mauvais¬ª.  Exemples: application d'une nouvelle configuration par un appareil, sauvegarde de donn√©es, transfert d'un fichier sur un r√©seau, d√©sactivation d'un port r√©seau sur un commutateur. <br><br>  Contrairement aux sources informatiques, les sources SI ont des connaissances externes suppl√©mentaires sur la fa√ßon d'interpr√©ter certains √©v√©nements du point de vue de la s√©curit√© - la politique.  Ainsi, l'utilisation de politiques permet aux sources du SI de prendre des d√©cisions - si le ph√©nom√®ne observ√© est ¬´bon¬ª ou ¬´mauvais¬ª - et de le signaler au SIEM via les √©v√©nements IB g√©n√©r√©s. <br><br>  Prenons l'exemple suivant: Ainsi, en g√©n√©ral, un pare-feu de niveau nouvelle g√©n√©ration consid√®re un √©v√©nement de transfert de fichiers sur le r√©seau comme ¬´mauvais¬ª: il s'av√®re que le fichier est un document Word qui est transf√©r√© du r√©seau interne de l'entreprise √† un serveur externe via FTP, et la strat√©gie configur√©e interdit de telles interactions informationnelles.  La d√©sactivation du port r√©seau est interpr√©t√©e comme une violation des droits d'acc√®s par la d√©cision de contr√¥ler les actions des administrateurs: puisque la d√©connexion du port est effectu√©e par l'utilisateur Alex, qui n'y a pas de droits, et se produit pendant ses heures non travaill√©es, selon la politique de s√©curit√© configur√©e. <br><br>  Cependant, il n'est pas tout √† fait vrai de dire que les sources de s√©curit√© de l'information ne g√©n√®rent que des √©v√©nements de s√©curit√© de l'information.  Les sources IB g√©n√®rent des √©v√©nements IB et IT.  Les sources SI g√©n√®rent des √©v√©nements informatiques, en r√®gle g√©n√©rale, lorsqu'elles signalent un changement dans leur √©tat: changements de configuration, commutation de n≈ìuds de cluster et sauvegardes.  En g√©n√©ral, ces √©v√©nements peuvent √™tre attribu√©s √† l'audit interne des actions et √† l'√©tat de la source.  Dans le m√™me temps, lorsque l'activit√© concerne l'application de politiques de s√©curit√©, la m√™me source g√©n√®re d√©j√† des √©v√©nements de s√©curit√© des informations, rapportant ainsi les r√©sultats de leur application. <br><br>  Nous avons d√©lib√©r√©ment d√©crit les diff√©rences entre les deux domaines avec autant de d√©tails.  Les √©v√©nements de chaque domaine ont leur propre signification et peuvent parfois diff√©rer fondamentalement les uns des autres.  Ces diff√©rences ont conduit √† l'existence de deux syst√®mes de cat√©gorisation d'√©v√©nements distincts responsables des √©v√©nements informatiques et des √©v√©nements de s√©curit√© de l'information. <br><br><img src="https://habrastorage.org/webt/lh/q6/2j/lhq62jphooh6zal7eks_kohztki.png" alt="Cat√©gorie de √©v√©nements.  Domaines d'√©v√©nements."><br>  <i>Domaines d'√©v√©nements</i> <br><br>  Il existe un autre type rare de sources qui g√©n√®rent des √©v√©nements d'un troisi√®me domaine distinct - le domaine des attaques.  Les √©v√©nements de ce domaine peuvent √™tre obtenus √† partir de sources du niveau de protection des points d'extr√©mit√© (Endpoint Protection), d'autres SIEM subordonn√©s (s'ils sont organis√©s dans une hi√©rarchie) ou d'autres solutions capables de d√©terminer, sur la base de l'analyse d'√©v√©nements informatiques et (ou) de s√©curit√© des informations, qu'un syst√®me automatis√© ou une partie est soumise √† une attaque de pirate. <br><br>  Dans le cadre de cette s√©rie d'articles, nous utiliserons les concepts suivants pour s√©parer les attaques et les √©v√©nements de s√©curit√© de l'information des moyens de d√©fense de bout en bout: <br><br><ol><li>  Une attaque est une s√©quence malveillante d'actions d'un attaquant visant √† atteindre un objectif sp√©cifique au sein d'une entreprise. </li><li>  Une attaque peut consister en un ou plusieurs √©v√©nements - une cha√Æne d'√©v√©nements de s√©curit√© des informations et / ou des √©v√©nements informatiques qui constituent des violations des politiques de s√©curit√© des informations. </li></ol><br>  Il existe plusieurs approches pour cat√©goriser les attaques, par exemple, la popularit√© croissante de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITER Adversarial Tactics, Techniques, and Common Knowledge (ATT &amp; CK)</a> , mais nous ne consid√©rerons pas ce domaine dans nos articles. <br><br><a name="ITCategorization"></a><h1>  Syst√®me de cat√©gorisation des √©v√©nements informatiques </h1><br>  Les logiciels et le mat√©riel d'application √† l'√©chelle du syst√®me, que nous attribuons aux sources informatiques des √©v√©nements, sont con√ßus pour mettre en ≈ìuvre ou prendre en charge certains processus pour remplir ses t√¢ches.  Au cours de leur d√©cision, les faits commis sont enregistr√©s par des √©v√©nements informatiques distincts.  Ils peuvent √™tre attribu√©s au processus dans lequel chacun d'eux s'est produit. <br><br>  En isolant les processus se produisant dans les sources informatiques, nous pouvons former le premier niveau de cat√©gorisation (que nous appellerons plus tard le contexte).  Il d√©finira un champ s√©mantique qui interpr√©tera correctement les √©v√©nements informatiques. <br><br>  Lors de l'analyse des √©v√©nements, il appara√Æt clairement que chacun d'eux d√©crit l'interaction de plusieurs entit√©s dans le cadre d'un processus d√©j√† d√©fini.  En s√©lectionnant la principale de ces entit√©s comme objet d'interaction, nous formons le deuxi√®me niveau de cat√©gorisation. <br><br>  Le comportement de l'entit√© principale dans l'√©v√©nement dans le cadre d'un processus sp√©cifique jouera le r√¥le du troisi√®me niveau de cat√©gorisation des √©v√©nements informatiques. <br>  Au total, √† la sortie, nous avons obtenu les niveaux suivants: <br><br><ol><li>  Contexte (processus) dans lequel l'√©v√©nement s'est produit. </li><li>  L'objet (entit√© principale) d√©crit par l'√©v√©nement. </li><li>  La nature du comportement de l'objet dans le contexte. </li></ol><br>  Ainsi, nous avons form√© trois niveaux de cat√©gorisation des √©v√©nements informatiques, vous permettant d'op√©rer facilement sur des √©v√©nements s√©mantiquement similaires provenant de diff√©rents types de sources dans l'infrastructure informatique. <br><br>  Pour garantir l'unicit√© du syst√®me de cat√©gorisation r√©sultant, nous formerons des domaines distincts pour chaque niveau. <br><br><img src="https://habrastorage.org/webt/yj/8h/qo/yj8hqoi_fevntq2utkvczwh5g_o.png" alt="Cat√©gorie des √©v√©nements informatiques.  Premier niveau."><br>  <i>Syst√®me de cat√©gorisation des √©v√©nements informatiques.</i>  <i>Premier niveau.</i> <br><br>  Une approche de processus similaire pour travailler avec les syst√®mes informatiques est √©galement utilis√©e dans ITSM (IT Service Management, IT service management), qui postule certains processus de base qui ont lieu dans les services informatiques.  Nous nous appuierons sur cette approche lors de la formation de processus possibles, ou en d'autres termes, de contextes, lors de l'examen des sources d'√©v√©nements informatiques. <br><br>  Nous distinguons les principaux processus de ce niveau: <br><br><ul><li>  <b>Gestion de la continuit√© des activit√©s</b> - √©v√©nements li√©s aux op√©rations pour maintenir le fonctionnement continu des syst√®mes: processus de r√©plication, migration et synchronisation des machines virtuelles, des bases de donn√©es et des stockages, op√©rations de sauvegarde et de restauration; </li><li>  <b>Gestion des</b> utilisateurs et des droits ( <b>gestion des</b> utilisateurs et des droits) - √©v√©nements li√©s √† l'utilisation des groupes et des comptes d'utilisateurs; </li><li>  <b>Gestion des acc√®s</b> - √©v√©nements associ√©s aux processus d'authentification, d'autorisation, de comptabilit√© (AAA) et √† toute tentative d'acc√®s au syst√®me; </li><li>  <b>Gestion de la disponibilit√©</b> - √©v√©nements associ√©s √† toutes les actions pour d√©marrer, arr√™ter, allumer, √©teindre, arr√™ter des entit√©s, y compris les messages d'information des syst√®mes de contr√¥le d'acc√®s aux entit√©s; </li><li>  <b>Gestion du d√©ploiement</b> (gestion des √©v√©nements) - √©v√©nements associ√©s √† l'introduction de nouvelles entit√©s dans le syst√®me de l'ext√©rieur, ainsi qu'√† la suppression de l'entit√© de ce syst√®me; </li><li>  <b>Gestion des interactions r√©seau</b> - √©v√©nements li√©s √† la transmission de donn√©es via le r√©seau, y compris l'√©tablissement de connexions, l'ouverture et la fermeture de tunnels; </li><li>  <b>Gestion du r√©seau</b> - √©v√©nements li√©s √† la pile r√©seau: y compris toutes les actions avec des politiques et des r√®gles pour le filtrage du r√©seau; </li><li>  <b>Gestion</b> de l'infrastructure virtuelle (gestion de l'infrastructure virtuelle) - √©v√©nements li√©s √† l'infrastructure de virtualisation; </li><li>  <b>Gestion de la base de donn√©es</b> - √©v√©nements li√©s au fonctionnement du SGBD et aux actions des utilisateurs et des processus qu'il contient; </li><li>  <b>Gestion du syst√®me</b> - √©v√©nements li√©s au fonctionnement du syst√®me d'exploitation et des logiciels qui font partie du syst√®me d'exploitation; </li><li>  <b>Generic Application Management</b> (gestion d'autres applications) - √©v√©nements associ√©s au fonctionnement d'autres applications install√©es par l'utilisateur et ne faisant pas partie du syst√®me d'exploitation. </li></ul><br>  Il est important de comprendre que diff√©rents processus peuvent se produire sur la m√™me source informatique.  Ainsi, par exemple, dans le service DHCP d√©ploy√© sur Unix, le processus de gestion du r√©seau (g√©n√©rant, par exemple, un √©v√©nement de mise √† jour d'adresse IP sur les n≈ìuds) et le processus de gestion du syst√®me, g√©n√©rant un √©v√©nement de red√©marrage du service ou une erreur d'analyse du fichier de configuration, peuvent se produire. <br><br><h2>  Le deuxi√®me niveau de cat√©gorisation des √©v√©nements informatiques (entit√©s) </h2><br><img src="https://habrastorage.org/webt/k_/rn/s6/k_rns6dddokqnddjqsdz9kjfdnk.png" alt="Syst√®me de cat√©gorisation des √©v√©nements IB.  Les premier et deuxi√®me niveaux."><br>  <i>Syst√®me de cat√©gorisation des √©v√©nements IB.</i>  <i>Les premier et deuxi√®me niveaux.</i> <br><br>  Le deuxi√®me niveau refl√®te l'objet d'interaction d√©crit dans l'√©v√©nement.  Notez qu'un √©v√©nement peut d√©crire plusieurs entit√©s.  Par exemple, prenez l'√©v√©nement suivant: "l'utilisateur a envoy√© une demande au serveur de certificats pour l'√©mission d'un certificat personnel."  Dans les √©v√©nements de ce type, il est n√©cessaire de choisir une entit√© de base comme objet d'interaction, qui est centrale dans l'√©v√©nement.  Ici, nous pouvons d√©terminer que l'entit√© principale est une ¬´demande √† un serveur de certification¬ª, car l'utilisateur est √©videmment le sujet de l'interaction, et le certificat personnel est le r√©sultat de l'interaction du sujet et de l'objet.  En collectant et en analysant un large √©ventail d'√©v√©nements, nous pouvons distinguer des groupes d'entit√©s: <br><br><ul><li>  <b>identification</b> : compte d'utilisateur, groupe d'utilisateurs, certificat - entit√©s qui vous permettent d'identifier l'utilisateur ou le syst√®me; </li><li>  <b>ex√©cutable</b> : application, module ex√©cutable - tout ce qui peut √™tre lanc√© par le syst√®me d'exploitation et contient un certain algorithme; </li><li>  <b>r√®gles et strat√©gies</b> : toutes les r√®gles, strat√©gies d'acc√®s, y compris les strat√©gies de groupe Windows OC; </li><li>  <b>l'essence du stockage d'informations dans le syst√®me d'exploitation</b> : un fichier, une cl√© de registre, un objet d'un groupe de r√©pertoires - tout ce qui peut servir de stockage d'informations au niveau de l'application; </li><li>  <b>connexions r√©seau</b> : sessions, flux, tunnels - entit√©s qui transportent un flux de donn√©es d'un n≈ìud √† un autre; </li><li>  <b>Entit√©s d'identification r√©seau du n≈ìud</b> : adresse r√©seau, socket, directement le n≈ìud r√©seau lui-m√™me - toutes ces entit√©s dont aucun syst√®me de surveillance ne peut se passer; </li><li>  <b>r√©seau L5-L7</b> : message √©lectronique, flux multim√©dia, liste de distribution - entit√©s qui transmettent des informations aux niveaux L5-L7 du mod√®le OSI; </li><li>  <b>r√©seau de service</b> : zone DNS, table de routage.  Ces entit√©s sont responsables du bon fonctionnement du r√©seau, sans porter de charge utile pour l'utilisateur final; </li><li>  <b>entit√©s de configurations tol√©rantes aux pannes</b> : RAID, √©l√©ments de r√©seau de cluster; </li><li>  <b>l'essence des syst√®mes de virtualisation</b> : machines virtuelles, disques durs virtuels, instantan√©s de machines virtuelles; </li><li>  <b>entit√©s de base de donn√©es</b> : tables, bases de donn√©es, SGBD; </li><li>  <b>√©quipements physiques</b> : <b>appareils</b> enfichables, √©l√©ments ACS (tourniquets, cam√©ras IP); </li><li>  <b>autres entit√©s OS</b> : une commande dans la console de gestion, la console syst√®me, le journal syst√®me - les entit√©s OS qui ne rentrent pas dans d'autres cat√©gories; </li><li>  <b>autres entit√©s de r√©seau</b> : interface de r√©seau, ressource de r√©seau public - les entit√©s du sous-syst√®me de r√©seau qui ne rentrent pas dans d'autres cat√©gories. </li></ul><br>  Ces groupes ne pr√©tendent pas √™tre exhaustifs, mais couvrent les principales t√¢ches d'attribution des cat√©gories de deuxi√®me niveau.  Si n√©cessaire, les groupes repr√©sent√©s peuvent s'√©tendre. <br><br><h2>  Le troisi√®me niveau de cat√©gorisation des √©v√©nements informatiques (nature de l'interaction) </h2><br><img src="https://habrastorage.org/webt/x5/wc/ja/x5wcja8h3u9jrersnj_au4im9ke.png" alt="Syst√®me de cat√©gorisation des √©v√©nements informatiques.  Les premier, deuxi√®me et troisi√®me niveaux."><br>  <i>Syst√®me de cat√©gorisation des √©v√©nements informatiques.</i>  <i>Les premier, deuxi√®me et troisi√®me niveaux.</i> <br><br>  Dans un processus sp√©cifique, le comportement de l'entit√© principale peut √™tre r√©duit aux valeurs suivantes: <br><br><ul><li>  <b>Contr√¥le</b> - interaction qui affecte le fonctionnement de l'entit√©; </li><li>  <b>Communication</b> - communication entre entit√©s; </li><li>  <b>Manipulation</b> - actions pour travailler avec l'entit√© elle-m√™me, y compris la manipulation de ses donn√©es; </li><li>  <b>Incorporation</b> - interaction, √† la suite de laquelle une nouvelle entit√© est ajout√©e au contexte (ou l'entit√© est supprim√©e du contexte); </li><li>  <b>√âtat</b> - √©v√©nements d'information sur les changements d'√©tat d'une entit√©. </li></ul><br>  Le dernier domaine se distingue entre autres: il comprend des √©v√©nements qui ne d√©crivent en fait aucune interaction, mais contiennent des informations sur l'entit√© ou les transitions d'entit√© entre √©tats.  Par exemple, un √©v√©nement qui d√©crit uniquement l'√©tat actuel du syst√®me (sur l'heure actuelle du syst√®me, sur un changement de statut d'une licence de produit). <br><br>  Les √©v√©nements d√©crivent non seulement l'interaction elle-m√™me, mais aussi son r√©sultat.  Il est important de comprendre que le contexte, l'essence principale et le comportement d'un objet dans le contexte ne d√©pendent pas du r√©sultat de l'interaction.  Le r√©sultat peut √™tre ¬´succ√®s¬ª et ¬´√©chec¬ª.  Un √©v√©nement peut √©galement d√©crire le processus continu d'interaction incompl√®te.  Nous appellerons ce statut ¬´en cours¬ª. <br><br><h2>  Formation d'un ensemble de donn√©es bas√© sur trois niveaux </h2><br>  Pour chaque domaine de chaque niveau, vous pouvez s√©lectionner un ensemble de donn√©es sp√©cifique contenant des √©v√©nements. <br><br>  Analysons un exemple d'√©v√©nement: <br><br><img src="https://habrastorage.org/webt/0j/e6/so/0je6sogj5o9rk3dbfr4qjylafac.png"><br><br>  Il peut √™tre interpr√©t√© comme ¬´la connexion du n≈ìud 10.0.1.5 au n≈ìud 192.168.149.2 a √©t√© d√©connect√©e¬ª.  En regardant le contexte d'un √©v√©nement, vous pouvez voir qu'il d√©crit une connexion r√©seau.  En cons√©quence, nous tombons dans le contexte de la ¬´gestion des interactions r√©seau¬ª. <br><br>  Ensuite, nous d√©terminons l'entit√© principale de l'√©v√©nement.  √âvidemment, l'√©v√©nement d√©crit trois entit√©s: deux n≈ìuds et une connexion r√©seau.  Sur la base des recommandations ci-dessus, nous comprenons que l'entit√© principale dans ce cas n'est qu'une connexion r√©seau et que les n≈ìuds sont des participants √† l'interaction, des points de terminaison qui effectuent des actions sur l'entit√©.  Au total, nous obtenons l'entit√© principale du domaine Connexions r√©seau, et l'action effectu√©e sur l'entit√© est la ¬´fermeture du canal de communication¬ª, qui peut √™tre attribu√©e au domaine de la communication. <br><br>  Cependant, nous avons encore beaucoup de donn√©es qui pourraient √™tre enregistr√©es √† partir de l'√©v√©nement.  Ainsi, un ensemble d'entit√©s du deuxi√®me niveau ¬´Connexions r√©seau¬ª ont des propri√©t√©s communes: <br><br><ul><li>  initiateur de connexion (adresse + port + interface); </li><li>  r√©cepteur (cible) de la connexion (adresse + port + interface); </li><li>  Protocole sur lequel la connexion est √©tablie. </li></ul><br>  De plus, par exemple, l'action du troisi√®me niveau de cat√©gorisation ¬´fermeture de la connexion¬ª, appartenant au domaine Communication, peut contenir les donn√©es suivantes, quelle que soit la connexion ferm√©e et quelle source l'a signal√©: <br><br><ul><li>  nombre d'octets envoy√©s / envoy√©s; </li><li>  nombre de paquets transmis / envoy√©s; </li><li>  dur√©e. </li></ul><br>  A titre d'exemple, on peut distinguer un ensemble d'entit√©s de base ¬´Entit√©s de stockage d'informations dans l'OS¬ª, qui se caract√©risent par les donn√©es suivantes: <br><br><ul><li>  nom de l'entit√©; </li><li>  le chemin de localisation de l'entit√© dans le syst√®me d'exploitation; </li><li>  taille de l'entit√©; </li><li>  privil√®ges d'acc√®s √† l'entit√©. </li></ul><br>  Un ensemble d'actions li√©es √† cette entit√©, par exemple la ¬´copie¬ª, qui est incluse dans le domaine de troisi√®me niveau ¬´Manipulation¬ª, peut √™tre caract√©ris√© par les propri√©t√©s suivantes: <br><br><ul><li>  Le nouveau nom de l'entit√© </li><li>  une nouvelle fa√ßon d'organiser l'entit√©; </li><li>  Nouveaux privil√®ges d'acc√®s aux entit√©s. </li></ul><br>  En option, nous pouvons obtenir toutes ces donn√©es de l'√©v√©nement.  L'essentiel est que la cat√©gorie que nous avons d√©finie nous permet de mettre en √©vidence un ensemble sp√©cifique de donn√©es qui peuvent √™tre extraites de l'√©v√©nement, sachant √† l'avance que ces donn√©es seront s√©mantiquement similaires. <br><br>  Et √† cet √©gard, les cat√©gories deviennent un outil pratique.  En comparant un certain ensemble de ces donn√©es √† chaque niveau de domaine, nous avons la possibilit√© de stocker des donn√©es s√©mantiquement similaires dans les m√™mes champs d'un √©v√©nement normalis√©, quels que soient le fabricant et le mod√®le de la source d'√©v√©nement.  Cela simplifie consid√©rablement la recherche de donn√©es dans un grand volume d'√©v√©nements et, par cons√©quent, la mise en ≈ìuvre de corr√©lations pour de tels √©v√©nements. <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exemples de syst√®me de cat√©gorisation </font></font></h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situation 1: Vous</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> devez trouver tous les √©v√©nements qui d√©crivent la connexion et la d√©connexion des p√©riph√©riques de toutes les sources. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chacune des sources g√©n√®re des √©v√©nements, apr√®s normalisation dont les </font><font style="vertical-align: inherit;">cat√©gories contiennent les cat√©gories </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (premier niveau de cat√©gorisation), </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (deuxi√®me niveau) et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (troisi√®me niveau). </font><font style="vertical-align: inherit;">Dans la situation d√©crite, tous les √©v√©nements d'int√©r√™t contiendront des cat√©gories:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 2: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©quipement physique;</font></font></b> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau 3: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int√©gration.</font></font></b> </li></ul><br>      ,          . <br><br>  ,        : <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 = ‚Äú&lt;      &gt;‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = ‚ÄúEmbedding‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  <b>Situation 2:</b> Il est n√©cessaire de trouver tous les √©v√©nements qui d√©crivent une tentative de modification des objets du syst√®me de fichiers avec un nom commen√ßant par ¬´boot¬ª. <br><br>  Les sources connect√©es √† SIEM peuvent produire des √©v√©nements de modification de fichier compl√®tement diff√©rents.  Cependant, l'attribution des cat√©gories appropri√©es aux √©v√©nements vous permet de s√©lectionner le n√©cessaire dans l'ensemble du tableau: <br><br><ul><li>  Niveau 1: <b>gestion du syst√®me;</b> </li><li>  Niveau 2: <b>Entit√©s de stockage d'informations dans le syst√®me d'exploitation;</b> </li><li>  Niveau 3: <b>Manipulation.</b> </li></ul><br>  De plus, une condition est sp√©cifi√©e par le nom de fichier: en utilisant des ensembles de donn√©es pr√©d√©finis, nous pouvons nous attendre √† ce que pour cette cat√©gorie le nom de fichier soit dans le champ object.name.  Par cons√©quent, pour s√©lectionner des √©v√©nements, vous pouvez former la requ√™te suivante: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 = ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">System</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Management</span></span>‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level2 = ‚Äú&lt;        &gt;‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = ‚ÄúManipulation‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (object.name <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> ‚Äúboot.%‚Äù)</code> </pre> <br>  Si une entit√© a √©t√© copi√©e, nous trouverons des informations √† son sujet et qu'elle a √©t√© copi√©e √† partir d'une autre entit√© - cela donnera un √©lan √† une enqu√™te plus approfondie. <br><br>  <b>Cas 3:</b> Il est n√©cessaire de fournir un profilage simple des connexions r√©seau sur les routeurs frontaliers de diff√©rents fabricants install√©s dans les succursales de l'entreprise.  SIEM re√ßoit des √©v√©nements de chacun de ces routeurs de p√©riph√©rie. <br><br>  Chacun des routeurs g√©n√®re des √©v√©nements informatiques, apr√®s normalisation dont les champs Niveau 1, Niveau 2, Niveau 3 contiennent des cat√©gories.  Dans l'exemple d√©crit, pour le profilage, il est n√©cessaire et suffisant d'analyser les √©v√©nements concernant l'ouverture et la fermeture des connexions r√©seau.  Selon le syst√®me de cat√©gorisation pr√©sent√©, ces √©v√©nements contiendront les champs de cat√©gorie suivants: <br><br><ul><li>  Niveau 1: <b>gestion des interactions r√©seau;</b> </li><li>  Niveau 2: <b>Connexions r√©seau;</b> </li><li>  Niveau 3: <b>Communication.</b> </li></ul><br>  De plus, pour les op√©rations d'ouverture et de fermeture de connexions, vous pouvez sp√©cifier les actions ¬´ouvrir¬ª et ¬´fermer¬ª, ainsi que le statut de l'action ¬´succ√®s¬ª. <br><br>  De plus, ayant des ensembles de donn√©es pour chacune des cat√©gories de la cat√©gorie, vous pouvez √™tre s√ªr que l'heure de d√©but de la connexion sera enregistr√©e dans l'√©v√©nement d'ouverture de connexion et que les informations sur les n≈ìuds participant √† l'interaction r√©seau seront plac√©es dans l'√©v√©nement de fermeture de connexion, ainsi que dans les champs ¬´Nombre d'octets transmis¬ª, ¬´nombre de paquets transmis¬ª et ¬´dur√©e¬ª seront plac√©s les donn√©es correspondantes sur la dur√©e de la connexion et la quantit√© d'informations transmises, respectivement. <br><br>  Ainsi, en filtrant le flux d'√©v√©nements par les cat√©gories et actions sp√©cifi√©es, vous pouvez s√©lectionner uniquement les √©v√©nements n√©cessaires pour l'op√©ration de profilage, sans avoir √† sp√©cifier une liste d'identificateurs d'√©v√©nements sp√©cifiques. <br><br><h1>  Syst√®me de cat√©gorisation des √©v√©nements IB </h1><br>  Avant de parler du syst√®me de cat√©gorisation, notons que nous ne consid√©rerons que les √©v√©nements provenant des d√©fenses.  La cat√©gorisation des attaques de pirates en tant que cha√Ænes d'actions malveillantes est un domaine distinct avec son propre syst√®me de cat√©gorisation. <br><br>  Le syst√®me de cat√©gorisation des √©v√©nements de s√©curit√© de l'information est bas√© sur un certain paradigme.  Il est formul√© comme suit: tout incident qui se produit dans un syst√®me automatis√© se refl√®te sur un ou plusieurs supports √† la fois: le niveau d'un h√¥te sp√©cifique, le niveau du r√©seau et le niveau de l'environnement physique. <br><br>  Les outils de s√©curit√© op√©rant √† ces niveaux identifient l'incident ou ses ¬´√©chos¬ª et g√©n√®rent des √©v√©nements de s√©curit√© de l'information qui entrent dans le SIEM. <br><br>  Par exemple, la transmission d'un fichier malveillant sur un r√©seau √† un h√¥te sp√©cifique peut √™tre d√©tect√©e au niveau du r√©seau et de l'h√¥te, dans le processus de traitement du trafic r√©seau au moyen de la protection du r√©seau ou en analysant les zones de m√©moire RAM avec les modules de protection antivirus appropri√©s. <br><br>  L'acc√®s physique non autoris√© aux locaux peut √™tre d√©tect√© au niveau de l'environnement physique au moyen de syst√®mes de contr√¥le d'acc√®s et au niveau de l'h√¥te, au moyen de SZI de la NSD lorsque l'utilisateur est autoris√© √† h√©berger pendant les heures creuses. <br><br>  Lorsque vous travaillez avec des √©v√©nements SI, il est souvent n√©cessaire de comprendre dans quel environnement l'incident a √©t√© enregistr√©.  Et d√©j√† en partant de l√†, construisez un nouveau chemin d'investigation ou formez la logique de la r√®gle de corr√©lation.  Ainsi, l'environnement de d√©tection est le premier niveau d'un syst√®me de cat√©gorisation. <br><br><h2>  Le premier niveau du syst√®me de cat√©gorisation des √©v√©nements de l'IB </h2><br><img src="https://habrastorage.org/webt/ig/ay/vz/igayvzurcou73lz_txlya7rqyya.png" alt="Syst√®me de cat√©gorisation des √©v√©nements IB.  Premier niveau."><br>  <i>Syst√®me de cat√©gorisation des √©v√©nements IB.</i>  <i>Premier niveau.</i> <br><br><ul><li>  <b>Violations</b> de l'h√¥te (√©v√©nements du niveau h√¥te) - √©v√©nements provenant des moyens de protection install√©s sur les postes de travail et serveurs finaux.  En r√®gle g√©n√©rale, les √©v√©nements de s√©curit√© de l'information de ce niveau d√©crivent le d√©clenchement de politiques de s√©curit√© √† la suite de l'analyse de l'√©tat interne de l'h√¥te au moyen d'une protection.  Sous l'analyse de l'√©tat interne, on entend ici l'analyse des processus en cours, des donn√©es dans les domaines de la RAM, des fichiers sur le disque. <br>  <b>Types de sources d'√©v√©nements</b> : outils de protection antivirus, syst√®mes de surveillance de l'int√©grit√©, syst√®mes de d√©tection d'intrusion au niveau de l'h√¥te, contr√¥le d'acc√®s et syst√®mes de contr√¥le d'acc√®s. </li><li>  <b>Violations de r√©seau</b> - √©v√©nements provenant de syst√®mes qui analysent le trafic r√©seau et lui appliquent un ensemble de politiques de s√©curit√© √©tablies. <br>  <b>Types de sources d'√©v√©nements</b> : pare-feu, syst√®mes de d√©tection et de pr√©vention des intrusions, syst√®mes de d√©tection DDoS.  Certaines protections d'h√¥te disposent √©galement de modules d'analyse du trafic r√©seau distincts.  Par exemple, des outils de protection antivirus et certains dispositifs antivirus domestiques de NSD. </li><li>  <b>Violations physiques</b> (violations du niveau de l'environnement physique) - √©v√©nements provenant de la s√©curit√© physique. <br>  <b>Types de sources d'√©v√©nements</b> : syst√®mes de s√©curit√© de p√©rim√®tre, syst√®mes de contr√¥le d'acc√®s, syst√®mes de protection contre les fuites d'informations via des canaux vibro-acoustiques et des canaux PEMIN. <br>  Cette cat√©gorie comprend √©galement les incidents identifi√©s par le service de s√©curit√© physique ou √©conomique au cours des activit√©s internes et introduits dans les bases de donn√©es internes de l'entreprise, dont les informations peuvent √™tre collect√©es par le SIEM.  Pour des raisons d'organisation, il s'agit d'un √©v√©nement extr√™mement rare, mais toujours possible. </li></ul><br><h2>  Les deuxi√®me et troisi√®me niveaux du syst√®me de cat√©gorisation des √©v√©nements de l'IB </h2><br>  Le deuxi√®me niveau du syst√®me de cat√©gorisation est associ√© au premier, mais pr√©sente des fonctionnalit√©s en raison des conditions pr√©alables suivantes: <br><br><ul><li>  les incidents de s√©curit√© des informations ne se produisent pas toujours dans l'environnement physique; </li><li>  les incidents dans l'environnement physique ne sont pas toujours associ√©s √† des incidents de s√©curit√© de l'information, mais il y a aussi des intersections; </li><li>  les incidents au niveau du r√©seau et de l'h√¥te final ont souvent une structure et une s√©mantique similaires. </li></ul><br>  Par cons√©quent, au deuxi√®me niveau, un groupe de cat√©gories correspondant aux violations du niveau de l'environnement physique et des groupes de cat√©gories communes aux violations du r√©seau et du niveau h√¥te sont distingu√©s. <br><br>  Le troisi√®me niveau du syst√®me de cat√©gorisation clarifie le second et d√©crit directement les violations elles-m√™mes, dont l'essence se refl√®te dans les √©v√©nements de s√©curit√© de l'information. <br><br>  Nous avons analys√© les syst√®mes de cat√©gorisation d'√©v√©nements pour les solutions de s√©curit√© IBM QRadar, Micro Focus Arcsight et Maxpatrol SIEM pour les violations au niveau du r√©seau et de l'h√¥te.  Selon les r√©sultats, ils ont conclu: ils sont tous tr√®s similaires et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">eCSIRT.net mkVI</a> peut servir de syst√®me de cat√©gorisation le plus complet et unificateur.  C'est elle qui a √©t√© prise comme base dans le syst√®me de cat√©gorisation ci-dessous. <br><br><img src="https://habrastorage.org/webt/eh/-e/gs/eh-egskwu2pfw2sjhrlucrdii80.png" alt="Syst√®me de cat√©gorisation des √©v√©nements IB.  Violations au niveau de l'h√¥te et au niveau du r√©seau."><br>  <i>Syst√®me de cat√©gorisation des √©v√©nements IB.</i>  <i>Violations au niveau de l'h√¥te et au niveau du r√©seau.</i> <br><br><ul><li>  <b>Contenu abusif</b> - contenu livr√© l√©galement √† l'utilisateur final, provoquant des actions ill√©gales (intentionnelles ou non intentionnelles) ou contenant des donn√©es malveillantes / ind√©sirables. <br>  <b>Cat√©gories de troisi√®me niveau</b> : Spam, Phishing. <br>  <b>Types de sources d'√©v√©nements</b> : serveurs proxy avec contr√¥le de contenu (Microsoft Threat Management Gateway), outils de protection du trafic Web (Cisco Web Security Appliance, lame de filtrage Check Point URL), outils de protection du courrier (Cisco Email Security Appliance, Kaspersky Secure Mail Gateway), S√©curit√© de l'h√¥te final avec des modules de contr√¥le Web et de messagerie int√©gr√©s (McAfee Internet Security, Kaspersky Internet Security). </li><li>  <b>Collecte d'informations</b> - collecte de donn√©es sur l'objet de la protection contre les sources d'information ouvertes et ferm√©es, en utilisant des m√©thodes de collecte actives et passives. <br>  <b>Cat√©gories de troisi√®me niveau</b> : empreinte digitale, reniflement, num√©risation, Bruteforce. <br>  <b>Types de sources d'√©v√©nements</b> : en r√®gle g√©n√©rale, fonctionnalit√©s de s√©curit√© r√©seau, √† savoir: pare-feu (Cisco Adaptive Security Appliance, lame Checkpoint Firewall), outils de d√©tection et de pr√©vention des intrusions (Cisco Firepower Next-Generation IPS, lame Check Point IPS). </li><li>  <b>Disponibilit√©</b> - une violation malveillante ou accidentelle de la disponibilit√© des services et syst√®mes individuels en g√©n√©ral. <br>  <b>Cat√©gories de troisi√®me niveau</b> : DDoS, DoS, Flood. <br>  <b>Types de sources d'√©v√©nements</b> : pare-feu et syst√®mes de d√©tection et de pr√©vention des intrusions, ainsi que des syst√®mes de d√©tection et de blocage des attaques DoS r√©seau (Arbor Pravail APS, Arbour Peakflow SP, Radware DefensePro, IFI Soft APK ¬´Perimeter¬ª). </li><li>  <b>Exploration des vuln√©rabilit√©s</b> - Identifie une vuln√©rabilit√© ou un groupe de vuln√©rabilit√©s.  Il est important de noter que cette cat√©gorie d√©crit les √©v√©nements de s√©curit√© des informations concernant la d√©tection de vuln√©rabilit√©, mais pas son fonctionnement. <br>  <b>Cat√©gories de troisi√®me niveau</b> : Firmware, Software. <br>  <b>Types de sources d'</b> √©v√©nements: √©v√©nements du SIEM int√©gr√© ou du scanner d'audit et de s√©curit√© externe int√©gr√© (Tenable Nessus Vulnerability Scanner, Positive Technologies Maxpatrol 8, Positive Technologies XSpider, Qualys Vulnerability Scanner, Burp Suit). </li><li>  <b>Exploitation de la vuln√©rabilit√©</b> (exploitation de la vuln√©rabilit√©) - identification de l'impact n√©gatif d√©lib√©r√© sur le syst√®me ou exploitation de la vuln√©rabilit√© du syst√®me.  Dans ce cas, les cat√©gories de troisi√®me niveau peuvent souvent inclure des techniques d'attaque individuelles r√©pertori√©es dans MITRE ATT &amp; CK (lien) et d√©finies par des fonctions de s√©curit√©. <br>  <b>Cat√©gories de troisi√®me niveau</b> : entit√©s externes XML, script intersite, d√©s√©rialisation non s√©curis√©e, empoisonnement du routage, etc. <br>  <b>Types de sources d'√©v√©nements</b> : syst√®mes de d√©tection et de pr√©vention des intrusions au niveau du r√©seau (Positive Technologies Network Attack Discovery, Positive Technologies Web Application Firewall, Imperva Web Application Firewall, Cisco Firepower Next Generation IPS, Check Point IPS blade)) ou au niveau de l'h√¥te (Carbon Black Cb Defense, Modules de protection antivirus HIPS, OSSEC). </li><li>  <b>Hacktool</b> (hacking utilities): utilisation d'utilitaires utilis√©s pour pirater des syst√®mes ou mettre en ≈ìuvre d'autres actions ill√©gales pour obtenir des informations confidentielles et contourner les outils de s√©curit√©. <br>  <b>Cat√©gories de troisi√®me niveau</b> : Scanner, Bruteforcer, Exploit Kit, Password dumper, Vulnerability scanner, TOR client, Sniffer, Shellcode, Keylogger. <br>  <b>Types de sources d'√©v√©nements</b> : syst√®mes de d√©tection et de pr√©vention des intrusions au niveau du r√©seau et au niveau de l'h√¥te, scanners de s√©curit√© et d'audit, outils de protection antivirus. </li><li>  <b>Code malveillant</b> - D√©tecte l'utilisation de code malveillant. <br>  <b>Cat√©gories de troisi√®me niveau</b> : Virus, Ver, Botnet, Rootkit, Bootkit, Trojan, Backdoor, Cryptor. <br>  <b>Types de sources d'√©v√©nements</b> : tous les outils de protection antivirus du r√©seau et de l'h√¥te, syst√®mes de d√©tection et de pr√©vention des intrusions au niveau du r√©seau. </li><li>  <b>Conformit√©</b> (violation de la conformit√©) - l'identification des faits de non-conformit√© aux contr√¥les d√©finis dans les politiques de conformit√©.  Dans ce cas, les politiques de conformit√© signifient les exigences PCI DSS, la commande FSTEC n ¬∞ 21 et les normes de s√©curit√© de l'entreprise. <br>  <b>Cat√©gories de troisi√®me niveau</b> : contr√¥le d'int√©grit√©, contr√¥le des param√®tres du syst√®me d'exploitation, contr√¥le des param√®tres de l'application. <br>  <b>Types de sources d'√©v√©nements</b> : scanners de s√©curit√© et d'audit. </li><li>  <b>Fuite d'informations</b> - fuite de donn√©es confidentielles via n'importe quel canal de communication. <br>  <b>Cat√©gories de troisi√®me niveau</b> : e-mail, Messenger, r√©seau social, appareil mobile, stockage amovible. <br>  <b>Types de sources d'√©v√©nements</b> : syst√®mes de pr√©vention des fuites de donn√©es (Rostelecom - Solar Dozor, InfoWatch Traffic Monitor). </li><li>  <b>Anomalie</b> (anomalies) - une d√©viation significative des param√®tres de l'objet de protection ou de son comportement par rapport √† la norme pr√©c√©demment √©tablie. <br>  <b>Cat√©gories de troisi√®me niveau</b> : statistiques, comportementales. <br>  <b>Types de sources d'√©v√©nements</b> : outils de protection r√©seau de nouvelle g√©n√©ration, syst√®mes de pr√©vention des fuites de donn√©es, syst√®mes de classe d'analyse du comportement des utilisateurs et des entit√©s (Splunk User Behavior Analytics, Securonix User and Entity Behavior Analytics, Exabeam Advanced Analytics). </li></ul><br><img src="https://habrastorage.org/webt/d8/zs/xq/d8zsxq3vzpqv8xa8p9415yzs_eg.png" alt="Syst√®me de cat√©gorisation des √©v√©nements IB.  Violations du niveau de l'environnement physique."><br>  <i>Syst√®me de cat√©gorisation des √©v√©nements IB.</i>  <i>Violations du niveau de l'environnement physique.</i> <br><br>  Les violations de l'environnement physique, importantes du point de vue de la s√©curit√© de l'information, ont leur propre "branche" distincte dans le syst√®me de cat√©gorisation.  Il est important que dans ce cas le syst√®me de cat√©gorisation ne comporte qu'un seul niveau. <br><br>  Une telle repr√©sentation ¬´tronqu√©e¬ª du syst√®me de cat√©gorisation est principalement due √† des cas extr√™mement rares d'int√©gration de SIEM avec des √©quipements de s√©curit√© physique.  Les exceptions sont les syst√®mes de contr√¥le d'acc√®s et de comptabilit√© (ACS), qui sont souvent connect√©s au SIEM.  Sinon, lors de la compilation de cette ¬´branche¬ª du syst√®me de cat√©gorisation, nous n'avions pas suffisamment de donn√©es statistiques pour syst√©matiser cette direction particuli√®re. <br><br><ul><li>  <b>Vol</b> (vol) - vol de supports physiques ou d'appareils informatiques (ordinateurs portables, tablettes, smartphones) contenant des informations confidentielles sur le territoire de l'entreprise ou des employ√©s de l'entreprise. <br>  <b>Types de sources d'√©v√©nements</b> : bases d'incidents des services de s√©curit√© physique, syst√®mes du personnel. </li><li>  <b>Intrusion</b> (p√©n√©tration physique) - contournement non autoris√© ou non r√©glement√© du syst√®me de protection physique. <br>  <b>Types de sources d'√©v√©nements</b> : bases d'incidents des services de s√©curit√© physique, ACS, syst√®mes de s√©curit√© de p√©rim√®tre. </li><li>  <b>Dommages</b> (dommages) - dommages cibl√©s, destruction, r√©duction de la dur√©e de vie de l'√©quipement ou des canaux de communication. <br>  <b>Types de sources d'√©v√©nements</b> : base de donn√©es des incidents de s√©curit√© physique. </li></ul><br><h2>  Exemples d'utilisation de syst√®mes de cat√©gorisation </h2><br>  Nous appliquons le syst√®me de cat√©gorisation d√©crit pour √©crire des r√®gles de corr√©lation de haut niveau et rechercher des √©v√©nements dans le processus d'enqu√™te.  Consid√©rez deux situations. <br><br>  <b>Situation 1</b> : au moyen de la r√®gle de corr√©lation, il est n√©cessaire d'identifier une fuite d'informations confidentielles due au piratage des actifs du syst√®me automatis√©.  SIEM re√ßoit des √©v√©nements des fonctionnalit√©s de s√©curit√© suivantes: <br><br><ul><li>  syst√®mes de pr√©vention des fuites de donn√©es; </li><li>  syst√®mes de d√©tection et de pr√©vention des intrusions au niveau du r√©seau; </li><li>  syst√®mes de d√©tection et de pr√©vention des intrusions au niveau de l'h√¥te; </li><li>  outil de protection antivirus. </li></ul><br>  Chacun d'eux g√©n√®re des √©v√©nements IB, apr√®s normalisation dans les <b>champs Level1</b> , <b>Level2</b> , <b>Level3</b> dont les cat√©gories sont appos√©es. <br>  Le texte de la r√®gle de corr√©lation en pseudo-code peut ressembler √† ceci: <br><br><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#         .    ¬´Host_poisoning event Host_poisoning¬ª: #          ,        group by dst.host #     hostname/fqdn/ip ,     filter { Level2 = ‚ÄúMalicious Code‚Äù OR Level2 = ‚ÄúVulnerability Exploitation‚Äù } #           : event Data_leak: group by dst.host filter { Level2 = ‚ÄúInformation Leak‚Äù AND Level3 = ‚ÄúEmail‚Äù #        } #      Host_poisoning_and_data_leakage:   ¬´Host_poisoning¬ª,   ¬´Data_leak¬ª   24       : rule Host_poisoning_and_data_leakage: (Host_poisoning ‚Äî&gt; Data_leak) within 24h emit { #  ‚Äî    }</span></span></code> </pre> <br>  <b>Situation 2:</b> nous enqu√™tons sur l'incident sur un h√¥te sp√©cifique - alexhost.company.local.  Vous devez comprendre ce qui lui est arriv√© entre 04h00 et 06h00 le 11/08/2018.  Pendant ce temps, il y a environ 21,6 millions d'√©v√©nements de cet h√¥te dans le SIEM lui-m√™me (le flux d'√©v√©nements moyen est de 3000 EPS).  Il est maintenant 11h00 le 09/09/2018, tous les √©v√©nements sont dans la base de donn√©es SIEM, au moment de l'incident, aucune r√®gle de corr√©lation n'a √©t√© √©tablie dans SIEM. <br><br>  De toute √©vidence, l'analyse manuelle de tous les √©v√©nements est une mauvaise id√©e.  Il faut en quelque sorte r√©duire leur volume et localiser le probl√®me.  Essayons de rechercher des √©v√©nements qui nous int√©ressent dans cet ensemble.  Un exemple de requ√™te utilisera une syntaxe de type SQL. <br><br><ol><li>  Nous apprenons que nous avons ¬´vu¬ª des rem√®des √† ce moment: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (‚ÄúHost violations‚Äù, ‚ÄúNetwork violations‚Äù, ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">Physical</span></span> violations‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=‚Äúalexhost.company.local‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Supposons que nous ayons re√ßu 10 000 √©v√©nements de domaines de violations d'h√¥te et de violations de r√©seau pour cette demande.  Quoi qu'il en soit, beaucoup, pour une analyse manuelle. </li><li>  Essayons de comprendre si l'h√¥te aurait pu √™tre pirat√© pendant l'incident, et peu importe pour nous quel type de protection cela signifie. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (‚ÄúVulnerability Exploitation‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=‚Äúalexhost.company.local‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Supposons que nous ayons re√ßu 500 √©v√©nements pour cette demande des syst√®mes de d√©tection et de pr√©vention des intrusions au niveau du r√©seau et de l'h√¥te.  Super!  Vous pouvez d√©j√† travailler avec cela manuellement. </li><li>  Au cours de l'enqu√™te, nous avons r√©alis√© que le piratage avait eu lieu au sein de l'entreprise.  Nous essaierons de savoir si l'un des outils de protection a ¬´vu¬ª l'installation ou l'ex√©cution d'outils de piratage sur l'un des h√¥tes de l'entreprise. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level3 = ‚ÄúExploit kit‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;)</code> </pre> </li></ol><br><a name="Conclusion"></a><h1>  Conclusions </h1><br>  Nous avons d√©crit les principes de construction d'un syst√®me de cat√©gorisation des √©v√©nements et mis en avant les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exigences</a> qui ont d√©termin√© les approches et les principes de sa formation.  Sur la base des sp√©cificit√©s des sources d'√©v√©nements li√©es au SIEM, le syst√®me de cat√©gorisation a √©t√© divis√© en deux domaines: la cat√©gorisation des √©v√©nements √† partir de sources informatiques et la cat√©gorisation des √©v√©nements √† partir de sources d'informations. <br><br>  Le syst√®me de cat√©gorisation des √©v√©nements informatiques a √©t√© form√© sur la base des principes suivants: <br><br><ol><li>  Les √©v√©nements informatiques refl√®tent les √©tapes ou les d√©tails des processus informatiques pris en charge ou mis en ≈ìuvre par les sources d'√©v√©nements. </li><li>  Le syst√®me de cat√©gorisation se compose de 3 niveaux principaux et d'un niveau suppl√©mentaire qui d√©termine le succ√®s ou l'√©chec de l'action d√©crite dans l'√©v√©nement. </li><li>  Au premier niveau, on distingue les processus informatiques au sein desquels op√®re la source des √©v√©nements. </li><li>  Le deuxi√®me niveau d√©crit les entit√©s de base impliqu√©es dans ce processus. </li><li>  Le troisi√®me niveau d√©termine quelles actions sont effectu√©es par telle ou telle entit√© dans le processus. </li><li>  Un niveau suppl√©mentaire d√©crit le statut de ces actions (succ√®s, √©chec). </li></ol><br>  Le syst√®me de cat√©gorisation des √©v√©nements de l'IB est bas√© sur les principes suivants: <br><br><ol><li>  La cat√©gorisation s'applique exclusivement aux √©v√©nements de s√©curit√© des informations collect√©s √† partir des √©quipements de s√©curit√© et n'affecte pas la cat√©gorisation des attaques contre les syst√®mes automatis√©s.  Des diff√©rences entre les attaques et les √©v√©nements de s√©curit√© de l'information ont √©t√© donn√©es au d√©but de l'article. </li><li>  Le syst√®me de cat√©gorisation se compose de 3 niveaux. </li><li>  Au premier niveau, des domaines sont identifi√©s dans lesquels des violations de SI peuvent √™tre enregistr√©es: violations du niveau d'h√¥te, du r√©seau et de l'environnement physique. </li><li>  Le deuxi√®me niveau de cat√©gorisation est form√© par des classes sp√©cifiques de violations. </li><li>      ,     . </li></ol><br>                 . <br><br><img src="https://habrastorage.org/webt/_z/3m/ah/_z3mahc8mgidrucoua4fzcbwmgq.png" alt="Sch√©ma g√©n√©ral du syst√®me de cat√©gorisation"><br> <i>   </i> <br><br>        .       ,        .         ,       ,     . <br><br><hr><br>  <b>S√©rie d'articles:</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1: Marketing pur ou probl√®me insoluble?</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. Le sch√©ma de donn√©es comme reflet du mod√®le ¬´monde¬ª</a> <br><br>  Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi.  3.1.   ( <i> </i> ) <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> 3.2.   </a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 4. Mod√®le de syst√®me comme contexte de r√®gles de corr√©lation</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 5. M√©thodologie pour d√©velopper des r√®gles de corr√©lation</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432352/">https://habr.com/ru/post/fr432352/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432342/index.html">Camunda BPM Meetup Raiffeisenbank UPD Broadcast</a></li>
<li><a href="../fr432344/index.html">Quatre √©tapes de d√©veloppement des ing√©nieurs</a></li>
<li><a href="../fr432346/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 436 (20/11/2018 - 26/06/2018)</a></li>
<li><a href="../fr432348/index.html">Master class: moulage sous vide de plastiques en silicone</a></li>
<li><a href="../fr432350/index.html">Pourquoi les √©l√©ments React ont-ils une propri√©t√© $$ typeof?</a></li>
<li><a href="../fr432354/index.html">Les fuites de donn√©es les plus importantes en 2018. Premi√®re partie (janvier-juin)</a></li>
<li><a href="../fr432356/index.html">Comment r√©diger un excellent fil d'actualit√©s VKontakte en 20 heures</a></li>
<li><a href="../fr432360/index.html">"Descendant" AlphaGo a ind√©pendamment appris √† jouer aux √©checs, au shogi et √† aller</a></li>
<li><a href="../fr432362/index.html">Chang'e 4 - La mission de l'autre c√¥t√© de la lune commence aujourd'hui</a></li>
<li><a href="../fr432364/index.html">Alphabet phon√©tique: comment une solution pour l'aviation aidera √† transf√©rer une connexion par t√©l√©phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>