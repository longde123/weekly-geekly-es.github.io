<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСМЁЯП╛ ЁЯСйЁЯП╗тАНтЪХя╕П тЫ╣ЁЯП╛ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдореИрд▓рд╡реЗрдпрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг тЫкя╕П ЁЯР╗ ЁЯСЭ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдкрд╛рдареНрдпрдХреНрд░рдо рдХреЗ рдЫрд╛рддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред 



 рд╕рд╛рд░рд╛рдВрд╢ 
 рдбреЗрд▓ рд╕рд┐рдХреНрдпреЛрд░рд╡рд░реНрдХреНрд╕ рдХрд╛рдЙрдВрдЯрд░ рдереНрд░реЗрдЯ рдпреВрдирд┐рдЯ (рд╕реАрдЯреАрдп...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдореИрд▓рд╡реЗрдпрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/481778/">  <i>рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рд╡рд┐рд╢реЗрд╖ рд░реВрдк <a href="https://otus.pw/C71z/">рд╕реЗ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ</a> рдкрд╛рдареНрдпрдХреНрд░рдо рдХреЗ рдЫрд╛рддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред</i> <br><br><img src="https://habrastorage.org/webt/9z/ro/zu/9zrozu-bzodywtxpi3u8jgmsgog.png"><br><hr><br><h3>  рд╕рд╛рд░рд╛рдВрд╢ </h3><br>  рдбреЗрд▓ рд╕рд┐рдХреНрдпреЛрд░рд╡рд░реНрдХреНрд╕ рдХрд╛рдЙрдВрдЯрд░ рдереНрд░реЗрдЯ рдпреВрдирд┐рдЯ (рд╕реАрдЯреАрдпреВ) рдХреЗ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдореИрд▓рд╡реЗрдпрд░ рдЦреЛрдЬрд╛ рд╣реИ рдЬреЛ рд╕рдХреНрд░рд┐рдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ (AD) рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХрд▓-рдХрд╛рд░рдХ (рдХреЗрд╡рд▓ рдкрд╛рд╕рд╡рд░реНрдб) рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВред  рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдкрд╕рдВрдж рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдореИрд▓рд╡реЗрдпрд░ рдХреЛ "рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА" (рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдХреБрдВрдЬреА) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  CTU рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдПрдХ рдЧреНрд░рд╛рд╣рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреА рдЦреЛрдЬ рдХреА, рдЬрд┐рд╕рдиреЗ рд╡реЗрдмрдореЗрд▓ рдФрд░ рд╡реАрдкреАрдПрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХрд▓-рдХрд╛рд░рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рд░рд┐рдореЛрдЯ рдПрдХреНрд╕реЗрд╕ рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рдорд┐рд▓ рдкрд╛рдИред  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЗ AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рд╕реНрдореГрддрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВред  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕ рднреМрддрд┐рдХ рдкреНрд░рд╡реЗрд╢ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рднреА рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдирд▓реЙрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рддреЗ рд╣реИрдВред <a name="habracut"></a><br><br>  рдкреНрд░рдХрд╛рд╢рди рдХреЗ рд╕рдордп рдЬреНрдЮрд╛рдд рдПрдХрдорд╛рддреНрд░ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреЗ рдирдореВрдиреЗ рдореЗрдВ рдирд┐рд░рдВрддрд░рддрд╛ рдХрд╛ рдЕрднрд╛рд╡ рдерд╛ - рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рдкреБрдирд░рд╛рд░рдВрдн рд╣реЛрдиреЗ рдкрд░ рдЙрдиреНрд╣реЗрдВ рдлрд┐рд░ рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╕реАрдЯреАрдпреВ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рдВрджреЗрд╣ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗрд╡рд▓ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрдерддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреБрдирдГ рдЖрд░рдВрдн рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХ рдкрд░ рдХреЛрдИ рдЕрдиреНрдп рдореИрд▓рд╡реЗрдпрд░ рдирд╣реАрдВ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдкреБрдирд░рд╛рд░рдВрдн рд╕реЗ рдЖрда рдШрдВрдЯреЗ рдФрд░ рдЖрда рджрд┐рдиреЛрдВ рдХреЗ рдмреАрдЪ, рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдиреЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреЛ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рддреИрдирд╛рдд рдЕрдиреНрдп рд░рд┐рдореЛрдЯ рдПрдХреНрд╕реЗрд╕ рдорд╛рд▓рд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред <br><br>  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рддреИрдирд╛рддреА рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд╕реАрдЯреАрдпреВ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдорд┐рд╢рди-рдХреНрд░рд┐рдЯрд┐рдХрд▓ рд╕рд░реНрд╡рд░, рдПрдбрдорд┐рдирд┐рд╕реНрдЯреНрд░реЗрдЯрд┐рд╡ рд╡рд░реНрдХрд╕реНрдЯреЗрд╢рди рд╕реЗ рдЪреЛрд░реА рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдФрд░ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЛ рдирд┐рд╢рд╛рдирд╛ рдмрдирд╛рддреЗ рд╣реБрдП рдХрдВрдХрд╛рд▓ рдХреА рддреИрдирд╛рддреА рдХрд░рддреЗ рд╣реБрдП рджреЗрдЦрд╛ред <br><br><h3>  рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг </h3><br>  рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ, рд╕реАрдЯреАрдпреВ рдХреЗ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдПрдХ рдХрдВрдХрд╛рд▓рд┐рдд рдирдореВрдирд╛ рджреЗрдЦрд╛, рдЬрд┐рд╕реЗ рдПрдХ рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ ole64.dll рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (рддрд╛рд▓рд┐рдХрд╛ 1 рджреЗрдЦреЗрдВ)ред <br><br><div class="scrollable-table"><table><tbody><tr><td>  рдЧреБрдг </td><td>  рдЕрд░реНрде рдпрд╛ рд╡рд┐рд╡рд░рдг </td></tr><tr><td>  рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо </td><td>  ole64.dll </td></tr><tr><td>  md5 </td><td>  bf45086e6334f647fda33576e2a05826 </td></tr><tr><td>  SHA1 </td><td>  5083b17ccc50dd0557dfc544f84e2ab55d6acd92 </td></tr><tr><td>  рд╕рдВрдХрд▓рди рд╕рдордп </td><td>  2014-02-19 09:31:29 </td></tr><tr><td>  рддреИрдирд╛рдд </td><td>  рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ (рдЖрдорддреМрд░ рдкрд░ рдореИрд▓рд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рдж рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ) </td></tr><tr><td>  рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ </td><td>  49664 рдмрд╛рдЗрдЯреНрд╕ </td></tr><tr><td>  рдордВрдЪ </td><td>  .text, .rdata, .data, .pdata, .rsrc, .reloc </td></tr><tr><td>  рдирд┐рд░реНрдпрд╛рдд </td><td><p>  ii (рдкреИрдЪ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ) </p><p>  uu (рдкреИрдЪ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ) </p><p>  Dllentrypoint (рдбрд┐рдлрд╝реЙрд▓реНрдЯ dll рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд┐рдВрджреБ) </p></td></tr></tbody></table></div><br>  <i>рддрд╛рд▓рд┐рдХрд╛ 1. рдирдореВрдирд╛ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА <code>ole64.dll</code> ред</i> <br><br>  <code>ole64.dll</code> рдЕрдзреНрдпрдпрди рдХрд░рддреЗ <code>ole64.dll</code> , CTU рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдкреАрдбрд╝рд┐рдд рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ "рдордзреНрдпрд╡рд░реНрддреА рд╣реЛрд╕реНрдЯ" рдкрд░ <code>msuta64.dll</code> рдХрд╛ рдПрдХ рдкреБрд░рд╛рдирд╛ рд╕рдВрд╕реНрдХрд░рдг <code>msuta64.dll</code> (рддрд╛рд▓рд┐рдХрд╛ 2 рджреЗрдЦреЗрдВ)ред  рдПрдХ рдордзреНрдпрд╡рд░реНрддреА рд╣реЛрд╕реНрдЯ рдХрд┐рд╕реА рднреА рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдкрд╣рд▓реЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд░рд┐рдореЛрдЯ рдПрдХреНрд╕реЗрд╕ рдорд╛рд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдбрд┐рдмрдЧрд┐рдВрдЧ рдСрдкрд░реЗрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдбреЗрд╡рд▓рдкрд░ рдХреЛ рдкреИрдЪ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдореЗрдореЛрд░реА рдкрддреЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред <br><br><div class="scrollable-table"><table><tbody><tr><td>  рдЧреБрдг </td><td>  рдЕрд░реНрде рдпрд╛ рд╡рд┐рд╡рд░рдг </td></tr><tr><td>  рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо </td><td>  msuta64.dll <br></td></tr><tr><td>  md5 </td><td>  66da7ed621149975f6e643b4f9886cfd </td></tr><tr><td>  SHA1 </td><td>  ad61e8daeeba43e442514b177a1b41ad4b7c6727 <br></td></tr><tr><td>  рд╕рдВрдХрд▓рди рд╕рдордп </td><td>  2012-09-20 08:07:12 </td></tr><tr><td>  рддреИрдирд╛рдд </td><td>  2013-09-29 07:58:16 <br></td></tr><tr><td>  рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ </td><td>  50688 рдмрд╛рдЗрдЯреНрд╕ </td></tr><tr><td>  рдордВрдЪ </td><td>  .text, .rdata, .data, .pdata, .rsrc, .reloc <br></td></tr><tr><td>  рдирд┐рд░реНрдпрд╛рдд </td><td><p>  ii (рдкреИрдЪ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ) </p><p>  uu (рдкреИрдЪ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ) </p><p>  Dllentrypoint (рдбрд┐рдлрд╝реЙрд▓реНрдЯ dll рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд┐рдВрджреБ) </p></td></tr></tbody></table></div><br>  <i>рддрд╛рд▓рд┐рдХрд╛ 2. рдирдореВрдирд╛ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА <code>msuta64.dll</code> ред</i> <br><br>  рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдиреЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреЛ 64-рдмрд┐рдЯ DLL рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд░рд┐рдирд┐рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛: <br><br><ol><li>  рдкреАрдбрд╝рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдордЪрд╛рди рдореЗрдЬрдмрд╛рди рдкрд░ рд╕реНрдЯреЗрдЬрд┐рдВрдЧ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА DLL рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред  CTU рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдХрдВрдХрд╛рд▓ рдХреА DLL рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЬреБрдбрд╝реЗ рддреАрди рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд┐рдпрд╛: ole64.dll, ole.dll рдФрд░ msuta64.dllред  рд╡рд┐рдВрдбреЛрдЬ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡реИрдз ole32.dll рдлрд╝рд╛рдЗрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЗрд╕ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ рд╣реИред </li><li>  рдЪреЛрд░реА рд╣реБрдП рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред </li><li>  рдпрджрд┐ рдЪреЛрд░реА рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЕрдм рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдирд┐рдореНрди рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рд╕реЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рдЪреЛрд░реА рдХреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рд╕рд╛рде рдкрд░рд┐рдЪрд┐рддрддрд╛ рдХрд╛ рдЕрд░реНрде рд╣реИ: <br><br><ul><li>  рдкреАрдбрд╝рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдПрдХ рдФрд░ рдЙрдкрд▓рдмреНрдз рд╕рд░реНрд╡рд░ рдХреА рд╕реНрдореГрддрд┐ </li><li>  рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдиреМрдХрд░рд┐рдпрд╛рдВ </li><li>  рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░реЗрдВ </li><li>  рд▓рдХреНрд╖реНрдп рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ C: \ WINDOWS \ system32 \ рдХреЗ рд▓рд┐рдП рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА DLL рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </li></ul></li><li>  Rundll32 рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рдХреНрд╖реНрдп рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА DLL рдлрд╝рд╛рдЗрд▓ рдХреЛ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx">PsExec</a> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЪреБрдирд╛ рдЧрдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб NTLM рд╣реИрд╢ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡рд░реВрдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреЛ рддреИрдирд╛рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ <code>NTLM: psexec -accepteula \\% TARGET-DC% rundll32 &lt;  DLL&gt; ii &lt;  NTLM&gt;</code> </li><li>  рд▓рдХреНрд╖реНрдп рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ C: \ WINDOWS \ system32 \ рд╕реЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА DLL рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдПрдВред </li><li>  рд╕рдВрдХреНрд░рдордг рдореЗрдЬрдмрд╛рди рдкрд░ рдордВрдЪрди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА DLL рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╣рдЯрд╛рдПрдБред </li><li>  рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП NTLMh рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ AD рдФрд░ рдЦрд╛рддреЗ рдХреЗ рд╕рд╛рде "рдиреЗрдЯ рдЙрдкрдпреЛрдЧ" рдЖрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреА рд╕рдлрд▓ рддреИрдирд╛рддреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВред </li></ol><br>  рд╕реАрдЯреАрдпреВ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдПрдХ рдПрдореНрдмреЗрдбреЗрдб рдкрд╛рд╕рд╡рд░реНрдб рдкреИрдЯрд░реНрди рдХреА рдЦреЛрдЬ рдХреА рдЬреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЗ рдПрдХ рд╕рдореВрд╣ рдиреЗ рдХрдИ рд╕рдВрдЧрдардиреЛрдВ рдореЗрдВ рдХрдВрдХрд╛рд▓ рдХреА рдХреБрдВрдЬреА рддреИрдирд╛рдд рдХреА рд╣реИред <br><br>  рдЙрдкрдпреЛрдЧрд┐рддрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рд╡рд┐рдВрдбреЛрдЬ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪреЗрддрд╛рд╡рдиреА рджреЗрдХрд░ PsExec рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд╛ рдкрддрд╛ Windows рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдирд┐рдореНрди рдИрд╡реЗрдВрдЯ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛, рдЬреЛ рд▓рдХреНрд╖реНрдп рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рджреЗрдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ, PsExec рдЙрдкрдХрд░рдг рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЗрд╕рдХреА рд╕реЗрд╡рд╛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╕реЗрд╡рд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╕реЗрд╡рд╛ рдХреЛ рд░реЛрдХрддрд╛ рд╣реИред  рдЬрдм рднреА PsExec рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпреЗ рдШрдЯрдирд╛рдПрдБ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╡реЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдпрд╛ рд╡реИрдз рд╣реИрдВ: <br><br><ul><li>  AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рдЕрдирдкреЗрдХреНрд╖рд┐рдд PSEXESVC рд╕реЗрд╡рд╛ рд╕реНрдерд╛рдкрдирд╛ рдИрд╡реЗрдВрдЯ (рдИрд╡реЗрдВрдЯ рдХреЛрдб 7045): <br><br>  <i>рд▓реЙрдЧ рдирд╛рдо</i> : рд╕рд┐рд╕реНрдЯрдо <br>  <i>рд╕реНрд░реЛрдд</i> : рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ <br>  <i>рд╕рд╛рд░рд╛рдВрд╢</i> : рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдХ рд╕реЗрд╡рд╛ рд╕реНрдерд╛рдкрд┐рдд рд╣реИред <br>  <i>рд╕реЗрд╡рд╛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо</i> : <br> <code>%SystemRoot%\PSEXESVC.exe</code> </li> <li>  AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ рдЕрдирдкреЗрдХреНрд╖рд┐рдд PSEXESVC рд╕реЗрд╡рд╛ рдкреНрд░рд╛рд░рдВрдн (рдЗрд╡реЗрдВрдЯ рдХреЛрдб 7036) рд░реЛрдХреЗрдВ: <br><br>  <i>рд▓реЙрдЧ рдирд╛рдо</i> : рд╕рд┐рд╕реНрдЯрдо <br>  <i>рд╕реНрд░реЛрдд</i> : рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ <br>  <i>рд╕рд╛рд░рд╛рдВрд╢</i> : <br><ul><li>  "PSEXESVC рд╕реЗрд╡рд╛ рдЪрд╛рд▓реВ рд╣реИред" </li><li>  "PSEXESVC рд╕реЗрд╡рд╛ рдиреЗ рдПрдХ рд░реБрдХреА рд╣реБрдИ рдЕрд╡рд╕реНрдерд╛ рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХрд┐рдпрд╛ рд╣реИред" </li></ul></li></ul><br>  рдПрдХ рдЪрд▓ рд░рд╣реЗ рд░рд╛рдЬреНрдп рдореЗрдВ рдПрдХ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <br><br><ol><li>  Windows рдХреЗ рдирд┐рдореНрди рд╕рдВрдЧрдд 64-рдмрд┐рдЯ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВред  рдореИрд▓рд╡реЗрдпрд░ рд╡рд┐рдВрдбреЛрдЬ рдХреЗ 32-рдмрд┐рдЯ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдпрд╛ рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рдирд╣реАрдВ рд╣реИ рдЬреЛ рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд░ 2012 (6.2) рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред <br><br><ul><li>  6.1 (Windows 2008 R2) </li><li>  6.0 (рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд░ 2008) </li><li>  5.2 (Windows 2003 R2) </li></ul></li><li>  рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рд╕рдмрд╕рд┐рд╕реНрдЯрдо (LSASS) рд╕реЗрд╡рд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SeDebugPrivilege рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ AD рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд╣рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИред </li><li>  LSASS рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрднрд╛рд▓ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВред </li><li>  рддрдп рдХрд┐рдП рдЧрдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдВрдмрдВрдзрд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкрддреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: <br><br><ul><li>  CDLocateCSystem - cryptdll.dll рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ </li><li>  SamiretrieveMultiplePrimaryCredentials - samsrv.dll рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ </li><li>  SamiretrievePrimaryCredentials - samsrv.dll рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ </li></ul></li><li>  рдЪрд░рдг 1 рдореЗрдВ рд╕рдВрдЧрддрддрд╛ рдЬрд╛рдБрдЪ рдХреЗ рджреМрд░рд╛рди рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдУрдПрд╕ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдмрдирд╛рдПрдВред </li><li>  LSASS рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрднрд╛рд▓ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП OpenProcess рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </li><li>  рдПрд▓рдПрд╕рдПрдПрд╕рдПрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдФрд░ рдкреИрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдореЗрдореЛрд░реА рд╕реНрдкреЗрд╕ рдЖрд░рдХреНрд╖рд┐рдд рдФрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВред </li><li>  рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕рдВрдмрдВрдзрд┐рдд рдХрд╛рд░реНрдп рдкреИрдЪрд┐рдВрдЧ: <br><br><ul><li>  CDLocateCSystem (рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рд╕рднреА рд╕рдВрдЧрдд рд╕рдВрд╕реНрдХрд░рдг) </li><li>  SamiretrieveMultiplePrimaryCredentials (рдХреЗрд╡рд▓ Windows 2008 R2 (6.1)) </li><li>  SamiretrievePrimaryCredentials (Windows 2008 R2 (6.1) рдХреЛ рдЫреЛрдбрд╝рдХрд░ Windows рдХреЗ рд╕рднреА рд╕рдВрдЧрдд рд╕рдВрд╕реНрдХрд░рдг) </li></ul></li></ol><br>  рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: <br><br><ol><li>  VirtualProtectEx рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЖрд╡рд╢реНрдпрдХ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдкреНрд░реЛрдЯреЗрдХреНрд╢рди рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд░реЗрдВ (PAGE_EXECUTE_READWRITE, 0x40)ред  рдпрд╣ рдЪрд░рдг рдЖрдкрдХреЛ рдлрд╝рдВрдХреНрд╢рди рдХреЛрдб рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </li><li>  рд▓рдХреНрд╖реНрдп рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП WriteProcessMemory рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕рд╣реА рдХреЛрдб рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗред  рдпрд╣ рдкрд░рд┐рд╡рд░реНрддрди рдкреИрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИред </li><li>  рдореВрд▓ рд╕реНрдореГрддрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдЭрдВрдбреЗ рдХреЗ рд╕рд╛рде VirtualProtectEx рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдореВрд▓ рд╕реНрдореГрддрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред  рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рд╕реНрдореГрддрд┐ рдХреЗ рд╕рдВрджрд┐рдЧреНрдз рдЖрд╡рдВрдЯрди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХрджрдо рдЖрд╡рд╢реНрдпрдХ рд╣реИред </li></ol><br>  рдкреИрдЪрд┐рдВрдЧ рдХреЗ рдмрд╛рдж, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА рднреА рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдирд┐рдпреЛрдЬрди рдХреЗ рджреМрд░рд╛рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрднреА рднреА рдЕрдкрдиреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕ рдПрдХ рддрд░рдлрд╝рд╛ AD рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд╡реЗрдмрдореЗрд▓ рдФрд░ рд╡реАрдкреАрдПрди, рдФрд░ рдХреАрдмреЛрд░реНрдб рдкрд░ рдПрдХ рдПрдореНрдмреЗрдбреЗрдб рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЕрдирд▓реЙрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдордЭреМрддрд╛ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд▓рд┐рдП рднреМрддрд┐рдХ рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br><h4>  <i>рдбреЛрдореЗрди рдкреНрд░рддрд┐рдХреГрддрд┐ рдореБрджреНрджреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрднрд╡ рд╕рд╣рдпреЛрдЧ</i> </h4><br>  рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рд╕рдВрдЪрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ-рдЖрдзрд╛рд░рд┐рдд рдЦреЛрдЬ рдХреЛ рдЕрдкреНрд░рднрд╛рд╡реА рдмрдирд╛рддреА рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕ рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдбреЛрдореЗрди рдкреНрд░рддрд┐рдХреГрддрд┐ рд╕рдорд╕реНрдпрд╛рдУрдВ рдореЗрдВ рдлрдВрд╕рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рд╕рдВрдХреНрд░рдордг рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддрд╛ рд╣реИред  рд╕реАрдЯреВ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдкрддрд╛ рдЪрд▓рд╛ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рддреИрдирд╛рддреА рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж, рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдХреГрддрд┐ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рд╛, рдЬрд┐рдиреНрд╣реЗрдВ Microsoft рд╕рдорд░реНрдерди рджреНрд╡рд╛рд░рд╛ рд╕рдордЭрд╛рдпрд╛ рдпрд╛ рд╣рд▓ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛, рдФрд░ рдЕрдВрддрддрдГ рдЙрдиреНрд╣реЗрдВ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░рд┐рдмреВрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАред  рдЗрди рд░рд┐рдмреВрдЯ рдиреЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдИрдкрд╛рд╕ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рдореИрд▓рд╡реЗрдпрд░ рдореЗрдВ рджреГрдврд╝рддрд╛ рддрдВрддреНрд░ рдирд╣реАрдВ рд╣реИред  рдЕрдВрдЬреАрд░ рдореЗрдВред  рдЪрд┐рддреНрд░рд╛ 1 рдЗрди рд░рд┐рдмреВрдЯ рдХреА рд╕рдордпрд░реЗрдЦрд╛, рд╕рд╛рде рд╣реА рдШреБрд╕рдкреИрдард┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЪреЛрд░реА, рдкрд╛рд░реНрд╢реНрд╡ рд╡рд┐рд╕реНрддрд╛рд░ рдФрд░ рдХрдВрдХрд╛рд▓ рдХреА рддреИрдирд╛рддреА рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред  рд░рд┐рдмреВрдЯ рдХреЗ рдмрд╛рдж рдХреБрдЫ рдШрдВрдЯреЛрдВ рдпрд╛ рдХрдИ рджрд┐рдиреЛрдВ рдХреЗ рдмрд╛рдж рдЖрдо рддреМрд░ рдкрд░ рд░рд┐рд▓реЛрдХреЗрд╢рди рд╣реЛрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/qo/jp/fz/qojpfzr6gcqy84wv_hl9f4xjnk4.png"><br>  <i>рдЪрд┐рддреНрд░рд╛ 1. рддреИрдирд╛рддреА рдФрд░ рд░рд┐рдмреВрдЯ рд╕рдВрдмрдВрдз CTU рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рджреЗрдЦрд╛ рдЧрдпрд╛, рдЕрдкреНрд░реИрд▓ - рдЬреБрд▓рд╛рдИ 2014 (рд╕реНрд░реЛрдд: рдбреЗрд▓ рд╕рд┐рдХреНрдпреЛрд░рд╡рд░реНрдХреНрд╕)</i> <br><br><h3>  countermeasures </h3><br>  рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддреА рд╣реИ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдЙрддреНрдкрдиреНрди рдирд╣реАрдВ рдХрд░рддреА рд╣реИред  рдирддреАрдЬрддрди, рдиреЗрдЯрд╡рд░реНрдХ рдШреБрд╕рдкреИрда рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд░реЛрдХрдерд╛рдо рдкреНрд░рдгрд╛рд▓реА (рдЖрдИрдбреАрдПрд╕ / рдЖрдИрдкреАрдПрд╕) рдЗрд╕ рдЦрддрд░реЗ рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛рдПрдЧрд╛ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, CTU рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА DLL рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://www.secureworks.com/research/skeleton-key-malware-analysis">рдкрд░рд┐рд╢рд┐рд╖реНрдЯ A</a> рдореЗрдВ YARA рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд▓рд┐рдЦреЗ рдФрд░ рдХреЛрдб рдЬреЛ рдХрд┐ LSASS рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИред <br><br><h3>  рд╕рдВрдХреЗрддрдХ рдХрд╛ рдЦрддрд░рд╛ </h3><br>  рддрд╛рд▓рд┐рдХрд╛ 3 рдореЗрдВ рдЦрддрд░реЗ рдХреЗ рд╕рдВрдХреЗрддрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><div class="scrollable-table"><table><tbody><tr><td>  рд╕реВрдЪрдХ </td><td>  рдЯрд╛рдЗрдк </td><td>  рдкреНрд░рд╕рдВрдЧ </td></tr><tr><td>  66da7ed621149975f6e643b4f9886cfd </td><td>  md5 рд╣реИрд╢ </td><td>  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреИрдЪ msuta64.dll </td></tr><tr><td>  ad61e8daeeba43e442514b177a1b41ad4b7c6727 </td><td>  sha1 рд╣реИрд╢ </td><td>  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреИрдЪ msuta64.dll </td></tr><tr><td>  bf45086e6334f647fda33576e2a05826 </td><td>  md5 рд╣реИрд╢ </td><td>  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреИрдЪ ole64.dl </td></tr><tr><td>  5083b17ccc50dd0557dfc544f84e2ab55d6acd92 </td><td>  sha1 рд╣реИрд╢ </td><td>  рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдкреИрдЪ ole64.dl </td></tr></tbody></table></div><br>  <i>рддрд╛рд▓рд┐рдХрд╛ 3. рдХрдВрдХрд╛рд▓ рдХреА рдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрддрдХред</i> <br><br><h3>  рдирд┐рд╖реНрдХрд░реНрд╖ </h3><br>  CTU рдЕрдиреБрд╕рдВрдзрд╛рди рд╕рдореВрд╣ рд╕рдВрдЧрдардиреЛрдВ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдВрдХрд╛рд▓ рдкреНрд░рдореБрдЦ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВ: <br><br><ul><li>  рд╡реАрдкреАрдПрди рдФрд░ рд░рд┐рдореЛрдЯ рдИ-рдореЗрд▓ рд╕рд╣рд┐рдд рд╕рднреА рд░рд┐рдореЛрдЯ рдПрдХреНрд╕реЗрд╕ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╣реБ-рдХрд╛рд░рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг, рдЪреЛрд░реА рдХрд┐рдП рдЧрдП рд╕реНрдерд┐рд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХрд▓-рдХрд╛рд░рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЦрддрд░реЗ рдореЗрдВ рдбрд╛рд▓рдиреЗ рд╡рд╛рд▓реЗ рдЕрднрд┐рдиреЗрддрд╛рдУрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред </li><li>  AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рд╕рд╣рд┐рдд рд╡рд░реНрдХрд╕реНрдЯреЗрд╢рди рдФрд░ рд╕рд░реНрд╡рд░ рдкрд░ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд░реНрдорд╛рдг рдСрдбрд┐рдЯ рд▓реЙрдЧ, рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рддреИрдирд╛рддреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╕рдВрдЧрдардиреЛрдВ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд▓рд╛рдХреГрддрд┐рдпреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП: <br><br><ul><li>  рдЕрдирдкреЗрдХреНрд╖рд┐рдд PsExec.exe рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдФрд░ PsExec "-accepteula" рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рддрд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ </li><li>  рдЕрдирдкреЗрдХреНрд╖рд┐рдд rundll32.exe рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ </li><li>  NTLM рд╣реИрд╢ рдХреЛрдб (рдирдВрдмрд░ 0-9 рдФрд░ AF рд╡рд░реНрдг рд╡рд╛рд▓реЗ 32 рд╡рд░реНрдг) рдХреЗ рд╕рдорд╛рди рддрд░реНрдХ рд╡рд┐рддрд░реНрдХ рдХрд░реЗрдВ </li></ul></li><li>  AD рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдкрд░ Windows рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрдХ рдИрд╡реЗрдВрдЯ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдирд╛ PSEXESVC PsExec рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЕрдирдкреЗрдХреНрд╖рд┐рдд рд╕рд░реНрд╡рд┐рд╕ рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдЗрд╡реЗрдВрдЯреНрд╕ (рдЗрд╡реЗрдВрдЯ рдХреЛрдб 7045) рдФрд░ рд╕реНрдЯрд╛рд░реНрдЯ / рд╕реНрдЯреЙрдк рдЗрд╡реЗрдВрдЯреНрд╕ (рдЗрд╡реЗрдВрдЯ рдХреЛрдб 7036) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред </li></ul><br><h3>  рдкрд░рд┐рд╢рд┐рд╖реНрдЯ A - YARA рд╣рд╕реНрддрд╛рдХреНрд╖рд░ </h3><br>  рдирд┐рдореНрди YARA рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рд╕рдВрджрд┐рдЧреНрдз рдлрд╝рд╛рдЗрд▓ рдпрд╛ рд╕рдХреНрд░рд┐рдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреА рдореЗрдореЛрд░реА рдбрдВрдк, рд╕рдВрднрд╡рддрдГ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рд╕реЗ рд╕реНрдХреИрди рдХрд░рдХреЗ рдПрдХ рдХрдВрдХрд╛рд▓ рдХреБрдВрдЬреА рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддреЗ рд╣реИрдВред <br><br><pre> <code class="bash hljs">rule skeleton_key_patcher { strings: <span class="hljs-variable"><span class="hljs-variable">$target_process</span></span> = <span class="hljs-string"><span class="hljs-string">"lsass.exe"</span></span> wide <span class="hljs-variable"><span class="hljs-variable">$dll1</span></span> = <span class="hljs-string"><span class="hljs-string">"cryptdll.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$dll2</span></span> = <span class="hljs-string"><span class="hljs-string">"samsrv.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$name</span></span> = <span class="hljs-string"><span class="hljs-string">"HookDC.dll"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched1</span></span> = <span class="hljs-string"><span class="hljs-string">"CDLocateCSystem"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched2</span></span> = <span class="hljs-string"><span class="hljs-string">"SamIRetrievePrimaryCredentials"</span></span> <span class="hljs-variable"><span class="hljs-variable">$patched3</span></span> = <span class="hljs-string"><span class="hljs-string">"SamIRetrieveMultiplePrimaryCredentials"</span></span> condition: all of them } rule skeleton_key_injected_code { strings: <span class="hljs-variable"><span class="hljs-variable">$injected</span></span> = { 33 C0 85 C9 0F 95 C0 48 8B 8C 24 40 01 00 00 48 33 CC E8 4D 02 00 00 48 81 C4 58 01 00 00 C3 } <span class="hljs-variable"><span class="hljs-variable">$patch_CDLocateCSystem</span></span> = { 48 89 5C 24 08 48 89 74 24 10 57 48 83 EC 20 48 8B FA 8B F1 E8 ?? ?? ?? ?? 48 8B D7 8B CE 48 8B D8 FF 50 10 44 8B D8 85 C0 0F 88 A5 00 00 00 48 85 FF 0F 84 9C 00 00 00 83 FE 17 0F 85 93 00 00 00 48 8B 07 48 85 C0 0F 84 84 00 00 00 48 83 BB 48 01 00 00 00 75 73 48 89 83 48 01 00 00 33 D2 } <span class="hljs-variable"><span class="hljs-variable">$patch_SamIRetrievePrimaryCredential</span></span> = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 49 8B F9 49 8B F0 48 8B DA 48 8B E9 48 85 D2 74 2A 48 8B 42 08 48 85 C0 74 21 66 83 3A 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 14 E8 ?? ?? ?? ?? 4C 8B CF 4C 8B C6 48 8B D3 48 8B CD FF 50 18 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 } <span class="hljs-variable"><span class="hljs-variable">$patch_SamIRetrieveMultiplePrimaryCredential</span></span> = { 48 89 5C 24 08 48 89 6C 24 10 48 89 74 24 18 57 48 83 EC 20 41 8B F9 49 8B D8 8B F2 8B E9 4D 85 C0 74 2B 49 8B 40 08 48 85 C0 74 22 66 41 83 38 26 75 1B 66 83 38 4B 75 15 66 83 78 0E 73 75 0E 66 83 78 1E 4B 75 07 B8 A1 02 00 C0 EB 12 E8 ?? ?? ?? ?? 44 8B CF 4C 8B C3 8B D6 8B CD FF 50 20 48 8B 5C 24 30 48 8B 6C 24 38 48 8B 74 24 40 48 83 C4 20 5F C3 } condition: any of them }</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi481778/">https://habr.com/ru/post/hi481778/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi481764/index.html">рд╣рд░рд┐рдд рдКрд░реНрдЬрд╛ рдХреЗ рдкрд╛рд╕ рдХрдард┐рди рднрд╡рд┐рд╖реНрдп рдХреНрдпреЛрдВ рд╣реИ?</a></li>
<li><a href="../hi481768/index.html">рд╣рдо 1C рдореЗрдВ WebKit рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, TinyMCE рдХрд╛ рдПрдХреАрдХрд░рдг UT 11 рдореЗрдВ рдПрдХ рдкреНрд░рдмрдВрдзрд┐рдд рд░реВрдк рдореЗрдВ</a></li>
<li><a href="../hi481772/index.html">VonmoTrade рдкреНрд░рдпреЛрдЧред рднрд╛рдЧ 2: рдЖрджреЗрд╢ред рдкреНрд░рдХрд╛рд░, рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕реБрд╡рд┐рдзрд╛рдПрдБ</a></li>
<li><a href="../hi481774/index.html">рд╕реБрд░рдХреНрд╖рд╛ рдзреЛрдЦрд╛ рд╢реАрдЯреНрд╕: рд╡рд░реНрдЪреБрдЕрд▓ рдкреИрдЪрд┐рдВрдЧ</a></li>
<li><a href="../hi481776/index.html">5 рдЬреА рдФрд░ рдХреНрд▓рд╛рдЙрдб рдЧреЗрдорд┐рдВрдЧ рд╕реЗрд╡рд╛рдПрдВ - рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рдореЙрд╕реНрдХреЛ рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi481780/index.html">MyOffice рдореЗрдВ 200 рд╕реЗ рдЕрдзрд┐рдХ рдирдИ рд╕реБрд╡рд┐рдзрд╛рдПрдБ рд╣реИрдВ</a></li>
<li><a href="../hi481782/index.html">рдкрд╛рдпрдерди рдЯреНрд░рд╛рдВрд╕рд▓реЗрдЯрд░ рд╕рдорд╕реНрдпрд╛рдУрдВ рдФрд░ рднрд╛рд╖рд╛ рдкрд░ рдкреБрдирд░реНрд╡рд┐рдЪрд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi481784/index.html">рдХрдлрдХрд╛ рдХреИрд╕реЗ рд╕рдЪ рд╣реБрдЖ</a></li>
<li><a href="../hi481786/index.html">Google PHP IMAP рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рджрдлрди рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi481788/index.html">рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЙрджреНрдпреЛрдЧ рдХреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╕реБрд▓рдЭрд╛рдиреЗ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рдмрдЪрдд рдЧреБрд▓реНрд▓рдХ рдФрд░ рдЕрдиреНрдп)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>