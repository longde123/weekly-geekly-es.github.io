<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😭 💼 🍜 Memulai dengan Google Sheets di Python. Dari mendaftar hingga membaca data 🧛🏼 🙆🏼 🏧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Untuk beberapa waktu saya berhasil mengunggah data ke Excel, tetapi modnya berubah, pengguna menginginkannya di awan. 

 Setelah mulai menerjemahkan s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memulai dengan Google Sheets di Python. Dari mendaftar hingga membaca data</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483302/">  Untuk beberapa waktu saya berhasil mengunggah data ke Excel, tetapi modnya berubah, pengguna menginginkannya di awan. <br><br>  Setelah mulai menerjemahkan sejumlah proyek ke dalam Python, saya memutuskan bahwa sudah waktunya untuk mengubah (atau menambah) Excel dengan sesuatu yang lebih modern. <br><br>  Ketika saya pertama kali menemukan kebutuhan untuk bekerja dengan Google spreadsheet dari Python, saya berada di bawah ilusi bahwa semua ini dapat dilakukan dalam beberapa klik.  Realitas ternyata tidak terlalu cerah, tetapi kita tidak memiliki globe yang lain. <br><br>  Artikel-artikel itu banyak membantu saya: <br><br><ul><li>  <a href="https://habr.com/ru/post/305378">Kami menghasilkan spreadsheet Google yang indah dari program kami (menggunakan Google Sheets API v4)</a> </li><li>  <a href="http://italylov.ru/blog/all/probuem-rabotat-s-google-sheets-api/">Memulai dengan Google Sheets API v4 /</a> </li><li>  <a href="http://datalytics.ru/all/rabotaem-s-api-google-drive-s-pomoschyu-python/">Bekerja dengan Google Drive API dengan Python</a> </li></ul><br>  Seperti biasa - ketika Anda pertama kali mengambil sesuatu, Anda dihadapkan dengan banyak pertanyaan yang kemudian hanya menyebabkan kebingungan - bagaimana mungkin ada orang yang berpikir tentang hal ini.  SD! <br><br>  Mungkin saya hanya berjalan jauh - saya akan senang jika Anda memperbaiki saya. <br><br>  Semua tindakan dilakukan pada komputer yang menjalankan Windows + Python 3.6.6, dan Notebook Jupyter juga digunakan. <br><br>  Kesulitan utama yang saya miliki pada tahap pengaturan awal.  Menemukan kode yang bisa diterapkan tidak sulit. <br><br>  Kode yang digunakan dalam artikel tersedia <a href="https://github.com/ovkgit/google_sheets_python">di repositori.</a> <br><a name="habracut"></a><br><h2>  Mendaftar untuk layanan Google dan instal perpustakaan </h2><br>  Untuk bekerja dengan tabel, Anda harus mendaftar dengan Google, mengatur proyek dan menginstal perpustakaan yang diperlukan. <br><br>  <a href="https://developers.google.com/sheets/">Dokumentasi resmi dalam bahasa Inggris ada di sini</a> . <br><br>  Pertama, Anda perlu mendaftar di gmail.com (Anda dapat melakukannya sendiri).  Maka Anda perlu membuat proyek (karena Google menyediakan akses ke layanannya). <br><br>  Ini adalah proses yang panjang dan melelahkan yang memungkinkan Anda memahami mengapa antarmuka Google disebut bukan yang paling nyaman dan intuitif (beberapa percaya bahwa jaringan sosial Google+ tidak lepas landas karena alasan ini). <br><br>  Untuk melakukan ini, buka <a href="https://console.developers.google.com/cloud-resource-manager">console.developers.google.com/cloud-resource-manager</a> dan klik "Buat Proyek" <br><br><img src="https://habrastorage.org/webt/fi/-w/y6/fi-wy693xsw54m-xh7jnh-17ble.jpeg"><br><br>  Masukkan nama proyek dan klik "Buat" <br><br><img src="https://habrastorage.org/webt/pq/li/wq/pqliwqiudct5g7s6q_rm6iag6tw.jpeg"><br><br>  Dalam daftar proyek yang diperbarui buka menu "Izin" <br><img src="https://habrastorage.org/webt/3z/pr/yb/3zprybr3paa7eqi5sxsurdt_aq8.jpeg"><br><br>  Di jendela yang terbuka, klik "Tambah", masukkan alamat email Anda dari domain gmail.com dan pilih grup "Proyek" - "Pemilik" <br><br><img src="https://habrastorage.org/webt/fu/4a/cl/fu4aclu3gibqg8-1rae94sovf08.jpeg"><br><br>  Simpan perubahannya. <br><br>  Mungkin terlihat aneh bahwa Anda membuat proyek tetapi dipaksa untuk mengeluarkan hak untuk diri sendiri.  Dan ini sebenarnya aneh, tetapi itu adalah jalan yang harus diambil pada saat menulis kursus ini, sehingga semuanya akan mulai berfungsi sebagaimana mestinya. <br><br>  Kunjungi <a href="https://console.developers.google.com/cloud-resource-manager">console.developers.google.com/cloud-resource-manager</a> lagi <br><br>  Pilih menu Pengaturan pada proyek Anda <br><br><img src="https://habrastorage.org/webt/_p/dx/al/_pdxalr_zhciudnkssxnej4iybo.jpeg"><br><br>  Di jendela yang terbuka, pilih "Akun layanan" dan kemudian "Buat akun layanan" <br><br><img src="https://habrastorage.org/webt/8e/ss/t-/8esst-mi2_3ioiylkv5ej1itpxu.jpeg"><br><br>  Masukkan nama akun dan klik "Buat" <br><br><img src="https://habrastorage.org/webt/4h/fe/18/4hfe18ts9ywn44bevocl3-fpsue.jpeg"><br><br>  Pilih peran Pemilik dan klik Lanjutkan. <br><br><img src="https://habrastorage.org/webt/0x/d9/sx/0xd9sxloeigykugl41pdx_qgp64.jpeg"><br><br>  Di jendela yang muncul, klik Buat Kunci <br><br><img src="https://habrastorage.org/webt/pv/jc/xk/pvjcxkvp6mjwda30w3uorjkbex4.jpeg"><br><br>  Pilih jenis kunci json dan klik Buat <br><br><img src="https://habrastorage.org/webt/75/sz/3l/75sz3lffo7nr8119jrpu-vvm1i8.jpeg"><br><br>  File dengan kunci akan dibuat dan segera diunduh.  Simpan itu, berkat itu kita akan dapat mengakses layanan Google. <br><br>  Klik tombol dengan tiga goresan horizontal, di sebelah kiri tulisan "Google API", pilih "API dan Layanan", dan di dalamnya ada sub-item "Panel Kontrol". <br><br><img src="https://habrastorage.org/webt/n9/0c/gh/n90cgh2hyrqigsxjus02cwhrt-c.jpeg"><br><br>  Di jendela yang terbuka, klik "Aktifkan API dan Layanan" <br><br><img src="https://habrastorage.org/webt/w8/3f/wc/w83fwcm2h2zcq4qza3pysyjhseu.jpeg"><br><br>  Ketik "google drive" ke dalam bilah pencarian dan klik layanan "Google Drive API" <br><br><img src="https://habrastorage.org/webt/fj/ks/iw/fjksiwvxazgd-6erfruqwrwq8os.jpeg"><br><br>  Klik Aktifkan <br><br><img src="https://habrastorage.org/webt/jk/f-/ys/jkf-ysfiu--oqojyf8vi1lwphao.jpeg"><br><br>  Situs ini akan memberi tahu Anda bahwa API diaktifkan dan memperingatkan Anda bahwa kredensial harus dibuat.  Abaikan peringatan ini (kami telah membuat akun layanan). <br><br><img src="https://habrastorage.org/webt/se/e4/z4/see4z4tacpn3manmkn_tixgkgck.jpeg"><br><br>  Kembali ke panel kontrol <br><br><img src="https://habrastorage.org/webt/c0/ak/ln/c0aklnjxew9zwlph6fgp1ym-yt8.jpeg"><br><br>  Di jendela yang terbuka, klik "Aktifkan API dan Layanan" <br><br><img src="https://habrastorage.org/webt/w8/3f/wc/w83fwcm2h2zcq4qza3pysyjhseu.jpeg"><br><br>  Masukkan "sheet" di bilah pencarian dan klik layanan "Google Sheets API" <br><br><img src="http://img/Task09_17.jpg"><br><br>  Pastikan API ini terhubung.  Ini akan hidup secara otomatis ketika Anda menghubungkan Google Drive API.  Jika terhubung, Anda akan melihat tombol "Kelola API", jika tidak, tombol "Aktifkan".  Nyalakan jika perlu. <br><br>  Terakhir kali, kunjungi <a href="https://console.developers.google.com/cloud-resource-manager">console.developers.google.com/cloud-resource-manager</a> <br><br>  Pilih menu Pengaturan pada proyek Anda <br><br><img src="https://habrastorage.org/webt/ov/ue/i6/ovuei6xocepbhtqmgs8ydb9tbt4.jpeg"><br>  Di jendela yang terbuka, pilih "Akun layanan", lalu salin dan simpan alamat email akun layanan.  Ini akan berguna bagi Anda untuk memberikan akses ke tabel. <br><br><img src="https://habrastorage.org/webt/qh/p5/yr/qhp5yrn74itkqnbwkvtstlcjwha.jpeg"><br><br>  Sekarang kita lanjutkan ke instalasi perpustakaan.  Jalankan perintah di konsol <br><br><pre><code class="bash hljs">pip3 install --upgrade google-api-python-client</code> </pre> <br>  dan kemudian <br><br><pre> <code class="bash hljs">pip3 install oauth2client</code> </pre> <br>  Ada kemungkinan bahwa ketika Anda menjalankan perintah kedua, Anda akan menerima pesan bahwa pustaka oauth2client sudah diinstal. <br><br>  Pergi ke <a href="https://raw.githubusercontent.com/gsuitedevs/python-samples/master/sheets/quickstart/quickstart.py">raw.githubusercontent.com/gsuitedevs/python-samples/master/sheets/quickstart/quickstart.py</a> <br><br>  Tekan tombol kanan mouse dan pilih "Save As" <br><br><img src="https://habrastorage.org/webt/t7/z5/mv/t7z5mvudm8lmipgvbcxsjn6jsr4.jpeg"><br><br>  Simpan file sebagai quickstart.py <br><br>  dan jalankan dengan perintah <br><br><pre> <code class="python hljs">python quickstart.py</code> </pre> <br>  Halaman baru akan terbuka di browser (mungkin itu akan mengatakan bahwa halaman itu tidak aman, tapi terus terang saja) dan Anda harus menerima persyaratannya. <br><br>  Pada jalan ini kita selesai. <br><br><h2>  Mengisi dan memformat tabel </h2><br>  Buat tabel pertama <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   import httplib2 import apiclient.discovery from oauth2client.service_account import ServiceAccountCredentials CREDENTIALS_FILE = 'seraphic-effect-248407-7ac2c44ec709.json' #     ,     #     credentials = ServiceAccountCredentials.from_json_keyfile_name(CREDENTIALS_FILE, ['https://www.googleapis.com/auth/spreadsheets', 'https://www.googleapis.com/auth/drive']) httpAuth = credentials.authorize(httplib2.Http()) #    service = apiclient.discovery.build('sheets', 'v4', http = httpAuth) #      4  API spreadsheet = service.spreadsheets().create(body = { 'properties': {'title': '  ', 'locale': 'ru_RU'}, 'sheets': [{'properties': {'sheetType': 'GRID', 'sheetId': 0, 'title': '  ', 'gridProperties': {'rowCount': 100, 'columnCount': 15}}}] }).execute() spreadsheetId = spreadsheet['spreadsheetId'] #    print('https://docs.google.com/spreadsheets/d/' + spreadsheetId)</span></span></code> </pre><br>  Jika semuanya berjalan tanpa kesalahan, tautan ke tabel akan ditampilkan. <br><br>  Pengidentifikasi file digunakan dalam tautan ini, kami menyimpannya dalam variabel spreadsheetId dan akan menggunakannya di masa mendatang. <br><br>  Ikuti itu.  Google akan memberi tahu Anda bahwa Anda tidak memiliki akses <br><br><img src="https://habrastorage.org/webt/y0/n7/te/y0n7te-mweqjhzr_9eg0gqsj50q.jpeg"><br><br>  Jangan minta izin!  Anda akan menerima pemberitahuan bahwa tidak mungkin mengirimkan surat permintaan ke alamat yang ditetapkan Google sendiri ke akun sistem.  Tetapi Anda tidak dapat mengubah alamat ini.  Mungkin ini tidak hanya bekerja dalam mode bebas. <br><br>  Tetapi kami dapat memberikan diri kami akses melalui Google Drive.  Anda perlu mengganti my_test_address@gmail.com dengan milik Anda. <br><br><pre> <code class="python hljs">driveService = apiclient.discovery.build(<span class="hljs-string"><span class="hljs-string">'drive'</span></span>, <span class="hljs-string"><span class="hljs-string">'v3'</span></span>, http = httpAuth) <span class="hljs-comment"><span class="hljs-comment">#    Google Drive  3  API access = driveService.permissions().create( fileId = spreadsheetId, body = {'type': 'user', 'role': 'writer', 'emailAddress': 'my_test_address@gmail.com'}, #     fields = 'id' ).execute()</span></span></code> </pre> <br>  Sekarang Anda memiliki akses, jangan tutup tabel, kami akan mengelolanya dan segera melihat perubahannya. <br><br>  Setiap dokumen memiliki kode sendiri - spreadsheetId - persis seperti yang ditampilkan di bilah alamat ketika kita membuka tabel di browser (di URL halaman dengan tabel terbuka, itu berada di antara "https://docs.google.com/spreadsheets/d/" dan "/ edit # gid = 0"). <br><br>  Kami menyimpannya di variabel spreadsheetId dan akan terus bekerja dengannya. <br><br>  Pertama, sedikit teori. <br><br>  Di setiap file (spreadsheet) ada sheet-tabs (sheet). <br><br>  Setiap lembar memiliki kode numeriknya sendiri (sheetId).  Lembar pertama yang dibuat dalam dokumen memiliki Id ini sama dengan 0. Lembar yang tersisa memiliki Id non-nol yang sangat berbeda (yaitu, mereka tidak diberi nomor secara berurutan). <br><br>  Pastikan ini <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ { "addSheet": { "properties": { "title": "  ", "gridProperties": { "rowCount": 20, "columnCount": 12 } } } } ] }).execute() #   ,  Id   spreadsheet = service.spreadsheets().get(spreadsheetId = spreadsheetId).execute() sheetList = spreadsheet.get('sheets') for sheet in sheetList: print(sheet['properties']['sheetId'], sheet['properties']['title']) sheetId = sheetList[0]['properties']['sheetId'] print('     Id = ', sheetId)</span></span></code> </pre><br>  Sesuatu seperti ini akan muncul di layar: <br><br><blockquote>  0 Lembar nomor satu <br>  415832263 Daun lagi <br>  Kami akan menggunakan sheet dengan Id = 0 </blockquote><br><br>  Bahkan, lembar pertama memiliki Id nol, dan yang kedua diberi nomor berbeda. <br><br>  Satu pertanyaan lagi: bagaimana menentukan rentang sel.  Rupanya, spreadsheet Google dikembangkan oleh tim yang berbeda, di bawah bimbingan manajer yang berbeda dan dengan bantuan arsitek yang berbeda.  Karena koordinat sel diatur dalam dua cara berbeda. <br><br>  Opsi 1: dalam format teks "Lembar nomor satu! B2: D5", mis.  nama lembar, diikuti dengan tanda seru, setelah - sel kiri atas dalam format "letter (kolom) + number (string)" + sel kanan bawah dalam format yang sama. <br><br><pre> <code class="python hljs">{<span class="hljs-string"><span class="hljs-string">"range"</span></span>: <span class="hljs-string"><span class="hljs-string">"  !B2:D5"</span></span>}</code> </pre> <br>  Opsi 2: dalam format json, menunjukkan ID sheet dan koordinat sel kiri atas dan kanan bawah dalam bentuk numerik (nomor baris dan nomor kolom) <br><br><pre> <code class="python hljs">{<span class="hljs-string"><span class="hljs-string">"range"</span></span>: { <span class="hljs-string"><span class="hljs-string">"sheetId"</span></span>: sheetId, <span class="hljs-comment"><span class="hljs-comment"># ID  "startRowIndex": 1, #    startRowIndex "endRowIndex": 5,#  endRowIndex - 1 (endRowIndex  !) "startColumnIndex": 0, #    startColumnIndex "endColumnIndex": 1 #  endColumnIndex - 1 }}</span></span></code> </pre> <br>  Fungsi yang berbeda menggunakan format yang berbeda. <br><br>  Sekarang kita cukup tahu untuk mengisi sel dengan data, menggambar bingkai dan menyorot header. <br><br><pre> <code class="python hljs">results = service.spreadsheets().values().batchUpdate(spreadsheetId = spreadsheetId, body = { <span class="hljs-string"><span class="hljs-string">"valueInputOption"</span></span>: <span class="hljs-string"><span class="hljs-string">"USER_ENTERED"</span></span>, <span class="hljs-comment"><span class="hljs-comment">#  ,    (  ) "data": [ {"range": "  !B2:D5", "majorDimension": "ROWS", #   ,   "values": [ [" B2", " C2", " D2"], #    ['25', "=6*6", "=sin(3,14/2)"] #    ]} ] }).execute()</span></span></code> </pre> <br>  Isi beberapa sel dengan data.  Karena  parameter USER_ENTERED ditentukan, tabel memahami data ini karena akan menerima input pengguna - mengonversi nilai numerik menjadi angka, dan nilai yang dimulai dengan tanda sama dengan rumus. <br><br>  Lihatlah meja Anda, itu diisi dengan data <br><br><img src="https://habrastorage.org/webt/ob/3h/h_/ob3hh_l6npzamjxabctqph8lrny.jpeg"><br><br>  Atur lebar kolom.  Fungsi batchUpdate dapat menerima beberapa perintah sekaligus, jadi kami akan mengatur lebar tiga grup kolom dengan satu permintaan.  Ada satu kolom di kelompok pertama dan ketiga, dan dua di kelompok kedua. <br><br><pre> <code class="python hljs">results = service.spreadsheets().batchUpdate(spreadsheetId = spreadsheetId, body = { <span class="hljs-string"><span class="hljs-string">"requests"</span></span>: [ <span class="hljs-comment"><span class="hljs-comment">#    A: 20  { "updateDimensionProperties": { "range": { "sheetId": sheetId, "dimension": "COLUMNS", #    "startIndex": 0, #     "endIndex": 1 #    startIndex  endIndex - 1 (endIndex  !) }, "properties": { "pixelSize": 20 #    }, "fields": "pixelSize" # ,     pixelSize } }, #    B  C: 150  { "updateDimensionProperties": { "range": { "sheetId": sheetId, "dimension": "COLUMNS", "startIndex": 1, "endIndex": 3 }, "properties": { "pixelSize": 150 }, "fields": "pixelSize" } }, #    D: 200  { "updateDimensionProperties": { "range": { "sheetId": sheetId, "dimension": "COLUMNS", "startIndex": 3, "endIndex": 4 }, "properties": { "pixelSize": 200 }, "fields": "pixelSize" } } ] }).execute()</span></span></code> </pre> <br>  Lihat tabel, lebar kolom telah berubah. <br><br><img src="https://habrastorage.org/webt/wu/zv/h4/wuzvh4jz9uloyxlkhfnxqk7otke.jpeg"><br><br>  Gambarlah bingkai di sekeliling meja <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ {'updateBorders': {'range': {'sheetId': sheetId, 'startRowIndex': 1, 'endRowIndex': 3, 'startColumnIndex': 1, 'endColumnIndex': 4}, 'bottom': { #      'style': 'SOLID', #   'width': 1, #  1  'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, #   'top': { #      'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'left': { #      'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'right': { #      'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'innerHorizontal': { #       'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}}, 'innerVertical': { #       'style': 'SOLID', 'width': 1, 'color': {'red': 0, 'green': 0, 'blue': 0, 'alpha': 1}} }} ] }).execute()</span></span></code> </pre><br><img src="https://habrastorage.org/webt/7v/8l/db/7v8ldbkjnukd2j6lukhezmaupje.jpeg"><br><br>  Gabungkan sel-sel di atas tabel dan masukkan judul di dalamnya. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   A2:D1 results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ {'mergeCells': {'range': {'sheetId': sheetId, 'startRowIndex': 0, 'endRowIndex': 1, 'startColumnIndex': 1, 'endColumnIndex': 4}, 'mergeType': 'MERGE_ALL'}} ] }).execute() #    results = service.spreadsheets().values().batchUpdate(spreadsheetId = spreadsheetId, body = { "valueInputOption": "USER_ENTERED", #  ,    (  ) "data": [ {"range": "  !B1", "majorDimension": "ROWS", #   ,   "values": [[" " ] ]} ] }).execute()</span></span></code> </pre><br><img src="https://habrastorage.org/webt/ba/pi/tq/bapitq07wcnkdodrbmodxssvvl8.jpeg"><br><br>  Tetapkan format untuk sel header tabel <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    results = service.spreadsheets().batchUpdate( spreadsheetId = spreadsheetId, body = { "requests": [ { "repeatCell": { "cell": { "userEnteredFormat": { "horizontalAlignment": 'CENTER', "backgroundColor": { "red": 0.8, "green": 0.8, "blue": 0.8, "alpha": 1 }, "textFormat": { "bold": True, "fontSize": 14 } } }, "range": { "sheetId": sheetId, "startRowIndex": 1, "endRowIndex": 2, "startColumnIndex": 1, "endColumnIndex": 4 }, "fields": "userEnteredFormat" } } ] }).execute()</span></span></code> </pre><br><img src="https://habrastorage.org/webt/an/mx/ix/anmxixf0r8g3tgobvulohsg3w5i.jpeg"><br><br>  Ada cara mudah untuk mengetahui berapa lebar atau warna yang Anda butuhkan untuk sebuah sel.  Untuk melakukan ini, cukup dengan memformat salah satu sel secara manual dan membaca propertinya. <br><br><pre> <code class="python hljs">ranges = [<span class="hljs-string"><span class="hljs-string">"  !C2:C2"</span></span>] <span class="hljs-comment"><span class="hljs-comment"># results = service.spreadsheets().get(spreadsheetId = spreadsheetId, ranges = ranges, includeGridData = True).execute() print(' ') print(results['properties']) print('\n  ') print(results['sheets'][0]['data'][0]['rowData'] ) print('\n ') print(results['sheets'][0]['data'][0]['rowMetadata']) print('\n ') print(results['sheets'][0]['data'][0]['columnMetadata'])</span></span></code> </pre><br>  Kami mendapat tanggapan <br><blockquote>  Data master <br>  {'title': 'Dokumen uji pertama', 'lokal': 'ru_RU', 'autoRecalc': 'ON_CHANGE', 'timeZone': 'Etc / GMT', 'defaultFormat': {'backgroundColor': {'backgroundColor': {'red' : 1, 'hijau': 1, 'biru': 1}, 'padding': {'top': 2, 'right': 3, 'bottom': 2, 'left': 3}, 'verticalAlignment': 'BOTTOM', 'wrapStrategy': 'OVERFLOW_CELL', 'textFormat': {'foregroundColor': {}, 'fontFamily': 'arial, sans, sans-serif', 'fontSize': 10, 'bold': False, 'italic': False, 'strikethrough': False, 'underline': False}}} <br><br>  Nilai dan pewarnaan <br>  [{'values': [{'userEnteredValue': {'stringValue': 'Cell C2'}, 'effectiveValue': {'stringValue': 'Cell C2'}, 'formattedValue': 'Cell C2', 'userEnteredFormat' : {'backgroundColor': {'red': 1, 'green': 0.6}, 'horizontalAlignment': 'CENTER', 'textFormat': {'fontSize': 14, 'bold': True, 'italic': True }}, 'efektifFormat': {'backgroundColor': {'red': 1, 'green': 0.6}, 'padding': {'top': 2, 'right': 3, 'bottom': 2, ' kiri ': 3},' horizontalAlignment ':' CENTER ',' verticalAlignment ':' BOTTOM ',' wrapStrategy ':' OVERFLOW_CELL ',' textFormat ': {' foregroundColor ': {},' fontFamily ':' Arial ', 'fontSize': 14, 'bold': True, 'italic': True, 'strikethrough': False, 'underline': False}, 'hyperlinkDisplayType': 'PLAIN_TEXT'}}]}]]] <br><br>  Tinggi sel <br>  [{'pixelSize': 21}] <br><br>  Lebar sel <br>  [{'pixelSize': 150}] <br></blockquote>  Kode ini akan menampilkan properti sel C2.  Anda dapat memilih font dan mengisi warna secara manual (dalam tabel), kemudian melihat bagaimana mereka tercermin dalam json. <br><br><h2>  Membaca data dari sebuah tabel </h2><br>  Untuk sepenuhnya mengungkapkan fitur pembacaan data, saya secara manual mengisi sel B4, C7 dan D5 seperti yang ditunjukkan pada gambar. <br><br><img src="https://habrastorage.org/webt/ms/yc/ph/msycphwvaxu8x49rvc2vq6zwdfo.jpeg"><br><br>  Kode untuk membaca data <br><br><pre> <code class="python hljs">ranges = [<span class="hljs-string"><span class="hljs-string">"  !A2:F8"</span></span>] <span class="hljs-comment"><span class="hljs-comment"># results = service.spreadsheets().values().batchGet(spreadsheetId = spreadsheetId, ranges = ranges, valueRenderOption = 'FORMATTED_VALUE', dateTimeRenderOption = 'FORMATTED_STRING').execute() sheet_values = results['valueRanges'][0]['values'] print(sheet_values)</span></span></code> </pre> <br>  Hasil <br><blockquote>  [['', 'Sel B2', 'Sel C2', 'Sel D2'], ['', '25', '36', '0,9999996829']] </blockquote><br>  Beberapa parameter fungsi: <i>valueRenderOption</i> - format untuk membaca data numerik. <br><br><ul><li>  <b>FORMATTED_VALUE</b> - membaca berdasarkan format tampilan.  Yaitu  apa yang terlihat di tabel akan dibaca.  Misalnya, dalam sel D3, angkanya adalah 0,9999999, tetapi formatnya adalah "dua tempat desimal", sehingga "1,00" ditampilkan, dalam format inilah ia akan dibaca. </li><li>  <b>UNFORMATTED_VALUE</b> - konten sel dibaca, pemformatan tidak diperhitungkan (mis., 0,9999999 akan dibaca) </li><li>  <b>FORMULA</b> - rumus ditampilkan (dalam hal ini "= sin (3,14 / 2)." Jika suatu angka dimasukkan dalam sel, maka dalam mode ini akan dibaca. </li></ul><br>  Kode ini membaca data dan menampilkannya baris demi baris.  Rentang yang Dapat Dibaca A2: F8. <br>  Seperti yang terlihat di layar: <br><br><ul><li>  Jika tidak ada sel di baris yang sedang dibaca yang terisi, data pada saluran tersebut tidak ditampilkan. </li><li>  Data setelah sel terisi terakhir tidak ditampilkan. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id483302/">https://habr.com/ru/post/id483302/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id483280/index.html">Sistem File ESP32 dan SPIFFS</a></li>
<li><a href="../id483284/index.html">Bagaimana saya menguraikan jadwal</a></li>
<li><a href="../id483290/index.html">Berpikir desain dalam manajemen proyek atau mengapa manajer proyek membutuhkan teknik kreatif</a></li>
<li><a href="../id483294/index.html">Kami sedang menulis "kalkulator". Bagian II Memecahkan persamaan, render dalam LaTeX, mempercepat fungsi menjadi superlight</a></li>
<li><a href="../id483298/index.html">Cara berhenti tepat, agar nanti ...</a></li>
<li><a href="../id483308/index.html">Eksperimen VonmoTrade. Bagian 4: Grafik Perdagangan</a></li>
<li><a href="../id483310/index.html">Buat lensa untuk Snapchat menggunakan pix2pix</a></li>
<li><a href="../id483312/index.html">Teori Kepingan Salju Besar</a></li>
<li><a href="../id483314/index.html">Cara melakukan tindakan Redux asinkron menggunakan Redux-Thunk</a></li>
<li><a href="../id483316/index.html">Pengantar cepat ke SwiftUI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>