<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïµüèº ‚è∞ üçØ O conceito de malha persistente para controlar a infraestrutura de TI üê¶ üíØ üßë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal. Vou falar sobre microsservi√ßos, mas de um ponto de vista ligeiramente diferente do de Vadim Madison, no post "O que sabemos sobre micross...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O conceito de malha persistente para controlar a infraestrutura de TI</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/462937/"><p>  Ol√° pessoal.  Vou falar sobre microsservi√ßos, mas de um ponto de vista ligeiramente diferente do de Vadim Madison, no post <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"O que sabemos sobre microsservi√ßos"</a> .  Em geral, eu me considero um desenvolvedor de banco de dados.  O que os microsservi√ßos t√™m a ver com isso?  O Avito usa: Vertica, PostgreSQL, Redis, MongoDB, Tarantool, VoltDB, SQLite ... No total, temos mais de 456 bancos de dados para mais de 849 servi√ßos.  E de alguma forma voc√™ precisa viver com isso. </p><br><p>  Neste post, mostrarei como implementamos a descoberta de dados na arquitetura de microsservi√ßos.  Este post √© uma transcri√ß√£o gratuita do meu relat√≥rio com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Highload ++ 2018</a> , o v√≠deo pode ser visto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </p><br><p><img src="https://habrastorage.org/webt/bj/wt/e3/bjwte39wtxw3c5gk5w-1bfu_hfk.png"></p><a name="habracut"></a><br><p>  Todos devem saber como uma arquitetura de microsservi√ßo deve ser constru√≠da em termos de bases.  Aqui est√° o padr√£o com o qual todos geralmente come√ßam.  Existe uma base comum entre os servi√ßos.  No slide, os ret√¢ngulos laranja s√£o servi√ßos, existe uma base comum entre eles. </p><br><p><img src="https://habrastorage.org/webt/vc/t7/xw/vct7xwnbj875pu2fusp_xaahcwg.png"></p><br><p>  Voc√™ n√£o pode viver assim, porque n√£o pode testar servi√ßos isoladamente quando, al√©m da comunica√ß√£o direta entre eles, tamb√©m h√° comunica√ß√£o atrav√©s do banco de dados.  Uma solicita√ß√£o de servi√ßo pode diminuir a velocidade de outro servi√ßo.  Isso √© ruim. </p><br><p><img src="https://habrastorage.org/webt/fv/ax/ze/fvaxzevgnmj7lkfqehybl1jv7uc.png"></p><br><p>  Do ponto de vista do trabalho com bancos de dados para arquitetura de microsservi√ßo, o padr√£o DataBase por Servi√ßo deve ser usado - cada servi√ßo possui seu pr√≥prio banco de dados.  Se houver muitos shards no banco de dados, a base dever√° ser compartilhada para que eles sejam sincronizados.  Isso √© uma teoria, mas na realidade n√£o √© assim. </p><br><p><img src="https://habrastorage.org/webt/il/pt/yz/ilptyzfojo0wsiclxhggpj47mag.png"></p><br><p>  Em empresas reais, eles usam n√£o apenas microsservi√ßos, mas tamb√©m um mon√≥lito.  Existem servi√ßos escritos corretamente.  E existem servi√ßos antigos que ainda usam um padr√£o de base comum. </p><br><p>  Vadim Madison, em sua apresenta√ß√£o, mostrou esta imagem com conex√£o.  S√≥ ele mostrou sem um componente, e a rede nele era uniforme.  Nesta rede no centro, h√° um ponto que est√° conectado a muitos pontos (microsservi√ßos).  Este √© um mon√≥lito.  √â pequeno no diagrama.  Mas, de fato, o mon√≥lito √© grande.  Quando falamos de uma empresa real, √© necess√°rio entender as nuances da coexist√™ncia da arquitetura monol√≠tica microsservi√ßos, nascida e de sa√≠da, mas ainda importante. </p><br><p>  Como um mon√≥lito √© reescrito em uma arquitetura de microsservi√ßo no n√≠vel de planejamento?  Obviamente, isso √© modelagem de dom√≠nio.  Em todos os lugares, diz que voc√™ precisa fazer a modelagem de dom√≠nio.  Mas, por exemplo, n√≥s no Avito por v√°rios anos criamos microsservi√ßos sem modelagem de dom√≠nio.  Ent√£o eu peguei e desenvolvedores de banco de dados.  Estamos cientes de fluxos de dados completos.  Esse conhecimento ajuda a projetar um modelo de dom√≠nio. </p><br><p><img src="https://habrastorage.org/webt/wr/kk/qa/wrkkqaxqq5wd-2gwilprpsroqhm.png"></p><br><p>  A descoberta de dados tem uma interpreta√ß√£o cl√°ssica - √© assim que se trabalha com dados espalhados por diferentes armazenamentos, a fim de levar a conclus√µes agregadas e fazer as conclus√µes corretas.  Isso √© realmente tudo besteira de marketing.  Essas defini√ß√µes s√£o sobre como baixar todos os dados dos microsservi√ßos para o armazenamento.  Sobre isso eu tive relat√≥rios h√° v√°rios anos, n√£o vamos nos debru√ßar sobre isso. </p><br><p>  Vou falar sobre outro processo, mais pr√≥ximo do processo de mudan√ßa para microsservi√ßos.  Quero mostrar como voc√™ pode entender a complexidade de um sistema em constante evolu√ß√£o em termos de dados, em termos de microsservi√ßos.  Onde ver toda a imagem de centenas de servi√ßos, bases, equipes, pessoas?  De fato, esta quest√£o √© a principal id√©ia do relat√≥rio. </p><br><p><img src="https://habrastorage.org/webt/uw/_a/l7/uw_al7h6mh9otso2s6sxie3fzhs.png"></p><br><p>  Para n√£o morrer nessa arquitetura de microsservi√ßo, voc√™ precisa de um g√™meo digital.  Sua empresa √© a totalidade de tudo que fornece a infraestrutura tecnol√≥gica.  Voc√™ precisa criar uma imagem adequada de todas essas dificuldades, com base nas quais pode resolver rapidamente problemas.  E este n√£o √© um reposit√≥rio anal√≠tico. </p><br><p><img src="https://habrastorage.org/webt/85/hf/p_/85hfp_vxlagi-frp4cwssioo_eg.png"></p><br><p>  Que tarefas podemos definir para um g√™meo digital?  Afinal, tudo come√ßou com a descoberta de dados mais simples. </p><br><p>  <strong>Perguntas:</strong> </p><br><ul><li>  Quais servi√ßos armazenam dados importantes? </li><li>  Em que dados pessoais n√£o s√£o armazenados? </li><li>  Voc√™ tem centenas de bases.  Que dados pessoais existem?  E em que n√£o? </li><li>  Como os dados importantes fluem entre os servi√ßos? </li><li>  Por exemplo, o servi√ßo n√£o tinha dados pessoais, e ent√£o ele come√ßou a ouvir o √¥nibus, e eles apareceram.  Onde os dados s√£o copiados quando s√£o apagados? </li><li>  Quem pode trabalhar com quais dados? </li><li>  Quem pode acessar diretamente pelo servi√ßo, alguns pelo banco de dados, outros pelo barramento? </li><li>  Quem atrav√©s de outro servi√ßo pode puxar a al√ßa da API (solicita√ß√£o) e baixar alguma coisa? </li></ul><br><p>  A resposta para essas perguntas √© quase sempre um gr√°fico de elementos, um gr√°fico de relacionamentos.  Este gr√°fico precisa ser preenchido, atualizado e mantido com novos dados.  Decidimos chamar esse gr√°fico de Tecido Persistente (na tradu√ß√£o - lembrando o tecido).  Aqui est√° a visualiza√ß√£o dele. </p><br><p><img src="https://habrastorage.org/webt/9l/qx/fg/9lqxfghwxvo7qdyfpvbz5zyj1m0.png"></p><br><p>  Vamos ver o que pode haver nesse tecido de lembran√ßa. </p><br><p>  <strong>Pontos de interface</strong> .  Estes s√£o elementos de intera√ß√£o do usu√°rio com a interface gr√°fica.  Pode haver v√°rios pontos de interface do usu√°rio em uma p√°gina.  Essas s√£o a√ß√µes-chave personalizadas, relativamente falando. </p><br><p>  <strong>Pontos finais</strong> .  A interface do usu√°rio aponta empurr√µes Endpoints.  Na tradi√ß√£o russa, isso √© chamado de canetas.  Al√ßas de servi√ßos.  Os terminais extraem servi√ßos. </p><br><p>  <strong>Servi√ßos</strong>  Centenas de servi√ßos.  Os servi√ßos est√£o conectados um ao outro.  Entendemos qual servi√ßo pode obter o servi√ßo.  Entendemos que chamada para pontos de interface do usu√°rio pode chamar quais servi√ßos na cadeia. </p><br><p>  <strong>Bases (em um sentido l√≥gico)</strong> .  A base como termo de armazenamento parece ruim, porque esse termo se refere a algo anal√≠tico.  Agora, consideramos o banco de dados como armazenamento.  Por exemplo, Redis, PostgreSQL, Tarantool.  Se um servi√ßo usa um banco de dados, geralmente usa v√°rios bancos de dados. </p><br><ul><li>  Para armazenamento de dados a longo prazo, por exemplo, PostgreSQL. </li><li>  Redis √© usado como um cache. </li><li>  Tarantool, que pode calcular rapidamente algo no fluxo de dados. </li></ul><br><p>  <strong>Anfitri√µes</strong>  O banco de dados possui uma implanta√ß√£o para hosts.  Uma base, um Redis pode realmente viver em 16 m√°quinas (anel principal) e outro 16 escravo ao vivo.  Isso fornece uma compreens√£o de quais servidores voc√™ precisa restringir o acesso para que alguns dados importantes n√£o vazem. </p><br><p>  <strong>Entidades</strong> .  As entidades s√£o armazenadas nos bancos de dados.  Exemplos de entidades: usu√°rio, an√∫ncio, pagamento.  As entidades podem ser armazenadas em v√°rios bancos de dados.  E aqui √© importante n√£o apenas saber que essa entidade est√° l√°.  √â importante saber que esta entidade tem um armazenamento sendo a Fonte Dourada.  Fonte de Ouro √© a base onde uma entidade √© criada e editada.  Todas as outras bases s√£o caches funcionais.  Um ponto importante.  Se, Deus proibir, uma entidade tiver duas Fontes Douradas, ser√° necess√°ria uma laboriosa coordena√ß√£o das fontes separadas.  As entidades que est√£o no banco de dados devem ter acesso ao servi√ßo se quisermos enriquecer esse servi√ßo com novas funcionalidades. </p><br><p>  <strong>Equipes</strong> .  Equipes que possuem os servi√ßos.  Um servi√ßo que n√£o pertence √†s equipes √© um servi√ßo ruim.  √â dif√≠cil para ele encontrar algu√©m respons√°vel. </p><br><p>  Agora vou me correlacionar fortemente com o relat√≥rio de Vadim Madison, porque ele mencionou que a pessoa que foi a √∫ltima a cometer l√° se reflete nos servi√ßos.  Este √© um bom ponto de partida.  Mas a longo prazo, isso √© ruim, porque a pessoa que cometeu por √∫ltimo l√° pode sair. </p><br><p>  Portanto, voc√™ precisa conhecer a equipe, as pessoas nelas e seu papel.  Temos um gr√°fico t√£o simples, onde em cada camada existem v√°rias centenas de elementos.  Voc√™ conhece um sistema onde tudo isso pode ser armazenado? </p><br><p>  O ponto chave.  Para que este Tecido Persistente seja utilizado, ele n√£o deve ser preenchido apenas uma vez.  Os servi√ßos s√£o criados, eles morrem, o armazenamento √© alocado, eles se movem pelos servidores, as equipes s√£o criadas, interrompidas e as pessoas mudam para outras equipes.  As entidades s√£o novas, adicionadas a novos servi√ßos, exclu√≠das.  Os terminais s√£o criados, registrados, as trajet√≥rias do usu√°rio do ponto de vista da GUI tamb√©m s√£o refeitas.  O mais importante n√£o √© que, em algum lugar, voc√™ precise armazen√°-lo tecnicamente.  O mais importante √© tornar todas as camadas de Tecido Persistente atualizadas.  Que √© atualizado. </p><br><p>  Proponho percorrer as camadas.  Ilustrarei como fazemos isso.  Vou mostrar como isso pode ser feito no n√≠vel de camadas individuais. </p><br><p><img src="https://habrastorage.org/webt/pw/yn/s1/pwyns16y-x0hlef3sbs3ue3ljry.png"></p><br><p>  Informa√ß√µes sobre a equipe podem ser obtidas na estrutura organizacional de 1C.  Aqui, quero ilustrar que o Persistent Fabric n√£o precisa preencher o gr√°fico gigante inteiro para preencher.  Cada camada precisa ser preenchida corretamente. </p><br><p><img src="https://habrastorage.org/webt/qp/xs/we/qpxswe2pdci_ztpaiogokjmdhdu.png"></p><br><p>  Informa√ß√µes sobre pessoas podem ser obtidas no LDAP.  Uma pessoa pode assumir pap√©is diferentes em equipes diferentes.  Isso √© absolutamente normal.  Agora criamos o sistema Avito People e, a partir dele, levamos o v√≠nculo das pessoas √†s equipes e seus pap√©is.  O mais importante √© que esses dados simples sigam para que pelo menos mantenham links para as extremidades dos links, para que os nomes das equipes correspondam √†s equipes da estrutura organizacional 1C. </p><br><p><img src="https://habrastorage.org/webt/am/zp/l1/amzpl1b-c9bxgfyraff5hszrh_8.png"></p><br><p>  <strong>Servi√ßos</strong>  Para o servi√ßo, voc√™ precisa obter o nome e a equipe que o possui.  A fonte √© descoberta de servi√ßo.  Este √© o sistema que Vadim Madison mencionou sob o nome Atlas.  Atlas √© um registro geral de servi√ßos. </p><br><p>  √â √∫til entender que quase todos esses sistemas, como o Atlas, armazenam informa√ß√µes sobre 95% dos servi√ßos.  5% dos servi√ßos nesses sistemas est√£o ausentes, porque  servi√ßos antigos criados sem registro no Atlas.  E quando voc√™ come√ßa a trabalhar com esse esquema, sente o que est√° perdendo. </p><br><p><img src="https://habrastorage.org/webt/1e/vc/mo/1evcmoycczxblnbdje8pb3jgbto.png"></p><br><p>  <strong>Armazenamentos</strong> s√£o reposit√≥rios gen√©ricos.  Pode ser PostgreSQL, MongoDB, Memcache, Vertica.  Temos v√°rias fontes para a descoberta de armazenamento.  Os bancos de dados NoSQL usam sua pr√≥pria metade do Atlas.  Para obter informa√ß√µes sobre bancos de dados PostgreSQL, a an√°lise yaml √© usada.  Mas eles querem tornar sua descoberta de armazenamento mais correta. </p><br><p><img src="https://habrastorage.org/webt/uk/kd/e_/ukkde_ys0c44uyk6wexiycnxlsw.png"></p><br><p>  Portanto, armazena e informa√ß√µes sobre o que o servi√ßo usa, bem ou possui (esses s√£o tipos diferentes) de armazenamento.  Veja, tudo o que descrevi √©, em princ√≠pio, bastante simples, pode ser preenchido at√© no Planilhas Google. </p><br><p>  O que pode ser feito com isso?  Vamos imaginar que este √© um gr√°fico.  Como trabalhar com o gr√°fico?  Adicione-o √† base do gr√°fico.  Por exemplo, no Neo4j.  Estes j√° s√£o exemplos de consultas reais e exemplos dos resultados dessas consultas. </p><br><p><img src="https://habrastorage.org/webt/-3/oi/df/-3oidf3lu-h4wxgov4-rwjqequq.png"></p><br><p>  O primeiro cen√°rio.  Precisamos emitir direitos para a base.  A base deve estar estritamente em servi√ßo.  Deve incluir apenas este servi√ßo e apenas membros da equipe propriet√°ria do servi√ßo.  Mas n√≥s vivemos no mundo real.  Muitas vezes, outras equipes acham √∫til ir para a base de outro servi√ßo.  Pergunta: a quem perguntar sobre a concess√£o de direitos?  O grande problema √© que centenas de bases compreendem quem est√° no comando.  Apesar de quem o criou, parou h√° muito tempo ou foi transferido para outro cargo, ou n√£o se lembra de quem trabalha com ele. </p><br><p>  E aqui est√° a consulta de gr√°fico mais simples (Neo4j).  Voc√™ precisa de acesso ao armazenamento.  Voc√™ vai do armazenamento para o servi√ßo que o possui.  V√° para a equipe propriet√°ria do servi√ßo.  Al√©m do servi√ßo, voc√™ descobrir√° quem √© essa equipe do TechLead.  No Avito, as equipes de produto t√™m um gerente t√©cnico e um gerente de produto que n√£o podem ajudar nas bases.  Somente metade da solicita√ß√£o √© realmente exibida no slide.  O acesso ao armazenamento n√£o √© uma opera√ß√£o at√¥mica.  Para acessar o armazenamento, voc√™ precisa acessar os servidores nos quais est√° instalado.  Esta √© uma tarefa separada bastante interessante. </p><br><p><img src="https://habrastorage.org/webt/jh/tr/mj/jhtrmjkc8podppfie6bfqe5eje8.png"></p><br><p>  Para resolv√™-lo, adicionamos uma nova entidade.  Esta √© uma instala√ß√£o.  Aqui est√° o problema terminol√≥gico.  H√° armazenamento, por exemplo, Redis base (redis: endere√ßo).  H√° um host - pode ser uma m√°quina f√≠sica, um cont√™iner lxc, kubernetes.  Instalando o armazenamento no host que chamamos de Inst√¢ncia. </p><br><p>  Pode ter quatro instala√ß√µes em tr√™s hosts, conforme mostrado no exemplo acima.  √â recomend√°vel que o armazenamento para produ√ß√£o seja instalado em m√°quinas f√≠sicas separadas para aumentar o desempenho.  Para um ambiente de desenvolvimento, tudo o que voc√™ precisa fazer √© instalar em um host e atribuir portas diferentes ao Redis. </p><br><p><img src="https://habrastorage.org/webt/t6/zl/pf/t6zlpfpuqnhzojgr9csffdljnji.png"></p><br><p>  O primeiro pedido de emiss√£o de direitos √† base foi direto ao ponto.  O chefe confirmou que os direitos podem ser concedidos. </p><br><p>  Em seguida, vem a segunda parte da solicita√ß√£o.  A segunda solicita√ß√£o de armazenamento vai para a inst√¢ncia e o host.  Esta solicita√ß√£o considera todas as instala√ß√µes para o ambiente correspondente.  No slide, h√° um exemplo para um ambiente de produ√ß√£o.  Com base nisso, os direitos de conex√£o com hosts e portas espec√≠ficos j√° foram emitidos.  Este foi um exemplo de uma solicita√ß√£o de concess√£o para um funcion√°rio que n√£o faz parte da equipe. </p><br><p><img src="https://habrastorage.org/webt/dz/aq/hk/dzaqhkkreobrnhfdyivpq078vha.png"></p><br><p>  Considere um exemplo em que uma equipe precisa contratar um novo funcion√°rio.  Ele precisa ter acesso concedido (para iniciantes - somente leitura) a todos os servi√ßos, a todo armazenamento deste comando.  No slide, a equipe real com uma sele√ß√£o incompleta.  C√≠rculos verdes s√£o l√≠deres de equipe.  C√≠rculos cor de rosa s√£o equipes.  Amarelo s√£o servi√ßos.  V√°rios servi√ßos amarelos possuem armazenamento azul.  Os cinza s√£o anfitri√µes.  Violeta √© a instala√ß√£o do armazenamento nos hosts.  Este √© um exemplo para uma unidade pequena.  Mas existem muitas unidades cujos servi√ßos n√£o s√£o 7, mas 27. Para essas unidades, a imagem ser√° grande.  Se voc√™ usar o Persistent Fabric, poder√° fazer solicita√ß√µes e obter respostas em uma lista. </p><br><p><img src="https://habrastorage.org/webt/40/-v/tv/40-vtvltatfneyrxw7qhfbw10cs.png"></p><br><p>  Vamos continuar preenchendo nosso tecido inteligente e falar sobre entidades comerciais.  As entidades no Avito s√£o an√∫ncios, usu√°rios, pagamentos e assim por diante.  Nas minhas publica√ß√µes ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HP Vertica, projetando um data warehouse, big data</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vertica + Anchor Modeling = comece a cultivar seu cogumelo</a> ) sobre data warehouses, voc√™ sabe que existem centenas dessas entidades no Avito.  De fato, todos eles n√£o precisam ser registrados.  De onde posso obter uma lista de entidades?  Do reposit√≥rio anal√≠tico.  Voc√™ pode enviar informa√ß√µes sobre de onde elas obt√™m essa entidade.  No primeiro est√°gio, isso √© suficiente. </p><br><p>  Al√©m disso, desenvolvemos esse conhecimento: para cada entidade, fazemos uma lista de reposit√≥rios onde est√°.  Tamb√©m indicamos que o armazenamento armazena a entidade como um cache ou o armazenamento a entidade como Fonte de Ouro, ou seja, √© sua fonte principal. </p><br><p><img src="https://habrastorage.org/webt/ly/z-/et/lyz-etcdkr_wuqrgxnuwwar6aec.png"></p><br><p>  Ao preencher esta coluna, voc√™ tem a oportunidade de fazer solicita√ß√µes.  Voc√™ tem alguma entidade e precisa entender: em quais servi√ßos a entidade vive, onde reflete, em que armazenamento, em quais hosts est√° instalado?  Por exemplo, ao processar dados pessoais, voc√™ precisa destruir os arquivos de log.  Para fazer isso, √© muito importante entender em quais m√°quinas f√≠sicas os arquivos de log podem permanecer. </p><br><p><img src="https://habrastorage.org/webt/je/fm/ge/jefmgeljgwsrg5oqjckgqyfht8c.png"></p><br><p>  O slide ilustra uma consulta simples para uma entidade imagin√°ria.  A quantidade de armazenamento √© reduzida para que o gr√°fico caiba no slide.  C√≠rculos vermelhos s√£o entidades.  C√≠rculos azuis s√£o as bases onde esta entidade est√° localizada.  O restante √© como nos slides anteriores: c√≠rculos cinzentos s√£o hosts, c√≠rculos roxos s√£o instala√ß√µes de armazenamento nos hosts. </p><br><p>  Portanto, se voc√™ deseja passar pelo PCI DSS, precisa restringir o acesso a determinadas entidades.  Para fazer isso, voc√™ precisa restringir o acesso aos c√≠rculos cinzas.  Se voc√™ precisar de acesso em tempo real, fechamos o acesso aos c√≠rculos roxos.  Esta √© uma informa√ß√£o est√°tica. </p><br><p><img src="https://habrastorage.org/webt/_w/dy/tx/_wdytxhtuarcxx4v_elq4eckhpo.png"></p><br><p>  Quando falamos sobre arquitetura de microsservi√ßo, o mais importante √© que ela muda.  √â importante ter n√£o apenas um relacionamento hier√°rquico entre entidades, mas tamb√©m relacionamentos entre irm√£os.  Um monte de servi√ßos √© um exemplo de conex√µes de n√≠vel √∫nico, que foram bem-sucedidas e usadas.  Um pacote configur√°vel do formul√°rio "servi√ßo chama servi√ßo".  H√° informa√ß√µes sobre chamadas diretas - o servi√ßo chama a API de outro servi√ßo. </p><br><p>  Tamb√©m deve haver informa√ß√µes sobre a conex√£o do formul√°rio: o servi√ßo n¬∫ 1 envia eventos para o barramento (fila) e o servi√ßo n¬∫ 2 √© inscrito neste evento.  √â como uma conex√£o lenta ass√≠ncrona passando por um barramento.  Esse relacionamento tamb√©m √© importante em termos de movimenta√ß√£o de dados.  Usando esses links, voc√™ pode verificar a opera√ß√£o dos servi√ßos se a vers√£o do servi√ßo ao qual eles est√£o inscritos foi alterada. </p><br><p><img src="https://habrastorage.org/webt/bx/wu/fe/bxwufe8rh4oqpya2apdmwjs6y7k.png"><br><img src="https://habrastorage.org/webt/o9/6b/zh/o96bzhtcwcpe6le99c5-j80xgk4.png"></p><br><p>  Existe uma entidade e sabemos que ela √© armazenada em determinado armazenamento.  Se considerarmos o problema de encontrar pontos de uso da entidade, a consulta √≥bvia que surge conosco √© a verifica√ß√£o do per√≠metro.  O armazenamento pertence a alguns servi√ßos.  Onde essa entidade pode vazar (ser copiada) do per√≠metro?  Pode vazar atrav√©s de chamadas de servi√ßo.  O servi√ßo contatou, recebeu e manteve o usu√°rio.  Pode vazar pelos pneus.  Os pneus podem conectar voc√™ usando o RabbitMQ, Londiste.  No slide de Londiste, ainda n√£o o carregamos.  Mas as chamadas j√° est√£o carregadas. </p><br><p>  Aqui est√° um exemplo de uma solicita√ß√£o real: um an√∫ncio, dois bancos de dados onde ele est√° armazenado, dois servi√ßos que possuem esses bancos de dados.  Ap√≥s tr√™s colunas, existem servi√ßos que funcionam com servi√ßos que possuem essa entidade.  Esses s√£o pontos de vazamento em potencial que vale a pena acrescentar. </p><br><p><img src="https://habrastorage.org/webt/f1/cu/hg/f1cuhgk8m_6zltf4vaolu54z1jg.png"></p><br><p>  Pontos finais.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vadim mencionou</a> que voc√™ pode usar a documenta√ß√£o para criar um registro de servi√ßos de terminais.  Voc√™ tamb√©m pode obter essas informa√ß√µes do monitoramento.  Se o Endpoint for importante, os pr√≥prios desenvolvedores o adicionar√£o ao monitoramento.  Se o Endpoint n√£o for monitorado, n√£o ser√° necess√°rio. </p><br><p><img src="https://habrastorage.org/webt/sr/wu/pk/srwupkfwo41g8vdgo_i2-_oejum.png"></p><br><p>  Consequentemente, as m√©tricas podem ser obtidas no monitoramento.  Vinculando m√©tricas ao armazenamento, aos servi√ßos, aos hosts, √† inst√¢ncia (shards do banco de dados) e ponto final. </p><br><p><img src="https://habrastorage.org/webt/bu/sc/ec/buscec_nm5a9a5w3jy34_ke0u5y.png"></p><br><p>  Quando voc√™ encontra uma falha, por exemplo, o terminal emite um c√≥digo HTTP 500, para rastrear a raiz do problema, √© necess√°rio fazer uma solicita√ß√£o para esse terminal.  Do terminal, v√° para o servi√ßo, v√° para os servi√ßos que este servi√ßo chama, dos servi√ßos, v√° para o armazenamento, do armazenamento, v√° para a inst√¢ncia e os hosts. </p><br><p><img src="https://habrastorage.org/webt/m-/lx/hu/m-lxhubwizopmc8tevtkqaxexn4.png"></p><br><p>  Al√©m disso, se voc√™ observar este gr√°fico, poder√° obter uma lista de identificadores para monitoramento.  Voc√™ pode procurar por esse ponto final em toda a cadeia, o que pode causar uma falha.  Na arquitetura de microsservi√ßo, uma falha no n√≥ de extremidade pode ser causada por uma falha de rede em algum servidor no qual um fragmento de banco de dados √© implantado.  Isso pode ser visto no monitoramento, mas com uma grande estrutura de servi√ßo, √© muito trabalhoso verificar todos os servi√ßos no monitoramento. </p><br><p><img src="https://habrastorage.org/webt/ti/qe/bx/tiqebxhp2cezstldxdblhhfj0ik.png"></p><br><p>  Teste.  Para testar adequadamente um microsservi√ßo, voc√™ precisa verificar o servi√ßo com outros servi√ßos nos quais ele precisa funcionar.        ,   .       .       .       ,   .          . </p><br><p>        ,    ,    ,      production.   ,             .  ‚Äî  ,          ,                    . </p><br><p>          ,    .       ,   .     .          . </p><br><p><img src="https://habrastorage.org/webt/9c/vw/o0/9cvwo0htj3q_rzayek1uqdmoivo.png"></p><br><p>   ‚Äî  ,      .        . </p><br><ul><li>        .          .      .         .     storage.   ‚Äî .   endpoint.     ,    ,      ..      . </li><li>          .       ¬´¬ª  .  , ,   ,  connection,  connection ,    .     ,            . (    ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Anchor Modeling</a> ).           .     ¬´ ¬ª.           .      Neo4j,     . </li><li>     ,           .        . , UI points  frontend ,   backend , storage  DBA,   DevOps ,   . </li></ul><br><h1 id="zadachi-in-progress">  in-progress </h1><br><p>       . <br>           (Londiste, PGQ, RabbitMQ). </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m estamos tentando adicionar gr√°ficos de caminhos do usu√°rio. </font><font style="vertical-align: inherit;">Os pontos de interface do usu√°rio do gr√°fico de comunica√ß√£o s√£o formados nas informa√ß√µes sobre como os usu√°rios andam entre eles. </font><font style="vertical-align: inherit;">Agora isso √© feito no n√≠vel de log do cliente. </font><font style="vertical-align: inherit;">No momento, estamos migrando para combinar essas informa√ß√µes e encaminhar para um Fabric Persistent para que a experi√™ncia do usu√°rio possa ser traduzida em pontos da interface do usu√°rio, de l√° para o Endpoint e de l√° para os servi√ßos. </font><font style="vertical-align: inherit;">A partir dessas informa√ß√µes, para entender o que os usu√°rios costumam usar e descobrir, por exemplo, por que um servi√ßo pequeno, n√£o muito carregado e n√£o muito importante, afeta a experi√™ncia do usu√°rio.</font></font></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462937/">https://habr.com/ru/post/pt462937/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462919/index.html">Gerente de produto x gerente de projeto: como evitar confus√£o?</a></li>
<li><a href="../pt462923/index.html">Entrando no Aeronet Epis√≥dio 3: Encontrando a Bola</a></li>
<li><a href="../pt462929/index.html">Vejo voc√™: t√°ticas de mascaramento de morcegos</a></li>
<li><a href="../pt462933/index.html">Como funciona o bloqueio da Internet: uma revis√£o dos m√©todos modernos com um exemplo real</a></li>
<li><a href="../pt462935/index.html">Como manter o foco enquanto trabalha em um escrit√≥rio de plano aberto?</a></li>
<li><a href="../pt462939/index.html">Os 10 principais relat√≥rios C ++ da R√∫ssia e a lista de reprodu√ß√£o da confer√™ncia de acesso aberto</a></li>
<li><a href="../pt462943/index.html">Ca√ßa aos Wumpus ou experimente escrever um jogo cl√°ssico do Android</a></li>
<li><a href="../pt462945/index.html">Gere senhas √∫nicas para 2FA em JS usando a API Web Crypto</a></li>
<li><a href="../pt462947/index.html">A hist√≥ria de como o PVS-Studio encontrou um erro na biblioteca usada em ... PVS-Studio</a></li>
<li><a href="../pt462949/index.html">A hist√≥ria de como o PVS-Studio encontrou um erro na biblioteca usada em ... PVS-Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>