<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯР┐я╕П ЁЯСйЁЯП┐тАНЁЯдЭтАНЁЯСйЁЯП╝ ЁЯС╢ЁЯП╛ рд╕реЗрдл - "рдШреБрдЯрдиреЗ рдкрд░" рд╕реЗ "рдЙрддреНрдкрд╛рджрди" рднрд╛рдЧ 2 рддрдХ ЁЯд▒ЁЯП╝ ЁЯд║ ЁЯСйЁЯП╝тАНЁЯПл</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(рдпрд╣рд╛рдВ рдкрд╣рд▓рд╛ рднрд╛рдЧ: https://habr.com/en/post/456446/ ) 
 CEPH 
 рдкрд░рд┐рдЪрдп 


 рдЪреВрдВрдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрдл рдХреЗ рдкреНрд░рдореБрдЦ рддрддреНрд╡реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ, рдФрд░ рдпрд╣ рд╣рдорд╛рд░реА рдХрдВрдкрдиреА рдореЗрдВ рдереЛрдбрд╝рд╛ рд╡рд┐рд╢...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╕реЗрдл - "рдШреБрдЯрдиреЗ рдкрд░" рд╕реЗ "рдЙрддреНрдкрд╛рджрди" рднрд╛рдЧ 2 рддрдХ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458390/"><p>  (рдпрд╣рд╛рдВ рдкрд╣рд▓рд╛ рднрд╛рдЧ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://habr.com/en/post/456446/</a> ) </p><br><h1 id="ceph">  CEPH </h1><br><h3 id="vvedenie">  рдкрд░рд┐рдЪрдп </h3><br><p>  рдЪреВрдВрдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрдл рдХреЗ рдкреНрд░рдореБрдЦ рддрддреНрд╡реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ, рдФрд░ рдпрд╣ рд╣рдорд╛рд░реА рдХрдВрдкрдиреА рдореЗрдВ рдереЛрдбрд╝рд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╣реИ, рд╣рдо рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рдмрддрд╛рдПрдВрдЧреЗред <br>  рдЗрд╕рдореЗрдВ рд╕рд┐рдл рдХрд╛ рдмрд╣реБрдд рд╣реА рдХрдо рд╡рд░реНрдгрди рд╣реЛрдЧрд╛, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдиреНрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ред  рдХреЗрд╡рд▓ рд╕рд┐рдл рд╕рд░реНрд╡рд░ рдФрд░ Proxmox рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬреЗрд╢рди рд╕рд░реНрд╡рд░ рдХреА рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </p><a name="habracut"></a><br><p>  рддреЛ: рдиреЗрдЯрд╡рд░реНрдХ рдЯреЛрдкреЛрд▓реЙрдЬреА рдХреЛ <strong>рд▓реАрдл-рд╕реНрдкрд╛рдЗрди рдХреЗ</strong> рд░реВрдк рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ <strong>ред</strong>  рдХреНрд▓рд╛рд╕рд┐рдХ рдереНрд░реА-рдЯрд┐рдпрд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдПрдХ рдРрд╕рд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ рдЬрд╣рд╛рдВ <strong>рдХреЛрд░</strong> (рдХреЛрд░ рд░рд╛рдЙрдЯрд░), <strong>рдПрдЧреНрд░реАрдЧреЗрд╢рди</strong> (рдПрдХрддреНрд░реАрдХрд░рдг рд░рд╛рдЙрдЯрд░) рд╣реИрдВ рдФрд░ рд╕реАрдзреЗ <strong>рдПрдХреНрд╕реЗрд╕</strong> рдХреНрд▓рд╛рдЗрдВрдЯ (рдПрдХреНрд╕реЗрд╕ рд░рд╛рдЙрдЯрд░) рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИ: </p><br><p>  <strong>рддреАрди рд╕реНрддрд░реАрдп рдпреЛрдЬрдирд╛</strong> </p><br><p><img src="https://habrastorage.org/webt/yf/e8/cm/yfe8cmp5qspkply3yniplpk53oo.jpeg"></p><br><p>  рд▓реАрдл-рд╕реНрдкрд╛рдЗрди рдЯреЛрдкреЛрд▓реЙрдЬреА рдореЗрдВ рджреЛ рд╕реНрддрд░ рд╣реЛрддреЗ рд╣реИрдВ: <strong>рд╕реНрдкрд╛рдЗрди</strong> (рдореЛрдЯреЗ рддреМрд░ рдкрд░ рдореБрдЦреНрдп рд░рд╛рдЙрдЯрд░ рдмреЛрд▓рддреЗ рд╣реИрдВ) рдФрд░ <strong>рд▓реАрдл</strong> (рд╢рд╛рдЦрд╛рдПрдВ)ред </p><br><p>  <strong>рджреЛ рд╕реНрддрд░реАрдп рдпреЛрдЬрдирд╛</strong> </p><br><p><img src="https://habrastorage.org/webt/dw/ka/qo/dwkaqo4_ru7urikqyvmv3mqe8ik.jpeg"></p><br><p>  рд╕рднреА рдЖрдВрддрд░рд┐рдХ рдФрд░ рдмрд╛рд╣рд░реА рд░реВрдЯрд┐рдВрдЧ рдмреАрдЬреАрдкреА рдкрд░ рдмрдирд╛рдИ рдЧрдИ рд╣реИред  рдореБрдЦреНрдп рдкреНрд░рдгрд╛рд▓реА рдЬреЛ рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓, рдШреЛрд╖рдгрд╛рдУрдВ рдФрд░ рдЕрдзрд┐рдХ рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><strong>рд╕рдВрдмрдВрдзрд┐рдд</strong></a> рд╣реИ, рд╡рд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><strong>XCloud рд╣реИред</strong></a> <br>  рдЪреИрдирд▓ рдЖрд░рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ (рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рд▓рд┐рдП рднреА) рджреЛ L3 рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВ (рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рд░реНрд╡рд░ рд▓реАрдл рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдиреЗрдЯрд╡рд░реНрдХ рд▓реЛрдб рдХреЗ рд╕рд╛рде рдХреБрдЫ рд╕рд░реНрд╡рд░ рд╕реАрдзреЗ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕реНрдкрд╛рдЗрди рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВ), рдФрд░ рдмреАрдЬреАрдкреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдиреЗ рдпреВрдирд┐рдХрд╕реНрдЯ рдкрддреЗ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрдИ рд╕рд░реНрд╡рд░ рд╕реЗрд╡рд╛ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреА рд╕реЗрд╡рд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ ECMP рд╕рдВрддреБрд▓рди рдЙрдирдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдкрддрд╛ред  рдЗрд╕ рдпреЛрдЬрдирд╛ рдХреА рдПрдХ рдЕрд▓рдЧ рд╡рд┐рд╢реЗрд╖рддрд╛, рдЬрд┐рд╕рдиреЗ рд╣рдореЗрдВ рдкрддреЛрдВ рдкрд░ рдмрдЪрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА, рд▓реЗрдХрд┐рди рд╕рд╛рде рд╣реА рдЗрдВрдЬреАрдирд┐рдпрд░реЛрдВ рдХреЛ IPv6 рдХреА рджреБрдирд┐рдпрд╛ рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдерд╛, RFC 5549 рдкрд░ рдЖрдзрд╛рд░рд┐рдд BGP рдЕрдирд╛рд╡рд╢реНрдпрдХ рдорд╛рдирдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдерд╛ред рдХреБрдЫ рд╕рдордп рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдФрд░ рд╕рдордп-рд╕рдордп рдкрд░ BGP рдореЗрдВ рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП Quagga рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рджрд╛рд╡рддреЛрдВ рдФрд░ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХреЗ рдиреБрдХрд╕рд╛рди рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛рдПрдВ рдереАрдВред  рд▓реЗрдХрд┐рди FRRout рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж (рдЬрд┐рдирдХреЗ рд╕рдХреНрд░рд┐рдп рдпреЛрдЧрджрд╛рдирдХрд░реНрддрд╛ рд╣рдорд╛рд░реЗ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг рд╡рд┐рдХреНрд░реЗрддрд╛ рд╣реИрдВ: рдХреНрдпреВрдореНрдпрд▓рд╕ рдФрд░ XCloudNetworks), рд╣рдордиреЗ рдЗрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рдирд╣реАрдВ рджреЗрдЦрд╛ рд╣реИред </p><br><p>  рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕ рд╕рдВрдкреВрд░реНрдг рд╕рд╛рдорд╛рдиреНрдп рдпреЛрдЬрдирд╛ рдХреЛ "рдХрд╛рд░рдЦрд╛рдирд╛" рдХрд╣рддреЗ рд╣реИрдВред </p><br><h2 id="poisk-puti">  рд░рд╛рд╕реНрддрд╛ рдЦреЛрдЬреЛ </h2><br><p>  рдХреНрд▓рд╕реНрдЯрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рдХрд▓реНрдк: </p><br><p>  1) рдмреАрдЬреАрдкреА рдкрд░ рджреВрд╕рд░рд╛ рдиреЗрдЯрд╡рд░реНрдХ </p><br><p>  2) LACP рдХреЗ рд╕рд╛рде рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрдЯреИрдХреНрдб рд╕реНрд╡рд┐рдЪ рдкрд░ рджреВрд╕рд░рд╛ рдиреЗрдЯрд╡рд░реНрдХ </p><br><p>  3) рдУрдПрд╕рдкреАрдПрдл рдХреЗ рд╕рд╛рде рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреГрдердХ рд╕реНрд╡рд┐рдЪ рдкрд░ рджреВрд╕рд░рд╛ рдиреЗрдЯрд╡рд░реНрдХ </p><br><h3 id="testy">  рдкрд░реАрдХреНрд╖рдг </h3><br><p>  рдкрд░реАрдХреНрд╖рдг рджреЛ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдХрд┐рдП рдЧрдП: </p><br><p>  a) iperf, qperf, nuttcp рдЙрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдиреЗрдЯрд╡рд░реНрдХ </p><br><p>  b) рдЖрдВрддрд░рд┐рдХ рдкрд░реАрдХреНрд╖рдг рд╕рд┐рдл ceph-gobench, рд░рд╛рдбреЛрд╕ рдмреЗрдВрдЪ, rbd рдмрдирд╛рдпрд╛ рдФрд░ рдЙрди рдкрд░ рдПрдХ рдпрд╛ рдХрдИ рдереНрд░реЗрдбреНрд╕ рдореЗрдВ dd рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛, fio рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ </p><br><p>  рд╕рднреА рдкрд░реАрдХреНрд╖рдг рдПрд╕рдПрдПрд╕ рдбрд┐рд╕реНрдХ рдХреЗ рд╕рд╛рде рдкрд░реАрдХреНрд╖рдг рдорд╢реАрдиреЛрдВ рдкрд░ рдХрд┐рдП рдЧрдП рдереЗред  рдЖрд░рдмреАрдбреА рдкреНрд░рджрд░реНрд╢рди рдореЗрдВ рдЖрдВрдХрдбрд╝реЗ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдирд╣реАрдВ рджреЗрдЦреЗ рдЧрдП рдереЗ, рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓ рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдХрдиреЗрдХреНрд╢рди рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдореЗрдВ рд░реБрдЪрд┐ред </p><br><h3 id="pervyy-variant">  рдкрд╣рд▓рд╛ рд╡рд┐рдХрд▓реНрдк </h3><br><p>  <strong>рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░реНрдб рдХрд╛рд░рдЦрд╛рдиреЗ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реИрдВ, рдмреАрдЬреАрдкреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╣реИрдВред</strong> </p><br><p>  рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рдорд╛рдирд╛ рдЧрдпрд╛ рдерд╛: </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд┐рд▓рдВрдмрддрд╛ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрд╡рд┐рдЪ рдХреЗ рд░реВрдк рдореЗрдВ рдордзреНрдпрд╡рд░реНрддреА рддрддреНрд╡реЛрдВ рдХреА рдЕрдзрд┐рдХ рд╕рдВрдЦреНрдпрд╛ (рдпрд╣ рдореБрдЦреНрдп рдХрд╛рд░рдг рдерд╛)ред <br>  рджреВрд╕рд░реЗ, рд╢реБрд░реВ рдореЗрдВ, рдПрд╕ 3 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдЯреИрдЯрд┐рдХреНрд╕ рдХрд╛рд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЛрдВрдиреЗ рд░реЗрдбреЛрд╕рдЧреЗрдЯрд╡реЗ рдХреЗ рд╕рд╛рде рдХрдИ рдорд╢реАрдиреЛрдВ рдкрд░ рдЙрдард╛рдП рдЧрдП рдХрд┐рд╕реА рднреА рдПрдбреНрд░реЗрд╕ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ред  рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдерд╛ рдХрд┐ рдЖрд░рдЬреАрдбрдмреНрд▓реНрдпреВ рдХреЗ рд▓рд┐рдП рдлреНрд░рдВрдЯ-рдПрдВрдб рдорд╢реАрдиреЛрдВ рд╕реЗ рдпрд╛рддрд╛рдпрд╛рдд рд╕рдорд╛рди рд░реВрдк рд╕реЗ рд╡рд┐рддрд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдорд╛рд░реНрдЧ рдХреЗ рд╕рд╛рде рдЧреБрдЬрд░рддрд╛ рд╣реИ - рдЕрд░реНрдерд╛рдд, рдлреНрд░рдВрдЯ-рдПрдВрдб рдирд┐рдЧреНрдиреЗрдХреНрд╕ рд╣рдореЗрд╢рд╛ рдЖрд░рдЬреАрдбрдмреНрд▓реНрдпреВ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рдиреЛрдб рдореЗрдВ рдмрджрд▓ рдЧрдпрд╛ рдЬреЛ рдХрд┐ рдЗрд╕рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд┐рдП рдЧрдП рдкрддреНрддреЗ рд╕реЗ рдЬреБрдбрд╝рд╛ рдерд╛ (рдпрд╣, рдЬрд╝рд╛рд╣рд┐рд░ рд╣реИ, рдерд╛) рдореБрдЦреНрдп рддрд░реНрдХ рдирд╣реАрдВ - рд╣рдордиреЗ рдмрд╛рдж рдореЗрдВ рд╕реНрдереИрддрд┐рдХ рд╡рд╛рдкрд╕ рд▓реМрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдкрддреЛрдВ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛)ред  рд▓реЗрдХрд┐рди рдкреНрд░рдпреЛрдЧ рдХреА рд╢реБрджреНрдзрддрд╛ рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЛрдВрдиреЗ рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рдХреА рдпреЛрдЬрдирд╛ рдкрд░ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред </p><br><p>  рд╣рдо рдкреВрд░реЗ рдмреИрдВрдбрд╡рд┐рдбреНрде рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдЪрд▓рд╛рдиреЗ рд╕реЗ рдбрд░рддреЗ рдереЗ, рдХреНрдпреЛрдВрдХрд┐ рдХрд╛рд░рдЦрд╛рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдареЗрд╕ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЕрдЧрд░ рд╣рдордиреЗ рдкрддреНрддреА рдФрд░ рд░реАрдврд╝ рдХреЗ рдмреАрдЪ рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдЗрд╕рд╕реЗ рдмрд┐рдХреНрд░реА рдореЗрдВ рдХреБрдЫ рдиреБрдХрд╕рд╛рди рд╣реЛрдЧрд╛ред <br>  рджрд░рдЕрд╕рд▓, рдЗрд╕ рддрд░рд╣ рдХреА рдпреЛрдЬрдирд╛ рдХреЛ рдЦрд╛рд░рд┐рдЬ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рдХрд╛рд░рдг рдерд╛ред <br>  рдЕрдиреНрдп рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХреЗ рд▓рд┐рдП 1, 10 рдФрд░ 100 рдзрд╛рд░рд╛рдУрдВ рдХреЗ рдмреАрдбрдмреНрд▓реНрдпреВ рд╕реАрдорд╛ рдХреЗ рд╕рд╛рде Iperf рдкрд░реАрдХреНрд╖рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br>  рдЯреЗрд╕реНрдЯ рдореЗрдВ рдирд┐рдореНрди рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рдИ рджрд┐рдП: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/0a5/257/66b/0a525766bf7e61ffc4ba1129db0d17fd.png"></p><br><p>  <strong>1</strong> рд╕реНрдЯреНрд░реАрдо рдореЗрдВ, рд▓рдЧрднрдЧ <strong>9.30 - 9.43 Gbits / sec</strong> (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, <strong>рд░рд┐рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди</strong> рдХреА рд╕рдВрдЦреНрдпрд╛ рджреГрдврд╝рддрд╛ рд╕реЗ <strong>39148</strong> рддрдХ <strong>рдмрдврд╝ рдЬрд╛рддреА рд╣реИ</strong> )ред  рдпрд╣ рдЖрдВрдХрдбрд╝рд╛ рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рдЕрдзрд┐рдХрддрдо рдХреЗ рдХрд░реАрдм рдирд┐рдХрд▓рд╛ рдпрд╣ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рджреЛрдиреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд░рд┐рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓рдЧрднрдЧ <strong>500-600 рд╣реИред</strong> <br>  рдкреНрд░рддрд┐ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ <strong>9.63 Gbits / sec</strong> рдХреА <strong>10</strong> рд╕реНрдЯреНрд░реАрдо, рдЬрдмрдХрд┐ <strong>рд░рд┐рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯреНрд╕</strong> рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝рдХрд░ <strong>17045 рдХреЗ</strong> рдФрд╕рдд рдкрд░ <strong>рдкрд╣реБрдВрдЪ рдЧрдИред</strong> <br>  <strong>100</strong> рдереНрд░реЗрдбреНрд╕ рдореЗрдВ, рдкрд░рд┐рдгрд╛рдо <strong>10 рдХреА</strong> рддреБрд▓рдирд╛ рдореЗрдВ рдЦрд░рд╛рдм рдерд╛, рдЬрдмрдХрд┐ рд░рд┐рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрдо рд╣реИ: рдФрд╕рдд рдореВрд▓реНрдп <strong>3354 рд╣реИ</strong> </p><br><h3 id="vtoroy-variant">  рджреВрд╕рд░рд╛ рд╡рд┐рдХрд▓реНрдк </h3><br><p>  <strong>LACP</strong> </p><br><p>  рджреЛ рдЬреБрдирд┐рдкрд░ EX4500 рд╕реНрд╡рд┐рдЪ рдереЗред  рдЙрдиреНрд╣реЛрдВрдиреЗ рдЙрдиреНрд╣реЗрдВ рд╕реНрдЯреИрдХ рдкрд░ рдПрдХрддреНрд░ рдХрд┐рдпрд╛, рдкрд╣рд▓реЗ рд▓рд┐рдВрдХ рдХреЗ рд╕рд╛рде рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреЛрдбрд╝рд╛, рджреВрд╕рд░реЗ рд╕реЗ рджреВрд╕рд░реЗ рдХреЛред <br>  рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕рдВрдмрдВрдз рд╕реЗрдЯрдЕрдк рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдерд╛: </p><br><pre><code class="plaintext hljs">root@ceph01-test:~# cat /etc/network/interfaces auto ens3f0 iface ens3f0 inet manual bond-master bond0 post-up /sbin/ethtool -G ens3f0 rx 8192 post-up /sbin/ethtool -G ens3f0 tx 8192 post-up /sbin/ethtool -L ens3f0 combined 32 post-up /sbin/ip link set ens3f0 txqueuelen 10000 mtu 9000 auto ens3f1 iface ens3f1 inet manual bond-master bond0 post-up /sbin/ethtool -G ens3f1 rx 8192 post-up /sbin/ethtool -G ens3f1 tx 8192 post-up /sbin/ethtool -L ens3f1 combined 32 post-up /sbin/ip link set ens3f1 txqueuelen 10000 mtu 9000 auto bond0 iface bond0 inet static address 10.10.10.1 netmask 255.255.255.0 slaves none bond_mode 802.3ad bond_miimon 100 bond_downdelay 200 bond_xmit_hash_policy 3 #(layer3+4 ) mtu 9000</code> </pre> <br><p>  Iperf рдФрд░ qperf рдкрд░реАрдХреНрд╖рдгреЛрдВ рдиреЗ Bw рдХреЛ <strong>16Gbits / sec</strong> рддрдХ рджрд┐рдЦрд╛рдпрд╛ <strong>ред</strong>  рд╣рдордиреЗ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдореЙрдб рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛: <br>  <strong>рдЖрд░рдЖрд░, рдмреИрд▓реЗрдВрд╕- xor рдФрд░ 802.3adред</strong>  рд╣рдордиреЗ рд╣реИрд╢рд┐рдВрдЧ <strong>рд▓реЗрдпрд░ 2 + 3 рдФрд░ рд▓реЗрдпрд░ 3 + 4</strong> рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХреА (рд╣реИрд╢ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рдкрд░ рд▓рд╛рдн рдкрд╛рдиреЗ рдХреА рдЙрдореНрдореАрдж)ред <br>  рд╣рдордиреЗ рдЪрд░ <strong>net.ipv4.fib_multipath_hash_policy рдХреЗ</strong> рдЕрд▓рдЧ-рдЕрд▓рдЧ sysctl рдорд╛рдиреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рддреБрд▓рдирд╛ рдХреА <strong>,</strong> (рдареАрдХ рд╣реИ, рд╣рдордиреЗ <strong>net.ipv4.tcp_congestion -control рдХреЗ</strong> рд╕рд╛рде рдереЛрдбрд╝рд╛ рд╕рд╛ рдЦреЗрд▓рд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рдХрд╛ <strong>рд╕рдВрдмрдВрдз</strong> рд╕реЗ рдХреЛрдИ рд▓реЗрдирд╛-рджреЗрдирд╛ рдирд╣реАрдВ рд╣реИред рдЗрд╕ рдЪрд░ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдП ValdikSS рдкрд░</a> рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдЪреНрдЫрд╛ рд▓реЗрдЦ рд╣реИ</a> ) </p><br><p>  рд▓реЗрдХрд┐рди рд╕рднреА рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ, рдпрд╣ <strong>18Gbits / sec</strong> рдХреА рд╕реАрдорд╛ рдХреЛ рдкрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдирд╣реАрдВ рдЖрдпрд╛ (рдпрд╣ рдЖрдВрдХрдбрд╝рд╛ <strong>рд╕рдВрддреБрд▓рди-рдПрдХреНрд╕реЛрд░ рдФрд░ 802.3ad</strong> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдкрд░реАрдХреНрд╖рдг рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдмреАрдЪ рдмрд╣реБрдд рдЕрдВрддрд░ рдирд╣реАрдВ рдерд╛) рдФрд░ рдпрд╣ рдорд╛рди "рдХреВрджрдиреЗ рдХреЗ рдмрд╛рдж" рдлрдЯрдиреЗ рдХреЗ рдмрд╛рдж рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред </p><br><h3 id="tretiy-variant">  рддреАрд╕рд░рд╛ рд╡рд┐рдХрд▓реНрдк </h3><br><p>  <strong>рдУрдПрд╕рдкреАрдПрдл</strong> </p><br><p>  рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрд▓рдПрд╕реАрдкреА рдХреЛ рд╕реНрд╡рд┐рдЪ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рд╕реНрдЯреИрдХрд┐рдВрдЧ рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛)ред  рдкреНрд░рддреНрдпреЗрдХ рд╕реНрд╡рд┐рдЪ рдкрд░, рдЙрдиреНрд╣реЛрдВрдиреЗ рдмрдВрджрд░рдЧрд╛рд╣реЛрдВ рдХреЗ рдПрдХ рд╕рдореВрд╣ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рд╡рд▓рд╛рди рдПрдХрддреНрд░ рдХрд┐рдпрд╛ (рднрд╡рд┐рд╖реНрдп рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрдВрдЦ рдХреЗ рд╕рд╛рде рдХрд┐ рдХреНрдпреВрдП рдФрд░ рдкреАрдЖрд░рдбреА рджреЛрдиреЛрдВ рд╕рд░реНрд╡рд░ рдПрдХ рд╣реА рд╕реНрд╡рд┐рдЪ рдореЗрдВ рдлрдВрд╕ рдЬрд╛рдПрдВрдЧреЗ)ред </p><br><p>  рдкреНрд░рддреНрдпреЗрдХ рд╡рд▓рд╛рди (рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкреНрд░рддрд┐ рд╕реНрд╡рд┐рдЪ) рдХреЗ рд▓рд┐рдП рджреЛ рдлреНрд▓реИрдЯ рдирд┐рдЬреА рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рдХрд┐рдпрд╛ред  рдЗрди рдкрддреЛрдВ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рддреАрд╕рд░реЗ рдирд┐рдЬреА рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдПрдХ рдФрд░ рдкрддреЗ рдХреА рдШреЛрд╖рдгрд╛ рд╣реИ, рдЬреЛ CEPH рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╕реНрдЯрд░ рдиреЗрдЯрд╡рд░реНрдХ рд╣реИред </p><br><p>  рдЪреВрдВрдХрд┐ <em>рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ</em> (рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдо рдПрд╕рдПрд╕рдПрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ) рдмреАрдЬреАрдкреА рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╣рдордиреЗ рдУрдПрд╕рдкреАрдПрдл рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдлрдЖрд░рдЖрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╣реИред </p><br><p>  <strong>10.10.10.0/24 рдФрд░ 20.20.20.0/24</strong> - рд╕реНрд╡рд┐рдЪ рдкрд░ рджреЛ рдлреНрд▓реИрдЯ рдиреЗрдЯрд╡рд░реНрдХ </p><br><p>  <strong>172.16.1.0/24</strong> - рдШреЛрд╖рдгрд╛ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ </p><br><p><img src="https://habrastorage.org/webt/t5/c5/fp/t5c5fpxxwqv7u82ywsvkuumcsag.jpeg"></p><br><p>  рдорд╢реАрди рд╕реЗрдЯрдЕрдк: <br>  рдЗрдВрдЯрд░рдлреЗрд╕ рдирд┐рдЬреА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рджрд┐рдЦрддреЗ рд╣реИрдВ <br>  рдкрдмреНрд▓рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЗрдВрдЯрд░рдлреЗрд╕ <strong>4f0 ens4f1</strong> рджрд┐рдЦрддреЗ рд╣реИрдВ </p><br><p>  рдорд╢реАрди рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрдиреНрдлрд┐рдЧ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="plaintext hljs">oot@ceph01-test:~# cat /etc/network/interfaces # This file describes the network interfaces available on your system # and how to activate them. For more information, see interfaces(5). source /etc/network/interfaces.d/* # The loopback network interface auto lo iface lo inet loopback auto ens1f0 iface ens1f0 inet static post-up /sbin/ethtool -G ens1f0 rx 8192 post-up /sbin/ethtool -G ens1f0 tx 8192 post-up /sbin/ethtool -L ens1f0 combined 32 post-up /sbin/ip link set ens1f0 txqueuelen 10000 mtu 9000 address 10.10.10.1/24 auto ens1f1 iface ens1f1 inet static post-up /sbin/ethtool -G ens1f1 rx 8192 post-up /sbin/ethtool -G ens1f1 tx 8192 post-up /sbin/ethtool -L ens1f1 combined 32 post-up /sbin/ip link set ens1f1 txqueuelen 10000 mtu 9000 address 20.20.20.1/24 auto ens4f0 iface ens4f0 inet manual post-up /sbin/ethtool -G ens4f0 rx 8192 post-up /sbin/ethtool -G ens4f0 tx 8192 post-up /sbin/ethtool -L ens4f0 combined 32 post-up /sbin/ip link set ens4f0 txqueuelen 10000 mtu 9000 auto ens4f1 iface ens4f1 inet manual post-up /sbin/ethtool -G ens4f1 rx 8192 post-up /sbin/ethtool -G ens4f1 tx 8192 post-up /sbin/ethtool -L ens4f1 combined 32 post-up /sbin/ip link set ens4f1 txqueuelen 10000 mtu 9000 #     loopback-: auto lo:0 iface lo:0 inet static address 55.66.77.88/32 dns-nameservers 55.66.77.88 auto lo:1 iface lo:1 inet static address 172.16.1.1/32</code> </pre> <br><p>  Frr config рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">root@ceph01-test:~# cat /etc/frr/frr.conf frr version 6.0 frr defaults traditional hostname ceph01-prod log file /var/log/frr/bgpd.log log timestamp precision 6 no ipv6 forwarding service integrated-vtysh-config username cumulus nopassword ! interface ens4f0 ipv6 nd ra-interval 10 ! interface ens4f1 ipv6 nd ra-interval 10 ! router bgp 65500 bgp router-id 55.66.77.88 # ,       timers bgp 10 30 neighbor ens4f0 interface remote-as 65001 neighbor ens4f0 bfd neighbor ens4f1 interface remote-as 65001 neighbor ens4f1 bfd ! address-family ipv4 unicast redistribute connected route-map redis-default exit-address-family ! router ospf ospf router-id 172.16.0.1 redistribute connected route-map ceph-loopbacks network 10.10.10.0/24 area 0.0.0.0 network 20.20.20.0/24 area 0.0.0.0 ! ip prefix-list ceph-loopbacks seq 10 permit 172.16.1.0/24 ge 32 ip prefix-list default-out seq 5 permit 0.0.0.0/0 ge 32 ! route-map ceph-loopbacks permit 10 match ip address prefix-list ceph-loopbacks ! route-map redis-default permit 10 match ip address prefix-list default-out ! line vty !</code> </pre> <br><p>  рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкрд░, рдиреЗрдЯрд╡рд░реНрдХ рдкрд░реАрдХреНрд╖рдг iperf, qperf, рдЖрджрд┐ред  рджреЛрдиреЛрдВ рдЪреИрдирд▓реЛрдВ рдХрд╛ рдЕрдзрд┐рдХрддрдо рдЙрдкрдпреЛрдЧ <strong>19.8 Gbit / sec рдореЗрдВ</strong> рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ <strong>,</strong> рдЬрдмрдХрд┐ рд╡рд┐рд▓рдВрдмрддрд╛ <strong>20us рддрдХ</strong> рдЧрд┐рд░ рдЧрдИ </p><br><p>  <em><strong>рдмреАрдЬреАрдкреА рд░рд╛рдЙрдЯрд░-рдЖрдИрдбреА</strong> рдлрд╝реАрд▓реНрдб <strong>:</strong> рд░реВрдЯрд┐рдВрдЧ рдЬрд╛рдирдХрд╛рд░реА рдФрд░ рдмрд┐рд▓реНрдбрд┐рдВрдЧ рдорд╛рд░реНрдЧреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╕рдордп рдиреЛрдб рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</em>  <em>рдпрджрд┐ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рд╣реИ, рддреЛ рд╣реЛрд╕реНрдЯ рдЖрдИрдкреА рдкрддреЗ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</em>  <em>рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдирд┐рд░реНрдорд╛рддрд╛рдУрдВ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдлрдЖрд░рдЖрд░ рдиреЗ рд╕рдмрд╕реЗ рдмрдбрд╝реЗ рд▓реВрдкрдмреИрдХ рдЖрдИрдкреА рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред</em>  <em>рдЗрд╕рд╕реЗ рджреЛ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реБрдИрдВ:</em> <em><br></em>  <em>1) рдпрджрд┐ рд╣рдордиреЗ рд╡рд░реНрддрдорд╛рди рдкрддреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдПрдХ рдФрд░ рдкрддрд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдиреЗрдЯрд╡рд░реНрдХ 172.16.0.0 рд╕реЗ рдирд┐рдЬреА) рдХреЛ рд▓рдЯрдХрд╛ рджреЗрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рддреЛ рдЗрд╕рд╕реЗ <strong>рд░рд╛рдЙрдЯрд░-рдЖрдИрдбреА</strong> рдореЗрдВ рдмрджрд▓рд╛рд╡ рд╣реБрдЖ рдФрд░, рддрджрдиреБрд╕рд╛рд░, рд╡рд░реНрддрдорд╛рди рд╕рддреНрд░реЛрдВ рдХреЛ рдкреБрди: рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред</em>  <em>рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХрд╛ рдХрдо рд╡рд┐рд░рд╛рдо рдФрд░ рдиреБрдХрд╕рд╛рдиред</em> <em><br></em>  <em>2) рдпрджрд┐ рд╣рдордиреЗ рдХрдИ рдорд╢реАрдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдЭрд╛ рдХрд┐рдП рдЧрдП рдХрд┐рд╕реА рднреА рдПрдбреНрд░реЗрд╕ рдХреЛ рд▓рдЯрдХрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдФрд░ рдЗрд╕реЗ <strong>рд░рд╛рдЙрдЯрд░-рдЖрдИрдбреА рдХреЗ</strong> рд░реВрдк рдореЗрдВ рдЪреБрдирд╛ рдЧрдпрд╛, рддреЛ рдПрдХ рд╣реА <strong>рд░рд╛рдЙрдЯрд░-рдЖрдИрдбреА рдХреЗ</strong> рд╕рд╛рде рджреЛ рдиреЛрдбреНрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рджрд┐рдЦрд╛рдИ рджрд┐рдП <strong>ред</strong></em> </p><br><h2 id="chast-2">  рднрд╛рдЧ реи </h2><br><p>  рдХреНрдпреВрдП рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХреЗ рдмрд╛рдж, рд╣рдордиреЗ рдореБрдХрд╛рдмрд▓рд╛ рд╕реЗрдл рдХреЛ рдЕрдкрдЧреНрд░реЗрдб рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд┐рдпрд╛ред </p><br><h3 id="network">  рдиреЗрдЯрд╡рд░реНрдХ </h3><br><h3 id="pereezd-s-odnoy-seti-na-dve">  рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рджреЛ рдХреА рдУрд░ рдмрдврд╝рдирд╛ </h3><br><p>  рдХреНрд▓рд╕реНрдЯрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЙрди рд▓реЛрдЧреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ рдЬреЛ рдУрдПрд╕рдбреА рдХреЛ <strong>ceph osd рдХреЗ</strong> рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдордХреНрдЦреА рдкрд░ рдирд╣реАрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ <strong>ред * Injectargsред</strong>  рдЗрд╕реЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдореЗрдВ рдмрджрд▓рдирд╛ рдФрд░ рдкреВрд░реЗ рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рдПрдХ рд╕рд╣рдиреАрдп рд╕рдорд╛рдзрд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдЫреЛрдЯрд╛ рдбрд╛рдЙрдирдЯрд╛рдЗрдо рднреА рдирд╣реАрдВ рдЪрд╛рд╣рддрд╛ рдерд╛ред  рдирдП рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдУрдПрд╕рдбреА рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ - рдХреБрдЫ рдмрд┐рдВрджреБ рдкрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкреБрд░рд╛рдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рджреЛ рдЖрдзреЗ-рдкреБрд░рд╛рдиреЗ рдХреНрд▓рд╕реНрдЯрд░ рд╣реЛрдВрдЧреЗ - рдирдП рдкрд░ рдирдП рдУрдПрд╕рдбреАред  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдХреНрд▓рд╕реНрдЯрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ (рд╕рд╛рде рд╣реА public_network, рд╡реИрд╕реЗ) рдПрдХ рд╕реВрдЪреА рд╣реИ, рдЕрд░реНрдерд╛рдд, рдЖрдк рдХрдИ рдорд╛рди рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдордиреЗ рдзреАрд░реЗ-рдзреАрд░реЗ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ - рдкрд╣рд▓реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдПрдХ рдирдпрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЬреЛрдбрд╝реЗрдВ, рдлрд┐рд░ рдкреБрд░рд╛рдиреЗ рдХреЛ рд╣рдЯрд╛ рджреЗрдВред  рд╕реАрдПрдлрдПрдЪ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рд╕реВрдЪреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдЬрд╛рддрд╛ рд╣реИ - рдУрдПрд╕рдбреА рдкрд╣рд▓реЗ рд╕реВрдЪреАрдмрджреНрдз рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдореБрд╢реНрдХрд┐рд▓ рдпрд╣ рдереА рдХрд┐ рдкрд╣рд▓рд╛ рдиреЗрдЯрд╡рд░реНрдХ bgp рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рдерд╛ рдФрд░ рдПрдХ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреБрдбрд╝рд╛ рдерд╛, рдФрд░ рджреВрд╕рд░рд╛ - рдУрд╕реНрдкрдл рдФрд░ рджреВрд╕рд░реЛрдВ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рдерд╛ рдЬреЛ рд╢рд╛рд░реАрд░рд┐рдХ рд░реВрдк рд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рдЬреБрдбрд╝реЗ рдирд╣реАрдВ рдереЗред  рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рдордп, рджреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдмреАрдЪ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рдерд╛ред  рд╣рдорд╛рд░реЗ рдХрд╛рд░рдЦрд╛рдиреЗ рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЦрд╝рд╛рд╕рд┐рдпрдд рдпрд╣ рдереА рдХрд┐ ACL рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдпрд╣ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд▓реЛрдЧреЛрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рд╣реИ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ "рдмрд╛рд╣рд░реА" рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП ACL рдХреЗрд╡рд▓ рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕реНрдкреЗрдВрд╕ рдкрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдирд╣реАрдВ рдкрд╣реБрдВрдЪрд╛ред рд▓реАрдХ рдкрд░)ред </p><br><p>  рд╕рдорд╛рдзрд╛рди рдПрдХ рдмреИрд╕рд╛рдЦреА, рдЬрдЯрд┐рд▓ рдерд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд╛рдо рдХрд┐рдпрд╛: рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП bgp рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдПрдХ рд╕рд╛рде ospf рдХреЗ рд╕рд╛рдеред </p><br><p>  рд╕рдВрдХреНрд░рдордг рдХреНрд░рдо рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИ: </p><br><p>  1) рджреЛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ ceph рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╕реНрдЯрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ: bgp рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдФрд░ ospf рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ <br>  Frr configs рдореЗрдВ рдХреБрдЫ рднреА рдмрджрд▓рдирд╛ рдЬрд░реВрд░реА рдирд╣реАрдВ рдерд╛, рдПрдХ рд▓рд╛рдЗрди </p><br><pre> <code class="plaintext hljs">ip prefix-list default-out seq 5 permit 0.0.0.0/0 ge 32</code> </pre> <br><p>  рдпрд╣ рд╣рдореЗрдВ рдШреЛрд╖рд┐рдд рдкрддреЛрдВ рдореЗрдВ рд╕реАрдорд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдкрддрд╛ рд╕реНрд╡рдпрдВ рд▓реВрдкрдмреИрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкрд░ рдЙрдард╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рд░рд╛рдЙрдЯрд░ рдкрд░ рдЗрд╕ рдкрддреЗ рдХреА рдШреЛрд╖рдгрд╛ рдХреЗ рд░рд┐рд╕реЗрдкреНрд╢рди рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдерд╛ред </p><br><p>  2) <strong>ceph.conf</strong> config рдореЗрдВ рдПрдХ рдирдпрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЬреЛрдбрд╝реЗрдВ </p><br><pre> <code class="plaintext hljs">cluster network = 172.16.1.0/24, 55.66.77.88/27</code> </pre> <br><p>  рдФрд░ рдУрдПрд╕рдбреА рдХреЛ рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ рдЬрдм рддрдХ рдХрд┐ рд╕рднреА <strong>172.16.1.0/24</strong> рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ <strong>рд╕реНрд╡рд┐рдЪ рди рдХрд░ рджреЗрдВред</strong> </p><br><pre> <code class="plaintext hljs">root@ceph01-prod:~#ceph osd set noout # -          OSD #     .  ,     #  , OSD      30 . root@ceph01-prod:~#for i in $(ps ax | grep osd | grep -v grep| awk '{ print $10}'); \ root@ceph01-prod:~# do systemctl restart ceph-osd@$i; sleep 30; done</code> </pre> <br><p>  3) рдлрд┐рд░ рд╣рдо рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ </p><br><pre> <code class="plaintext hljs">cluster network = 172.16.1.0/24</code> </pre> <br><p>  рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджреЛрд╣рд░рд╛рдПрдВред </p><br><p>  рдмрд╕ рдЗрддрдирд╛ рд╣реА, рд╣рдо рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ рдирдП рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЪрд▓реЗ рдЧрдПред </p><br><p>  рд╕рдВрджрд░реНрдн: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://shalaginov.com/2016/03/26/--leaf-spine/</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://www.xcloudnetworks.com/case-studies/innova-case-study/</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/rumanzo/ceph-gobench</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi458390/">https://habr.com/ru/post/hi458390/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi458376/index.html">рджреВрд╕рд░реА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд▓реИрдВрдЧреНрд╡реЗрдЬ рдирд╣реАрдВред рднрд╛рдЧ 1: рдбреЛрдореЗрди рд▓реЙрдЬрд┐рдХ</a></li>
<li><a href="../hi458378/index.html">рд╕рд╛рдЗрдЯ рд▓реЗрдЖрдЙрдЯ рдХреЗ рд▓рд┐рдП рдПрд╡реЛрдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред рд╢реБрд░реБрдЖрддреА рдХреЗ рд▓рд┐рдП рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред рдмреЛрдирд╕ - 30-рджрд┐рд╡рд╕реАрдп рдкрд░реАрдХреНрд╖рдг рдЕрд╡рдзрд┐ рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВ</a></li>
<li><a href="../hi458382/index.html">рд╣рдо рдпрд╣ рдХреНрдпреЛрдВ рд╕рд┐рдЦрд╛ рд░рд╣реЗ рд╣реИрдВ?</a></li>
<li><a href="../hi458384/index.html">рдПрдЪрдкреА 3 рдбреА рд╕реНрдЯреНрд░рдХреНрдЪрд░реНрдб рд▓рд╛рдЗрдЯ рд╕реНрдХреИрдирд░ рдкреНрд░реЛ рдПрд╕ 3 рд░рд┐рд╡реНрдпреВ рдФрд░ рдЯреЗрд╕реНрдЯ</a></li>
<li><a href="../hi458388/index.html">рджреАрдк (рд▓рд░реНрдирд┐рдВрдЧ + рд░реИрдВрдбрдо) рд╡рди рдФрд░ рд▓реЗрдЦ рдкрд╛рд░реНрд╕рд┐рдВрдЧ</a></li>
<li><a href="../hi458394/index.html">рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ LoRaWAN рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╡рд╛рдпрд░рд▓реЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛</a></li>
<li><a href="../hi458396/index.html">рдХреИрд╕реЗ рдореИрдВрдиреЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд░реЗрдВрдбрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде Vue.js рдкрд░ рд╡рд┐рдХрд╛рд╕ рдХрд┐рдпрд╛</a></li>
<li><a href="../hi458398/index.html">рджреВрд░рд╕реНрде рдХрд╛рд░реНрдп рдХреА рд╕реНрд╡рдЪреНрдЫрддрд╛ рдпрд╛ рдЯреЗрд▓реАрдкреИрдереА рдХреЗ рд▓рд╛рдн</a></li>
<li><a href="../hi458400/index.html">рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕реЗрдЬ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдПрдВрдб рдЗрдВрдкреНрд▓реАрдореЗрдВрдЯреЗрд╢рди рд╕реНрдЯреЗрдк-рдмрд╛рдп-рд╕реНрдЯреЗрдк рдкрд╛рд░реНрдЯ 1</a></li>
<li><a href="../hi458404/index.html">рдореЛрдиреЛрд▓рд┐рде рд╕реЗ рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕ рдореЗрдВ рд╕рдВрдХреНрд░рдордг: рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдЕрднреНрдпрд╛рд╕</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>