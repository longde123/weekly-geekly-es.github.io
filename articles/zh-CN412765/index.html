<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🍳 💍 🙍🏾 新的Unity磁贴卡系统简介 👨🏿‍🔧 🐬 🏴󠁧󠁢󠁳󠁣󠁴󠁿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="熟悉Unity 2D磁贴系统可为独立开发人员和游戏工作室节省大量时间来制作原型和创建高质量2D游戏，这是一个绝佳的机会。 

 如果没有此系统，您可能要花费数天（甚至数周）的时间来编写自己的磁贴卡系统或处理其他人的磁卡系统。 这只是编程，但是瓦片地图编辑器呢？ 

 新系统是免费的，直接内置在Uni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>新的Unity磁贴卡系统简介</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412765/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c94/67e/f7c/c9467ef7c3ac69be35fea0375965760d.png"></div><br> 熟悉Unity 2D磁贴系统可为独立开发人员和游戏工作室节省大量时间来制作原型和创建高质量2D游戏，这是一个绝佳的机会。 <br><br> 如果没有此系统，您可能要花费数天（甚至数周）的时间来编写自己的磁贴卡系统或处理其他人的磁卡系统。 这只是编程，但是瓦片地图编辑器呢？ <br><br> 新系统是免费的，直接内置在Unity编辑器中。 它提供了我们将在本教程中介绍的许多功能。 <br><br> 在本文中，我们将使用一个简单的tile 2D游戏来发现以下内容： <br><br><ul><li> 磁贴卡的工作方式。 </li><li> 如何在Unity中启用切片地图并自定义网格。 </li><li> 如何将精灵添加到项目中，将其转换为图块，然后将其添加到图块调色板。 </li><li> 如何使用图块编辑器工具创建关卡。 </li><li> 如何对图块进行排序并将它们放置在不同的图层中。 </li><li> 如何添加Unity物理图块。 </li><li> 如何为瓷砖动态着色。 </li><li> 如何使用本机代码和逻辑更改预制砖。 </li><li> 如何将自己的扩展名和平铺地图脚本添加到项目。 </li></ul><a name="habracut"></a><br> 是的，这个清单很棒。 但是请不要害怕-当我们开始理解时，您将很快了解这些工具的简单性。 <br><br><blockquote>  <em>注意：</em>本教程假定您擅长使用Unity编辑器。 如果您认为自己不熟悉它，那么<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Unity入门</a>教程将提供学习本教程所需的一切。 此外，您需要Unity版本2017.3或更高版本。 </blockquote><br><h2> 什么是瓷砖游戏？ </h2><br>  2D瓷砖游戏是其中关卡或游戏区域由许多小瓷砖（瓷砖）组成的小游戏，这些小瓷砖共同构成瓷砖网格。 有时，图块之间的差异可能很明显，有时，它们对于玩家来说似乎是牢固且无法区分的。 <br><br> 游戏中图块的集合称为图块集，每个图块通常是一个sprite，是spritesheet的一部分。 如果您想更好地处理Sprite表，那么我们有一个描述Unity Sprite表的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">教程</a> 。 <br><br> 如您在本教程中所见，平铺通常是正方形。 但是它们可以采用另一种形式-矩形，平行四边形或六边形。 在游戏中，通常使用俯视图或侧视图，但在平铺游戏中有时也使用2.5D。 <br><br> 也许您已经知道使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>磁</i></a>贴卡系统的两个最受欢迎的游戏： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>Starbound</i></a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><i>Terraria</i></a> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aac/428/8ee/aac4288ee7c7868202364a050a82e34a.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/650/d2d/db4/650d2ddb41661d2b4ae2b948fccee019.png"></div><br><h2> 开始工作 </h2><br> 下载本教程的项目<a href="">资料</a>并解压缩.zip文件。 <br><br> 启动Unity编辑器，并从解压缩的项目资料中加载<em>Rayzor-starter</em>项目。 <br><br> 这是您将在此项目中使用的东西： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2e3/ae3/784/2e3ae3784a7e0cda552c51902367eb8a.png"></div><br><ul><li>  Cinemachine / Gizmos：添加Unity Cinemachine仅是为了在播放器之后实现易于使用的摄像头。 </li><li> 调色板：在此文件夹中，我们将存储自己的瓦片调色板。 </li><li> 预制件：我们稍后在游戏中使用的一些预制件预制件。 </li><li> 场景：在这里我们将打开并保存场景。 </li><li> 脚本：一些简单的脚本可控制玩家的动作，陷阱陷阱和游戏中输赢的逻辑。 该文件夹还包含Unity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2D Extras Github存储库</a>中的Unity Tilemap脚本，我们将在以后使用。 </li><li>  Sfx：游戏的声音。 </li><li> 子画面：2D子画面，我们将根据它们创建图块调色板。 它们是从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一堆山洞和地牢中冒出来的，它们很像流氓</a> 。 该包的作者是kenney.nl。 </li></ul><br><h2> 游戏创作 </h2><br> 从“ <em>场景”</em>文件夹中打开“ <em>游戏</em> ” <em>场景</em> 。 <br><br> 在编辑器中单击“ <em>播放”</em>按钮以启动游戏。 在“ <em>游戏”</em>窗口中，使用WASD键或“箭头”移动英雄。 <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/20e/1a1/8a8/20e1a18a8e44d9eeef984cb19e43527e.gif"></div></div></div><br> 当英雄在颜色为00000的看似无止尽的相机背景中徘徊时，迷失在虚无之中。 <br><br> 要解决此问题，我们需要2D切片工具来构建有趣的关卡和游戏机制。 <br><br><h3> 了解瓷砖调色板 </h3><br> 在编辑器中，单击<em>窗口-&gt;拼贴面板</em>以打开2D拼贴面板窗口。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e9c/4c4/681/e9c4c46814518dadf262f42ceab70563.png"></div><br> 在Unity中从事平铺游戏时，此窗口将是您最好的朋友。 <br><br><ol><li> 这一系列的图标提供了用于操作图块，绘制和删除的基本工具 </li><li> 使用此选择器，您可以创建不同的调色板，这些调色板可以被视为绘制的调色板，在其中放置“颜色”，在本例中为“瓷砖”。 </li><li> 使用此选择器可以创建具有不同行为的画笔。 您可以添加自己的画笔，其行为与默认画笔不同（例如，绘制具有附加功能的预制瓷砖） </li></ol><br> 单击“ <em>创建新调色板”，</em>然后将其命名为<em>RoguelikeCave</em>调色板。 不要更改网格和单元格选项。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab3/a35/339/ab3a35339e71da7a385d6c778abd4f7d.png"></div><br> 单击<em>创建，</em>然后选择将新的调色板保存在项目的<em>Assets \ Palettes文件夹中</em> 。 在其中创建一个新的<em>RoguelikeCave</em>文件夹。 <br><br> 现在，您的项目的文件夹结构应如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/362/087/33a/36208733a60c0a788173c9cb199a1423.png"></div><br> 在“ <em>Tile调色板</em>编辑器”窗口中，应选择<em>RoguelikeCave</em> 。 目前，我们还没有任何图块： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f8/0f3/e89/9f80f3e894a6a3d64c3f9951b03046e5.png"></div><br> 没有材料的艺术家如何创作他的杰作？ <br><br> 在不关闭“ Tile Palette”窗口的情况下，选择“ <em>Sprites / roguelike-cave-pack”</em>项目文件夹并展开<em>roguelikeDungeon transparent.png</em>资产。 然后在此Sprite工作表中选择所有Sprite：选择第一个Sprite，按住shift键并选择最后一个Sprite。 <br><br> 将所有选定的精灵拖动到Tile Palette RoguelikeCave窗口中： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/055/d5b/aae/055d5baae6a8c222f66f0fec36824e05.gif"></div></div></div><br> 将这些精灵拖放到Tile Palette窗口中，然后选择在Unity中存储资产的位置。 <br><br> 在<em>Assets / Palettes / RoguelikeCave中</em>创建一个新的<em>Tiles</em>文件夹，然后选择此文件夹作为存储位置： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/16f/609/327/16f6093279a3a3b3c5c728ebdcd07afd.png"></div><br>  Unity将为从Sprite工作表添加的每个Sprite生成一个Tile资产。 等待该过程完成，然后增加“ Tile Palette”窗口的大小，并欣赏位于RoguelikeCave调色板中的美丽新瓷砖的偶数行： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27d/c87/f36/27dc87f368115a032b42d4b8058bdd1d.png"></div><br> 重复上述过程，使用“ <em>Tile Palette”</em>窗口创建一个瓷砖调色板，但是这次将新的<em>RoguelikeCustom</em>调色板命名。 <br><br> 将新调色板放置在新文件夹中。 将其命名为<em>RoguelikeCustom</em>文件夹，并将其移至项目的<em>Assets / Palettes文件夹</em> 。 <br><br> 这次，使用上述过程，使用<em>Assets / Sprites / roguelike-custom / roguelike-normal-cutdown-sheet.png工作表中的Sprite</em>填充新调色板的图块。 在<em>RoguelikeCustom</em>调色板文件夹内创建一个<em>Tiles</em>文件夹，然后在其中移动tile资源： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/402/c0d/fb6/402c0dfb6ca659f755ba63cafa6c288b.png"></div><br> 为自己高兴，现在您知道创建瓷砖调色板的魔力！ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/782/ed3/b0f/782ed3b0f5bc2546c2116c07f9652f7f.png"></div><br><h3> 平铺地图网格 </h3><br> 打开Unity编辑器顶部的<em>GameObject</em>菜单（如果使用的是MacOS，则打开Unity菜单栏），单击<em>2D Object</em> ，然后单击<em>Tilemap</em>创建新的Tilemap网格： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/259/99d/e4e/25999de4efb34557bac40669f988fcdd.png"></div><br> 您应该看到新的GameObject <em>Grid已</em>添加到场景层次中。 展开它，然后选择内置的<em>GameObject Tilemap</em> 。 <br><br> 将此<em>Tilemap</em>视为游戏中的一个图层（也许是其中的一个）。 您可以添加新对象来创建其他Tilemap图层。 <br><br> 在检查器中，您将看到Unity自动添加到此GameObject的两个组件： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1a0/f58/3fa/1a0f583faa33dfc44002dde103c8d97e.png"></div><br><ul><li> Unity引擎使用<code>Tilemap</code>组件将精灵存储在标有<code>Grid</code>组件的电路中-在我们的例子中是GameObject <em>Grid</em> 。 首次创建Tilemap时，您实际上不必担心Unity如何在所有这些组件之间进行通信的所有技术功能。 </li><li>  <code>Tilemap Renderer</code>指定将用于在Tilemap中渲染图块的材料。 它还允许您配置此Tilemap图层的排序属性。 </li></ul><br> 将<em>GameObject</em> <em>Tilemap</em>重命名为<em>BaseLayer</em> 。 <br><br><h3> 使用各种瓷砖调色板绘制工具 </h3><br> 在编辑器中切换到场景模式。 <br><br> 在不关闭“拼贴”调色板的情况下，选择“ RoguelikeCave”调色板，然后选择<em>画笔</em>工具（或按<em>B</em> ）。 选择一个砂砖，如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dcd/44c/cb4/dcd44ccb47904a96bcae52075ea37e3e.png"></div><br> 在“场景”窗口中，将光标移动到播放器旁边的网格。 沙瓦刷将卡在网格上。 <br><br> 按住鼠标左键，在播放器周围绘制一个矩形区域。 它将在Tilemap BaseLayer图层上绘制： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3c5/6d6/068/3c56d606885a624960d5ed83106893dd.gif"></div></div></div><br> 绘制大区域可能是一项单调的任务，因此有一种“ <em>实心框”（Filled Box）</em>画笔可用于绘制大区域。 在“拼贴面板”窗口中，单击<em>方形画笔图标</em> （或按<em>U</em> ）。 <br><br> 返回编辑器，并按住鼠标左键，将光标从左上角拖动到右下角，在播放器周围绘制更大的矩形： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85d/f5f/35c/85df5f35c7f37f325e814568d970553f.gif"></div></div></div><br> 尽管我们为游戏添加了一些颜色，但此沙地牢看起来很暗淡。 现在该添加一些细节了！ <br><br> 使用<em>GameObject-&gt; 2D对象-&gt; Tilemap</em>菜单选项创建一个新的Tilemap图层。 这次它将是层次结构中唯一创建的对象，因为我们已经有了合适的网格。 将此层重命名为<em>DungeonFloorDecoration</em> ： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/074/4a8/b33/0744a8b330652fe6f4ba7b3939d987ec.png"></div><br> 在“ Tile Palette”窗口中，将“ <em>Active Tilemap”</em>切换到“ <em>DungeonFloorDecoration”</em>层： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/272/dc3/87c/272dc387cdf5f84261eebf6da3dde2a9.png"></div><br> 选择<em>画笔</em>工具（ <em>B</em> ），然后在“场景”窗口中绘制散布在地图上的对象： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bbb/4dd/f6b/bbb4ddf6b3f5ba0393f5a6d3d04254eb.png"></div><br> 禁用然后重新启用<em>GameObject</em>层次结构中的<em>DungeonFloorDecoration</em> ，以查看活动Tilemap上的渲染如何更改DungeonFloorDecoration层，并且所有渲染的图块均位于此新层上： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fe3/416/3a0/fe34163a070ac1c85f8d0aee80356a90.gif"></div></div></div><br> 再次使用GameObject- <em>&gt; 2D Object-&gt; Tilemap选项</em>创建一个新的Tilemap图层。  <em>称它为可碰撞的</em> 。 将来，我们将用它来创建墙和边界。 <br><br> 将“ Tile Palette”窗口中的“ Active Tilemap”切换为“ <em>Collideable”</em> 。 选择画笔工具（ <em>B</em> ），然后绘制以下图块以在游戏区域周围建墙。 下图中以红色突出显示的区域是需要添加的新部分： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3f0/7e3/004/3f07e30041691b855a4d1870d69f2e34.png"></div><br> 查看“ Tile Palette”窗口下面的屏幕快照，以找出在哪里可以找到建造墙所需的瓷砖。 不要忘记，您可以使用CTRL-Z或CMD-Z组合来撤销操作或使用当前画笔擦除错误（按住<em>Shift的</em>同时）： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c94/67e/f7c/c9467ef7c3ac69be35fea0375965760d.png"></div><br> 在编辑器中启动游戏，然后尝试深入了解： <br><br><div class="spoiler">  <b class="spoiler_title">谁开启了noclip模式？</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/49d/6fb/e88/49d6fbe88e6368ae9d9d47caa6ed2ece.gif"></div></div></div><br> 你没想到吗？ <br><br> 问题在于，我们只是绘制了标准图块，还没有将魔术物理学Unity应用于图块地图图层。 <br><br> 选择<em>GameObject Collideable</em> ，然后单击“ <em>检查器”</em>窗口中的“ <em>添加组件”</em>按钮来<em>添加</em>新组件； 在搜索字段中，输入<em>Tilemap Collider 2D</em> ： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/15e/7ec/614/15e7ec614a110e3de5020f7b5f6a2d4d.png"></div><br> 该组件是专门为Unity 2D平铺游戏创建的。 它只是将物理碰撞器的形状应用于添加了它的图层中的所有图块，而无需执行任何其他工作。 <br><br> 再次开始游戏，并尝试穿墙。 拒绝访问！ <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b2/8f1/a3a/2b28f1a3a2f60422649719e084a9fd08.gif"></div></div></div><br><blockquote>  <em>注意：</em>有时在移动相机时，您可能会注意到一些瓷砖之间的黑色细线。 在2D Tilemap Unity系统的项目中，这似乎是照相机运动的问题。 通过在图形设置中禁用“抗锯齿”，您几乎可以完全摆脱它。 但是，即使在采购项目中完成了该操作，其效果仍然会稍微显着。 解决此问题的方法可能是添加您自己的具有像素偏移量的相机移动脚本。 关于这个问题的很好的讨论可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>找到。 </blockquote><br> 碰撞效果很好，您可能会认为足够了。 但是目前，对撞机还没有得到有效的优化。 在“场景”模式下，放大墙壁的一部分并查看对撞机的轮廓： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ea/3f8/af3/4ea3f8af32c2e23852a146578a7f9f49.png"></div><br> 每个磁贴周围都有一个对撞机。 中墙部分不需要这些额外的对撞机。 <br><br>  <em>选择GameObject Collideable之后</em> ，向其中添加<em>Composite Collider 2D</em>组件。 这还将自动添加RigidBody2D。 <br><br> 将BodyType RigidBody2D参数设置为<em>Static</em> ，然后在<em>Tilemap Collider 2D</em>组件中选中“ <em>由复合使用”</em>复选框： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ca/12b/9e0/2ca12b9e01baa5b477288bc06cf546cf.png"></div><br> 之后，您会注意到墙壁中间的这些不必要的方形对撞机消失了。 <br><br> 通过建造墙壁并在顶部封闭（约16瓦高）来完成墙的创建。 不要忘记。 应将“可碰撞对象”选择为“拼贴面板” <em>窗口</em>的“活动拼贴”： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e6/33f/81d/7e633f81d090fd304dcee26abb4cf760.png"></div><br> 对于没有障碍的英雄来说，地牢区将不会有任何困难。 现在，我们将开始创建死亡室，并辅之以美丽的古代大理石走廊。 克服所有这些障碍后，玩家将获得奖励-金山。 <br><br> 要绘制这些走廊，我们将使用特殊的图块画笔<em>Rule Tile</em> 。 如您在本教程开始时所看到的那样，来自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Unity 2D Extras</a> Github存储库的其他平铺脚本已被添加到项目中。 其中之一是Rule Tile。 <br><br> 规则图块允许我们根据所拥有的相邻图块来设置绘制哪些图块的规则。 <br><br> 右键单击项目的<em>Prefabs</em>文件夹，然后选择<em>创建-&gt;规则平铺</em> （此项目应在菜单顶部）。 命名新的<em>MarbleFloorRuleTile</em>元素： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/702/42b/66c/70242b66c05805fb9a147521da24aa89.png"></div><br> 选择此新的<em>MarbleFloorRuleTile</em>并使用检查器将<em>Default Sprite</em>设置为<code>roguelikeDungeon_transparent_335</code> 。 然后通过单击<em>+</em>图标添加新的切片规则。 为该规则的<em>Sprite</em>选择<code>roguelikeDungeon_transparent_339</code>的值，然后单击规则方案中的所有外部正方形，以便每个都有向外的绿色箭头： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/546/707/124/546707124181cac98c682dfadeb56491.gif"></div></div></div><br> 使用“瓷砖调色板”中的盒形填充画笔（ <em>B</em> ）工具并选择“ Tilemap <em>BaseLayer”</em> ，绘制大理石墙的笔直部分。 它必须覆盖地板的所有可用空间。 <br><br> 您会注意到，执行此操作时，该图层将使用碰撞器关闭墙砖，因为尚未设置图层的顺序。 可以通过选择<em>GameObject Collideable</em>并更改<em>Tilemap Renderer</em>组件的<em>Layer</em>中的<em>Order</em>到一个更高的值来轻松解决此问题（ <em>5</em>就足够了）： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/314/631/467/314631467ec638cad00a0082fae58113.gif"></div></div></div><br> 返回项目的<em>Prefabs</em>文件夹，打开Tile窗口并选择RoguelikeCave调色板，然后将<em>MarbleFloorRuleTile</em>拖动到调色板上的空白处： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/de3/c7b/15b/de3c7b15b5b9e8531b15824c196d480d.gif"></div></div></div><br> 使用盒子填充刷在房间的大理石地板上绘制一些部分： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/092/120/1ff/0921201ff5eb1be81f34bfebff121079.gif"></div></div></div><br> 请注意，自定义规则图块被所有角度和面完全包围，成为装饰图块（在“切片规则”编辑器中选择的子画面）。 <br><br><h3> 这是一个陷阱！ </h3><br> 不，我们不会将Admiral Akbar作为角色添加到游戏中。 我们将为陷阱的预制件创建一个瓷砖刷，用它来绘制用旋转刀片射击的陷阱！ <br><br> 在层次结构中创建一个新的空GameObject并将其命名为<em>ShootingTrap</em> 。 在ShootingTrap中创建一个空的GameObject子级。 将其命名为<em>Sprite</em> ： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/66e/754/55e/66e75455eda0bbdb02033ebc5cff618f.png"></div><br> 选择<em>Sprite，</em>然后向其中添加<em>Sprite Renderer</em>组件。 将“ <em>排序层”</em>设置为“ <em>播放器”</em> ，将<em>“层中</em>的<em>顺序”</em>设置为<em>1</em> ，以使其在其余层的顶部呈现。 选择<em>Sprite</em>字段，并将<em>roguelikeDungeon_transparent_180</em>设置为sprite。 <br><br> 现在在<em>Z</em>轴上将<em>Sprite</em>对象的Transform旋转<em>-90</em> ： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/540/666/ded/540666ded98bc99613b7dd5d6c7beeb7.png"></div><br> 接下来，返回GameObject <em>ShootingTrap</em>并使用检查器添加一个新组件。 在搜索字段中，找到“ <em>射击陷阱”</em>并附加此脚本。 <br><br> 该脚本将添加到您下载的项目文件中； 实际上，它每两秒钟启动corutin，在陷阱的当前位置创建一个旋转锯片（或任何其他预制件）的预制实例。 <br><br> 将Shooting Trap组件的<em>Item to Shoot Prefab</em>参数设置为<em>Projectile</em> （预制件位于<em>/ Assets / Prefabs中</em> ）： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a59/614/6dc/a596146dc4ec7d91eb3f17e9976f5945.png"></div><br> 在编辑器中再次启动游戏，并使用“场景”模式查找陷阱。 她工作！ <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ef0/771/5ae/ef07715aed64732a12386defeec1b1cb.gif"></div></div></div><br> 将<em>ShootingTrap</em>副本从层次结构<em>拖到</em>项目的<em>/ Assets / Prefabs文件夹中</em>以创建预制件。 从层次结构中删除ShootingTrap。 <br><br> 我们使用另一个名为<em>PrefabBrush的</em>平铺画笔脚本来创建可以在Tilemap图层上绘制预制件的画笔。 <br><br> 右键单击项目的<em>/ Assets / Prefabs文件夹，</em>然后选择<em>创建-&gt;预制画笔</em> 。 将对象命名为<em>PrefabBrush</em> 。 <br><br> 使用检查器将<em>Prefabs Size</em> PrefabBrush参数设置为<em>1</em> ，将<em>Element 0</em>参数设置为<em>ShootingTrap</em> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c84/58e/0df/c8458e0df00c239708a275d5c17fd25b.png"></div><br> 在<em>网格中</em>创建一个名为<em>Traps</em>的新Tilemap图层，然后打开Tile Palette窗口。 <br><br> 选择常规的瓷砖刷（ <em>B</em> ），然后使用“瓷砖调色板”窗口底部的下拉菜单选择<em>PrefabBrush</em> 。 选择“活动Tilemap <em>陷阱”</em>作为图层，然后使用“场景”窗口沿房间的左边界绘制几个预制陷阱。 <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce1/f3a/3b6/ce1f3a3b6fbea97b23f8a388404772e8.gif"></div></div></div><br> 在层次结构中展开GameObject <em>Traps</em> ，并使用检查器中的Shooting Trap脚本对每个Gameobject <em>ShootingTrap</em>上每个值的<em>Shoot Start Delay</em>值进行试验。 将每个陷阱的值加上0.25，即： <br><br><ul><li> 首次射击陷阱-&gt;射击开始延迟= 0.1 </li><li>  Second ShootingTrap-&gt;射击开始延迟= 0.35 </li><li> 第三次射击陷阱-&gt;射击开始延迟= 0.6 </li><li> 依此类推... </li></ul><br> 如果您敢，请启动游戏并通过测试。 <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/809/ea5/02b809ea5ea2b177b3da6d537a447794.gif"></div></div></div><br><h3> 最终目标 </h3><br> 这个迷你地牢的目标是获得一堆金子。 名利双收等待着那些到达它的人，避免致命的飞刃。 <br><br> 在GameObject <em>Grid中</em>创建一个名为<em>目标</em>的新Tilemap图层。 选择<em>目标，</em>然后将<em>Layer</em>中的<em>Tilemap Renderer Order</em>的值更改为<em>2</em> ： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ece/7bf/f1f/ece7bff1f2eec46dab6974ec9293d8e8.png"></div><br> 在不关闭“拼贴面板”窗口的情况下，确保仍选择PrefabBrush。 使<em>元素0</em>引用项目的<em>/ Assets / Prefabs文件夹中的</em> <em>目标</em> <em>预设</em> 。 <br><br> 这是一个带有大量金色精灵的预制件，其中Box Collider 2D启用了Is Trigger，添加了声源，并且提供了简单的<code>Goal.cs</code>脚本，该脚本可再现到达目标的声音并在玩家掉入触发区域时重新启动关卡。 <br><br> 使用标准瓷砖刷在陷阱后面的房间顶部绘制一个目标预制瓷砖： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee4/970/1c0/ee49701c003075b4bb2a048b6d2e8039.png"></div><br> 再次开始游戏，并尝试达到目标。 转到此图块时， <code>OnTriggerEnter2D()</code>逻辑<code>Goal.cs</code> ，再现声音效果并重新启动该级别。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2c1/736/d0e/2c1736d0e9eb131101cef9c7ee08a18d.png"></div><br><h3> 画龙点睛 </h3><br> 现在，地牢太轻又自由了。 我们可以通过切换到可以响应光线的2D精灵材质来为其添加样式。 <br><br> 选择Sprite Player，Goal和ShootingTrap对象，并使Sprite Renderer <em>材质</em>使用<em>SpriteLightingMaterial</em> ： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e8/7ce/36a/9e87ce36a51b69b514f71cf71992f4b5.png"></div><br> 这是带有<em>Sprite / Diffuse</em>着色器的材质。 它允许场景照明影响精灵。 <br><br> 在<em>GameObject</em> <em>网格中，</em>选择<em>BaseLayer，DungeonFloorDecoration，Collideable和Goal</em>对象，然后使用检查<em>器</em>在材质中<em>也</em>使用<em>Tilemap Renderer材质</em> <em>SpriteLightingMaterial</em> 。 <br><br> 然后在GameObject <em>Lights中</em>选择<em>Directional light</em> ，并将<em>Intensity</em> Light降低到<em>0.3</em> 。 <br><br> 好多了！ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6fe/cb2/4ed/6fecb24ed773ea4b843e2ee32d3be164.png"></div><br> 另外，您现在会注意到，玩家携带一个<em>点光源</em> ，即<em>灯笼</em>在他周围发光。 <br><br> 现在，场景中的精灵使用了正确的材质，Unity照明会影响所有周围的精灵。 <br><br> 从场景中项目的<em>/ Assets / Prefabs文件夹中</em>拖动FlickerLight <em>预制</em>件的两个副本，并将它们放置在GameObject <em>Lights中</em> 。 <br><br> 设置第一个预制位置<em>（X：-11.25，Y：4，Z：-1.35）</em> ，第二个- <em>（X：2.75，Y：4，Z：-1.35）</em> 。 <br><br> 创建一个名为<em>WallsAndObjects</em>的新Tilemap图层，并将“ <em>图层”</em>检查<em>器中</em>的<em>Tilemap Renderer Order</em>设置为<em>15</em> 。 请记住， <em>Material</em>也使用<em>SpriteLightingMaterial</em> 。 <br><br> 将瓷砖调色板画笔切换回<em>默认画笔</em> ，将<em>活动瓷砖映射切换</em>至<em>WallsAndObjects</em> 。 <br><br> 使用画笔（ <em>B</em> ）工具在我们放置在初始区域的各个角落的每个新FlickerLight下绘制两个“ light lamp”图块： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a8/2ae/b82/6a82aeb824326ec78184559b0986ef78.png"></div><br><h3> 困难时期 </h3><br> 让我们看看是否可以进一步改善地牢。 使用Tilemap <em>WallsAndObjects</em>图层，使用称为<em>RoguelikeCustom的</em>另一个瓷砖调色板在地牢房<em>顶部</em>创建书柜。 还要画一两部分开裂的墙。 <br><br> 返回Tilemap <em>DungeonFloorDecoration</em>图层，并在大理石地板上添加更多详细信息，例如，几个瓷砖上的裂缝： <br><br><div class="spoiler">  <b class="spoiler_title">GIF</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/611/5d7/f2a/6115d7f2a96969a47b9c262dd215623b.gif"></div></div></div><br> 恭喜，您已经完成了第一个迷你地牢级别！ 结果，您应该得到类似的内容： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f1b/190/063/f1b1900633e1a0fdad59453a238c5a17.png"></div><br><h2> 接下来要去哪里？ </h2><br> 如果您错过了某个步骤，则可以通过从可下载的<a href="">资料中</a>打开Unity <em>Rayzor-final</em>项目来查看本教程的最终结果。 <br><br> 在本教程中，我们学到了很多东西，但是与其他任何事情一样，总会有其他东西！ <br><br> 本教程未涵盖一些有趣的瓷砖刷脚本。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>阅读有关它们的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">信息，</a>并考虑是否可以使用它们。 <br><br> 您还可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>了解如何创建动画图块。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN412765/">https://habr.com/ru/post/zh-CN412765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN412753/index.html">通过寄存器上的LTDC ...启动STM32上的显示</a></li>
<li><a href="../zh-CN412755/index.html">电报发布了官方MTProto代理服务器</a></li>
<li><a href="../zh-CN412757/index.html">日本的LED灯泡</a></li>
<li><a href="../zh-CN412759/index.html">Telegram的新MTProto-proxy服务器</a></li>
<li><a href="../zh-CN412763/index.html">将Firefly-RK3288重装板与RockChip RK3288 SoC一起使用 Microchip Digital I2C热传感器-MCP9808</a></li>
<li><a href="../zh-CN412767/index.html">CMG Impact 2016会议回顾</a></li>
<li><a href="../zh-CN412769/index.html">我做了PWA，并将其放在三个应用程序商店中。 这是我发现的</a></li>
<li><a href="../zh-CN412773/index.html">明斯克宇航</a></li>
<li><a href="../zh-CN412775/index.html">个人经验：从低级C开发到Java编程</a></li>
<li><a href="../zh-CN412777/index.html">世界专栏建设的杰作：QUAD 11L-千分之二的最佳“货架”</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>