<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóûÔ∏è üßùüèº üë¥üèª Analysieren von Aufgaben aus der Hydra-Konferenz - Lastausgleich und In-Memory-Speicher ü¶ñ üêÇ üßúüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor einigen Tagen gab es eine Hydra-Konferenz . Die Jungs von der JUG.ru Group luden die Traumredner ein (Leslie Lampport! Cliff Click! Martin Kleppma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analysieren von Aufgaben aus der Hydra-Konferenz - Lastausgleich und In-Memory-Speicher</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skbkontur/blog/459958/"><p>  Vor einigen Tagen gab es eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hydra-Konferenz</a> .  Die Jungs von der JUG.ru Group luden die Traumredner ein (Leslie Lampport! Cliff Click! Martin Kleppmann!) Und widmeten sich zwei Tage lang verteilten Systemen und Computern.  Contour war einer der drei Konferenzpartner.  Wir sprachen am Stand, sprachen √ºber unsere verteilten Lagereinrichtungen, spielten Bingo und l√∂sten Probleme. </p><br><p>  Dies ist ein Beitrag mit einer Analyse der Aufgaben am Contour-Stand des Autors ihres Textes.  Wer auf Hydra war, ist Ihr Grund, sich an angenehme Eindr√ºcke zu erinnern, wer nicht - eine Chance, die <em>gro√üe O-</em> Note Ihres Gehirns zu dehnen. </p><br><p>  Es gab sogar Teilnehmer, die das Flipchart in Folien zerlegten, um ihre Entscheidung aufzuzeichnen.  Ich scherze nicht - sie haben dieses Papierpaket zur √úberpr√ºfung √ºbergeben: </p><br><p><img src="https://habrastorage.org/webt/6k/m8/59/6km859kxtxuu_21czx2sn-l5do0.jpeg"></p><br><p>  Insgesamt gab es drei Aufgaben: </p><br><ul><li>  √ºber die Auswahl von Replikaten f√ºr Gewichte f√ºr den Lastausgleich </li><li>  Informationen zum Sortieren der Ergebnisse einer Abfrage in eine In-Memory-Datenbank </li><li>  zur Zustands√ºbertragung in einem verteilten System mit einer Ringtopologie </li></ul><a name="habracut"></a><br><h1 id="zadacha-1-clusterclient">  Aufgabe 1. ClusterClient </h1><br><p>  Es war notwendig, einen Algorithmus f√ºr die effektive Auswahl von K aus N gewichteten Repliken eines verteilten Systems vorzuschlagen: </p><br><blockquote>  Ihr Team hat die Aufgabe, eine Clientbibliothek f√ºr einen massiv verteilten Cluster von N Knoten zu entwickeln.  Die Bibliothek w√ºrde verschiedene Metadaten verfolgen, die Knoten zugeordnet sind (z. B. ihre Latenzen, 4xx / 5xx-Antwortraten usw.) und ihnen Gleitkommagewichte W <sub>1</sub> ..W <sub>N</sub> zuweisen.  Um die Strategie der gleichzeitigen Ausf√ºhrung zu unterst√ºtzen, sollte die Bibliothek in der Lage sein, K von N Knoten zuf√§llig auszuw√§hlen - eine Chance, ausgew√§hlt zu werden, sollte proportional zum Gewicht eines Knotens sein. <br><br>  Schlagen Sie einen Algorithmus vor, um Knoten effizient auszuw√§hlen.  Sch√§tzen Sie die Rechenkomplexit√§t mithilfe der gro√üen O-Notation. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Warum ist alles auf Englisch?</b> <div class="spoiler_text"><p>  Weil in dieser Form die Teilnehmer der Konferenz mit ihnen k√§mpften und weil Englisch die offizielle Sprache von Hydra war.  Die Aufgaben sahen folgenderma√üen aus: </p><br><p><img src="https://habrastorage.org/webt/to/5s/0a/to5s0amsnoyj1q_hxhl0z3gczzy.png"></p></div></div><br><p>  Nehmen Sie Papier und Bleistift, denken Sie, beeilen Sie sich nicht, um die Spoiler sofort zu √∂ffnen :) </p><br><div class="spoiler">  <b class="spoiler_title">Nachbesprechung (Video)</b> <div class="spoiler_text"><p>  Ab 5:53 nur 4 Minuten: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HAiQ2llS0bE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Und so haben die Jungs mit einem Flipchart ihre Entscheidung getroffen: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/U_yfKDwXppg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><div class="spoiler">  <b class="spoiler_title">Analyse der Entscheidung (Text)</b> <div class="spoiler_text"><p> An der Oberfl√§che gibt es eine solche L√∂sung: Summieren Sie die Gewichte aller Replikate, generieren Sie eine Zufallszahl von 0 bis zur Summe aller Gewichte und w√§hlen Sie dann eine i-Replik, sodass die Summe der Replikatgewichte von 0 bis zum (i-1) -ten kleiner als die Zufallszahl ist, und die Summe der Replikatgewichte von 0 bis zum i-ten - mehr als es.  Es stellt sich heraus, dass Sie ein Replikat ausw√§hlen m√ºssen. Um das n√§chste auszuw√§hlen, m√ºssen Sie den gesamten Vorgang wiederholen, ohne das ausgew√§hlte Replikat zu ber√ºcksichtigen.  Mit einem solchen Algorithmus ist die Komplexit√§t der Auswahl eines Replikats O (N), die Komplexit√§t der Auswahl von K Replikaten ist O (N ¬∑ K) ~ O (N <sup>2</sup> ). </p><br><p><img src="https://habrastorage.org/webt/cq/1w/hg/cq1whgt1skw7dcwo3ck7wh6rbto.png"></p><br><p>  Die quadratische Komplexit√§t ist schlecht, kann aber verbessert werden.  Erstellen Sie dazu einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Segmentbaum</a> f√ºr die Gewichtssummen.  Dies erzeugt einen Baum mit einer Tiefe von log N, in dessen Bl√§ttern sich Replikatgewichte befinden, und in den verbleibenden Knoten Teilsummen bis zur Summe aller Gewichte in der Wurzel des Baumes.  Als n√§chstes generieren wir eine Zufallszahl von 0 bis zur Summe aller Gewichte, suchen das i-te Replikat, l√∂schen es aus dem Baum und wiederholen den Vorgang, um nach den verbleibenden Replikaten zu suchen.  Mit einem solchen Algorithmus ist die Komplexit√§t des Konstruierens eines Baums O (N), die Komplexit√§t des Findens des i-ten Replikats und des Entfernens aus dem Baum ist O (log N), die Komplexit√§t der Auswahl von K Replikaten ist O (N + K log N) ~ O (N log N) . </p><br><p><img src="https://habrastorage.org/webt/u-/23/tx/u-23txhrw-1dl14qilobw3laro4.png"></p><br><p>  Die linear-logarithmische Komplexit√§t ist insbesondere bei gro√üen K besser als die quadratische Komplexit√§t. </p><br><p>  Dieser Algorithmus ist <a href="">im Code</a> der ClusterClient-Bibliothek aus dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vostok-</a> Projekt <a href="">implementiert</a> . </p></div></div><br><h1 id="zadacha-2-zebra">  Aufgabe 2. Zebra </h1><br><p>  Es war notwendig, einen Algorithmus zum effizienten Sortieren von Dokumenten im Speicher nach einem beliebigen nicht indizierten Feld vorzuschlagen: </p><br><blockquote>  Ihr Team hat die Aufgabe, eine gespeicherte In-Memory-Dokumentendatenbank zu entwickeln.  Eine √ºbliche Arbeitslast w√§re die Auswahl der Top-N-Dokumente, sortiert nach einem beliebigen (nicht indizierten) numerischen Feld aus einer Sammlung der Gr√∂√üe M (normalerweise N &lt;100 &lt;&lt; M).  Eine etwas geringere Arbeitsbelastung w√§re die Auswahl von Top N nach dem √úberspringen von Top S-Dokumenten (S ~ N). <br><br>  Schlagen Sie einen Algorithmus vor, um solche Abfragen effizient auszuf√ºhren.  Sch√§tzen Sie die Rechenkomplexit√§t mithilfe der Big-O-Notation im Durchschnitt und im schlimmsten Fall. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Nachbesprechung (Video)</b> <div class="spoiler_text"><p>  Start um 34:50, nur 6 Minuten: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HAiQ2llS0bE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><div class="spoiler">  <b class="spoiler_title">Analyse der Entscheidung (Text)</b> <div class="spoiler_text"><p>  Die L√∂sung liegt auf der Oberfl√§che: Sortieren Sie alle Dokumente (z. B. mithilfe von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quicksort</a> ) und nehmen Sie dann N + S-Dokumente.  In diesem Fall betr√§gt die Komplexit√§t der Sortierung im Durchschnitt O (M lg M), im schlimmsten Fall O (M <sup>2</sup> ). </p><br><p>  Offensichtlich ist es ineffizient, alle M-Dokumente zu sortieren, um dann nur einen kleinen Teil davon aufzunehmen.  Um nicht alle Dokumente zu sortieren, ist der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schnellauswahlalgorithmus geeignet</a> , der N + S der erforderlichen Dokumente ausw√§hlt (sie k√∂nnen nach jedem Algorithmus sortiert werden).  In diesem Fall nimmt die Komplexit√§t im Durchschnitt auf O (M) ab, und der schlimmste Fall bleibt der gleiche. </p><br><p>  Sie k√∂nnen dies jedoch noch effizienter tun - verwenden Sie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bin√§ren Heap-Streaming-</a> Algorithmus.  In diesem Fall werden die ersten N + S-Dokumente zum Min- oder Max-Heap hinzugef√ºgt (abh√§ngig von der Sortierrichtung). Anschlie√üend wird jedes nachfolgende Dokument mit dem Stamm des Baums verglichen, der derzeit das minimale oder maximale Dokument enth√§lt, und bei Bedarf zum Baum hinzugef√ºgt .  In diesem Fall ist die Komplexit√§t im schlimmsten Fall, wenn Sie den Baum st√§ndig neu erstellen m√ºssen - O (M lg (N + S)), die durchschnittliche Komplexit√§t ist O (M), wie bei der Schnellauswahl. </p><br><p>  Heap-Streaming ist jedoch effektiver, da in der Praxis die meisten Dokumente nach einem einzigen Vergleich mit seinem Stammelement verworfen werden k√∂nnen, ohne den Heap neu zu erstellen.  Eine solche Sortierung ist in der speicherinternen Zebra-Dokumentendatenbank implementiert, die in der Schaltung entwickelt und verwendet wird. </p></div></div><br><h1 id="zadacha-3-state-swaps">  Aufgabe 3. State Swaps </h1><br><p>  Es war notwendig, den effizientesten Algorithmus f√ºr die Zustandsverschiebung vorzuschlagen: </p><br><blockquote>  Ihr Team hat die Aufgabe, einen ausgefallenen Zustandsaustauschmechanismus f√ºr einen verteilten Cluster von N Knoten zu entwickeln.  Der Zustand des i-ten Knotens sollte auf den (i + 1) -ten Knoten √ºbertragen werden, der Zustand des N-ten Knotens sollte auf den ersten Knoten √ºbertragen werden.  Die einzige unterst√ºtzte Operation ist der Zustandstausch, wenn zwei Knoten ihre Zust√§nde atomar austauschen.  Es ist bekannt, dass ein Zustandstausch M Millisekunden dauert.  Jeder Knoten kann jederzeit an einem einzelnen Statusaustausch teilnehmen. <br><br>  Wie lange dauert es, die Zust√§nde aller Knoten in einem Cluster zu √ºbertragen? </blockquote><br><div class="spoiler">  <b class="spoiler_title">Analyse der Entscheidung (Text)</b> <div class="spoiler_text"><p>  Eine L√∂sung an der Oberfl√§che: Tauschen Sie die Zust√§nde des ersten und zweiten Elements aus, dann des ersten und dritten, dann des ersten und vierten und so weiter.  Nach jedem Austausch befindet sich der Zustand eines Elements an der gew√ºnschten Position.  Sie m√ºssen O (N) -Permutationen durchf√ºhren und O (N ¬∑ M) -Zeit verbringen. </p><br><p><img src="https://habrastorage.org/webt/lx/f6/8p/lxf68pgl8xz2tqhhc58r_1m03y4.png"></p><br><p>  Die lineare Zeit ist eine lange Zeit, sodass Sie die Zust√§nde von Elementen paarweise austauschen k√∂nnen: die erste mit der zweiten, die dritte mit der vierten und so weiter.  Nach jedem Austausch befindet sich der Zustand jedes zweiten Elements an der gew√ºnschten Position.  Wir m√ºssen O (log N) -Permutationen durchf√ºhren und O (M log N N) -Zeit verbringen. </p><br><p><img src="https://habrastorage.org/webt/mm/5n/jq/mm5njqmglg6ma2nlrkxsd14coeu.png"></p><br><p>  Sie k√∂nnen die Verschiebung jedoch noch effektiver gestalten - nicht linear, sondern in konstanter Zeit.  Dazu m√ºssen Sie im ersten Schritt den Status des ersten Elements gegen das letzte, das zweite gegen das vorletzte Element usw. austauschen.  Der Zustand des letzten Elements befindet sich an der gew√ºnschten Position.  Und jetzt m√ºssen Sie den Zustand des zweiten Elements gegen das letzte, das dritte gegen das vorletzte usw. austauschen.  Nach dieser Austauschrunde befinden sich die Zust√§nde aller Elemente in der richtigen Position.  Insgesamt werden O (2M) ~ O (1) -Permutationen durchgef√ºhrt. </p><br><p><img src="https://habrastorage.org/webt/ul/gz/os/ulgzosuwmplrlvpyxh_1fh7fndg.png"></p><br><p>  Eine solche L√∂sung wird einen Mathematiker nicht √ºberraschen, der sich immer noch daran erinnert, dass Rotation eine Zusammensetzung zweier axialer Symmetrien ist.  √úbrigens ist es trivial verallgemeinert, nicht um eins, sondern um K &lt;N Positionen zu verschieben.  (Schreiben Sie in den Kommentaren genau wie.) </p></div></div><br><p>  Magst du R√§tsel?  Kennen Sie andere L√∂sungen?  Teilen Sie in den Kommentaren. </p><br><p>  Und hier sind einige n√ºtzliche Links am Ende: </p><br><ul><li>  Erfahren Sie mehr √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Infrastrukturentwicklung</a> in Circuit </li><li>  Sehen Sie sich Aufzeichnungen interner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flyer mit Berichten</a> √ºber verteilte Systeme an </li><li>  Sehen Sie sich die Video-Vorlesungsreihe ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ungew√∂hnliche Algorithmen f√ºr normale Menschen</a> ‚Äú an. </li><li>  Abonnieren Sie unseren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kanal in Telegramm</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459958/">https://habr.com/ru/post/de459958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459936/index.html">9 weitere Tricks f√ºr die Arbeit mit Visual Studio</a></li>
<li><a href="../de459948/index.html">Implementierung physikalisch korrekter volumetrischer Wolken wie in Horizon Zero Dawn</a></li>
<li><a href="../de459952/index.html">Ein wenig Erfahrung mit Backup & Storage</a></li>
<li><a href="../de459954/index.html">Warum eines der gr√∂√üten IT-Unternehmen zu CNCF kam - einem Fonds zur Entwicklung der Cloud-Infrastruktur</a></li>
<li><a href="../de459956/index.html">Implantation in v√∂lliger Abwesenheit von Z√§hnen infolge vorzeitiger Besuche beim Zahnarzt</a></li>
<li><a href="../de459960/index.html">Von der Idee bis zur Ver√∂ffentlichung. Detaillierte Market Frontend-Erfahrung</a></li>
<li><a href="../de459964/index.html">8 einfache UI-Tricks, um ein Prototyp-Design dynamisch zu gestalten, ohne auf Animation zur√ºckgreifen zu m√ºssen</a></li>
<li><a href="../de459968/index.html">Was wirklich mit der verschwundenen malaysischen Boeing passiert ist (Teil 3/3)</a></li>
<li><a href="../de459970/index.html">Promise.allSettled</a></li>
<li><a href="../de459972/index.html">Entwicklung f√ºr Docker. Lokale Umgebung. Teil 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>