<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚡️ 👨‍👧 🎒 ¿Deben las cadenas en Python ser iterables? 👨‍👩‍👦‍👦 🔽 👧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Y Guido creó cadenas en la imagen de C, en la imagen de conjuntos de caracteres creados. Y Guido vio que estaba bien. O no? 

 Imagine que está escrib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¿Deben las cadenas en Python ser iterables?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451252/">  Y Guido creó cadenas en la imagen de C, en la imagen de conjuntos de caracteres creados.  Y Guido vio que estaba bien.  <i>O no?</i> <br><br>  Imagine que está escribiendo código completamente idiomático para omitir algunos datos con anidamiento.  Lo bello es mejor que lo feo, lo simple es mejor que lo complejo, por lo que debe detenerse en la siguiente versión del código: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections.abc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Iterable <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">traverse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(list_or_value, callback)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isinstance(list_or_value, Iterable): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> list_or_value: traverse(item, callback) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: callback(list_or_value)</code> </pre> <br>  Escribes una prueba unitaria, y ¿qué pensarías?  No funciona, y no solo no funciona, sino <br><br><pre> <code class="plaintext hljs">&gt;&gt;&gt; traverse({"status": "ok"}, print) Traceback (most recent call last): File "&lt;stdin&gt;", line 1, in &lt;module&gt; File "&lt;stdin&gt;", line 4, in traverse File "&lt;stdin&gt;", line 4, in traverse File "&lt;stdin&gt;", line 4, in traverse [Previous line repeated 989 more times] File "&lt;stdin&gt;", line 2, in traverse File "/usr/local/opt/python/libexec/bin/../../Frameworks/Python.framework/Versions/3.7/lib/python3.7/abc.py", line 139, in __instancecheck__ return _abc_instancecheck(cls, instance) RecursionError: maximum recursion depth exceeded in comparison</code> </pre><br>  Como?  Por qué  En busca de una respuesta, te sumergirás en el maravilloso mundo de las colecciones de infinita profundidad. <br><a name="habracut"></a><br>  De hecho, ¡una cadena es el único <code>Iterable</code> incorporado que siempre devuelve <code>Iterable</code> como elemento!  Podemos, por supuesto, construir otro ejemplo creando una lista y agregándola a nosotros mismos una o dos veces, pero ¿lo ve a menudo en su código?  Y la línea es <code>Iterable</code> profundidad infinita, escondiéndose bajo la cobertura de la noche directamente en su producción. <br><br>  Otro ejemplo.  En algún lugar del código, debe verificar repetidamente la presencia de elementos en los contenedores.  Decide escribir un ayudante que lo acelere de muchas maneras.  Escribe una solución universal que usa solo el método <code>__contains__</code> (el único método en la clase Base abstracta del <code>Container</code> ), pero luego decide agregar una súper optimización para un caso especial: una colección.  Después de todo, ¡puedes caminar y hacer un <code>set</code> ! <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> functools <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> typing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Collection, Container <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">faster_container</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c: Container)</span></span></span><span class="hljs-function"> -&gt; Container:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isinstance(c, Collection): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> set(c) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CachedContainer(c) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CachedContainer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, c: Container)</span></span></span><span class="hljs-function">:</span></span> self._contains = functools.lru_cache()(c.__contains__) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__contains__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, stuff)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._contains(stuff)</code> </pre><br>  III ... tu solución no funciona!  Bueno aqui!  Otra vez! <br><br><pre> <code class="plaintext hljs">&gt;&gt;&gt; c = faster_container(othello_text) &gt;&gt;&gt; "Have you pray'd to-night, Desdemona?" in c False</code> </pre><br>  (Pero la respuesta incorrecta se emitió muy rápido ...) <br><br>  Por qué  Porque una cadena en Python es una colección increíble en la que la semántica del método <code>__contains__</code> <b>no es consistente</b> con la semántica de <code>__iter__</code> y <code>__len__</code> . <br><br>  De hecho, una cadena es una colección: <br><br><pre> <code class="plaintext hljs">&gt;&gt;&gt; from collections.abc import Collection &gt;&gt;&gt; issubclass(str, Collection) True</code> </pre><br>  Pero la colección ... ¿qué?  <code>__iter__</code> y <code>__len__</code> consideran que se trata de una colección de personajes: <br><br><pre> <code class="plaintext hljs">&gt;&gt;&gt; s = "foo" &gt;&gt;&gt; len(s) 3 &gt;&gt;&gt; list(s) ['f', 'o', 'o']</code> </pre><br>  ¡Pero <code>__contains__</code> piensa que esta es una colección de subcadenas! <br><br><pre> <code class="plaintext hljs">&gt;&gt;&gt; "oo" in s True &gt;&gt;&gt; "oo" in list(s) False</code> </pre><br><h2>  Que se puede hacer </h2><br>  Aunque el comportamiento de <code>str.__contains__</code> puede parecer extraño en el contexto de implementaciones de <code>__contains__</code> otros tipos estándar, este comportamiento es una de las muchas cosas pequeñas que hacen que Python sea tan conveniente como un lenguaje de script;  permitiéndole escribir código rápido y literario en él.  No sugeriría cambiar el comportamiento de este método, especialmente porque casi nunca lo usamos para verificar la presencia de un solo carácter en una cadena. <br><br>  Y por cierto, ¿sabes por qué?  ¡Porque casi nunca usamos una cadena como una colección de caracteres en un lenguaje de script!  Manipulación de caracteres específicos en una cadena, acceso por índice, con mayor frecuencia el destino de las tareas en las entrevistas.  Entonces, ¿tal vez debería eliminar <code>__iter__</code> de la cadena, ocultarlo detrás de algún método como <code>.chars()</code> ?  Esto resolvería ambos problemas. <br><br>  ¡Hora para la discusión del viernes en los comentarios! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451252/">https://habr.com/ru/post/451252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451232/index.html">El uso del modelo de financiación continua en crowdfunding</a></li>
<li><a href="../451240/index.html">¿Por qué me gustan las interfaces Go?</a></li>
<li><a href="../451242/index.html">MMORPG solo (acosador 2d)</a></li>
<li><a href="../451246/index.html">Ingeniería inversa de una estación de soldadura de alta gama</a></li>
<li><a href="../451248/index.html">El lado oscuro de los hackatones.</a></li>
<li><a href="../451254/index.html">Categoría: proveedor de IaaS de hierro unboxing</a></li>
<li><a href="../451256/index.html">¿Qué es un sistema de informes ideal? ¿Es realista entender lo que está sucediendo en la empresa?</a></li>
<li><a href="../451258/index.html">Atrápame si puedes. Carta del gerente</a></li>
<li><a href="../451260/index.html">10 eventos temáticos de la Universidad ITMO</a></li>
<li><a href="../451262/index.html">Científicos de Stanford: un dispositivo colocado en el oído podrá controlar el funcionamiento del cerebro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>