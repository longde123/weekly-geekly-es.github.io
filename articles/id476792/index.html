<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§›ğŸ¼ ğŸ’¨ ğŸ´ Swift.assert - kehidupan setelah rilis ğŸ¤ŸğŸ¾ ğŸ¦• ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘©ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seberapa sering Anda menggunakan Swift.assert() dalam kode Anda? Jujur saya cukup sering menggunakannya (Jika ini adalah praktik yang buruk, maka sila...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Swift.assert - kehidupan setelah rilis</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476792/"> Seberapa sering Anda menggunakan <code>Swift.assert()</code> dalam kode Anda?  Jujur saya cukup sering menggunakannya (Jika ini adalah praktik yang buruk, maka silakan tulis di komentar - mengapa itu buruk?).  Dalam kode saya, Anda sering dapat melihat, misalnya, panggilan seperti itu: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Swift</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">assert</span></span>(<span class="hljs-type"><span class="hljs-type">Thread</span></span>.isMainThread)</code> </pre> <br>  Belum lama ini, saya memutuskan bahwa akan menyenangkan untuk terus mengamati hasil dari panggilan ini, tidak hanya sebagai bagian dari peluncuran aplikasi di simulator / perangkat, tetapi juga dari tindakan pengguna nyata.  Ngomong-ngomong, di sini kita dapat berbicara tentang <code>Swift.precondition()</code> , <code>Swift.fatalError()</code> , dll., Walaupun saya mencoba menghindarinya.  Saya membaca lebih lanjut tentang <i>Kesalahan yang Tidak Dapat Dipulihkan di Swift</i> <a href="https://habr.com/ru/post/440884/">dalam publikasi ini</a> dan ternyata sangat informatif. <br><br>  Lebih dekat ke titik: <a name="habracut"></a>  dalam kode saya menemukan sekitar 300 panggilan seperti itu.  Tak satu pun dari mereka bekerja selama pengujian lokal yang biasa, dan itu menyenangkan saya.  Tetapi saya menyarankan bahwa tindakan pengguna mungkin masih memicu beberapa panggilan. <br><br>  Dari sudut pandang pengguna, crash seharusnya tidak terjadi (sekali lagi, menurut saya).  Dalam kasus yang ekstrim, pengguna harus memahami bahwa beberapa skenario salah dan tim pengembang sudah bekerja untuk memperbaikinya.  Pengecualian serupa selalu ditangani oleh saya, dan bagi pengguna itu bisa berdampak pada bentuk yang paling tidak berbahaya.  Sebagai contoh, salah satu dari ratusan sel tabel tidak terlihat. <br><br>  Dengan pengguna lebih atau kurang semuanya jelas.  Masih berurusan dengan pengiriman log ke pengembang.  Pertama, diperlukan upaya minimal untuk mengganti panggilan saat ini dalam kode dengan panggilan mengirim log di suatu tempat di luar aplikasi.  Kedua, itu perlu untuk secara akurat melokalisasi tempat kejadian, jika tidak praktis tidak mungkin untuk menghubungkan pengecualian dengan kode nyata.  Ketiga, harus dicatat bahwa panggilan yang dimodifikasi dapat bekerja selama pengujian Unit, di mana <code>Thread.isMainThread</code> seharusnya sudah diabaikan.  Saya menggunakan kerangka kerja <b>RxTest</b> untuk jenis pengujian tertentu (di sini saya juga siap mendengarkan saran dan kritik).  Poin utama tetap bahwa secara lokal semua pengecualian harus dipicu seperti sebelumnya, yaitu  <code>Loggin.assert()</code> harus memecat pada saat yang sama bahwa <code>Swift.assert()</code> akan memecat <br><br>  <b>Fabric</b> ( <b>Crashlytics</b> ) menyediakan cara hebat untuk mengirim acara.  Ini terlihat seperti ini: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Crashlytics</span></span>.sharedInstance().recordCustomExceptionName(<span class="hljs-string"><span class="hljs-string">""</span></span>, reason: <span class="hljs-string"><span class="hljs-string">""</span></span>...</code> </pre> <br>  Masih mengemas <b>Crashlytics</b> ke dalam beberapa kerangka kerja yang dapat dimuat <b>secara keseluruhan</b> ke dalam aplikasi dan dalam bentuk terpotong (tanpa ketergantungan <b>Crashlytics</b> ) dalam target pengujian. <br><br>  Saya memutuskan untuk melakukan " <a href="https://cocoapods.org/">pengemasan</a> " melalui <a href="https://cocoapods.org/">CocoaPods</a> : <br><br><pre> <code class="ruby hljs">Pod::Spec.new <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|s|</span></span> s.name = <span class="hljs-string"><span class="hljs-string">'Logging'</span></span> ... s.subspec <span class="hljs-string"><span class="hljs-string">'Base'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|ss|</span></span> ss.source_files = <span class="hljs-string"><span class="hljs-string">'Source/Logging+Base.swift'</span></span> ss.dependency <span class="hljs-string"><span class="hljs-string">'Crashlytics'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> s.subspec <span class="hljs-string"><span class="hljs-string">'Test'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|ss|</span></span> ss.source_files = <span class="hljs-string"><span class="hljs-string">'Source/Logging+Test.swift'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Kode untuk "target tempur" adalah sebagai berikut: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Crashlytics public enum Logging { public static func send(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { let file = __file.components(separatedBy: "/").last ?? __file let line = "\(__line)" let name = [line, file].joined(separator: "_") Crashlytics.sharedInstance().recordCustomExceptionName(name, reason: reason ?? "no reason", frameArray: []) } public static func assert(_ assertion: @escaping @autoclosure () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { if assertion() == false { self.assertionFailure(reason, __file: __file, __line: __line) } } public static func assert(_ assertion: @escaping () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { if assertion() == false { self.assertionFailure(reason, __file: __file, __line: __line) } } public static func assertionFailure(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { Swift.assertionFailure(reason ?? "") self.send(reason, __file: __file, __line: __line) } }</code> </pre> <br>  Untuk "target pengujian" yaitu  tanpa ketergantungan <b>Crashlytics</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation public enum Logging { public static func send(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { <span class="hljs-comment"><span class="hljs-comment">// } public static func assert(_ assertion: @escaping @autoclosure () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { // } public static func assert(_ assertion: @escaping () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { // } public static func assertionFailure(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { // } }</span></span></code> </pre> <br><h2>  Hasil: </h2><br>  Pengecualian benar-benar mulai bekerja.  Sebagian besar dari mereka melaporkan format yang salah untuk data yang diterima: <code>Decodable</code> terkadang menerima data dengan tipe yang <code>Decodable</code> .  Terkadang log untuk <code>Thread.isMainThread</code> berfungsi, yang sangat cepat diperbaiki di rilis berikutnya.  Kesalahan paling menarik secara ajaib ditangkap oleh <b>NSException</b> . <br><br>  Terima kasih atas perhatian anda <br><br>  <b>NB</b> Jika Anda terlalu sering mengirim log seperti itu ke <b>Crashlytics</b> , layanan ini dapat mengenali tindakan Anda sebagai spam.  Dan Anda akan melihat pesan berikut: <br><blockquote>  Karena penggunaan yang tidak tepat, pelaporan non-fatal telah dinonaktifkan untuk beberapa bangunan.  Pelajari cara mengaktifkan kembali pelaporan dalam dokumentasi kami. </blockquote>  Oleh karena itu, perlu mempertimbangkan terlebih dahulu frekuensi pengiriman log.  Jika tidak, semua log bangunan mungkin dalam bahaya diabaikan oleh <b>Crashlytics.</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id476792/">https://habr.com/ru/post/id476792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id476772/index.html">DeepPavlov untuk pengembang: # 2 pengaturan dan penyebaran</a></li>
<li><a href="../id476774/index.html">Ulasan Playme TAU DVR: Mount Magnetic, Murah</a></li>
<li><a href="../id476778/index.html">Gorp.NET - perpustakaan baru untuk membuat template terbalik untuk mengekstrak data dari teks terstruktur</a></li>
<li><a href="../id476786/index.html">Sertifikasi sistem perekaman foto / video pelanggaran dan sistem segmen keamanan transportasi</a></li>
<li><a href="../id476788/index.html">Mengapa Pencetakan 3D Akan Mengubah Dunia?</a></li>
<li><a href="../id476796/index.html">Refleksi pada tubuh yang sempurna</a></li>
<li><a href="../id476798/index.html">Kami mempelajari perakitan chip RAM pada contoh Hynix GDDR3 SDRAM</a></li>
<li><a href="../id476806/index.html">MPS 2019.2: enumerasi tipe data, penyesuaian pesan kesalahan, transisi ke JDK 11 dan banyak lagi</a></li>
<li><a href="../id476812/index.html">Catatan tentang segalanya. Catu daya sederhana dan berbahaya</a></li>
<li><a href="../id476816/index.html">Dubai Mall di smartphone, atau cara menambahkan denah bangunan ke aplikasi Anda</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>