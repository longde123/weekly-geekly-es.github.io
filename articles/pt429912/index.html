<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÖ üí¢ üë©üèΩ‚Äçüéì Desenvolvimento da biblioteca: da API ao lan√ßamento p√∫blico üëí üê≠ üëçüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vejamos as bibliotecas n√£o do lado mais familiar para n√≥s, ou seja, do usu√°rio, mas do ponto de vista do desenvolvedor da biblioteca de desenvolviment...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento da biblioteca: da API ao lan√ßamento p√∫blico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/429912/">  Vejamos as bibliotecas n√£o do lado mais familiar para n√≥s, ou seja, do usu√°rio, mas do ponto de vista do desenvolvedor da biblioteca de desenvolvimento m√≥vel.  Vamos falar sobre quais abordagens devem ser seguidas ao desenvolver sua biblioteca.  Come√ßamos, √© claro, projetando uma API que voc√™ gostaria de usar, o que seria conveniente.  Pensaremos no que precisa ser considerado para criar n√£o apenas c√≥digo funcional, mas uma biblioteca muito boa e chegar ao ponto de lan√ßar um lan√ßamento p√∫blico adulto real.  <strong>Asya Sviridenko</strong> nos ajudar√° nisso, que compartilhar√° sua experi√™ncia consider√°vel no desenvolvimento da biblioteca m√≥vel SpeechKit em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex</a> . <br><br>  O material ser√° √∫til n√£o apenas para os envolvidos no desenvolvimento de uma biblioteca ou estrutura, mas tamb√©m para aqueles que desejam separar uma parte de seu aplicativo em um m√≥dulo separado e depois reutiliz√°-lo ou, por exemplo, compartilhar seu c√≥digo com o resto da comunidade de desenvolvedores, publicando-o em acesso p√∫blico. <br><br>  Para todos os outros, a hist√≥ria ser√° repleta de hist√≥rias genu√≠nas da vida da equipe m√≥vel do SpeechKit, por isso deve ser divertido. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/uvx060VepYo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h3>  Conte√∫do <br></h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Minuto SpeechKit</a> . <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projetando uma</a> API conveniente e compreens√≠vel que voc√™ deseja usar. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desenvolvimento</a> .  O que adicionar ao c√≥digo para que ele n√£o apenas funcione e execute a funcionalidade, mas tamb√©m ajude seus usu√°rios. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lan√ßamento</a> - o que voc√™ n√£o deve esquecer quando lan√ßa o lan√ßamento. <br></li></ul><br><a name="speechkit"></a><br><h2>  SpeechKit minute </h2><br>  N√£o vou perguntar se voc√™ ouviu falar sobre o SpeechKit, porque mesmo no Yandex, nem todo mundo sabe o que √©. <br><br>  <strong>O SpeechKit √© a porta para todas as tecnologias de fala Yandex</strong> .  Usando esta biblioteca, voc√™ pode integrar tecnologias de fala em seu aplicativo: reconhecimento e s√≠ntese de voz, ativa√ß√£o por voz. <br><br>  Voc√™ provavelmente j√° ouviu falar sobre a assistente de voz Alice - ela apenas trabalha com base no SpeechKit.  O SpeechKit em si n√£o inclui reconhecimento ou s√≠ntese, acontece no servidor.  Mas √© atrav√©s da nossa biblioteca que tudo pode ser integrado ao aplicativo. <br><br>  A seguir, geralmente vem a pergunta - se tudo no servidor acontece, o que a biblioteca faz?  Por que √© necess√°rio? <br><br>  A biblioteca faz muito: <br><br><ol><li>  <strong>Sincroniza√ß√£o de todos os processos.</strong>  Por exemplo, usando um assistente de voz, o usu√°rio clica em um bot√£o, diz alguma coisa, interrompe o assistente, faz solicita√ß√µes - tudo passa pela biblioteca.  Para o usu√°rio da nossa biblioteca isso √© transparente, eles n√£o devem se preocupar com tudo isso. </li><li> <strong>Trabalho em rede</strong>  Como tudo acontece no servidor, voc√™ precisa obter dados de l√°, process√°-los e entreg√°-los ao usu√°rio.  O SpeechKit agora pode acessar v√°rios servidores diferentes na mesma conex√£o de rede: um est√° envolvido no reconhecimento, o outro est√° na aloca√ß√£o de significado, o terceiro est√° no reconhecimento da m√∫sica, etc.  Tudo isso est√° oculto na biblioteca, os usu√°rios n√£o precisam se preocupar com isso. </li><li>  <strong>Trabalhe com fontes de √°udio.</strong>  Estamos lidando com a fala humana e o trabalho com √°udio tamb√©m ocorre no SpeechKit.  Al√©m disso, n√£o podemos apenas escrever de um dispositivo padr√£o, mas tamb√©m receber dados de qualquer lugar.  Pode ser um arquivo ou um fluxo - podemos trabalhar com tudo isso. </li></ol><br>  O SpeechKit √© usado em equipes internas.  Agora ele foi integrado por 16 equipes Yandex.  E sabemos at√© sobre v√°rias equipes externas que fizeram isso tamb√©m. <br><a name="disain"></a><br><h2>  Desenho </h2><br>  Vamos pensar no que queremos dizer com uma aplica√ß√£o conveniente.  Geralmente, este √© um UX atencioso e compreens√≠vel, a solu√ß√£o para nossos problemas, opera√ß√£o est√°vel etc. <br><br>  Quando dizemos que uma biblioteca √© conveniente, primeiro queremos dizer que ela possui uma API que √© f√°cil de usar.  Como conseguir isso? <br><br><h3>  Princ√≠pios b√°sicos <br></h3><br>  Esses s√£o alguns dos aspectos que aprendi com minha experi√™ncia com o SpeechKit. <br><br><ul><li>  <strong>Antes de tudo, lembre-se de que seus usu√°rios s√£o desenvolvedores</strong> . <br></li></ul><br>  Por um lado, isso √© bom, porque voc√™ n√£o pode explicar aos usu√°rios comuns: "Veja, o back-end est√° conosco e, portanto, nada funciona, e estamos bem!"  Voc√™ pode explicar aos desenvolvedores - voc√™ pode explicar muito aos desenvolvedores! <br><br>  Por outro lado, voc√™ obt√©m esses usu√°rios que definitivamente aproveitar√£o a oportunidade para encontrar um buraco e quebrar algo se voc√™ o deixar.  Todos n√≥s usamos bibliotecas e tentamos tirar o m√°ximo proveito delas.  Eles alegam que est√£o fazendo apenas isso, isso e isso, e estamos pensando: "N√£o, agora vamos fazer uma brincadeira aqui, vamos repassar e tudo ser√° como deveria". <br><br>  Al√©m disso, o fato de os usu√°rios serem desenvolvedores significa que voc√™ sempre ter√° uma montanha de dicas e truques sobre como desenvolver e como melhorar tudo. <br><br>  O segundo ponto importante √© totalmente consistente com o primeiro. <br><br><ul><li>  <strong>Tudo o que n√£o √© permitido na sua biblioteca deve ser proibido,</strong> <strong><br></strong>  <strong>para que n√£o haja brechas indesejadas.</strong> <br></li></ul><br>  Se seus usu√°rios come√ßarem a fazer algo com a biblioteca que voc√™ n√£o esperava, esse √© um caminho direto para erros e para aqueles que s√£o dif√≠ceis de depurar.  Tente usar tudo o que o idioma fornece e a tecnologia que voc√™ usa: p√∫blico / privado, final, reprovado, somente leitura.  Reduza o escopo, pro√≠ba a heran√ßa e o uso de alguns m√©todos, marque propriedades que n√£o podem ser alteradas - forne√ßa tudo o que for poss√≠vel para impedir algo que sua biblioteca simplesmente n√£o foi projetada para fazer. <br><br><ul><li>  <strong>N√£o permita ambiguidades na interpreta√ß√£o da API da sua biblioteca.</strong> <br></li></ul><br>  Se essa classe espec√≠fica puder ser criada de uma maneira, negue todas as outras.  Se essa propriedade n√£o puder ser nula, especifique-a explicitamente.  No iOS, h√° inicializador nulo / n√£o nulo, designado, o mesmo ocorre em Java e Android.  Use tudo isso para que o usu√°rio abra o arquivo, abra sua classe, repasse-o e entenda imediatamente o que pode ser feito e o que n√£o pode ser feito. <br><br><h3>  API do SpeechKit do caso <br></h3><br>  Usando o SpeechKit como exemplo, mostrarei como refatoramos a vers√£o 2 para a vers√£o 3. Alteramos muito a API e tentamos usar todos esses princ√≠pios. <br><br>  A necessidade surgiu porque a <strong>API era complexa e "te√≥rica"</strong> .  Havia componentes globais nele que precisavam ser chamados primeiro - n√£o chamados - tudo n√£o funcionou.  Configura√ß√µes muito estranhas foram definidas.  A API era bastante "te√≥rica", porque o SpeechKit fazia parte do Navegador e, em seguida, essa pe√ßa foi levada para a biblioteca.  A API trabalhou essencialmente com os casos usados ‚Äã‚Äãno Navigator. <br><br>  Gradualmente, o n√∫mero de usu√°rios aumentou e come√ßamos a entender o que eles realmente precisavam: quais m√©todos, retornos de chamada, par√¢metros.  Eles vieram at√© n√≥s com solicita√ß√µes que a API n√£o permitia implementar.  Isso foi repetido v√°rias vezes e ficou claro que a API n√£o estava √† altura.  Ent√£o nos envolvemos na refatora√ß√£o. <br><br>  <strong>O processo de refatora√ß√£o foi longo (meio ano) e doloroso (todo mundo estava infeliz)</strong> .  A principal dificuldade n√£o era pegar uma montanha de c√≥digo e reescrev√™-la.  Era imposs√≠vel simplesmente refatorar, mas era necess√°rio suportar todas as vers√µes ativas que estavam em uso.  N√£o pod√≠amos dizer apenas aos nossos usu√°rios: "Gente, sim, isso n√£o funciona para voc√™, sim, voc√™ precisa desse recurso - faremos tudo na vers√£o 3, aguarde seis meses!" <br><br>  Como resultado, a refatora√ß√£o levou muito tempo, e o processo foi doloroso, e tamb√©m para os usu√°rios.  Porque, no final, alteramos a API sem compatibilidade com vers√µes anteriores.  Eles vieram at√© eles e disseram: ‚ÄúAqui est√° um novo e bonito SpeechKit, por favor, pegue!‚Äù  - eles responderam: "N√£o, n√£o temos planos de atualizar para a sua vers√£o 3.0."  Por exemplo, tivemos uma equipe que mudou para esta vers√£o em um ano.  Portanto, durante um ano inteiro, apoiamos a vers√£o anterior para eles. <br><br>  Mas o resultado valeu a pena.  Temos <strong>integra√ß√£o simples e menos bugs</strong> .  Isso √© o que eu mencionei nos princ√≠pios b√°sicos de design da API.  Se voc√™ tem certeza de que sua API est√° sendo usada corretamente, definitivamente n√£o h√° problemas nesta parte: todas as classes s√£o chamadas corretamente, todos os par√¢metros est√£o corretos.  Encontrar bugs √© muito mais f√°cil, menos casos em que algo pode dar errado. <br><br>  Abaixo est√° um exemplo de como era a classe principal que lida com o reconhecimento antes da refatora√ß√£o. <br><br><pre><code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">// SpeechKit v2 @interface YSKRecognizer: NSObject @property (nonatomic, strong, readonly, getter=getModel) NSString* model; @property (nonatomic, assign, getter=isVADEnabled) BOOL VADEnabled; - (instancetype)initWithLanguage:(NSString *)language model:(NSString *)m; - (void)start; - (void)cancel; - (void)cancelSync; @end @interface YSKInitializer: NSObject - (instancetype)init; - (void)dealloc; - (void)start; + (BOOL)isInitializationCompleted; @end extern NSString *const YSKInactiveTimeout; extern NSString *const YSKVADEnabled; @interface YSKSpeechKit: NSObject + (instancetype)sharedInstance; ‚Äì (void)setParameter:(NSString *)name withValue:(NSString *)value; @end</span></span></code> </pre> <br>  Esta √© uma classe regular que herda de NSObject.  Vamos considerar cada um de seus detalhes separadamente.  √â claro que podemos herdar dele, redefinir alguns m√©todos nele - tudo o que pode ser feito com o NSObject. <br><br>  Em seguida, ao criar, duas linhas (linguagem e modelo) s√£o passadas para ele.  Quais s√£o essas linhas?  Se voc√™ passar no idioma "Ol√°, mundo", a sa√≠da ser√° uma tradu√ß√£o, ou o qu√™?  N√£o √© muito claro. <br><br>  Al√©m disso, como esse √© o sucessor do NSObject, podemos chamar init, new, etc.  O que vai acontecer?  Funcionar√° ou esperar√° alguns par√¢metros? <br><br>  √â claro que conhe√ßo as respostas para essas perguntas, conhe√ßo esse c√≥digo.  Mas as pessoas que est√£o vendo isso pela primeira vez n√£o entendem por que isso √© tudo.  Mesmo os m√©todos com setter e getter n√£o parecem nada com o que pode parecer no iOS.  Os m√©todos start, cancel, cancelSync (e o que acabou de cancelar - √© aSync?) - o que acontecer√° se forem chamados juntos?  Muitas perguntas para esse c√≥digo. <br><br>  Em seguida, vem o objeto sobre o qual falei (YSKInitializer), que deve ser iniciado para que tudo funcione - geralmente √© algum tipo de m√°gica.  Pode-se ver que esse c√≥digo foi escrito por desenvolvedores que n√£o escrevem para iOS, mas est√£o envolvidos em C ++. <br><br>  Al√©m disso, as configura√ß√µes desse reconhecedor foram definidas por meio de componentes globais que foram transferidos para outro objeto global e, de fato, era imposs√≠vel criar dois reconhecedores diferentes com diferentes conjuntos de par√¢metros.  E esse foi provavelmente um dos casos mais populares que n√£o suportavam a API. <br><br><h3>  Do que v3 √© melhor que v2 <br></h3><br>  O que obtivemos quando refatoramos e mudamos para a vers√£o 3? <br><br><ul><li>  <strong>API completamente nativa.</strong> <br></li></ul><br>  Agora, nossa API do iOS parecia a API do iOS, a API do Android parecia o Android. <br><br><blockquote>  Um ponto importante que n√£o percebemos imediatamente √© que as diretrizes da plataforma s√£o muito mais importantes que a uniformidade da API da sua biblioteca. <br></blockquote><br>  Por exemplo, as classes para Android s√£o criadas usando construtores, porque esse √© um padr√£o muito compreens√≠vel para desenvolvedores de Android.  No iOS, isso n√£o √© t√£o popular, por isso √© usada uma abordagem diferente: criamos objetos com uma classe especial de configura√ß√µes. <br><br>  Lembro-me de como discutimos por um longo tempo sobre esse assunto.  Pareceu-nos importante que o desenvolvedor adotasse nosso c√≥digo no iOS ou Android, e a correspond√™ncia seria de 99%.  Mas isso n√£o √© verdade.  Melhor, o c√≥digo ser√° semelhante √† plataforma para a qual est√° sendo desenvolvido. <br><br><ul><li>  <strong>Inicializa√ß√£o simples e intuitiva</strong> . <br></li></ul><br>  Este objeto √© necess√°rio - aqui est√£o suas configura√ß√µes, crie-as, transfira-as - lucre!  Ou seja, n√£o h√° configura√ß√µes globais ocultas que precisam ser transferidas para algum lugar. <br><br><ul><li>  <strong>Falta de componentes globais.</strong> <br></li></ul><br>  Jogamos fora componentes globais que confundiram, assustaram e causaram muitas perguntas, mesmo entre os desenvolvedores desta biblioteca, n√£o apenas os usu√°rios. <br><br>  Agora, a mesma classe na nova vers√£o se parece com esta (ainda √© Objective-C - voc√™ n√£o podia mudar para Swift ent√£o). <br><br><pre> <code class="objectivec hljs"><span class="hljs-comment"><span class="hljs-comment">// SpeechKit v3 NS_ASSUME_NONNULL_BEGIN __attribute__((objc_subclassing_restricted)) @interface YSKOnlineRecognizer: NSObject&lt;YSKRecognizing&gt; @property (nonatomic, copy, readonly) YSKOnlineRecognizerSettings *settings; - (instancetype)initWithSettings:(YSKOnlineRecognizerSettings *)s audioSource:(id&lt;YSKAudioSource&gt;)as NS_DESIGNATED_INITIALIZER; + (instancetype)new __attribute__((unavailable("Use designated initializer."))); - (instancetype)init __attribute__((unavailable("Use designated initializer."))); @end NS_ASSUME_NONNULL_END @protocol YSKRecognizing &lt;NSObject&gt; - (void)prepare; - (void)startRecording; - (void)cancel; @end @interface YSKOnlineRecognizerSettings: NSObject&lt;NSCopying&gt; @property (nonatomic, copy, readonly) YSKLanguage *language; @property (nonatomic, copy, readonly) YSKOnlineModel *model; @property (nonatomic, assign) BOOL enableVAD; - (instancetype)initWithLanguage:(YSKLanguage *)l model:(YSKOnlineModel *)m NS_DESIGNATED_INITIALIZER; @end @interface YSKLanguage: YSKSetting + (instancetype)russian; + (instancetype)english; @end</span></span></code> </pre><br>  Este √© o sucessor do NSObject, mas agora estamos falando claramente do fato de que voc√™ n√£o pode herdar dele.  Todos os m√©todos que s√£o caracter√≠sticos deste objeto s√£o transferidos para um protocolo especial.  √â criado usando as configura√ß√µes e o audioSource.  Agora todas as configura√ß√µes s√£o encapsuladas em um √∫nico objeto, que √© transferido especificamente aqui para definir as configura√ß√µes de um reconhecedor espec√≠fico. <br><br>  Al√©m disso, removemos o trabalho com √°udio daqui, ou seja, o reconnaiser agora n√£o √© o componente que grava o √°udio.  Este componente lida com problemas de reconhecimento e qualquer fonte pode ser transferida aqui. <br><br>  Outros m√©todos de cria√ß√£o atrav√©s do novo ou do init s√£o proibidos, porque essa classe precisa de configura√ß√µes padr√£o.  Por favor, se voc√™ quiser us√°-lo, crie pelo menos algumas configura√ß√µes padr√£o. <br><br>  O principal √© que as configura√ß√µes transferidas aqui s√£o imut√°veis, ou seja, voc√™ n√£o pode alter√°-las no processo.  N√£o √© necess√°rio tentar, quando algo √© reconhecido, substituir o modelo ou o idioma.  Dessa forma, n√£o oferecemos aos usu√°rios a oportunidade de alterar o objeto com as configura√ß√µes que j√° foram transferidas. <br><br>  Macros NS_ASSUME_NONNULL_BEGIN / NS_ASSUME_NONNULL_END para enfatizar que essas configura√ß√µes n√£o podem ser nulas: audioSource n√£o pode ser nula - todas elas devem ter algum valor espec√≠fico para funcionar. <br><br>  Como eu disse, os m√©todos de in√≠cio e cancelamento (cancelSync √† esquerda) foram movidos para um protocolo separado.  H√° lugares na biblioteca onde voc√™ pode usar n√£o o nosso reconnaiser, mas qualquer outro.  Por exemplo, usamos o nativo da Apple, que implementa esse protocolo e para o qual ele pode transferir nossos componentes. <br><br>  As configura√ß√µes aqui s√£o NSCopying para que possamos copi√°-las e elas n√£o puderam ser alteradas no processo.  No init, os par√¢metros necess√°rios s√£o idioma, modelo e NS_DESIGNATED_INITIALIZER.  Este n√£o √© um peda√ßo de c√≥digo id√™ntico aos m√©todos obsoletos, mas a ideia √© clara.  Estes s√£o par√¢metros necess√°rios com os quais as configura√ß√µes s√£o criadas.  Eles devem ser e devem ser diferentes de zero. <br><br>  O restante do conjunto possui cerca de 20 configura√ß√µes do reconhecedor aqui.  At√© as configura√ß√µes de uma linguagem ou modelo tamb√©m s√£o classes separadas que n√£o nos permitem transmitir algo abstrato, com o qual n√£o podemos trabalhar.  Ou seja, dizemos claramente: ‚ÄúPor favor, n√£o nos d√™ algo com o qual n√£o sabemos trabalhar.  O compilador n√£o permitir√° que voc√™ fa√ßa isso. <br><br>  Ent√£o, conversamos sobre o que voc√™ pode fazer com a API.  O desenvolvimento tamb√©m tem suas pr√≥prias nuances. <br><a name="develop"></a><br><h2>  Desenvolvimento </h2><br>  Primeiro de tudo, a biblioteca deve fazer o que voc√™ escreveu - para executar bem sua funcionalidade.  Mas voc√™ pode tornar seu c√≥digo uma biblioteca muito boa.  Proponho v√°rias observa√ß√µes que foram coletadas por mim durante o desenvolvimento do SpeechKit. <br><br><h3>  O c√≥digo n√£o √© apenas para voc√™ <br></h3><br>  <strong>√â</strong> absolutamente necess√°rio <strong>coletar informa√ß√µes de depura√ß√£o</strong> , porque voc√™ n√£o deseja que os usu√°rios digam que o servi√ßo deles n√£o est√° funcionando por causa da sua biblioteca. <br><br>  O IOS possui um n√≠vel de informa√ß√µes de depura√ß√£o que mostra quais informa√ß√µes precisam ser coletadas.  Por padr√£o, ele coletar√° absolutamente tudo o que puder encontrar: todas as chamadas, todos os valores.  Isso √© √≥timo, mas √© uma quantidade muito grande de dados.  Definir apenas tabelas-de-linhas permite coletar informa√ß√µes sobre chamadas de fun√ß√£o.  Isso √© mais que suficiente para encontrar um problema e corrigi-lo. <br><br>  Isso est√° inclu√≠do nas configura√ß√µes do Xcode (Build Settings) e √© chamado de n√≠vel de informa√ß√µes de depura√ß√£o.  Por exemplo, ao ativar essa configura√ß√£o, reduzimos o tamanho do arquivo bin√°rio do SpeechKit de 600 MB para 90 MB.  Esta n√£o √© uma informa√ß√£o muito necess√°ria e simplesmente a jogamos fora. <br><br>  A segunda coisa importante √© <strong>ocultar caracteres particulares</strong> .  Todos voc√™s sabem que toda vez que voc√™ carrega uma biblioteca no iTunes, corre o risco de receber um novo aviso de que est√° usando algo errado, sem adicionar nada.  Portanto, se voc√™ usar bibliotecas que a Apple considera privadas, oculte-as.  Isso n√£o significa nada para voc√™, voc√™ tamb√©m pode trabalhar com eles, mas assim que seus usu√°rios tentarem fazer upload do aplicativo com sua biblioteca no iTunes, eles receber√£o um erro.  Nem todos pedir√£o que voc√™ o conserte; a maioria simplesmente se recusar√° a usar sua solu√ß√£o. <br><br>  <strong>Evite conflitos de personagem</strong> : adicione prefixos a tudo o que voc√™ tem, √†s suas aulas, √†s categorias.  Se a biblioteca tiver uma categoria UIColor + HEX, certifique-se de que seus usu√°rios tenham exatamente a mesma categoria e, quando integrarem sua biblioteca, eles receber√£o conflitos de caracteres.  E, novamente, nem todo mundo vai querer dizer e dizer. <br><br>  Outra pergunta √© quando voc√™ usa bibliotecas de terceiros em sua biblioteca.  Vale a pena lembrar algumas nuances.  Primeiramente, se voc√™ usar algo que apareceu em uma vers√£o anterior √† sua biblioteca, n√£o se esque√ßa de usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Link Fraco</a> (Xcode -&gt; Construir Fases -&gt; Vincular Bin√°rio Com Bibliotecas -&gt; O status est√° ativado).  Isso permite que voc√™ n√£o caia se de repente essa biblioteca n√£o estiver. <br><br>  A documenta√ß√£o da Apple detalha como isso funciona.  Mas a vincula√ß√£o fraca n√£o significa que a biblioteca n√£o ser√° carregada se n√£o for usada.  Ou seja, se a hora de in√≠cio do aplicativo for importante para seus usu√°rios e voc√™ n√£o precisar da parte da sua biblioteca que usa uma biblioteca de terceiros e demora algum tempo para iniciar, a vincula√ß√£o fraca n√£o ajudar√°.  Com ele, a biblioteca ainda carrega se √© usada ou n√£o. <br><br>  Se voc√™ deseja carregar no tempo de execu√ß√£o, isso ajudar√° a se livrar do problema do link na inicializa√ß√£o, ent√£o voc√™ precisar√° usar o dlopen e o carregamento din√¢mico.  Isso requer muito barulho, e voc√™ deve primeiro entender se isso faz sentido.  O Facebook tem um <a href="">c√≥digo</a> bastante <a href="">interessante para um</a> exemplo de como eles se vincularam dinamicamente. <br><br>  Por √∫ltimo - <strong>tente n√£o usar entidades globais por dentro</strong> .  Cada plataforma possui alguns componentes globais.  √â aconselh√°vel n√£o arrast√°-los para a sua biblioteca.  Isso parece √≥bvio porque √© um objeto global, e os usu√°rios da sua biblioteca podem peg√°-lo e configur√°-lo como quiserem.  Voc√™ o usa na sua biblioteca, precisa salvar de algum modo seu estado, reconfigurar e restaurar o estado.  Existem muitas nuances e h√° onde cometer um erro.  Lembre-se disso e tente evitar. <br><br>  Por exemplo, no SpeechKit, antes da terceira vers√£o, trabalhamos com √°udio dentro da biblioteca e configuramos e ativamos explicitamente a sess√£o de √°udio.  Uma sess√£o de √°udio no iOS √© algo que todo aplicativo possui - n√£o diga que voc√™ n√£o tem um.  Ele √© criado no in√≠cio, √© respons√°vel pela intera√ß√£o do aplicativo e do daemon de m√≠dia do sistema e diz o que seu aplicativo deseja fazer com o √°udio.  Este √© um objeto singleton no sentido mais verdadeiro da palavra.  N√≥s o pegamos com calma, configuramos conforme necess√°rio, mas isso levou ao fato de que os usu√°rios tinham problemas menores, como alterar o volume do som.  Outro m√©todo de sess√µes de √°udio, respons√°vel por definir as configura√ß√µes, √© bastante longo.  Demora cerca de 200 ms, e isso √© um abrandamento percept√≠vel na ativa√ß√£o ou desativa√ß√£o. <br><br>  Na terceira vers√£o, peguei com alegria uma sess√£o de √°udio da biblioteca.  Depois disso, quase todos os usu√°rios de todos os servi√ßos que tinham o SpeechKit integrado disseram que estavam terrivelmente infelizes.  Agora eles devem saber que existe algum tipo de sess√£o de √°udio que precisa ser especialmente configurada para o nosso SpeechKit. <br><br><blockquote>  A conclus√£o √© a seguinte: mesmo assim, tente n√£o usar entidades globais, mas esteja preparado para o fato de que seus usu√°rios nem sempre ficar√£o felizes com suas decis√µes. <br></blockquote><br><h3>  Tornamos conveniente para os usu√°rios <br></h3><br>  De que outra forma voc√™ pode ajudar seus usu√°rios? <br><br><ul><li>  <strong>Adicionar logs: n√≠veis diferentes, inclus√£o din√¢mica</strong> . <br></li></ul><br>  A maneira mais f√°cil √© anexar um arquivo, cuja presen√ßa √© um modo de mega depura√ß√£o.  Realmente ajuda a depurar em uma situa√ß√£o em que seus usu√°rios t√™m usu√°rios com erro e voc√™ precisa entender o que exatamente aconteceu. <br><br><ul><li>  <strong>Suporte todas as vers√µes do sistema operacional do usu√°rio.</strong> <br></li></ul><br>  Lembre-se de que quando voc√™ fala sobre o suporte √† vers√£o em uma biblioteca, n√£o √© o mesmo que o suporte √† vers√£o em um aplicativo comum.  Em um aplicativo comum, analisamos as estat√≠sticas de que, por exemplo, apenas 2% de nossos usu√°rios usam o iOS 8, e isso significa que voc√™ pode parar de oferecer suporte ao iOS 8. Na biblioteca, n√£o √© assim. Recusar a vers√£o do sistema operacional significa abandonar completamente o usu√°rio e todos os usu√°rios.  Isso pode ser metade dos seus usu√°rios em princ√≠pio. <br><br>  Portanto, √© necess√°rio monitorar quais vers√µes s√£o usadas pelos aplicativos que usam sua biblioteca e, com base nisso, voc√™ j√° deve concluir se oferece suporte a algo ou n√£o.  N√£o recusamos o iOS 7 por um longo tempo. Parece-me que j√° havia pessoas que abandonaram o iOS 8 e estavam prontas para abandonar o iOS 9. Ainda apoiamos o iOS 7, porque t√≠nhamos um navegador que at√© o fim mantinha todos os usu√°rios, e trabalhamos em estreita colabora√ß√£o com ele e n√£o conseguimos deix√°-lo em tal situa√ß√£o. <br><br>  Novamente, seus usu√°rios n√£o dir√£o: ‚ÄúVamos desativar essa funcionalidade na vers√£o que n√£o a suporta‚Äù, n√£o, eles simplesmente remover√£o sua biblioteca e encontrar√£o uma que suporte toda a s√©rie de vers√µes. <br><br><ul><li>  <strong>Adicione incremento m√≠nimo em novas vers√µes.</strong> </li></ul><br>  Isso √© muito "n√£o muito" para desenvolvedores de bibliotecas.  Quero liberar tudo o que est√° pronto para lan√ßamento.  Voc√™ criou recursos, corrigiu bugs - agora colocaremos o pacote inteiro e o lan√ßaremos no lan√ßamento.  A libera√ß√£o tamb√©m √© um processo.  Isso n√£o √© verdade para seus usu√°rios.  Quando eles est√£o testando seu produto e preparando-o para libera√ß√£o, eles n√£o desejam receber de voc√™ um assembly com novos recursos que precisam de testes adicionais. <br><br>  Realmente tivemos casos em que revertemos alguns lan√ßamentos, os dividimos em partes e os lan√ßamos j√° em peda√ßos.  Ent√£o, as equipes para as quais implementamos altera√ß√µes podem ter exatamente a vers√£o em que h√° pequenas altera√ß√µes, e n√£o todas de uma vez. <br><br><blockquote>  Isso realmente n√£o √© muito conveniente para o desenvolvimento, mas o incremento m√≠nimo de vers√µes tornar√° seus usu√°rios um pouco mais felizes. <br></blockquote><br><h3>  Nunca h√° muitos testes <br></h3><br>  Isso vale tanto para um aplicativo regular quanto para uma biblioteca.  Mas no caso da biblioteca novamente, existem recursos. <br><img src="https://habrastorage.org/webt/jk/1n/gb/jk1ngbzjsq3q-9vrkndir038u2w.jpeg"><br>  Certamente, s√£o necess√°rios <strong>autotestes</strong> , mas al√©m deles √© √≥timo ter um <strong>aplicativo de teste</strong> para sua biblioteca.  Isso o ajudar√° a integrar o que voc√™ escreveu e a entender quais problemas ou armadilhas podem surgir.  Voc√™ pode sentir por si mesmo quais s√£o seus usu√°rios. <br><br>  Se sua biblioteca, de alguma forma, interage com a rede, inclui criptografia, h√° pelo menos algo relacionado a dados e seguran√ßa, entregue a <strong>seguran√ßas</strong> para <strong>verifica√ß√£o</strong> .  Voc√™ absolutamente n√£o quer ser a biblioteca na qual eles encontram a vulnerabilidade - √© um estigma para a vida toda.  Quase todas as grandes empresas t√™m um departamento inteiro que lida com a verifica√ß√£o de seguran√ßa dos produtos - entregue a eles.  Se voc√™ n√£o possui uma, h√° <strong>uma auditoria externa</strong> .  Se voc√™ n√£o puder pagar pelo externo, encontre os testes na rede, execute-os, verifique se a sua biblioteca n√£o permite vazamento de dados do usu√°rio. <br><br>  A √∫ltima coisa que √© muito importante nos testes √©, desde o in√≠cio, tentar adicionar <strong>medidas de tudo o que √© poss√≠vel</strong> : tempo, consumo de energia, tudo o que √© t√≠pico para sua biblioteca em particular.  Voc√™ ainda precisa fazer isso no final, por que n√£o pensar em medidas desde o in√≠cio. <br><br>  Isso n√£o protege contra altera√ß√µes e da necessidade de acelerar a biblioteca, mas ajuda a descobrir o que deu errado.  Se voc√™ tiver gr√°ficos, isso ajudar√° no monitoramento em tempo real de quais funcionalidades adicionaram atrasos ou aumento no consumo de energia. <br><br>  Quase nunca h√° tempo para isso, porque essa n√£o √© a funcionalidade da biblioteca, n√£o √© para isso que voc√™ a est√° desenvolvendo.  Mas √© isso que ajuda a mant√™-lo em boas condi√ß√µes e em boa qualidade. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> voc√™ pode ler como n√≥s, na Yandex, medimos o consumo de energia de dispositivos m√≥veis.  Sobre as medi√ß√µes de tempo foi uma hist√≥ria engra√ßada.  Como desenvolvedores de bibliotecas, √© dif√≠cil medir o comportamento em casos espec√≠ficos, porque nem todos os scripts do SpeechKit s√£o usados ‚Äã‚Äãpor todas as equipes.  At√© o momento, usamos nosso aplicativo de teste.  Casos especiais de uso foram escritos, por exemplo, um reconhecedor ou componentes para s√≠ntese de fala, todas as etapas foram gravadas e os registros foram salvos e, como resultado, gr√°ficos interessantes foram constru√≠dos. <br><br>  Tudo ficaria bem, mas trabalhamos com √°udio e, para verificar tudo, em certos casos a faixa de √°udio realmente √© reproduzida.  Al√©m disso, √© necess√°rio fazer muitas medi√ß√µes, para que eles deixem o teste para a noite: coloque os alto-falantes, coloque algum tipo de dispositivo ao lado e inicie os arquivos de √°udio.  De manh√£, tudo desligou, na noite seguinte repetiu e depois novamente.  N√£o se tratava de algumas criaturas m√°gicas que andavam pelo escrit√≥rio - apenas os limpadores estavam assustados.  Havia realmente um texto muito estranho que era lido em intervalos. <br><br>  Como resultado, foi decidido fazer um banco de testes local, que chamamos de Gabinete.  Este √© um gabinete natural, apenas √† prova de som.  Ele cont√©m muitos dispositivos, um farm inteiro com dispositivos, cada um dos quais pode ser iniciado v√°rias vezes durante o dia √∫til, porque n√£o far√° mal a ningu√©m. <br><a name="deploy"></a><br><h2>  Lan√ßamento </h2><br>  Finalmente chegamos √† √∫ltima parte importante - este √© o lan√ßamento.  O c√≥digo est√° escrito, uma boa API foi projetada para torn√°-lo conveniente para os usu√°rios.  Como agora para liberar tudo isso em lan√ßamento. <br><br>  Come√ßarei com lan√ßamentos locais para usu√°rios dentro do Yandex.  O esquema aqui √© o mesmo que no desenvolvimento de um aplicativo regular: lan√ßamentos regulares, mensais ou semanais. <br><img src="https://habrastorage.org/webt/by/kz/vj/bykzvjvcxhseq5viva1mcy8gwno.jpeg"><br>  O processo consiste nas etapas usuais, mas ao desenvolver uma biblioteca, cada um desses pontos tem suas pr√≥prias caracter√≠sticas. <br><br><h3>  Planejamento <br></h3><br>  Para mim, essa √© a parte mais dolorosa, porque a biblioteca possui v√°rias equipes de produtos.  Em um aplicativo regular, h√° um gerente de produto que define tarefas que a equipe prioriza e come√ßa a executar uma por vez. <br><br>  Se houver v√°rias equipes de produtos, cada uma delas receber√° solicita√ß√µes que devem ser processadas em tempo real.  Vou dar conselhos: se houver uma pessoa que saiba lidar com uma infinidade de tarefas em um momento, tente busc√°-la em sua equipe.  Porque deve haver algu√©m entre todos os gerentes externos e o desenvolvimento - aquele que assumir√° a funcionalidade para priorizar tarefas. <br><br>       SpeechKit ,        , , .  ,    ,  -         .       ,       ‚Äî   .    ,      n .        ,      .          ,         ,    -   . <br><br><h3>  <br></h3><br> ,    ,     :   , ,      .     Agile-      . <br><br>  ,     ,  ,    ‚Äî .    ,       .     ! <br><br>     <strong>Scrum</strong> .   ,      ,  ,   .           .   ¬´ ¬ª,          . <br><br> Scrum  ,    ,  ,  ‚Äî      ‚Äî       , .     .      ‚Äî      ,        - . ,     ?  ,      : ¬´,         ,    ,         ¬ª.  ,       ,   - ,      ,  Scrum  .    ! ,       . <br><br>       .    ,     ,      .   ,      .     ,    , ,     ,       .      ,       .     . <br><br><h3>  <br></h3><br>  ,      ‚Äî     ,      -   . ,  ,      ,      ,    .  ,       .      : ¬´     4,     3 ‚Äî    ¬ª.     ,     .    -    , ,    ,  <strong>    </strong> ,   . <br><br>     ‚Äî <strong>     </strong> .  Continuous Integration ,              ,   ,   <strong>  </strong> . <br><br><h3>   <br></h3><br>   ,       .    . <br><br> 1. <strong> .</strong> <br><br>    ‚Äî       <strong>  </strong> .     -      -  ,  , ,      .      . <br><br> <strong>   </strong>      .      ,   ‚Äî  , , , ,  .     ,    ,    -  . <br><br> 2. <strong> .</strong> <br><br>       ,  ,   ,   ‚Äî ,      ,  ,    ,    ,    ! <br><br>    .  , <strong>   </strong> .        ,  ,    -,     . <br><br>        ‚Äî <strong>   </strong> .       SpeechKit   .  ,  ,    ‚Äî ,   - .      ‚Äî   ,   -     . <br><br>  , <strong>    </strong> .     ,    4    2, ,        .         ,     -,      ,     . <br><br>  ‚Äî <strong>   </strong> .   ,  ,    ,     . <br><br><h2> . .  <br></h2><br>   ,     -,     .    <strong>  </strong> .      ,    , ,  help  ,    . <br><img src="https://habrastorage.org/webt/a8/ip/yi/a8ipyiozxkbcgk_-fr0fuk8a9hi.jpeg"><br>  <strong> </strong> .     :  -,     GitHub,    , .  ‚Äî ,   ‚Äî  .          ,       ,   . <br><br>    <strong> </strong> ,    ,   -       ,    ,   .. <br><br><h2>   <br></h2><br>  ,     ,    : <br><br><ul><li> <strong>.</strong>    ,        .   -   ,    ,    . <br></li><li> <strong></strong> .      ,      .      ,  OpenSource ,  ,    ,    ,      . </li><li> <strong>.</strong> ,       .        ,   ,     .    .     SpeechKit      . <br></li></ul><br><h1>  Sum√°rio <br></h1><br><ul><li>      ,     API. <br></li><li>  ,     ,       . <br></li><li>        . <br></li><li>   ,      -    :)    - ,     . <br></li></ul><br> Yandex.SpeachKit  GitHub  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">iOS</a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Android</a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> Mobile SDK. <br><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AppsConf</a> ‚Äî       ‚Äî    <b>22  23  2019 </b> ,      ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>  . <br><br>          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  . , ,     . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429912/">https://habr.com/ru/post/pt429912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429898/index.html">DMS (Dealership Management System) - Implementa√ß√£o de EcoSystems de informa√ß√£o para gerenciar redes de revendedores</a></li>
<li><a href="../pt429902/index.html">Page Rank na Era da Web 2.0 - Parte 1</a></li>
<li><a href="../pt429904/index.html">Hist√≥rias engra√ßadas e tristes sobre o desenvolvimento de jogos de computador</a></li>
<li><a href="../pt429908/index.html">Como usar corotinas na comida e dormir tranquilamente √† noite</a></li>
<li><a href="../pt429910/index.html">AppsConf Rises</a></li>
<li><a href="../pt429914/index.html">OpenSceneGraph: Gr√°fico de cena e ponteiros inteligentes</a></li>
<li><a href="../pt429916/index.html">Como construir e construir</a></li>
<li><a href="../pt429918/index.html">Mundo virtual Intel. Parte 2: SMP</a></li>
<li><a href="../pt429920/index.html">Tragicomedy em NaN age: como criamos um jogo em JS e o lan√ßamos no Steam</a></li>
<li><a href="../pt429922/index.html">Como transformar um projeto simples em uma constru√ß√£o de longo prazo ou cortar todos os itens desnecess√°rios</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>