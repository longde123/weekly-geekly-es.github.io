<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🏫 ☝🏽 🙇🏼 Vulnérabilités critiques multiples de Symantec / Norton Antivirus 🤞🏻 🤦🏼 🕥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un exploit fonctionnel a été publié pour toutes les versions d'antivirus. Le fait d'emprunter du code sous la GPL est révélé
 
 
 Hier, Tavis Ormandy ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vulnérabilités critiques multiples de Symantec / Norton Antivirus</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395547/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exploit fonctionnel a été publié pour toutes les versions d'antivirus. </font><font style="vertical-align: inherit;">Le fait d'emprunter du code sous la GPL est révélé</font></font></h3><br>
<img src="https://habrastorage.org/files/bf8/e9c/a2b/bf8e9ca2bd75423b977548077c4710b8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier, Tavis Ormandy du pirate Project Zero de Google a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publié un accès ouvert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à de nombreuses vulnérabilités dans les programmes antivirus Symantec, y compris les vulnérabilités d'exécution de code à distance. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certains experts disent que le programme antivirus installé sur l'ordinateur, compte tenu de son niveau de privilège maximal dans le système, peut devenir un vecteur d'attaque supplémentaire, c'est-à-dire une violation supplémentaire de la sécurité globale du système. L'exemple Symantec le démontre aussi clairement que possible. Dans certains cas, sous Windows, du code malveillant est chargé directement dans le noyau du système d'exploitation, ce qui endommage la mémoire du noyau.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les programmes Symantec utilisent le même noyau, donc les méthodes décrites fonctionnent pour tous les programmes Symantec, y compris les antivirus vendus sous la marque Norton. </font><font style="vertical-align: inherit;">Parmi eux:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norton Security, Norton 360 et autres produits Norton hérités (toutes les plates-formes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Endpoint Protection (toutes versions, toutes plates-formes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Email Security (toutes les plateformes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection Engine (toutes les plates-formes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection pour serveurs SharePoint</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et d'autres</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy de Project Zero a dévoilé des exemples de certaines vulnérabilités, afin que tout le monde comprenne l'essence du problème. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas des antivirus, le problème est de savoir comment ils analysent les fichiers exécutables empaquetés par des packers comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour analyser ces fichiers, les antivirus utilisent des décompresseurs de fichiers spéciaux pour remettre le fichier dans sa forme d'origine. Cela aide avec les packers standard, mais pour le reste, vous devez recourir à l'émulation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy écrit que toutes ces méthodes sont inutilement complexes et extrêmement vulnérables, car il est très difficile de sécuriser un tel code. «Nous vous recommandons d'utiliser le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bac à sable</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cycle de vie du développement de la sécurité</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mais les vendeurs font souvent des économies ici », écrit Thevis. </font><font style="vertical-align: inherit;">De ce fait, les déballeurs deviennent une énorme source de vulnérabilités, comme c'était déjà le cas avec </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comodo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaspersky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fireeye</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bien d'autres</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le cas de Symantec, la situation est encore pire, car dans ses programmes, les </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déballeurs fonctionnent dans le noyau</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par exemple, son </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">décompresseur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">ASPack</font></a><font style="vertical-align: inherit;"> permet un débordement de tampon trivial si la valeur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SizeOfRawData est</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> supérieure à </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SizeOfImage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Lorsque cela se produit, Symantec transfère les octets "supplémentaires" vers le tampon en utilisant</font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En conséquence, nous pouvons facilement exécuter du code arbitraire pour une exécution au niveau du noyau en utilisant cette méthode:</font></font><br>
<br>
<pre><code class="hljs lisp">    char *buf = malloc(<span class="hljs-name"><span class="hljs-name">SizeOfImage</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span><font></font>
<font></font>
    memcpy(<span class="hljs-name"><span class="hljs-name">&amp;buf</span></span>[DataSection-&gt;VirtualAddress],<font></font>
           DataSection-&gt;PointerToRawData,<font></font>
           SectionSizeOnDisk)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La vulnérabilité CVE-2016-2208 est décrite plus en détail dans le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">traqueur de bogues</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sur les systèmes d'exploitation Linux, macOS et Unix, cela conduit à un débordement propre au niveau racine dans le processus Symantec ou Norton, et sur Windows, il provoque une corruption de la mémoire du noyau. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que Symantec utilise un pilote spécial pour intercepter toutes les interruptions du système, pour exploiter la vulnérabilité, envoyez simplement à la victime un fichier par e-mail ou un lien d'exploitation. La victime n'a pas besoin d'ouvrir le fichier ou de suivre le lien, l' </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">antivirus fera tout par lui-même</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cela permet même au ver de se propager automatiquement à tous les systèmes avec l'antivirus Symantec / Norton installé!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, vous pouvez facilement infecter un grand nombre d'ordinateurs dans le réseau local de l'entreprise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est curieux qu'avant de publier les informations dans le domaine public, Tavis Ormandy ait envoyé un exploit au service de sécurité par e-mail dans une archive zip protégée par mot de passe, et le mot de passe était indiqué dans le texte de la lettre. Mais le serveur de messagerie avec les «fonctions de sécurité» installées Symantec a extrait le mot de passe du texte du message, l'a appliqué à l'archive et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s'est écrasé</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en train d'étudier le code d'exploitation </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy parle également de vulnérabilités dans l'analyse des fichiers PowerPoint et d'autres fichiers Microsoft Office, ainsi que des vulnérabilités dans le moteur heuristique Bloodhound Heuristics (Advanced Heuristic Protection). Exploiter le code source </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publié</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il s'agit d'un exploit fonctionnant à 100% qui fonctionne contre les configurations standard de Norton Antivirus et Symantec Endpoint, et fonctionne </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniquement lorsque vous envoyez le lien par courrier ou publiez le lien sur une page Web</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (il n'a pas besoin d'être ouvert). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce cas, les produits suivants sont vulnérables (tous les programmes Symantec potentiellement vulnérables ne sont pas répertoriés ici, il est fort possible que l'exploit fonctionne également dans d'autres):</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norton Antivirus (Mac, Windows)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Endpoint (Mac, Windows, Linux, Unix)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Scan Engine (toutes les plates-formes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moteur de protection Symantec Cloud / NAS (toutes plates-formes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Email Security (toutes les plateformes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection pour SharePoint / Exchange / Notes / etc (toutes les plateformes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous les autres programmes Symantec / Norton Carrier, Enterprise, SMB, Home et autres antivirus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et d'autres</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous Windows, cela conduit à l'exécution de code au niveau SYSTEM, dans d'autres systèmes d'exploitation avec des privilèges root. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certains programmes de Symantec ne sont pas mis à jour automatiquement, les administrateurs système doivent donc prendre des mesures urgentes pour protéger leurs réseaux. </font><font style="vertical-align: inherit;">Les informations officielles de Symantec sont </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD </font><font style="vertical-align: inherit;">Comme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il est </font><font style="vertical-align: inherit;">apparu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Symantec a </font><font style="vertical-align: inherit;">emprunté le </font><font style="vertical-align: inherit;">code des bibliothèques open-source et libmspack unrarsrc - et les mettre à </font><font style="vertical-align: inherit;">jour au moins sept ans!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr395547/">https://habr.com/ru/post/fr395547/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr395537/index.html">Marquez-le</a></li>
<li><a href="../fr395539/index.html">Nous brassons de la bière en utilisant le module MP8036multi</a></li>
<li><a href="../fr395541/index.html">Une combinaison spatiale pour atterrir sur l'Europe et la Lune - que devrait-elle être? Entretien avec Lead Final Frontier Design Designer</a></li>
<li><a href="../fr395543/index.html">La Russie crée une base ouverte d'objets proches de la Terre</a></li>
<li><a href="../fr395545/index.html">Les archéologues de Novgorod ont découvert une ancienne malédiction russe inconnue</a></li>
<li><a href="../fr395549/index.html">Est-il vrai que l'humanité devient stupide?</a></li>
<li><a href="../fr395551/index.html">Blockchain - Nouveau Google</a></li>
<li><a href="../fr395555/index.html">Viv est une nouvelle ère d'assistants personnels. Entretien avec Doug Kittlaus, créateur de Siri</a></li>
<li><a href="../fr395557/index.html"># 2 Unité de contrôle du curseur vidéo</a></li>
<li><a href="../fr395559/index.html">Le vol Moscou-Sea of ​​Clarity est retardé</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>