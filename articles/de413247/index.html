<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåßÔ∏è üíñ üç± Warum Speichersysteme √ºberwachen? ü•û #‚É£ üíπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jemand wird bald fallen 

 Weil SHD das Allerheiligste speichert - Daten. Wenn keine Daten mehr verf√ºgbar sind, riechen sie sehr bald gebraten. Oder w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Warum Speichersysteme √ºberwachen?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/croc/blog/413247/"><img src="https://habrastorage.org/webt/ph/hp/en/phhpenviwwkomiriz7rmdco7blo.png"><br>  <i>Jemand wird bald fallen</i> <br><br>  Weil SHD das Allerheiligste speichert - Daten.  Wenn keine Daten mehr verf√ºgbar sind, riechen sie sehr bald gebraten.  Oder wenn der Ort pl√∂tzlich vorbei ist - auch eine unangenehme √úberraschung.  Daher sollte die √úberwachung obligatorisch sein und Speichersysteme abdecken. <br><br>  Es gibt zwei Hauptans√§tze zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberwachung der Speicherung</a> .  Verwenden Sie entweder ein universelles √úberwachungssystem wie Nagios, Icinga, das Informationen √ºber SNMP sammelt, oder kaufen Sie hochspezialisierte Software von den Herstellern der Speichersysteme selbst.  Nat√ºrlich bietet die zweite Option eine eingehendere Analyse des Eisenzustands und zeigt bestimmte Dinge wie den Zustand des Caches, den Iops, die Trefferquote, das Laden des Controllers usw. Diese Option wird am h√§ufigsten von unseren Kunden gew√§hlt, die gro√üe und teure Arrays im Einsatz haben. . <br><br>  √úbrigens ist mit kommerzieller √úberwachungssoftware nicht alles so reibungslos.  Im Detail werde ich weiter erz√§hlen.  Es wird sozusagen Erfahrung aus erster Hand sein.  Zu einer Zeit, fast 2 Jahre lang, habe ich ein solches System f√ºr viele tausend gr√ºne Papierst√ºcke eines ber√ºhmten Anbieters fertiggestellt.  Und er nahm es auf, so dass sogar die Unterst√ºtzung des Verk√§ufers anfing, sich mit mir zu beraten.  Aber einige Softwareprobleme wurden durch andere ersetzt, genauso wie einige Indianer aus dem Support durch neue Indianer ersetzt wurden - und dann kam mir die Idee, wenn √ºberhaupt nicht radikal zu handeln ... Im Allgemeinen fing alles damit an. <br><a name="habracut"></a><br><h3>  Was ist falsch an der Software des Anbieters? </h3><br>  Wie gesagt, die √úberwachung durch den Hersteller √ºberwacht die Speichersysteme desselben Herstellers perfekt.  Dies ist der Hauptvorteil.  Von hier aus wachsen die Nachteile: Arrays anderer Hersteller werden nur eingeschr√§nkt oder gar nicht unterst√ºtzt.  Es stellt sich heraus, dass Sie mehrere verschiedene √úberwachungstools ben√∂tigen, wenn Sie mehrere verschiedene Arrays in der Farm haben.  Ja, und vergessen Sie nicht, welche von was und wann Sie es das n√§chste Mal ansehen m√ºssen.  Idealerweise im Allgemeinen von admin f√ºr jedes Array. <br><br>  Es ist kein Geheimnis, dass Werkzeuge von Herstellerherstellern Geld kosten und ziemlich gro√ü sind.  Und die Verl√§ngerung des Supports kostet dann auch einen h√ºbschen Cent.  Und einige Anbieter haben einen neuen Fokus gemeistert: Sie k√ºndigen das Ende des Lebenszyklus ihrer Software an und bieten einfach an, ein anderes Produkt ohne Migration von Lizenzen zu kaufen.  Es war ein solches Setup, das erst vor ein paar Monaten bei einem unserer Kunden stattgefunden hat.  Es gibt keine Optionen: Wenn Sie die Hardware weiterhin √ºberwachen m√∂chten, t√§tigen Sie einen Neukauf. <br><br>  Wenn Sie die Software des Anbieters vertiefen, werden andere unangenehme Funktionen angezeigt.  Beispielsweise k√∂nnen Sie in einer Reihe von Produkten das aktuelle Statusbild sehen, aber Sie k√∂nnen den Verlauf f√ºr den vorherigen Zeitraum nicht sehen.  Oder die Geschichte ist begrenzt: Das Protokoll wird alle 3 Tage neu geschrieben.  Es besteht einfach keine Notwendigkeit, √ºber die Anh√§ufung von Statistiken zu sprechen.  Und h√§ufig wird die Ereignishistorie f√ºr Prognosen ben√∂tigt, z. B. f√ºr den Kauf von Ersatzteilen, f√ºr die Berichterstattung und f√ºr die Untersuchung von Vorf√§llen.  Zum Beispiel k√∂nnen die Bremsen in einem Gesch√§ftssystem auf das Speichersystem geschoben werden, und wenn es keine tats√§chlichen Daten gibt, gibt es nichts, hinter dem man sich verstecken k√∂nnte. <br><br>  Und schlie√ülich kann man sich nur √ºber die Geschwindigkeit von Updates und √Ñnderungen in der Anbietersoftware beschweren.  Oh, wie oft bin ich wegen meiner langen Praxis auf dieses Problem gesto√üen!  Neue Modelle von Arrays kommen heraus, neue Firmwares kommen heraus, neue Einstellungen erscheinen.  All dies unterbricht leicht die Arbeits√ºberwachung: Entweder werden keine Informationen mehr gesammelt, oder die Arrays fallen im Allgemeinen ab.  In einem neuen Mikrocode hat ein Hersteller die Unterst√ºtzung f√ºr alte SSL-Versionen deaktiviert, und die √úberwachungssoftware hat das TLS-Protokoll noch nicht unterst√ºtzt.  Und zuerst konnte niemand einen Grund finden.  Nach meiner eigenen Untersuchung habe ich diese Eingaben an den Hersteller gesendet und sie haben bereits die alten Bibliotheken aktualisiert.  Diese B√ºrokratie dauerte jedoch unbegrenzt. <br><br>  Und einmal haben wir den Piloten beim Kunden gescheitert.  Es wurde vorgeschlagen, Anbietersoftware zu verwenden, und dem Kunden gefiel alles in Bezug auf Funktionalit√§t und Benutzeroberfl√§che.  Leider wurden ihre wichtigsten Produktivsysteme nicht unterst√ºtzt.  Sie waren sogar bereit, ein oder zwei Monate zu warten, aber der Anbieter sagte, dass es keine Pl√§ne gibt, diese Systeme in naher Zukunft in den Support aufzunehmen (und dies war nur ein Update der Hitachi AMS-Linie auf HUS). <br><br>  Im Allgemeinen ziemlich viele Unannehmlichkeiten und aus irgendeinem Grund f√ºr viel Geld. <br><br><h3>  Vor langer Zeit habe ich keine Steine ‚Äã‚Äãabgeholt ... </h3><br>  Frustriert von diesem Zustand habe ich oft dar√ºber nachgedacht, wie ich meine eigene √úberwachung f√ºr die Speicherung implementieren kann.  Wenn Sie das Array gut kennen und dessen CLI besitzen, k√∂nnen Sie schnell die Informationen abrufen, die Sie √ºber den Status ben√∂tigen, oder den Problemen auf den Grund gehen.  Zuvor ist es nat√ºrlich notwendig, viele Docks, Rauchforen und Wissensdatenbanken von Anbietern zu schaufeln und st√ºckweise verschiedene Informationen zu erhalten.  Aber wenn Sie wissen, welchen Befehl Sie mit welchem ‚Äã‚ÄãSchl√ºssel eingeben m√ºssen und was jede Ausgabespalte bedeutet, sind Sie bereits ein Guru.  Es blieb, dieses Wissen in eine bequeme Oberfl√§che zu integrieren, die weiterhin alles f√ºr Sie tun wird. <br><br>  Ich gebe zu, dass ich zuerst geplant hatte, die Benutzeroberfl√§che auch von Grund auf neu zu schreiben, aber dann bin ich auf Zabbix gesto√üen - ein ausgereiftes Tool mit einer gro√üen Community, das auch leicht zu erweitern ist.  Es hatte alles, was ich brauchte: eine Schnittstelle, ein Vorbild, Benachrichtigungen, ein Triggersystem, Proxy-Client-Agenten.  Es blieb nur f√ºr diesen M√§hdrescher, Informationen √ºber Speichersysteme und Schwellenwerte verschiedener Parameter korrekt bereitzustellen.  Der Fall begann zu kochen.  Wir haben ein Team von Spezialisten f√ºr Arrays.  Nat√ºrlich ist es unm√∂glich, alle Arrays von einer Person zu kennen, daher sind wir nach Modell und Hersteller unterteilt. <br><br>  Eine weitere Schwierigkeit bei der Entwicklung Ihrer eigenen √úberwachung ist die M√∂glichkeit, auf die Eisenst√ºcke selbst zuzugreifen, sodass sie immer noch keine Angst haben, alle Arten von Experimenten zu laden, zu brechen und durchzuf√ºhren.  Gl√ºcklicherweise haben die Ressourcen unseres Labors all dies erm√∂glicht. <br><br>  Als erstes muss der Zustand aller Hardwarekomponenten √ºberwacht werden.  Etwas kann √ºber SNMP √ºbernommen werden, aber in den meisten F√§llen handelt es sich um eine Umfrage unter Verwendung eines speziellen Protokolls (SMI-S, REST-API, SOAP-API und andere).  Ich muss sagen, dass Sie mit den Arrays selbst Benachrichtigungen √ºber Ausf√§lle konfigurieren k√∂nnen.  Und alle Kunden nutzen dies zumindest.  Aber was passiert, wenn die Benachrichtigung selbst auf dem Array unterbrochen wird?  Dies geschah mehr als einmal, als das Array wochenlang still war und es allen so schien, als sei alles in Ordnung, es war still.  Und dann wurde pl√∂tzlich klar, dass eine kritische Anzahl von Festplatten darauf flog, aber es war bereits zu sp√§t. <br><br>  Der zweite wichtige Punkt, der √ºberwacht werden muss, ist die Leistung.  Denn wenn eine Leistung auf einem Speichersystem mit einer Aufzeichnungsverz√∂gerung von einigen Sekunden basiert, kann Oracle einfach auf und ab gehen.  Keine Ahnung.  Die Leistung in gro√üen Infrastrukturen mit vielen Speichersystemen wird am schlechtesten gesteuert.  Und Zabbix verf√ºgt √ºber eine √§u√üerst praktische Vorhersageanalyse: Basierend auf der Prognose k√∂nnen Sie den Wert der Metrik festlegen, der in Zukunft verwendet wird.  Zum Beispiel haben wir einen Ausl√∂ser erstellt, der funktioniert, wenn prognostiziert wird, dass nur noch 3 Monate f√ºr die aktuelle Entsorgung √ºbrig sind.  Oder zum Beispiel, dass die Reaktionszeit gem√§√ü der Prognose in 2 Wochen um 50 Millisekunden l√§nger sein wird.  Durch die √úberwachung haben wir Zeit, uns vorab √ºber anstehende Probleme zu informieren und bereits etwas zu tun. <br><br>  Irgendwann haben wir festgestellt, dass es nat√ºrlich gut ist, den Speicherstatus zu kennen, aber es ist viel besser zu verstehen, was sonst noch im Netzwerk und auf der Serverseite passiert.  Infolgedessen wurde es nach mehrmonatiger Arbeit m√∂glich, sowohl die Server als auch das Netzwerk und die Speichersysteme in einer Schnittstelle zu sehen.  Es erschienen nicht nur Plug-Ins und Konnektoren f√ºr die Speicherung, sondern auch eine n√ºtzliche Bindung in Form von Netzwerktopologiekarten.  Bisher ber√ºcksichtigt das Plugin nat√ºrlich unsere Erfahrung und unsere Bed√ºrfnisse, aber wenn Sie uns sagen, was Sie darin sehen m√ºssen, werden wir es verdrehen. <br><br><img src="https://habrastorage.org/webt/ut/cc/sz/utccszsrlpc89pbcvjqvzo5pr7y.png"><br>  <i>End-to-End-Topologie f√ºr VMware-Cluster: Von der virtuellen Maschine zum Speichervolumen</i> <br><br><img src="https://habrastorage.org/webt/tu/uv/nm/tuuvnmtm6hn04e1gs4oqtqzebjm.png"><br><img src="https://habrastorage.org/webt/8q/jc/g6/8qjcg65vrycqdrzzrlxbbfsrls8.png"><br>  <i>Leistung</i> <br><br>  In der Grafik zur Array-Leistung sehen wir, dass das System sehr stark √ºberlastet ist.  Eine hohe Auslastung der Festplattengruppen zeigt an, dass die Festplatten √ºberlastet sind.  Es gibt viele E / A-Vorg√§nge an den Speicherports, was bedeutet, dass IT-Systeme das Array f√ºr ihren Teil laden.  Nun, das charakteristische Diagramm der Reaktionszeit sowie die Verwendung von Prozessoren √ºber den empfohlenen Werten.  Urteil - Es wurden zu viele Aufgaben auf das Array gestellt, einige m√ºssen migriert werden. <br><br><img src="https://habrastorage.org/webt/5y/rj/_o/5yrj_osycqxzagfoddfq1y9rd5g.png"><br>  <i>Storage Network Map: Auffinden von Engp√§ssen</i> <br><br><h3>  Zusammenfassung </h3><br>  Was haben wir bekommen?  Wir haben das beliebte und weit verbreitete Zabbix-√úberwachungssystem mit neuen Funktionen ausgestattet, darunter: <br><br><ol><li>  Sammlung von Informationen zum Status aller Hardware und logischen Komponenten von Festplatten-Arrays und Switches des Speichernetzwerks. </li><li>  Leistungsstatistiken f√ºr absolut alle Systeme, f√ºr die wir Plugins erstellt haben (Anbieter haben diesbez√ºglich L√ºcken). </li><li>  Topologische Zuordnungen eines gemeinsam genutzten Speichernetzwerks und von Ende zu Ende von virtuellen Maschinen zu Volumes auf Speichersystemen (bisher nur f√ºr VMware). </li><li>  Sammlung aller Inventarinformationen. </li><li>  Die Menge an Speicherplatz. </li></ol><br>  Mit Zabbix selbst k√∂nnen Sie sehr coole Benachrichtigungen erstellen, Schwellenwerte festlegen und informative Briefe √ºber das Problem senden.  Wenn beispielsweise der Port am Switch ausf√§llt (oder der Datenverkehr am Port sehr gro√ü wird), enth√§lt die Nachricht nicht nur den Namen des Switches mit der Portnummer, sondern auch Informationen zum angeschlossenen Ger√§t. <br><br>  Welche Systeme unterst√ºtzen wir derzeit?  Viele verschiedene: <br><br><ol><li>  Alle Hitachi-Arrays (AMS, HUS, VSP, VSP G). </li><li>  Arrays Dell-EMC CLARiiON, VNX, Unity, ISILON, Compellent. </li><li>  HPE 3PAR-, P9500- und XP7-Arrays. </li><li>  Arrays von IBM Storwize, DS5000. </li><li>  Arrays NetApp FAS (7-Modus, C-Modus). </li><li>  HPE StoreOnce, EMC DataDomain-Festplattenbibliotheken. </li><li>  Brocade Silkworm Switches, Cisco MDS. </li></ol><br>  Wir haben auch Erweiterungen f√ºr einige Betriebssysteme (Windows, ESX), mit denen wir Daten √ºber FC HBA sammeln, um in Zukunft topologische Karten zu zeichnen.  Aktive Entwicklung von Plugins f√ºr OpenStack- und Virtualisierungssysteme. <br><br>  Bei der Entwicklung von Plug-Ins wird das Fachwissen unserer Ingenieure ber√ºcksichtigt, hinter denen es viele F√§lle gibt, in denen Probleme auf Arrays gel√∂st werden k√∂nnen - sowohl Hardware als auch Leistung.  Aufgrund der gro√üen Anzahl eigener fertiger Bibliotheken werden auf Anfrage in kurzer Zeit neue Plugins entwickelt. <br><br>  Einige unserer Kunden konfigurieren das System wie folgt: Benachrichtigungen mit der Vertragsnummer, Kontaktpersonen und allen Parametern der fehlerhaften Komponente werden automatisch an unsere Mail gesendet.  Dies reduziert die Reaktionszeit und die Bestellung der erforderlichen Ersatzteile, da der diensthabende Ingenieur auch nachts nicht viele Informationen anrufen und kl√§ren muss.  Die Anwendung geht sofort an die Arbeit. <br><br>  Wie l√∂sen Sie die Probleme bei der √úberwachung Ihrer Infrastruktur, insbesondere des Speichers?  Erz√§hlen Sie uns davon in den Kommentaren oder im Brief an die Mail VRyzhevsky@croc.ru </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413247/">https://habr.com/ru/post/de413247/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413237/index.html">Facebook bestreitet, dass Ger√§tehersteller dieselben Daten wie Entwickler Alexander Kogan senden</a></li>
<li><a href="../de413239/index.html">Wie man ein Smartphone etwas d√ºmmer macht</a></li>
<li><a href="../de413241/index.html">Abfangen von Funktionen im Linux-Kernel mit ftrace</a></li>
<li><a href="../de413243/index.html">School of Data: Wie man Mathematik und Wirtschaft kombiniert</a></li>
<li><a href="../de413245/index.html">Auf Dolby Atmos-Ger√§ten - nur "nativer" Sound. Dolby verbietet nicht native Upmixing</a></li>
<li><a href="../de413249/index.html">Schreiben eines Linux-Kernelmoduls: I2C</a></li>
<li><a href="../de413251/index.html">Polymerasekettenreaktion und Wladiwostok</a></li>
<li><a href="../de413253/index.html">Richard Hamming: Kapitel 21. Faseroptik</a></li>
<li><a href="../de413255/index.html">Richard Hamming: Kapitel 27. Ung√ºltige Daten</a></li>
<li><a href="../de413261/index.html">Wie die Suche funktioniert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>