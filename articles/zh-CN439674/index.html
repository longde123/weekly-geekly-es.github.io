<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✋🏽 📝 🏂🏽 强化深度学习：原始像素乒乓球 🔂 🧚 👨‍🎓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="这是一篇有关“强化学习”（RL）的早就应该发表的文章。 RL是一个很酷的话题！ 

 您可能知道，计算机现在可以自动学习玩ATARI游戏 （通过在入口获得原始游戏像素！）。 他们在围棋比赛中击败了世界冠军，虚拟的四足动物学会了跑步和跳跃 ，机器人学会了执行复杂的操纵任务，这些挑战挑战了显式编程。 事...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>强化深度学习：原始像素乒乓球</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439674/"> 这是一篇有关“强化学习”（RL）的早就应该发表的文章。  RL是一个很酷的话题！ <br><br> 您可能知道，计算机现在可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">自动学习玩ATARI游戏</a> （通过在入口获得原始游戏像素！）。 他们在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">围棋</a>比赛中击败了世界冠军，虚拟的四足动物学会了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">跑步和跳跃</a> ，机器人学会了执行复杂的操纵任务，这些挑战挑战了显式编程。 事实证明，没有RL，所有这些成就都是不完整的。 过去一年中，我对RL也很感兴趣：我与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Richard Sutton的</a>书<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">（大约参考：已替换）一起工作</a> ，阅读了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">David Silver的</a>课程， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">参加了John Schulman的讲座</a> ，编写<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了关于Javascript的RL库</a> ，并于夏天在DeepMind进行了实习， DeepRL是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OpenRL Gym</a>的最新开发工具，是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OpenAI Gym</a>的最新开发工具。 因此，我当然已经参加了至少一年的浪潮，但仍然没有费心去写关于RL为什么如此重要，它是什么意思以及它如何发展的注释。 <br><br><img src="https://habrastorage.org/webt/vr/ir/gu/vrirgukar82fw0cg6wbnsklagum.png"><br>  <i>使用深度Q学习的示例。</i>  <i>从左到右：神经网络扮演ATARI，神经网络扮演AlphaGo，机器人折叠乐高玩具，虚拟四足动物围绕虚拟障碍物奔跑。</i> <br><a name="habracut"></a><br> 反思RL近期进展的性质很有趣。 我想指出影响AI发展的四个独立因素： <br><br><ol><li> 计算速度（GPU，ASIC专用设备，摩尔定律） </li><li> 可用形式的足够数据（例如ImageNet） </li><li> 算法（研究和思路，例如backprop，CNN，LSTM） </li><li> 基础架构（Linux，TCP / IP，Git，ROS，PR2，AWS，AMT，TensorFlow等）。 </li></ol><br> 就像在计算机视觉中一样，RL的进步也在不断发展……尽管看起来并不像看起来那么快。 例如，在计算机视觉中，AlexNet 2012神经网络是1990年代ConvNets神经网络的深度和宽度版本的增加。 同样，ATARI Deep Q-Learning 2013是标准Q-Learning算法的实现，您可以在Richard Sutton的1998年经典著作中找到它。 此外，AlphaGo使用策略梯度技术，而蒙特卡洛树搜索（MCTS）也是旧思想或其组合。 当然，要使它们起作用，需要大量的技能和耐心，并且已经在旧算法的基础上开发了许多棘手的设置。  <b>但大致上，近期进展的主要驱动力不是新的算法和思想，而是计算量的增加，足够的数据和成熟的基础架构。</b> <br><br> 现在回到RL。 许多人无法相信我们可以教计算机如何使用从头开始的原始像素并使用相同的自学习算法来在人类水平上玩ATARI游戏。 同时，每次我感觉到差距–看起来多么神奇，以及它真正的内在多么简单。 <br><br> 我们使用的基本方法实际上很愚蠢。 尽管如此，我想向您介绍Policy Gradient（PG）技术，这是目前解决RL问题的我们最喜欢的默认选择。 您可能很好奇，为什么我无法想象DQN，DQN是一种替代且知名度更高的RL算法，也用于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ATARI训练中</a> 。 事实证明，尽管Q学习是众所周知的，但它并不是那么完美。 大多数人都选择使用Policy Gradient，包括原始<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DQN文章</a>的作者，他们已经表明，通过良好的调整，Policy Gradient的性能甚至优于Q-Learning。  PG更可取，因为它很明确：有明确的政策和连贯的方法可以直接优化预期的回报。 例如，我们将学习如何玩ATARI Pong：从头开始，从原始像素到带有神经网络的Policy Gradient。 我们将所有这些放入130行Python中。  （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">要点链接</a> ）让我们看看这是如何完成的。 <br><br><img src="https://habrastorage.org/webt/yy/fk/hg/yyfkhg3xutt4gsualf7l6o0sa4i.gif"><br><img src="https://habrastorage.org/webt/mw/rq/2w/mwrq2wthkobnxuqohcfovs1lgei.jpeg"><br>  <i>上图：乒乓球。</i>  <i>下图：作为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Markov决策过程（MDP）</a>特例的乒乓演示：图形的每个顶点对应于游戏的某个状态，并且边线确定过渡到其他状态的概率。</i>  <i>每个肋骨也确定奖励。</i>  <i>目标是找到从任何州获得最大回报的最佳途径</i> <br><br> 打乒乓球是RL挑战的一个很好的例子。 在ATARI 2600版本中，我们将自己打一个球拍。 另一个球拍由内置算法控制。 我们需要击球，以便其他球员没有时间击球。 希望没有必要解释什么是乒乓球。 在较低的级别上，游戏的工作方式如下：我们得到一个图像帧-字节数组210x160x3，并决定是否要向上或向下移动球拍。 也就是说，我们只有两种选择来管理游戏。 每次选择后，游戏模拟器都会执行动作并给予我们奖励：如果球超过了对手的球拍，则+1奖励；如果我们错过球，则为-1。 否则为0。当然，我们的目标是移动球拍，以使我们获得尽可能多的回报。 <br><br> 在考虑解决方案时，请记住，我们将对乒乓做出很少的假设，因为它在实践中并不是特别重要。 在大型任务中，例如操纵机器人，组装和导航，我们要考虑更多的事情。  Pong只是一个有趣的玩具测试用例，我们在玩这个游戏的过程中发现了如何编写非常通用的AI系统，该系统一天可以执行任意有用的任务。 <br><br>  <b>神经网络作为RL策略</b> 。 首先，我们将确定我们的参与者（或“代理商”）执行的所谓政策。  （（*）“代理商”，“环境”和“代理商政策”是RL理论的标准术语）。 在我们的案例中，策略功能是神经网络。 她将在入口处接受游戏的状态，然后在出口处决定要做什么-上下移动。 作为我们最喜​​欢的简单计算模块，我们将使用两层神经网络，该网络将获取原始图像像素（总计100,800个数字（210 * 160 * 3）），并生成一个数字，指示将球拍向上移动的可能性。 请注意，随机策略的使用是标准的，这意味着我们仅产生向上运动的概率。 为了获得实际的移动，我们将使用此概率。 当我们谈论培训时，其原因将变得更加清楚。 <br><br><img src="https://habrastorage.org/webt/cm/n4/ap/cmn4apvesxvu5d8konqytnbk0cm.png"><br>  <i>我们的政策功能包括2层全连接神经网络</i> <br><br> 更具体地说，假设在输入处得到一个向量X，它包含一组预处理像素。 然后我们必须使用python \ numpy计算： <br><br><pre><code class="python hljs">h = np.dot(W1, x) <span class="hljs-comment"><span class="hljs-comment"># compute hidden layer neuron activations h[h&lt;0] = 0 # ReLU nonlinearity: threshold at zero logp = np.dot(W2, h) # compute log probability of going up p = 1.0 / (1.0 + np.exp(-logp)) # sigmoid function (gives probability of going up)</span></span></code> </pre> <br> 在此片段中，W1和W2是我们随机初始化的两个矩阵。 我们不使用偏见，因为我们想要。 请注意，最后我们使用了S形的非线性，这将输出概率降低到[0,1]范围。 直观地讲，隐藏层中的神经元（权重位于W1中）可以检测各种游戏场景（例如，球在顶部，而我们的球拍在中间），然后W2中的权重可以决定在每种情况下我们是否应该上升或下降。 当然，最初的随机W1和W2首先会在我们的神经播放器中引起痉挛和抽搐，这使他在飞机的控制上等同于自闭症。 因此，现在唯一的任务就是找到W1和W2，从而开发出出色的游戏！ <br><br> 关于像素预处理的一句话-理想情况下，您需要将至少2帧传输到神经网络，以便它可以检测运动。 但是为了简化这种情况，我们将应用两个帧的差。 也就是说，我们将减去当前帧和前一帧，然后将差值应用于神经网络的输入。 <br><br>  <b>听起来好像是不可能的事情。</b> 在这一点上，我希望您了解RL问题的复杂性。 我们得到100800个数字（210x160x 3），并将其发送到我们的神经网络，该神经网络将实施玩家的政策（顺便说一下，在矩阵W1和W2中轻松包含了大约一百万个参数）。 假设我们在某个时候决定上升。 游戏模拟器可以回答，这次我们将获得0个奖励，并为下一帧再提供100 800个数字。 在获得非零奖励之前，我们可以重复此过程数百次！ 例如，假设我们最终获得了+1奖励。 这太好了，但是我们怎么能说-是什么导致的呢？ 这是我们刚才所做的动作吗？ 还是后退76帧？ 或者，也许这首先与第10帧相关联，然后我们在第90帧做了正确的事情？ 以及我们如何找出-数以百万计的“笔”中的哪一个可以扭曲，以便在将来获得更大的成功？ 我们称此为确定某些动作的置信系数的任务。 在乒乓球的特定情况下，我们知道如果球超过了对手，我们将得到+1。 真正的原因是我们无意中将球沿着良好的路线踢了几帧，而随后执行的每个动作都丝毫不影响它。 换句话说，我们面临着一个非常复杂的计算问题，并且一切看起来都令人沮丧。 <br><br>  <b>与老师一起训练。</b> 在深入探讨政治梯度之前，我想简要回顾一下与老师一起进行教学的原因，因为正如我们将看到的那样，RL非常相似。 请参考下表。 在与老师的常规教学中，我们将图像传输到网络，并在输出中接收有关课程的一些数字概率。 例如，在我们的案例中，我们有两个类：UP和DOWN。 我使用对数概率（-1.2，-0.36）而不是30％和70％格式的概率，因为我们优化了正确类别（或标签）的对数概率。 因为对数是单调的，所以这使数学计算更加优雅，并且等效于优化概率。 <br><br> 与老师一起训练时，我们将立即获得正确的课程（标签）。 在训练阶段，尽管神经网络可能会有所不同，但是他们会确切地告诉我们现在需要采取什么正确的步骤（假设它是UP，标号0）。 因此，我们计算梯度 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-9" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></span></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">（</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;"> y </font></span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">U </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;">P </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;">x </font></span><span class="MJXp-mrow" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">）</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-22">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.373ex" height="2.419ex" viewBox="0 -780.1 13077.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-61" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-62" x="1380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6C" x="1809" y="0"></use><g transform="translate(2108,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-57" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6C" x="3728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6F" x="4027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-67" x="4512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-70" x="4993" y="0"></use><g transform="translate(5496,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-79" x="6326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMAIN-3D" x="7102" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-55" x="8158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-50" x="8925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6D" x="9927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="10805" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-64" x="11151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-78" x="11674" y="0"></use><g transform="translate(12247,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ nabla_ {W} \ log p（y = UP \ mid x）</script> 调整网络设置。 该梯度仅告诉我们如何更改数百万个参数中的每个参数，以使网络在相同情况下更有可能预测UP。 例如，网络中的一百万个参数之一可以具有-2.1的梯度，这意味着如果我们将此参数增加一个小的正值（例如0.001），则UP的对数概率将减少2.1 * 0.001。  （由于负号而减少）。 如果我们应用渐变，然后使用反向传播算法更新参数，那么是的，当我们的网络将来看到相同或非常相似的图像时，将给出较高的UP概率。 <br><br><img src="https://habrastorage.org/webt/-p/r6/bu/-pr6bumeyrk2xdf9nuoulm5oflw.png"><br><br>  <b>政治学的梯度（PG）</b> 。 是的，但是如果我们没有正确的强化训练标签，我们该怎么办？ 这是PG的解决方案（请再次参考下图）。 我们的神经网络计算出上升30％（logprob -1.2）和下降7％（logprob -0.36）的概率。 现在，我们从此分布中进行选择，并指定要执行的操作。 例如，他们选择DOWN，然后将此动作发送到游戏模拟器。 此时，请注意一个有趣的事实：我们可以像在与老师一起教课时那样立即计算并应用DOWN动作的坡度，从而使网络将来更有可能执行DOWN动作。 因此，我们可以立即欣赏并记住该梯度。 但是问题是，目前我们还不知道-下降是否很好？  <b>但是最有趣的是，我们可以稍等片刻，然后再应用渐变！</b> 在Pong中，我们可以等到游戏结束，然后获取我们获得的奖励（如果我们赢了，则为+1，如果我们输了，则为-1），然后将其输入作为渐变的因数。 因此，如果我们为DOWN概率引入-1并进行反向传播，我们将重建网络参数，以便将来在遇到相同图像时执行DOWN动作的可能性较小，因为采用此动作会使我们输掉比赛。 也就是说，我们将需要以某种方式记住游戏的一个情节中的所有动作（神经网络的输入和输出），并基于此阵列，以与老师教学几乎相同的方式扭曲神经网络。 <br><br><img src="https://habrastorage.org/webt/hj/jr/tg/hjjrtgpmkweozlnidrhixsf7jfs.png"><br><br> 这就是所需要的：我们有一个随机的政策来选择行动，然后在将来，鼓励最终导致良好结果的行动，而不鼓励导致不良结果的行动。 此外，如果我们最终赢得比赛，奖励甚至不应为+1或-1。 它可以是具有相同含义的任意值。 例如，如果一切顺利，则奖励可能是10.0，然后我们将其用作渐变以开始反向传播反向传播。 这就是神经网络的美。 使用它们似乎是一个骗局：您可以在1万亿次运算中内置100万个参数，并且可以使程序学习使用随机梯度下降（SGD）进行任意操作。 它不应该起作用，但是有趣的是我们生活在一个可以起作用的宇宙中。 <br><br> 如果我们玩简单的棋盘游戏，例如跳棋，那么顺序将大致相同。 与minimax或alpha-beta裁剪算法有明显区别。 在这些算法中，程序将向前迈出几步，了解游戏规则，并分析数百万个位置。 在RL方法中，仅分析实际执行的动作。 同时，神经网络并不期待，因为它对游戏规则一无所知。 <br><br>  <b>锻炼顺序详细。</b> 我们用W1，W2创建和初始化一个神经网络，并玩100局傍晚游戏（我们称其为“政治，政策出台的“磨合”）。 假设每个游戏包含200帧，那么我们总共做出100 * 200 = 20,000个决定上升或下降。 对于每种解决方案，我们都知道一个梯度，该梯度告诉我们在将来要在这种状态下鼓励或禁止该解决方案时应如何更改参数。 现在剩下的就是标记我们做出的每个决定是好是坏。 例如，假设我们赢了12场比赛而输了88场。我们将对获胜游戏做出的所有200 * 12 = 2400个决定，并做出积极的更新（为每个动作填充+1.0渐变，执行反向传播并更新参数鼓励我们在所有这些情况下选择的行动）。 然后，我们将在输掉比赛中做出其他200 * 88 = 17,600个决定，并做出负面更新（不批准我们所做的事情）。 这就是全部。 现在，网络将更有可能重复已执行的操作，而不太可能重复未执行的操作。 现在，我们通过略有改进的新策略又玩了100场游戏，然后重复应用渐变。 <br><br><img src="https://habrastorage.org/webt/zv/ap/mo/zvapmoiul9plnltsttdsplvze3g.png"><br>  <i>4个游戏的卡通方案。</i>  <i>每个黑色圆圈都是一种游戏状态（下面显示了三个状态示例），每个箭头都是标有所选动作的过渡。</i>  <i>在这种情况下，我们赢了2场，输了2场。</i>  <i>我们参加了赢得的两场比赛，并轻轻鼓励了我们在本集中所做的所有动作。</i>  <i>相反，我们还将进行两场输掉的比赛，并稍微劝阻我们在本集中所做的每个动作。</i> <br><br> 如果您对此进行反思，您将开始发现一些有趣的属性。 例如，如果我们在第50帧进行了良好的动作，正确踢球，但随后在第150帧错过了球怎么办？ 由于我们输掉了比赛，因此每个动作现在都标记为不良，这是否会妨碍正确击中第50帧？ 您说的没错-这个派对就是这样。 但是，当您考虑成千上万的游戏过程时，正确执行篮板球将增加您将来获胜的可能性。 平均而言，对于适当的球拍打击，您会看到比消极更新要多的积极信息。 而且神经网络的实施策略最终将产生正确的反应。 <br><br>  <i>更新：2016年12月9日</i>是另一种视图。 在上面的解释中，我使用了诸如“定义梯度和反向传播”的术语，这是一项非常熟练的技术。 如果您习惯于编写自己的反向传播反向传播代码或使用Torch，则可以完全控制渐变。 但是，如果您习惯使用Theano或TensorFlow，您会有些困惑，因为backprop代码是完全自动化的并且很难自定义。 在这种情况下，以下替代视图可能会更有成效。 与老师一起教学时，通常的目标是最大程度地提高 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-35" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">（</font></span></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">）</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-36">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-46">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.091ex" height="2.419ex" viewBox="0 -780.1 9941.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6C" x="2764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6F" x="3063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-67" x="3548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-70" x="4029" y="0"></use><g transform="translate(4532,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(5362,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6D" x="6447" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="7326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-64" x="7671" y="0"></use><g transform="translate(8195,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="809" y="-213"></use></g><g transform="translate(9111,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ sum_i \ log p（y_i \ mid x_i）</script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.996ex" height="2.419ex" viewBox="0 -780.1 2581.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="809" y="-213"></use><g transform="translate(916,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(1746,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="693" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> x_i，y_i </script>  -训练示例（例如图像及其标签）。 将梯度应用于策略功能与教师培训完全吻合，但有两个小区别：1）我们没有正确的标签 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-64"><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="1.817ex" viewBox="0 -520.7 834.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="693" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> y_i </script>  ，因此，作为“假标签”，我们使用收到的操作来从策略中选择 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-msubsup" id="MJXp-Span-69"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-71" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.129ex" height="1.817ex" viewBox="0 -520.7 916.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x_i </script>  ，以及2）我们为每个动作引入另一个权宜性系数（优势）。 因此，最终，我们的损失现在看起来像 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;"> l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">（</font></span></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-98" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;">）</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-92">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-98" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.634ex" height="2.419ex" viewBox="0 -780.1 11036.7 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="1242" y="-213"></use></g><g transform="translate(2514,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="1061" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6C" x="3859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6F" x="4158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-67" x="4643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-70" x="5124" y="0"></use><g transform="translate(5627,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(6457,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-6D" x="7542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="8420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-64" x="8766" y="0"></use><g transform="translate(9289,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/439674/&amp;usg=ALkJrhg5MnmYL6gd_M5AGE14lljQvAXa9g#MJMATHI-69" x="809" y="-213"></use></g><g transform="translate(10206,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ sum_i A_i \ log p（y_i \ mid x_i）</script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-msubsup" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ÿ </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-104" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> y_i </script>  -这是我们对样本执行的操作，并且 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-msubsup" id="MJXp-Span-106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-108" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> A_i </script> 是数字，我们称为权宜系数。 例如，对于乒乓球，该值 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">A</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> A_i </script> 如果我们最终赢得该集，则可能是1.0；如果我们输了，则可能是-1.0。 这样可以确保我们最大程度地记录导致良好结果的动作的可能性，并最大程度地减少未记录结果的可能性。 由于许多呼吁而采取的中立行动不会特别影响政治功能。 因此，强化学习与与老师的学习完全相同，但是在不断变化的数据集（情节）上，还有其他因素。 <br><br>  <b>更先进的可行性功能。</b> 我还承诺会提供更多信息。 到目前为止，我们已经根据我们是否获胜来评估每个动作的正确性。 在更一般的RL设置中，我们将获得“有条件的奖励” <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-116" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> r_t </script> 对于每个步骤，取决于步骤编号或时间。 一种常见的选择是使用折现系数，因此上图中的“可能的报酬”为 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-120" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-122">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">u</span><span class="MJXp-msubsup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-131"><span class="MJXp-mtext" id="MJXp-Span-132">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">y</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">k</span><span class="MJXp-mo" id="MJXp-Span-129">=</span><span class="MJXp-mn" id="MJXp-Span-130">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-138">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">m</span><span class="MJXp-msubsup" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-145" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">t</span><span class="MJXp-mo" id="MJXp-Span-150">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> R_t = \ sum_ {k = 0} ^ {\ infty} \ gamma ^ k r_ {t + k} </script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mtext" id="MJXp-Span-153" style="color: red;">\伽</span><span class="MJXp-mrow" id="MJXp-Span-154"><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0.278em; margin-right: 0.278em;">玛</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> \伽玛</script> 是从0到1的数字，称为折扣系数（例如0.99）。 该表述表示，我们鼓励采取行动的力量是所有奖励的加权总和，但随后的奖励却没有那么重要。 就是说，更好地鼓励采取行动的短链，而采取行动的长链的尾巴则变得不那么重要。 实际上，您还需要将它们标准化。 例如，假设我们计算 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-159" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> R_t </script> 适用于一系列100个游戏情节中的所有20,000个动作。 一个很好的主意是在将它们连接到反向传播算法之前，将它们标准化（减去平均值，除以标准差）。 因此，我们总是鼓励和劝阻大约一半的行动。 这样可以减少波动并使政策更加趋同。 在[ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">链接</a> ]可以找到更深入的研究。 <br><br>  <b>从策略功能派生。</b> 我还想简要描述一下数学上如何采用渐变。 政治功能的梯度是更一般性理论的特例。 一般情况是，当我们有以下形式的表达式时 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">x</span><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">p</span><span class="MJXp-mrow" id="MJXp-Span-170"><span class="MJXp-mo" id="MJXp-Span-171">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">x</span><span class="MJXp-mtext" id="MJXp-Span-173">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">d</span><span class="MJXp-mtext" id="MJXp-Span-177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">a</span><span class="MJXp-mrow" id="MJXp-Span-183"><span class="MJXp-mo" id="MJXp-Span-184">）</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">f</span><span class="MJXp-mrow" id="MJXp-Span-187"><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">x</span><span class="MJXp-mrow" id="MJXp-Span-190"><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> E_ {x \ sim p（x \ mid \ theta）} [f（x）] </script>  ，即某些标量函数的期望 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">f</span><span class="MJXp-mrow" id="MJXp-Span-195"><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">x</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> f（x）</script> 及其参数的一些分布 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">p</span><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">x</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">a</span><span class="MJXp-mrow" id="MJXp-Span-212"><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> p（x; \ theta）</script> 由某些向量参数化 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-mtext" id="MJXp-Span-215">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ theta </script>  。 然后 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">f</span><span class="MJXp-mrow" id="MJXp-Span-223"><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">x</span><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> f（x）</script> 将成为我们的奖励函数（或更一般意义上的权宜函数），以及离散分布 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">p</span><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">x</span><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> p（x）</script> 将是我们的政策，实际上具有以下形式 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">p</span><span class="MJXp-mrow" id="MJXp-Span-237"><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mrow" id="MJXp-Span-239"><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.278em; margin-right: 0.278em;">一</span></span><span class="MJXp-mrow" id="MJXp-Span-241"><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.278em; margin-right: 0.278em;">个</span></span><span class="MJXp-mtext" id="MJXp-Span-243" style="color: red;">\中</span><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0.278em; margin-right: 0.278em;">旬</span></span><span class="MJXp-mrow" id="MJXp-Span-246"><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.278em; margin-right: 0.278em;">我</span></span><span class="MJXp-mrow" id="MJXp-Span-248"><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> p（一个\中旬我）</script> 给出图片的动作概率 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mrow" id="MJXp-Span-251"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0.278em; margin-right: 0.278em;">我</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21">我</script>  。 然后我们对如何通过其参数移动p的分布感兴趣 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ theta </script> 放大 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> f </script>  （即，我们如何更改网络设置，以使操作获得更高的回报）。 我们有这个： <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="noError" id="MJXp-Span-263" style="display: inline-block;">\开始{align}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;E_x&nbsp;[f（x）]＆=&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;sum_x&nbsp;p（x）f（x）＆\&nbsp;text&nbsp;{期望的定义}&nbsp;\\＆=&nbsp;\&nbsp;sum_x&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;p（x）f（x）和\文字{交换总和和渐变}&nbsp;\\＆=&nbsp;\&nbsp;sum_x&nbsp;p（x）\&nbsp;frac&nbsp;{\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;p（x）}&nbsp;{p&nbsp;（x）}&nbsp;f（x）＆\文字{乘以并除以}&nbsp;p（x）\\＆=&nbsp;\&nbsp;sum_x&nbsp;p（x）\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;p（x）f（x）＆\文字{使用以下事实：\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log（z）=&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{z}&nbsp;\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;z&nbsp;\\＆=&nbsp;E_x&nbsp;[f（x）\&nbsp;nabla&nbsp;_&nbsp;{\&nbsp;theta}&nbsp;\&nbsp;log&nbsp;p（x）]和\文本{期望的定义}&nbsp;\结束{align}</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \开始{align} \ nabla _ {\ theta} E_x [f（x）]＆= \ nabla _ {\ theta} \ sum_x p（x）f（x）＆\ text {期望的定义} \\＆= \ sum_x \ nabla _ {\ theta} p（x）f（x）和\文字{交换总和和渐变} \\＆= \ sum_x p（x）\ frac {\ nabla _ {\ theta} p（x）} {p （x）} f（x）＆\文字{乘以并除以} p（x）\\＆= \ sum_x p（x）\ nabla _ {\ theta} \ log p（x）f（x）＆\文字{使用以下事实：\ nabla _ {\ theta} \ log（z）= \ frac {1} {z} \ nabla _ {\ theta} z \\＆= E_x [f（x）\ nabla _ {\ theta} \ log p（x）]和\文本{期望的定义} \结束{align} </script><br><br> 我将尽力解释这一点。 我们有一些分配 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">p</span><span class="MJXp-mrow" id="MJXp-Span-266"><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">x</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-270">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">a</span><span class="MJXp-mrow" id="MJXp-Span-276"><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> p（x; \ theta）</script>  （我用了缩写 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">p</span><span class="MJXp-mrow" id="MJXp-Span-280"><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">x</span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> p（x）</script> 从中我们可以选择特定的值。 例如，它可以是随机数发生器从中采样的高斯分布。 对于每个示例，我们还可以计算估计函数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> f </script>  ，根据当前示例，它为我们提供了一些标量估计。 所得方程式告诉我们如何通过其参数移动分布 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mtext" id="MJXp-Span-288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ theta </script> 如果我们想进一步根据它采取行动的例子来获得更高的利率 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> f </script>  。 我们举一些行动的例子 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> x </script> 及其评估 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">f</span><span class="MJXp-mrow" id="MJXp-Span-300"><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">x</span><span class="MJXp-mrow" id="MJXp-Span-303"><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> f（x）</script>  ，对于每个x，我们还评估第二项 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-305"><span class="MJXp-mtext" id="MJXp-Span-306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">l</span><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-313" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">p</span><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">x</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">a</span><span class="MJXp-mrow" id="MJXp-Span-335"><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> \ nabla _ {\ theta} \ log p（x; \ theta）</script>  。 这个乘数是多少？ 这就是向量-梯度，它为我们提供了参数空间中的方向，这将导致特定动作的可能性增加 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> x </script>  。 换句话说，如果我们将θ推向 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-339"><span class="MJXp-mtext" id="MJXp-Span-340">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">l</span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-354">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">p</span><span class="MJXp-mrow" id="MJXp-Span-359"><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">x</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-363">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">a</span><span class="MJXp-mrow" id="MJXp-Span-369"><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> \ nabla _ {\ theta} \ log p（x; \ theta）</script>  ，我们将看到此操作的新可能性会略有增加。 如果回头看公式，它告诉我们应该朝这个方向乘以标量值 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">f</span><span class="MJXp-mrow" id="MJXp-Span-373"><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">x</span><span class="MJXp-mrow" id="MJXp-Span-376"><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> f（x）</script>  。 这样可以确保评分较高（在本例中为奖励）的操作示例比指标较低的示例更“吸引”，因此，如果我们要根据 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> p </script>  ，则概率密度将向更高的最终游戏点方向移动，这增加了获得具有高奖励的动作示例的可能性。 重要的是不要从函数中获取梯度 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> f </script>  ，因为它通常是无法区分且不可预测的。 一 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> p </script> 可区分的 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-384"><span class="MJXp-mtext" id="MJXp-Span-385">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ theta </script>  。 那是 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> p </script> 是连续可调的离散分布，您可以在其中调整单个动作的概率。 我们还假设 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> p </script> 标准化。 <br><br><img src="https://habrastorage.org/webt/xo/qy/9p/xoqy9pzjvy4d3sxosr_irpasic4.png"><br><br>  <i>渐变可视化。</i>  <i>左：高斯分布及其中的几个示例（蓝点）。</i>  <i>在每个蓝点处，我们还绘制了对数概率相对于平均参数的梯度。</i>  <i>箭头指示平均分布值应移动的方向，以增加此示例操作的可能性。</i>  <i>中间：添加了一些求值函数，除某些小区域中的+1之外，其他所有地方都提供-1（请注意，这可以是任意的，不一定是可微分的标量函数）。</i>  <i>箭头现在采用了颜色编码，因为由于乘法运算，我们将平均所有绿色箭头的正值和负红色箭头的值。</i>  <i>右：更新参数后，绿色箭头和反向红色箭头将我们向左和向下推。</i>  <i>如果需要，此分布中的样本现在将具有更高的预期评级。</i> <br><br> 我希望与RL的联系清楚。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们的政策为我们提供了一些行动示例，其中一些行动比其他行动更好（根据权宜功能判断）。更改策略设置的方法是运行，采用所选操作的梯度，将其乘以等级并添加我们在上方所做的所有操作。对于更彻底的结论，我建议</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">约翰·舒尔曼</font></font><br></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">John Shulman）进行</font></a><font style="vertical-align: inherit;">一次演讲</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">。</font></a></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">培训。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">好吧，我们已经制定了政治职能梯度的原则。我用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">130行Python脚本</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现了整个方法，该</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">脚本</font></a><font style="vertical-align: inherit;">使用了</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">OpenAI Gym提供</font></a><font style="vertical-align: inherit;">的现成的ATAI 2600 Pong仿真器</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我使用RMSProp算法训练了一个包含200个隐层神经元的两层神经网络，进行了10次发作（根据规则，每个发作包括几次抽签，该发作持续得分21）。我并没有设置过多的超级参数并在慢速的Macbook上进行了实验，但是经过三天的锻炼，我得到了一个比内置播放器更好玩的策略。总的情节总数约为8,000，因此该算法玩了大约200,000傍游戏，这相当多，总共产生了约800次权重更新。如果我使用ConvNets在GPU上进行训练，那么几天之内，我就能取得不错的成绩；如果我优化超参数，那么我总能赢。但是，我并没有花费太多时间进行计算或设置，所以取而代之的是Pong AI，它说明了主要思想并且效果很好：</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/cf/gf/jr/cfgfjrkzt_awy-l7f5lcxcrfvki.png"></a> <br> <i>  .      </i> <br><br> <b> .</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们还可以查看获得的神经网络权重。由于进行了预处理，我们的每个输入都是80x80的差异图像（当前帧减去前一帧）。来自层W1的每个神经元都连接到由200个神经元组成的隐藏层W2。债券数量为80 * 80 * 200。让我们尝试分析这些连接。我们将对W2层的所有神经元进行分类，并可视化导致它的权重。根据从W1神经元到一个W2神经元的尺度，我们将制作80x80图片。下面是40张这样的W2图片（总共200张）。白色像素为正权重，黑色像素为负。请注意，几个W2神经元被调谐到以虚线编码的飞行球。在游戏中，球只能在一个地方，因此，这些神经元具有多种用途，如果球在这些线的某处，它们将“射击”。黑白交替很有趣，因为当球沿着轨道移动时，神经元的活动会像正弦波一样波动。由于ReLU的缘故，他只会在某些位置“射击”。图像中有很多噪点，如果我使用L2正则化，则噪点会更少。</font></font><br><br><img src="https://habrastorage.org/webt/1t/n4/le/1tn4lew2rszryk1u9vkbreigku4.png"><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么都没发生。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，我们学习了如何使用策略功能的梯度在图片上打乒乓球，并且效果很好。这种方法是一种奇怪的“建议和验证”形式，其中“猜测”是指在游戏的多个情节中执行我们的政策，而“检查”则鼓励采取行动以产生良好的结果。一般而言，这代表了我们当前如何处理强化学习问题的当前水平。如果您直观地理解算法并知道其工作原理，那么您至少应该会有些失望。特别是什么时候不起作用？</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将此与人可以学习打乒乓球的方式进行比较。您自己给他们看比赛，然后说：“您控制球拍，您可以上下移动球拍，您的任务是将球扔到内置程序控制的另一位球员身上，”您就可以出发了。请注意一些区别：</font></font><br><br><ul><li>         - , ,   ,     .     RL       ,        .       ,        (        ),       ,  .         .   ,          ,  ,  ,   ,            , ,   ,  . <br></li><li>      ,     ( ,    ,     ,      ..),    ( «» « ,  , ,    -  -  . .).      «»          / . ,     ,    (   )   (      ,    ). <br></li><li>    —    (brute force),            ,       .              .       ,    ,           ,      .   ,     «»    ,        .   ,    ,         . <br></li><li>        ,    ,     .    ,             ,      .           . <br></li></ul><br><img src="https://habrastorage.org/webt/do/4a/ha/do4ahazbavg7xmlq-a5omrr77vq.png"><br><br> <i>:  :      RL.   ,  ,     .  ,    .     ,  99%        .  ,  «»   . :       «»,    ,  - , -  , -  ,     ,     .                 « ,      ».</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我还要强调一个事实，相反，在许多游戏中，政治梯度很容易击败一个人。特别是，这适用于具有频繁奖励的游戏，这些游戏需要准确，快速的反应并且没有长期计划。 PG方法很容易看出奖励和行动之间的短期关联。您可以在我们的代理商Pong中看到类似的内容。当他只等球时，他就制定了策略，然后迅速移动以仅在最边缘抓住球，这就是为什么球以很高的垂直速度弹跳的原因。特工连续重复数次获胜，重复了这种简单的策略。在许多游戏（弹球游戏，突破游戏）中，深度Q学习通过简单而精确的动作将一个人吸引并践踏到泥泞中。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一旦了解了这些算法的“技巧”，就可以了解它们的优缺点。特别是，这些算法在构建人们可以用来快速学习的游戏的抽象概念方面远远落后于人们。一旦计算机查看了像素阵列并注意到了钥匙，就进了门，然后自以为是，拿钥匙去门就好了。目前尚无与此相关的东西，而试图到达那里是一个活跃的研究领域。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">神经网络中的不可微计算。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我想提到非博弈策略梯度的另一个有趣应用：它允许我们使用与不可微计算执行（或交互）的组件来设计和训练神经网络。这个想法</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由Williams</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">于</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">1992</font></a><font style="vertical-align: inherit;">年首次提出</font><font style="vertical-align: inherit;">。并且最近在</font><a href=""><font style="vertical-align: inherit;">循环视觉注意力模型中</font></a><font style="vertical-align: inherit;">得到了普及</font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在处理具有一系列中心凹低分辨率外观的图像的模型的背景下，这种模式称为“密切关注”，类似于我们的眼睛如何以运行中的中央视觉检查对象。在每次迭代中，RNN将接收一小幅图像片段，并选择需要进一步查看的位置。例如，RNN可以查看位置（5.30），获取图像的小片段，然后决定查看（24，50），依此类推。神经网络的一部分选择了要进一步查看的位置，然后对其进行检查。不幸的是，该操作不可区分，因为我们不知道如果在其他地方进行采样会发生什么。在更一般的情况下，请考虑具有多个输入和输出的神经网络：</font></font><br><br><img src="https://habrastorage.org/webt/xn/gn/ca/xngncauic38rgmg3bi_srnlevbw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，大多数蓝色箭头与往常一样是可区分的，但是某些视图转换可能还包括未区分的选择操作，该操作以红色突出显示。我们可以沿相反的方向穿过蓝色箭头，但是红色箭头是一种依赖关系，通过它我们无法反向传播反向传播。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">梯度政策要抢救！让我们考虑执行采样的网络部分，它可以表示为嵌入在大型神经网络中的随机策略的函数。因此，在训练过程中，我们将提供几个示例（由下面的分支指示），然后我们将鼓励最终产生良好结果的样本（在这种情况下，例如，以最后的损失来衡量）。换句话说，我们将像往常一样使用反向传播器训练蓝色箭头中包含的参数，但现在红色箭头中包含的参数将使用策略梯度独立于后向传递进行更新，从而鼓励降低样本损失。最近也很好地构想了这个想法。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用随机计算图进行梯度估计。</font></font></a> <br><br><img src="https://habrastorage.org/webt/td/vx/lr/tdvxlrd98jepxgmsvpc5gtewlxs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">经过训练的输入/输出在随机存取存储器中。您还将在其他许多文章中找到这种想法。例如，</font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">神经图灵机</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个存储带，他们可以用它们来读写。要执行写操作，您需要执行类似m [i] = x的操作，其中i和x由RNN神经网络预测。但是，没有信号告诉我们如果我们写j，损失函数会发生什么！ =I。因此，NTM可以执行软读取和写入操作。他预测注意力分布函数a，然后对所有i执行：m [i] = a [i] * x。现在是可区分的，但是我们必须付出高昂的计算成本，对所有单元格进行排序。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，我们可以使用策略梯度从理论上解决此问题，就像</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RL-NTM一样</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我们仍然可以预测注意力a的分布，但不是穷举搜索，而是随机选择写作地点：i =样本（a）； m [i] = x。在训练期间，我们可以针对一小部分i进行此操作，最后找到一个比其他i更好用的集合。一个巨大的计算优势是，在测试期间，您可以从一个单元读取/写入。但是，如文档中所述，该策略很难实现，因为您需要经历许多选择，并且几乎偶然地使用了有效的算法。目前，研究人员一致认为，只有在有多个离散选项且您不需要梳理庞大的搜索空间时，PG才能很好地工作。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，借助策略梯度，并且在有大量数据和计算能力的情况下，原则上我们可以梦想很多。例如，我们可以设计学习与大型不可微对象（例如Latex编译器）进行交互的神经网络。例如，为了让char-rnn生成现成的Latex代码，SLAM系统，LQR求解器或其他东西。或者，例如，超级智能可能想要学习如何通过TCP / IP（也是不可区分的）与Internet进行交互，以访问捕获世界所需的信息。这是一个很好的例子。</font></font><br><br><h4> 结论 </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们看到策略梯度是一种功能强大的通用算法，例如，我们从</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">130条Python行中的</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">原始像素中训练了ATARI Pong代理</font><font style="vertical-align: inherit;">。通常，可以使用相同的算法来训练任意游戏的代理，并且希望有一天我们可以使用它来解决现实世界中的控制问题。最后，我想补充一些评论：</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于AI的发展</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。我们看到该算法通过暴力搜索起作用，在这种情况下，您首先会随机犹豫，并且必须在策略功能更改其参数之前至少一次（理想情况下是偶然）偶然发现有用的情况。我们还看到，一个人以完全不同的方式来解决这些问题，类似于快速构建抽象模型。由于很难抽象地想象这些抽象模型（如果不是不可能的话），这也是最近对生成模型和软件归纳产生了极大兴趣的原因。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于机器人技术的使用。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该算法不适用于难以获得大量研究的情况。例如，您可以让一个（或几个）机器人与世界实时互动。对于该算法的简单应用而言，这还不够。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确定性的政策梯度</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是旨在减轻这一问题的工作领域之一</font><font style="vertical-align: inherit;">。这种方法不是进行实际尝试，而是从对评估函数建模的第二个神经网络（称为评论家）获取梯度信息。从原则上讲，这种方法对于高维度的行为可能是有效的，因为在这种情况下，随机抽样的覆盖率很低。另一种相关方法是扩大我们在</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Google机器人农场</font></a><font style="vertical-align: inherit;">中开始看到的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机器人技术</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">甚至是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">带有自动驾驶仪</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Tesla S +。</font></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有一条工作线试图通过添加其他控件来减少搜索过程的希望。例如，在许多实际情况下，您可以直接从人那里获得最初的发展方向。例如，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AlphaGo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">首先使用老师的培训来预测人类的行为（例如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">远程机器人控制</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学徒制</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">轨迹优化</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完整策略搜索</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。然后使用PG配置最终的策略，以实现真正的目标-赢得比赛。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在某些情况下，可能会有更少的预设（例如，用于</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">远程控制机器人</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），并且存在使用该</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实习前</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据的方法</font><font style="vertical-align: inherit;">。最后，如果人们不提供特定的数据或设置，则在某些情况下也可以通过使用非常昂贵的优化方法进行计算来获得它们，例如，通过</font><font style="vertical-align: inherit;">在已知动态模型（例如物理模拟器中的F = ma）中</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">优化轨迹</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来进行计算，</font><font style="vertical-align: inherit;">或者在某些情况下创建近似的本地模型时（如在用于托管策略搜索的非常有前途的结构中看到的那样）。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于在实践中使用PG。</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我想更多地谈论RNN。我认为RNN似乎很神奇，可以自动解决与任意序列有关的问题。事实是，使这些模型正常工作可能很棘手。需要护理和经验，以及何时知道更简单的方法可以帮助您90％。政策梯度也是如此。它们不会像那样自动运行：您需要有很多示例，它们可以永久地训练，当它们不起作用时很难调试。在到达火箭筒之前，您应该始终尝试从小手枪射击。例如，在加强训练的情况下，应始终首先检查</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">交叉熵方法（CEM）</font></a><font style="vertical-align: inherit;">。</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，一种受进化启发的简单的随机“猜测和检验”方法。而且，如果您坚持尝试执行任务的策略梯度，请确保您知道具体的窍门。从简单开始，并使用一个称为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TRPO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的PG选项</font><font style="vertical-align: inherit;">，该</font><font style="vertical-align: inherit;">选项</font><font style="vertical-align: inherit;">几乎总是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比传统PG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更好，更一致</font><font style="vertical-align: inherit;">。基本思想是避免由于使用新旧政策之间的Kulbak-Leibler距离而更新太多更改您的政策的设置。</font></font><br><br> 仅此而已！<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">希望我给您一个关于强化学习的概念，有什么问题，如果您想帮助推广RL，我邀请您在我们的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenAI Gym中进行</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：）下次见！</font></font><br><br><hr><br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">人工智能和自动驾驶特斯拉研究人员，开发人员，总监</font><font style="vertical-align: inherit;">Andrej Karpathy，</font></font><br><br> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他信息：</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2018年手指深度学习</font><font style="vertical-align: inherit;">课程</font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://habr.com/en/post/414165/</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">手指深度学习</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开放课程2019 </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https：// // habr.com/ru/company/ods/blog/438940/</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NSU物理学院</font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.phys.nsu.ru/</font></font></a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN439674/">https://habr.com/ru/post/zh-CN439674/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN439662/index.html">宣布TypeScript 3.3</a></li>
<li><a href="../zh-CN439664/index.html">C ++二进制兼容性和无痛升级到Visual Studio 2019</a></li>
<li><a href="../zh-CN439668/index.html">将技术通讯扩展到300个城市中的70万订户：Techstars初创公司摘要的历史</a></li>
<li><a href="../zh-CN439670/index.html">俄罗斯用于诊断Botkin.AI的AI系统。 现在在Azure市场中</a></li>
<li><a href="../zh-CN439672/index.html">PowerShell基础知识：检测字符串是否以特定字符结尾</a></li>
<li><a href="../zh-CN439676/index.html">适用于iOS和Android的React Native和C ++集成</a></li>
<li><a href="../zh-CN439678/index.html">提交应用F＃挑战</a></li>
<li><a href="../zh-CN439680/index.html">大约50％的俄罗斯人愿意出售其个人数据</a></li>
<li><a href="../zh-CN439682/index.html">培训Cisco 200-125 CCNA v3.0。 思科认证网络专家（CCNA）。 第4天。网关设备</a></li>
<li><a href="../zh-CN439684/index.html">申请已应用的F＃挑战</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>