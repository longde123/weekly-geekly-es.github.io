<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😓 👩🏿‍🚀 👨🏽‍🔬 Utilisation de l'API KOMPAS-3D → Leçon 12 → Lignes composées ☮️ 🔷 💞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la leçon précédente, nous avons examiné l'affichage de chaînes simples. À ce sujet, nous parlerons de la formation de lignées composées, y compri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Utilisation de l'API KOMPAS-3D → Leçon 12 → Lignes composées</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/424509/">  Dans la leçon précédente, nous avons examiné l'affichage de chaînes simples.  À ce sujet, nous parlerons de la formation de lignées composées, y compris les écarts et les fractions.  Nous <b>générerons de</b> telles lignes en utilisant la méthode <b>ksText</b> , que nous avons étudiée précédemment.  À strictement parler, cette méthode n'est pas destinée à produire des chaînes complexes.  Néanmoins, dans la leçon d'aujourd'hui, nous allons nous familiariser avec un certain nombre de drapeaux qui jouent un rôle clé dans la formation de lignes composées. <br><br><img src="https://habrastorage.org/webt/_4/wy/zc/_4wyzcxmukwnvd1wcolm6g0yztc.png"><br><br><a name="habracut"></a><br><blockquote><h4>  Le contenu de la série de leçons «Travailler avec l'API KOMPAS-3D» </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les bases</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conception de dessin</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Connexion correcte à KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Inscription principale</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Primitives graphiques</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Enregistrement d'un document dans différents formats</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Connaître les paramètres</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Méthodes d'écriture plus sophistiquées dans le cartouche</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lecture des cellules de légende</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caractères spéciaux dont une chaîne</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Étiquettes de texte simples</a> </li><li>  <b>Chaînes composées</b> </li></ol></blockquote><br>  Bien que les méthodes décrites pour la construction des écarts et des fractions ne soient pas documentées, elles, comme mes expériences le montrent, fonctionnent correctement sur les versions modernes de KOMPAS (vérifiées les 15, 16 et 17).  Mais ce comportement peut être modifié dans les futures versions. <br><br>  Les méthodes «correctes» pour construire des chaînes composées seront décrites dans les leçons suivantes. <br><br><h2>  <font color="#00B2FF">Italique, gras et souligné</font> </h2><br>  Les styles italiques, gras et soulignés sont contrôlés par les indicateurs indiqués dans le tableau ci-dessous.  Ils sont déclarés dans le fichier d'en-tête <b>ldefin2d.h</b> . <br><br><img src="https://habrastorage.org/webt/md/ot/_x/mdot_xd391dvskzggywaqkhang4.png"><br><br>  Dans la méthode <b>ksText, l'</b> effet de chacun de ces indicateurs est limité à l'appel de cette méthode.  Ce qui suit est un exemple de programme qui illustre la sortie de lignes avec différents styles. <br><br><pre><code class="hljs erlang-repl">Document2D-&gt;ksText(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> , SysAllocString(L<span class="hljs-string"><span class="hljs-string">" "</span></span>)); Document2D-&gt;ksText(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ITALIC_OFF , SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  "</span></span>)); Document2D-&gt;ksText(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, BOLD_ON , SysAllocString(L<span class="hljs-string"><span class="hljs-string">" "</span></span>)); Document2D-&gt;ksText(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, UNDERLINE_ON, SysAllocString(L<span class="hljs-string"><span class="hljs-string">" "</span></span>));</code> </pre> <br>  Par souci de simplicité, cet exemple omet le code responsable de la création et de l'exécution du document (ce sujet a été discuté dans les leçons précédentes), ainsi que de la libération des ressources (y compris après avoir appelé la fonction <b>SysAllocString</b> ). <br><br>  Remarque: par défaut, KOMPAS affiche le texte en italique.  Par conséquent, pour annuler l' <i>italique,</i> nous utilisons le drapeau <i>ITALIC_OFF</i> .  La figure ci-dessous montre les lignes produites par ce programme. <br><br><img src="https://habrastorage.org/webt/ev/ti/h_/evtih_t-gm3t2ul2m2dtbzhu7ck.png"><br><br>  L'utilisation simultanée de drapeaux appariés (par exemple, <i>BOLD_ON</i> et <i>BOLD_OFF</i> ) n'affecte pas l'affichage de la chaîne.  Il est affiché comme il le serait si aucun de ces indicateurs n'était défini. <br><br><h2>  <font color="#00B2FF">Écarts supérieurs et inférieurs</font> </h2><br>  Les écarts supérieurs et inférieurs sont définis à l'aide des drapeaux indiqués dans le tableau ci-dessous. <br><br><img src="https://habrastorage.org/webt/r_/44/oa/r_44oazvl35o5a8pbrcbckassuy.png"><br><br>  Ce qui suit est un exemple de programme qui illustre la sortie d'une ligne contenant des écarts supérieurs et inférieurs. <br><br><pre> <code class="hljs rust">double x = <span class="hljs-number"><span class="hljs-number">100.0</span></span>; double y = <span class="hljs-number"><span class="hljs-number">100.0</span></span>; BSTR <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  "</span></span>); long itext = Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); x += Document2D-&gt;ksGetTextLengthFromReference(itext) + <span class="hljs-number"><span class="hljs-number">2.0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">" "</span></span>); itext = Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, UPPER_DEVIAT, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); double dx1 = Document2D-&gt;ksGetTextLengthFromReference(itext); <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">" "</span></span>); itext = Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, LOWER_DEVIAT, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); double dx2 = Document2D-&gt;ksGetTextLengthFromReference(itext); x += max(dx1, dx2); <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  "</span></span>); Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>);</code> </pre><br>  Dans cet exemple, nous recalculons à chaque fois les coordonnées des points d'ancrage des lignes affichées afin de savoir où les sortir.  Pour ce faire, utilisez la méthode <b>ksGetTextLengthFromReference</b> décrite dans la leçon précédente.  Attention: seule la coordonnée horizontale est recalculée, la verticale ne change pas.  KOMPAS détermine lui-même le décalage vertical souhaité.  La figure ci-dessous montre la ligne composite générée par ce programme. <br><br><img src="https://habrastorage.org/webt/_b/qf/ry/_bqfryeirgdc5warzsdwwl0siku.png"><br><br><h2>  <font color="#00B2FF">Fraction</font> </h2><br>  Le rendu des fractions est défini par les indicateurs répertoriés dans le tableau ci-dessous. <br><br><img src="https://habrastorage.org/webt/kg/i2/4q/kgi24qz3rhz83cg4jmbxp8ztzxy.png"><br><br>  Voici un exemple de programme qui illustre la sortie d'une fraction dans une chaîne de texte. <br><br><pre> <code class="hljs rust">double x = <span class="hljs-number"><span class="hljs-number">100.0</span></span>; double y = <span class="hljs-number"><span class="hljs-number">100.0</span></span>; BSTR <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  "</span></span>); long itext = Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); x += Document2D-&gt;ksGetTextLengthFromReference(itext) + <span class="hljs-number"><span class="hljs-number">2.0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">""</span></span>); itext = Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, NUMERATOR, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); double dx1 = Document2D-&gt;ksGetTextLengthFromReference(itext); <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">""</span></span>); itext = Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, DENOMINATOR, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); double dx2 = Document2D-&gt;ksGetTextLengthFromReference(itext); x += max(dx1, dx2); <span class="hljs-built_in"><span class="hljs-built_in">str</span></span> = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  "</span></span>); Document2D-&gt;ksText(x, y, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">str</span></span>); SysFreeString(<span class="hljs-built_in"><span class="hljs-built_in">str</span></span>);</code> </pre><br>  Il est facile de remarquer que cet exemple est similaire au précédent.  En effet, la sortie des écarts et des fractions ne diffère que par les drapeaux utilisés.  La figure ci-dessous montre le résultat du programme. <br><br><img src="https://habrastorage.org/webt/ry/sh/5c/rysh5cmibquzltwo7yh5ofdbbjc.png"><br><br>  <b>Conclusion</b> <br><br>  Dans cette leçon, nous avons examiné la création de chaînes composites à l'aide de la méthode <b>ksText</b> .  La méthode décrite ici n'est pas documentée, vous ne devez donc pas l'utiliser dans vos applications.  Dans les leçons suivantes, nous examinerons de plus près les moyens documentés de créer des chaînes composées.  Et là, nous aurons besoin des drapeaux que nous avons rencontrés aujourd'hui. <br><br>  <b>Pour continuer, suivez l'actualité du blog.</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., auteur du livre "Application Development for COMPAS in Delphi". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424509/">https://habr.com/ru/post/fr424509/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424499/index.html">Eh bien lui, ton pentest</a></li>
<li><a href="../fr424501/index.html">Terminaux de diagnostic pour les vrais soudeurs</a></li>
<li><a href="../fr424503/index.html">Démarrez-vous, le printemps arrive (partie 1)</a></li>
<li><a href="../fr424505/index.html">«Nous avons des idées pour Maven 4 et même Maven 5» - une interview de Robert Scholte, un acteur clé du projet Maven</a></li>
<li><a href="../fr424507/index.html">VI Hackathon JetBrains annuel: Shiftius Altius Ctrlius</a></li>
<li><a href="../fr424511/index.html">Outils pour trouver des classes annotées en Java</a></li>
<li><a href="../fr424513/index.html">À propos des centres de données bon marché, de la protection ILV et DDoS</a></li>
<li><a href="../fr424517/index.html">Implémentation de la minimisation des fonctions logiques par la méthode Quine \ McCluskey avec un jeu d'entrées incomplet</a></li>
<li><a href="../fr424519/index.html">Beethoven peut-il envoyer des demandes de suppression?</a></li>
<li><a href="../fr424525/index.html">Contrôle de vitesse mini-perceuse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>