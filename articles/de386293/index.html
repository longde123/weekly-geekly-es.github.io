<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😌 🏝️ 💃🏼 Schnittstellen für Crib Swing Device - Vom Schlüsselanhänger zum Web 🈸 🙋🏿 🎫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Etwas mehr als ein Jahr ist vergangen, seit ich meinen ersten Artikel über ein Gerät zum Schaukeln einer Krippe geschrieben habe. Während dieser Zeit ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Schnittstellen für Crib Swing Device - Vom Schlüsselanhänger zum Web</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/386293/"><div style="text-align:center;"><img src="https://habrastorage.org/files/a17/b69/b13/a17b69b1341b4ba38455428341654685.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Etwas mehr als ein Jahr ist vergangen, seit ich meinen ersten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> über ein Gerät zum Schaukeln einer Krippe geschrieben habe. </font><font style="vertical-align: inherit;">Während dieser Zeit entwickelte ich ein neues Bedienfeld mit einem Bildschirm und dann eine Webschnittstelle zu diesem Gerät. </font><font style="vertical-align: inherit;">Wenn Sie mehr erfahren möchten, sind Sie bei cat willkommen.</font></font><br>
<br>
<a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Am Anfang - ein paar Worte zum Gerät selbst, eine kurze Zusammenfassung der vorherigen Serie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Gerät ist also so konzipiert, dass es ein Kinderbett mit einem Pendelmechanismus schwingt. Eine Antriebseinheit mit einem Elektromagneten und einer Elektronik im Inneren ist am festen Teil der Krippe installiert. Ein Neodym-Magnet ist am beweglichen Teil befestigt. Ein Permanentmagnet, der über einen Elektromagneten fliegt, induziert eine EMF, deren Form das Moment bestimmt, in dem derselbe Elektromagnet an eine Stromquelle angeschlossen wird. Somit drückt der Elektromagnet zum richtigen Zeitpunkt den Permanentmagneten und damit den beweglichen Teil der Krippe. Wenn der Elektromagnet nicht mit Strom versorgt wird, spielt er gleichzeitig die Rolle eines Positionssensors für den beweglichen Teil der Krippe.</font></font><br>
<br>
<img src="https://habrastorage.org/files/79a/544/62a/79a54462afb845d7b06548478ca65f9e.gif" height="350" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/e80/6e9/0bd/e806e90bd42d464c72d0cef045499ea0.jpg" alt="Bild" height="350"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe die erste Kopie des Geräts für mich selbst erstellt. Dann stellte sich heraus, dass solche Geräte verkauft werden können, und seit mehr als drei Jahren mache ich dies mit unterschiedlichem Erfolg. Jetzt werden in kleinen Mengen vier Modelle des Geräts von einem der größten russischen Hersteller von Kindermöbeln hergestellt und verkauft. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In dem ersten Modell der Vorrichtung zum Schaukeln einer Krippe wird eine solche Fernbedienung als Bedienfeld verwendet. Es gibt vier Tasten mit den Funktionen „Start“, „Stopp“, „Stärker“ und „Schwächer“. Dementsprechend können Sie mit dieser Fernbedienung den Schwung starten und stoppen sowie seine Intensität ändern - wählen Sie eine von sechs möglichen Stufen. Der Schlüsselanhänger arbeitet mit einer Frequenz von 433 MHz und hat keine Rückkopplung.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/845/aa6/11b/845aa611b6ee4769bed8bd30d1f63f4c.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach einiger Zeit wurde eine vereinfachte Version des Geräts (Modell 0) entwickelt, im Allgemeinen ohne Bedienfeld. Sie schüttelten das Kinderbett mit seiner Hand - und es schwingt unbegrenzt weiter. Gestoppt - Schwingen gestoppt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Entwicklung des nächsten, zweiten Modells der Schaukelvorrichtung (Modell 2) bestand die Hauptaufgabe darin, einen Zeitgeber für Reisekrankheit hinzuzufügen und den Schwung aus dem Schrei des Kindes heraus zu starten. Und das stellte sich als Problem heraus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tatsache ist, dass die Schwungzeit irgendwie in Stunden und Minuten eingestellt werden muss. Und die Mikrofonempfindlichkeit wäre auch irgendwie schön einzurichten. All dies erfordert jedoch eine Schnittstelle, und eine „blinde“ Fernbedienung mit vier Tasten reicht eindeutig nicht aus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der erste Gedanke war natürlich, einen Hinweis auf das Gerätegehäuse zu geben. Platzieren Sie dort einige LEDs und / oder ein kleines Display. Und steuern Sie auch mit Hilfe dieser kleinen Fernbedienung. Der Nachteil dieser Lösung besteht jedoch darin, dass das Gerät im Allgemeinen an einem unzugänglichen Ort irgendwo an der Rückwand des Kinderbetts an der Wand installiert wird. Und die Hinweise auf den Fall in diesem Fall werden einfach nicht sichtbar sein. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher wurde beschlossen, ein Bedienfeld mit einem Display zu erstellen. Etwas weniger als ein Jahr Entwicklungszeit - und das Gerät mit der Fernbedienung ist fertig!</font></font><br>
<br>
<img src="https://habrastorage.org/files/6a7/2bd/a6e/6a72bda6ecfa4102917ccc6e36500b74.gif" align="left" height="350"><img src="https://habrastorage.org/files/c9d/5ad/290/c9d5ad290d064d5ababcf7b905b865cf.gif" height="350"><div style="text-align:center;"><img src="https://habrastorage.org/files/a5f/177/1dc/a5f1771dccce41aebe3815e49227f58c.gif"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In der Konsole befindet sich ATMega32A, das Display ist ein Bildschirm von Nokia 1202 und der Transceiver ist NRF24L01 +. Das Gehäuse ist Standard, die Tastatur ist Film. Über die Fernbedienung können Sie die Zeit der Reisekrankheit, die Empfindlichkeit des Mikrofons, die Intensität des Schwungs sowie das Starten und Stoppen des Vorgangs einstellen. Für den Fall mehrerer Betten im selben Raum besteht die Möglichkeit, den Steuerkanal zu wechseln, da der NRF24L01 + dies problemlos ermöglicht.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Konsole und das Gerät stehen ständig im Dialog miteinander. Dies geschieht zur Rückmeldung - der aktuelle Status des Geräts wird auf dem Bildschirm angezeigt, nämlich ob der Schwenkvorgang läuft oder nicht (wenn dies der Fall ist, schwingt auch das Krippenbild auf der Fernbedienung), wie viel Zeit zum Pumpen verbleibt, wie hoch die aktuellen Einstellungen für die Intensität der Reisekrankheit und die Mikrofonempfindlichkeit sind. Damit die Batterien im Bedienfeld nicht zu schnell entladen werden, ist ein Ruhemodus verfügbar. Wenn eine halbe Stunde lang niemand die Tasten auf der Fernbedienung drückt, „schläft“ die Fernbedienung ein.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nach der Entwicklung und Einführung von „Modell 2“, obwohl in einer bescheidenen, aber immer noch produzierten Produktion, dachte ich weiter darüber nach, das Schwenkgerät zu verbessern. Das wäre toll, dachte ich, wenn Sie das Gerät von einem Handy aus steuern könnten! Oder von einer Tablette. Wenn ich zum Beispiel schlafe, lege ich ein Handy neben mich. Es gibt einen Wecker und eine Post, und Sie können vor dem Schlafengehen etwas lesen. Und sicherlich auch viele junge Eltern. Warum eine separate Fernbedienung für das Schaukelgerät verwenden, wenn es sich hier - eine universelle Sache - um ein Smartphone oder Tablet handelt? Lass ihn das Bedienfeld sein, dachte ich.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Welche mehr oder weniger geeigneten Funkschnittstellen gibt es in einem modernen Smartphone? Bluetooth und Wi-Fi. Zuerst überlegte ich, das Schaukelgerät über Bluetooth zu steuern. Von den Vorteilen - es ist einfach von der Seite des Geräts zu implementieren. Sie können das Modul verwenden - den "Bridge" Bluetooth-UART, und das ist das Problem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Richtig, von der Seite des Smartphones - ständige Probleme.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist eine schlechte Idee, Bluetooth immer auf Ihrem Telefon zu haben. Außerdem müssen Sie für jedes Betriebssystem Ihre eigene Software schreiben. Dies sind mindestens zwei Anwendungen - für Android und für iPhone. Es gibt aber auch Telefone unter Windows Phone ... Nachdem ich mich etwas eingehender mit dem Thema befasst hatte, stellte ich fest, dass mit dem iPhone nichts funktionieren kann. Es scheint einige Einschränkungen zu geben. Nun, auch wenn alles klappt. Bewerbungen müssen zuerst geschrieben werden. Dann in den entsprechenden Filialen veröffentlichen. Dann müssen sie in gutem Zustand gehalten werden, um Fehler zu korrigieren und auf Benutzerkommentare zu reagieren. Das Problem ist, dass ich nichts davon getan habe, für mich ist es ein "dunkler Wald mit Partisanen" und für diesen Teil der Arbeit ist es eine gute Möglichkeit, eine sachkundige Person einzustellen. Und nicht einmalig einzustellen und dann ständig mit ihm in Bezug auf die Programmunterstützung zusammenzuarbeiten.Nun, oder lerne alles selbst. Es stellt sich irgendwie teuer und technisch hässlich heraus. Daher verschwindet Bluetooth.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und dann erfuhr ich von der Existenz des ESP8266. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, hier wurde bereits viel über diese Module geschrieben, außerdem gibt es ein ausgezeichnetes russischsprachiges Forum. Vor etwas weniger als einem Jahr, nachdem ich begonnen hatte, dieses Modul für meine Anwendung in Betracht zu ziehen, konnte ich mir lange Zeit keine Meinung über seine Fähigkeiten bilden. Und jetzt, nach den Fragen von Neulingen im selben Forum zu urteilen, sehe ich, dass viele nicht wissen, wozu dieses Modul (Chip) fähig ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier gibt es eine wichtige Sache zu sagen - anfangs war der ESP8266 mit einem sehr "rohen" und "fehlerhaften" chinesischen SDK "ausgestattet", und daher konnte der Chip nicht zur Lösung echter "Kampf" -Aufgaben verwendet werden. Natürlich war es möglich zu spielen, die LED zu blinken, aber es war unmöglich, etwas stabiles zu tun.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im vergangenen Jahr hat sich die Situation jedoch grundlegend geändert. Auf einem diesem Chip gewidmeten russischsprachigen Forum implementierte einer seiner Teilnehmer ein Projekt - "Entwicklung einer 'Bibliothek' eines kleinen Webservers auf ESP8266". Eine erstaunliche Inkognito-Person, die sich unter dem Spitznamen pvvx versteckt, hat fast im Alleingang eine Firmware für ESP8266 erstellt, mit der Sie die Funktionen dieses Chips vollständig offenlegen können. Die Quellcodes des Projekts sind öffentlich zugänglich. Der Autor erlaubt, sie nach Belieben zu verwenden, auch für kommerzielle Zwecke. Darüber hinaus ergänzt pvvx die Assembly weiterhin mit neuen Funktionen und ist, was sehr wichtig ist, aktiv im Forum präsent und wird nicht müde (wahrscheinlich), Neulinge (und nicht auch Neulinge) zu beraten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen habe ich keine Angst vor Pathos und herausragender Arbeit. Es wurde (unter anderem) möglich, jedem Gerät eine vollwertige, stabil funktionierende Weboberfläche zur Verfügung zu stellen. Die Fähigkeiten des Chips und der Firmware sind nicht auf diese Anwendung beschränkt, aber ich musste genau dieses Problem lösen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Vorteile des ESP8266 liegen auf der Hand, und darüber hinaus gibt es derzeit keine anderen Optionen, die in Preis und Funktionalität vergleichbar sind.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei einem Preis von ca. 170 Rubel auf dem ESP8266-Modul können Sie einen Webserver mit einer Gerätesteuerungsschnittstelle organisieren, mit der Sie unter keinem Betriebssystem Programme schreiben können, sondern nur einmal, um eine Webschnittstelle zu erstellen. Das Modul kann als Zugangspunkt und als Station sowie gleichzeitig in diesen beiden Modi betrieben werden. Wenn Sie beispielsweise eine Verbindung zum Modul als Zugangspunkt herstellen, können Sie dessen Kommunikationsparameter konfigurieren und das Modul bei Bedarf als Station mit Ihrem WLAN-Heimnetzwerk verbinden. Die Assembly ("Dump", wie der Autor es respektvoll nennt) verfügt über viele Einstellungen (über 250), die über die Weboberfläche verfügbar sind.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich gibt es auch andere Firmware für ESP8266, aber keine von ihnen verfügt über solche Fähigkeiten, Stabilität und Arbeitsqualität wie die Montage von pvvx (dies ist meine subjektive Meinung in Bezug auf meine Aufgabe). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basierend auf dieser Firmware wurde ein Webinterface für ein Krippenschaukelgerät entwickelt. Das Webpart selbst wurde so geschrieben, dass die Site auf verschiedenen Bildschirmen mit unterschiedlichen Größen und Auflösungen korrekt angezeigt wurde. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/e3b/b52/a67/e3bb52a67c6cf9fdf15a8298999d67c2.jpg" alt="Bild" height="800" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/f57/0b3/440/f570b344063bba844ebf23a8394eb634.jpg" alt="Bild" height="397" align="left"><img src="https://habrastorage.org/getpro/geektimes/post_images/4a6/8db/1f4/4a68db1f4fad6a2bfaea052ef086adaa.jpg" alt="Bild" height="397"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Natürlich musste die Hardware des Geräts großartig neu gemacht werden (tatsächlich - wieder gemacht). Der Swing-Algorithmus ist jetzt auf dem Attiny441-Mikrocontroller implementiert und interagiert über UART mit dem ESP8266. Die 3,3-Volt-Versorgung erfolgt über den ST1S10. Optionskarte mit einem Fehler (behoben durch Oberflächenmontage):</font></font><br>
<br>
<img src="https://habrastorage.org/files/469/e9d/477/469e9d477ad747f39a40291cfad1b0fa.gif" height="350" align="left"><img src="https://habrastorage.org/files/595/0b9/378/5950b9378053444ba6b86cdf831d5ad6.gif" height="350"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
So ist es jetzt einfacher denn je, Wi-Fi und ein Webinterface an irgendetwas zu „binden“. </font><font style="vertical-align: inherit;">Gleichzeitig arbeitet das System recht stabil und die Kosten für die Komponenten betragen nur etwa 250 Rubel (wenn Sie die gesamte Bindung berechnen, nicht nur das ESP8266-Modul selbst). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und so erschien das Webinterface des Geräts zum Schaukeln einer Krippe.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de386293/">https://habr.com/ru/post/de386293/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de386281/index.html">Fundraising für einen ungewöhnlichen Scanner, der auch mit Büchern schnell zurechtkommt</a></li>
<li><a href="../de386283/index.html">5 originelle Fälle von Marken, die sich durch Spiele bewerben</a></li>
<li><a href="../de386285/index.html">Vorstellung des LXBOX 3 Mini PC</a></li>
<li><a href="../de386287/index.html">Das kollektive Flugzeugrettungssystem wurde geschaffen. Dies ist nicht rentabel - Antwort bei Fluggesellschaften</a></li>
<li><a href="../de386291/index.html">Woraus, woraus, woraus bestehen unsere Roboter?</a></li>
<li><a href="../de386295/index.html">Der Google-Posteingang hilft jetzt bei der Beantwortung von E-Mails mithilfe von Hochtechnologie</a></li>
<li><a href="../de386297/index.html">Warten auf einen gemeinsamen Infospace</a></li>
<li><a href="../de386299/index.html">Samsung hat einen neuen Bio-Prozessor für tragbare Geräte angekündigt</a></li>
<li><a href="../de386301/index.html">Virgin Galactic wird im Februar 2016 die neue Version von SpaceShipTwo zeigen</a></li>
<li><a href="../de386303/index.html">Intelligente Lampe, die vor Dieben schützt. Beon Lieferungen begannen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>