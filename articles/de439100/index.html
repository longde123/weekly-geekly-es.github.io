<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèø üåñ üéÆ So passen Sie UX / UI unter Berechtigungen an üë¥üèæ ‚úåüèø üò¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Viele Projekte haben Authentifizierungsprozesse (bis zu dem einen oder anderen Grad). Viele Best Practices wurden in allen bekannten Technologien usw....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So passen Sie UX / UI unter Berechtigungen an</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439100/"><p>  Viele Projekte haben Authentifizierungsprozesse (bis zu dem einen oder anderen Grad).  Viele Best Practices wurden in allen bekannten Technologien usw. geschrieben.  usw. </p><br><p>  Aber der Benutzer hat sich angemeldet und?  Immerhin kann er nicht alles machen.  Wie man feststellt, was er sehen kann und was nicht.  Welche Schaltfl√§chen es zu dr√ºcken hat, welche k√∂nnen √§ndern, was erstellt oder gel√∂scht werden soll. </p><br><p>  In diesem Artikel m√∂chte ich einen Ansatz zur L√∂sung dieser Probleme in Webanwendungen betrachten. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/5c7/fbf/618/5c7fbf6189a80d53e873ce0138546c1b.gif" alt="Bild"></p><a name="habracut"></a><br><p> Eine echte / effektive Autorisierung kann zun√§chst nur auf dem Server erfolgen.  Im Front End k√∂nnen wir nur die Benutzeroberfl√§che verbessern (hmm, die russische Sprache ist m√§chtig, aber nicht immer ...), es ist auch die Benutzererfahrung jenseits von UX.  Wir k√∂nnen die Schaltfl√§chen ausblenden, auf die der Benutzer nicht klicken darf, oder ihn daran hindern, auf die Seite zuzugreifen, oder eine Meldung anzeigen, dass er keine Rechte an dieser oder jener Aktion hat. </p><br><p>  Und hier stellt sich die Frage, wie man es so richtig wie m√∂glich macht. </p><br><p>  Beginnen wir mit der Definition des Problems. </p><br><p>  Wir haben die Todo App erstellt und sie hat verschiedene Benutzertypen: </p><br><p>  <b>USER</b> - kann alle Aufgaben <b>anzeigen</b> und √§ndern (V setzen und entfernen), aber nicht l√∂schen oder erstellen und keine Statistiken anzeigen. </p><br><p>  <b>ADMIN</b> - kann alle Aufgaben <b>anzeigen</b> und neue erstellen, sieht jedoch keine Statistiken. </p><br><p>  <b>SUPER_ADMIN</b> - kann alle Aufgaben <b>anzeigen</b> , neue erstellen und l√∂schen, kann auch Statistiken <b>anzeigen</b> . </p><br><table><thead><tr><th></th><th>  Aufgabe anzeigen </th><th>  Aufgabe erstellen </th><th>  Aufgabe aktivieren / deaktivieren (Update) </th><th>  Aufgabe l√∂schen </th><th>  Statistiken anzeigen </th></tr></thead><tbody><tr><td>  USER </td><td>  V. </td><td>  X. </td><td>  V. </td><td>  X. </td><td>  X. </td></tr><tr><td>  Admin </td><td>  V. </td><td>  V. </td><td>  V. </td><td>  X. </td><td>  X. </td></tr><tr><td>  SUPER_ADMIN </td><td>  V. </td><td>  V. </td><td>  V. </td><td>  V. </td><td>  V. </td></tr></tbody></table><br><p>  In einer solchen Situation k√∂nnen wir mit den Rollen leicht auskommen.  Die Situation kann sich jedoch stark √§ndern.  Stellen Sie sich vor, es gibt einen Benutzer, der die gleichen Rechte wie <strong>ADMIN haben</strong> und Aufgaben l√∂schen muss.  Oder einfach <strong>USER</strong> mit der F√§higkeit, Statistiken zu sehen. </p><br><p>  Eine einfache L√∂sung besteht darin, neue Rollen zu erstellen. <br>  Auf gro√üen Systemen mit einer relativ gro√üen Anzahl von Benutzern verlieren wir uns jedoch schnell in einer gro√üen Anzahl von Rollen ... Und hier erinnern wir uns an die <em>Berechtigungen f√ºr</em> Benutzerrechte.  Zur einfacheren Verwaltung k√∂nnen wir Gruppen mit mehreren Berechtigungen erstellen und diese an den Benutzer anh√§ngen.  Es besteht immer die M√∂glichkeit, einem bestimmten Benutzer eine bestimmte Berechtigung hinzuzuf√ºgen. </p><br><p>  √Ñhnliche L√∂sungen finden sich in vielen gro√üartigen Diensten.  AWS, Google Cloud, SalesForce usw. <br>  √Ñhnliche L√∂sungen sind bereits in vielen Frameworks implementiert, beispielsweise in Django (Python). </p><br><p>  Ich m√∂chte ein Beispiel f√ºr die Implementierung f√ºr Angular-Anwendungen geben.  (Am Beispiel derselben ToDo-App). </p><br><p>  Zuerst m√ºssen Sie alle m√∂glichen Berechtigungen ermitteln. </p><br><p>  In Funktionen unterteilt </p><br><ol><li>  Wir haben Aufgaben und Statistiken. </li><li>  Wir bestimmen die m√∂glichen Aktionen mit jedem von ihnen. <br><ul><li>  Aufgabe: erstellen, lesen, aktualisieren, l√∂schen </li><li>  Statistik: Lesen (in unserem Beispiel nur Ansicht) </li></ul></li><li>  Erstellen Sie eine Karte (MAP) mit Rollen und Berechtigungen </li></ol><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> permissionsMap = { <span class="hljs-attr"><span class="hljs-attr">todos</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">create</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">read</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">update</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">delete</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">stats</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span> }</code> </pre> <br><p>  Meiner Meinung nach ist dies die beste Option, aber in den meisten F√§llen gibt der Server Folgendes zur√ºck: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> permissions = [ <span class="hljs-string"><span class="hljs-string">'todos_create'</span></span>, <span class="hljs-string"><span class="hljs-string">'todos_read'</span></span>, <span class="hljs-string"><span class="hljs-string">'todos_update'</span></span>, <span class="hljs-string"><span class="hljs-string">'todos_delete'</span></span>, <span class="hljs-string"><span class="hljs-string">'stas'</span></span> ]</code> </pre> <br><p>  Weniger lesbar, aber auch sehr gut. </p><br><p>  So sieht unsere Anwendung aus, wenn der Benutzer √ºber alle m√∂glichen Berechtigungen verf√ºgt. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f90/e2a/bdf/f90e2abdf79074b0d7951b769421cb3d.gif" alt="Bild"></p><br><p>  Beginnen wir mit USER. So sehen die Berechtigungen aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> USERpermissionsMap = { <span class="hljs-attr"><span class="hljs-attr">todos</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">read</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">update</span></span>:<span class="hljs-string"><span class="hljs-string">'*'</span></span>, } }</code> </pre> <br><p>  1) Der BENUTZER kann keine Statistiken sehen, dh er kann im Prinzip nicht zur Statistikseite gehen. </p><br><p>  In solchen Situationen verf√ºgt Angular √ºber Guards, die auf Routenebene registriert sind ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> ). </p><br><p>  In unserem Fall sieht es so aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> routes: Routes = [ <span class="hljs-comment"><span class="hljs-comment">// {...Other routes}, { path: 'stats', component: TodoStatisticsComponent, canActivate: [ PermissionsGuardService ], data: { permission: 'stats' }, } ];</span></span></code> </pre> <br><p>  Sie sollten auf das Objekt in den Daten achten. </p><br><p>  peremissions = 'stats', dies sind die Berechtigungen, √ºber die der Benutzer verf√ºgen muss, um auf diese Seite zugreifen zu k√∂nnen. </p><br><p>  Basierend auf den erforderlichen data.permissions und den Berechtigungen, die der PermissionsGuardService-Server uns erteilt hat, wird entschieden, ob USER auf die Seite '/ stats' gehen soll oder nicht. </p><br><pre> <code class="javascript hljs">@Injectable({ <span class="hljs-attr"><span class="hljs-attr">providedIn</span></span>: <span class="hljs-string"><span class="hljs-string">'root'</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PermissionsGuardService</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CanActivate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>( private store: Store&lt;any&gt;) { } canActivate(route: ActivatedRouteSnapshot, <span class="hljs-attr"><span class="hljs-attr">state</span></span>: RouterStateSnapshot): Observable&lt;boolean&gt; | boolean { <span class="hljs-comment"><span class="hljs-comment">// Required permission to continue navigation const required = route.data.permission; // User permissions that we got from server const userPerms = this.getPermissions(); // verification const isPermitted = checkPermissions(required, userPerms); if (!isPermitted) { alert('ROUTE GUARD SAYS: \n You don\'t have permissions to see this page'); } return isPermitted; } getPermissions() { return localStorage.get('userPermissions') } }</span></span></code> </pre> <br><p>  Diese Funktion enth√§lt die Entscheidungslogik - Gibt es eine unersetzliche Berechtigung (erforderlich) f√ºr alle Berechtigungen des USER (userPerms)? </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkPermissions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">required: string, userPerms</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// 1) Separate feature and action const [feature, action] = required.split('_'); // 2) Check if user have any type of access to the feature if (!userPerms.hasOwnProperty(feature)) { return false; } // 3) Check if user have permission for required action if (!userPerms[feature].hasOwnProperty(action)) { return false; } return true; }</span></span></code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/38f/a3c/7ea/38fa3c7ea79c42b5c245c347223be1f7.gif" alt="Bild"></p><br><p>  Und so.  Unser BENUTZER kann nicht zur Statistikseite gelangen.  Er kann jedoch weiterhin Aufgaben erstellen und l√∂schen. </p><br><p>  Damit USER die Aufgabe nicht entfernen kann, reicht es aus, das rote (X) aus der Aufgabenzeile zu entfernen. <br>  Zu diesem Zweck verwenden wir die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Strukturrichtlinie</a> . </p><br><pre> <code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Similar to other Structural Directives in angular (*ngIF, *ngFor..) we have '*' in directive name Input for directive is a required permission to see this btn. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> *</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">appPermissions</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"'todos_delete'"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"delete-button"</span></span></span><span class="hljs-tag"> (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span><span class="hljs-tag">)=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"removeSingleTodo()"</span></span></span><span class="hljs-tag">&gt;</span></span> X <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="javascript hljs">@Directive({ <span class="hljs-attr"><span class="hljs-attr">selector</span></span>: <span class="hljs-string"><span class="hljs-string">'[appPermissions]'</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PermissionsDirective</span></span></span><span class="hljs-class"> </span></span>{ private _required: string; private _viewRef: EmbeddedViewRef&lt;any&gt; | <span class="hljs-literal"><span class="hljs-literal">null</span></span> = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; private _templateRef: TemplateRef&lt;any&gt; | <span class="hljs-literal"><span class="hljs-literal">null</span></span> = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; @Input() set appPermissions(permission: string) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._required = permission; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._viewRef = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.init(); } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private templateRef: TemplateRef&lt;any&gt;, private viewContainerRef: ViewContainerRef) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._templateRef = templateRef; } init() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isPermitted = checkPermissions(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._required, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getPermissions()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isPermitted) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._viewRef = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.viewContainerRef.createEmbeddedView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.templateRef); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'PERMISSIONS DIRECTIVE says \n You don\'t have permissions to see it'</span></span>); } } getPermissions() { localStorage.get(<span class="hljs-string"><span class="hljs-string">'userPermissions'</span></span>) } }</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/50b/11c/e52/50b11ce5206ba632dbc272f8c5a7ca0b.gif" alt="Bild"></p><br><p>  Jetzt sieht USER die Schaltfl√§che L√ñSCHEN nicht, kann aber dennoch neue Aufgaben hinzuf√ºgen. </p><br><p>  Ein Eingabefeld zu entfernen - wird alle Arten unserer Anwendung verderben.  Die richtige L√∂sung in dieser Situation besteht darin <code>disable</code> Eingabefelder zu <code>disable</code> . </p><br><p>  Wir werden Rohr verwenden. </p><br><pre> <code class="javascript hljs">&lt;!-- <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a value <span class="hljs-string"><span class="hljs-string">`permissions`</span></span> pipe will get required permissions <span class="hljs-string"><span class="hljs-string">`permissions`</span></span> pipe <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> or <span class="hljs-literal"><span class="hljs-literal">false</span></span>, that<span class="hljs-string"><span class="hljs-string">'s why we have !('</span></span>todos_create<span class="hljs-string"><span class="hljs-string">' | permissions) to set disable=true if pipe returns false --&gt; &lt;input class="centered-block" [disabled]="!('</span></span>todos_create<span class="hljs-string"><span class="hljs-string">' | permissions)" placeholder="What needs to be done?" autofocus/&gt;</span></span></code> </pre> <br><pre> <code class="javascript hljs">@Pipe({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'permissions'</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PermissionsPipe</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PipeTransform</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private store: Store&lt;any&gt;) { } transform(required: any, args?: any): any { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isPermitted = checkPermissions(required, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getPermissions()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isPermitted) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'[PERMISSIONS PIPE] You don\'t have permissions'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } getPermissions() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> localStorage.get(<span class="hljs-string"><span class="hljs-string">'userPermissions'</span></span>) } }</code> </pre> <br><p>  Und jetzt kann USER nur Aufgaben sehen und √§ndern (V / X).  Wir haben jedoch noch eine weitere Schaltfl√§che mit dem Namen "L√∂schen abgeschlossen". </p><br><p>  Angenommen, wir haben die folgenden Anforderungen an den Produktmanager: </p><br><ol><li>  Die Schaltfl√§che "Abgeschlossen l√∂schen" sollte f√ºr alle und immer sichtbar sein. </li><li>  Es sollte auch anklickbar sein. </li><li>  Wenn USER ohne die entsprechenden Berechtigungen die Schaltfl√§che dr√ºckt, sollte eine Meldung angezeigt werden. </li></ol><br><p>  Bauanweisung wird uns nicht helfen, ebenso wie Rohr. <br>  Es ist auch nicht sehr bequem, Berechtigungspr√ºfungen in Komponentenfunktionen zu schreiben. </p><br><p>  Wir m√ºssen lediglich eine Berechtigungspr√ºfung zwischen dem Klick und der Ausf√ºhrung der gebundenen Funktion durchf√ºhren. </p><br><p>  Meiner Meinung nach lohnt es sich, Dekorateure einzusetzen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Permissions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">required</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">classProto, propertyKey, descriptor</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> originalFunction = descriptor.value; descriptor.value = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">...args: any[]</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userPerms = localStorage.get(<span class="hljs-string"><span class="hljs-string">'userPermissions'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isPermitted = checkPermissions(required, userPerms); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isPermitted) { originalFunction.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, args); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert(<span class="hljs-string"><span class="hljs-string">'you have no permissions \n [PERMISSIONS DECORATOR]'</span></span>); } }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> descriptor; }; }</code> </pre> <br><pre> <code class="javascript hljs">@Component({ <span class="hljs-attr"><span class="hljs-attr">selector</span></span>: <span class="hljs-string"><span class="hljs-string">'app-actions'</span></span>, <span class="hljs-attr"><span class="hljs-attr">templateUrl</span></span>: <span class="hljs-string"><span class="hljs-string">'./actions.component.html'</span></span>, <span class="hljs-attr"><span class="hljs-attr">styleUrls</span></span>: [<span class="hljs-string"><span class="hljs-string">'./actions.component.css'</span></span>] }) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionsComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnInit</span></span></span><span class="hljs-class"> </span></span>{ @Output() deleteCompleted = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventEmitter(); <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { } @Permissions(<span class="hljs-string"><span class="hljs-string">'todos_delete'</span></span>) public deleteCompleted() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.deleteCompleted.emit(); } }</code> </pre> <br><p>  Die Redner verdienen einen separaten Artikel. </p><br><p>  Unser Endergebnis: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f90/e2a/bdf/f90e2abdf79074b0d7951b769421cb3d.gif" alt="Bild"></p><br><p>  Das Ergebnis: </p><br><p>  Dieser Ansatz erm√∂glicht es uns, unsere UX einfach und dynamisch an die Berechtigungen des Benutzers anzupassen. </p><br><p>  Und am wichtigsten ist, dass wir daf√ºr nicht alle Komponenten in Services verschieben oder die '* ngIf'-Vorlagen einschlagen m√ºssen. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der gesamte Antrag ist vollst√§ndig</a> . </p><br><p>  Ich werde gerne einen Kommentar abgeben. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439100/">https://habr.com/ru/post/de439100/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439086/index.html">Ursachen von ANR und wie man es vermeidet</a></li>
<li><a href="../de439090/index.html">Die IBM 5150. Wo das Monopol begann</a></li>
<li><a href="../de439094/index.html">Wissenschaftler haben das √§lteste lebende Wirbeltier der Erde gefunden</a></li>
<li><a href="../de439096/index.html">Buildbot: eine Geschichte mit Beispielen eines anderen kontinuierlichen Integrationssystems</a></li>
<li><a href="../de439098/index.html">Sasha Memus, Chatfuel: Wie man nach Beratung eine Karriere in Produkten aufbaut, ist es gef√§hrlich zu meditieren und wie man Verhalten √§ndert</a></li>
<li><a href="../de439102/index.html">Russen sind 20% h√§ufiger im Internet beleidigt</a></li>
<li><a href="../de439104/index.html">Redux Einfach wie ein Rechen</a></li>
<li><a href="../de439108/index.html">Amateurfunkmessungen: Wenn kein Frequenzmesser vorhanden ist</a></li>
<li><a href="../de439110/index.html">Videospiel-Monster: Wie man Angst s√§t</a></li>
<li><a href="../de439112/index.html">Der Sch√∂pfer von Kate Mobile wurde wegen P√§dophiler verhaftet, der seinen Dienst in Anspruch nahm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>