<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍✈️ 🤳🏼 🕐 Maven-way para criar projetos Go 👨‍👩‍👦‍👦 🚵🏽 🧛🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primeiro, um pouco de fundo. No início de 2010, criei um pequeno utilitário de conversão de arquivos BIN do emulador BK-0010 para arquivos WAV. O util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maven-way para criar projetos Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465803/"><p>  Primeiro, um pouco de fundo.  No início de 2010, criei um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pequeno utilitário de conversão</a> de arquivos BIN do emulador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BK-0010</a> para arquivos WAV.  O utilitário foi escrito em Python com o objetivo de máxima portabilidade, funcionou sem problemas e eu me esqueci dele por um tempo.  Mas em 2016, o usuário apareceu, que não tinha idéia do Python e como instalá-lo.  Ele queria um monólito executável simples que "funcionasse".  Seu pedido me pareceu lógico e decidi refazer o utilitário como um conjunto de arquivos executáveis ​​binários para as principais plataformas. </p><br><p><img src="https://habrastorage.org/webt/dm/hq/kd/dmhqkdcz2pv6rlqs3af4f2_5jv4.png" alt="imagem"></p><br><p>  Python e Java não deram essa oportunidade (a não ser, é claro, que houvesse um desejo de aumentar o utilitário em muitas dezenas de megabytes).  Potencialmente, a solução poderia ser feita em C / C ++, mas com uma cobertura tão direcionada das plataformas, as dificuldades com a compilação cruzada iriam além do tempo alocado para a tarefa (e eu tive que oferecer suporte à montagem cruzada para Windows, Linux e MacOS em 64 e 32 bits opções).  Então, chamei a atenção para o idioma Go, que está ganhando popularidade, que já havia se tornado bastante maduro e o único que, <strong>sem "dançar com um pandeiro", fornece toda a compilação cruzada necessária logo de cara (!)</strong> . </p><a name="habracut"></a><br><p>  Um inconveniente que me incomodou muito com o Go (especialmente como desenvolvedor Java) foi a falta de consideração da organização da estrutura dos projetos Go e a necessidade de ajustar constantemente o ambiente.  Talvez os desenvolvedores do Go tenham planejado inicialmente algum uso específico ou houvesse um foco em contêineres, mas eu me acostumei com o "saboroso" e, como minha principal ferramenta em Java é o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Maven</a> , decidi criar um plug-in que faz chamadas para utilitários e comandos GoSDK com a geração automática dos necessários variáveis ​​de ambiente. </p><br><p> Não era interessante criar um plug-in simples que chamasse o utilitário go, e eu decidi ir da etapa - instalar o GoSDK na plataforma host.  Imediatamente após o início, a presença do GoSDK é verificada em seu diretório de configuração (eu escolhi o caminho padrão <code>~/.mvnGoLang</code> ) e, na ausência da versão necessária, o arquivo do GoSDK é automaticamente baixado e descompactado do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site oficial</a> .  Isso nos permitiu criar projetos portáteis Go sem se preocupar se a ferramenta da versão necessária está pré-instalada e configurada.  Obviamente, com muitas configurações, previ a possibilidade de usar uma versão pré-instalada e adicionei configurações para todas as etapas do processo, pois para muitos problemas, como desativar a verificação do certificado SSL ou geralmente fazer solicitações HTTP fora (como no projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Keycloak</a> ), são <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">essenciais</a> . </p><br><p>  O próximo passo, envolvi nos objetivos do Maven (objetivos) todos os comandos do utilitário go fornecidos naquele momento.  Como havia a chance de outro novo comando aparecer com a nova versão do GoSDK, uma tarefa <code>custom</code> foi adicionada, permitindo que o usuário determinasse o comando desejado por conta própria.  Por padrão, dentro da estrutura de maven-phase (phase), as tarefas são executadas na seguinte ordem: </p><br><ul><li>  <strong>limpo</strong> como <code>default-clean</code> na fase <em>limpa</em> </li><li>  <strong>corrigir</strong> como <strong>correção</strong> <code>default-fix</code> na fase de <em>validação</em> </li><li>  <strong>obter</strong> como <code>default-get</code> na fase de <em>inicialização</em> </li><li>  <strong>gerar</strong> como <code>default-generate</code> na fase <em>gerar-fontes</em> </li><li>  <strong>fmt</strong> como <code>default-fmt</code> na fase de <em>fontes de processo</em> </li><li>  <strong>teste</strong> como <strong>teste</strong> <code>default-test</code> na fase de <em>teste</em> </li><li>  <strong>construir</strong> como <strong>construção</strong> <code>default-build</code> na fase do <em>pacote</em> </li><li>  como <code>default-install</code> tarefa interna <strong>mvninstall</strong> é <strong>executada</strong> na fase de <em>instalação</em> </li><li>  <strong>instalar</strong> como <code>default-deploy</code> na fase de <em>implantação</em> </li></ul><br><p>  Qualquer uma das etapas básicas pode ser desabilitada convertendo a tarefa em uma fase inexistente: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>default-fix<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span>none<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Na implementação interna, as tarefas foram divididas em “trabalhando com dependências” e “não exigindo resolução de dependência”, após o surgimento do suporte ao modo de módulo, mais migrado para “trabalhando com dependências”. </p><br><p>  A estrutura do projeto Go-maven, tentei me aproximar da estrutura de pastas padrão aceita para Go (ou seja, <code>/src</code> e <code>/bin</code> na raiz do projeto).  Mas como o Maven está preso no Java, não foi possível "quebrar" diretamente sua abordagem para organizar a estrutura do projeto e tornar essa etapa invisível para o usuário; portanto, a configuração básica do plug-in parece um pouco incomum, mesmo para muitos familiarizados com o maven: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> ```${basedir}/src<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sourceDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-wrapper<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span>1.12.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><blockquote>  <strong>ATENÇÃO!</strong>  Por alguma razão, o HabR pode exibir incorretamente a <code>&lt;sourceDirectory&gt;${basedir}/src&lt;/sourceDirectory&gt;</code> ao formatar XML </blockquote><p>  Como você pode ver, você precisa determinar diretamente a pasta de origem <code>/src</code> e a pasta com o resultado <code>/bin</code> .  Por um lado, isso é um sinal de menos, por outro lado, a possibilidade de alterar sua localização. </p><br><p>  Todo o pom.xml minimalista de um projeto de módulo único, no mundo Hello, é o seguinte: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-helloworld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> ```${basedir}/src<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sourceDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-wrapper<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span>1.12.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Observe que a embalagem do projeto é designada como <strong>mvn-golang</strong> .  Essa configuração é suficiente para criar o arquivo executável e colocá-lo na pasta bin resultante com base nos textos de origem na pasta src.  O cache de compilação Go também será criado na <code>/bin</code> (como <code>/bin/.goBuildCache</code> por padrão) e será apagado com a limpeza desta pasta temporária. </p><br><p>  Na fase de <em>instalação</em> , a tarefa interna <code>mvninstall</code> é <code>mvninstall</code> , que simplesmente empacota o projeto inteiro em um arquivo zip e o coloca no repositório maven como um artefato gerado.  Inicialmente, eu apenas armazenei esses artefatos, mas a partir da versão 2.3.2, um mecanismo foi adicionado para suportá-los como dependências padrão do maven e tornou-se possível desenvolver projetos com "compartilhamento" de código comum por meio do repositório do maven.  Está claro que colocar os resultados binários gerados no repositório como artefatos é uma má idéia devido a requisitos de plataforma cruzada e, portanto, o conteúdo da pasta <code>/bin</code> não é empacotado no artefato. </p><br><p>  Conectar outro projeto com o <em>empacotamento</em> <code>mvn-golang</code> como uma dependência <code>mvn-golang</code> é algo como isto: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-go-test-mix-terminal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Com a versão 2.3.3, foi adicionado suporte para trabalhar com o mecanismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Go</a> dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">módulos</a> , mas, por padrão, ele não é ativado (para compatibilidade com versões anteriores) e é ativado usando o parâmetro de configuração: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">moduleMode</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">moduleMode</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Quando o mecanismo dos módulos Go ainda estava em fase experimental, adicionei suporte para trabalhar com versões de dependência por meio de chamadas diretas aos utilitários do CVS, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um exemplo de teste</a> foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">feito</a> .  Mas agora acho que esse mecanismo não é mais de grande interesse e é mais lucrativo usar dependências padrão por meio de módulos.  Além disso, o plug-in é capaz de pré-processar os arquivos <code>go.mod</code> no momento da criação do projeto, substituindo os caminhos para as pastas locais, se o trabalho estiver em andamento na estrutura de um projeto com vários módulos. </p><br><p>  Como o Maven prevê a possibilidade de padronização usando arquétipos, criei dois arquétipos: </p><br><ul><li>  <em>com.igormaznitsa: mvn-golang-hello: 2.3.3</em> para um arquétipo de módulo único simples </li><li>  <em>com.igormaznitsa: mvn-golang-hello-multi: 2.3.3</em> para um projeto de vários módulos com código-fonte compartilhado </li></ul><br><p>  Um exemplo de trabalho com o arquétipo de um projeto de módulo único pode ser visto na animação abaixo <br><img src="https://habrastorage.org/webt/xj/l4/as/xjl4ashjm59in1djzr0hvsjqqkg.gif" alt="imagem">  . </p><br><p>  Você também pode clonar o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Hello World"</a> e brincar: </p><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/raydac/mvn-golang-example.git</code> </pre> <br><p><img src="https://habrastorage.org/webt/x6/d8/3f/x6d83f1hbq0ul2ewmrzgkdpg0eq.gif" alt="imagem"></p><br><p>  Muitas vezes, surge uma pergunta razoável - por que tudo isso é necessário e quais bônus o uso do Maven dá no processo de construção de um projeto Go?  Vou tentar responder ponto por ponto: </p><br><ol><li>  O Maven é um ambiente de criação de projetos de plataforma cruzada muito maduro, suportado por quase todas as plataformas de CI, por exemplo, Jenkins. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando o Go2XUnit,</a> você pode converter os resultados dos testes no formato exibido pelos plug-ins de relatórios. </li><li>  O Maven é multiplataforma e é suportado por todos os sistemas operacionais, sendo incluído em todos os repositórios.  A presença de perfis ativados de forma flexível facilita a personalização do processo para várias plataformas. </li><li>  O Maven possui uma <strong>enorme quantidade de plugins</strong> , o que facilita a obtenção de um efeito sinérgico, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combinando o Go e o GWT</a> , conectando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ANTLR</a> ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">projeto</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gerando o Go com base nos descritores do Protobuf</a> e até <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">adicionando pré-processamento</a> .  Tudo isso pode ser organizado manualmente por meio de arquivos em lote, mas se houver plug-ins oficiais suportados, é mais rentável usá-los. </li><li>  O projeto se torna facilmente portátil entre máquinas e plataformas, e a troca da versão do GoSDK é feita alterando uma linha. </li><li>  Facilidade de organização de projetos com vários módulos, com a separação do código-fonte através do repositório Maven. </li><li>  A ferramenta é familiar e familiar aos desenvolvedores Java, o que facilita sua adaptação ao mudar para o desenvolvimento no Golang ou ao desenvolver soluções multilíngues Go + Java. </li><li>  Existe a possibilidade de pseudo-desenvolvimento on Go em ambientes que suportam o Maven, mesmo se eles não tiverem suporte para esta plataforma, por exemplo, no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NetBeans IDE</a> . </li></ol><br><p>  A maior desvantagem da solução, na minha opinião, é uma aqui - um número limitado de desenvolvedores familiarizados com o Maven na comunidade Golang.  Para aqueles que mudaram para Golang com C / C ++, é claro que é difícil encontrar algo mais próximo e mais caro de fazer, assim como ninguém cancelou os sistemas Go-build "nativos".  Percebi que, por algum motivo, muitos desenvolvedores não gostam de misturar plataformas. </p><br><p>  Então, mostrei brevemente uma das maneiras de usar o Maven ao desenvolver projetos Go usando o plug-in mvn-golang-wrapper.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O projeto do plug-in foi criado como um projeto OSS e publicado no GitHub</a> .  Se alguém estiver interessado e usar em seus projetos, não hesite em fazer perguntas e "reportar bugs".  Tentei fazer um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conjunto de exemplos para diferentes ocasiões</a> (nas quais o plug-in está sendo testado), mas não posso cobrir tudo. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os exemplos de teste</a> no projeto de plug-in usam a versão dev, portanto, se você deseja criá-los localmente após a clonagem do projeto, primeiro você precisa criar a versão dev do plug-in usando o comando no diretório raiz do projeto: </p><br><pre> <code class="bash hljs">mvn install</code> </pre> <br><p>  após o qual, você pode acessar qualquer subprojeto <code>mvn-golang-examples</code> e construí-lo com </p><br><pre> <code class="bash hljs">mvn clean install</code> </pre> <br><p>  você também pode começar a criar todos os exemplos a partir da raiz do projeto, usando </p><br><pre> <code class="bash hljs">mvn clean install -Pexamples</code> </pre> <br><p>  O plug-in suporta montagem de projetos com vários threads e pode ser acelerado usando o argumento correspondente, dividindo, por exemplo, em 6 threads </p><br><pre> <code class="bash hljs">mvn clean install -Pexamples -T6</code> </pre> <br><p>  Durante o desenvolvimento, o projeto acumulou uma quantidade razoável de "sinos e assobios", que decidi não abordar neste pequeno artigo.  Informações sobre os parâmetros com pequenos exemplos de configuração podem ser encontradas no mapa mental deste plug-in (o arquivo de origem no formato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SciaReto</a> está <a href="">aqui</a> ): </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ro/yo/qr/royoqrdlvvlrwvjyiey5yigtnec.jpeg" alt="imagem"></a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt465803/">https://habr.com/ru/post/pt465803/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt465791/index.html">Vulnerabilidades de varejistas - três casos em que o OTP pode ser obtido na solicitação</a></li>
<li><a href="../pt465793/index.html">Frontend Weekly Digest (26 de agosto a 1 de setembro de 2019)</a></li>
<li><a href="../pt465795/index.html">O resumo de materiais frescos do mundo do front-end da última semana n ° 378 (26 de agosto a 1 de setembro de 2019)</a></li>
<li><a href="../pt465797/index.html">Algoritmos genéticos (ou o cliente é sempre rei - e muitas vezes um tolo)</a></li>
<li><a href="../pt465801/index.html">Food Design Digest, agosto de 2019</a></li>
<li><a href="../pt465805/index.html">Gigatron - um microcomputador caseiro sem processador</a></li>
<li><a href="../pt465807/index.html">A história de como a popular biblioteca JavaScript começou a exibir anúncios no terminal</a></li>
<li><a href="../pt465809/index.html">Não caia na armadilha da otimização prematura</a></li>
<li><a href="../pt465811/index.html">14 dicas para escrever um código React limpo. Parte 1</a></li>
<li><a href="../pt465813/index.html">14 dicas para escrever um código React limpo. Parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>