<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äç‚úàÔ∏è ü§≥üèº üïê Maven-way para criar projetos Go üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ üöµüèΩ üßõüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primeiro, um pouco de fundo. No in√≠cio de 2010, criei um pequeno utilit√°rio de convers√£o de arquivos BIN do emulador BK-0010 para arquivos WAV. O util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maven-way para criar projetos Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465803/"><p>  Primeiro, um pouco de fundo.  No in√≠cio de 2010, criei um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pequeno utilit√°rio de convers√£o</a> de arquivos BIN do emulador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BK-0010</a> para arquivos WAV.  O utilit√°rio foi escrito em Python com o objetivo de m√°xima portabilidade, funcionou sem problemas e eu me esqueci dele por um tempo.  Mas em 2016, o usu√°rio apareceu, que n√£o tinha id√©ia do Python e como instal√°-lo.  Ele queria um mon√≥lito execut√°vel simples que "funcionasse".  Seu pedido me pareceu l√≥gico e decidi refazer o utilit√°rio como um conjunto de arquivos execut√°veis ‚Äã‚Äãbin√°rios para as principais plataformas. </p><br><p><img src="https://habrastorage.org/webt/dm/hq/kd/dmhqkdcz2pv6rlqs3af4f2_5jv4.png" alt="imagem"></p><br><p>  Python e Java n√£o deram essa oportunidade (a n√£o ser, √© claro, que houvesse um desejo de aumentar o utilit√°rio em muitas dezenas de megabytes).  Potencialmente, a solu√ß√£o poderia ser feita em C / C ++, mas com uma cobertura t√£o direcionada das plataformas, as dificuldades com a compila√ß√£o cruzada iriam al√©m do tempo alocado para a tarefa (e eu tive que oferecer suporte √† montagem cruzada para Windows, Linux e MacOS em 64 e 32 bits op√ß√µes).  Ent√£o, chamei a aten√ß√£o para o idioma Go, que est√° ganhando popularidade, que j√° havia se tornado bastante maduro e o √∫nico que, <strong>sem "dan√ßar com um pandeiro", fornece toda a compila√ß√£o cruzada necess√°ria logo de cara (!)</strong> . </p><a name="habracut"></a><br><p>  Um inconveniente que me incomodou muito com o Go (especialmente como desenvolvedor Java) foi a falta de considera√ß√£o da organiza√ß√£o da estrutura dos projetos Go e a necessidade de ajustar constantemente o ambiente.  Talvez os desenvolvedores do Go tenham planejado inicialmente algum uso espec√≠fico ou houvesse um foco em cont√™ineres, mas eu me acostumei com o "saboroso" e, como minha principal ferramenta em Java √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Maven</a> , decidi criar um plug-in que faz chamadas para utilit√°rios e comandos GoSDK com a gera√ß√£o autom√°tica dos necess√°rios vari√°veis ‚Äã‚Äãde ambiente. </p><br><p> N√£o era interessante criar um plug-in simples que chamasse o utilit√°rio go, e eu decidi ir da etapa - instalar o GoSDK na plataforma host.  Imediatamente ap√≥s o in√≠cio, a presen√ßa do GoSDK √© verificada em seu diret√≥rio de configura√ß√£o (eu escolhi o caminho padr√£o <code>~/.mvnGoLang</code> ) e, na aus√™ncia da vers√£o necess√°ria, o arquivo do GoSDK √© automaticamente baixado e descompactado do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site oficial</a> .  Isso nos permitiu criar projetos port√°teis Go sem se preocupar se a ferramenta da vers√£o necess√°ria est√° pr√©-instalada e configurada.  Obviamente, com muitas configura√ß√µes, previ a possibilidade de usar uma vers√£o pr√©-instalada e adicionei configura√ß√µes para todas as etapas do processo, pois para muitos problemas, como desativar a verifica√ß√£o do certificado SSL ou geralmente fazer solicita√ß√µes HTTP fora (como no projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Keycloak</a> ), s√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">essenciais</a> . </p><br><p>  O pr√≥ximo passo, envolvi nos objetivos do Maven (objetivos) todos os comandos do utilit√°rio go fornecidos naquele momento.  Como havia a chance de outro novo comando aparecer com a nova vers√£o do GoSDK, uma tarefa <code>custom</code> foi adicionada, permitindo que o usu√°rio determinasse o comando desejado por conta pr√≥pria.  Por padr√£o, dentro da estrutura de maven-phase (phase), as tarefas s√£o executadas na seguinte ordem: </p><br><ul><li>  <strong>limpo</strong> como <code>default-clean</code> na fase <em>limpa</em> </li><li>  <strong>corrigir</strong> como <strong>corre√ß√£o</strong> <code>default-fix</code> na fase de <em>valida√ß√£o</em> </li><li>  <strong>obter</strong> como <code>default-get</code> na fase de <em>inicializa√ß√£o</em> </li><li>  <strong>gerar</strong> como <code>default-generate</code> na fase <em>gerar-fontes</em> </li><li>  <strong>fmt</strong> como <code>default-fmt</code> na fase de <em>fontes de processo</em> </li><li>  <strong>teste</strong> como <strong>teste</strong> <code>default-test</code> na fase de <em>teste</em> </li><li>  <strong>construir</strong> como <strong>constru√ß√£o</strong> <code>default-build</code> na fase do <em>pacote</em> </li><li>  como <code>default-install</code> tarefa interna <strong>mvninstall</strong> √© <strong>executada</strong> na fase de <em>instala√ß√£o</em> </li><li>  <strong>instalar</strong> como <code>default-deploy</code> na fase de <em>implanta√ß√£o</em> </li></ul><br><p>  Qualquer uma das etapas b√°sicas pode ser desabilitada convertendo a tarefa em uma fase inexistente: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>default-fix<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span>none<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phase</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Na implementa√ß√£o interna, as tarefas foram divididas em ‚Äútrabalhando com depend√™ncias‚Äù e ‚Äún√£o exigindo resolu√ß√£o de depend√™ncia‚Äù, ap√≥s o surgimento do suporte ao modo de m√≥dulo, mais migrado para ‚Äútrabalhando com depend√™ncias‚Äù. </p><br><p>  A estrutura do projeto Go-maven, tentei me aproximar da estrutura de pastas padr√£o aceita para Go (ou seja, <code>/src</code> e <code>/bin</code> na raiz do projeto).  Mas como o Maven est√° preso no Java, n√£o foi poss√≠vel "quebrar" diretamente sua abordagem para organizar a estrutura do projeto e tornar essa etapa invis√≠vel para o usu√°rio; portanto, a configura√ß√£o b√°sica do plug-in parece um pouco incomum, mesmo para muitos familiarizados com o maven: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> ```${basedir}/src<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sourceDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-wrapper<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span>1.12.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><blockquote>  <strong>ATEN√á√ÉO!</strong>  Por alguma raz√£o, o HabR pode exibir incorretamente a <code>&lt;sourceDirectory&gt;${basedir}/src&lt;/sourceDirectory&gt;</code> ao formatar XML </blockquote><p>  Como voc√™ pode ver, voc√™ precisa determinar diretamente a pasta de origem <code>/src</code> e a pasta com o resultado <code>/bin</code> .  Por um lado, isso √© um sinal de menos, por outro lado, a possibilidade de alterar sua localiza√ß√£o. </p><br><p>  Todo o pom.xml minimalista de um projeto de m√≥dulo √∫nico, no mundo Hello, √© o seguinte: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-helloworld<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> ```${basedir}/src<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sourceDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/bin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang-wrapper<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.3.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span>1.12.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugins</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Observe que a embalagem do projeto √© designada como <strong>mvn-golang</strong> .  Essa configura√ß√£o √© suficiente para criar o arquivo execut√°vel e coloc√°-lo na pasta bin resultante com base nos textos de origem na pasta src.  O cache de compila√ß√£o Go tamb√©m ser√° criado na <code>/bin</code> (como <code>/bin/.goBuildCache</code> por padr√£o) e ser√° apagado com a limpeza desta pasta tempor√°ria. </p><br><p>  Na fase de <em>instala√ß√£o</em> , a tarefa interna <code>mvninstall</code> √© <code>mvninstall</code> , que simplesmente empacota o projeto inteiro em um arquivo zip e o coloca no reposit√≥rio maven como um artefato gerado.  Inicialmente, eu apenas armazenei esses artefatos, mas a partir da vers√£o 2.3.2, um mecanismo foi adicionado para suport√°-los como depend√™ncias padr√£o do maven e tornou-se poss√≠vel desenvolver projetos com "compartilhamento" de c√≥digo comum por meio do reposit√≥rio do maven.  Est√° claro que colocar os resultados bin√°rios gerados no reposit√≥rio como artefatos √© uma m√° id√©ia devido a requisitos de plataforma cruzada e, portanto, o conte√∫do da pasta <code>/bin</code> n√£o √© empacotado no artefato. </p><br><p>  Conectar outro projeto com o <em>empacotamento</em> <code>mvn-golang</code> como uma depend√™ncia <code>mvn-golang</code> √© algo como isto: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.igormaznitsa<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-go-test-mix-terminal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-golang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Com a vers√£o 2.3.3, foi adicionado suporte para trabalhar com o mecanismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Go</a> dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√≥dulos</a> , mas, por padr√£o, ele n√£o √© ativado (para compatibilidade com vers√µes anteriores) e √© ativado usando o par√¢metro de configura√ß√£o: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">moduleMode</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">moduleMode</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Quando o mecanismo dos m√≥dulos Go ainda estava em fase experimental, adicionei suporte para trabalhar com vers√µes de depend√™ncia por meio de chamadas diretas aos utilit√°rios do CVS, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um exemplo de teste</a> foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">feito</a> .  Mas agora acho que esse mecanismo n√£o √© mais de grande interesse e √© mais lucrativo usar depend√™ncias padr√£o por meio de m√≥dulos.  Al√©m disso, o plug-in √© capaz de pr√©-processar os arquivos <code>go.mod</code> no momento da cria√ß√£o do projeto, substituindo os caminhos para as pastas locais, se o trabalho estiver em andamento na estrutura de um projeto com v√°rios m√≥dulos. </p><br><p>  Como o Maven prev√™ a possibilidade de padroniza√ß√£o usando arqu√©tipos, criei dois arqu√©tipos: </p><br><ul><li>  <em>com.igormaznitsa: mvn-golang-hello: 2.3.3</em> para um arqu√©tipo de m√≥dulo √∫nico simples </li><li>  <em>com.igormaznitsa: mvn-golang-hello-multi: 2.3.3</em> para um projeto de v√°rios m√≥dulos com c√≥digo-fonte compartilhado </li></ul><br><p>  Um exemplo de trabalho com o arqu√©tipo de um projeto de m√≥dulo √∫nico pode ser visto na anima√ß√£o abaixo <br><img src="https://habrastorage.org/webt/xj/l4/as/xjl4ashjm59in1djzr0hvsjqqkg.gif" alt="imagem">  . </p><br><p>  Voc√™ tamb√©m pode clonar o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Hello World"</a> e brincar: </p><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/raydac/mvn-golang-example.git</code> </pre> <br><p><img src="https://habrastorage.org/webt/x6/d8/3f/x6d83f1hbq0ul2ewmrzgkdpg0eq.gif" alt="imagem"></p><br><p>  Muitas vezes, surge uma pergunta razo√°vel - por que tudo isso √© necess√°rio e quais b√¥nus o uso do Maven d√° no processo de constru√ß√£o de um projeto Go?  Vou tentar responder ponto por ponto: </p><br><ol><li>  O Maven √© um ambiente de cria√ß√£o de projetos de plataforma cruzada muito maduro, suportado por quase todas as plataformas de CI, por exemplo, Jenkins. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando o Go2XUnit,</a> voc√™ pode converter os resultados dos testes no formato exibido pelos plug-ins de relat√≥rios. </li><li>  O Maven √© multiplataforma e √© suportado por todos os sistemas operacionais, sendo inclu√≠do em todos os reposit√≥rios.  A presen√ßa de perfis ativados de forma flex√≠vel facilita a personaliza√ß√£o do processo para v√°rias plataformas. </li><li>  O Maven possui uma <strong>enorme quantidade de plugins</strong> , o que facilita a obten√ß√£o de um efeito sin√©rgico, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combinando o Go e o GWT</a> , conectando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ANTLR</a> ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">projeto</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gerando o Go com base nos descritores do Protobuf</a> e at√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">adicionando pr√©-processamento</a> .  Tudo isso pode ser organizado manualmente por meio de arquivos em lote, mas se houver plug-ins oficiais suportados, √© mais rent√°vel us√°-los. </li><li>  O projeto se torna facilmente port√°til entre m√°quinas e plataformas, e a troca da vers√£o do GoSDK √© feita alterando uma linha. </li><li>  Facilidade de organiza√ß√£o de projetos com v√°rios m√≥dulos, com a separa√ß√£o do c√≥digo-fonte atrav√©s do reposit√≥rio Maven. </li><li>  A ferramenta √© familiar e familiar aos desenvolvedores Java, o que facilita sua adapta√ß√£o ao mudar para o desenvolvimento no Golang ou ao desenvolver solu√ß√µes multil√≠ngues Go + Java. </li><li>  Existe a possibilidade de pseudo-desenvolvimento on Go em ambientes que suportam o Maven, mesmo se eles n√£o tiverem suporte para esta plataforma, por exemplo, no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NetBeans IDE</a> . </li></ol><br><p>  A maior desvantagem da solu√ß√£o, na minha opini√£o, √© uma aqui - um n√∫mero limitado de desenvolvedores familiarizados com o Maven na comunidade Golang.  Para aqueles que mudaram para Golang com C / C ++, √© claro que √© dif√≠cil encontrar algo mais pr√≥ximo e mais caro de fazer, assim como ningu√©m cancelou os sistemas Go-build "nativos".  Percebi que, por algum motivo, muitos desenvolvedores n√£o gostam de misturar plataformas. </p><br><p>  Ent√£o, mostrei brevemente uma das maneiras de usar o Maven ao desenvolver projetos Go usando o plug-in mvn-golang-wrapper.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O projeto do plug-in foi criado como um projeto OSS e publicado no GitHub</a> .  Se algu√©m estiver interessado e usar em seus projetos, n√£o hesite em fazer perguntas e "reportar bugs".  Tentei fazer um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conjunto de exemplos para diferentes ocasi√µes</a> (nas quais o plug-in est√° sendo testado), mas n√£o posso cobrir tudo. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os exemplos de teste</a> no projeto de plug-in usam a vers√£o dev, portanto, se voc√™ deseja cri√°-los localmente ap√≥s a clonagem do projeto, primeiro voc√™ precisa criar a vers√£o dev do plug-in usando o comando no diret√≥rio raiz do projeto: </p><br><pre> <code class="bash hljs">mvn install</code> </pre> <br><p>  ap√≥s o qual, voc√™ pode acessar qualquer subprojeto <code>mvn-golang-examples</code> e constru√≠-lo com </p><br><pre> <code class="bash hljs">mvn clean install</code> </pre> <br><p>  voc√™ tamb√©m pode come√ßar a criar todos os exemplos a partir da raiz do projeto, usando </p><br><pre> <code class="bash hljs">mvn clean install -Pexamples</code> </pre> <br><p>  O plug-in suporta montagem de projetos com v√°rios threads e pode ser acelerado usando o argumento correspondente, dividindo, por exemplo, em 6 threads </p><br><pre> <code class="bash hljs">mvn clean install -Pexamples -T6</code> </pre> <br><p>  Durante o desenvolvimento, o projeto acumulou uma quantidade razo√°vel de "sinos e assobios", que decidi n√£o abordar neste pequeno artigo.  Informa√ß√µes sobre os par√¢metros com pequenos exemplos de configura√ß√£o podem ser encontradas no mapa mental deste plug-in (o arquivo de origem no formato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SciaReto</a> est√° <a href="">aqui</a> ): </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ro/yo/qr/royoqrdlvvlrwvjyiey5yigtnec.jpeg" alt="imagem"></a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt465803/">https://habr.com/ru/post/pt465803/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt465791/index.html">Vulnerabilidades de varejistas - tr√™s casos em que o OTP pode ser obtido na solicita√ß√£o</a></li>
<li><a href="../pt465793/index.html">Frontend Weekly Digest (26 de agosto a 1 de setembro de 2019)</a></li>
<li><a href="../pt465795/index.html">O resumo de materiais frescos do mundo do front-end da √∫ltima semana n ¬∞ 378 (26 de agosto a 1 de setembro de 2019)</a></li>
<li><a href="../pt465797/index.html">Algoritmos gen√©ticos (ou o cliente √© sempre rei - e muitas vezes um tolo)</a></li>
<li><a href="../pt465801/index.html">Food Design Digest, agosto de 2019</a></li>
<li><a href="../pt465805/index.html">Gigatron - um microcomputador caseiro sem processador</a></li>
<li><a href="../pt465807/index.html">A hist√≥ria de como a popular biblioteca JavaScript come√ßou a exibir an√∫ncios no terminal</a></li>
<li><a href="../pt465809/index.html">N√£o caia na armadilha da otimiza√ß√£o prematura</a></li>
<li><a href="../pt465811/index.html">14 dicas para escrever um c√≥digo React limpo. Parte 1</a></li>
<li><a href="../pt465813/index.html">14 dicas para escrever um c√≥digo React limpo. Parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>