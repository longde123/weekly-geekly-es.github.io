<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ğŸ§–ğŸ¼ ğŸ¤¦ğŸ½ Maschinelles Lernen fÃ¼r Ihre Wohnungssuche. Teil 2 ğŸ‘ˆ ğŸ”‡ ğŸ˜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A. A. A. A. A. A. A. A. A. A. A. A. A. A.  
 Haben Sie Ã¼ber den Einfluss der nÃ¤chstgelegenen U-Bahn auf den Preis Ihrer Wohnung nachgedacht? A. A. 
 A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Maschinelles Lernen fÃ¼r Ihre Wohnungssuche. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470710/"><p>  A. A. A. A. A. A. A. A. A. A. A. A. A. A. <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"></span> <br>  Haben Sie Ã¼ber den Einfluss der nÃ¤chstgelegenen U-Bahn auf den Preis Ihrer Wohnung nachgedacht?  A. A. <br>  A. A. A. A. Was ist mit mehreren KindergÃ¤rten in Ihrer Wohnung?  Sind Sie bereit, in die Welt der Geodaten einzutauchen? </p><br><p>  A. A. <img src="https://habrastorage.org/webt/mk/hb/cd/mkhbcdjqdoilsw7psuegvtv25r0.png" alt="Die Welt bietet so viel Informati on ...">  A. A. <br>  A. A. A. A. <br>  A. A. <a name="habracut"></a></p><br><h2 id="what-is-all-about">  Worum geht es? </h2><br><p>  A. A. <br>  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorigen Teil</a> hatten wir einige Daten und haben versucht, ein ausreichend gutes Angebot auf einem Immobilienmarkt in Jekaterinburg zu finden. </p><br><p> Wir waren an einem Punkt angekommen, an dem wir eine Genauigkeit bei der Kreuzvalidierung nahe 73% hatten.  Jede MÃ¼nze hat jedoch 2 Seiten.  Und 73% Genauigkeit sind 27% Fehler.  Wie kÃ¶nnten wir das weniger machen?  Was ist der nÃ¤chste Schritt? </p><br><p>  A. A. </p><br><h2 id="spatial-data-is-coming-to-help">  Geodaten helfen dabei </h2><br><p>  Was ist mit mehr Daten aus der Umgebung?  Wir kÃ¶nnen Geokontext und einige rÃ¤umliche Daten verwenden. <br>  A. A. <br>  Selten verbringen Menschen ihr ganzes Leben zu Hause.  A. A. Manchmal gehen sie in GeschÃ¤fte, nehmen Kinder aus der KindertagesstÃ¤tte.  Ihre Kinder wachsen auf und gehen zur Schule, zur UniversitÃ¤t usw.  A. A. </p><br><p>  Oder ... Manchmal brauchen sie medizinische Hilfe und suchen ein Krankenhaus.  Und eine sehr wichtige Sache ist der Ã¶ffentliche Verkehr, zumindest die U-Bahn. A. A. Mit anderen Worten, es gibt viele Dinge in der NÃ¤he, die sich auf die Preisgestaltung auswirken. </p><br><p>  Lassen Sie mich Ihnen eine Liste von ihnen zeigen: </p><br><ul><li>  Ã–ffentliche Verkehrsmittel halten an </li><li>  GeschÃ¤fte </li><li>  KindergÃ¤rten </li><li>  KrankenhÃ¤user / medizinische Einrichtungen A. A. A. A. A. A. A. A. A. A. A. A.  A. A. A. A. A. A. </li><li>  Bildungseinrichtungen A. A. A. A. A. A. A. A. A. A. A. A.  A. A. A. A. A. A. </li><li>  U-Bahn </li></ul><br><h3 id="visualization-for-new-data">  Visualisierung fÃ¼r neue Daten </h3><br><p>  Nachdem Sie diese Informationen erhalten haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">A. A. Verschiedene Quellen A. A. A. A.</a> Ich habe eine Visualisierung gemacht. </p><br><p>  A. A. <br>  A. A. <img src="https://habrastorage.org/webt/ws/au/w5/wsauw53wky7lkl0ffzklyiyomg4.png">  A. A. A. A. A. A. A. A. <br>  Es gibt einige Punkte auf der Karte, der prestigetrÃ¤chtigste (und teuerste) Bezirk von Yek Aterinburg. A. A. A. A. A. A. A. A. A. A. <br>  A. A. A. A. </p><br><ul><li>  A. A. A. A. A. A. A. A. R ed Punkte - Wohnungen </li><li>  <strong>O</strong> lief ge - stoppt </li><li>  Gelbe LÃ¤den </li><li>  <strong>G</strong> reen - KindergÃ¤rten </li><li>  <strong>B</strong> lue - Bildung </li><li>  <strong>Ich</strong> ndigo - medizinisch </li><li>  <strong>V</strong> iolet - Metro </li></ul><br><p>  Ja, ein Regenbogen ist hier. </p><br><h3 id="overview">  Ãœbersicht </h3><br><p>  Jetzt haben wir einen Datensatz, der an Geodaten gebunden ist und einige neue Informationen enthÃ¤lt </p><br><pre><code class="python hljs">df.head(<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/pn/wp/2g/pnwp2gqzcxbt25nmahbmri2g9fu.png"></p><br><pre> <code class="python hljs">df.describe()</code> </pre><br><p><img src="https://habrastorage.org/webt/r2/vj/cx/r2vjcx5myydbcx8vqo1p4pneea8.png"></p><br><h2 id="a-good-old-model">  Ein gutes altes Modell </h2><br><p>  Versuchen Sie es genauso wie zuvor </p><br><pre> <code class="python hljs">y = df.cost X = df.drop(columns=[<span class="hljs-string"><span class="hljs-string">'cost'</span></span>]) X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number"><span class="hljs-number">0.2</span></span>,random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>)</code> </pre> <br><p>  Dann trainieren wir unser Modell erneut, drÃ¼cken die Daumen und versuchen erneut, den Preis fÃ¼r eine Wohnung vorherzusagen. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LinearRegression regressor = LinearRegression() model = regressor.fit(X_train, y_train) do_cross_validation(X_test, y_test, model)</code> </pre> <br><p><img src="https://habrastorage.org/webt/e_/af/fl/e_affl53a0ey291a3_rzscwst20.png"></p><br><p>  Hmm ... es sieht mit 73% Genauigkeit besser aus als das vorherige Ergebnis. <br>  Was ist mit Interpretationsversuchen?  Unser VorgÃ¤ngermodell hatte eine ausreichende FÃ¤higkeit, den Pauschalpreis zu erklÃ¤ren. </p><br><pre> <code class="python hljs">estimate_model(regressor)</code> </pre> <br><p><img src="https://habrastorage.org/webt/tv/db/vs/tvdbvsugcwrsekxthskddg0uyto.png"></p><br><p>  Ups ... Unser neues Modell funktioniert gut mit alten Funktionen, aber das Verhalten mit neuen scheint seltsam. </p><br><p>  Zum Beispiel fÃ¼hrt die grÃ¶ÃŸere Anzahl von Bildungseinrichtungen oder medizinischen Einrichtungen zu einem RÃ¼ckgang des Wohnungspreises.  Dementsprechend ist die Anzahl der Haltestellen in der NÃ¤he der Wohnung identisch und sollte einen zusÃ¤tzlichen Beitrag zum Wohnungspreis leisten. <br>  Das neue Modell ist genauer, passt aber nicht zum wirklichen Leben. </p><br><h2 id="something-is-broken">  Etwas ist kaputt </h2><br><p>  Lassen Sie uns Ã¼berlegen, was passiert ist. </p><br><p>  ZunÃ¤chst mÃ¶chte ich Sie daran erinnern, dass das Hauptmerkmal unserer linearen Regression ... Ã¤hm ... LinearitÃ¤t ist.  Ja, Captain Obvious ist hier. </p><br><p>  Wenn Ihre Daten mit der Idee "Je grÃ¶ÃŸer / Leasing ist X, desto grÃ¶ÃŸer / Leasing wird Y" kompatibel sind, ist die lineare Regression ein gutes Werkzeug.  Geodaten sind jedoch komplexer als erwartet. </p><br><p>  Zum Beispiel: </p><br><ul><li>  Wenn sich in der NÃ¤he Ihrer Wohnung eine Bushaltestelle befindet, ist dies gut, aber wenn die Anzahl etwa 5 betrÃ¤gt, fÃ¼hrt dies zu einer lauten StraÃŸe, und die Leute mÃ¶chten es vermeiden, eine Wohnung in der NÃ¤he zu kaufen. </li><li>  Wenn es eine UniversitÃ¤t gibt, sollte sie einen guten Einfluss auf den Preis haben. <br>  Gleichzeitig ist eine Menge von Studenten in Ihrer NÃ¤he nicht so erfreut, wenn Sie keine sehr gesellige Person sind. </li><li>  Metro in der NÃ¤he Ihres Hauses ist gut, aber wenn Sie in einer Stunde zu FuÃŸ leben <br>  von der nÃ¤chsten U-Bahn - es sollte keinen Sinn machen. </li></ul><br><p>  Wie Sie sehen, hÃ¤ngt es von vielen Faktoren und Gesichtspunkten ab.  Und die Art unserer Geodaten ist nicht linear, wir kÃ¶nnen die Auswirkungen nicht extrapolieren. <br>  Warum funktioniert ein Modell mit bizarren Koeffizienten gleichzeitig besser als das vorherige? </p><br><pre> <code class="python hljs">plot.figure(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)) corr = df.corr()*<span class="hljs-number"><span class="hljs-number">100.0</span></span> sns.heatmap(corr[[<span class="hljs-string"><span class="hljs-string">'cost'</span></span>]], cmap= sns.diverging_palette(<span class="hljs-number"><span class="hljs-number">220</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), center=<span class="hljs-number"><span class="hljs-number">0</span></span>, linewidths=<span class="hljs-number"><span class="hljs-number">1</span></span>, cbar_kws={<span class="hljs-string"><span class="hljs-string">"shrink"</span></span>: <span class="hljs-number"><span class="hljs-number">.7</span></span>}, annot=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, fmt=<span class="hljs-string"><span class="hljs-string">".2f"</span></span>)ï»¿ï»¿ï»¿ï»¿</code> </pre> <br><p><img src="https://habrastorage.org/webt/qu/ja/fg/qujafgl6oqquabiiv_5eyyzhq18.png" alt="Die Korrelation mit dem Wohnungspreis"></p><br><p>  Es sieht interessant aus.  Wir haben das Ã¤hnliche Bild im vorherigen Teil gesehen. <br>  Es besteht eine negative Korrelation zwischen der Entfernung zur nÃ¤chsten U-Bahn und dem Preis.  Und dieser Faktor wirkt sich mehr auf die Genauigkeit aus als einige Ã¤ltere. </p><br><p>  <strong>In der Zwischenzeit</strong> arbeitet unser Modell chaotisch und sieht keine AbhÃ¤ngigkeiten zwischen aggregierten Daten und Zielvariablen.  Die Einfachheit der linearen Regression hat ihre eigenen Grenzen.  A. A. </p><br><h2 id="the-king-is-dead-long-live-the-king">  Der KÃ¶nig ist tot, es lebe der KÃ¶nig! </h2><br><p>  Und wenn eine lineare Regression fÃ¼r unseren Fall nicht geeignet ist, was kann besser sein?  Wenn nur unser Modell "schlauer" sein kÃ¶nnte ... </p><br><p>  GlÃ¼cklicherweise haben wir einen Ansatz, der besser sein sollte, weil er flexibler ist und Ã¼ber einen eingebauten Mechanismus verfÃ¼gt: "Mach das, wenn das das macht, sonst mach das". </p><br><p>  <strong>Der Entscheidungsbaum wird</strong> in der Szene angezeigt. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.tree <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DecisionTreeRegressor A decision tree can have a different depth, usually, it works well when depth <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> bigger. And the parameter of max depth has the biggest influence on the result. Let<span class="hljs-string"><span class="hljs-string">'s do some code for checking depth from 3 to 32 data = [] for x in range(3,32): regressor = DecisionTreeRegressor(max_depth=x,random_state=42) model = regressor.fit(X_train, y_train) accuracy = do_cross_validation(X, y, model) data.append({'</span></span>max_depth<span class="hljs-string"><span class="hljs-string">':x,'</span></span>accuracy<span class="hljs-string"><span class="hljs-string">':accuracy}) data = pd.DataFrame(data) ax = sns.lineplot(x="max_depth", y="accuracy", data=data) max_result = data.loc[data['</span></span>accuracy<span class="hljs-string"><span class="hljs-string">'].idxmax()] ax.set_title(f'</span></span>Max accuracy-{max_result.accuracy}\nDepth {max_result.max_depth} <span class="hljs-string"><span class="hljs-string">')</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/iq/q1/vp/iqq1vpflhxb2vgpfdqeum6th_vo.png" alt="&quot;Mehr&quot; bedeutet nicht &quot;Beste&quot;"></p><br><p>  Nun ... fÃ¼r eine Situation, in der die m A. A. Ax_depth eines Baumes ist gleich 8, die Genauigkeit liegt Ã¼ber 77. <br>  Und es wÃ¤re eine gute Leistung, wenn wir nicht Ã¼ber die Grenzen dieses Ansatzes nachdenken wÃ¼rden.  Lassen Sie uns einen Blick darauf werfen, wie es funktionieren wird <em>A. A. A. A. M ax_depht = 2 A. A. A. A.</em> A. A. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> IPython.core.display <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image, SVG <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.tree <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> export_graphviz <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> graphviz <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Source <span class="hljs-number"><span class="hljs-number">2</span></span>_level_regressor = DecisionTreeRegressor(max_depth=<span class="hljs-number"><span class="hljs-number">2</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) model = <span class="hljs-number"><span class="hljs-number">2</span></span>_level_regressor.fit(X_train, y_train) graph = Source(export_graphviz(model, out_file=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span> , feature_names=X.columns , filled = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) SVG(graph.pipe(format=<span class="hljs-string"><span class="hljs-string">'svg'</span></span>))</code> </pre> <br><p><img src="https://habrastorage.org/webt/tu/aq/nn/tuaqnnpvmhawqb4tmbn9rcix64u.png"></p><br><p>  Auf diesem Bild sehen wir, dass es nur 4 Varianten der Vorhersage gibt.  Wenn Sie <em>DecisionTreeRegressor verwenden</em> , funktioniert es anders als die <em>lineare Regression</em> .  Einfach anders.  Es wird kein Beitrag von Faktoren (Koeffizienten) verwendet, stattdessen verwendet <em>DecisionTreeRegressor</em> "Likelihood".  Und der Preis einer Wohnung wird der gleiche sein, den die vorhergesagte Wohnung am Ã¤hnlichsten hat. <br>  Wir kÃ¶nnen es zeigen, indem wir unseren Preis mit diesem Baum vorhersagen. </p><br><pre> <code class="python hljs">y = two_level_regressor.predict(X_test) errors = pd.DataFrame(data=y,columns=[<span class="hljs-string"><span class="hljs-string">'errors'</span></span>]) f, ax = plot.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>)) sns.countplot(x=<span class="hljs-string"><span class="hljs-string">"errors"</span></span>, data=errors)</code> </pre> <br><p><img src="https://habrastorage.org/webt/bw/kl/t3/bwklt3nvb65y2mdmfwlkj0_v_le.png"><br>  Und jede Ihrer Vorhersagen stimmt mit einem dieser Werte Ã¼berein.  Und wenn wir <em>max_depth</em> = 8 verwenden, kÃ¶nnen wir nicht mehr als 256 verschiedene Optionen fÃ¼r mehr als 2000 Wohnungen erwarten.  Vielleicht ist es gut fÃ¼r Klassifizierungsprobleme, aber es ist nicht flexibel genug fÃ¼r unseren Fall. </p><br><h2 id="wisdom-of-crowd">  Weisheit der Menge </h2><br><p>  Wenn Sie versuchen, das Ergebnis im Finale der Weltmeisterschaft vorherzusagen, besteht eine groÃŸe Wahrscheinlichkeit, dass Sie sich irren.  Wenn Sie alle Richter der Meisterschaft um eine Meinung bitten, haben Sie gleichzeitig bessere Chancen zu erraten.  Wenn Sie unabhÃ¤ngige Experten, Trainer, Richter fragen und dann mit Antworten zaubern, erhÃ¶hen sich Ihre Chancen erheblich.  Sieht aus wie eine Wahl eines PrÃ¤sidenten. </p><br><p>  Ein Ensemble aus mehreren "primitiven" BÃ¤umen kann mehr als jeder von ihnen geben.  Und <em>Rando mForestRegressor ist</em> ein Werkzeug, das wir verwenden werden </p><br><p>  Betrachten wir zunÃ¤chst die grundlegenden Parameter - <em>max_depth</em> , <em>max_features</em> und eine <em>Reihe von BÃ¤umen</em> im Modell. <br>  A. A. </p><br><h3 id="number-of-trees">  Anzahl der BÃ¤ume </h3><br><p>  In Ãœbereinstimmung mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Wie viele BÃ¤ume in einem zufÃ¤lligen Wald?"</a>  Die beste Wahl sind <strong>128 BÃ¤ume</strong> .  Eine weitere ErhÃ¶hung der Anzahl der BÃ¤ume fÃ¼hrt nicht zu einer signifikanten Verbesserung der Genauigkeit, sondern zu einer VerlÃ¤ngerung der Trainingszeit. </p><br><h3 id="maximal-number-of-features">  Maximale Anzahl von Funktionen </h3><br><p>  Derzeit verfÃ¼gt unser Modell Ã¼ber 12 Funktionen.  Die HÃ¤lfte von ihnen sind alte, die sich auf Merkmale der Wohnung beziehen, andere auf den Geokontext.  Also habe ich beschlossen, jedem von ihnen eine Chance zu geben.  Es seien <strong>6 Merkmale</strong> fÃ¼r einen Baum. </p><br><h3 id="maximal-depth-of-a-tree">  Maximale Tiefe eines Baumes </h3><br><p>  FÃ¼r diesen Parameter kÃ¶nnen wir eine Lernkurve analysieren. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestRegressor data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>): regressor = RandomForestRegressor(random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>, max_depth=x, n_estimators=<span class="hljs-number"><span class="hljs-number">128</span></span>,max_features=<span class="hljs-number"><span class="hljs-number">6</span></span>)ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿model = regressor.fit(X_train, y_train)ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿ï»¿accuracy = do_cross_validation(X, y, model) data.append({<span class="hljs-string"><span class="hljs-string">'max_depth'</span></span>:x,<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>:accuracy}) data = pd.DataFrame(data) f, ax = plot.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) sns.lineplot(x=<span class="hljs-string"><span class="hljs-string">"max_depth"</span></span>, y=<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>, data=data) max_result = data.loc[data[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>].idxmax()] ax.set_title(<span class="hljs-string"><span class="hljs-string">f'Max accuracy-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{max_result.accuracy}</span></span></span><span class="hljs-string">\nDepth </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{max_result.max_depth}</span></span></span><span class="hljs-string"> '</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/sl/mw/ca/slmwcayhk5w0tlediopsbku7dde.png" alt="86% der Genauigkeit ist erstaunlich"></p><br><p>  Whoa ... Ã¼ber 86% Genauigkeit bei <strong>max_depth = 16</strong> gegenÃ¼ber 77% bei einem <strong>Designbaum</strong> .  Es sieht toll aus, nicht wahr? </p><br><h2 id="conclusion">  Fazit </h2><br><p>  Nun ... jetzt haben wir ein besseres Vorhersageergebnis als die vorherigen, 86% stehen kurz vor dem Ziel.  Der letzte Schritt zur ÃœberprÃ¼fung - sehen wir uns die Wichtigkeit der Funktionen an.  Haben Geodaten unserem Modell Vorteile gebracht? </p><br><pre> <code class="python hljs">feat_importances = model.feature_importances_ feat_importances = pd.Series(feat_importances, index=X.columns) feat_importances.nlargest(<span class="hljs-number"><span class="hljs-number">5</span></span>).plot(kind=<span class="hljs-string"><span class="hljs-string">'barh'</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/cn/bm/im/cnbmimno-ma3r0qbqozoq7diwrw.png" alt="Die Top 5 der wichtigsten Funktionen"></p><br><p>  Einige alte Funktionen haben sich immer noch auf das Ergebnis ausgewirkt.  Gleichzeitig hat sich auch die Entfernung zur nÃ¤chsten U-Bahn und zu den KindergÃ¤rten ausgewirkt.  Und es klingt logisch. </p><br><p>  Ohne Zweifel haben uns Geodaten geholfen, unser Modell zu verbessern. </p><br><p>  <strong>Danke fÃ¼rs Lesen!</strong> </p><br><h2 id="ps">  PS </h2><br><p>  Unsere Reise ist noch nicht beendet.  Eine Genauigkeit von 86% ist ein enormes Ergebnis fÃ¼r reale Daten.  Inzwischen gibt es eine kleine LÃ¼cke zwischen 14% und 10% des mittleren Fehlers, die wir erwarten.  Im nÃ¤chsten Kapitel unserer Geschichte werden wir versuchen, diese Barriere zu Ã¼berwinden oder zumindest diesen Fehler zu verringern. A. A. A. A. A. A. A. A. A. A. A. A.  A. A. A. A. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Da</a> ist das IPython-Notebook </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de470710/">https://habr.com/ru/post/de470710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de470692/index.html">Wie wir eine neue Rosbank-Website erstellt haben und was daraus wurde</a></li>
<li><a href="../de470694/index.html">Auswahl einer E-Mail-Marketing-Plattform: Was ist fÃ¼r russische Unternehmen zu beachten?</a></li>
<li><a href="../de470696/index.html">Warum ist Kaldi gut fÃ¼r die Spracherkennung? (aktualisiert am 25.12.2019)</a></li>
<li><a href="../de470700/index.html">Tischplatte. Metallic Lautlos Ihre</a></li>
<li><a href="../de470706/index.html">Python + Keras + LSTM: Erstellen Sie in einer halben Stunde einen TextÃ¼bersetzer</a></li>
<li><a href="../de470714/index.html">Wie ich zum Digital Breakthrough Finale kam</a></li>
<li><a href="../de470718/index.html">"Algebraische Effekte" in der menschlichen Sprache</a></li>
<li><a href="../de470720/index.html">Wie schreibe ich einen intelligenten Vertrag mit Python Ã¼ber Ontologie? Teil 2: Speicher-API</a></li>
<li><a href="../de470722/index.html">Wie schreibe ich einen intelligenten Vertrag mit Python Ã¼ber Ontologie? Teil 3: Laufzeit-API</a></li>
<li><a href="../de470726/index.html">Wie man nicht routinemÃ¤ÃŸig ertrinkt oder unsere Erfahrung beim Vergleich von AWR-Dumps wÃ¤hrend Stresstests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>