<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘· ğŸ¥€ ğŸ™‹ğŸ¾ ASP.NET MVC-é€šè¿‡ADO.NETä½¿ç”¨MySQL ğŸ‘©ğŸ¿â€ğŸ’» ğŸ¤¾ğŸ¿ ğŸŒ¨ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¼ ç»ŸæŠ€æœ¯  è­¦å‘Šï¼šASP.NET MVCå’ŒADO.NETå‡å·²å¼ƒç”¨ã€‚ å»ºè®®å°†ASP.NET Coreä¸ç°ä»£ORMç»“åˆä½¿ç”¨ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æœ‰å…´è¶£ï¼Œè¯·é˜…è¯»ã€‚ 

 æˆ‘å¤§æ¦‚å·²ç»ä¸‰æ¬¡ä½¿ç”¨ASP.NET MVCã€‚ åœ¨ä½¿ç”¨ASP.NET WebFormsåå¹´åï¼Œåˆ‡æ¢åˆ°MVCæŠ€æœ¯æœ‰ç‚¹å›°éš¾ï¼Œå› ä¸ºå­˜åœ¨è®¸å¤šå·®å¼‚ï¼Œå› æ­¤åˆ—å‡º...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ASP.NET MVC-é€šè¿‡ADO.NETä½¿ç”¨MySQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482346/"><div class="spoiler">  <b class="spoiler_title">ä¼ ç»ŸæŠ€æœ¯</b> <div class="spoiler_text">  <b>è­¦å‘Šï¼šASP.NET MVCå’ŒADO.NETå‡å·²å¼ƒç”¨ã€‚</b>  <b>å»ºè®®å°†ASP.NET Coreä¸ç°ä»£ORMç»“åˆä½¿ç”¨ã€‚</b>  <b>ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æœ‰å…´è¶£ï¼Œè¯·é˜…è¯»ã€‚</b> <br></div></div><br> æˆ‘å¤§æ¦‚å·²ç»ä¸‰æ¬¡ä½¿ç”¨ASP.NET MVCã€‚ åœ¨ä½¿ç”¨ASP.NET WebFormsåå¹´åï¼Œåˆ‡æ¢åˆ°MVCæŠ€æœ¯æœ‰ç‚¹å›°éš¾ï¼Œå› ä¸ºå­˜åœ¨è®¸å¤šå·®å¼‚ï¼Œå› æ­¤åˆ—å‡ºè¿™äº›æŠ€æœ¯çš„å…±åŒç‚¹æ¯”è¾ƒå®¹æ˜“ï¼Œä½†.NET Frameworkåº“é™¤å¤–ã€‚ æˆ‘ä¸ä¼šåœ¨è¿™é‡Œå†™-MVCæ¯”WebFormsæ›´å¥½æˆ–æ›´å·®ï¼Œå®ƒä»¬éƒ½å¾ˆå¥½ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥åœ¨è¿™ä¸¤ç§æŠ€æœ¯ä¸Šæ„å»ºè‰¯å¥½çš„åº”ç”¨ç¨‹åºã€‚ å°½ç®¡æˆ‘æœ‰æƒ³æ³•ï¼Œä½†æˆ‘ä¹ŸæŠŠå¯¹TDDçš„éœ€æ±‚ç•™ç»™äº†æˆ‘ã€‚ <br><br> ç°åœ¨ï¼Œæˆ‘å°†è®¨è®ºæœ€æ ‡å‡†çš„ä»»åŠ¡-æ•°æ®çš„å¸¸è§„å·¥ä½œï¼šä»¥è¡¨æ ¼å½¢å¼æŸ¥çœ‹è®°å½•åˆ—è¡¨ï¼Œæ·»åŠ ï¼Œæ›´æ”¹å’Œåˆ é™¤æ•°æ®ï¼ˆCRUDæ“ä½œï¼‰ã€‚ ä½†æ˜¯ï¼Œç”±äºæŸç§åŸå› ï¼Œåœ¨å‡ ä¹æ‰€æœ‰ä¹¦ç±å’Œè®¸å¤šç”¨äºASP.NET MVCçš„Internetè§£å†³æ–¹æ¡ˆä¸­ï¼Œä»…é€šè¿‡ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰è€ƒè™‘è¯¥é€‰é¡¹ï¼šå®ä½“æ¡†æ¶ï¼ˆEFï¼‰æˆ–LINQ for SQLã€‚ æ¯«æ— ç–‘é—®ï¼Œè¿™äº›æŠ€æœ¯éƒ½æ˜¯æå¥½çš„ï¼Œæœ€åï¼Œç¨‹åºå‘˜å¯èƒ½ä¸ä¼šç†è§£-ä½†æ˜¯è¿™ç§éå¸¸ç›¸å…³çš„DBMSï¼ˆä»–æœ€æœ‰å¯èƒ½ä½¿ç”¨çš„ï¼‰é€šå¸¸æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»ç†è®ºä¸Šè®²ï¼Œç”šè‡³ä¸å†éœ€è¦SQLï¼šä»¥EFå’ŒDBMSçš„è¿æ¥å™¨å°†ç›¸äº’ç†è§£ã€‚  â€œè¿™é‡Œæ˜¯å¹¸ç¦-ä¸å†æœ‰ç¾ä¸½ã€‚â€ ä½†æ˜¯ï¼Œå¯¹äºé‚£äº›ä¸å®³æ€•é€šè¿‡ADO.NETæœºåˆ¶ç›´æ¥ä¸æ•°æ®åº“ä¸€èµ·å·¥ä½œçš„ç¨‹åºå‘˜ï¼Œé€šå¸¸å¹¶ä¸æ¸…æ¥š-é€šå¸¸ä»ä½•å¤„å¼€å§‹ä½¿ç”¨ASP.NET MVCä»¥åŠæ˜¯å¦æœ‰å¿…è¦ã€‚ <br><a name="habracut"></a><br> å¦å¤–ï¼Œä¾‹å¦‚ï¼Œå¯¹æˆ‘è€Œè¨€ï¼Œä¸€å¼€å§‹å®ƒç”±äºç¼ºä¹åœ¨ç½‘æ ¼è¡¨ä¸­æ˜¾ç¤ºæ•°æ®çš„ä¾¿æ·ç»„ä»¶è€Œé€ æˆäº†æ··ä¹±ã€‚ å¯ä»¥ç†è§£çš„æ˜¯ï¼Œå¼€å‘äººå‘˜æœ¬äººå¿…é¡»å®æ–½æ‰€æœ‰è¿™ä¸€åˆ‡ï¼Œæˆ–è€…ä»åŒ…ç®¡ç†å™¨ä¸­è·å–é€‚å½“çš„ä¸œè¥¿ã€‚ å¦‚æœåƒæˆ‘ä¸€æ ·ï¼Œæ‚¨å¯¹ASP.NET WebFormsä¸­çš„GridViewç»„ä»¶æ„Ÿåˆ°æ»¡æ„ï¼Œé‚£ä¹ˆå¯¹äºMVCï¼Œé™¤äº†Grid.mvcä¹‹å¤–ï¼Œå¾ˆéš¾æ‰¾åˆ°å¯æ¯”çš„ä¸œè¥¿ã€‚ ä½†æ˜¯ï¼Œæˆ‘å¯¹è¿™äº›ç»„ä»¶çš„ä¿¡ä»»ä¸è¶³ä»¥å°†å®ƒä»¬ç”¨äºè¶³å¤Ÿå¤§çš„é¡¹ç›®ã€‚ å¦‚æœä½¿ç”¨å®ƒä»¬ï¼Œåˆ™ç¨‹åºå‘˜å¼€å§‹ä¾èµ–äºå¦ä¸€ä¸ªå¼€å‘äººå‘˜ï¼Œè¯¥å¼€å‘äººå‘˜é¦–å…ˆä¸çŸ¥é“å¦‚ä½•ç¼–å†™æ­¤ç»„ä»¶ï¼ˆæ˜¯å¦å®šæ€§ï¼Ÿï¼‰ï¼Œå…¶æ¬¡ï¼Œä¸çŸ¥é“ä½•æ—¶ä»¥åŠå¦‚ä½•å®Œæˆè¯¥ç»„ä»¶ã€‚ æœ‰æ—¶ä¼¼ä¹ç”šè‡³å¯ä»¥æ‰©å±•è¯¥ç»„ä»¶å¹¶è¿›è¡Œè¿›ä¸€æ­¥çš„è§‚å¯Ÿï¼Œä½†æ˜¯ï¼Œå¦‚æœå¼€å‘äººå‘˜å®Œæˆäº†è¯¥ç»„ä»¶ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸é‡æ–°æŒ–æ˜ä»£ç æˆ–å°†ç»„ä»¶æ›´æ–°å†»ç»“åœ¨æŸä¸ªç‰ˆæœ¬ä¸Šã€‚ è€Œä¸”ï¼Œå¦‚æœå¼€å‘äººå‘˜ä¿®å¤äº†æ¼æ´ï¼Œåˆ™ä»ç„¶å¿…é¡»å‡çº§åˆ°æ–°ç‰ˆæœ¬ã€‚ å³ä½¿è¿‡æ¸¡åˆ°æ–°ç‰ˆæœ¬çš„MySQLè¿æ¥å™¨ï¼Œä¹Ÿä¼šå¼•èµ·æŸäº›é—®é¢˜ï¼Œå°½ç®¡å®ƒä»ç”±ä¸€å®¶å¤§å…¬å¸å¼€å‘ï¼Œä½†æ˜¯Nugetè½¯ä»¶åŒ…ç®¡ç†å™¨ä¸­çš„ä¼—å¤šâ€œè‡ªè¡Œè½¦â€åˆå¦‚ä½•å‘¢ï¼Ÿ <br><br> å› æ­¤ï¼Œåœ¨å¤„ç†ç”±MySQL DBMSå¤„ç†çš„æ•°æ®æ—¶ï¼Œè®©æˆ‘ä»¬å°è¯•å­¦ä¹ å¦‚ä½•åœ¨ASP.NET MVCä¸‹ç¼–å†™ã€‚ æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨<a href="https://yadi.sk/d/EArrZdGh_iVaJg" rel="nofollow">æ­¤åœ°å€è·å¾—</a> ï¼Œä¸‹é¢å°†é€šè¿‡å°é“¾æ¥å’Œè§£é‡Šéƒ¨åˆ†å‘ˆç°æ­¤ä»£ç ã€‚  <a href="https://example-mvc.azurewebsites.net/" rel="nofollow">åœ¨è¿™é‡Œ</a>æ‚¨å¯ä»¥çœ‹åˆ°è¯¥åº”ç”¨ç¨‹åºã€‚ <br><br><h2> åœ¨MySQLä¸­åˆ›å»ºæ•°æ®åº“ </h2><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SCHEMA</span></span> <span class="hljs-string"><span class="hljs-string">`example`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> <span class="hljs-string"><span class="hljs-string">`example`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`users`</span></span> ( <span class="hljs-string"><span class="hljs-string">`UserID`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT, <span class="hljs-string"><span class="hljs-string">`SupporterTier`</span></span> enum(<span class="hljs-string"><span class="hljs-string">'None'</span></span>,<span class="hljs-string"><span class="hljs-string">'Silver'</span></span>,<span class="hljs-string"><span class="hljs-string">'Gold'</span></span>,<span class="hljs-string"><span class="hljs-string">'Platinum'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'None'</span></span>, <span class="hljs-string"><span class="hljs-string">`Loginname`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`LanguageID`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">`Email`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`LastLoginDate`</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-string"><span class="hljs-string">`UserID`</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> <span class="hljs-string"><span class="hljs-string">`i_Loginname`</span></span> (<span class="hljs-string"><span class="hljs-string">`Loginname`</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> <span class="hljs-string"><span class="hljs-string">`i_Language_idx`</span></span> (<span class="hljs-string"><span class="hljs-string">`LanguageID`</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> <span class="hljs-string"><span class="hljs-string">`i_Language`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-string"><span class="hljs-string">`LanguageID`</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> <span class="hljs-string"><span class="hljs-string">`languages`</span></span> (<span class="hljs-string"><span class="hljs-string">`LanguageID`</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">InnoDB</span></span> AUTO_INCREMENT=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=utf8; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`languages`</span></span> ( <span class="hljs-string"><span class="hljs-string">`LanguageID`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT, <span class="hljs-string"><span class="hljs-string">`LanguageName`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">`Culture`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-string"><span class="hljs-string">`LanguageID`</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">InnoDB</span></span> AUTO_INCREMENT=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=utf8;</code> </pre> <br> æ•°æ®åº“ï¼ˆDBï¼‰å°†å¾ˆç®€å•ï¼Œå¹¶ä¸”ä»…ç”±ä¸¤ä¸ªè¡¨è¡¨ç¤ºï¼Œåœ¨<code>LanguageID</code>å­—æ®µä¸­ï¼Œå®ƒä»¬ä¹‹é—´å…·æœ‰ä¸€å¯¹å¤šçš„å…³ç³»ã€‚ è¿™æ ·ï¼Œæˆ‘å°†ä½¿éœ€è¦ä½¿ç”¨ä¸‹æ‹‰åˆ—è¡¨ä¸ºç”¨æˆ·é€‰æ‹©ä¸€ç§è¯­è¨€çš„æƒ…å†µå¤æ‚åŒ–ã€‚ å¦å¤–ï¼Œä¸ºæ–¹ä¾¿èµ·è§ï¼Œå¯¹äºç”¨æˆ·ï¼Œæˆ‘ä»¬è¿˜å°†å¼•å…¥<code>SupporterTier</code>å­—æ®µï¼Œè¯¥å­—æ®µå°†ç¡®å®šé€šè¿‡æšä¸¾æä¾›çš„ç”¨æˆ·æ”¯æŒçº§åˆ«ã€‚ ä¸ºäº†åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ä½¿ç”¨å‡ ä¹æ‰€æœ‰æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬æ·»åŠ äº†â€œæ—¥æœŸ/æ—¶é—´â€ç±»å‹çš„<code>LastLoginDate</code>å­—æ®µï¼Œè¯¥å­—æ®µå°†åœ¨ç”¨æˆ·ç™»å½•æ—¶ç”±åº”ç”¨ç¨‹åºæœ¬èº«å¡«å……ï¼ˆæœªåæ˜ åœ¨è¯¥é¡¹ç›®ä¸­ï¼‰ã€‚ <br><br><h2> å»ºç«‹ä¸“æ¡ˆ </h2><br><img src="https://habrastorage.org/webt/sm/4a/07/sm4a07w8etetdgvtnkhd5i-wjcu.png"><br><br> é€‰æ‹©â€œ MVCâ€ã€‚ å¯ä»¥ä½¿ç”¨â€œç©ºâ€ï¼Œä½†æ˜¯æˆ‘ä»¬ç»è¿‡åŸ¹è®­ï¼Œè€Œä¸æ˜¯å®é™…çš„åº”ç”¨ç¨‹åºï¼Œå› æ­¤è¿™å°†ç«‹å³ä¸ºæˆ‘ä»¬æä¾›å¸®åŠ©ï¼Œè€Œæ— éœ€ä¸å¿…è¦çš„æ‰‹åŠ¿ï¼Œå°†Bootstrapå’ŒJQueryé›†æˆåˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ã€‚ <br><br><img src="https://habrastorage.org/webt/lg/yv/rn/lgyvrneaxmudgq9mx1ijk36jjqs.png"><br><br> æˆ‘ä»¬å·²ç»ä½¿ç”¨ASP.NET MVCåŒ…å’Œè¿‡æ»¤å™¨æ³¨å†Œåœ¨<i>App_Start</i>ç›®å½•ä¸­å¡«å……äº†<i>Content</i> ï¼Œ <i>Fonts</i> ï¼Œ <i>Scripts</i>æ–‡ä»¶å¤¹ä»¥åŠ<i>BundleConfig.cs</i>å’Œ<i>FilterConfig.csæ–‡ä»¶</i> ã€‚ åœ¨ä¸€ä¸ªç©ºé¡¹ç›®ä¸­ï¼Œä»…åœ¨<i>RouteConfig.cs</i>æ–‡ä»¶ä¸­æ³¨å†Œäº†è·¯ç”±ã€‚ åœ¨<i>Global.asax.csä¸­ï¼Œ</i>è¿˜å°†æ·»åŠ è¿™äº›æ–‡ä»¶ä¸­æè¿°<i>çš„</i>æ–¹æ³•è°ƒç”¨ï¼š <br><br><pre> <code class="cpp hljs">FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles);</code> </pre> <br><h2> æˆ‘ä»¬å»ºç«‹äº†åŸºç¡€æ¶æ„å’Œæ•´ä¸ªæ†ç»‘ </h2><br> è¦ä½¿ç”¨MySQL DBMSï¼Œè¯·æ·»åŠ <i>MySql.Data</i>åº“ï¼šå¦‚æœå·²ç»åœ¨è®¡ç®—æœºä¸Šå®‰è£…äº†<b>mysql-connector-net-8.0.18è¿æ¥å™¨</b> ï¼Œåˆ™æ‰‹åŠ¨æ·»åŠ ï¼Œæˆ–è€…ä»NugetåŒ…ç®¡ç†å™¨æ·»åŠ ï¼š <br><br><img src="https://habrastorage.org/webt/mk/b_/fh/mkb_fhxg6d8kx2pdnrithceoaf4.png"><br><br> å°†è¿æ¥å­—ç¬¦ä¸²çš„é…ç½®æ·»åŠ åˆ°MySQL DBMSçš„<i>Web.config</i>æ–‡ä»¶ä¸­ï¼š <br><br><pre> <code class="cpp hljs">&lt;connectionStrings&gt; &lt;add name=<span class="hljs-string"><span class="hljs-string">"example"</span></span> providerName=<span class="hljs-string"><span class="hljs-string">"MySql.Data.MySqlClient"</span></span> connectionString=<span class="hljs-string"><span class="hljs-string">"server=localhost;Port=3306;user id=develop;Password=develop;persistsecurityinfo=True;database=example;CharSet=utf8;SslMode=none"</span></span> /&gt; &lt;/connectionStrings&gt;</code> </pre> <br> åœ¨<code>&lt;appSettings&gt;</code>éƒ¨åˆ†ä¸­æ·»åŠ ä¸€è¡Œï¼Œå¹¶å¸¦æœ‰æŒ‡å‘æ‰€æ·»åŠ çš„è¿æ¥å­—ç¬¦ä¸²çš„é“¾æ¥ï¼š <code>&lt;add key="ConnectionString" value="example" /&gt;</code> <br> æˆ‘ä»¬å‘åº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªæ–°çš„<i>Domain</i>ç›®å½•ï¼Œåœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„é™æ€<code>Base</code>ç±»ï¼ˆåœ¨<i>Base.cs</i>æ–‡ä»¶ä¸­ï¼‰ï¼Œåœ¨å…¶ä¸­è®¿é—®ä»¥ä¸‹å‚æ•°ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Base</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> ConnectionString { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> System.Configuration.ConfigurationManager.AppSettings[<span class="hljs-string"><span class="hljs-string">"ConnectionString"</span></span>]; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> strConnect { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> System.Configuration.ConfigurationManager.ConnectionStrings[ConnectionString].ConnectionString; } } }</code> </pre> <br> æˆ‘å–œæ¬¢åœ¨åº”ç”¨ç¨‹åºä¸­æœ‰ä¸€ä¸ªç‰¹å®šçš„åŸºç±»ï¼Œè¯¥ç±»å…·æœ‰æŒ‡å‘åº”ç”¨ç¨‹åºå‚æ•°çš„é“¾æ¥å’Œä¸€äº›å¯ä»¥ä»æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­è°ƒç”¨çš„æ ‡å‡†å‡½æ•°ã€‚ <br> è¿æ¥å­—ç¬¦ä¸²çš„åç§°æ˜¯åœ¨åº”ç”¨ç¨‹åºè®¾ç½®ä¸­å®šä¹‰çš„ï¼Œå› æ­¤å°†æ¥å¯ä»¥æ›´è½»æ¾åœ°å°†è¿æ¥å­—ç¬¦ä¸²ä¸DBMSä¸€èµ·ä½¿ç”¨ï¼šåœ¨ä¸åŒçš„æ•°æ®åº“ä¹‹é—´å¿«é€Ÿåˆ‡æ¢å¹¶æ›´æ”¹è¿æ¥è®¾ç½®ã€‚ æ­¤å¤–ï¼Œåœ¨åº”ç”¨ç¨‹åºå‚æ•°ä¸­ä½¿ç”¨è¿æ¥å­—ç¬¦ä¸²åç§°å°†åº”ç”¨ç¨‹åºå‘å¸ƒåˆ°Microsoft Azureæ˜¯å¾ˆæ–¹ä¾¿çš„-æ‚¨å¯ä»¥åœ¨å…¶ä¸­è®¾ç½®ç”¨äºå‘å¸ƒçš„åº”ç”¨ç¨‹åºæœåŠ¡çš„å‚æ•°ï¼Œå¹¶åœ¨å…¶ä¸­ç¡®å®šæ‰€éœ€çš„è¿æ¥å­—ç¬¦ä¸²ï¼Œè¯¥è¿æ¥å­—ç¬¦ä¸²åœ¨<code>&lt;connectionStrings&gt;</code>é¢„å®šä¹‰ã€‚ ç„¶åï¼Œåœ¨å‘å¸ƒæ—¶ï¼Œæ‚¨å°†æ— æ³•ä½¿ç”¨<i>web.configæ–‡ä»¶</i>çš„è½¬æ¢ã€‚ <br><br> æˆ‘è¿˜å–œæ¬¢åœ¨æ–‡æœ¬ä¸­ä½¿ç”¨å…¨å±€èµ„æºæ–‡ä»¶ä¸­çš„å€¼ï¼Œä»¥ä¾¿åœ¨çªç„¶éœ€è¦æ—¶ä¸åœ¨å¤šä¸ªä½ç½®è¦†ç›–å®ƒä»¬ã€‚ ä¾‹å¦‚ï¼š <br><br><img src="https://habrastorage.org/webt/rc/8u/qz/rc8uqzdrz9hvnd-y7swirgoh4tm.png"><br><br> åœ¨é¡µé¢å¸ƒå±€æ–‡ä»¶<i>_Layout.cshtml</i> ï¼ˆé€šå¸¸ä½äº<i>Views \ Shared</i>ç›®å½•ä¸­ï¼Œä»¥åå°†åœ¨è¯¥é¡¹ç›®çš„æ‰€æœ‰é¡µé¢ä¸­ä½¿ç”¨ï¼‰ä¸­ï¼Œæ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨è¿™äº›å˜é‡ï¼ˆä¾‹å¦‚ï¼Œå‚è§<code>Example_Users.Properties.Resources.Title</code> ï¼‰ï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>@ViewBag.Title â€“ @Example_Users.Properties.Resources.Title<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> @Styles.Render("~/Content/css") @Scripts.Render("~/bundles/modernizr") <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container body-content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"page-header"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>@Example_Users.Properties.Resources.Title<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> @RenderBody() <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> @DateTime.Now.Year â€“ @Example_Users.Properties.Resources.Author<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> @Scripts.Render("~/bundles/jquery") @Scripts.Render("~/bundles/bootstrap") @RenderSection("scripts", required: false) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> åŒæ ·åœ¨æ­¤æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°è¿æ¥çš„Bootstrapå’ŒJQueryè„šæœ¬åº“çš„çº§è”æ ·å¼è¡¨çš„é™„ä»¶ã€‚ æ‰€æœ‰è§†å›¾çš„å†…å®¹å°†åœ¨è°ƒç”¨<code>RenderBody()</code>å‡½æ•°çš„ä½ç½®ç”Ÿæˆã€‚ <br><br><h2>  Mè¡¨ç¤ºå‹å· </h2><br> å°†æ–‡ä»¶<i>UserClass.cs</i>æ·»åŠ åˆ°<i>Domain</i>ç›®å½•ä¸­ï¼š <br><br><pre> <code class="cpp hljs">[DisplayName(<span class="hljs-string"><span class="hljs-string">"User"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserClass</span></span></span><span class="hljs-class"> {</span></span> [Key] [HiddenInput(DisplayValue=<span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> UserID { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } [Required(ErrorMessage=<span class="hljs-string"><span class="hljs-string">"Please enter a login name"</span></span>)] [Display(Name = <span class="hljs-string"><span class="hljs-string">"Login"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> Loginname { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> LanguageClass Language { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } [EmailAddress(ErrorMessage = <span class="hljs-string"><span class="hljs-string">"Please enter a valid email"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> Email { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } [UIHint(<span class="hljs-string"><span class="hljs-string">"Enum"</span></span>)] [EnumDataType(typeof(Supporter))] [Required(ErrorMessage = <span class="hljs-string"><span class="hljs-string">"Please select supporter tier"</span></span>)] [Display(Name = <span class="hljs-string"><span class="hljs-string">"Supporter"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Supporter SupporterTier { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } [HiddenInput(DisplayValue = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] [ScaffoldColumn(<span class="hljs-literal"><span class="hljs-literal">false</span></span>)] [Display(Name = <span class="hljs-string"><span class="hljs-string">"Last login"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime? LastLoginDate { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } [HiddenInput(DisplayValue = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsLastLogin { get { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LastLoginDate != null &amp;&amp; LastLoginDate &gt; DateTime.MinValue; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserClass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserClass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> UserID, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Loginname, LanguageClass Language, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Email, DateTime? LastLoginDate, Supporter SupporterTier)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.UserID = UserID; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Loginname = Loginname; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Language = Language; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Email = Email; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.LastLoginDate = LastLoginDate; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SupporterTier = SupporterTier; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Supporter { [Display(Name=<span class="hljs-string"><span class="hljs-string">""</span></span>)] None = <span class="hljs-number"><span class="hljs-number">1</span></span>, Silver = <span class="hljs-number"><span class="hljs-number">2</span></span>, Gold = <span class="hljs-number"><span class="hljs-number">3</span></span>, Platinum = <span class="hljs-number"><span class="hljs-number">4</span></span> }</code> </pre> <br> ä»¥åŠåŒä¸€ä¸ªç›®å½•ä¸­çš„<i>LanguageClass.cs</i>æ–‡ä»¶ï¼š <br><pre> <code class="cpp hljs">[DisplayName(<span class="hljs-string"><span class="hljs-string">"Language"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LanguageClass</span></span></span><span class="hljs-class"> {</span></span> [Key] [HiddenInput(DisplayValue = <span class="hljs-literal"><span class="hljs-literal">false</span></span>)] [Required(ErrorMessage = <span class="hljs-string"><span class="hljs-string">"Please select a language"</span></span>)] [Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue, ErrorMessage = <span class="hljs-string"><span class="hljs-string">"Please select a language"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LanguageID { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } [Display(Name = <span class="hljs-string"><span class="hljs-string">"Language"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> LanguageName { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LanguageClass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LanguageClass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LanguageID, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LanguageName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.LanguageID = LanguageID; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.LanguageName = LanguageName; } }</code> </pre> <br> åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ç±»çš„å±æ€§é‡å¤äº†DBMSä¸­â€œ <code>Users</code>å’Œ<code>Languages</code>è¡¨çš„ç»“æ„ã€‚  <code>enum Supporter</code>ä¸ºè¯¥æšä¸¾ç±»å‹åˆ›å»ºäº†ä¸€ä¸ª<code>enum Supporter</code> ï¼Œä»¥ä¾¿å¯ä»¥å°†å…¶ç”¨äºæ•°æ®åº“è¡¨ä¸­ç±»ä¼¼å­—æ®µçš„<code>SupporterTier</code>ç±»çš„å±æ€§ã€‚ å¯¹äº<code>UserID</code> ï¼Œ <code>LanguageID</code>å­—æ®µï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å®ƒä»¬è¢«æŒ‡å®šä¸ºä¸»é”®ï¼Œå°±åƒåœ¨æ•°æ®åº“ä¸­ä¸€æ ·ã€‚  <code>[Key]</code>å±æ€§ç”¨äºæ­¤ç›®çš„ã€‚ <br><br> æ‰€æœ‰å…¶ä»–å±æ€§å¾ˆå¯èƒ½ä¸ä½¿ç”¨æ­¤ç±»çš„è§†å›¾ç›¸å…³ã€‚ è€Œä¸”ï¼Œå¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨åŠ©æ‰‹ä¸ºè¿™äº›å±æ€§å½¢æˆHTMLæ ‡è®°ï¼ˆæˆ‘ä¸ªäººè‚¯å®šä¼šå»ºè®®è¿™æ ·åšï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¿…é¡»éå¸¸ä»”ç»†åœ°è®¾ç½®è¿™äº›å±æ€§æ‰èƒ½è·å¾—æ‰€éœ€çš„å†…å®¹ã€‚ ç‰¹åˆ«æ˜¯ï¼Œæ­¤é¡¹ç›®éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š <br><br><ul><li>  <b><code>[DisplayName]</code></b> -ç”¨ä½œç±»çš„æ˜¾ç¤ºåç§°ã€‚ æœ‰æ—¶å®ƒå¾ˆæœ‰ç”¨ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ç‰¹åˆ«æ·»åŠ äº†<code>Html.DisplayNameForModel</code>å¸®åŠ©å™¨çš„<code>Html.DisplayNameForModel</code>è¿›è¡Œæ¼”ç¤ºã€‚ </li><li> å…·æœ‰<code>Name</code>å±æ€§çš„<b><code>[Display]</code></b> -ç”¨ä½œå±å¹•ä¸Šæ˜¾ç¤ºçš„classå±æ€§çš„åç§°ã€‚ è¿˜æœ‰ä¸€ä¸ªæœ‰ç”¨çš„Orderå±æ€§ï¼Œä½¿æ‚¨å¯ä»¥ä½¿ç”¨åŠ©æ‰‹å¯¹æ˜¾ç¤ºç±»å±æ€§çš„é¡ºåºè¿›è¡Œæ’åºï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‰å®šä¹‰ç±»å±æ€§çš„é¡ºåºæ’åºï¼Œå› æ­¤è¯¥é¡¹ç›®ä¸­æœªä½¿ç”¨Orderå±æ€§ï¼‰ã€‚ </li><li> å…·æœ‰<code>DisplayValue</code>å±æ€§çš„<b><code>[HiddenInput]</code></b> ã€‚ å®ƒç”¨äºæ ¹æœ¬ä¸éœ€è¦åœ¨è¡¨å•å’Œåˆ—è¡¨ä¸­æ˜¾ç¤ºçš„å±æ€§ï¼ˆ <code>DisplayValue=false</code> ï¼Œè¢«ç»˜åˆ¶ä¸º<code>hidden</code>ç±»å‹çš„<code>input</code>æ ‡ç­¾ï¼‰ï¼Œæˆ–ä»éœ€è¦æ˜¾ç¤ºä½†ä»¥ä¸å¯å˜æ–‡æœ¬å½¢å¼æ˜¾ç¤ºçš„å±æ€§ï¼ˆ <code>DisplayValue=true</code> ï¼Œå·²ç»˜åˆ¶ï¼‰åƒçº¯æ–‡å­—ï¼Œæ²¡æœ‰æ ‡ç­¾ï¼‰ </li><li>  <b><code>[ScaffoldColumn]</code></b> -æŒ‡ç¤ºæ˜¯å¦åœ¨ç¼–è¾‘<code>Html.EditorForModel</code> ï¼ˆä¾‹å¦‚<code>Html.EditorForModel</code> ï¼‰ä¸­æ˜¾ç¤ºè¯¥å­—æ®µã€‚ å¦‚æœä¸º<code>false</code> ï¼Œåˆ™ä¸ä¼šåœ¨è¡¨æ ¼ä¸­æ˜¾ç¤ºå¯¹ç±»å±æ€§çš„æè¿°æˆ–å…¶å€¼ã€‚  <code>[HiddenInput(DisplayValue = false)]</code>ä¸èƒ½åœ¨<code>[HiddenInput(DisplayValue = false)]</code>ä½¿ç”¨ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¤ç±»ç±»å±æ€§çš„å€¼ä¸ä»…ä¸ä¼šåœ¨ä¿¡æ¯è¾“å…¥è¡¨å•ä¸­è€Œä¸”ä¸ä¼šåœ¨è¡¨æ ¼æ˜¾ç¤ºä¸­æ˜¾ç¤ºã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ <code>LastLoginDate</code>å±æ€§æ˜¯å¿…éœ€çš„ï¼Œè¯¥å±æ€§ä¸æ˜¯æ‰‹åŠ¨è¾“å…¥çš„ï¼Œè€Œæ˜¯è‡ªåŠ¨å¡«å……çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶éœ€è¦æŸ¥çœ‹å®ƒã€‚ </li><li>  <b><code>[Required]</code></b> -æ£€æŸ¥æ˜¯å¦å·²ä¸ºclasså±æ€§è¾“å…¥å€¼ï¼Œå¹¶åœ¨<code>ErrorMessage</code>å±æ€§ä¸­æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯æ–‡æœ¬ï¼Œå¹¶ä½¿ç”¨<code>AllowEmptyStrings</code>å±æ€§å…è®¸æ‚¨è¾“å…¥ç©ºç™½è¡Œã€‚ </li><li>  <b><code>[EmailAddress]</code></b> -æœ¬è´¨ä¸Šç›¸åŒçš„å±æ€§ï¼Œç”¨äºæ£€æŸ¥é‚®ä»¶åœ°å€çš„æ­£ç¡®æ€§ã€‚ </li></ul><br> æ•°æ®åº“æ¨¡å‹çš„ç±»å·²å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬è½¬å‘è¡¨ç¤ºå½¢å¼ï¼ˆè¡¨ç¤ºæ¨¡å‹çš„ç±»åˆ«å°†åœ¨ä¸‹é¢æè¿°ï¼‰ã€‚ <br><br><h2>  V-è¡¨ç¤º<s>ä»‡æ€</s>è¡¨æ¼” </h2><br> åœ¨<i>Views</i>ç›®å½•ä¸­ï¼Œä¸ºæˆ‘ä»¬çš„è§†å›¾åˆ›å»º<i>Users</i>ç›®å½•ã€‚ æˆ‘ä»¬æ‰€æœ‰çš„è§†å›¾éƒ½ä½¿ç”¨ä½äº<i>Views \ Shared</i>ç›®å½•ä¸­çš„æ ‡å‡†ï¼ˆåœ¨<i>Views</i>ç›®å½•çš„<i>_ViewStart.cshtml</i>æ–‡ä»¶ä¸­å®šä¹‰ï¼‰ <i>_Layout.cshtml</i>å¸ƒå±€ã€‚ åˆ›å»ºä¸€ä¸ª<code>Index</code>è§†å›¾ï¼ˆâ€œ <i>ç”¨æˆ·â€</i>ç›®å½•ä¸­çš„<i>Index.cshtml</i>æ–‡ä»¶ï¼‰ï¼š <br><br><img src="https://habrastorage.org/webt/jh/es/jn/jhesjnicwj2g1acx7yziv4f6wqy.png"><br><br> å¹¶ç¼–å†™ä»£ç ï¼š <br><br><pre> <code class="xml hljs">@model Example_Users.Models.UsersGrid @{ ViewBag.Title = "Users page"; } @using (@Html.BeginForm()) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span>Users list:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> @if (TempData["message"] != null) {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text-success"</span></span></span><span class="hljs-tag">&gt;</span></span>@TempData["message"]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>} @if (TempData["error"] != null) {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text-warning"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert"</span></span></span><span class="hljs-tag">&gt;</span></span>ERROR:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> @TempData["error"]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>} @Html.Partial("List") <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onNewUser"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"New user"</span></span></span><span class="hljs-tag"> /&gt;</span></span> @*@Html.ActionLink("New user", "New", "Users")*@ <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> }</code> </pre> <br> å¦‚æœæˆ‘ä»¬å¸Œæœ›é»˜è®¤æƒ…å†µä¸‹å¯åŠ¨æ­¤è§†å›¾ï¼Œè¯·åœ¨<i>RouteConfig.cs</i>æ–‡ä»¶ä¸­å¯¹<code>Default</code>è¿›è¡Œæ›´æ”¹ï¼š <br><br><pre> <code class="cpp hljs">routes.MapRoute(name: <span class="hljs-string"><span class="hljs-string">"Default"</span></span>, url: <span class="hljs-string"><span class="hljs-string">"{controller}/{action}/{id}"</span></span>, defaults: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { controller = <span class="hljs-string"><span class="hljs-string">"Users"</span></span>, action = <span class="hljs-string"><span class="hljs-string">"Index"</span></span>, id = UrlParameter.Optional });</code> </pre> <br> åœ¨è§†å›¾æœ¬èº«ä¸­ï¼Œæ‚¨éœ€è¦æ³¨æ„<code>Html.Partial("List")</code> ã€‚ å¿…é¡»åœ¨æ­¤ä½ç½®åœ¨<i>Views \ Shared</i>ç›®å½•çš„<i>List.cshtml</i>æ–‡ä»¶ä¸­ç»˜åˆ¶ä¸€ä¸ªç‰¹æ®Šçš„å•ç‹¬çš„å¸¸è§„å±€éƒ¨è§†å›¾ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªç½‘æ ¼è¡¨ï¼Œç”¨äºæ˜¾ç¤ºæˆ‘ä»¬çš„<code>users</code>æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ï¼š <br><br><pre> <code class="xml hljs">@model Example_Users.Models.UsersGrid @using Example_Users.Domain <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"table-responsive"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"table table-bordered table-hover"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink(Html.DisplayNameFor(m =&gt; Model.Users.First().Loginname).ToString(), "Index", Request.QueryString.ToRouteValueDictionary("sortOrder", Model.SortingInfo.NewOrder(Html.NameFor(m =&gt; Model.Users.First().Loginname).ToString()))) @Html.SortIdentifier(Model.SortingInfo.currentSort, Html.NameFor(m =&gt; Model.Users.First().Loginname).ToString()) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink(Html.DisplayNameFor(m =&gt; Model.Users.First().Language.LanguageName).ToString(), "Index", Request.QueryString.ToRouteValueDictionary("sortOrder", Model.SortingInfo.NewOrder(Html.NameFor(m =&gt; Model.Users.First().Language).ToString()))) @Html.SortIdentifier(Model.SortingInfo.currentSort, Html.NameFor(m =&gt; Model.Users.First().Language).ToString()) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink(Html.DisplayNameFor(m =&gt; Model.Users.First().Email).ToString(), "Index", Request.QueryString.ToRouteValueDictionary("sortOrder", Model.SortingInfo.NewOrder(Html.NameFor(m =&gt; Model.Users.First().Email).ToString()))) @Html.SortIdentifier(Model.SortingInfo.currentSort, Html.NameFor(m =&gt; Model.Users.First().Email).ToString()) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink(Html.DisplayNameFor(m =&gt; Model.Users.First().SupporterTier).ToString(), "Index", Request.QueryString.ToRouteValueDictionary("sortOrder", Model.SortingInfo.NewOrder(Html.NameFor(m =&gt; Model.Users.First().SupporterTier).ToString()))) @Html.SortIdentifier(Model.SortingInfo.currentSort, Html.NameFor(m =&gt; Model.Users.First().SupporterTier).ToString()) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink(Html.DisplayNameFor(m =&gt; Model.Users.First().LastLoginDate).ToString(), "Index", Request.QueryString.ToRouteValueDictionary("sortOrder", Model.SortingInfo.NewOrder(Html.NameFor(m =&gt; Model.Users.First().LastLoginDate).ToString()))) @Html.SortIdentifier(Model.SortingInfo.currentSort, Html.NameFor(m =&gt; Model.Users.First().LastLoginDate).ToString()) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> @foreach (var item in Model.Users) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.ActionLink(item.Loginname, "Edit", "Users", new { UserID = item.UserID }, null)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.DisplayFor(modelitem =&gt; item.Language.LanguageName)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>@Html.DisplayFor(modelitem =&gt; item.Email)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@Html.DisplayFor(modelitem =&gt; item.SupporterTier)"</span></span></span><span class="hljs-tag">&gt;</span></span>@if (item.SupporterTier != Supporter.None) {@Html.DisplayFor(modelitem =&gt; item.SupporterTier);}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>@if (item.IsLastLogin) {@Html.DisplayFor(modelitem =&gt; item.LastLoginDate)}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> } <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> @if (Model.PagingInfo.totalPages &gt; 1) { <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination"</span></span></span><span class="hljs-tag">&gt;</span></span> @Html.PageLinks(Model.PagingInfo, x =&gt; Url.Action("Index", new { page = x, sortOrder = Model.SortingInfo.currentSort })) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> }</code> </pre> <br> å¯ä»¥çœ‹å‡ºï¼Œåœ¨æ•°æ®è¡¨çš„æ ‡é¢˜ä¸­ï¼Œ <code>Html.DisplayNameFor</code> helper <code>Html.DisplayNameFor</code>æ˜¾ç¤ºåˆ—çš„åç§°ï¼Œä¸ºæ­¤ï¼Œæ‚¨å¿…é¡»æŒ‡å®šå¯¹ç±»å¯¹è±¡çš„å±æ€§çš„å¼•ç”¨ã€‚ ç”±äºå½¢æˆè¡¨æ ¼æ ‡é¢˜æ—¶ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ª<code>Model.Users</code>å¯¹è±¡ï¼Œå®ƒæ˜¯<code>UserClass</code>ç±»å‹çš„å¯¹è±¡åˆ—è¡¨ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼šé€‰æ‹©æ­¤åˆ—è¡¨çš„ç¬¬ä¸€è¡Œä½œä¸º<code>UserClass</code>ç±»çš„å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºç”¨æˆ·åï¼š <code>Model.Users.First().Loginname</code> ã€‚ ç”±äº<code>Users</code>ç±»çš„<code>Loginname</code>å±æ€§å…·æœ‰<code>[Display(Name = "Login")]</code>å±æ€§ï¼Œå› æ­¤å®ƒå°†åœ¨åˆ—åç§°ä¸­æ˜¾ç¤ºä¸ºâ€œ Loginâ€ï¼š <br><br><img src="https://habrastorage.org/webt/hv/kf/dv/hvkfdvojevmzacuid51wurye8ik.png"><br><br>  <code>List</code>è§†å›¾ä¸­è¿˜æœ‰ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ï¼Ÿ å½“ç„¶ï¼Œ <code>foreach</code>å—å°†å‘ˆç°ä»æ§åˆ¶å™¨æ¥æ”¶åˆ°çš„â€œ <code>Users</code>åˆ—è¡¨ä¸­çš„<code>UserClass</code>ç±»çš„å¯¹è±¡ã€‚ è¿™é‡Œçš„<code>UsersGrid</code>æ¨¡å‹ä¸­çš„<code>SortingInfo</code>å’Œ<code>PagingInfo</code>å¾ˆæœ‰è¶£ã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬éœ€è¦è¿™äº›å¯¹è±¡æ¥ç»„ç»‡æ•°æ®æ’åºï¼ˆåœ¨<code>&lt;th&gt;</code>æ ‡è®°çš„è¡¨å¤´ä¸­ä½¿ç”¨ï¼‰å’Œç»„ç»‡ä¿¡æ¯çš„åˆ†é¡µï¼ˆåœ¨é¡µé¢åº•éƒ¨çš„è¡¨ä¸‹æ–¹ï¼‰ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸å°†<code>IEnumerable&lt;UserClass&gt;</code>ç±»å‹çš„å¯¹è±¡çš„çº¯åˆ—è¡¨ç”¨ä½œæ¨¡å‹çš„åŸå› ã€‚ ä½œä¸ºæ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>UsersGrid</code>ç±»ï¼Œè¯¥ç±»ä½äº<i>Model</i>ç›®å½•çš„<i>UsersGrid.cs</i>æ–‡ä»¶ä¸­ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersGrid</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable&lt;UserClass&gt; Users { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> PagingInfo PagingInfo { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SortingInfo SortingInfo { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } }</code> </pre> <br>  <code>PagingInfo</code>å’Œ<code>SortingInfo</code>ç±»æœ¬èº«åœ¨<code>GridInfo.cs</code>æ–‡ä»¶ä¸­çš„åŒä¸€ä½ç½®ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PagingInfo</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">//     public int totalItems { get; set; } //     public int itemsPerPage { get; set; } //   public int currentPage { get; set; } //         public int showPages { get; set; } //   public int totalPages { get { return (int)Math.Ceiling((decimal)totalItems / itemsPerPage); } } //           public int pagesSide { get { return (int)Math.Truncate((decimal)showPages / 2); } } } public class SortingInfo { //  ,     public string currentOrder { get; set; } //   public SortDirection currentDirection { get; set; } //      public string currentSort { get { return currentDirection != SortDirection.Descending ? currentOrder : currentOrder + "_desc"; } } //       (      -   ) public string NewOrder(string columnName) { return columnName == currentOrder &amp;&amp; currentDirection != SortDirection.Descending ? columnName + "_desc" : columnName; } }</span></span></code> </pre> <br> ä¸ºäº†åœ¨è§†å›¾ä¸­ä½¿ç”¨ï¼Œç‰¹æ®Šçš„å¸®åŠ©å™¨å·²æ·»åŠ åˆ°<i>GridHelpers.cs</i>æ–‡ä»¶ï¼ˆ <i>HtmlHelpers</i>ç›®å½•ï¼‰ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GridHelpers</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">//     1 ... 3 4 5 ... Last public static MvcHtmlString PageLinks(this HtmlHelper html, PagingInfo pagingInfo, Func&lt;int, string&gt; pageUrl) { StringBuilder result = new StringBuilder(); if (pagingInfo.currentPage &gt; pagingInfo.pagesSide + 1) {//   TagBuilder li = new TagBuilder("li"); li.AddCssClass("page-item"); TagBuilder tag = new TagBuilder("a"); tag.MergeAttribute("href", pageUrl(1)); tag.InnerHtml = "1"; li.InnerHtml = tag.ToString(); result.Append(li.ToString()); } int page1 = pagingInfo.currentPage - pagingInfo.pagesSide; int page2 = pagingInfo.currentPage + pagingInfo.pagesSide; if (page1 &lt; 1) { page2 = page2 - page1 + 1; page1 = 1; } if (page2 &gt; pagingInfo.totalPages) page2 = pagingInfo.totalPages; if (page1 &gt; 2) {// ... TagBuilder li = new TagBuilder("li"); li.AddCssClass("page-item"); TagBuilder tag = new TagBuilder("span"); tag.InnerHtml = "..."; tag.AddCssClass("page-item"); tag.AddCssClass("disabled"); li.InnerHtml = tag.ToString(); result.Append(li.ToString()); } for (int i = page1; i &lt;= page2; i++) {//  TagBuilder li = new TagBuilder("li"); li.AddCssClass("page-item"); if (i == pagingInfo.currentPage) li.AddCssClass("active"); TagBuilder tag = new TagBuilder("a"); tag.AddCssClass("page-link"); tag.MergeAttribute("href", pageUrl(i)); tag.InnerHtml = i.ToString(); li.InnerHtml = tag.ToString(); result.Append(li.ToString()); } if (page2 &lt; pagingInfo.totalPages) {// ...    TagBuilder li = new TagBuilder("li"); li.AddCssClass("page-item"); TagBuilder tag = new TagBuilder("span"); tag.InnerHtml = "..."; tag.AddCssClass("page-item"); tag.AddCssClass("disabled"); li.InnerHtml = tag.ToString(); result.Append(li.ToString()); li = new TagBuilder("li"); li.AddCssClass("page-item"); tag = new TagBuilder("a"); tag.MergeAttribute("href", pageUrl(pagingInfo.totalPages)); tag.InnerHtml = pagingInfo.totalPages.ToString(); li.InnerHtml = tag.ToString(); result.Append(li.ToString()); } return MvcHtmlString.Create(result.ToString()); } public static IHtmlString SortIdentifier(this HtmlHelper htmlHelper, string sortOrder, string field) { if (string.IsNullOrEmpty(sortOrder) || (sortOrder.Trim() != field &amp;&amp; sortOrder.Replace("_desc", "").Trim() != field)) return null; string glyph = "glyphicon glyphicon-chevron-up"; if (sortOrder.ToLower().Contains("desc")) { glyph = "glyphicon glyphicon-chevron-down"; } var span = new TagBuilder("span"); span.Attributes["class"] = glyph; return MvcHtmlString.Create(span.ToString()); } public static RouteValueDictionary ToRouteValueDictionary(this NameValueCollection collection, string newKey, string newValue) { var routeValueDictionary = new RouteValueDictionary(); foreach (var key in collection.AllKeys) { if (key == null) continue; if (routeValueDictionary.ContainsKey(key)) routeValueDictionary.Remove(key); routeValueDictionary.Add(key, collection[key]); } if (string.IsNullOrEmpty(newValue)) { routeValueDictionary.Remove(newKey); } else { if (routeValueDictionary.ContainsKey(newKey)) routeValueDictionary.Remove(newKey); routeValueDictionary.Add(newKey, newValue); } return routeValueDictionary; } }</span></span></code> </pre> <br> ç”±äºå…·æœ‰æ•°æ®çš„ç½‘æ ¼æ²¡æœ‰æ’åºè€Œæ²¡æœ‰åˆ†é¡µä¿¡æ¯æ˜¯ä¸€ä»¶ç›¸å½“æ²¡ç”¨çš„äº‹æƒ…ï¼Œå¹¶ä¸”ASP.NET MVCä¸­æ²¡æœ‰ç”¨äºæ•´ä¸ªæ•°æ®è¡¨çš„æ ‡å‡†å¸®åŠ©ç¨‹åºï¼Œå› æ­¤æ‚¨å¿…é¡»è‡ªå·±åˆ›å»ºï¼ˆæˆ–é‡‡ç”¨å…¶ä»–äººåˆ›å»ºçš„ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ç›‘è§†äº†Internetä¸ŠASP.NET MVCä¹¦ç±å’Œè§£å†³æ–¹æ¡ˆä¸­çš„å‡ ç§å®ç°ã€‚ è€Œä¸”ï¼Œç”±äºæŸç§åŸå› ï¼Œè‡³å°‘ç»“åˆäº†æ•°æ®æ’åºå’Œåˆ†é¡µçš„è§£å†³æ–¹æ¡ˆæ ¹æœ¬æ²¡æœ‰ï¼Œæˆ–è€…æˆ‘æ²¡æœ‰æ‰¾åˆ°ã€‚ æˆ‘å¿…é¡»ç†è§£è¿™ä»¶äº‹ï¼Œå°†å…¶ç»„åˆå¹¶ä¿®æ”¹ä¸ºæ­£å¸¸çŠ¶æ€ã€‚ ä¾‹å¦‚ï¼Œåœ¨é‚£äº›å®ç°ä¸­çš„åˆ†é¡µé€šå¸¸ä¸èƒ½æä¾›æˆ–å¤šæˆ–å°‘çš„é•¿é¡µé¢åˆ—è¡¨çš„è¾“å‡º-é‚£ä¹ˆï¼Œå¦‚æœä¼šæœ‰å‡ åƒä¸ªé¡µé¢æ€ä¹ˆåŠï¼Ÿ æˆ‘ç»™å‡ºäº†ä¸Šè¿°è§£å†³æ–¹æ¡ˆçš„æ˜¾ç¤ºç¤ºä¾‹ï¼š <br><br><img src="https://habrastorage.org/webt/wj/dt/yr/wjdtyrmtbxm5f_5jfj7til_iqy0.png"><br><br> æˆ‘ä»¬è¿˜éœ€è¦è§†å›¾æ¥åˆ›å»ºå’Œä¿®æ”¹æ•°æ®ã€‚ ç”¨äºåˆ›å»º<code>UserClass</code>ç±»å‹çš„å¯¹è±¡çš„è§†å›¾ï¼š <br><br><img src="https://habrastorage.org/webt/0u/80/-i/0u80-itckfou4ciyyxremebrqy8.png"><br><br> å¹¶ä¸”è§†å›¾ä»£ç å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs">@model Example_Users.Models.UserModel @{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"New "</span></span> + Html.DisplayNameForModel().ToString().ToLower(); } &lt;h2&gt;@ViewBag.Title&lt;/h2&gt; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (@Html.BeginForm(<span class="hljs-string"><span class="hljs-string">"New"</span></span>, <span class="hljs-string"><span class="hljs-string">"Users"</span></span>, FormMethod.Post)) { @Html.EditorFor(m =&gt; m.User); @Html.LabelFor(m =&gt; Model.User.Language)&lt;br /&gt; @Html.DropDownListFor(m =&gt; Model.User.Language.LanguageID, Model.SelectLanguages()) &lt;span/&gt;@Html.ValidationMessageFor(m =&gt; Model.User.Language.LanguageID)&lt;br /&gt; &lt;br /&gt; &lt;p&gt;&lt;input type=<span class="hljs-string"><span class="hljs-string">"submit"</span></span> name=<span class="hljs-string"><span class="hljs-string">"action"</span></span> value=<span class="hljs-string"><span class="hljs-string">"Add"</span></span> /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"button"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"history.go(-1)"</span></span> value=<span class="hljs-string"><span class="hljs-string">"Cancel"</span></span> /&gt;&lt;/p&gt; @*&lt;p&gt;@Html.ActionLink(<span class="hljs-string"><span class="hljs-string">"Back to list"</span></span>, <span class="hljs-string"><span class="hljs-string">"Index"</span></span>)&lt;/p&gt;*@ }</code> </pre> <br> ä¾‹å¦‚ï¼Œæ­¤è§†å›¾æ˜¾ç¤ºäº†<code>Html.EditorFor</code>è¾…åŠ©ç¨‹åºä½œä¸ºç”Ÿæˆç”¨äºç¼–è¾‘<code>UserClass</code>ç±»ä¸­å¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„æ ‡è®°çš„ä¸€ç§æ–¹å¼ã€‚ æ˜¾ç¤ºå¦‚ä¸‹ï¼š <br><br><img src="https://habrastorage.org/webt/v-/rz/kw/v-rzkwz4dtui-xhs4lo2vbjyf3s.png"><br><br> è¯¥è§†å›¾ä½¿ç”¨<code>UserModel</code>ç±»ä½œä¸ºæ¨¡å‹ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨<code>UserClass</code> ã€‚  <code>UserModel</code>ç±»æœ¬èº«ä½äº<i>Models</i>ç›®å½•çš„<i>UserModel.cs</i>æ–‡ä»¶ä¸­ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserModel</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> UserClass User { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IList&lt;LanguageClass&gt; Languages { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserClass user, IList&lt;LanguageClass&gt; languages)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.User = user; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Languages = languages; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable&lt;SelectListItem&gt; SelectLanguages() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Languages != null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SelectList(Languages, <span class="hljs-string"><span class="hljs-string">"LanguageID"</span></span>, <span class="hljs-string"><span class="hljs-string">"LanguageName"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } }</code> </pre> <br> è¯¥ç±»<code>LanguageClass</code>åŒ…å«<code>UserClass</code>å¯¹è±¡æœ¬èº«ä»¥åŠ<code>LanguageClass</code>ç±»å‹çš„å…¶ä»–å¯¹è±¡åˆ—è¡¨ã€‚ æˆ‘ä»¬éœ€è¦æ­¤åˆ—è¡¨æ¥åˆ›å»ºè¯­è¨€çš„ä¸‹æ‹‰åˆ—è¡¨ï¼Œå¹¶åœ¨å…¶ä¸­é€‰æ‹©å½“å‰ç”¨æˆ·è¯­è¨€ï¼š <code>@Html.DropDownListFor(m =&gt; Model.User.Language.LanguageID, Model.SelectLanguages(), "")</code> <br><br> è¯¥åŠ©æ‰‹ä½¿ç”¨å¯¹<code>SelectLanguages()</code>å‡½æ•°çš„è°ƒç”¨ï¼Œè¯¥å‡½æ•°å°†è¯­è¨€åˆ—è¡¨è½¬æ¢ä¸º<code>SelectList</code>ç±»å‹çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„æ ‡è¯†ç¬¦å’Œè¡Œåå‚æ•°å·²è®¾ç½®ã€‚ å°†è¿™ä¸ªå¯¹è±¡çš„ç”Ÿæˆæ”¾å…¥è§†å›¾ä¸­å°†æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºè¿™ç§æƒ³æ³•æ˜¯ä¸çŸ¥é“è¿™äº›ä¸å­—æ®µåç§°çš„ç»‘å®šã€‚ å½“ç„¶ï¼Œæœ‰å¯èƒ½ç›´æ¥åœ¨æ§åˆ¶å™¨ä¸­ç”Ÿæˆä¸€ä¸ªç°æˆçš„<code>SelectList</code> ï¼Œä½†æ˜¯æˆ‘å–œæ¬¢å¸¦æœ‰åŸŸç±»å¯¹è±¡çš„ç§æœ‰åˆ—è¡¨å’Œå‡½æ•°çš„é€‰é¡¹ã€‚ <br><br> è¦ç”Ÿæˆä¸‹æ‹‰åˆ—è¡¨ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨å•ç‹¬çš„åŠ©æ‰‹ï¼Œå› ä¸º<code>Html.EditorFor(m =&gt; m.User)</code>åŠ©æ‰‹å°†ä¸ä¼šä¸º<code>LanguageClass</code>ç±»å‹çš„åµŒå…¥å¼å¯¹è±¡ç”Ÿæˆç¼–è¾‘æ ‡è®°ï¼ˆå¯ä»¥é€šè¿‡ä¸ºä¸‹æ‹‰åˆ—è¡¨ç¼–å†™é€šç”¨æ¨¡æ¿æ¥ç»•è¿‡å®ƒï¼Œä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æˆ‘ä»¬ä¸ä¼šè¿™ä¹ˆåšçš„...ï¼‰ã€‚ <br><br> å¹¶ä¸”ç”±äºæˆ‘ä»¬åœ¨è§†å›¾ä¸­ä½¿ç”¨çš„æ˜¯<code>UserModel</code>ç±»çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬<code>UserClass</code>ç±»çš„å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å°†æ— æ³•ä½¿ç”¨<code>Html.EditorForModel()</code>å¸®åŠ©å™¨ï¼Œå› ä¸ºè¿™äº›å¸®åŠ©å™¨ä¸æ˜¯é€’å½’çš„ï¼Œå¹¶ä¸”åœ¨è¿™ç§æƒ…å†µä¸‹å°†æ— æ³•ä½¿ç”¨ï¼Œå› æ­¤ä½¿ç”¨äº†<code>Html.EditorFor()</code>å¸®åŠ©å™¨<code>Html.EditorFor()</code>ç”¨äº<code>User</code>å¯¹è±¡ã€‚ <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘è¿˜æƒ³æ³¨æ„æ³¨é‡Šæ‰çš„æ ‡è®°ï¼š</font></font><code>Html.ActionLink("Back to list", "Index")</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ï¼Œä»¥ç±»ä¼¼çš„æ–¹å¼å®ç°ä»è§†å›¾è¿”å›ä»¥ç¼–è¾‘å›æ•°æ®åˆ—è¡¨çš„æ“ä½œã€‚å®é™…ä¸Šï¼Œé¦–å…ˆï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå®ƒçœ‹èµ·æ¥å¾ˆå¥‡æ€ª-å½“æ‚¨åœ¨formä¸­ä½¿ç”¨ç±»å‹æŒ‰é’®æ—¶</font></font><code>button</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œç”±äºæŸç§åŸå› ï¼Œè¿”å›æŒ‰é’®æ˜¯ç”±é“¾æ¥å®ç°çš„ã€‚å…¶æ¬¡ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨æ’åºå’Œé€é¡µè¾“å‡º-æˆ‘ä»¬å¿…é¡»æ˜æ™ºçš„åšæ³•æ˜¯åœ¨åŒä¸€è§†å›¾ä¸­è¿”å›åŒä¸€é¡µé¢-å¹¶ä¸”ä¸ä»…è¦åœ¨è§†å›¾ä¸­ä¼ é€’å¯¹è±¡</font></font><code>UserClass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè€Œä¸”è¿˜è¦</font><font style="vertical-align: inherit;">ä¼ é€’</font><font style="vertical-align: inherit;">è¿”å›é¡µé¢çš„å‚æ•°ã€‚æœ‰ä¸€ç§ç®€å•å¾—å¤šçš„æ–¹æ³•-å°†é€‰é¡¹ä¸æŒ‰é’®ä¸€èµ·ä½¿ç”¨ï¼š</font></font><code>/&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¿™ä¼šå°†ç”¨æˆ·å¸¦å›åˆ°æµè§ˆå™¨å†å²è®°å½•é¡µé¢ã€‚å½“ç„¶ï¼Œè¿™é‡Œæœ‰ä¸€äº›ç»†å¾®å·®åˆ«ï¼ˆä¾‹å¦‚ï¼Œæ‚¨å·²ç»å°è¯•å°†å¯¹è±¡ä¿å­˜åœ¨æ­¤é¡µé¢ä¸Šï¼Œå®ƒä¸èµ·ä½œç”¨ï¼Œç°åœ¨-æ‚¨å·²ç»éœ€è¦åŒå‡»â€œå–æ¶ˆâ€æŒ‰é’®äº†ï¼‰ï¼Œä½†æ˜¯æ­¤é€‰é¡¹ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥è¯´æ•ˆæœå¾ˆå¥½ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥åŠç”¨äºç¼–è¾‘ç±»å‹çš„å¯¹è±¡çš„è§†å›¾</font></font><code>UserClass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><img src="https://habrastorage.org/webt/a2/eo/xh/a2eoxhk3nzvbvs0h7s_nmjxuems.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠå…¶ä»£ç ï¼š</font></font><br><br><pre> <code class="cpp hljs">@model Example_Users.Models.UserModel @{ ViewBag.Title = <span class="hljs-string"><span class="hljs-string">"Edit "</span></span> + Html.DisplayNameForModel().ToString().ToLower(); } &lt;h2&gt;@ViewBag.Title @Model.User.Loginname&lt;/h2&gt; @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (@Html.BeginForm(<span class="hljs-string"><span class="hljs-string">"Edit"</span></span>, <span class="hljs-string"><span class="hljs-string">"Users"</span></span>, FormMethod.Post)) { @Html.HiddenFor(m =&gt; Model.User.UserID) &lt;div&gt; @Html.LabelFor(m =&gt; Model.User.Loginname) @Html.EditorFor(m =&gt; Model.User.Loginname) @Html.ValidationMessageFor(m =&gt; Model.User.Loginname) &lt;/div&gt; &lt;div&gt; @Html.LabelFor(m =&gt; Model.User.Language) @Html.DropDownListFor(m =&gt; Model.User.Language.LanguageID, Model.SelectLanguages()) @Html.ValidationMessageFor(m =&gt; Model.User.Language.LanguageID) &lt;/div&gt; &lt;div&gt; @Html.LabelFor(m =&gt; Model.User.Email) @Html.EditorFor(m =&gt; Model.User.Email) @Html.ValidationMessageFor(m =&gt; Model.User.Email) &lt;/div&gt; &lt;div&gt; @Html.LabelFor(m =&gt; Model.User.SupporterTier) @Html.EditorFor(m =&gt; Model.User.SupporterTier) @*@Html.EnumDropDownListFor(m =&gt; Model.User.SupporterTier)*@ @*@Html.DropDownListFor(m =&gt; m.Model.User.SupporterTier, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SelectList(Enum.GetNames(typeof(Example_Users.Domain.Supporter))))*@ @Html.ValidationMessageFor(m =&gt; Model.User.SupporterTier) &lt;/div&gt; &lt;br /&gt; &lt;p&gt;&lt;input type=<span class="hljs-string"><span class="hljs-string">"submit"</span></span> name=<span class="hljs-string"><span class="hljs-string">"action"</span></span> value=<span class="hljs-string"><span class="hljs-string">"Save"</span></span> /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"submit"</span></span> name=<span class="hljs-string"><span class="hljs-string">"action"</span></span> value=<span class="hljs-string"><span class="hljs-string">"Remove"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"javascript:return confirm('Are you sure?');"</span></span> /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"submit"</span></span> name=<span class="hljs-string"><span class="hljs-string">"action"</span></span> value=<span class="hljs-string"><span class="hljs-string">"Cancel"</span></span> /&gt;&lt;/p&gt; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶ä¸”åœ¨æ­¤è§†å›¾ä¸­ï¼Œæä¾›äº†ä½¿ç”¨ä¸åŒçš„åŠ©æ‰‹ä¸ºç±»å¯¹è±¡çš„æ¯ä¸ªæ‰€éœ€å±æ€§åˆ†åˆ«ç”Ÿæˆæ ‡ç­¾çš„é€‰é¡¹ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å·²ç»å¯ä»¥ä»¥ç¨å¾®æ›´æ¼‚äº®çš„æ–¹å¼è¿›è¡Œæ˜¾ç¤ºï¼š</font></font><br><br><img src="https://habrastorage.org/webt/3g/ew/as/3gewasn6m2whqy9odk4gvrn2l0c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤è§†å›¾ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹å¼è¿”å›åˆ—è¡¨ã€‚</font><font style="vertical-align: inherit;">è€Œä¸æ˜¯ä½¿ç”¨ç±»ä¼¼çš„æŒ‰é’®ï¼š</font></font><code>/&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›¸åŒçš„æŒ‰é’®ä¸å…¶ä»–æ“ä½œæŒ‰é’®ï¼ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Save</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remove</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ä¸€èµ·ä½¿ç”¨ï¼š</font></font><code>/&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶ä¸”è¿”å›æ˜¯åœ¨å¤„ç†è¿™äº›æŒ‰é’®çš„æ“ä½œçš„controlleræ–¹æ³•å†…è¿›è¡Œçš„ï¼ˆè¯·å‚è§ä¸‹é¢æ–¹æ³•çš„å®ç°ï¼‰ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æšä¸¾ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç„¶åå°±äº§ç”Ÿäº†ä¸</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»å‹çš„classå±æ€§æœ‰å…³çš„ç»†å¾®å·®åˆ«</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">äº‹å®æ˜¯ï¼Œå¦‚æœä»…ä½¿ç”¨å¸®åŠ©å™¨</font></font><code>Html.EditorFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™æ–‡æœ¬ä¿¡æ¯è¾“å…¥å­—æ®µï¼ˆtype tag </font></font><code>&lt;input type=â€textâ€/&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">å°†</font><font style="vertical-align: inherit;">æ˜¾ç¤ºåœ¨è¡¨å•ä¸Š</font><font style="vertical-align: inherit;">ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä»ä¸€ç»„å€¼ä¸­è¿›è¡Œé€‰æ‹©çš„å­—æ®µï¼ˆå³</font></font><code>&lt;select&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¸¦æœ‰ä¸€ç»„é€‰é¡¹</font><font style="vertical-align: inherit;">çš„æ ‡ç­¾</font></font><code>&lt;option&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.ç›´çº¿ä½¿ç”¨çš„è¾…åŠ©å‹è§£å†³</font></font><code>Html.DropDownListFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ–è€…</font></font><code>Html.ListBoxFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­</font></font><code>@Html.DropDownListFor(m =&gt; m.Model.User.SupporterTier, new SelectList(Enum.GetNames(typeof(Example_Users.Domain.Supporter))))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æœ‰ä¸¤ä¸ªç¼ºç‚¹-æ¯æ¬¡éƒ½å¿…é¡»å•ç‹¬ä¸ºåŠ©æ‰‹æŒ‡å®šå¤„æ–¹ï¼Œ</font></font><code>Html.EditorForModel()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦åˆ™</font></font><code>Html.EditorFor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒå°†ä¸èµ·ä½œç”¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹æ¨¡æ¿</font></font><code>Editor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">Views \ Shared \ EditorTemplatesæ–‡ä»¶å¤¹ä¸­</font></i><font style="vertical-align: inherit;">åˆ›å»º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supporter.cshtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ï¼š </font></font><br><br><pre> <code class="xml hljs">@model Example_Users.Domain.Supporter @Html.DropDownListFor(m =&gt; m, new SelectList(Enum.GetNames(Model.GetType()), Model.ToString()))</code> </pre> <br>      ,     <code>Html.EditorFor(m =&gt; Model.SupporterTier)</code> ,  <code>Html.EditorFor(m =&gt; Model.SupporterTier, "Supporter")</code> .    -,           <code>[UIHint("Supporter")]</code> .     ,    <code>Html.EditorForModel()</code> â€“     <code>Html.EditorFor(m =&gt; Model.SupporterTier, "Supporter")</code>  . <br><br>      -  ,     (  <code>New</code> )    <code>Html.EditorFor()</code>  <code>Html.EditorForModel()</code>   : Â« <i> ,   ,   NULL,         Â«Example_Users.Domain.SupporterÂ»,    NULL.</i> Â»   â€“       ,       .    . <br><br> 3.    <code>Html.EnumDropDownListFor()</code> ,    .    ,     ,   ,        .   Â«Â»:  <code>Html.EditorForModel()</code>       <code>Html.EditorFor()</code> , ,   <code>Html.EnumDropDownListFor()</code> . ,   ,          â€“ <code>[UIHint]</code> , <code>[DataType]</code>  <code>[EnumDataType]</code>   .        ,    None  , ,   ,       <code>Supporter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.ç»“æœï¼Œæˆ‘æƒ³å‡ºäº†ä¸€ä¸ª</font></font><a href="https://odetocode.com/Blogs/scott/archive/2012/08/29/working-with-enums-and-templates-in-asp-net-mvc.aspx" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨Internetä¸Šæ‰¾åˆ°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è§£å†³æ–¹æ¡ˆé€‰é¡¹</font><font style="vertical-align: inherit;">ï¼šåˆ›å»ºç”¨äºä¼ è¾“çš„é€šç”¨æ¨¡æ¿ã€‚</font><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">Views \ Shared \ EditorTemplatesæ–‡ä»¶å¤¹ä¸­</font></i><font style="vertical-align: inherit;">åˆ›å»º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enum.cshtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶</font><font style="vertical-align: inherit;">ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="xml hljs">@using System.ComponentModel.DataAnnotations @model Enum @{ Func<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">string</span></span></span><span class="hljs-tag">&gt;</span></span> GetDisplayName = o =&gt; { var result = null as string; var display = o.GetType() .GetMember(o.ToString()).First() .GetCustomAttributes(false) .OfType<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DisplayAttribute</span></span></span><span class="hljs-tag">&gt;</span></span>() .LastOrDefault(); if (display != null) result = display.GetName(); return result ?? o.ToString(); }; var values = Enum.GetValues(ViewData.ModelMetadata.ModelType).Cast<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span>() .Select(v =&gt; new SelectListItem { Selected = v.Equals(Model), Text = GetDisplayName(v), // v.ToString(), Value = v.ToString() }); } @Html.DropDownList("", values)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ€»çš„æ¥è¯´ï¼Œè¿™é‡Œä¸€åˆ‡éƒ½å¾ˆå¥½ï¼šæ¨¡æ¿åœ¨ä»»ä½•å¯èƒ½çš„åœ°æ–¹éƒ½å¾ˆå¥½ç”¨ã€‚</font><font style="vertical-align: inherit;">æ‚¨ç”šè‡³</font></font><code>[UIHint("Enum")]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ— æ³•æ·»åŠ ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œæ­¤é€šç”¨æ¨¡æ¿</font></font><code>[Display(Name)]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨ç‰¹æ®ŠåŠŸèƒ½</font><font style="vertical-align: inherit;">è¯»å–</font><font style="vertical-align: inherit;">æšä¸¾å€¼</font><font style="vertical-align: inherit;">çš„å±æ€§</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cè¡¨ç¤ºæ§åˆ¶å™¨ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UsersController.cs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶æ·»åŠ </font><font style="vertical-align: inherit;">åˆ°</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controllers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®å½•</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersController</span></span></span><span class="hljs-class"> :</span></span> Controller { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pageSize = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> showPages = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    public ViewResult Index(string sortOrder, int page = 1) { string sortName = null; System.Web.Helpers.SortDirection sortDir = System.Web.Helpers.SortDirection.Ascending; sortOrder = Base.parseSortForDB(sortOrder, out sortName, out sortDir); UsersRepository rep = new UsersRepository(); UsersGrid users = new UsersGrid { Users = rep.List(sortName, sortDir, page, pageSize, out count), PagingInfo = new PagingInfo { currentPage = page, itemsPerPage = pageSize, totalItems = count, showPages = showPages }, SortingInfo = new SortingInfo { currentOrder = sortName, currentDirection = sortDir } }; return View(users); } [ReferrerHold] [HttpPost] public ActionResult Index(string onNewUser) { if (onNewUser != null) { TempData["referrer"] = ControllerContext.RouteData.Values["referrer"]; return View("New", new UserModel(new UserClass(), Languages())); } return View(); } [ReferrerHold] public ActionResult New() { TempData["referrer"] = ControllerContext.RouteData.Values["referrer"]; return View("New", new UserModel(new UserClass(), Languages())); } [HttpPost] public ActionResult New(UserModel model) { if (ModelState.IsValid) { if (model.User == null || model.User.Language == null || model.User.Language.LanguageID == 0) RedirectToAction("Index"); UsersRepository rep = new UsersRepository(); if (rep.AddUser(model.User)) TempData["message"] = string.Format("{0} has been added", model.User.Loginname); else TempData["error"] = string.Format("{0} has not been added!", model.User.Loginname); if (TempData["referrer"] != null) return Redirect(TempData["referrer"].ToString()); return RedirectToAction("Index"); } else { model = new UserModel(model.User, Languages()); // -          model.Languages,   return View(model); } } [ReferrerHold] public ActionResult Edit(int UserID) { UsersRepository rep = new UsersRepository(); UserClass user = rep.FetchByID(UserID); if (user == null) return HttpNotFound(); TempData["referrer"] = ControllerContext.RouteData.Values["referrer"]; return View(new UserModel(user, Languages())); } [HttpPost] public ActionResult Edit(UserModel model, string action) { if (action == "Cancel") { if (TempData["referrer"] != null) return Redirect(TempData["referrer"].ToString()); return RedirectToAction("Index"); } if (ModelState.IsValid) { if (model.User == null || model.User.Language == null || model.User.Language.LanguageID == 0) RedirectToAction("Index"); UsersRepository rep = new UsersRepository(); if (action == "Save") { if (rep.ChangeUser(model.User)) TempData["message"] = string.Format("{0} has been saved", model.User.Loginname); else TempData["error"] = string.Format("{0} has not been saved!", model.User.Loginname); } if (action == "Remove") { if (rep.RemoveUser(model.User)) TempData["message"] = string.Format("{0} has been removed", model.User.Loginname); else TempData["error"] = string.Format("{0} has not been removed!", model.User.Loginname); } if (TempData["referrer"] != null) return Redirect(TempData["referrer"].ToString()); return RedirectToAction("Index"); } else { model = new UserModel(model.User, Languages()); return View(model); } } public IList&lt;LanguageClass&gt; Languages() { IList&lt;LanguageClass&gt; languages = new List&lt;LanguageClass&gt;(); LanguagesRepository rep = new LanguagesRepository(); languages = rep.List(); return languages; } }</span></span></code> </pre> <br>   : <br><br> 1)  <code>Index</code> <br><br>     : <code>public ViewResult Index(string sortOrder, int page = 1)</code> <br><br>     <code>sortOrder</code>  <code>page</code> .  <code>page</code>  - ,    <code>sortOrder</code>       ,       SQL-     .        (     ,     <i>Base.cs</i> ): <code>sortOrder = Base.parseSortForDB(sortOrder, out sortName, out sortDir);</code> <br><br>   ,    <code>UsersRepository</code> (   ,    ),   <code>List</code>         <code>UsersGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»ç”¨æˆ·çš„å®é™…åˆ—è¡¨ä»¥åŠç»„ç»‡ä¿¡æ¯åˆ†é¡µå’Œæ’åºæ‰€å¿…éœ€çš„ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œåœ¨è°ƒç”¨è¯¥æ–¹æ³•çš„</font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒæ—¶ä¸åˆ›å»ºç±»objectä¸€èµ·</font><font style="vertical-align: inherit;">è·å¾—totalItemçš„å€¼</font></font><code>UsersGrid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æ­¤å¤–ï¼Œè¯¥å¯¹è±¡è¢«è½¬ç§»ä»¥æ˜¾ç¤ºåˆ°è¡¨ç¤ºã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜æœ‰å¦ä¸€ä¸ªå…·æœ‰è¯¥å±æ€§çš„Indexæ–¹æ³•ï¼Œ</font></font><code>[HttpPost]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éœ€è¦</font></font><code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è§†å›¾ä¸­</font><font style="vertical-align: inherit;">è¿›è¡ŒæŒ‰é’®å•å‡»</font></font><code>Index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><code>public ActionResult Index(string onNewUser)</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¾“å…¥å‚æ•°</font></font><code>onNewUser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸</font></font><code>/&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§†å›¾ä¸­</font><font style="vertical-align: inherit;">çš„å…ƒç´ </font><font style="vertical-align: inherit;">æœ‰</font><font style="vertical-align: inherit;">ä¸€äº›å…±åŒç‚¹ï¼Œ</font></font><code>Index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“æˆ‘ä»¬å•å‡»æ­¤æŒ‰é’®æ—¶ï¼Œå®ƒå°†å‚æ•°å€¼ä¼ é€’ç»™ä¸</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¯”è¾ƒçš„å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚å¦‚æœç±»å‹æŒ‰é’®</font></font><code>submit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è§†å›¾ä¸­</font></font><code>Index</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡ ä¸ªï¼Œåˆ™å¿…é¡»æ£€æŸ¥å€¼æœ¬èº«ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥å€¼å°†æ˜¯â€œ New userâ€ï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ£€æŸ¥ä¹‹åï¼Œæˆ‘ä»¬å½¢æˆä¸€ä¸ªç±»å¯¹è±¡</font></font><code>UserModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">è¯¥ç±»å¯¹è±¡</font><font style="vertical-align: inherit;">ç”±ä¸€ä¸ªæ–°å¯¹è±¡</font></font><code>UserClass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œä¸€ç³»åˆ—è¯­è¨€</font><font style="vertical-align: inherit;">ç»„æˆï¼Œä»¥</font><font style="vertical-align: inherit;">ä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©å®ƒä»¬å¹¶å°†å…¶ä¼ é€’ç»™presentation </font></font><code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚é€šè¿‡</font><font style="vertical-align: inherit;">å¦‚ä¸‹</font></font><code>LanguageRepository</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–¹æ³•</font><font style="vertical-align: inherit;">ä»å­˜å‚¨åº“ä¸­è·å–è¯­è¨€åˆ—è¡¨</font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IList&lt;LanguageClass&gt; Languages() { LanguagesRepository rep = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguagesRepository(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rep.List(); }</code> </pre> <br> 2)  <code>New</code> <br><br>  <code>New</code>         <i>New User</i>    <code>Html.ActionLink("New user", "New", "Users")</code>   <code>Index</code> .  (  <code>New</code> )   ,      ,      . <br><br>  <code>New</code>   model  <code>UserModel</code>             : <code>public ActionResult New(UserModel model)</code> <br><br>    New    <code>UserModel</code> ,    ( ,   <code>UserClass</code>  <code>LanguageClass</code> ),    <code>UsersRepository</code>       ,   <code>AddUser(model.User)</code> .       (    <code>New</code> )          . <br><br> 3)  <code>Edit</code> <br><br>  <code>Edit</code>    <code>UserID</code> ( )             : <code>public ActionResult Edit(int UserID)</code> <br><br>       <code>UsersRepository</code>      <code>FetchByID(UserID)</code>     <code>UserClass</code> .      â€“   <code>UserModel</code>           <code>Edit</code>  . <br><br>       <code>UserModel</code>   <code>action</code> : <code>public ActionResult Edit(UserModel model, string action)</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°†ç±»å‹å¯¹è±¡ä¼ é€’ç»™æ­¤æ–¹æ³•</font></font><code>UserModel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå½“å•å‡»è§†å›¾çš„æŒ‰é’®ï¼ˆå¤„ç†ç”¨äºå‘é€è¡¨å•æ•°æ®çš„äº‹ä»¶ï¼‰æ—¶ï¼Œå®ƒä¼šå¤„ç†æ“ä½œ</font></font><code>Edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ä¸ºäº†äº†è§£æŒ‰ä¸‹äº†å“ªä¸ªæŒ‰é’®ï¼Œä½¿ç”¨äº†è¾“å…¥å‚æ•°ï¼Œè¯¥è¾“å…¥å‚æ•°</font></font><code>action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨HTML typeæ ‡ç­¾çš„åç§°ä¸­æŒ‡ç¤º</font></font><code>input</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚å› æ­¤ï¼Œè¯¥æ–¹æ³•å°†è¯¥å‚æ•°çš„å€¼ä¸</font></font><code>value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™äº›æŒ‰é’®</font><font style="vertical-align: inherit;">çš„å‚æ•°å€¼è¿›è¡Œæ¯”è¾ƒ</font><font style="vertical-align: inherit;">ã€‚åœ¨æ£€æŸ¥æ¨¡å‹çš„æœ‰æ•ˆæ€§ä¹‹å‰ï¼Œè¯·æ£€æŸ¥è¯¥å€¼</font></font><code>Cancel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥æ‰§è¡Œå–æ¶ˆç”¨æˆ·ç¼–è¾‘çš„æ“ä½œã€‚ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œè€Œä¸æ˜¯è¿”å›åˆ°è§†å›¾ä¸­</font></font><code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨</font><font style="vertical-align: inherit;">çš„æµè§ˆå™¨å†å²è®°å½•ï¼Œ</font><font style="vertical-align: inherit;">å¹¶ç”¨äºå­˜å‚¨ä»å…¶ä¼ é€’è§†å›¾çš„é¡µé¢çš„åœ°å€</font></font><code>Edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚ä¸ºæ­¤ï¼Œæ§åˆ¶å™¨æ¼”ç¤ºäº†ä½¿ç”¨å…¶å±æ€§çš„æŠ€æœ¯</font></font><code>ActionFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font><i><font style="vertical-align: inherit;">ReferrerHoldAttribute.cs</font></i></font><code>ReferrerHoldAttribute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶</font><font style="vertical-align: inherit;">ï¼ˆ</font><i><font style="vertical-align: inherit;">HtmlAttribute</font></i><font style="vertical-align: inherit;">ç›®å½•</font><font style="vertical-align: inherit;">ï¼‰ä¸­çš„ç±»ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReferrerHoldAttribute</span></span></span><span class="hljs-class"> :</span></span> ActionFilterAttribute { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnActionExecuting</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ActionExecutingContext filterContext)</span></span></span><span class="hljs-function"> </span></span>{ var referrer = filterContext.RequestContext.HttpContext.Request.UrlReferrer; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (referrer != null) filterContext.RouteData.Values.Add(<span class="hljs-string"><span class="hljs-string">"referrer"</span></span>, referrer); base.OnActionExecuting(filterContext); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒç”¨äºå­˜å‚¨æœ‰å…³åœ¨å•å‡»â€œ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–°ç”¨æˆ·</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> â€ </font><font style="vertical-align: inherit;">æŒ‰é’®</font><font style="vertical-align: inherit;">æˆ–æ›´æ”¹ç”¨æˆ·é“¾æ¥</font><font style="vertical-align: inherit;">åéœ€è¦è¿”å›çš„é¡µé¢çš„ä¿¡æ¯</font><font style="vertical-align: inherit;">ï¼š</font></font><code>TempData["referrer"] = ControllerContext.RouteData.Values["referrer"];</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬éœ€è¦å®ƒï¼Œä»¥ä¾¿æ¯æ¬¡æˆ‘ä»¬éƒ½ä¸ä¼šä»¥ä¸åŒçš„æ–¹æ³•ç¼–å†™ç›¸åŒçš„ä»£ç ã€‚å¯ä»¥åœ¨æ§åˆ¶å™¨ä¸­ç¼–å†™ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨å¤šä¸ªæ§åˆ¶å™¨ï¼Œåˆ™ä½¿ç”¨ç‰¹æ®Šçš„å±æ€§ç±»å‹æ›´ä¸ºå®ç”¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éšåï¼Œåœ¨å¤„ç†è§†å›¾</font></font><code>New</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font><font style="vertical-align: inherit;">çš„æ“ä½œçš„æ–¹æ³•çš„ä¸»ä½“ä¸­</font></font><code>Edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæå–å­˜å‚¨çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶ç”¨äºé‡å®šå‘å›ä»ä¸­è°ƒç”¨è¿™äº›è§†å›¾çš„é¡µé¢ï¼š</font></font><code>if (TempData["referrer"] != null) return Redirect(TempData["referrer"].ToString());</code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†ç¡®å®šæ˜¯å¦éœ€è¦ä¿å­˜æˆ–åˆ é™¤ç”¨æˆ·ï¼Œå°†å‚æ•°</font></font><code>action</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¿å­˜</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font><font style="vertical-align: inherit;">æ¯”è¾ƒ</font><font style="vertical-align: inherit;">ã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»å­˜å‚¨åº“ä¸­åˆ†åˆ«</font><i><font style="vertical-align: inherit;">åˆ é™¤</font></i><font style="vertical-align: inherit;">å’Œ</font></font><code>UsersRepository</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°</font></font><code>ChangeUser(model.User)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><code>RemoveUser(model.User)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">ç„¶åè¿”å›ä¸Šä¸€é¡µï¼ˆè§†å›¾è°ƒç”¨æ¥è‡ª</font></font><code>Edit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œå¹¶åœ¨æ­¤å¤„æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ï¼ŒæŒ‡ç¤ºæ“ä½œæˆåŠŸæˆ–å¤±è´¥ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ADO.NETå’ŒMySQL-å­˜å‚¨åº“ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»ˆäºå¼€å§‹ä½¿ç”¨DBMSã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬éœ€è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼šå°†ç”¨æˆ·æ·»åŠ åˆ°è¡¨ä¸­</font></font><code>Users</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæ›´æ”¹ç”¨æˆ·æ•°æ®ï¼Œä»è¡¨ä¸­åˆ é™¤ç”¨æˆ·ï¼Œé€šè¿‡IDè·å–ç”¨æˆ·ï¼Œè·å–ç”¨æˆ·åˆ—è¡¨ä»¥åŠä»è¡¨ä¸­è·å–è¯­è¨€åˆ—è¡¨</font></font><code>Languages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šå¸¸ï¼Œæ ‡å‡†ç»“æ„ç”¨äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MySQL.Data</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç±»ï¼Œ</font><font style="vertical-align: inherit;">ä½¿ç”¨</font></font><code>MySqlCommand</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection( )) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sql = <span class="hljs-string"><span class="hljs-string">" "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(sql, connect)) { cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">" "</span></span>,  ).Value =  ; connect.Open(); result = cmd.ExecuteNonQuery() &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//        (INSERT, UPDATE, DELETE)   cmd.ExecuteScalar()         SELECT } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ–</font></font><code>MySqlDataReader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”±äºæŸ¥è¯¢è€Œè¯»å–è¡¨è¡Œï¼š</font></font><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection( )) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sql = <span class="hljs-string"><span class="hljs-string">" "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlDataReader dr = cmd.ExecuteReader()) { cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">" "</span></span>,  ).Value =  ; objConnect.Open(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (dr.Read()) {<span class="hljs-comment"><span class="hljs-comment">//       } } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨</font><i><font style="vertical-align: inherit;">Models</font></i><font style="vertical-align: inherit;">ç›®å½•ä¸­</font><font style="vertical-align: inherit;">åˆ›å»º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserRepository.cs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶</font><font style="vertical-align: inherit;">ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersRepository</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserClass user)</span></span></span><span class="hljs-function"> </span></span>{ user.UserID = AddUser(Name: user.Loginname, LanguageID: user.Language.LanguageID, Email: user.Email, SupporterTier: user.SupporterTier); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> user.UserID &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LanguageID, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Email, Supporter SupporterTier)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ID = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(Base.strConnect)) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sql = <span class="hljs-string"><span class="hljs-string">"INSERT INTO `Users` (`Loginname`, `LanguageID`, `Email`, `SupporterTier`) VALUES (@Loginname, @LanguageID, @Email, @SupporterTier)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(sql, connect)) { cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"Loginname"</span></span>, MySqlDbType.String).Value = Name; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"LanguageID"</span></span>, MySqlDbType.Int32).Value = LanguageID; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"Email"</span></span>, MySqlDbType.String).Value = Email; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"SupporterTier"</span></span>, MySqlDbType.Int32).Value = SupporterTier; connect.Open(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cmd.ExecuteNonQuery() &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { sql = <span class="hljs-string"><span class="hljs-string">"SELECT LAST_INSERT_ID() AS ID"</span></span>; cmd.CommandText = sql; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.TryParse(cmd.ExecuteScalar().ToString(), out ID); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ID; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ChangeUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserClass user)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ChangeUser(ID: user.UserID, Name: user.Loginname, LanguageID: user.Language.LanguageID, Email: user.Email, SupporterTier: user.SupporterTier); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ChangeUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ID, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LanguageID, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Email, Supporter SupporterTier)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ID &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(Base.strConnect)) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sql = <span class="hljs-string"><span class="hljs-string">"UPDATE `Users` SET `Loginname`=@Loginname, `LanguageID`=@LanguageID, `Email`=@Email, `SupporterTier`=@SupporterTier WHERE UserID=@UserID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(sql, connect)) { cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"UserID"</span></span>, MySqlDbType.Int32).Value = ID; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"Loginname"</span></span>, MySqlDbType.String).Value = Name; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"LanguageID"</span></span>, MySqlDbType.Int32).Value = LanguageID; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"Email"</span></span>, MySqlDbType.String).Value = Email; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"SupporterTier"</span></span>, MySqlDbType.Int32).Value = SupporterTier; connect.Open(); result = cmd.ExecuteNonQuery() &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(UserClass user)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> RemoveUser(user.UserID); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ID)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection connect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(Base.strConnect)) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sql = <span class="hljs-string"><span class="hljs-string">"DELETE FROM `Users` WHERE `UserID`=@UserID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(sql, connect)) { cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"UserID"</span></span>, MySqlDbType.Int32).Value = ID; connect.Open(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cmd.ExecuteNonQuery() &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UserClass </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FetchByID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ID)</span></span></span><span class="hljs-function"> </span></span>{ UserClass user = null; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection objConnect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(Base.strConnect)) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> strSQL = <span class="hljs-string"><span class="hljs-string">"SELECT u.`UserID`, u.`Loginname`, l.`LanguageID`, l.`LanguageName`, u.`Email`, u.`LastLoginDate`, CAST(u.`SupporterTier` AS UNSIGNED) as `SupporterTier` FROM `Users` u LEFT JOIN `Languages` l ON l.LanguageID=u.LanguageID WHERE `UserID`=@UserID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(strSQL, objConnect)) { objConnect.Open(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> UserID = <span class="hljs-number"><span class="hljs-number">0</span></span>, LanguageID = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> Loginname = null, LanguageName= null, Email = String.Empty; Supporter SupporterTier = Supporter.None; DateTime? LastLoginDate = null; cmd.Parameters.Add(<span class="hljs-string"><span class="hljs-string">"UserID"</span></span>, MySqlDbType.Int32).Value = ID; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlDataReader dr = cmd.ExecuteReader()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dr.Read()) { UserID = dr.GetInt32(<span class="hljs-string"><span class="hljs-string">"UserID"</span></span>); Loginname = dr.GetString(<span class="hljs-string"><span class="hljs-string">"Loginname"</span></span>).ToString(); LanguageID = dr.GetInt32(<span class="hljs-string"><span class="hljs-string">"LanguageID"</span></span>); LanguageName = dr.GetString(<span class="hljs-string"><span class="hljs-string">"LanguageName"</span></span>).ToString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dr.IsDBNull(dr.GetOrdinal(<span class="hljs-string"><span class="hljs-string">"Email"</span></span>))) Email = dr.GetString(<span class="hljs-string"><span class="hljs-string">"Email"</span></span>).ToString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dr.IsDBNull(dr.GetOrdinal(<span class="hljs-string"><span class="hljs-string">"LastLoginDate"</span></span>))) LastLoginDate = dr.GetDateTime(<span class="hljs-string"><span class="hljs-string">"LastLoginDate"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dr.IsDBNull(dr.GetOrdinal(<span class="hljs-string"><span class="hljs-string">"SupporterTier"</span></span>))) SupporterTier = (Supporter)dr.GetInt32(<span class="hljs-string"><span class="hljs-string">"SupporterTier"</span></span>); } LanguageClass language = null; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (LanguageID &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) language = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageClass(LanguageID: LanguageID, LanguageName: LanguageName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UserID &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; language != null &amp;&amp; language.LanguageID &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) user = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UserClass(UserID: UserID, Loginname: Loginname, Language: language, Email: Email, LastLoginDate: LastLoginDate, SupporterTier: (Supporter)SupporterTier); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> user; } <span class="hljs-comment"><span class="hljs-comment">//       ASP.NET WebForms,             ObjectDataSource      //     ,         " "         //public IEnumerable&lt;DataRow&gt; List() //{ // using (MySqlConnection objConnect = new MySqlConnection(Base.strConnect)) // { // string strSQL = "select * from users"; // using (MySqlCommand objCommand = new MySqlCommand(strSQL, objConnect)) // { // objConnect.Open(); // using (MySqlDataAdapter da = new MySqlDataAdapter(objCommand)) // { // DataTable dt = new DataTable(); // da.Fill(dt); // return dt.AsEnumerable(); // } // } // } //} public IList&lt;UserClass&gt; List(string sortOrder, System.Web.Helpers.SortDirection sortDir, int page, int pagesize, out int count) { List&lt;UserClass&gt; users = new List&lt;UserClass&gt;(); using (MySqlConnection objConnect = new MySqlConnection(Base.strConnect)) { //     string sort = " ORDER BY "; //   ,               (inject) // ,  , MySQL        //    ,         (       ) //        ,    if (sortOrder != null &amp;&amp; sortOrder != String.Empty) { sort += "`" + sortOrder + "`"; if (sortDir == System.Web.Helpers.SortDirection.Descending) sort += " DESC"; sort += ","; } sort += "`UserID`"; //   //        ( ) string limit = ""; if (pagesize &gt; 0) { int start = (page - 1) * pagesize; limit = string.Concat(" LIMIT ", start.ToString(), ", ", pagesize.ToString()); } string strSQL = "SELECT SQL_CALC_FOUND_ROWS u.`UserID`, u.`Loginname`, l.`LanguageID`, l.`LanguageName` as `Language`, u.`Email`, u.`LastLoginDate`, CAST(u.`SupporterTier` AS UNSIGNED) as `SupporterTier` FROM `Users` u LEFT JOIN `Languages` l ON l.LanguageID=u.LanguageID" + sort + limit; using (MySqlCommand cmd = new MySqlCommand(strSQL, objConnect)) { objConnect.Open(); cmd.Parameters.Add("page", MySqlDbType.Int32).Value = page; cmd.Parameters.Add("pagesize", MySqlDbType.Int32).Value = pagesize; using (MySqlDataReader dr = cmd.ExecuteReader()) { while (dr.Read()) { LanguageClass language = new LanguageClass(LanguageID: dr.GetInt32("LanguageID"), LanguageName: dr.GetString("Language").ToString()); users.Add(new UserClass( UserID: dr.GetInt32("UserID"), Loginname: dr.GetString("Loginname"), Language: language, Email: dr.IsDBNull(dr.GetOrdinal("Email")) ? String.Empty : dr.GetString("Email"), LastLoginDate: dr.IsDBNull(dr.GetOrdinal("LastLoginDate")) ? (DateTime?) null : dr.GetDateTime("LastLoginDate"), SupporterTier: dr.IsDBNull(dr.GetOrdinal("SupporterTier")) ? (Supporter) Supporter.None : (Supporter)dr.GetInt32("SupporterTier"))); } } } using (MySqlCommand cmdrows = new MySqlCommand("SELECT FOUND_ROWS()", objConnect)) { int.TryParse(cmdrows.ExecuteScalar().ToString(), out count); } } return users; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒåŒ…å«ä¸€ç§</font></font><code>AddUser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨äºæ·»åŠ ç”¨æˆ·ï¼Œæ›´æ–°ç”¨æˆ·æ•°æ®ï¼ˆ</font></font><code>ChangeUser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œåˆ é™¤ï¼ˆ</font></font><code>RemoveUser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰ï¼Œ</font></font><code>FetchByID</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡ID </font><font style="vertical-align: inherit;">æœç´¢ç”¨æˆ·ï¼ˆ</font><font style="vertical-align: inherit;">ï¼‰çš„æ–¹æ³•</font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font><font style="vertical-align: inherit;">ä»¥åŠ</font><font style="vertical-align: inherit;">ç”¨äºæ˜¾ç¤ºç”¨æˆ·åˆ†é¡µåˆ—è¡¨è¿›è¡Œæ’åº</font><font style="vertical-align: inherit;">çš„æœ€æœ‰è¶£çš„æ–¹æ³•</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æˆ‘è¿˜è¦å¯¹åŠŸèƒ½è¿›è¡Œè¯„è®º</font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æ­¤è¿”å›è¡¨ï¼ˆ</font></font><code>DataTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼‰</font><font style="vertical-align: inherit;">æ˜¯ä¸å€¼å¾—çš„</font><font style="vertical-align: inherit;">-åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å¤±å»è®¿é—®è§†å›¾ä¸­ç±»çš„å…ƒç´ çš„èƒ½åŠ›ï¼Œå¹¶ä¸”å°†è¢«è¿«ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡æ¥å¼•ç”¨è¡¨è¡Œä¸­çš„å€¼ã€‚</font></font>å³          SQL-.       <code>UserClass</code> . </li><li>          <code>LIMIT</code>  SQL- <code>SELECT</code> .  ,  MySQL      ,   <code>LIMIT</code>       .   ,     ,       <code>ORDER BY</code>           . ,         SQL-,     SQL   ,       ,     .       ,      ,          :         . </li><li>           SQL  <code>SELECT FOUND_ROWS()</code> ,          ,     <code>SELECT SQL_CALC_FOUND_ROWS</code>     <code>LIMIT</code> . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‰€æœ‰å…¶ä»–æ–¹æ³•éƒ½æ˜¯å®Œå…¨æ™®é€šçš„ï¼Œä¸ä¸Šé¢çš„æ ‡å‡†ä¸€è‡´ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥åŠ</font><i><font style="vertical-align: inherit;">Models</font></i><font style="vertical-align: inherit;">ç›®å½•ä¸­</font><font style="vertical-align: inherit;">çš„</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LanguageRepository.cs</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ–‡ä»¶</font><font style="vertical-align: inherit;">ï¼š</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LanguagesRepository</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IList&lt;LanguageClass&gt; List() { List&lt;LanguageClass&gt; languages = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;LanguageClass&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlConnection objConnect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlConnection(Base.strConnect)) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> strSQL = <span class="hljs-string"><span class="hljs-string">"SELECT `LanguageID`, `LanguageName` as `Language` FROM `Languages` ORDER BY `LanguageName`"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MySqlCommand(strSQL, objConnect)) { objConnect.Open(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (MySqlDataReader dr = cmd.ExecuteReader()) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (dr.Read()) { LanguageClass language = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageClass(LanguageID: dr.GetInt32(<span class="hljs-string"><span class="hljs-string">"LanguageID"</span></span>), LanguageName: dr.GetString(<span class="hljs-string"><span class="hljs-string">"Language"</span></span>).ToString()); languages.Add(language); } } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> languages; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒåªæœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥ä»æ•°æ®åº“ä¸­è·å–è¯­è¨€åˆ—è¡¨ï¼Œå¹¶åˆ›å»ºç±»å…ƒç´ åˆ—è¡¨</font></font><code>LanguageClass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><h2> åˆè®¡ </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°±è¿™æ ·-ä»»åŠ¡è§£å†³äº†ã€‚</font><font style="vertical-align: inherit;">æ˜¾ç„¶ï¼Œè®¸å¤šé—®é¢˜æ²¡æœ‰è§£å†³ï¼šä¾èµ–æ³¨å…¥å®¹å™¨ï¼Œå•å…ƒæµ‹è¯•ï¼Œä¿®æ”¹å·¥å…·ï¼Œæœ¬åœ°åŒ–ç­‰ã€‚</font></font>ç­‰<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰äº›äº‹æƒ…å¯ä»¥åšçš„ä¸åŒï¼Œä¹Ÿå¯ä»¥åšå¾—æ›´å¥½ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ç»“æœå‡ºæ¥çš„â€œç –å—â€è¶³å¤Ÿå®Œæ•´ï¼Œè¶³ä»¥ç†è§£ASP.NET MVCçš„å·¥ä½œåŸç†ï¼Œå¹¶ä¸”ä¸éMS SQLçš„ADO.NETå’ŒDBMSä¸€èµ·ä½¿ç”¨ä¹Ÿä¸æ˜¯é‚£ä¹ˆä»¤äººææƒ§ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PSæœ€åï¼šæ‚¨å¯ä»¥åœ¨</font></font><a href="http://example-mvc.azurewebsites.net/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤åœ°å€</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŸ¥çœ‹è¯¥é¡¹ç›®çš„å·¥ä½œæ–¹å¼</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è€Œ</font></font><a href="https://yadi.sk/d/EArrZdGh_iVaJg" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä½ å¯ä»¥ä¸‹è½½æ•´ä¸ªé¡¹ç›®ã€‚</font><font style="vertical-align: inherit;">å¥½äº†ï¼Œåˆ°å †- </font></font><a href="https://dukeyusupov.wordpress.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘çš„åšå®¢</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„é“¾æ¥</font><font style="vertical-align: inherit;">ã€‚</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN482346/">https://habr.com/ru/post/zh-CN482346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN482330/index.html">ç”¨äºå‰–æRuby on Railsåº”ç”¨ç¨‹åºçš„åŸºæœ¬gemåˆ—è¡¨</a></li>
<li><a href="../zh-CN482336/index.html">äº¤æ˜“è€…å¯ä»¥åœ¨å…¬å…±å¹¿æ’­ä¹‹å‰å‚åŠ è‹±æ ¼å…°ä¸­å¤®é“¶è¡Œçš„æ–°é—»å‘å¸ƒä¼š</a></li>
<li><a href="../zh-CN482338/index.html">Visual Studio for Macï¼šç”¨é”®æ§åˆ¶æ‚¨çš„IDE</a></li>
<li><a href="../zh-CN482340/index.html">ä»åˆçº§åˆ°ä¸­çº§ï¼šè§£æå™¨</a></li>
<li><a href="../zh-CN482344/index.html">å‡†å¤‡åœ¨ä¿„ç½—æ–¯å¼•å…¥ç¤¾ä¼šè¯„çº§</a></li>
<li><a href="../zh-CN482348/index.html">æ¯«ä¸æ€€ç–‘çš„æ¸¸æˆå¼€å‘è€…çš„æ‹“æ‰‘å’Œç»¼åˆåˆ†æï¼šå‹ç¼©å•ä¸ª3Då‘é‡</a></li>
<li><a href="../zh-CN482352/index.html">å½“æˆ‘å·®ç‚¹å°†150kæŠ•å‘é£æˆ–è€…å…¬å¯“ä¸­å¼ºåˆ¶é€šé£çš„å®‰è£…å†å²æ—¶</a></li>
<li><a href="../zh-CN482354/index.html">ConfigureAwaitï¼šå¸¸è§é—®é¢˜</a></li>
<li><a href="../zh-CN482356/index.html">ä»å¸¸è§„Windowsç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œåœ¨æ²¡æœ‰èµ„æºç®¡ç†å™¨çš„æƒ…å†µä¸‹ä½¿ç”¨Windows Server</a></li>
<li><a href="../zh-CN482358/index.html">æƒŠæ…Œå¦‚ä½•åœ¨Rustä¸­å‘æŒ¥ä½œç”¨</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>