<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëºüèΩ üê± üó£Ô∏è Erstellen eines InnoDB-Clusters aus MySQL 5.7 auf Centos 7 üÜö üîØ üë®‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! 

 Sobald eine Aufgabe im Job angezeigt wurde - auf mehreren virtuellen Maschinen mit Centos 7.5 scheint es einen konfigurierten Tes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen eines InnoDB-Clusters aus MySQL 5.7 auf Centos 7</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423587/">  Hallo allerseits! <br><br>  Sobald eine Aufgabe im Job angezeigt wurde - auf mehreren virtuellen Maschinen mit Centos 7.5 scheint es einen konfigurierten Test-InnoDB-Cluster zu geben. Sie m√ºssen ihn untersuchen und ein paar weitere Knoten hinzuf√ºgen.  Sie k√∂nnen brechen und verspotten, wie Sie m√∂chten.  Klingt verlockend. <br><a name="habracut"></a><br>  Zuvor hatte ich keine Erfahrung mit einem solchen Cluster, aber Google half. <br>  Mit wenigen Ausnahmen befanden sich alle Links darin und in Yandex entweder auf dev.mysql.com oder in diesem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel auf Habr</a> .  Es scheint, als w√§re ein Cluster von zwei Knoten darauf konfiguriert worden. <br><br>  Nun, ich habe den Artikel gelesen, ich war etwas √ºberrascht √ºber die Komplexit√§t des Hinzuf√ºgens von Knoten und das Fehlen vieler Details, aber na ja.  Mit einer S√ºnde f√ºgte ich einen halben neuen Knoten hinzu (einige der Befehle waren nicht n√ºtzlich, andere brachen alles), woraufhin ich anfing, mit dem Neustart der Knoten usw. zu experimentieren. <br><br>  Nach mehreren Ans√§tzen und unz√§hligen Todesf√§llen von Nervenzellen konnte der Cluster es nicht ertragen.  Ein Knoten wollte unter keinen Umst√§nden hinzugef√ºgt werden, der andere legte auf, als ich versuchte, auf die Datenbank zuzugreifen, der dritte tat so, als sei alles in Ordnung.  Ich musste schie√üen und von vorne anfangen. <br><br>  Beim Erstellen eines neuen Clusters traten leider viele Probleme und Inkonsistenzen auf.  Vielleicht liegt der Punkt in Softwareversionen, ich habe MySQL 5.7 ausprobiert.  Vielleicht in der Distribution.  Infolgedessen stoppte ich gedankenlose Versuche, alles auf einem St√ºck Papier zu tun, und begann, es durch Tippen einzurichten.  Und google. <br><br>  Ein paar angenehme Abende und N√§chte, und die Gruppe versammelte sich und weigerte sich sogar, zusammenzubrechen. <br>  Gleichzeitig unterschied sich die Methode ihrer Erstellung deutlich von fr√ºheren Versuchen, und ich wollte sie teilen, weil  Im Internet habe ich keine anderen relevanten detaillierten verst√§ndlichen Anweisungen zum Einrichten des inndoDB-Clusters gefunden. <br><br>  Wir haben also drei identische virtuelle Maschinen mit dem neu installierten Centos 7.5 Minimum 1804 und deaktiviertem Selinux und Firewalld: <br><br>  1.1.1.1 <br>  1.1.1.2 <br>  1.1.1.3 <br><br>  F√ºr die Arbeit habe ich MySQL 5.7 verwendet, also verwenden wir es.  Beginnen wir mit 1.1.1.1: <br><br>  1. Installieren Sie das MySQL-Community-Repository: <br><br><pre><code class="hljs powershell">rpm <span class="hljs-literal"><span class="hljs-literal">-i</span></span> https://dev.mysql.com/get/mysql80<span class="hljs-literal"><span class="hljs-literal">-community</span></span><span class="hljs-literal"><span class="hljs-literal">-release</span></span><span class="hljs-literal"><span class="hljs-literal">-el7</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span>.noarch.rpm</code> </pre> <br>  Schalten Sie das Repository f√ºr 8 aus, schalten Sie es f√ºr 5.7 ein und √ºberpr√ºfen Sie, ob alles in Ordnung ist. Installieren Sie dann mysql: <br><br><pre> <code class="hljs powershell">yum install yum<span class="hljs-literal"><span class="hljs-literal">-utils</span></span> yum<span class="hljs-literal"><span class="hljs-literal">-config</span></span><span class="hljs-literal"><span class="hljs-literal">-manager</span></span> -<span class="hljs-literal"><span class="hljs-literal">-disable</span></span> mysql80<span class="hljs-literal"><span class="hljs-literal">-community</span></span> yum<span class="hljs-literal"><span class="hljs-literal">-config</span></span><span class="hljs-literal"><span class="hljs-literal">-manager</span></span> -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span> mysql57<span class="hljs-literal"><span class="hljs-literal">-community</span></span> yum repolist yum install mysql<span class="hljs-literal"><span class="hljs-literal">-community</span></span><span class="hljs-literal"><span class="hljs-literal">-server</span></span> mysql<span class="hljs-literal"><span class="hljs-literal">-shell</span></span></code> </pre> <br>  2. Wir bringen /etc/my.cnf in dieses Formular: <br><br><pre> <code class="hljs pgsql">[mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock symbolic-links=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>-error=/var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/mysqld.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> pid-file=/var/run/mysqld/mysqld.pid bind-address=<span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> port=<span class="hljs-number"><span class="hljs-number">3301</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Replication</span></span> part server_id=<span class="hljs-number"><span class="hljs-number">1</span></span> gtid_mode=<span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> enforce_gtid_consistency=<span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> master_info_repository=<span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> relay_log_info_repository=<span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> binlog_checksum=<span class="hljs-keyword"><span class="hljs-keyword">NONE</span></span> log_slave_updates=<span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> log_bin=binlog binlog_format=<span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> plugin-<span class="hljs-keyword"><span class="hljs-keyword">load</span></span> = group_replication.so # <span class="hljs-keyword"><span class="hljs-keyword">Group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">replication</span></span> part transaction_write_set_extraction=XXHASH64 loose-group_replication_start_on_boot = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span> loose-group_replication_local_address = <span class="hljs-number"><span class="hljs-number">1.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">33011</span></span> loose-group_replication_bootstrap_group = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span> report_port = <span class="hljs-number"><span class="hljs-number">3301</span></span> report_host = <span class="hljs-number"><span class="hljs-number">1.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span></code> </pre><br>  Hier ist 3301 der Port, an dem MySQL lauscht, und 33011 ist der Port, an dem die Knoten miteinander kommunizieren. <br><br>  3. Starten Sie MySQL und f√ºhren Sie die vorl√§ufige Konfiguration durch: <br><br><pre> <code class="hljs pgsql">systemctl <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> mysqld grep <span class="hljs-string"><span class="hljs-string">'password'</span></span> /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/mysqld.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> mysql_secure_installation</code> </pre> <br>  4. Erstellen Sie einen Cluster sowie einen separaten Benutzer, um ihn zu verwalten.  Wenn Sie die IP-Adressen der Knoten im Voraus kennen, k√∂nnen Sie sie sofort in der ipWhitelist auflisten.  Wir werden so tun, als w√ºssten wir noch nichts √ºber 1.1.1.2.  und 1.1.1.3: <br><br><pre> <code class="hljs perl">mysqlsh &gt; \c <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">3301</span></span> &gt; dba.configureLocalInstance(<span class="hljs-string"><span class="hljs-string">"127.0.0.1:3301"</span></span>, {mycnfPath: <span class="hljs-string"><span class="hljs-string">"/etc/my.cnf"</span></span>, clusterAdmin: <span class="hljs-string"><span class="hljs-string">"cladmin"</span></span>, clusterAdminPassword: <span class="hljs-string"><span class="hljs-string">"SomePassword!123"</span></span>}) &gt; \c cladmin@1.<span class="hljs-number"><span class="hljs-number">1.1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">3301</span></span> &gt; dba.checkInstanceConfiguration() &gt; cl=dba.createCluster(<span class="hljs-string"><span class="hljs-string">'TestCluster'</span></span>, {ipWhitelist: <span class="hljs-string"><span class="hljs-string">'1.1.1.1'</span></span>}) &gt; dba.configureLocalInstance() &gt; cl.status()</code> </pre> <br>  Fertig!  cl.status sollte ungef√§hr Folgendes ausgeben: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"clusterName"</span></span>: <span class="hljs-string"><span class="hljs-string">"TestCluster"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"defaultReplicaSet"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"default"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"primary"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.1:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ssl"</span></span>: <span class="hljs-string"><span class="hljs-string">"REQUIRED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"OK_NO_TOLERANCE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusText"</span></span>: <span class="hljs-string"><span class="hljs-string">"Cluster is NOT tolerant to any failures."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"topology"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"1.1.1.1:3301"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.1:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"R/W"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readReplicas"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"HA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ONLINE"</span></span> } } }, <span class="hljs-attr"><span class="hljs-attr">"groupInformationSourceMember"</span></span>: <span class="hljs-string"><span class="hljs-string">"mysql://cladmin@1.1.1.1:3301"</span></span> }</code> </pre><br>  Beim √Ñndern des Clusters muss der Befehl dba.configureLocalInstance () lokal auf allen Knoten ausgef√ºhrt werden, um die √Ñnderungen zu speichern: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">WARNING</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">On</span></span> instance <span class="hljs-string"><span class="hljs-string">'1.1.1.1:3301'</span></span> membership change cannot be persisted since MySQL <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> <span class="hljs-number"><span class="hljs-number">5.7</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span> does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support the <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> PERSIST command (MySQL <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> &gt;= <span class="hljs-number"><span class="hljs-number">8.0</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span> required). Please use the &lt;Dba&gt;.configureLocalInstance command locally <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> persist the changes.</code> </pre> <br>  Weil  Wir werden ein paar weitere Knoten hinzuf√ºgen. Wir schlie√üen die Verbindung mit Server 1.1.1.1 nicht, dies ist praktisch f√ºr uns. <br><br>  Versuchen wir nun, dem Cluster den Knoten 1.1.1.2 hinzuzuf√ºgen.  Zu diesem Zweck f√ºhren wir dieselben Befehle in bis zu 3 Schritten aus, wobei wir nicht vergessen, server_id, lose Gruppenreplikationslokaladresse und report_host zu √§ndern. <br><br>  4. Wir f√ºhren am 1.1.1.2 aus: <br><br><pre> <code class="hljs pgsql">mysql -p &gt; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GLOBAL</span></span> group_replication_allow_local_disjoint_gtids_join=<span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>;</code> </pre> <br>  Ich habe versucht, diese Variable √ºber mysqlsh festzulegen und in den SQL-Modus zu wechseln, aber die dortigen Aktionen hatten keine Auswirkungen auf mysql.  Weiter: <br><br><pre> <code class="hljs swift">mysqlsh &gt; \<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.1</span></span>:<span class="hljs-number"><span class="hljs-number">3301</span></span> &gt; dba.configureLocalInstance(<span class="hljs-string"><span class="hljs-string">"127.0.0.1:3301"</span></span>, {mycnfPath: <span class="hljs-string"><span class="hljs-string">"/etc/my.cnf"</span></span>, clusterAdmin: <span class="hljs-string"><span class="hljs-string">"cladmin"</span></span>, clusterAdminPassword: <span class="hljs-string"><span class="hljs-string">"SomePassword!123"</span></span>}) &gt; \<span class="hljs-built_in"><span class="hljs-built_in">c</span></span> cladmin@<span class="hljs-number"><span class="hljs-number">1.1</span></span>.<span class="hljs-number"><span class="hljs-number">1.2</span></span>:<span class="hljs-number"><span class="hljs-number">3301</span></span> &gt; dba.checkInstanceConfiguration()</code> </pre> <br><br>  5. Kehren Sie zum ersten Knoten 1.1.1.1 zur√ºck.  Wenn Sie die Verbindung geschlossen haben, k√∂nnen Sie schnell eine Verbindung zum Cluster herstellen: <br><br><pre> <code class="hljs mel">mysqlsh --uri cladmin@1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">3301</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span> &gt; \sql &gt; STOP GROUP_REPLICATION; &gt; SET GLOBAL group_replication_ip_whitelist=<span class="hljs-string"><span class="hljs-string">"1.1.1.1,1.1.1.2"</span></span>; &gt; START GROUP_REPLICATION; &gt; \js &gt; <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>.addInstance(<span class="hljs-string"><span class="hljs-string">'cladmin@1.1.1.2:3301'</span></span>, {ipWhitelist: <span class="hljs-string"><span class="hljs-string">'1.1.1.1,1.1.1.2'</span></span>}) &gt; <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>.status()</code> </pre><br>  Wenn Sie einen Knoten ohne die Option ipWhitelist hinzuf√ºgen, wird er aus irgendeinem Grund nicht automatisch an ihn √ºbertragen. Daher geben wir ihn manuell an. <br>  Wenn Ihre Whitelist anf√§nglich f√ºr alle Knoten oder ein Subnetz konfiguriert ist, k√∂nnen Befehle im SQL-Modus √ºbersprungen werden. <br><br>  Vergessen Sie nicht, dba.configureLocalInstance () auf allen Knoten auszuf√ºhren, um die Konfiguration zu speichern. <br><br>  Der Cluster ihrer beiden Knoten stellte sich heraus: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"clusterName"</span></span>: <span class="hljs-string"><span class="hljs-string">"TestCluster"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"defaultReplicaSet"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"default"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"primary"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.1:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ssl"</span></span>: <span class="hljs-string"><span class="hljs-string">"REQUIRED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"OK_NO_TOLERANCE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusText"</span></span>: <span class="hljs-string"><span class="hljs-string">"Cluster is NOT tolerant to any failures."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"topology"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"1.1.1.1:3301"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.1:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"R/W"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readReplicas"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"HA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ONLINE"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"1.1.1.2:3301"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.2:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"R/O"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readReplicas"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"HA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ONLINE"</span></span> } } }, <span class="hljs-attr"><span class="hljs-attr">"groupInformationSourceMember"</span></span>: <span class="hljs-string"><span class="hljs-string">"mysql://cladmin@1.1.1.1:3301"</span></span> }</code> </pre><br>  Nun, es gibt einen Cluster aus zwei Knoten, aber im Modus "Cluster ist NICHT tolerant gegen√ºber Fehlern" <br>  F√ºgen Sie einen dritten hinzu, der Algorithmus ist im Grunde der gleiche wie das Hinzuf√ºgen eines zweiten. <br><br>  Wenn Sie die Whitelist erneut √§ndern m√ºssen, m√ºssen Sie die Befehle auf dem R / W-Knoten ausf√ºhren, weil  Auf R / O-Knoten scheint es zu nichts zu f√ºhren.  In diesem Fall fallen die R / O-Knoten ab und m√ºssen erneut verbunden werden, wobei gleichzeitig eine neue Whitelist gemeldet wird. <br>  In unserem Fall: <br><br><pre> <code class="hljs pgsql">&gt; <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>.rejoinInstance(<span class="hljs-string"><span class="hljs-string">'cladmin@1.1.1.2:3301'</span></span>, {ipWhitelist: <span class="hljs-string"><span class="hljs-string">'1.1.1.1,1.1.1.2,1.1.1.3'</span></span>})</code> </pre> <br>  Vergessen Sie auch hier nicht, dba.configureLocalInstance () auf allen Knoten auszuf√ºhren, um die Konfiguration zu speichern. <br><br>  Ein Cluster von drei Knoten sieht folgenderma√üen aus: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"clusterName"</span></span>: <span class="hljs-string"><span class="hljs-string">"TestCluster"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"defaultReplicaSet"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"default"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"primary"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.1:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ssl"</span></span>: <span class="hljs-string"><span class="hljs-string">"REQUIRED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusText"</span></span>: <span class="hljs-string"><span class="hljs-string">"Cluster is ONLINE and can tolerate up to ONE failure."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"topology"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"1.1.1.1:3301"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.1:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"R/W"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readReplicas"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"HA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ONLINE"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"1.1.1.2:3301"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.2:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"R/O"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readReplicas"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"HA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ONLINE"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"1.1.1.3:3301"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.1.1.3:3301"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"R/O"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"readReplicas"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"role"</span></span>: <span class="hljs-string"><span class="hljs-string">"HA"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"ONLINE"</span></span> } } }, <span class="hljs-attr"><span class="hljs-attr">"groupInformationSourceMember"</span></span>: <span class="hljs-string"><span class="hljs-string">"mysql://cladmin@1.1.1.1:3301"</span></span> }</code> </pre><br>  Wenn der Cluster auf den Status eines Knotens zusammengebrochen ist, muss er mit dem Parameter lose-Gruppenreplikation_bootstrap_group = ON in /etc/my.cnf gestartet werden <br>  Nach dem Start muss der Parameter wieder ausgeschaltet werden, andernfalls wird dieser Knoten immer vom Cluster getrennt und beh√§lt seinen eigenen bei. <br><br>  Die Installation des MySQL-Routers wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ausf√ºhrlich beschrieben, sodass ich keinen Sinn darin sehe, sie zu duplizieren. <br><br>  Das ist alles, das ist es, ich hoffe, jemand wird meine Erfahrung n√ºtzlich finden. <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de423587/">https://habr.com/ru/post/de423587/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de423575/index.html">Designstandards in der Mikroelektronik: Wo gibt es wirklich 7 Nanometer in der 7-nm-Technologie?</a></li>
<li><a href="../de423577/index.html">Erstellen eines Logikspiels f√ºr eine Spieleplattform</a></li>
<li><a href="../de423579/index.html">Cloud Services f√ºr WebGL? Nein danke</a></li>
<li><a href="../de423583/index.html">Erhalten von Unf√§llen durch NotificationIRP in OSS</a></li>
<li><a href="../de423585/index.html">Live: CI / CD unter iOS und Android</a></li>
<li><a href="../de423589/index.html">Wie wir TTS zum Beispiel ausgew√§hlt haben, klingt im W√∂rterbuch</a></li>
<li><a href="../de423591/index.html">Alte Lieder √ºber die Hauptsache. Java und ausgehende Anfragen</a></li>
<li><a href="../de423593/index.html">Google k√ºndigt einen Wettbewerb f√ºr Angriffe auf Bildverarbeitungsalgorithmen an</a></li>
<li><a href="../de423595/index.html">Frango Anomalie, Austausch</a></li>
<li><a href="../de423597/index.html">Wie und welche Cluster k√∂nnen im Kundenstamm zugeordnet werden?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>