<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”¯ ğŸ¤¸ğŸ½ ğŸ“ƒ Imperva enthÃ¼llte technische Details des Cloud WAF-Hacks ğŸ• ğŸ§”ğŸ½ ğŸ‘ˆğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ende August informierte Imperva Kunden von Cloud WAF (ehemals Incapsula) Ã¼ber das Auslaufen vertraulicher Informationen und leitete ein ZurÃ¼cksetzen d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Imperva enthÃ¼llte technische Details des Cloud WAF-Hacks</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/472708/">  Ende August <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">informierte</a> Imperva Kunden von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud WAF</a> (ehemals Incapsula) Ã¼ber das Auslaufen vertraulicher Informationen und leitete ein ZurÃ¼cksetzen der KontokennwÃ¶rter ein.  Es stellte sich heraus, dass AuÃŸenstehende Zugriff auf Kennwort-Hashes, API-SchlÃ¼ssel und SSL-Zertifikate erhielten. <br><br>  Am 10. Oktober legten Chris Hylen, CEO des Unternehmens, und Kunal Anand, CTO, eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Obduktion vor,</a> in der der Vorfall detailliert beschrieben wurde.  Wie kÃ¶nnte dies bei einem Unternehmen geschehen, das sich auf Daten- und Anwendungsschutz spezialisiert hat? <br><br>  Zusammenfassend ist das Problem auf eine <b>fehlerhafte Migration der Datenbank von Ihrem eigenen Hosting zu Amazon Web Services zurÃ¼ckzufÃ¼hren</b> . <br><br>  In seinem Beitrag listet Chris Heilan eine Reihe von Fehlern auf, die wÃ¤hrend der Migration gemacht wurden.  Zusammen erlaubten sie Unbekannten, den Administrator-API-SchlÃ¼ssel fÃ¼r eines der Konten in der Produktion von Amazon Web Services zu stehlen.  Eine Untersuchung ergab, dass bereits im Oktober 2018 unbefugter Zugriff erfolgte. <br><br>  Mit dem AdministratorschlÃ¼ssel erhielt der Angreifer Zugriff auf einen Datenbank-Snapshot mit verschiedenen Informationen zu Clients, die sich vor dem 15. September 2017 registriert haben.  Zu den Informationen gehÃ¶rten E-Mail-Adressen, gehashte und salzige PasswÃ¶rter sowie fÃ¼r eine Reihe von Clients API-SchlÃ¼ssel und SSL-Zertifikate, die von Clients bereitgestellt wurden. <br><a name="habracut"></a><br><h2>  Chronologie des Scheiterns </h2><br>  Laut CTO begann alles im Jahr 2017, als das Unternehmen Ã¼berlegte, auf den AWS-Dienst ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Relational Database Service</a> , RDS) umzusteigen, da das Incapsula-System â€aufgrund der Gewinnung neuer Kunden und der ErfÃ¼llung ihrer kritischen Anforderungen unter erheblichem Druck standâ€œ. .  Der Ãœbergang zum Cloud-Hosting war erforderlich, um das GeschÃ¤ft zu skalieren. <br><br>  "Einige der wichtigsten Entscheidungen, die wÃ¤hrend des AWS-Evaluierungsprozesses getroffen wurden, wurden kombiniert, um Informationen aus dem Datenbank-Snapshot zu extrahieren." <br><br>  Eine dieser fatalen Entscheidungen ist die Erstellung dieses Schnappschusses. <br><br>  Ein weiterer Fehler ist das Erstellen einer internen Computerinstanz mit dem AWS-API-SchlÃ¼ssel, auf die Benutzer von auÃŸen zugreifen kÃ¶nnen. <br><br>  Auf diese Weise konnte der Angreifer die Instanz kompromittieren, den SchlÃ¼ssel stehlen und damit auf den Datenbank-Snapshot zugreifen. <br><br>  Obwohl das Datenleck im Oktober 2018 stattfand, erfuhr Imperva erst am 20. August 2019 von dem Hack, als ein Dritter dem Unternehmen einen Datensatz von seinen Servern schickte und eine Belohnung fÃ¼r das Bug-Bounty-Programm forderte.  Imperva behauptet, dass dieser Dritte ihm bisher nicht bekannt war: â€Wir haben den Speicherauszug der SQL-Datenbank im prÃ¤sentierten Datensatz mit unseren Snapshots verglichen - und eine Ãœbereinstimmung gefunden.  Derzeit kÃ¶nnen wir sagen, dass die Kundendatenelemente bis zum 15. September 2017 auf WAF-Konten beschrÃ¤nkt sind.  Die Datenbanken und SchnappschÃ¼sse unserer anderen Produkte wurden nicht herausgefiltert. â€œ <br><br>  In Ãœbereinstimmung mit dem DSGVO-Gesetz hat das Unternehmen die StrafverfolgungsbehÃ¶rden und die zustÃ¤ndigen AufsichtsbehÃ¶rden in der vorgeschriebenen Weise informiert.  Eine DatenbankprÃ¼fung und Schadensbewertung dauerte mehrere Wochen.  Danach gab Imperva Ã¶ffentlich Informationen Ã¼ber den Vorfall bekannt. <br><br>  Imperva betont, dass sein eigenes Produkt zur Ãœberwachung der AktivitÃ¤t des Database Activity Monitoring (DAM) im Jahr 2017 AWS RDS (wie jedes andere Cloud-Hosting) nicht unterstÃ¼tzte und daher nicht intern verwendet wurde.  Erst 2019 wurde die fÃ¼r PaaS geeignete Cloud Data Security (CDS) entwickelt, die nun auch zur Ãœberwachung von Cloud WAF verwendet wird. <br><br><h2>  Lektionen fÃ¼r die Zukunft </h2><br>  Anand sagt, dass Imperva einige Schritte unternommen hat, um zukÃ¼nftige VorfÃ¤lle zu verhindern, darunter: <br><br><ul><li>  verbesserte Zugangskontrolle; <br></li><li>  ErhÃ¶hen der Anzahl der ZugriffsprÃ¼fungen fÃ¼r â€SchnappschÃ¼sseâ€œ; <br></li><li>  AuÃŸerbetriebnahme inaktiver Instanzen (einschlieÃŸlich gefÃ¤hrdeter Instanzen); <br></li><li>  standardmÃ¤ÃŸig aktive Computerinstanzen fÃ¼r VPN hosten; <br></li><li>  Ãœberwachung der Software und unverzÃ¼gliche Installation von Patches; <br></li><li>  regelmÃ¤ÃŸige Ã„nderung von Anmeldeinformationen und SchlÃ¼sseln; <br></li><li>  Verbesserte Verwaltung von Anmeldeinformationen <br></li><li>  ErhÃ¶hung der HÃ¤ufigkeit der Scan-Infrastruktur. </li></ul><br>  Die Multi-Faktor-Authentifizierung fÃ¼r die AWS-Verwaltungskonsole wurde bereits frÃ¼her aktiviert.  Laut Anand hÃ¤tte sie jedoch den unbefugten Zugriff auf den API-SchlÃ¼ssel nicht verhindert. <br><br>  Der technische Direktor sagte, dass es dank Verbesserungen in der internen Kontrolle heute nicht mÃ¶glich ist, dieses Leck zu wiederholen.  Das neue Imperva-System signalisiert sofort, wenn anfÃ¤llige Datenbankinstanzen und Snapshots erkannt werden, wie sie beispielsweise zum Hack 2018 gefÃ¼hrt haben.  Tatsache ist, dass die Protokollierungssysteme AWS CloudTrail und GuardDuty zuvor funktionierten und nicht autorisierte AktivitÃ¤ten in den Protokollen protokollierten. Sie haben dies einfach nicht signalisiert. <br><br>  Laut CTO hat das Unternehmen bei der Untersuchung des Vorfalls keine weiteren SicherheitslÃ¼cken gefunden und kennt keine bÃ¶swilligen AktivitÃ¤ten von Cyberkriminellen in Bezug auf Kunden, die Opfer eines Datenlecks waren. <br><br>  â€Zu Beginn unserer Untersuchung haben wir unsere Kunden sofort benachrichtigt, damit sie fundierte Entscheidungen treffen und gemÃ¤ÃŸ den von uns empfohlenen SicherheitsmaÃŸnahmen handeln kÃ¶nnen.  Dank dieser Empfehlungen haben unsere Kunden mehr als 13.000 PasswÃ¶rter geÃ¤ndert, mehr als 13.500 SSL-Zertifikate geÃ¤ndert und mehr als 1.400 API-SchlÃ¼ssel wiederhergestellt, sagte Anand.  "Unsere Mission bleibt dieselbe: FÃ¼hren Sie im Namen unserer Kunden und ihrer Benutzer den weltweiten Kampf um den Schutz von Daten und Anwendungen vor Cyberkriminellen." <br><br>  Als Referenz.  Imperva ist einer der weltweit fÃ¼hrenden Anbieter von Webanwendungs- und DatenschutzlÃ¶sungen (CDN, Cloud-Firewall, Reverse Proxy, Schutz vor DDoS-Angriffen usw.). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f77/46f/a66/f7746fa6619b894ea2872f92b76677ae.png"><br><br>  Das Unternehmen wurde im Jahr 2002 gegrÃ¼ndet, die Anzahl der Mitarbeiter Ã¼bersteigt 1000 Personen, Jahreseinkommen: 321,7 Millionen US-Dollar (2017).  Seit 2011 werden die Aktien des Unternehmens an der New Yorker BÃ¶rse gehandelt. Im Januar 2019 wurde sie jedoch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vollstÃ¤ndig von der</a> privaten Investmentfirma Thoma Bravo aufgekauft, die sich auf den Kauf von Technologie- und Softwareunternehmen spezialisiert hat. <br><br>  Es ist schwer zu sagen, wie sich der Vorfall auf das Image von Imperva auswirkt und wie sehr er das GeschÃ¤ft bedroht.  Sicherlich wird die Anzahl der Kunden nicht wachsen und das Image wird verdorben. <br><br>  Niemand ist vor DevOps-Fehlern sicher, insbesondere im komplexen GeschÃ¤ft des Einrichtens von Cloud-Instanzen.  Aber wer am wenigsten solche Fehler erwartet hat, ist Imperva. <br><br>  â€Wir Ã¼bernehmen die Verantwortung dafÃ¼r, dass der Vorfall das Ergebnis unserer Wahl war, der MaÃŸnahmen, die wir vor, wÃ¤hrend und nach der Migration der Datenbank ergriffen oder nicht ergriffen haben.  Wir empfehlen allen Unternehmen, sich die Zeit zu nehmen, um die gemeinsame Verantwortung fÃ¼r die Bereitstellung und Verwaltung von Anwendungen und Daten in IaaS-LÃ¶sungen (Infrastructure as a Service) vollstÃ¤ndig zu erkennen â€œ, sagte Imperva CTO.  â€Mit Sicherheit kann man nieâ€ fertig â€œwerden.  Jeden Tag mÃ¼ssen wir weiterarbeiten - um unsere Prozesse zu bewerten und zu verbessern. â€œ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de472708/">https://habr.com/ru/post/de472708/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de472686/index.html">Videostudio basierend auf i486</a></li>
<li><a href="../de472688/index.html">So funktioniert das Rendern von 3D-Spielen: Vertex-Verarbeitung</a></li>
<li><a href="../de472690/index.html">Was ist neu in Zabbix 4.4?</a></li>
<li><a href="../de472694/index.html">Mehr als Ceph: MCS Block Cloud Storage</a></li>
<li><a href="../de472702/index.html">JH Regenwasser â€Wie man Katzen weidetâ€œ: Rassen von Programmierern und Merkmale ihrer Zucht</a></li>
<li><a href="../de472714/index.html">Wo kann der Front-End-Mitarbeiter nach Arbeit suchen und nicht darauf hereinfallen: Telegramm, Slack und nicht nur</a></li>
<li><a href="../de472716/index.html">Spring Bean korrekt aus dem Anwendungskontext eines Drittanbieters abrufen</a></li>
<li><a href="../de472720/index.html">ERP funktioniert nicht ... Was ist die Alternative? oder pÃ¼nktlich. FÃ¼r Russland?</a></li>
<li><a href="../de472724/index.html">EinfÃ¼hrung in skydive.network</a></li>
<li><a href="../de472726/index.html">Verbesserung der ImmunitÃ¤t gegen Arduino-Rauschen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>