<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçüè´ üíá üßùüèø PBX virtual Rostelecom: qu√© y c√≥mo se puede hacer a trav√©s de la API üë∏üèΩ ‚¨ÖÔ∏è üë©üèª‚Äçüé§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las empresas modernas perciben los tel√©fonos fijos como una tecnolog√≠a obsoleta: la comunicaci√≥n celular proporciona movilidad y la disponibilidad con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PBX virtual Rostelecom: qu√© y c√≥mo se puede hacer a trav√©s de la API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/484180/"><img src="https://habrastorage.org/webt/9p/4z/il/9p4zilg_eledccytuo6hslf19f0.png"><br><br>  Las empresas modernas perciben los tel√©fonos fijos como una tecnolog√≠a obsoleta: la comunicaci√≥n celular proporciona movilidad y la disponibilidad constante de los empleados, las redes sociales y la mensajer√≠a instant√°nea son un canal de comunicaci√≥n m√°s f√°cil y r√°pido.  Para mantenerse al d√≠a con sus competidores, los PBX de oficina se est√°n volviendo cada vez m√°s como ellos: van a las nubes, se administran a trav√©s de la interfaz web y se integran con otros sistemas a trav√©s de la API.  En esta publicaci√≥n, le diremos qu√© funciones tiene la API PBX virtual de Rostelecom y c√≥mo trabajar con ella a trav√©s de las funciones b√°sicas de una PBX virtual. <br><a name="habracut"></a><br>  La tarea principal de la API PBX virtual de Rostelecom es interactuar con CRM o sitios de la compa√±√≠a.  Por ejemplo, la API incluye widgets "devolver llamada" y "llamar desde el sitio" para los principales sistemas de control: WordPress, Bitrix, OpenCart.  La API te permite: <br><br><ul><li>  Recibir informaci√≥n, notificar sobre el estado y realizar llamadas a solicitud de un sistema externo; <br></li><li>  Obtenga un enlace temporal a la grabaci√≥n de la conversaci√≥n; <br></li><li>  Administrar y recibir configuraciones de restricci√≥n de los usuarios; <br></li><li>  Obtener informaci√≥n sobre el usuario de una PBX virtual; <br></li><li>  Solicitar un historial de cargos y cargos por llamadas; <br></li><li>  Descargar el registro de llamadas. <br></li></ul><br><h2>  C√≥mo funciona la API </h2><br>  La API de integraci√≥n y el sistema externo interact√∫an entre s√≠ mediante solicitudes HTTP.  En su cuenta personal, el administrador establece las direcciones donde deben llegar las solicitudes a la API y a d√≥nde deben enviarse las solicitudes de la API.  El sistema externo debe tener una direcci√≥n p√∫blica accesible desde Internet con un certificado SSL instalado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aef/32c/8c5/aef32c8c5b54534a5b002a87166cb724.png"><br><br>  Adem√°s, en su cuenta personal, el administrador del dominio puede restringir las fuentes de IP de las solicitudes al acceder a la API. <br><br><h2>  Obtenemos informaci√≥n sobre los usuarios de la PBX virtual </h2><br>  Para obtener una lista de usuarios o grupos, debe enviar una solicitud a la PBX virtual utilizando el m√©todo <i>/ users_info</i> . <br><br><pre><code class="plaintext hljs">{         "domain":"example.ru" }</code> </pre> <br>  Se le devolver√° una lista que puede guardar. <br><br><pre> <code class="plaintext hljs">{ "result":0, "resultMessage":"", "users":[                           {                            "display_name":"test_user_1",                            "name":"admin",                            "pin":^_^quot öquot^_^,                           "is_supervisor":true,                            "is_operator":false,                            "email":"test_user_1@mail.gov","recording":1                             },                            {                            "display_name":"test_user_2",                            "name":"test",                            "pin":^_^quot øquot^_^,                            "is_supervisor":true,                            "is_operator":false,                            "email":"",                           "recording":1                            }              ], "groups":              [                            {                            "name":"testAPI",                            "pin":^_^quot«¥quot^_^,                            "email":"Ivanov@mail.gov",                            "distribution":1,                           "users_list":[^_^quot öquot^_^,^_^quot øquot^_^]                            }              ]</code> </pre><br>  En este m√©todo, se pasan dos matrices.  Uno con usuarios de dominio, uno con grupos de dominio.  El grupo tambi√©n tiene la capacidad de especificar el correo electr√≥nico que se enviar√° en la solicitud. <br><br><h2>  Procesamos informaci√≥n sobre una llamada entrante </h2><br>  Conectar la telefon√≠a corporativa a varios sistemas CRM ahorra el tiempo de los empleados que interact√∫an con los clientes y acelera el procesamiento de las llamadas entrantes.  Por ejemplo, en una llamada del cliente actual, CRM puede abrir su tarjeta y, desde CRM, puede enviar una llamada al cliente y conectarla al empleado. <br><br>  Para obtener informaci√≥n sobre llamadas a trav√©s de la API, debe usar el m√©todo <i>/ get_number_info</i> , que forma una lista de llamadas con informaci√≥n sobre el grupo en el que se distribuye la llamada.  Suponga que una llamada entrante del n√∫mero 1234567890 ha llegado al n√∫mero virtual de PBX. Luego se enviar√° una solicitud desde la PBX: <br><br><pre> <code class="plaintext hljs">{        "session_id":"SDsnZugDFmTW7Sec",        "timestamp":"2019-12-27 15:34:44.461",        "type":"incoming",        "state":"new",        "from_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "from_pin":"",        "request_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@1192.168.0.1",        "request_pin":^_^quot…üquot^_^,        "disconnect_reason":"",        "is_record":"" }</code> </pre><br>  A continuaci√≥n, debe conectar el controlador <i>/ get_number_info</i> .  La solicitud debe ejecutarse cuando llega una llamada entrante en una l√≠nea entrante antes de enrutar las llamadas.  Si la respuesta a la solicitud no se recibe dentro del tiempo establecido, la llamada se enruta de acuerdo con las reglas establecidas en el dominio. <br><br>  Ejemplo de controlador en el lado de CRM. <br><br><pre> <code class="plaintext hljs">if ($account) {        $data = [            'result' =&gt; 0,            'resultMessage' =&gt; ' ',            'displayName' =&gt; $account-&gt;name,            //'PIN' =&gt; $crm_users,        ];    }        else                {        $data = [            'result' =&gt; 0,            'resultMessage' =&gt; '  ',            'displayName' =&gt; '  '.$contact,            //'PIN' =&gt; crm_users,        ];    }    return $data;</code> </pre><br>  La respuesta del manejador. <br><br><pre> <code class="plaintext hljs">{        "result":0,        "resultMessage":" ",        "displayName":"   +1&lt;/i&gt; 234-56-78-90&lt;i&gt;" }</code> </pre><br><h2>  Monitoreamos el estado y descargamos registros de conversaci√≥n </h2><br>  En la central telef√≥nica virtual de Rostelecom, la grabaci√≥n de conversaciones se activa en su cuenta personal.  Usando la API, puede rastrear el estado de esta funci√≥n.  Al procesar la terminaci√≥n de la llamada en <i>call_events,</i> puede ver el <i>indicador 'is_record',</i> que notifica al usuario sobre el estado de grabaci√≥n: <i>verdadero</i> significa que el usuario tiene <i>habilitada una</i> funci√≥n de grabaci√≥n de conversaci√≥n. <br><br>  Para descargar un registro, debe enviar una solicitud a <i>api.cloudpbx.rt.ru/get_record utilizando el</i> ID de sesi√≥n de la llamada <i>session_id</i> <i>.</i> <i><br></i> <br><pre> <code class="plaintext hljs">{        "session_id":"SDsnZugDFmTW7Sec" }</code> </pre><br>  La respuesta ser√° un enlace temporal para descargar el archivo de grabaci√≥n de la conversaci√≥n. <br><br><pre> <code class="plaintext hljs">{        "result": ^_^quot&amp;#0;quot^_^,        "resultMessage": "  ",    "url": "https://api.cloudpbx.rt.ru/records_new_scheme/record/download/501a8fc4a4aca86eb35955419157921d/188254033036" }</code> </pre><br><br>  El tiempo de almacenamiento de archivos se establece en la configuraci√≥n de su cuenta personal.  Despu√©s de que se elimine el archivo. <br><br><h2>  Estad√≠sticas e informes </h2><br>  En su cuenta en una p√°gina separada, puede ver estad√≠sticas e informes para todas las llamadas y aplicar filtros por estado y hora.  A trav√©s de la API, primero debe procesar la llamada con el m√©todo <i>/ call_events</i> : <br><br><pre> <code class="plaintext hljs">    {        "session_id":"SDsnZugDFmTW7Sec",        "timestamp":"2019-12-27 15:34:59.349",        "type":"incoming",        "state":"end",        "from_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "from_pin":"",        "request_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",        "request_pin":^_^quot öquot^_^,        "disconnect_reason":"",        "is_record":"true"        }</code> </pre><br>  Luego llame al m√©todo <i>call_info</i> para procesar la matriz y mostrar la llamada en el sistema CRM. <br><br><pre> <code class="plaintext hljs">   {        "session_id":"SDsnZugDFmTW7Sec" }</code> </pre><br>  La respuesta ser√° una matriz de datos que se puede procesar para almacenar datos en el registro de CRM. <br><br><pre> <code class="plaintext hljs">{        "result":0,        "resultMessage":"",        "info":        {                "call_type":1,                "direction":1,                "state":1,                "orig_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",                "orig_pin":null,                "dest_number":"sip:&lt;/i^_^gt lt&amp;i;gt^_^@192.168.0.1",                "answering_sipuri":"admin@example.ru",                "answering_pin":^_^quot…üquot^_^,                "start_call_date":^_^quot quot^_^,                "duration":14,                 "session_log":"0:el:123456789;0:ru:admin;7:ct:admin;9:cc:admin;14:cd:admin;",                "is_voicemail":false,                "is_record":true,                "is_fax":false,                "status_code":^_^quot&amp;#0;quot^_^,                "status_string":""        } }</code> </pre><br><br><h2>  Otras funciones √∫tiles de PBX virtual </h2><br>  Adem√°s de la API, la PBX virtual tiene algunas funciones m√°s √∫tiles que puede usar.  Por ejemplo, este es un men√∫ de voz interactivo y una combinaci√≥n de comunicaciones celulares y fijas. <br><br>  La respuesta de voz interactiva (IVR) es lo que escuchamos en el receptor antes de que una persona responda.  De hecho, este es un operador electr√≥nico que redirige las llamadas a los departamentos apropiados y responde algunas de las preguntas autom√°ticamente.  Pronto, ser√° posible trabajar con IVR a trav√©s de la API: ahora estamos desarrollando un software que le permitir√° rastrear el progreso de una llamada a trav√©s de IVR y recibir informaci√≥n sobre las pulsaciones de teclas cuando la persona que llama est√° en el men√∫ de voz. <br><br>  Para transferir telefon√≠a corporativa a tel√©fonos m√≥viles, puede usar aplicaciones de softphone o conectar por separado el servicio de convergencia m√≥vil fija (FMC).  Con cualquiera de los m√©todos, las llamadas dentro de la red son gratuitas, es posible trabajar con n√∫meros cortos, y las llamadas se pueden grabar y se pueden mantener estad√≠sticas generales sobre ellas. <br><br>  La diferencia es que los softphones necesitan Internet para comunicarse, pero no est√°n vinculados a un operador, y FMC est√° vinculado a un operador espec√≠fico, pero incluso se pueden usar en tel√©fonos de bot√≥n m√°s antiguos. </div></div><p>Source: <a href="https://habr.com/ru/post/484180/">https://habr.com/ru/post/484180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../484170/index.html">Actualizar punto de control de R77.30 a 80.20</a></li>
<li><a href="../484172/index.html">Integraci√≥n continua en Unity: c√≥mo reducir el tiempo de montaje y ahorrar recursos + l√≠nea de pago como regalo</a></li>
<li><a href="../484174/index.html">Castle bebe en condiciones "extremas" o c√≥mo participamos en el espect√°culo "DOZOR"</a></li>
<li><a href="../484176/index.html">Implementaci√≥n de la plantilla de estado en Unity</a></li>
<li><a href="../484178/index.html">Conmutador Ethernet inteligente para el planeta Tierra</a></li>
<li><a href="../484182/index.html">Xenobots: nanorobots vivos de c√©lulas de rana</a></li>
<li><a href="../484186/index.html">LDAP - "autenticaci√≥n" es un antipatr√≥n</a></li>
<li><a href="../484188/index.html">Est√°ndares de dise√±o de bases de datos</a></li>
<li><a href="../484192/index.html">Aplicaciones f√°ciles y f√°ciles de implementar en el cartucho de Tarantool (parte 2)</a></li>
<li><a href="../484194/index.html">Kubernetes traducido a ni√±os</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>