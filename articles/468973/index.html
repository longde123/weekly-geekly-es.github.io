<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé™ üëè üëâüèø Red neuronal para clasificar im√°genes de sat√©lite usando Tensorflow en Python üë©üèΩ‚Äçüöí üõë üë®‚Äçüë©‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta es una instrucci√≥n paso a paso para la clasificaci√≥n de im√°genes multiespectrales del sat√©lite Landsat 5. Hoy, en varias √°reas, el aprendizaje pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Red neuronal para clasificar im√°genes de sat√©lite usando Tensorflow en Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/468973/"><img src="https://habrastorage.org/webt/uq/qc/uz/uqqcuz2dhxwps1cueikg6ceigja.jpeg"><br><br>  Esta es una instrucci√≥n paso a paso para la clasificaci√≥n de im√°genes multiespectrales del sat√©lite Landsat 5. Hoy, en varias √°reas, el aprendizaje profundo domina como una herramienta para resolver problemas complejos, incluidos los geoespaciales.  Espero que est√© familiarizado con los conjuntos de datos satelitales, en particular, Landsat 5 TM.  Si est√° un poco familiarizado con los algoritmos de aprendizaje autom√°tico, esto lo ayudar√° a aprender r√°pidamente este manual.  Y para aquellos que no entienden, ser√° suficiente saber que, de hecho, el aprendizaje autom√°tico consiste en establecer relaciones entre varias caracter√≠sticas (un conjunto de atributos X) de un objeto con su otra propiedad (valor o etiqueta, la variable objetivo Y).  Alimentamos el modelo con muchos objetos para los que se conocen las caracter√≠sticas y el valor del indicador / clase objetivo del objeto (datos etiquetados) y lo entrenamos para que pueda predecir el valor de la variable objetivo Y para nuevos datos (sin marcar). <br><a name="habracut"></a><br>  ¬øCu√°l es el principal problema con las im√°genes satelitales? <br><br>  Dos o m√°s clases de objetos (por ejemplo, edificios, lotes bald√≠os y pozos de cimentaci√≥n) en im√°genes de sat√©lite pueden tener las mismas caracter√≠sticas espectrales del valor, por lo tanto, en los √∫ltimos veinte a√±os, su clasificaci√≥n ha sido una tarea dif√≠cil. <br><br>  Debido a esto, es posible usar modelos cl√°sicos de aprendizaje autom√°tico con y sin un maestro, pero su calidad estar√° lejos de ser ideal.  Siempre tienen los mismos inconvenientes.  Considere un ejemplo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/15b/16c/5b7/15b16c5b76906f81f27374daa8558806.jpg"><br><br>  Si usa una l√≠nea vertical como clasificador y la mueve a lo largo del eje X, entonces clasificar im√°genes de casas no ser√° f√°cil.  Los datos se distribuyen de manera que es imposible separarlos en clases usando una l√≠nea vertical (en tales casos se dice que "los objetos de diferentes clases no son linealmente separables").  ¬°Pero esto no significa que las casas no se puedan clasificar en absoluto! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc4/ea7/7a0/cc4ea77a0f9f4713ea6a49b7885d31c2.gif"><br><br>  Usemos la l√≠nea roja para separar las dos clases.  En este caso, el clasificador identific√≥ la mayor√≠a de las casas, pero una casa no fue asignada a su clase, y tres √°rboles m√°s fueron asignados por error a las "casas".  Para no perderse una sola casa, puede usar el clasificador en forma de l√≠nea azul.  Entonces todo estar√° cubierto en casa, es decir, decimos que la m√©trica de retiro (plenitud) es alta.  Sin embargo, no todos los valores clasificados resultaron ser casas, es decir, al mismo tiempo obtuvimos un valor bajo de la m√©trica de precisi√≥n.  Si usamos la l√≠nea verde, entonces todas las im√°genes clasificadas como casas realmente ser√°n casas, es decir, el clasificador mostrar√° una alta precisi√≥n.  En este caso, la plenitud ser√° menor, ya que las tres casas no se contabilizar√°n.  En la mayor√≠a de los casos, tenemos que encontrar un compromiso entre la precisi√≥n y la integridad. <br><br>  Este problema de casas y √°rboles es similar al problema con edificios, lotes bald√≠os y pozos.  La prioridad de las m√©tricas de clasificaci√≥n de im√°genes satelitales puede variar seg√∫n la tarea.  Por ejemplo, si necesita asegurarse de que todos los territorios construidos se clasifiquen como edificios sin excepci√≥n, y est√° listo para soportar la presencia de p√≠xeles de otras clases con firmas similares, que tambi√©n se clasificar√°n como edificios, entonces necesita un modelo con una alta integridad.  Y si es m√°s importante para usted clasificar un edificio, sin agregar p√≠xeles de otras clases, y est√° listo para abandonar la clasificaci√≥n de territorios mixtos, elija un clasificador con alta precisi√≥n.  En el caso de casas y √°rboles, el modelo habitual usar√° la l√≠nea roja, manteniendo un equilibrio entre precisi√≥n e integridad. <br><br><h2>  Datos utilizados </h2><br>  Como signos, utilizaremos los valores de seis rangos (banda 2 - banda 7) de la imagen de Landsat 5 TM e intentaremos predecir la clase de desarrollo binario.  Para capacitaci√≥n y pruebas, se utilizar√°n datos multiespectrales (im√°genes y una capa con una clase de construcci√≥n binaria) con Landsat 5 para 2011 para Bangalore.  Y para la predicci√≥n se utilizar√°n datos Landsat 5 multiespectrales obtenidos en 2005 en Hyderabad. <br>  Dado que usamos datos etiquetados para la ense√±anza, esto se llama ense√±anza con el maestro. <br><br><img src="https://habrastorage.org/webt/c4/nx/71/c4nx71fzbix6rhp4fb1-ofdupjm.jpeg"><br><br>  <i>Datos de entrenamiento multiespectral y la capa binaria correspondiente con desarrollo.</i> <br><br>  Para crear una red neuronal, usaremos Python, la biblioteca de Google Tensorflow.  Tambi√©n necesitaremos estas bibliotecas: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>pyrsgis</i></a> : para leer y escribir GeoTIFF. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>scikit-learn</i></a> : para preprocesamiento de datos y evaluaci√≥n de precisi√≥n. <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>numpy</i></a> : para operaciones b√°sicas con matrices. <br></li></ol><br>  Y ahora, sin m√°s pre√°mbulos, escribamos el c√≥digo. <br><br>  Coloque los tres archivos en un directorio, escriba la ruta y los nombres de los archivos de entrada en el script y luego lea los archivos GeoTIFF. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrsgis <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> raster os.chdir(<span class="hljs-string"><span class="hljs-string">"E:\\yourDirectoryName"</span></span>) mxBangalore = <span class="hljs-string"><span class="hljs-string">'l5_Bangalore2011_raw.tif'</span></span> builtupBangalore = <span class="hljs-string"><span class="hljs-string">'l5_Bangalore2011_builtup.tif'</span></span> mxHyderabad = <span class="hljs-string"><span class="hljs-string">'l5_Hyderabad2011_raw.tif'</span></span> <span class="hljs-comment"><span class="hljs-comment"># Read the rasters as array ds1, featuresBangalore = raster.read(mxBangalore, bands='all') ds2, labelBangalore = raster.read(builtupBangalore, bands=1) ds3, featuresHyderabad = raster.read(mxHyderabad, bands='all')</span></span></code> </pre> <br>  El m√≥dulo <code>raster</code> del paquete <code>pyrsgis</code> lee los datos de geolocalizaci√≥n GeoTIFF y los valores de n√∫meros digitales (DN) como matrices NumPy separadas.  Si est√° interesado en los detalles, lea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Ahora mostramos el tama√±o de los datos le√≠dos. <br><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">"Bangalore multispectral image shape: "</span></span>, featuresBangalore.shape) print(<span class="hljs-string"><span class="hljs-string">"Bangalore binary built-up image shape: "</span></span>, labelBangalore.shape) print(<span class="hljs-string"><span class="hljs-string">"Hyderabad multispectral image shape: "</span></span>, featuresHyderabad.shape)</code> </pre> <br>  Resultado: <br><br><pre> <code class="python hljs">Bangalore multispectral image shape: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2054</span></span>, <span class="hljs-number"><span class="hljs-number">2044</span></span> Bangalore binary built-up image shape: <span class="hljs-number"><span class="hljs-number">2054</span></span>, <span class="hljs-number"><span class="hljs-number">2044</span></span> Hyderabad multispectral image shape: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">1318</span></span>, <span class="hljs-number"><span class="hljs-number">1056</span></span></code> </pre> <br>  Como puede ver, las im√°genes de Bangalore tienen el mismo n√∫mero de filas y columnas que en la capa binaria (correspondiente al edificio).  El n√∫mero de capas en im√°genes multiespectrales en Bangalore y Hyderabad tambi√©n coincide.  El modelo aprender√° a decidir qu√© p√≠xeles pertenecen al edificio y cu√°les no, en funci√≥n de los valores correspondientes para los 6 espectros.  Por lo tanto, las im√°genes multiespectrales deben tener el mismo n√∫mero de caracter√≠sticas (rangos) enumeradas en el mismo orden. <br><br>  Ahora convertimos las matrices en bidimensionales, donde cada fila representa un p√≠xel separado, porque esto es necesario para la operaci√≥n de la mayor√≠a de los algoritmos de aprendizaje autom√°tico.  Haremos esto usando el m√≥dulo de <code>pyrsgis</code> paquete <code>pyrsgis</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d69/176/b91/d69176b91e9758291e1faae6c25486e5.jpg"><br>  <i>Esquema de reestructuraci√≥n de datos.</i> <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrsgis.convert <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> changeDimension featuresBangalore = changeDimension(featuresBangalore) labelBangalore = changeDimension (labelBangalore) featuresHyderabad = changeDimension(featuresHyderabad) nBands = featuresBangalore.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] labelBangalore = (labelBangalore == <span class="hljs-number"><span class="hljs-number">1</span></span>).astype(int) print(<span class="hljs-string"><span class="hljs-string">"Bangalore multispectral image shape: "</span></span>, featuresBangalore.shape) print(<span class="hljs-string"><span class="hljs-string">"Bangalore binary built-up image shape: "</span></span>, labelBangalore.shape) print(<span class="hljs-string"><span class="hljs-string">"Hyderabad multispectral image shape: "</span></span>, featuresHyderabad.shape)</code> </pre> <br>  Resultado: <br><br><pre> <code class="python hljs">Bangalore multispectral image shape: <span class="hljs-number"><span class="hljs-number">4198376</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span> Bangalore binary built-up image shape: <span class="hljs-number"><span class="hljs-number">4198376</span></span> Hyderabad multispectral image shape: <span class="hljs-number"><span class="hljs-number">1391808</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span></code> </pre> <br>  En la s√©ptima l√≠nea, extrajimos todos los p√≠xeles con un valor de 1. Esto ayuda a evitar problemas con los p√≠xeles sin informaci√≥n (NoData), que a menudo tienen valores extremadamente altos o bajos. <br>  Ahora dividiremos los datos en muestras de capacitaci√≥n y validaci√≥n.  Esto es necesario para que el modelo no vea los datos de prueba y funcione igual de bien con la nueva informaci√≥n.  De lo contrario, el modelo se volver√° a entrenar y funcionar√° bien solo en los datos de entrenamiento. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split xTrain, xTest, yTrain, yTest = train_test_split(featuresBangalore, labelBangalore, test_size=<span class="hljs-number"><span class="hljs-number">0.4</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) print(xTrain.shape) print(yTrain.shape) print(xTest.shape) print(yTest.shape)</code> </pre> <br>  Resultado: <br><br><pre> <code class="python hljs">(<span class="hljs-number"><span class="hljs-number">2519025</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>) (<span class="hljs-number"><span class="hljs-number">2519025</span></span>,) (<span class="hljs-number"><span class="hljs-number">1679351</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>) (<span class="hljs-number"><span class="hljs-number">1679351</span></span>,) test_size=<span class="hljs-number"><span class="hljs-number">0.4</span></span></code> </pre> <br>  significa que los datos se dividen en capacitaci√≥n y validaci√≥n en una proporci√≥n de 60/40. <br>  Muchos algoritmos de aprendizaje autom√°tico, incluidas las redes neuronales, necesitan datos normalizados.  Esto significa que deben distribuirse dentro de un rango determinado (en este caso, de 0 a 1).  Por lo tanto, para cumplir este requisito, normalizamos los s√≠ntomas.  Esto se puede hacer extrayendo el valor m√≠nimo y luego dividi√©ndolo por el diferencial (la diferencia entre los valores m√°ximo y m√≠nimo).  Como el dataset Landsat es de ocho bits, los valores m√≠nimo y m√°ximo ser√°n 0 y 255 (2 <sup>‚Å∏</sup> = 256 valores). <br><br>  Tenga en cuenta que para la normalizaci√≥n siempre es mejor calcular los valores m√≠nimos y m√°ximos en funci√≥n de los datos.  Para simplificar la tarea, nos mantendremos en el rango de ocho bits por defecto. <br><br>  Otra etapa del procesamiento preliminar es la transformaci√≥n de la matriz de signos de dos dimensiones a tres dimensiones, de modo que el modelo perciba cada fila como un p√≠xel separado (un objeto de aprendizaje separado). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/965/d0f/aa8/965d0faa8e8c7b4787c10823cf038d20.jpg"><br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Normalise the data xTrain = xTrain / 255.0 xTest = xTest / 255.0 featuresHyderabad = featuresHyderabad / 255.0 # Reshape the data xTrain = xTrain.reshape((xTrain.shape[0], 1, xTrain.shape[1])) xTest = xTest.reshape((xTest.shape[0], 1, xTest.shape[1])) featuresHyderabad = featuresHyderabad.reshape((featuresHyderabad.shape[0], 1, featuresHyderabad.shape[1])) # Print the shape of reshaped data print(xTrain.shape, xTest.shape, featuresHyderabad.shape)</span></span></code> </pre> <br>  Resultado: <br><br><pre> <code class="python hljs">(<span class="hljs-number"><span class="hljs-number">2519025</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>) (<span class="hljs-number"><span class="hljs-number">1679351</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>) (<span class="hljs-number"><span class="hljs-number">1391808</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)</code> </pre> <br>  Todo est√° listo, ensamblemos nuestro modelo con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">keras</a> .  Para comenzar, usemos el modelo secuencial, agregando capas una tras otra.  Tendremos una capa de entrada con el n√∫mero de nodos igual al n√∫mero de rangos ( <code>nBands</code> ), en nuestro caso hay 6. Tambi√©n usaremos una capa oculta con 14 nodos y la <code>ReLu</code> activaci√≥n <code>ReLu</code> .  La √∫ltima capa consta de dos nodos para definir una clase de construcci√≥n binaria con la <code>softmax</code> activaci√≥n <code>softmax</code> , que es adecuada para mostrar un resultado categorizado.  Lea m√°s sobre las funciones de activaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras <span class="hljs-comment"><span class="hljs-comment"># Define the parameters of the model model = keras.Sequential([ keras.layers.Flatten(input_shape=(1, nBands)), keras.layers.Dense(14, activation='relu'), keras.layers.Dense(2, activation='softmax')]) # Define the accuracy metrics and parameters model.compile(optimizer="adam", loss="sparse_categorical_crossentropy", metrics=["accuracy"]) # Run the model model.fit(xTrain, yTrain, epochs=2)</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/d8a/9cd/5ec/d8a9cd5ec53c57d671d77b0c46bfb17e.png"><br>  <i>Arquitectura de red neuronal</i> <br><br>  Como se menciona en la l√≠nea 10, especificamos <code>adam</code> como optimizador de modelo (hay varios <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otros</a> ).  En este caso, utilizaremos la entrop√≠a cruzada como una funci√≥n de p√©rdida (en. <code>categorical-sparse-crossentropy</code> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> se escribe m√°s sobre esto).  Para evaluar la calidad del modelo, utilizaremos la m√©trica de <code>accuracy</code> . <br><br>  Finalmente, comenzaremos a entrenar nuestro modelo para dos eras (o iteraciones) en <code>xTrain</code> y <code>yTrain</code> .  Esto llevar√° alg√∫n tiempo, dependiendo del tama√±o de los datos y la potencia de procesamiento.  Esto es lo que ver√° despu√©s de la compilaci√≥n: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfa/3fc/c47/dfa3fcc47572b2fd20c5252ba4da1e50.png"><br><br>  Vamos a predecir los valores para los datos de validaci√≥n que almacenamos por separado y calcular varias m√©tricas de precisi√≥n. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> confusion_matrix, precision_score, recall_score <span class="hljs-comment"><span class="hljs-comment"># Predict for test data yTestPredicted = model.predict(xTest) yTestPredicted = yTestPredicted[:,1] # Calculate and display the error metrics yTestPredicted = (yTestPredicted&gt;0.5).astype(int) cMatrix = confusion_matrix(yTest, yTestPredicted) pScore = precision_score(yTest, yTestPredicted) rScore = recall_score(yTest, yTestPredicted) print("Confusion matrix: for 14 nodes\n", cMatrix) print("\nP-Score: %.3f, R-Score: %.3f" % (pScore, rScore))</span></span></code> </pre> <br>  La funci√≥n <code>softmax</code> genera columnas separadas para valores de probabilidad para cada clase.  Utilizamos solo los valores para la primera clase ("hay un edificio"), como se puede ver en la sexta l√≠nea del c√≥digo anterior.  Evaluar el trabajo de los modelos de an√°lisis geoespacial no es tan simple, a diferencia de otros problemas cl√°sicos del aprendizaje autom√°tico.  Ser√° injusto confiar en un error total generalizado.  La clave para un modelo exitoso es el dise√±o espacial.  Por lo tanto, la matriz de confusi√≥n, la precisi√≥n y la integridad pueden dar una idea m√°s correcta de la calidad del modelo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/399/3d8/bf3/3993d8bf36a5f4165b60f39e36e5c566.jpg"><br>  <i>Entonces, la consola muestra la matriz de error, la precisi√≥n y la integridad.</i> <br><br>  Como puede ver en la matriz de confusi√≥n, hay miles de p√≠xeles que est√°n relacionados con edificios, pero se clasifican de manera diferente, y viceversa.  Sin embargo, su participaci√≥n en el volumen total de datos no es demasiado grande.  La precisi√≥n e integridad de los datos de prueba excedieron el umbral de 0.8. <br><br>  Puede pasar m√°s tiempo y realizar varias iteraciones para encontrar el n√∫mero √≥ptimo de capas ocultas, el n√∫mero de nodos en cada capa oculta, as√≠ como el n√∫mero de eras para lograr la precisi√≥n deseada.  Seg√∫n sea necesario, los √≠ndices de teledetecci√≥n como NDBI o NDWI se pueden usar como caracter√≠sticas.  Al lograr la precisi√≥n deseada, use el modelo para predecir el desarrollo basado en nuevos datos y exporte el resultado a GeoTIFF.  Para tales tareas, puede usar un modelo similar con cambios menores. <br><br><pre> <code class="python hljs">predicted = model.predict(feature2005) predicted = predicted[:,<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-comment"><span class="hljs-comment">#Export raster prediction = np.reshape(predicted, (ds.RasterYSize, ds.RasterXSize)) outFile = 'Hyderabad_2011_BuiltupNN_predicted.tif' raster.export(prediction, ds3, filename=outFile, dtype='float')</span></span></code> </pre> <br>  Tenga en cuenta que exportamos GeoTIFF con valores de probabilidad pronosticados, y no con su versi√≥n binarizada de umbral.  M√°s adelante en el entorno SIG, podemos establecer el valor umbral de una capa de tipo flotante, como se muestra en la figura a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/sk/ka/kz/skkakzxokrbkvrgulcvm0vkuwua.jpeg"><br>  <i>Capa acumulada de Hyderabad predicha por el modelo basada en datos multiespectrales.</i> <br><br>  La precisi√≥n del modelo ya se ha medido con precisi√≥n y recuperaci√≥n.  Tambi√©n puede realizar comprobaciones tradicionales (por ejemplo, utilizando el coeficiente kappa) en una nueva capa prevista.  Adem√°s de las dificultades antes mencionadas con la clasificaci√≥n de las im√°genes de sat√©lite, otras limitaciones obvias incluyen la imposibilidad de pron√≥sticos basados ‚Äã‚Äãen im√°genes tomadas en diferentes √©pocas del a√±o y en diferentes regiones, ya que tendr√°n diferentes firmas espectrales. <br><br>  El modelo descrito en este art√≠culo tiene la arquitectura m√°s simple para redes neuronales.  Se pueden lograr mejores resultados con modelos m√°s complejos, incluidas las redes neuronales convolucionales.  La principal ventaja de tal clasificaci√≥n es su escalabilidad (aplicabilidad) despu√©s de entrenar el modelo. <br><br>  Los datos utilizados y todo el c√≥digo est√°n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/468973/">https://habr.com/ru/post/468973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../468961/index.html">¬øC√≥mo deshacerse de la rutina en la vida por $ 560? O como vivir, no vivir</a></li>
<li><a href="../468963/index.html">Copia de seguridad, parte a petici√≥n de los lectores: descripci√≥n general de UrBackup, BackupPC, AMANDA</a></li>
<li><a href="../468967/index.html">"Tecnolog√≠a" de obtenci√≥n de ecuaciones de din√°mica de TAU. ¬øY por qu√© la identificaci√≥n del sistema es una mierda y las reglas de "f√≠sica honesta"</a></li>
<li><a href="../468969/index.html">Crear usuarios de Google desde PowerShell a trav√©s de API</a></li>
<li><a href="../468971/index.html">Escribir en Java para Nintendo DS</a></li>
<li><a href="../468989/index.html">El mercado de la UEBA muere - Larga vida a la UEBA</a></li>
<li><a href="../468991/index.html">Personajes de sprites modulares y su animaci√≥n.</a></li>
<li><a href="../468993/index.html">Oculus Quest se conecta a una PC y ve manos</a></li>
<li><a href="../468995/index.html">Pol√≠tica de apertura: c√≥mo los usuarios influyen en el proyecto</a></li>
<li><a href="../468997/index.html">Mentoring: ¬øun must-have o un buen bono?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>