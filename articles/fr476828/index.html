<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïâÔ∏è üöê ü§¶üèΩ Op√©ration "Migration": comment se passe le cloud DataLine üçá ü§ûüèΩ ü•´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a environ 7 ans, les tout premiers projets ont migr√© vers notre cloud simplement et sans pr√©tention. Des images de machines virtuelles ont √©t√© t√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Op√©ration "Migration": comment se passe le cloud DataLine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/476828/">  Il y a environ 7 ans, les tout premiers projets ont migr√© vers notre cloud simplement et sans pr√©tention.  Des images de machines virtuelles ont √©t√© t√©l√©charg√©es sur un serveur FTP ou import√©es sur des disques durs.  Ensuite, via un serveur d'importation sp√©cial, les machines virtuelles ont √©t√© t√©l√©charg√©es sur le cloud. <br><br>  Si ce n'est pas un probl√®me pour le client de d√©sactiver la machine virtuelle pendant un jour ou deux (ou pas d'autres options), alors c'est possible.  Mais si le temps d'arr√™t doit √™tre au maximum d'une heure, cette m√©thode ne fonctionnera pas.  Aujourd'hui, je vais vous dire quels outils vous aideront √† migrer vers le cloud avec un temps d'arr√™t minimal et comment le processus de migration fonctionne avec nous. <br><br><img src="https://habrastorage.org/webt/5x/cx/dg/5xcxdguftiv1yk7grwcbj7fmf4q.jpeg"><br><a name="habracut"></a><br><h3>  Migration avec Veeam Backup and Replication </h3><br>  Tout le monde conna√Æt Veeam Backup and Replication comme un outil pour cr√©er des sauvegardes et des r√©pliques.  Nous l'utilisons pour la migration entre nos sites et pour le transport de clients avec virtualisation priv√©e vers notre cloud.  Les machines virtuelles clientes sont r√©pliqu√©es sur notre vCenter, apr√®s quoi l'ing√©nieur les ajoute √† vCloud Director. <br><br>  La r√©plication principale est effectu√©e sur une machine virtuelle activ√©e.  A l'heure convenue, la machine c√¥t√© client s'√©teint.  La r√©plication red√©marre pour transf√©rer les modifications qui se sont produites depuis la premi√®re r√©plication.  Apr√®s cela, la machine virtuelle d√©marre d√©j√† dans notre cloud. <br><br><img src="https://habrastorage.org/webt/mn/us/t0/mnust0ek7ckllt7afy8kty-y_qa.png"><br><br>  Habituellement, √† partir du moment o√π la machine est √©teinte sur l'infrastructure du client et jusqu'au moment o√π elle est allum√©e, pas plus d'une demi-heure, mais plut√¥t 15 √† 20 minutes, passent dans notre cloud. <br><br>  Dans le m√™me temps, la machine virtuelle d'origine reste sur le site du client.  Si soudainement quelque chose se passe mal, vous pouvez toujours revenir en arri√®re et l'allumer.  Pour le client, cette m√©thode est √©galement pratique en ce qu'elle ne n√©cessite pas Veeam de sa part. <br><br>  <i>Cas 1</i> <i><br></i>  <i>Le client avait sa propre infrastructure virtuelle bas√©e sur VMware - 40 VM avec une capacit√© de 30 To.</i>  <i>L'√©quipement sur lequel le cluster a √©t√© d√©ploy√© est d√©j√† obsol√®te, et le client a d√©cid√© de ne pas s'impliquer dans l'achat d'un nouveau et de passer √† un cloud public.</i>  <i>Le temps d'arr√™t requis pour les syst√®mes critiques ne d√©passait pas une heure.</i>  <i>Veeam Replication a √©t√© choisi comme outil.</i>  <i>Le plus √©tait √©galement que le fournisseur d'acc√®s Internet du client √©tait pr√©sent dans notre centre de donn√©es, ce qui nous a permis d'organiser un bon canal.</i>  <i>La migration a pris environ un mois, tandis que le changement √©tait simple, il a fallu jusqu'√† 30 minutes pour un groupe de machines virtuelles.</i> <br><br><h3>  Migrez avec Veeam Cloud Connect </h3><br>  Veeam Cloud Connect est un outil qui vous aide √† configurer la r√©plication des machines virtuelles et √† ex√©cuter des r√©pliques dans le cloud du fournisseur de services.  Apr√®s la mise √† jour en <a href="https://habr.com/ru/company/dataline/blog/436086/">2019</a> , il est devenu possible de r√©pliquer des machines virtuelles directement vers vCloud Director.  La seule condition est que du c√¥t√© client, votre sauvegarde et r√©plication Veeam doit √™tre d√©ploy√©e au moins en version 9. En bref (une version d√©taill√©e est <a href="https://habr.com/ru/company/dataline/blog/308984/">ici</a> ), l'ensemble du processus est le suivant. <br><br>  VCloud Director cr√©e une organisation avec les ressources et les r√©seaux n√©cessaires.  Dans Veeam Cloud Connect, nous cr√©ons un compte, le client s'y connecte √† partir de notre Veeam B&amp;R, s√©lectionne le fournisseur et l'organisation DataLine et configure les t√¢ches de r√©plication.  Outre le fait que lors d'une telle migration, les temps d'arr√™t seront compris entre 15 et 20 minutes, le client ne d√©pend pas du support technique du fournisseur et g√®re l'ensemble du processus de mani√®re ind√©pendante: il cr√©e des t√¢ches de r√©plication, la r√©plication elle-m√™me, √©teint les machines et d√©marre leur d√©marrage sur un nouveau site. <br><br><img src="https://habrastorage.org/webt/g7/bm/j9/g7bmj9ziorp-bxksjcep9s73kfw.png"><br><br>  <i>Cas 2</i> <i><br></i>  <i>L'infrastructure client √† partir de laquelle la migration √©tait pr√©vue √©tait situ√©e au B√©larus.</i>  <i>Il a fallu transporter 90 VM avec un volume total de 27 To, malgr√© le fait que le canal Internet √©tait √† 100 Mbps.</i>  <i>Si vous effectuez une sauvegarde et la t√©l√©chargez imm√©diatement sur notre cloud, cela prendra plusieurs jours pour certaines machines virtuelles.</i>  <i>Pendant ce temps, un grand delta se d√©velopperait sur la machine virtuelle, ce qui pourrait d√©j√† nuire aux performances des machines ou, pire encore, l'espace sur le magasin de donn√©es s'√©puisait.</i>  <i>Ils ont agi comme suit: premi√®rement, le client a effectu√© une sauvegarde compl√®te locale et nous en a transf√©r√© une copie dans le cloud via Veeam Cloud Connect.</i>  <i>Puis il a fait et jet√© l'incr√©ment dans le nuage.</i>  <i>La machine virtuelle d'origine a continu√© de fonctionner.</i>  <i>Apr√®s avoir arr√™t√© la machine virtuelle, le client a effectu√© un autre incr√©ment et l'a √©galement transf√©r√© vers le cloud.</i>  <i>De notre c√¥t√©, nous avons d√©ploy√© une machine virtuelle √† partir d'une sauvegarde compl√®te, puis nous y avons ajout√© deux incr√©ments.</i>  <i>Un tel sch√©ma nous a permis de minimiser les temps d'arr√™t √† 2 heures lors du passage sur notre site.</i> <br><br><h3>  Migration avec VMware vCloud Availability </h3><br>  En mars de cette ann√©e, VMware a publi√© vCloud Availability 3.0, qui permet aux machines virtuelles de migrer entre diff√©rents clouds (vCloud Director - vCloud Director) et des stands de virtualisation de clients priv√©s vers le cloud (vCenter - vCloud Director).  La principale commodit√© est l'int√©gration avec l'interface vCloud Director.  Cela simplifie consid√©rablement la gestion de la r√©plication et minimise les temps d'arr√™t lors de la commutation. <br><br>  √Ä l'aide de cet outil, nous avons migr√© l'un des clients de notre cloud de Moscou vers notre cloud de Saint-P√©tersbourg.  Il a fallu transporter 18 machines virtuelles d'une capacit√© totale de 14 To.  Pour le client, une organisation a √©t√© cr√©√©e dans le cloud de Saint-P√©tersbourg et les r√©seaux n√©cessaires ont √©t√© organis√©s.  Ensuite, √† partir de l'interface de vCloud Director, le client est pass√© aux param√®tres de disponibilit√© de vCloud, a cr√©√© des t√¢ches de r√©plication et est pass√© au site de Saint-P√©tersbourg √† un moment opportun.  Le temps d'arr√™t lors du changement √©tait de 12 minutes. <br><br><img src="https://habrastorage.org/webt/3p/v8/9b/3pv89bdu2lsktkf8kcjg3tikqme.png"><br>  <i>Le sch√©ma de migration entre les nuages ‚Äã‚ÄãDataLine √† Saint-P√©tersbourg et Moscou.</i> <br><br>  VCloud Availability dispose d'un m√©canisme de migration des machines virtuelles d'un site client vers notre cloud.  Pour ce faire, une application sp√©ciale de disponibilit√© vCloud est d√©ploy√©e dans le client vCenter.  Apr√®s une configuration simple, vous √™tes connect√© au cloud et les t√¢ches de migration sont configur√©es.  Le client g√®re √©galement de mani√®re ind√©pendante l'ensemble du processus et le temps de migration est minimis√©. <br><br><img src="https://habrastorage.org/webt/qe/0h/xg/qe0hxg2qd306tw-ismqzsvuftue.png"><br>  <i>Un diagramme de la migration des machines virtuelles d'une installation priv√©e vers le cloud.</i> <br><br>  VMware vCloud Availability a de nombreux autres cas d'utilisation; nous en parlerons bient√¥t dans un article s√©par√©. <br><br><h3>  Pr√©paration √† la migration </h3><br>  Pour s√©lectionner un outil et poursuivre la migration, vous devez d√©cider des points suivants: <br><br>  <b>D'o√π migrons-nous?</b>  Si vous migrez √† partir d'une solution priv√©e, vous avez une libert√© totale dans le choix des outils.  Si vous quittez le fournisseur, c'est plus difficile.  Tr√®s probablement, la connexion de l'infrastructure des deux fournisseurs et le simple glissement de la machine virtuelle √©choueront pour des raisons de s√©curit√©.  Parfois, le prestataire, que le client va refuser, commence compl√®tement √† √™tre nuisible et prend du temps.  Vous pouvez quitter le fournisseur √† l'ancienne: en t√©l√©chargeant la machine virtuelle sur des disques et FTP ou en migrant au niveau de l'application.  Le nom de ce dernier est arbitraire et ressemble √† ceci. <br><br>  <i>Cas 3</i> <i><br></i>  <i>Il a fallu migrer le syst√®me SAP du client depuis un fournisseur europ√©en: 34 VM avec un volume de 54 To.</i>  <i>Des ressources ont √©t√© allou√©es au client dans notre cloud.</i>  <i>Entre nous et l'infrastructure du fournisseur europ√©en a √©t√© organis√©e la connectivit√© r√©seau.</i>  <i>Les serveurs d'applications ont √©t√© red√©ploy√©s, avec le cumul des configurations n√©cessaires.</i>  <i>De grandes bases de donn√©es ont migr√© via le t√©l√©chargement de sauvegardes sur notre cloud.</i>  <i>Ensuite, la r√©plication entre les bases de donn√©es sur notre et les sites source a √©t√© configur√©e.</i>  <i>√Ä l'heure convenue, nous sommes pass√©s aux bases de donn√©es de notre cloud.</i> <br><br>  <b>La quantit√© de donn√©es et le canal Internet.</b>  Nous demandons g√©n√©ralement au client de fournir le d√©chargement sur les syst√®mes avec des param√®tres de m√©moire, CPU, disques.  Nous estimons si le canal est suffisant pour envoyer directement des r√©pliques ou des sauvegardes de machines virtuelles. <br><br>  <b>Valide simple.</b>  Pour diff√©rents syst√®mes et, par cons√©quent, les machines virtuelles, il peut √™tre diff√©rent selon leur criticit√© pour l'entreprise.  Habituellement, un client est livr√© avec des exigences pr√©d√©finies pour les temps d'arr√™t pendant la migration, et sur cette base, nous choisissons le bon outil et le bon plan de migration.  Nous essayons de planifier le passage final √† la nuit ou au week-end, de sorte que m√™me un l√©ger temps d'arr√™t ne soit pas perceptible pour les utilisateurs finaux du client. <br><br>  Sur la base de ces donn√©es, vous pouvez choisir un outil et poursuivre la migration elle-m√™me.  Voici ce qui se passe ensuite. <br><br><ol><li>  <b>Configuration de la connectivit√© r√©seau.</b>  Nous organisons la connectivit√© r√©seau entre notre cloud et l'infrastructure client.  Les machines virtuelles seront copi√©es sur ce r√©seau.  Si Veeam Backup and Replication est utilis√©, il s'agit d'un canal d√©di√©, moins souvent un canal VPN.  Si Veeam Cloud Connect, alors tout passe par Internet ou le m√™me canal d√©di√©. <br><br>  Ensuite, le r√©seau est configur√© pour la machine virtuelle dans le cloud.  Les voitures se d√©placent g√©n√©ralement en groupe et plus d'une journ√©e.  Une fois que les VM nous ont √©t√© transf√©r√©es et lanc√©es, elles devraient interagir avec les machines qui restent toujours sur le site de d√©part. </li><li>  <b>Calendrier de migration.</b>  Lorsqu'il y a beaucoup de voitures, il est raisonnable de les diviser en groupes et de les transporter par lots.  En accord avec le client, nous convenons d'un plan dans lequel nous prescrivons quand et quelles machines se d√©placer et quand la r√©plication finale et le passage √† un nouveau site seront effectu√©s. </li><li>  <b>Tester la migration.</b>  Nous migrons la machine virtuelle de test et v√©rifions si tout est correctement configur√©: connectivit√© r√©seau entre les sites, la disponibilit√© de la machine virtuelle pour les machines sur le site source, les droits de compte, etc.  Un tel test permet d'√©viter les accrocs lors de la phase de migration de combat. </li></ol><br>  C‚Äôest tout pour moi.  Posez des questions dans les commentaires et parlez de votre exp√©rience de migration. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr476828/">https://habr.com/ru/post/fr476828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr476806/index.html">MPS 2019.2: types de donn√©es √©num√©r√©s, personnalisation des messages d'erreur, transition vers JDK 11 et bien plus</a></li>
<li><a href="../fr476812/index.html">Notes sur tout. Alimentations simples et dangereuses</a></li>
<li><a href="../fr476816/index.html">Dubai Mall dans un smartphone, ou comment ajouter un plan d'√©tage d'un b√¢timent √† votre application</a></li>
<li><a href="../fr476824/index.html">McKinsey: repenser l'architecture logicielle et √©lectronique de l'automobile</a></li>
<li><a href="../fr476826/index.html">Exp√©riences multiples: th√©orie et pratique</a></li>
<li><a href="../fr476830/index.html">Comment impl√©menter les fonctions de l'utilitaire JavaScript √† l'aide de Reduce?</a></li>
<li><a href="../fr476834/index.html">Red Hat OpenShift 4.2: nouveaux outils</a></li>
<li><a href="../fr476838/index.html">Comment capter la lumi√®re avec la mousse: r√©seau mousse-photons</a></li>
<li><a href="../fr476842/index.html">Comment construire un syst√®me de support client efficace</a></li>
<li><a href="../fr476844/index.html">Sp√©cifique et mondial: programme Mobius 2019 Moscou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>