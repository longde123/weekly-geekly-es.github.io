<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙏🏿 👨‍👨‍👦 🐽 Cartes Yandex pour l'application Taxi 👇🏼 🥃 👰🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour la plupart des applications qui utilisent la géolocalisation, les cartes et les directions, je préfère Google Maps. Parce que Google Maps possède...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cartes Yandex pour l'application Taxi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472798/"> Pour la plupart des applications qui utilisent la géolocalisation, les cartes et les directions, je préfère Google Maps.  Parce que Google Maps possède un ensemble complet de fonctions, une bonne documentation, ainsi qu'un excellent mapkit pour mettre en œuvre toutes les idées visuelles et de programmation.  Malheureusement, Google Maps n'est pas une panacée pour la mise en œuvre de toutes les tâches possibles.  Le problème est qu'il y a des localités, des villes, etc. qui ne sont pas entièrement comprises par l'entreprise, et à cause de cela, les numéros de maison et même des rues entières peuvent ne pas être disponibles. <br><a name="habracut"></a><br>  Dans la fig.  1 vous pouvez voir à quoi ressemble l'un des quartiers de la ville sur Google Maps, et sur la fig.  2 vous pouvez voir à quoi ressemble cette même zone uniquement sur les cartes Yandex. <br><br><img src="https://habrastorage.org/webt/oc/y6/kt/ocy6ktmxhraxrjvnycrofuli1b8.png" alt="image"><br>  <i>fig.</i>  <i>1</i> <br><br><img src="https://habrastorage.org/webt/-1/jo/tw/-1jotwn2nydytdxml6qjlhsuhk4.png" alt="image"><br>  <i>fig.</i>  <i>2</i> <br><br>  À mon avis, la différence est visible à l'œil nu, il est immédiatement clair que pour une raison quelconque, les cartes de Google n'ont pas / pourraient / ne voulaient pas fonctionner dans cette partie de la ville et, comme vous pouvez le voir, il manque à la fois les numéros de maison et les noms de rue. <br><br>  Comme il est très important pour une application de taxi d'avoir les informations les plus fiables sur la ville et ses rues (entreprises, institutions, etc.), il a été décidé d'utiliser les cartes Yandex.  Peu importe combien de temps je travaille avec des cartes Yandex, le sentiment est comme la première fois, malheureusement, beaucoup d'entre elles provoquent des émotions pas tout à fait positives.  Peut-être que quelqu'un peut me réparer, mais la documentation de mapkit est assez rare, et j'ai dû sculpter beaucoup de fonctionnalités nécessaires à partir de ce qu'elles étaient. <br><br><h3>  Style de carte </h3><br>  Afin de donner à votre carte un caractère unique ou d'intégrer une carte dans votre conception, vous devez lui donner le style nécessaire.  La seule méthode que j'ai trouvée ne me plaisait pas vraiment parce que la façon de personnaliser une carte en l'utilisant est assez gênante, et si je comprends bien, je ne comprenais que les paramètres teinte, saturation, légèreté. <br><br><pre><code class="java hljs">String style = <span class="hljs-string"><span class="hljs-string">"["</span></span> + <span class="hljs-string"><span class="hljs-string">" {"</span></span> + <span class="hljs-string"><span class="hljs-string">" \"featureType\" : \"all\","</span></span> + <span class="hljs-string"><span class="hljs-string">" \"stylers\" : {"</span></span> + <span class="hljs-string"><span class="hljs-string">" \"hue\" : \"1\","</span></span> + <span class="hljs-string"><span class="hljs-string">" \"saturation\" : \"-1\","</span></span> + <span class="hljs-string"><span class="hljs-string">" \"lightness\" : \"0.78\""</span></span> + <span class="hljs-string"><span class="hljs-string">" }"</span></span> + <span class="hljs-string"><span class="hljs-string">" }"</span></span> + <span class="hljs-string"><span class="hljs-string">"]"</span></span>; mapView.getMap().setMapStyle(style);</code> </pre> <br><h3>  Demande de suggestions </h3><br>  Avant d'atteindre la version finale de la demande d'invite, plusieurs méthodes ont été revérifiées, le dernier et le plus efficace moyen de recevoir des invites via SuggestSession. <br><br>  Créez d'abord une instance de l'objet <i>SearchManager</i> et une instance de l'objet <i>SuggestSession</i> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SearchManager searchManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SuggestSession suggestSession = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>;</code> </pre> <br>  initialiser searchManager dans la méthode onCreate () <br><br><pre> <code class="java hljs">searchManager = SearchFactory.getInstance() .createSearchManager(SearchManagerType.COMBINED);</code> </pre><br>  De plus, dans la méthode requestSuggest (String query), nous initialisons l'objet suggestSession, et nous n'oublions pas que nous n'avons pas besoin de créer une nouvelle session à chaque fois. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (suggestSession == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) suggestSession = searchManager.createSuggestSession();</code> </pre><br>  Pour obtenir des conseils sur les entreprises, nous utilisons le paramètre SuggestType.BIZ et pour obtenir des données sur la région de l'utilisateur, vous devez utiliser BoundigBox, qui est initialisé comme suit: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> BoundingBox BOUNDING_BOX = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BoundingBox( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(<span class="hljs-number"><span class="hljs-number">66.066191</span></span>, <span class="hljs-number"><span class="hljs-number">76.468435</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(<span class="hljs-number"><span class="hljs-number">66.149326</span></span>, <span class="hljs-number"><span class="hljs-number">76.824836</span></span>));</code> </pre><br>  où le premier point est le coin inférieur gauche et le deuxième coin supérieur droit de votre secteur rectangulaire. <br><br><pre> <code class="java hljs">suggestSession.suggest(query, BOUNDING_BOX, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SuggestOptions() .setSuggestTypes(SuggestType.BIZ.value) .setUserPosition(CENTER), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SuggestSession.SuggestListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull List&lt;SuggestItem&gt; list)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull Error error)</span></span></span><span class="hljs-function"> </span></span>{ } });</code> </pre><br>  Si nous devons obtenir des rues, des maisons, etc., nous utilisons le paramètre SuggestType.BIZ: <br><br><pre> <code class="java hljs">suggestSession.suggest(query, BOUNDING_BOX, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SuggestOptions() .setSuggestTypes(SuggestType.GEO.value) .setUserPosition(CENTER), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SuggestSession.SuggestListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull List&lt;SuggestItem&gt; list)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull Error error)</span></span></span><span class="hljs-function"> </span></span>{ } });</code> </pre><br>  De plus, l'un des problèmes notés était le fait que pour le même nom, plusieurs valeurs identiques sont sorties, je vous conseille donc de les trier immédiatement. <br><br>  Et la dernière chose que je voudrais partager aujourd'hui est d'afficher votre SuggestItem dans la liste.  Au départ, tout semblait clair car l'objet a plusieurs propriétés: <br><br><pre> <code class="java hljs">getSearchText(); getDisplayText();</code> </pre><br>  Ce qui, à mon avis, implique qu'il existe une ligne complète pour la recherche et une ligne pour l'affichage, mais dans 99% des cas, ces lignes coïncident afin d'obtenir un nom de rue simple sans utiliser d'expressions régulières (cela pourrait nuire à l'affichage, car pourrait couper les données nécessaires à la compréhension: nom de la rue, numéro de la maison, appartement, etc.), la fonction suivante a été utilisée: <br><br><pre> <code class="java hljs">suggestItem.getTitle().getText();</code> </pre><br>  Curieusement, cette fonction donne le résultat nécessaire, même si au départ cette option ne semblait pas si évidente. <br><br>  En fait, ce ne sont que quelques petites choses qui ont dû être rencontrées dans cette application.  Afin de ne pas étirer l’article, je laisse le soin à la deuxième partie, car construire des itinéraires, afficher des marqueurs et!  ce qui est tout aussi important dans une application comme un taxi, le déplacement d'une voiture sur une carte avec sa rotation. <br><br>  Matvienko Alexander, Hossein Fakhr. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472798/">https://habr.com/ru/post/fr472798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472780/index.html">Pourquoi éviter les amis ou comment j'ai perdu tous mes avantages</a></li>
<li><a href="../fr472782/index.html">Pourquoi 3D Headache / Part 8 Defocus et l'avenir de la 3D</a></li>
<li><a href="../fr472790/index.html">Antiquités: i-Mate Jasjar, un communicateur pour les entreprises</a></li>
<li><a href="../fr472792/index.html">Ordinateur basé sur les vannes NOR: à l'intérieur de l'ordinateur de commande embarqué Apollo</a></li>
<li><a href="../fr472796/index.html">OUI flanche FAANG * ou [guide pratique] sur la recherche d'emploi aux USA / Europe pour spécialiste informatique</a></li>
<li><a href="../fr472802/index.html">MIRO est une plate-forme de robot intérieure ouverte. Partie 2 - Conception de robots</a></li>
<li><a href="../fr472810/index.html">À l'administrateur système débutant: comment mettre de l'ordre dans le chaos</a></li>
<li><a href="../fr472812/index.html">Le serveur «s'éteint» si le test de fumée du centre de données «prend feu»?</a></li>
<li><a href="../fr472814/index.html">Ma première machine virtuelle: comment ne pas salir</a></li>
<li><a href="../fr472816/index.html">Motifs élégants en JavaScript moderne (cycle d'équipe Bill Sourour)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>