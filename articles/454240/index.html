<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçü§ù‚Äçüë®üèø üë®üèº‚Äçüé§ üê≥ An√°lisis de wavelet. Parte 3 ü§¶üèª üîπ üöÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduccion 
 Cuando se realiza un an√°lisis CWT utilizando la biblioteca PyWavelets (un software gratuito de c√≥digo abierto lanzado bajo la licencia ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>An√°lisis de wavelet. Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454240/"><h3>  Introduccion </h3><br>  Cuando se realiza un an√°lisis CWT utilizando la biblioteca PyWavelets (un software gratuito de c√≥digo abierto lanzado bajo la licencia MIT), existen problemas para visualizar el resultado.  El <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">programa de</a> prueba de visualizaci√≥n propuesto por los desarrolladores se muestra en la siguiente lista: <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt t = np.linspace(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, endpoint=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) sig = np.cos(<span class="hljs-number"><span class="hljs-number">2</span></span> * np.pi * <span class="hljs-number"><span class="hljs-number">7</span></span> * t) + np.real(np.exp(<span class="hljs-number"><span class="hljs-number">-7</span></span>*(t<span class="hljs-number"><span class="hljs-number">-0.4</span></span>)**<span class="hljs-number"><span class="hljs-number">2</span></span>)*np.exp(<span class="hljs-number"><span class="hljs-number">1j</span></span>*<span class="hljs-number"><span class="hljs-number">2</span></span>*np.pi*<span class="hljs-number"><span class="hljs-number">2</span></span>*(t<span class="hljs-number"><span class="hljs-number">-0.4</span></span>))) widths = np.arange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>) cwtmatr, freqs = pywt.cwt(sig, widths, <span class="hljs-string"><span class="hljs-string">'cmor1-1.5'</span></span>) plt.imshow(cwtmatr, extent=[<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>], cmap=<span class="hljs-string"><span class="hljs-string">'PRGn'</span></span>, aspect=<span class="hljs-string"><span class="hljs-string">'auto'</span></span>, vmax=abs(cwtmatr).max(), vmin=-abs(cwtmatr).max()) <span class="hljs-comment"><span class="hljs-comment"># doctest: +SKIP plt.show() # doctest: +SKIP</span></span></code> </pre> </div></div><br>  Cuando se trabaja con wavelets complejas, por ejemplo con 'cmor1-1.5', el programa produce un error: <br><br><pre> <code class="python hljs">File<span class="hljs-string"><span class="hljs-string">"C:\Users\User\AppData\Local\Programs\Python\Python36\lib\site-packages\matplotlib\image.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">642</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> set_data <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> TypeError(<span class="hljs-string"><span class="hljs-string">"Image data cannot be converted to float"</span></span>) TypeError: Image data cannot be converted to float</code> </pre> <br>  Este error, as√≠ como las dificultades para elegir la escala (anchos) para proporcionar la resoluci√≥n de tiempo necesaria, dificultan, especialmente para los usuarios novatos, estudiar el an√°lisis de CWT, lo que me llev√≥ a escribir este art√≠culo de naturaleza educativa. <br><br>  El prop√≥sito de esta publicaci√≥n es considerar el uso del nuevo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√≥dulo de</a> visualizaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escalagrama</a> para el an√°lisis de se√±ales simples y especiales, as√≠ como cuando se utilizan m√©todos de normalizaci√≥n, escalamiento logar√≠tmico y s√≠ntesis, que proporcionan informaci√≥n adicional en el an√°lisis de series de tiempo. <br><a name="habracut"></a><br>  El art√≠culo utiliz√≥ informaci√≥n de la publicaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Una introducci√≥n suave a wavelet para el an√°lisis de datos"</a> .  En los listados de ejemplos dados en la publicaci√≥n, los errores se corrigen y cada listado del ejemplo se lleva a su forma final, lo que le permite usarlo sin familiarizarse con los anteriores.  Para el an√°lisis wavelet de se√±ales especiales, se utilizaron datos de la base de datos de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muestra</a> PyWavelets. <br><br>  Un escalograma wavelet es una representaci√≥n bidimensional de datos unidimensionales.  El tiempo se traza en el eje X, y se muestra una escala en el eje Y, el resultado de la transformada wavelet de la se√±al correspondiente a la amplitud de la se√±al en el tiempo X. El valor anal√≠tico de tal visualizaci√≥n gr√°fica de la se√±al es que la resoluci√≥n del tiempo se muestra en el eje Y, que proporciona informaci√≥n adicional sobre las propiedades din√°micas de la se√±al. <br><br><h3>  Wavelet - Escalogramas de se√±al simple </h3><br>  1. Onda cosenoidal con una envoltura gaussiana (Reemplazo de wavelets. Puede estudiar la dependencia de la resoluci√≥n del tiempo en la escala) <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-comment"><span class="hljs-comment">#  ,        #       'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') #    1  /  ns = 1024 time =arange(ns) scales = scg.periods2scales( arange(1, 40) ) p1=10; periodic1 = cos(2*pi/p1*time) * exp(-((time-ns/2)/200)**2) fig1, ax1 = subplots(1, 1, figsize=(6.9,2.9)); lines = ax1.plot(periodic1); ax1.set_xlim(0, len(time)) ax1.set_title("   ") fig1.tight_layout() ax2 = scg.cws(periodic1, scales=scales, figsize=(6.9,2.9)); txt = ax2.annotate("p1=%s"%p1, xy=(100, 10), bbox=dict(boxstyle="round4", fc="w")) tight_layout() print("    :", scg.get_default_wavelet(), "(", pywt.ContinuousWavelet(scg.get_default_wavelet()).family_name, ")") show()</span></span></code> </pre> <br></div></div><br>  Funci√≥n wavelet para conversi√≥n de se√±al: cmor1-1.5 (wavelets complejas de Morlet) <br><br><img src="https://habrastorage.org/webt/hs/p1/yt/hsp1ytatqsrowio0ybi4hocti9i.png"><br><br><img src="https://habrastorage.org/webt/xw/di/hq/xwdihq6dkqpofxc6ucw8oq7h6zu.png"><br><br>  La se√±al peri√≥dica ahora aparece como una franja continua horizontal en el punto Y = p1, cuya intensidad var√≠a seg√∫n la amplitud de la se√±al peri√≥dica. <br><br>  Hay algo de confusi√≥n en la detecci√≥n, ya que el ancho de banda no es igual a cero, esto se debe al hecho de que las wavelets no detectan una frecuencia, sino m√°s bien una banda.  Este efecto est√° asociado con el ancho de banda de wavelet. <br><br>  2. Se agregan tres pulsos secuencialmente con un per√≠odo creciente (para considerar variaciones peri√≥dicas a diferentes escalas: an√°lisis de resoluci√≥n m√∫ltiple): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-comment"><span class="hljs-comment">#          #       'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') ##    1  /  ns = 1024 time = arange(ns) scales = scg.periods2scales(arange(1, 40)) pulses = zeros(ns, dtype=float32) steps = linspace(0, ns, 8) periods = [10, 20, 40] for i in range(0,3): step_mask = (time &gt; steps[i*2+1]) &amp; (time &lt; steps[i*2+2]) pulses += cos(2*pi/periods[i]*time) * step_mask fig1, ax1 = subplots(1, 1, figsize=(7,3)); lines = ax1.plot(pulses); ax1.set_xlim(0, len(time)); ax1.set_title("     "); ax1.set_xlabel("Time") fig1.tight_layout() ax2 = scg.cws(pulses, scales=scales, figsize=(7,3)) for i in range(0, 3): txt = ax2.annotate("p%d=%ds"%(i+1,periods[i]), xy=(steps[i*2]+20, periods[i]), bbox=dict(boxstyle="round4", fc="w")) ax2.plot(steps[i*2+1]*np.ones(2), ax2.get_ylim(), '-w', alpha=0.5) ax2.plot(steps[i*2+2]*np.ones(2), ax2.get_ylim(), '-w', alpha=0.5) tight_layout() show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/df/nm/l7/dfnml7k3umgnlv4vati1jgp_pd8.png"><br><br><img src="https://habrastorage.org/webt/hu/6b/wd/hu6bwdexuagw8otjcaogaecreba.png"><br><br>  Los impulsos aparecen en el lugar esperado Y, correspondiente a su periodicidad, se localizan en frecuencia y tiempo.  El comienzo de la tira y el final corresponden al impulso. <br>  El ancho de banda se escala con la duraci√≥n del per√≠odo.  Esta es una propiedad bien conocida de la transformada wavelet: cuando la escala aumenta, la resoluci√≥n del tiempo disminuye.  Esto tambi√©n se conoce como el equilibrio entre tiempo y frecuencia.  Cuando miras un espectrograma de este tipo, haces muchos an√°lisis de resoluci√≥n. <br><br>  3. Tres oscilaciones peri√≥dicas de diferentes frecuencias al mismo tiempo (Wavelet: el an√°lisis puede distinguir los componentes de la se√±al por frecuencia, si sus diferencias son significativas): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg scg.set_default_wavelet(<span class="hljs-string"><span class="hljs-string">'cmor1-1.5'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#          #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') ##    1  /  ns = 1024 time = arange(ns) scales = scg.periods2scales(arange(1, 40)) allwaves = np.zeros(ns, dtype=np.float32) periods = [10, 20, 40] for i in range(0,3): allwaves += cos(2*np.pi/periods[i]*time) fig1, ax1 = subplots(1, 1, figsize=(6.5,2)); lines = ax1.plot(allwaves); ax1.set_title("  ") ax1.set_xlim(0, len(time)); ax1.set_xlabel("") fig1.tight_layout() ax2 = scg.cws(allwaves, scales=scales, figsize=(7,2)) tight_layout() show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/pr/uo/gr/pruogrwxqhvs0flrmlcfydqsquq.png"><br><br><img src="https://habrastorage.org/webt/fw/a1/18/fwa118pra6k0_mckusb8sn0vbmq.png"><br><br>  4. Una se√±al peri√≥dica no sinusoidal (se considera la diferencia en las transformaciones de wavelet de una se√±al de onda triangular con un per√≠odo de 30 segundos de las consideradas anteriormente): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scipy.signal <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg scg.set_default_wavelet(<span class="hljs-string"><span class="hljs-string">'cmor1-1.5'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#          #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') ##    1  /  ns = 1024 time = arange(ns) scales = scg.periods2scales(arange(1, 40)) ptri = 30.0 # period in samples raising = 0.8 # fraction of the period raising triangle = scipy.signal.sawtooth(time/ptri*2*pi, raising) # plot the signal fig1, ax1 = subplots(1, 1, figsize=(7,3)); lines = ax1.plot(triangle); ax1.set_xlim(0, len(time)) ax1.set_title("triangle wave increasing 80% of the time with a 30s period") fig1.tight_layout() # and the scaleogram ax2 = scg.cws(triangle, scales=scales, figsize=(7,3)); txt = ax2.annotate("first harmonic", xy=(100, 30), bbox=dict(boxstyle="round4", fc="w")) txt = ax2.annotate("second harmonic", xy=(100, 15), bbox=dict(boxstyle="round4", fc="w")) tight_layout() show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/y7/2z/rk/y72zrke6shecx3nb5drpkrqdepq.png"><br><br><img src="https://habrastorage.org/webt/dk/rs/bp/dkrsbphqpqk9ceoiehga4re3mhy.png"><br><br>  Una banda grande es el primer arm√≥nico.  El segundo arm√≥nico es visible exactamente a la mitad del valor del per√≠odo del primer arm√≥nico.  Este es el resultado esperado para se√±ales peri√≥dicas no sinusoidales.  Aparecen elementos verticales difusos alrededor del segundo arm√≥nico, que es m√°s d√©bil y tiene una amplitud de 1/4 del primero para una forma de onda triangular. <br><br>  5. Los impulsos suaves (gaussianos) son similares a las estructuras de datos reales.  (Este ejemplo muestra c√≥mo usar el an√°lisis wavelet para detectar cambios de se√±al localizados a lo largo del tiempo): <br><br>  Una serie de pulsos suaves con diferentes valores sigma: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>=</mo><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.108ex" height="2.419ex" viewBox="0 -780.1 7796.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-63" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-64" x="1184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6F" x="1707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-74" x="2193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-73" x="2804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-69" x="3274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-67" x="3619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6D" x="4100" y="0"></use><g transform="translate(4978,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-3D" x="6239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="7295" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-1"> 2 \ cdot \ sigma _ {1} = 2 </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><mo>=</mo><mn>10</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.27ex" height="2.419ex" viewBox="0 -780.1 8297 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-63" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-64" x="1184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6F" x="1707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-74" x="2193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-73" x="2804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-69" x="3274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-67" x="3619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6D" x="4100" y="0"></use><g transform="translate(4978,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-3D" x="6239" y="0"></use><g transform="translate(7295,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-30" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> 2 \ cdot \ sigma _ {2} = 10 </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow></msub><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>$</mo></mrow><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.27ex" height="2.539ex" viewBox="0 -832 8297 1093.4" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-63" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-64" x="1184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6F" x="1707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-74" x="2193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-73" x="2804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-69" x="3274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-67" x="3619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6D" x="4100" y="0"></use><g transform="translate(4978,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-33" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-3D" x="6239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-24" x="7295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="7796" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>$</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-3"> 2 \ cdot \ sigma _ {3} = $ 2</script></li></ul><br>  Ancho de pulso: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>=</mo><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.493ex" height="2.298ex" viewBox="0 -728.2 5379 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6D" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-65" x="1614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-67" x="2080" y="0"></use><g transform="translate(2561,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-3D" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="4878" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ omega _ {1} = 2 </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>$</mo></mrow><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.656ex" height="2.539ex" viewBox="0 -832 5879.5 1093.4" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6D" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-65" x="1614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-67" x="2080" y="0"></use><g transform="translate(2561,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-3D" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-24" x="4878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-32" x="5378" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>$</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> \ omega _ {2} = $ 2</script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow></msub><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>$</mo></mrow><mn>10</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.818ex" height="2.539ex" viewBox="0 -832 6380 1093.4" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6F" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-6D" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-65" x="1614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-67" x="2080" y="0"></use><g transform="translate(2561,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-33" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-3D" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-24" x="4878" y="0"></use><g transform="translate(5378,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/454240/&amp;usg=ALkJrhizZejF1Iu8bfBr2DDx6G6IjNN_bQ#MJMAIN-30" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>o</mi><mi>m</mi><mi>e</mi><mi>g</mi><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow></msub><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>$</mo></mrow><mn>10</mn></math></span></span><script type="math/tex" id="MathJax-Element-6"> \ omega _ {3} = $ 10</script></li></ul><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg scg.set_default_wavelet(<span class="hljs-string"><span class="hljs-string">'cmor1-1.5'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#          #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') ##    1  /  ns = 1024 time = arange(ns) scales = scg.periods2scales(arange(1, 40)) #       s1=1; s2=5; s3=10 events = [ns*0.1, ns*0.3, ns*0.7] bumps = exp(-((time-events[0])/s1)**2) + exp(-((time-events[1])/s2)**2) + \ exp(-((time-events[2])/s3)**2) #      w1=1; w2=5; w3= 50 steps = ((time &gt; events[0]-w1) &amp; (time &lt; events[0]+w1)) + \ ((time &gt; events[1]-w2) &amp; (time &lt; events[1]+w2)) + \ ((time &gt; events[2]-w3) &amp; (time &lt; events[2]+w3)) #   fig1, (ax1, ax2) = subplots(1, 2, figsize=(11, 2)); ax1.set_title("Bumps"); ax2.set_title("Steps") lines = ax1.plot(bumps); ax1.set_xlim(0, len(time)) lines = ax2.plot(steps); ax2.set_xlim(0, len(time)) fig1.tight_layout() #   scales_bumps = scg.periods2scales(arange(1, 120, 2) ) fig2, (ax3, ax4) = subplots(1, 2, figsize=(14,3)); ax3 = scg.cws(bumps, scales=scales_bumps, ax=ax3) ax4 = scg.cws(steps, scales=scales_bumps, ax=ax4) for bmpw, stepw in [(2*s1, 2*w1), (2*s2,2*w2), (2*s3, 2*w3)]: ax3.plot(ax3.get_xlim(), bmpw*ones(2), 'w-', alpha=0.5) ax4.plot(ax4.get_xlim(), stepw*ones(2), 'w-', alpha=0.5) fig2.tight_layout() show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/3l/ga/ke/3lgakegkiip9e9nxwyrdwcmkfsi.png"><br><br><img src="https://habrastorage.org/webt/lz/1z/n8/lz1zn8m1yjsy5pjkveiwc70oecc.png"><br><br>  Los pulsos discretos crean estructuras c√≥nicas en el sialograma, que tambi√©n se conocen como el cono de influencia.  Los impulsos suaves (gaussianos) son similares a las estructuras de datos reales y crean conos que se expanden hacia grandes escalas.  Las l√≠neas de gu√≠a horizontales corresponden aproximadamente a per√≠odos de tiempo (2 s, 10 s, 20 s).  Por lo tanto, el pulso es similar a una se√±al peri√≥dica con un per√≠odo. <br><br>  6. Ruido (ruido de pantalla en el sialograma): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random scg.set_default_wavelet(<span class="hljs-string"><span class="hljs-string">'cmor1-1.5'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#          #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') #    1  /  ns = 1024 time =arange(ns) scales = scg.periods2scales( arange(1, 40) ) noise =random.sample(range(ns), ns) fig1, ax1 = plt.subplots(1, 1, figsize=(6.2,2)); ax1.set_title("  ") lines = ax1.plot(time, noise) ax1.set_xlim(0, ns) fig1.tight_layout() ax2 = scg.cws(noise, scales=scales, figsize=(7,2)) tight_layout() show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/qy/hu/lq/qyhulqiqtynyjwdfbakadzh4eog.png"><br><br><img src="https://habrastorage.org/webt/ad/gp/cl/adgpclbvaolajsneosnady6kr5a.png"><br><br>  El ruido generalmente se muestra como un conjunto de elementos, y algunas irregularidades pueden parecer objetos de datos reales, por lo que al usar datos reales, debe tener cuidado y, si es necesario, verificar el nivel de ruido.  El horario superior ser√° diferente cada vez que se inicie el programa. <br><br><h3>  Escalogramas Wavelet de Se√±ales Especiales </h3><br>  La base de datos PyWavelets contiene veinte se√±ales especiales de transformaci√≥n wavelet que ser√°n √∫tiles tanto para el estudio como para el desarrollo.  Por lo tanto, le dar√© una lista que le permite realizar un an√°lisis wavelet de las veinte se√±ales: <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # -*- coding: utf-8 -*- import numpy as np from pylab import* import scaleogram as scg import pywt signals = pywt.data.demo_signal('list') signal_length=1024 for signal in signals: if signal in ['Gabor', 'sineoneoverx']: x = pywt.data.demo_signal(signal) else: x = pywt.data.demo_signal(signal, signal_length) times=[] signals=[] for time, sig in enumerate(x.real): times.append(time) signals.append(sig) scg.set_default_wavelet('cmor1-1.5') scales = scg.periods2scales( arange(1, 40) ) fig1, ax1 = subplots(1, 1, figsize=(6.9,2.9)); lines = ax1.plot(signals); ax1.set_xlim(0, len(times)) ax1.set_title("%s"%signal) fig1.tight_layout() ax2 = scg.cws(signals, scales=scales, figsize=(6.9,2.9)); tight_layout() show()</span></span></code> </pre> <br></div></div><br>  Solo dar√© un resultado de la transformada wavelet de la se√±al Doppler: <br><br><img src="https://habrastorage.org/webt/pr/bs/wo/prbsworf8jztubjhss5cq47bwzo.png"><br><br><img src="https://habrastorage.org/webt/ig/ry/ih/igryiht55ky8h-ne4pf4cgpvrf8.png"><br><br>  Se consideran las variedades m√°s comunes de se√±ales simples y especiales, lo que nos permite pasar a usar un escalograma para resolver algunos problemas de an√°lisis de series temporales. <br><br><h3>  Escalogramas de l√≠nea de tiempo de wavelet </h3><br>  1. Datos de fertilidad de los CDC en los Estados Unidos 1969-2008 (los datos de fertilidad contienen caracter√≠sticas peri√≥dicas, tanto en una escala anual como en una m√°s peque√±a): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) fig = figure(figsize=(12,2)) lines = plot(births.index, births.values/1000, '-') xlim(datetime_lim) ylabel("Nb of birthes [k]"); title("Total births per day in the US (CDC)"); xlim = xlim() ax = scg.cws(births, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day") set_x_yearly(ax, len(births)) show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/f3/fh/1f/f3fh1fip-zi3iahsrcrsujbw6io.png"><br><br><img src="https://habrastorage.org/webt/ys/t-/76/yst-76_hoeaxymf8bkry0jy411i.png"><br><br>  Aparece una l√≠nea horizontal con una frecuencia de aproximadamente 7 d√≠as.  Los valores altos aparecen cerca de los bordes de la escala, que es el comportamiento normal del procesamiento de wavelets.  Estos efectos son bien conocidos como un cono de influencia, por lo que una m√°scara (opcional) se superpone a esta √°rea. <br><br>  2. Normalizaci√≥n (Eliminar el valor promedio - <b>births_normed = births-births.mean ()</b> es obligatorio, de lo contrario, los l√≠mites de datos se consideran etapas que crean muchas detecciones falsas en forma de cono): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() ax = scg.cws(births_normed, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day") set_x_yearly(ax, len(births)) show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/83/0w/7v/830w7vhmgd4pnuwczktltgbhuq0.png"><br><br>  3. Cambio de escala en amplitud (para ver objetos anuales, usando <b>period2scales ()</b> se especifica <b>la</b> escala a lo largo del eje Y). <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() scales = scg.periods2scales(np.arange(1, 365+100, 3)) ax = scg.cws(births_normed, scales=scales, figsize=(13.2, 5), xlabel="Year", ylabel="Nb of Day", clim=(0, 2500)) set_x_yearly(ax, len(births)) show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/40/jj/lv/40jjlvzp8zjkx9xgghb_5pj6h-y.png"><br><br>  El rango de amplitud del mapa de color (eje Y) ahora se establece mediante clim = (0.2500).  El valor exacto de la amplitud de oscilaci√≥n depende de la wavelet, pero permanecer√° cerca del orden del valor real.  Esto es mucho mejor, ahora vemos muy bien la variaci√≥n anual, ¬°as√≠ como alrededor de 6 meses! <br><br>  4. Uso de la escala logar√≠tmica (para poder ver per√≠odos peque√±os y grandes al mismo tiempo, es mejor usar la escala logar√≠tmica en el eje Y. Esto se logra usando la opci√≥n xscale = log). <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() scales = scg.periods2scales(np.arange(1, 365+100, 3)) ax = scg.cws(births_normed, scales=scales, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day", clim=(0,2500), yscale='log') set_x_yearly(ax, len(births)) print("Number of available days:", len(births_normed)) show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/8d/fe/uc/8dfeuc1vt4flkoyih6glx9ss7e4.png"><br><br>  El resultado es mucho mejor, pero ahora los p√≠xeles en valores bajos de per√≠odos se alargan a lo largo del eje Y. <br><br>  5. Distribuci√≥n uniforme en una escala logar√≠tmica (para obtener una distribuci√≥n uniforme en una escala, los valores del per√≠odo deben distribuirse uniformemente y luego convertirse a valores de escala, como se muestra a continuaci√≥n :): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() #        log-Y-axis :-) scales = scg.periods2scales(np.logspace(np.log10(2), np.log10(365*3), 200)) #  CWT  ,       cwt = scg.CWT(births_normed, scales=scales) ax = scg.cws(cwt, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day", clim=(0,2500), yscale='log') set_x_yearly(ax, len(births)) bboxf = dict(boxstyle="round", facecolor="y", edgecolor="0.5") arrowpropsf = dict(facecolor='yellow', shrink=0.05) text = ax.annotate("unusual\nfeature", xy=(365*6, 15), xytext=(365*3, 50), bbox=bboxf, arrowprops=arrowpropsf) show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/nn/sc/qi/nnscqiixwxx1vbxcbv7mir8lgrs.png"><br><br>  Podemos ver cambios de se√±al en todas las escalas.  El sialograma muestra cada a√±o en per√≠odos iguales. <br><br>  6. Resaltando parte de la l√≠nea de tiempo (Comprobaci√≥n de datos intermedios entre las marcas de la l√≠nea de tiempo en busca de artefactos o datos faltantes): <br><br><div class="spoiler">  <b class="spoiler_title">Listado</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() #        log-Y-axis :-) scales = scg.periods2scales(np.logspace(np.log10(2), np.log10(365*3), 200)) #        log-Y-axis :-) cwt = scg.CWT(births_normed, scales=scales) #    : 1974-1976 fig = figure(figsize=(12,4)) lines =plot(births.index, births.values/1000, '-') xlim(pd.to_datetime("1974-01-01"), pd.to_datetime("1976-01-01")) ylabel("Nb of birthes [k]"); title("Total births per day bw 1974 and 1976"); #      ax = scg.cws(cwt, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day", clim=(0,2500), yscale='log') set_x_yearly(ax, len(births)) xlim = ax.set_xlim( (1974-1969)*365, (1976-1969)*365 ) show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/i-/wd/uc/i-wducpridcu1ycejwjntcdcebk.png"><br><img src="https://habrastorage.org/webt/dj/zj/cz/djzjcz5rdiiw0t-uvyfzowcibve.png"><br><br>   ,     ,  -   ,      : <br><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() #        log-Y-axis :-) scales = scg.periods2scales(np.logspace(np.log10(2), np.log10(365*3), 200)) #        log-Y-axis :-) cwt = scg.CWT(births_normed, scales=scales) # :  1975    1976  fig = figure(figsize=(12,4)) lines = plot(births.index, births.values/1000, '.-') xlim(pd.to_datetime("1974-12-01"), pd.to_datetime("1975-02-01")) ylabel("Nb of birthes [k]"); title("Total births per day : 2 monthes zoom"); #      ax = scg.cws(cwt, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day", clim=(0,2500), yscale='log') set_x_yearly(ax, len(births)) xlim = ax.set_xlim( (1975-1969)*365-30, (1975-1969)*365+30 ) show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/fx/ks/kp/fxkskpcbci6rcfbfta9ibyltg3w.png"><br><br><img src="https://habrastorage.org/webt/2w/bo/jp/2wbojp4_gv7rebff34gmej_37qc.png"><br><br>  ,     : <br><br><ul><li> : 23/24/25      ,       ; </li><li>    ,          1-  2- ,        </li></ul><br> 7.  (    ,      ): <br><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters() <span class="hljs-comment"><span class="hljs-comment">#          #    'cmor1-1.5' #scg.set_default_wavelet('cmor1-1.5') #scg.set_default_wavelet('cgau5') #scg.set_default_wavelet('cgau1') #scg.set_default_wavelet('shan0.5-2') #scg.set_default_wavelet('mexh') df = pd.read_csv("births.csv") #   df = df[(df.day&gt;=1) &amp; (df.day&lt;=31) &amp; (df.births.values &gt; 1000)] #   datetime = pd.to_datetime(df[['year', 'month', 'day']], errors='coerce') df.insert(0, 'datetime', datetime) datetime_lim = [ df.datetime.min(), df.datetime.max() ] years_lim = [ df.datetime.min().year, df.datetime.max().year ] births = df[['datetime', 'births']].groupby('datetime').sum().squeeze() def set_x_yearly(ax, days, start_year=1969): xlim = (np.round([0, days]) / 365).astype(np.int32) ticks = np.arange(xlim[0], xlim[1]) ax.set_xticks(ticks*365) ax.set_xticklabels(start_year + ticks) births_normed = births-births.mean() #        log-Y-axis :-) scales = scg.periods2scales(np.logspace(np.log10(2), np.log10(365*3), 200)) #        log-Y-axis :-) cwt = scg.CWT(births_normed, scales=scales) ax = scg.cws(cwt, figsize=(13.2, 4), xlabel="Year", ylabel="Nb of Day", clim=(0,2500), yscale='log') set_x_yearly(ax, len(births)) bbox = dict(boxstyle="round", facecolor="w", edgecolor="0.5") bbox2 = dict(boxstyle="round", facecolor="y", edgecolor="0.5") arrowprops = dict(facecolor='white', shrink=0.05) arrowprops2 = dict(facecolor='yellow', shrink=0.05) for period, label in [ (3.5, "half a week"), (7, "one week"), (365/2, "half a year"), (365, "one year"), (365*2.8, "long trends")]: text = ax.annotate(label, xy=(365*5.5, period), xytext=(365*2, period), bbox=bbox, arrowprops=arrowprops) text = ax.annotate("end of year\neffect", xy=(365*6, 15), xytext=(365*3, 50), bbox=bbox2, arrowprops=arrowprops2) text = ax.annotate("increase in\nvariations *amplitude*", xy=(365*18.5, 7), xytext=(365*14, 50), bbox=bbox2, arrowprops=arrowprops2) show()</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/96/w4/of/96w4oftizpwwzk0ltfek2jdnm64.png"><br><br> CWT       : <br><br>  ,    ,     ; <br><br>  80-     ,        ,      ; <br><br>     ‚Äî    .       3  1 ,       ,     .              ; <br><br>         1 . , ,      . <br><br><h3> : </h3><br>     ,        .         ,     ,  CWT    . <br><br>               . CWT ‚Äî   ,                        . <br><br>       ,       ,       .      ‚Äì        , ,   mexh  gaus5.   1 : <br><br><img src="https://habrastorage.org/webt/wm/eq/-c/wmeq-co9bi_nfpvrrbncf5bridw.png"><br><br><img src="https://habrastorage.org/webt/qv/mi/ca/qvmicaco6aoj4bi5zmfwyo9pydm.png"><br><br> PS          : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram; print(scaleogram .__version__) <span class="hljs-number"><span class="hljs-number">0.9</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas; print(pandas .__version__) <span class="hljs-number"><span class="hljs-number">0.24</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy; print(numpy .__version__) <span class="hljs-number"><span class="hljs-number">1.16</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib; print(matplotlib .__version__) <span class="hljs-number"><span class="hljs-number">3.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span></code> </pre><br>       *.csv   (  ): <br> year,month,day,gender,births <br> 1969,1,1,F,4046 <br> 1969,1,1,M,4440 <br> 1969,1,2,F,4454 <br> 1969,1,2,M,4548 <br>  ... <br>   0.24.1 pandas     matplotlib. <br><br>   : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas.plotting <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> register_matplotlib_converters register_matplotlib_converters()</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/454240/">https://habr.com/ru/post/454240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454224/index.html">Recomendaciones en Okko: c√≥mo ganar cientos de millones multiplicando un par de matrices</a></li>
<li><a href="../454226/index.html">Memoria en dominios magn√©ticos cil√≠ndricos. Parte 1. Principio de trabajo</a></li>
<li><a href="../454232/index.html">OOP en lenguajes de programaci√≥n gr√°fica. Parte 2 MOS y OOP</a></li>
<li><a href="../454236/index.html">Dos historias sobre c√≥mo ANKI puede ayudarlo a aprender un idioma extranjero y prepararse para una entrevista</a></li>
<li><a href="../454238/index.html">"La m√°quina de la emoci√≥n" de Marvin Minsky (traducci√≥n de Habra, segunda ronda)</a></li>
<li><a href="../454242/index.html">"Mira, ¬°qu√© jetpack tengo!" "¬°Ja, mira qu√© cohete tengo!" (notas del campeonato de cohetes)</a></li>
<li><a href="../454246/index.html">Variedades de coordenadas utilizadas en la GUI de Unity3d</a></li>
<li><a href="../454248/index.html">Siervos en la era de la inteligencia artificial</a></li>
<li><a href="../454252/index.html">Incluso los recursos web de organizaciones conocidas no est√°n protegidos de los errores de los ni√±os.</a></li>
<li><a href="../454254/index.html">Escribimos Reverse socks5 proxy en powershell. Parte 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>