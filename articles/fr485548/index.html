<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêö ‚õΩÔ∏è üßîüèº SwiftUI sur les √©tag√®res üïû ü¶É üññüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Chaque fois qu'un nouveau framework appara√Æt dans un langage de programmation, t√¥t ou tard, des personnes apparaissent qui en apprennent le langage. C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SwiftUI sur les √©tag√®res</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485548/"> Chaque fois qu'un nouveau framework appara√Æt dans un langage de programmation, t√¥t ou tard, des personnes apparaissent qui en apprennent le langage.  C'√©tait probablement le cas dans le d√©veloppement iOS au moment de l'apparition de Swift: au d√©but, il √©tait consid√©r√© comme un ajout √† Objective-C - mais je ne l'ai pas d√©j√† trouv√©.  Maintenant, si vous partez de z√©ro, le choix de la langue n'en vaut plus la peine.  Swift est au-del√† de la concurrence. <br><br>  La m√™me chose, mais √† plus petite √©chelle, se produit avec les cadres.  L'apparition de SwiftUI ne fait pas exception.  Je suis probablement un repr√©sentant de la premi√®re g√©n√©ration de d√©veloppeurs qui a commenc√© par apprendre SwiftUI, en ignorant UIKit.  Cela a un prix - jusqu'√† pr√©sent, il existe tr√®s peu de mat√©riel de formation et d'exemples de code de travail.  Oui, le r√©seau a d√©j√† un certain nombre d'articles racontant une fonctionnalit√© particuli√®re, un outil particulier.  Sur le m√™me site <a href="https://www.hackingwithswift.com/quick-start/swiftui" rel="nofollow">www.hackingwithswift.com,</a> il y a d√©j√† beaucoup d'exemples de code avec des explications.  Cependant, ils font peu pour aider ceux qui d√©cident d'apprendre SwiftUI √† partir de z√©ro, comme moi.  La plupart des documents du r√©seau sont des r√©ponses √† des questions sp√©cifiques et formul√©es.  Un d√©veloppeur exp√©riment√© peut facilement comprendre comment tout fonctionne, pourquoi il en est ainsi et pourquoi il doit √™tre appliqu√©.  Pour un d√©butant, vous devez d'abord comprendre quelle question poser, et alors seulement il pourra acc√©der √† ces articles. <br><br><img src="https://habrastorage.org/webt/1u/td/t6/1utdt6xa6tcsov4biwj2ura36s0.png"><br><br>  Sous la coupe, je vais essayer de syst√©matiser et trier ce que j'ai r√©ussi √† apprendre pour le moment.  Le format de l'article est presque un guide, mais plut√¥t une feuille de triche compil√©e par moi sous la forme dans laquelle je voudrais moi-m√™me le lire au d√©but de mon voyage.  Pour les d√©veloppeurs exp√©riment√©s qui n'ont pas encore plong√© dans SwiftUI, il existe √©galement quelques exemples de code int√©ressants, et les explications textuelles peuvent √™tre lues en diagonale. <br><br>  J'esp√®re que cet article vous fera gagner du temps lorsque vous voudrez √©galement ressentir un peu de magie. <br><a name="habracut"></a><br><h3>  Pour commencer, un peu de vous </h3><br>  Je n'ai pratiquement aucune exp√©rience en d√©veloppement mobile et une exp√©rience significative <br>  en 1s ne pouvait pas aider beaucoup ici.  A propos de comment et pourquoi j'ai d√©cid√© d'apprendre SwiftUI, je vous dirai une autre fois, si cela sera int√©ressant pour quelqu'un, bien s√ªr. <br><br>  Il se trouve que le d√©but de mon immersion dans le d√©veloppement mobile a co√Øncid√© avec la sortie d'iOS 13 et de SwiftUI.  C'est un signe, pensai-je, et j'ai d√©cid√© de commencer imm√©diatement avec, en ignorant UIKit.  J'ai trouv√© une co√Øncidence amusante que j'ai commenc√© √† travailler avec 1c √† ces moments-l√†: alors des formulaires g√©r√©s sont apparus.  Dans le cas de 1c, la vulgarisation des nouvelles technologies a pris pr√®s de cinq ans.  Chaque fois qu'un d√©veloppeur √©tait charg√© d'impl√©menter de nouvelles fonctionnalit√©s, il faisait face √† un choix: le faire rapidement et de mani√®re fiable, avec des outils familiers, ou passer beaucoup de temps √† en discuter avec de nouvelles, et sans garantie de r√©sultats.  Le choix √©tait g√©n√©ralement fait en faveur de la vitesse et de la qualit√© en ce moment, et investir du temps dans de nouveaux outils a √©t√© retard√© tr√®s longtemps. <br><br>  Maintenant, apparemment, la situation avec SwiftUI est √† peu pr√®s la m√™me.  Tout le monde est int√©ress√©, tout le monde comprend que c'est l'avenir, mais jusqu'√† pr√©sent, peu ont pris le temps de l'√©tudier.  Sauf pour les projets pour animaux de compagnie. <br><br>  Dans l‚Äôensemble, peu importe le cadre √† √©tudier, et j‚Äôai d√©cid√© de tenter ma chance malgr√© l‚Äôopinion g√©n√©rale qu‚Äôil serait possible de le lancer en production dans un an ou deux.  Et comme il se trouve que j'√©tais parmi les pionniers, j'ai d√©cid√© de partager mon exp√©rience pratique.  Je veux dire que je ne suis pas un gourou, et en g√©n√©ral dans le d√©veloppement mobile - une bouilloire.  N√©anmoins, j'ai d√©j√† parcouru une certaine voie, au cours de laquelle j'ai cherch√© sur Internet √† la recherche d'informations, et je peux affirmer avec certitude que cela ne suffit pas et que ce n'est pratiquement pas syst√©matis√©.  Mais en russe, bien s√ªr, il est pratiquement inexistant.  Si c'est le cas, j'ai d√©cid√© de rassembler mes forces, de repousser le complexe des <a href="https://habr.com/ru/post/370877">imposteurs</a> et de partager avec la communaut√© ce que j'ai r√©ussi √† comprendre moi-m√™me.  Je partirai de l'hypoth√®se que le lecteur conna√Æt d√©j√† au moins tr√®s peu SwiftUI, et je ne d√©chiffrerai pas des choses comme <code>VStack{‚Ä¶}</code> , <code>Text(‚Ä¶)</code> , etc. <br><br>  J'insiste encore une fois sur le fait que je d√©crirai plus en d√©tail mes propres impressions des tentatives pour obtenir le r√©sultat souhait√© de SwiftUI.  Je pourrais tr√®s bien ne pas comprendre quelque chose, et √† partir de certaines exp√©riences pour tirer des conclusions erron√©es ou inexactes, toutes les corrections et clarifications sont donc les bienvenues. <br><br>  Pour les d√©veloppeurs exp√©riment√©s, cet article peut sembler plein de descriptions de choses √©videntes, mais ne jugez pas strictement.  Les tutoriels pour les nuls sur SwiftUI n'ont pas encore √©t√© √©crits. <br><br><h2>  Qu'est-ce que c'est que ce SwiftUI? </h2><br>  Donc, je commencerais probablement par ce dont il s'agit, c'est votre SwiftUI.  L√† encore, mon 1er pass√© revient.  L'analogie avec les formulaires g√©r√©s n'est devenue plus forte que lorsque j'ai regard√© quelques vid√©os de didacticiel sur la mise en page des interfaces dans Storyboard (c'est-√†-dire lorsque vous travaillez avec UIKit).  J'ai pris la nostalgie selon des formes ¬´incontr√¥lables¬ª en 1s: placement manuel des √©l√©ments sur le formulaire, et surtout des reliures ... Oh, quand l'auteur de la vid√©o de formation pendant environ 20 minutes a parl√© des subtilit√©s de la reliure de divers √©l√©ments entre eux et des bords de l'√©cran, je m'en suis souvenu avec un sourire 1C - tout √©tait le m√™me avant les formes contr√¥l√©es.  Eh bien, presque ... un peu pire, bien s√ªr, et en cons√©quence - plus facile.  Et SwiftUI est, en gros, des formulaires g√©r√©s d'Apple.  Aucune reliure.  Pas de story-boards et de segways.  Vous d√©crivez simplement la structure de votre vue dans le code.  Et c'est tout.  Tous les param√®tres, tailles, etc. sont d√©finis directement dans le code - mais tout simplement.  Plus pr√©cis√©ment, vous pouvez modifier les param√®tres des objets existants dans Canvas, mais pour cela, vous devez d'abord les ajouter dans le code.  Honn√™tement, je ne sais pas comment cela fonctionnera dans les grandes √©quipes de d√©veloppement, o√π il est habituel de s√©parer la mise en page du design et le contenu de la vue elle-m√™me, mais en tant que d√©veloppeur ind√©pendant, j'aime vraiment cette approche. <br><br><h3>  Style d√©claratif </h3><br>  SwiftUI suppose que la description de la structure de votre vue est enti√®rement en code.  De plus, Apple nous propose un style d√©claratif d'√©criture de ce code.  Autrement dit, quelque chose comme √ßa: <br><blockquote>  ¬´Ceci est une vue.  Il <s>(pour une raison quelconque, je veux dire ¬´voir¬ª et, par cons√©quent, appliquer la d√©clinaison √† un mot f√©minin) se</s> compose de deux champs de texte et d'une image.  Les champs de texte sont dispos√©s les uns apr√®s les autres horizontalement.  L'image est sous eux et ses bords sont rogn√©s en forme de cercle. " </blockquote>  Cela semble inhabituel, non?  Habituellement, dans le code, nous d√©crivons le processus lui-m√™me, ce qui doit √™tre fait pour atteindre le r√©sultat que nous avons dans notre t√™te: <br><blockquote>  "Ins√©rez un bloc, ins√©rez un champ de texte dans ce bloc, suivi d'un autre champ de texte, puis prenez une photo, recadrez ses bords en les arrondissant et collez ci-dessous." </blockquote>  Cela ressemble √† une instruction pour les meubles d'Ikea.  Et dans swiftUI, nous voyons imm√©diatement quel devrait √™tre le r√©sultat.  M√™me sans Canvas ni d√©bogage, la structure du code refl√®te clairement la structure de la vue.  Il est clair quoi et dans quelle s√©quence sera affich√© et avec quels effets. <br><br>  Un excellent article sur FunctionBuilder et comment il vous permet d'√©crire du code dans un style d√©claratif est d√©j√† sur <a href="https://habr.com/ru/company/tinkoff/blog/455760/">Habr√©</a> . <br><br>  En principe, beaucoup de choses ont √©t√© √©crites sur le style d√©claratif et ses avantages, je vais donc terminer.  J'ajouterai de moi-m√™me que je m'y suis un peu habitu√© et j'ai vraiment senti √† quel point il est pratique d'√©crire du code dans ce style en ce qui concerne les interfaces.  Avec cela, Apple a frapp√© ce qu'on appelle la bulle! <br><br><h2>  En quoi consiste View? </h2><br>  Mais regardons de plus pr√®s.  Apple sugg√®re que le style d√©claratif est le suivant: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text1 = <span class="hljs-string"><span class="hljs-string">"some text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text2 = <span class="hljs-string"><span class="hljs-string">"some more text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span>{ <span class="hljs-type"><span class="hljs-type">Text</span></span>(text1) .padding() .frame(width: <span class="hljs-number"><span class="hljs-number">100</span></span>, height: <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(text2) .background(<span class="hljs-type"><span class="hljs-type">Color</span></span>.gray) .border(<span class="hljs-type"><span class="hljs-type">Color</span></span>.green) } } }</code> </pre> <br>  Veuillez noter que <code>View</code> est une structure avec quelques param√®tres.  Pour cr√©er la <code>View</code> la structure, nous devons d√©finir le <code>body</code> param√®tre calcul√©, qui renvoie une <code>some View</code> .  Nous en reparlerons plus tard.  Le contenu du <code>body: some View { ‚Ä¶ }</code> fermeture de la <code>body: some View { ‚Ä¶ }</code> est la description de ce qui sera affich√© √† l'√©cran.  En fait, c'est tout ce qui est n√©cessaire pour que notre structure r√©ponde aux exigences du protocole View.  Je sugg√®re de me concentrer principalement sur le <code>body</code> . <br><br><h3>  Et donc, des √©tag√®res </h3><br>  Au total, j'ai compt√© trois types d'√©l√©ments √† partir desquels le corps de la vue est construit: <br><br><ul><li>  <b>Autre vue</b> <br>  C'est-√†-dire  Chaque vue contient une ou plusieurs autres <code>View</code> .  Ceux-ci, √† leur tour, peuvent √©galement contenir √† la fois une <code>View</code> syst√®me pr√©d√©finie comme <code>Text()</code> et des images complexes personnalis√©es √©crites par le d√©veloppeur.  Il s'av√®re une sorte de poup√©e gigogne avec un niveau de nidification illimit√©. </li><li>  <b>Modificateurs</b> <br>  Avec l'aide de modificateurs, toute magie op√®re.  Gr√¢ce √† eux, nous disons bri√®vement et clairement √† SwiftUI quel type de vue nous voulons voir.  Comment cela fonctionne, nous allons toujours le comprendre, mais l'essentiel est que les modificateurs ajoutent la pi√®ce requise au contenu d'une certaine <code>View</code> . </li><li>  <b>Conteneurs</b> <br>  Les premiers conteneurs avec <code>HStack</code> commence le standard ¬´Hello, world¬ª sont <code>HStack</code> et <code>VStack</code> .  Un peu plus tard, <code>Group</code> , <code>Section</code> et d'autres apparaissent.  En fait, les conteneurs sont la m√™me vue, mais ils ont une fonctionnalit√©.  Vous leur passez du contenu que vous souhaitez afficher.  Toute la caract√©ristique du conteneur est qu'il doit en quelque sorte regrouper et afficher les √©l√©ments de ce contenu.  En ce sens, les conteneurs sont similaires aux modificateurs, √† la seule diff√©rence que les modificateurs sont destin√©s √† modifier une vue pr√™te √† l'emploi, et les conteneurs organisent ces vues (√©l√©ments de contenu ou blocs de syntaxe d√©clarative) dans un certain ordre, par exemple, verticalement ou horizontalement ( <code>VStack{...}</code> <code>HStack{...}</code> ).  Il existe √©galement des conteneurs sp√©cifiques, tels que <code>ForEach</code> ou <code>GeometryReader</code> , nous en parlerons un peu plus tard. <br><br>  En g√©n√©ral, je consid√®re les conteneurs comme n'importe quelle vue, dans laquelle le contenu peut √™tre transmis en tant que param√®tre. </li></ul><br>  Et c'est tout.  Tous les √©l√©ments de SwiftUI de race pure peuvent √™tre attribu√©s √† l'un de ces types.  Oui, cela ne suffit pas pour remplir votre vue de fonctionnalit√©s, mais c'est tout ce dont vous avez besoin pour afficher vos fonctionnalit√©s √† l'√©cran. <br><br><h3>  .modifiers () - comment sont-ils organis√©s? </h3><br>  Commen√ßons par le plus simple.  Un modificateur est en fait une chose tr√®s simple.  Il prend simplement une <code>View</code> , lui applique des modifications <s>(ou le fait-il?)</s> , Et la renvoie.  C'est-√†-dire  Le modificateur est une fonction de la <code>View</code> elle-m√™me, qui renvoie <code>self</code> , apr√®s avoir effectu√© quelques modifications auparavant. <br><br>  Voici un exemple de code avec lequel je d√©clare mon propre modificateur.  Plus pr√©cis√©ment, je surcharge le <code>frame(width:height:)</code> modification existant <code>frame(width:height:)</code> , avec lequel vous pouvez fixer les dimensions sp√©cifiques d'une vue particuli√®re.  Dans la case correspondante, vous devez sp√©cifier la largeur et la hauteur, et je devais lui passer un objet <code>CGSize</code> avec un argument, qui est une description de la longueur et de la largeur.  Pourquoi ai-je besoin de √ßa, je le dirai un peu plus tard. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FrameFromSize</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModifier</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> size: <span class="hljs-type"><span class="hljs-type">CGSize</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">body</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(content: Content)</span></span></span></span> -&gt; some <span class="hljs-type"><span class="hljs-type">View</span></span> { content .frame(width: size.width, height: size.height) } }</code> </pre> <br>  Avec ce code, nous avons cr√©√© une structure conforme au protocole <code>ViewModifier</code> .  Ce protocole nous oblige √† ce que la fonction <code>body()</code> soit impl√©ment√©e dans cette structure, dont l'entr√©e sera du <code>Content</code> et la sortie aura <code>some View</code> : le m√™me type que le param√®tre <code>body</code> de notre <code>View</code> (nous parlerons d'une vue ci-dessous) .  De quel type de <code>Content</code> il? <br><br><h4>  Content + ViewBuilder = Afficher </h4><br>  Dans la documentation int√©gr√©e √† son sujet, il est dit: <br><blockquote>  `content` est un proxy pour la vue √† laquelle le modificateur repr√©sent√© par` Self` lui sera appliqu√©. </blockquote>  Il s'agit d'un type de proxy, qui est un pr√©fabriqu√© View auquel des modificateurs peuvent √™tre appliqu√©s.  Une sorte de produit semi-fini.  En fait, le <code>Content</code> est une fermeture de style d√©clarative qui d√©crit la structure de la <code>View</code> .  Ainsi, si nous appelons ce modificateur pour une vue, tout ce qu'il fait est d'obtenir une fermeture du <code>body</code> et de la transmettre √† notre fonction <code>body</code> , dans laquelle nous ajoutons nos cinq cents √† cette fermeture. <br><br>  Encore une fois, <code>View</code> est avant tout une structure qui stocke tous les param√®tres n√©cessaires pour g√©n√©rer une image √† l'√©cran.  Y compris les instructions de montage, dont le <code>Content</code> .  Ainsi, une fermeture dans un style d√©claratif ( <code>Content</code> ) trait√© √† l'aide de <code>ViewBuilder</code> nous renvoie une Vue. <br><br>  Revenons √† notre modificateur.  En principe, la d√©claration de la structure <code>FrameFromSize</code> suffit d√©j√† pour commencer √† l'appliquer.  √Ä l'int√©rieur du <code>body</code> nous pouvons √©crire comme ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">RoundedRectangle</span></span>(cornerRadius: <span class="hljs-number"><span class="hljs-number">4</span></span>).modifier(<span class="hljs-type"><span class="hljs-type">FrameFromSize</span></span>(size: size))</code> </pre><br>  <code>modifier</code> est une m√©thode de protocole View qui extrait le contenu de la <code>View</code> modification, le transmet √† la fonction corps de la structure du modificateur et transmet le r√©sultat au traitement <code>ViewBuilder</code> ou au modificateur suivant, si nous avons une cha√Æne de modifications. <br><br>  Mais vous pouvez le rendre encore plus concis en d√©clarant votre propre modificateur en tant que fonction, √©largissant ainsi les capacit√©s du protocole View. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">frame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size: CGSize)</span></span></span></span> -&gt; some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.modifier(<span class="hljs-type"><span class="hljs-type">FrameFromSize</span></span>(size: size)) } }</code> </pre> <br>  Dans ce cas, j'ai surcharg√© le modificateur existant <code>.frame(width: height:)</code> une autre variante des param√®tres d' <code>.frame(width: height:)</code> .  Maintenant, nous pouvons utiliser l'option d'appeler le modificateur <code>frame(size:)</code> pour n'importe quelle <code>View</code> .  Il s'est av√©r√© que rien de compliqu√©. <br><br><div class="spoiler">  <b class="spoiler_title">Un peu d'erreurs</b> <div class="spoiler_text">  Au fait, je pensais qu'il n'√©tait pas n√©cessaire d'√©tendre tout le protocole, il suffirait d'√©tendre sp√©cifiquement le <code>RoundedRectangle</code> dans mon cas, et cela aurait d√ª fonctionner, comme il me semblait - mais il semble que Xcode ne s'attendait pas √† une telle impudence, et est tomb√© avec une erreur inintelligible " <code>Abort trap: 6</code> ‚Äùet une proposition pour envoyer un vidage aux d√©veloppeurs.  D'une mani√®re g√©n√©rale, dans SwiftUI, les descriptions d'erreurs jusqu'√† pr√©sent ne r√©v√®lent pas tr√®s souvent la cause de cette erreur. <br></div></div><br>  De la m√™me mani√®re, vous pouvez cr√©er des modificateurs personnalis√©s et les utiliser de la m√™me mani√®re que le SwiftUI int√©gr√©: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">RoundedRectangle</span></span>(cornerRadius: <span class="hljs-number"><span class="hljs-number">4</span></span>).frame(size)</code> </pre><br>  De fa√ßon pratique, concise et claire. <br><br>  J'imagine une cha√Æne de modifications comme des perles enfil√©es sur un fil - notre point de vue.  Cette analogie est √©galement vraie dans le sens o√π l'ordre dans lequel les modifications sont appel√©es importe. <br><br><img src="https://habrastorage.org/webt/tw/1p/ak/tw1paklgxp9d5acpcmwvjywxjce.png"><br><br><div class="spoiler">  <b class="spoiler_title">Presque tout dans SwiftUI est View</b> <div class="spoiler_text">  Au fait, une remarque int√©ressante.  En tant que param√®tre d'entr√©e, l'arri√®re-plan n'accepte pas la couleur, mais la vue.  C'est-√†-dire  La classe Color n'est pas seulement une description de la couleur, c'est une vue √† part enti√®re, √† laquelle des modificateurs et plus peuvent √™tre appliqu√©s.  Et comme arri√®re-plan, en cons√©quence, vous pouvez passer une autre vue. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Modificateurs - uniquement pour les modifications</b> <div class="spoiler_text">  Peut-√™tre vaut-il la peine de noter un dernier point.  Les modificateurs qui ne modifient pas le contenu source sont simplement ignor√©s par SwiftUI et ne sont pas appel√©s.  C'est-√†-dire  Vous ne pourrez pas effectuer de d√©clenchement bas√© sur le modificateur qui provoque certains √©v√©nements, mais n'effectue aucune action avec le contenu.  Apple nous pousse constamment √† abandonner certaines actions lors de l'ex√©cution lors du rendu de l'interface et √† faire confiance au style d√©claratif. <br></div></div><br><h2>  Voir toujours </h2><br>  Plus t√¥t, nous avons parl√© de la composition du <code>body</code> , du corps de la <code>View</code> ou de ses instructions de montage.  Revenons √† la <code>View</code> elle-m√™me.  Tout d'abord, c'est une structure dans laquelle certains param√®tres peuvent √™tre d√©clar√©s, et <code>body</code> n'est que l'un d'entre eux.  Comme nous l'avons d√©j√† dit, en d√©couvrant ce qu'est le <code>Content</code> , le <code>body</code> est une instruction sur la fa√ßon d'assembler la vue souhait√©e, qui est une fermeture dans un style d√©claratif.  Mais qu'est-ce qui devrait rendre notre fermeture? <br><br><h3>  quelques vues - commodit√© </h3><br><img align="right" src="https://habrastorage.org/webt/j9/zh/zz/j9zhzza2ma_4if9rhtzqjkqvdhi.jpeg"><br><br>  Et nous arrivons en douceur √† une question que pendant longtemps je n'ai pas pu comprendre, m√™me si cela ne m'a pas emp√™ch√© d'√©crire du code de travail.  Quelle est cette <code>some View</code> ?  La documentation indique que cette description est un "type de r√©sultat opaque" - mais cela n'a pas beaucoup de sens. <br><br>  Le mot cl√© <code>some</code> est une version ¬´g√©n√©rique¬ª d'une description d'un type retourn√© par une fermeture qui ne d√©pend pas d'autre chose que du code lui-m√™me.  C'est-√†-dire  Le r√©sultat de l'acc√®s √† la propri√©t√© calcul√©e du corps de notre vue devrait √™tre une structure qui satisfait le protocole de vue.  Il peut y en avoir beaucoup - texte, image ou peut-√™tre une structure que vous avez d√©clar√©e.  La puce enti√®re du mot cl√© some est de d√©clarer ¬´g√©n√©rique¬ª conforme au protocole View.  Il est statiquement d√©termin√© par le code impl√©ment√© dans le corps de votre vue, et Xcode est tout √† fait capable d'analyser ce code et de calculer la signature sp√©cifique de la valeur de retour <s>(enfin, presque toujours)</s> .  Et certains sont juste une tentative de ne pas surcharger le d√©veloppeur de <a href="https://habr.com/ru/post/482834/">c√©r√©monies</a> inutiles.  Il suffit que le d√©veloppeur dise: "il y aura une sorte de vue", et laquelle - triez-la vous-m√™me.  La cl√© ici est que le type concret est d√©termin√© non pas par les param√®tres d'entr√©e, comme avec le type g√©n√©rique habituel, mais directement par le code.  Par cons√©quent, ci-dessus, g√©n√©rique que j'ai cit√©. <br><br>  Xcode devrait √™tre en mesure d'identifier un type sp√©cifique sans savoir exactement quelles valeurs vous passez √† cette structure.  Ceci est important √† comprendre - apr√®s la compilation, l'expression Some View est remplac√©e par le type sp√©cifique de votre <code>View</code> .  Ce type est assez d√©terministe et peut √™tre assez complexe, par exemple, comme ceci: <code>Group&lt;TupleView&lt;(Text, ForEach&lt;[SomeClass], SomeClass.ID, Text&gt;)&gt;&gt;</code> . <br><br>  Un exemple de code peut √™tre restaur√© √† partir de ce type: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Group</span></span>{ <span class="hljs-type"><span class="hljs-type">Text</span></span>(‚Ä¶) <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(‚Ä¶){(value: <span class="hljs-type"><span class="hljs-type">SomeClass</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(‚Ä¶) } }</code> </pre> <br>  <code>ForEach</code> , comme le montre la signature de type, n'est pas une boucle d'ex√©cution.  Ceci est juste une <code>View</code> qui est construite sur la base d'un tableau d'objets <code>SomeClass</code> .  comme identifiant d'une sous-vue particuli√®re associ√©e √† l'√©l√©ment de collection, l'ID d'√©l√©ment est indiqu√©, et pour chaque √©l√©ment une sous- <code>subView</code> type <code>Text</code> est <code>subView</code> .  <code>Text</code> et <code>ForEach</code> combin√©s dans <code>TupleView</code> , et tout cela est plac√© dans <code>Group</code> .  Nous parlerons plus <code>ForEach</code> d√©tail de <code>ForEach</code> . <br><br>  Imaginez le volume d'√©criture si nous √©tions oblig√©s de d√©crire une signature exacte comme le <code>body</code> du param√®tre?  Pour √©viter cela, le mot cl√© <code>some</code> √©t√© cr√©√©. <br><br><div class="spoiler">  <b class="spoiler_title">R√©sum√©</b> <div class="spoiler_text">  <code>some</code> sont ¬´g√©n√©riques - vice versa¬ª.  Nous obtenons le g√©n√©rique classique de l'ext√©rieur de la fonction, et connaissant d√©j√† le type sp√©cifique du type g√©n√©rique, Xcode d√©finit le fonctionnement de notre fonction.  <code>some-</code> ne d√©pendent pas des param√®tres d'entr√©e, mais uniquement du code lui-m√™me.  Il s'agit simplement d'une abr√©viation, qui permet de ne pas d√©finir de type sp√©cifique, mais d'indiquer uniquement la famille de la valeur retourn√©e par la fonction (protocole). <br></div></div><br><h3>  quelques vues - et cons√©quences </h3><br>  L'approche du calcul du type statique d'une expression √† l'int√©rieur du corps soul√®ve, √† mon avis, deux points importants: <br><br><ul><li>  Une fois compil√©, Xcode analyse le contenu du corps afin de calculer le type de retour sp√©cifique.  Dans les corps complexes, cela peut prendre un certain temps.  Dans certains corps particuli√®rement complexes, il peut ne pas √™tre en mesure de faire face √† un temps sain du tout, et il le dira directement. <br><img src="https://habrastorage.org/webt/-b/cf/nv/-bcfnvtylozajmnzcgjcto_8ms0.png"><br>  En g√©n√©ral, View doit √™tre aussi simple que possible.  Les structures complexes sont mieux plac√©es dans une vue s√©par√©e.  Ainsi, des cha√Ænes enti√®res de types r√©els sont remplac√©es par un type - votre CustomView, qui permet au compilateur de ne pas devenir fou avec tout ce g√¢chis. <br>  Soit dit en passant, il est vraiment tr√®s pratique de d√©boguer un petit morceau d'une grande vue, ici, √† la vol√©e, en recevant et en observant le r√©sultat dans Canvas. </li><li>  Nous ne pouvons pas contr√¥ler directement le flux.  Si If - else SwiftUI peut toujours le traiter en cr√©ant une ¬´vue Schr√∂dinger¬ª de type &lt;_ConditionalContent &lt;Text, TextField &gt;&gt;, alors l'op√©rateur de condition trinar ne peut √™tre utilis√© que pour s√©lectionner une valeur de param√®tre sp√©cifique, mais pas un type, ni m√™me pour s√©lectionner une s√©quence de modificateurs. <br><img src="https://habrastorage.org/webt/cp/18/7s/cp187s4fsvn9v3kvwobduyk5rie.png"><br>  Mais cela vaut la peine de restaurer le m√™me ordre de modificateurs, et un tel enregistrement cesse d'√™tre un probl√®me. </li></ul><br><h2>  Sauf corps </h2><br>  Cependant, il peut y avoir d'autres param√®tres dans la structure avec lesquels vous pouvez travailler.  En tant que param√®tres, nous pouvons d√©clarer les choses suivantes. <br><br><h3>  Param√®tres externes </h3><br>  Ce sont des param√®tres de structure simples que nous devons passer de l'ext√©rieur lors de l'initialisation pour que la vue les rende en quelque sorte: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> textValue: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(textValue) } }</code> </pre> <br>  Dans cet exemple, <code>textValue</code> pour la structure <code>TextView</code> est un param√®tre qui doit √™tre <code>TextView</code> externe car il n'a pas de valeur par d√©faut.  √âtant donn√© que les structures prennent en charge la g√©n√©ration automatique d'initialiseurs, nous pouvons utiliser cette vue simplement: <br><br><pre> <code class="swift hljs"> <span class="hljs-type"><span class="hljs-type">TextView</span></span>(textValue: <span class="hljs-string"><span class="hljs-string">"some text"</span></span>)</code> </pre><br>  De l'ext√©rieur, vous pouvez √©galement transf√©rer les fermetures qui doivent √™tre effectu√©es lorsqu'un √©v√©nement se produit.  Par exemple, <code>Button(lable:action:)</code> ne fait que cela: effectue la fermeture de l'action pass√©e lorsqu'un bouton est cliqu√©. <br><br><h3>  √©tat - param√®tres </h3><br>  SwiftUI utilise tr√®s activement la nouvelle fonctionnalit√© Swift 5.1 - <a href="https://habr.com/ru/company/funcorp/blog/485008/">Property Wrapper</a> . <br><br>  Tout d'abord, ce sont des variables d'√©tat - des param√®tres stock√©s de notre structure, dont le changement devrait se refl√©ter sur l'√©cran.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ils sont emball√©s dans des emballages sp√©ciaux </font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- pour les types primitifs et </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- pour les classes. Une classe doit satisfaire au protocole </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- cela signifie que cette classe doit √™tre en mesure d'informer les abonn√©s (View, qui utilisent cette valeur avec un wrapper </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) de la modification de leurs propri√©t√©s. Pour ce faire, enveloppez simplement les propri√©t√©s requises dans </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous ne cherchez pas de moyens simples ou si vous avez besoin de fonctionnalit√©s suppl√©mentaires, au lieu de ce wrapper, vous pouvez utiliser </font></font><code>ObservableObjectPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et envoyer des notifications manuellement en utilisant les √©v√©nements de </font></font><code>willSet()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ces param√®tres, comme d√©crit, par exemple, </font></font><a href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-send-state-updates-manually-using-objectwillchange" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rappelez-vous, j'ai dit que</font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'agit-il simplement d'une propri√©t√© calculable? Au d√©but, je ne comprenais pas tout de suite les variables d'√©tat, et j'ai essay√© de d√©clarer quelques variables d'√©tat √† l'int√©rieur </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans wrappers. Le probl√®me s'est av√©r√© √™tre </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, comme je l'ai dit, une instruction apatride. La vue a √©t√© g√©n√©r√©e conform√©ment √† cette instruction, et tout le contexte d√©clar√© √† l'int√©rieur du corps a √©t√© mis en d√©charge. Ensuite, seuls les param√®tres de structure stock√©s sont actifs. Lors de la modification des param√®tres d'√©tat, tous les n√¥tres sont </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mis √† jour. L'instruction est √† nouveau prise, les valeurs actuelles de tous les param√®tres de structure y sont substitu√©es, l'image sur l'√©cran est collect√©e, l'instruction est renvoy√©e jusqu'√† la prochaine fois. Variables d√©clar√©es √† l'int√©rieur </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- avec elle. Pour les d√©veloppeurs exp√©riment√©s, cela peut √™tre √©vident, mais au d√©but, j'√©tais tourment√© par cela, ne comprenant pas l'essence du processus.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et encore une remarque</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous ne pouvez pas utiliser d' </font></font><code>didSet</code> <code>willSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©v√©nements de param√®tres de structure encapsul√©s dans des wrappers. </font><font style="vertical-align: inherit;">Le compilateur vous permet d'√©crire ce code, mais il ne s'ex√©cute pas. </font><font style="vertical-align: inherit;">Probablement parce que l'encapsuleur est une sorte de code de mod√®le qui est ex√©cut√© lorsque ces √©v√©nements se produisent.</font></font><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple d' </font></font><a href="https://habr.com/ru/users/state/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©tat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> classique </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span> { <span class="hljs-type"><span class="hljs-type">Button</span></span>(action: {<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tapCount += <span class="hljs-number"><span class="hljs-number">1</span></span>}, label: { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Tap count \(tapCount)"</span></span>) }) } } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Param√®tres de liaison </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, pour refl√©ter certains changements dans le service d'affichage </font></font><code>@State</code> <code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mais comment ces changements se transmettent-ils entre les deux </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Pour ce faire, SwiftUI a un autre PropertyWrapper - </font></font><code>@Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Compliquons notre exemple avec un bouton pour compter les clics. Supposons que nous ayons un parent </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, qui refl√®te, entre autres, un compteur de clics et un enfant </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec un bouton. Dans la vue parent, le compteur est d√©clar√© comme </font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- c'est compr√©hensible, mais nous voulons que le compteur √† l'√©cran soit mis √† jour. Mais dans la filiale, le compteur doit √™tre d√©clar√© comme </font></font><code>@Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il s'agit d'un autre Property Wrapper, √† l'aide duquel nous d√©clarons des param√®tres de structure qui non seulement changeront, mais reviendront √©galement au parent </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ceci est une sorte de </font></font><code>inout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marqueur pour</font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Lorsqu'une valeur change dans une vue enfant, cette modification est traduite dans la vue parent, d'o√π elle est originaire. </font><font style="vertical-align: inherit;">Et comme pour </font></font><code>inout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous devons marquer les valeurs transmises avec un symbole sp√©cial </font></font><code>$,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour montrer que nous attendons que la valeur transmise change dans une autre vue. </font><font style="vertical-align: inherit;">R√©agissez en action.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span>{ <span class="hljs-type"><span class="hljs-type">SomeView</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: $tapCount) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"you tap \(tapCount) times"</span></span>) } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela se refl√®te √©galement dans les types de donn√©es. </font></font><code>@Binding var tapCount: Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par exemple, ce n'est plus seulement un </font></font><code>Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">type, c'est</font></font><br><br><pre> <code class="plaintext hljs">Binding&lt;Int&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est utile de savoir, par exemple, si vous voulez √©crire votre propre initialiseur </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ @<span class="hljs-type"><span class="hljs-type">Binding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: <span class="hljs-type"><span class="hljs-type">Binding</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Int</span></span>&gt;){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>._tapCount = <span class="hljs-built_in"><span class="hljs-built_in">count</span></span> <span class="hljs-comment"><span class="hljs-comment">//    -    } var body: some View{ Button(action: {self.tapCount += 1}, label: { Text("Tap me") }) } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veuillez noter qu'√† l'int√©rieur, </font></font><code>init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vous devez </font></font><code>@PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utiliser un trait </font><font style="vertical-align: inherit;">de </font><font style="vertical-align: inherit;">soulignement </font><font style="vertical-align: inherit;">pour faire r√©f√©rence aux param√®tres envelopp√©s dans certains param√®tres </font></font><code>self._</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- cela fonctionne dans les initialiseurs, lorsqu'ils sont </font></font><code>self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encore en cours de cr√©ation. </font><font style="vertical-align: inherit;">Plus pr√©cis√©ment, avec l'aide, </font></font><code>self._</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous nous r√©f√©rons au param√®tre avec son wrapper. </font><font style="vertical-align: inherit;">L'application directe √† la valeur √† l'int√©rieur du wrapper se fait sans soulignement. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ä son tour, si vous avez une variable envelopp√©e dans une sorte d'entr√©e </font></font><code>PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous obtenons un type wrapper, dans ce cas</font></font><br><br><pre> <code class="plaintext hljs">Binding&lt;Int&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous </font></font><code>Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pouvez </font><font style="vertical-align: inherit;">acc√©der directement √† la valeur de type </font></font><code>.wrappedValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et comme toujours, un r√¢teau personnel</font></font></b> <div class="spoiler_text"> ,  Binding     .   View          View.      View      ,    @Binding-.  ,   View     <a href="https://habr.com/ru/users/state/" class="user_link">State</a>  @Binding ‚Äî ,     State-   Binding.       -,  ,    . <br></div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EnvironmentObject </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bref, les </font></font><code>EnvironmentObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param√®tres sont comme </font></font><code>Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, seulement imm√©diatement pour tout </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le </font><font style="vertical-align: inherit;">monde </font><font style="vertical-align: inherit;">dans la hi√©rarchie, sans avoir besoin de les passer explicitement.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ContentView</span></span>().environmentObject(session)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©n√©ralement, l'√©tat actuel de l'application, ou une partie de celle-ci, dont de nombreux View ont besoin √† la fois, est transmis. Par exemple, des donn√©es sur un utilisateur, une session ou quelque chose de similaire, il est logique de les placer une fois dans EnvironmentObject, dans la vue racine. Dans chaque vue, l√† o√π elles sont n√©cessaires, elles peuvent √™tre extraites de l'environnement en d√©clarant une variable avec un wrapper @EnvironmentObject, par exemple comme ceci</font></font><br><br><pre> <code class="swift hljs"> @<span class="hljs-type"><span class="hljs-type">EnvironmentObject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session: <span class="hljs-type"><span class="hljs-type">Session</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'identifiant d'une valeur sp√©cifique est le type lui-m√™me. Si vous entrez </font></font><code>EnvironmentObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plusieurs valeurs du m√™me type, l'ordre est important. Pour arriver √† la 3e, par exemple, la valeur, vous devez obtenir toutes les valeurs dans l'ordre, m√™me si vous n'en avez pas besoin. Par cons√©quent, </font></font><code>EnvironmentObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il est bien adapt√© pour refl√©ter l'√©tat de l'application, mais il n'est pas bien adapt√© pour passer plusieurs valeurs du m√™me type entre </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ils devront √™tre transmis manuellement, via </font></font><code>Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@Environment est presque le m√™me. Dans le sens, c'est un √©tat de l'environnement, c'est-√†-dire OS Il est pratique de passer √† travers ce wrapper, par exemple, la position de l'√©cran (vertical ou horizontal), un th√®me clair ou sombre est utilis√©, etc. De plus, gr√¢ce √† ce wrapper, vous pouvez acc√©der √† la base de donn√©es lorsque vous utilisez CoreData:</font></font><br><br><pre> <code class="swift hljs">@<span class="hljs-type"><span class="hljs-type">Environment</span></span>(\.managedObjectContext) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> moc: <span class="hljs-type"><span class="hljs-type">NSManagedObjectContext</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soit dit en passant, beaucoup de choses int√©ressantes ont √©t√© faites pour travailler avec CoreData dans SwiftUI. </font><font style="vertical-align: inherit;">Mais √† ce sujet, peut-√™tre, la prochaine fois. </font><font style="vertical-align: inherit;">L'article a donc d√©pass√© toutes les attentes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> @PropertyWrapper personnalis√© </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En gros, </font></font><code>PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c'est un raccourci pour setter et getter, le m√™me pour tous les param√®tres envelopp√©s dans le m√™me </font></font><code>property wrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous pouvez restaurer compl√®tement cette fonctionnalit√© vous-m√™me en supprimant la d√©claration wrapper et en √©crivant les param√®tres getter {} setter {}, mais vous devrez le faire √† chaque fois, pour chacun </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, en dupliquant le code. </font><font style="vertical-align: inherit;">Par exemple, son utilisation est </font></font><code>PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr√®s pratique pour masquer le travail </font></font><code>UserDefaults</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs">@propertyWrapper <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDefault</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> initialValue: <span class="hljs-type"><span class="hljs-type">T</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wrappedValue: <span class="hljs-type"><span class="hljs-type">T</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(newValue, forKey: key) } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.object(forKey: key) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">T</span></span> ?? initialValue } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, nous pouvons stocker des types de donn√©es primitifs dans le stockage </font></font><code>UserDefaults</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Apple revendique une tr√®s bonne vitesse d'acc√®s √† ce stockage, il n'est donc probablement pas n√©cessaire de mettre ces donn√©es en cache sous forme de param√®tres de structure ou de variables, √† moins bien s√ªr qu'elles ne soient utilis√©es dans des cycles massifs et des t√¢ches exigeantes en vitesse. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compte tenu de cela, vous pouvez cr√©er un type de stub (dans ce cas, une √©num√©ration) dans lequel d√©clarer des variables statiques pour acc√©der √† des valeurs sp√©cifiques stock√©es √† l' </font></font><code>UserDefaults</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aide de l'encapsuleur qui vient d'√™tre cr√©√©:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserPreferences</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"isCheatModeEnabled"</span></span>, initialValue: <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isCheatModeEnabled: <span class="hljs-type"><span class="hljs-type">Bool</span></span> @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"highestScore"</span></span>, initialValue: <span class="hljs-number"><span class="hljs-number">10000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> highestScore: <span class="hljs-type"><span class="hljs-type">Int</span></span> @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"nickname"</span></span>, initialValue: <span class="hljs-string"><span class="hljs-string">"cloudstrife97"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nickname: <span class="hljs-type"><span class="hljs-type">String</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le r√©sultat peut √™tre utilis√© tr√®s succinctement, en se concentrant sur la logique et l'affichage visuel, et tout le travail est effectu√© sous le capot. </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.isCheatModeEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.highestScore = <span class="hljs-number"><span class="hljs-number">25000</span></span> <span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.nickname = <span class="hljs-string"><span class="hljs-string">"squallleonhart‚Äù</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple a √©t√© initialement d√©crit </font></font><a href="https://medium.com/swlh/understanding-property-wrappers-in-swift-by-examples-604206022b5c" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conteneurs </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, la derni√®re chose √† discuter de ma liste est les conteneurs. Nous en avons d√©j√† partiellement parl√© lorsque nous en avons parl√© </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En fait, les conteneurs sont courants </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. La seule diff√©rence est qu'en tant que l'un des param√®tres de cette structure, nous transmettons le contenu. Rappelons que le contenu est une fermeture contenant une ou plusieurs expressions d√©claratives. Cette fermeture, si elle est trait√©e √† l'aide de </font></font><code>@ViewBuilder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, nous renverra une nouvelle vue, combinant d'une certaine mani√®re toutes les vues r√©pertori√©es dans la fermeture (blocs de contenu). Dans le m√™me temps, pour diff√©rents conteneurs, les m√©canismes de traitement des blocs eux-m√™mes sont diff√©rents. </font></font><code>VStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">organise les √©l√©ments de contenu verticalement, </font></font><code>HStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">horizontalement, etc. C'est comme un modificateur, mais cette fois ce n'est pas seulement une vue sp√©cifique qui est en train d'√™tre modifi√©e, mais l'ensemble</font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transf√©r√© dans le conteneur et un nouveau est g√©n√©r√© </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">De plus, ce nouveau </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a un nouveau type. </font><font style="vertical-align: inherit;">Par exemple, pour </font></font><code>HStack{Text(‚Ä¶)}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce type sera </font></font><code>TupleView&lt;Text, Image&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, n'oubliez pas que tout </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y compris les conteneurs, est une structure qui peut avoir d'autres param√®tres que le corps. </font><font style="vertical-align: inherit;">Par exemple, pendant longtemps, je n'ai pas pu comprendre comment supprimer un petit espace entre l' </font></font><code>Text(¬´a¬ª)</code> <code>Text(¬´b¬ª)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int√©rieur </font></font><code>HStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">J'ai pass√© beaucoup de temps avec </font></font><code>offset()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">et </font></font><code>position()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, calculant les coordonn√©es du d√©calage en fonction de la longueur des lignes, jusqu'√† ce que je tombe par hasard sur la syntaxe compl√®te de la d√©claration </font></font><code>HStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HStack (espacement:, alingment:, contexte :). </font></font><br></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplement, les deux premiers param√®tres sont facultatifs et sont ignor√©s dans la plupart des exemples. </font><font style="vertical-align: inherit;">Erreur pour les d√©butants - ne pas voir la syntaxe compl√®te.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Foreach </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√©par√©ment, il vaut la peine d'en parler </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il s'agit d'un conteneur qui sert √† refl√©ter √† l'√©cran tous les √©l√©ments de la collection transf√©r√©e. Tout d'abord, vous devez comprendre que ce n'est pas la m√™me chose que d'appeler une collection </font></font><code>forEach(‚Ä¶)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Comme nous l'avons dit ci-dessus, </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retourne un unique </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, cr√©√© sur la base des √©l√©ments de la collection transf√©r√©e.</font></font> C'est-√†-dire<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c'est juste un autre conteneur dans lequel la collection est transf√©r√©e et des instructions sur la fa√ßon de refl√©ter les √©l√©ments de la collection √† l'√©cran. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, il </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doit √™tre plac√© √† l'int√©rieur d'un autre conteneur qui d√©terminera d√©j√† comment grouper cette entit√© multiple - en la pla√ßant verticalement, horizontalement ou, par exemple, en la pla√ßant dans une liste ( </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br> <code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accepte trois param√®tres: collection ( </font></font><code>data: RandomAccesCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), adresse de l'identificateur d'√©l√©ment de collection ( </font></font><code>id: Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) et content ( </font></font><code>content: ()-&gt;Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Le troisi√®me dont nous avons d√©j√† discut√©: comme tout autre conteneur, il </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accepte </font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- c'est-√†-dire court-circuit. Mais contrairement aux conteneurs ordinaires, o√π il </font></font><code>content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne contient pas de param√®tres, il </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passe √† la fermeture un √©l√©ment de collection qui peut √™tre utilis√© pour d√©crire le contenu.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La collection </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne convient </font><font style="vertical-align: inherit;">√† personne </font><font style="vertical-align: inherit;">, mais seulement </font></font><code>RandomAccesCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour diverses collections d√©sordonn√©es, il suffit d'appeler la m√©thode </font></font><code>sorted(by:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec laquelle vous pouvez obtenir </font></font><code>RandomAccesCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Il s'agit d'un ensemble </font></font><code>subView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g√©n√©r√© pour chaque √©l√©ment de la collection en fonction du contenu transmis. Il est important de noter que SwiftUI doit savoir lequel </font></font><code>subView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est associ√© √† quel √©l√©ment de la collection. Pour cela, chacun </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doit avoir un identifiant. Le deuxi√®me param√®tre est pr√©cis√©ment n√©cessaire pour cela. Si les √©l√©ments de la collection sont des </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">types, tels que des cha√Ænes, vous pouvez √©crire simplement </font></font><code>id: \.self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Cela signifie que la cha√Æne elle-m√™me sera l'identifiant. Si les √©l√©ments de la collection sont des classes et satisfont au protocole</font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- alors le deuxi√®me argument peut √™tre manqu√©. Dans ce cas, l'id de chaque √©l√©ment de la collection deviendra un identifiant </font></font><code>subView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si votre objet a une sorte d'accessoires qui fournissent l'unicit√© et qui r√©pondent au protocole </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, vous pouvez le sp√©cifier comme ceci:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ForEach</span></span>(values, id: \.value){item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ‚Ä¶}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans mon exemple, </font></font><code>values</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est un tableau d'objets de classe </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour lesquels les accessoires sont d√©clar√©s </font></font><code>value: Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans tous les cas, vous devez vous assurer que chaque identifiant </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">associ√© √† un √©l√©ment de votre collection est </font><font style="vertical-align: inherit;">unique </font><font style="vertical-align: inherit;">. Par exemple, dans votre contexte, certains param√®tres de votre objet peuvent changer. </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">il doit √™tre mis en correspondance 1 √† 1 avec l'objet de donn√©es (√©l√©ment de collection), sinon il ne sera pas clair o√π renvoyer la modification de </font></font><code>@Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param√®tre </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soit dit en passant, l'organisation d'une analyse des √©l√©ments de collection qui ne satisfont pas Identifiable peut √©galement √™tre effectu√©e √† l'aide d'index. Par exemple, comme ceci:</font></font><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ForEach</span></span>(keys.<span class="hljs-built_in"><span class="hljs-built_in">indices</span></span>){ind <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">SomeView</span></span>(key: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.keys[ind]) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce cas, la travers√©e sera construite non pas par les √©l√©ments eux-m√™mes, mais par leurs indices. Pour les petites collections, cela est parfaitement acceptable. Sur les collections avec un grand nombre d'√©l√©ments, cela peut probablement affecter les performances, en particulier lorsque les √©l√©ments de la collection ne sont pas des types de r√©f√©rence, mais, par exemple, des cha√Ænes volumineuses ou des donn√©es JSON. En g√©n√©ral, utilisez avec prudence. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un point important sur </font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce </font><font style="vertical-align: inherit;">√† </font><font style="vertical-align: inherit;">quoi on fait r√©f√©rence </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il est de mauvaise humeur et refuse de travailler normalement avec des fermetures, avec plus d'un bloc (c'est-√†-dire qu'il per√ßoit le contenu d'une ligne normalement, mais il n'en a d√©j√† pas 2 ou plus). Cela est r√©solu assez simplement, il est assez simple de remplir tout le contenu </font></font><code>Groupe{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- un tel hack cesse d'√™tre un probl√®me.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il suffit de d√©clarer que les variables internes dans le cadre de cette fermeture ne fonctionneront pas. </font><font style="vertical-align: inherit;">Les fermetures transmises √† ViewBuilder ne peuvent pas contenir de d√©clarations de variables. </font><font style="vertical-align: inherit;">Rappelez-vous, au d√©but de l'article, j'ai donn√© un exemple de cr√©ation d'un modificateur </font></font><code>.frame(size:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Je l'ai cr√©√© pour cette raison. </font><font style="vertical-align: inherit;">J'ai calcul√© les tailles de bouton en fonction du nombre de ces boutons dans une rang√©e et du nombre de lignes (je n'√©tais pas satisfait de l'√©tirement automatique, diff√©rents boutons devraient avoir des tailles diff√©rentes). </font><font style="vertical-align: inherit;">La fonction a renvoy√© CGSize et plusieurs niveaux de structures imbriqu√©es ont √©t√© explor√©s √† l'int√©rieur. </font><font style="vertical-align: inherit;">S'il √©tait possible d'ex√©cuter la fonction une fois, √©crivez son r√©sultat sous la forme d'une taille variable, puis appelez</font></font><code>.ftame(width: size.width, height: size.height)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Je ferais √ßa." </font><font style="vertical-align: inherit;">Mais il n'y a pas une telle possibilit√©, et je ne voulais pas ex√©cuter la fonction deux fois - parce que j'ai contourn√© cette limitation et mis une partie du code dans le modificateur.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vue conteneur personnalis√©e </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, comme c'est arriv√©, je vais donner un exemple de cr√©ation d'un conteneur personnalis√©. </font><font style="vertical-align: inherit;">Assez souvent, la relation de plusieurs objets de type ¬´1: N¬ª peut √™tre repr√©sent√©e de mani√®re pratique sous la forme d'un dictionnaire. </font><font style="vertical-align: inherit;">Il n'est </font></font><code>dict: [KeyObject: [SomeObject]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas difficile d' </font><font style="vertical-align: inherit;">ex√©cuter la requ√™te et de convertir son r√©sultat en un dictionnaire de types </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce cas, les objets de la classe agissent comme la cl√© du dictionnaire </font></font><code>KeyObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(pour cela, il doit supporter le protocole </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), et les valeurs sont des tableaux d'objets d'une autre classe - </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> value: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">UUID</span></span> = <span class="hljs-type"><span class="hljs-type">UUID</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(value: <span class="hljs-type"><span class="hljs-type">Int</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.value = value } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comparable</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(name: <span class="hljs-type"><span class="hljs-type">String</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.name = name } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> &lt; (lhs: KeyObject, rhs: KeyObject) -&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bool</span></span></span><span class="hljs-function"> </span></span>{ lhs.name &lt; rhs.name } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> == </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lhs: KeyObject, rhs: KeyObject)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lhs.name == rhs.name } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> { hasher.combine(name) } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si votre application pr√©voit une sorte d'analyse avec le regroupement, il est logique de cr√©er un conteneur s√©par√© pour afficher ces dictionnaires afin de ne pas dupliquer tout le code dans chaque vue. Et √©tant donn√© que les regroupements peuvent √™tre modifi√©s par l'utilisateur, nous devrons utiliser des g√©n√©riques. Je ne l'ai pas compliqu√© en ajoutant du design visuel, ne laissant que la structure de notre container:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TreeView</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">V</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyContent</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValueContent</span></span></span><span class="hljs-class">&gt;: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comparable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyContent</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValueContent</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data: [<span class="hljs-type"><span class="hljs-type">K</span></span>: [<span class="hljs-type"><span class="hljs-type">V</span></span>]] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> keyContent: (<span class="hljs-type"><span class="hljs-type">K</span></span>)-&gt;<span class="hljs-type"><span class="hljs-type">KeyContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> valueContent: (<span class="hljs-type"><span class="hljs-type">V</span></span>)-&gt;<span class="hljs-type"><span class="hljs-type">ValueContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span>{ <span class="hljs-type"><span class="hljs-type">VStack</span></span>(alignment: .leading, spacing: <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(data.keys.sorted(), id: \.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>){(key: <span class="hljs-type"><span class="hljs-type">K</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">VStack</span></span>(alignment: .trailing, spacing: <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.keyContent(key) <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.data[key]!){(value: <span class="hljs-type"><span class="hljs-type">V</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.valueContent(value) } } } } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme vous pouvez le voir, le conteneur accepte un dictionnaire du type </font></font><code>[K: [V]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(o√π </font></font><code>K</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est le type des objets de cl√© de dictionnaire, </font></font><code>V</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est le type de tableau dans lequel les valeurs de dictionnaire se composent), et deux contextes: l'un pour afficher les cl√©s de dictionnaire, et l'autre pour afficher les valeurs. Malheureusement, je n'ai pas trouv√© d'exemples de cr√©ation </font></font><code>ViewBuilder-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de conteneurs </font><font style="vertical-align: inherit;">personnalis√©s </font><font style="vertical-align: inherit;">pour les conteneurs personnalis√©s (probablement cette option n'existe tout simplement pas), nous devrons donc utiliser celui standard </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Puisqu'il n'accepte qu'√† l'entr√©e </font></font><code>RandomAccessCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, et </font></font><code>dict.keys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce n'est pas le cas, nous devrons utiliser le tri. D'o√π la n√©cessit√© de prendre en charge le protocole </font></font><code>Comparable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font><code>KeyObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai utilis√© deux </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conteneurs </font><font style="vertical-align: inherit;">imbriqu√©s </font><font style="vertical-align: inherit;">. Dans le premier cas, j'ai utilis√© le hachage de l'√©l√©ment de collection (</font></font><code>\.self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) comme identifiant de chaque imbriqu√© </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Je pourrais faire √ßa parce que les cl√©s de dictionnaire doivent de toute fa√ßon prendre en charge le protocole </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dans le deuxi√®me cas, j'ai ajout√© le </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">support de protocole </font><font style="vertical-align: inherit;">√† la classe</font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Cela m'a permis de ne pas sp√©cifier du tout de cl√© de communication - id est automatiquement utilis√©. </font><font style="vertical-align: inherit;">Dans mon cas, l'identifiant n'est stock√© nulle part. </font><font style="vertical-align: inherit;">Chaque fois qu'un objet est cr√©√© - qu'il s'agisse de cr√©ation dans du code ou de r√©cup√©ration √† l'aide d'une requ√™te de base de donn√©es - un nouvel identifiant est g√©n√©r√©. </font><font style="vertical-align: inherit;">Pour une interface, ce n'est pas indispensable. </font><font style="vertical-align: inherit;">Il ne changera pas tout au long de la vie de l'objet, c'est-√†-dire </font><font style="vertical-align: inherit;">session, et cela suffit pour l'afficher sous cet identifiant. </font><font style="vertical-align: inherit;">Et si la prochaine fois que vous ouvrirez l'application, elle aura un identifiant diff√©rent - rien de mauvais ne se produira. </font><font style="vertical-align: inherit;">Si votre objet poss√®de d√©j√† des champs cl√©s, vous pouvez simplement faire de id un param√®tre calcul√© et utiliser de toute fa√ßon le support de ce protocole et une syntaxe abr√©g√©e </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple d'utilisation de notre conteneur:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> dict: [<span class="hljs-type"><span class="hljs-type">KeyObject</span></span>: [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>]] = [ <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"1st group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">3</span></span>)], <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"2nd group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">4</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">6</span></span>)], <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"3rd group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">7</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">9</span></span>)] ] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">TreeView</span></span>(data: dict, keyContent: {keyObject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"the key is: \(keyObject.name)"</span></span>) } ){valueObject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"value: \(valueObject.value)"</span></span>) } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le r√©sultat √† l'√©cran dans Canvas: </font></font><br><br><img src="https://habrastorage.org/webt/48/jl/e_/48jle_vonedzfqtotu7uclu2u1e.png"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† suivre </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est tout pour l'instant. </font><font style="vertical-align: inherit;">Je voulais √©galement souligner tous les r√¢teaux sur lesquels j'ai march√©, en essayant de l'utiliser </font></font><code>CoreData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en conjonction avec SwiftUI, mais, franchement, je ne m'attendais pas √† ce que seules les bases de SwiftUI prennent autant de temps et que l'article soit si volumineux. </font><font style="vertical-align: inherit;">Donc, comme on dit, √† suivre. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous avez quelque chose √† ajouter ou √† corriger, bienvenue dans les commentaires. </font><font style="vertical-align: inherit;">Je vais essayer de refl√©ter des commentaires importants dans l'article.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr485548/">https://habr.com/ru/post/fr485548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr485536/index.html">Est-il possible de pirater un avion - 2</a></li>
<li><a href="../fr485538/index.html">Zabbix: surveillez tout de suite (sur l'exemple de Redis)</a></li>
<li><a href="../fr485542/index.html">Ajouter des graphiques √† Notion</a></li>
<li><a href="../fr485544/index.html">Les √©checs comme syst√®me dynamique</a></li>
<li><a href="../fr485546/index.html">L'apocalypse arrive</a></li>
<li><a href="../fr485550/index.html">Y a-t-il de la vie au-del√† du p√©riph√©rique de Moscou? Comment nous recherchons et pr√©parons les d√©veloppeurs</a></li>
<li><a href="../fr485552/index.html">Une autre fa√ßon de suivre le temps et le num√©ro de build pour Java</a></li>
<li><a href="../fr485554/index.html">Objectifs et r√©sultats cl√©s (OKR) - Notre exp√©rience de mise en ≈ìuvre progressive</a></li>
<li><a href="../fr485556/index.html">Il a fallu 12 ans pour cr√©er une section de la carte du cerveau de la drosophile, les efforts de 250 personnes et 40 millions de dollars</a></li>
<li><a href="../fr485558/index.html">Pas de moustiques! Aper√ßu des moustiques "phyto-munitions"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>