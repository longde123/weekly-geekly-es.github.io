<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö£üèø ‚ôüÔ∏è üë©üèæ‚Äç‚öñÔ∏è C√≥mo automatizar con Jenkins construyendo y rodando artefactos de artefactos de modelos de metadatos para tablas en el repositorio üíπ üôÑ üßëüèæ‚Äçü§ù‚Äçüßëüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todo comenz√≥ con el hecho de que nos enfrentamos con la necesidad de formar estructuras EDWEX, JSON, DDL de manera r√°pida y correcta y luego rodarlas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo automatizar con Jenkins construyendo y rodando artefactos de artefactos de modelos de metadatos para tablas en el repositorio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/428101/">  Todo comenz√≥ con el hecho de que nos enfrentamos con la necesidad de formar estructuras EDWEX, JSON, DDL de manera r√°pida y correcta y luego rodarlas en diferentes contornos de bases de datos relacionales.  Por contornos, quiero decir abreviaturas que todos conocen: DEV, TST, UAT, PRD. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/169/a9a/387/169a9a387c429ecc2c76fa39abb3527f.jpg"><br><br>  En ese momento, hicimos casi todo manualmente: generamos DDL y recopilamos edwex y json basados ‚Äã‚Äãen metadatos de la base de datos Oracle.  Hay muchos par√°metros de entrada.  Si pierde uno, formar√° una entidad incorrectamente.  Y dado que todo el proceso de formaci√≥n fue constante y continuo, el error se detectar√° solo al final.  Sobre c√≥mo todos automatizamos y superamos los errores, lea debajo del corte. <br><a name="habracut"></a><br><h2>  Un poco sobre infraestructura </h2><br>  Antes de completar los datos en las tablas de bases de datos relacionales, debemos aceptarlos desde la fuente, en cualquier formato, por ejemplo, en Excel.  Los datos de la fuente que utilizan el mecanismo interno se transportan a Hadoop (Data Lake).  Hive tiene instalado el complemento Hive: con su ayuda podemos ver el contenido de los archivos utilizando una sintaxis similar a SQL. <br><br>  Para transferir los datos en Data Lake en forma de tablas, necesitamos json, que se forman sobre la base de metadatos.  Para analizar datos en formato Excel, necesitamos crear archivos EDWEX.  Los archivos EDWEX (EDW_EXTRACTOR) son un conjunto de artefactos que contienen conjuntos de tablas con el nombre, as√≠ como conjuntos de campos para cada una de estas tablas, que se forman sobre la base de metadatos.  Dependiendo de la versi√≥n del modelo y la ID de origen, el conjunto de campos var√≠a.  La formaci√≥n de DDL es necesaria para crear las tablas en la base de datos de Hive a nivel de datos operativos y en la base de datos de Greenplum a nivel de datos detallados y agregados.  Es decir, los datos se transfieren principalmente a Hive, si es necesario, se filtran y transfieren a Greenplum para la posterior manipulaci√≥n de datos y la creaci√≥n de escaparates basados ‚Äã‚Äãen ellos. <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de artefacto de Edwex</b> <div class="spoiler_text">  paquete: contiene un conjunto de tablas <br>  datos: contiene un conjunto de campos <br><br>  pack.edwex: <br><br><pre><code class="sql hljs">1 Table_1 User Table_1 bid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm') 2 Table_2 User Table_2 curbid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm') 3 Table_3 User Table_3 bid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm')</code> </pre> <br><br>  data.edwex: <br><br><pre> <code class="sql hljs">1 1 CHARGE_ID NUMBER 38 0 1 2 SVC_ID NUMBER 38 0 1 3 VND_ID NUMBER 38 0 1 4 PRICE NUMBER 38 5 1 5 QUANTITY NUMBER 38 5 1 6 BASE NUMBER 38 5 1 7 TAX NUMBER 38 5 1 8 TOTAL NUMBER 38 5 1 9 TAX_RATE NUMBER 38 5 1 10 TAX_IN VARCHAR 1 1 11 CHARGE_KIND VARCHAR 3 1 12 PRIVILEGE_ID NUMBER 38 0 1 13 CHARGE_REF_ID NUMBER 38 0 1 14 EBID NUMBER 38 0 1 15 INVOICE_ID NUMBER 38 0 1 16 ZERO_STATE_ID NUMBER 38 0 1 17 USER_ID NUMBER 38 0 1 18 BID NUMBER 38 0 1 19 QUANTITY_REAL NUMBER 38 5 2 1 CURBID NUMBER 38 0 2 2 USER_ID NUMBER 38 0 2 3 VND_ID NUMBER 38 0 2 4 APPBID NUMBER 38 0 2 5 SVC_ID NUMBER 38 0 2 6 DEBT NUMBER 38 5 2 7 INSTDEBT NUMBER 38 5 3 1 INVOICE_ID NUMBER 38 0 3 2 INVOICE_DATE DATE 3 3 INVOICE_NUM VARCHAR 64 3 4 INVOICE_NUM_N NUMBER 38 5 3 5 BASE NUMBER 38 5 3 6 TAX NUMBER 38 5 3 7 TOTAL NUMBER 38 5 3 8 PREPAID VARCHAR 1 3 9 EXPLICIT VARCHAR 1 3 10 VND_ID NUMBER 38 0 3 11 ADV_PAYMENT_ID NUMBER 38 0 3 12 MDBID NUMBER 38 0 3 13 BID NUMBER 38 0 3 14 USER_ID NUMBER 38 0 3 15 ZERO_STATE_ID NUMBER 38 0 3 16 ACTIVE_SUM NUMBER 38 5 3 17 SPLIT_VND NUMBER 38 5 3 18 PRECREATED VARCHAR 1</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de artefacto Json</b> <div class="spoiler_text"><pre> <code class="java hljs">Table.json: { <span class="hljs-string"><span class="hljs-string">"metadata"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"true"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"svc_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"vnd_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"price"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"5"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"quantity"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"6"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"base"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"8"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"total"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"9"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax_rate"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax_in"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"11"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_kind"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"12"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"privilege_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"13"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_ref_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"14"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"ebid"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"15"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"invoice_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"zero_state_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"17"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"user_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"18"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"bid"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"19"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"quantity_real"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> } ], <span class="hljs-string"><span class="hljs-string">"ctlPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"  ctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"errPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"    "</span></span>, <span class="hljs-string"><span class="hljs-string">"inPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"    hdfs"</span></span>, <span class="hljs-string"><span class="hljs-string">"outSchema"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"outTable"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"isPartitioned"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"sourceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"id  "</span></span> }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ejemplos de artefactos DDL</b> <div class="spoiler_text">  alter table esquema. GP_000001_TABLE renombrar a Z_GP_000001_TABLE_20180807; <br>  crear esquema de tabla. GP_000001_TABLE <br>  ( <br><br>  `charge_id` DECIMAL (38.0), <br>  `svc_id` DECIMAL (38.0), <br>  `vnd_id` DECIMAL (38.0), <br>  `precio` DECIMAL (38.5), <br>  `cantidad` DECIMAL (38.5), <br>  `base` DECIMAL (38.5), <br>  `fiscal` DECIMAL (38.5), <br>  `total` DECIMAL (38.5), <br>  `tax_rate` DECIMAL (38.5), <br>  `tax_in` STRING, <br>  `charge_kind` STRING, <br>  `privilege_id` DECIMAL (38.0), <br>  `charge_ref_id` DECIMAL (38.0), <br>  `ebid` DECIMAL (38.0), <br>  `invoice_id` DECIMAL (38.0), <br>  `zero_state_id` DECIMAL (38,0), <br>  `user_id` DECIMAL (38.0), <br>  `bid` DECIMAL (38.0), <br>  `cantidad_real` DECIMAL (38.5), <br>  `load_dttm` TIMESTAMP, <br>  `src_id` SMALLINT, <br>  `package_id` BIGINT, <br>  `wf_run_id` BIGINT, <br>  `md5` STRING <br>  ) <br>  FORMATO DE FILAS CAMPOS DELIMITADOS TERMINADOS POR '\ t' <br>  ALMACENADO COMO INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' <br>  UBICACI√ìN 'forma de formar en hdfs' <br>  TBLPROPERTIES ('auto.purge' = 'true', 'transient_lastDlastDdlTime' = '1489060201'); <br>  insertar en el esquema. GP_000001_TABLE (`charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `precio`, <br>  `cantidad`, <br>  `base`, <br>  "impuesto", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `invoice_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  oferta <br>  `cantidad_real`, <br>  `load_dttm`, <br>  `src_id`, <br>  package_id <br>  `wf_run_id`, <br>  `md5`) <br><br>  seleccione `charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `precio`, <br>  `cantidad`, <br>  `base`, <br>  "impuesto", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `invoice_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  oferta <br>  `cantidad_real`, <br>  load_dttm, <br>  src_id <br>  package_id, <br>  wf_run_id, <br>  md5 del esquema.Z_GP_000001_TABLE_20180807; <br><br>  alter table esquema. GP_000001_TABLE renombrar a Z_GP_000001_TABLE_20180807; <br>  crear esquema de tabla. GP_000001_TABLE <br>  ( <br><br>  `charge_id` DECIMAL (38.0), <br>  `svc_id` DECIMAL (38.0), <br>  `vnd_id` DECIMAL (38.0), <br>  `precio` DECIMAL (38.5), <br>  `cantidad` DECIMAL (38.5), <br>  `base` DECIMAL (38.5), <br>  `fiscal` DECIMAL (38.5), <br>  `total` DECIMAL (38.5), <br>  `tax_rate` DECIMAL (38.5), <br>  `tax_in` STRING, <br>  `charge_kind` STRING, <br>  `privilege_id` DECIMAL (38.0), <br>  `charge_ref_id` DECIMAL (38.0), <br>  `ebid` DECIMAL (38.0), <br>  `invoice_id` DECIMAL (38.0), <br>  `zero_state_id` DECIMAL (38,0), <br>  `user_id` DECIMAL (38.0), <br>  `bid` DECIMAL (38.0), <br>  `cantidad_real` DECIMAL (38.5), <br>  `load_dttm` TIMESTAMP, <br>  `src_id` SMALLINT, <br>  `package_id` BIGINT, <br>  `wf_run_id` BIGINT, <br>  `md5` STRING <br>  ) <br>  FORMATO DE FILAS CAMPOS DELIMITADOS TERMINADOS POR '\ t' <br>  ALMACENADO COMO INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' <br>  UBICACI√ìN 'forma de formar en hdfs' <br>  TBLPROPERTIES ('auto.purge' = 'true', 'transient_lastDlastDdlTime' = '1489060201'); <br>  insertar en el esquema. GP_000001_CPA_CHARGE (`charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `precio`, <br>  `cantidad`, <br>  `base`, <br>  "impuesto", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `invoice_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  oferta <br>  `cantidad_real`, <br>  `load_dttm`, <br>  `src_id`, <br>  package_id <br>  `wf_run_id`, <br>  `md5`) <br><br>  seleccione `charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `precio`, <br>  `cantidad`, <br>  `base`, <br>  "impuesto", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `invoice_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  oferta <br>  `cantidad_real`, <br>  load_dttm, <br>  src_id <br>  package_id, <br>  wf_run_id, <br>  md5 del esquema.Z_GP_000001_TABLE_20180807; <br></div></div><br><h2>  ¬øC√≥mo automatizar </h2><br>  Para resolver el problema, utilizamos: <br><br><ul><li>  Jenkins: como orquesta y herramienta para implementar el proceso de CI. <br></li><li>  Python: implementa la funcionalidad y las pruebas unitarias. <br></li><li>  SQL: para acceder a la base de datos de metadatos. <br></li><li>  Script de Shell: para copiar artefactos entre directorios y crear scripts en proyectos de m√∫ltiples trabajos que se ejecutan en el servidor Jenkins. <br></li></ul><br>  Para empezar, inicialmente trabajamos con una gran cantidad de fuentes, por lo tanto, al usar el script de Shell como par√°metro de inicio, pasamos las ID de las fuentes a las funciones de SQL para identificarlas.  Las funciones SQL resultantes se ejecutar√°n autom√°ticamente en la base de datos de metadatos.  En funci√≥n de los metadatos disponibles, estas funciones forman un archivo con una lista de nuevas funciones SQL para cada una de las tablas de origen para que posteriormente podamos llamarlas en el programa ejecutable.  El resultado de la ejecuci√≥n de las funciones generadas es la transferencia de los valores DDL, JSON o EDWEX al par√°metro de salida. <br><br>  Aqu√≠ es donde Python se conecta, con toda la funcionalidad ejecutable y las pruebas unitarias escritas.  Antes de comenzar cualquiera de los m√≥dulos para rodar artefactos utilizando pruebas unitarias, se verifica la transferencia de par√°metros correcta para ejecutar scripts de python.  Las pruebas no solo verifican la correcci√≥n de los par√°metros de entrada, sino tambi√©n su presencia en el m√≥dulo de metadatos, los tama√±os de los archivos creados y las fechas de su creaci√≥n.  Las pruebas tambi√©n controlan la cantidad de artefactos nuevos creados y la cantidad de artefactos existentes.  Por lo tanto, optimizamos el uso de los recursos del servidor, ya que solo tomamos nuevos archivos para rodar y no reinstalamos los modelos existentes nuevamente. <br><br>  Y solo despu√©s de pasar con √©xito todas las comprobaciones se ejecuta un programa de Python que crea los artefactos necesarios y descompone el resultado en las carpetas de proyecto necesarias en el servidor.  Python no solo dirige los archivos json generados a directorios, sino que tambi√©n forma estructuras en Data Lake para que los datos se carguen correctamente.  Al generar artefactos DDL, no solo se guardan para su posterior an√°lisis y reutilizaci√≥n, sino que tambi√©n se pueden instalar inmediatamente en la base de datos utilizando nuevos modelos y estructuras especificadas en el m√≥dulo de metadatos.  Esto le permite crear cientos de tablas en poco tiempo sin involucrar trabajo manual. <br><br><h2>  ¬øY d√≥nde est√° Jenkins aqu√≠? </h2><br>  Jenkins ingresa cuando es necesario administrar todos estos procesos visualmente usando una interfaz. <br><br>  Esta herramienta fue seleccionada porque: <br><br><ul><li>  cubre completamente las necesidades de automatizaci√≥n del ensamblaje y la instalaci√≥n <br></li><li>  le permite dise√±ar un mecanismo para ensamblar artefactos con la implementaci√≥n del proceso de autocomprobaci√≥n <br></li><li>  le permite administrar f√°cilmente los lanzamientos de trabajos y supervisar la ejecuci√≥n a una persona que est√° lejos de programar <br></li><li>  le permite configurar el mecanismo de registro de tal manera que el resultado de la ejecuci√≥n sea comprensible para cualquier persona del equipo.  El problema en el ensamblado se indicar√° expl√≠citamente o el proceso se completar√° con √©xito. <br></li></ul><br>  Para resolver las tareas, hemos creado varios proyectos de trabajo m√∫ltiple.  Este tipo de proyecto se ha utilizado, ya que puede funcionar en paralelo con otros trabajos en un solo inicio.  Cada trabajo es responsable de la implementaci√≥n de su bloque de funcionalidad.  As√≠ que reemplazamos el proceso secuencial de obtenci√≥n de artefactos por otros paralelos aut√≥nomos.  Todo comienza por separado: la formaci√≥n de EDWEX, JSON, DDL, la formaci√≥n de la estructura en HIVE, la instalaci√≥n de estructuras de tabla en la base de datos.  Analizamos el resultado en diferentes etapas de la formaci√≥n de artefactos y procedemos a lanzar acciones posteriores si tienen √©xito. <br><br>  La parte de Jenkins se implementa sin muchos trucos.  <b>Los</b> par√°metros de <b>cadena</b> o <b>ejecuci√≥n</b> se env√≠an a la entrada para iniciar el c√≥digo de Python.  <b>El</b> par√°metro <b>String</b> es una ventana para ingresar un valor de tipo str antes de comenzar.  <b>El</b> par√°metro de <b>ejecuci√≥n</b> se puede transferir sobre la marcha a otro trabajo para su ejecuci√≥n, para esto basta con indicar de qu√© proyecto es necesario tomar la variable recibida.  Adem√°s, se pasa un nodo como un par√°metro separado para la ejecuci√≥n.  Aqu√≠ se acaba de implementar la partici√≥n en tiempos de ejecuci√≥n en DEV, TST, UAT, PRD.  Se us√≥ un trabajo separado para transferir los archivos EDWEX recibidos a SVN con el n√∫mero de revisi√≥n para poder rastrear las versiones de las estructuras modificadas. <br><br>  Una interfaz de ejemplo en Jenkins: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00f/250/8c5/00f2508c5c04082a8b753041e471fe14.png"><br><br>  El resultado de la ejecuci√≥n del trabajo es la creaci√≥n e instalaci√≥n de los artefactos necesarios, su transferencia a SVN y la formaci√≥n de un informe HTML que muestra el √©xito de pasar las pruebas unitarias y los resultados del montaje e instalaci√≥n de los artefactos.  Los trabajos pueden ejecutarse individualmente con sus manos, o en modo autom√°tico, habiendo construido previamente una cadena de ejecuci√≥n. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/324/549/50f/32454950f7eb0476ca4cc753715c4472.png"><br>  <i>Arquitectura del mecanismo de montaje e instalaci√≥n</i> <br><br><h3>  Para resumir </h3><br>  Se ha trabajado mucho para automatizar la formaci√≥n de artefactos.  Anteriormente, ten√≠a que subir manualmente al servidor, ejecutar scripts de shell y luego estudiar y editar los datos durante mucho tiempo con las manos.  Ahora solo haga clic en el bot√≥n de inicio, especifique la ID del sistema de origen, el n√∫mero de modelo y el bucle de ejecuci√≥n.  Con la ayuda de Jenkins, fue posible estructurar y descomponer todo el mecanismo de montaje e instalaci√≥n de artefactos en etapas independientes.  Se agregaron los controles necesarios antes de comenzar la formaci√≥n de artefactos y su integraci√≥n.  Los artefactos recibidos se transfieren autom√°ticamente a SVN, lo que simplifica el trabajo con equipos relacionados de analistas de sistemas y modeladores de datos.  Los controles se implementan para evitar lanzamientos inactivos de formaci√≥n de artefactos y confirmar su correcci√≥n. <br><br>  Como resultado, redujimos el largo proceso de ensamblaje e instalaci√≥n de artefactos modelo de varias horas a un par de minutos.  Y lo m√°s importante, eliminaron la ocurrencia de errores debido al factor humano, que inevitablemente surgi√≥ en un proceso rutinario complejo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es428101/">https://habr.com/ru/post/es428101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es428089/index.html">"Calendario de prueba" para octubre. Comentarios: c√≥mo sucede</a></li>
<li><a href="../es428091/index.html">C√≥mo un estudiante interno cre√≥ el videojuego m√°s popular del mundo o el historial de juegos de Windows</a></li>
<li><a href="../es428095/index.html">Estudio de mercado para estudios web y agencias digitales.</a></li>
<li><a href="../es428097/index.html">Enrutamiento recursivo en MikroTik a trav√©s de puertas de enlace asignadas por DHCP</a></li>
<li><a href="../es428099/index.html">¬øQu√© tienen en com√∫n los vestidos comunes y la pr√≥xima era 5G?</a></li>
<li><a href="../es428103/index.html">Mitap en San Petersburgo: ingenier√≠a de datos y m√°s</a></li>
<li><a href="../es428105/index.html">Blogger recomienda: marketing de influencia</a></li>
<li><a href="../es428107/index.html">Contenedorizaci√≥n de aplicaciones Angular 6 SPA Template ASP .NET Core 2.1</a></li>
<li><a href="../es428109/index.html">Muro corporativo</a></li>
<li><a href="../es428111/index.html">Aritm√©tica de precisi√≥n arbitraria en Erlang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>