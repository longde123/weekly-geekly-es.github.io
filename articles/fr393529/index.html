<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❄️ 🌆 ♟️ Compteur de vitesse HUD - de l'idée au résultat 🤕 🤞🏻 👩🏻‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous! 
 Je n’ai rien écrit depuis longtemps, maintenant c’est plus une source d’information que pratique. Je vais essayer de régler la situa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Compteur de vitesse HUD - de l'idée au résultat</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393529/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonjour à tous! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n’ai rien écrit depuis longtemps, maintenant c’est plus une source d’information que pratique. </font><font style="vertical-align: inherit;">Je vais essayer de régler la situation. </font><font style="vertical-align: inherit;">Je vais vous parler du développement du compteur de vitesse HUD. </font><font style="vertical-align: inherit;">Bien qu'il ne s'agisse pas d'une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projection laser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il est abordable et compact. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Présentation</font></font></b><br>
  ,       3.3"  .    ,     .   4 ,   5,   .  ,         —  .      ,        .  ,       ,     (     ) —  1800.    (     ):<br>
1.      —    ,     ,    ,    - .  ,   —    .            .<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Vous ne pouvez pas coller le film, puis les nombres (ils sont assez petits) doublent, et rien n'est visible au soleil. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, le résultat n'est pas un film n'importe où dans le verre et même pendant la journée: </font></font><br>
<img src="https://habrastorage.org/files/ff6/b22/fc5/ff6b22fc52b64ef1b49e753cf85203ff.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sous la coupe, je promets beaucoup d'images, de vidéos médiocres, de code et de texte - le tout dans la meilleure tradition.</font></font><br>
<a name="habracut"></a><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Théorie</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
L'idée est simple - pour une période de temps fixe, nous comptons le nombre d'impulsions du capteur de vitesse. En tant que CPU, l'ATMega8 simple et abordable. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La première difficulté s'est avérée être la coordination du MK 5 V et des indicateurs 7,5 V. Fantasy a dessiné un schéma d'un empilement de transistors et résistances (7 éléments pour indication dynamique). De tous Google, un seul article m'a aidé à remplacer les indicateurs dans une montre, désolé d'avoir perdu son adresse. J'en profite pour exprimer ma gratitude à l'auteur pour l'idée d'utiliser TD62783 (à partir de 5 pièces par lot). En fait, il s'agit d'un pilote d'indicateur à sept segments, à l'intérieur d'un assemblage de transistor. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, un convertisseur DC / DC. Fabriqué sur le MC34063, j'en ai beaucoup, je les ai en stock. Je l'ai compté sur une calculatrice, je l'ai vérifié avec un testeur - 7,5 V. Dans les tests sur le terrain, il s'est avéré être un peu, la luminosité n'était pas suffisante, augmentée à 10 V.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La luminosité est ajustée en fonction des lectures du capteur de lumière, qui est une photorésistance chinoise ordinaire. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, le circuit s'est avéré comme suit: </font></font><br>
<img src="https://habrastorage.org/files/c2a/f7f/9a8/c2af7f9a87e44b3c8096cb226beff9b1.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entraînement J'ai</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
imprimé la carte de circuit imprimé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TopoR</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . J'ai utilisé le placement automatique, bien que j'ai corrigé la plupart des éléments manuellement. Mais le progrès doit fonctionner pour moi, et pas seulement pour le progrès. Il s'est avéré la beauté: </font></font><br>
<img src="https://habrastorage.org/files/ff6/75a/f61/ff675af611bb4a16988ef316f5efba70.png"> <img src="https://habrastorage.org/files/920/8e8/1a6/9208e81a60364c3ca3acba4b4041c5c4.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
avec la largeur du corps, U4 a raté, j'ai dû terminer les pistes et ne pas souder la 11e étape. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À quoi cela ressemble dans la vraie vie:</font></font><br>
<img src="https://habrastorage.org/files/30a/758/c18/30a758c18cc64043a5e8eff2bc50df12.jpg"><br>
<img src="https://habrastorage.org/files/5d8/fa2/1cf/5d8fa21cf4c04799878eebdbbd8918d8.jpg"><br>
<img src="https://habrastorage.org/files/a84/745/d1b/a84745d1b01644f0b37b8460c11d094e.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La prochaine personne inattendue s'est glissée dans le logiciel (je ne dirai pas comment j'ai oublié de mettre en miroir 2 et 5, 4 - il n'y a pas de quoi être fier). </font><font style="vertical-align: inherit;">Le problème était plus compliqué: le compteur comptait trop longtemps le nombre d'impulsions nécessaire. </font><font style="vertical-align: inherit;">Par exemple, à 60 km / h, compter 60 impulsions provenant d'un capteur de vitesse a pris plus d'une seconde. </font><font style="vertical-align: inherit;">Une mise à jour aussi rare du témoignage ne me convenait pas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai dû multiplier chaque étage de mesure par 2. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un changement linéaire de luminosité par rapport à l'éclairage ne convenait pas: quand il était légèrement plus sombre, la luminosité s'est avérée insuffisante, quand il était presque sombre, la luminosité était trop. </font><font style="vertical-align: inherit;">J'ai lancé Excel, construit un graphique pour différentes fonctions mathématiques. </font><font style="vertical-align: inherit;">En conséquence, j'ai choisi un carré. </font></font><br>
<img src="https://habrastorage.org/files/879/6f1/217/8796f12172ba4f0ba9d5cdd77da3e15e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code Bascom:</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texte masqué</font></font></b><div class="spoiler_text"><code>'HUD-speedometer<br>
'17/01/2016<br>
'21/01/2016<br>
'v1.1<br>
<br>
$regfile = "m8adef.dat"<br>
$crystal = 4000000<br>
$hwstack = 40<br>
$swstack = 16<br>
$framesize = 32<br>
<br>
Config Portb = Output<br>
Config Portc = Output<br>
Config Portd = Output<br>
Config Portd.4 = Input<br>
Portd.4 = 1<br>
Config Timer0 = Counter , Edge = Falling<br>
Config Timer1 = Pwm , Pwm = 8 , Compare_a_pwm = Clear_up , Compare_b_pwm = Clear_up , Prescale = 8<br>
Config Timer2 = Timer , Prescale = 1024<br>
On Timer2 Mytimer2<br>
Enable Interrupts<br>
Enable Timer2<br>
Config Adc = Single , Prescaler = Auto , Reference = Internal<br>
Start Adc<br>
<br>
Dim I As Byte '   <br>
Dim N As Byte '  <br>
Dim Pwm_value As Integer '<br>
Dim Speed As Integer , Speed_half As Integer , First_symbol As Integer , Second_symbol As Integer<br>
Dim A As Integer ' Speed  Speed_half<br>
Dim R1 As Word<br>
Declare Sub Digit_indication(digit As Integer) ' <br>
<br>
Const P = 500<br>
Const T = 5000 '   <br>
Const T1 = 1000 '    PWM<br>
Pwm_value = 5<br>
Tcnt0 = 0 '<br>
<br>
Do<br>
Incr I<br>
If I = 25 Then '   <br>
R1 = Getadc(7)<br>
R1 = Sqr(r1) ' <br>
R1 = R1 * 8<br>
If R1 &lt; 250 Then<br>
Pwm_value = 250 - R1<br>
Else<br>
Pwm_value = 3 ' <br>
End If<br>
I = 0<br>
End If<br>
Gosub Indication<br>
Loop<br>
<br>
Indication:<br>
If Speed &lt; 3 Then '  0 -  , 3 -   <br>
Pwm_value = 0<br>
End If<br>
While Speed &gt; 99 '..  2 <br>
Speed = Speed - 100<br>
Wend<br>
First_symbol = Speed / 10 ' <br>
Second_symbol = First_symbol * 10 '<br>
Second_symbol = Speed - Second_symbol ' <br>
Pwm1b = 0<br>
Pwm1a = 0<br>
Waitus T1 '  <br>
Call Digit_indication(first_symbol) '  <br>
Pwm1b = Pwm_value<br>
Waitus T<br>
Pwm1b = 0<br>
Pwm1a = 0<br>
Waitus T1 '  <br>
Call Digit_indication(second_symbol)<br>
Pwm1a = Pwm_value<br>
Waitus T<br>
Return<br>
<br>
Sub Digit_indication(digit As Integer)<br>
Select Case Digit<br>
Case 0:<br>
Portd.0 = 0<br>
Portc.0 = 1<br>
Portc.1 = 1<br>
Portc.2 = 1<br>
Portc.3 = 1<br>
Portc.4 = 1<br>
Portc.5 = 1<br>
Case 1:<br>
Portd.0 = 0<br>
Portc.0 = 1<br>
Portc.1 = 0<br>
Portc.2 = 0<br>
Portc.3 = 0<br>
Portc.4 = 0<br>
Portc.5 = 1<br>
Case 2:<br>
Portd.0 = 1<br>
Portc.0 = 0<br>
Portc.1 = 1<br>
Portc.2 = 1<br>
Portc.3 = 0<br>
Portc.4 = 1<br>
Portc.5 = 1<br>
Case 3:<br>
Portd.0 = 1<br>
Portc.0 = 1<br>
Portc.1 = 1<br>
Portc.2 = 0<br>
Portc.3 = 0<br>
Portc.4 = 1<br>
Portc.5 = 1<br>
Case 4:<br>
Portd.0 = 1<br>
Portc.0 = 1<br>
Portc.1 = 0<br>
Portc.2 = 0<br>
Portc.3 = 1<br>
Portc.4 = 0<br>
Portc.5 = 1<br>
Case 5:<br>
Portd.0 = 1<br>
Portc.0 = 1<br>
Portc.1 = 1<br>
Portc.2 = 0<br>
Portc.3 = 1<br>
Portc.4 = 1<br>
Portc.5 = 0<br>
Case 6:<br>
Portd.0 = 1<br>
Portc.0 = 1<br>
Portc.1 = 1<br>
Portc.2 = 1<br>
Portc.3 = 1<br>
Portc.4 = 1<br>
Portc.5 = 0<br>
Case 7:<br>
Portd.0 = 0<br>
Portc.0 = 1<br>
Portc.1 = 0<br>
Portc.2 = 0<br>
Portc.3 = 0<br>
Portc.4 = 1<br>
Portc.5 = 1<br>
Case 8:<br>
Portd.0 = 1<br>
Portc.0 = 1<br>
Portc.1 = 1<br>
Portc.2 = 1<br>
Portc.3 = 1<br>
Portc.4 = 1<br>
Portc.5 = 1<br>
Case 9:<br>
Portd.0 = 1<br>
Portc.0 = 1<br>
Portc.1 = 1<br>
Portc.2 = 0<br>
Portc.3 = 1<br>
Portc.4 = 1<br>
Portc.5 = 1<br>
End Select<br>
End Sub<br>
<br>
Mytimer2:<br>
Incr N<br>
If N = 26 Then<br>
N = 0<br>
Speed = Tcnt0 'Speed =    <br>
Tcnt0 = 0 '  <br>
End If<br>
If N = 13 Then '..      (  )<br>
Speed_half = Tcnt0 * 2 ' <br>
A = Speed - Speed_half<br>
A = A And &amp;B0111111111111111 '<br>
If A &gt; 2 Then<br>
Speed = Speed_half<br>
End If<br>
End If<br>
Timer2 = 135 ' 135 <br>
Return<br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À la fin de 135 - un facteur de correction, sélectionné pour chaque machine individuellement (135 pour Logan, pour Solaris c'était moins - tout le monde a des capteurs de vitesse différents). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La vidéo promise. Désolé pour la qualité, j'ai tiré sur un morceau de ruban électrique bleu d'une main, de l'autre j'ai roulé:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/s9eSjLEi_6M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les indicateurs ne s'allument pas lorsque la vitesse est inférieure à 3 km / h. </font><font style="vertical-align: inherit;">Si la vitesse est supérieure à 99, s'affiche alors sans le premier caractère. </font></font><br>
 <br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Budget:</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
ATMega8 - 200 rub pour 5 pcs - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
40 rub Indicators - 825 rub pour 10 pcs - 165 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rub </font><font style="vertical-align: inherit;">TD62783 - 250 </font><font style="vertical-align: inherit;">rub pour 5 pcs - </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
50 rub Le reste des trucs en vrac que j'avais, mais en général, il est clair que vous pouvez rester dans les 500 rub. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il n'y a plus rien à dire. </font><font style="vertical-align: inherit;">Il s'est avéré un grand beau comptoir. </font><font style="vertical-align: inherit;">Testé sur Solaris. </font><font style="vertical-align: inherit;">La mise au point a échoué, la mise au point n'avait pas de capteur de vitesse. </font><font style="vertical-align: inherit;">Je terminerai le programme de travail avec OBD2 via ELM327. </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dossier de projet sur Yandex.Disk</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Merci à tous pour votre attention!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr393529/">https://habr.com/ru/post/fr393529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr393517/index.html">Религия, суеверия и космос</a></li>
<li><a href="../fr393521/index.html">Après cinq jours de compilation, Gentoo Linux installé sur le Tesla Model S</a></li>
<li><a href="../fr393523/index.html">Варианты компенсации даунтаймов от Google и Telstra</a></li>
<li><a href="../fr393525/index.html">Very Large Telescope a encore plus de fonctionnalités</a></li>
<li><a href="../fr393527/index.html">Le premier drone asymétrique au monde avec une seule pièce mobile</a></li>
<li><a href="../fr393533/index.html">Aux États-Unis, a commencé à tester le plus grand navire sans pilote du monde "Sea Hunter"</a></li>
<li><a href="../fr393535/index.html">4xiDraw: un stylo traceur maison sur Arduino</a></li>
<li><a href="../fr393539/index.html">Lancez Nextion Editor 0.34 sous Wine</a></li>
<li><a href="../fr393543/index.html">Revue Homey, projet de balle intelligente Athom Kickstarter</a></li>
<li><a href="../fr393549/index.html">Le nouveau filtre peut sauver le propriétaire du modèle X en cas d'utilisation d'armes biologiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>