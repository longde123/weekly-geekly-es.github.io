<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ– ğŸ™†ğŸ» ğŸ“… Ketika saya menulis bot untuk sekolah d / z dan mengubah database ğŸšï¸ ğŸ¬ ğŸ“¯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, warga negara Khabrovsk! 
 Hari ini saya akan mencoba memberi tahu Anda bagaimana seorang siswa dapat menulis bot untuk menyimpan pekerjaan rumah...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ketika saya menulis bot untuk sekolah d / z dan mengubah database</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475406/">  Halo, warga negara Khabrovsk! <br>  Hari ini saya akan mencoba memberi tahu Anda bagaimana seorang siswa dapat menulis bot untuk menyimpan pekerjaan rumah untuk VK. <br><div class="spoiler">  <b class="spoiler_title">Perhatian</b> <div class="spoiler_text">  Saya akan segera menarik perhatian pada kenyataan bahwa untuk proyek-proyek serius tidak <b>mungkin untuk</b> membangun infrastruktur seperti <b>ini</b> , seluruh proyek ini dibuat hanya untuk hiburan dan penghancuran waktu, dan untuk presentasi di semua jenis konferensi proyek sekolah. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Komentar</b> <div class="spoiler_text">  11/17/2019 15:55 <br>  Mereka menulis kepada saya dalam pesan pribadi bahwa di seluruh artikel itu tidak terlalu jelas apa pekerjaan rumah yang mereka bicarakan. <br>  Saya akan segera mengklarifikasi bahwa semua tugas yang saya bicarakan dalam artikel diisi seperti dalam buku harian biasa, dan tugas-tugas lama "menghilang". <br>  Ini adalah bagaimana pengguna menerima tugas-tugas yang harus dia lakukan. <br></div></div><br><a name="habracut"></a><br>  Bot ditulis dalam PHP, dan demi percobaan saya memutuskan untuk menerima pembaruan tidak menggunakan webhooks CallBack API, tetapi menggunakan LongPoll. <br><br>  Karena fakta bahwa saya tidak pernah menulis bot menggunakan metode ini untuk menerima pembaruan, saya tersiksa oleh keraguan samar-samar tentang apakah saya bisa menulis bot ini dalam PHP, tetapi pada akhirnya semuanya berhasil.  Sekarang saya akan beralih ke bagaimana ide saya muncul dan bagaimana saya menerapkannya. <br><br>  Yang pertama, secara umum, adalah ide untuk menulis bot untuk menyimpan pekerjaan rumah di dalamnya.  Nah, bagaimana cara menyimpannya.  Sesuatu seperti catatan, tetapi di dalam VK, karena saya jarang masuk ke catatan, dan itu tidak nyaman bagi saya. <br><br>  Untuk menerapkan bot dangkal dengan pekerjaan rumah, saya membuat satu tabel dalam database, di mana nama item, pekerjaan rumah itu sendiri dan jumlah semua kebahagiaan ini ditetapkan.  Ini tidak terlalu menarik untuk dijelaskan, jadi saya akan menghilangkan poin ini, tetapi saya akan memberikan diagram ER yang <b>kuat</b> tentang bagaimana database terlihat di awal. <br><br><img src="https://habrastorage.org/webt/sk/3g/sy/sk3gsyi4l-6vtzd5kdjnlejkvdk.png" alt="gambar"><br><br>  Lalu saya berpikir, mengapa tidak memberi orang lain kesempatan untuk menggunakan bot.  Yah, dia memberi orang kesempatan ini.  Saya mengubah database sedikit, tetapi tabel di mana semua ini berputar hampir tidak berubah. <br><br><img src="https://habrastorage.org/webt/hp/2g/1z/hp2g1ztbmrfih30qdnvlzifncfo.png" alt="gambar"><br><br>  Dari bagan ER, Anda dapat memahami bahwa setiap pengguna milik grup.  Pintu masuk ke grup yang ada dilakukan oleh token, dan untuk setiap yang baru dihasilkan token yang unik.  Dan tugas itu sendiri juga milik satu atau kelompok lain, sehingga pengguna tidak melihat kekacauan dari tugas mereka dan orang lain. <br><br>  Saya menambahkan kode, tidak ada yang menarik di sini, pada prinsipnya, tidak.  Saya baru saja membuatnya sehingga tugas-tugas lama tidak akan muncul, agar tidak menghapus semuanya secara manual, tetapi, saya pikir, menulis kueri SELECT dalam SQL cukup sederhana. <br><br>  Dan sekarang saatnya untuk bersenang-senang: Saya mulai menambahkan fungsi yang akan memperlambat keseluruhan antrian pesan, jadi saya memutuskan untuk meletakkannya di skrip yang terpisah, karena saya tidak dapat melakukan multithread saat ini, tetapi saya memilih LongPoll.  (Dan apakah ada penggunaan PHP seperti itu?) <br><br>  Dan fungsi-fungsi ini: mengirim pesan ke semua anggota grup dan menghasilkan kode QR di mana kunci untuk bergabung dengan grup dienkripsi. <br><br>  Untuk melakukan ini, saya baru saja membuat tabel lain dalam database, di mana saya memasukkan teks pengiriman dan kepada siapa itu dimaksudkan.  Basis akhirnya mengambil formulir ini. <br><br><img src="https://habrastorage.org/webt/6x/mq/jf/6xmqjfitgts3nq1lbig1s1trnvc.png" alt="gambar"><br><br>  Dan pembuatan kode QR umumnya dibuat dalam proses terpisah, yang juga menerima pembaruan dari VK tentang pesan keluar, dan melihat pesan mana yang berisi kunci ke grup. <br><br>  Sejauh ini, semuanya terlihat kurang lebih memadai, tetapi kemudian saya memutuskan model relasional dengan memasukkan JSON ke dalam basis data. <br><br>  JSON apa yang bisa saya masukkan ke dalam database?  Saya memasukkan parameter lampiran, yang saya terima dari VK, dan kemudian memprosesnya saat mengirim pesan, agar tidak memuat proses utama. <br><br>  Hasilnya, semuanya terlihat seperti ini. <br><br><img src="https://habrastorage.org/webt/ml/a_/vp/mla_vppfg08h4cou--uneka3z4u.png" alt="gambar"><br><br>  Tentang metode yang sama, maka saya menambahkan lampiran file ke tugas di bot.  Tugas ditambahkan segera, dan file-file tersebut secara bertahap dilampirkan jika sesuai dengan format dan sesuai dengan ukuran untuk Telegram Bot Api.  Saya mengunggah file ke Telegram melalui sekelompok bot dan menyimpan id file. <br><br>  Saya menyimpan file-file di Telegram karena fakta bahwa server tempat saya menyimpan semua ini tidak memiliki banyak ruang, dan memperluas bagi saya sangat sulit secara finansial. <br><br>  Seluruh database mulai terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/3o/xg/06/3oxg064z6msqhghzfghsxnsdcts.png" alt="gambar"><br><br>  Tapi sekarang saya punya tugas: bagaimana saya akan mengembalikan file kepada pengguna?  Lalu saya membuat logika yang hampir sama dengan penambahan file. <br><br><img src="https://habrastorage.org/webt/xl/tn/tc/xltntc1ylqfgiekbjllxphe0-78.png" alt="gambar"><br><br>  Kemudian bot lain ditambahkan untuk Cart, tapi saya belum akan menjelaskannya. <br><br>  Pada dasarnya, saya pikir struktur basis datanya tidak buruk, tetapi saya tidak suka sesuatu di sini.  Mungkin akan berguna bagi beberapa pendatang baru untuk melihat bagaimana Anda dapat merancang struktur basis data selama pengembangan ide, dan akan menarik bagi saya untuk mendengarkan kritik pada organisasi basis saya dan mengambil sesuatu untuk digunakan. <br><br>  Artikel ini kecil, tetapi dapat menurunkan kritik. <br><div class="spoiler">  <b class="spoiler_title">Klats 1</b> <div class="spoiler_text">  "Penuh sampai jam 5 sore di mejaku!" <br>  Saya akan memposting semua kode sumber bot pada git setelah membela proyek, dan bukan dosa menulis artikel. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Klats 2</b> <div class="spoiler_text">  Beberapa ide yang berhubungan dengan bekerja dengan file disarankan kepada saya dalam obrolan Habr di gerobak, saya sering terlihat di sana. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Klats 3</b> <div class="spoiler_text">  Anda dapat menyodok bot langsung di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Saya akan dengan senang hati memberikan umpan balik. <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id475406/">https://habr.com/ru/post/id475406/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id475390/index.html">Cara membuat aplikasi web pertama Anda menggunakan Go</a></li>
<li><a href="../id475392/index.html">Mengapa menggunakan python -m pip</a></li>
<li><a href="../id475396/index.html">Apa yang penuh dengan penonaktifan cek "tidak perlu" dalam CAD papan sirkuit tercetak</a></li>
<li><a href="../id475398/index.html">Acara digital di Moskow dari 11-17 November</a></li>
<li><a href="../id475400/index.html">Acara digital di St. Petersburg dari 11-17 November</a></li>
<li><a href="../id475408/index.html">Fitur pembayaran pajak oleh pekerja lepas IT wiraswasta</a></li>
<li><a href="../id475416/index.html">AI dalam SOC-nya sendiri: lakukan impian para kepala pusat pemantauan serangan-cyber analitik elektrik</a></li>
<li><a href="../id475418/index.html">Diskusi: mengapa hosting video populer semakin menghapus konten dengan panduan peretas</a></li>
<li><a href="../id475420/index.html">Bagaimana cara kerja peluru di video game?</a></li>
<li><a href="../id475424/index.html">Terbang dengan dosimeter di saku Anda</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>