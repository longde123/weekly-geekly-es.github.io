<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìï üõí üí≤ Apresentando o PHP 7.4: Desempenho, Recursos, Descontinua√ß√µes ü§ö üß§ üìû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O que o PHP 7.4 significa para voc√™? 
 O PHP evolui continuamente e eles lan√ßaram sua √∫ltima atualiza√ß√£o do PHP 7.4, cheia de novos recursos. Como j√° ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apresentando o PHP 7.4: Desempenho, Recursos, Descontinua√ß√µes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483128/"><h2>  O que o PHP 7.4 significa para voc√™? </h2><br>  O PHP evolui continuamente e eles lan√ßaram sua √∫ltima atualiza√ß√£o do PHP 7.4, cheia de novos recursos.  Como j√° provamos nas vers√µes anteriores do PHP 7 - o desempenho e a velocidade continuam avan√ßando.  Um dos novos recursos mais interessantes √© o <b>pr√©</b> - <b>carregamento</b> .  Ele acelera a execu√ß√£o do script e introduz a capacidade de ter um c√≥digo mais r√°pido e limpo, devido √†s linhas comuns de c√≥digo simplificadas. <br><br>  Os respons√°veis ‚Äã‚Äãpelo PHP levaram em considera√ß√£o os coment√°rios e solicita√ß√µes da audi√™ncia e os responderam perfeitamente.  Desde ent√£o, eles mudam continuamente o c√≥digo para serem mais intuitivos e mais confort√°veis ‚Äã‚Äãpara alternar entre linguagens de programa√ß√£o. <br><br>  O PHP √© usado em mais de 78,9% de todos os sites.  Segundo a <b><a href="https://w3techs.com/technologies/details/pl-php">W3techs</a></b> , os sites mais populares que usam PHP s√£o Wikipedia, Pinterest e Facebook, para citar alguns. <br><br>  Se olharmos explicitamente para sites WordPress executando PHP, comparando o PHP 5 e 7, podemos ver um aumento de velocidade dupla.  Os sites com WordPress ganham mais ao usar a vers√£o mais recente do PHP. <br><br><img src="https://habrastorage.org/webt/mv/aq/7i/mvaq7ifytdcg65bytr9gmxim9ri.png" alt="imagem"><br><a name="habracut"></a><br>  Este gr√°fico ilustra a verdade sobre sites que usam ativamente PHP.  S√£o <b><a href="https://trends.builtwith.com/websitelist/PHP">40 mln.</a></b>  sites ao vivo o suficiente para chamar sua aten√ß√£o?  √â assim que muitos est√£o usando PHP no momento.  Al√©m disso, o PHP 7.4 j√° est√° apresentando melhores resultados de teste que o PHP 7.3, com melhor desempenho e outras atualiza√ß√µes de qualidade de vida. <br><br>  O gr√°fico abaixo mostra o <b><a href="https://www.phoronix.com/scan.php%3Fpage%3Darticle%26item%3Dphp-74-benchmarks%26num%3D1">teste de benchmark</a></b> geral nas vers√µes novas e antigas do PHP.  Alguns dos crit√©rios testados foram facilidade de uso, velocidade e desempenho, entre outros. <br><br><img src="https://habrastorage.org/webt/yc/pa/rn/ycparnhmqt8bezuoxtfdi_y_veo.png" alt="imagem"><br><br><h2>  O que h√° de novo no PHP 7.4? </h2><br>  Desde 2016, o PHP7 lan√ßa atualiza√ß√µes anuais sem falhas.  A cada ano, eles oferecem novos recursos, adi√ß√µes e a possibilidade de escrever um c√≥digo mais limpo, que torna o idioma mais confi√°vel e f√°cil de usar para quem o executa em seus sites. <br><br>  Vamos nos aprofundar e dar uma olhada em algumas das mudan√ßas que foram feitas com a adi√ß√£o do PHP 7.4.  Para uma lista completa, confira o changelog <b><a href="https://www.php.net/manual/en/migration74.php">aqui</a></b> . <br><br><h3>  Pr√©-carregamento </h3><br>  Vamos falar sobre c√≥digo.  Ao usar uma estrutura ou bibliotecas, seus arquivos precisam ser carregados e vinculados a cada solicita√ß√£o.  O pr√©-carregamento √© quando voc√™ pode carregar estruturas e bibliotecas no OPCache.  Ele permite que o servidor carregue os arquivos PHP e os armazene na mem√≥ria durante a inicializa√ß√£o e os disponibilize para solicita√ß√µes futuras.  Fale sobre fazer as coisas correrem r√°pido! <br><br>  O pr√©-carregamento √© executado por uma diretiva <b>php.ini</b> espec√≠fica: <b>opcache.preload</b> .  Este possui o compilador de scripts PHP e √© executado quando o servidor √© iniciado.  Tamb√©m pode ser usado para pr√©-carregar mais arquivos e optar por inclu√≠-los ou compil√°-los. <br><br>  Isso √© demais.  No entanto, se a origem dos arquivos pr√©-carregados for alterada, o servidor dever√° ser reiniciado.  Os arquivos pr√©-carregados tamb√©m permanecem em cache na mem√≥ria do OPCache para sempre. <br>  No entanto, esses arquivos pr√©-carregados continuar√£o dispon√≠veis para solicita√ß√µes futuras, caso voc√™ precise us√°-los novamente. <br><br><h3>  Operador de propaga√ß√£o em express√µes de matriz </h3><br>  Quando o PHP 5.6 foi lan√ßado, o PHP come√ßou a suportar a descompacta√ß√£o de argumentos (operador de propaga√ß√£o), mas agora, com a 7.4, podemos usar esse recurso com uma express√£o de matriz.  A descompacta√ß√£o de argumentos √© uma sintaxe para descompactar matrizes e Traversables em listas de argumentos.  E, para fazer isso, ele s√≥ precisa ser precedido por ... (3 pontos). √â isso. <br><br>  Vejamos este exemplo: <br><br><pre><code class="php hljs">$animals = [<span class="hljs-string"><span class="hljs-string">'dog'</span></span>, <span class="hljs-string"><span class="hljs-string">'cat'</span></span>]; $animalkingdom = [<span class="hljs-string"><span class="hljs-string">'lion'</span></span>, <span class="hljs-string"><span class="hljs-string">'elephant'</span></span>, ...$animals, <span class="hljs-string"><span class="hljs-string">'giraffe'</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// ['lion', 'elephant', 'dog', 'cat', 'giraffe'];</span></span></code> </pre> <br>  Agora podemos expandir uma matriz de qualquer lugar que desejemos em outra matriz, simplesmente usando a sintaxe do operador de propaga√ß√£o. <br><br>  Aqui est√° um exemplo mais longo: <br><br><pre> <code class="php hljs">$num1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; $num2 = [...$num1]; <span class="hljs-comment"><span class="hljs-comment">// [1, 2, 3] $num3 = [0, ...$num1]; // [0, 1, 2, 3] $num4 = array(...$num1, ...$num2, 111); // [1, 2, 3, 1, 2, 3, 111] $num5 = [...$num1, ...$num1]; // [1, 2, 3, 1, 2, 3]</span></span></code> </pre> <br>  N√£o apenas isso, mas voc√™ tamb√©m pode us√°-lo em uma fun√ß√£o.  Confira este exemplo: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>]; } $num6 = [...getNum(), <span class="hljs-string"><span class="hljs-string">'c'</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// ['a', 'b', 'c'] $num7 = [...new NumIterator(['a', 'b', 'c'])]; // ['a', 'b', 'c'] function arrGen() { for($i = 11; $i &lt; 15; $i++) { yield $i; } } $num8 = [...arrGen()]; // [11, 12, 13, 14]</span></span></code> </pre> <br>  Al√©m disso, agora voc√™ pode descompactar matrizes e geradores retornados por uma fun√ß√£o diretamente em uma nova matriz. <br><br>  Um exemplo de c√≥digo ficaria assim: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAnimals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-string"><span class="hljs-string">'dog'</span></span>, <span class="hljs-string"><span class="hljs-string">'cat'</span></span>, <span class="hljs-string"><span class="hljs-string">'elephant'</span></span>]; } $num1 = [...getAnimals(), <span class="hljs-string"><span class="hljs-string">'lion'</span></span>, <span class="hljs-string"><span class="hljs-string">'tiger'</span></span>, <span class="hljs-string"><span class="hljs-string">'giraffe'</span></span>];</code> </pre> <br>  E com o PHP 7.4, ele imprimiria: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) { [<span class="hljs-number"><span class="hljs-number">0</span></span>]=&gt; string(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-string"><span class="hljs-string">"dog"</span></span> [<span class="hljs-number"><span class="hljs-number">1</span></span>]=&gt; string(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-string"><span class="hljs-string">"cat"</span></span> [<span class="hljs-number"><span class="hljs-number">2</span></span>]=&gt; string(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-string"><span class="hljs-string">"elephant"</span></span> [<span class="hljs-number"><span class="hljs-number">3</span></span>]=&gt; string(<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-string"><span class="hljs-string">"lion"</span></span> [<span class="hljs-number"><span class="hljs-number">4</span></span>]=&gt; string(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-string"><span class="hljs-string">"tiger"</span></span> [<span class="hljs-number"><span class="hljs-number">5</span></span>]=&gt; string(<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-string"><span class="hljs-string">"giraffe"</span></span> }</code> </pre> <br>  Com essa nova express√£o de matriz, os operadores de spread devem ter um desempenho muito melhor em rela√ß√£o ao 7.3 array_merge.  Isso ocorre porque o operador spread √© uma estrutura de linguagem, enquanto array_merge √© uma fun√ß√£o.  Tamb√©m porque o operador spread suporta objetos implementando traversable e array_merge suporta apenas matrizes. <br><br>  Algumas coisas importantes a serem observadas, voc√™ s√≥ pode usar matrizes indexadas, pois as chaves de sequ√™ncia n√£o s√£o suportadas.  Se usado, um erro recuper√°vel ser√° exibido na tela, assim que uma chave de cadeia for encontrada. <br>  Outro benef√≠cio glorioso para o 7.4 √© a remo√ß√£o do array_merge.  Diga adeus √† temida mudan√ßa de √≠ndice! <br><br>  Por exemplo, vejamos essa longa matriz de mesclagem abaixo: <br><br><pre> <code class="php hljs">$array = [<span class="hljs-string"><span class="hljs-string">'banana, '</span></span>orange<span class="hljs-string"><span class="hljs-string">']; $array[2] = '</span></span>orange<span class="hljs-string"><span class="hljs-string">'; $array[1] = '</span></span>apple<span class="hljs-string"><span class="hljs-string">'; //shifting var_dump($array); // prints array(3) { [0]=&gt; string(6) "banana" [1]=&gt; string(5) "apple" [2]=&gt; string(6) "orange"</span></span></code> </pre> <br>  Outro benef√≠cio do 7.4 √© usar a fun√ß√£o de gerador.  Uma fun√ß√£o de gerador funciona exatamente como uma fun√ß√£o normal, exceto que, em vez de retornar um valor, uma <b><a href="https://www.php.net/manual/en/language.generators.syntax.php">fun√ß√£o de gerador</a></b> gera tantos valores quanto necess√°rio. <br><br>  Confira o c√≥digo de exemplo abaixo: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">3</span></span>; $i &lt;= <span class="hljs-number"><span class="hljs-number">5</span></span>; $i++) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> $i; } } $num1 = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ...generator()];</code> </pre> <br><h3>  Refer√™ncias fracas </h3><br>  Agora, o PHP 7.4 tem uma classe WeakReference, que n√£o deve ser confundida com a classe <b>WeakRed</b> ou a extens√£o <b>Weakref</b> . <br><br>  <b>As WeakReferences</b> permitem que o programador recupere uma refer√™ncia a um objeto.  Isso √© √∫til porque n√£o impede que o objeto seja destru√≠do.  Eles s√£o √∫teis para implementar o cache como estruturas. <br><br><pre> <code class="php hljs">WeakReference { <span class="hljs-comment"><span class="hljs-comment">/* Methods */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> __construct ( void ) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> create ( object $referent ) : WeakReference <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> get ( void ) : ?object }</code> </pre> <br><h3>  Par√¢metros Contravariantes e Devolu√ß√µes Covariantes </h3><br>  Atualmente, o PHP usa principalmente tipos de par√¢metros invariantes e tipos de retorno.  Ou seja, se um m√©todo tiver um par√¢metro ou tipo de retorno X, o par√¢metro de subtipo ou tipo de retorno tamb√©m dever√° ser do tipo <b>X.</b> <br><br>  Agora, com o PHP 7.4, ele prop√µe permitir <b>covari√¢ncia</b> (ordenada de espec√≠fica para gen√©rica) e <b>contravariante</b> (reverter a ordem) nos tipos de par√¢metro e retorno. <br><br>  Aqui est√° um exemplo de ambos: <br><br>  Exemplo de tipo de retorno covari√°vel: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Factory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">object</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserFactory</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Factory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span></span>; }</code> </pre> <br>  Exemplo de tipo de par√¢metro contravariante: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Concatable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">concat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Iterator $input)</span></span></span></span>; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Collection</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Concatable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// accepts all iterables, not just Iterator function concat(iterable $input) {/* . . . */} }</span></span></code> </pre> <br><h3>  Propriedades digitadas 2.0 </h3><br>  Desde o PHP 5, as dicas de tipo t√™m sido um recurso dispon√≠vel, permitindo que voc√™ especifique o tipo de vari√°vel que deve ser passado para uma fun√ß√£o ou classe.  Nas migra√ß√µes do PHP 7.2, a adi√ß√£o do tipo de dados do objeto deu esperan√ßas de que mais estivessem dispon√≠veis no futuro.  O futuro √© agora. <br><br>  No novo 7.4, o PHP √© capaz de suportar a seguinte lista de tipos: <br><br><pre> <code class="php hljs">bool, int, float, string, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>, object, iterable, <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span> any <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">or</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> ?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class"> // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">may</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">be</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">of</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">the</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">above</span></span></span></span></code> </pre> <br>  Observe que o tipo <b>pai</b> pode ser usado em classes e n√£o precisa ter um pai consistente com o par√¢metro e o tipo de retorno. <br><br>  Al√©m disso, observe que o <b>cancelamento</b> e a <b>chamada</b> n√£o s√£o suportados.  <b>O v√°cuo</b> foi removido porque n√£o era √∫til e tinha sem√¢ntica pouco clara;  <b>Pode ser chamado</b> , porque seu comportamento depende do contexto. <br><br>  Vamos conferir mais alguns exemplos. <br><br>  Aqui est√° uma classe, escrita para o PHP 7.3: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> int $id */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $id; <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string $name */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id, string $name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;id = $id; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name = $name; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;id; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;id = $id; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $name)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name = $name; } }</code> </pre> <br>  No PHP 7.4, sem sacrificar nenhuma seguran√ßa de tipo, uma classe agora pode ser escrita t√£o simples quanto: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int $id; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string $name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $id, string $name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;id = $id; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name = $name; } }</code> </pre><br>  Aqui est√£o alguns exemplos de todos os tipos que o 7.4 suporta agora: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Example</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int $scalarType; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> ClassName $classType; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ?ClassName $nullableClassType; <span class="hljs-comment"><span class="hljs-comment">// Types are also legal on static properties public static iterable $staticProp; // Types can also be used with the "var" notation var bool $flag; // Typed properties may have default values (more below) public string $str = "foo"; public ?string $nullableStr = null; // The type applies to all properties in one declaration public float $x, $y; // equivalent to: public float $x; public float $y; }</span></span></code> </pre> <br><h3>  Fun√ß√µes de seta 2.0 </h3><br>  Fun√ß√µes an√¥nimas no PHP tendem a ser longas e extensas, mesmo quando est√£o executando apenas opera√ß√µes simples.  Isso ocorre parcialmente devido a uma grande quantidade de clich√™ sint√°tico e parcialmente devido √† necessidade de importar manualmente as vari√°veis ‚Äã‚Äãusadas. <br><br>  Isso torna o c√≥digo que usa fechamentos simples confuso para ler e ainda mais dif√≠cil de entender. <br><br>  Vamos dar uma olhada em algum c√≥digo que voc√™ usaria no PHP 7.3: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array_values_from_keys</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($arr, $keys)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array_map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($arr)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $arr[$x]; }, $keys); }</code> </pre> <br>  Agora, aqui est√° a sintaxe mais concisa do PHP 7.4: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array_values_from_keys</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($arr, $keys)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array_map(fn($x) =&gt; $arr[$x], $keys); }</code> </pre> <br>  Portanto, as fun√ß√µes de seta agora t√™m este formato simples: <br><br><pre> <code class="php hljs">fn(parameter_list) =&gt; expr</code> </pre> <br>  Abaixo voc√™ pode ver um exemplo de duas fun√ß√µes $ fn1 (7.3) e $ fn2 (7.4) lado a lado.  Eles t√™m o mesmo resultado, mas parecem diferentes: <br><br><pre> <code class="php hljs">$y = <span class="hljs-number"><span class="hljs-number">1</span></span>; $fn1 = fn($x) =&gt; $x + $y; $fn2 = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $x + $y; };</code> </pre> <br>  Isso tamb√©m funcionar√° se as fun√ß√µes de seta estiverem aninhadas: <br><br><pre> <code class="php hljs">$z = <span class="hljs-number"><span class="hljs-number">1</span></span>; $fn = fn($x) =&gt; fn($y) =&gt; $x * $y + $z;</code> </pre><br>  Aqui, a fun√ß√£o externa captura <b>$ z</b> .  Ent√£o, a fun√ß√£o interna tamb√©m captura $ z da fun√ß√£o externa.  Com 7.4, o escopo externo pode se tornar dispon√≠vel na fun√ß√£o interna.  Isso √© algo que 7.3 n√£o foi capaz de fazer. <br><br>  A sintaxe da fun√ß√£o de seta permite uma variedade de fun√ß√µes, como vari√°veis, valores padr√£o, par√¢metros e tipos de retorno, bem como passagem e retorno por refer√™ncia.  Tudo isso mantendo um visual limpo e leg√≠vel.  Abaixo est√£o todas as fun√ß√µes de seta v√°lidas agora dispon√≠veis: <br><br><pre> <code class="php hljs">fn(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span> $x) =&gt; $x; fn(): int =&gt; $x; fn($x = <span class="hljs-number"><span class="hljs-number">42</span></span>) =&gt; $x; fn(&amp;$x) =&gt; $x; fn&amp;($x) =&gt; $x; fn($x, ...$rest) =&gt; $rest;</code> </pre> <br>  Uma coisa a notar √© que as fun√ß√µes de seta t√™m a menor preced√™ncia.  Veja o exemplo: <br><br><pre> <code class="php hljs">fn($x) =&gt; $x + $y <span class="hljs-comment"><span class="hljs-comment">// is fn($x) =&gt; ($x + $y) // not (fn($x) =&gt; $x) + $y</span></span></code> </pre> <br><h2>  Depreca√ß√µes </h2><br>  H√° muitas obsoletas acontecendo com a mesclagem para 7.4.  A lista a seguir √© uma breve vis√£o geral das fun√ß√µes direcionadas √† deprecia√ß√£o.  Voc√™ pode encontrar uma explica√ß√£o mais detalhada <b><a href="https://wiki.php.net/rfc/deprecations_php_7_4">aqui</a></b> : <br><br><ul><li>  O tipo <b>real</b> </li><li>  Legendas de cita√ß√µes m√°gicas </li><li>  <b>array_key_exists ()</b> com objetos </li><li>  Filtro <b>FILTER_SANITIZE_MAGIC_QUOTES</b> </li><li>  M√©todos de <b>exporta√ß√£o de</b> reflex√£o <b>()</b> </li><li>  <b>mb_strrpos ()</b> com codifica√ß√£o como terceiro argumento </li><li>  mix de ordem dos par√¢metros <b>implode ()</b> </li><li>  Desvinculando <b>$ this</b> de fechamentos n√£o est√°ticos </li><li>  <b>Fun√ß√£o hebrevc ()</b> </li><li>  fun√ß√£o <b>convert_cyr_string ()</b> </li><li>  fun√ß√£o <b>money_format ()</b> </li><li>  fun√ß√£o <b>ezmlm_hash ()</b> </li><li>  r fun√ß√£o <b>estore_include_path ()</b> </li><li>  <b>allow_url_include</b> ini directiv </li></ul><br>  Alguns pontos importantes a serem observados s√£o as seguintes depreca√ß√µes em duas etapas. <br><br><h3>  Alterando a preced√™ncia de um operador de concatena√ß√£o </h3><br>  Atualmente, a preced√™ncia dos operadores '.', '+' And '-' √© igual.  Qualquer combina√ß√£o desses operadores ser√° simplesmente resolvida da esquerda para a direita. <br><br>  Vamos dar uma olhada neste c√≥digo no PHP 7.3: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"sum: "</span></span> . $a + $b; <span class="hljs-comment"><span class="hljs-comment">// would be evaluated left-to-right echo ("sum: " . $a) + $b; // could also look like this</span></span></code> </pre> <br>  No PHP 7.4, '+' e '-' teriam preced√™ncia sobre '.'  portanto, as adi√ß√µes e subtra√ß√µes sempre seriam realizadas antes da string.  Seria o seguinte: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"sum: "</span></span> . $a + $b; <span class="hljs-comment"><span class="hljs-comment">// would be executed as if the code were as follows. echo "sum :" . ($a + $b);</span></span></code> </pre> <br>  Esta proposta em duas etapas visa ser menos propensa a erros e mais instintiva.  Atualmente, o PHP 7.4 est√° no primeiro est√°gio com um aviso de descontinua√ß√£o de express√µes sem par√™nteses de '+', '-' e '.'  Enquanto aguarda a vota√ß√£o / mudan√ßa final acontecendo no PHP 8. <br><br><h3>  Operador tern√°rio associativo de esquerda </h3><br>  Diferentemente da maioria das outras linguagens, o operador tern√°rio no PHP √© associativo √† esquerda, em vez de associativo √† direita.  Al√©m de incomum, tamb√©m √© confuso para programadores que alternam entre idiomas diferentes.  O PHP 7.4 prop√µe remover a associatividade esquerda e requer o uso de par√™nteses. <br><br>  Vamos dar uma olhada no c√≥digo abaixo: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $a == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-string"><span class="hljs-string">'one'</span></span> : $a == <span class="hljs-number"><span class="hljs-number">2</span></span> ? <span class="hljs-string"><span class="hljs-string">'two'</span></span> : $a == <span class="hljs-number"><span class="hljs-number">3</span></span> ? <span class="hljs-string"><span class="hljs-string">'three'</span></span> : $a == <span class="hljs-number"><span class="hljs-number">4</span></span> ? <span class="hljs-string"><span class="hljs-string">'four'</span></span> : <span class="hljs-string"><span class="hljs-string">'other'</span></span>;</code> </pre> <br>  Na maioria dos outros idiomas, seria interpretado como: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $a == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-string"><span class="hljs-string">'one'</span></span> : ($a == <span class="hljs-number"><span class="hljs-number">2</span></span> ? <span class="hljs-string"><span class="hljs-string">'two'</span></span> : ($a == <span class="hljs-number"><span class="hljs-number">3</span></span> ? <span class="hljs-string"><span class="hljs-string">'three'</span></span> : ($a == <span class="hljs-number"><span class="hljs-number">4</span></span> ? <span class="hljs-string"><span class="hljs-string">'four'</span></span> : <span class="hljs-string"><span class="hljs-string">'other'</span></span>)))</code> </pre> <br>  Enquanto em PHP, ele √© interpretado como: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((($a == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-string"><span class="hljs-string">'one'</span></span> : $a == <span class="hljs-number"><span class="hljs-number">2</span></span>) ? <span class="hljs-string"><span class="hljs-string">'two'</span></span> : $a == <span class="hljs-number"><span class="hljs-number">3</span></span>) ? <span class="hljs-string"><span class="hljs-string">'three'</span></span> : $a == <span class="hljs-number"><span class="hljs-number">4</span></span>) ? <span class="hljs-string"><span class="hljs-string">'four'</span></span> : <span class="hljs-string"><span class="hljs-string">'other'</span></span>;</code> </pre> <br>  Isso pode levar a erros, porque geralmente n√£o √© o que se pretendia. <br><br>  Atrav√©s de uma proposta em duas etapas, o PHP 7.4 implementou o uso expl√≠cito de par√™nteses como um aviso de descontinua√ß√£o e, esperan√ßosamente, executar√° um erro de tempo de execu√ß√£o de compila√ß√£o em vers√µes futuras. <br><br><h2>  Conclus√£o </h2><br>  Bem na hora das festas, o PHP 7.4 traz novos recursos e melhorias na qualidade de vida de todos os desenvolvedores de PHP. <br><br>  Os sites WordPress definitivamente se beneficiar√£o dessas melhorias e seus usu√°rios podem esperar tempos de execu√ß√£o mais r√°pidos e menos uso de mem√≥ria ao usar o PHP 7.4 em compara√ß√£o com as vers√µes anteriores. <br><br>  Com a adi√ß√£o de declara√ß√µes de tipo de propriedade de primeira classe e dicas de tipo, fun√ß√µes de mesclagem de setas e velocidade ridiculamente melhor, o 7.4 certamente melhorar√° a velocidade e a qualidade do seu fluxo de trabalho. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt483128/">https://habr.com/ru/post/pt483128/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt483116/index.html">Fazendo um tubo de telesc√≥pio em casa</a></li>
<li><a href="../pt483118/index.html">O que ser√° adicionado ao JavaScript em 2020</a></li>
<li><a href="../pt483120/index.html">Como conectar cart√µes em uma proje√ß√£o elips√≥ide, se isso n√£o for fornecido?</a></li>
<li><a href="../pt483124/index.html">O gadget mais maci√ßo em um futuro pr√≥ximo (n√£o um smartphone)</a></li>
<li><a href="../pt483126/index.html">Efeitos criog√™nicos podem garantir o transporte seguro de baterias de ve√≠culos el√©tricos danificadas</a></li>
<li><a href="../pt483130/index.html">O que fazer se o c√≥digo para a fechadura da mala for esquecido?</a></li>
<li><a href="../pt483132/index.html">Projeto e fabrica√ß√£o de um telesc√≥pio</a></li>
<li><a href="../pt483134/index.html">Teste de autentica√ß√£o de dois fatores e poss√≠veis solu√ß√µes alternativas</a></li>
<li><a href="../pt483136/index.html">Verificando o MacBook usado antes da compra - lista de verifica√ß√£o</a></li>
<li><a href="../pt483140/index.html">Pol√≠gonos Outro Mundo: Amiga 500</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>