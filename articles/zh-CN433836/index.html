<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘°ğŸ½ ğŸ§šğŸ¿ ğŸ’ƒğŸ» ç¾æ´²å°ç¬¬å®‰äººå ¡å’çš„å­—èŠ‚æœºï¼ˆä¸ä»…å¦‚æ­¤ï¼‰ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰ ãŠ™ï¸ ğŸ¤› ğŸ‘¨ğŸ¾â€âš–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å­—èŠ‚ç è¿›è¡Œå®éªŒã€‚ è¿™æ˜¯æ±‡ç¼–ç¨‹åºä¸­å­—èŠ‚æœºæ–‡ç« çš„ç»­ç¯‡ï¼Œ è¿™æ˜¯ç¬¬ä¸€éƒ¨åˆ† ã€‚ 

 æ€»çš„æ¥è¯´ï¼Œæˆ‘è®¡åˆ’åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­åˆ›å»ºä¸€ä¸ªå ¡å’è§£é‡Šå™¨ï¼Œå¹¶åœ¨ç¬¬ä¸‰éƒ¨åˆ†ä¸­å¯¹æ­¤å­—èŠ‚æœºè¿›è¡Œå ¡å’ç¼–è¯‘å™¨ã€‚ ä½†æ˜¯ï¼Œè¯¥æ–‡ç« è·å¾—çš„ä½“ç§¯éå¸¸å¤§ã€‚ è¦åˆ›å»ºè§£é‡Šå™¨ï¼Œæ‚¨éœ€è¦æ‰©å±•å†…æ ¸ï¼ˆä¸€ç»„å­—èŠ‚å‘½ä»¤ï¼‰ï¼Œå¹¶å®ç°ï¼šå˜é‡ï¼Œè§£æå­—ç¬¦ä¸²ï¼Œè¾“å…¥å­—ç¬¦ä¸²ï¼Œå­—å…¸...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç¾æ´²å°ç¬¬å®‰äººå ¡å’çš„å­—èŠ‚æœºï¼ˆä¸ä»…å¦‚æ­¤ï¼‰ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433836/"><img src="https://habrastorage.org/getpro/habr/post_images/dbb/a59/e93/dbba59e932ecdb4b0c28896a7e6fc3e3.jpg" alt="å›¾ç‰‡"><br><br> è®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å­—èŠ‚ç è¿›è¡Œå®éªŒã€‚ è¿™æ˜¯æ±‡ç¼–ç¨‹åºä¸­å­—èŠ‚æœºæ–‡ç« çš„ç»­ç¯‡ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™æ˜¯ç¬¬ä¸€éƒ¨åˆ†</a> ã€‚ <br><br> æ€»çš„æ¥è¯´ï¼Œæˆ‘è®¡åˆ’åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­åˆ›å»ºä¸€ä¸ªå ¡å’è§£é‡Šå™¨ï¼Œå¹¶åœ¨ç¬¬ä¸‰éƒ¨åˆ†ä¸­å¯¹æ­¤å­—èŠ‚æœºè¿›è¡Œå ¡å’ç¼–è¯‘å™¨ã€‚ ä½†æ˜¯ï¼Œè¯¥æ–‡ç« è·å¾—çš„ä½“ç§¯éå¸¸å¤§ã€‚ è¦åˆ›å»ºè§£é‡Šå™¨ï¼Œæ‚¨éœ€è¦æ‰©å±•å†…æ ¸ï¼ˆä¸€ç»„å­—èŠ‚å‘½ä»¤ï¼‰ï¼Œå¹¶å®ç°ï¼šå˜é‡ï¼Œè§£æå­—ç¬¦ä¸²ï¼Œè¾“å…¥å­—ç¬¦ä¸²ï¼Œå­—å…¸ï¼Œæœç´¢å­—å…¸...å—¯ï¼Œè‡³å°‘æ•°å­—çš„è¾“å‡ºåº”è¯¥èµ·ä½œç”¨ã€‚ ç»“æœï¼Œæˆ‘å†³å®šå°†è§£é‡Šå™¨ä¸Šçš„æ–‡ç« åˆ†æˆä¸¤éƒ¨åˆ†ã€‚ å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ‰©å±•å†…æ ¸ï¼Œç¡®å®šå˜é‡ï¼Œç»˜åˆ¶æ•°å­—è¾“å‡ºã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹è®¡åˆ’ï¼šç¬¬ä¸‰éƒ¨åˆ†æ˜¯è§£é‡Šå™¨ï¼Œç¬¬å››éƒ¨åˆ†æ˜¯ç¼–è¯‘å™¨ã€‚ å½“ç„¶è¿˜æœ‰æ€§èƒ½æµ‹è¯•ã€‚ å®ƒä»¬å°†åœ¨ç¬¬å››æˆ–ç¬¬äº”æ¡ä¸­ã€‚ è¿™äº›æ–‡ç« å°†åœ¨æ–°å¹´ä¹‹åã€‚ <br><br> è°è¿˜ä¸æ€•å¯æ€•çš„æ±‡ç¼–å™¨å’Œå­—èŠ‚ç -æ¬¢è¿æ¥åˆ°è¿™é‡Œï¼  :) <br><a name="habracut"></a><br> é¦–å…ˆï¼Œä¿®å¤é”™è¯¯ã€‚ è®©æˆ‘ä»¬æŒ‰ç…§GASçš„ä¹ æƒ¯è®¾ç½®æ–‡ä»¶æ‰©å±•å.sï¼ˆæ„Ÿè°¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">mistergrim</a> ï¼‰ã€‚ ç„¶åï¼Œå°†int 0x80æ›¿æ¢ä¸ºsyscallå¹¶ä½¿ç”¨64ä½å¯„å­˜å™¨ï¼ˆæ„Ÿè°¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">qw1</a> ï¼‰ã€‚ ä¸€å¼€å§‹ï¼Œæˆ‘æ²¡æœ‰ä»”ç»†é˜…è¯»å‘¼å«è¯´æ˜ï¼Œä»…çº æ­£äº†å¯„å­˜å™¨...å¹¶å‡ºç°åˆ†æ®µé”™è¯¯ã€‚ äº‹å®è¯æ˜ï¼Œç³»ç»Ÿè°ƒç”¨çš„ä¸€åˆ‡éƒ½å·²æ›´æ”¹ï¼ŒåŒ…æ‹¬ç”µè¯å·ç ã€‚  syscallçš„sys_writeä¸º1ï¼Œsys_exitä¸º60ã€‚å› æ­¤ï¼Œbadï¼Œtypeå’Œbyeå‘½ä»¤é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š <br><br><pre><code class="cpp hljs">b_bad = <span class="hljs-number"><span class="hljs-number">0x00</span></span> bcmd_bad: mov rax, <span class="hljs-number"><span class="hljs-number">1</span></span> #   â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - sys_write mov rdi, <span class="hljs-number"><span class="hljs-number">1</span></span> #  â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span> mov rsi, offset msg_bad_byte #     mov rdx, msg_bad_byte_len #   syscall #   mov rax, <span class="hljs-number"><span class="hljs-number">60</span></span> #   â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - sys_exit mov rbx, <span class="hljs-number"><span class="hljs-number">1</span></span> #    <span class="hljs-number"><span class="hljs-number">1</span></span> syscall #   b_bye = <span class="hljs-number"><span class="hljs-number">0x01</span></span> bcmd_bye: mov rax, <span class="hljs-number"><span class="hljs-number">1</span></span> #   â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - sys_write mov rdi, <span class="hljs-number"><span class="hljs-number">1</span></span> #  â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span> mov rsi, offset msg_bye #     mov rdx, msg_bye_len #   syscall #   mov rax, <span class="hljs-number"><span class="hljs-number">60</span></span> #   â„– <span class="hljs-number"><span class="hljs-number">60</span></span> - sys_exit mov rdi, <span class="hljs-number"><span class="hljs-number">0</span></span> #    <span class="hljs-number"><span class="hljs-number">0</span></span> syscall #   b_type = <span class="hljs-number"><span class="hljs-number">0x80</span></span> bcmd_type: mov rax, <span class="hljs-number"><span class="hljs-number">1</span></span> #   â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - sys_write mov rdi, <span class="hljs-number"><span class="hljs-number">1</span></span> #  â„– <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span> pop rdx pop rsi push r8 syscall #   pop r8 jmp _next</code> </pre> <br> è¿˜æœ‰ä¸€ä»¶äº‹ã€‚ ç›¸å½“æ­£ç¡®åœ°ï¼Œåœ¨å‰ä¸€ç¯‡æ–‡ç« çš„è¯„è®ºä¸­ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">berez</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">fpaukå†™é“</a> ï¼Œå¦‚æœåœ¨å­—èŠ‚ç ä¸­ä½¿ç”¨å¤„ç†å™¨åœ°å€ï¼Œåˆ™å­—èŠ‚ç å–å†³äºå¹³å°ã€‚ åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œâ€œ Helloï¼Œworldï¼â€çš„è¡Œåœ°å€æ˜¯æŒ‰å­—èŠ‚ç æŒ‰å€¼è®¾ç½®çš„ï¼ˆä½¿ç”¨lit64å‘½ä»¤ï¼‰ã€‚ å½“ç„¶ï¼Œè¿™ä¸æ˜¯å¿…éœ€çš„ã€‚ ä½†è¿™æ˜¯æ£€æŸ¥å­—èŠ‚æœºçš„æœ€ç®€å•æ–¹æ³•ã€‚ æˆ‘ä¸å†è¿™æ ·åšäº†ï¼Œä½†æ˜¯æˆ‘å°†é€šè¿‡å…¶ä»–æ–¹å¼æ¥è·å–å˜é‡çš„åœ°å€ï¼šç‰¹åˆ«æ˜¯ä½¿ç”¨varå‘½ä»¤ï¼ˆç¨åä¼šè¯¦ç»†ä»‹ç»ï¼‰ã€‚ <br><br><h4> çƒ­èº« </h4><br> ç°åœ¨ï¼Œä½œä¸ºçƒ­èº«ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œæ‰€æœ‰åŸºæœ¬çš„æ•´æ•°ç®—æœ¯è¿ç®—ï¼ˆ+ï¼Œ-ï¼Œ*ï¼Œ/ï¼Œmodï¼Œ/ modï¼Œabsï¼‰ã€‚ æˆ‘ä»¬å°†éœ€è¦å®ƒä»¬ã€‚ <br><br> è¯¥ä»£ç æ˜¯å¦‚æ­¤ç®€å•ï¼Œä»¥è‡³äºæˆ‘å°†å…¶å¸¦å…¥æ‰°æµå™¨è€Œæ— éœ€æ³¨é‡Šã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç®—æœ¯è¿ç®—</b> <div class="spoiler_text"><pre> <code class="cpp hljs">b_add = <span class="hljs-number"><span class="hljs-number">0x21</span></span> bcmd_add: pop rax add [rsp], rax jmp _next b_sub = <span class="hljs-number"><span class="hljs-number">0x22</span></span> bcmd_sub: pop rax sub [rsp], rax jmp _next b_mul = <span class="hljs-number"><span class="hljs-number">0x23</span></span> bcmd_mul: pop rax pop rbx imul rbx push rax jmp _next b_div = <span class="hljs-number"><span class="hljs-number">0x24</span></span> bcmd_div: pop rbx pop rax cqo idiv rbx push rax jmp _next b_mod = <span class="hljs-number"><span class="hljs-number">0x25</span></span> bcmd_mod: pop rbx pop rax cqo idiv rbx push rdx jmp _next b_divmod = <span class="hljs-number"><span class="hljs-number">0x26</span></span> bcmd_divmod: pop rbx pop rax cqo idiv rbx push rdx push rax jmp _next b_abs = <span class="hljs-number"><span class="hljs-number">0x27</span></span> bcmd_abs: mov rax, [rsp] <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> rax, rax jge _next neg rax mov [rsp], rax jmp _next</code> </pre></div></div><br> ä¼ ç»Ÿä¸Šï¼Œåœ¨å ¡å’ä¸­ï¼Œå°†åŒç²¾åº¦è¿ç®—æ·»åŠ åˆ°é€šå¸¸çš„ç®—æœ¯å’Œå †æ ˆè¿ç®—ä¸­ã€‚ ç”¨äºæ­¤ç±»æ“ä½œçš„å­—è¯é€šå¸¸ä»¥â€œ 2â€å¼€å¤´ï¼š2DUPï¼Œ2SWAPç­‰ã€‚ ä½†æ˜¯æˆ‘ä»¬å·²ç»æœ‰64ä½æ ‡å‡†ç®—æœ¯äº†ï¼Œä»Šå¤©æˆ‘ä»¬ç»å¯¹ä¸ä¼šåš128ä½:) <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·»åŠ åŸºæœ¬çš„å †æ ˆæ“ä½œï¼ˆåˆ é™¤ï¼Œäº¤æ¢ï¼Œæ ¹ï¼Œ-rootï¼Œç»“æŸï¼Œæ‹¾å–ï¼Œæ»šåŠ¨ï¼‰ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å †æ ˆæ“ä½œ</b> <div class="spoiler_text"><pre> <code class="cpp hljs">b_drop = <span class="hljs-number"><span class="hljs-number">0x31</span></span> bcmd_drop: add rsp, <span class="hljs-number"><span class="hljs-number">8</span></span> jmp _next b_swap = <span class="hljs-number"><span class="hljs-number">0x32</span></span> bcmd_swap: pop rax pop rbx push rax push rbx jmp _next b_rot = <span class="hljs-number"><span class="hljs-number">0x33</span></span> bcmd_rot: pop rax pop rbx pop rcx push rbx push rax push rcx jmp _next b_mrot = <span class="hljs-number"><span class="hljs-number">0x34</span></span> bcmd_mrot: pop rcx pop rbx pop rax push rcx push rax push rbx jmp _next b_over = <span class="hljs-number"><span class="hljs-number">0x35</span></span> bcmd_over: push [rsp + <span class="hljs-number"><span class="hljs-number">8</span></span>] jmp _next b_pick = <span class="hljs-number"><span class="hljs-number">0x36</span></span> bcmd_pick: pop rcx push [rsp + <span class="hljs-number"><span class="hljs-number">8</span></span>*rcx] jmp _next b_roll = <span class="hljs-number"><span class="hljs-number">0x37</span></span> bcmd_roll: pop rcx mov rbx, [rsp + <span class="hljs-number"><span class="hljs-number">8</span></span>*rcx] roll1: mov rax, [rsp + <span class="hljs-number"><span class="hljs-number">8</span></span>*rcx - <span class="hljs-number"><span class="hljs-number">8</span></span>] mov [rsp + <span class="hljs-number"><span class="hljs-number">8</span></span>*rcx], rax dec rcx jnz roll1 push rbx jmp _next</code> </pre> </div></div><br> è€Œä¸”ï¼Œæˆ‘ä»¬è¿˜å°†å‘å‡ºç”¨äºè¯»å†™å†…å­˜çš„å‘½ä»¤ï¼ˆFortçš„å•è¯@å’Œï¼ï¼‰ã€‚ ä»¥åŠä¸ä¹‹å¯¹åº”çš„å…¶ä»–ä½æ·±åº¦ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è¯»å–å’Œå†™å…¥å†…å­˜</b> <div class="spoiler_text"><pre> <code class="cpp hljs">b_get = <span class="hljs-number"><span class="hljs-number">0x40</span></span> bcmd_get: pop rcx push [rcx] jmp _next b_set = <span class="hljs-number"><span class="hljs-number">0x41</span></span> bcmd_set: pop rcx pop rax mov [rcx], rax jmp _next b_get8 = <span class="hljs-number"><span class="hljs-number">0x42</span></span> bcmd_get8: pop rcx movsx rax, byte ptr [rcx] push rax jmp _next b_set8 = <span class="hljs-number"><span class="hljs-number">0x43</span></span> bcmd_set8: pop rcx pop rax mov [rcx], al jmp _next b_get16 = <span class="hljs-number"><span class="hljs-number">0x44</span></span> bcmd_get16: pop rcx movsx rax, word ptr [rcx] push rax jmp _next b_set16 = <span class="hljs-number"><span class="hljs-number">0x45</span></span> bcmd_set16: pop rcx pop rax mov [rcx], ax jmp _next b_get32 = <span class="hljs-number"><span class="hljs-number">0x46</span></span> bcmd_get32: pop rcx movsx rax, dword ptr [rcx] push rax jmp _next b_set32 = <span class="hljs-number"><span class="hljs-number">0x47</span></span> bcmd_set32: pop rcx pop rax mov [rcx], eax jmp _next</code> </pre> </div></div><br> æˆ‘ä»¬å¯èƒ½ä»ç„¶éœ€è¦æ¯”è¾ƒå›¢é˜Ÿï¼Œæˆ‘ä»¬ä¹Ÿä¼šè¿™æ ·åšã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ¯”è¾ƒå‘½ä»¤</b> <div class="spoiler_text"><pre> <code class="cpp hljs"># <span class="hljs-number"><span class="hljs-number">0</span></span>= b_zeq = <span class="hljs-number"><span class="hljs-number">0x50</span></span> bcmd_zeq: pop rax <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> rax, rax jnz rfalse rtrue: push <span class="hljs-number"><span class="hljs-number">-1</span></span> jmp _next rfalse: push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # <span class="hljs-number"><span class="hljs-number">0</span></span>&lt; b_zlt = <span class="hljs-number"><span class="hljs-number">0x51</span></span> bcmd_zlt: pop rax <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> rax, rax jl rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # <span class="hljs-number"><span class="hljs-number">0</span></span>&gt; b_zgt = <span class="hljs-number"><span class="hljs-number">0x52</span></span> bcmd_zgt: pop rax <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> rax, rax jg rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # = b_eq = <span class="hljs-number"><span class="hljs-number">0x53</span></span> bcmd_eq: pop rbx pop rax cmp rax, rbx jz rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # &lt; b_lt = <span class="hljs-number"><span class="hljs-number">0x54</span></span> bcmd_lt: pop rbx pop rax cmp rax, rbx jl rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # &gt; b_gt = <span class="hljs-number"><span class="hljs-number">0x55</span></span> bcmd_gt: pop rbx pop rax cmp rax, rbx jg rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # &lt;= b_lteq = <span class="hljs-number"><span class="hljs-number">0x56</span></span> bcmd_lteq: pop rbx pop rax cmp rax, rbx jle rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next # &gt;= b_gteq = <span class="hljs-number"><span class="hljs-number">0x57</span></span> bcmd_gteq: pop rbx pop rax cmp rax, rbx jge rtrue push <span class="hljs-number"><span class="hljs-number">0</span></span> jmp _next</code> </pre> </div></div><br> æˆ‘ä»¬ä¸ä¼šæµ‹è¯•æ“ä½œã€‚ æœ€ä¸»è¦çš„æ˜¯ï¼Œæ±‡ç¼–ç¨‹åºåœ¨ç¼–è¯‘æ—¶ä¸ä¼šå‘å‡ºé”™è¯¯ã€‚ è°ƒè¯•å°†åœ¨ä½¿ç”¨å®ƒä»¬çš„è¿‡ç¨‹ä¸­è¿›è¡Œã€‚ <br><br> ç«‹å³è®¾ç½®å•è¯æ·±åº¦ï¼ˆå †æ ˆæ·±åº¦ï¼‰ã€‚ ä¸ºæ­¤ï¼Œåœ¨å¯åŠ¨æ—¶ï¼Œä¿å­˜æ•°æ®å †æ ˆå’Œè¿”å›å †æ ˆçš„åˆå§‹å€¼ã€‚ é‡æ–°å¯åŠ¨ç³»ç»Ÿæ—¶ï¼Œè¿™äº›å€¼å¯èƒ½ä»ç„¶æ´¾ä¸Šç”¨åœºã€‚ <br><br><pre> <code class="cpp hljs">init_stack: .quad <span class="hljs-number"><span class="hljs-number">0</span></span> init_rstack: .quad <span class="hljs-number"><span class="hljs-number">0</span></span> _start: mov rbp, rsp sub rbp, stack_size lea r8, start mov init_stack, rsp mov init_rstack, rbp jmp _next b_depth = <span class="hljs-number"><span class="hljs-number">0x38</span></span> bcmd_depth: mov rax, init_stack sub rax, rsp shr rax, <span class="hljs-number"><span class="hljs-number">3</span></span> push rax jmp _next</code> </pre> <br><h4> å·ç è¾“å‡º </h4><br> å¥½äº†ï¼Œçƒ­èº«ç»“æŸäº†ï¼Œæ‚¨å¾—å°‘æµæ±—ã€‚ æ•™æˆ‘ä»¬çš„ç³»ç»Ÿè¾“å‡ºæ•°å­—ã€‚ å•è¯â€œã€‚â€ç”¨äºæ˜¾ç¤ºè¦å¡ä¸­çš„æ•°å­—ã€‚  ï¼ˆå¥å·ï¼‰ã€‚ è®©æˆ‘ä»¬æŒ‰ç…§æ ‡å‡†Fortå®ç°ä¸­çš„å®Œæˆæ–¹å¼æ¥åšï¼Œä½¿ç”¨å•è¯&lt;ï¼ƒï¼Œholdï¼Œï¼ƒï¼Œï¼ƒsï¼Œï¼ƒ&gt;ï¼Œbaseã€‚ å¿…é¡»æ„è¯†åˆ°æ‰€æœ‰è¿™äº›è¯ã€‚ ä¸ºäº†å½¢æˆä¸€ä¸ªæ•°å­—ï¼Œä½¿ç”¨äº†ä¸€ä¸ªç¼“å†²åŒºå’Œä¸€ä¸ªæŒ‡å‘è¦å½¢æˆçš„å­—ç¬¦çš„æŒ‡é’ˆï¼Œè¿™äº›å°†æ˜¯å•è¯holdbufå’Œholdpointã€‚ <br><br> å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è¿™äº›è¯ï¼š <br><br><ul><li>  <b>holdbuf-</b>ç”¨äºç”Ÿæˆæ•°å­—è¡¨ç¤ºå½¢å¼çš„ç¼“å†²åŒºï¼Œä»æœ€åå¼€å§‹å½¢æˆ </li><li>  <b>holdpoint-</b>æœ€åæ˜¾ç¤ºçš„å­—ç¬¦çš„åœ°å€ï¼ˆåœ¨holdbufä¸­ï¼‰ </li><li>  <b>&lt;ï¼ƒ</b> -å½¢æˆä¸€ä¸ªæ•°å­—çš„å¼€å§‹ï¼› å°†ä¿ç•™ç‚¹è®¾ç½®ä¸ºå­—èŠ‚ï¼Œåœ¨æœ€åä¸€ä¸ªå­—èŠ‚holdbufä¹‹å </li><li>  hold- <b>å°†ä¿æŒç‚¹</b>å‡å°‘1ï¼Œå¹¶å°†å­—ç¬¦ä»å †æ ˆä¿å­˜åˆ°æ¥æ”¶åœ°å€çš„ç¼“å†²åŒº </li><li>  <b>ï¼ƒ</b> -å°†å †æ ˆé¡¶éƒ¨çš„å•è¯é™¤ä»¥æ•°å­—ç³»ç»Ÿçš„åŸºæ•°ï¼Œå°†é™¤æ³•çš„å…¶ä½™éƒ¨åˆ†è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä½¿ç”¨holdå°†å…¶ä¿å­˜åˆ°ç¼“å†²åŒºä¸­ </li><li>  <b>#s-</b>è½¬æ¢æ•´ä¸ªå•è¯ï¼› å®é™…ä¸Šåœ¨å¾ªç¯ä¸­è°ƒç”¨å•è¯ï¼ƒç›´åˆ°å †æ ˆä¸Šå‰©ä¸‹0 </li><li>  <b>ï¼ƒ&gt;</b> -è½¬æ¢å®Œæˆï¼› å°†å½¢æˆçš„å­—ç¬¦ä¸²çš„å¼€å¤´åŠå…¶é•¿åº¦æ¨å…¥å †æ ˆ </li></ul><br> æˆ‘ä»¬å°†ç”¨å­—èŠ‚ç å¤„ç†æ‰€æœ‰å•è¯ï¼Œä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¤„ç†å˜é‡ã€‚ <br><br><h4> å˜æ•° </h4><br> åœ¨è¿™é‡Œä¼šæœ‰ä¸€ç‚¹Fortiané­”æ³•ã€‚ äº‹å®æ˜¯ï¼Œåœ¨ä¸€ä¸ªå ¡å’ä¸­ï¼Œå˜é‡å°±æ˜¯ä¸€ä¸ªå•è¯ã€‚ å½“æ‰§è¡Œè¯¥å­—æ—¶ï¼Œå­˜å‚¨å˜é‡å€¼çš„å­˜å‚¨å•å…ƒçš„åœ°å€åœ¨å †æ ˆä¸Šã€‚ æ‚¨å¯ä»¥è¯»å†™è¯¥åœ°å€ã€‚ ä¾‹å¦‚ï¼Œè¦å°†å€¼12345å†™å…¥å˜é‡Aï¼Œæ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼šâ€œ 12345 Aï¼â€ã€‚ åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå°†12345å‹å…¥å †æ ˆï¼Œç„¶åå˜é‡Aå‹å…¥å…¶åœ°å€ï¼Œå•è¯â€œï¼â€ ä»å †æ ˆä¸­åˆ é™¤ä¸¤ä¸ªå€¼ï¼Œå¹¶å°†12345å†™å…¥å˜é‡Açš„åœ°å€ã€‚åœ¨å ¡å’çš„å…¸å‹å®ç°ä¸­ï¼ˆä½¿ç”¨ç›´æ¥ä»£ç ï¼‰ï¼Œå˜é‡æ˜¯åœ°å€ä¸º_nextçš„CALLå¾®å¤„ç†å™¨å‘½ä»¤ï¼Œæ­¤åä¿ç•™ä¸€ä¸ªä½ç½®ä»¥å­˜å‚¨å˜é‡çš„å€¼ã€‚ å½“æ‰§è¡Œè¿™æ ·çš„å­—æ—¶ï¼Œå¾®å¤„ç†å™¨å°†æ§åˆ¶æƒè½¬ç§»åˆ°_nextå¹¶å°†è¿”å›åœ°å€ï¼ˆé€šè¿‡RSPï¼‰å‹å…¥å †æ ˆã€‚ ä½†åœ¨è¦å¡ä¸­ï¼Œå¾®å¤„ç†å™¨å †æ ˆæ˜¯ç®—æœ¯è¿ç®—ï¼Œæˆ‘ä»¬å°†ä¸ä¼šå†è¿”å›ä»»ä½•åœ°æ–¹ã€‚ ç»“æœï¼Œæ‰§è¡Œç»§ç»­ï¼Œå¹¶ä¸”åœ¨å †æ ˆä¸Šæ˜¯å˜é‡çš„åœ°å€ã€‚ è€Œæ‰€æœ‰è¿™äº›åªæœ‰ä¸€ä¸ªå¤„ç†å™¨å›¢é˜Ÿï¼ åœ¨æ±‡ç¼–å™¨ä¸­ï¼Œå®ƒå°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs"> call _next #   _next,      ,   <span class="hljs-number"><span class="hljs-number">12345</span></span> .quad <span class="hljs-number"><span class="hljs-number">12345</span></span></code> </pre> <br> ä½†æ˜¯æˆ‘ä»¬æœ‰ä¸€ä¸ªå­—èŠ‚ç ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨è¿™ç§æœºåˆ¶ï¼ æˆ‘æ²¡æœ‰ç«‹å³å¼„æ¸…æ¥šå¦‚ä½•åœ¨å­—èŠ‚ç ä¸Šå»ºç«‹è¿™æ ·çš„æœºåˆ¶ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä»é€»è¾‘ä¸Šè€ƒè™‘ï¼Œé‚£ä¸ä¼šå¹²æ‰°éå¸¸ç›¸ä¼¼çš„äº‹æƒ…çš„å®ç°ã€‚ è¯·è®°ä½ï¼Œè¿™ä¸æ˜¯å¤„ç†å™¨å‘½ä»¤ï¼Œè€Œæ˜¯å­—èŠ‚ç ï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯å­—èŠ‚ç ä¸Šçš„â€œå­ä¾‹ç¨‹â€ã€‚ è¿™æ˜¯é—®é¢˜çš„é™ˆè¿°ï¼š <br><br><ul><li> è¿™æ˜¯ä¸€ä¸ªå­—èŠ‚ç ï¼Œåœ¨å°†æ§åˆ¶æƒè½¬ç§»åˆ°å®ƒæ—¶åº”ç«‹å³ä»ä¸­è¿”å› </li><li> è¿”å›åï¼Œå­˜å‚¨å˜é‡å€¼çš„åœ°å€åº”ä¿ç•™åœ¨ç®—æœ¯å †æ ˆä¸­ </li></ul><br> æˆ‘ä»¬æœ‰ä¸€ä¸ªé€€å‡ºå­—èŠ‚å‘½ä»¤ã€‚ è®©æˆ‘ä»¬åœ¨åŒ…å«å•ä¸ªé€€å‡ºå‘½ä»¤çš„å­—èŠ‚ç ä¸Šè¯´ä¸€ä¸ªå­—ã€‚ ç„¶åæ­¤å‘½ä»¤å°†ä»ä¸­è¿”å›ã€‚ ä»ç„¶éœ€è¦æ‰§è¡Œç›¸åŒçš„å‘½ä»¤ï¼Œè¿™è¿˜ä¼šå°†ä¸‹ä¸€ä¸ªå­—èŠ‚çš„åœ°å€å‹å…¥å †æ ˆï¼ˆå¯„å­˜å™¨R8ï¼‰ã€‚ æˆ‘ä»¬å°†è¿™æ ·åšä½œä¸ºé€€å‡ºçš„é™„åŠ å…¥å£ç‚¹ï¼Œä»¥ä¿å­˜è¿‡æ¸¡ï¼š <br><br><pre> <code class="cpp hljs">b_var0 = <span class="hljs-number"><span class="hljs-number">0x28</span></span> bcmd_var0: push r8 b_exit = <span class="hljs-number"><span class="hljs-number">0x17</span></span> bcmd_exit: mov r8, [rbp] add rbp, <span class="hljs-number"><span class="hljs-number">8</span></span> _next: movzx rcx, byte ptr [r8] inc r8 jmp [bcmd + rcx*<span class="hljs-number"><span class="hljs-number">8</span></span>]</code> </pre> <br> ç°åœ¨ï¼ŒåŸºæœ¬å˜é‡å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><pre> <code class="cpp hljs">base: .byte b_var0 .quad <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br> é¡ºä¾¿è¯´ä¸€å¥ï¼Œä¸ºä»€ä¹ˆæ˜¯var0ï¼Œè€Œä¸ä»…ä»…æ˜¯varï¼Ÿ äº‹å®æ˜¯ï¼Œå°†å­˜åœ¨å…¶ä»–å‘½ä»¤æ¥æ ‡è¯†åŒ…å«æ•°æ®çš„æ›´é«˜çº§çš„å•è¯ã€‚ æˆ‘å°†åœ¨ä»¥ä¸‹æ–‡ç« ä¸­æ›´è¯¦ç»†åœ°æè¿°ã€‚ <br><br> ç°åœ¨æˆ‘ä»¬éƒ½å‡†å¤‡ç”»æ•°å­—äº†ã€‚ è®©æˆ‘ä»¬å¼€å§‹å§ï¼ <br><br><h4> è¯åº“ï¼Œholdbufï¼Œholdpoint </h4><br> å˜é‡çš„æ’åˆ—æ–¹å¼å·²ç»ç¡®å®šã€‚ å› æ­¤ï¼Œå•è¯baseï¼Œholdbufï¼Œholdpointçš„è·å–æ–¹å¼å¦‚ä¸‹ï¼š <br><br><pre> <code class="cpp hljs">base: .byte b_var0 .quad <span class="hljs-number"><span class="hljs-number">10</span></span> holdbuf_len = <span class="hljs-number"><span class="hljs-number">70</span></span> holdbuf: .byte b_var0 .space holdbuf_len holdpoint: .byte b_var0 .quad <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  holdbufç¼“å†²åŒºçš„å¤§å°é€‰æ‹©ä¸º70ã€‚æ•°å­—çš„æœ€å¤§ä½æ•°ä¸º64ï¼ˆå¦‚æœæ‚¨é€‰æ‹©äºŒè¿›åˆ¶ç³»ç»Ÿï¼Œåˆ™ä¸º64ï¼‰ã€‚ å¦å¤–è¿˜ä¿ç•™äº†å‡ ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚ï¼Œæ•°å­—çš„ç¬¦å·å’Œå…¶åçš„ç©ºæ ¼ã€‚ æˆ‘ä»¬å°†æ£€æŸ¥ç¼“å†²åŒºæ˜¯å¦æº¢å‡ºï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬ä¸ä¼šåœ¨ç¼“å†²åŒºä¸­æ”¾å…¥å¤šä½™çš„å­—ç¬¦ã€‚ è¿™æ ·å°±å¯ä»¥è¿›è¡Œå…¶ä»–è¯Šæ–­ã€‚ <br><br><h4> ä¿æŒ </h4><br> ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å•è¯holdã€‚ åœ¨è¦å¡ä¸Šï¼Œå…¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs">: hold holdpoint @ <span class="hljs-number"><span class="hljs-number">1</span></span>- dup holdbuf &gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> drop drop <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> dup holdpoint ! c! then ;</code> </pre> <br> å¯¹äºé‚£äº›ç¬¬ä¸€æ¬¡çœ‹åˆ°å ¡å’çš„äººï¼Œæˆ‘å°†è¯¦ç»†åˆ†æä»£ç ã€‚ å¯¹äºæ¥ä¸‹æ¥çš„è¯ï¼Œæˆ‘å°†ä¸è¿™æ ·åšã€‚ <br><br> å¼€å¤´æœ‰ä¸€ä¸ªç”¨äºå®šä¹‰æ–°å•è¯çš„å•è¯å’Œä¸€ä¸ªæ–°å•è¯çš„åç§°ï¼šâ€œï¼šholdâ€ã€‚ ä¹‹åæ˜¯ä»¥å•è¯â€œ;â€ç»“å°¾çš„ä»£ç ã€‚ è®©æˆ‘ä»¬åˆ†æä¸€ä¸‹å•è¯çš„ä»£ç ã€‚ æ‰§è¡Œå‘½ä»¤åï¼Œæˆ‘å°†ç»™å‡ºå‘½ä»¤å’Œå †æ ˆçŠ¶æ€ã€‚ åœ¨è°ƒç”¨è¯¥å•è¯ä¹‹å‰ï¼Œå †æ ˆä¸Šæœ‰ä¸€ä¸ªå­—ç¬¦ä»£ç ï¼Œè¯¥å­—ç¬¦ä»£ç æ”¾ç½®åœ¨ç¼“å†²åŒºä¸­ï¼ˆç”±&lt;character&gt;è¡¨ç¤ºï¼‰ã€‚ è¿›ä¸€æ­¥çš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š <br><br><pre> <code class="cpp hljs">holdpoint &lt;&gt; &lt;  holdpoint&gt; @ &lt;&gt; &lt;  holdpoint&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>- &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; dup &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; holdbuf &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;  holdbuf&gt; &gt; &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;,    holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>    holdbuf&gt;</code> </pre> <br> ä¹‹åæ˜¯ifå‘½ä»¤ï¼Œå®ƒå°†ç¼–è¯‘æˆæ¡ä»¶è·³è½¬ï¼Œç„¶åè·³è½¬åˆ°elseå’Œthenä¹‹é—´çš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚ æ¡ä»¶åˆ†æ”¯ä»å †æ ˆä¸­åˆ é™¤æ¯”è¾ƒç»“æœï¼Œå¦‚æœå †æ ˆä¸Šæœ‰è°è¨€ï¼Œåˆ™æ‰§è¡Œè½¬æ¢ã€‚ å¦‚æœæ²¡æœ‰è¿‡æ¸¡ï¼Œåˆ™æ‰§è¡Œifå’Œelseä¹‹é—´çš„åˆ†æ”¯ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªdropå‘½ä»¤åˆ é™¤å­—ç¬¦å’Œåœ°å€ã€‚ å¦åˆ™ï¼Œæ‰§è¡Œå°†ç»§ç»­ã€‚ å•è¯â€œï¼â€ å°†æ–°å€¼ä¿å­˜åœ¨ä¿æŒç‚¹ä¸­ï¼ˆåœ°å€å’Œå€¼ä»å †æ ˆä¸­åˆ é™¤ï¼‰ã€‚ è¿˜æœ‰å•è¯â€œ cï¼â€ å°†ä¸€ä¸ªå­—ç¬¦å†™å…¥ç¼“å†²åŒºï¼Œè¿™æ˜¯set8å­—èŠ‚å‘½ä»¤ï¼ˆå­—ç¬¦çš„åœ°å€å’Œå€¼ä»å †æ ˆä¸­åˆ é™¤ï¼‰ã€‚ <br><br><pre> <code class="cpp hljs">dup &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; holdpoint &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; &lt;  holdpoint&gt; ! &lt;&gt; &lt;  holdpoint  <span class="hljs-number"><span class="hljs-number">1</span></span>&gt; c! ,  ,   ! :)</code> </pre> <br> è¿™ç®€çŸ­çš„å‘½ä»¤åºåˆ—å¯ä»¥æ‰§è¡Œå¤šå°‘æ“ä½œï¼ æ˜¯çš„ï¼Œè¦å¡å¾ˆç®€æ´ã€‚ ç°åœ¨æˆ‘ä»¬æ‰“å¼€æ‰‹åŠ¨çš„â€œç¼–è¯‘å™¨â€ ï¼š)ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼š <br><pre> <code class="cpp hljs">hold: .byte b_call8 .byte holdpoint - . - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-meta"><span class="hljs-meta"># holdpoint .byte b_get # @ .byte b_wm # 1- .byte b_dup # dup .byte b_call8 .byte holdbuf - . - 1 # holdbuf .byte b_gt # &gt; .byte b_qbranch8 # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> .byte 0f - . .byte b_drop # drop .byte b_drop # drop .byte b_branch8 #     ( then) .byte 1f - . 0: .byte b_dup # dup .byte b_call8 .byte holdpoint - . - 1 # holdpoint .byte b_set # ! .byte b_set8 # c! 1: .byte b_exit # ;</span></span></code> </pre> <br> åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨äº†æœ¬åœ°æ ‡ç­¾ï¼ˆ0å’Œ1ï¼‰ã€‚ å¯ä»¥ä½¿ç”¨ç‰¹æ®Šåç§°è®¿é—®è¿™äº›æ ‡ç­¾ã€‚ ä¾‹å¦‚ï¼Œæ ‡ç­¾0å¯ä»¥é€šè¿‡åç§°0fæˆ–0bè®¿é—®ã€‚ è¿™æ„å‘³ç€é“¾æ¥åˆ°æœ€è¿‘çš„æ ‡ç­¾0ï¼ˆå‘å‰æˆ–å‘åï¼‰ã€‚ å¯¹äºæœ¬åœ°ä½¿ç”¨çš„æ ‡ç­¾éå¸¸æ–¹ä¾¿ï¼Œä»¥å…å‡ºç°ä¸åŒçš„åç§°ã€‚ <br><br><h4> å­—å· </h4><br> è®©æˆ‘ä»¬åšä¸ªå•è¯ï¼ƒã€‚ åœ¨è¦å¡ä¸Šï¼Œå…¶ä»£ç å°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs">: <span class="hljs-meta"><span class="hljs-meta"># base /mod swap dup 10 &lt; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> câ€³ 0 + </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> 10 - câ€³ A + then hold ;</span></span></code> </pre> <br> è¿™é‡Œçš„æ¡ä»¶ç”¨äºæ£€æŸ¥ï¼šæ”¶åˆ°çš„æ•°å­—æ˜¯å¦å°äºåï¼Ÿ å¦‚æœè¾ƒå°ï¼Œåˆ™ä½¿ç”¨æ•°å­—0â€“9ï¼›å¦åˆ™ï¼Œå°†ä½¿ç”¨ä»¥â€œ Aâ€å¼€å¤´çš„å­—ç¬¦ã€‚ è¿™å°†å…è®¸ä½¿ç”¨åå…­è¿›åˆ¶æ•°å­—ç³»ç»Ÿã€‚ åºåˆ—câ€ 0å°†å­—ç¬¦ä»£ç 0å‹å…¥å †æ ˆã€‚æˆ‘ä»¬æ‰“å¼€â€œç¼–è¯‘å™¨â€ï¼š <br><br><pre> <code class="cpp hljs">conv: .byte b_call16 .word base - . - <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-meta"><span class="hljs-meta"># base .byte b_get # @ .byte b_divmod # /mod .byte b_swap # swap .byte b_dup # dup .byte b_lit8 .byte 10 # 10 .byte b_lt # &lt; .byte b_qnbranch8 # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> .byte 0f - . .byte b_lit8 .byte </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'0'</span></span></span><span class="hljs-meta"> # câ€³ 0 .byte b_add # + .byte b_branch8 # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> .byte 1f - . 0: .byte b_lit8 .byte </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">'A'</span></span></span><span class="hljs-meta"> # câ€³ A .byte b_add # + 1: .byte b_call16 .word hold - . - 2 # hold .byte b_exit # ;</span></span></code> </pre> <br><h4> å­—&lt;ï¼ƒ </h4><br>  &lt;ï¼ƒè¿™ä¸ªè¯å¾ˆç®€å•ï¼š <br><br><pre> <code class="cpp hljs">: &lt;<span class="hljs-meta"><span class="hljs-meta"># holdbuf 70 + holdpoint ! ;</span></span></code> </pre> <br> å­—èŠ‚ç ï¼š <br><br><pre> <code class="cpp hljs">conv_start: .byte b_call16 .word holdbuf - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_lit8 .byte holdbuf_len .byte b_add .byte b_call16 .word holdpoint - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_set .byte b_exit</code> </pre> <br><h4> å­—å·&gt; </h4><br>  ï¼ƒ&gt;ä¸€è¯å®Œæˆè½¬æ¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs">: #&gt; holdpoint @ holdbuf <span class="hljs-number"><span class="hljs-number">70</span></span> + over - ;</code> </pre> <br> å­—èŠ‚ç ï¼š <br><br><pre> <code class="cpp hljs">conv_end: .byte b_call16 .word holdpoint - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_get .byte b_call16 .word holdbuf - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_lit8 .byte holdbuf_len .byte b_add .byte b_over .byte b_sub .byte b_exit</code> </pre> <br><h4> å•è¯#s </h4><br> æœ€åï¼Œå•è¯#sï¼š <br><br><pre> <code class="cpp hljs">: <span class="hljs-meta"><span class="hljs-meta">#s do # dup 0= until ;</span></span></code> </pre> <br> å­—èŠ‚ç ï¼š <br><br><pre> <code class="cpp hljs">conv_s: .byte b_call8 .byte conv - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_dup .byte b_qbranch8 .byte conv_s - . .byte b_exit</code> </pre> <br> ä»»ä½•å°å¿ƒçš„äººéƒ½ä¼šæ³¨æ„åˆ°å­—èŠ‚ç å’Œè¦å¡ä»£ç ä¹‹é—´ç•¥æœ‰å·®å¼‚:) <br><br><h4> ä¸€åˆ‡å‡†å¤‡å°±ç»ª </h4><br> ç°åœ¨ï¼Œä»€ä¹ˆéƒ½ä¸ä¼šé˜»æ­¢æ‚¨ä½¿å•è¯â€œã€‚â€æ˜¾ç¤ºæ•°å­—ï¼š <br><br><pre> <code class="cpp hljs">: . &lt;# <span class="hljs-meta"><span class="hljs-meta">#s drop #&gt; type ;</span></span></code> </pre> <br> å­—èŠ‚ç ï¼š <br><br><pre> <code class="cpp hljs">dot: .byte b_call8 .byte conv_start - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_call8 .byte conv_s - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_drop .byte b_call8 .byte conv_end - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_type .byte b_exit</code> </pre> <br> è®©æˆ‘ä»¬åšä¸€ä¸ªæµ‹è¯•å­—èŠ‚ç æ¥æ£€æŸ¥æˆ‘ä»¬çš„è§‚ç‚¹ï¼š <br><br><pre> <code class="cpp hljs">start: .byte b_lit16 .word <span class="hljs-number"><span class="hljs-number">1234</span></span> .byte b_call16 .word dot - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_bye</code> </pre> <br> å½“ç„¶ï¼Œå®ƒä¸èƒ½ä¸€æ¬¡å…¨éƒ¨èµ·ä½œç”¨ã€‚ ä½†æ˜¯ï¼Œåœ¨è°ƒè¯•ä¹‹åï¼Œè·å¾—äº†ä»¥ä¸‹ç»“æœï¼š <br><br><pre> <code class="plaintext hljs">$ as forth.asm -o forth.o -g -ahlsm&gt;list.txt $ ld forth.o -o forth $ ./forth 1234bye!</code> </pre><br> é—¨æ¡†ç«‹å³å¯è§ã€‚ æ•°å­—åï¼Œå ¡å’åº”æ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ã€‚ åœ¨conv_startï¼ˆ&lt;ï¼ƒï¼‰è°ƒç”¨32 holdå‘½ä»¤ä¹‹åæ·»åŠ ã€‚ <br><br> æˆ‘ä»¬è¿˜å¾—å‡ºäº†æ ‡å¿—çš„ç»“è®ºã€‚ é¦–å…ˆï¼Œæ·»åŠ dup absï¼Œæœ€åï¼Œæ£€æŸ¥å·¦å‰¯æœ¬çš„ç¬¦å·ï¼Œå¹¶åœ¨æ•°å­—ä¸ºè´Ÿæ•°æ—¶æ”¾ç½®å‡å·ï¼ˆ0 &lt;å¦‚æœcâ€-åˆ™ä¿æŒï¼‰ã€‚ ç»“æœï¼Œå•è¯â€œã€‚â€ é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š <br><br><pre> <code class="cpp hljs">: . dup <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span> &lt;# <span class="hljs-number"><span class="hljs-number">32</span></span> hold <span class="hljs-meta"><span class="hljs-meta">#s drop #&gt; 0&lt; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> câ€³ - hold then type ;</span></span></code> </pre> <br> å­—èŠ‚ç ï¼š <br><br><pre> <code class="cpp hljs">dot: .byte b_dup .byte b_abs .byte b_call8 .byte conv_start - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_lit8 .byte <span class="hljs-string"><span class="hljs-string">' '</span></span> .byte b_call16 .word hold - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_call8 .byte conv_s - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_drop .byte b_zlt .byte b_qnbranch8 .byte <span class="hljs-number"><span class="hljs-number">1f</span></span> - . .byte b_lit8 .byte <span class="hljs-string"><span class="hljs-string">'-'</span></span> .byte b_call16 .word hold - . - <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: .byte b_call8 .byte conv_end - . - <span class="hljs-number"><span class="hljs-number">1</span></span> .byte b_type .byte b_exit</code> </pre> <br> åœ¨å­—èŠ‚å‘½ä»¤çš„å¼€å§‹é¡ºåºä¸­ï¼Œè¾“å…¥ä¸€ä¸ªè´Ÿæ•°å¹¶æ£€æŸ¥ï¼š <br><br><pre> <code class="plaintext hljs">$ as forth.asm -o forth.o -g -ahlsm&gt;list.txt $ ld forth.o -o forth $ ./forth -1234 bye!</code> </pre><br> æ•°å­—æœ‰ç»“è®ºï¼ <br><br><div class="spoiler">  <b class="spoiler_title">å…¨æ–‡</b> <div class="spoiler_text"><pre> <code class="cpp hljs">.intel_syntax noprefix stack_size = <span class="hljs-number"><span class="hljs-number">1024</span></span> .section .data init_stack: .quad <span class="hljs-number"><span class="hljs-number">0</span></span> init_rstack: .quad <span class="hljs-number"><span class="hljs-number">0</span></span> msg_bad_byte: .ascii <span class="hljs-string"><span class="hljs-string">"Bad byte code!\n"</span></span> msg_bad_byte_len = . - msg_bad_byte #  len    msg_bye: .ascii <span class="hljs-string"><span class="hljs-string">"bye!\n"</span></span> msg_bye_len = . - msg_bye bcmd: .quad bcmd_bad, bcmd_bye, bcmd_num0, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad # <span class="hljs-number"><span class="hljs-number">0x00</span></span> .quad bcmd_lit8, bcmd_lit16, bcmd_lit32, bcmd_lit64, bcmd_call8, bcmd_call16, bcmd_call32, bcmd_bad .quad bcmd_branch8, bcmd_branch16, bcmd_qbranch8, bcmd_qbranch16, bcmd_qnbranch8, bcmd_qnbranch16,bcmd_bad, bcmd_exit # <span class="hljs-number"><span class="hljs-number">0x10</span></span> .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_wm, bcmd_add, bcmd_sub, bcmd_mul, bcmd_div, bcmd_mod, bcmd_divmod, bcmd_abs # <span class="hljs-number"><span class="hljs-number">0x20</span></span> .quad bcmd_var0, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_dup, bcmd_drop, bcmd_swap, bcmd_rot, bcmd_mrot, bcmd_over, bcmd_pick, bcmd_roll # <span class="hljs-number"><span class="hljs-number">0x30</span></span> .quad bcmd_depth, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_get, bcmd_set, bcmd_get8, bcmd_set8, bcmd_get16, bcmd_set16, bcmd_get32, bcmd_set32 # <span class="hljs-number"><span class="hljs-number">0x40</span></span> .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_zeq, bcmd_zlt, bcmd_zgt, bcmd_eq, bcmd_lt, bcmd_gt, bcmd_lteq, bcmd_gteq #<span class="hljs-number"><span class="hljs-number">0x50</span></span> .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad # <span class="hljs-number"><span class="hljs-number">0x60</span></span> .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_type, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad # <span class="hljs-number"><span class="hljs-number">0x80</span></span> .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad .quad bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad, bcmd_bad start: .byte b_lit16 .word <span class="hljs-number"><span class="hljs-number">-1234</span></span> .byte b_call16 .word dot - . - <span class="hljs-number"><span class="hljs-number">2</span></span> .byte b_bye base: .byte b_var0 .quad <span class="hljs-number"><span class="hljs-number">10</span></span> holdbuf_len = <span class="hljs-number"><span class="hljs-number">70</span></span> holdbuf: .byte b_var0 .space holdbuf_len holdpoint: .byte b_var0 .quad <span class="hljs-number"><span class="hljs-number">0</span></span> # : hold holdpoint @ <span class="hljs-number"><span class="hljs-number">1</span></span>- dup holdbuf &gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> drop drop <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> dup holdpoint ! c! then ; hold: .byte b_call8 .byte holdpoint - . - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-meta"><span class="hljs-meta"># holdpoint .byte b_get # @ .byte b_wm # 1- .byte b_dup # dup .byte b_call8 .byte holdbuf - . - 1 # holdbuf .byte b_gt # &gt; .byte b_qbranch8 # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> .byte 0f - . .byte b_drop # drop .byte b_drop # drop .byte b_branch8 #     ( then) .byte 1f - . 0: .byte b_dup # dup .byte b_call8 .byte holdpoint - . - 1 # holdpoint .byte b_set # ! .byte b_set8 # c! 1: .byte b_exit # ; # : # base /mod swap dup 10 </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; if c" 0 + else 10 - c" A + then hold ; conv: .byte b_call16 .word base - . - 2 # base .byte b_get # @ .byte b_divmod # /mod .byte b_swap # swap .byte b_dup # dup .byte b_lit8 .byte 10 # 10 .byte b_lt # &lt; .byte b_qnbranch8 # if .byte 0f - . .byte b_lit8 .byte '0' # c" 0 .byte b_add # + .byte b_branch8 # else .byte 1f - . 0: .byte b_lit8 .byte '?' # c" A .byte b_add # + 1: .byte b_call16 .word hold - . - 2 # hold .byte b_exit # ; # : &lt;# holdbuf 70 + holdpoint ! ; conv_start: .byte b_call16 .word holdbuf - . - 2 .byte b_lit8 .byte holdbuf_len .byte b_add .byte b_call16 .word holdpoint - . - 2 .byte b_set .byte b_exit # : #s do # dup 0=until ; conv_s: .byte b_call8 .byte conv - . - 1 .byte b_dup .byte b_qbranch8 .byte conv_s - . .byte b_exit # : #&gt; holdpoint @ holdbuf 70 + over - ; conv_end: .byte b_call16 .word holdpoint - . - 2 .byte b_get .byte b_call16 .word holdbuf - . - 2 .byte b_lit8 .byte holdbuf_len .byte b_add .byte b_over .byte b_sub .byte b_exit dot: .byte b_dup .byte b_abs .byte b_call8 .byte conv_start - . - 1 .byte b_lit8 .byte ' ' .byte b_call16 .word hold - . - 2 .byte b_call8 .byte conv_s - . - 1 .byte b_drop .byte b_zlt .byte b_qnbranch8 .byte 1f - . .byte b_lit8 .byte '-' .byte b_call16 .word hold - . - 2 1: .byte b_call8 .byte conv_end - . - 1 .byte b_type .byte b_exit .section .text .global _start #     _start: mov rbp, rsp sub rbp, stack_size lea r8, start mov init_stack, rsp mov init_rstack, rbp jmp _next b_var0 = 0x28 bcmd_var0: push r8 b_exit = 0x17 bcmd_exit: mov r8, [rbp] add rbp, 8 _next: movzx rcx, byte ptr [r8] inc r8 jmp [bcmd + rcx*8] b_num0 = 0x02 bcmd_num0: push 0 jmp _next b_lit8 = 0x08 bcmd_lit8: movsx rax, byte ptr [r8] inc r8 push rax jmp _next b_lit16 = 0x09 bcmd_lit16: movsx rax, word ptr [r8] add r8, 2 push rax jmp _next b_call8 = 0x0C bcmd_call8: movsx rax, byte ptr [r8] sub rbp, 8 inc r8 mov [rbp], r8 add r8, rax jmp _next b_call16 = 0x0D bcmd_call16: movsx rax, word ptr [r8] sub rbp, 8 add r8, 2 mov [rbp], r8 add r8, rax jmp _next b_call32 = 0x0E bcmd_call32: movsx rax, dword ptr [r8] sub rbp, 8 add r8, 4 mov [rbp], r8 add r8, rax jmp _next b_lit32 = 0x0A bcmd_lit32: movsx rax, dword ptr [r8] add r8, 4 push rax jmp _next b_lit64 = 0x0B bcmd_lit64: mov rax, [r8] add r8, 8 push rax jmp _next b_dup = 0x30 bcmd_dup: push [rsp] jmp _next b_wm = 0x20 bcmd_wm: decq [rsp] jmp _next b_add = 0x21 bcmd_add: pop rax add [rsp], rax jmp _next b_sub = 0x22 bcmd_sub: pop rax sub [rsp], rax jmp _next b_mul = 0x23 bcmd_mul: pop rax pop rbx imul rbx push rax jmp _next b_div = 0x24 bcmd_div: pop rbx pop rax cqo idiv rbx push rax jmp _next b_mod = 0x25 bcmd_mod: pop rbx pop rax cqo idiv rbx push rdx jmp _next b_divmod = 0x26 bcmd_divmod: pop rbx pop rax cqo idiv rbx push rdx push rax jmp _next b_abs = 0x27 bcmd_abs: mov rax, [rsp] or rax, rax jge _next neg rax mov [rsp], rax jmp _next b_drop = 0x31 bcmd_drop: add rsp, 8 jmp _next b_swap = 0x32 bcmd_swap: pop rax pop rbx push rax push rbx jmp _next b_rot = 0x33 bcmd_rot: pop rax pop rbx pop rcx push rbx push rax push rcx jmp _next b_mrot = 0x34 bcmd_mrot: pop rcx pop rbx pop rax push rcx push rax push rbx jmp _next b_over = 0x35 bcmd_over: push [rsp + 8] jmp _next b_pick = 0x36 bcmd_pick: pop rcx push [rsp + 8*rcx] jmp _next b_roll = 0x37 bcmd_roll: pop rcx mov rbx, [rsp + 8*rcx] roll1: mov rax, [rsp + 8*rcx - 8] mov [rsp + 8*rcx], rax dec rcx jnz roll1 push rbx jmp _next b_depth = 0x38 bcmd_depth: mov rax, init_stack sub rax, rsp shr rax, 3 push rax jmp _next b_get = 0x40 bcmd_get: pop rcx push [rcx] jmp _next b_set = 0x41 bcmd_set: pop rcx pop rax mov [rcx], rax jmp _next b_get8 = 0x42 bcmd_get8: pop rcx movsx rax, byte ptr [rcx] push rax jmp _next b_set8 = 0x43 bcmd_set8: pop rcx pop rax mov [rcx], al jmp _next b_get16 = 0x44 bcmd_get16: pop rcx movsx rax, word ptr [rcx] push rax jmp _next b_set16 = 0x45 bcmd_set16: pop rcx pop rax mov [rcx], ax jmp _next b_get32 = 0x46 bcmd_get32: pop rcx movsx rax, dword ptr [rcx] push rax jmp _next b_set32 = 0x47 bcmd_set32: pop rcx pop rax mov [rcx], eax jmp _next # 0= b_zeq = 0x50 bcmd_zeq: pop rax or rax, rax jnz rfalse rtrue: push -1 jmp _next rfalse: push 0 jmp _next # 0&lt; b_zlt = 0x51 bcmd_zlt: pop rax or rax, rax jl rtrue push 0 jmp _next # 0&gt; b_zgt = 0x52 bcmd_zgt: pop rax or rax, rax jg rtrue push 0 jmp _next # = b_eq = 0x53 bcmd_eq: pop rbx pop rax cmp rax, rbx jz rtrue push 0 jmp _next # &lt; b_lt = 0x54 bcmd_lt: pop rbx pop rax cmp rax, rbx jl rtrue push 0 jmp _next # &gt; b_gt = 0x55 bcmd_gt: pop rbx pop rax cmp rax, rbx jg rtrue push 0 jmp _next # &lt;= b_lteq = 0x56 bcmd_lteq: pop rbx pop rax cmp rax, rbx jle rtrue push 0 jmp _next # &gt;= b_gteq = 0x57 bcmd_gteq: pop rbx pop rax cmp rax, rbx jge rtrue push 0 jmp _next b_branch8 = 0x10 bcmd_branch8: movsx rax, byte ptr [r8] add r8, rax jmp _next b_branch16 = 0x11 bcmd_branch16: movsx rax, word ptr [r8] add r8, rax jmp _next b_qbranch8 = 0x12 bcmd_qbranch8: pop rax or rax, rax jnz bcmd_branch8 inc r8 jmp _next b_qbranch16 = 0x13 bcmd_qbranch16: pop rax or rax, rax jnz bcmd_branch16 add r8, 2 jmp _next b_qnbranch8 = 0x14 bcmd_qnbranch8: pop rax or rax, rax jz bcmd_branch8 inc r8 jmp _next b_qnbranch16 = 0x15 bcmd_qnbranch16:pop rax or rax, rax jz bcmd_branch16 add r8, 2 jmp _next b_bad = 0x00 bcmd_bad: mov rax, 1 #   â„– 1 - sys_write mov rdi, 1 #  â„– 1 â€” stdout mov rsi, offset msg_bad_byte #     mov rdx, msg_bad_byte_len #   syscall #   mov rax, 60 #   â„– 1 - sys_exit mov rbx, 1 #    1 syscall #   b_bye = 0x01 bcmd_bye: mov rax, 1 #   â„– 1 - sys_write mov rdi, 1 #  â„– 1 â€” stdout mov rsi, offset msg_bye #     mov rdx, msg_bye_len #   syscall #   mov rax, 60 #   â„– 60 - sys_exit mov rdi, 0 #    0 syscall #   b_type = 0x80 bcmd_type: mov rax, 1 #   â„– 1 - sys_write mov rdi, 1 #  â„– 1 - stdout pop rdx pop rsi push r8 syscall #   pop r8 jmp _next</span></span></span></span></code> </pre></div></div><br><h4> æ€»ç»“ </h4><br> ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†å­—èŠ‚å‘½ä»¤çš„ç›¸å½“ä¸é”™çš„æ ¸å¿ƒï¼šæ‰€æœ‰åŸºæœ¬ç®—æœ¯ï¼Œå †æ ˆæ“ä½œï¼Œæ¯”è¾ƒæ“ä½œï¼Œä½¿ç”¨å†…å­˜å’Œå˜é‡ã€‚ å¦å¤–ï¼Œå·²ç»æœ‰æ•°å­—è¾“å‡ºï¼Œå®Œå…¨ä»¥å­—èŠ‚ç å®ç°ã€‚ å£è¯‘å‘˜å·²å‡†å¤‡å¥½ä¸€åˆ‡ï¼Œè¿™å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å®Œæˆï¼ <br><br> ç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼ <br><br> æ¬¢è¿æ‰¹è¯„ï¼  :) <br><br>  Continuationï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¾æ´²å°ç¬¬å®‰äººå ¡å’çš„å­—èŠ‚æœºï¼ˆä¸ä»…å¦‚æ­¤ï¼‰ï¼ˆç¬¬3éƒ¨åˆ†ï¼‰</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN433836/">https://habr.com/ru/post/zh-CN433836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN433826/index.html">æŸ¿å­2.0ä½¿ç”¨è¯´æ˜</a></li>
<li><a href="../zh-CN433828/index.html">ä½¿ç”¨QMLåœ°å›¾æ„å»ºèˆªç©º-ç¬¬1éƒ¨åˆ†</a></li>
<li><a href="../zh-CN433830/index.html">æ–°å‹LED Diallç¯</a></li>
<li><a href="../zh-CN433832/index.html">Linuxä¸­çš„ClangFormatæºä»£ç æ ¼å¼ï¼šé—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="../zh-CN433834/index.html">æ­£å¦‚IvanæŒ‡æ ‡ä¸€æ ·ï¼ŒDevOpsä¹Ÿæ˜¯å¦‚æ­¤ã€‚ å¼€å§‹</a></li>
<li><a href="../zh-CN433838/index.html">çº¦ä¹¦äºšÂ·æ‰çº³ï¼ˆJoshua Zaynerï¼‰çš„ç”Ÿç‰©é»‘å®¢å…¬å¼€ä¿¡</a></li>
<li><a href="../zh-CN433842/index.html">[æ˜ŸæœŸäº”]å¤å¤æ˜¾ç¤ºå™¨å’Œå…¶ä»–è¡¨é¢ä¸Šçš„ASCIIæ¶‚é¸¦</a></li>
<li><a href="../zh-CN433844/index.html">å…³äºITæˆåŠŸå·¥ä½œæ‰€éœ€çš„ä¸‰ä¸ªç»„ä»¶</a></li>
<li><a href="../zh-CN433846/index.html">æ ¸ç”µç«™é—®ä¸–ä¹‹å‰çš„æ ¸ç”µ</a></li>
<li><a href="../zh-CN433848/index.html">è‹¹æœç”µåŠ¨è½¦ä¸“åˆ©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>