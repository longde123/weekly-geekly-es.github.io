<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ช๏ธ ๐ป Nginx cache: ูู ุดูุก ุฌุฏูุฏ - ูุฏูู ุงูููุณู ๐ฎ ๐ฉ๐ผโ๐จ ๐คด๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุญูุงุฉ ูู ูุดุฑูุน ุ ูุฃุชู ุงูููุช ุงูุฐู ูุชููู ููู ุงูุฎุงุฏู ุนู ุชูุจูุฉ ูุชุทูุจุงุช ุงุชูุงููุฉ ูุณุชูู ุงูุฎุฏูุฉ ููุจุฏุฃ ูุนูููุง ูู ุฎูู ูููุฉ ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ. ุจุนุฏ ุฐูู ุ ุชุจุฏุฃ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nginx cache: ูู ุดูุก ุฌุฏูุฏ - ูุฏูู ุงูููุณู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428127/" style=";text-align:right;direction:rtl">  ูู ุญูุงุฉ ูู ูุดุฑูุน ุ ูุฃุชู ุงูููุช ุงูุฐู ูุชููู ููู ุงูุฎุงุฏู ุนู ุชูุจูุฉ ูุชุทูุจุงุช ุงุชูุงููุฉ ูุณุชูู ุงูุฎุฏูุฉ ููุจุฏุฃ ูุนูููุง ูู ุฎูู ูููุฉ ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ.  ุจุนุฏ ุฐูู ุ ุชุจุฏุฃ ุงูุนูููุฉ ุงูุทูููุฉ ููุจุญุซ ุนู ุงูุงุฎุชูุงูุงุช ุฃู ุงูุงุณุชุนูุงูุงุช ุงูุซูููุฉ ุฃู ุงูููุงุฑุณ ุงูุชู ุชู ุฅูุดุงุคูุง ุจุดูู ุบูุฑ ุตุญูุญ ุฃู ุงูุจูุงูุงุช ุบูุฑ ุงููุฎุฒูุฉ ูุคูุชูุง ุฃู ุงูุนูุณ ุจุงูุนูุณ ุ ูุงูุชู ุบุงูุจูุง ูุง ูุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุงูุฌูุงูุจ ุงููุธููุฉ ุงูุฃุฎุฑู ูููุดุฑูุน. <br><br>  ูููู ูุงุฐุง ุชูุนู ุนูุฏูุง ูููู ุฑูุฒู "ูุซุงูููุง" ุ ููุชู ูุถุน ุฌููุน ุงูุทูุจุงุช ุงูุซูููุฉ ูู ุงูุฎูููุฉ ุ ููู ุดูุก ูุงู ูููููุง ุชู ุชุฎุฒููู ูุคูุชูุง ุ ููุง ูุฒุงู ุงูุฎุงุฏู ูุง ูุตู ุฅูู ูุคุดุฑุงุช ุงุชูุงููุฉ ูุณุชูู ุงูุฎุฏูุฉ ุงูุชู ูุญุชุงุฌูุงุ  ุฅุฐุง ุฃููู ุ ุจุงูุทุจุน ููููู ุดุฑุงุก ุณูุงุฑุงุช ุฌุฏูุฏุฉ ุ ูุชูุฒูุน ุจุนุถ ุญุฑูุฉ ุงููุฑูุฑ ููุณูุงู ุงููุดููุฉ ููุชุฑุฉ ูู ุงูููุช. <br><br>  ูููู ุฅุฐุง ูุงู ูุฏูู ุดุนูุฑ ุจุฃู ุงูุฎุงุฏู ุงูุฎุงุต ุจู ูุงุฏุฑ ุนูู ุงููุฒูุฏ ุ ุฃู ุฃู ููุงู ูุนููุฉ ุณุญุฑูุฉ ุชุณุฑุน ุงููููุน 100 ูุฑุฉ ุ ูููููู ุชุฐูุฑ ููุฒุฉ nginx ุงููุถููุฉ ุงูุชู ุชุณูุญ ูู ุจุชุฎุฒูู ุงูุงุณุชุฌุงุจุงุช ูู ุงูุฎูููุฉ.  ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ูุง ูู ูููู ูููู ุฃู ูุณุงุนุฏ ูู ุฒูุงุฏุฉ ุนุฏุฏ ุงูุทูุจุงุช ุงูุชู ุชุชู ูุนุงูุฌุชูุง ุจูุงุณุทุฉ ุงูุฎุงุฏู. <a name="habracut"></a><br><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู Nginx cache ูููู ูุนููุ </h3><br>  ูููู ุฃู ุชููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู Nginx ุนุฏุฏ ุทูุจุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ุจุดูู ููุญูุธ.  ูุชู ุชุญููู ุฐูู ุนู ุทุฑูู ุญูุธ ุงุณุชุฌุงุจุฉ HTTP ููุชุฑุฉ ูุนููุฉ ุ ูุนูุฏ ุงููุตูู ุฅูู ุงูููุฑุฏ ูุฑุฉ ุฃุฎุฑู ุ ูุฅุนุงุฏุชู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุฏูู ุฅุฌุฑุงุก ูููู ูุทูุจ ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ุงูุชุฎุฒูู ุงููุคูุช ุ ุญุชู ููุชุฑุฉ ูุตูุฑุฉ ุ ุณูุนุทู ุฒูุงุฏุฉ ูุจูุฑุฉ ูู ุนุฏุฏ ุงูุทูุจุงุช ุงููุนุงูุฌุฉ ูู ูุจู ุงูุฎุงุฏู. <br><br>  ูุจู ูุชุงุจุนุฉ ุชูููู nginx ุ ูุฌุจ ุฃู ุชุชุฃูุฏ ูู ุฃูู ุชู ุฅูุดุงุคู ุจุงุณุชุฎุฏุงู ุงููุญุฏุฉ ุงูููุทูุฉ "ngx_http_proxy_module" ุ ุญูุซ ุณูููู ุจุชููููู ุจุงุณุชุฎุฏุงู ูุฐู ุงููุญุฏุฉ. <br><br>  ููุฑุงุญุฉ ุ ููููู ููู ุงูุชูููู ุฅูู ููู ูููุตู ุ ุนูู ุณุจูู ุงููุซุงู ุ "/etc/nginx/conf.d/cache.conf".  ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุชูุฌูู proxy_cache_path ุ ุงูุฐู ูุณูุญ ูู ุจุชูููู ุฅุนุฏุงุฏุงุช ุชุฎุฒูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br><br><pre style=";text-align:right;direction:rtl"><code class="hljs swift">proxy_cache_path /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/nginx/proxy_cache levels=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span> keys_zone=proxy_cache:15m max_size=1G;</code> </pre> <br>  ูุญุฏุฏ "/ Var / lib / nginx / proxy_cache" ูุณุงุฑ ุชุฎุฒูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุนูู ุงูุฎุงุฏู.  ูู ูุฐุง ุงูุฏููู ุ ุณูุญูุธ nginx ุงููููุงุช ููุณูุง ุจุงูุงุณุชุฌุงุจุฉ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ูู ุงูููุช ููุณู ุ ูู ูููู nginx ุจุฅูุดุงุก ุฏููู ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุดูู ูุณุชูู ุ ูุนููู ุงูุงูุชูุงู ุจูุฐุง ุจููุณู. <br><br>  "ุงููุณุชููุงุช = 1: 2" - ูุถุจุท ูุณุชูู ุชุฏุงุฎู ุงูุฏูุงุฆู ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ูุดุงุฑ ุฅูู ูุณุชููุงุช ุงูุชุนุดูุด ูู ุฎูุงู ":" ุ ูู ูุฐู ุงูุญุงูุฉ ุณูุชู ุฅูุดุงุก ุฏููููู ุ ูู ูุฌููุน 3 ูุณุชููุงุช ุชุฏุงุฎู ูุณููุญ ุจูุง.  ููู ูุณุชูู ุชุฏุงุฎู ุ ุชุชููุฑ ููู ูู 1 ุฅูู 2 ุ ุชุดูุฑ ุฅูู ููููุฉ ุฅูุดุงุก ุงุณู ุงูุฏููู. <br><br>  ุงูููุทุฉ ุงููููุฉ ูู ุฃูู ูุง ูุชู ุงุฎุชูุงุฑ ุงุณู ุงูุฏููู ุจุดูู ุนุดูุงุฆู ุ ูููู ูุชู ุฅูุดุงุคู ุจูุงุกู ุนูู ุงุณู ุงูููู.  ุงุณู ุงูููู ุ ุจุฏูุฑู ุ ูู ูุชูุฌุฉ ูุธููุฉ md5 ูู ููุชุงุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุณููุธุฑ ูู ููุชุงุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุนุฏ ุฐูู ุจูููู. <br><br>  ุฏุนููุง ูุฑู ุนูููุง ููู ูุชู ุจูุงุก ุงููุณุงุฑ ุฅูู ููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs swift">/<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/lib/nginx/proxy_cache/<span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">49</span></span>/07edcfe6974569ab4da6634ad4e5d492</code> </pre> <br>  ุชุญุฏุฏ ุงููุนููุฉ โKeys_zone = proxy_cache: 15mโ ุงุณู ุงูููุทูุฉ ูู ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ ุ ุญูุซ ูุชู ุชุฎุฒูู ุฌููุน ุงูููุงุชูุญ ูุงููุนูููุงุช ุงููุดุทุฉ ุนูููุง.  ูุดูุฑ ":" ุฅูู ุญุฌู ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ุจุงูููุบุงุจุงูุช.  ููููุง ูู nginx ุ ูููู 1 ููุบุงุจุงูุช ูุชุฎุฒูู 8 ุขูุงู ููุชุงุญ. <br><br>  ูุญุฏุฏ "Max_size = 1G" ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุฌููุน ุงูุตูุญุงุช ุงูุชู ุณูุชููู nginx ุฃุนูุงู ุญุฐู ุงูุจูุงูุงุช ุงูุฃูู ุญุงุฌุฉ ุฅูููุง. <br><br>  ูู ุงููููู ุฃูุถูุง ุงูุชุญูู ูู ุนูุฑ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุฐูู ูููู ุชุญุฏูุฏ ุงููุนููุฉ "ุบูุฑ ุงููุดุทุฉ" ูุชูุฌูู "proxy_cache_path" ุ ููู 10 ุฏูุงุฆู ุงูุชุฑุงุถููุง.  ุฅุฐุง ูู ุชูู ููุงู ุงุณุชุฏุนุงุกุงุช ูุจูุงูุงุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุฎูุงู ุงููุชุฑุฉ ุงููุญุฏุฏุฉ ูู ุงููุนููุฉ "ุบูุฑ ุงููุดุทุฉ" ุ ูุณูุชู ุญุฐู ูุฐู ุงูุจูุงูุงุช ุญุชู ุฅุฐุง ูู ุชูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช "ุญุงูุถุฉ" ุญุชู ุงูุขู. <br><br>  ููู ุชุจุฏู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุฐูุ  ูุฐุง ูู ุงููุงูุน ููู ุนุงุฏู ุนูู ุงูุฎุงุฏู ุ ุชุชู ูุชุงุจุฉ ูุญุชููุงุชู: <br><br>  โข ููุชุงุญ ุงูุชุฎุฒูู ุงููุคูุช ุ <br>  โข ุฑุคูุณ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ <br>  โข ุงุณุชุฌุงุจุฉ ุงููุญุชูู ูู ุงูุฎูููุฉ. <br><br>  ุฅุฐุง ูุงู ูู ุดูุก ูุงุถุญูุง ูุน ุงูุฑุคูุณ ูุงูุงุณุชุฌุงุจุฉ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ูููุงู ุนุฏุฏ ูู ุงูุฃุณุฆูุฉ ุนูู "ููุชุงุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช".  ููู ูุชู ุจูุงุฆู ูููู ูููู ุฅุฏุงุฑุชูุ <br><br>  ููุตู ุงููุงูุจ ูุจูุงุก ููุชุงุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู nginx ุ ููุงู ุชูุฌูู proxy_cache_key ุ ุญูุซ ูุชู ุชุญุฏูุฏ ุงูุณูุณูุฉ ููุนููุฉ.  ูููู ุฃู ุชุชููู ุงูุณูุณูุฉ ูู ุฃู ูุชุบูุฑุงุช ูุชููุฑุฉ ูู nginx. <br><br>  ุนูู ุณุจูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_key</span></span> <span class="hljs-variable"><span class="hljs-variable">$request_method</span></span><span class="hljs-variable"><span class="hljs-variable">$host</span></span><span class="hljs-variable"><span class="hljs-variable">$orig_uri</span></span>:<span class="hljs-variable"><span class="hljs-variable">$cookie_some_cookie</span></span>:<span class="hljs-variable"><span class="hljs-variable">$arg_some_arg</span></span>;</code> </pre> <br>  ูุชู ุงุณุชุฎุฏุงู ุงูุฑูุฒ ":" ุจูู ูุนููุฉ ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท ููุนููุฉ get ูููุน ุงูุชุตุงุฏู ุจูู ููุงุชูุญ ุงูุชุฎุฒูู ุงููุคูุช ุ ููููู ุงุฎุชูุงุฑ ุฃู ุฑูุฒ ุขุฎุฑ ูู ุงุฎุชูุงุฑู.  ุจุดูู ุงูุชุฑุงุถู ุ ูุณุชุฎุฏู nginx ุงูุณุทุฑ ุงูุชุงูู ูุฅูุดุงุก ุงูููุชุงุญ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_key</span></span> <span class="hljs-variable"><span class="hljs-variable">$scheme</span></span><span class="hljs-variable"><span class="hljs-variable">$proxy_host</span></span><span class="hljs-variable"><span class="hljs-variable">$request_uri</span></span>;</code> </pre> <br>  ูุฌุจ ููุงุญุธุฉ ุงูุชูุฌููุงุช ุงูุชุงููุฉ ุงูุชู ุณุชุณุงุนุฏู ุนูู ุฅุฏุงุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุดูู ุฃูุซุฑ ูุฑููุฉ: <br><br>  <i>proxy_cache_valid</i> - ูุญุฏุฏ ููุช ุงูุชุฎุฒูู ุงููุคูุช ููุงุณุชุฌุงุจุฉ.  ูู ุงููููู ุงูุฅุดุงุฑุฉ ุฅูู ุงูุญุงูุฉ ุงููุญุฏุฏุฉ ููุงุณุชุฌุงุจุฉ ุ ุนูู ุณุจูู ุงููุซุงู 200 ุ 302 ุ 404 ุ ุฅูุฎ ุ ุฃู ุชุญุฏูุฏ ูู ุดูุก ุฏูุนุฉ ูุงุญุฏุฉ ุจุงุณุชุฎุฏุงู ุงูุจูุงุก "ุฃู".  ุฅุฐุง ุชู ุชุญุฏูุฏ ููุช ุงูุชุฎุฒูู ุงููุคูุช ููุท ุ ูุณูููู nginx ุงูุชุฑุงุถููุง ููุชุฎุฒูู ุงููุคูุช ูุญุงูุงุช 200 ู 301 ู 302 ููุท. <br><br>  ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_valid</span></span> <span class="hljs-number"><span class="hljs-number">15m</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_valid</span></span> <span class="hljs-number"><span class="hljs-number">404</span></span> <span class="hljs-number"><span class="hljs-number">15s</span></span>;</code> </pre><br>  ูู ูุฐุง ุงููุซุงู ุ ูููุง ุจุชุนููู ุนูุฑ ุงูุชุฎุฒูู ุงููุคูุช ุนูู 15 ุฏูููุฉ ููุญุงูุงุช 200 ุ 301 ุ 302 (ุชุณุชุฎุฏููุง nginx ุจุดูู ุงูุชุฑุงุถู ุ ุญูุซ ูู ูุญุฏุฏ ุญุงูุฉ ูุนููุฉ).  ูุถุจุท ุงูุณุทุฑ ุงูุชุงูู ููุช ุงูุชุฎุฒูู ุงููุคูุช ุนูู 15 ุซุงููุฉ ุ ููุท ููุฑุฏูุฏ ุจุงูุญุงูุฉ 404. <br><br>  <i>proxy_cache_lock</i> - <i>ุณูุณุงุนุฏ</i> ูุฐุง ุงูุชูุฌูู ุนูู ุชุฌูุจ ุงูุชูุฑูุฑุงุช ุงููุชุนุฏุฏุฉ ูููุงุฌูุฉ ุงูุฎูููุฉ ูุจุงุดุฑุฉ ุจุนุฏ ูุฌููุนุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ููุท ูู ุจุชุนููู ุงููููุฉ ูู ุงููุถุน "ุชุดุบูู".  ุณุชูุชุธุฑ ุฌููุน ุงูุทูุจุงุช ุงูุฃุฎุฑู ุงุณุชุฌุงุจุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุฃู ูููุฉ ูุญุธุฑ ุงูุทูุจ ุนูู ุงูุตูุญุฉ.  ููููุง ูุฐูู ุ ูููู ุชูููู ูู ุงููููุงุช. <br><br>  <i>proxy_cache_lock_age</i> - ูุณูุญ ูู ุจุชุนููู ุญุฏ ุงููููุฉ ูุงุณุชุฌุงุจุฉ ูู ุงูุฎุงุฏู ุ ูุจุนุฏ ุฐูู ุณูุชู ุฅุฑุณุงู ุงูุทูุจ ุงูุชุงูู ุฅููู ุจุนุฏ ุชุนููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ูู 5 ุซูุงู. <br><br>  <i>proxy_cache_lock_timeout</i> - <i>ูุถุจุท</i> ููุช ุงูุชุธุงุฑ ุงูููู ุ ูุจุนุฏ ุฐูู ุณูุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ูููู ูู ูุชู ุชุฎุฒูู ุงูุงุณุชุฌุงุจุฉ ูุคูุชูุง.  ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ูู 5 ุซูุงู. <br><br>  <i>proxy_cache_use_stale</i> - ุชูุฌูู ูููุฏ ุขุฎุฑ ูุณูุญ ูู ุจุงูุชูููู ุนูุฏูุง ูููู ูู ุงููููู ุงุณุชุฎุฏุงู ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช ูุฏููุฉ. <br><br>  ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_use_stale</span></span> <span class="hljs-literal"><span class="hljs-literal">error</span></span> timeout updating;</code> </pre> <br>  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุณุชุฎุฏู ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช ูุฏููุฉ ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ูู ุงูุงุชุตุงู ุ ุฃู ุฅุฑุณุงู ุทูุจ ุ ุฃู ูุฑุงุกุฉ ุงุณุชุฌุงุจุฉ ูู ุงูุฎุงุฏู ุ ุฃู ุชุฌุงูุฒ ุญุฏ ุงูุงูุชุธุงุฑ ูุฅุฑุณุงู ุทูุจ ุ ุฃู ูุฑุงุกุฉ ุงุณุชุฌุงุจุฉ ูู ุงูุฎุงุฏู ุ ุฃู ุฅุฐุง ุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ููุช ุงูุทูุจ. <br><br>  <i>proxy_cache_bypass</i> - ุชุญุฏุฏ ุงูุดุฑูุท ุงูุชู ูู <i>ุชุชููู</i> ูููุง nginx ุงุณุชุฌุงุจุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูููููุง ุชุนูุฏ ุชูุฌูู ุงูุทูุจ ุนูู ุงูููุฑ ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ุฅุฐุง ูุงูุช ุฅุญุฏู ุงููุนููุงุช ุนูู ุงูุฃูู ููุณุช ูุงุฑุบุฉ ููุง ุชุณุงูู "0".  ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy_cache_bypass</span></span> <span class="hljs-variable"><span class="hljs-variable">$cookie_nocache</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_nocache</span></span>;</code> </pre> <br>  <i>proxy_no_cache</i> - ุชุนููู ุงูุญุงูุฉ ุงูุชู ูู ูุญูุธ ูููุง nginx ุงูุงุณุชุฌุงุจุฉ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุฅูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ูุจุฏุฃ ุงูุชุดุบูู ูู ููุณู ูุจุฏุฃ ุชูุฌูู proxy_cache_bypass. <br><br><h3 style=";text-align:right;direction:rtl">  ุงููุดุงูู ุงููุญุชููุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช ููุตูุญุฉ </h3><br>  ููุง ุฐูุฑ ุฃุนูุงู ุ ุฅูู ุฌุงูุจ ุงูุชุฎุฒูู ุงููุคูุช ูุงุณุชุฌุงุจุฉ HTTP ุ ูุญูุธ nginx ุงูุฑุคูุณ ุงููุชููุงุฉ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ุฅุฐุง ูุงู ูููุนู ูุณุชุฎุฏู ุฌูุณุฉ ุ ูุณูุชู ุฃูุถูุง ุชุฎุฒูู ููู ุชุนุฑูู ุงุฑุชุจุงุท ุงูุฌูุณุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุณูุชููู ุฌููุน ุงููุณุชุฎุฏููู ุงูุฐูู ูุฒูุฑูู ุงูุตูุญุฉ ุงูุชู ููุช ูุญุธูุธูุง ูููุง ุงูุชุฎุฒูู ุงููุคูุช ุจูุงูุงุชู ุงูุดุฎุตูุฉ ุงููุฎุฒูุฉ ูู ุงูุฌูุณุฉ. <br><br>  ุงูุชุญุฏู ุงูุชุงูู ุงูุฐู ุณุชูุงุฌูู ูู ุฅุฏุงุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุจุงูุทุจุน ุ ููููู ุถุจุท ููุช ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช ุบูุฑ ููู ูู 2-5 ุฏูุงุฆู ูุณูููู ูุฐุง ูุงูููุง ูู ูุนุธู ุงูุญุงูุงุช.  ููู ูุฐุง ูุง ููุทุจู ูู ุฌููุน ุงูููุงูู ุ ูุฐูู ุณูุนูุฏ ุงุจุชูุงุฑ ุฏุฑุงุฌุชูุง.  ุงูุขู ุ ุฃูู ุดูุก ุฃููุงู. <br><br>  <b>ุฅุฏุงุฑุฉ ุญูุธ ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท</b> <br><br>  ุงูุชุฎุฒูู ุงููุคูุช ุนูู ุงูุฌุงูุจ nginx ููุฑุถ ุจุนุถ ูููุฏ ุงูุชุตููู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุง ูููููุง ุงุณุชุฎุฏุงู ุงูุฌูุณุงุช ุนูู ุงูุตูุญุงุช ุงููุฎุจุฃุฉ ุ ุญูุซ ูุง ูุตู ุงููุณุชุฎุฏู ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ูููุงู ูููุฏ ุฃุฎุฑู ูู ุชุณููู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ูุจู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ูุธุฑูุง ูุฃู nginx ุชุฎุฒู ุฌููุน ุงูุฑุคูุณ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุชุฌูุจ ุชุฎุฒูู ุฌูุณุฉ ุดุฎุต ุขุฎุฑ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุญุชุงุฌ ุฅูู ุญุธุฑ ุชุณููู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ููุตูุญุงุช ุงููุฎุฒูุฉ ูุคูุชูุง.  ุณูุณุงุนุฏูุง ุชูุฌูู proxy_ignore_headers ูู ุฐูู.  ุชุณุฑุฏ ุงููุณูุทุฉ ุงูุฑุคูุณ ุงูุชู ูุฌุจ ุชุฌุงูููุง ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ. <br><br>  ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">proxy_ignore_headers</span></span> <span class="hljs-string"><span class="hljs-string">"Set-Cookie"</span></span>;</code> </pre> <br>  ูุน ูุฐุง ุงูุฎุท ุ ูุชุฌุงูู ุชุซุจูุช ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ุงูุฎุงุฏู ุงููููู ุ ุฃู ุฃู ุงููุณุชุฎุฏู ุณูุชููู ุงุณุชุฌุงุจุฉ ุจุฏูู ุฑุฃุณ "Set-Cookies".  ููููุง ูุฐูู ุ ุณูุชู ุชุฌุงูู ูู ุดูุก ุญุงููุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุชุงุจุชู ุฅูู ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ุฌุงูุจ ุงูุนููู ุ ูุฃูู ูู ูุนุฑู ุญุชู ุฃู ููุงู ุดูุฆูุง ูุฎุตุตูุง ูู.  ูุฌุจ ูุฑุงุนุงุฉ ุชูููุฏ ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท ูุฐุง ุนูุฏ ุชุทููุฑ ุชุทุจูู.  ุนูู ุณุจูู ุงููุซุงู ุ ูุทูุจ ุชูููุถ ุ ููููู ุฅููุงู ุชุดุบูู ุงูุฅุดุนุงู ุจุญูุซ ูุชููู ุงููุณุชุฎุฏู ููู ุชุนุฑูู ุงุฑุชุจุงุท ุงูุฌูุณุฉ. <br><br>  ูุฌุจ ุฃู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุฃูุถูุง ูุฏุฉ ุงูุฌูุณุฉ ุ ุญูุซ ูููู ุนุฑุถูุง ูู ูุนููุฉ " <i>session.gc_maxlifetime</i> " ูุชูููู php.ini.  ุชุฎูู ุฃู ุงููุณุชุฎุฏู ูุงู ุจุชุณุฌูู ุงูุฏุฎูู ุฅูู ุงููููุน ูุจุฏุฃ ูู ุนุฑุถ ููุฌุฒ ุงูุฃุฎุจุงุฑ ุ ูู ุงูุจูุงูุงุช ููุฌูุฏุฉ ุจุงููุนู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู nginx.  ุจุนุฏ ูุฑูุฑ ุจุนุถ ุงูููุช ุ ููุงุญุธ ุงููุณุชุฎุฏู ุฃู ุชูููุถู ูุฏ ุงุฎุชูู ููุญุชุงุฌ ูุฑุฉ ุฃุฎุฑู ููุฎุถูุน ูุนูููุฉ ุงูุชูููุถ ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุงู ุทูุงู ุงูููุช ูู ุงููููุน ูุดุงูุฏ ุงูุฃุฎุจุงุฑ.  ุญุฏุซ ูุฐุง ูุฃู nginx ูู ุฌููุน ุทูุจุงุชูุง ุฃุนุงุฏุช ุงููุชูุฌุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุฏูู ุฅุฑุณุงู ุทูุจ ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ูุฐูู ุ ูุฑุฑุช ุงูุฎูููุฉ ุฃู ุงููุณุชุฎุฏู ูุงู ุบูุฑ ูุดุท ูุจุนุฏ ุญุฐู ุงูููุช ุงููุญุฏุฏ ูู " <i>session.gc_maxlifetime</i> " ุญุฐู ููู ุงูุฌูุณุฉ. <br><br>  ูููุน ุญุฏูุซ ุฐูู ุ ูููููุง ูุญุงูุงุฉ ุทูุจุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุฎูุงู ajax ุ ุฃุฑุณู ุทูุจูุง ุณูุชู ุถูุงู ุชูุฑูุฑู ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ.  ูุชูุฑูุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช nginx ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ููุท ุฃุฑุณู ุทูุจ POST ุ ููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุงููุงุนุฏุฉ ูู ุชูุฌูู "proxy_cache_bypass" ุ ุฃู ุจุจุณุงุทุฉ ูู ุจุชุนุทูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุฐู ุงูุตูุญุฉ.  ูุง ูุฌุจ ุฃู ูุนูุฏ ุงูุทูุจ ุดูุฆูุง ูุง ุ ูููู ุฃู ูููู ููููุง ุจุณุทุฑ ูุงุญุฏ ูุจุฏุฃ ุงูุฌูุณุฉ.  ุงูุบุฑุถ ูู ูุซู ูุฐุง ุงูุทูุจ ูู ุฅุทุงูุฉ ุนูุฑ ุงูุฌูุณุฉ ุฃุซูุงุก ูุฌูุฏ ุงููุณุชุฎุฏู ุนูู ุงููููุน ุ ูุชุนุทู nginx ุจุถููุฑ ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูุคูุชูุง ูุฌููุน ุทูุจุงุชูุง. <br><br>  <b>ุฅุฏุงุฑุฉ ุชุฏูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช</b> <br><br>  ุชุญุชุงุฌ ุฃููุงู ุฅูู ุชุญุฏูุฏ ุงููุชุทูุจุงุช ุ ูุง ุงููุฏู ุงูุฐู ูุญุงูู ุชุญูููู.  ูููุชุฑุถ ุฃู ูููุนูุง ูุญุชูู ุนูู ูุณู ุจู ุจุซ ูุตู ููุฃุญุฏุงุซ ุงูุฑูุงุถูุฉ ุงูุดููุฑุฉ.  ุนูุฏ ุชุญููู ุงูุตูุญุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุชุฃุชู ุฌููุน ุงูุฑุณุงุฆู ุงูุฌุฏูุฏุฉ ุนูู ูุขุฎุฐ.  ุญุชู ูุชููู ุงููุณุชุฎุฏู ูู ุฑุคูุฉ ุงูุฑุณุงุฆู ุงูุญุงููุฉ ูู ุงูููุช ุงูุญุงูู ูู ุงูุชูููุฏ ุงูุฃูู ุ ุจุฏูุงู ูู 15 ุฏูููุฉ ุ ูุญุชุงุฌ ุฅูู ุฃู ูุชููู ูู ูุณุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู nginx ุจุดูู ูุณุชูู ูู ุฃู ููุช.  ูู ููุณ ุงูููุช ุ ูุฏ ูุง ูููู nginx ููุฌูุฏูุง ุนูู ููุณ ุงูุฌูุงุฒ ูุซู ุงูุชุทุจูู.  ุฃูุถูุง ุ ุณูููู ุฃุญุฏ ูุชุทูุจุงุช ุฅุนุงุฏุฉ ุงูุถุจุท ูู ุงููุฏุฑุฉ ุนูู ุญุฐู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุนุจุฑ ุตูุญุงุช ูุชุนุฏุฏุฉ ูู ููุช ูุงุญุฏ. <br><br>  ูุจู ุฃู ุชุจุฏุฃ ูู ูุชุงุจุฉ ุงูุญู ุงูุฎุงุต ุจู ุ ุฏุนูุง ูุฑู ูุง ููุฏูู nginx ุฎุงุฑุฌ ุงูุตูุฏูู.  ูุฅุนุงุฏุฉ ุชุนููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุญุชูู nginx ุนูู ุชูุฌูู ุฎุงุต ูุณูู "proxy_cache_purge" ุ ูุงูุฐู ูุณุฌู ุญุงูุฉ ุฅุนุงุฏุฉ ุชุนููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช.  ุงูุดุฑุท ูู ูู ุงููุงูุน ุฎุท ุนุงุฏู ุ ุฅุฐุง ูู ููู ูุงุฑุบูุง ูููุณ "0" ุ ูุณูุชู ุญุฐู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ุฎูุงู ุงูููุชุงุญ ุงูุฐู ุชู ุชูุฑูุฑู.  ููุฑ ูู ูุซุงู ุตุบูุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl">proxy_cache_path /data/nginx/cache keys_zone=cache_zone:<span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-keyword"><span class="hljs-keyword">m</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">map</span></span> $request_method $purge_method { PURGE <span class="hljs-number"><span class="hljs-number">1</span></span>; default <span class="hljs-number"><span class="hljs-number">0</span></span>; } server { ... location / { proxy_pass http:<span class="hljs-regexp"><span class="hljs-regexp">//backend</span></span>; proxy_cache cache_zone; proxy_cache_key $uri; proxy_cache_purge $purge_method; } }</code> </pre><br>  <i>ุชู ุฃุฎุฐ ูุซุงู ูู ูููุน nginx ุงูุฑุณูู.</i> <br><br>  ุงููุชุบูุฑ $ purge_method ูุณุคูู ุนู ูุณุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ููู ุดุฑุท ูุชูุฌูู proxy_cache_purge ููุชู ุชุนูููู ุนูู 0 ุจุดูู ุงูุชุฑุงุถู.  ูุฐุง ูุนูู ุฃู nginx ูุนูู ูู ุงููุถุน "ุงูุนุงุฏู" (ูุญูุธ ุงูุงุณุชุฌุงุจุงุช ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ).  ูููู ุฅุฐุง ููุช ุจุชุบููุฑ ุทุฑููุฉ ุงูุทูุจ ุฅูู "PURGE" ุ ูุจุฏูุงู ูู ุชูุฏูู ุทูุจ ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุน ุญูุธ ุงูุงุณุชุฌุงุจุฉ ุ ุณูุชู ุญุฐู ุฅุฏุฎุงู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุงุณุชุฎุฏุงู ููุชุงุญ ุงูุชุฎุฒูู ุงููุคูุช ุงูููุงุจู.  ูู ุงููููู ุฃูุถูุง ุชุญุฏูุฏ ููุงุน ุญุฐู ุนู ุทุฑูู ุชุญุฏูุฏ "*" ูู ููุงูุฉ ููุชุงุญ ุงูุชุฎุฒูู ุงููุคูุช.  ูุจุงูุชุงูู ุ ูุง ูุญุชุงุฌ ุฅูู ูุนุฑูุฉ ูููุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุนูู ุงููุฑุต ููุจุฏุฃ ุชูููู ุงูููุชุงุญ ุ ููุชููู nginx ูุฐู ุงููุณุคูููุงุช.  ูููู ููุงู ุฃูุถูุง ุนููุจ ูู ูุฐุง ุงูููุฌ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชููุฑ ุงูุชูุฌูู proxy_cache_purge ูุฌุฒุก ูู ุงุดุชุฑุงู ุชุฌุงุฑู. </li><li style=";text-align:right;direction:rtl">  ูู ุงููููู ููุท ุญุฐู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุดูู ููุทู ุ ุฃู ุจุงุณุชุฎุฏุงู ููุงุน ุงููููุฐุฌ {ููุชุงุญ ุงูุชุฎุฒูู ุงููุคูุช} "*" </li></ul><br>  ูุธุฑูุง ูุฃู ุนูุงููู ุงูุตูุญุงุช ุงููุฎุฒูุฉ ูุคูุชูุง ูููู ุฃู ุชููู ูุฎุชููุฉ ุชูุงููุง ุ ุจุฏูู ุฃุฌุฒุงุก ุดุงุฆุนุฉ ุ ูุฅู ุงูููุฌ ุจุงุณุชุฎุฏุงู ุงูููุงุน "*" ูุงูุชูุฌูู "proxy_cache_purge" ุบูุฑ ููุงุณุจ ููุง.  ูุจูู ุฃู ูุชุฐูุฑ ุงููููู ูู ุงููุธุฑูุฉ ูุงูุชุดู IDide ุงูููุถูุฉ ูุฏูู. <br><br>  ูุญู ูุนูู ุฃู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช nginx ูู ููู ุนุงุฏู ุนูู ุงูุฎุงุฏู.  ุญุฏุฏูุง ุจุดูู ูุณุชูู ุงูุฏููู ูุชุฎุฒูู ูููุงุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ุชูุฌูู "proxy_cache_path" ุ ุญุชู ุฃููุง ุญุฏุฏูุง ููุทู ุชุดููู ุงููุณุงุฑ ุฅูู ุงูููู ูู ูุฐุง ุงูุฏููู ุจุงุณุชุฎุฏุงู "ุงููุณุชููุงุช".  ุงูุดูุก ุงููุญูุฏ ุงูุฐู ููุชูุฏู ูู ุงูุชูููู ุงูุตุญูุญ ูููุชุงุญ ุงูุชุฎุฒูู ุงููุคูุช.  ูููู ูููููุง ุฃูุถูุง ุฑุคูุชู ูู ุชูุฌูู "proxy_cache_key".  ุงูุขู ูู ูุง ุนูููุง ูุนูู ูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุดููู ุงููุณุงุฑ ุงููุงูู ููุตูุญุฉ ุ ุชูุงููุง ููุง ูู ูุญุฏุฏ ูู ุชูุฌูู proxy_cache_key ุ </li><li style=";text-align:right;direction:rtl">  ุชุฑููุฒ ุงูุณูุณูุฉ ุงููุงุชุฌุฉ ูู md5 ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฃุฏูุฉ ูุชุฏุงุฎูุฉ ุจุงุณุชุฎุฏุงู ุงููุงุนุฏุฉ ูู ูุนููุฉ "ุงููุณุชููุงุช". </li><li style=";text-align:right;direction:rtl">  ูุงูุขู ูุฏููุง ุจุงููุนู ุงููุณุงุฑ ุงููุงูู ุฅูู ููู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุนูู ุงูุฎุงุฏู.  ุงูุขู ูู ูุง ุชุจูู ููุง ูู ุญุฐู ูุฐุง ุงูููู ุจุงูุฐุงุช.  ูู ุงูุฌุฒุก ุงูุชูููุฏู ุ ูุนูู ุฃู nginx ูุฏ ูุง ูููู ููุฌูุฏูุง ุนูู ุฌูุงุฒ ุงูุชุทุจูู ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุชูููู ุญุฐู ุนุฏุฉ ุนูุงููู ูู ููุช ูุงุญุฏ.  ูุฑุฉ ุฃุฎุฑู ุ ูุตู ุงูุฎูุงุฑุฒููุฉ: </li><li style=";text-align:right;direction:rtl">  ุงููุณุงุฑุงุช ุงูุชู ุชู ุฅูุดุงุคูุง ููููุงุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุณููุชุจ ุฅูู ุงูููู ุ </li><li style=";text-align:right;direction:rtl">  ูููุชุจ ูุต ุจุงุด ุจุณูุท ูุถุนู ุนูู ุงูุฌูุงุฒ ูุน ุงูุชุทุจูู.  ุณุชููู ูููุชู ุงูุงุชุตุงู ุนุจุฑ ssh ุจุงูุฎุงุฏู ุญูุซ ูุฏููุง ุงูุชุฎุฒูู ุงููุคูุช nginx ูุญุฐู ุฌููุน ูููุงุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงููุญุฏุฏุฉ ูู ุงูููู ุงูุฐู ุชู ุฅูุดุงุคู ูู ุงูุฎุทูุฉ 1 ุ </li></ul><br>  ููุชูู ูู ุงููุธุฑูุฉ ุฅูู ุงูููุงุฑุณุฉ ุ ูุณููุชุจ ูุซุงููุง ุตุบูุฑูุง ููุถุญ ุฎูุงุฑุฒููุฉ ุนูููุง. <br><br>  ุงูุฎุทูุฉ 1. ุฅูุดุงุก ููู ุจูุณุงุฑุงุช ุฅูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$urls</span></span> = [ <span class="hljs-string"><span class="hljs-string">'httpGETdomain.ru/news/111/1:2'</span></span>, <span class="hljs-string"><span class="hljs-string">'httpGETdomain.ru/news/112/3:4'</span></span>, ]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to_nginx_cache_path</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url)</span></span></span></span> { <span class="hljs-variable"><span class="hljs-variable">$nginxHash</span></span> = md5(<span class="hljs-variable"><span class="hljs-variable">$url</span></span>); <span class="hljs-variable"><span class="hljs-variable">$firstDir</span></span> = substr(<span class="hljs-variable"><span class="hljs-variable">$nginxHash</span></span>, <span class="hljs-literal"><span class="hljs-literal">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-variable"><span class="hljs-variable">$secondDir</span></span> = substr(<span class="hljs-variable"><span class="hljs-variable">$nginxHash</span></span>, <span class="hljs-literal"><span class="hljs-literal">-3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/var/lib/nginx/proxy_cache/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$firstDir</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$secondDir</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$nginxHash</span></span></span><span class="hljs-string">"</span></span>; } //        tmp <span class="hljs-variable"><span class="hljs-variable">$filePath</span></span> = tempnam(<span class="hljs-string"><span class="hljs-string">'tmp'</span></span>, <span class="hljs-string"><span class="hljs-string">'nginx_cache_'</span></span>); //      <span class="hljs-variable"><span class="hljs-variable">$fileStream</span></span> = fopen(<span class="hljs-variable"><span class="hljs-variable">$filePath</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-variable"><span class="hljs-variable">$urls</span></span> as <span class="hljs-variable"><span class="hljs-variable">$url</span></span>) { //      <span class="hljs-variable"><span class="hljs-variable">$cachePath</span></span> = to_nginx_cache_path(<span class="hljs-variable"><span class="hljs-variable">$url</span></span>); //       fwrite(<span class="hljs-variable"><span class="hljs-variable">$fileStream</span></span>, <span class="hljs-variable"><span class="hljs-variable">$cachePath</span></span> . PHP_EOL); } //     fclose(<span class="hljs-variable"><span class="hljs-variable">$fileStream</span></span>); //  bash       exec(<span class="hljs-string"><span class="hljs-string">"/usr/local/bin/cache_remover </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$filePath</span></span></span><span class="hljs-string">"</span></span>);</code> </pre><br>  ูุฑุฌู ููุงุญุธุฉ ุฃู ุนูุงููู url ุงููุชุบูุฑุฉ ุชุญุชูู ุนูู ุนููุงู url ุงูุฎุงุต ุจุงูุตูุญุงุช ุงููุฎุฒูุฉ ูุคูุชูุง ุ ุจุงูุชูุณูู proxy_cache_key ุงููุญุฏุฏ ุจุงููุนู ูู ุงูุชูููู nginx.  ูุนูู Url ูุนูุงูุฉ ููููุงูุงุช ุงููุนุฑูุถุฉ ุนูู ุงูุตูุญุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ููููู ุฅูุดุงุก ุฌุฏูู ุนุงุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ุญูุซ ุณูุชู ุชุนููู ูู ููุงู ูุตูุญุฉ ูุนููุฉ ูุชู ุนุฑุถูุง ุนููู.  ุจุนุฏ ุฐูู ุ ุนูุฏ ุชุบููุฑ ุฃู ุจูุงูุงุช ุ ูููููุง ุฅุฌุฑุงุก ุชุญุฏูุฏ ุนูู ุงูุฌุฏูู ูุญุฐู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุฌููุน ุงูุตูุญุงุช ุงูุชู ูุญุชุงุฌูุง. <br><br>  ุงูุฎุทูุฉ 2. ุงูุงุชุตุงู ุจุฎุงุฏู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุญุฐู ูููุงุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs smalltalk">#      ,      <span class="hljs-type"><span class="hljs-type">FILE_LIST</span></span>=`cat <span class="hljs-string"><span class="hljs-string">$1</span></span> | tr <span class="hljs-comment"><span class="hljs-comment">"\n"</span></span> <span class="hljs-comment"><span class="hljs-comment">" "</span></span>` #   ssh  <span class="hljs-type"><span class="hljs-type">SSH</span></span>=`which ssh` <span class="hljs-type"><span class="hljs-type">USER</span></span>=<span class="hljs-comment"><span class="hljs-comment">"root"</span></span> #         nginx <span class="hljs-type"><span class="hljs-type">HOST</span></span>=<span class="hljs-comment"><span class="hljs-comment">"10.10.1.0"</span></span> #   <span class="hljs-type"><span class="hljs-type">KEY</span></span>=<span class="hljs-comment"><span class="hljs-comment">"/var/keys/id_rsa"</span></span> # <span class="hljs-type"><span class="hljs-type">SSH</span></span> ,          <span class="hljs-string"><span class="hljs-string">$S</span></span>SH -i <span class="hljs-string"><span class="hljs-string">${</span></span><span class="hljs-type"><span class="hljs-type">KEY</span></span>} <span class="hljs-string"><span class="hljs-string">${</span></span><span class="hljs-type"><span class="hljs-type">USER</span></span>}@<span class="hljs-string"><span class="hljs-string">${</span></span><span class="hljs-type"><span class="hljs-type">HOST</span></span>} <span class="hljs-comment"><span class="hljs-comment">"rm -f ${FILE_LIST}"</span></span> #       rm -rf rm -f <span class="hljs-string"><span class="hljs-string">$1</span></span> #  </code> </pre><br>  ุงูุฃูุซูุฉ ุฃุนูุงู ูู ููุฅุฑุดุงุฏ ููุท ุ ูุง ุชุณุชุฎุฏููุง ูู ุงูุฅูุชุงุฌ.  ูู ุงูุฃูุซูุฉ ุ ูุชู ุญุฐู ุนูููุงุช ุงูุชุญูู ูู ูุนููุงุช ุงูุฅุฏุฎุงู ููููุฏ ุงูุฃูุงูุฑ.  ุฅุญุฏู ุงููุดุงูู ุงูุชู ูุฏ ุชูุงุฌููุง ูู ุชุญุฏูุฏ ุทูู ุงููุณูุทุฉ ูุฃูุฑ rm.  ุนูุฏ ุงูุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ุชุทููุฑ ุนูู ูุญุฏุงุช ุชุฎุฒูู ุตุบูุฑุฉ ุ ูููู ุชูููุชูุง ุจุณูููุฉ ุ ููู ุงูุฅูุชุงุฌ ุชุญุตู ุนูู ุงูุฎุทุฃ "rm: ูุงุฆูุฉ ุงููุณุงุฆุท ุทูููุฉ ุฌุฏูุง". <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุฎุฒูู ุงููุคูุช ูุชูุฉ ูุฎุตุตุฉ </h3><br>  ุฏุนููุง ููุฎุต ูุง ุชูููุง ูู ุงูููุงู ุจู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูููู ุงูุญูู ุนูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชุนุฑู ุนูู ููููุฉ ุฅุฏุงุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช </li><li style=";text-align:right;direction:rtl">  ุชุนููุช ูุณุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ุฃู ููุช. </li></ul><br>  ูููู ููุณ ูู ุดูุก ุฌูุฏ ููุง ูุฏ ูุจุฏู ูููููุฉ ุงูุฃููู.  ุงูุขู ุ ุนูู ุงูุฃุฑุฌุญ ุ ุฅู ูู ููู ูู ูู ูุฑุฉ ุ ูุฅู ูู ูููุน ุซุงูู ุนูู ูุฌู ุงูุชุญุฏูุฏ ูุญุชูู ุนูู ูุธููุฉ ุชุณุฌูู / ุชูููุถ ุ ุจุนุฏ ุงููุฑูุฑ ุ ุณูุฑูุฏ ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู ูู ููุงู ูุง ูู ุงูุฑุฃุณ.  ุงููุชูุฉ ุงูุชู ุชุญูู ุงูุงุณู ูุฑูุฏุฉ ููุฌุจ ุฃู ุชุนุฑุถ ุงุณู ุงููุณุชุฎุฏู ุงูุฐู ูุชู ุชูููุถูุง ุจููุฌุจู.  ูุธุฑูุง ูุฃู nginx ูุญูุธ ุงูุงุณุชุฌุงุจุฉ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ููู ุญุงูุฉ ุงูุตูุญุฉ ูููู ูุญุชูู html ููุตูุญุฉ ุ ูุณูุชู ุฃูุถูุง ุชุฎุฒูู ูุชูุฉ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูุคูุชูุง.  ุณูุฑู ุฌููุน ุฒูุงุฑ ุงููููุน ุงุณู ุงููุณุชุฎุฏู ุงูุฃูู ุงูุฐู ูุฑุฑ ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ููุฌููุนุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br>  ูุฐูู ุ ูุฌุจ ุฃูุง ุชุนุทู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุชููุง ุญูุซ ุชูุฌุฏ ุงููุนูููุงุช ุงูุดุฎุตูุฉ ุจุญูุซ ูุง ุชูุน ูุฐู ุงููุนูููุงุช ุชุญุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู nginx. <br><br>  ูู ุงูุถุฑูุฑู ุงููุธุฑ ูู ุชุญููู ุจุฏูู ููุฐู ุงูุฃุฌุฒุงุก ูู ุงูุตูุญุฉ.  ููุง ูู ุงูุญุงู ุฏุงุฆููุง ุ ูููู ุงูููุงู ุจุฐูู ุจุนุฏุฉ ุทุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุจุนุฏ ุชุญููู ุงูุตูุญุฉ ุ ูุฅุฑุณุงู ุทูุจ ุฃุฌุงูุณ ุ ูุนุฑุถ ุงููุญูู ุจุฏูุงู ูู ุงููุญุชูู ุงูุดุฎุตู.  ุทุฑููุฉ ุฃุฎุฑู ุณููุธุฑ ูููุง ุงูููู ูู ุงุณุชุฎุฏุงู ุนูุงูุงุช ssi.  ุฏุนููุง ูููู ุฃููุงู ูุง ูู SSI ุ ุซู ููู ูููููุง ุงุณุชุฎุฏุงูู ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช nginx. <br><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู SSI ูููู ูุนูู </h3><br>  SSI (ูุชุถูู ุฌุงูุจ ุงูุฎุงุฏู ุ ุงูุชุถูููุงุช ูู ุฌุงูุจ ุงูุฎุงุฏู) ูู ูุฌููุนุฉ ูู ุงูุฃูุงูุฑ ุงููุถููุฉ ูู ุตูุญุฉ html ูุงูุชู ุชุฎุจุฑ ุงูุฎุงุฏู ุจูุง ูุฌุจ ุงูููุงู ุจู. <br><br>  ูููุง ููู ูุงุฆูุฉ ุจูุฐู ุงูุฃูุงูุฑ (ุงูุชูุฌููุงุช): <br><br>  โข if / elif / else / endif - ุนุงูู ุงูุชูุฑุน ุ <br>  โข ุตุฏู - ูุนุฑุถ ููู ุงููุชุบูุฑุงุช ุ <br>  โข include - ูุณูุญ ูู ุจุฅุฏุฑุงุฌ ูุญุชููุงุช ููู ุขุฎุฑ ูู ุงููุณุชูุฏ. <br>  ุณูุชู ููุงูุดุฉ ุงูุชูุฌูู ุงูุฃุฎูุฑ ููุท.  ูุญุชูู ุชูุฌูู ุงูุชุถููู ูุนููุชูู: <br>  โข ููู - ูุญุฏุฏ ุงููุณุงุฑ ููููู ุนูู ุงูุฎุงุฏู.  ุจุฎุตูุต ุงูุฏููู ุงูุญุงูู ุ <br>  โข ุธุงูุฑู - ูุดูุฑ ุฅูู ุงููุณุงุฑ ุงูุงูุชุฑุงุถู ูููุณุชูุฏ ุนูู ุงูุฎุงุฏู. <br><br>  ูุญู ููุชููู ุจุงููุนููุฉ "ุงูุธุงูุฑูุฉ" ุ ูุธุฑูุง ูุฃู ุชุญุฏูุฏ ุงููุณุงุฑ ุงููุงูู ููููู ุนูู ุงูุฎุงุฏู ููุณ ุฏุงุฆููุง ููุงุณุจูุง ุ ุฃู ูู ุญุงูุฉ ุงูุจููุฉ ุงูููุฒุนุฉ ุ ูุฅู ุงูููู ุงูููุฌูุฏ ุนูู ุงูุฎุงุฏู ุบูุฑ ููุฌูุฏ ุจุจุณุงุทุฉ.  ุชูุฌูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!--#include virtual="/user/personal_news/"--&gt;</span></span></code> </pre> <br>  ููู ุชุจุฏุฃ nginx ูู ูุนุงูุฌุฉ ุฅุฏุฎุงูุงุช ssi ุ ุชุญุชุงุฌ ุฅูู ุชุนุฏูู ุงููููุน ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs">location / { ssi <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>; ... }</code> </pre><br>  ุงูุขู ุณูุชููู ุฌููุน ุงูุทูุจุงุช ุงูุชู ุชูุช ูุนุงูุฌุชูุง ุจูุงุณุทุฉ ุงููููุน "/" ูู ุชูููุฐ ุฅุฏุฎุงูุงุช Ssi. <br><br>  ููู ุณููุฑ ุทูุจูุง ุจูุฐุง ุงููุฎุทุท ุจุฃููููุ <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุทูุจ ุงูุนููู ุงูุตูุญุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชููู Nginx ุจุทูุจ ุทูุจ ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุชุนุทู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุงูุตูุญุฉ ุจุฅุฏุฑุงุฌ ssi ุ </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุฎุฒูู ุงููุชูุฌุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ </li><li style=";text-align:right;direction:rtl">  ุชุณุชูุณุฑ Nginx ุนู ุงููุชู ุงูููููุฏุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูุชู ุฅุฑุณุงู ุงูุตูุญุฉ ุงููุงุชุฌุฉ ุฅูู ุงูุนููู. </li></ul><br>  ููุง ุชุฑู ูู ุงูุฎุทูุงุช ุ ุณุชุฏุฎู ุชุตูููุงุช ssi ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช nginx ุ ููุง ุณูุณูุญ ุจุนุฏู ุชุฎุฒูู ุงููุชู ุงูุดุฎุตูุฉ ูุคูุชูุง ุ ูุณูุชู ุฅุฑุณุงู ุตูุญุฉ html ุฌุงูุฒุฉ ูุน ูู ุงููุฏุฎูุงุช.  ููุง ูุนูู ุชุญููููุง ุ ุชุทูุจ nginx ุจุดูู ูุณุชูู ูุชู ุงูุตูุญุงุช ุงูููููุฏุฉ.  ูููู ูุซู ุฃู ุญู ุขุฎุฑ ุ ูุฅู ูุฐุง ุงูููุฌ ูู ุฅูุฌุงุจูุงุชู ูุณูุจูุงุชู.  ุชุฎูู ุฃู ููุงู ุงูุนุฏูุฏ ูู ุงููุชู ูู ุงูุตูุญุฉ ุงูุชู ูุฌุจ ุนุฑุถูุง ุจุดูู ูุฎุชูู ุงุนุชูุงุฏูุง ุนูู ุงููุณุชุฎุฏู ุ ุซู ุณูุชู ุงุณุชุจุฏุงู ูู ูุชูุฉ ูู ูุฐุง ุงููุจูู ุจุฅุฏุฑุงุฌ ssi.  ููุง ูู ูุชููุน ุ ุณุชุทูุจ Nginx ูู ูุชูุฉ ูู ูุฐู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุ ุฃู ุฃู ุทูุจูุง ูุงุญุฏูุง ูู ุงููุณุชุฎุฏู ุณูุคุฏู ุนูู ุงูููุฑ ุฅูู ุฅูุดุงุก ุนุฏุฉ ุทูุจุงุช ูููุงุฌูุฉ ุงูุฎูููุฉ ุ ููู ูุง ูุง ุฃุฑุบุจ ููู ุนูู ุงูุฅุทูุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุฎูุต ูู ุทูุจุงุช ุงููุงุฌูุฉ ุงูุฎูููุฉ ุงููุณุชูุฑุฉ ุนุจุฑ SSI </h3><br>  ูุญู ูุฐู ุงููุดููุฉ ุ ุณุชุณุงุนุฏูุง ูุญุฏุฉ nginx โngx_http_memcached_moduleโ.  ุชุณูุญ ุงููุญุฏุฉ ุจุชููู ุงูููู ูู ุฎุงุฏู memcached.  ูู ุชุนูู ุงููุชุงุจุฉ ูู ุฎูุงู ุงููุญุฏุฉ ุงูููุทูุฉ ุ ูุฌุจ ุฃู ูุนุชูู ุฎุงุฏู ุงูุชุทุจูู ุจุฐูู.  ููุฑ ูู ูุซุงู ุตุบูุฑ ูุชูููู nginx ุจุงูุงูุชุฑุงู ูุน ูุญุฏุฉ ููุทูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /page { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$memcached_key</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$uri</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">memcached_pass</span></span> <span class="hljs-number"><span class="hljs-number">127.0.0.1:11211</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">error_page</span></span> <span class="hljs-number"><span class="hljs-number">404</span></span> <span class="hljs-number"><span class="hljs-number">502</span></span> <span class="hljs-number"><span class="hljs-number">504</span></span> = <span class="hljs-variable"><span class="hljs-variable">@fallback</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> <span class="hljs-variable"><span class="hljs-variable">@fallback</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://backend; } }</code> </pre><br>  ูู ุงููุชุบูุฑ $ memcache_key ุญุฏุฏูุง ุงูููุชุงุญ ุงูุฐู ุณุชุญุงูู nginx ูู ุฎูุงูู ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ูู memcache.  ูุชู ุชุนููู ุงููุนููุงุช ููุงุชุตุงู ุจุฎุงุฏู memcache ูู ุงูุชูุฌูู memcached_pass.  ูููู ุชุญุฏูุฏ ุงูุงุชุตุงู ุจุนุฏุฉ ุทุฑู: <br><br>  โข ุงุณู ุงููุฌุงู ุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">memcached_pass</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.domain</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ru</span></span>;</code> </pre> <br>  โข ุนููุงู IP ูุงููููุฐ ุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">memcached_pass</span></span> localhost:<span class="hljs-number"><span class="hljs-number">11211</span></span>;</code> </pre> <br>  โข ููุจุณ ููููุณ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">memcached_pass</span></span> unix:/tmp/memcached.socket;</code> </pre> <br>  โข ุชูุฌูู ุงูููุจุน. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs axapta">upstream cachestream { hash $request_uri consistent; <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">11211</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>:<span class="hljs-number"><span class="hljs-number">11211</span></span>; } location / { ... memcached_pass cachestream; ... }</code> </pre><br>  ุฅุฐุง ุชููู nginx ูู ุงูุญุตูู ุนูู ุงุณุชุฌุงุจุฉ ูู ุฎุงุฏู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ูุฅูู ูุนุทููุง ููุนููู.  ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุณูุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุนุจุฑ "fallback".  ุณูุณุงุนุฏูุง ูุฐุง ุงูุฅุนุฏุงุฏ ุงูุตุบูุฑ ูููุญุฏุฉ memcached ุชุญุช nginx ุนูู ุชูููู ุนุฏุฏ ุทูุจุงุช ุงููุฑูุฑ ูููุงุฌูุฉ ุงูุฎูููุฉ ูู ุฅุฏุฎุงูุงุช ssi. <br><br>  ูุฃูู ุฃู ุชููู ูุฐู ุงูููุงูุฉ ูููุฏุฉ ููุฏ ุชูููุง ูู ุฅุธูุงุฑ ุฅุญุฏู ุงูุทุฑู ูุชุญุณูู ุงูุญูู ุนูู ุงูุฎุงุฏู ุ ูุงููุธุฑ ูู ุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ ูุฅุนุฏุงุฏ ุงูุชุฎุฒูู ุงููุคูุช ูู nginx ูุฅุบูุงู ุงููุดููุงุช ุงูุชู ุชูุดุฃ ุนูุฏ ุงุณุชุฎุฏุงูู. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar428127/">https://habr.com/ru/post/ar428127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar428117/index.html">ูุนุงูุฌุงุช ููุชุฑ ูุฌุงููุฉ ูู Google ูู Colaboratory Cloud</a></li>
<li><a href="../ar428119/index.html">ุงูุชุฑุงุญ "ุญููู ุงูุญููู" ุฃู "ุงูุฎุทุฃ ุงูุฐู ุญุฏุซ ูู ุงุฑุชูุงุจ tc39"</a></li>
<li><a href="../ar428121/index.html">ุณุชุงู ุฏุฑุงุจููู. ูุตุงุฆุฏ ุงูุชุดููุฑ ุนุงููุฉ ุงููุณุชูู ูู .NET</a></li>
<li><a href="../ar428123/index.html">ุฃุณุจูุน ุงูุฃูู 41: ุฃุฎุจุงุฑ ุฌูุฏุฉ</a></li>
<li><a href="../ar428125/index.html">ูู ูู ุชุญูููุงุช ุงูููุชุฌ ูููุงุฐุง ูุญุชุงุฌูู ุฅููู ูู ุงููุฑููุ</a></li>
<li><a href="../ar428129/index.html">ุชูุณู ููุทู ุบุงูุถ ุจุณูุท ูุนูุง "ูู ูุง ูุงู" ููุญุฑู ุชูุฑุจููู ุบุงุฒ</a></li>
<li><a href="../ar428131/index.html">ุงูุญูููุฉ ุงููุงููุฉ ุนู RTOS. ุงููุงุฏุฉ ุฑูู 17. ูุฌููุนุงุช ุนูุงูุฉ ุงูุญุฏุซ: ุงูููุฏูุฉ ูุงูุฎุฏูุงุช ุงูุฃุณุงุณูุฉ</a></li>
<li><a href="../ar428133/index.html">ุญุณูุฑุฉ. ุนุงููุฉ ุงูุฃุฏุงุก GraphQL ูุจููุฉ ุฎุงุฏู SQL</a></li>
<li><a href="../ar428135/index.html">ููููุฉ ุชูููู ุฃู ุชุนุทูู ุงููู ูู ูุญุฑุฑ ุงูููุฏ ุงููุฏูุฌ</a></li>
<li><a href="../ar428137/index.html">ุงูุฃูููุจูุงุฏ ุ ูุณุงุจูุฉ ุงูุฃููุงุฑ ุ ูุญุงุถุฑุงุช ุญูู ุฅุฏุงุฑุฉ ูุดุงุฑูุน ุชูููููุฌูุง ุงููุนูููุงุช ูุนุฑูุถ ุงูุฃููุงู: 10 ุฃุญุฏุงุซ ูุงุฏูุฉ ูู ุฌุงูุนุฉ ITMO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>