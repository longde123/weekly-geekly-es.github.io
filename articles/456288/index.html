<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç© üë¶üèø üïñ MAM: montaje frontend sin dolor üôÇ üö¥üèª üë≤üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola, mi nombre es Dmitry Karlovsky y adoro a MAM. M AM gobierna los m√≥dulos Gn√≥sticos M , ahorr√°ndome la mayor parte de la rutina. 





 El m√≥dulo a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MAM: montaje frontend sin dolor</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456288/"><p>  Hola, mi nombre es Dmitry Karlovsky y adoro a MAM.  <strong>M</strong> AM gobierna los m√≥dulos Gn√≥sticos <strong>M</strong> , ahorr√°ndome la mayor parte de la rutina. </p><br><p><img src="https://habrastorage.org/webt/m2/5h/ps/m25hpsfevki-o6lwx4v_ukfxvtu.png" alt="M√≥dulo agn√≥stico t√≠pico"></p><br><p> <strong>El m√≥dulo agn√≥stico</strong> , a diferencia del tradicional, no es un archivo fuente, sino un directorio dentro del cual puede haber c√≥digos fuente en una variedad de idiomas: l√≥gica de programa en <code>JS</code> / <code>TS</code> , pruebas para √©l en <code>TS</code> / <code>JS</code> , composici√≥n de componentes en <code>view.tree</code> , estilos en <code>CSS</code> , localizaci√≥n en <code>locale=*.json</code> , im√°genes, etc., etc.  Si lo desea, no es dif√≠cil asegurar el soporte de cualquier otro idioma.  Por ejemplo, Stylus para escribir estilos o HTML para describir plantillas. </p><br><p>  Las dependencias entre m√≥dulos se rastrean autom√°ticamente mediante el an√°lisis de la fuente.  Si el m√≥dulo se enciende, se enciende como un todo: cada c√≥digo fuente del m√≥dulo se transpone y cae en el paquete correspondiente: scripts - por separado, estilos - por separado, pruebas - por separado.  Para diferentes plataformas, sus paquetes: para un nodo, el suyo, para un navegador, el suyo. </p><br><p>  Automatizaci√≥n total, falta de configuraci√≥n y repetitivo, tama√±os de paquete m√≠nimos, bombeo autom√°tico de dependencias, desarrollo de cientos de bibliotecas y aplicaciones enajenadas en una base de c√≥digo sin dolor ni sufrimiento.  <strong>Wow que adicci√≥n!</strong>  ¬°Saquen a los ni√±os embarazadas, nerviosos, de los monitores y bienvenidos al submarino! </p><a name="habracut"></a><br><h1 id="filosofiya">  Filosof√≠a </h1><br><p>  MAM es un experimento audaz para cambiar radicalmente la forma en que se organiza el c√≥digo y el proceso de trabajar con √©l.  Aqu√≠ est√°n los principios b√°sicos: </p><br><p>  <strong>Convenciones en lugar de configuraci√≥n.</strong>  Los acuerdos razonables, simples y universales le permiten automatizar toda la rutina, manteniendo la comodidad y la uniformidad entre los diferentes proyectos. </p><br><p>  <strong>La infraestructura est√° separada, el c√≥digo est√° separado.</strong>  Una situaci√≥n no es infrecuente cuando necesita desarrollar docenas, o incluso cientos de bibliotecas y aplicaciones.  No despliegue la infraestructura de ensamblaje, desarrollo, despliegue, etc. para cada uno de ellos.  Es suficiente pedirlo una vez y luego remachar aplicaciones como pasteles. </p><br><p>  <strong>No pague por lo que no usa.</strong>  Utiliza alg√∫n tipo de m√≥dulo: est√° incluido en el paquete con todas sus dependencias.  No utilizar: no se enciende.  Cuanto m√°s peque√±os son los m√≥dulos, mayor es la granularidad y menos c√≥digo innecesario en el paquete. </p><br><p>  <strong>C√≥digo m√≠nimo redundante.</strong>  Romper el c√≥digo en los m√≥dulos deber√≠a ser tan simple como escribir todo el c√≥digo en un solo archivo.  De lo contrario, el desarrollador ser√° perezoso para dividir los m√≥dulos grandes en peque√±os. </p><br><p>  <strong>No hay conflictos de versiones.</strong>  Solo hay una versi√≥n: la actual.  No es necesario gastar recursos en el soporte de versiones antiguas, si puede gastarlas en actualizar las √∫ltimas. </p><br><p>  <strong>Mantenga un dedo en el pulso.</strong>  Los comentarios m√°s r√°pidos con respecto a las incompatibilidades no permitir√°n que el c√≥digo salga mal. </p><br><p>  <strong>La forma m√°s f√°cil es la m√°s segura.</strong>  Si el camino correcto requiere un esfuerzo adicional, aseg√∫rese de que nadie vaya a ellos. </p><br><h1 id="importyeksporty">  Importaciones / Exportaciones </h1><br><p>  Abrimos el primer proyecto que <a href="">surgi√≥</a> utilizando un sistema de m√≥dulos moderno: <a href="">un m√≥dulo tiene menos de 300 l√≠neas de largo, 30 de las cuales son importaciones.</a> </p><br><p>  Pero estas siguen siendo flores: <a href="">para una funci√≥n de 9 l√≠neas, se requieren 8 importaciones.</a> </p><br><p>  Y mi favorito: <a href="">ni una sola l√≠nea de c√≥digo √∫til.</a>  20 l√≠neas de cambio de valores del mont√≥n de m√≥dulos a uno, para que luego pueda importar desde un m√≥dulo, y no desde veinte. </p><br><p>  Todo esto es repetitivo, lo que lleva al hecho de que los desarrolladores son demasiado vagos para asignar peque√±os fragmentos de c√≥digo en m√≥dulos separados, prefiriendo m√≥dulos grandes a peque√±os.  E incluso si no son perezosos, resulta mucho c√≥digo para importar m√≥dulos peque√±os o m√≥dulos especiales que importan muchos m√≥dulos en s√≠ mismos y los exportan a granel. </p><br><p>  Todo esto conduce a una baja granularidad del c√≥digo y a inflar el tama√±o de los paquetes con c√≥digo no utilizado, lo cual es lo suficientemente afortunado como para estar cerca del que se usa.  Para JS, est√°n tratando de resolver este problema complicando la tuber√≠a de ensamblaje, agregando la llamada "sacudida del √°rbol", que corta el exceso de lo que import√≥.  Esto ralentiza el montaje, pero no todo est√° cortado. </p><br><p>  Idea: <strong>¬øQu√© sucede si no importamos, sino que solo tomamos y usamos, y el recolector mismo descubrir√° qu√© necesita importarse?</strong> </p><br><p>  Los IDE modernos pueden generar autom√°ticamente importaciones para las entidades que utiliza.  Si el IDE puede hacer esto, ¬øqu√© impide que el recopilador haga esto?  Es suficiente tener un acuerdo simple sobre el nombre y la ubicaci√≥n de los archivos, lo que ser√≠a conveniente para el usuario y comprensible para la m√°quina.  PHP ha tenido durante mucho tiempo una convenci√≥n est√°ndar: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PSR-4</a> .  MAM introduce lo mismo para los archivos <em>.ts y</em> .jam.js: los nombres que comienzan con $ son el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Nombre completo de</a> alguna entidad global cuyo c√≥digo se carga a lo largo de la ruta obtenida de FQN reemplazando los delimitadores con barras inclinadas.  Un ejemplo simple de dos m√≥dulos: </p><br><p>  <strong>my / alert / alert.ts</strong> </p><br><pre> <code class="plaintext hljs">const $my_alert = alert // FQN   </code> </pre> <br><p>  <strong>my / app / app.ts</strong> </p><br><pre> <code class="plaintext hljs">$my_alert( 'Hello!' ) // ,   /my/alert/</code> </pre> <br><p>  Un m√≥dulo completo de una l√≠nea: ¬øqu√© podr√≠a ser m√°s simple?  El resultado no se hace esperar: la simplicidad de crear y usar m√≥dulos lleva a minimizar su tama√±o.  Como resultado, para maximizar la granularidad.  Y como una cereza, minimiza el tama√±o de los bultos sin sacudir los √°rboles. </p><br><p>  Un buen ejemplo es la familia de m√≥dulos de validaci√≥n JSON <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">/ mol / data</a> .  Si utiliza la funci√≥n <code>$mol_data_integer</code> en alg√∫n lugar de su c√≥digo, los m√≥dulos <code>/mol/data/integer</code> y <code>/mol/data/number</code> , de los que depende <code>$mol_data_integer</code> , se incluir√°n en el paquete.  Pero, por ejemplo, el recopilador <code>/mol/data/email</code> ni siquiera leer√° desde el disco, ya que nadie depende de √©l. </p><br><h1 id="razgrebaya-bardak">  Rastrillar un desastre </h1><br><p>  Desde que comenzamos a patear Angular, no nos detendremos.  ¬øD√≥nde piensa buscar la <code>applyStyles</code> funci√≥n <code>applyStyles</code> ?  No adivinar√° en <a href=""><code>/packages/core/src/render3/styling_next/bindings.ts</code></a> .  La capacidad de colocar cualquier cosa en cualquier lugar conduce al hecho de que en cada proyecto observamos un sistema √∫nico de ubicaci√≥n de archivos, a menudo no susceptible de ninguna l√≥gica.  Y si el "salto a la definici√≥n" a menudo guarda el IDE, entonces ver el c√≥digo en el github o revisar la solicitud de extracci√≥n se ven privados de esta oportunidad. </p><br><p>  Idea: <strong>¬øQu√© pasa si los nombres de las entidades corresponden estrictamente a su ubicaci√≥n?</strong> </p><br><p>  Para colocar el c√≥digo en el archivo <code>/angular/packages/core/src/render3/stylingNext/bindings.ts</code> , en la arquitectura MAM deber√° nombrar la entidad <code>$angular_packages_core_src_render3_stylingNext_applyStyles</code> , pero, por supuesto, nadie actuar√°, porque hay mucho m√°s en el nombre.  Pero los nombres en el c√≥digo quiero ver cortos y concisos, por lo que el desarrollador intentar√° excluir todo lo innecesario del nombre, dejando solo lo importante: <code>$angular_render3_applyStyles</code> .  Y se ubicar√° en consecuencia en <code>/angular/render3/applyStyles/applyStyles.ts</code> . </p><br><p>  Observe c√≥mo MAM utiliza las debilidades de los desarrolladores para lograr el resultado deseado: cada entidad obtiene un nombre corto globalmente √∫nico que puede usarse en cualquier contexto.  Por ejemplo, en los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mensajes de confirmaciones,</a> estos nombres le permiten captar de manera r√°pida y precisa de lo que est√°n hablando: </p><br><pre> <code class="plaintext hljs">73ebc45e517ffcc3dcce53f5b39b6d06fc95cae1 $mol_vector: range expanding support 3a843b2cb77be19688324eeb72bd090d350a6cc3 $mol_data: allowed transformations 24576f087133a18e0c9f31e0d61052265fd8a31a $mol_data_record: support recursion</code> </pre> <br><p>  O supongamos que desea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">encontrar todas las menciones del m√≥dulo $ mol_fiber en Internet</a> , lo que lo hace m√°s f√°cil que nunca gracias a FQN. </p><br><h1 id="ciklicheskie-zavisimosti">  Dependencias c√≠clicas </h1><br><p>  Escribamos 7 l√≠neas de c√≥digo simple en un archivo: </p><br><pre> <code class="plaintext hljs">export class Foo { get bar() { return new Bar(); } } export class Bar extends Foo {} console.log(new Foo().bar);</code> </pre> <br><p>  A pesar de la dependencia c√≠clica, funciona correctamente.  Lo dividimos en 3 archivos: </p><br><p>  <strong>my / foo.js</strong> </p><br><pre> <code class="plaintext hljs">import { Bar } from './bar.js'; export class Foo { get bar() { return new Bar(); } }</code> </pre> <br><p>  <strong>my / bar.js</strong> </p><br><pre> <code class="plaintext hljs">import { Foo } from './foo.js'; export class Bar extends Foo {}</code> </pre> <br><p>  <strong>my / app.js</strong> </p><br><pre> <code class="plaintext hljs">import { Foo } from './foo.js'; console.log(new Foo().bar);</code> </pre> <br><p>  ¬°Vaya! Error de <code>ReferenceError: Cannot access 'Foo' before initialization</code> .  ¬øQu√© tipo de tonter√≠as?  Para solucionar esto, nuestra <code>app.js</code> necesita saber que <code>foo.js</code> depende de <code>bar.js</code>  Por lo tanto, primero tenemos que importar <code>bar.js</code> , que importa <code>foo.js</code>  Despu√©s de lo cual ya podemos importar <code>foo.js</code> sin error: </p><br><p>  <strong>my / app.js</strong> </p><br><pre> <code class="plaintext hljs">import './bar.js'; import { Foo } from './foo.js'; console.log(new Foo().bar);</code> </pre> <br><p>  Esos navegadores, ese NodeJS, ese paquete web, ese paquete, todos funcionan de manera torcida con dependencias circulares.  Y bueno, simplemente los prohibir√≠an: uno podr√≠a complicar de inmediato el c√≥digo para que no haya bucles.  Pero pueden funcionar bien, y luego bam, y dar un error incomprensible. </p><br><p>  Idea: <strong>¬øQu√©</strong> sucede <strong>si durante el ensamblaje simplemente pegamos los archivos en el orden correcto, como si todo el c√≥digo se hubiera escrito originalmente en un archivo?</strong> </p><br><p>  Dividamos el c√≥digo usando los principios de MAM: </p><br><p>  <strong>my / foo / foo.ts</strong> </p><br><pre> <code class="plaintext hljs">class $my_foo { get bar() { return new $my_bar(); } }</code> </pre> <br><p>  <strong>my / bar / bar.ts</strong> </p><br><pre> <code class="plaintext hljs">class $my_bar extends $my_foo {}</code> </pre> <br><p>  <strong>my / app / app.ts</strong> </p><br><pre> <code class="plaintext hljs">console.log(new $my_foo().bar);</code> </pre> <br><p>  Todas las mismas 7 l√≠neas de c√≥digo que originalmente.  Y simplemente funcionan sin chamanismo adicional.  El caso es que el coleccionista entiende que la dependencia de <code>my/bar</code> de <code>my/foo</code> m√°s estricta que <code>my/foo</code> de <code>my/bar</code> .  Esto significa que debe incluir estos m√≥dulos en el paquete en este orden: <code>my/foo</code> , <code>my/bar</code> , <code>my/app</code> . </p><br><p>  ¬øC√≥mo entiende esto el coleccionista?  Ahora la heur√≠stica es simple: por el n√∫mero de sangr√≠a en la l√≠nea en la que se detecta la dependencia.  Tenga en cuenta que una dependencia m√°s fuerte en nuestro ejemplo tiene cero sangr√≠a, y una d√©bil tiene doble sangr√≠a. </p><br><h1 id="raznye-yazyki">  Diferentes idiomas </h1><br><p>  Dio la casualidad de que para diferentes cosas tenemos diferentes idiomas para estas diferentes cosas agudizadas.  Los m√°s comunes son: JS, TS, CSS, HTML, SVG, SCSS, Less, Stylus.  Cada uno tiene su propio sistema de m√≥dulos, que no interact√∫a con otros idiomas de ninguna manera.  No hace falta decir que hay unos 100500 tipos de idiomas m√°s espec√≠ficos.  Como resultado, para conectar un componente, debe conectar por separado sus scripts, estilos separados, registrar plantillas por separado, configurar por separado la implementaci√≥n de los archivos est√°ticos que necesita, etc., etc. </p><br><p>  Gracias a los cargadores, Webpack est√° tratando de resolver este problema.  Pero tiene un punto de entrada es un script que ya conecta archivos en otros idiomas.  ¬øY si no necesitamos un script?  Por ejemplo, tenemos un m√≥dulo con hermosos estilos para platos y queremos que tengan los mismos colores en el tema claro y otros en la oscuridad: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.dark-theme</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: black; } <span class="hljs-selector-class"><span class="hljs-selector-class">.light-theme</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: white; }</code> </pre> <br><p>  Adem√°s, si dependemos del tema, se debe cargar un script que instalar√° el tema deseado seg√∫n la hora del d√≠a.  Es decir, CSS en realidad depende de JS. </p><br><p>  Idea: <strong>¬øQu√© pasa si un sistema modular no depende de idiomas?</strong> </p><br><p>  Dado que en MAM el sistema modular est√° separado de los idiomas, las dependencias pueden ser entre idiomas.  CSS puede depender de JS, que puede depender de TS, que puede depender de otro JS.  Esto se logra debido al hecho de que las dependencias de origen se detectan en los m√≥dulos, y los m√≥dulos est√°n conectados por completo y pueden contener c√≥digos fuente en cualquier idioma.  En el caso del ejemplo de temas, se ve as√≠: </p><br><p>  <strong>/my/table/table.css</strong> </p><br><pre> <code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/* ,   /my/theme */</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[my_theme="dark"]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: black; } <span class="hljs-selector-attr"><span class="hljs-selector-attr">[my_theme="light"]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: white; }</code> </pre> <br><p>  <strong>/my/theme/theme.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.documentElement.setAttribute( <span class="hljs-string"><span class="hljs-string">'my_theme'</span></span> , ( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>().getHours() + <span class="hljs-number"><span class="hljs-number">15</span></span> ) % <span class="hljs-number"><span class="hljs-number">24</span></span> &lt; <span class="hljs-number"><span class="hljs-number">12</span></span> ? <span class="hljs-string"><span class="hljs-string">'light'</span></span> : <span class="hljs-string"><span class="hljs-string">'dark'</span></span> , )</code> </pre> <br><p>  Utilizando esta t√©cnica, por cierto, puede implementar su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modernizador</a> , pero sin 300 comprobaciones que no necesita, porque solo se incluir√°n en el paquete las comprobaciones de las que realmente depende su CSS. </p><br><h1 id="mnogo-bibliotek">  Muchas bibliotecas </h1><br><p>  Por lo general, el punto de entrada para crear un paquete es alg√∫n tipo de archivo.  En el caso de Webpack, este es JS.  Si desarrolla muchas bibliotecas y aplicaciones enajenables, entonces necesita muchos paquetes.  Y para cada paquete necesita crear un punto de entrada separado.  En el caso de Parcel, el punto de entrada es HTML, que para las aplicaciones deber√° crearse de todos modos.  Pero para las bibliotecas, esto de alguna manera no es muy adecuado. </p><br><p>  Idea: <strong>¬øQu√© pasa si cualquier m√≥dulo puede ensamblarse en un paquete independiente sin preparaci√≥n previa?</strong> </p><br><p>  Armemos la √∫ltima versi√≥n del generador de proyectos $ mol_build MAM: </p><br><pre> <code class="plaintext hljs">mam mol/build</code> </pre> <br><p>  Ahora ejecute este colector y deje que se vuelva a armar para asegurarse de que todav√≠a puede hacerlo: </p><br><pre> <code class="plaintext hljs">node mol/build/-/node.js mol/build</code> </pre> <br><p>  Aunque, no, vamos a pedirle que ejecute pruebas junto con la asamblea: </p><br><pre> <code class="plaintext hljs">node mol/build/-/node.test.js mol/build</code> </pre> <br><p>  Y si todo sali√≥ bien, publique el resultado en NPM: </p><br><pre> <code class="plaintext hljs">npm publish mol/build/-</code> </pre> <br><p>  Como puede ver, al ensamblar el m√≥dulo, se crea un subdirectorio con el nombre <code>-</code> y todos los artefactos de ensamblaje se colocan all√≠.  Veamos los archivos que puedes encontrar all√≠: </p><br><ul><li>  <code>web.dep.json</code> : toda la informaci√≥n sobre el gr√°fico de dependencia </li><li>  <code>web.js</code> - paquete de script del navegador </li><li>  <code>web.js.map</code> - sorsmaps para √©l </li><li>  <code>web.esm.js</code> : tiene la forma de un m√≥dulo es </li><li>  <code>web.esm.js.map</code> - y sorsmaps para ello </li><li>  <code>web.test.js</code> - paquete de prueba </li><li>  <code>web.test.js.map</code> - y para pruebas sorsmap </li><li>  <code>web.d.ts</code> - paquete con tipos de todo lo que est√° en el paquete de script </li><li>  <code>web.css</code> - paquete con estilos </li><li>  <code>web.css.map</code> - y clasifica mapas para ello </li><li>  <code>web.test.html</code> : punto de entrada para ejecutar pruebas de rendimiento en un navegador </li><li>  <code>web.view.tree</code> : declaraciones de todos los componentes incluidos en el paquete view.tree </li><li>  <code>web.locale=*.json</code> - paquetes con textos localizados, cada paquete tiene su propio paquete </li><li>  <code>package.json</code> : le permite publicar inmediatamente el m√≥dulo ensamblado en NPM </li><li>  <code>node.dep.json</code> : toda la informaci√≥n sobre el gr√°fico de dependencia </li><li>  <code>node.js</code> - paquete de script de nodo </li><li>  <code>node.js.map</code> - sorsmaps para ello </li><li>  <code>node.esm.js</code> : tiene la forma de un m√≥dulo es </li><li>  <code>node.esm.js.map</code> - y sorsmaps para ello </li><li>  <code>node.test.js</code> : el mismo paquete, pero tambi√©n con pruebas </li><li>  <code>node.test.js.map</code> - y sorsmaps para ello </li><li>  <code>node.d.ts</code> : paquete con tipos de todo lo que est√° en el paquete de script </li><li>  <code>node.view.tree</code> : declaraciones de todos los componentes incluidos en el paquete view.tree </li><li>  <code>node.locale=*.json</code> - paquetes con textos localizados, cada paquete tiene su propio paquete </li></ul><br><p>  La est√°tica simplemente se copia junto con las rutas.  Como ejemplo, tome una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aplicaci√≥n que muestre sus propios c√≥digos fuente</a> .  Sus fuentes est√°n aqu√≠: </p><br><ul><li> <code>/mol/app/quine/quine.view.tree</code> </li> <li> <code>/mol/app/quine/quine.view.ts</code> </li> <li> <code>/mol/app/quine/index.html</code> </li> <li> <code>/mol/app/quine/quine.locale=ru.json</code> </li> </ul><br><p>  Desafortunadamente, en el caso general, el recopilador no puede saber que necesitaremos estos archivos en tiempo de ejecuci√≥n.  Pero podemos decirle esto poniendo un archivo especial cerca: </p><br><p>  <strong>/mol/app/quine/quine.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">deploy \/mol/app/quine/quine.view.tree deploy \/mol/app/quine/quine.view.ts deploy \/mol/app/quine/index.html deploy \/mol/app/quine/quine.locale=ru.json</code> </pre> <br><p>  Como resultado del ensamblado <code>/mol/app/quine</code> , se copiar√°n de las siguientes maneras: </p><br><ul><li> <code>/mol/app/quine/-/mol/app/quine/quine.view.tree</code> </li> <li> <code>/mol/app/quine/-/mol/app/quine/quine.view.ts</code> </li> <li> <code>/mol/app/quine/-/mol/app/quine/index.html</code> </li> <li> <code>/mol/app/quine/-/mol/app/quine/quine.locale=ru.json</code> </li> </ul><br><p>  Ahora el directorio <code>/mol/app/quine/-</code> se puede dise√±ar en cualquier alojamiento est√°tico y la aplicaci√≥n ser√° completamente funcional. </p><br><h1 id="celevye-platformy">  Plataformas de destino </h1><br><p>  JS se puede ejecutar tanto en el cliente como en el servidor.  Y qu√© bueno es cuando puedes escribir un c√≥digo y funcionar√° en todas partes.  Sin embargo, a veces la implementaci√≥n de lo mismo en el cliente y el servidor es fundamentalmente diferente.  Y quiero, por ejemplo, que se use una implementaci√≥n para un nodo y otra para un navegador. </p><br><p>  Idea: <strong>¬øQu√©</strong> sucede <strong>si el prop√≥sito del archivo se refleja en su nombre?</strong> </p><br><p>  MAM usa un sistema de etiquetas en los nombres de archivo.  Por ejemplo, el m√≥dulo <code>$mol_state_arg</code> proporciona acceso a los par√°metros de aplicaci√≥n definidos por el usuario.  En el navegador, estos par√°metros se establecen a trav√©s de la barra de direcciones.  Y en el nodo, a trav√©s de argumentos de l√≠nea de comando.  <code>$mol_sate_arg</code> el resto de la aplicaci√≥n de estos matices mediante la implementaci√≥n de ambas opciones con una √∫nica interfaz, coloc√°ndolas en archivos: </p><br><ul><li>  / mol / state / arg / arg.  <strong>web</strong> .ts - implementaci√≥n para navegadores </li><li>  / mol / state / arg / arg.  <strong>nodo</strong> .ts: implementaci√≥n para un nodo </li></ul><br><p>  Las fuentes no etiquetadas con estas etiquetas se incluyen independientemente de la plataforma de destino. </p><br><p>  Se observa una situaci√≥n similar con las pruebas: desean almacenarse junto al resto de las fuentes, pero no quieren incluirse en el paquete que va al usuario final.  Por lo tanto, las pruebas tambi√©n est√°n marcadas con una etiqueta separada: </p><br><ul><li>  / mol / state / arg / arg.  <strong>test</strong> .ts - pruebas de m√≥dulo, caer√°n en el paquete de prueba </li></ul><br><p>  Las etiquetas pueden ser param√©tricas.  Por ejemplo, con cada m√≥dulo pueden venir textos en varios idiomas y deben incluirse en los paquetes de idiomas correspondientes.  Un archivo de texto es un diccionario JSON normal nombrado con la configuraci√≥n regional en el nombre: </p><br><ul><li>  / mol / app / life / life.  <strong>locale = ru</strong> .json - textos para el idioma ruso </li><li>  / mol / app / life / life.  <strong>locale = jp</strong> .json - textos para japon√©s </li></ul><br><p>  Finalmente, ¬øqu√© pasa si queremos poner archivos cerca, pero queremos que el recopilador los ignore y no los incluya autom√°ticamente en el paquete?  Es suficiente agregar al comienzo de su nombre cualquier car√°cter no alfanum√©rico.  Por ejemplo: </p><br><ul><li>  / hyoo / juguetes / <strong>.</strong>  git: comienza con un punto, por lo que el recopilador ignorar√° este directorio </li></ul><br><h1 id="versionirovanie">  Versionado </h1><br><p>  Google lanz√≥ AngularJS por primera vez y lo public√≥ en NPM como <code>angular</code> .  Luego cre√≥ un marco completamente nuevo con un nombre similar: Angular y lo public√≥ con el mismo nombre, pero ya la versi√≥n 2. Ahora estos dos fuegos artificiales se est√°n desarrollando de forma independiente.  Solo se produce un cambio de ruptura de API entre las versiones principales.  Y el otro, <a href="">entre el menor</a> .  Y dado que es imposible poner dos versiones de la misma dependencia en el mismo nivel, no se puede hablar de una transici√≥n fluida, cuando dos versiones de la biblioteca coexisten simult√°neamente durante alg√∫n tiempo en la aplicaci√≥n. </p><br><p>  Parece que el equipo de Angular ya ha pisado todos los rastrillos posibles.  Y una cosa m√°s: el c√≥digo marco est√° dividido en varios m√≥dulos grandes.  Al principio, los versionaron de forma independiente, pero muy r√°pidamente, incluso ellos mismos comenzaron a confundirse sobre las versiones de los m√≥dulos que son compatibles entre s√≠, y mucho menos los desarrolladores comunes.  Por lo tanto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Angular cambi√≥ a versiones de extremo a extremo</a> , donde la versi√≥n principal del m√≥dulo puede cambiar incluso sin ning√∫n cambio en el c√≥digo.  El soporte para m√∫ltiples versiones de m√∫ltiples m√≥dulos es un gran problema tanto para los propios mantenedores como para el ecosistema en su conjunto.  Despu√©s de todo, se gastan muchos recursos de todos los miembros de la comunidad para garantizar la compatibilidad con m√≥dulos ya obsoletos. </p><br><p>  La hermosa idea de las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">versiones sem√°nticas</a> se convierte en una realidad dura: nunca se sabe si algo se romper√° cuando cambie la versi√≥n menor <a href="">o incluso la versi√≥n del parche</a> .  Por lo tanto, en muchos proyectos, se repara una versi√≥n espec√≠fica de la dependencia.  Sin embargo, una soluci√≥n de este tipo no afecta las dependencias transitivas, que pueden ser atra√≠das a la √∫ltima versi√≥n cuando se instala desde cero, pero pueden seguir siendo las mismas si ya lo son.  Este desastre lleva al hecho de que nunca puede confiar en una versi√≥n fija y necesita verificar regularmente la compatibilidad con las versiones actuales de dependencias (al menos transitivas). </p><br><p>  ¬øPero qu√© pasa con <a href="">los archivos de bloqueo</a> ?  Si est√° desarrollando una biblioteca que se instala a trav√©s de dependencias, el archivo de bloqueo no lo ayudar√°, ya que el administrador de paquetes lo ignorar√°.  Para la aplicaci√≥n final, el archivo de bloqueo le dar√° la llamada "reproducibilidad de ensamblajes".  Pero seamos honestos.  ¬øCu√°ntas veces necesitas construir la aplicaci√≥n final desde la misma fuente?  Exactamente una vez.  Al recibir la salida, independientemente de cualquier NPM, el artefacto de ensamblaje: un binario ejecutable, un contenedor de acoplador o simplemente un archivo con todo el c√≥digo necesario para ejecutarlo.  Espero que no <code>npm install</code> haciendo <code>npm install</code> en prod? </p><br><p>  Algunos encuentran el uso de archivos de bloqueo para que el servidor CI re√∫na exactamente lo que el desarrollador ha comprometido.  Pero espere, el desarrollador mismo puede simplemente ensamblarlo en su m√°quina local.  ,    ,  ,    . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Continuous Integration</a>       ,     ,    ,  ,   - .  CI        ,            . </p><br><p>        ,     ,  . ,            Angular@4 (  3).  ,     ,  "     "  "     ".      Angular@4     ,      Angular@5.      Angular@6,         .  Angular   TypeScript    .     .  ,   2  ,  ‚Ä¶      ,   business value    ,     ,  ,  ,  . </p><br><p>                   ,    ,       ,   ,       2 .    :      ,  ‚Äî ,  ‚Äî .       3 React, 5 jQuery, 7 lodash. </p><br><p> : <strong>         ‚Äî ?</strong> </p><br><p>         .     -   .     ,       .     ,     .  ,    .  ,       .        ,    .   ,        ,            .      :  issue,    ,  workaround,  pull request,    ,      .          ,    ,    .        .            . </p><br><p>               ,        . ,        ,       .        .        .  :  ,       ,     -.     -      ‚Äî       .  ,            ,    -  .         , ,  ,   NPM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a>     .  ,      .       . </p><br><p>         ,      ?   ‚Äî   .  <code>mobx</code> ,  <code>mobx2</code>     API  .   ‚Äî    ,    :     ,       .     <code>mobx</code>        <code>mobx2</code> ,      API.         API,     . </p><br><p>        .           ‚Äî .  ,      : </p><br><pre> <code class="plaintext hljs">var pages_count = $mol_atom2_sync( ()=&gt; $lib_pdfjs.getDocument( uri ).promise ).document().numPages</code> </pre> <br><p>  <strong> </strong>   <code>mol_atom2_sync</code>  <code>lib_pdfjs</code> ,      : </p><br><pre> <code class="plaintext hljs">npm install mol_atom2_sync@2.1 lib_pdfjs@5.6</code> </pre> <br><p> ,   , ‚Äî   ,       .        ?    ‚Äî    ,    <code>*.meta.tree</code> ,          : </p><br><p> <strong>/.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">pack node git \https://github.com/nin-jin/pms-node.git pack mol git \https://github.com/eigenmethod/mol.git pack lib git \https://github.com/eigenmethod/mam-lib.git</code> </pre> <br><p>    .             . </p><br><h1 id="integraciya-s-npm">   NPM </h1><br><p> MAM ‚Äî    NPM . ,         ‚Äî . ,    ,     NPM      . </p><br><p>          NPM ,     $node. ,   -        -: </p><br><p> <strong>/my/app/app.ts</strong> </p><br><pre> <code class="plaintext hljs">$node.portastic.find({ min : 8080 , max : 8100 , retrieve : 1 }).then( ( ports : number[] ) =&gt; { $node.express().listen( ports[0] ) })</code> </pre> <br><p>       ,     . -    <code>lib</code>      NPM . ,     NPM- <code>pdfjs-dist</code> : </p><br><p> <strong>/lib/pdfjs/pdfjs.ts</strong> </p><br><pre> <code class="plaintext hljs">namespace $ { export let $lib_pdfjs : typeof import( 'pdfjs-dist' ) = require( 'pdfjs-dist/build/pdf.min.js' ) $lib_pdfjs.disableRange = true $lib_pdfjs.GlobalWorkerOptions.workerSrc = '-/node_modules/pdfjs-dist/build/pdf.worker.min.js' }</code> </pre> <br><p> <strong>/lib/pdfjs/pdfjs.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">deploy \/node_modules/pdfjs-dist/build/pdf.worker.min.js</code> </pre> <br><p>        ,    . </p><br><h1 id="okruzhenie-razrabotchika">   </h1><br><p>          .     <code>create-react-app</code>  <code>angular-cli</code> ,       . , ,   <code>eject</code>       .          .       ,         ,       . </p><br><p> : <strong>      ?</strong> </p><br><p>    MAM      .          . </p><br><p>      MAM  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   MAM </a> ,    : </p><br><pre> <code class="plaintext hljs">git clone https://github.com/eigenmethod/mam.git ./mam &amp;&amp; cd mam npm install npm start</code> </pre> <br><p>   8080   . ,    ‚Äî        MAM. </p><br><p>     (  ‚Äî <code>acme</code> )         (  ‚Äî <code>hello</code>  <code>home</code> ): </p><br><p> <strong>/acme/acme.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">pack hello git \https://github.com/acme/hello.git pack home git \https://github.com/acme/home.git</code> </pre> <br><p>           <code>npm start</code> : </p><br><pre> <code class="plaintext hljs">npm start acme/hello acme/home</code> </pre> <br><p>         .     ‚Äî  . ,  ,   .     ‚Äî   : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://t.me/mam_mol</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/456288/">https://habr.com/ru/post/456288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456272/index.html">¬øQu√© es Android Lint y c√≥mo te ayuda a escribir c√≥digo compatible?</a></li>
<li><a href="../456274/index.html">Psic√≥logos: los robots sexuales conducir√°n a un aumento en el n√∫mero de personas sin pareja que no necesitan relaciones con otras personas</a></li>
<li><a href="../456276/index.html">¬øQu√© es la informaci√≥n?</a></li>
<li><a href="../456280/index.html">Comenzar con stm32 o no repetir mis errores</a></li>
<li><a href="../456282/index.html">Gr√°ficos multidimensionales en Python: de tridimensional a seis dimensional</a></li>
<li><a href="../456290/index.html">Telegrama Unidad de red ilimitada. Gratis</a></li>
<li><a href="../456294/index.html">Diferencias entre LabelEncoder y OneHotEncoder en SciKit Learn</a></li>
<li><a href="../456296/index.html">El mundo de la hiperesfera tridimensional. Trazado de rayos geod√©sicos en un universo cerrado con geometr√≠a esf√©rica</a></li>
<li><a href="../456298/index.html">Tecnolog√≠as de microelectr√≥nica en los dedos: la Ley de Moore, los movimientos de marketing y por qu√© los nan√≥metros no son lo mismo ahora. Parte 2</a></li>
<li><a href="../456300/index.html">Encontrar zina</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>