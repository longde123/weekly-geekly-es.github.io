<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§–ğŸ¼ ğŸ•¹ï¸ ğŸ¤³ğŸ½ å¯ç¼–ç ç”¨äºAPIè¯·æ±‚ä»¥åŠå¦‚ä½•æŒ‰é¡ºåºæ”¾ç½®ä»£ç  ğŸ‘©ğŸ½â€ğŸ”§ ğŸ“¸ ğŸ¤ŸğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ 

 ä»Swift 4å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–°çš„Codableåè®®ï¼Œä»è€Œå¯ä»¥è½»æ¾åœ°å¯¹æ¨¡å‹è¿›è¡Œç¼–ç /è§£ç ã€‚ æˆ‘çš„é¡¹ç›®ä¸­æœ‰è®¸å¤šç”¨äºAPIè°ƒç”¨çš„ä»£ç ï¼Œå¹¶ä¸”åœ¨è¿‡å»çš„ä¸€å¹´é‡Œï¼Œæˆ‘é€šè¿‡æ€æ­»é‡å¤çš„ä»£ç å¹¶ç”šè‡³å¯¹å¤šéƒ¨åˆ†è¯·æ±‚å’ŒurlæŸ¥è¯¢å‚æ•°ä½¿ç”¨Codableï¼Œå°†å¤§é‡çš„ä»£ç ä¼˜åŒ–ä¸ºéå¸¸è½»å·§ï¼Œç®€æ´å’Œç®€å•çš„ä¸œè¥¿ã€‚ åœ¨æˆ‘çœ‹æ¥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¯ç¼–ç ç”¨äºAPIè¯·æ±‚ä»¥åŠå¦‚ä½•æŒ‰é¡ºåºæ”¾ç½®ä»£ç </h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427937/">å“ˆHaï¼ <br><br> ä»Swift 4å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–°çš„Codableåè®®ï¼Œä»è€Œå¯ä»¥è½»æ¾åœ°å¯¹æ¨¡å‹è¿›è¡Œç¼–ç /è§£ç ã€‚ æˆ‘çš„é¡¹ç›®ä¸­æœ‰è®¸å¤šç”¨äºAPIè°ƒç”¨çš„ä»£ç ï¼Œå¹¶ä¸”åœ¨è¿‡å»çš„ä¸€å¹´é‡Œï¼Œæˆ‘é€šè¿‡æ€æ­»é‡å¤çš„ä»£ç å¹¶ç”šè‡³å¯¹å¤šéƒ¨åˆ†è¯·æ±‚å’ŒurlæŸ¥è¯¢å‚æ•°ä½¿ç”¨Codableï¼Œå°†å¤§é‡çš„ä»£ç ä¼˜åŒ–ä¸ºéå¸¸è½»å·§ï¼Œç®€æ´å’Œç®€å•çš„ä¸œè¥¿ã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œå®ƒæ˜¯ç”¨äºå‘é€è¯·æ±‚å’Œè§£ææœåŠ¡å™¨å“åº”çš„å‡ ä¸ªå‡ºè‰²çš„ç±»ã€‚ ä»¥åŠæ–¹ä¾¿çš„æ–‡ä»¶ç»“æ„ï¼Œå®ƒæ˜¯æ¯ç»„è¯·æ±‚çš„æ§åˆ¶å™¨ï¼Œæˆ‘åœ¨åç«¯ä½¿ç”¨Vapor 3æ—¶æ‰æ ¹ã€‚ å‡ å¤©å‰ï¼Œæˆ‘å°†æ‰€æœ‰å¼€å‘å†…å®¹åˆ†é…åˆ°ä¸€ä¸ªå•ç‹¬çš„åº“ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸ºCodyFireã€‚ æˆ‘æƒ³åœ¨è¿™ç¯‡æ–‡ç« ä¸­è°ˆè®ºå¥¹ã€‚ <br><a name="habracut"></a><br><h4> å…è´£å£°æ˜ </h4><br>  CodyFireåŸºäºAlamofireï¼Œä½†å®ƒä¸ä»…ä»…æ˜¯Alamofireçš„åŒ…è£…ï¼Œå®ƒæ˜¯ä¸iOSçš„REST APIä¸€èµ·ä½¿ç”¨çš„æ•´ä¸ªç³»ç»Ÿæ–¹æ³•ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¸ç”¨æ‹…å¿ƒAlamofireä¼šçœ‹åˆ°ç¬¬äº”ç‰ˆå°†æä¾›Codableæ”¯æŒçš„åŸå› ï¼Œå› ä¸º å®ƒä¸ä¼šæ€æ­»æˆ‘çš„åˆ›é€ ã€‚ <br><br><h2> åˆå§‹åŒ– </h2><br> è®©æˆ‘ä»¬ä»è¿œå¤„å¼€å§‹ï¼Œå³æˆ‘ä»¬ç»å¸¸æ‹¥æœ‰ä¸‰å°æœåŠ¡å™¨ï¼š <br><br>  <b>dev-</b>å¯¹äºå¼€å‘ï¼Œæˆ‘ä»¬ä»Xcodeå¼€å§‹ <br>  <b>é˜¶æ®µ</b> -åœ¨å‘å¸ƒå‰è¿›è¡Œæµ‹è¯•ï¼Œé€šå¸¸åœ¨TestFlightæˆ–InHouseä¸­è¿›è¡Œ <br>  <b>äº§å“</b> -ç”Ÿäº§ï¼Œç”¨äºAppStore <br><br> å½“ç„¶ï¼Œè®¸å¤šiOSå¼€å‘äººå‘˜éƒ½çŸ¥é“Xcodeä¸­å­˜åœ¨<i>ç¯å¢ƒå˜é‡</i>å’Œå¯åŠ¨æ–¹æ¡ˆï¼Œä½†æ˜¯åœ¨æˆ‘ï¼ˆè¶…è¿‡8å¹´çš„å®è·µï¼‰ä¸­ï¼Œæœ‰90ï¼…çš„å¼€å‘äººå‘˜åœ¨æµ‹è¯•æ—¶æˆ–ç»„è£…å‰ä»¥ä¸€å®šçš„å¸¸æ•°æ‰‹åŠ¨ç¼–å†™äº†æ­£ç¡®çš„æœåŠ¡å™¨ï¼Œè¿™æ˜¯æˆ‘æƒ³é€šè¿‡å±•ç¤ºä¸€ä¸ªæ­£ç¡®çš„ä¾‹å­æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ <br><br> é»˜è®¤æƒ…å†µä¸‹ï¼ŒCodyFireè‡ªåŠ¨ç¡®å®šåº”ç”¨ç¨‹åºå½“å‰åœ¨å“ªä¸ªç¯å¢ƒä¸­è¿è¡Œï¼Œè¿™éå¸¸ç®€å•ï¼š <br><br><pre><code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> DEBUG //DEV environment #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> Bundle.main.appStoreReceiptURL?.lastPathComponent == "sandboxReceipt" { //TESTFLIGHT environment } </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> { //APPSTORE environment } #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre> <br> è¿™å½“ç„¶æ˜¯åœ¨å¹•åï¼Œåœ¨AppDelegateçš„é¡¹ç›®ä¸­ï¼Œæ‚¨åªéœ€è¦æ³¨å†Œä¸‰ä¸ªURL <br><br><pre> <code class="hljs objectivec">import CodyFire @<span class="hljs-built_in"><span class="hljs-built_in">UIApplicationMain</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> AppDelegate: <span class="hljs-built_in"><span class="hljs-built_in">UIResponder</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">UIApplicationDelegate</span></span> { func application(_ application: <span class="hljs-built_in"><span class="hljs-built_in">UIApplication</span></span>, didFinishLaunchingWithOptions launchOptions: [<span class="hljs-built_in"><span class="hljs-built_in">UIApplication</span></span>.LaunchOptionsKey : Any]? = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) -&gt; Bool { let dev = CodyFireEnvironment(baseURL: <span class="hljs-string"><span class="hljs-string">"http://localhost:8080"</span></span>) let testFlight = CodyFireEnvironment(baseURL: <span class="hljs-string"><span class="hljs-string">"https://stage.myapi.com"</span></span>) let appStore = CodyFireEnvironment(baseURL: <span class="hljs-string"><span class="hljs-string">"https://api.myapi.com"</span></span>) CodyFire.shared.configureEnvironments(dev: dev, testFlight: testFlight, appStore: appStore) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre><br> ä¸€ä¸ªäººå¯èƒ½å¯¹æ­¤æ„Ÿåˆ°é«˜å…´ï¼Œå´æ— æ‰€ä½œä¸ºã€‚ <br><br> ä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨Xcodeä¸­æµ‹è¯•å¼€å‘ï¼Œç™»å°å’Œç”Ÿäº§æœåŠ¡å™¨ï¼Œä¸ºæ­¤ï¼Œæˆ‘æ•¦ä¿ƒæ‚¨ä½¿ç”¨å¯åŠ¨æ–¹æ¡ˆã€‚ <br><br><img src="https://habrastorage.org/webt/u_/rp/t_/u_rpt_jk71avrzwwasrgviv7rgk.png" alt="å›¾ç‰‡"><br><blockquote>  <i>æç¤ºï¼šåœ¨â€œ <i>ç®¡ç†æ–¹æ¡ˆâ€</i>éƒ¨åˆ†ä¸­ï¼Œè¯·ä¸è¦å¿˜è®°é€‰ä¸­æ¯ä¸ªæ–¹æ¡ˆçš„â€œå…±äº«â€æ¡†ï¼Œä»¥ä¾¿é¡¹ç›®ä¸­çš„æ‰€æœ‰å¼€å‘äººå‘˜éƒ½å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚</i> </blockquote><br> åœ¨æ¯ç§æ–¹æ¡ˆä¸­ï¼Œæ‚¨éƒ½éœ€è¦ç¼–å†™ç¯å¢ƒå˜é‡`env`ï¼Œè¯¥å˜é‡å¯ä»¥é‡‡ç”¨ä¸‰ä¸ªå€¼ï¼šdevï¼ŒtestFlightå’ŒappStoreã€‚ <br><br><img src="https://habrastorage.org/webt/ur/j4/ee/urj4eeqtonszxwlo8uv-w8fdt4a.png" alt="å›¾ç‰‡"><br><br> ä¸ºäº†ä½¿è¿™äº›æ–¹æ¡ˆä¸CodyFireä¸€èµ·ä½¿ç”¨ï¼Œæ‚¨éœ€è¦åœ¨åˆå§‹åŒ–CodyFireä¹‹åå‘<i>AppDelegate.didFinishLaunchingWithOptions</i>æ·»åŠ ä»¥ä¸‹ä»£ç  <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">CodyFire</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.shared</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.setupEnvByProjectScheme</span></span>()</code> </pre> <br> è€Œä¸”ï¼Œé¡¹ç›®çš„è€æ¿æˆ–æµ‹è¯•äººå‘˜ç»å¸¸å¯èƒ½ä¼šè¦æ±‚æ‚¨åœ¨<i>LoginScreen</i>ä¸Šçš„æŸä¸ªä½ç½®å³æ—¶åˆ‡æ¢æœåŠ¡å™¨ã€‚ ä½¿ç”¨CodyFireï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨ä¸€è¡Œä¸­åˆ‡æ¢æœåŠ¡å™¨ï¼Œæ›´æ”¹ç¯å¢ƒæ¥è½»æ¾å®ç°æ­¤ç›®çš„ï¼š <br><br><pre> <code class="hljs vhdl">CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.environmentMode = .appStore</code> </pre> <br><blockquote> è¿™å°†ä¸€ç›´èµ·ä½œç”¨ï¼Œç›´åˆ°é‡æ–°å¯åŠ¨è¯¥åº”ç”¨ç¨‹åºä¸ºæ­¢ï¼›å¦‚æœè¦åœ¨å¯åŠ¨åå°†å…¶ä¿å­˜ï¼Œåˆ™å°†è¯¥å€¼ä¿å­˜åœ¨<i>UserDefaultsä¸­</i> ï¼Œè¯·æ£€æŸ¥ä½•æ—¶åœ¨<i>AppDelegateä¸­</i>å¯åŠ¨è¯¥åº”ç”¨ç¨‹åºï¼Œå¹¶å°†ç¯å¢ƒåˆ‡æ¢åˆ°å¿…è¦çš„ç¯å¢ƒã€‚ </blockquote> æˆ‘å‘Šè¯‰äº†è¿™ä¸€é‡è¦ç‚¹ï¼Œå¸Œæœ›æœ‰æ›´å¤šçš„é¡¹ç›®å¯ä»¥å¾ˆå¥½åœ°å®Œæˆç¯å¢ƒåˆ‡æ¢ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬å·²ç»åˆå§‹åŒ–äº†åº“ã€‚ <br><br><h2> æ–‡ä»¶ç»“æ„å’Œæ§åˆ¶å™¨ </h2><br> ç°åœ¨æ‚¨å¯ä»¥è°ˆè°ˆæˆ‘å¯¹æ‰€æœ‰APIè°ƒç”¨çš„æ–‡ä»¶ç»“æ„çš„çœ‹æ³•ï¼Œè¿™å¯ä»¥ç§°ä¸ºCodyFireçš„æ€æƒ³ä½“ç³»ã€‚ <br><br> è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæœ€ç»ˆåœ¨é¡¹ç›®ä¸­çš„å¤–è§‚ <br><br><img src="https://habrastorage.org/webt/0f/pn/l8/0fpnl8_sb2a6uhivnubvfwdgddy.png" alt="å›¾ç‰‡"><br><br> ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ–‡ä»¶åˆ—è¡¨ï¼Œè®©æˆ‘ä»¬ä»<i>API.swift</i>å¼€å§‹ã€‚ <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">API</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> auth = <span class="hljs-type"><span class="hljs-type">AuthController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> post = <span class="hljs-type"><span class="hljs-type">PostController</span></span> }</code> </pre><br> æ­¤å¤„åˆ—å‡ºäº†æ‰€æœ‰æ§åˆ¶å™¨çš„é“¾æ¥ï¼Œä»¥ä¾¿å¯ä»¥é€šè¿‡API.controller.methodè½»æ¾è°ƒç”¨å®ƒä»¬ã€‚ <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthController</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre><br>  <i>API + Login.swift</i> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginResponse</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> token: <span class="hljs-type"><span class="hljs-type">String</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(email: String, password: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>&lt;<span class="hljs-type"><span class="hljs-type">LoginResponse</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>(<span class="hljs-string"><span class="hljs-string">"login"</span></span>).method(.post) .basicAuth(email: email, password: password) .addCustomError(.notFound, <span class="hljs-string"><span class="hljs-string">"User not found"</span></span>) } }</code> </pre><br> åœ¨æ­¤è£…é¥°å™¨ä¸­ï¼Œæˆ‘ä»¬å£°æ˜ä¸€ä¸ªå‡½æ•°æ¥è°ƒç”¨æˆ‘ä»¬çš„APIï¼š <br><br>  -æŒ‡å®šç«¯ç‚¹ <br>  -HTTP POSTæ–¹æ³• <br>  -ä½¿ç”¨åŒ…è£…å™¨è¿›è¡ŒåŸºæœ¬èº«ä»½éªŒè¯ <br>  -ä¸ºæœåŠ¡å™¨çš„ç‰¹å®šå“åº”å£°æ˜æ‰€éœ€çš„æ–‡æœ¬ï¼ˆè¿™å¾ˆæ–¹ä¾¿ï¼‰ <br>  -å¹¶æŒ‡å‡ºå°†ç”¨æ¥è§£ç æ•°æ®çš„æ¨¡å‹ <br><br> ä»€ä¹ˆä»ç„¶éšè—ï¼Ÿ <br><br>  -æ— éœ€æŒ‡å®šå®Œæ•´çš„æœåŠ¡å™¨URLï¼Œå› ä¸º å®ƒå·²ç»åœ¨å…¨çƒè®¾ç½® <br>  -ä¸å¿…è¡¨ç¤ºå¦‚æœä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œæˆ‘ä»¬å¸Œæœ›æ”¶åˆ°<i>200 OK</i> <br><blockquote>  200 OKæ˜¯CodyFireæœŸæœ›çš„æ‰€æœ‰è¯·æ±‚çš„é»˜è®¤çŠ¶æ€ä»£ç ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®å°†è¢«è§£ç å¹¶è°ƒç”¨å›è°ƒï¼Œä¸€åˆ‡æ­£å¸¸ï¼Œè¿™æ˜¯æ‚¨çš„æ•°æ®ã€‚ </blockquote> æ­¤å¤–ï¼Œåœ¨<i>LoginScreen</i>ä»£ç çš„æŸå¤„<i>ï¼Œ</i>æ‚¨åªéœ€è°ƒç”¨ <br><br><pre> <code class="hljs lua">API.auth.login(email: <span class="hljs-string"><span class="hljs-string">"test@mail.com"</span></span>, password: <span class="hljs-string"><span class="hljs-string">"qwerty"</span></span>).onError { <span class="hljs-built_in"><span class="hljs-built_in">error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> switch <span class="hljs-built_in"><span class="hljs-built_in">error</span></span>.code { case .notFound: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">error</span></span>.description) //: User <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> found default: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">error</span></span>.description) } }.onSuccess { token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> //TODO:  auth token    <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Received auth token: "</span></span>+ token) }</code> </pre><br>  <i>onError</i>å’Œ<i>onSuccess</i>åªæ˜¯APIRequestå¯ä»¥è¿”å›çš„å›è°ƒçš„ä¸€å°éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åœ¨åé¢è®¨è®ºã€‚ <br><br> åœ¨è¾“å…¥ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä»…è€ƒè™‘äº†å¯¹è¿”å›çš„æ•°æ®è¿›è¡Œè‡ªåŠ¨è§£ç æ—¶çš„é€‰é¡¹ï¼Œä½†æ˜¯æ‚¨å¯ä»¥è¯´æ‚¨è‡ªå·±å¯ä»¥å®ç°å®ƒï¼Œè€Œä¸”æ‚¨æ˜¯å¯¹çš„ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬ä»¥æ³¨å†Œè¡¨æ ¼ä¸ºä¾‹ï¼Œè€ƒè™‘æ ¹æ®æ¨¡å‹å‘é€æ•°æ®çš„å¯èƒ½æ€§ã€‚ <br><br>  <i>API + Signup.swift</i> <br><br><pre> <code class="hljs rust">extension AuthController { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignupRequest</span></span></span></span>: JSONPayload { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> email, password: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstName, lastName, mobileNumber: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> init(email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, password: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, firstName: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, lastName: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, mobileNumber: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.email = email <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.password = password <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.firstName = firstName <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.lastName = lastName <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.mobileNumber = mobileNumber } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignupResponse</span></span></span></span>: Codable { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> token: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> func signup(_ request: SignupRequest) -&gt; APIRequest&lt;SignupResponse&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> APIRequest(<span class="hljs-string"><span class="hljs-string">"signup"</span></span>, payload: request).method(.post) .addError(.conflict, <span class="hljs-string"><span class="hljs-string">"Account already exists"</span></span>) } }</code> </pre><br> ä¸ç™»å½•ä¸åŒï¼Œåœ¨æ³¨å†Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼ è¾“å¤§é‡æ•°æ®ã€‚ <br><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å…·æœ‰ä¸€ä¸ªç¬¦åˆ<i>JSONPayload</i>åè®®çš„<i>SignupRequest</i>æ¨¡å‹ï¼ˆå› æ­¤CodyFireç†è§£äº†æœ‰æ•ˆè´Ÿè½½ç±»å‹ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬çš„è¯·æ±‚çš„ä¸»ä½“ä¸ºJSONå½¢å¼ã€‚ å¦‚æœæ‚¨éœ€è¦x-www-form-urlencodedï¼Œè¯·ä½¿ç”¨<i>FormURLEncodedPayload</i> ã€‚ <br><br> ç»“æœï¼Œæ‚¨è·å¾—äº†ä¸€ä¸ªæ¥å—æœ‰æ•ˆè´Ÿè½½æ¨¡å‹çš„ç®€å•å‡½æ•° <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">API</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.auth</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.signup</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">request</span></span>)</code> </pre> <br> å¦‚æœæˆåŠŸï¼Œå®ƒå°†ä¸ºæ‚¨è¿”å›ç‰¹å®šçš„å“åº”æ¨¡å‹ã€‚ <br><br> æˆ‘è§‰å¾—å¾ˆé…·ï¼Œå¯¹å§ï¼Ÿ <br><br><h4> ä½†æ˜¯å¦‚æœæ˜¯å¤šéƒ¨åˆ†çš„å‘¢ï¼Ÿ </h4><br> è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå¯ä»¥åˆ›å»º<i>Post</i>çš„ç¤ºä¾‹ã€‚ <br><br>  <i>å‘å¸ƒ+ Create.swift</i> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateRequest</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MultipartPayload</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tags: [<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> images: [<span class="hljs-type"><span class="hljs-type">Attachment</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> video: <span class="hljs-type"><span class="hljs-type">Data</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> (text: <span class="hljs-type"><span class="hljs-type">String</span></span>, tags: [<span class="hljs-type"><span class="hljs-type">String</span></span>], images: [<span class="hljs-type"><span class="hljs-type">Attachment</span></span>], video: <span class="hljs-type"><span class="hljs-type">Data</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.text = text <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tags = tags <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.images = images <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.video = video } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Post</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> text: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> tags: [<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> linksToImages: [<span class="hljs-type"><span class="hljs-type">String</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> linkToVideo: <span class="hljs-type"><span class="hljs-type">String</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> request: CreateRequest)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>&lt;<span class="hljs-type"><span class="hljs-type">CreateRequest</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>(<span class="hljs-string"><span class="hljs-string">"post"</span></span>, payload: request).method(.post) } }</code> </pre><br> æ­¤ä»£ç å°†èƒ½å¤Ÿå‘é€åŒ…å«å›¾åƒæ–‡ä»¶æ•°ç»„å’Œä¸€ä¸ªè§†é¢‘çš„å¤šéƒ¨åˆ†è¡¨å•ã€‚ <br> è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è°ƒç”¨è°ƒåº¦ã€‚ è¿™æ˜¯å…³äº<i>Attachment</i>çš„æœ€æœ‰è¶£çš„æ—¶åˆ»ã€‚ <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> videoData = <span class="hljs-type"><span class="hljs-type">FileManager</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>.contents(atPath: <span class="hljs-string"><span class="hljs-string">"/path/to/video.mp4"</span></span>)! <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> imageAttachment = <span class="hljs-type"><span class="hljs-type">Attachment</span></span>(data: <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(named: <span class="hljs-string"><span class="hljs-string">"cat"</span></span>)!.jpeg(.high)!, fileName: <span class="hljs-string"><span class="hljs-string">"cat.jpg"</span></span>, mimeType: .jpg) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> payload = <span class="hljs-type"><span class="hljs-type">PostController</span></span>.<span class="hljs-type"><span class="hljs-type">CreateRequest</span></span>(text: <span class="hljs-string"><span class="hljs-string">"CodyFire is awesome"</span></span>, tags: [<span class="hljs-string"><span class="hljs-string">"codyfire"</span></span>, <span class="hljs-string"><span class="hljs-string">"awesome"</span></span>], images: [imageAttachment], video: videoData) <span class="hljs-type"><span class="hljs-type">API</span></span>.post.create(payload).onProgress { progress <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">" : \(progress)"</span></span>) }.onError { error <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(error.description) }.onSuccess { createdPost <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"  : \(createdPost)"</span></span>) }</code> </pre><br>  <i>é™„ä»¶</i>æ˜¯ä¸€ç§æ¨¡å‹ï¼Œå…¶ä¸­é™¤äº†<i>æ•°æ®ä¹‹å¤–ï¼Œ</i>è¿˜ä¼ è¾“æ–‡ä»¶ååŠå…¶MimeTypeã€‚ <br><br> å¦‚æœæ‚¨æ›¾ç»ä½¿ç”¨Alamofireæˆ–è£¸éœ²çš„<i>URLRequest</i>ä»Swiftæäº¤äº†å¤šéƒ¨åˆ†è¡¨å•<i>ï¼Œé‚£ä¹ˆ</i>æˆ‘ç›¸ä¿¡æ‚¨ä¼šå–œæ¬¢<i>CodyFire</i>çš„ç®€å•æ€§ã€‚ <br><br> ç°åœ¨æ›´ç®€å•ä½†ä¸å°‘é…·çš„GETè°ƒç”¨ç¤ºä¾‹ã€‚ <br><br>  <i>å‘å¸ƒ+ Get.swift</i> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListQuery</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Codable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> offset, limit: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span> (offset: <span class="hljs-type"><span class="hljs-type">Int</span></span>, limit: <span class="hljs-type"><span class="hljs-type">Int</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.offset = offset <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.limit = limit } } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> query: ListQuery? = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">nil</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>&lt;[<span class="hljs-type"><span class="hljs-type">Post</span></span>]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>(<span class="hljs-string"><span class="hljs-string">"post"</span></span>).query(query) } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id: UUID)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Post</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>(<span class="hljs-string"><span class="hljs-string">"post/"</span></span> + id.uuidString) } }</code> </pre><br> æœ€ç®€å•çš„ä¾‹å­æ˜¯ <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">API</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.post</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.get</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:)</span></span></code> </pre> <br> åœ¨<i>onSuccessä¸­ï¼Œ</i>å®ƒå°†å‘æ‚¨è¿”å›<i>Post</i>æ¨¡å‹ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªæ›´æœ‰è¶£çš„ç¤ºä¾‹ã€‚ <br><br><pre> <code class="hljs pgsql">API.post.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(PostController.ListQuery(<span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>))</code> </pre> <br> å®ƒä»¥<i>ListQuery</i>æ¨¡å‹ä½œä¸ºè¾“å…¥ï¼Œ <br> æœ€ç»ˆå“ªä¸ªAPIRequestè½¬æ¢ä¸ºä»¥ä¸‹å½¢å¼çš„URLè·¯å¾„ <br><br><pre> <code class="hljs pgsql">post?<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>&amp;<span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span></code> </pre> <br> å¹¶å°†<i>[Post]</i>æ•°ç»„è¿”å›åˆ°<i>onSuccess</i> ã€‚ <br><br> å½“ç„¶ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§æ—§çš„æ–¹å¼ç¼–å†™URLè·¯å¾„ï¼Œä½†æ˜¯ç°åœ¨æ‚¨çŸ¥é“å®Œå…¨å¯ä»¥ç¼–ç äº†ã€‚ <br><br> æœ€åçš„ç¤ºä¾‹è¯·æ±‚å°†æ˜¯DELETE <br><br>  <i>å‘è¡¨+ Delete.swift</i> <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PostController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id: UUID)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Nothing</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">APIRequest</span></span>(<span class="hljs-string"><span class="hljs-string">"post/"</span></span> + id.uuidString) .method(.delete) .desiredStatusCode(.noContent) } }</code> </pre><br> æœ‰ä¸¤ä¸ªæœ‰è¶£çš„è§‚ç‚¹ã€‚ <br><br>  -è¿”å›ç±»å‹ä¸ºAPIRequestï¼Œå®ƒæŒ‡å®šé€šç”¨ç±»å‹<i>Nothing</i> ï¼Œå®ƒæ˜¯ä¸€ä¸ªç©ºçš„<i>Codable</i>æ¨¡å‹ã€‚ <br>  -æˆ‘ä»¬æ˜ç¡®è¡¨ç¤ºå¸Œæœ›æ”¶åˆ°204ä¸ªNOå†…å®¹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹CodyFireä»…ä¼šè°ƒç”¨<i>onSuccess</i> ã€‚ <br><br> æ‚¨å·²ç»çŸ¥é“å¦‚ä½•ä»ViewControllerè°ƒç”¨æ­¤ç»ˆç»“ç‚¹ã€‚ <br><br> ä½†æ˜¯æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œç¬¬ä¸€ä¸ªå¸¦æœ‰<i>onSuccess</i> ï¼Œç¬¬äºŒä¸ªæ²¡æœ‰ã€‚ æˆ‘ä»¬æ¥çœ‹ä»– <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">API</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.post</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.delete</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">id</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:).execute()</span></span></code> </pre> <br> å°±æ˜¯è¯´ï¼Œå¦‚æœæ‚¨å¯¹è¯·æ±‚æ˜¯å¦æˆåŠŸå¹¶ä¸é‡è¦ï¼Œåˆ™å¯ä»¥ç®€å•åœ°å¯¹å…¶è°ƒç”¨<i>.executeï¼ˆï¼‰</i> ï¼Œå¦åˆ™ï¼Œå®ƒå°†åœ¨å¤„ç†ç¨‹åºçš„<i>onSuccess</i>å£°æ˜ä¹‹åå¼€å§‹ã€‚ <br><br><h2> å¯ç”¨åŠŸèƒ½ </h2><br><h4> æ¯ä¸ªè¯·æ±‚çš„æˆæƒ </h4><br> è¦ä½¿ç”¨ä»»ä½•http-headerç­¾åæ¯ä¸ªè¯·æ±‚APIï¼Œè¯·ä½¿ç”¨å…¨å±€å¤„ç†ç¨‹åºï¼Œæ‚¨å¯ä»¥åœ¨<i>AppDelegateä¸­çš„</i>æŸä¸ªä½ç½®è¿›è¡Œè®¾ç½®ã€‚ æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç»å…¸çš„[Stringï¼šString]æˆ–Codableæ¨¡å‹è¿›è¡Œé€‰æ‹©ã€‚ <br><br> æˆæƒè½½ä½“ç¤ºä¾‹ã€‚ <br><br>  1.å¯ç¼–ç ï¼ˆæ¨èï¼‰ <br><pre> <code class="hljs ruby">CodyFire.shared.fillCodableHeaders = { struct <span class="hljs-symbol"><span class="hljs-symbol">Headers:</span></span> Codable { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-symbol"><span class="hljs-symbol">NOTE:</span></span>  <span class="hljs-literal"><span class="hljs-literal">nil</span></span>,     headers var <span class="hljs-symbol"><span class="hljs-symbol">Authorization:</span></span> String? var <span class="hljs-symbol"><span class="hljs-symbol">anythingElse:</span></span> String } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Headers(<span class="hljs-symbol"><span class="hljs-symbol">Authorization:</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">anythingElse:</span></span> <span class="hljs-string"><span class="hljs-string">"hello"</span></span>) }</code> </pre><br>  2.ç»å…¸[Stringï¼šString] <br><pre> <code class="hljs swift"><span class="hljs-type"><span class="hljs-type">CodyFire</span></span>.shared.fillHeaders = { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> apiToken = <span class="hljs-type"><span class="hljs-type">LocalAuthStorage</span></span>.savedToken <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [:] } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-string"><span class="hljs-string">"Authorization"</span></span>: <span class="hljs-string"><span class="hljs-string">"Bearer \(apiToken)"</span></span>] }</code> </pre><br><h4> æœ‰é€‰æ‹©åœ°å‘è¯·æ±‚æ·»åŠ ä¸€äº›httpæ ‡å¤´ </h4><br> è¿™å¯ä»¥åœ¨åˆ›å»ºAPIRequestæ—¶å®Œæˆï¼Œä¾‹å¦‚ï¼š <br><br><pre> <code class="hljs powershell">APIRequest(<span class="hljs-string"><span class="hljs-string">"some/endpoint"</span></span>).headers([<span class="hljs-string"><span class="hljs-string">"someKey"</span></span>: <span class="hljs-string"><span class="hljs-string">"someValue"</span></span>])</code> </pre> <br><h4> å¤„ç†æœªæˆæƒçš„è¯·æ±‚ </h4><br> æ‚¨å¯ä»¥å…¨å±€å¤„ç†å®ƒä»¬ï¼Œä¾‹å¦‚åœ¨<i>AppDelegateä¸­</i> <br><br><pre> <code class="hljs objectivec">CodyFire.shared.unauthorizedHandler = { <span class="hljs-comment"><span class="hljs-comment">//   WelcomeScreen }</span></span></code> </pre><br> æˆ–åœ¨æ¯ä¸ªè¯·æ±‚ä¸­æœ¬åœ° <br><br><pre> <code class="hljs objectivec">API.post.create(request).onNotAuthorized { <span class="hljs-comment"><span class="hljs-comment">//   }</span></span></code> </pre><br><h4> å¦‚æœç½‘ç»œä¸å¯ç”¨ </h4><br><pre> <code class="hljs objectivec">API.post.create(request). onNetworkUnavailable { <span class="hljs-comment"><span class="hljs-comment">//   ,  ,     }</span></span></code> </pre> å¦åˆ™åœ¨<i>onErrorä¸­ï¼Œ</i>æ‚¨å°†æ”¶åˆ°é”™è¯¯<i>._notConnectedToInternet</i> <br><br><h4> åœ¨è¯·æ±‚å¼€å§‹ä¹‹å‰å…ˆå¼€å§‹ </h4><br> æ‚¨å¯ä»¥è®¾ç½®<i>.onRequestStarted</i>å¹¶å¼€å§‹æ˜¾ç¤ºä¾‹å¦‚åŠ è½½ç¨‹åºã€‚ <br> è¿™æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„åœ°æ–¹ï¼Œå› ä¸ºåœ¨æ²¡æœ‰Internetçš„æƒ…å†µä¸‹ä¸ä¼šè°ƒç”¨å®ƒï¼Œä¾‹å¦‚ï¼Œæ‚¨ä¸å¿…å¾’åŠ³åœ°æ˜¾ç¤ºè£…è½½ç¨‹åºã€‚ <br><br><h4> å¦‚ä½•å…¨å±€ç¦ç”¨/å¯ç”¨æ—¥å¿—è¾“å‡º </h4><br><pre> <code class="hljs vhdl">CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.logLevel = .debug CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.logLevel = .<span class="hljs-literal"><span class="hljs-literal">error</span></span> CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.logLevel = .info CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.logLevel = .off</code> </pre><br><h4> å¦‚ä½•ç¦ç”¨å•ä¸ªè¯·æ±‚çš„æ—¥å¿—è¾“å‡º </h4><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.avoidLogError</span></span>()</code> </pre> <br><h4> ä»¥è‡ªå·±çš„æ–¹å¼å¤„ç†æ—¥å¿— </h4><br><pre> <code class="hljs pgsql">CodyFire.shared.logHandler = { <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-type"><span class="hljs-type">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> print("  CodyFire: " + <span class="hljs-type"><span class="hljs-type">text</span></span>) }</code> </pre><br><h4> å¦‚ä½•è®¾ç½®æœåŠ¡å™¨çš„é¢„æœŸhttpå“åº”ä»£ç  </h4><br> å°±åƒæˆ‘ä¸Šé¢è¯´çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒCodyFireå¸Œæœ›æ”¶åˆ°<i>200 OKï¼Œ</i>å¦‚æœå¯ä»¥ï¼Œå®ƒå°†å¼€å§‹è§£ææ•°æ®å¹¶è°ƒç”¨<i>onSuccess</i> ã€‚ <br><br> ä½†æ˜¯å¯ä»¥ä»¥æ–¹ä¾¿çš„æšä¸¾å½¢å¼è®¾ç½®æœŸæœ›çš„ä»£ç ï¼Œä¾‹å¦‚ï¼Œå¯¹äº<i>201 CREATED</i> <br><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.desiredStatusCode</span></span>(<span class="hljs-selector-class"><span class="hljs-selector-class">.created</span></span>)</code> </pre><br> æˆ–è€…ç”šè‡³å¯ä»¥è®¾ç½®è‡ªå®šä¹‰é¢„æœŸä»£ç  <br><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.desiredStatusCode</span></span>(<span class="hljs-selector-class"><span class="hljs-selector-class">.custom</span></span>(777))</code> </pre><br><h4> å–æ¶ˆè¦æ±‚ </h4><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.cancel</span></span>()</code> </pre><br> å¹¶ä¸”æ‚¨å¯ä»¥é€šè¿‡å£°æ˜<i>.onCancellation</i>å¤„ç†ç¨‹åºæ¥å‘ç°è¯·æ±‚å·²è¢«å–æ¶ˆ <br><br><pre> <code class="hljs objectivec">.onCancellation { <span class="hljs-comment"><span class="hljs-comment">//   }</span></span></code> </pre><br> å¦åˆ™ä¼š<i>å¼•å‘onError</i> <br><br><h4> è®¾ç½®è¯·æ±‚è¶…æ—¶ </h4><br><pre> <code class="hljs objectivec">.responseTimeout(<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   30 </span></span></code> </pre><br> å¤„ç†ç¨‹åºä¹Ÿå¯ä»¥æŒ‚åœ¨è¶…æ—¶äº‹ä»¶ä¸Š <br><br><pre> <code class="hljs objectivec">. onTimeout { <span class="hljs-comment"><span class="hljs-comment">//    }</span></span></code> </pre><br> å¦åˆ™ä¼š<i>å¼•å‘onError</i> <br><br><h4> è®¾ç½®äº¤äº’å¼é¢å¤–è¶…æ—¶ </h4><br> è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„åŠŸèƒ½ã€‚ ä¸€ä½æ¥è‡ªç¾å›½çš„é¡¾å®¢æ›¾ç»é—®è¿‡æˆ‘å…³äºå¥¹çš„äº‹ï¼Œå› ä¸º ä»–ä¸å¸Œæœ›ç™»å½•è¡¨å•çš„ç”Ÿæˆé€Ÿåº¦å¤ªå¿«ï¼Œä»–è®¤ä¸ºç™»å½•è¡¨å•çœ‹èµ·æ¥ä¸è‡ªç„¶ï¼Œå¥½åƒæ˜¯å‡çš„ï¼Œä¸æ˜¯æˆæƒã€‚ <br><br> è¿™ä¸ªæƒ³æ³•æ˜¯ä»–å¸Œæœ›ç”µå­é‚®ä»¶/å¯†ç æ£€æŸ¥æŒç»­2ç§’æˆ–æ›´é•¿æ—¶é—´ã€‚ å¦‚æœä»…æŒç»­0.5ç§’ï¼Œåˆ™éœ€è¦å†æ‰”1.5ç§’ï¼Œç„¶åå†è°ƒç”¨<i>onSuccess</i> ã€‚ å¦‚æœæ°å¥½éœ€è¦2æˆ–2.5ç§’ï¼Œè¯·ç«‹å³è°ƒç”¨<i>onSuccess</i> ã€‚ <br><br><pre> <code class="hljs objectivec">.additionalTimeout(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-comment"><span class="hljs-comment">// 2    </span></span></code> </pre><br><h4> è‡ªå®šä¹‰<i>æ—¥æœŸ</i>ç¼–ç å™¨/è§£ç å™¨ </h4><br>  CodyFireæœ‰å…¶è‡ªå·±çš„<i>DateCodingStrategy</i>æšä¸¾ï¼Œå…¶ä¸­æœ‰ä¸‰ä¸ªå€¼ <br><br>  -ç§’è‡ª1970å¹´ä»¥æ¥ <br> è‡ª1970å¹´ä»¥æ¥ <br>  -æ ¼å¼åŒ–ï¼ˆ_ customDateFormatterï¼šDateFormatterï¼‰ <br><br> å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼åˆ†åˆ«è®¾ç½®<i>DateCodingStrategy</i> ï¼Œä»¥è¿›è¡Œè§£ç å’Œç¼–ç  <br>  -åœ¨<i>AppDelegateä¸­</i>å…¨å±€ <br><br><pre> <code class="hljs vhdl">CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.dateEncodingStrategy = .secondsSince1970 let customDateFormatter = DateFormatter() CodyFire.<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>.dateDecodingStrategy = .formatted(customDateFormatter)</code> </pre><br>  -ä¸€ä¸ªè¯·æ±‚ <br><br><pre> <code class="hljs objectivec">APIRequest(<span class="hljs-string"><span class="hljs-string">"some/endpoint"</span></span>) .dateDecodingStrategy(.millisecondsSince1970) .dateEncodingStrategy(.secondsSince1970)</code> </pre><br>  -ç”šè‡³å¯¹äºæ¯ä¸ªæ¨¡å‹éƒ½æ˜¯å•ç‹¬çš„ï¼Œæ‚¨åªéœ€è¦æ¨¡å‹åŒ¹é…<i>CustomDateEncodingStrategy</i>å’Œ/æˆ–<i>CustomDateDecodingStrategyå³å¯</i> ã€‚ <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomePayload</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JSONPayload</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomDateEncodingStrategy</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomDateDecodingStrategy</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dateEncodingStrategy: <span class="hljs-type"><span class="hljs-type">DateCodingStrategy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dateDecodingStrategy: <span class="hljs-type"><span class="hljs-type">DateCodingStrategy</span></span> }</code> </pre><br><h2> å¦‚ä½•æ·»åŠ åˆ°é¡¹ç›® </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯¥åº“å¯æ ¹æ®MITè®¸å¯åœ¨GitHubä¸Šä½¿ç”¨ã€‚</a> <br><br> ç›®å‰åªèƒ½é€šè¿‡CocoaPodså®‰è£… <br><pre> <code class="ruby hljs">pod <span class="hljs-string"><span class="hljs-string">'CodyFire'</span></span></code> </pre> <br><br> æˆ‘çœŸçš„å¸Œæœ›CodyFireå¯¹å…¶ä»–iOSå¼€å‘äººå‘˜æœ‰ç”¨ï¼Œå®ƒå°†ç®€åŒ–ä»–ä»¬çš„å¼€å‘ï¼Œæ€»çš„æ¥è¯´ä¼šä½¿ä¸–ç•Œå˜å¾—æ›´å¥½ä¸€ç‚¹ï¼Œäººä»¬ä¹Ÿæ›´åŠ å‹å–„ã€‚ <br><br> å°±è¿™æ ·ï¼Œè°¢è°¢æ‚¨çš„å®è´µæ—¶é—´ã€‚ <br><br>  <b>UPDï¼šæ·»åŠ äº†ReactiveCocoaå’ŒRxSwiftæ”¯æŒ</b> <br><pre> <code class="ruby hljs">pod <span class="hljs-string"><span class="hljs-string">'ReactiveCodyFire'</span></span> <span class="hljs-comment"><span class="hljs-comment"># ReactiveCocoa pod 'RxCodyFire' # RxSwift #      'CodyFire',    </span></span></code> </pre><br> ç”¨äºReactiveCocaçš„<u>APIRequest</u>å°†å…·æœ‰<i>.signalProducer</i>å’Œç”¨äºRxSwiftçš„<i>.observable</i> <br><br>  <b>UPD2ï¼šç°åœ¨æ‚¨å¯ä»¥è¿è¡Œå¤šä¸ªè¯·æ±‚</b> <br> å¦‚æœè·å–æ¯ä¸ªæŸ¥è¯¢çš„ç»“æœå¯¹æ‚¨æ¥è¯´å¾ˆé‡è¦ï¼Œè¯·ä½¿ç”¨<i>.andï¼ˆï¼‰</i> <br> åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œæ‚¨æœ€å¤šå¯ä»¥è¿è¡Œ10ä¸ªè¯·æ±‚ï¼Œå®ƒä»¬å°†ä¸¥æ ¼æ‰§è¡Œã€‚ <br><pre> <code class="hljs pgsql">API.employee.<span class="hljs-keyword"><span class="hljs-keyword">all</span></span>() .<span class="hljs-keyword"><span class="hljs-keyword">and</span></span>(API.office.<span class="hljs-keyword"><span class="hljs-keyword">all</span></span>()) .<span class="hljs-keyword"><span class="hljs-keyword">and</span></span>(API.car.<span class="hljs-keyword"><span class="hljs-keyword">all</span></span>()) .<span class="hljs-keyword"><span class="hljs-keyword">and</span></span>(API.event.<span class="hljs-keyword"><span class="hljs-keyword">all</span></span>()) .<span class="hljs-keyword"><span class="hljs-keyword">and</span></span>(API.post.<span class="hljs-keyword"><span class="hljs-keyword">all</span></span>()) .onError { error <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> print(error.description) }.onSuccess { employees, offices, cars, events, posts <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> //    !!! }</code> </pre><br> ä¹Ÿå¯ä»¥ä½¿ç”¨<i>onRequestStartedï¼ŒonNetworkUnavailableï¼ŒonCancellationï¼ŒonNotAuthorizedï¼ŒonTimeout</i> ã€‚ <br>  <i>onProgress-</i>ä»åœ¨å¼€å‘ä¸­ <br><br> å¦‚æœæ‚¨ä¸å…³å¿ƒæŸ¥è¯¢ç»“æœï¼Œåˆ™å¯ä»¥ä½¿ç”¨<i>.flattenï¼ˆï¼‰</i> <br><pre> <code class="hljs powershell">[<span class="hljs-type"><span class="hljs-type">API.employee.all</span></span>(), <span class="hljs-type"><span class="hljs-type">API.office.all</span></span>(), <span class="hljs-type"><span class="hljs-type">API.car.all</span></span>()].flatten().onError { print(error.description) }.onSuccess { print(<span class="hljs-string"><span class="hljs-string">"flatten finished!"</span></span>) }</code> </pre> è¦åŒæ—¶è¿è¡Œå®ƒä»¬ï¼Œåªéœ€æ·»åŠ <i>.concurrentï¼ˆbyï¼š3ï¼‰ï¼Œ</i>è¿™å°†å…è®¸åŒæ—¶æ‰§è¡Œä¸‰ä¸ªè¯·æ±‚ï¼Œå¯ä»¥æŒ‡å®šä»»æ„æ•°é‡ã€‚ <br> è¦è·³è¿‡å¤±è´¥çš„æŸ¥è¯¢é”™è¯¯ï¼Œè¯·æ·»åŠ <i>.avoidCancelOnErrorï¼ˆï¼‰</i> <br> è¦è·å¾—è¿›åº¦ï¼Œè¯·æ·»åŠ <i>.onProgress</i> <br><br>  <b>UPD3ï¼šç°åœ¨æ‚¨å¯ä»¥ä¸ºæ¯ä¸ªè¯·æ±‚è®¾ç½®å•ç‹¬çš„æœåŠ¡å™¨</b> <br> æœ‰å¿…è¦åœ¨æŸä¸ªåœ°æ–¹åˆ›å»ºå¿…è¦çš„æœåŠ¡å™¨åœ°å€ï¼Œä¾‹å¦‚è¿™æ · <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> server1 = ServerURL(<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>: <span class="hljs-string"><span class="hljs-string">"https://server1.com"</span></span>, path: <span class="hljs-string"><span class="hljs-string">"v1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> server2 = ServerURL(<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>: <span class="hljs-string"><span class="hljs-string">"https://server2.com"</span></span>, path: <span class="hljs-string"><span class="hljs-string">"v1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> server3 = ServerURL(<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>: <span class="hljs-string"><span class="hljs-string">"https://server3.com"</span></span>)</code> </pre> ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨æŒ‡å®šç«¯ç‚¹ä¹‹å‰ç›´æ¥åœ¨è¯·æ±‚çš„åˆå§‹åŒ–ä¸­ä½¿ç”¨å®ƒä»¬ <br><pre> <code class="hljs lisp">APIRequest(<span class="hljs-name"><span class="hljs-name">server1</span></span>, <span class="hljs-string"><span class="hljs-string">"endpoint"</span></span>, payload: payloadObject) APIRequest(<span class="hljs-name"><span class="hljs-name">server2</span></span>, <span class="hljs-string"><span class="hljs-string">"endpoint"</span></span>, payload: payloadObject) APIRequest(<span class="hljs-name"><span class="hljs-name">server3</span></span>, <span class="hljs-string"><span class="hljs-string">"endpoint"</span></span>, payload: payloadObject)</code> </pre> æˆ–è€…æ‚¨å¯ä»¥åœ¨åˆå§‹åŒ–è¯·æ±‚åæŒ‡å®šæœåŠ¡å™¨ <br><pre> <code class="hljs objectivec">APIRequest(<span class="hljs-string"><span class="hljs-string">"endpoint"</span></span>, payload: payloadObject).serverURL(server1)</code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN427937/">https://habr.com/ru/post/zh-CN427937/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN427927/index.html">B-æ®‹é…·ã€‚ å·´ä»€ç§‘å°”æ‰˜æ–¯å¦å…±å’Œå›½ä¹’ä¹“çƒè”åˆä¼šï¼ˆFTN RBï¼‰çš„å®˜æ–¹ç½‘ç«™</a></li>
<li><a href="../zh-CN427929/index.html">åŠ³åŠ¨éƒ¨ï¼šæµ‹è¯•ä»»åŠ¡æ˜¯ä¸€ç§é›‡ä½£å…³ç³»</a></li>
<li><a href="../zh-CN427931/index.html">äº’è”ç½‘ä¿¡æ¯æ¶æ„ç¬¬4éƒ¨åˆ†</a></li>
<li><a href="../zh-CN427933/index.html">Steamå¼€å‘äººå‘˜æ„è§ï¼šé˜€é—¨çš„æœ€å¤§æ”¶ç›Šå’Œä½è´£ä»»</a></li>
<li><a href="../zh-CN427935/index.html">åœ¨2018å¹´åº•é‡æ–°å®‰è£…é¢„å®‰è£…çš„Windows 8</a></li>
<li><a href="../zh-CN427939/index.html">å¤„ç†FHRPéå¯¹ç§°è·¯ç”±</a></li>
<li><a href="../zh-CN427941/index.html">ä½¿ç”¨Kubeadmå’ŒKeepalivedåœ¨Baremetalä¸Šéƒ¨ç½²Kubernetes HAé›†ç¾¤ï¼ˆç®€å•æŒ‡å—ï¼‰</a></li>
<li><a href="../zh-CN427943/index.html">æˆ‘ä»¬æ­£åœ¨ç­‰å¾…2019å¹´6æœˆçš„ä¸²è¡Œ8K OLED LGç”µè§†ï¼Œå‘å¸ƒå¯èƒ½ä¼šå»¶è¿Ÿ</a></li>
<li><a href="../zh-CN427945/index.html">è™šæ‹Ÿæœºç®¡ç†ç¨‹åº</a></li>
<li><a href="../zh-CN427947/index.html">ç¥ç»ç½‘ç»œä¸äº†è§£ä»€ä¹ˆæ˜¯å…‰å­¦é”™è§‰ã€‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>