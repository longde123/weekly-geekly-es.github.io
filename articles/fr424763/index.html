<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèΩ üàµ üé∏ Un √©diteur de texte n'est pas votre plus haute math√©matique, vous devez penser ici üë©üèª‚Äçüé® üì™ ü§≤üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les √©diteurs de texte modernes peuvent non seulement √©mettre un bip et ne pas quitter le programme. Il s'av√®re qu'un m√©tabolisme tr√®s complexe bout en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un √©diteur de texte n'est pas votre plus haute math√©matique, vous devez penser ici</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/424763/"> Les √©diteurs de texte modernes peuvent non seulement √©mettre un bip et ne pas quitter le programme.  Il s'av√®re qu'un m√©tabolisme tr√®s complexe bout en eux.  Vous voulez savoir quelles astuces sont effectu√©es pour recalculer rapidement les coordonn√©es, comment les styles, les plis et les enveloppements logiciels sont attach√©s au texte et comment tout est mis √† jour, qu'est-ce que la structure de donn√©es fonctionnelles et la file d'attente prioritaire ont √† voir avec cela, ainsi que comment tromper l'utilisateur - bienvenue au chat! <br><br><img src="https://habrastorage.org/webt/sr/i0/vg/sri0vg3jog_-mc16jc5zz-wjxw0.jpeg"><br><br>  L'article est bas√© sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport d'</a> Alexei Kudryavtsev avec Joker 2017. Alexei √©crit Intellij IDEA dans JetBrains depuis environ 10 ans.  Sous la coupe, vous trouverez la vid√©o et la transcription textuelle du rapport. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YzWr9CN6cGQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h1>  Structures de donn√©es √† l'int√©rieur des √©diteurs de texte </h1><br>  Pour comprendre comment l'√©diteur fonctionne, √©crivons-le. <br><br><img src="https://habrastorage.org/webt/q9/nb/-n/q9nb-nr675yuu19v6loydkq3nrm.png"><br><br>  Voil√†, notre √©diteur le plus simple est pr√™t. <br><br>  √Ä l'int√©rieur de l'√©diteur, le texte est plus facile √† stocker dans un tableau de caract√®res ou, ce qui est le m√™me (en termes d'organisation de la m√©moire), dans la classe Java StringBuffer.  Pour obtenir du caract√®re par d√©calage, nous appelons la m√©thode StringBuffer.charAt (i).  Et pour y ins√©rer le caract√®re que nous avons tap√© sur le clavier, nous appelons la m√©thode StringBuffer.insert (), qui ins√®re le caract√®re quelque part au milieu. <br><br>  Ce qui est le plus int√©ressant, malgr√© toute la simplicit√© et l'idiotie de cet √©diteur, c'est la meilleure id√©e que l'on puisse inventer.  C'est √† la fois simple et presque toujours rapide. <br><br>  Malheureusement, un probl√®me d'√©chelle se pose avec cet √©diteur.  Imaginez que nous y imprimions beaucoup de texte et que nous allons ins√©rer une autre lettre au milieu.  Les √©v√©nements suivants se produiront.  Nous devons de toute urgence lib√©rer de l'espace pour cette lettre en d√©pla√ßant toutes les autres lettres d'un caract√®re vers l'avant.  Pour ce faire, nous d√©calons cette lettre d'une position, puis de la suivante et ainsi de suite, jusqu'√† la fin du texte. <br><br>  Voici √† quoi cela ressemblerait en m√©moire: <br><br><img src="https://habrastorage.org/webt/ec/uk/r4/ecukr4oxdmj0tlxojojwuf9k8i4.gif"><br><br>  D√©caler tous ces m√©gaoctets n'est pas tr√®s bon: c'est lent.  Bien s√ªr, pour un ordinateur moderne, c'est une affaire insignifiante - une sorte de m√©gaoctets path√©tiques pour se d√©placer d'avant en arri√®re.  Mais pour un changement de texte tr√®s actif, cela peut √™tre perceptible. <br><br>  Pour r√©soudre ce probl√®me d'insertion d'un personnage au milieu, il y a longtemps est venu une solution de contournement appel√©e "Gap Buffer". <br><br><h3>  Tampon d'espace </h3><br>  L'√©cart est l'√©cart.  Le tampon est, comme vous pouvez l'imaginer, un tampon.  La structure de donn√©es Gap Buffer est un tel tampon vide que nous gardons au milieu de notre texte, juste au cas o√π.  Si nous avions besoin d'imprimer quelque chose, nous utilisons ce petit tampon de texte pour une saisie rapide. <br><br><img src="https://habrastorage.org/webt/vc/ca/v4/vccav4jbt0zboaf_fuo985dzerc.png"><br><br>  La structure des donn√©es a un peu chang√© - le tableau est rest√© en place, mais deux pointeurs sont apparus: au d√©but du tampon et √† sa fin.  Pour prendre un caract√®re de l'√©diteur √† un certain d√©calage, nous devons comprendre s'il se trouve avant ou apr√®s ce tampon et corriger l√©g√®rement le d√©calage.  Et pour ins√©rer un personnage, nous devons d'abord d√©placer le Gap Buffer √† cet endroit et le remplir avec ces caract√®res.  Et, bien s√ªr, si nous allons au-del√† de notre tampon, recr√©ez-le d'une mani√®re ou d'une autre.  Voici √† quoi cela ressemble dans l'image. <br><br><img src="https://habrastorage.org/webt/bu/4a/gs/bu4ags_jk9vobq_9rxegbww01nw.gif"><br><br>  Comme vous pouvez le voir, nous nous d√©pla√ßons d'abord pendant longtemps sur un petit tampon d'espace (rectangle bleu) vers l'emplacement d'√©dition (en √©changeant simplement les caract√®res √† partir de ses bords gauche et droit √† leur tour).  Ensuite, nous utilisons ce tampon, en tapant des caract√®res l√†-bas. <br><br>  Comme vous pouvez le constater, il n'y a pas de mouvement de m√©gaoctets de caract√®res, l'insert est tr√®s rapide, pendant un temps constant, et il semble que tout le monde soit content.  Tout semble aller bien, mais si notre processeur est tr√®s lent, un temps assez important est perdu pour d√©placer le tampon d'√©cart et le texte d'avant en arri√®re.  Cela √©tait particuli√®rement visible lors de tr√®s petits m√©gahertz. <br><br><h3>  Table des pi√®ces </h3><br>  Juste √† ce moment-l√†, une soci√©t√© appel√©e Microsoft a √©crit un √©diteur de texte Word.  Ils ont d√©cid√© d'appliquer une autre id√©e pour acc√©l√©rer l'√©dition appel√©e ¬´Tableau de pi√®ces¬ª, c'est-√†-dire ¬´Tableau de pi√®ces¬ª.  Et ils ont propos√© de sauvegarder le texte de l'√©diteur dans le m√™me tableau de caract√®res le plus simple, qui ne changera pas, et de mettre toutes ses modifications dans un tableau s√©par√© de ces pi√®ces tr√®s modifi√©es. <br><br><img src="https://habrastorage.org/webt/gf/gt/gu/gfgtgutww7ymm-bx-4v7tytyjt4.png"><br><br>  Ainsi, si nous avons besoin de trouver un caract√®re par d√©calage, nous devons trouver cette pi√®ce que nous avons √©dit√©e et en extraire ce personnage, et s'il n'est pas l√†, alors aller au texte d'origine.  L'insertion d'un symbole devient plus facile, il suffit de cr√©er et d'ajouter cette nouvelle pi√®ce au tableau.  Voici √† quoi cela ressemble dans l'image: <br><br><img src="https://habrastorage.org/webt/94/8w/3u/948w3uylg_cuxh8mywws-owxs_i.gif"><br><br>  Ici, nous voulions supprimer l'espace au d√©calage 5. Pour ce faire, nous ajoutons deux nouveaux morceaux √† la table des tranches: l'un indique le premier fragment ("Bummer"), et le second indique le fragment apr√®s modification ("mouton").  Il s'av√®re que l'√©cart entre eux dispara√Æt, ces deux pi√®ces sont coll√©es ensemble, et nous obtenons d√©j√† un nouveau texte sans espace: ¬´Oblomovtsy¬ª.  Ensuite, nous ajoutons le nouveau texte ("souffrant d'oblomovisme") √† la fin.  Utilisez un tampon suppl√©mentaire et ajoutez une nouvelle tranche √† la table des pi√®ces qui pointe vers ce texte le plus r√©cent ajout√©. <br><br>  Comme vous pouvez le voir, il n'y a pas de mouvement de va-et-vient, tout le texte reste en place.  La mauvaise nouvelle est qu'il devient de plus en plus difficile d'acc√©der au symbole, car trier toutes ces pi√®ces est assez difficile. <br><br>  Pour r√©sumer. <br><br>  Ce qui est bien avec <b>Piece Table</b> : <br><br><ul><li>  Int√©grez rapidement; </li><li>  Annulation facile; </li><li>  Ajouter uniquement. </li></ul><br>  Ce qui est mauvais: <br><br><ul><li>  Il est terriblement difficile d'acc√©der √† un document; </li><li>  C'est terriblement difficile √† mettre en ≈ìuvre. </li></ul><br>  Voyons qui nous utilisons habituellement quoi. <br><br>  NetBeans, Eclipse et Emacs utilisent Gap Buffer - bravo!  Vi ne d√©range pas et utilise juste une liste de lignes.  Word utilise la table des pi√®ces (ils ont r√©cemment pr√©sent√© leurs anciennes sortes et l√† vous pouvez m√™me comprendre quelque chose). <br><br>  Atom est plus int√©ressant.  Jusqu'√† r√©cemment, ils ne se g√™naient pas et utilisaient une liste de lignes JavaScript.  Et puis ils ont d√©cid√© de tout r√©√©crire en C ++ et ont accumul√© une structure assez compliqu√©e, qui semble √™tre similaire √† la table des morceaux.  Mais ces pi√®ces ne sont pas stock√©es dans la liste, mais dans l'arborescence et dans ce que l'on appelle l'arborescence splay - il s'agit d'une arborescence qui s'auto-ajuste lorsqu'elle est ins√©r√©e dans celle-ci, afin que les insertions r√©centes soient plus rapides.  Ils ont fait une chose tr√®s compliqu√©e. <br><br>  Qu'est-ce qu'Intellij IDEA utilise? <br>  Non, pas de tampon d'√©cart.  Non, vous vous trompez aussi, pas une table √† pi√®ces. <br>  Oui, tout √† fait, votre propre v√©lo. <br><br>  Le fait est que les exigences de l'EDI pour le stockage de texte sont l√©g√®rement diff√©rentes de celles d'un √©diteur de texte standard.  L'IDE a besoin de support pour diverses choses d√©licates comme la comp√©titivit√©, c'est-√†-dire l'acc√®s parall√®le au texte depuis l'√©diteur.  Par exemple, afin que de nombreux produits de boulangerie diff√©rents puissent le lire et faire quelque chose.  (L'inspection est un petit morceau de code qui analyse le programme d'une mani√®re ou d'une autre - par exemple, √† la recherche d'endroits qui l√®vent une exception NullPointerException).  IDE a √©galement besoin d'un support de version texte modifiable.  Plusieurs versions sont simultan√©ment en m√©moire pendant que vous travaillez avec un document afin que ces longs processus continuent d'analyser l'ancienne version. <br><br><h1>  Les probl√®mes </h1><br><h3>  Comp√©titivit√© / versioning </h3><br>  Afin de maintenir le parall√©lisme, les op√©rations de texte sont g√©n√©ralement envelopp√©es de ¬´synchronis√©¬ª ou de verrous de lecture / √©criture.  Malheureusement, cela n'√©volue pas tr√®s bien.  Une autre approche est le texte immuable, c'est-√†-dire un r√©f√©rentiel de texte immuable. <br><br><img src="https://habrastorage.org/webt/ov/ia/sa/oviasaeniuwmhiaebpsic_mxm88.png"><br><br>  Voici √† quoi ressemble un √©diteur avec un document immuable comme structure de donn√©es de support. <br><br>  Comment fonctionne la structure des donn√©es? <br><br>  Au lieu d'un tableau de caract√®res, nous aurons un nouvel objet de type ImmutableText, qui stocke du texte sous la forme d'un arbre, o√π de petites sous-cha√Ænes sont stock√©es dans les feuilles.  En acc√©dant √† un certain d√©calage, il essaie d'atteindre la toute derni√®re feuille de cet arbre, et on lui demandera d√©j√† le symbole auquel nous faisions r√©f√©rence.  Et lorsque vous ins√©rez du texte, il cr√©e un nouvel arbre et l'enregistre √† l'ancien emplacement. <br><br><img src="https://habrastorage.org/webt/_2/xx/rh/_2xxrh9kohjwodn3ub-gyt2z8la.gif"><br><br>  Par exemple, nous avons un document avec le texte ¬´sans calories¬ª.  Il est impl√©ment√© comme un arbre avec deux feuilles de substitutions "D√©mon" et "hypercalorique".  Lorsque nous voulons ins√©rer la ligne ¬´jolie¬ª au milieu, une nouvelle version de notre document est cr√©√©e.  Et pr√©cis√©ment, une nouvelle racine est cr√©√©e, √† laquelle trois feuilles sont d√©j√† attach√©es: ¬´D√©mon¬ª, ¬´assez¬ª et ¬´hypercalorique¬ª.  De plus, deux de ces nouvelles fiches peuvent faire r√©f√©rence √† la premi√®re version de notre document.  Et pour la feuille dans laquelle nous avons ins√©r√© la ligne ¬´jolie¬ª, un nouveau sommet est allou√©.  Ici, la premi√®re version et la deuxi√®me version sont disponibles en m√™me temps et elles sont toutes immuables, immuables.  Tout a l'air bien. <br><br>  Qui utilise quelles structures d√©licates? <br><br><img src="https://habrastorage.org/webt/yf/mt/eh/yfmtehxbzlale_95bblpk2msh2k.jpeg"><br><br>  Par exemple, dans GNOME, certains de leurs widgets standard utilisent une structure appel√©e Rope.  Xi-Editor, le nouvel √©diteur brillant de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Raf Levien</a> , utilise Persistent Rope.  Et Intellij IDEA utilise cet arbre immuable.  Derri√®re tous ces noms, en fait, se trouve plus ou moins la m√™me structure de donn√©es avec une repr√©sentation arborescente du texte.  Sauf que GtkTextBuffer utilise Mutable Rope, c'est-√†-dire un arbre avec des sommets mutables, et Intellij IDEA et Xi-Editor - Immutable. <br><br>  La prochaine chose √† consid√©rer lors du d√©veloppement d'un r√©f√©rentiel de caract√®res dans les IDE modernes est appel√©e multicats.  Cette fonction vous permet d'imprimer √† plusieurs endroits √† la fois, en utilisant plusieurs chariots. <br><br><img src="https://habrastorage.org/webt/qb/ak/9t/qbak9tqjnu7v_iiciaouw-qqeug.gif"><br><br>  Nous pouvons imprimer quelque chose et en m√™me temps, √† plusieurs endroits du document, nous ins√©rons ce que nous y avons imprim√©.  Si nous regardons comment nos structures de donn√©es, que nous avons examin√©es, r√©agissent aux multicarets, nous verrons quelque chose d'int√©ressant. <br><br><img src="https://habrastorage.org/webt/ty/4p/8k/ty4p8kuqs1rgeanxr9y3n9i8wz4.jpeg"><br><br>  Si nous ins√©rons un caract√®re dans notre tout premier √©diteur primitif, il faudra naturellement un temps lin√©aire pour d√©placer un groupe de caract√®res dans les deux sens.  Ceci est √©crit comme O (N).  Pour l'√©diteur bas√© sur Gap Buffer, √† son tour, un temps constant est n√©cessaire, pour lequel il a √©t√© invent√©. <br><br>  Pour un arbre immuable, le temps d√©pend logarithmiquement de la taille, car vous devez d'abord aller du haut de l'arbre √† sa feuille - c'est le logarithme, puis pour tous les sommets sur le chemin pour cr√©er de nouveaux sommets pour le nouvel arbre - c'est encore le logarithme.  Le tableau des pi√®ces n√©cessite √©galement une constante. <br>  Mais tout change un peu si nous essayons de mesurer le temps d'insertion d'un personnage dans un √©diteur √† plusieurs chariots, c'est-√†-dire l'insertion simultan√©e √† plusieurs endroits.  √Ä premi√®re vue, le temps semble augmenter proportionnellement d'un facteur C - le nombre d'endroits o√π le symbole est ins√©r√©.  C'est exactement ce qui se passe, √† l'exception de Gap Buffer.  Dans son cas, le temps, au lieu de C fois, augmente de fa√ßon inattendue des temps C * L incompr√©hensibles, o√π L est la distance moyenne entre les chariots.  Pourquoi cela se produit-il? <br><br>  Imaginez que nous devons ins√©rer la ligne ¬´, on¬ª √† deux endroits dans notre document. <br><br><img src="https://habrastorage.org/webt/ec/n3/jd/ecn3jdpnsvqscfbvjxivopbs5uq.gif"><br><br>  C'est ce qui se passe dans l'√©diteur en ce moment. <br><br><ul><li>  Cr√©ez un tampon d'espace dans l'√©diteur (un petit rectangle bleu dans l'image); </li><li>  Nous commen√ßons deux voitures (lignes verticales noires en gras); </li><li>  Nous essayons d'imprimer; </li><li>  Ins√©rez une virgule dans notre tampon d'espace; </li><li>  Vous devez maintenant l'ins√©rer √† la place du deuxi√®me chariot; </li><li>  Pour ce faire, nous devons d√©placer notre tampon d'espace √† la position du chariot suivant; </li><li>  Imprime une virgule √† la deuxi√®me place; </li><li>  Vous devez maintenant ins√©rer le caract√®re suivant √† la position du premier chariot; </li><li>  Et nous devons repousser notre Gap Buffer; </li><li>  Ins√©rez la lettre "n"; </li><li>  Et nous d√©pla√ßons notre tampon de longue souffrance √† la place de la deuxi√®me voiture; </li><li>  Nous y ins√©rons notre "n"; </li><li>  Reculez le tampon pour ins√©rer le caract√®re suivant. </li></ul><br>  Sentez-vous o√π tout va? <br><br>  Oui, il s'av√®re qu'en raison de ces nombreux mouvements de va-et-vient du tampon, notre temps total augmente.  Honn√™tement, ce n'est pas qu'il soit directement horrifi√© car il a augment√© - d√©placer des m√©gaoctets path√©tiques, des gigaoctets d'avant en arri√®re pour un ordinateur moderne n'est pas un probl√®me, mais il est int√©ressant de noter que cette structure de donn√©es fonctionne radicalement diff√©remment dans le cas des multicats. <br><br><h3>  Trop de lignes?  LineSet! </h3><br>  Quels sont les autres probl√®mes dans un √©diteur de texte classique?  Le probl√®me le plus difficile est le d√©filement, c'est-√†-dire le redessin de l'√©diteur tout en d√©pla√ßant le chariot sur la ligne suivante. <br><br><img src="https://habrastorage.org/webt/yt/0d/rn/yt0drnu1rsxyciwb4pruefmufyu.gif"><br><br>  Lorsque l'√©diteur d√©file, nous devons comprendre √† partir de quelle ligne, √† partir de quel symbole nous devons commencer √† dessiner le texte dans notre petite fen√™tre.  Pour ce faire, nous devons comprendre rapidement quelle ligne correspond √† quel d√©calage. <br><br><img src="https://habrastorage.org/webt/kn/ak/gm/knakgm1aq7-wnjwbruefxeyouh0.png"><br><br>  Il existe une interface √©vidente pour cela, lorsque nous devons comprendre son d√©calage dans le texte par num√©ro de ligne.  Et vice versa, par le d√©calage dans le texte pour comprendre dans quelle ligne il se trouve.  Comment cela peut-il se faire rapidement? <br><br>  Par exemple, comme ceci: <br><br>  Organisez ces lignes en un arbre et marquez chaque sommet de cet arbre en d√©calant le d√©but de la ligne et en d√©calant la fin de la ligne.  Et puis, afin de comprendre par le d√©calage dans quelle ligne il se trouve, il vous suffit d'ex√©cuter une recherche logarithmique dans cet arbre et de le trouver. <br><br><img src="https://habrastorage.org/webt/x1/jq/3w/x1jq3w1gwiytzsrdytznnltc_l0.png"><br><br>  Une autre fa√ßon est encore plus simple. <br><br>  √âcrivez dans le tableau le d√©calage du d√©but des lignes et de la fin des lignes.  Et puis, pour trouver le d√©calage du d√©but et de la fin par le num√©ro de ligne, vous devrez acc√©der √† l'index. <br><br><img src="https://habrastorage.org/webt/wq/ls/wy/wqlswyl-k5brg4fsbgoxaqxkj1u.png"><br><br>  Fait int√©ressant, dans le monde r√©el, les deux m√©thodes sont utilis√©es. <br><br><img src="https://habrastorage.org/webt/ii/w6/qu/iiw6quo2j0clh8xnovh0mfn5ow0.jpeg"><br><br>  Par exemple, Eclipse utilise une telle structure en bois qui, comme vous pouvez le voir, fonctionne dans un temps logarithmique pour la lecture et la mise √† jour.  Et IDEA utilise une structure de table, pour laquelle la lecture est une constante rapide, c'est une inversion d'index dans une table, mais la reconstruction est plut√¥t lente, car vous devez reconstruire la table enti√®re lorsque vous modifiez la longueur d'une ligne. <br><br><h3>  Encore trop de lignes?  Des plis! </h3><br>  Quoi d'autre est mauvais qui tombe sur les √©diteurs de texte?  Par exemple, des pliages.  Ce sont des morceaux de texte que vous pouvez ¬´r√©duire¬ª et montrer √† la place. <br><br><img src="https://habrastorage.org/webt/tp/g1/fc/tpg1fcoak4ahpzd1mbf9wex_jvi.png"><br><br>  Ces points sur un fond vert dans l'image cachent beaucoup de symboles derri√®re nous, mais si nous ne sommes pas int√©ress√©s √† les regarder (comme dans le cas, par exemple, des documents Java ou des listes d'importation les plus longs et ennuyeux), nous les masquons, les r√©duisons ellipses. <br><br>  Et l√† encore, vous devez comprendre quand elle se termine et quand la r√©gion que nous devons montrer commence, et comment la mettre √† jour rapidement?  Comment cela est organis√©, je le dirai un peu plus tard. <br><br><h3>  Trop longues lignes?  Enveloppement doux! </h3><br><img src="https://habrastorage.org/webt/yu/lb/hg/yulbhgos7wf3ilx0gqtxg2lrkpq.jpeg"><br><br>  De plus, les √©diteurs modernes ne peuvent pas vivre sans enveloppe souple.  L'image montre que le d√©veloppeur a ouvert le fichier JavaScript apr√®s la minimisation et l'a imm√©diatement regrett√©.  Cette √©norme ligne JavaScript, lorsque nous essayons de l'afficher dans l'√©diteur, ne rentrera dans aucun √©cran.  Par cons√©quent, un emballage doux le d√©chire de force en plusieurs lignes et le pousse dans l'√©cran. <br>  Comment c'est organis√© - plus tard. <br><br><h3>  Trop peu de beaut√© </h3><br><img src="https://habrastorage.org/webt/md/yh/d0/mdyhd06genl8kiaehxjectze9g4.jpeg"><br><br>  Et enfin, je veux aussi apporter de la beaut√© aux √©diteurs de texte.  Par exemple, mettez en surbrillance certains mots.  Dans l'image ci-dessus, les mots cl√©s sont mis en √©vidence en bleu gras, certaines m√©thodes statiques en italique, certaines annotations - √©galement dans une couleur diff√©rente. <br><br>  Alors, comment conservez-vous et traitez-vous encore les pliages, les emballages souples et les surlignages? <br>  Il s'av√®re que tout cela, en principe, est une seule et m√™me t√¢che. <br><br><h3>  Trop peu de beaut√©?  Surligneurs de gamme! </h3><br><img src="https://habrastorage.org/webt/jj/rl/t7/jjrlt7sisz9curcqa5lotpzjfya.jpeg"><br><br>  Pour prendre en charge toutes ces fonctionnalit√©s, tout ce que nous devons √™tre en mesure de faire est de coller certains attributs de texte √† un d√©calage donn√© dans le texte, par exemple, la couleur, la police ou le texte √† plier.  De plus, ces attributs de texte doivent √™tre mis √† jour tout le temps √† cet endroit afin qu'ils survivent √† toutes sortes d'insertions et de suppressions. <br><br>  Comment cela est-il g√©n√©ralement mis en ≈ìuvre?  Naturellement, sous la forme d'un arbre. <br><br><h3>  Probl√®me: trop de beaut√©?  Arbre d'intervalle! </h3><br><img src="https://habrastorage.org/webt/0e/ux/le/0euxleajuom5pdsa02kwxuudyny.jpeg"><br><br>  Par exemple, nous avons ici plusieurs reflets jaunes que nous voulons conserver dans le texte.  Nous ajoutons les intervalles de ces faits saillants dans un arbre de recherche, le soi-disant arbre d'intervalle.  Il s'agit du m√™me arbre de recherche, mais un peu plus d√©licat car nous devons stocker des intervalles plut√¥t que des nombres. <br><br>  Et comme il y a des intervalles sains et petits, comment les trier, les comparer les uns aux autres et les mettre dans un arbre est une t√¢che plut√¥t simple.  Bien que tr√®s connu en informatique.  Ensuite, regardez √† votre guise comment cela fonctionne.  Donc, nous prenons et mettons tous nos intervalles dans un arbre, puis chaque changement de texte quelque part au milieu conduit √† un changement logarithmique dans cet arbre.  Par exemple, l'insertion d'un caract√®re devrait entra√Æner la mise √† jour de tous les intervalles √† droite de ce caract√®re.  Pour ce faire, nous trouvons tous les sommets dominants de ce symbole et indiquons que tous leurs sommets doivent √™tre d√©plac√©s d'un symbole vers la droite. <br><br><h3>  Toujours envie de beaut√©?  Ligatures! </h3><br><img src="https://habrastorage.org/webt/iv/j-/tb/ivj-tb9_w2ata-tiwclrmqfjs_a.jpeg"><br><br>  Il y a encore une chose si terrible - les ligatures, que je voudrais √©galement soutenir.  Ce sont des beaut√©s diff√©rentes, comme le signe ¬´! =¬ª Est dessin√© sous la forme d'un grand glyphe ¬´pas √©gal¬ª et ainsi de suite.  Heureusement, nous comptons ici sur un m√©canisme de swing pour supporter ces ligatures.  Et, selon notre exp√©rience, il travaille apparemment de la mani√®re la plus simple.  √Ä l'int√©rieur de la police, une liste de toutes ces paires de caract√®res est stock√©e, qui, lorsqu'elles sont combin√©es ensemble, forment une sorte de ligature d√©licate.  Ensuite, lors du trac√© de la ligne, Swing it√®re simplement sur toutes ces paires, trouve celles n√©cessaires et les dessine en cons√©quence.  Si vous avez beaucoup de ligatures dans la police, alors, apparemment, son affichage ralentira proportionnellement. <br><br><h3>  Basculement des freins </h3><br>  Et le plus important - un autre probl√®me rencontr√© dans les √©diteurs complexes modernes est l'optimisation du basculement, c'est-√†-dire l'appui sur les touches et l'affichage du r√©sultat. <br><br><img src="https://habrastorage.org/webt/fq/yb/wi/fqybwipttxn9pvl3phzc5qts6_k.jpeg"><br><br>  Si vous entrez dans Intellij IDEA et voyez ce qui se passe lorsque vous appuyez sur un bouton, il se trouve que l'horreur suivante se produit: <br><br><ul><li>  En cliquant sur un bouton, nous devons voir si nous sommes dans la fen√™tre de compl√©tion pour fermer le menu de fin si, par exemple, nous tapons du "Enter". </li><li>  Vous devez voir si le fichier est sous un syst√®me de contr√¥le de version d√©licat, comme Perforce, qui doit prendre des mesures pour commencer la modification. </li><li>  V√©rifiez s'il y a une r√©gion sp√©ciale dans le document qui ne peut pas √™tre imprim√©e, comme certains textes g√©n√©r√©s automatiquement. </li><li>  Si le document est bloqu√© par une op√©ration qui n'est pas termin√©e, vous devez terminer la mise en forme et continuer ensuite. </li><li>  injected-,      ,       ,   -  . </li><li>     auto popup handler,    , ,       . </li><li>   info  ,     ,    .     selection remove,    selection  ,   .    selection ,    . </li><li>     typed handler,       ,      . </li><li>    . </li><li>  undo,  virtual space'   write action. </li><li> ,     . </li></ul><br>  Hourra! <br><br> , ,   .  ,    . ,    listener  ,   ,  - .  editor view.  -   listener'. <br><br>      ,   ,  -      DocumentListener? <br><br>  Editor.documentChanged()   : <br><br><ul><li>  error stripe; </li><li>  gutter size, ; </li><li>  editor component size,    ; </li><li>      ; </li><li>  soft wrap,    ; </li><li>  repaint(). </li></ul><br>  repaint() ‚Äî     Swing,        .   ,   Repaint     Swing. <br><br>   -       ,   repaint   ,    : <br><br><img src="https://habrastorage.org/webt/je/qh/cy/jeqhcytdxkun3ft_r7azwrby2eu.jpeg"><br><br>    paint-,   ,        . <br><br>  , ,   ? <br><br><img src="https://habrastorage.org/webt/sm/mo/xq/smmoxqrmfayyfodciwe75svwdzw.jpeg"><br><br>  ,  ,  .    Intellij IDEA   . <br><br><img src="https://habrastorage.org/webt/5u/x8/as/5ux8ashfsenwboudd_u07ubtjmk.jpeg"><br><br>    ,  -   - ,    ,         ,    .  !  ,    ,    ,   -  ‚Äî !      ,  -    .    .      ¬´Zero latency typing¬ª. <br><br><h1>   </h1><br>      ‚Äî    . <br><br>   ?       ,  ‚Äî  ,        Google Docs -    -  . <br><br>  : <br><br><ul><li>  ; </li><li>  . </li></ul><br>   ,        ,          . <br><br>  -          .    ,  ,     .   .   ‚Äî   , ¬´intention preservation¬ª.  ,   -  ,          ,     ,   .    ‚Äî .  ,            -       ,   . <br><br><h3> Operation transformation </h3><br><img src="https://habrastorage.org/webt/h9/e8/pq/h9e8pqu3ljnoh4y70_759peizn0.jpeg"><br><br>  ,       ,  ¬´operation transformation¬ª.   .    , - :     ,     .  Operation transformation       .   ,    ,   ,    - . ,        .    ,    -         .  ,      ,    . <br><br>       ,   ,    ,   .     ¬´TP2 puzzle¬ª. <br><br><img src="https://habrastorage.org/webt/c1/5i/cs/c15icsdnqbjqykloe_pfbxahz-e.jpeg"><br><br>       - ,    ,     .  ,    Operation transformation       ,  ,  ,     (¬´¬ª).       (¬´¬ª).   ,   .    ,         Operation transformation,  -       . <br><br>          ,  Google Docs, Google Wave  -   Etherpad.   Operation transformation    . <br><br><h3> Conflict-free replicated data type </h3><br>      : ¬´  ,  OT!¬ª     ,      ,  . ,  ,    ,              ,      100%         .   ¬´CRDT¬ª (Conflict-free replicated data type). <br><br><img src="https://habrastorage.org/webt/kn/82/9n/kn829n91st7gpykcp905spuy_ki.jpeg"><br><br>   ,    ,          . ,     , ,   .   ,       . -            (  ),  ()      (  ). <br><br><img src="https://habrastorage.org/webt/vs/9-/i7/vs9-i7bdfpjonh_z1cgie6qj4kk.jpeg"><br><br>           ? <br><br>  Oui ,     G-counter',   ,   .      ,       .        ¬´+1¬ª  ,  ¬´+1¬ª  , ,       ‚Äî   ¬´2¬ª.  ,          ,     .      G-counter,     ,       .       G-counter,    .    ,     ,       .       .    ‚Äî   . ,       CRDT. ,   . <br><br><h3> Conflict-free replicated inserts </h3><br><img src="https://habrastorage.org/webt/pz/bg/ta/pzbgta8bteajr0embilmbnpxifc.jpeg"><br><br> ,     ,      ,    . , ,        . <br><br>   ,     ,     -  - , ,  ,  ,        .   ,      ,     ,     ,     . , ,  ,     ,     2    ¬´¬ª,    ,    ¬´¬ª   ¬´¬ª   ¬´¬ª. <br><br><h3> Conflict-free replicated deletes </h3><br><img src="https://habrastorage.org/webt/jt/w1/fb/jtw1fbphe5mjcyhbye4ua-mjf7s.jpeg"><br><br>      .        ,    ,     ,  - .   ,       ,     .  ,       ,        ,    . <br>  ,      . <br><br><h3> Conflict-free replicated edits </h3><br> ,   , CRDT  - , ,  Xi-Editor,          Fuchsia.  ,     ,    . <br><br><h1>  Fermeture √©clair </h1><br>      ,          ¬´Zipper¬ª.  ,      ,      . ,  ,        .    , ( ¬´¬ª ,   ,     ¬´  ¬ª). ,      -     .      ,       - ,   .        Zipper. <br><br>           ,     .    . <br><br><img src="https://habrastorage.org/webt/ap/ne/p2/apnep2miklsburr5xhtqgcwbzri.gif"><br><br>  Zipper   ,      (¬´  ¬ª).     Zipper'       .    ‚Äî     .       (),   ,          . ,    Zipper,   -        ,   .  ,     ,   ,   ( ).      ,        ( ).   ,                .    ,        . <br><br>  ,        . <br><br>       ? -,   ,    ,    ,    .  ,       ,   .  -,    ,      .     .  Je vous remercie <br><br> ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> <br> ‚Üí <a href=""></a> <br><br><h1>  Les r√©f√©rences </h1><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zipper data structure</a> <br> <a href="">  CRDT in Xi Editor</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">       </a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   </a> <br><br>     ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Visual Studio Code editor  Piece Table</a> . <br>  ,   -   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . <br><br><blockquote> Vous voulez des rapports encore plus puissants, y compris Java 11?  Ensuite, nous vous attendons au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Joker 2018</a> .  Intervenants cette ann√©e: Josh Long, John McClean, Marcus Hirth, Robert Scholte et d'autres intervenants tout aussi cool.  Il reste 17 jours avant la conf√©rence.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Billets</a> sur le site. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424763/">https://habr.com/ru/post/fr424763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424751/index.html">Fonctionnement du syst√®me biom√©trique unifi√©</a></li>
<li><a href="../fr424753/index.html">Nouveaut√©s de YouTrack 2018.3</a></li>
<li><a href="../fr424755/index.html">L'argent aime le projet de loi: comment les voitures trient les factures</a></li>
<li><a href="../fr424757/index.html">Le condens√© des √©v√©nements pour les professionnels des RH dans le domaine des TI en octobre 2018</a></li>
<li><a href="../fr424761/index.html">Introduction au d√©marrage du noyau Linux et aux processus de d√©marrage</a></li>
<li><a href="../fr424765/index.html">Gestion des √©tats dans les applications Flutter</a></li>
<li><a href="../fr424767/index.html">Nous faisons un g√¢teau de Habr. Encore une fois</a></li>
<li><a href="../fr424771/index.html">Exp√©rience personnelle: d'une id√©e et d'une feuille blanche √† une version provisoire d'un site</a></li>
<li><a href="../fr424773/index.html">Biopharma et mod√©lisation num√©rique: exp√©rience et pratique d'Amgen</a></li>
<li><a href="../fr424777/index.html">Utilisation de Consul pour faire √©voluer les services avec √©tat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>