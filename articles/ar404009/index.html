<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦃 😨 ☔️ نحن نسيطر على المنزل من خلال Telegram 📻 👨🏼‍🏫 🧠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="حاليا ، أصبحت أنظمة التحكم في المنزل الذكي أكثر شعبية. توفر الواجهة المركزية التي تتحكم في الأجهزة في جميع أنحاء المنزل الوقت وتسمح لك بالتحكم في منزل...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>نحن نسيطر على المنزل من خلال Telegram</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404009/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  حاليا ، أصبحت أنظمة التحكم في المنزل الذكي أكثر شعبية.  توفر الواجهة المركزية التي تتحكم في الأجهزة في جميع أنحاء المنزل الوقت وتسمح لك بالتحكم في منزلك بشكل أكثر فعالية.  يتم تنفيذ رؤيتهم لهذه الأنظمة من قبل العلامات التجارية البارزة: Apple و Amazon و Google ، وبناءها في بنيتها التحتية ، وكذلك الحرفيين الذين يقومون بتجميع هذه الأنظمة على أساس منصة Arduino. </p><br><p style=";text-align:right;direction:rtl">  كان هدفنا كما يلي: إنشاء نظام سيكون متاحًا على عدد كبير من الأجهزة ولن يكون مرتبطًا بأي مكان.  اتضح أن خيارًا ممتازًا لتنفيذ عنصر التحكم هو برنامج روبوت لـ Telegram messenger.  لدى Telegram تطبيقات على جميع المنصات الرئيسية ، بالإضافة إلى إصدار الويب.  يمكن الحصول على الوصول إليها من أي مكان ، ما عليك سوى أن يكون لديك حساب. </p><br><p style=";text-align:right;direction:rtl">  اخترنا من الوحدات ما يلي: </p><br><p style=";text-align:right;direction:rtl">  • شريط LED بتحكم RGB <br>  • منفذ تديره <br>  • مستشعر درجة الحرارة <br>  • مستشعر الضوء (يستخدم لتشغيل الضوء تلقائيًا) </p><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ماذا نحتاج </h3><br><h4 style=";text-align:right;direction:rtl">  1. التوت بي 3 </h4><br><p style=";text-align:right;direction:rtl">  جهاز كمبيوتر صغير ولكن بعيد لا يحتاج إلى إدخال ، ستكون قوته كافية لنا للقيام بهذه المهام.  الإصدار الثالث جيد مع وحدة Wi-Fi مدمجة ، لذلك لا يتعين علينا التفكير في محول طرف ثالث. </p><br><h4 style=";text-align:right;direction:rtl">  2. وحدات ESP8266 </h4><br><p style=";text-align:right;direction:rtl">  سنحتاج 4 منهم.  استخدمنا ESP-12F ، ولكن بشكل عام لا يوجد فرق: سيكون ESP-1 كافيًا تمامًا.  أيضا ، يمكن أن توفر لك لوحات NodeMCU الجاهزة الوقت والجهد. </p><br><h4 style=";text-align:right;direction:rtl">  3. شريط LED </h4><br><p style=";text-align:right;direction:rtl">  أخذنا شريط RGB مُدارًا على وحدات التحكم WS2812b ، على الرغم من أن أي شريط يعمل على 5V ويدعمه نظام Arduino مناسب هنا بالمناسبة. </p><br><h4 style=";text-align:right;direction:rtl">  4. أجهزة استشعار درجة الحرارة والضوء </h4><br><p style=";text-align:right;direction:rtl">  استخدمنا وحدة BH1750 لتحديد الإضاءة في الغرفة و DS18B20 لدرجة الحرارة.  كانت المعايير الرئيسية هي التوفر ، والدعم من قبل منصة Arduino ، والقدرة على العمل مع منطق 3.3V ESP8266. </p><br><h4 style=";text-align:right;direction:rtl">  5. التتابع </h4><br><p style=";text-align:right;direction:rtl">  يمكن أن تمر الوحدة الفرعية MOD-1CH لـ Arduino حتى 10 أمبير من التيار ويتم التحكم فيها بواسطة 5V ، ولم نجد نظائرًا لـ 3.3V ، لذلك استخدمنا ترانزستور في وضع مفتاح للتحكم. </p><br><h4 style=";text-align:right;direction:rtl">  6. بوت برقية </h4><br><p style=";text-align:right;direction:rtl">  سيتم التحكم المباشر في النظام بأكمله باستخدام برنامج Telegram bot ، الذي تم إطلاقه على Raspberry: سيتيح هذا الوصول إلى النظام بسهولة على أي منصة من أي مكان في العالم.  إن إنشاء برنامج بوت ل Telegram أمر بسيط للغاية ، بفضل نظام أساسي متطور ودعم لعدد كبير من اللغات. </p><br><p style=";text-align:right;direction:rtl">  وبالتالي ، سيبدو نظامنا بالكامل على النحو التالي: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/060/7b9/0b6/0607b90b6cd44144aa5e28641bc3e156.png" alt="الصورة"></p><br><h3 style=";text-align:right;direction:rtl">  التنفيذ </h3><br><p style=";text-align:right;direction:rtl">  أولاً ، نختبر الوحدات. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/c2e/093/5de/c2e0935de6ad4b5dacda3e494e645eef.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  تعمل لوحات الدوائر الجاهزة على تكييف المسافة بين المسامير ، مما يسهل بشكل كبير اللحام ، وتحتوي أيضًا على المقاومات الضرورية التي تربط المسامير CH_PD و GPIO2 إلى Vcc. </p><br><p style=";text-align:right;direction:rtl">  لسوء الحظ ، يتم تشغيل وحدات ESP8266 وتشغيلها عند 3.3 فولت ، وليس 5 ، مثل Arduino.  يمكنك تحويل الجهد باستخدام وحدة تحويل جاهزة ، ولكن يمكنك أيضًا لحام الدائرة بناءً على المثبت الخطي AMS1117 ، كما فعلنا. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/171/88e/b51/17188eb517dd4ae7a781aae753d4df42.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  الخطوة التالية هي البرمجة. </p><br><p style=";text-align:right;direction:rtl">  لحسن الحظ ، يتم دعم منصة ESP8266 بواسطة Arduino IDE ، مما يفتح العديد من الاحتمالات لنا.  لتنزيل البرامج الثابتة مباشرة إلى الوحدة النمطية ، سنستخدم Arduino Nano ، ومع ذلك ، يمكن القيام بذلك من خلال محول USB-UART المعتاد.  لا تنس فرق الجهد بين Arduino و ESP. </p><br><p style=";text-align:right;direction:rtl">  المخطط كما يلي: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/47d/caa/be9/47dcaabe9a06464aa8e9d4d1e35ca479.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  الزر مطلوب لإغلاق دبوس GPIO1 إلى GND عند تطبيق الطاقة على الوحدة النمطية ، وبالتالي نقله إلى وضع البرمجة. </p><br><p style=";text-align:right;direction:rtl">  بعد ذلك ، نقوم بتكوين Arduino IDE بحيث يفهم ESP ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تعليمات مفصلة مع جميع الروابط</a> ) ومحاولة تسجيل رسم تخطيطي لوميض LED. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/b88/94a/65a/b8894a65aa6143e0be334ea8e7468ad3.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  بعد غمضة ناجحة ، بدأنا لحام جميع الوحدات.  مع مستشعر درجة الحرارة والضوء ، كل شيء قياسي جدًا. </p><br><p style=";text-align:right;direction:rtl">  درجة الحرارة: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/e7a/4a7/d03/e7a4a7d03d4e4c46b1af02d0f3e6a97e.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/3ce/cbe/5fa/3cecbe5fadd144208d47b42f4b55f88d.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  إضاءة: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/1ec/4db/505/1ec4db505e254635a6dfcc0e8c1f65ab.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/5a6/5bf/202/5a65bf202e0c4f698282a5554221130e.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  لكن الشريط والمآخذ الذكية تسببت في بعض الصعوبات. </p><br><p style=";text-align:right;direction:rtl">  فشل اتصال بسيط لمدخلات التحكم في الشريط بـ ESP.  هذا ليس مفاجئًا ، لأن WS2812b يتطلب 70٪ على الأقل من مدخلات VCC (5x0.7 = 3.5) لإدخال التحكم ، ومن الواضح أن لوحة 3.3V ليست كافية.  لكن وجدنا <del>  عكاز </del>  طريقة مثيرة للاهتمام لبدء تشغيلها دون استخدام محول تعزيز.  إذا كان الصمام الثنائي يتطلب 0.7xVcc كحد أدنى للتفاعل مع الإشارة ولا يمكننا زيادة مستوى هذه الإشارة ، فيجب تخفيض Vcc!  نعم ، لن تضيء مصابيح LED بشكل ساطع ، ومع ذلك ، لا نحتاج إلى تشغيل الشريط بالكامل بهذه الطريقة ؛  ديود واحد يكفي.  من خلال إرسال الإشارة على طول السلسلة ، يستخدم LED بالفعل مستوى Vcc لتشكيل الإشارة ، وهو ما يكفي لمؤشر LED "عادي".  وبالتالي ، من خلال توصيل الصمام الثنائي الأول في الشريط بمصدر الطاقة من خلال الصمام الثنائي ، والذي "يأكل" حوالي 0.6 فولت ، نحصل على شريط يعمل بشكل مثالي يتم التحكم فيه مباشرة من وحدة ESP8266.  وتركنا مصباح LED الأول الخافت قليلاً لاحتياجات التصحيح: عرض حالة اتصال الشبكة. </p><br><p style=";text-align:right;direction:rtl">  إليك ما حدث: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/6ea/eba/f9e/6eaebaf9e0c741a7ab938a97318d5d25.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/2c9/cb1/baa/2c9cb1baac0c41ea90c0ceeba0c252ea.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  أردنا وضع مقبسنا الذكي تمامًا في الحالة من المقبس القديم مع جهاز توقيت.  كان عليهم الدخول إلى هناك: ESP-12F نفسها ، ومصدر طاقة لها ومرحل يتحكم في المخرج.  ومع ذلك ، بعد وضع التتابع ومصدر الطاقة هناك ، لا يزال يتعذر علينا استيعاب وحدة ESP هناك.  لذلك ، كان علي إرفاق مربع صغير أدناه. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/ed7/0d9/1fe/ed70d91fe74945818d27cfc476ed0305.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  لم تكن النتيجة أنيقة كما أردنا في الأصل ، ولكنها كانت جهازًا صلبًا كان لا بد من توصيله بمنفذ طاقة. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/476/4bc/f54/4764bcf5488b400b9b0b1d3dd25b428a.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/b63/79f/683/b6379f6833c34e4f8e04f5a974a5ec96.jpg" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  كانت الخطوة التالية هي تكوين Raspberry.  كانت الخطة كما يلي: تتصل وحداتنا بنقطة وصول Wi-Fi ، وهي Raspberry ، وبشكل أكثر دقة ، إلى وحدة Wi-Fi المدمجة.  يدير Raspberry برنامج Telegram-bot ، والذي يقع مع جميع الوحدات على الشبكة المحلية ويمكنه بسهولة تبادل طلبات http معهم.  كلها متصلة بالإنترنت عبر إيثرنت. </p><br><p style=";text-align:right;direction:rtl">  لتنفيذ هذه الخطة ، استخدمنا حزمتين: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  hostapd - يسمح لك باستخدام وحدة wi-fi المدمجة كنقطة وصول </li><li style=";text-align:right;direction:rtl">  dnsmasq - يجمع بين خوادم DHCP و DNS. </li></ul><br><p style=";text-align:right;direction:rtl">  لقد حاولنا تحقيق الاستقلال النسبي للرمز والأجهزة ، وبالتالي ، تم تنفيذ جميع الطلبات ليس على عناوين IP ، ولكن على أسماء من منطقة .sh اخترعت (light.sh ، socket.sh ، وما إلى ذلك).  للقيام بذلك ، قمنا بتكوين عناوين IP ثابتة لكل وحدة نمطية وأضفنا السجلات المقابلة للوحدات النمطية لعناوين DNS هذه.  لحسن الحظ ، من السهل جدًا تكوين dnsmasq ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تعليمات تفصيلية لإعداد هذا النظام</a> ). </p><br><p style=";text-align:right;direction:rtl">  وأخيرًا ، البوت نفسه. </p><br><p style=";text-align:right;direction:rtl">  كتبنا روبوتًا في Python باستخدام مكتبة python-telegram-bot.  لقد قمنا بتطوير واجهة زر ، تبسط الإدارة ، وتحول الجهاز إلى نوع من جهاز التحكم عن بعد: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/5c1/14e/04c/5c114e04c8f84c209cbdb34a2e4e4301.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/web/07a/b0f/d39/07ab0fd391324935afccf4632226702f.png" alt="الصورة"></p><br><p style=";text-align:right;direction:rtl">  يمكن العثور على رمز الروبوت المصدر <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> . </p><br><p style=";text-align:right;direction:rtl">  وحتى لا يتمكن أي شخص من استخدامه ، قمنا بتعيين حماية كلمة المرور. </p><br><h3 id="vyvod" style=";text-align:right;direction:rtl">  الخلاصة </h3><br><p style=";text-align:right;direction:rtl">  بالطبع ، لم نقم بإنشاء أي نظام ثوري ؛ هناك عدد كبير من التطبيقات الأكثر شمولية ومدروسة.  يمكن جعل وحدات درجة الحرارة والإضاءة مستقلة ، حيث أن ESP8266 يحتوي على وضع استعداد خاص يستهلك فيه القليل جدًا من الطاقة.  يمكن للمرء أن يضيف قابلية توسع سهلة للمستخدم ، والتي لا تتطلب تغيير التعليمات البرمجية المصدر وإعادة تكوين اتصالات الشبكة ، وأكثر من ذلك بكثير.  ومع ذلك ، لم يكن الهدف من هذا المشروع بأكمله على الإطلاق.  بادئ ذي بدء ، أردنا إنشاء نظام بسيط يمكن إنشاؤه من قبل أي شخص في منزلنا ولن يتطلب إعدادًا وتكاليف جادة.  والأهم من ذلك: أردنا أن نتعلم أشياء كثيرة أثناء قيامنا بهذا المشروع.  وإذا كان من الممكن تطوير التطبيق العملي ووظيفة الحل لفترة أطول ، فإن المعرفة التي اكتسبناها في عملية تخطيط وتنفيذ هذا النظام كانت تستحق الجهد بالتأكيد. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar404009/">https://habr.com/ru/post/ar404009/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar403997/index.html">مجموعة القراصنة الحيوية الشباب</a></li>
<li><a href="../ar403999/index.html">عبادة الشحن للذكاء الاصطناعي: أسطورة الذكاء الاصطناعي الخارقة</a></li>
<li><a href="../ar404003/index.html">كيمياء عالم الكمبيوتر</a></li>
<li><a href="../ar404005/index.html">بكرة صغيرة ، نعم عزيزتي: سماعات Fostex داخل الأذن</a></li>
<li><a href="../ar404007/index.html">GPD Win - استكشاف كمبيوتر دفتري صغير بقطر 5.5 بوصة ، مصمم للألعاب والمحاكاة</a></li>
<li><a href="../ar404011/index.html">التوفير في الدم: تم تطوير نظام جديد لتوصيل المواد الحيوية في المختبر</a></li>
<li><a href="../ar404015/index.html">لماذا على الذهاب التفكير بشكل أفضل</a></li>
<li><a href="../ar404017/index.html">126 دولارًا في 5 دقائق: كيفية استخدام فرق السعر للدول مقابل جهات التسويق</a></li>
<li><a href="../ar404019/index.html">Likbez على Kryonika: بلغة بسيطة حول موضوع معقد</a></li>
<li><a href="../ar404021/index.html">ملجأ Doomsday في النرويج غمرته ملايين البذور المؤرشفة بسبب ذوبان الجليد الدائم</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>