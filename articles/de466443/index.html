<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñåÔ∏è üçö üëÜüèΩ ShIoTiny und die Welt: Analoge Sensoren oder ADCs f√ºr die Kleinsten üîä üì≤ ‚¨áÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wichtige Punkte oder worum es in diesem Artikel geht 


 Fortsetzung einer Reihe von Artikeln √ºber ShIoTiny - eine visuell programmierbare Steuerung a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny und die Welt: Analoge Sensoren oder ADCs f√ºr die Kleinsten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466443/"><p><img src="https://habrastorage.org/webt/fr/no/k7/frnok7ogh51ujstrunvuo69naww.jpeg" alt="Bild"></p><br><h3 id="osnovnye-tezisy-ili-o-chem-eta-statya">  Wichtige Punkte oder worum es in diesem Artikel geht </h3><br><p>  Fortsetzung einer Reihe von Artikeln √ºber <strong>ShIoTiny</strong> - eine visuell programmierbare Steuerung auf Basis des <strong>ESP8266-</strong> Chips.  Ein Hauptmerkmal dieses Controllers ist die M√∂glichkeit, ihn durch Zeichnen eines Programms in einem Browser zu programmieren. </p><br><p>  Dieser Artikel beschreibt eine kurze Theorie der Analog-Digital-Wandlung und die praktische Anwendung des <strong>ShIoTiny</strong> ADC-Controllers. </p><br><p>  <strong>Fr√ºhere Artikel in der Reihe.</strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ShIoTiny: kleine Automatisierung, das Internet der Dinge oder ‚Äûsechs Monate vor den Ferien‚Äú</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ShIoTiny: Knoten, Links und Ereignisse oder Funktionen von Zeichenprogrammen</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ShIoTiny: Nassrauml√ºftung (Beispielprojekt)</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ShIoTiny und die umliegende Welt: Anschlie√üen von Sensoren an Bin√§reing√§nge, Kontaktsprung und andere Probleme</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projektseite</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bin√§re Firmware, Controller-Schaltung und Dokumentation hier</a> </p><a name="habracut"></a><br><h3 id="vstuplenie-ili-vmesto-sereznoy-teorii">  Einf√ºhrung oder statt ernsthafter Theorie </h3><br><p>  In einem fr√ºheren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel haben</a> wir die Verbindung der wichtigsten Sensortypen mit einem <strong>Bin√§rausgang</strong> mit den <strong>Bin√§reing√§ngen</strong> des <strong>ShIoTiny-</strong> Controllers untersucht. </p><br><p>  Aber wie die meisten Menschen sowie Sch√ºler und Sch√ºler wissen, sind die meisten Informationen √ºber die Umgebung analoge Gr√∂√üen verschiedener physikalischer Natur: die Kraft von Licht und Ton, Geschwindigkeit, Luftdruck, Fl√ºssigkeitsstand und so weiter. </p><br><p>  Fast alle modernen Mikroprozessoren und Mikrocontroller k√∂nnen nur diskrete Werte in bin√§rer Darstellung verarbeiten. </p><br><p>  F√ºr diejenigen, die noch nicht wissen, wie sich der Analogwert vom diskreten unterscheidet, werde ich kurze Erkl√§rungen schreiben.  Wer schon alles wei√ü, kann sie √ºberspringen.  Ich werde sofort eine Reservierung vornehmen - Analogien und Vereinfachungen m√ºssen einen Platz haben.  Dies ist keine Dissertation, sondern eine kurze Erkl√§rung an den Fingern. </p><br><h3 id="analogovye-i-diskretnye-velichiny-professoram-akademikam-i-vunderkindam-mozhno-ne-chitat">  Analoge und diskrete Gr√∂√üen (Sie k√∂nnen Professoren, Akademikern und Geeks nicht vorlesen) </h3><br><p>  Alle haben in der Schule Mathematik studiert.  Deshalb wenden wir uns dem zu und ziehen Analogien zwischen analogen und diskreten Gr√∂√üen und Zahlen. </p><br><p>  Aus mathematischer Sicht ist eine <strong>analoge</strong> Gr√∂√üe eine <strong>reelle</strong> Zahl, die an jedem Punkt eines bestimmten Abschnitts einer Zahlenlinie definiert wird. </p><br><p>  <strong>Der diskrete</strong> Wert aus mathematischer Sicht ist <strong>eine ganze Zahl</strong> .  Und es wird nur an bestimmten Punkten eines bestimmten Abschnitts einer Zahlenlinie definiert. </p><br><p>  Die folgende Abbildung zeigt schematisch die Position von analogen und diskreten Mengenzahlen auf einer Zahlenlinie. </p><br><p><img src="https://habrastorage.org/webt/_f/py/tm/_fpytmw_jsgmgxgr-1saubap86m.png" alt="Bild"></p><br><p>  Betrachten Sie beispielsweise ein Segment einer Zahlenlinie von <strong>-4</strong> bis <strong>3</strong> .  Wie Sie sehen k√∂nnen, sind <strong>diskrete</strong> Gr√∂√üen, die durch <strong>rote</strong> Punkte angezeigt werden - ganze Zahlen darauf - nur 8 Teile.  <strong>Die</strong> durch die <strong>gr√ºne</strong> Linie in der Abbildung gezeigten Analogwerte sind endlos. </p><br><p>  Zum Beispiel haben wir eine bestimmte Gr√∂√üe <strong>X</strong> , die einen Wertebereich von <strong>0</strong> bis <strong>127 hat</strong> .  Wenn wir diese Gr√∂√üe als <strong>analog darstellen</strong> , k√∂nnen wir sie theoretisch mit beliebiger Genauigkeit darstellen - zum Beispiel <strong>12.123455454980</strong> oder <strong>126.00000000007</strong> oder im Allgemeinen mit einer Million Dezimalstellen. </p><br><p>  Sobald der Mikrocontroller in das Gesch√§ft eintritt und der Wert von <strong>X</strong> eine <strong>diskrete</strong> Darstellung erh√§lt, kann auch theoretisch nicht von einer ‚Äûunendlichen Genauigkeit‚Äú gesprochen werden.  Die Genauigkeit wird durch die Anzahl der Bin√§rziffern begrenzt, die wir der Darstellung der Gr√∂√üe <strong>X</strong> zuordnen. </p><br><p>  Zum Beispiel nehmen wir <strong>7</strong> Bits.  In diesem Fall k√∂nnen wir den Wert von <strong>X</strong> mit einer Genauigkeit von eins darstellen.  Das hei√üt, es wird m√∂glich sein, <strong>X = 1</strong> oder <strong>X = 112</strong> anzugeben.  <strong>X = 112,5</strong> kann jedoch nicht bereits angegeben werden - es ist nicht gen√ºgend Bittiefe vorhanden.  Wenn wir f√ºr die Darstellung des gleichen Wertes von <strong>X</strong> nicht <strong>7</strong> , sondern <strong>10</strong> Stellen nehmen, ist die Genauigkeit der Darstellung nicht eins, sondern <strong>0,125</strong> .  Und in dieser Form k√∂nnen Sie sich <strong>X = 95,125</strong> oder <strong>X = 112,5</strong> vorstellen.  Genauer gesagt zum Beispiel in der Form <strong>X = 112.13</strong> - dieser Wert kann nicht bereits dargestellt werden. </p><br><p>  Wenn Sie durch die Tatsache verwirrt sind, dass ich Bruchwerte schreibe und gleichzeitig von ihnen als Ganzzahlen spreche, denken Sie daran, dass "diskrete Punkte" auf einer Zahlenlinie nicht in Einheiten, sondern beispielsweise in <strong>0,5</strong> oder <strong>0,125</strong> Einheiten platziert werden k√∂nnen.  Der endg√ºltige Wert bleibt jedoch in jedem Segment erhalten.  Und alle Eigenschaften einer diskreten Menge bleiben erhalten. </p><br><p>  <strong>Der</strong> Hauptunterschied zwischen einem <strong>diskreten</strong> und einem <strong>analogen</strong> Wert besteht darin, dass es auf jedem endlichen Segment der Zahlenlinie eine endliche Anzahl von diskreten (ganzzahligen) Werten und eine unendliche Anzahl von analogen (reellen) Werten gibt.  Dementsprechend erhalten wir, dass die diskrete Darstellung von Gr√∂√üen immer eine endliche Genauigkeit hat. </p><br><p>  Als Ergebnis all dessen erhalten wir eine triviale <strong>Schlussfolgerung</strong> .  Die meisten messbaren Gr√∂√üen der realen Welt sind <strong>analog</strong> .  Mikrocontroller arbeiten nur mit <strong>diskreten</strong> numerischen Darstellungen von Gr√∂√üen.  Daher muss dieser Wert vor der Verarbeitung eines Analogwerts mit einem Mikrocontroller als diskreter Wert dargestellt werden.  Ja und in bin√§rer Form. </p><br><p>  <strong><em>Eine solche Umwandlung von analog zu digital wird als Analog-Digital-Umwandlung bezeichnet</em></strong> . </p><br><h3 id="analogo-cifrovoy-preobrazovatel">  Analog-Digital-Wandler </h3><br><p>  Ein Ger√§t zur Umwandlung eines analogen in ein digitales Signal wird als <strong>ADC</strong> ( <strong>Analog-Digital-Wandler</strong> ) bezeichnet. </p><br><p>  Typischerweise hat ein solches Ger√§t einen oder mehrere analoge Eing√§nge, an die ein analoges Signal und ein digitaler Ausgang mit einer bestimmten Bittiefe geliefert werden (normalerweise 8 bis 16 Bit). </p><br><p>  Moderne Mikrocontroller, einschlie√ülich unseres <strong>ESP8266</strong> , verf√ºgen √ºber integrierte ADC-Einheiten. </p><br><p>  Welche Eigenschaften haben der ADC im Allgemeinen und der <strong>ESP8266 ADC</strong> im Besonderen? </p><br><p>  <strong>Das erste</strong> Merkmal ist, welche Art von analogem Eingangswert der ADC in einen digitalen Ausgangscode umwandelt.  Meistens ist dieser Wert die Spannung am Analogeingang des ADC.  So wird es in unserem Fall sein.  In der Natur gibt es jedoch ADCs mit Stromeingang. </p><br><p>  <strong>Das zweite</strong> Merkmal des ADC, das in der Praxis ben√∂tigt wird, ist der Wertebereich des Eingangswerts des ADC.  In unserem Fall sind dies die minimalen und maximalen Spannungswerte am Eingang des ADC.  Diese Werte betragen <strong>0 V</strong> bzw. <strong>1 V.</strong>  Der Eingangsbereich von <strong>1 V</strong> scheint klein zu sein, aber gro√üe Spannungen k√∂nnen immer geteilt und reduziert werden, und kleine Spannungen k√∂nnen verst√§rkt werden. </p><br><p>  <strong>Das dritte</strong> und vielleicht wichtigste Merkmal des ADC ist seine Kapazit√§t.  Dieser Wert bestimmt die Genauigkeit der Transformation oder (nach unserer Analogie) - wie oft die "diskreten" Punkte auf der "reellen" Zahlenlinie platziert werden.  In unserem Fall hat der ADC eine Aufl√∂sung von <strong>10</strong> .  Was bedeutet das?  Dies bedeutet, dass der ausgegebene digitale Code durch 10 Bin√§rziffern dargestellt wird und 1024 Werte aufweist - von 0 bis 1023. <br>  Genau genommen ist zu beachten, dass die Konvertierungsgenauigkeit nicht nur von der Bittiefe abh√§ngt, sondern auch von einer Reihe anderer Parameter, beispielsweise der Linearit√§t des ADC.  Aber sehr kluge Onkel haben bereits viel dar√ºber in sehr klugen B√ºchern dar√ºber geschrieben, deshalb werde ich den Leser in diesem Artikel ohne Details lassen. </p><br><p>  Dar√ºber hinaus kann der <strong>ADC ESP8266</strong> einen √úberlauf erkennen, <strong>dh</strong> eine Situation, in der eine Spannung von mehr als <strong>1 V</strong> an den Eingang angelegt wird. </p><br><p>  Wenn Sie ein intelligentes Nachschlagewerk √ºber ADCs nehmen und dort nachsehen, gibt es Dutzende anderer Merkmale.  Alle von ihnen sind notwendig und wichtig, aber wir werden nicht so weit gehen.  <strong>Zum Beispiel</strong> werden wir <em>die Zeitparameter des ADC nicht ber√ºhren</em> , weil wir glauben, dass sich in unserem Fall die gemessenen Werte ziemlich langsam √§ndern und der ADC sie ‚Äûsofort‚Äú in eine digitale Darstellung umwandelt. </p><br><p>  Um <strong>das</strong> vorl√§ufige <strong>Ergebnis zusammenzufassen</strong> . <br>  Der <strong>ShIoTiny-</strong> Controller verf√ºgt √ºber einen im <strong>ESP8266 integrierten</strong> ADC. </p><br><p>  Am Eingang des <strong>ADC ESP8266 wird</strong> eine Spannung im Bereich von <strong>0</strong> bis <strong>1 V</strong> angelegt. </p><br><p>  Am Ausgang des <strong>ESP8266 ADC erhalten</strong> wir eine Zahl proportional zur Eingangsspannung im Bereich von <strong>0</strong> bis <strong>1023</strong> .  Die Spannung <strong>0 V</strong> entspricht dem Code <strong>0</strong> am ADC-Ausgang, die Spannung <strong>1 V</strong> entspricht dem Code <strong>1023</strong> am ADC-Ausgang. </p><br><p>  Das Lesen von Daten vom ADC in <strong>ShIoTiny</strong> erfolgt mit einer Geschwindigkeit von ungef√§hr <strong>10 Mal pro Sekunde</strong> . </p><br><p>  Der Hardware-Eingang des ADC ist gegen √úberspannung gesch√ºtzt, √§hnlich wie die <strong>Bin√§reing√§nge Input1,2,3 gesch√ºtzt sind</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">siehe hier</a> ). </p><br><p>  Das war's f√ºr die <strong>ShIoTiny ADC-Hardware</strong> . </p><br><p>  <strong>Betrachten</strong> wir nun <strong>den ADC1-</strong> Knoten, der Daten vom <strong>ESP8266-</strong> Hardware- <strong>ADC verarbeitet</strong> . </p><br><h3 id="programmnye-navoroty-ili-uzel-adc1">  Software Schnickschnack ADC1 </h3><br><p>  Im Programmdiagramm im <strong>ElDraw-</strong> Editor hei√üt die Analog-Digital-Wandlerbaugruppe <strong>ADC1</strong> . </p><br><img src="https://habrastorage.org/webt/bt/wn/ub/btwnub4pibvpje98rsdylqdvizs.png"><br><p>  Wie bereits erw√§hnt, empf√§ngt der <strong>ADC1-</strong> Knoten ungef√§hr <strong>10 Mal pro Sekunde</strong> Daten vom <strong>ESP8266-</strong> Hardware- <strong>ADC</strong> .  Der angegebene Knoten beruhigt sich jedoch nicht, sondern beginnt, diese Daten zu verarbeiten und sogar ein wenig zu analysieren. </p><br><p>  <strong>Zun√§chst</strong> wird √ºberpr√ºft, ob ein ADC-√úberlauf aufgetreten ist.  Das hei√üt - hat der ADC nicht mehr als <strong>1 V</strong> eingegeben?  Wenn eine solche Situation erkannt wird, wird der Ausgang des <strong>ADC1-</strong> Knotens auf <strong>NAN</strong> ( <strong>keine Nummer</strong> ) gesetzt. </p><br><p>  <strong>Zweitens wird</strong> , wenn kein √úberlauf <strong>aufgetreten ist</strong> , der Ausgangswert des ADC <strong>0..1023</strong> in den Spannungswert am Eingang des ADC umgewandelt <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.116ex" height="1.817ex" viewBox="0 -520.7 1341.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-6E" x="345" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> u_ {in} </script>  - eine Gleitkommazahl im Bereich <strong>0..1</strong> . </p><br><p>  <strong>Drittens</strong> wird dieser umgerechnete Wert <strong>0..1</strong> gem√§√ü der Formel neu berechnet <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">d </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">u </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;">i </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">n</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"> + </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;">b</font></span></font><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.014ex" height="2.419ex" viewBox="0 -780.1 7755.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-58" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMAIN-3D" x="1130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-6B" x="2186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-63" x="2958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-64" x="3391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-6F" x="3915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-74" x="4400" y="0"></use><g transform="translate(4762,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMAIN-2B" x="6325" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-62" x="7326" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> X = k \ cdot u_ {in} + b </script>  wo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-26" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.116ex" height="1.817ex" viewBox="0 -520.7 1341.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-6E" x="345" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> u_ {in} </script>  - Spannung am Eingang des ADC (von <strong>0</strong> bis <strong>1 V</strong> );  <strong>k</strong> ist der Bereich ( <strong>ADC-Bereich</strong> ) und <strong>b</strong> ist der Versatz ( <strong>ADC-Versatz</strong> ).  Und schlie√ülich wird der erhaltene Wert von <strong>X</strong> auf den Ausgang des <strong>ADC1-</strong> Knotens gesetzt. </p><br><p>  Und schlie√ülich <strong>im f√ºnften</strong> .  Wenn sich der Wert von <strong>X</strong> um einen bestimmten Prozentsatz (von <strong>1</strong> auf <strong>100%</strong> ) ge√§ndert hat, generiert die ADC-Einheit Ereignisse, die eine Konvertierung der Werte der mit ihr verbundenen Knoten bewirken.  Dies ist im Wesentlichen der <strong>ADC-Empfindlichkeitsparameter</strong> ( <strong>ADC-√Ñnderungen, Bereich%</strong> ).  Schlie√ülich gibt es normalerweise keinen Grund, ‚Äûauf jedes Niesen‚Äú zu reagieren, dh auf sp√§rliche √Ñnderungen in den unteren Bits des ADC - sie machen oft ‚ÄûGer√§usche‚Äú.  Daher ist der Empfindlichkeitsparameter von gro√üer praktischer Bedeutung. </p><br><p>  Es stellt sich die berechtigte Frage: Wie konfigurieren wir diese Einstellungen?  Klicken Sie mit der Maus auf den <strong>ADC1-</strong> Knoten im Diagramm und genau dort sehen Sie ein Einstellungsfenster. </p><br><p>  Darin k√∂nnen Sie alles einstellen, was Sie brauchen.  In unserem Fall handelt es sich um ein solches Fenster wie in der Abbildung. </p><br><p><img src="https://habrastorage.org/webt/cn/so/ub/cnsoubc9q_rhu-2p6hlffcd_1ig.png" alt="Bild"></p><br><p>  In diesem Fenster k√∂nnen Sie alle oben genannten Parameter einstellen - Bereich, Offset und Empfindlichkeit des ADC. </p><br><p>  Wenn Sie nichts angegeben haben, ist der Bereich 1. Der Versatz ist Null.  Und die Empfindlichkeit betr√§gt 1%. </p><br><p>  Das hei√üt, standardm√§√üig ist der Ausgang des <strong>ADC1-</strong> Knotens der Wert der analogen Spannung, die dem ADC-Eingang zugef√ºhrt wird. </p><br><p>  Wie Sie sehen k√∂nnen, ist der <strong>ADC1-</strong> Knoten ziemlich komplex.  Warum wird das alles gemacht? <del>  Ja f√ºr Sie, meine lieben Benutzer! </del>  Nur ein Scherz, nat√ºrlich, als b√∂sartiger Egoist habe ich fr√ºhere Erfahrungen ber√ºcksichtigt und versucht, mein Leben leichter zu machen. </p><br><p>  Wir als einfache Ingenieure m√∂chten, dass die Werte nicht in "Papageien", sondern in normalen und verst√§ndlichen Werten dargestellt werden - Volt, Ampere, Kilogramm oder Meter. </p><br><p>  Viele Sensoren geben den Wert ‚Äûbei Papageien‚Äú aus, in der Hoffnung, dass ein intelligenter Mikrocontroller sie auf die gew√ºnschten Werte neu berechnet. </p><br><p>  Zu diesem Zweck wurde die Umwandlung des gemessenen ADC-Wertes durch die Funktion des gegebenen eingef√ºhrt. </p><br><p>  Aber wie immer ist es besser, einmal zu sehen als zehnmal zu h√∂ren.  Es ist auch besser, es einmal zu versuchen als zehn Mal zu sehen ... Aber das ist nicht der Punkt. <br>  Daher werde ich einige nicht komplizierte Beispiele nennen: ein Stromversorgungssystem und ein Temperaturmesssystem, das auf einem Sensor mit einem Stromausgang von <strong>4 bis 20 mA</strong> basiert. </p><br><h3 id="kontrol-pitayuschey-seti">  Netz√ºberwachung </h3><br><p>  Das Messen von Spannung ist eine h√§ufige Aufgabe.  Zum Beispiel wollen wir die Spannung des Netzes <strong>~ 220V messen</strong> .  Wenn wir eine schlechte Stromversorgung haben, ist die Aufgabe sehr real.  Wir brauchen keine sehr, sehr genaue √Ñnderung.  Es reicht aus, wenn <strong>Relais1</strong> bei <strong>ShIoTiny</strong> ausgel√∂st wird, wenn die Spannung 15% √ºber der Norm <strong>liegt</strong> , und wenn die Spannung um 15% gegen√ºber der Norm <strong>reduziert wird</strong> , wird <strong>Relais2 ausgel√∂st</strong> . </p><br><p>  Nat√ºrlich k√∂nnen wir <strong>den ADC1-</strong> Eingang des <strong>ShIoTIny-</strong> Controllers nicht in eine Buchse <strong>stecken</strong> .  Was zu tun ist?  Erstens muss die Spannung auf ein akzeptables Niveau reduziert werden - <strong>0,1 V.</strong>  Und zweitens muss es gleichgerichtet werden: Unser ADC kann die Wechselspannung nicht messen. </p><br><p>  Die Spannung im Netzwerk kann sowohl unter als auch √ºber der Norm liegen.  Der Einfachheit halber <strong>nehmen</strong> wir <strong>an,</strong> dass <strong>220 V der</strong> Netzspannung <strong>0,5 V der</strong> Spannung am Eingang des ADC entsprechen. </p><br><p>  Als n√§chstes suchen wir nach einem <strong>Abw√§rtstransformator, der</strong> bei <strong>~ 220 V der</strong> Eingangsspannung etwa <strong>3</strong> V <strong>der</strong> Ausgangsspannung <strong>liefert</strong> , und bauen eine solche Schaltung wie in der folgenden Abbildung zusammen. </p><br><br><p>  Hier kann eine <strong>√úberraschung</strong> die Unwissenden in der Elektronik erwarten.  Am Ausgang des Gleichrichters erscheint pl√∂tzlich nicht mehr <strong>3V</strong> Gleichspannung, sondern etwas <strong>4V</strong> plus!  In der Tat wird alles einfach erkl√§rt.  Wenn wir eine Wechselspannung messen, zeigt uns das Voltmeter den <strong>tats√§chlichen</strong> Spannungswert an.  Und wenn wir diese Spannung gleichrichten, erhalten wir am Ausgang des Gleichrichters den <strong>Spitzenwert</strong> der Spannung, der f√ºr das sinusf√∂rmige Signal ungef√§hr <strong>1,41</strong> betr√§gt, und zwar genau <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn" id="MJXp-Span-35"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.791ex" height="2.298ex" viewBox="0 -728.2 2493.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMATHI-74" x="1631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/466443/&amp;usg=ALkJrhh9iDiZnzDpOkAsOndFFnnx8F7m3A#MJMAIN-32" x="1993" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ sqrt 2 </script>  mal mehr als die aktuelle.  Daher die "unverst√§ndlichen" <strong>4,23 V</strong> am Ausgang des Gleichrichters. </p><br><p>  Und schlie√ülich m√ºssen wir den Spannungsteiler berechnen, dh den Widerstand <strong>R1</strong> und <strong>R2</strong> .  Wir m√ºssen am Ausgang des Teilers <strong>0,5 V</strong> mit einer Spannung am Eingang <strong>4,23 V erreichen</strong> .  Die gleichgerichtete Spannung von <strong>4,23 V</strong> sollte also durch das <strong>8,46-</strong> fache geteilt werden.  Stellen Sie dazu den Widerstand <strong>R2 = 100 Ohm</strong> und den Widerstand <strong>R1 = 746 Ohm ein</strong> .  Das ist aber ideal.  Tats√§chlich existieren keine Widerst√§nde mit einem Widerstand von <strong>746 Ohm</strong> .  Ja, und Transformatoren sind nicht besonders genau.  Wenn sich jemand traut, diese L√∂sung auszuprobieren, <strong>empfehle</strong> ich <strong>Ihnen dringend</strong> , den Widerstand <strong>R1 = 760 Ohm</strong> und den Widerstandstrimmer <strong>R2</strong> mit einem Widerstand von <strong>180 Ohm</strong> oder <strong>220 Ohm zu verwenden</strong> .  Dann k√∂nnen Sie mit einem Voltmeter <strong>R2</strong> so einstellen, dass bei <strong>~ 220 V die</strong> Spannung an der Prim√§rwicklung des Transformators am Ausgang des Teilers (oder, was am Eingang von <strong>ADC1 gleich ist</strong> ) <strong>= 0,5</strong> <strong>V</strong> betr√§gt. </p><br><p>  Wir messen die Spannung nicht nur so, sondern um etwas zu tun, indem wir sie von der Norm √ºberschreiten oder verringern.  Schalten Sie beispielsweise die Backup-Stromversorgung ein, damit einige Ger√§te nicht durchbrennen und sich nicht ausschalten. </p><br><p>  Daher werden wir das einfachste Programmschema zeichnen, das bewirkt, dass das Relais <strong>Relais1 funktioniert</strong> , wenn die Spannung <strong>15%</strong> √ºber der Norm liegt, und wenn die Spannung um <strong>15%</strong> von der Norm <strong>abf√§llt</strong> , das Relais <strong>Relais2 funktioniert</strong> .  Au√üerdem muss die √úber- oder Unterspannung im Netzwerk <strong>mindestens 1 Minute lang</strong> aufrechterhalten werden, um ein Relais auszul√∂sen.  Dies verhindert Fehlalarme bei kurzen Spannungsspitzen, die h√§ufig im Netzwerk auftreten.  Das Schema-Programm, das unsere Idee umsetzt, ist in der Abbildung dargestellt. </p><br><p><img src="https://habrastorage.org/webt/vq/t0/bo/vqt0bo1gbldkrrwflef9j6e8ada.png" alt="Bild"></p><br><p>  Damit diese Schaltung funktioniert, muss der Koeffizient k (Bereich) in den Einstellungen der ADC-Parameter auf <strong>440 eingestellt</strong> werden, wie in der Abbildung gezeigt. </p><br><p><img src="https://habrastorage.org/webt/3a/iw/x8/3aiwx8bupssyh3wkvimax7bxnfe.png" alt="Bild"></p><br><p>  Mit einem Koeffizienten von <strong>440</strong> und einer Spannungsspannung am Eingang des ADC <strong>0,5</strong> V betr√§gt der Ausgang des <strong>ADC1-</strong> Knotens <strong>220</strong> .  Das ist die reale Netzspannung! </p><br><p>  Dies ist sehr praktisch, da Sie die Konstanten sofort in Volt <strong>einstellen k√∂nnen</strong> : <strong>220 V + 15%</strong> sind <strong>253 V</strong> und <strong>220 V - 15%</strong> sind <strong>187 V.</strong>  Bei Bedarf k√∂nnen diese Werte leicht ge√§ndert werden, ohne Zeit mit der Berechnung und Umwandlung der Spannung in ‚ÄûPapageien‚Äú zu verschwenden. </p><br><h3 id="datchik-temperatury-4-20ma">  4-20mA Temperatursensor </h3><br><p>  Sensoren mit einer Stromabgabe von 4 bis 20 mA sind in der Industrie weit verbreitet.  Im Alltag werden Sie sie nicht oft treffen.  Trotzdem hat jemand sie und dieser will sie an die Sache anpassen. </p><br><p>  Der ADC erm√∂glicht die Verwendung solcher Sensoren in Verbindung mit dem <strong>ShIoTiny-</strong> Controller. </p><br><p>  Warum ist der Sensorausgangsstrom und genau <strong>4-20mA</strong> ?  Ich werde es erkl√§ren. </p><br><p>  Stromausg√§nge funktionieren gut auf langen Leitungen.  Sag einen Kilometer.  Der Widerstand der Dr√§hte ist ihnen egal: Der Strom ist √ºber die gesamte L√§nge des Drahtes gleich, unabh√§ngig vom Widerstand der Leiter. </p><br><p>  Der anf√§ngliche Stromwert von <strong>4 mA</strong> und nicht nur der fehlende Strom machen es einfach, einen Drahtbruch zu erkennen.  Wenn der Sensor ganz ist und der Draht nicht gebrochen ist, ist immer Strom vorhanden.  Mindestens <strong>4mA</strong> .  Und wenn der Draht <strong>bricht,</strong> gibt es keinen Strom ( <strong>0mA</strong> ). </p><br><p>  Angenommen, wir haben einen Temperatursensor mit einer Stromabgabe von <strong>4</strong> bis <strong>20 mA</strong> und einem Bereich der gemessenen Temperatur von <strong>-40</strong> ¬∞ <strong>C</strong> bis <strong>+</strong> <strong>125</strong> ¬∞ <strong>C.</strong>  Wir wollen es mit <strong>ShIoTin verbinden</strong> .  Als erstes m√ºssen wir den Strom in Spannung umwandeln.  Ein ideales Mittel f√ºr eine solche Umwandlung ist ein herk√∂mmlicher Widerstand. </p><br><p>  Da die maximale Spannung am Eingang des ADC <strong>1 V</strong> betr√§gt und der maximale Strom in der Leitung <strong>20 mA</strong> betr√§gt, kann leicht berechnet werden, dass ein Widerstand, der <strong>20 mA</strong> in <strong>1 V</strong> umwandelt, einen Widerstand von <strong>50 Ohm hat</strong> .  ( <em>Kenne Ohmsches Gesetz nicht - bleib zu Hause!</em> ). </p><br><p>  Wir werden unseren Sensor wie in der Abbildung gezeigt anschlie√üen. </p><br><p><img src="https://habrastorage.org/webt/7a/fq/og/7afqogxbvlo_0tb4ytycdnaynqm.png" alt="Bild"></p><br><p>  Der Sensor ist ein Stromgenerator proportional zur gemessenen Temperatur.  Bei einem Widerstand von <strong>50 Ohm</strong> , der parallel zum <strong>ADC1-</strong> Eingang geschaltet ist, liegen die folgenden Spannungswerte am ADC-Eingang, abh√§ngig vom in der Sensorschaltung erzeugten Strom: </p><br><ul><li>  Strom <strong>kleiner als 4mA</strong> , Spannung am ADC-Eingang kleiner als <strong>0,2 V</strong> - Leitungsbruch; </li><li>  Strom von <strong>4mA bis 20mA</strong> , Spannung von <strong>0,2V bis 1V</strong> - der Sensor arbeitet; </li><li>  Strom ist <strong>gr√∂√üer als 20mA</strong> , Eingangsspannung ist <strong>gr√∂√üer als 1V</strong> - der Sensor ist defekt.  Bei einem Kurzschluss im Sensor kann ein 50-Ohm-Widerstand durchbrennen, wenn die Leistung unter 2 W liegt. </li></ul><br><p>  Angenommen, wir m√∂chten die Temperatur messen und durch <strong>MQTT ver√∂ffentlichen</strong> .  Zus√§tzlich ver√∂ffentlichen wir den Status des Sensors (Unterbrechung, Kurzschluss oder alles ist in Ordnung). </p><br><p>  Das erste, was wir tun m√ºssen, ist den Wert von den "Papageien" in Grad neu zu berechnen.  Wenn wir wissen, dass eine Temperatur von <strong>-40</strong> ¬∞ <strong>C</strong> einem Strom von <strong>4 mA</strong> und einer Spannung am Eingang des ADC von <strong>0,2 V entspricht</strong> und eine Temperatur von <strong>+125 ¬∞ C</strong> einem Strom von <strong>20 mA</strong> und einer Spannung am Eingang des ADC von <strong>1</strong> <strong>V entspricht</strong> , erhalten wir die Koeffizienten: <strong>k = 206,25</strong> und <strong>b = -81,25</strong> .  Geben Sie diese Koeffizienten in das ADC-Einstellungsfenster ein, wie in der Abbildung gezeigt. </p><br><p><img src="https://habrastorage.org/webt/pn/bn/ss/pnbnsso2veaouphppgibtzqx8do.png" alt="Bild"></p><br><p>  Wer die Richtigkeit der Berechnung von <strong>k</strong> und <strong>b selbst</strong> √ºberpr√ºfen m√∂chte, entscheidet selbst √ºber das einfachste Gleichungssystem: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-36"><span class="MJXp-mtext" id="MJXp-Span-37">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">n</span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">F</span><span class="MJXp-mrow" id="MJXp-Span-45"><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">√§</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">e</span></span><span class="MJXp-mn" id="MJXp-Span-50">0</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-52">2</span><span class="MJXp-mtext" id="MJXp-Span-53">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">k</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">b</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-63">40</span><span class="MJXp-mspace" id="MJXp-Span-64" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-65">1</span><span class="MJXp-mtext" id="MJXp-Span-66">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">k</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">b</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-75">125</span><span class="MJXp-mtext" id="MJXp-Span-76">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">d</span><span class="MJXp-mrow" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">F</span><span class="MJXp-mrow" id="MJXp-Span-82"><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0em;">√§</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">e</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ begin {F√§lle} 0,2 \ cdot k + b = -40 \\ 1 \ cdot k + b = 125 \ end {F√§lle} </script></p><br><p>  Nun, das Programmschema wird √ºberhaupt nicht kompliziert sein und ist in der folgenden Abbildung dargestellt. </p><br><p><img src="https://habrastorage.org/webt/nn/yg/u9/nnygu9gstcce-b58llm-k5fyxns.png" alt="Bild"></p><br><p>  Wenn alles in Ordnung ist und der <strong>4-20-mA-</strong> Temperatursensor <strong>funktioniert</strong> , wird die Temperatur auf dem <strong>MQTT-</strong> Server unter dem Namen <strong>/ t_sens ver√∂ffentlicht</strong> .  Die Symptome werden auch unter den Namen <strong>/ sens_short</strong> und <strong>/ sens_break ver√∂ffentlicht</strong> .  Wenn alles in Ordnung ist, sind die Anzeichen eines Unfalls Null. </p><br><p>  Wenn die Leitung <strong>bricht</strong> , liegt die Temperatur unter <strong>-40 ¬∞ C.</strong>  In diesem Fall wird der Parameter <strong>/ sens_break</strong> auf dem <strong>MQTT-</strong> Broker als Einheit ver√∂ffentlicht. </p><br><p>  Wenn die Leitung einen Kurzschluss aufweist, betr√§gt die Temperatur mehr als <strong>+ 125</strong> ¬∞ <strong>C.</strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Fall liegt am Eingang des ADC eine Spannung von mehr als </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 V</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an, </font><font style="vertical-align: inherit;">und die ADC-Einheit setzt den Ausgang auf </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NAN</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht-Nummer</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">In diesem Fall wird der Parameter </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sens_short</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf dem </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MQTT-</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Broker als Einheit ver√∂ffentlicht.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn einer der Alarme </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auftritt</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><strong><font style="vertical-align: inherit;">l√∂st</font></strong><font style="vertical-align: inherit;"> das </font><strong><font style="vertical-align: inherit;">Relais3-</font></strong><font style="vertical-align: inherit;"> Relais aus </font><font style="vertical-align: inherit;">, wodurch beispielsweise der Sensor ausgeschaltet werden kann.</font></font></p><br><p>    ¬´¬ª ,   , ,  200      . </p><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>      <strong>ShIoTiny</strong>  ,      .      ,  . </p><br><p>  ,  -    ¬´¬ª  ,  - , -   . </p><br><p>   ‚Äî     .      . </p><br><p>           : <strong>shiotiny@yandex.ru</strong> . </p><br><h3 id="ssylki">  Referenzen </h3><br><p>        ,   ,     . </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">       <br></a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">- </a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analoges und digitales Signal. </font><font style="vertical-align: inherit;">Arten von Signalen und wie es funktioniert</font></font></a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liste der Spannungs- und Stromparameter </font></font><br></a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analoge Feldschnittstellen: 4-20 mA Stromschleife - von einfach bis komplex</font></font></a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EINSTELLEN DES ESPPOWER CLOUD-MANAGEMENTS √úBER DAS INTERNET MIT ANDROID</font></font></a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466443/">https://habr.com/ru/post/de466443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466433/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 41. DHCP-Snooping und nicht standardm√§√üiges natives VLAN</a></li>
<li><a href="../de466435/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 42. Inter-VLAN-Routing und SVI</a></li>
<li><a href="../de466437/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 43. Routing-Protokolle Distanzvektor und Verbindungsstatus</a></li>
<li><a href="../de466439/index.html">√úberpr√ºfen Sie selbst: Wie viele Fragen k√∂nnen Sie ChGK beantworten?</a></li>
<li><a href="../de466441/index.html">Python-Buggy-Code: 10 h√§ufigste Fehler, die Entwickler machen</a></li>
<li><a href="../de466445/index.html">Angriffe zwischen Vertrauensstellungen zwischen Dom√§nen</a></li>
<li><a href="../de466447/index.html">Wof√ºr sollen wir ein CDN bauen?</a></li>
<li><a href="../de466449/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 44. Einf√ºhrung in OSPF</a></li>
<li><a href="../de466451/index.html">Read_You kann nicht werfen</a></li>
<li><a href="../de466453/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 45. Konfigurieren von OSPF</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>