<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿‍🤝‍🧑🏼 ⚜️ 🤷🏼 Pi-Sonos v2.0 ou l'évolution de la radio Internet sur le Raspberry Pi 🖇️ 🤰🏼 🤱</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comme vous le savez, il n'y a pas de limite à la perfection. Même pour l'acoustique portable maison, dont le public d'utilisateurs ne comprend qu'une ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pi-Sonos v2.0 ou l'évolution de la radio Internet sur le Raspberry Pi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/410227/"><img src="https://habrastorage.org/webt/gd/g9/zx/gdg9zxcp2lrffn69l2p0nfjlp5k.png" alt="image" align="left">  Comme vous le savez, il n'y a pas de limite à la perfection.  Même pour l'acoustique portable maison, dont le public d'utilisateurs ne comprend qu'une seule personne.  Une personne très exigeante et parfois têtue maniaque.  Après la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publication</a> du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premier article</a> sur Pi-Sonos, près de 5 mois se sont écoulés.  Pendant ce temps, le logiciel à l'intérieur de cette acoustique a réussi à changer radicalement deux fois.  La raison de ces changements était à la fois les conseils utiles des Habrachiens et leur propre UX. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Un peu d'histoire pour ceux qui sont trop paresseux pour lire ou qui ont déjà oublié le premier article</b> <div class="spoiler_text">  Pi-Sonos est une acoustique compacte faite maison, dont la création a été inspirée par Sonos Play 1. Le but de cette acoustique était, tout d'abord, de jouer de la musique à partir de stations de radio Internet.  Lors de sa création, j'ai mis le minimalisme et la commodité au premier plan: je l'ai branché sur une prise de courant, puis, partout dans la maison, contrôlez la musique depuis votre smartphone / ordinateur / tablette. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">De quoi parle cet article</b> <div class="spoiler_text">  Tout d'abord, sur la persévérance et la curiosité sur le chemin de l'idéal.  Sous la coupe, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">nom d'utilisateur</a> , il n'y aura ni solution à aucun problème global, ni description d'une nouvelle technologie unique.  L'article présente simplement une comparaison des centres de médias populaires pour le Raspberry Pi, révèle leurs forces et leurs faiblesses, ainsi que ma vision personnelle du cadre optimal pour une radio Internet.  En fait, en développant mon propre logiciel pour le haut-parleur, je viens de répéter partiellement le parcours des créateurs de Volumio, réalisant à partir de rien une seule de ses fonctions (lire: «inventé un autre vélo»). <br>  Malgré le fait que l'article traite du thème du développement logiciel, il n'y a pas de code, car le but de l'article est de décrire l'idée et la fonctionnalité, et non le processus de sa mise en œuvre.  Si le sujet du code est intéressant pour les résidents, je vais essayer de maîtriser un article distinct décrivant le processus de développement. <br></div></div><br>  Initialement, le bourrage logiciel pour l'acoustique était <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OSMC</a> , mais les gens sages dans les commentaires ont attiré l'attention sur le fait que Kodi (alias OSMC) est trop audacieux comme le "cerveau" d'une station de radio Internet.  Il est trop intelligent et grand, seulement pour les projets audio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Volumio est</a> meilleur.  En fait, cela s'est avéré de cette façon.  Volumio est plus léger, affiné par l'interface Web et dispose d'une API plus avancée et plus facile à développer.  De plus, il n'est pas nécessaire qu'un câble HDMI dépasse de l'arrière, car Volumio est entièrement personnalisable dans n'importe quel navigateur. <br><br>  Cependant, Volumio a également montré quelques lacunes importantes qui m'ont incité à poursuivre mes recherches.  C'est, d'une part, le temps de téléchargement, et d'autre part, le manque de lecture automatique.  Après avoir étudié la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation officielle</a> (à partir de laquelle on peut comprendre que Volumio est un module complémentaire sur mpd (Music Player Daemon)), j'ai décidé qu'il était temps d'écrire mon propre wrapper appelé RPi-Radio sur js qui résoudrait ces problèmes.  Sa partie serveur fonctionne sur Node.js, et la partie client (GUI) utilisant React.js est prête depuis OSMC, elle n'avait besoin que d'être modifiée.  Il ressemble donc maintenant à l'écran du smartphone: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/te/nz/am/tenzamoyba4r-l2y4ypzu3zpt68.jpeg"></div><br>  Vous trouverez ci-dessous une plaque qui montre clairement les inconvénients et les avantages de chacun des cadres. <br><table><tbody><tr><th>  Critère </th><th>  <nobr>OSMC</nobr> </th><th>  <nobr>Volumio</nobr> </th><th>  <nobr>RPi-Radio</nobr> </th></tr><tr><td>  Temps de chargement </td><td>  <nobr>35 sec</nobr> </td><td>  <nobr>45 sec</nobr> </td><td>  <nobr>20 sec</nobr> </td></tr><tr><td>  Démarrage de la lecture automatique </td><td>  <nobr>non *</nobr> </td><td>  <nobr>non *</nobr> </td><td>  <nobr>oui</nobr> </td></tr><tr><td>  Le nombre de bandes de l'écran principal de l'interface graphique «native» sur le smartphone pour sélectionner une station de radio dans la liste des favoris ** </td><td>  <nobr>Défilement 5 + 1</nobr> </td><td>  <nobr>4</nobr> </td><td>  <nobr>1</nobr> </td></tr><tr><td>  La nécessité d'un moniteur, d'un clavier et d'une souris *** </td><td>  <nobr>oui</nobr> </td><td>  <nobr>non</nobr> </td><td>  <nobr>non</nobr> </td></tr><tr><td>  Gestion Web </td><td>  <nobr>partiel</nobr> </td><td>  <nobr>complet</nobr> </td><td>  <nobr>partiel</nobr> </td></tr><tr><td>  Modification de la liste des stations </td><td>  <nobr>bof</nobr> </td><td>  <nobr>les normes</nobr> </td><td>  <nobr>bof</nobr> </td></tr><tr><td>  Configuration initiale facile </td><td>  <nobr>bof</nobr> </td><td>  <nobr>super</nobr> </td><td>  <nobr>médiocre</nobr> </td></tr><tr><td>  Intégration avec l'interface graphique de mon smartphone </td><td>  <nobr>avec des béquilles</nobr> </td><td>  <nobr>avec des béquilles</nobr> </td><td>  <nobr>hors de la boîte</nobr> </td></tr><tr><td>  Commodité d'utilisation quotidienne </td><td>  <nobr>☆</nobr> </td><td>  <nobr>☆☆</nobr> </td><td>  <nobr>☆☆☆</nobr> </td></tr></tbody></table>  <b>* en</b> fait oui, mais vous devez faire une béquille et palmer son démarrage Raspbian;  dans le cas d'OSMC, la béquille est écrite en python, et dans le cas de Volumio, en js ou bash.  Mais dans les deux cas, cela ne fonctionne toujours pas comme nous le souhaiterions. <br>  <b>**</b> pour OSMC et Volumio, ce sont des paramètres très importants, car tous ces tap-scrolls doivent être effectués à chaque fois que vous allumez la colonne.  Pour RPi-Radio, ce paramètre, bien que minimal, n'est toujours pas si important, car la colonne commence à jouer d'elle-même lorsqu'elle est allumée. <br>  <b>*** Je</b> veux dire la connexion physique du moniteur, du clavier et de la souris au Raspberry Pi lui-même, c'est-à-dire  ces cas où il n'y a aucun moyen de contourner l'interface Web intégrée ou la connexion ssh. <br><br><div class="spoiler">  <b class="spoiler_title">Sous ce spoiler se trouve une explication détaillée de chacun des points de comparaison.</b> <div class="spoiler_text"> Un temps de démarrage de 20 secondes est, à mon avis, le minimum qui peut être atteint sans plonger dans les déserts d'optimisation de Raspbian pour ce projet.  C'est le temps qu'il faut au Malinka pour charger le système d'exploitation et démarrer le service mpd.  Probablement, ce résultat peut être amélioré si vous remplacez microSDHC par microSDXC avec une vitesse de lecture / écriture plus élevée (je vérifierai si possible).  Étonnamment, Volumio, se faisant passer pour léger et agile, prend plus de temps à charger que la moissonneuse-batteuse OSMC.  45 secondes d'attente sont au-delà du seuil de fonctionnement confortable, et c'était la principale raison de quitter Volumio. <br><br>  La lecture automatique est présente dans mpd hors de la boîte, je n'ai rien eu à faire pour l'activer - commodément!  Dans Volumio, bien qu'il s'agisse d'un wrapper mpd, cette fonction a été étranglée pour un beau son de salutation.  Comme je l'ai déjà écrit, vous pouvez créer un script et le mettre en démarrage.  La situation est similaire pour OSMC. <br><br>  OSMC a la plupart de l'interaction des utilisateurs via le moniteur: il y a une belle interface, la possibilité de regarder des vidéos, des photos, de lire des nouvelles et de regarder la météo - il y a beaucoup de choses que ma chronique ne fera jamais de ma vie. <br><br>  Mais la gestion Web d'OSMC est très limitée, et vous ne pouvez même pas configurer à distance la liste de vos stations préférées dans le plug-in Radio - uniquement via le moniteur.  Chez Volumio - au contraire, tout se fait uniquement via l'interface web.  La modification de la liste des stations est plus pratique dans le navigateur sur le bureau / ordinateur portable, mais elle est également possible sur le smartphone si vous le souhaitez.  Avec RPi-Radio, vous ne pouvez sélectionner qu'une station et régler le son via l'interface Web.  La liste des stations, et en effet tout le reste doit être fait via la console via ssh.  La liste des stations est la plus difficile: si OSMC et Volumio ont leurs propres bibliothèques complètes de stations de radio Internet, alors dans RPi-Radio j'ai dû saisir manuellement les adresses de mes stations préférées au format JSON.  Inconvénient, mais seulement une (ou plusieurs) fois dans une vie. <br><br>  Avec la configuration initiale, OSMC est le pire.  Vous devez d'abord connecter un moniteur à la "framboise" et configurer le plugin Radio, puis vous devez configurer la sortie audio vers le DAC IQAudio externe (le même que celui de la carte Suptronics X400) via la console ou via ssh.  RPi-Radio a la même configuration DAC, mais au moins tout le reste se fait via ssh aussi.  Le leader dans cette catégorie, bien sûr, est Volumio - pour produire du son via un DAC externe, il vous suffit de sélectionner l'élément approprié dans la liste déroulante du menu des paramètres.  Il y a une comparaison même sur le site officiel de Suptronics (http://www.suptronics.com/xseries/x400.html) <br><br>  L'interface graphique de RPi-Radio est une simple page Web implémentée sur React.js.  La partie serveur, qui est responsable de l'interaction entre l'interface graphique client et mpd, s'exécute sur Node.js et est un simple serveur HTTP et WebSocket basé sur la connexion <code>express</code> <code>Socket.io</code> + <code>http</code> +.  Il s'exécute sur Raspbian en tant que service lorsque le système est mis sous <code>mpc-js</code> immédiatement après le démarrage du service mpd et utilise le module <code>mpc-js</code> pour contrôler mpd.  L'interface graphique client est accessible à n'importe quel navigateur sur mon réseau domestique simplement par ip ou nom d'hôte "framboise".  Parfait. <br></div></div><br>  Les sources RPi-Radio sont publiées sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Github</a> .  Dans le même référentiel, dans les brunchs correspondants, vous pouvez trouver les deux adaptations GUI pour travailler avec OSMC et Volumio. <br><br>  Le résultat de mes exercices, RPi-Radio, dépasse le cadre d'un simple ajout à une seule colonne.  Il s'agit d'une sorte de solution prête à l'emploi qui transforme non seulement le Raspberry Pi en récepteur radio Internet, mais également tout appareil avec sortie audio, accès Internet et possibilité d'exécuter mpd et Node.js.  Le principal avantage d'un tel système est le manque de tout ce qui est superflu.  En fait, comme cela a été fait dans Sonos, dans l'idéal que je m'efforce d'atteindre. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr410227/">https://habr.com/ru/post/fr410227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr410217/index.html">Soyez en bonne santé! Avec l'Internet des objets ...</a></li>
<li><a href="../fr410219/index.html">Huit battements: à propos des sons dans les anciens jeux</a></li>
<li><a href="../fr410221/index.html">Choisir un projecteur de cinéma maison</a></li>
<li><a href="../fr410223/index.html">Un mineur de New York contraint de déconnecter son équipement en raison d'interférences avec le réseau T-Mobile</a></li>
<li><a href="../fr410225/index.html">Demandez à Ethan: la lumière se déplace-t-elle toujours à la même vitesse?</a></li>
<li><a href="../fr410229/index.html">Une faible activité physique a été associée à un tissu nerveux affaibli et à un risque de démence.</a></li>
<li><a href="../fr410231/index.html">La faible lumière la rend plus bête et le scintillement guérit l'Alzheimer à la bonne fréquence</a></li>
<li><a href="../fr410233/index.html">Valery Litvin, CTO cyber • Fund, «Blockchain. Le manque de modèles est une introduction populaire à la technologie de la blockchain et à la cryptoéconomie »</a></li>
<li><a href="../fr410235/index.html">Un passionné risque 15 mois de prison pour avoir extrait gratuitement des CD Dell Restore</a></li>
<li><a href="../fr410237/index.html">Les parents ne doivent pas espionner leurs enfants</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>