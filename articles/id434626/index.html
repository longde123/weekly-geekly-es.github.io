<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòé üïî üë®üèæ‚Äçüéì Pengunduh Buhtrap Baru üë©üèø‚Äçü§ù‚Äçüë©üèΩ üë¥üèø üëâ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari ini kami akan memberi tahu Anda tentang pendekatan baru untuk mengirim malware ke grup Buhtrap. 



 Modul bootloader 
 Pada tanggal 19 Desember,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengunduh Buhtrap Baru</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bizone/blog/434626/">  Hari ini kami akan memberi tahu Anda tentang pendekatan baru untuk mengirim malware ke grup Buhtrap. <br><br><img src="https://habrastorage.org/webt/sn/u8/a1/snu8a1cvx8zvuttb34taqxmyoxi.png"><br><br><h3>  <font color="#4169E1">Modul bootloader</font> </h3><br>  Pada tanggal 19 Desember, kami mengetahui adanya surat berbahaya yang berisi file yang dapat dieksekusi ( <i>md5: faf833a1456e1bb85117d95c23892368</i> ).  File tersebut mengambil berbagai nama: "Rekonsiliasi untuk December.exe", "Documents wednesday.exe", "Dokumen 19.12.exe", "Menutup dokumen wednesday.exe". <br><br>  Dari menarik - file ini ditulis dalam. Net, yang tidak khas untuk kelompok kriminal ini.  Untuk mendekompilasi .Net, Anda dapat menggunakan perangkat lunak apa pun: <b>Reflektor</b> , <b>dotPeek</b> , <b>dnSpy</b> , <b>ILSpy</b> .  Dalam artikel ini kita akan berbicara tentang fitur implementasi file ini dan bagaimana kita menganalisanya. <br><a name="habracut"></a><br><h3>  <font color="#4169E1">Inspeksi awal bootloader</font> </h3><br>  Untuk analisis, kami menggunakan <b>dnSpy</b> , dan semua tangkapan layar lebih lanjut akan berasal dari itu. <br>  Karena kebiasaan, buka executable di <b>IDA Pro</b> dan lihat bagian impor.  Contoh: <br><br><img src="https://habrastorage.org/webt/6n/ks/r-/6nksr-jvgkh8kj5kerx7erkx13w.png"><br><br>  Kehadiran beberapa fungsi menunjukkan adanya muatan yang dikemas ( <b>LoadCursorW</b> , <b>LoadIconW</b> - dapatkan objek dari sumber daya, <b>VirtualProtect</b> - mengubah atribut halaman, lalu Anda dapat menjalankan kode) dan anti-debugging sederhana ( <b>IsDebuggerPresent</b> ).  Tapi semuanya ternyata lebih sederhana.  Eksekusi bahkan tidak mencapai IsDebuggerPresent, dan LoadCursorW dan LoadIconW tidak berguna karena mereka mencoba mengakses sumber daya yang tidak ada (LoadCursorW dari " <i>fiza</i> " dan LoadIconW dari " <i>saxikulatebutohutejijobododore</i> "): <br><br><img src="https://habrastorage.org/webt/gp/ye/vf/gpyevft3j2j5-vzaeg87-o9tczw.png"><br><br><img src="https://habrastorage.org/webt/lo/kq/ic/lokqicp7awjfseefk3gnouqs3p0.png"><br><br>  Tetapi kembali ke dekompiler <b>dnSpy</b> .  Dalam file yang dapat dieksekusi, kami melihat sejumlah besar kode yang tidak dikelola: <br><br><img src="https://habrastorage.org/webt/n1/og/k_/n1ogk_upsf-5baxmk9q04-8tsyw.png"><br><br>  Untuk memahami kode yang tidak dikelola dalam file yang sedang diselidiki, kami akan menggunakan IDA Pro.  Cara termudah adalah dengan melihat isi kode yang tidak dikelola dalam bentuk hex.  Untuk melakukan ini, buka Offset File offset.  Menggunakan fungsi <b>_main ()</b> sebagai contoh: <br><br><img src="https://habrastorage.org/webt/-4/5p/81/-45p816dvsaj7whinkl7ctkaj8u.png"><br><br><img src="https://habrastorage.org/webt/vr/mf/ua/vrmfua0qkoqgqfcqvwzgj3rl_qc.png"><br><br>  Selanjutnya, di <b>IDA Pro, kami</b> akan mencari berdasarkan hex-sequence: <br><br><img src="https://habrastorage.org/webt/ro/hh/oy/rohhoylitba4gnuxygzn9bs_pes.png"><br><br>  Pada output, kita mendapatkan fungsi _main () yang tidak dikelola, yang dengannya Anda dapat dengan mudah bekerja dengan bantuan dekompiler idov: <br><br><img src="https://habrastorage.org/webt/zv/gs/pc/zvgspc2az6zmnuymfakhjy8tc0e.png"><br><br><img src="https://habrastorage.org/webt/ef/ea/sz/efeaszcwmkc-dpzpm_sl-dfjuk0.png"><br><br><h4>  Menerima payload </h4><br>  Kembali ke dnSpy.  Perhatian ditarik ke data <b>payloadData</b> . <br><br><img src="https://habrastorage.org/webt/fk/sc/od/fkscodflcwfpqv91v780smb2h4c.png"><br><br><img src="https://habrastorage.org/webt/rm/xx/xd/rmxxxdvbwil4utycw3fd5romqci.png"><br><br>  Kami menemukan urutan ini di IDA Pro, dapatkan tautan ke sana, dan mengetahui bahwa panggilan tersebut terjadi hanya pada fungsi <b>_main ()</b> : <br><br><img src="https://habrastorage.org/webt/lm/2m/i7/lm2mi7e28qgrkqqtwbfenvkppls.png"><br><br>  Kode yang didekompilasi menggunakan buffer ini terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/u_/cw/1j/u_cw1jdwih4vxh7xx-2kb09fd5m.png"><br><br>  Fungsi-fungsi berikut bertanggung jawab untuk mengonversi buffer ini: <br><br><img src="https://habrastorage.org/webt/oc/tw/a6/octwa6li37592_dxbjjl5iw_vtu.png"><br><br>  Di sini, variabel <b>holdrand diinisialisasi</b> ke <i>0xEA48CB16</i> dan fungsi <b>foo ()</b> dipanggil dalam loop untuk setiap byte dari <b>payloadData</b> ( <i>parameter c sbyte</i> ).  Perlu dicatat bahwa fungsi t () berasal dari kode yang tidak aman: jika Anda melihat kodenya, Anda dapat memastikan bahwa selalu mengembalikan <i>0x343FD</i> . <br><br>  Kami mempersenjatai diri dengan IDA Pro dan, melihat buffer yang dibongkar, kami melihat bahwa itu berisi beberapa kode di awal: <br><br><img src="https://habrastorage.org/webt/sf/5r/wu/sf5rwudeoqmxkcs-kcrrk5hskcg.png"><br><br>  Pada offset <i>0x15A0</i> dari awal buffer, file yang dapat dieksekusi terletak: <br><br><img src="https://habrastorage.org/webt/4y/ul/fa/4yulfappi52yhaucx3iuy2je-tc.png"><br><br>  Simpan untuk analisis nanti. <br><br>  Nah, dalam kode yang dapat dieksekusi itu sendiri, hal yang agak sepele diimplementasikan.  Pertama, struktur berikut terbentuk (di <i>sini mz_base adalah alamat offset dalam buffer dengan PE yang dibongkar, dan bidang yang tersisa adalah alamat fungsi yang diperlukan dan pegangan perpustakaan</i> ): <br><br><img src="https://habrastorage.org/webt/em/tx/2x/emtx2xx3rpongt81rdkgqenspt8.png"><br><br>  Dan kemudian, menggunakan fungsi yang diperoleh, proses dari file yang dapat dieksekusi yang sama dibuat ( <i>md5: faf833a1456e1bb85117d95c23892368</i> ), dan executable yang tidak dibongkar dipetakan ke alamat virtual dari proses baru.  Setelah mengubah alamat instruksi yang dapat dieksekusi ( <b>GetThreadContext</b> dan bundel <b>SetThreadContext</b> ), utas proses baru dimulai, dan proses induk itu sendiri terbunuh. <br><br>  Nah, sekarang kita beralih ke analisis file executable yang dihasilkan (payload). <br><br><h3>  <font color="#4169E1">Bongkar Muat</font> </h3><br>  Payload ( <i>md5 dump: d8f40c7060c44fab57df87ab709f058f</i> ) juga ditulis di .Net Framework. <br><br>  Untuk melindungi dari analisis statis dan dinamis, pengembang <b>malware</b> menggunakan pelindung <b>ConfuserEx</b> populer terbaru: <br><br><img src="https://habrastorage.org/webt/75/ui/tb/75uitbdw5gznezlw4flyzx4c6-e.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ConfuserEx</a> adalah pelindung open source yang mapan. <br><br><h3>  <font color="#4169E1">Pembongkaran primer</font> </h3><br>  Titik masuk file yang dilindungi oleh pelindung ini adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/xc/fk/sr/xcfksree6xb2nl7l3sg-nn1dsqg.png"><br><br>  Setelah dekripsi, array byte dimuat ke dalam memori dalam bentuk modul yang disebut <b>koi</b> .  Kemudian metode utama modul ini ditentukan dan dipanggil.  Pada platform .Net, metode atau konstruktor dalam sebuah modul dapat diperoleh dari token metadata dengan memanggil fungsi <b>Module.ResolveMethod ()</b> .  Untuk mentransfer kontrol ke metode yang diperoleh, fungsi <b>MethodBase.Invoke ()</b> digunakan. <br><br><img src="https://habrastorage.org/webt/-s/1n/xo/-s1nxo2iy6mgehse3asimugo_ra.png"><br><br>  Kode yang dapat dieksekusi dalam modul <b>koi</b> adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/fp/cj/9v/fpcj9viyn46punvfce7grleeati.png"><br><br>  Untuk menghapus tapak, kami menggunakan utilitas berikut: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github.com/cawk/ConfuserEx-Unpacker</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github.com/0xd4d/de4dot</a> </li></ul><br>  <b>ConfuserEx-Unpacker</b> mendekripsi baris dan kode di dalam metode, dan <b>de4dot</b> membuat nama metode dapat dibaca. <br><br>  Hasilnya adalah kode yang cocok untuk analisis statis: <br><br><img src="https://habrastorage.org/webt/5p/_c/yx/5p_cyxuqhky7vndvuh0htnkkzp4.png"><br><br>  Tentu saja, kami beruntung mendapatkan kode yang dapat dibaca.  Penulis virus dapat memodifikasi kode sumber untuk tapak <b>ConfuserEx</b> untuk lebih mempersulit analisis. <br>  Masih ada dua masalah yang harus diselesaikan untuk analisis file yang nyaman. <br><br><h4>  Masalah 1 </h4><br>  Setelah menghapus tapak, decompiler tidak dapat menguraikan beberapa metode.  Sebagai contoh: <br><br><img src="https://habrastorage.org/webt/uj/xm/h4/ujxmh4ivlwt0fm7w0xzkig5lu_k.png"><br><br>  Jika Anda beralih ke kode-IL, Anda akan melihat panggilan di pointer nol: <br><br><img src="https://habrastorage.org/webt/5b/pw/is/5bpwismvu1l9gt6bktnrpvoxlya.png"><br><br>  Untuk memperbaiki kesalahan dekompilasi, ganti instruksi yang salah dengan instruksi nop.  (Utilitas <b>dnSpy</b> memungkinkan <b>Anda</b> untuk memodifikasi kode dekompilasi dan kode IL.) <br>  Setelah penggantian, kode yang didekompilasi terlihat benar: <br><br><img src="https://habrastorage.org/webt/gy/zi/8l/gyzi8lglspniec_imqi-uauacz4.png"><br><br>  Mengubah kode-IL dalam semua metode yang bermasalah, kami mendapat file yang sepenuhnya terurai. <br><br><h4>  Masalah 2 </h4><br>  File yang dihasilkan tidak mungkin untuk memulai, dan ini mengecualikan kemungkinan analisis dinamis.  Untuk mengatasi masalah ini, Anda harus menentukan token metode input dalam struktur file yang dapat dieksekusi. <br><br>  Anda dapat menemukannya di salah satu dari dua cara: <br><br><ul><li>  lihat di bawah debugging dengan parameter mana fungsi dipanggil </li></ul><br>  <b>Module.ResolveMethod ()</b> sebelum membongkar file: <br><br><img src="https://habrastorage.org/webt/1y/vt/ex/1yvtexa_v0psvugzbzwla1ow4zq.png"><br><br><ul><li>  di file yang belum dibongkar cari metode dengan label <b>[STAThread]</b> : </li></ul><br><img src="https://habrastorage.org/webt/xr/an/wi/xranwidrui8z1gmkbc23c84ibpg.png"><br><br>  Dalam hal ini, token metadata untuk metode input adalah <i>0x6000106</i> .  Kami mengubahnya menggunakan utilitas <b>CFF Explorer</b> : <br><br><img src="https://habrastorage.org/webt/ad/7u/xp/ad7uxpajjbfh1gzvdqgaj8kw3oc.png"><br><br>  Setelah menyimpan perubahan, file yang sudah dibuka mulai dan mendebug dengan benar. <br><br><h3>  <font color="#4169E1">Analisis bootloader</font> </h3><br>  Segera setelah mulai bekerja, bootloader memeriksa apakah sedang berjalan di lingkungan virtual. <br>  Berjalan di bawah <b>VMWare</b> atau <b>QEMU</b> ditentukan dengan mencari substring "vmware" dan "qemu" dalam nilai registri berikut: <br><br><ul><li>  [HKLM \ System \ CurrentControlSet \ Services \ Disk \ Enum \ 0]. </li></ul><br>  Jika mesin virtual terdeteksi, bootloader menampilkan pesan jendela yang sesuai: <br><br><img src="https://habrastorage.org/webt/wt/pw/lz/wtpwlzmwrcfsghc-bgib6fw0kru.png"><br><br>  Menariknya, output dari pesan ini tidak mempengaruhi operasi proses. <br><br>  Setelah itu, malware mencoba memuat pustaka dari daftar berikut ke dalam memori: <b>SbieDll.dll, dbghelp.dll, api_log.dll, dir_watch.dll, pstorec.dll, vmcheck.dll, wpespy.dll, snxhk.dll, guard32.dll</b> . <br><br>  Selain itu, dengan menggunakan panggilan ke fungsi <b>Debugger.IsLogging ()</b> dan <b>Debugger.get_IsAttached ()</b> , loader memeriksa apakah ia berjalan di bawah debugger. <br>  Jika setidaknya salah satu pustaka memuat dengan sukses atau loader mendeteksi bahwa ia berjalan di bawah debugger, itu akan <i>menghapus</i> sendiri menggunakan perintah " <i>cmd / C ping 8.8.8.8 -n 1 -w 3000&gt; Nul &amp; Del</i> ".  Menariknya, bootloader dapat menghapus sendiri bahkan pada sistem nyata dengan memuat pustaka <b>dbghelp.dl</b> . <br><br>  Selanjutnya, malware memeriksa apakah diluncurkan dari direktori yang berisi substring "Mozilla". <br><br><h4>  Jika prosesnya tidak dimulai dari direktori yang berisi substring "Mozilla" </h4><br><ul><li>  VPO membentuk daftar direktori yang terletak di desktop dan berisi substring berikut (semua baris di dalam bootloader dienkripsi menggunakan algoritma AES-256-ECB, kunci enkripsi dihasilkan menggunakan kata sandi yang dikodekan dengan keras): </li></ul><br><img src="https://habrastorage.org/webt/5f/xj/cb/5fxjcbvohua3udy6wiwixj3kwmo.jpeg"><br><br><ul><li>  Menghasilkan daftar URL dari riwayat browser yang berisi substring berikut: </li></ul><br><img src="https://habrastorage.org/webt/tc/ra/lh/tcralhf4zikmr0z5egouejvwafw.jpeg"><br><br><ul><li>  Menghasilkan daftar file yang terletak di direktori "% UserProfile% \\ Desktop", "% AppData%", "C: \\ Program Files (x86)", "C: \\ Program Files (x86) (x86)" dan memiliki nama-nama berikut: </li></ul><br><img src="https://habrastorage.org/webt/g5/5a/4k/g55a4keejjvjzv0jjdto5cs1fgw.jpeg"><br><br><ul><li>  Menghitung jumlah daftar tidak kosong dari indikator yang terkait dengan operasi perbankan (dalam versi saat ini dari bootloader, fungsi ini tidak mempengaruhi apa pun). </li><li>  Membuat tugas untuk menjalankan file ini setiap kali pengguna login menggunakan perintah "schtasks / create / f / sc ONLOGON / RL TERTINGGI / tn LimeRAT-Admin / tr". </li><li>  Jika tugas tidak dapat dibuat, buat pintasan "% AppData% \\ Microsoft \\ Windows \\ Start Menu \\ Program \\ Startup \\ MozillaUpdate.lnk", yang menunjukkan "% Appdata% \\ Mozilla \\ xaudiodg.exe" , yang memastikan bahwa file xaudiodg.exe diluncurkan setiap kali sistem dihidupkan ulang. </li><li>  Ini menyalin dirinya di sepanjang jalan "% AppData% \\ Mozilla \\ xaudiodg.exe". </li><li>  Menghapus file &lt;self_path&gt;: Zone.Identifier, menjalankan xaudiodg.exe dan menghapus sendiri. </li></ul><br><h4>  Jika proses dimulai dari direktori yang berisi substring "Mozilla" </h4><br><ul><li>  Malware juga mencari indikator operasi perbankan di atas dalam sistem yang terinfeksi. </li><li>  Mengumpulkan informasi sistem lainnya untuk dikirim ke server manajemen. </li><li>  Dalam utas terpisah mengirim informasi ke C&amp;C dan menunggu respons dari server. </li><li>  Di utas lain, ia mengirimkan string terenkripsi "PING?" Ke server dalam satu lingkaran tanpa akhir. </li></ul><br><h3>  <font color="#4169E1">Interaksi Server Manajemen</font> </h3><br>  Alamat IP server dalam sampel malware yang diuji adalah 213.252.244 [.] 200.  Koneksi diinisialisasi oleh port yang dipilih secara acak dari daftar: <br><br>  ‚Ä¢ 8989, <br>  ‚Ä¢ 5656, <br>  ‚Ä¢ 2323. <br><br>  Segera setelah koneksi diinisialisasi, bootloader mengirimkan informasi tentang sistem yang terinfeksi ke C&amp;C: <br><br>  ‚Ä¢ ID pengguna, <br>  ‚Ä¢ nama pengguna <br>  ‚Ä¢ versi OS, <br>  ‚Ä¢ versinya sendiri (loader v0.2.1), <br>  ‚Ä¢ daftar indikator operasi perbankan yang ditemukan pada sistem yang terinfeksi. <br><br>  Contoh garis yang dikirim oleh loader ke server manajemen: <br><br><pre><code class="xml hljs">¬´INFO<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>9D3A4B22D21C<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>IEUser<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span> Windows 7 Enterprise SP 1 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>loader v0.2.1<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>1c, ¬ª</code> </pre> <br><br>  Baris ini akan dikirim jika ada folder "1c" di desktop pengguna yang terinfeksi, dan tidak ada indikator lain. <br>  Fungsi untuk memproses respons dari server adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/o7/a0/qj/o7a0qjtcivxuursy_coehrz0lds.png"><br><br>  Respons yang didekripsi dari server adalah sebagai berikut: <br><br><ul><li><pre> <code class="xml hljs">COMMAND<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>DATA1<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>DATA2<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NYANxCAT</span></span></span><span class="hljs-tag">&gt;</span></span>‚Ä¶</code> </pre> </li></ul><br>  Seperti yang dapat dilihat dari tangkapan layar, COMMAND dapat mengambil salah satu dari nilai berikut: <br><br><ul><li>  <b>TUTUP</b> - mengakhiri koneksi dan menutup proses saat ini; </li><li>  <b>DW</b> - menerjemahkan konten base64 dari DATA2, menulisnya ke file &lt;temp_file_name&gt; dengan ekstensi dari DATA1, dan meluncurkan file untuk dieksekusi; </li><li>  <b>UPDATE</b> - menerjemahkan konten base64 dari DATA1, menulisnya ke file dengan nama &lt;temp_file_name&gt; dan ekstensi .exe, meluncurkan file yang dapat dieksekusi baru dan membersihkannya sendiri; </li><li>  <b>RD-</b> - mengirimkan string "RD-" sebagai respons; </li><li>  <b>RD +</b> - mengirim tangkapan layar ke server manajemen; </li><li>  DEL - hapus sendiri. </li></ul><br>  Selama penyelidikan bootloader, kami berhasil mendapatkan perintah DW dari server penyerang.  Sebagai akibatnya, perangkat lunak Punto Switcher diinstal dengan DLL winmm.dll berbahaya (md5: 9d25553bb09e2785262b2f7ba7923605), yang merupakan modul spyware Buhtrap. <br><br>  TCP Stream adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/3c/su/h_/3csuh_fjfjm6hs4g9tt0ngql5qa.png"><br><br><img src="https://habrastorage.org/webt/mj/bw/uv/mjbwuvakfsdnak_k8lhfvtsht6o.png"><br><br>  Untuk mengenkripsi data yang dikirimkan antara klien dan server manajemen, <b>algoritma AES-128-ECB</b> digunakan.  Kunci enkripsi diinisialisasi dengan kata sandi hard-coded. <br><br>  Setelah dekripsi, lalu lintas adalah sebagai berikut: <br><br><img src="https://habrastorage.org/webt/yp/-z/-8/yp-z-8jb5walz17xs-rozjatzjw.png"><br><br><img src="https://habrastorage.org/webt/lw/kg/ni/lwkgniohrsvqexvxamrwogmcmgy.png"><br><br>  Dari base64, penginstal NSIS diterjemahkan dengan konten berikut: <br><br><img src="https://habrastorage.org/webt/nx/fe/ij/nxfeijizxvvy4agsiobhqeil9tu.png"><br><br>  Menariknya, server merespons, meskipun daftar indikator perbankan kosong. <br><br><h3>  <font color="#4169E1">DLL berbahaya</font> </h3><br>  Pustaka <b>winmm.dll</b> dieksekusi menggunakan teknik pembajakan dll.  Modul berbahaya mengirim informasi tentang sistem yang terinfeksi dan daftar pembaca kartu pintar yang aktif ke C&amp;C.  Selain itu, ia memiliki komponen keylogger dan dapat menerima modul berbahaya lainnya dari server pengelola, jalankan dari disk atau dalam memori proses saat ini.  C &amp; C-server dari sampel yang diteliti berada di alamat berikut: <br><br><ul><li>  hxxp: // my1cprovider [.] xyz: 6060 / klog [.] php </li><li>  hxxp: // tinderminderorli1999 [.] xyz: 7764 / klog [.] php </li></ul><br><h3>  <font color="#4169E1">Kesimpulan</font> </h3><br>  Proses infeksi dapat direpresentasikan sebagai skema berikut: <br><br><img src="https://habrastorage.org/webt/r8/ho/0e/r8ho0ecv5utwzrjykx0yg4jrpuk.png"><br><br>  Terlepas dari perlindungan yang baik terhadap analisis, jelas bahwa saat ini bootloader tidak berfungsi dengan benar dan kemungkinan besar dalam proses pengembangan: <br><br><ul><li>  dapat menghapus sendiri bahkan pada sistem nyata; </li><li>  memeriksa koneksi sistem yang terinfeksi dengan operasi perbankan sebelum menyalin dirinya sendiri ke ‚Äú% AppData% \\ Mozilla \\ xaudiodg.exe‚Äù dan sebelum berinteraksi dengan C&amp;C, tetapi tidak menggunakan informasi ini dengan cara apa pun. </li></ul><br>  Akhirnya, ingat pesan jendela aneh.  Menariknya, apakah ini cacat pada pengembang - atau itu dilakukan secara khusus untuk mendorong pengguna meninggalkan lingkungan virtual dan mulai menggunakan mesin nyata?  Selamat datang di komentar. <br><br><h3>  <font color="#4169E1">IOC</font> </h3><br>  <b>MD5:</b> <br><br>  <i>faf833a1456e1bb85117d95c23892368</i> <i><br></i>  <i>9d25553bb09e2785262b2f7ba7923605</i> <br><br>  <b>URL:</b> <br><br>  hxxp: // my1cprovider [.] xyz: 6060 / klog [.] php <br>  hxxp: // tinderminderorli1999 [.] xyz: 7764 / klog [.] php <br>  IP: <br>  213.252.244 [.] 200 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id434626/">https://habr.com/ru/post/id434626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id434616/index.html">Soviet HI-FI dan penciptanya: rekaman suara digital di Uni Soviet - satu langkah lagi dari kemenangan</a></li>
<li><a href="../id434618/index.html">MVP dan Belati 2 - Kerangka Aplikasi Android - Bagian 2</a></li>
<li><a href="../id434620/index.html">Buat air terjun penuh gaya dari RiME langsung di Unity atau UE4</a></li>
<li><a href="../id434622/index.html">Dunia apa yang bisa bertahan hidup setelah kematian matahari?</a></li>
<li><a href="../id434624/index.html">Bagaimana saya menemukan bug di GNU Tar</a></li>
<li><a href="../id434628/index.html">bitContainer (untuk makanan) - Yandex buatan rumah. Stasiun</a></li>
<li><a href="../id434634/index.html">Peretas Radio Universal - Cara Mudah Menjelajahi Protokol Radio Digital</a></li>
<li><a href="../id434636/index.html">Bagaimana cara mengeksploitasi anak-anak</a></li>
<li><a href="../id434638/index.html">Peluncuran roket dari Timur dengan mata kepala Anda sendiri</a></li>
<li><a href="../id434640/index.html">Mengapa validasi email biasa tidak cukup. Memvalidasi catatan MX dengan contoh dalam PHP dan Ruby</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>