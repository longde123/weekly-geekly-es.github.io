<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§± üëë üë© √âvaluation de Cavium ThunderX2: le r√™ve du serveur Arm se r√©alise (Partie 1, Introduction) üöß üíï üò≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a moins de deux ans, nous avons explor√© le premier serveur Arm SoC, qui pourrait th√©oriquement rivaliser avec le Intel Xeon E5s - Cavium ThunderX...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√âvaluation de Cavium ThunderX2: le r√™ve du serveur Arm se r√©alise (Partie 1, Introduction)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/413885/"> Il y a moins de deux ans, nous avons explor√© le premier serveur Arm SoC, qui pourrait th√©oriquement rivaliser avec le Intel Xeon E5s - Cavium ThunderX.  Le serveur SoC a d√©montr√© tout ce qui avait √©t√© annonc√©, cependant, en raison des faibles performances monofilaires et des difficult√©s d'optimisation des performances √©nerg√©tiques, le SoC √† 48 c≈ìurs a √©t√© affect√© √† des march√©s de niche.  En cons√©quence, le premier serveur Cavium SoC n'a jamais pu rivaliser avec le Xeon d'Intel. <br><br><img src="https://habrastorage.org/webt/x6/z7/5j/x6z75jaf9myymohvcozvis4hahg.jpeg"><br><br>  Mais Cavium n'a pas abandonn√© pour des raisons √©videntes: pour le moment, le march√© des serveurs est devenu plus attractif que jamais.  Les centres de donn√©es du g√©ant mondial Intel g√©n√®rent des revenus d'environ 20 milliards de dollars am√©ricains (!) Par an.  De plus, la rentabilit√© est de 50%.  En termes de profit et de chiffre d'affaires, le march√© des serveurs est bien plus important que tout autre march√© d'√©quipement.  Ainsi, apr√®s le lancement de ThunderX, Cavium a promis de publier une deuxi√®me it√©ration: une gestion de l'alimentation am√©lior√©e, des performances am√©lior√©es sur un seul thread et encore plus de c≈ìurs (54). <br><a name="habracut"></a><br>  Ce qui ne joue pas entre les mains de Cavium, c'est que si l'utilisateur a besoin d'un serveur, il peut simplement prendre une machine Intel fiable et d√©bogu√©e.  En effet, les promesses fortes d'Arm, Calxeda, Broadcom, AppliedMicro au cours des 5 derni√®res ann√©es sont rest√©es des promesses, provoquant une s√©rieuse vague de scepticisme et de m√©fiance et l'√©mergence de nouveaux SoCs Arm Server. <br><br>  N√©anmoins, la nouvelle cr√©ation d'un Cavium ext√©rieur m√©rite l'attention.  Un certain nombre de modifications ont √©t√© apport√©es, pas seulement l'ajout du num√©ro ¬´2¬ª au nom: Cavium a achet√© la conception Vulcan d'Avago.  Vulcan est un processeur assez ambitieux, d√©velopp√© √† l'origine par l'√©quipe SoC Broadcom du serveur Arm, et a un h√©ritage beaucoup plus important que le ThunderX d'origine.  De plus, sur la base de son exp√©rience avec ThunderX, Cavium a pu introduire quelques am√©liorations microarchitecturales dans la conception Vulcan, am√©liorant ses performances et sa puissance. <br><br>  En cons√©quence, ThunderX2 s'est av√©r√© √™tre un noyau plus √©labor√© que la g√©n√©ration pr√©c√©dente.  Le noyau ThunderX avait un pipeline tr√®s court et √©tait peu susceptible de r√©sister √† deux instructions par cycle, mais le noyau Vulcan est con√ßu pour 8 r√©cup√©rations et ex√©cutant jusqu'√† 4 instructions par cycle.  Et encore plus: les 4 flux (SMT4) peuvent √™tre actifs en m√™me temps, fournissant un chargement back-end constant.  Le nouveau ThunderX2 SoC32 dispose de 32 c≈ìurs de ce type avec une fr√©quence allant jusqu'√† 2,5 GHz. <br><br><img src="https://habrastorage.org/webt/nt/nl/7a/ntnl7apffv6jkwh6k1v_aoqptae.png"><br><br>  Avec jusqu'√† 128 threads et au moins huit contr√¥leurs DDR4, ce CPU devrait bien fonctionner dans toutes les charges de serveur.  En d'autres termes, contrairement √† ThunderX (1), ThunderX2 est le premier processeur de serveur Arm et a toutes les chances de briser l'√©quilibre sur le march√© des serveurs. <br><br><h2>  Qui a plus: sp√©cifications </h2><br>  Trente-deux c≈ìurs IPC √©lev√©s dans un m√™me bo√Ætier semblent prometteurs.  Mais √† quoi ressemble le nouveau ThunderX2 par rapport aux produits AMD, Qualcomm et Intel?  Dans le tableau ci-dessous, nous comparons les sp√©cifications de plusieurs r√©f√©rences de serveur haut de gamme. <br><br><img src="https://habrastorage.org/webt/p3/hv/fx/p3hvfxp0iatr1ockmnjx9xm8xp8.png"><br><br>  Les lecteurs avertis remarqueront imm√©diatement que le haut de la gamme de processeurs Intel est le Xeon Platinum 8180. Cependant, ce SKU avec 205 W TDP et un prix sup√©rieur √† 10 000 $ n'est g√©n√©ralement pas comparable √† n'importe quel processeur de la liste.  Nous avons d√©j√† presque d√©pass√© la ligne de raison, y compris 8176, qui, comme il nous semble, tombe dans cette liste en fonction des param√®tres de la SKU maximale des blocs noyau / thread.  En fait, Cavium positionne le Cavium 9980 comme ¬´comparable¬ª au Xeon Platinum 8164 (et Intel joue ce r√¥le 8176), mais avec des fr√©quences l√©g√®rement plus basses. <br><br>  Cependant, en termes de performances pour le dollar, Cavium compare son produit phare 9980 avec Intel Xeon Gold 6148, et dans ce cas, le prix du processeur Cavium semble assez app√©tissant.  Selon les r√©sultats des tests, le ThunderX2 le plus rapide a 30 √† 40% d'avance sur le Xeon 6148, tandis que l'offre de Cavium est 1300 $ moins ch√®re.  Cette tarification agressive explique les rumeurs selon lesquelles Qualcomm ne va pas entrer sur le march√© des serveurs. <br><br>  Les donn√©es du tableau ci-dessus montrent d'importantes diff√©rences entre les concurrents.  Intel semble avoir la topologie de base la plus avanc√©e et la vitesse turbo la plus √©lev√©e.  Qualcomm, quant √† lui, semble plus attrayant en termes de performances par watt. <br><br><img src="https://habrastorage.org/webt/no/2u/7-/no2u7-_oyjv6ol2vd6vqiartfks.png"><br><br>  Comme l'EPYC d'AMD, le ThunderX2 de Cavium est susceptible de briller sur le march√© de l'informatique haute performance (33% de d√©bit en plus, c≈ìurs / threads plus √©lev√©s).  Comme avec la conception d'AMD, le cache EPYC L3 est lent si vous avez besoin de donn√©es qui ne se trouvent pas dans l'emplacement de cache local de 8 Mo.  ThunderX2 est beaucoup plus complexe - avec une architecture √† double anneau similaire √† l'architecture en anneau Xeon v4 (Broadwell-EP).  Selon les informations de Cavium, leur architecture non bloquante en anneau est capable de fournir des d√©bits allant jusqu'√† 6 To / s. <br><br>  Cette architecture en anneau est connect√©e √† l'interconnexion du processeur coh√©rent du Cavium (CCPI2 - en haut de la figure), qui fonctionne √† une vitesse de 600 Gbit / s.  Cette connexion connecte deux n≈ìuds socket / NUMA.  56 voies de SoC PCIe 3.0 sont connect√©es √† l'anneau, que Cavium a localis√© parmi 14 contr√¥leurs PCIe.  Ces 14 contr√¥leurs peuvent, √† leur tour, se ramifier en x4 ou x1, comme indiqu√© ci-dessous. <br><br><img src="https://habrastorage.org/webt/yw/e3/r8/ywe3r8nlwh9n0sjcobksmoeqf58.png"><br><br>  De plus, il prend en charge SR-IOV, qui est si important pour la virtualisation d'E / S (Xen et KVM). <br><br><h2>  ThunderX: de facile √† complexe </h2><br>  <b>Bref briefing.</b>  Le ThunderX d'origine √©tait une version am√©lior√©e d'Octeon III: un processeur capable d'ex√©cuter simultan√©ment deux instructions (core √† double √©mission) avec deux pipelines courts. <br><br><img src="https://habrastorage.org/webt/s_/vu/na/s_vunadz47iappsidwdpeuyjmhw.png"><br><br>  Un avantage de la conception originale de ThunderX est sa haute efficacit√© √©nerg√©tique, en particulier pour les charges de travail √† faible ILP (parall√©lisme au niveau de l'instruction).  Bien s√ªr, un convoyeur aussi court pose de s√©rieuses limites pour augmenter la fr√©quence d'horloge, et une conception simple garantit de faibles performances monothread √† des charges ILP moyennes et √©lev√©es, tandis que des processeurs hors service plus avanc√©s peuvent extraire autant de "parall√©lisme cach√©" que possible. ". <br><br><h3>  Le ¬´nouveau¬ª noyau du Cavium: Vulcan </h3><br><img src="https://habrastorage.org/webt/20/1j/9c/201j9c0fk3jebmf5cwxryqdxkva.png"><br><br>  Compar√© au ThunderX d'origine, le noyau du Vulcan ThunderX2 est une b√™te compl√®tement diff√©rente.  Annonc√© en 2014 par Broadcom, Vulcan est un noyau relativement volumineux qui contr√¥le 4 threads simultan√©s (SMT4).  Par cons√©quent, le back-end doit √™tre bien charg√© m√™me lorsque vous travaillez avec des charges de serveur avec un faible ILP. <br><br>  Pour garantir la stabilit√© de 4 flux SMT, le frontal ThunderX2 peut extraire jusqu'√† 64 octets d'un cache d'instructions associatif √† 8 voies de 32 Ko, qui est √©quip√© d'un simple pr√©filtre ¬´ligne suivante¬ª.  Cependant, le choix de 8 commandes n'est possible que s'il n'y a pas de branchement dans ces 64 octets.  Sinon, la s√©lection est interrompue √† la fourche. <br><br>  Cela signifie qu'en code de branchement intensif (bases de donn√©es, AI ...), le r√©cup√©rateur re√ßoit en moyenne ¬± 5 instructions par cycle, puisque l'une des 5 instructions est une branche.  Les instructions s√©lectionn√©es sont ensuite envoy√©es au tampon de lissage - un tampon dans lequel les instructions stock√©es sont stock√©es pour le d√©codage. <br><br><img src="https://habrastorage.org/webt/lt/4e/q4/lt4eq4bh57wresbzuf84layrak8.png"><br><br>  Ensuite, le d√©codeur fonctionne avec un ensemble de 4 instructions.  Entre le d√©codeur et la phase de renommage, chaque flux poss√®de un ¬´slip buffer¬ª, compos√© de 8 packs.  Avec 4 threads, jusqu'√† 32 paquets (128 instructions) peuvent √™tre mis en m√©moire tampon √† tout moment. <br><br>  Ces 4 instructions - le paquet - se d√©placent le long du pipeline jusqu'√† ce qu'une seule file de messages soit atteinte pour le planificateur.  Comme le Loop Stream Detector d'Intel (fonctionne comme un petit cache), il dispose √©galement d'un tampon de boucle et d'un pr√©dicteur.  Ce tampon de boucle √©limine les pr√©dictions de branchement incorrectes et contient des Œºops d√©cod√©s qui ¬´raccourcissent¬ª le pipeline et r√©duisent l'√©nergie utilis√©e pour le d√©codage. <br><br>  Jusqu'√† 6 instructions peuvent √™tre ex√©cut√©es √† la fois.  L'impl√©mentation comprend 2 emplacements ALU / FP / NEON, 1 emplacement ALU / tap, 2 emplacements de chargement / stockage (16 octets) et 1 emplacement de stockage propre qui envoie 16 octets au cache D.  Il existe un petit TLB L1 (Cavium ne r√©v√©lera pas combien) pour la commutation avec un retard nul des adresses virtuelles aux adresses physiques.  Il n'y a pas de pr√©fetcher mat√©riel pour le cache L1 D1, mais le cache L2 poss√®de un pr√©fetcher mat√©riel assez sophistiqu√© qui peut reconna√Ætre les mod√®les (il peut fonctionner √©tape par √©tape ou r√©cup√©rer la ligne suivante). <br><br>  C'est assez pour ¬´alimenter¬ª le back-end, qui peut prendre en charge 4 instructions par cycle √† partir de 4 threads diff√©rents. <br><br><h3>  Diff√©rences en microarchitecture </h3><br>  Cavium a publi√© une quantit√© limit√©e d'informations sur les c≈ìurs ThunderX2.  Certaines caract√©ristiques cl√©s de diverses architectures de processeur sont r√©sum√©es ci-dessous. <br><br><img src="https://habrastorage.org/webt/ud/di/rc/uddircouggaghevqdm5rtzgfrry.png"><br><br>  Une analyse d√©taill√©e d√©passe le cadre de cet article.  Mais vous pouvez lire les analyses de Johan De Gelas sur l'architecture de Falkor, Skylake et Zen dans AnandTech.  Nous nous limitons aux diff√©rences les plus √©videntes. <br><br>  Il est assez √©vident que les performances √† un seul thread d'Intel restent hors comp√©tition: le noyau Skylake est le noyau qui ex√©cute la plupart des instructions √† la vol√©e et, surtout, fonctionne √† une vitesse d'horloge plus √©lev√©e.  Le c≈ìur de ThunderX2 est diff√©rent en ce qu'il extrait un maximum d'instructions par cycle, capable de supporter en permanence 4 threads.  Le r√©cup√©rateur capturera 8 √©quipes √† partir d'un thread, puis 8 √† partir du deuxi√®me thread, et continuera √† faire d√©filer les threads.  Cela signifie qu'une mauvaise pr√©diction peut r√©duire consid√©rablement les performances d'un seul thread. <br><br><h2>  Les SKU ThunderX2: 16 √† 32 c≈ìurs </h2><br>  Le SKU utilis√© pour les tests est ThunderX2 CN9980 2.2.  C'est le SKU haut de gamme, contient 32 c≈ìurs √† une fr√©quence de 2,2 GHz avec la possibilit√© d'augmenter jusqu'√† 2,5 GHz. <br><br><img src="https://habrastorage.org/webt/bs/p0/cz/bsp0czxkrsx9_oxyoavedet_lje.png"><br><br>  Si vous croyez aux plans de Cavium, dans les prochains mois, il y aura beaucoup plus de SKU.  Cavium affirme que le CN9980 sera bient√¥t disponible avec une fr√©quence de 2,5 GHz et un turbo jusqu'√† 3 GHz. <br><br>  Cavium a r√©pertori√© toutes ses r√©f√©rences SKU ainsi que les r√©f√©rences Intel comparables.  Selon la d√©finition de Cavium, un SKU Intel comparable est une puce qui atteint le m√™me SPECInRate (2017) sous gcc que le SKU de Cavium. <br><br><img src="https://habrastorage.org/webt/nz/yd/7m/nzyd7mn7vi6azmttjyosotv51ma.png"><br><br>  Cavium estime que le CN9880 2.2 que nous avons obtenu est comparable au 8164 beaucoup plus cher. Pour nos tests, nous le comparons au 8176 (SKU Intel disponible pour nous).  Peu importe: le 8176 n'a qu'une vitesse d'horloge sup√©rieure de 3% et 2 c≈ìurs suppl√©mentaires (+ 7%) par rapport au 8164. Cependant, notez que bien que le ThunderX2 Cavium puisse vraiment rivaliser avec les SKU Intel indiqu√©s, ils offrent les m√™mes performances pour un tiers du co√ªt du SKU Intel. <br><br>  Dans la partie suivante: <br><br><ul><li>  Configuration et m√©thodologie des tests </li><li>  Sous-syst√®me de m√©moire: bande passante </li><li>  Performances √† un seul thread: SPEC CPU2006 </li><li>  SPEC CPU2006 Cont: performances bas√©es sur les c≈ìurs avec SMT </li></ul><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en le recommandant √† vos amis, une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√©s pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment diviser le serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 Go DDR4 6x480 Go SSD 1 Gbps 100 TV √† partir de 249 $</a> aux Pays-Bas et aux √âtats-Unis!</b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413885/">https://habr.com/ru/post/fr413885/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413873/index.html">Les donn√©es r√©cup√©r√©es de la mission Apollo ont aid√© √† r√©soudre le myst√®re du ¬´chauffage de la lune¬ª</a></li>
<li><a href="../fr413875/index.html">SpaceX d√©veloppera un "centre spatial du futur"</a></li>
<li><a href="../fr413877/index.html">Vous donnez juste une raison. Ou sous quel pr√©texte peuvent-ils vous voler maintenant?</a></li>
<li><a href="../fr413879/index.html">Apprendre un cheval (partie 4)</a></li>
<li><a href="../fr413881/index.html">Image Docker de 5,94 m√®tres avec Telegram MTProxy</a></li>
<li><a href="../fr413889/index.html">D√©lai non respect√©, ou pourquoi plus de la moiti√© des entreprises n'√©taient pas pr√™tes pour le RGPD</a></li>
<li><a href="../fr413891/index.html">Organisation du registre d'√âtat unifi√© des entit√©s juridiques - un registre d'√âtat unifi√© des entit√©s juridiques</a></li>
<li><a href="../fr413893/index.html">Un trou comme outil de s√©curit√© - 2, ou comment attraper des app√¢ts vivants APT</a></li>
<li><a href="../fr413895/index.html">Pirater un bracelet de fitness pas cher</a></li>
<li><a href="../fr413897/index.html">Unity3D ECS et Job System</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>