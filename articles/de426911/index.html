<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👨🏿 🚥 👊🏾 GreyEnergy: BlackEnergy-Nachfolger greift Unternehmen des Energiesektors an 📻 🙆🏾 🤟🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESET-Spezialisten führten eine Analyse hochentwickelter Malware durch, die zuvor noch nicht untersucht wurde und auf gezielte Angriffe auf kritische I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GreyEnergy: BlackEnergy-Nachfolger greift Unternehmen des Energiesektors an</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/426911/">  ESET-Spezialisten führten eine Analyse hochentwickelter Malware durch, die zuvor noch nicht untersucht wurde und auf gezielte Angriffe auf kritische Infrastrukturunternehmen in Mittel- und Osteuropa ausgerichtet ist.  Das Programm mit dem Namen GreyEnergy hat eine konzeptionelle Ähnlichkeit mit BlackEnergy, einer Malware, die im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dezember 2015</a> bei Angriffen auf ukrainische Energieunternehmen eingesetzt wurde.  Darüber hinaus gibt es Links, die darauf hinweisen, dass die GreyEnergy-Betreiber mit der TeleBots-Gruppe hinter einer Reihe destruktiver Angriffe zusammengearbeitet haben. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/d5/8-/dvd58-ginvoshns9sbcaupqnvzy.jpeg"></div><br>  Der Bericht enthält Informationen zu den Aktivitäten der GreyEnergy Group in den letzten Jahren.  Beachten Sie, dass wir keinem Status Angriffe und Malware-Entwicklung zuordnen.  Nach unserer Terminologie ist „ART-Gruppe“ eine Reihe technischer Indikatoren. <br><a name="habracut"></a><br><h2>  Einführung </h2><br>  Im Dezember 2015 griff die BlackEnergy-Gruppe den ukrainischen Energiekomplex mit Malware aus den Familien BlackEnergy und KillDisk an.  Dies war der letzte bekannte Vorfall mit BlackEnergy-Software unter realen Bedingungen.  Nach diesem Angriff verwandelte sich die Gruppe in mindestens zwei Untergruppen: TeleBots und GreyEnergy. <br><br>  TeleBots ist spezialisiert auf Cyber-Sabotage mittels Network Computer Attacks (CNA).  Die Gruppe hat zerstörerische Angriffe gezählt, darunter: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine Reihe von Angriffen</a> mit der aktualisierten Version von KillDisk für Windows und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linux</a> im Dezember 2016; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NotPetya-Epidemie</a> im Juni 2017, implementiert mit Hilfe einer komplexen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hintertür,</a> die mit Hilfe der MEDoc-Buchhaltungssoftware implementiert wurde; </li><li>  Angriff mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BadRabbit-Encoder</a> im Oktober 2017. </li></ul><br>  ESET-Experten überwachen seit mehreren Jahren die Aktivitäten der GreyEnergy-Gruppe.  Die Gruppe verwendet die einzigartige gleichnamige Malware-Familie.  Die Malvari-Architektur ähnelt der BlackEnergy-Familie. <br><br>  Neben den konzeptionellen Ähnlichkeiten der Programme gibt es weitere Links, die darauf hinweisen, dass die GreyEnergy-Betreiber eng mit der TeleBots-Gruppe zusammenarbeiten.  Insbesondere im Dezember 2016 startete die GreyEnergy-Gruppe einen Wurm, der NotPetya ähnelt, und eine fortgeschrittenere Version dieses Programms erschien im Juni 2017 bei einem TeleBots-Angriff. <br><br>  Es ist erwähnenswert, dass GreyEnergy und TeleBots unterschiedliche Ziele verfolgen. GreyEnergy interessiert sich hauptsächlich für industrielle Netzwerke, die kritischen Infrastrukturunternehmen gehören, und ist im Gegensatz zu TeleBots nicht auf Objekte in der Ukraine beschränkt. <br><br>  Ende 2015 bemerkten wir erstmals GreyEnergy-Malware für ein Energieunternehmen in Polen.  GreyEnergy greift jedoch auch ukrainische Ziele an.  Die Gruppe konzentriert sich auf den Energiesektor, die Verkehrsinfrastruktur und andere hochrangige Einrichtungen.  Mindestens eine BlackEnergy-Zielorganisation wurde von GreyEnergy angegriffen.  Die letzte Nutzung von GreyEnergy wurde Mitte 2018 verzeichnet. <br><br>  Das Schadprogramm GreyEnergy verfügt über eine modulare Architektur. Im Gegensatz zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Industroyer</a> haben wir jedoch keine Module gesehen, die sich auf industrielle Steuerungssysteme (ICS) auswirken könnten.  Die GreyEnergy-Betreiber haben jedoch mindestens einmal eine Viper auf der Festplatte bereitgestellt, um Workflows zu unterbrechen und Spuren eines Cyberangriffs zu verbergen. <br><br>  Eines der interessantesten Details unserer Forschung ist, dass eines der GreyEnergy-Muster mit einem gültigen digitalen Zertifikat signiert wurde.  Dieses Zertifikat wurde höchstwahrscheinlich einem taiwanesischen Hersteller von ICS-Geräten gestohlen.  In dieser Hinsicht trat die Gruppe GreyEnergy in die Fußstapfen der Autoren von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stuxnet</a> . <br><br><h2>  GreyEnergy: Arbeitsweise </h2><br>  Bei der Beobachtung der Aktivität der GreyEnergy-Gruppe sahen wir hauptsächlich zwei anfängliche Infektionsvektoren.  Der erste betrifft Organisationen mit Webdiensten, die sich auf den Servern der Opfer befinden.  Wenn der öffentliche Webdienst auf einem Server ausgeführt wird, der mit dem internen Netzwerk verbunden ist, versuchen Angreifer, ihn zu kompromittieren, um in das Netzwerk einzudringen.  Der zweite Vektor ist das gezielte Phishing mit böswilligen E-Mail-Anhängen. <br><br>  Schädliche Dokumente sichern GreyEnergy mini - eine leichte Hintertür der ersten Stufe, für die keine Administratorrechte erforderlich sind.  Nachdem ein Computer mit GreyEnergy mini kompromittiert wurde, erstellen Angreifer eine Netzwerkkarte und sammeln Kennwörter, um Domänenadministratorrechte zu erhalten.  Mit diesen Berechtigungen können Angreifer das gesamte Netzwerk steuern.  Die GreyEnergy-Gruppe verwendet ziemlich Standardwerkzeuge, um diese Aufgaben zu erfüllen: Nmap und Mimikatz. <br><br>  Nach einer ersten Erkundung des Netzwerks können Angreifer eine Flaggschiff-Hintertür bereitstellen - die Haupt-GreyEnergy.  Für schädliche Software sind Administratorrechte erforderlich, die vor der Bereitstellungsphase von GreyEnergy erworben werden müssen.  Laut unserer Forschung installieren GreyEnergy-Betreiber die Haupt-Backdoor hauptsächlich auf zwei Arten von Endpunkten: Servern mit langer Betriebszeit und Workstations, die zur Verwaltung von ICS-Umgebungen verwendet werden. <br><br>  Um die Kommunikation mit C &amp; C-Servern zu maskieren, können Angreifer zusätzliche Software auf internen Servern eines gefährdeten Netzwerks installieren, sodass jeder Server als Proxy fungiert.  Ein solcher Proxy-C &amp; C leitet Anforderungen von infizierten Knoten im Netzwerk an einen externen C &amp; C-Server im Internet weiter.  Die „Kommunikation“ mehrerer Netzwerkcomputer mit einem internen Server sieht nicht so verdächtig aus wie mit einem externen.  Die Methode kann auch zum Verwalten von Malware in verschiedenen Segmenten eines gefährdeten Netzwerks verwendet werden.  Eine ähnliche Methode unter Verwendung interner Server als Proxy-C &amp; C wurde in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Duqu 2.0 ART-Kampagne beobachtet</a> . <br><br>  Wenn in der gefährdeten Organisation öffentliche Webserver mit dem internen Netzwerk verbunden sind, können Angreifer auf diesen Servern Backdoors für die Sicherung bereitstellen.  Sie werden verwendet, um den Zugriff auf das Netzwerk wiederherzustellen, falls die wichtigsten Backdoors erkannt und gelöscht werden. <br><br>  Alle C &amp; C-Server im Zusammenhang mit GreyEnergy-Malware verwenden Tor. <br><br><img src="https://habrastorage.org/webt/xx/oq/go/xxoqgo-8cdke9obd1fcazkwa3cq.png"><br>  <i>Abbildung 1. Ein vereinfachtes Diagramm zweier von der GreyEnergy-Gruppe verwendeter Netzwerkkompromisszenarien</i> <br><br><h2>  Greyenergy mini </h2><br>  GreyEnergy mini ist eine leichte Hintertür der ersten Stufe, die von Angreifern verwendet wurde, um einen kompromittierten Computer zu bewerten und einen ersten Brückenkopf im Netzwerk bereitzustellen.  In der Regel wurde GreyEnergy mini mithilfe eines schädlichen Dokuments heruntergeladen, das in Phishing-E-Mails verteilt ist.  GreyEnergy mini ist auch als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FELIXROOT bekannt</a> . <br><br>  Im September 2017 entdeckte ESET ein ukrainisches Word-Microsoft-Dokument, das ein schädliches Makro enthält.  Das Köderdokument ahmt ein interaktives Formular nach, um das Opfer zu ermutigen, das Makro einzuschalten und auszufüllen. <br><br><img src="https://habrastorage.org/webt/fw/vr/33/fwvr33hhjxbw8fufl_c6qpeluoo.png"><br>  <i>Abbildung 2. Von GreyEnergy im September 2017 verwendetes Köderdokument</i> <br><br>  Nach dem Einschalten des Makros versucht sein Code, die Binärdatei vom Remote-Server herunterzuladen und auszuführen. <br><br><img src="https://habrastorage.org/webt/lu/xi/c8/luxic8ibbi5mgwhz7rhefr978ak.png"><br>  <i>Abbildung 3. Schädliches VBA-Makro (Kommentare von ESET hinzugefügt)</i> <br><br>  Interessanterweise ist ein Link, der zu einem externen Bild führt, in den Dokumentkörper eingebettet.  Nach dem Öffnen des Dokuments versucht er, dieses Bild hochzuladen. Auf diese Weise erfahren die Angreifer, dass die Datei geöffnet ist.  Mit dieser Methode können Sie verfolgen, welche Ziele ein schädliches Makro enthielten und welche gerade ein Dokument geöffnet haben. <br><br><img src="https://habrastorage.org/webt/0j/td/ot/0jtdotwwqqa9vzly3-cd92brvsa.png"><br>  <i>Abbildung 4. Verknüpfung mit einer externen „Tracker“ -Zeichnung in einem schädlichen Dokument</i> <br><br>  Die heruntergeladene ausführbare Datei ist eine GreyEnergy Mini-Pipette.  Der Dropper schreibt die schädliche DLL in den Ordner <code>%APPDATA%</code> , wobei eine zufällig generierte GUID als Name verwendet wird.  Darüber hinaus erstellt der Dropper eine <code>.LNK</code> Datei mit einem leeren Dateinamen im <code>.LNK</code> des Startmenüs mit einem Eintrag, der <code>rundll32.exe</code> mit dem Pfad zur DLL als Befehlszeilenargument ausführt.  Dies ist die GreyEnergy Mini-Persistenzmethode. <br><br>  Die Flushed DLL ist das Hauptmodul von GreyEnergy mini.  Es wird als legitime Datei im Zusammenhang mit Microsoft Windows getarnt. <br><br><img src="https://habrastorage.org/webt/ly/yu/lg/lyyulg-m5vxpbdbsgqvyssghhww.png"><br>  <i>Abbildung 5. GreyEnergy Mini-Backdoor-DLL maskiert sich als legitime Windows-DLL</i> <br><br>  Um einen gefährdeten Computer zu bewerten, sammelt Malware so viele Informationen wie möglich und sendet Daten an C &amp; C.  Die Daten werden mithilfe der WMI-Abfragesprache (WQL) und der Windows-Registrierungsabfragen erfasst.  Folgende Daten werden erhoben: <br><br><ul><li>  Computername </li><li>  Betriebssystemversion einschließlich Service Pack-Version </li><li>  Standardsprache </li><li>  Benutzername </li><li>  aktuelle Windows-Benutzerrechte, Höhe, UAC-Ebene </li><li>  Proxy-Einstellungen </li><li>  Computerinformationen (Hersteller, Modell, Systemtyp) </li><li>  Zeitzone </li><li>  installierte Sicherheitssoftware (Antivirus und Firewall) </li><li>  Liste der Benutzer und Domänen </li><li>  Liste der installierten Programme aus der Registrierung </li><li>  Netzwerkinformationen (IP-Adressen, DHCP-Server usw.) </li><li>  Liste der laufenden Prozesse </li></ul><br>  Schädliche Software empfängt Befehle vom C &amp; C-Server.  Die folgenden Befehle werden unterstützt (unten sind die Befehls-IDs und ihre Bedeutung aufgeführt): <br><br><ol><li>  Computerinformationen sammeln </li><li>  Laden Sie die ausführbare Datei aus dem Ordner für temporäre Dateien herunter und führen Sie sie aus </li><li>  Shell-Befehl ausführen </li><li>  sich von einem kompromittierten Computer entfernen </li><li>  Laden Sie die .BAT-Datei aus dem Ordner für temporäre Dateien herunter und führen Sie sie aus </li><li>  Datei auf lokale Festplatte herunterladen </li><li>  Datei hochladen </li></ol><br>  Die Malware-Konfiguration im JSON-Format ist in die Binärdatei eingebettet und wird mit einem benutzerdefinierten Algorithmus verschlüsselt.  Verschlüsselte Daten enthalten am Anfang vier Bytes.  Diese Bytes werden als Schlüssel für die XOR-Operation verwendet, um den Rest der Daten zu entschlüsseln.  Die meisten von der Malware verwendeten Zeichenfolgen werden mit diesem Algorithmus verschlüsselt. <br><br><img src="https://habrastorage.org/webt/ra/1e/7q/ra1e7q7lgjkezdzs1cvknhtjytc.png"><br>  <i>Abbildung 6. Integrierte GreyEnergy Mini-Konfiguration vor und nach der Entschlüsselung</i> <br><br>  Alle GreyEnergy Mini-Konfigurationen, die wir gesehen haben, enthalten HTTPS- und HTTP-Server, die als C &amp; C verwendet werden.  Auf diese Weise können Angreifer auf Zielen, auf denen die HTTPS-Verbindung von der Netzwerk- oder Firewallkonfiguration nicht unterstützt wird, zu HTTP wechseln. <br><br>  GreyEnergy mini weist Ähnlichkeiten im Code mit anderen Schadprogrammen der GreyEnergy-Familie auf.  Darüber hinaus verwenden sowohl der GreyEnergy mini als auch die Haupt-GreyEnergy-Hintertür dieselben C &amp; C-Server. <br><br><h2>  Haupttür GreyEnergy </h2><br>  GreyEnergy ist die Haupttür dieser Cybergruppe.  Die hier analysierten Malware-Beispiele werden in C geschrieben und mit Visual Studio kompiliert, jedoch ohne die Standardfunktionen der C-Laufzeitbibliothek (CRT).  Gepackte Proben können einen gefälschten PE-Zeitstempel enthalten, aber nach dem Auspacken wird der Zeitstempel zurückgesetzt (1. Januar 1970). <br><br><img src="https://habrastorage.org/webt/4g/30/bx/4g30bxseryscxui0m-0z3hrdrzo.png"><br>  <i>Abbildung 7. PE-Zeitstempel der ausgepackten GreyEnergy-Probe</i> <br><br>  Interessanterweise wurde eine der ersten analysierten GreyEnergy-Proben mit einem Zertifikat von Advantech signiert.  Dies ist ein taiwanesisches Unternehmen, das Geräte für Industrie und IoT herstellt.  Da wir festgestellt haben, dass dasselbe Zertifikat zum Signieren der sauberen, nicht bösartigen Software von Advantech verwendet wurde, glauben wir, dass sie gestohlen wurde.  Beachten Sie, dass das erkannte Beispiel keine digitale Signatur hat. Dies bedeutet, dass die Signatur nach Ablauf des Zertifikats ungültig wurde. <br><br><img src="https://habrastorage.org/webt/y4/qe/i8/y4qei8gt9buk4eftsr5_5bukgiy.png"><br>  <i>Abbildung 8. Advantech-Zertifikat zum Signieren des GreyEnergy-Malware-Beispiels</i> <br><br>  Die Zertifikatdaten lauten wie folgt: <br><br> <code>Serial Number: 15:f4:8f:98:c5:79:41:00:6f:4c:9a:63:9b:f3:c1:cc <br> Validity: <br> Not Before: Feb 10 00:00:00 2014 GMT <br> Not After : Feb 26 23:59:59 2017 GMT <br> SHA1 Fingerprint=97:53:AD:54:DF:6B:D6:73:E0:6C:00:36:3D:34:6A:06:00:7A:0A:9B</code> <br> <br>  Wir haben festgestellt, dass GreyEnergy normalerweise in zwei Modi bereitgestellt wird: nur im Speicher und unter Beibehaltung des DLL-Dienstes.  Der erste Modus wird verwendet, wenn Angreifer sicher sind, dass für die Installation keine besonderen Maßnahmen zur Gewährleistung der Stabilität erforderlich sind (z. B. auf Servern mit langer Betriebszeit).  Der zweite Modus ist, wenn die Malware einem Neustart standhalten muss. <br><br><h4>  Nur-Speicher-Modus </h4><br>  In diesem Modus legen Angreifer die DLL-Datei in einem bestimmten Ordner ab und führen sie dann mit der Windows-Anwendung <code>rundll32.exe</code> .  Wir haben festgestellt, dass Angreifer das Windows Sysinternals PsExec-Tool lokal verwenden, um <code>rundll32.exe</code> mit den höchstmöglichen Berechtigungen auszuführen ( <code>NT AUTHORITY\SYSTEM</code> ). <br><br>  Unten finden Sie die Befehlszeile, die in der ersten Ausführungsphase von GreyEnergy nur im Speicher verwendet wird: <br><br> <code>cmd.exe /c "C:\Windows\System32\rundll32.exe "C:\Sun\Thumbs.db",#1 CAIAABBmAAAgAAAA8GFGvkHVGDtGRqcl3Z3nYJ9aXCm7TVZX8klEdjacOSU="</code> <br> <br>  In diesem Beispiel ist Thumbs.db eine GreyEnergy-DLL-Datei, aus der die Funktion mit der ersten Sequenznummer vom Prozess <code>rundll32.exe</code> aufgerufen wird.  Das angegebene Befehlszeilenbeispiel enthält eine Folge von mit base64 verschlüsselten Bytes, die anschließend als AES-256-Schlüssel zum Entschlüsseln eines kleinen Stubs verwendet werden.  Danach startet der Code im „Stub“ eine neue Kopie des Prozesses <code>svchost.exe</code> und injiziert die GreyEnergy-Nutzdaten.  In der letzten Phase, in der der GreyEnergy-Prozess <code>rundll32.exe</code> endet, wird die schädliche DLL-Datei vor dem Löschen von der Festplatte geschützt.  Daher ist die GreyEnergy-Nutzlast nur im Kontext des Prozessspeichers <code>svchost.exe</code> . <br><br>  Höchstwahrscheinlich wollten die Autoren Malware so entwickeln, dass es ohne einen Schlüssel in der Befehlszeile unmöglich war, den „Stub“ und die Nutzlast zu entschlüsseln. <br><br><img src="https://habrastorage.org/webt/rb/l5/vt/rbl5vtt2xe-e3ud4p9wxpuhsgz8.png"><br>  <i>Abbildung 9. Interner Name der GreyEnergy DLL für den Nur-Speicher-Modus</i> <br><br>  Wenn Sie den Modus "Nur im Speicher" verwenden, reicht es aus, den entsprechenden <code>svchost.exe</code> Prozess <code>svchost.exe</code> oder den Computer neu zu starten, um GreyEnergy zu entfernen. <br><br><h4>  DLL-Dienstpersistenz </h4><br>  Um diese Methode zu verwenden, stellen die Bediener den GreyEnergy-Dropper bereit, der mit Administratorrechten ausgeführt werden muss. <br><br>  Mit dem <code>ServiceDLL</code> Registrierungsschlüssel können Sie das Service-DLL-Modul im Kontext des Prozesses <code>svchost.exe</code> .  Funktion nicht von Microsoft dokumentiert;  Es wird jedoch von einer Reihe von Malware-Familien verwendet, einschließlich des Conficker-Wurms. <br><br>  Um die Persistenz des DLL-Dienstes sicherzustellen, sucht der Dropper nach einem vorhandenen Dienst und fügt einen neuen <code>ServiceDLL</code> Registrierungsschlüssel hinzu.  Da die Methode zu einem Systemausfall führen kann, führt der Dropper zunächst eine Reihe von Überprüfungen durch, um einen Dienst auszuwählen, der eine Reihe von Anforderungen erfüllt. <br><br>  Zunächst findet der Dropper alle Windows-Dienste, die derzeit durch Ausführen der folgenden WQL-Abfrage gestoppt werden: <br><br> <code>Select * from Win32_Service where PathName Like '%%svchost%%' and State = 'Stopped'</code> <br> <br>  Die folgenden Bedingungen können zur Anforderung hinzugefügt werden: <br><br><ul><li>  <code>and StartMode = 'Disabled'</code> oder <code>and StartMode = 'Manual'</code> </li><li>  <code>and ServiceType = 'Own Process'</code> oder <code>and ServiceType = 'Share Process'</code> </li></ul><br>  Als Nächstes versucht der Dropper, den gewünschten Dienst auszuwählen, überprüft die Ergebnisse und überspringt diejenigen, die die folgenden Bedingungen erfüllen: <br><br><ul><li>  Der <code>winmgmt</code> enthält <code>winmgmt</code> (Windows Management Instrumentation) oder <code>BITS</code> (Background Intelligent Transfer Service). </li><li>  Dropper hat keinen Zugriff auf den Dienst oder den Registrierungsschlüssel </li><li>  <code>DependOnService</code> Registrierungswert von <code>DependOnService</code> nicht leer </li><li>  Der Registrierungswert für <code>ServiceDll</code> oder <code>ImagePath</code> ist nicht vorhanden </li><li>  Die Service-Befehlszeile enthält eines der folgenden Wörter: </li><li>  <code>DcomLaunch</code> , <code>LocalServiceNetworkRestricted</code> , <code>LocalServiceNoNetwork</code> , <code>LocalServicePeerNet</code> , <code>LocalSystemNetworkRestricted</code> , <code>NetworkServiceNetworkRestricted</code> , <code>secsvcs</code> , <code>wcssvc</code> </li></ul><br>  Wenn ein Dienst erkannt wird, der diese Bedingungen erfüllt, speichert das Malware-Programm die DLL-Datei im Windows- <code>system32</code> Verzeichnis und schreibt den <code>ServiceDLL</code> Registrierungsschlüssel.  Der DLL-Name enthält vier zufällig generierte Zeichen und am Ende <code>svc.dll</code> oder <code>srv.dll</code> .  Darüber hinaus fälscht der Dropper die Zeitmetadaten der Datei, indem er sie aus der vorhandenen Datei <code>user32.dll</code> kopiert. <br><br>  Die neueste Version des GreyEnergy-Droppers unterstützt sowohl 32-Bit- als auch 64-Bit-Betriebssysteme. <br><br><img src="https://habrastorage.org/webt/ih/kq/uu/ihkquuwr7ha_ggshsdfwgngg3sw.png"><br>  <i>Abbildung 10. DLL GreyEnergy DLL, die über die DLL-Dienstpersistenzmethode bereitgestellt wird</i> <br><br>  Dropper verwendet eine interessante Methode, um eine schädliche DLL als legitime Datei zu tarnen.  Insbesondere kopiert der Dropper die VERSIONINFO-Ressource, die eine detaillierte Beschreibung aus der ausführbaren Datei des betreffenden Windows-Dienstes enthält, und schreibt diese Daten in eine schädliche DLL.  Zu diesem Zweck werden die Windows-API-Funktionen <code>BeginUpdateResource</code> / <code>UpdateResource</code> / <code>EndUpdateResource</code> .  Neuere Versionen rufen diese Funktionen nicht über die API auf.  Ihr Code ist im Schadprogramm selbst implementiert, um zu vermeiden, dass die DLL-Datei ohne eine gefälschte VERSIONINFO-Ressource auf die Festplatte geschrieben wird.  Vermutlich wird dadurch die Erkennung bestimmter Sicherheitsprodukte vermieden.  Dieselbe Pipette kann schädliche DLL-Dateien mit unterschiedlichen Beschreibungen auf verschiedenen Computern erstellen.  Jedes auf diese Weise erweiterte Muster hat einen eindeutigen Hash. <br><br>  Wenn die Malware bereits auf dem System vorhanden ist, kann der Dropper sie mithilfe der Named Pipe aktualisieren. <br><br>  In der letzten Phase löscht sich der Dropper selbst, indem er die Datei mit Nullen überschreibt und von der Festplatte löscht.  Dropper löscht auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USN-Magazin</a> .  Aktionen werden über die folgenden Shell-Befehle ausgeführt: <br><br> <code>timeout 2 &gt; nul &amp; fsutil file setzerodata offset=0 length=%DROPPER_FILESIZE% "%DROPPER_PATH%" &amp; timeout 2 &amp; cmd /c del /F /Q "%DROPPER_PATH%" &amp; fsutil usn deletejournal /D %DROPPER_DRIVE%</code> <br> <br><h4>  Konfiguration und Kommunikation </h4><br>  Der von den Bedienern ausgewählte Persistenzmodus wirkt sich nicht auf die Funktionalität des Schadprogramms aus, die bei beiden Methoden unverändert bleibt. <br><br>  Schädliche Software enthält eine eingebettete Konfiguration, die mit dem AES-256-Algorithmus verschlüsselt und mit LZNT1 komprimiert wird. <br><br>  Das Mehrkomponenten-MIME-Format wird für die Konfiguration eingebetteter Malware verwendet.  Die Autoren haben keinen eigenen Parser für dieses Format implementiert.  Stattdessen verwenden sie die COM-Schnittstellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IMimeMessage</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IMimeBody</a> .  Interessanterweise wird in der Microsoft-Dokumentation davon abgeraten, diese Schnittstellen zu verwenden. <br><br><img src="https://habrastorage.org/webt/wr/uw/mb/wruwmbzmf4phjtbinjintm9ryfw.png"><br>  <i>Abbildung 11. Beispiel für eine integrierte GreyEnergy-Konfiguration</i> <br><br>  Für die externe Konfiguration wird das identische MIME-Format verwendet.  Die Malware verschlüsselt die externe Konfiguration jedoch auf verschiedene Weise.  Es verwendet die DPAPI (Data Protection Application Programming Interface), insbesondere die Windows-API-Funktionen <code>CryptProtectData</code> und <code>CryptUnprotectData</code> .  Die externe Konfiguration wird im folgenden Pfad <code>C:\ProgramData\Microsoft\Windows\%GUID%</code> gespeichert <code>C:\ProgramData\Microsoft\Windows\%GUID%</code> , wobei <code>%GUID%</code> ein zufällig generierter GUID-Wert ist, der auf der Seriennummer des Laufwerks C: basiert. <br><br>  Einige GreyEnergy-Beispiele enthalten eine etwas verschleierte Version der Konfiguration.  Insbesondere enthalten die <code>Type</code> solcher Konfigurationen Buchstaben anstelle von Optionsnamen. <br><br><img src="https://habrastorage.org/webt/wj/dl/7-/wjdl7-_lpzwki1oifgi_awjctxy.png"><br>  <i>Abbildung 12. Ein Beispiel für eine verschleierte GreyEnergy-Konfiguration</i> <br><br>  Die Konfiguration kann folgende Werte enthalten: <br><br><img src="https://habrastorage.org/webt/yo/_s/8e/yo_s8eqfgp-xgxf3mooreev9tmo.png"><br><br>  Die Malware entfernt sich selbst vom infizierten System, wenn die Anzahl der erfolglosen Versuche den Wert von <code>MaxAttempts</code> überschreitet und die letzte erfolgreiche Verbindung vor mehr als <code>Lifetime</code> <code>MaxAttempts</code> hat. <br><br>  Die Kommunikation mit C &amp; C erfolgt normalerweise über HTTPS.  In einigen Fällen wird jedoch auch HTTP verwendet.  Das gleiche MIME-Format ist in HTTP-Anforderungen gekapselt.  Es ist erwähnenswert, dass die Daten mit AES-256 und RSA-2048 verschlüsselt werden. <br><br><img src="https://habrastorage.org/webt/b1/g8/6d/b1g86dydvt2stlutlwkgy79ydem.png"><br>  <i>Abbildung 13. In Wireshark erfasste GreyEnergy über HTTP-Kommunikation</i> <br><br>  Wenn Sie HTTP verwenden, ist es einfacher, einen gefährdeten Computer im Netzwerk zu identifizieren, indem Sie den Netzwerkverkehr analysieren.  In den untersuchten Malware-Beispielen wurden immer die folgenden fest codierten Benutzeragenten verwendet: <br><br><ul><li> <code>Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko</code> </li> <li> <code>Mozilla/5.0 (compatible, MSIE 11, Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko</code> </li> </ul><br>  Damit GreyEnergy-Betreiber infizierte Computer identifizieren können, sendet die Malware die Ergebnisse der folgenden WQL-Abfragen an den C &amp; C-Server: <br><br><ul><li> <code>SELECT Caption, Version, CSName, ProductType, CurrentTimeZone, LocalDateTime, OSLanguage, OSType FROM Win32_OperatingSystem</code> </li> <li> <code>SELECT MACAddress, IPAddress, IPSubnet, DHCPEnabled, DHCPServer, DNSDomain FROM Win32_NetworkAdapterConfiguration WHERE MACAddress IS NOT NULL</code> </li> </ul><br>  Die Antworten des C &amp; C-Servers sind verschlüsselt, enthalten jedoch nach der Entschlüsselung dasselbe MIME-Format mit den folgenden möglichen Werten: <br><img src="https://habrastorage.org/webt/go/am/pd/goampdwrvmb0ospdus377v4jvj8.png"><br><br>  GreyEnergy lädt zusätzliche Module und Nutzdaten mit einem eigenen PE-Dateilader in den Speicher. <br><br><h4>  GreyEnergy-Module </h4><br>  Wie viele komplexe Bedrohungen verfügt auch die GreyEnergy-Malware über eine modulare Architektur.  Die Funktionalität kann durch Hinzufügen zusätzlicher Module erweitert werden.  Das GreyEnergy-Modul ist eine DLL-Datei, die durch Aufrufen einer Funktion mit der ersten Sequenznummer ausgeführt wird.  Jedes Modul, einschließlich des Hauptmoduls GreyEnergy, akzeptiert Textbefehle mit verschiedenen Parametern. <br><br>  GreyEnergy-Bediener senden nicht sofort alle Module an eine gefährdete Maschine.  In der Regel lädt ein Schadprogramm die zur Ausführung bestimmter Aufgaben erforderlichen Module herunter und führt sie aus. <br><br>  Wir sind uns der Existenz der folgenden GreyEnergy-Module bewusst: <br><br>  <code>remoteprocessexec</code> - <code>remoteprocessexec</code> eine binäre RE-Datei in einen Remote-Prozess ein <br>  <code>info</code> - sammelt Systeminformationen, Ereignisprotokolle und SHA-256-Malware <br>  <code>file</code> - Dateisystemoperationen <br>  <code>sshot</code> - macht Screenshots <br>  <code>keylogger</code> - fängt Tastenanschläge ab <br>  <code>passwords</code> - Sammelt Passwörter, die in verschiedenen Anwendungen gespeichert sind <br>  <code>mimikatz</code> - <code>mimikatz</code> Tool zum Sammeln von Windows-Anmeldeinformationen <br>  <code>plink</code> - <code>plink</code> Software zum Erstellen von SSH-Tunneln <br>  <code>3proxy</code> - <code>3proxy</code> Software zum Erstellen von Proxys <br><br>  Mit <code>remoteprocessexec</code> Modul <code>remoteprocessexec</code> kann ein Angreifer beliebige Binärdateien im Kontext vorhandener Prozesse ausführen.  Sie können beispielsweise Mimikatz oder einen Port-Scanner im Kontext von Windows Explorer ausführen, ohne sie auf der Festplatte abzulegen.  Um Standardausgabe- und Prozessthreads umzuleiten und den Prozess zu beenden, fängt das Modul fünf Windows-API-Funktionen ab. <br><br><img src="https://habrastorage.org/webt/vn/c9/2a/vnc92aap-hqdl_ps_0r-tzj4ngc.png"><br>  <i>Abbildung 14. Von remoteprocessexec erfasste Windows-API-Funktionen</i> <br><br>  Da die zurückgesetzte GreyEnergy-DLL für jeden infizierten Computer eindeutig ist, können Angreifer mithilfe des Informationsmoduls SHA-256-Hashes sammeln.  Durch das Vorhandensein von Hashes können Sie verfolgen, ob die Datei auf öffentliche Webdienste wie VirusTotal hochgeladen wurde. <br><br><h4>  Reverse Protection und Anti-Criminal-Methoden </h4><br>  GreyEnergy verwendet verschiedene Methoden, um die Analyse zu erschweren.  Beispielsweise verschlüsselt ein Malware-Programm Zeichenfolgen.  Einige Optionen verwenden denselben Algorithmus wie GreyEnergy mini. <br><br>  Die meisten GreyEnergy-Beispiele haben jedoch einen anderen Verschlüsselungsalgorithmus.  Insbesondere werden die ersten vier Bytes in einem verschlüsselten Blob nicht als Schlüssel für XOR-Operationen verwendet.  Stattdessen werden sie verwendet, um die Anfangsnummer des Pseudozufallszahlen-Generierungsalgorithmus ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mersenne Whirlwind</a> ) zu initialisieren, und dann sind die generierten vier Bytes der Schlüssel.  Vor dem Freigeben eines Speicherpuffers mit einer Zeichenfolge aus einfachem Text überschreibt die Malware den Puffer mit Nullen. <br><br><img src="https://habrastorage.org/webt/on/px/a6/onpxa6j99a73zoqabotlcujmfyu.png"><br>  <i>Abbildung 15. Dekompilierter Code für die GreyEnergy-Zeichenfolgendecodierungsfunktion</i> <br><br>  Das Schadprogramm fängt die <code>DeleteFileW</code> <code>DeleteFileA</code> und <code>DeleteFileW</code> in der <code>DeleteFileW</code> jeder in den Speicher geladenen binären PE-Datei ab.  Der Hook ersetzt diese Funktionen durch Funktionen, mit denen Dateien sicher gelöscht werden.  Insbesondere wird die Datei mit Nullen überschrieben, bevor sie von der Festplatte gelöscht wird.  Jede Nutzlast oder jedes Plugin verwendet eine solche Funktion, ohne dass sie in jedem Modul implementiert werden muss. <br><br><img src="https://habrastorage.org/webt/h1/ii/9y/h1ii9yhj8un7_f4zsauhxcaf4wg.png"><br>  <i>Abbildung 16. Dekompilierter Code für eine Routine, die DeleteFileA und DeleteFileW abfängt</i> <br><br><h2>  Die Werkzeuge </h2><br>  Angreifer verwendeten den Nmap-Port-Scanner als Hauptwerkzeug für die Zuordnung der internen Netzwerke des Opfers.  Darüber hinaus haben wir die Verwendung eines leichten benutzerdefinierten Port-Scanners beobachtet, bei dem Nmap nicht möglich war. <br><br><img src="https://habrastorage.org/webt/6s/6p/wu/6s6pwugb_rufwoeytkhlkorgc_m.png"><br>  <i>Abbildung 17. Konsolenausgabe eines benutzerdefinierten GreyEnergy-Gruppenport-Scanners</i> <br><br>  Angreifer verwenden aktiv legitime Tools wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SysInternals PsExec</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WinExe</a> für horizontale Bewegungen in gefährdeten Netzwerken.  Das WinExe-Tool, das Open-Source-Analogon von WinExe, kann von einem Linux-Gerät aus gesteuert werden, z. B. von einem kompromittierten Linux-Webserver. <br><br>  Es ist erwähnenswert, dass Angreifer zusätzlich zu diesen Tools PowerShell-Skripte verwenden. <br><br><h2>  Webserver-Hintertüren </h2><br>  Wie bereits erwähnt, stellt die GreyEnergy-Gruppe zusätzliche Backdoors für Webserver bereit, wenn auf diese Server über das Internet zugegriffen werden kann.  Wir haben festgestellt, dass Angreifer für diesen Zweck in PHP geschriebene Backdoors verwenden.  Sie verwenden die öffentlich zugängliche PHP-Web-Shell WSO-Webshell und c99shell. <br><br>  Angreifer können ein vorhandenes PHP-Skript auf einem Webserver ändern oder ein neues bereitstellen.  Der eigentliche Backdoor-PHP-Code verbirgt normalerweise mehrere Ebenen der Verschleierung und Verschlüsselung. <br><br><img src="https://habrastorage.org/webt/zo/ri/hz/zorihzdc7ajclfmonz_fcia53yy.png"><br>  <i>Abbildung 18. Verschleierter Code der PHP-Hintertür der GreyEnergy-Gruppe</i> <br><br>  Die letzte Codeebene ist durch Stream-Verschlüsselung geschützt.  Die Schlüsselgenerierung für diese Verschlüsselung basiert auf einer Zeichenfolge aus dem Cookie-Wert, den die Angreifer über eine HTTP-Anforderung bereitgestellt haben.  Jede solche PHP-Backdoor wird mit einem separaten Schlüssel verschlüsselt. <br><br><img src="https://habrastorage.org/webt/cs/8t/yh/cs8tyhnegnb6c1rk1avs7dxfgtk.png"><br>  <i>Abbildung 19. Die letzte Ebene, die der PHP-Backdoor-Code dekodiert</i> <br><br>  Die Verschleierungstechnik wird verwendet, um eine Analyse sowie die Unmöglichkeit der Verwendung einer solchen PHP-Hintertür durch andere Cybergruppen zu verhindern. <br><br><h2>  Proxy C &amp; C (Triulin) </h2><br>  Wie bereits erwähnt, können Angreifer den internen Server als C &amp; C-Proxy verwenden. <br><br>  Wir haben festgestellt, dass die Angreifer sogar Ketten von C &amp; C-Proxys erstellt haben, in denen der erste derartige Server den Netzwerkverkehr zum nächsten umleiten kann usw., bis er das endgültige Ziel im Internet erreicht. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angreifer verwenden verschiedene Methoden, um den internen Server in einen C &amp; C-Proxy zu verwandeln. </font><font style="vertical-align: inherit;">Zu diesem Zweck können sie direkt die GreyEnergy-Malware, zusätzliche Software oder Skripte von Drittanbietern verwenden. </font><font style="vertical-align: inherit;">Im ersten Fall können Bediener den Windows-Server mithilfe von GreyEnergy kompromittieren und ihn mithilfe der Module 3proxy und plink in einen C &amp; C-Proxy verwandeln. </font><font style="vertical-align: inherit;">Bei der Überwachung der GreyEnergy-Aktivität haben wir die Installation der folgenden legitimen Programme auf internen Linux-Servern beobachtet:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3proxy kleiner Proxy </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dante SOCKS Server </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PuTTY Link (Plink) </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstelle von Software von Drittanbietern können Angreifer interne Webserver verwenden, indem sie ihre eigenen Skripts auf ihnen installieren. Die Programmiersprachen PHP und ASP werden verwendet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In allen beobachteten Fällen wurden die bereitgestellten PHP-Skripte mit der gleichen Art der Verschleierung wie in Backdoors für Webserver verschleiert und verschlüsselt. In diesem Fall wird das Cookie mit dem Entschlüsselungsschlüssel jedoch von der GreyEnergy-Malware selbst bereitgestellt. Aus diesem Grund sollten Betreiber ein spezielles Konfigurationsformat für die Server-URL verwenden. </font></font><br><br><img src="https://habrastorage.org/webt/ms/tm/84/mstm84awqgzzm0rxykrmni1ocmw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 20. Die letzte Ebene, die den PHP-Backdoor-Code mithilfe eines Cookies entschlüsselt.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Interessanterweise enthält die Malware-Konfiguration das Wort </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Triungulin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf dem Weg zum verschleierten PHP-Skript des Proxyservers. </font><font style="vertical-align: inherit;">Dies scheint der interne Name dieser Methode zu sein, die von den GreyEnergy-Anweisungen verwendet wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn das Schadprogramm in der Konfiguration einen integrierten C &amp; C-Proxy hat, enthält es keine externen C &amp; C-Server. </font><font style="vertical-align: inherit;">Um die externe C &amp; C-Adresse zu finden, benötigen Sie daher sowohl ein Malware-Beispiel als auch alle damit verbundenen PHP-Skripte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben die Verwendung der folgenden PHP-Skripte beobachtet:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> benutzerdefiniertes PHP-Proxy-Skript </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leicht modifizierte Version von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antichat Socks5 Server</font></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein benutzerdefiniertes PHP-Proxy-Skript enthält eine URL mit einem externen C &amp; C-Header. </font></font><br><br><img src="https://habrastorage.org/webt/z1/il/bq/z1ilbqnz3shhbn__app1xhpgtem.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 21. Ein externer C &amp; C-Server, der in das benutzerdefinierte PHP-Proxyserverskript eingebettet ist Das benutzerdefinierte PHP-</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Skript verwendet die OpenSSL- und Curl-Bibliotheken, um die Anforderung von der Malware an den externen C &amp; C-Server im Internet umzuleiten. </font></font><br><br><img src="https://habrastorage.org/webt/ph/bc/20/phbc20w7dx91bjkhopbartak4cw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 22. Code für das benutzerdefinierte PHP-Skript des GreyEnergy-Gruppenproxyservers</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wie oben erwähnt, können Angreifer ASP-Skripte für denselben Zweck verwenden. In einem von uns beobachteten Fall verwendete das ASP-Skript ein von der Malware bereitgestelltes Cookie, um nur die echte C &amp; C-Adresse mit AES zu entschlüsseln. Der Rest des Codes wurde nicht verschlüsselt oder verschleiert. </font></font><br><br><img src="https://habrastorage.org/webt/y-/2k/tq/y-2ktq8-zcd2m9e70sobitai9se.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 23. Von der GreyEnergy-Gruppe verwendeter ASP-Proxy-Code</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C &amp; C-Server mit Internetzugang </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle GreyEnergy C &amp; C-Server verwendeten Tor, als sie aktiv waren. </font><font style="vertical-align: inherit;">Die Einstellungen der C &amp; C-Infrastruktur ähneln denen von BlackEnergy, TeleBots und Industroyer, die auch Tor-Server verwendeten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wahrscheinlich hat jeder C &amp; C-Server eine Zwiebeladresse, mit der Angreifer auf Daten zugreifen, diese verwalten oder übertragen können. </font><font style="vertical-align: inherit;">Dies scheint eine OPSEC-Anforderung zu sein, die Angreifern eine zusätzliche Anonymitätsebene verleiht. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESET-Experten haben die C &amp; C-Server identifiziert, die in den letzten drei Jahren von der GreyEnergy-Malware verwendet wurden. </font><font style="vertical-align: inherit;">Die Liste finden Sie weiter unten im Abschnitt „Kompromissindikatoren“.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vergleich von GreyEnergy und BlackEnergy </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Malware-Familien GreyEnergy und BlackEnergy haben dieselbe Struktur, dieselbe Reihe von Modulen und Funktionen. </font><font style="vertical-align: inherit;">Obwohl die Implementierung dieser Funktionen unterschiedlich ist, sind sie immer noch vergleichbar.</font></font><br><img src="https://habrastorage.org/webt/mn/zc/sj/mnzcsjrof8t61sfkfi3lzs15p8k.png"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Dezember 2016 starteten Angreifer einen Wurm, der unserer Meinung nach der Vorgänger von NotPetya war (auch bekannt als Petya, ExPetr, Nyetya, EternalPetya). Der Wurm wurde bei Angriffen auf eine kleine Anzahl von Objekten verwendet und hatte begrenzte Verteilungsmöglichkeiten, so dass er nicht allgemein bekannt war. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Wurm ist eine DLL-Datei mit einem Namen </font></font><code>msvcrt120b.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Windows-Verzeichnis. Der interne Dateiname ist </font></font><code>moonraker.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, was vielleicht ein Hinweis auf den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Film</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und den gleichnamigen </font><font style="vertical-align: inherit;">Bond- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roman ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Im Allgemeinen haben wir das Programm Moonraker Petya genannt. </font></font><br><br><img src="https://habrastorage.org/webt/21/ez/o5/21ezo5wz4iwkebpqamk88nnuv3e.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 24. Der interne Name des im Dezember 2016 installierten Wurms</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der PE-Zeitstempel in der DLL deutet darauf hin, dass die Datei im Dezember 2016 kompiliert wurde, vermutlich kurz vor der Installation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moonraker Petya enthält Code, nach dem der Computer nicht mehr geladen wird. Insbesondere wird der Wert </font></font><code>ImagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in den Registrierungsschlüsseln </font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet001\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">überschrieben</font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet002\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und löscht den ersten Sektor des Systemlaufwerks. Im Gegensatz zu NotPetya enthält Moonraker Petya keinen Code, der direkt mit MBR und dem Bootloader des Betriebssystems interagiert. Stattdessen enthält die Moonraker Petya DLL einen verschlüsselten Binärdaten-Blob. Die Malware erwartet ein Befehlszeilenargument, das später als Entschlüsselungsschlüssel verwendet wird. Nach dem Entschlüsseln und Entpacken mit der zlib-Bibliothek wird der Code als binäre RE-Datei in den Speicher geladen und ausgeführt. Wir haben keinen Entschlüsselungsschlüssel, aber wir haben die Disk-Images infizierter Computer analysiert. Sie enthielten den MBR- und Bootloader-Code, der dem Code des ursprünglichen Green Petya entspricht, der von verschiedenen Cybergruppen verwendet wird. Wir gehen davon aus, dass der Blob die ursprüngliche grüne Petja enthalten kann.</font></font><br><br><img src="https://habrastorage.org/webt/ok/4h/pk/ok4hpk-oion7dmngxdeo0ud8tka.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 25. Der Popup-Bildschirm, der nach dem Neustart auf mit Moonraker Petya infizierten Computern angezeigt wird.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist interessant, dass die Entschlüsselung in Moonraker Petya dem gleichen Vorgang in GreyEnergy DLL-Dateien im Modus "Nur im Speicher" sehr ähnlich ist. </font></font><br><br><img src="https://habrastorage.org/webt/mb/ef/mq/mbefmqjst4qziv5a8wxnrggyxky.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 26. Vergleich von dekompiliertem Moonraker Petya-Code (links) und GreyEnergy (rechts)</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya- </font><i><font style="vertical-align: inherit;">Code</font></i><font style="vertical-align: inherit;"> kann mit SysInternals PsExec über ein lokales Netzwerk verteilt werden. Schädliche Programme enthalten zlib-komprimierte Binärdateien in ihren Ressourcen. Später wird die Binärdatei mit dem Dateinamen in das Windows-Verzeichnis geschrieben </font></font><code>conhost.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses Schadprogramm ist in </font><font style="vertical-align: inherit;">ähnlicher Weise NotPetya verteilt: aufzählt Netzknoten mit </font><font style="vertical-align: inherit;">unterschiedlichen Methoden ( </font></font><code>WNetEnumResourceW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetIpNetTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetExtendedTcpTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>NetServerEnum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, TERMSRV-Aufzeichnungen mit</font></font><code>CredEnumerateW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), stellt dann über die Funktion eine Verbindung zum Netzwerkhost her </font></font><code>WNetAddConnection2W</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und speichert die Malware als </font></font><code>\\%TARGET-HOST%\admin$\%MALWARE%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Danach führt Moonraker Petya den folgenden Befehl aus, mit dem das Schadprogramm auf dem Remotecomputer mithilfe von PsExec zurückgesetzt wird: </font></font><br><br> <code>C:\Windows\conhost.exe \\%TARGET-HOST% -accepteula -s -d C:\Windows\System32\rundll32.exe "C:\Windows\msvcrt120b.dll", #1 %TIMEOUT% "USER1:PASSWORD1;USER2:PASSWORD2" "%DECRYPTIONKEY%"</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist wichtig zu beachten, dass das Schadprogramm keine Funktionen zum Sammeln von Anmeldeinformationen mithilfe von Mimikatz hat und den EternalBlue-Exploit nicht enthält. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zusätzlich zu den aufgeführten Funktionen unterstützt Moonraker Petya auch die Dateiverschlüsselung. Das Schadprogramm scannt alle Dateien auf den Festplatten und versucht anschließend, sie mit dem AES-256-Algorithmus zu verschlüsseln. Nach Abschluss des Verschlüsselungsprozesses kann Malware eine Datei </font></font><code>README.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit Zahlungsanweisungen </font><font style="vertical-align: inherit;">erstellen </font><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Anweisung enthält einen persönlichen Schlüssel, der mit RSA-2048 verschlüsselt wurde. Darüber hinaus enthält es den gleichen Text und die gleichen Zwiebeladressen wie die ursprüngliche grüne Petja. Es scheint, dass die Angreifer die Verwendung dieser Malware als Angriff auf Green Petya tarnen wollten. </font></font><br><br><img src="https://habrastorage.org/webt/9f/i3/qu/9fi3quz_fckxngvtzjm6eay2svy.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 27. Readme-Datei mit Zahlungsanweisungen von Moonraker Petya</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Als letzten Schritt versucht Moonraker Petya, den Computer neu zu starten.</font></font><br><br><h2>  Fazit </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GreyEnergy ist ein wichtiger Teil des Arsenals einer der gefährlichsten ART-Gruppen, die in den letzten Jahren ukrainische Ziele angegriffen haben. Wir sehen sie als Nachfolgerin von BlackEnergy. Ähnlichkeiten und Unterschiede sind in diesem Beitrag aufgeführt. Die Hauptgründe, warum wir zu diesem Schluss gekommen sind, sind eine ähnliche Struktur von Malware, eine Auswahl von Zielen und Arbeitsmethoden. Der Übergang von BlackEnergy zu GreyEnergy erfolgte Ende 2015 - möglicherweise, weil Angreifer die Malware-Suite aktualisieren mussten, nachdem sie verstärkt auf die BlackEnergy-Infrastruktur geachtet hatten.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein interessanter Teil des Puzzles ist die Tatsache, dass Moonraker Petya im Juni 2016 verwendet wurde, das nach unseren Schätzungen der Vorgänger des zerstörerischen Programms NotPetya ist. </font><font style="vertical-align: inherit;">Dies kann darauf hinweisen, dass die Gruppen TeleBots und GreyEnergy zusammenarbeiten oder zumindest Code und einige Ideen austauschen. </font><font style="vertical-align: inherit;">Wir betrachten sie jedoch als separate Gruppen, deren Ziele etwas anders sind. </font><font style="vertical-align: inherit;">Zum Zeitpunkt des Schreibens haben wir die beabsichtigten Aktivitäten von TeleBots außerhalb der Ukraine im Gegensatz zu GreyEnergy und BlackEnergy zuvor nicht gesehen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In jedem Fall stellen GreyEnergy-Betreiber eine ernsthafte Gefahr dar. </font><font style="vertical-align: inherit;">Wir überwachen weiterhin die Aktivitäten von GreyEnergy und TeleBots und empfehlen privaten und geschäftlichen Benutzern, die fortschrittlichsten Produkte zum Schutz von Endpunkten zu verwenden.</font></font><br><br><h2>  Kompromissindikatoren </h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erkennung durch ESET-Produkte: </font></font></h4><br> <code>VBA/TrojanDownloader.Agent.EYV <br> Win32/Agent.SCT <br> Win32/Agent.SCM <br> Win32/Agent.SYN <br> Win64/Agent.SYN <br> Win32/Agent.WTD <br> Win32/GreyEnergy <br> Win64/GreyEnergy <br> Win32/Diskcoder.MoonrakerPetya.A <br> PHP/Agent.JS <br> PHP/Agent.JX <br> PHP/Agent.KJ <br> PHP/Agent.KK <br> PHP/Agent.KL <br> PHP/Agent.KM <br> PHP/Agent.KN <br> PHP/Agent.KO <br> PHP/Agent.KP <br> PHP/Agent.KQ <br> PHP/Agent.KR <br> PHP/Agent.KS <br> PHP/Agent.KT <br> PHP/Agent.KU <br> PHP/Agent.LC <br> PHP/Agent.NBP <br> PHP/Kryptik.AB <br> PHP/TrojanProxy.Agent.B <br> ASP/Agent.L <br> Win64/HackTool.PortScanner.A <br> Win64/Riskware.Mimikatz.A <br> Win64/Riskware.Mimikatz.AE <br> Win64/Riskware.Mimikatz.AH <br> Win32/Winexe.A <br> Win64/Winexe.A <br> Win64/Winexe.B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy-Dokument: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>177AF8F6E8D6F4952D13F88CDF1887CB7220A645</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy mini: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>455D9EB9E11AA9AF9717E0260A70611FF84EF900 <br> 51309371673ACD310F327A10476F707EB914E255 <br> CB11F36E271306354998BB8ABB6CA67C1D6A3E24 <br> CC1CE3073937552459FB8ED0ADB5D56FA00BCD43 <br> 30AF51F1F7CB9A9A46DF3ABFFB6AE3E39935D82C</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy-Tropfer: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>04F75879132B0BFBA96CB7B210124BC3D396A7CE <br> 69E2487EEE4637FE62E47891154D97DFDF8AAD57 <br> 716EFE17CD1563FFAD5E5E9A3E0CAC3CAB725F92 <br> 93EF4F47AC160721768A00E1A2121B45A9933A1D <br> 94F445B65BF9A0AB134FAD2AAAD70779EAFD9288 <br> A414F0A651F750EEA18F6D6C64627C4720548581 <br> B3EF67F7881884A2E3493FE3D5F614DBBC51A79B <br> EBD5DC18C51B6FB0E9985A3A9E86FF66E22E813E <br> EC7E018BA36F07E6DADBE411E35B0B92E3AD8ABA</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zurücksetzbare GreyEnergy-DLLs: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0B5D24E6520B8D6547526FCBFC5768EC5AD19314 <br> 10D7687C44BECA4151BB07F78C6E605E8A552889 <br> 2A7EE7562A6A5BA7F192B3D6AED8627DFFDA4903 <br> 3CBDC146441E4858A1DE47DF0B4B795C4B0C2862 <br> 4E137F04A2C5FA64D5BF334EF78FE48CF7C7D626 <br> 62E00701F62971311EF8E57F33F6A3BA8ED28BF7 <br> 646060AC31FFDDFBD02967216BC71556A0C1AEDF <br> 748FE84497423ED209357E923BE28083D42D69DE <br> B75D0379C5081958AF83A542901553E1710979C7 <br> BFC164E5A28A3D56B8493B1FC1CA4A12FA1AC6AC <br> C1EB0150E2FCC099465C210B528BF508D2C64520 <br> CBB7BA92CDF86FA260982399DAB8B416D905E89B <br> DF051C67EE633231E4C76EC247932C1A9868C14F <br> DFD8665D91C508FAF66E2BC2789B504670762EA2 <br> E2436472B984F4505B4B938CEE6CAE26EF043FC7 <br> E3E61DF9E0DD92C98223C750E13001CBB73A1E31 <br> E496318E6644E47B07D6CAB00B93D27D0FE6B415 <br> EDA505896FFF9A29BD7EAE67FD626D7FFA36C7B2 <br> F00BEFDF08678B642B69D128F2AFAE32A1564A90 <br> F36ECAC8696AA0862AD3779CA464B2CD399D8099</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy DLL ("nur im Speicher" -Modus): </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0BCECB797306D30D0BA5EAEA123B5BF69981EFF4 <br> 11159DB91B870E6728F1A7835B5D8BE9424914B9 <br> 6ABD4B82A133C4610E5779C876FCB7E066898380 <br> 848F0DBF50B582A87399428D093E5903FFAEEDCD <br> 99A81305EF6E45F470EEE677C6491045E3B4D33A <br> A01036A8EFE5349920A656A422E959A2B9B76F02 <br> C449294E57088E2E2B9766493E48C98B8C9180F8 <br> C7FC689FE76361EF4FDC1F2A5BAB71C0E2E09746 <br> D24FC871A721B2FD01F143EB6375784144365A84 <br> DA617BC6DCD2083D93A9A83D4F15E3713D365960 <br> E4FCAA1B6A27AA183C6A3A46B84B5EAE9772920B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>1AA1EF7470A8882CA81BB9894630433E5CCE4373</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PHP- und ASP-Skripte </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>10F4D12CF8EE15747BFB618F3731D81A905AAB04 <br> 13C5B14E19C9095ABA3F1DA56B1A76793C7144B9 <br> 1BA30B645E974DE86F24054B238FE77A331D0D2C <br> 438C8F9607E06E7AC1261F99F8311B004C23DEC3 <br> 4D1C282F9942EC87C5B4D9363187AFDC120F4DC7 <br> 4E0C5CCFFB7E2D17C26F82DB5564E47F141300B3 <br> 5377ADB779DE325A74838C0815EEA958B4822F82 <br> 58A69A8D1B94E751050DECF87F2572E09794F0F8 <br> 5DD34FB1C8E224C17DCE04E02A4409E9393BCE58 <br> 639BCE78F961C4B9ECD9FE1A8537733388B99857 <br> 7127B880C8E31FBEB1D376EB55A6F878BC77B21A <br> 71BA8FE0C9C32A9B987E2BB827FE54DAE905D65E <br> 78A7FBDD6ADF073EA6D835BE69084E071B4DA395 <br> 81332D2F96A354B1B8E11984918C43FB9B5CB9DB <br> 8CC008B3189F8CE9A96C2C41F864D019319EB2EE <br> 940DE46CD8C50C28A9C0EFC65AEE7D567117941B <br> A415E12591DD47289E235E7022A6896CB2BFDE96 <br> D3AE97A99D826F49AD03ADDC9F0D5200BE46AB5E <br> E69F5FF2FCD18698BB584B6BC15136D61EB4F594 <br> E83A090D325E4A9E30B88A181396D62FEF5D54D5 <br> ECF21EFC09E4E2ACFEEB71FB78CB1F518E1F5724</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzerdefinierter Port-Scanner </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>B371A5D6465DC85C093A5FB84D7CDDEB1EFFCC56 <br> B40BDE0341F52481AE1820022FA8376E53A20040</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mimikatz </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>89D7E0DA80C9973D945E6F62E843606B2E264F7E <br> 8B295AB4789105F9910E4F3AF1B60CBBA8AD6FC0 <br> AD6F835F239DA6683CAA54FCCBCFDD0DC40196BE</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Winexe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1: </font><font style="vertical-align: inherit;">Warnung: Die meisten Server mit diesen IP-Adressen waren Teil des Tor-Netzwerks, dh die Verwendung dieser Indikatoren kann zu Fehlalarmen führen.</font></font><br> <code>0666B109B0128599D535904C1F7DDC02C1F704F2 <br> 2695FCFE83AB536D89147184589CCB44FC4A60F3 <br> 3608EC28A9AD7AF14325F764FB2F356731F1CA7A <br> 37C837FB170164CBC88BEAE720DF128B786A71E0 <br> 594B809343FEB1D14F80F0902D764A9BF0A8C33C <br> 7C1F7CE5E57CBDE9AC7755A7B755171E38ABD70D <br> 90122C0DC5890F9A7B5774C6966EA694A590BD38 <br> C59F66808EA8F07CBDE74116DDE60DAB4F9F3122 <br> CEB96B364D6A8B65EA8FA43EB0A735176E409EB0 <br> FCEAA83E7BD9BCAB5EFBA9D1811480B8CB0B8A3E</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C &amp; C-Serveradressen GreyEnergy mini </font></font></h4><br> <code>https://82.118.236[.]23:8443/27c00829d57988279f3ec61a05dee75a <br> http://82.118.236[.]23:8080/27c00829d57988279f3ec61a05dee75a <br> https://88.198.13[.]116:8443/xmlservice <br> http://88.198.13[.]116:8080/xmlservice <br> https://217.12.204[.]100/news/ <br> http://217.12.204[.]100/news/ <br> http://pbank.co[.]ua/favicon.ico (IP: 185.128.40.90)</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy C &amp; C-Serveradressen (Aktivitätsperioden und IP) </font></font></h4><br> <code>2015–2016 – 109.200.202.7 <br> 2015–2015 – 193.105.134.68 <br> 2015–2016 – 163.172.7.195 <br> 2015–2016 – 163.172.7.196 <br> 2016–2016 – 5.149.248.77 <br> 2016–2016 – 31.148.220.112 <br> 2016–2016 – 62.210.77.169 <br> 2016–2016 – 85.25.211.10 <br> 2016–2016 – 138.201.198.164 <br> 2016–2017 – 124.217.254.55 <br> 2017–2017 – 46.249.49.231 <br> 2017–2017 – 37.59.14.94 <br> 2017–2017 – 213.239.202.149 <br> 2017–2017 – 88.198.13.116 <br> 2017–2017 – 217.12.202.111 <br> 2017–2017 – 176.31.116.140 <br> 2017–2018 – 185.217.0.121 <br> 2017–2018 – 178.150.0.200 <br> 2018–2018 – 176.121.10.137 <br> 2018–2018 – 178.255.40.194 <br> 2018–2018 – 193.105.134.56 <br> 2018–2018 – 94.130.88.50 <br> 2018–2018 – 185.216.33.126</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de426911/">https://habr.com/ru/post/de426911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de426899/index.html">Video Science Meetup Video</a></li>
<li><a href="../de426901/index.html">Die schnellste Kamera der Welt nimmt 10 Billionen Bilder pro Sekunde auf</a></li>
<li><a href="../de426903/index.html">Die Stadt Chengdu möchte einen Satellitenreflektor in die Umlaufbahn bringen, um die Straßen mit einem Sonnenfleck von 10 bis 80 km zu beleuchten</a></li>
<li><a href="../de426905/index.html">PVS-Studio 6.26 Release</a></li>
<li><a href="../de426907/index.html">Häufige Sicherheitsprobleme im Unternehmensnetzwerk, die mit Check Point Security CheckUP erkannt werden können</a></li>
<li><a href="../de426913/index.html">Wie man Interviews zwischen Berichten und einem kleinen Bericht über DevOops macht</a></li>
<li><a href="../de426915/index.html">NASA Hackathon: Space Apps Challenge</a></li>
<li><a href="../de426917/index.html">Intelligente, sichere Cisco-Plattform für Unternehmen im digitalen Zeitalter</a></li>
<li><a href="../de426919/index.html">Einführung in Microsoft Learn</a></li>
<li><a href="../de426921/index.html">Oh, mein Code: Wie man in der IT erfolgreich wird</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>