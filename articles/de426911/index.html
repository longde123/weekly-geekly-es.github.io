<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçü§ù‚Äçüë®üèø üö• üëäüèæ GreyEnergy: BlackEnergy-Nachfolger greift Unternehmen des Energiesektors an üìª üôÜüèæ ü§üüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ESET-Spezialisten f√ºhrten eine Analyse hochentwickelter Malware durch, die zuvor noch nicht untersucht wurde und auf gezielte Angriffe auf kritische I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GreyEnergy: BlackEnergy-Nachfolger greift Unternehmen des Energiesektors an</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/426911/">  ESET-Spezialisten f√ºhrten eine Analyse hochentwickelter Malware durch, die zuvor noch nicht untersucht wurde und auf gezielte Angriffe auf kritische Infrastrukturunternehmen in Mittel- und Osteuropa ausgerichtet ist.  Das Programm mit dem Namen GreyEnergy hat eine konzeptionelle √Ñhnlichkeit mit BlackEnergy, einer Malware, die im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dezember 2015</a> bei Angriffen auf ukrainische Energieunternehmen eingesetzt wurde.  Dar√ºber hinaus gibt es Links, die darauf hinweisen, dass die GreyEnergy-Betreiber mit der TeleBots-Gruppe hinter einer Reihe destruktiver Angriffe zusammengearbeitet haben. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/d5/8-/dvd58-ginvoshns9sbcaupqnvzy.jpeg"></div><br>  Der Bericht enth√§lt Informationen zu den Aktivit√§ten der GreyEnergy Group in den letzten Jahren.  Beachten Sie, dass wir keinem Status Angriffe und Malware-Entwicklung zuordnen.  Nach unserer Terminologie ist ‚ÄûART-Gruppe‚Äú eine Reihe technischer Indikatoren. <br><a name="habracut"></a><br><h2>  Einf√ºhrung </h2><br>  Im Dezember 2015 griff die BlackEnergy-Gruppe den ukrainischen Energiekomplex mit Malware aus den Familien BlackEnergy und KillDisk an.  Dies war der letzte bekannte Vorfall mit BlackEnergy-Software unter realen Bedingungen.  Nach diesem Angriff verwandelte sich die Gruppe in mindestens zwei Untergruppen: TeleBots und GreyEnergy. <br><br>  TeleBots ist spezialisiert auf Cyber-Sabotage mittels Network Computer Attacks (CNA).  Die Gruppe hat zerst√∂rerische Angriffe gez√§hlt, darunter: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine Reihe von Angriffen</a> mit der aktualisierten Version von KillDisk f√ºr Windows und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linux</a> im Dezember 2016; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NotPetya-Epidemie</a> im Juni 2017, implementiert mit Hilfe einer komplexen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hintert√ºr,</a> die mit Hilfe der MEDoc-Buchhaltungssoftware implementiert wurde; </li><li>  Angriff mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BadRabbit-Encoder</a> im Oktober 2017. </li></ul><br>  ESET-Experten √ºberwachen seit mehreren Jahren die Aktivit√§ten der GreyEnergy-Gruppe.  Die Gruppe verwendet die einzigartige gleichnamige Malware-Familie.  Die Malvari-Architektur √§hnelt der BlackEnergy-Familie. <br><br>  Neben den konzeptionellen √Ñhnlichkeiten der Programme gibt es weitere Links, die darauf hinweisen, dass die GreyEnergy-Betreiber eng mit der TeleBots-Gruppe zusammenarbeiten.  Insbesondere im Dezember 2016 startete die GreyEnergy-Gruppe einen Wurm, der NotPetya √§hnelt, und eine fortgeschrittenere Version dieses Programms erschien im Juni 2017 bei einem TeleBots-Angriff. <br><br>  Es ist erw√§hnenswert, dass GreyEnergy und TeleBots unterschiedliche Ziele verfolgen. GreyEnergy interessiert sich haupts√§chlich f√ºr industrielle Netzwerke, die kritischen Infrastrukturunternehmen geh√∂ren, und ist im Gegensatz zu TeleBots nicht auf Objekte in der Ukraine beschr√§nkt. <br><br>  Ende 2015 bemerkten wir erstmals GreyEnergy-Malware f√ºr ein Energieunternehmen in Polen.  GreyEnergy greift jedoch auch ukrainische Ziele an.  Die Gruppe konzentriert sich auf den Energiesektor, die Verkehrsinfrastruktur und andere hochrangige Einrichtungen.  Mindestens eine BlackEnergy-Zielorganisation wurde von GreyEnergy angegriffen.  Die letzte Nutzung von GreyEnergy wurde Mitte 2018 verzeichnet. <br><br>  Das Schadprogramm GreyEnergy verf√ºgt √ºber eine modulare Architektur. Im Gegensatz zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Industroyer</a> haben wir jedoch keine Module gesehen, die sich auf industrielle Steuerungssysteme (ICS) auswirken k√∂nnten.  Die GreyEnergy-Betreiber haben jedoch mindestens einmal eine Viper auf der Festplatte bereitgestellt, um Workflows zu unterbrechen und Spuren eines Cyberangriffs zu verbergen. <br><br>  Eines der interessantesten Details unserer Forschung ist, dass eines der GreyEnergy-Muster mit einem g√ºltigen digitalen Zertifikat signiert wurde.  Dieses Zertifikat wurde h√∂chstwahrscheinlich einem taiwanesischen Hersteller von ICS-Ger√§ten gestohlen.  In dieser Hinsicht trat die Gruppe GreyEnergy in die Fu√üstapfen der Autoren von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stuxnet</a> . <br><br><h2>  GreyEnergy: Arbeitsweise </h2><br>  Bei der Beobachtung der Aktivit√§t der GreyEnergy-Gruppe sahen wir haupts√§chlich zwei anf√§ngliche Infektionsvektoren.  Der erste betrifft Organisationen mit Webdiensten, die sich auf den Servern der Opfer befinden.  Wenn der √∂ffentliche Webdienst auf einem Server ausgef√ºhrt wird, der mit dem internen Netzwerk verbunden ist, versuchen Angreifer, ihn zu kompromittieren, um in das Netzwerk einzudringen.  Der zweite Vektor ist das gezielte Phishing mit b√∂swilligen E-Mail-Anh√§ngen. <br><br>  Sch√§dliche Dokumente sichern GreyEnergy mini - eine leichte Hintert√ºr der ersten Stufe, f√ºr die keine Administratorrechte erforderlich sind.  Nachdem ein Computer mit GreyEnergy mini kompromittiert wurde, erstellen Angreifer eine Netzwerkkarte und sammeln Kennw√∂rter, um Dom√§nenadministratorrechte zu erhalten.  Mit diesen Berechtigungen k√∂nnen Angreifer das gesamte Netzwerk steuern.  Die GreyEnergy-Gruppe verwendet ziemlich Standardwerkzeuge, um diese Aufgaben zu erf√ºllen: Nmap und Mimikatz. <br><br>  Nach einer ersten Erkundung des Netzwerks k√∂nnen Angreifer eine Flaggschiff-Hintert√ºr bereitstellen - die Haupt-GreyEnergy.  F√ºr sch√§dliche Software sind Administratorrechte erforderlich, die vor der Bereitstellungsphase von GreyEnergy erworben werden m√ºssen.  Laut unserer Forschung installieren GreyEnergy-Betreiber die Haupt-Backdoor haupts√§chlich auf zwei Arten von Endpunkten: Servern mit langer Betriebszeit und Workstations, die zur Verwaltung von ICS-Umgebungen verwendet werden. <br><br>  Um die Kommunikation mit C &amp; C-Servern zu maskieren, k√∂nnen Angreifer zus√§tzliche Software auf internen Servern eines gef√§hrdeten Netzwerks installieren, sodass jeder Server als Proxy fungiert.  Ein solcher Proxy-C &amp; C leitet Anforderungen von infizierten Knoten im Netzwerk an einen externen C &amp; C-Server im Internet weiter.  Die ‚ÄûKommunikation‚Äú mehrerer Netzwerkcomputer mit einem internen Server sieht nicht so verd√§chtig aus wie mit einem externen.  Die Methode kann auch zum Verwalten von Malware in verschiedenen Segmenten eines gef√§hrdeten Netzwerks verwendet werden.  Eine √§hnliche Methode unter Verwendung interner Server als Proxy-C &amp; C wurde in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Duqu 2.0 ART-Kampagne beobachtet</a> . <br><br>  Wenn in der gef√§hrdeten Organisation √∂ffentliche Webserver mit dem internen Netzwerk verbunden sind, k√∂nnen Angreifer auf diesen Servern Backdoors f√ºr die Sicherung bereitstellen.  Sie werden verwendet, um den Zugriff auf das Netzwerk wiederherzustellen, falls die wichtigsten Backdoors erkannt und gel√∂scht werden. <br><br>  Alle C &amp; C-Server im Zusammenhang mit GreyEnergy-Malware verwenden Tor. <br><br><img src="https://habrastorage.org/webt/xx/oq/go/xxoqgo-8cdke9obd1fcazkwa3cq.png"><br>  <i>Abbildung 1. Ein vereinfachtes Diagramm zweier von der GreyEnergy-Gruppe verwendeter Netzwerkkompromisszenarien</i> <br><br><h2>  Greyenergy mini </h2><br>  GreyEnergy mini ist eine leichte Hintert√ºr der ersten Stufe, die von Angreifern verwendet wurde, um einen kompromittierten Computer zu bewerten und einen ersten Br√ºckenkopf im Netzwerk bereitzustellen.  In der Regel wurde GreyEnergy mini mithilfe eines sch√§dlichen Dokuments heruntergeladen, das in Phishing-E-Mails verteilt ist.  GreyEnergy mini ist auch als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FELIXROOT bekannt</a> . <br><br>  Im September 2017 entdeckte ESET ein ukrainisches Word-Microsoft-Dokument, das ein sch√§dliches Makro enth√§lt.  Das K√∂derdokument ahmt ein interaktives Formular nach, um das Opfer zu ermutigen, das Makro einzuschalten und auszuf√ºllen. <br><br><img src="https://habrastorage.org/webt/fw/vr/33/fwvr33hhjxbw8fufl_c6qpeluoo.png"><br>  <i>Abbildung 2. Von GreyEnergy im September 2017 verwendetes K√∂derdokument</i> <br><br>  Nach dem Einschalten des Makros versucht sein Code, die Bin√§rdatei vom Remote-Server herunterzuladen und auszuf√ºhren. <br><br><img src="https://habrastorage.org/webt/lu/xi/c8/luxic8ibbi5mgwhz7rhefr978ak.png"><br>  <i>Abbildung 3. Sch√§dliches VBA-Makro (Kommentare von ESET hinzugef√ºgt)</i> <br><br>  Interessanterweise ist ein Link, der zu einem externen Bild f√ºhrt, in den Dokumentk√∂rper eingebettet.  Nach dem √ñffnen des Dokuments versucht er, dieses Bild hochzuladen. Auf diese Weise erfahren die Angreifer, dass die Datei ge√∂ffnet ist.  Mit dieser Methode k√∂nnen Sie verfolgen, welche Ziele ein sch√§dliches Makro enthielten und welche gerade ein Dokument ge√∂ffnet haben. <br><br><img src="https://habrastorage.org/webt/0j/td/ot/0jtdotwwqqa9vzly3-cd92brvsa.png"><br>  <i>Abbildung 4. Verkn√ºpfung mit einer externen ‚ÄûTracker‚Äú -Zeichnung in einem sch√§dlichen Dokument</i> <br><br>  Die heruntergeladene ausf√ºhrbare Datei ist eine GreyEnergy Mini-Pipette.  Der Dropper schreibt die sch√§dliche DLL in den Ordner <code>%APPDATA%</code> , wobei eine zuf√§llig generierte GUID als Name verwendet wird.  Dar√ºber hinaus erstellt der Dropper eine <code>.LNK</code> Datei mit einem leeren Dateinamen im <code>.LNK</code> des Startmen√ºs mit einem Eintrag, der <code>rundll32.exe</code> mit dem Pfad zur DLL als Befehlszeilenargument ausf√ºhrt.  Dies ist die GreyEnergy Mini-Persistenzmethode. <br><br>  Die Flushed DLL ist das Hauptmodul von GreyEnergy mini.  Es wird als legitime Datei im Zusammenhang mit Microsoft Windows getarnt. <br><br><img src="https://habrastorage.org/webt/ly/yu/lg/lyyulg-m5vxpbdbsgqvyssghhww.png"><br>  <i>Abbildung 5. GreyEnergy Mini-Backdoor-DLL maskiert sich als legitime Windows-DLL</i> <br><br>  Um einen gef√§hrdeten Computer zu bewerten, sammelt Malware so viele Informationen wie m√∂glich und sendet Daten an C &amp; C.  Die Daten werden mithilfe der WMI-Abfragesprache (WQL) und der Windows-Registrierungsabfragen erfasst.  Folgende Daten werden erhoben: <br><br><ul><li>  Computername </li><li>  Betriebssystemversion einschlie√ülich Service Pack-Version </li><li>  Standardsprache </li><li>  Benutzername </li><li>  aktuelle Windows-Benutzerrechte, H√∂he, UAC-Ebene </li><li>  Proxy-Einstellungen </li><li>  Computerinformationen (Hersteller, Modell, Systemtyp) </li><li>  Zeitzone </li><li>  installierte Sicherheitssoftware (Antivirus und Firewall) </li><li>  Liste der Benutzer und Dom√§nen </li><li>  Liste der installierten Programme aus der Registrierung </li><li>  Netzwerkinformationen (IP-Adressen, DHCP-Server usw.) </li><li>  Liste der laufenden Prozesse </li></ul><br>  Sch√§dliche Software empf√§ngt Befehle vom C &amp; C-Server.  Die folgenden Befehle werden unterst√ºtzt (unten sind die Befehls-IDs und ihre Bedeutung aufgef√ºhrt): <br><br><ol><li>  Computerinformationen sammeln </li><li>  Laden Sie die ausf√ºhrbare Datei aus dem Ordner f√ºr tempor√§re Dateien herunter und f√ºhren Sie sie aus </li><li>  Shell-Befehl ausf√ºhren </li><li>  sich von einem kompromittierten Computer entfernen </li><li>  Laden Sie die .BAT-Datei aus dem Ordner f√ºr tempor√§re Dateien herunter und f√ºhren Sie sie aus </li><li>  Datei auf lokale Festplatte herunterladen </li><li>  Datei hochladen </li></ol><br>  Die Malware-Konfiguration im JSON-Format ist in die Bin√§rdatei eingebettet und wird mit einem benutzerdefinierten Algorithmus verschl√ºsselt.  Verschl√ºsselte Daten enthalten am Anfang vier Bytes.  Diese Bytes werden als Schl√ºssel f√ºr die XOR-Operation verwendet, um den Rest der Daten zu entschl√ºsseln.  Die meisten von der Malware verwendeten Zeichenfolgen werden mit diesem Algorithmus verschl√ºsselt. <br><br><img src="https://habrastorage.org/webt/ra/1e/7q/ra1e7q7lgjkezdzs1cvknhtjytc.png"><br>  <i>Abbildung 6. Integrierte GreyEnergy Mini-Konfiguration vor und nach der Entschl√ºsselung</i> <br><br>  Alle GreyEnergy Mini-Konfigurationen, die wir gesehen haben, enthalten HTTPS- und HTTP-Server, die als C &amp; C verwendet werden.  Auf diese Weise k√∂nnen Angreifer auf Zielen, auf denen die HTTPS-Verbindung von der Netzwerk- oder Firewallkonfiguration nicht unterst√ºtzt wird, zu HTTP wechseln. <br><br>  GreyEnergy mini weist √Ñhnlichkeiten im Code mit anderen Schadprogrammen der GreyEnergy-Familie auf.  Dar√ºber hinaus verwenden sowohl der GreyEnergy mini als auch die Haupt-GreyEnergy-Hintert√ºr dieselben C &amp; C-Server. <br><br><h2>  Hauptt√ºr GreyEnergy </h2><br>  GreyEnergy ist die Hauptt√ºr dieser Cybergruppe.  Die hier analysierten Malware-Beispiele werden in C geschrieben und mit Visual Studio kompiliert, jedoch ohne die Standardfunktionen der C-Laufzeitbibliothek (CRT).  Gepackte Proben k√∂nnen einen gef√§lschten PE-Zeitstempel enthalten, aber nach dem Auspacken wird der Zeitstempel zur√ºckgesetzt (1. Januar 1970). <br><br><img src="https://habrastorage.org/webt/4g/30/bx/4g30bxseryscxui0m-0z3hrdrzo.png"><br>  <i>Abbildung 7. PE-Zeitstempel der ausgepackten GreyEnergy-Probe</i> <br><br>  Interessanterweise wurde eine der ersten analysierten GreyEnergy-Proben mit einem Zertifikat von Advantech signiert.  Dies ist ein taiwanesisches Unternehmen, das Ger√§te f√ºr Industrie und IoT herstellt.  Da wir festgestellt haben, dass dasselbe Zertifikat zum Signieren der sauberen, nicht b√∂sartigen Software von Advantech verwendet wurde, glauben wir, dass sie gestohlen wurde.  Beachten Sie, dass das erkannte Beispiel keine digitale Signatur hat. Dies bedeutet, dass die Signatur nach Ablauf des Zertifikats ung√ºltig wurde. <br><br><img src="https://habrastorage.org/webt/y4/qe/i8/y4qei8gt9buk4eftsr5_5bukgiy.png"><br>  <i>Abbildung 8. Advantech-Zertifikat zum Signieren des GreyEnergy-Malware-Beispiels</i> <br><br>  Die Zertifikatdaten lauten wie folgt: <br><br> <code>Serial Number: 15:f4:8f:98:c5:79:41:00:6f:4c:9a:63:9b:f3:c1:cc <br> Validity: <br> Not Before: Feb 10 00:00:00 2014 GMT <br> Not After : Feb 26 23:59:59 2017 GMT <br> SHA1 Fingerprint=97:53:AD:54:DF:6B:D6:73:E0:6C:00:36:3D:34:6A:06:00:7A:0A:9B</code> <br> <br>  Wir haben festgestellt, dass GreyEnergy normalerweise in zwei Modi bereitgestellt wird: nur im Speicher und unter Beibehaltung des DLL-Dienstes.  Der erste Modus wird verwendet, wenn Angreifer sicher sind, dass f√ºr die Installation keine besonderen Ma√ünahmen zur Gew√§hrleistung der Stabilit√§t erforderlich sind (z. B. auf Servern mit langer Betriebszeit).  Der zweite Modus ist, wenn die Malware einem Neustart standhalten muss. <br><br><h4>  Nur-Speicher-Modus </h4><br>  In diesem Modus legen Angreifer die DLL-Datei in einem bestimmten Ordner ab und f√ºhren sie dann mit der Windows-Anwendung <code>rundll32.exe</code> .  Wir haben festgestellt, dass Angreifer das Windows Sysinternals PsExec-Tool lokal verwenden, um <code>rundll32.exe</code> mit den h√∂chstm√∂glichen Berechtigungen auszuf√ºhren ( <code>NT AUTHORITY\SYSTEM</code> ). <br><br>  Unten finden Sie die Befehlszeile, die in der ersten Ausf√ºhrungsphase von GreyEnergy nur im Speicher verwendet wird: <br><br> <code>cmd.exe /c "C:\Windows\System32\rundll32.exe "C:\Sun\Thumbs.db",#1 CAIAABBmAAAgAAAA8GFGvkHVGDtGRqcl3Z3nYJ9aXCm7TVZX8klEdjacOSU="</code> <br> <br>  In diesem Beispiel ist Thumbs.db eine GreyEnergy-DLL-Datei, aus der die Funktion mit der ersten Sequenznummer vom Prozess <code>rundll32.exe</code> aufgerufen wird.  Das angegebene Befehlszeilenbeispiel enth√§lt eine Folge von mit base64 verschl√ºsselten Bytes, die anschlie√üend als AES-256-Schl√ºssel zum Entschl√ºsseln eines kleinen Stubs verwendet werden.  Danach startet der Code im ‚ÄûStub‚Äú eine neue Kopie des Prozesses <code>svchost.exe</code> und injiziert die GreyEnergy-Nutzdaten.  In der letzten Phase, in der der GreyEnergy-Prozess <code>rundll32.exe</code> endet, wird die sch√§dliche DLL-Datei vor dem L√∂schen von der Festplatte gesch√ºtzt.  Daher ist die GreyEnergy-Nutzlast nur im Kontext des Prozessspeichers <code>svchost.exe</code> . <br><br>  H√∂chstwahrscheinlich wollten die Autoren Malware so entwickeln, dass es ohne einen Schl√ºssel in der Befehlszeile unm√∂glich war, den ‚ÄûStub‚Äú und die Nutzlast zu entschl√ºsseln. <br><br><img src="https://habrastorage.org/webt/rb/l5/vt/rbl5vtt2xe-e3ud4p9wxpuhsgz8.png"><br>  <i>Abbildung 9. Interner Name der GreyEnergy DLL f√ºr den Nur-Speicher-Modus</i> <br><br>  Wenn Sie den Modus "Nur im Speicher" verwenden, reicht es aus, den entsprechenden <code>svchost.exe</code> Prozess <code>svchost.exe</code> oder den Computer neu zu starten, um GreyEnergy zu entfernen. <br><br><h4>  DLL-Dienstpersistenz </h4><br>  Um diese Methode zu verwenden, stellen die Bediener den GreyEnergy-Dropper bereit, der mit Administratorrechten ausgef√ºhrt werden muss. <br><br>  Mit dem <code>ServiceDLL</code> Registrierungsschl√ºssel k√∂nnen Sie das Service-DLL-Modul im Kontext des Prozesses <code>svchost.exe</code> .  Funktion nicht von Microsoft dokumentiert;  Es wird jedoch von einer Reihe von Malware-Familien verwendet, einschlie√ülich des Conficker-Wurms. <br><br>  Um die Persistenz des DLL-Dienstes sicherzustellen, sucht der Dropper nach einem vorhandenen Dienst und f√ºgt einen neuen <code>ServiceDLL</code> Registrierungsschl√ºssel hinzu.  Da die Methode zu einem Systemausfall f√ºhren kann, f√ºhrt der Dropper zun√§chst eine Reihe von √úberpr√ºfungen durch, um einen Dienst auszuw√§hlen, der eine Reihe von Anforderungen erf√ºllt. <br><br>  Zun√§chst findet der Dropper alle Windows-Dienste, die derzeit durch Ausf√ºhren der folgenden WQL-Abfrage gestoppt werden: <br><br> <code>Select * from Win32_Service where PathName Like '%%svchost%%' and State = 'Stopped'</code> <br> <br>  Die folgenden Bedingungen k√∂nnen zur Anforderung hinzugef√ºgt werden: <br><br><ul><li>  <code>and StartMode = 'Disabled'</code> oder <code>and StartMode = 'Manual'</code> </li><li>  <code>and ServiceType = 'Own Process'</code> oder <code>and ServiceType = 'Share Process'</code> </li></ul><br>  Als N√§chstes versucht der Dropper, den gew√ºnschten Dienst auszuw√§hlen, √ºberpr√ºft die Ergebnisse und √ºberspringt diejenigen, die die folgenden Bedingungen erf√ºllen: <br><br><ul><li>  Der <code>winmgmt</code> enth√§lt <code>winmgmt</code> (Windows Management Instrumentation) oder <code>BITS</code> (Background Intelligent Transfer Service). </li><li>  Dropper hat keinen Zugriff auf den Dienst oder den Registrierungsschl√ºssel </li><li>  <code>DependOnService</code> Registrierungswert von <code>DependOnService</code> nicht leer </li><li>  Der Registrierungswert f√ºr <code>ServiceDll</code> oder <code>ImagePath</code> ist nicht vorhanden </li><li>  Die Service-Befehlszeile enth√§lt eines der folgenden W√∂rter: </li><li>  <code>DcomLaunch</code> , <code>LocalServiceNetworkRestricted</code> , <code>LocalServiceNoNetwork</code> , <code>LocalServicePeerNet</code> , <code>LocalSystemNetworkRestricted</code> , <code>NetworkServiceNetworkRestricted</code> , <code>secsvcs</code> , <code>wcssvc</code> </li></ul><br>  Wenn ein Dienst erkannt wird, der diese Bedingungen erf√ºllt, speichert das Malware-Programm die DLL-Datei im Windows- <code>system32</code> Verzeichnis und schreibt den <code>ServiceDLL</code> Registrierungsschl√ºssel.  Der DLL-Name enth√§lt vier zuf√§llig generierte Zeichen und am Ende <code>svc.dll</code> oder <code>srv.dll</code> .  Dar√ºber hinaus f√§lscht der Dropper die Zeitmetadaten der Datei, indem er sie aus der vorhandenen Datei <code>user32.dll</code> kopiert. <br><br>  Die neueste Version des GreyEnergy-Droppers unterst√ºtzt sowohl 32-Bit- als auch 64-Bit-Betriebssysteme. <br><br><img src="https://habrastorage.org/webt/ih/kq/uu/ihkquuwr7ha_ggshsdfwgngg3sw.png"><br>  <i>Abbildung 10. DLL GreyEnergy DLL, die √ºber die DLL-Dienstpersistenzmethode bereitgestellt wird</i> <br><br>  Dropper verwendet eine interessante Methode, um eine sch√§dliche DLL als legitime Datei zu tarnen.  Insbesondere kopiert der Dropper die VERSIONINFO-Ressource, die eine detaillierte Beschreibung aus der ausf√ºhrbaren Datei des betreffenden Windows-Dienstes enth√§lt, und schreibt diese Daten in eine sch√§dliche DLL.  Zu diesem Zweck werden die Windows-API-Funktionen <code>BeginUpdateResource</code> / <code>UpdateResource</code> / <code>EndUpdateResource</code> .  Neuere Versionen rufen diese Funktionen nicht √ºber die API auf.  Ihr Code ist im Schadprogramm selbst implementiert, um zu vermeiden, dass die DLL-Datei ohne eine gef√§lschte VERSIONINFO-Ressource auf die Festplatte geschrieben wird.  Vermutlich wird dadurch die Erkennung bestimmter Sicherheitsprodukte vermieden.  Dieselbe Pipette kann sch√§dliche DLL-Dateien mit unterschiedlichen Beschreibungen auf verschiedenen Computern erstellen.  Jedes auf diese Weise erweiterte Muster hat einen eindeutigen Hash. <br><br>  Wenn die Malware bereits auf dem System vorhanden ist, kann der Dropper sie mithilfe der Named Pipe aktualisieren. <br><br>  In der letzten Phase l√∂scht sich der Dropper selbst, indem er die Datei mit Nullen √ºberschreibt und von der Festplatte l√∂scht.  Dropper l√∂scht auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USN-Magazin</a> .  Aktionen werden √ºber die folgenden Shell-Befehle ausgef√ºhrt: <br><br> <code>timeout 2 &gt; nul &amp; fsutil file setzerodata offset=0 length=%DROPPER_FILESIZE% "%DROPPER_PATH%" &amp; timeout 2 &amp; cmd /c del /F /Q "%DROPPER_PATH%" &amp; fsutil usn deletejournal /D %DROPPER_DRIVE%</code> <br> <br><h4>  Konfiguration und Kommunikation </h4><br>  Der von den Bedienern ausgew√§hlte Persistenzmodus wirkt sich nicht auf die Funktionalit√§t des Schadprogramms aus, die bei beiden Methoden unver√§ndert bleibt. <br><br>  Sch√§dliche Software enth√§lt eine eingebettete Konfiguration, die mit dem AES-256-Algorithmus verschl√ºsselt und mit LZNT1 komprimiert wird. <br><br>  Das Mehrkomponenten-MIME-Format wird f√ºr die Konfiguration eingebetteter Malware verwendet.  Die Autoren haben keinen eigenen Parser f√ºr dieses Format implementiert.  Stattdessen verwenden sie die COM-Schnittstellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IMimeMessage</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IMimeBody</a> .  Interessanterweise wird in der Microsoft-Dokumentation davon abgeraten, diese Schnittstellen zu verwenden. <br><br><img src="https://habrastorage.org/webt/wr/uw/mb/wruwmbzmf4phjtbinjintm9ryfw.png"><br>  <i>Abbildung 11. Beispiel f√ºr eine integrierte GreyEnergy-Konfiguration</i> <br><br>  F√ºr die externe Konfiguration wird das identische MIME-Format verwendet.  Die Malware verschl√ºsselt die externe Konfiguration jedoch auf verschiedene Weise.  Es verwendet die DPAPI (Data Protection Application Programming Interface), insbesondere die Windows-API-Funktionen <code>CryptProtectData</code> und <code>CryptUnprotectData</code> .  Die externe Konfiguration wird im folgenden Pfad <code>C:\ProgramData\Microsoft\Windows\%GUID%</code> gespeichert <code>C:\ProgramData\Microsoft\Windows\%GUID%</code> , wobei <code>%GUID%</code> ein zuf√§llig generierter GUID-Wert ist, der auf der Seriennummer des Laufwerks C: basiert. <br><br>  Einige GreyEnergy-Beispiele enthalten eine etwas verschleierte Version der Konfiguration.  Insbesondere enthalten die <code>Type</code> solcher Konfigurationen Buchstaben anstelle von Optionsnamen. <br><br><img src="https://habrastorage.org/webt/wj/dl/7-/wjdl7-_lpzwki1oifgi_awjctxy.png"><br>  <i>Abbildung 12. Ein Beispiel f√ºr eine verschleierte GreyEnergy-Konfiguration</i> <br><br>  Die Konfiguration kann folgende Werte enthalten: <br><br><img src="https://habrastorage.org/webt/yo/_s/8e/yo_s8eqfgp-xgxf3mooreev9tmo.png"><br><br>  Die Malware entfernt sich selbst vom infizierten System, wenn die Anzahl der erfolglosen Versuche den Wert von <code>MaxAttempts</code> √ºberschreitet und die letzte erfolgreiche Verbindung vor mehr als <code>Lifetime</code> <code>MaxAttempts</code> hat. <br><br>  Die Kommunikation mit C &amp; C erfolgt normalerweise √ºber HTTPS.  In einigen F√§llen wird jedoch auch HTTP verwendet.  Das gleiche MIME-Format ist in HTTP-Anforderungen gekapselt.  Es ist erw√§hnenswert, dass die Daten mit AES-256 und RSA-2048 verschl√ºsselt werden. <br><br><img src="https://habrastorage.org/webt/b1/g8/6d/b1g86dydvt2stlutlwkgy79ydem.png"><br>  <i>Abbildung 13. In Wireshark erfasste GreyEnergy √ºber HTTP-Kommunikation</i> <br><br>  Wenn Sie HTTP verwenden, ist es einfacher, einen gef√§hrdeten Computer im Netzwerk zu identifizieren, indem Sie den Netzwerkverkehr analysieren.  In den untersuchten Malware-Beispielen wurden immer die folgenden fest codierten Benutzeragenten verwendet: <br><br><ul><li> <code>Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko</code> </li> <li> <code>Mozilla/5.0 (compatible, MSIE 11, Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko</code> </li> </ul><br>  Damit GreyEnergy-Betreiber infizierte Computer identifizieren k√∂nnen, sendet die Malware die Ergebnisse der folgenden WQL-Abfragen an den C &amp; C-Server: <br><br><ul><li> <code>SELECT Caption, Version, CSName, ProductType, CurrentTimeZone, LocalDateTime, OSLanguage, OSType FROM Win32_OperatingSystem</code> </li> <li> <code>SELECT MACAddress, IPAddress, IPSubnet, DHCPEnabled, DHCPServer, DNSDomain FROM Win32_NetworkAdapterConfiguration WHERE MACAddress IS NOT NULL</code> </li> </ul><br>  Die Antworten des C &amp; C-Servers sind verschl√ºsselt, enthalten jedoch nach der Entschl√ºsselung dasselbe MIME-Format mit den folgenden m√∂glichen Werten: <br><img src="https://habrastorage.org/webt/go/am/pd/goampdwrvmb0ospdus377v4jvj8.png"><br><br>  GreyEnergy l√§dt zus√§tzliche Module und Nutzdaten mit einem eigenen PE-Dateilader in den Speicher. <br><br><h4>  GreyEnergy-Module </h4><br>  Wie viele komplexe Bedrohungen verf√ºgt auch die GreyEnergy-Malware √ºber eine modulare Architektur.  Die Funktionalit√§t kann durch Hinzuf√ºgen zus√§tzlicher Module erweitert werden.  Das GreyEnergy-Modul ist eine DLL-Datei, die durch Aufrufen einer Funktion mit der ersten Sequenznummer ausgef√ºhrt wird.  Jedes Modul, einschlie√ülich des Hauptmoduls GreyEnergy, akzeptiert Textbefehle mit verschiedenen Parametern. <br><br>  GreyEnergy-Bediener senden nicht sofort alle Module an eine gef√§hrdete Maschine.  In der Regel l√§dt ein Schadprogramm die zur Ausf√ºhrung bestimmter Aufgaben erforderlichen Module herunter und f√ºhrt sie aus. <br><br>  Wir sind uns der Existenz der folgenden GreyEnergy-Module bewusst: <br><br>  <code>remoteprocessexec</code> - <code>remoteprocessexec</code> eine bin√§re RE-Datei in einen Remote-Prozess ein <br>  <code>info</code> - sammelt Systeminformationen, Ereignisprotokolle und SHA-256-Malware <br>  <code>file</code> - Dateisystemoperationen <br>  <code>sshot</code> - macht Screenshots <br>  <code>keylogger</code> - f√§ngt Tastenanschl√§ge ab <br>  <code>passwords</code> - Sammelt Passw√∂rter, die in verschiedenen Anwendungen gespeichert sind <br>  <code>mimikatz</code> - <code>mimikatz</code> Tool zum Sammeln von Windows-Anmeldeinformationen <br>  <code>plink</code> - <code>plink</code> Software zum Erstellen von SSH-Tunneln <br>  <code>3proxy</code> - <code>3proxy</code> Software zum Erstellen von Proxys <br><br>  Mit <code>remoteprocessexec</code> Modul <code>remoteprocessexec</code> kann ein Angreifer beliebige Bin√§rdateien im Kontext vorhandener Prozesse ausf√ºhren.  Sie k√∂nnen beispielsweise Mimikatz oder einen Port-Scanner im Kontext von Windows Explorer ausf√ºhren, ohne sie auf der Festplatte abzulegen.  Um Standardausgabe- und Prozessthreads umzuleiten und den Prozess zu beenden, f√§ngt das Modul f√ºnf Windows-API-Funktionen ab. <br><br><img src="https://habrastorage.org/webt/vn/c9/2a/vnc92aap-hqdl_ps_0r-tzj4ngc.png"><br>  <i>Abbildung 14. Von remoteprocessexec erfasste Windows-API-Funktionen</i> <br><br>  Da die zur√ºckgesetzte GreyEnergy-DLL f√ºr jeden infizierten Computer eindeutig ist, k√∂nnen Angreifer mithilfe des Informationsmoduls SHA-256-Hashes sammeln.  Durch das Vorhandensein von Hashes k√∂nnen Sie verfolgen, ob die Datei auf √∂ffentliche Webdienste wie VirusTotal hochgeladen wurde. <br><br><h4>  Reverse Protection und Anti-Criminal-Methoden </h4><br>  GreyEnergy verwendet verschiedene Methoden, um die Analyse zu erschweren.  Beispielsweise verschl√ºsselt ein Malware-Programm Zeichenfolgen.  Einige Optionen verwenden denselben Algorithmus wie GreyEnergy mini. <br><br>  Die meisten GreyEnergy-Beispiele haben jedoch einen anderen Verschl√ºsselungsalgorithmus.  Insbesondere werden die ersten vier Bytes in einem verschl√ºsselten Blob nicht als Schl√ºssel f√ºr XOR-Operationen verwendet.  Stattdessen werden sie verwendet, um die Anfangsnummer des Pseudozufallszahlen-Generierungsalgorithmus ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mersenne Whirlwind</a> ) zu initialisieren, und dann sind die generierten vier Bytes der Schl√ºssel.  Vor dem Freigeben eines Speicherpuffers mit einer Zeichenfolge aus einfachem Text √ºberschreibt die Malware den Puffer mit Nullen. <br><br><img src="https://habrastorage.org/webt/on/px/a6/onpxa6j99a73zoqabotlcujmfyu.png"><br>  <i>Abbildung 15. Dekompilierter Code f√ºr die GreyEnergy-Zeichenfolgendecodierungsfunktion</i> <br><br>  Das Schadprogramm f√§ngt die <code>DeleteFileW</code> <code>DeleteFileA</code> und <code>DeleteFileW</code> in der <code>DeleteFileW</code> jeder in den Speicher geladenen bin√§ren PE-Datei ab.  Der Hook ersetzt diese Funktionen durch Funktionen, mit denen Dateien sicher gel√∂scht werden.  Insbesondere wird die Datei mit Nullen √ºberschrieben, bevor sie von der Festplatte gel√∂scht wird.  Jede Nutzlast oder jedes Plugin verwendet eine solche Funktion, ohne dass sie in jedem Modul implementiert werden muss. <br><br><img src="https://habrastorage.org/webt/h1/ii/9y/h1ii9yhj8un7_f4zsauhxcaf4wg.png"><br>  <i>Abbildung 16. Dekompilierter Code f√ºr eine Routine, die DeleteFileA und DeleteFileW abf√§ngt</i> <br><br><h2>  Die Werkzeuge </h2><br>  Angreifer verwendeten den Nmap-Port-Scanner als Hauptwerkzeug f√ºr die Zuordnung der internen Netzwerke des Opfers.  Dar√ºber hinaus haben wir die Verwendung eines leichten benutzerdefinierten Port-Scanners beobachtet, bei dem Nmap nicht m√∂glich war. <br><br><img src="https://habrastorage.org/webt/6s/6p/wu/6s6pwugb_rufwoeytkhlkorgc_m.png"><br>  <i>Abbildung 17. Konsolenausgabe eines benutzerdefinierten GreyEnergy-Gruppenport-Scanners</i> <br><br>  Angreifer verwenden aktiv legitime Tools wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SysInternals PsExec</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WinExe</a> f√ºr horizontale Bewegungen in gef√§hrdeten Netzwerken.  Das WinExe-Tool, das Open-Source-Analogon von WinExe, kann von einem Linux-Ger√§t aus gesteuert werden, z. B. von einem kompromittierten Linux-Webserver. <br><br>  Es ist erw√§hnenswert, dass Angreifer zus√§tzlich zu diesen Tools PowerShell-Skripte verwenden. <br><br><h2>  Webserver-Hintert√ºren </h2><br>  Wie bereits erw√§hnt, stellt die GreyEnergy-Gruppe zus√§tzliche Backdoors f√ºr Webserver bereit, wenn auf diese Server √ºber das Internet zugegriffen werden kann.  Wir haben festgestellt, dass Angreifer f√ºr diesen Zweck in PHP geschriebene Backdoors verwenden.  Sie verwenden die √∂ffentlich zug√§ngliche PHP-Web-Shell WSO-Webshell und c99shell. <br><br>  Angreifer k√∂nnen ein vorhandenes PHP-Skript auf einem Webserver √§ndern oder ein neues bereitstellen.  Der eigentliche Backdoor-PHP-Code verbirgt normalerweise mehrere Ebenen der Verschleierung und Verschl√ºsselung. <br><br><img src="https://habrastorage.org/webt/zo/ri/hz/zorihzdc7ajclfmonz_fcia53yy.png"><br>  <i>Abbildung 18. Verschleierter Code der PHP-Hintert√ºr der GreyEnergy-Gruppe</i> <br><br>  Die letzte Codeebene ist durch Stream-Verschl√ºsselung gesch√ºtzt.  Die Schl√ºsselgenerierung f√ºr diese Verschl√ºsselung basiert auf einer Zeichenfolge aus dem Cookie-Wert, den die Angreifer √ºber eine HTTP-Anforderung bereitgestellt haben.  Jede solche PHP-Backdoor wird mit einem separaten Schl√ºssel verschl√ºsselt. <br><br><img src="https://habrastorage.org/webt/cs/8t/yh/cs8tyhnegnb6c1rk1avs7dxfgtk.png"><br>  <i>Abbildung 19. Die letzte Ebene, die der PHP-Backdoor-Code dekodiert</i> <br><br>  Die Verschleierungstechnik wird verwendet, um eine Analyse sowie die Unm√∂glichkeit der Verwendung einer solchen PHP-Hintert√ºr durch andere Cybergruppen zu verhindern. <br><br><h2>  Proxy C &amp; C (Triulin) </h2><br>  Wie bereits erw√§hnt, k√∂nnen Angreifer den internen Server als C &amp; C-Proxy verwenden. <br><br>  Wir haben festgestellt, dass die Angreifer sogar Ketten von C &amp; C-Proxys erstellt haben, in denen der erste derartige Server den Netzwerkverkehr zum n√§chsten umleiten kann usw., bis er das endg√ºltige Ziel im Internet erreicht. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angreifer verwenden verschiedene Methoden, um den internen Server in einen C &amp; C-Proxy zu verwandeln. </font><font style="vertical-align: inherit;">Zu diesem Zweck k√∂nnen sie direkt die GreyEnergy-Malware, zus√§tzliche Software oder Skripte von Drittanbietern verwenden. </font><font style="vertical-align: inherit;">Im ersten Fall k√∂nnen Bediener den Windows-Server mithilfe von GreyEnergy kompromittieren und ihn mithilfe der Module 3proxy und plink in einen C &amp; C-Proxy verwandeln. </font><font style="vertical-align: inherit;">Bei der √úberwachung der GreyEnergy-Aktivit√§t haben wir die Installation der folgenden legitimen Programme auf internen Linux-Servern beobachtet:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3proxy kleiner Proxy </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dante SOCKS Server </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PuTTY Link (Plink) </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstelle von Software von Drittanbietern k√∂nnen Angreifer interne Webserver verwenden, indem sie ihre eigenen Skripts auf ihnen installieren. Die Programmiersprachen PHP und ASP werden verwendet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In allen beobachteten F√§llen wurden die bereitgestellten PHP-Skripte mit der gleichen Art der Verschleierung wie in Backdoors f√ºr Webserver verschleiert und verschl√ºsselt. In diesem Fall wird das Cookie mit dem Entschl√ºsselungsschl√ºssel jedoch von der GreyEnergy-Malware selbst bereitgestellt. Aus diesem Grund sollten Betreiber ein spezielles Konfigurationsformat f√ºr die Server-URL verwenden. </font></font><br><br><img src="https://habrastorage.org/webt/ms/tm/84/mstm84awqgzzm0rxykrmni1ocmw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 20. Die letzte Ebene, die den PHP-Backdoor-Code mithilfe eines Cookies entschl√ºsselt.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Interessanterweise enth√§lt die Malware-Konfiguration das Wort </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Triungulin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auf dem Weg zum verschleierten PHP-Skript des Proxyservers. </font><font style="vertical-align: inherit;">Dies scheint der interne Name dieser Methode zu sein, die von den GreyEnergy-Anweisungen verwendet wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn das Schadprogramm in der Konfiguration einen integrierten C &amp; C-Proxy hat, enth√§lt es keine externen C &amp; C-Server. </font><font style="vertical-align: inherit;">Um die externe C &amp; C-Adresse zu finden, ben√∂tigen Sie daher sowohl ein Malware-Beispiel als auch alle damit verbundenen PHP-Skripte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben die Verwendung der folgenden PHP-Skripte beobachtet:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> benutzerdefiniertes PHP-Proxy-Skript </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leicht modifizierte Version von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antichat Socks5 Server</font></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein benutzerdefiniertes PHP-Proxy-Skript enth√§lt eine URL mit einem externen C &amp; C-Header. </font></font><br><br><img src="https://habrastorage.org/webt/z1/il/bq/z1ilbqnz3shhbn__app1xhpgtem.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 21. Ein externer C &amp; C-Server, der in das benutzerdefinierte PHP-Proxyserverskript eingebettet ist Das benutzerdefinierte PHP-</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Skript verwendet die OpenSSL- und Curl-Bibliotheken, um die Anforderung von der Malware an den externen C &amp; C-Server im Internet umzuleiten. </font></font><br><br><img src="https://habrastorage.org/webt/ph/bc/20/phbc20w7dx91bjkhopbartak4cw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 22. Code f√ºr das benutzerdefinierte PHP-Skript des GreyEnergy-Gruppenproxyservers</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wie oben erw√§hnt, k√∂nnen Angreifer ASP-Skripte f√ºr denselben Zweck verwenden. In einem von uns beobachteten Fall verwendete das ASP-Skript ein von der Malware bereitgestelltes Cookie, um nur die echte C &amp; C-Adresse mit AES zu entschl√ºsseln. Der Rest des Codes wurde nicht verschl√ºsselt oder verschleiert. </font></font><br><br><img src="https://habrastorage.org/webt/y-/2k/tq/y-2ktq8-zcd2m9e70sobitai9se.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 23. Von der GreyEnergy-Gruppe verwendeter ASP-Proxy-Code</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C &amp; C-Server mit Internetzugang </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle GreyEnergy C &amp; C-Server verwendeten Tor, als sie aktiv waren. </font><font style="vertical-align: inherit;">Die Einstellungen der C &amp; C-Infrastruktur √§hneln denen von BlackEnergy, TeleBots und Industroyer, die auch Tor-Server verwendeten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wahrscheinlich hat jeder C &amp; C-Server eine Zwiebeladresse, mit der Angreifer auf Daten zugreifen, diese verwalten oder √ºbertragen k√∂nnen. </font><font style="vertical-align: inherit;">Dies scheint eine OPSEC-Anforderung zu sein, die Angreifern eine zus√§tzliche Anonymit√§tsebene verleiht. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESET-Experten haben die C &amp; C-Server identifiziert, die in den letzten drei Jahren von der GreyEnergy-Malware verwendet wurden. </font><font style="vertical-align: inherit;">Die Liste finden Sie weiter unten im Abschnitt ‚ÄûKompromissindikatoren‚Äú.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vergleich von GreyEnergy und BlackEnergy </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Malware-Familien GreyEnergy und BlackEnergy haben dieselbe Struktur, dieselbe Reihe von Modulen und Funktionen. </font><font style="vertical-align: inherit;">Obwohl die Implementierung dieser Funktionen unterschiedlich ist, sind sie immer noch vergleichbar.</font></font><br><img src="https://habrastorage.org/webt/mn/zc/sj/mnzcsjrof8t61sfkfi3lzs15p8k.png"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Dezember 2016 starteten Angreifer einen Wurm, der unserer Meinung nach der Vorg√§nger von NotPetya war (auch bekannt als Petya, ExPetr, Nyetya, EternalPetya). Der Wurm wurde bei Angriffen auf eine kleine Anzahl von Objekten verwendet und hatte begrenzte Verteilungsm√∂glichkeiten, so dass er nicht allgemein bekannt war. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Wurm ist eine DLL-Datei mit einem Namen </font></font><code>msvcrt120b.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">im Windows-Verzeichnis. Der interne Dateiname ist </font></font><code>moonraker.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, was vielleicht ein Hinweis auf den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Film</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und den gleichnamigen </font><font style="vertical-align: inherit;">Bond- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Roman ist</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Im Allgemeinen haben wir das Programm Moonraker Petya genannt. </font></font><br><br><img src="https://habrastorage.org/webt/21/ez/o5/21ezo5wz4iwkebpqamk88nnuv3e.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 24. Der interne Name des im Dezember 2016 installierten Wurms</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der PE-Zeitstempel in der DLL deutet darauf hin, dass die Datei im Dezember 2016 kompiliert wurde, vermutlich kurz vor der Installation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moonraker Petya enth√§lt Code, nach dem der Computer nicht mehr geladen wird. Insbesondere wird der Wert </font></font><code>ImagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in den Registrierungsschl√ºsseln </font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet001\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font><font style="vertical-align: inherit;">√ºberschrieben</font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet002\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und l√∂scht den ersten Sektor des Systemlaufwerks. Im Gegensatz zu NotPetya enth√§lt Moonraker Petya keinen Code, der direkt mit MBR und dem Bootloader des Betriebssystems interagiert. Stattdessen enth√§lt die Moonraker Petya DLL einen verschl√ºsselten Bin√§rdaten-Blob. Die Malware erwartet ein Befehlszeilenargument, das sp√§ter als Entschl√ºsselungsschl√ºssel verwendet wird. Nach dem Entschl√ºsseln und Entpacken mit der zlib-Bibliothek wird der Code als bin√§re RE-Datei in den Speicher geladen und ausgef√ºhrt. Wir haben keinen Entschl√ºsselungsschl√ºssel, aber wir haben die Disk-Images infizierter Computer analysiert. Sie enthielten den MBR- und Bootloader-Code, der dem Code des urspr√ºnglichen Green Petya entspricht, der von verschiedenen Cybergruppen verwendet wird. Wir gehen davon aus, dass der Blob die urspr√ºngliche gr√ºne Petja enthalten kann.</font></font><br><br><img src="https://habrastorage.org/webt/ok/4h/pk/ok4hpk-oion7dmngxdeo0ud8tka.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 25. Der Popup-Bildschirm, der nach dem Neustart auf mit Moonraker Petya infizierten Computern angezeigt wird.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist interessant, dass die Entschl√ºsselung in Moonraker Petya dem gleichen Vorgang in GreyEnergy DLL-Dateien im Modus "Nur im Speicher" sehr √§hnlich ist. </font></font><br><br><img src="https://habrastorage.org/webt/mb/ef/mq/mbefmqjst4qziv5a8wxnrggyxky.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 26. Vergleich von dekompiliertem Moonraker Petya-Code (links) und GreyEnergy (rechts)</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya- </font><i><font style="vertical-align: inherit;">Code</font></i><font style="vertical-align: inherit;"> kann mit SysInternals PsExec √ºber ein lokales Netzwerk verteilt werden. Sch√§dliche Programme enthalten zlib-komprimierte Bin√§rdateien in ihren Ressourcen. Sp√§ter wird die Bin√§rdatei mit dem Dateinamen in das Windows-Verzeichnis geschrieben </font></font><code>conhost.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieses Schadprogramm ist in </font><font style="vertical-align: inherit;">√§hnlicher Weise NotPetya verteilt: aufz√§hlt Netzknoten mit </font><font style="vertical-align: inherit;">unterschiedlichen Methoden ( </font></font><code>WNetEnumResourceW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetIpNetTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetExtendedTcpTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>NetServerEnum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, TERMSRV-Aufzeichnungen mit</font></font><code>CredEnumerateW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), stellt dann √ºber die Funktion eine Verbindung zum Netzwerkhost her </font></font><code>WNetAddConnection2W</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und speichert die Malware als </font></font><code>\\%TARGET-HOST%\admin$\%MALWARE%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Danach f√ºhrt Moonraker Petya den folgenden Befehl aus, mit dem das Schadprogramm auf dem Remotecomputer mithilfe von PsExec zur√ºckgesetzt wird: </font></font><br><br> <code>C:\Windows\conhost.exe \\%TARGET-HOST% -accepteula -s -d C:\Windows\System32\rundll32.exe "C:\Windows\msvcrt120b.dll", #1 %TIMEOUT% "USER1:PASSWORD1;USER2:PASSWORD2" "%DECRYPTIONKEY%"</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist wichtig zu beachten, dass das Schadprogramm keine Funktionen zum Sammeln von Anmeldeinformationen mithilfe von Mimikatz hat und den EternalBlue-Exploit nicht enth√§lt. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zus√§tzlich zu den aufgef√ºhrten Funktionen unterst√ºtzt Moonraker Petya auch die Dateiverschl√ºsselung. Das Schadprogramm scannt alle Dateien auf den Festplatten und versucht anschlie√üend, sie mit dem AES-256-Algorithmus zu verschl√ºsseln. Nach Abschluss des Verschl√ºsselungsprozesses kann Malware eine Datei </font></font><code>README.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mit Zahlungsanweisungen </font><font style="vertical-align: inherit;">erstellen </font><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Anweisung enth√§lt einen pers√∂nlichen Schl√ºssel, der mit RSA-2048 verschl√ºsselt wurde. Dar√ºber hinaus enth√§lt es den gleichen Text und die gleichen Zwiebeladressen wie die urspr√ºngliche gr√ºne Petja. Es scheint, dass die Angreifer die Verwendung dieser Malware als Angriff auf Green Petya tarnen wollten. </font></font><br><br><img src="https://habrastorage.org/webt/9f/i3/qu/9fi3quz_fckxngvtzjm6eay2svy.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abbildung 27. Readme-Datei mit Zahlungsanweisungen von Moonraker Petya</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Als letzten Schritt versucht Moonraker Petya, den Computer neu zu starten.</font></font><br><br><h2>  Fazit </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GreyEnergy ist ein wichtiger Teil des Arsenals einer der gef√§hrlichsten ART-Gruppen, die in den letzten Jahren ukrainische Ziele angegriffen haben. Wir sehen sie als Nachfolgerin von BlackEnergy. √Ñhnlichkeiten und Unterschiede sind in diesem Beitrag aufgef√ºhrt. Die Hauptgr√ºnde, warum wir zu diesem Schluss gekommen sind, sind eine √§hnliche Struktur von Malware, eine Auswahl von Zielen und Arbeitsmethoden. Der √úbergang von BlackEnergy zu GreyEnergy erfolgte Ende 2015 - m√∂glicherweise, weil Angreifer die Malware-Suite aktualisieren mussten, nachdem sie verst√§rkt auf die BlackEnergy-Infrastruktur geachtet hatten.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein interessanter Teil des Puzzles ist die Tatsache, dass Moonraker Petya im Juni 2016 verwendet wurde, das nach unseren Sch√§tzungen der Vorg√§nger des zerst√∂rerischen Programms NotPetya ist. </font><font style="vertical-align: inherit;">Dies kann darauf hinweisen, dass die Gruppen TeleBots und GreyEnergy zusammenarbeiten oder zumindest Code und einige Ideen austauschen. </font><font style="vertical-align: inherit;">Wir betrachten sie jedoch als separate Gruppen, deren Ziele etwas anders sind. </font><font style="vertical-align: inherit;">Zum Zeitpunkt des Schreibens haben wir die beabsichtigten Aktivit√§ten von TeleBots au√üerhalb der Ukraine im Gegensatz zu GreyEnergy und BlackEnergy zuvor nicht gesehen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In jedem Fall stellen GreyEnergy-Betreiber eine ernsthafte Gefahr dar. </font><font style="vertical-align: inherit;">Wir √ºberwachen weiterhin die Aktivit√§ten von GreyEnergy und TeleBots und empfehlen privaten und gesch√§ftlichen Benutzern, die fortschrittlichsten Produkte zum Schutz von Endpunkten zu verwenden.</font></font><br><br><h2>  Kompromissindikatoren </h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erkennung durch ESET-Produkte: </font></font></h4><br> <code>VBA/TrojanDownloader.Agent.EYV <br> Win32/Agent.SCT <br> Win32/Agent.SCM <br> Win32/Agent.SYN <br> Win64/Agent.SYN <br> Win32/Agent.WTD <br> Win32/GreyEnergy <br> Win64/GreyEnergy <br> Win32/Diskcoder.MoonrakerPetya.A <br> PHP/Agent.JS <br> PHP/Agent.JX <br> PHP/Agent.KJ <br> PHP/Agent.KK <br> PHP/Agent.KL <br> PHP/Agent.KM <br> PHP/Agent.KN <br> PHP/Agent.KO <br> PHP/Agent.KP <br> PHP/Agent.KQ <br> PHP/Agent.KR <br> PHP/Agent.KS <br> PHP/Agent.KT <br> PHP/Agent.KU <br> PHP/Agent.LC <br> PHP/Agent.NBP <br> PHP/Kryptik.AB <br> PHP/TrojanProxy.Agent.B <br> ASP/Agent.L <br> Win64/HackTool.PortScanner.A <br> Win64/Riskware.Mimikatz.A <br> Win64/Riskware.Mimikatz.AE <br> Win64/Riskware.Mimikatz.AH <br> Win32/Winexe.A <br> Win64/Winexe.A <br> Win64/Winexe.B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy-Dokument: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>177AF8F6E8D6F4952D13F88CDF1887CB7220A645</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy mini: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>455D9EB9E11AA9AF9717E0260A70611FF84EF900 <br> 51309371673ACD310F327A10476F707EB914E255 <br> CB11F36E271306354998BB8ABB6CA67C1D6A3E24 <br> CC1CE3073937552459FB8ED0ADB5D56FA00BCD43 <br> 30AF51F1F7CB9A9A46DF3ABFFB6AE3E39935D82C</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy-Tropfer: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>04F75879132B0BFBA96CB7B210124BC3D396A7CE <br> 69E2487EEE4637FE62E47891154D97DFDF8AAD57 <br> 716EFE17CD1563FFAD5E5E9A3E0CAC3CAB725F92 <br> 93EF4F47AC160721768A00E1A2121B45A9933A1D <br> 94F445B65BF9A0AB134FAD2AAAD70779EAFD9288 <br> A414F0A651F750EEA18F6D6C64627C4720548581 <br> B3EF67F7881884A2E3493FE3D5F614DBBC51A79B <br> EBD5DC18C51B6FB0E9985A3A9E86FF66E22E813E <br> EC7E018BA36F07E6DADBE411E35B0B92E3AD8ABA</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zur√ºcksetzbare GreyEnergy-DLLs: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0B5D24E6520B8D6547526FCBFC5768EC5AD19314 <br> 10D7687C44BECA4151BB07F78C6E605E8A552889 <br> 2A7EE7562A6A5BA7F192B3D6AED8627DFFDA4903 <br> 3CBDC146441E4858A1DE47DF0B4B795C4B0C2862 <br> 4E137F04A2C5FA64D5BF334EF78FE48CF7C7D626 <br> 62E00701F62971311EF8E57F33F6A3BA8ED28BF7 <br> 646060AC31FFDDFBD02967216BC71556A0C1AEDF <br> 748FE84497423ED209357E923BE28083D42D69DE <br> B75D0379C5081958AF83A542901553E1710979C7 <br> BFC164E5A28A3D56B8493B1FC1CA4A12FA1AC6AC <br> C1EB0150E2FCC099465C210B528BF508D2C64520 <br> CBB7BA92CDF86FA260982399DAB8B416D905E89B <br> DF051C67EE633231E4C76EC247932C1A9868C14F <br> DFD8665D91C508FAF66E2BC2789B504670762EA2 <br> E2436472B984F4505B4B938CEE6CAE26EF043FC7 <br> E3E61DF9E0DD92C98223C750E13001CBB73A1E31 <br> E496318E6644E47B07D6CAB00B93D27D0FE6B415 <br> EDA505896FFF9A29BD7EAE67FD626D7FFA36C7B2 <br> F00BEFDF08678B642B69D128F2AFAE32A1564A90 <br> F36ECAC8696AA0862AD3779CA464B2CD399D8099</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy DLL ("nur im Speicher" -Modus): </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0BCECB797306D30D0BA5EAEA123B5BF69981EFF4 <br> 11159DB91B870E6728F1A7835B5D8BE9424914B9 <br> 6ABD4B82A133C4610E5779C876FCB7E066898380 <br> 848F0DBF50B582A87399428D093E5903FFAEEDCD <br> 99A81305EF6E45F470EEE677C6491045E3B4D33A <br> A01036A8EFE5349920A656A422E959A2B9B76F02 <br> C449294E57088E2E2B9766493E48C98B8C9180F8 <br> C7FC689FE76361EF4FDC1F2A5BAB71C0E2E09746 <br> D24FC871A721B2FD01F143EB6375784144365A84 <br> DA617BC6DCD2083D93A9A83D4F15E3713D365960 <br> E4FCAA1B6A27AA183C6A3A46B84B5EAE9772920B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>1AA1EF7470A8882CA81BB9894630433E5CCE4373</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PHP- und ASP-Skripte </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>10F4D12CF8EE15747BFB618F3731D81A905AAB04 <br> 13C5B14E19C9095ABA3F1DA56B1A76793C7144B9 <br> 1BA30B645E974DE86F24054B238FE77A331D0D2C <br> 438C8F9607E06E7AC1261F99F8311B004C23DEC3 <br> 4D1C282F9942EC87C5B4D9363187AFDC120F4DC7 <br> 4E0C5CCFFB7E2D17C26F82DB5564E47F141300B3 <br> 5377ADB779DE325A74838C0815EEA958B4822F82 <br> 58A69A8D1B94E751050DECF87F2572E09794F0F8 <br> 5DD34FB1C8E224C17DCE04E02A4409E9393BCE58 <br> 639BCE78F961C4B9ECD9FE1A8537733388B99857 <br> 7127B880C8E31FBEB1D376EB55A6F878BC77B21A <br> 71BA8FE0C9C32A9B987E2BB827FE54DAE905D65E <br> 78A7FBDD6ADF073EA6D835BE69084E071B4DA395 <br> 81332D2F96A354B1B8E11984918C43FB9B5CB9DB <br> 8CC008B3189F8CE9A96C2C41F864D019319EB2EE <br> 940DE46CD8C50C28A9C0EFC65AEE7D567117941B <br> A415E12591DD47289E235E7022A6896CB2BFDE96 <br> D3AE97A99D826F49AD03ADDC9F0D5200BE46AB5E <br> E69F5FF2FCD18698BB584B6BC15136D61EB4F594 <br> E83A090D325E4A9E30B88A181396D62FEF5D54D5 <br> ECF21EFC09E4E2ACFEEB71FB78CB1F518E1F5724</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzerdefinierter Port-Scanner </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>B371A5D6465DC85C093A5FB84D7CDDEB1EFFCC56 <br> B40BDE0341F52481AE1820022FA8376E53A20040</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mimikatz </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>89D7E0DA80C9973D945E6F62E843606B2E264F7E <br> 8B295AB4789105F9910E4F3AF1B60CBBA8AD6FC0 <br> AD6F835F239DA6683CAA54FCCBCFDD0DC40196BE</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Winexe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1: </font><font style="vertical-align: inherit;">Warnung: Die meisten Server mit diesen IP-Adressen waren Teil des Tor-Netzwerks, dh die Verwendung dieser Indikatoren kann zu Fehlalarmen f√ºhren.</font></font><br> <code>0666B109B0128599D535904C1F7DDC02C1F704F2 <br> 2695FCFE83AB536D89147184589CCB44FC4A60F3 <br> 3608EC28A9AD7AF14325F764FB2F356731F1CA7A <br> 37C837FB170164CBC88BEAE720DF128B786A71E0 <br> 594B809343FEB1D14F80F0902D764A9BF0A8C33C <br> 7C1F7CE5E57CBDE9AC7755A7B755171E38ABD70D <br> 90122C0DC5890F9A7B5774C6966EA694A590BD38 <br> C59F66808EA8F07CBDE74116DDE60DAB4F9F3122 <br> CEB96B364D6A8B65EA8FA43EB0A735176E409EB0 <br> FCEAA83E7BD9BCAB5EFBA9D1811480B8CB0B8A3E</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C &amp; C-Serveradressen GreyEnergy mini </font></font></h4><br> <code>https://82.118.236[.]23:8443/27c00829d57988279f3ec61a05dee75a <br> http://82.118.236[.]23:8080/27c00829d57988279f3ec61a05dee75a <br> https://88.198.13[.]116:8443/xmlservice <br> http://88.198.13[.]116:8080/xmlservice <br> https://217.12.204[.]100/news/ <br> http://217.12.204[.]100/news/ <br> http://pbank.co[.]ua/favicon.ico (IP: 185.128.40.90)</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy C &amp; C-Serveradressen (Aktivit√§tsperioden und IP) </font></font></h4><br> <code>2015‚Äì2016 ‚Äì 109.200.202.7 <br> 2015‚Äì2015 ‚Äì 193.105.134.68 <br> 2015‚Äì2016 ‚Äì 163.172.7.195 <br> 2015‚Äì2016 ‚Äì 163.172.7.196 <br> 2016‚Äì2016 ‚Äì 5.149.248.77 <br> 2016‚Äì2016 ‚Äì 31.148.220.112 <br> 2016‚Äì2016 ‚Äì 62.210.77.169 <br> 2016‚Äì2016 ‚Äì 85.25.211.10 <br> 2016‚Äì2016 ‚Äì 138.201.198.164 <br> 2016‚Äì2017 ‚Äì 124.217.254.55 <br> 2017‚Äì2017 ‚Äì 46.249.49.231 <br> 2017‚Äì2017 ‚Äì 37.59.14.94 <br> 2017‚Äì2017 ‚Äì 213.239.202.149 <br> 2017‚Äì2017 ‚Äì 88.198.13.116 <br> 2017‚Äì2017 ‚Äì 217.12.202.111 <br> 2017‚Äì2017 ‚Äì 176.31.116.140 <br> 2017‚Äì2018 ‚Äì 185.217.0.121 <br> 2017‚Äì2018 ‚Äì 178.150.0.200 <br> 2018‚Äì2018 ‚Äì 176.121.10.137 <br> 2018‚Äì2018 ‚Äì 178.255.40.194 <br> 2018‚Äì2018 ‚Äì 193.105.134.56 <br> 2018‚Äì2018 ‚Äì 94.130.88.50 <br> 2018‚Äì2018 ‚Äì 185.216.33.126</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de426911/">https://habr.com/ru/post/de426911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de426899/index.html">Video Science Meetup Video</a></li>
<li><a href="../de426901/index.html">Die schnellste Kamera der Welt nimmt 10 Billionen Bilder pro Sekunde auf</a></li>
<li><a href="../de426903/index.html">Die Stadt Chengdu m√∂chte einen Satellitenreflektor in die Umlaufbahn bringen, um die Stra√üen mit einem Sonnenfleck von 10 bis 80 km zu beleuchten</a></li>
<li><a href="../de426905/index.html">PVS-Studio 6.26 Release</a></li>
<li><a href="../de426907/index.html">H√§ufige Sicherheitsprobleme im Unternehmensnetzwerk, die mit Check Point Security CheckUP erkannt werden k√∂nnen</a></li>
<li><a href="../de426913/index.html">Wie man Interviews zwischen Berichten und einem kleinen Bericht √ºber DevOops macht</a></li>
<li><a href="../de426915/index.html">NASA Hackathon: Space Apps Challenge</a></li>
<li><a href="../de426917/index.html">Intelligente, sichere Cisco-Plattform f√ºr Unternehmen im digitalen Zeitalter</a></li>
<li><a href="../de426919/index.html">Einf√ºhrung in Microsoft Learn</a></li>
<li><a href="../de426921/index.html">Oh, mein Code: Wie man in der IT erfolgreich wird</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>