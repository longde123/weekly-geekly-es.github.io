<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ò£Ô∏è üßõüèº ‚èØÔ∏è L'automatisation contre le chaos üëàüèª üë©üèæ‚Äçüîß üè°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le d√©veloppement moderne des technologies informatiques a permis de limiter les √©normes flux de donn√©es. 
 L'entreprise dispose de divers outils: CRM,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'automatisation contre le chaos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421705/"><img src="https://habrastorage.org/webt/qz/sq/j9/qzsqj9kwc7g4xeaponeocm3phxy.jpeg"><br><br>  Le d√©veloppement moderne des technologies informatiques a permis de limiter les √©normes flux de donn√©es. <br>  L'entreprise dispose de divers outils: CRM, ERP, BPM, syst√®mes comptables, ou dans des cas extr√™mes juste Excel et Word. <br><br>  Les entreprises sont √©galement diff√©rentes.  Certains sont constitu√©s de nombreuses branches distinctes.  Dans ce cas, l'entreprise a un probl√®me de synchronisation des donn√©es dans le zoo des syst√®mes informatiques.  De plus, les succursales diff√®rent en termes de fournisseurs ou de versions de logiciels.  Et les changements fr√©quents dans les exigences de rapport de la soci√©t√© de gestion provoquent des acc√®s de ¬´joie¬ª incontr√¥l√©s sur le terrain. <br><br>  Cette histoire concerne un projet dans lequel il m'est arriv√© de rencontrer un chaos qui devait √™tre syst√©matis√© et automatis√©.  Un budget modeste et des d√©lais serr√©s ont limit√© l'utilisation de la plupart des solutions industrielles, mais ont ouvert la voie √† la cr√©ativit√©. <br><a name="habracut"></a><br><h2>  Format universel </h2><br>  Le client a d√©fini la t√¢che de collecte des donn√©es pour les rapports de toutes les succursales de l'entreprise.  Pour comprendre l'ampleur de la catastrophe, il existe des dizaines de syst√®mes, y compris des self-made et des monstres tels que SAP, et, bien s√ªr, 1C - o√π sans lui. <br><br>  Dans un rapport, les donn√©es de: tenue de livres, r√©parateurs, sp√©cialistes des relations publiques, minist√®re des Urgences, m√©t√©orologues pourraient se recouper. <br><br>  Avant le d√©marrage du projet, la majeure partie des donn√©es a √©t√© envoy√©e √† la soci√©t√© m√®re par e-mail sous forme de pi√®ces jointes Word / Excel.  De plus, le processus ressemblait √† un coucher de soleil manuel: les donn√©es √©taient trait√©es par des personnes sp√©cialement form√©es et entr√©es dans deux syst√®mes.  Le r√©sultat de ce travail a √©t√© des dizaines de rapports, sur la base desquels des d√©cisions de gestion ont √©t√© prises. <br><br>  Le choix de l'approche a √©t√© motiv√© par le format des fichiers transf√©r√©s, √† savoir xlsx / docx.  M√™me les syst√®mes ¬´anciens¬ª des succursales prenaient en charge le t√©l√©chargement de donn√©es vers ces formats, ou, dans des cas extr√™mes, personne n'a annul√© le copier-coller. <br><br>  Notre plan obstin√© √©tait le suivant: <br><br><ol><li>  d√©crire la structure de chaque rapport et les r√®gles de sa transmission; </li><li>  nous r√©duisons les exigences de mise en place de syst√®mes d'envoi de documents par email selon les r√©glementations aux agences.  L√† o√π il n'y a pas de syst√®me - envoyer, comme auparavant, √† la main; </li><li>  Nous d√©veloppons un programme qui: <br><ul><li>  s√©lectionne certains documents du courrier entrant; </li><li>  en extrait des donn√©es; </li><li>  √©crit les donn√©es extraites dans la base de donn√©es, ainsi que ¬´battre¬ª les contrevenants aux r√®glements. </li></ul><br></li></ol><br><img src="https://habrastorage.org/webt/6b/na/ev/6bnaevbsj113vtojoryl6pkxt2s.png"><br><br><h2>  Impl√©mentation </h2><br><h3>  Questions d'organisation </h3><br>  Au stade de la collecte et de la formalisation des exigences relatives √† la structure et √† la r√©glementation du transfert de donn√©es, il s'est av√©r√© qu'il n'y avait aucune description de la structure des rapports.  Tout √©tait stock√© dans l'esprit de certains employ√©s et transmis sous forme de contes populaires russes de bouche √† oreille.  Mais les vrais probl√®mes ont commenc√© plus tard - lors de la configuration de l'√©change de donn√©es. <br><br><h4>  Probl√®me un </h4><br>  La diff√©rence entre la structure des documents de la r√©f√©rence et la qualit√© des donn√©es.  Dans les rapports, les montants parfois ne convergeaient pas, les colonnes √©taient m√©lang√©es ou avaient des noms incorrects.  Le probl√®me a √©t√© principalement observ√© dans les succursales o√π les donn√©es ont √©t√© saisies manuellement. <br><br>  La solution est la mise en place d'une v√©rification en trois √©tapes: <br><br><ol><li>  Cr√©ation de documents Excel de r√©f√©rence avec une structure rigide, en utilisant Excel lui-m√™me.  Dans ces documents, seules les cellules de saisie de donn√©es √©taient disponibles.  Sur quels contr√¥les suppl√©mentaires ont √©t√© impos√©s: type, convergence des montants, etc. </li><li>  V√©rifie lors de l'extraction des donn√©es du rapport.  Par exemple, une comparaison de la date et de la date actuelles dans un paragraphe d'un document Word ou une v√©rification arithm√©tique des donn√©es d'un document Excel (si elles ne peuvent pas √™tre sp√©cifi√©es dans le document lui-m√™me). </li><li>  Analyse approfondie des donn√©es apr√®s collecte.  Par exemple, la d√©tection d'√©carts significatifs dans les indicateurs cl√©s par rapport aux p√©riodes pr√©c√©dentes. </li></ol><br><h4>  Deuxi√®me probl√®me </h4><br>  Une violation syst√©matique du calendrier de transfert de donn√©es ou des tentatives de sabotage sans scrupules: "En g√©n√©ral, nous n'avons jamais envoy√© de donn√©es √† personne, mais vous √™tes ici avec les miennes ...", "Oui, j'ai tout envoy√© √† temps, c'est probablement un mauvais ping." <br><br>  La solution est le feedback.  Le syst√®me avertit automatiquement les personnes responsables de la succursale en cas de violation d'horaire.  Plus tard, le sous-syst√®me de r√©troaction a √©t√© viss√© au syst√®me de contr√¥le de la qualit√© des donn√©es d'entr√©e et au syst√®me de rapport final, afin que la succursale re√ßoive imm√©diatement un ensemble de donn√©es et une comparaison avec les ¬´voisins¬ª.  <s>Pour expliquer clairement pourquoi il ratisse.</s> <br><br><h3>  Sous-syst√®mes d√©velopp√©s </h3><br><br><ol><li>  Configurateur de types de documents avec donn√©es, dans lequel vous pouvez d√©crire rapidement: <br><ul><li>  des panneaux permettant d'identifier le document; </li><li>  les r√®glements de transfert; </li><li>  algorithme d'extraction de donn√©es; </li><li>  d'autres attributs comme le chemin d'acc√®s au code qui valide et stocke les donn√©es. </li></ul><br></li><li>  Un destinataire du courrier qui d√©place les pi√®ces jointes vers un stockage isol√© (bac √† sable) et stocke les informations connexes sur la lettre; </li><li>  Un analyseur de pi√®ces jointes qui d√©finit les types de documents et en extrait des donn√©es. </li></ol><br><img src="https://habrastorage.org/webt/7s/bp/ef/7sbpefc8oczlxcc6xyrauq4309y.png"><br><br><h4>  Configurateur </h4><br>  Historiquement, tous les documents contenant des donn√©es sont envoy√©s au courrier g√©n√©ral, o√π il est plein d'autres lettres importantes et pas si.  Nous avons besoin de signes permettant de d√©terminer les documents n√©cessaires.  Le nom du document ou le texte dans le corps de l'e-mail n'est ni fiable ni pratique pour l'exp√©diteur.  Il a donc √©t√© d√©cid√© que la composition du rapport ne serait d√©termin√©e que par le contenu du document.  En outre, vous devez d√©terminer sans ambigu√Øt√© quel type de rapport contient le document. <br><br>  Ils ont trouv√© un raifort de brainstorming qui sait combien de signes pour identifier un document: couleur du texte dans une cellule, police, etc.  Mais le plus correct √©tait le signe de la pr√©sence d'une sous-cha√Æne dans une certaine ¬´fente¬ª de cellule ou un tableau de cellules pour Excel et un paragraphe ou un en-t√™te pour Word.  Une logique formelle simple a √©t√© ajout√©e pour le ¬´slot¬ª: ¬´√©gal¬ª, ¬´in√©gal¬ª, ¬´plus¬ª, ¬´moins¬ª, etc. Exemple pour Excel: dans la plage A2-E4, le texte de la cellule doit √™tre √©gal √† ¬´R√©sum√© quotidien du chargement de l'√©quipement¬ª. <br><br><img src="https://habrastorage.org/webt/km/aj/ea/kmajeaf8og5y17cnfronq3x2wmq.png"><br><br>  La zone de document dans laquelle vous souhaitez rechercher le d√©but et la fin des donn√©es est configur√©e de mani√®re similaire (environ Conditions de recherche de la fin: 2 lignes vides de suite). <br><br><img src="https://habrastorage.org/webt/u1/9t/hh/u19thhrwphi6bbdfifx1bt6tk84.png"><br><br>  D'autres param√®tres utiles incluent une liste d'exp√©diteurs r√©solus, un type de document (Excel / Word) et un chemin pour exporter les donn√©es. <br><br>  En sortie, nous obtenons une structure JSON (mod√®le) qui d√©crit le rapport. <br><br><h4>  Destinataire du courrier </h4><br>  Un lecteur de messagerie qui place tous les documents des pi√®ces jointes dans le bac √† sable, enregistre les attributs de la lettre et place les documents dans la file d'attente des t√¢ches pour l'analyse. <br><br>  Il y a 2 questions de s√©curit√©: <br><br><ol><li>  Et si les donn√©es sont envoy√©es √† une autre succursale? </li><li>  que faire si les donn√©es sont envoy√©es par des attaquants? </li></ol><br>  Le premier probl√®me est r√©solu en rapprochant l'adresse e-mail de la branche d'envoi et la branche sp√©cifi√©e dans le corps du rapport. <br><br>  Le second utilise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SPF</a> . <br><br><h4>  Analyseur de pi√®ces jointes </h4><br>  Presque toutes les biblioth√®ques pour analyser Word et Excel ont de s√©rieuses limitations sur les versions prises en charge, donc pour commencer le document doit √™tre converti.  Libre Office r√©sout ce probl√®me par cinq. <br><br>  Apr√®s la conversion: <br><br><ol><li>  nous filtrons un tableau de mod√®les en fonction des caract√©ristiques de base du configurateur (Word / Excel, exp√©diteur ...); </li><li>  ex√©cutez le document avec les mod√®les restants; </li><li>  si le mod√®le est trouv√©, nous extrayons les donn√©es et les transf√©rons dans le r√©f√©rentiel. </li></ol><br><h2>  R√©sum√© </h2><br>  Nous l'avons fait! <br>  Apr√®s deux mois de travail minutieux, le si√®ge social a commenc√© √† recevoir r√©guli√®rement des donn√©es pour les rapports de toutes les succursales.  De plus, la qualit√© et l'exhaustivit√© des donn√©es √©taient sans pr√©c√©dent diff√©rentes de ce qu'elles √©taient auparavant, et les ressources humaines lib√©r√©es ont r√©cup√©r√© les co√ªts du projet √† la fin de l'ann√©e. <br><br>  Pour nous, nous avons appris que l'int√©gration n'est pas toujours douloureuse et avons soulign√© les principaux aspects de la r√©ussite: <br><br><ol><li>  nous ne sommes pas entr√©s dans les syst√®mes dans les succursales; </li><li>  officialis√© et approuv√© une structure unique de rapports et de r√©glementations pour leur transmission; </li><li>  cr√©√© des mod√®les de formats de sortie g√©n√©ralement disponibles pour tous les syst√®mes sous forme de documents Excel et Word; </li><li>  a choisi la m√©thode de transmission de donn√©es la plus courante - le courrier √©lectronique. </li></ol><br>  Et deux principaux inconv√©nients: <br><br><ul><li>  Faible vitesse de livraison des donn√©es. </li><li>  La taille du paquet de donn√©es ne doit pas d√©passer la taille d'une pi√®ce jointe ordinaire. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421705/">https://habr.com/ru/post/fr421705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421693/index.html">L'histoire d'une API: comment nous avons transform√© Frankenstein en beau</a></li>
<li><a href="../fr421695/index.html">[Pas] les r√©seaux conventionnels: comment d√©tecter l'eau dans un sac en utilisant le Wi-Fi</a></li>
<li><a href="../fr421699/index.html">Comment se d√©barrasser des erreurs avec les tables Active Object lors de la restauration de Jira √† partir de la sauvegarde</a></li>
<li><a href="../fr421701/index.html">Bac √† sable d'apprentissage Python et feuille de triche</a></li>
<li><a href="../fr421703/index.html">Linux √† la maison ou ...</a></li>
<li><a href="../fr421707/index.html">FB2D - Framework 2D pour Linux Frame Buffer (Rust)</a></li>
<li><a href="../fr421709/index.html">Nouvelles (et anciennes) unit√©s CSS dont vous avez √† peine entendu parler</a></li>
<li><a href="../fr421711/index.html">Analyse des demandes de service √† l'aide du machine learning</a></li>
<li><a href="../fr421713/index.html">Comment trouver des robots sur YouTube: mod√®les d'interaction des commentateurs externes</a></li>
<li><a href="../fr421717/index.html">O√π √©tudient les analystes?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>