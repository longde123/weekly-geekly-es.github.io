<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☣️ 🧛🏼 ⏯️ L'automatisation contre le chaos 👈🏻 👩🏾‍🔧 🏡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le développement moderne des technologies informatiques a permis de limiter les énormes flux de données. 
 L'entreprise dispose de divers outils: CRM,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>L'automatisation contre le chaos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421705/"><img src="https://habrastorage.org/webt/qz/sq/j9/qzsqj9kwc7g4xeaponeocm3phxy.jpeg"><br><br>  Le développement moderne des technologies informatiques a permis de limiter les énormes flux de données. <br>  L'entreprise dispose de divers outils: CRM, ERP, BPM, systèmes comptables, ou dans des cas extrêmes juste Excel et Word. <br><br>  Les entreprises sont également différentes.  Certains sont constitués de nombreuses branches distinctes.  Dans ce cas, l'entreprise a un problème de synchronisation des données dans le zoo des systèmes informatiques.  De plus, les succursales diffèrent en termes de fournisseurs ou de versions de logiciels.  Et les changements fréquents dans les exigences de rapport de la société de gestion provoquent des accès de «joie» incontrôlés sur le terrain. <br><br>  Cette histoire concerne un projet dans lequel il m'est arrivé de rencontrer un chaos qui devait être systématisé et automatisé.  Un budget modeste et des délais serrés ont limité l'utilisation de la plupart des solutions industrielles, mais ont ouvert la voie à la créativité. <br><a name="habracut"></a><br><h2>  Format universel </h2><br>  Le client a défini la tâche de collecte des données pour les rapports de toutes les succursales de l'entreprise.  Pour comprendre l'ampleur de la catastrophe, il existe des dizaines de systèmes, y compris des self-made et des monstres tels que SAP, et, bien sûr, 1C - où sans lui. <br><br>  Dans un rapport, les données de: tenue de livres, réparateurs, spécialistes des relations publiques, ministère des Urgences, météorologues pourraient se recouper. <br><br>  Avant le démarrage du projet, la majeure partie des données a été envoyée à la société mère par e-mail sous forme de pièces jointes Word / Excel.  De plus, le processus ressemblait à un coucher de soleil manuel: les données étaient traitées par des personnes spécialement formées et entrées dans deux systèmes.  Le résultat de ce travail a été des dizaines de rapports, sur la base desquels des décisions de gestion ont été prises. <br><br>  Le choix de l'approche a été motivé par le format des fichiers transférés, à savoir xlsx / docx.  Même les systèmes «anciens» des succursales prenaient en charge le téléchargement de données vers ces formats, ou, dans des cas extrêmes, personne n'a annulé le copier-coller. <br><br>  Notre plan obstiné était le suivant: <br><br><ol><li>  décrire la structure de chaque rapport et les règles de sa transmission; </li><li>  nous réduisons les exigences de mise en place de systèmes d'envoi de documents par email selon les réglementations aux agences.  Là où il n'y a pas de système - envoyer, comme auparavant, à la main; </li><li>  Nous développons un programme qui: <br><ul><li>  sélectionne certains documents du courrier entrant; </li><li>  en extrait des données; </li><li>  écrit les données extraites dans la base de données, ainsi que «battre» les contrevenants aux règlements. </li></ul><br></li></ol><br><img src="https://habrastorage.org/webt/6b/na/ev/6bnaevbsj113vtojoryl6pkxt2s.png"><br><br><h2>  Implémentation </h2><br><h3>  Questions d'organisation </h3><br>  Au stade de la collecte et de la formalisation des exigences relatives à la structure et à la réglementation du transfert de données, il s'est avéré qu'il n'y avait aucune description de la structure des rapports.  Tout était stocké dans l'esprit de certains employés et transmis sous forme de contes populaires russes de bouche à oreille.  Mais les vrais problèmes ont commencé plus tard - lors de la configuration de l'échange de données. <br><br><h4>  Problème un </h4><br>  La différence entre la structure des documents de la référence et la qualité des données.  Dans les rapports, les montants parfois ne convergeaient pas, les colonnes étaient mélangées ou avaient des noms incorrects.  Le problème a été principalement observé dans les succursales où les données ont été saisies manuellement. <br><br>  La solution est la mise en place d'une vérification en trois étapes: <br><br><ol><li>  Création de documents Excel de référence avec une structure rigide, en utilisant Excel lui-même.  Dans ces documents, seules les cellules de saisie de données étaient disponibles.  Sur quels contrôles supplémentaires ont été imposés: type, convergence des montants, etc. </li><li>  Vérifie lors de l'extraction des données du rapport.  Par exemple, une comparaison de la date et de la date actuelles dans un paragraphe d'un document Word ou une vérification arithmétique des données d'un document Excel (si elles ne peuvent pas être spécifiées dans le document lui-même). </li><li>  Analyse approfondie des données après collecte.  Par exemple, la détection d'écarts significatifs dans les indicateurs clés par rapport aux périodes précédentes. </li></ol><br><h4>  Deuxième problème </h4><br>  Une violation systématique du calendrier de transfert de données ou des tentatives de sabotage sans scrupules: "En général, nous n'avons jamais envoyé de données à personne, mais vous êtes ici avec les miennes ...", "Oui, j'ai tout envoyé à temps, c'est probablement un mauvais ping." <br><br>  La solution est le feedback.  Le système avertit automatiquement les personnes responsables de la succursale en cas de violation d'horaire.  Plus tard, le sous-système de rétroaction a été vissé au système de contrôle de la qualité des données d'entrée et au système de rapport final, afin que la succursale reçoive immédiatement un ensemble de données et une comparaison avec les «voisins».  <s>Pour expliquer clairement pourquoi il ratisse.</s> <br><br><h3>  Sous-systèmes développés </h3><br><br><ol><li>  Configurateur de types de documents avec données, dans lequel vous pouvez décrire rapidement: <br><ul><li>  des panneaux permettant d'identifier le document; </li><li>  les règlements de transfert; </li><li>  algorithme d'extraction de données; </li><li>  d'autres attributs comme le chemin d'accès au code qui valide et stocke les données. </li></ul><br></li><li>  Un destinataire du courrier qui déplace les pièces jointes vers un stockage isolé (bac à sable) et stocke les informations connexes sur la lettre; </li><li>  Un analyseur de pièces jointes qui définit les types de documents et en extrait des données. </li></ol><br><img src="https://habrastorage.org/webt/7s/bp/ef/7sbpefc8oczlxcc6xyrauq4309y.png"><br><br><h4>  Configurateur </h4><br>  Historiquement, tous les documents contenant des données sont envoyés au courrier général, où il est plein d'autres lettres importantes et pas si.  Nous avons besoin de signes permettant de déterminer les documents nécessaires.  Le nom du document ou le texte dans le corps de l'e-mail n'est ni fiable ni pratique pour l'expéditeur.  Il a donc été décidé que la composition du rapport ne serait déterminée que par le contenu du document.  En outre, vous devez déterminer sans ambiguïté quel type de rapport contient le document. <br><br>  Ils ont trouvé un raifort de brainstorming qui sait combien de signes pour identifier un document: couleur du texte dans une cellule, police, etc.  Mais le plus correct était le signe de la présence d'une sous-chaîne dans une certaine «fente» de cellule ou un tableau de cellules pour Excel et un paragraphe ou un en-tête pour Word.  Une logique formelle simple a été ajoutée pour le «slot»: «égal», «inégal», «plus», «moins», etc. Exemple pour Excel: dans la plage A2-E4, le texte de la cellule doit être égal à «Résumé quotidien du chargement de l'équipement». <br><br><img src="https://habrastorage.org/webt/km/aj/ea/kmajeaf8og5y17cnfronq3x2wmq.png"><br><br>  La zone de document dans laquelle vous souhaitez rechercher le début et la fin des données est configurée de manière similaire (environ Conditions de recherche de la fin: 2 lignes vides de suite). <br><br><img src="https://habrastorage.org/webt/u1/9t/hh/u19thhrwphi6bbdfifx1bt6tk84.png"><br><br>  D'autres paramètres utiles incluent une liste d'expéditeurs résolus, un type de document (Excel / Word) et un chemin pour exporter les données. <br><br>  En sortie, nous obtenons une structure JSON (modèle) qui décrit le rapport. <br><br><h4>  Destinataire du courrier </h4><br>  Un lecteur de messagerie qui place tous les documents des pièces jointes dans le bac à sable, enregistre les attributs de la lettre et place les documents dans la file d'attente des tâches pour l'analyse. <br><br>  Il y a 2 questions de sécurité: <br><br><ol><li>  Et si les données sont envoyées à une autre succursale? </li><li>  que faire si les données sont envoyées par des attaquants? </li></ol><br>  Le premier problème est résolu en rapprochant l'adresse e-mail de la branche d'envoi et la branche spécifiée dans le corps du rapport. <br><br>  Le second utilise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SPF</a> . <br><br><h4>  Analyseur de pièces jointes </h4><br>  Presque toutes les bibliothèques pour analyser Word et Excel ont de sérieuses limitations sur les versions prises en charge, donc pour commencer le document doit être converti.  Libre Office résout ce problème par cinq. <br><br>  Après la conversion: <br><br><ol><li>  nous filtrons un tableau de modèles en fonction des caractéristiques de base du configurateur (Word / Excel, expéditeur ...); </li><li>  exécutez le document avec les modèles restants; </li><li>  si le modèle est trouvé, nous extrayons les données et les transférons dans le référentiel. </li></ol><br><h2>  Résumé </h2><br>  Nous l'avons fait! <br>  Après deux mois de travail minutieux, le siège social a commencé à recevoir régulièrement des données pour les rapports de toutes les succursales.  De plus, la qualité et l'exhaustivité des données étaient sans précédent différentes de ce qu'elles étaient auparavant, et les ressources humaines libérées ont récupéré les coûts du projet à la fin de l'année. <br><br>  Pour nous, nous avons appris que l'intégration n'est pas toujours douloureuse et avons souligné les principaux aspects de la réussite: <br><br><ol><li>  nous ne sommes pas entrés dans les systèmes dans les succursales; </li><li>  officialisé et approuvé une structure unique de rapports et de réglementations pour leur transmission; </li><li>  créé des modèles de formats de sortie généralement disponibles pour tous les systèmes sous forme de documents Excel et Word; </li><li>  a choisi la méthode de transmission de données la plus courante - le courrier électronique. </li></ol><br>  Et deux principaux inconvénients: <br><br><ul><li>  Faible vitesse de livraison des données. </li><li>  La taille du paquet de données ne doit pas dépasser la taille d'une pièce jointe ordinaire. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421705/">https://habr.com/ru/post/fr421705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421693/index.html">L'histoire d'une API: comment nous avons transformé Frankenstein en beau</a></li>
<li><a href="../fr421695/index.html">[Pas] les réseaux conventionnels: comment détecter l'eau dans un sac en utilisant le Wi-Fi</a></li>
<li><a href="../fr421699/index.html">Comment se débarrasser des erreurs avec les tables Active Object lors de la restauration de Jira à partir de la sauvegarde</a></li>
<li><a href="../fr421701/index.html">Bac à sable d'apprentissage Python et feuille de triche</a></li>
<li><a href="../fr421703/index.html">Linux à la maison ou ...</a></li>
<li><a href="../fr421707/index.html">FB2D - Framework 2D pour Linux Frame Buffer (Rust)</a></li>
<li><a href="../fr421709/index.html">Nouvelles (et anciennes) unités CSS dont vous avez à peine entendu parler</a></li>
<li><a href="../fr421711/index.html">Analyse des demandes de service à l'aide du machine learning</a></li>
<li><a href="../fr421713/index.html">Comment trouver des robots sur YouTube: modèles d'interaction des commentateurs externes</a></li>
<li><a href="../fr421717/index.html">Où étudient les analystes?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>