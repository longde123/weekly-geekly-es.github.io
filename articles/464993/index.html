<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôã üòü üí§ Construyendo un paquete RPM para Rosa Linux en la pr√°ctica üç∫ üë©üèæ‚Äçüéì üëÉüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si ha estado utilizando el sistema operativo Linux durante mucho tiempo e incluso sabe un poco sobre programaci√≥n, tarde o temprano necesitar√° compila...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Construyendo un paquete RPM para Rosa Linux en la pr√°ctica</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464993/"><p>  Si ha estado utilizando el sistema operativo Linux durante mucho tiempo e incluso sabe un poco sobre programaci√≥n, tarde o temprano necesitar√° compilar el programa a partir del c√≥digo fuente.  Quiz√°s el programa deseado no estar√° en los repositorios de distribuci√≥n.  O el programa tiene una versi√≥n antigua en estos repositorios, y necesita la √∫ltima.  O tal vez cre√≥ un nuevo programa y desea compartirlo con otros usuarios. <br></p><br><p>  Por supuesto, puede instalar el programa de acuerdo con las instrucciones que vienen con el c√≥digo fuente.  Pero luego deber√° administrar manualmente los archivos del programa y monitorear sus dependencias.  Es mucho mejor crear un paquete con el programa y usar el administrador de aplicaciones integrado en el sistema operativo. <br></p><br><p>  Espero que este art√≠culo le ayude a descubrir r√°pidamente c√≥mo construir un paquete RPM para <em>Rosa Linux</em> u otra distribuci√≥n que use el administrador de paquetes RPM (Mandriva, RedHat).  O al menos dime d√≥nde buscar informaci√≥n. <br></p><br><p>  Aqu√≠ mostrar√© c√≥mo crear paquetes RPM en mi computadora local, usando un ejemplo simple.  Construiremos el programa <em>xkb-switch</em> en el <em>sistema</em> operativo <em>Rosa Linux</em> .  Tomaremos el c√≥digo fuente del programa de <em>GitHub</em> . <br></p><br><br><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">El art√≠culo est√° dividido en muchas partes cortas, por lo que la tabla de contenido est√° debajo del spoiler.</b> <div class="spoiler_text"><h2>  Tabla de contenidos </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un poco sobre Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un poco sobre xkb-switch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configurar, finalizar, verificar el programa</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Verificando el c√≥digo fuente sin tu perfil en GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Verificaci√≥n al guardar el proyecto en su perfil de GitHub</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Creando parches</a> </li></ul><br></li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Prepare el "lugar de trabajo" para crear un paquete</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comencemos a crear un archivo de especificaciones</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un poco sobre la sintaxis del archivo de especificaciones</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Encabezado de archivo de especificaciones</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Preparaci√≥n de la fuente</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Compilaci√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Instalaci√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Archivo de embalaje</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬øQu√© es rpmlint?</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tipos de paquetes RPM para Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Nuestro resultado</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Si necesita dividir el paquete en partes</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Agrega algunas macros</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cambia un poco el t√≠tulo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Definir paquetes de biblioteca</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Definir archivos para paquetes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Resolviendo problemas adicionales</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conclusi√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Equipos principales</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comandos √∫tiles para construir un paquete</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comprobando el paquete terminado</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlaces √∫tiles (fuentes principales)</a> </li></ul><br></div></div><br><br><a name="foreword"></a><br><h2>  Un poco sobre Rosa Linux </h2><br><p>  <em>Rosa Linux</em> es una distribuci√≥n creada y respaldada por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desarrolladores rusos</a> .  Est√° basado en <em>Mandriva</em> , pero con algunas caracter√≠sticas.  Estoy usando la versi√≥n de 32 bits de <em>Rosa Fresh R8</em> , que se lanz√≥ en 2014.  Ahora la versi√≥n <em>R8</em> ya no es compatible con los desarrolladores (los repositorios no est√°n actualizados), pero funciona bien en mi computadora port√°til, por lo que no quiero instalar una nueva versi√≥n. <br></p><br><p> <em>Rosa Fresh R8</em> utiliza el escritorio <em>KDE4</em> .  Todas las versiones del paquete de distribuci√≥n usan administradores <code>rpm</code> y <code>urpm</code> para administrar paquetes con aplicaciones, y los comandos correspondientes son <code>rpm</code> , <code>urpmi</code> , <code>urpme</code> , <code>urpmq</code> , <code>urpmf</code> . <br></p><br><p>  Los principios de creaci√≥n de paquetes de software rara vez se modifican dentro de la misma familia de distribuci√≥n de Linux.  Por lo tanto, lo que se describe en este art√≠culo deber√≠a funcionar en todas las versiones de distribuciones de <em>Rosa</em> . <br></p><br><p>  Crear paquetes en Rosa Linux es un poco m√°s simple que en otras distribuciones basadas en <em>RPM</em> .  Algunos puntos est√°n automatizados y no necesitan configurarse. <br></p><br><br><a name="foreword-xkb-switch"></a><br><h2>  Un poco sobre xkb-switch </h2><br><p>  Me gust√≥ la idea de usar el complemento para el editor de texto Vim - <em>xkbswitch</em> , sobre el cual hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un art√≠culo sobre Habr√©</a> .  Cambia autom√°ticamente la distribuci√≥n del teclado a ingl√©s cuando sale del modo de entrada, y viceversa, a aquel en el que se ingres√≥ el texto la √∫ltima vez, si ingresa nuevamente al modo de entrada.  Para que este complemento funcione, necesita el programa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">xkb-switch</a> , que le permite cambiar la distribuci√≥n del teclado desde la l√≠nea de comandos y desde los complementos para el editor <em>Vim</em> .  Este programa no estaba en los repositorios <em>Rosa Linux R8</em> (y probablemente nadie lo agregar√°, porque la distribuci√≥n ya es antigua y el programa <em>xkb-switch</em> no <em>es</em> muy popular). <br></p><br><br><a name="test_program"></a><br><h2>  Configurar, finalizar, verificar el programa </h2><br><p>  A menudo es necesario configurar la compilaci√≥n del programa para que funcione correctamente en una distribuci√≥n particular o incluso para un sistema espec√≠fico.  Sucede que un programa debe construirse con otras opciones o con el soporte de alg√∫n controlador especial.  O tal vez desee corregir errores en el c√≥digo del programa o simplemente verificar si funciona.  Para hacer esto, es mejor copiar el c√≥digo fuente a su computadora antes de construir el paquete RPM, intente compilarlo y verificar c√≥mo funciona el programa compilado. <br></p><br><p>  Si est√° seguro de que no necesitar√° modificar los archivos del proyecto, puede usar el c√≥digo fuente original del sitio web del proyecto e inmediatamente proceder a construir el paquete.  Pero si necesita cambiar la configuraci√≥n de compilaci√≥n, generalmente es mucho m√°s f√°cil cambiar el archivo en la carpeta de origen (el llamado <em>archivo MAKE</em> ) que luego lidiar con las opciones de comando de compilaci√≥n y el dispositivo macro interno para el archivo de especificaciones. <br></p><br><br><a name="test_program-local"></a><br><h3>  Verificando el c√≥digo fuente sin tu perfil en GitHub </h3><br><p>  Si decide trabajar con el c√≥digo fuente o la configuraci√≥n de compilaci√≥n del proyecto, pero no tiene su propio perfil en GitHub o no quiere usarlo, simplemente puede descargar y descomprimir el c√≥digo fuente.  En nuestro caso, podr√≠a verse as√≠ (uso la carpeta <code>~/Projects/cpp</code> para el c√≥digo fuente de <em>C ++</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Esto crear√° la carpeta <code>~/Projects/cpp/xkb-switch</code> contiene el c√≥digo fuente.  Por supuesto, en lugar de usar <code>git</code> puede descargar el archivo con el programa y descomprimirlo. <br></p><br><p>  Desde el archivo <code>README.md</code> en la carpeta del proyecto, es f√°cil adivinar que la utilidad <code>cmake</code> se usa para construir el programa.  Por lo tanto, si necesita cambiar la configuraci√≥n de compilaci√≥n, en nuestro caso est√°n en el archivo <code>CMakeLists.txt</code> .  Y solo tratamos de compilar el programa y verificar si funciona.  Los comandos que necesita usar para esto est√°n escritos en el mismo archivo <code>README.md</code> en la ra√≠z del proyecto. <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> xkb-switch mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake .. make ./xkb-switch <span class="hljs-comment"><span class="hljs-comment">#         ./xkb-switch -l #       ./xkb-switch -s ru #       (  )</span></span></code> </pre><br><br><p>  Despu√©s de eso, para usar el proyecto modificado, tendr√° que borrar o eliminar la carpeta de <code>build</code> del proyecto y empacar el c√≥digo fuente en el archivo.  Podr√≠a verse as√≠: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/xkb-switch rm -rf ./build <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp zip -r xkb-switch.zip xkb-switch</code> </pre><br><br><p>  El archivo <code>xkb-switch.zip</code> usarse para compilar el paquete. <br></p><br><br><a name="test_program-github"></a><br><h3>  Verificaci√≥n al guardar el proyecto en su perfil de GitHub </h3><br><p>  Supongo que cualquiera que lea esta secci√≥n est√° al menos un poco familiarizado con el trabajo con <em>git</em> y ya ha configurado un perfil en <em>GitHub</em> .  Creo que este m√©todo es el mejor, por lo que el resto del art√≠culo implicar√° que se usa, a menos que se indique lo contrario. <br></p><br><p>  Primero debes bifurcar el proyecto original en tu <em>GitHub</em> .  Despu√©s de eso, como en el m√©todo anterior, clonamos el proyecto en nuestra computadora, pero desde nuestro repositorio (en mi caso, el nombre de usuario es <em>alexandersolovyov</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/alexandersolovyov/xkb-switch.git</code> </pre><br><br><p>  Para agregar cualquier cambio, es mejor usar una nueva rama.  Luego, si lo desea, ser√° posible utilizar diferentes versiones del programa.  Y tambi√©n ser√° posible proponer cambios al autor del proyecto mediante solicitudes pull.  Por ejemplo, si decide arreglar un poco el archivo <code>CMakeLists.txt</code> , antes de eso necesita crear una nueva rama con: <br></p><br><br><pre> <code class="bash hljs">git branch cmake_corrections</code> </pre><br><br><p>  Despu√©s de realizar los cambios, verificarlos y agregarlos a la rama (usando <code>git commit -am " "</code> ), puede agregar una nueva rama a su GitHub: <br></p><br><br><pre> <code class="bash hljs">git push origin cmake_corrections</code> </pre><br><br><p>  Despu√©s de eso, puede hacer una solicitud de extracci√≥n, si es necesario. <br></p><br><p>  Puede hacer un enlace al repositorio original: <br></p><br><br><pre> <code class="bash hljs">git remote add ierton https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Y luego actualice la rama principal de su repositorio para que coincida con el original: <br></p><br><br><pre> <code class="bash hljs">git pull ierton master</code> </pre><br><br><p>  El c√≥digo del programa correspondiente a la rama corregida se puede usar al construir el RPM.  Para hacer esto, deber√° especificar la direcci√≥n del archivo en el formulario en el archivo de especificaciones: <br></p><br><br><pre> <code class="plaintext hljs">Source0: https://github.com/-/-/archive/---.zip</code> </pre><br><br><p>  Pero, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">como lo solicit√≥ el usuario de specblog</a> , este no es el caso.  Es mejor transmitir sus cambios en forma de parches.  Para hacer esto, debe crear archivos de parche a partir de los cambios en su rama y copiarlos en la carpeta de origen para compilar el paquete ( <code>~/rpmbuild/SOURCES/</code> ).  Luego deber√° especificarlos en el archivo de especificaciones.  Consideraremos esto un poco m√°s tarde, pero si lo desea, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puede leerlo aqu√≠</a> .  Si no sabe c√≥mo crear parches, puede mirar debajo del spoiler. <br></p><br><br><a name="test_program-github-patches"></a><br><div class="spoiler">  <b class="spoiler_title">C√≥mo crear parches usando git</b> <div class="spoiler_text"><h4>  Creando parches </h4><br><p>  <em>Parches</em> , son <em>parches</em> : son archivos en los que los cambios se registran en el c√≥digo fuente del programa.  Se usan como una alternativa a los comandos <code>git pull</code> y <code>git push</code> para la comunicaci√≥n entre repositorios de c√≥digo local si no es conveniente "extraer" los cambios desde un repositorio remoto, o si el historial de cambios del proyecto y los principios de trabajar con √©l son tales que es mejor usar parches. <br></p><br><br><p>  Imaginemos que necesitamos hacer cambios en el archivo <code>CMakeLists.txt</code> .  Primero, debe hacer todo como se describe anteriormente: la rama <em>maestra</em> en nuestro repositorio de GitHub debe corresponder a la rama principal del proyecto original, y para sus cambios debe usar la rama <em>cmake_corrections</em> .  Luego debes ir a esta rama, hacer los cambios necesarios y guardarlos en <em>git</em> usando commits. <br></p><br><p>  Ahora debe guardar los cambios como archivos de parche en la carpeta <code>~/rpmbuild/SOURCES</code> (si no est√° utilizando Rosa Linux, la ruta a la carpeta <code>SOURCES</code> puede ser diferente).  Por ejemplo, esto (quiero decir que estamos en la carpeta del proyecto, por ejemplo, <code>~/Projects/cpp/xkb-switch</code> - y en la rama <code>cmake_corrections</code> ): <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES origin/master</code> </pre><br><p>  El comando <code>git format-patch</code> crea un archivo de <code>git format-patch</code> para cada confirmaci√≥n.  De esta forma, crear√° parches a partir de la confirmaci√≥n especificada por el √∫ltimo argumento y terminando con la √∫ltima confirmaci√≥n de la rama actual.  Puede especificar una confirmaci√≥n de cualquier manera: al comienzo del hash, utilizando el puntero <em>HEAD</em> o el nombre de la rama, que ahora indica la confirmaci√≥n deseada.  Lo principal es que uno de los commits que son visibles cuando <code>git log</code> ejecuta <code>git log</code> se toma como un inicio.  Es decir, no puede comenzar a hacer parches desde una confirmaci√≥n que est√° en otra rama. <br></p><br><p>  Y puede recordar (o ver) cu√°ntas confirmaciones se ramificaron desde la rama principal, y hacer parches para un cierto n√∫mero de confirmaciones.  Por ejemplo, si hici√©ramos dos commits, el comando ser√≠a: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES -2</code> </pre><br><p>  Aqu√≠ el n√∫mero de confirmaciones se establece usando <code>-2</code> .  Puede especificar cualquier n√∫mero de ellos en lugar de esta cifra. <br></p><br><p>  Puede especificar el rango de confirmaciones a partir del cual se deben realizar parches colocando dos puntos entre los enlaces a las confirmaciones inicial y final: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES master..cmake_corrections</code> </pre><br><p>  El nombre de cada archivo de revisi√≥n consta de un n√∫mero de serie y la primera l√≠nea de un comentario de confirmaci√≥n.  Por lo tanto, es mejor cambiar el nombre de cada archivo para que la descripci√≥n del parche describa m√°s breve y claramente su esencia.  Por ejemplo, as√≠: <br></p><br><pre> <code class="bash hljs">mv 0001-Return-memory-allocated-by-XkbRf-getNamesProp()-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-tmp.patch 001-Fix-memory-leak.patch</code> </pre><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La convenci√≥n de nomenclatura para parches en el art√≠culo sobre la sintaxis del archivo de especificaciones</a> recomienda agregar <em>package_name-version-rosa-</em> antes de la descripci√≥n de cada archivo de parche.  Tal vez esta sea una buena pr√°ctica si env√≠a parches por correo electr√≥nico, pero no para crear paquetes.  Creamos paquetes en nuestra computadora, por lo que es mejor vaciar la carpeta <code>~/rpmbuild/SOURCES</code> cada vez antes de <code>~/rpmbuild/SOURCES</code> paquete con otro programa o un paquete de una nueva versi√≥n. <br></p><br><p>  Ahora, si necesita actualizar la rama del repositorio principal ( <em>maestra</em> ) para que coincida con la original, entonces la rama de cambio ( <em>cmake_corrections</em> ) deber√° actualizarse utilizando el <code>git rebase</code> .  Puedes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ver</a> c√≥mo hacer esto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Despu√©s de eso, ser√° necesario recrear los parches. <br></p><br></div></div><br><br><a name="prepare"></a><br><h2>  Prepare el "lugar de trabajo" para crear un paquete </h2><br><p>  Primero necesitas crear una estructura de directorio.  Todo el ensamblaje se lleva a cabo en la carpeta <code>rpmbuild</code> en la carpeta de inicio del <code>rpmbuild</code> .  Cree la estructura de directorio inicial y vaya a la carpeta para los archivos de especificaciones: <br></p><br><br><pre> <code class="bash hljs">mkdir -p ~/rpmbuild/SPECS &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/SPECS</code> </pre><br><br><p>  Para Rosa Linux, esto es suficiente: las carpetas restantes se crear√°n autom√°ticamente. <br></p><br><p>  Otra distribuci√≥n puede usar una ubicaci√≥n de archivo diferente para compilar el paquete.  Y quiz√°s deba crear la jerarqu√≠a de carpetas completa manualmente.  Busque informaci√≥n para su distribuci√≥n si no est√° utilizando Rosa Linux.  Por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esto podr√≠a verse as√≠ en Red Hat</a> . <br></p><br><p>  Si el paquete se compil√≥ con errores, entonces todos los archivos creados por el comando <code>rpmbuild</code> no se eliminan, lo mismo que con una compilaci√≥n exitosa.  Intentaremos recopilar el paquete muchas veces y los archivos restantes despu√©s de la √∫ltima vez interferir√°n.  Por lo tanto, es mejor crear un script simple que ayudar√° a eliminarlos r√°pidamente.  Cree un archivo cleanup.sh y p√≥ngalo en la <code>~/rpmbuild/SPECS</code> .  Aqu√≠ est√°n sus contenidos: <br></p><br><br><pre> <code class="bash hljs">!<span class="hljs-comment"><span class="hljs-comment">#/bin/sh rm -rf ~/rpmbuild/BUILD/* rm -rf ~/rpmbuild/BUILDROOT/* rm -rf ~/rpmbuild/RPMS/* rm -rf ~/rpmbuild/SRPMS/*</span></span></code> </pre><br><br><p>  Por supuesto, es mejor agregarle derechos de ejecuci√≥n usando el <code>chmod u+x cleanup.sh</code> . <br></p><br><p>  Si desea recopilar un paquete de archivos que est√°n en la computadora local, si no est√° utilizando <em>GitHub</em> y ha realizado cambios en los archivos del proyecto, o si desea crear un paquete desde su propio programa que se almacena solo en su computadora, debe empaquetar el proyecto en un archivo ( por ejemplo <code>.zip</code> , <code>.tar</code> o <code>.tar.gz</code> ) y p√≥ngalo en la carpeta <code>SOURCES</code> .  Por ejemplo, as√≠: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/ zip -r xkb-switch.zip xkb-switch mkdir -p ~/rpmbuild/SOURCES cp xkb-switch.zip ~/rpmbuild/SOURCES/</code> </pre><br><br><p>  Si despu√©s de compilar el programa desea compilar otra o la misma versi√≥n pero diferente, necesitar√° eliminar todos los archivos de la carpeta <code>~/rpmbuild/SOURCES</code> , y luego copiar su archivo all√≠ (si no lo descarga desde <em>GitHub</em> ) y archivos de parches (si se usan).  De lo contrario, lo m√°s probable es que el archivo de archivo no se descargue de <em>GitHub</em> (por qu√©, ver m√°s adelante), y tambi√©n ser√° dif√≠cil determinar qu√© archivo de parche pertenece a qu√© programa. <br></p><br><br><a name="specfile_start"></a><br><h2>  Comencemos a crear un archivo de especificaciones </h2><br><p>  La base para construir un paquete RPM es el llamado <em>archivo speck</em> .  Este archivo contiene las instrucciones para el programa <code>rpmbuild</code> (o m√°s bien <code>rpm</code> ) necesarias para compilar el paquete. <br></p><br><p>  Cree el archivo <code>xkb-switch.spec</code> en la <code>~/rpmbuild/SPECS/</code> .  La forma m√°s f√°cil de comenzar es con una plantilla que se puede encontrar en el sitio web de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">archivos de especificaciones de plantilla</a> . <br></p><br><p>  Desde el <code>README</code> en la p√°gina del proyecto <em>xkb-switch</em> , se sabe que el programa se compila utilizando la utilidad <code>cmake</code> .  Por lo tanto, seleccionaremos el <strong>archivo Spec para un programa creado usando CMake</strong> y <strong>copiaremos</strong> la plantilla completa a nuestro archivo spec.  Por supuesto, para ensamblar adecuadamente nuestro paquete RPM, esta plantilla debe cambiarse mucho, lo cual haremos. <br></p><br><br><a name="specfile_syntax"></a><br><h2>  Un poco sobre la sintaxis del archivo de especificaciones </h2><br><ul><li>  La sintaxis del archivo de especificaciones le permite agregar comentarios de estilo bash. <br></li><li>  Puede usar espacios como espacios entre los valores en la misma l√≠nea para crear la apariencia de columnas pares, pero la documentaci√≥n recomienda encarecidamente usar el car√°cter de tabulaci√≥n (uno o dos siempre que las columnas sean pares).  <strong>Nota:</strong> en todos los ejemplos de c√≥digo de este art√≠culo, solo se utilizan espacios, por lo que es mejor no copiar todo el texto de aqu√≠ a su archivo de especificaciones, sino imprimirlo usted mismo. <br></li><li>  Los campos de opci√≥n consisten en un nombre de opci√≥n especial con dos puntos y el siguiente valor a trav√©s de pesta√±as (o espacios).  El caso de los caracteres en los nombres de campo no importa.  Por ejemplo: <br><pre> <code class="plaintext hljs"> Name: xkb-switch</code> </pre><br></li><li>  Si la palabra est√° precedida por el s√≠mbolo <code>%</code> (por ejemplo, <code>%description</code> ), entonces esta es una palabra clave especial.  Puede ser una llamada de comando, macro o script.  Luego, despu√©s de esto, se pueden indicar los par√°metros que utiliza.  Y hay palabras clave que indican el comienzo de un bloque de comandos u opciones.  Luego, los par√°metros se pueden indicar al lado, y en las siguientes l√≠neas debe haber comandos o una lista de opciones que describ√≠ en el p√°rrafo anterior.  Despu√©s de tal bloqueo, se debe dejar una l√≠nea vac√≠a. <br></li><li>  Para usar el valor de una constante, debe insertar una construcci√≥n de la forma <code>%{_}</code> .  Su valor puede predefinirse, o puede determinarse mediante una opci√≥n (por ejemplo, <code>Name: xkb-switch</code> ) o usando la palabra clave <code>%define</code> .  Todas estas constantes tambi√©n se consideran macros.  Su uso se discutir√° con m√°s detalle a continuaci√≥n. <br></li></ul><br><br><a name="specfile_header"></a><br><h2>  Encabezado de archivo de especificaciones </h2><br><p>  En el archivo de especificaciones, el encabezado siempre se escribe primero.  Esta es una lista de opciones que se aplican al paquete principal de RPM.  Cuando el paquete est√© listo, casi toda esta informaci√≥n se mostrar√° al ver su descripci√≥n.  Esto es lo que indican las l√≠neas individuales: <br></p><br><br>  <b>Resumen:</b> <br>  Una breve descripci√≥n del paquete.  Vi la descripci√≥n en el archivo <code>README.md</code> en el proyecto <em>xkb-switch</em> : <code>Query and change XKB layout state</code> . <br><br>  <b>Nombre:</b> <br>  El nombre del paquete.  En nuestro caso, esto es <code>xkb-switch</code> . <br><br>  <b>Versi√≥n:</b> <br>  Versi√≥n del programa  Para averiguarlo, es mejor mirar el archivo <code>CMakeLists.txt</code> en la carpeta ra√≠z del proyecto.  Por supuesto, debe tomar el archivo de la copia del proyecto que se utilizar√° para el ensamblaje.  Si usa el proyecto original, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puede abrir el archivo directamente en su p√°gina de GitHub</a> .  Como puede ver, la versi√≥n est√° compuesta por <code>MAJOR_VERSION</code> , <code>MINOR_VERSION</code> y <code>RELEASE_VERSION</code> .  <code>1.6.0</code> versi√≥n del programa <code>1.6.0</code> . <br><br>  <b>Lanzamiento</b> <br>  El n√∫mero de versi√≥n del paquete en s√≠.  Muestra a qu√© hora se est√° ensamblando un paquete con un programa de la misma versi√≥n.  En nuestro caso, este es "1", ya que nadie ha ensamblado un programa de esta versi√≥n.  En el caso ideal, si ya intentamos construir el paquete y el ensamblaje lleg√≥ al final (incluso si hubo errores), entonces, despu√©s de cada nuevo intento, debe aumentar este n√∫mero en 1 y al mismo tiempo no eliminar los paquetes recopilados antiguos de las <code>rpmbuild/SRPMS</code> <code>rpmbuild/RPMS</code> y <code>rpmbuild/SRPMS</code> : A continuaci√≥n, se crear√°n nuevos paquetes con un nuevo n√∫mero de compilaci√≥n.  Quiz√°s esto deber√≠a hacerse si utiliza un servidor especial para el ensamblaje.  Usamos nuestra computadora y en su lugar limpiaremos las carpetas.  Si un paquete con un programa de esta versi√≥n ya est√° en los repositorios de la distribuci√≥n de Linux, pero est√° compilando con otras configuraciones, entonces es mejor especificar la versi√≥n n√∫mero 1 m√°s que ese paquete. <br><br>  <b>Licencia:</b> <br>  El nombre corto de la licencia bajo la cual se distribuye el programa.  De acuerdo con las reglas de Rosa Linux, solo puede crear paquetes con una licencia que permita la distribuci√≥n gratuita.  <code>README.md</code> encontrar en el archivo <code>README.md</code> que la licencia es <em>GNU GPLv3</em> .  Entonces escribimos: <code>GPLv3+</code> . <br><br>  <b>Grupo:</b> <br>  El grupo o categor√≠a a la que pertenece el programa.  Con estos grupos, los programas se ordenan en el men√∫ de inicio de la aplicaci√≥n y en el administrador de programas de la ventana ("Agregar o quitar programas").  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La lista de grupos para Rosa Linux se puede encontrar aqu√≠</a> .  Creo que <code>Development\X11</code> es lo mejor para nosotros, ya que el programa est√° relacionado con X11 y es principalmente necesario para crear scripts y complementos para Vim. <br><br>  <b>URL:</b> <br>  Direcci√≥n de Internet donde puede descargar el c√≥digo fuente original del programa.  Se especificar√° al ver la informaci√≥n del paquete RPM.  Este art√≠culo es opcional, pero le indicaremos: <code>https://github.com/ierton/xkb-switch</code> <br><br>  <b>Fuente0:</b> <br>  El nombre del archivo que contiene el c√≥digo fuente o la direcci√≥n de Internet donde se puede descargar.  Si especifica una direcci√≥n en Internet, durante la primera compilaci√≥n, el archivo se descargar√° a <code>~/rpmbuild/SOURCES/</code> .  Si dicho archivo ya existe, ya no se descargar√°, es decir, el programa <code>rpmbuild</code> solo usar√° el nombre de archivo especificado al final de esta URL.  Puede especificar solo el nombre del archivo, pero luego deber√° colocarse en la carpeta <code>~/rpmbuild/SOURCES/</code> manualmente.  Es mejor proporcionar la direcci√≥n de su copia del proyecto en GitHub.  Us√© el archivo <code>https://github.com/alexandersolovyov/xkb-switch/archive/master.zip</code> .  Puede especificar varias fuentes diferentes para recopilar las fuentes de varios archivos con la ayuda de un archivo speck.  Luego, en el nombre de la opci√≥n para agregar cada archivo subsiguiente, el n√∫mero deber√≠a aumentar ( <code>Source1</code> , <code>Source2</code> , etc.).  Estas direcciones de archivo no son visibles cuando se visualiza la informaci√≥n del paquete RPM. <br><br>  <b>Parche0:</b> <br>  Esta opci√≥n no est√° en el archivo de plantilla.  Puede ser √∫til si decide transferir sus cambios en los archivos de proyecto del programa en forma de parches.  En cuanto a la opci√≥n <code>Source0</code> , cada archivo debe indicarse en una l√≠nea separada, y el n√∫mero al final del nombre de la opci√≥n debe aumentar cada vez.  Los archivos de parche deben ubicarse en la carpeta <code>~/rpmbuild/SOURCES</code> (al lado del archivo fuente descargado).  El nombre de cada archivo debe escribirse sin una ruta.  No es necesario especificar todos los archivos de parche aqu√≠, solo pueden ser aquellos que desea aplicar. <br><br>  <b>BuildRequires:</b> <br>  Paquetes necesarios para construir el programa.  La plantilla <code>cmake</code> .  El archivo <code>CMakeLists.txt</code> indica que la versi√≥n m√≠nima de CMake para ensamblar no debe ser inferior a <em>2.6</em> , por lo que es mejor especificar <code>cmake &gt;= 2.6</code> .  Puede agregar otros paquetes, cada uno de ellos en una l√≠nea separada, usando la opci√≥n <code>BuildRequires:</code> separada.  La lista de paquetes necesarios para el ensamblaje se puede encontrar leyendo el <code>README</code> del proyecto y mirando cuidadosamente el archivo <code>CMakeLists.txt</code> (especialmente las <code>FIND_PACKAGE</code> , <code>TARGET_LINK_LIBRARY</code> , <code>FIND_PROGRAM</code> ).  Luego, debe encontrar el nombre de paquete correcto en los repositorios utilizando el comando <code>urpmq -a __</code> .  En nuestro caso, el archivo de configuraci√≥n de compilaci√≥n ( <code>CMakeLists.txt</code> ) ya contiene l√≠neas que verifican la presencia de los paquetes necesarios en el sistema.  Pero es mejor especificar la lista completa aqu√≠ tambi√©n: <br><pre> <code class="plaintext hljs"># CMake  2.6   BuildRequires: cmake &gt;= 2.6 #  C/C++ BuildRequires: gcc #    libxkbfile BuildRequires: libxkbfile-devel #   X11   libxkbfile, #  libx11-devel   . #    man: BuildRequires: xz</code> </pre><br><br>  <b>Requiere:, Proporciona:</b> <br>  Estas opciones no est√°n en la muestra, pero a veces pueden ser √∫tiles.  Establecen dependencias entre paquetes.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La opci√≥n </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica las </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caracter√≠sticas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proporcionadas por el paquete que se est√° creando. Este puede ser el nombre de la cabecera del archivo de lenguaje </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o el nombre de la biblioteca de v√≠nculos din√°micos, o cualquier funci√≥n especial. Y la opci√≥n </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indica de qu√© </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capacidades de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> otros paquetes depende el paquete. Administrador de paquetes ( </font></font><code>rpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>urpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u otras personas que utilizan su distribuci√≥n), en la b√∫squeda de dependencias que buscan estas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oportunidades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en lugar de nombres de paquetes. Por </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lo </font><font style="vertical-align: inherit;">tanto, </font><font style="vertical-align: inherit;">es mejor indicar la versi√≥n de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oportunidad</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proporcionada </font><font style="vertical-align: inherit;">y para </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qu√© versiones de las </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oportunidades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proporcionadas </font><font style="vertical-align: inherit;">son adecuadas. La versi√≥n est√° indicada por signos </font></font><code>&gt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o </font></font><code>&lt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, rodeado de espacios. Por lo general, todas las opciones se indican primero </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, luego </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, un nombre de funci√≥n por l√≠nea, lo mismo que para </font></font><code>BuildRequires:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Por lo general, cuando se crean paquetes en Rosa Linux, las dependencias se reconocen autom√°ticamente, y estas opciones rara vez necesitan especificarse. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoReq:, AutoProv:</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> si est√° </font><b><font style="vertical-align: inherit;">creando un</font></b><font style="vertical-align: inherit;"> programa que est√° escrito en un idioma en el que el administrador de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><font style="vertical-align: inherit;">nuevo, o que es propietario, y las dependencias no se detectan correctamente autom√°ticamente, puede deshabilitar la detecci√≥n autom√°tica de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Capacidades</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (con </font></font><code>AutoProv: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) y / o </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dependencias</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (con ayuda </font></font><code>AutoReq: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% descripci√≥n</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este bloque ya no es parte del encabezado, pero est√° asociado con √©l. </font><font style="vertical-align: inherit;">Agregar√° una descripci√≥n completa del programa al paquete RPM. </font><font style="vertical-align: inherit;">Se debe dejar una l√≠nea vac√≠a despu√©s. </font><font style="vertical-align: inherit;">La descripci√≥n puede ser la siguiente:</font></font><br><pre> <code class="plaintext hljs">%description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las l√≠neas de la plantilla que comienzan con </font></font><code>%files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>%find_lang</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">son necesarias solo si crea una aplicaci√≥n con soporte para varios idiomas, as√≠ que elim√≠nelas.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s, despu√©s del comentario de l√≠nea divisoria, seguido de comandos y macros que deben completarse antes de empaquetar los archivos. </font><font style="vertical-align: inherit;">Todos estos comandos est√°n divididos en bloques definidos usando palabras clave especiales.</font></font></p><br><br><a name="prep"></a><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preparaci√≥n de la fuente </font></font></h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El primero es un bloque </font></font><code>%prep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que indica los comandos para prepararse para la compilaci√≥n. </font><font style="vertical-align: inherit;">En ella hay un comando macro </font></font><code>%setup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ella ejecuta un script que hace lo siguiente:</font></font></p><br><br><ul><li>       ,      <code>SourceX:</code>    (  ‚Äî  <code>Source0:</code> ).         ,    . <br></li><li>      <code>~/rpmbuild/SOURCES/</code> . <br></li><li>      <code>~/rpmbuild/BUILD/</code> . <br></li><li>      . <br></li></ul><br><br><p>   <code>-q</code> ,       . </p><br><p>     ,     <code>%prep</code> : </p><br><br><pre> <code class="bash hljs">rpmbuild -bp ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>rpmbuild</code> .       ,      <code>rpm</code>    : <code>rpmbuild</code>    ,      .           (   <code>root</code>    <code>sudo</code> ).    <code>rpmbuild</code>  ,  <code>man rpmbuild</code> .      ,       ,   , ‚Äî  ,          <code>rpmbuild</code> . <br></p><br><p>      : <code>xkb-switch-1.6.0: No such file or directory</code> .    ,          <code>~/rpmbuild/BUILD/xkb-switch-1.6.0</code> ,  .   <br></p><br><br><pre> <code class="bash hljs">ls ~/rpmbuild/BUILD/</code> </pre><br><br><p> ,     <code>xkb-switch-master</code> .     <code>%setup</code>    <code>-n</code> .    <code>%prep</code>  -   : <br></p><br><br><pre> <code class="bash hljs">%prep %setup -q -n xkb-switch-master</code> </pre><br><br><p>    <code>~/rpmbuild/SPECS/cleanup.sh</code> ,    <code>BUILD</code> ,     ,   <code>%prep</code> .  ,     <code>exit 0</code> .  ,     . <br></p><br><p>          ,         .       <code>%prep</code> .       ,    ,      : <br></p><br><pre> <code class="plaintext hljs">%apply_patches</code> </pre><br><p>       <code>rpmbuild -bp xkb-switch.spec</code> .    ‚Äî    . <br></p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  Maximum RPM</a> . <br></p><br><p>    . <br></p><br><br><a name="build"></a><br><h2>  </h2><br><p>      <code>%build</code> .   <code>README</code>  ,     <code>cmake ..</code>  <code>make</code> ,     -   .  :           ,     .    ,        <code>%build</code> : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bc ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>exit 0</code> :    . <br></p><br><p> ,         .     shell (  bash  zsh,     ).  <code>rpmbuild</code>      ,           .    shell    - ‚Äî        . (    .) <br></p><br><p>     -  , ,  ,     <code>%build</code>  shell  . <br></p><br><p>     ,    ,   .      <code>cmake</code> , , ,        <code>%cmake</code>      -  ,      ,    .         (   ‚Äî <code>CMakeLists.txt</code> ).             ,    . <br></p><br><br><a name="install"></a><br><h2>  Instalaci√≥n </h2><br><p> , <em></em> .   <code>%install</code>   ,               ,     ,    <code>~/rpmbuild/BUILDROOT/__-buildroot/</code> . <br></p><br><p>  <code>__</code>    ,     <code>Name:</code>   -,   ( <code>Version:</code>  -),   ( <code>Release:</code>  -),  ,     . <br></p><br><p>   <code>README</code>  ,     <code>make install</code> ,    <code>build</code>   .  - - <code>%makeinstall_std -C build</code>    ,   .       ( ,   ): <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bi ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>      ,       RPM.   -   ,     . <br></p><br><br><a name="packing"></a><br><h2>   </h2><br><p>         ,      -  .     ,     <code>~/rpmbild/BUILDROOT/</code> . ( , ,     <code>tree</code> ,  -      Linux.)  ,       ,       <code>.debug</code> .    , ,    :        . <br></p><br><p>  ,       ,   <code>%files</code>  -.   ,     ,      .  . <br></p><br><p>       <code>%files</code>  -.  ,    .   Rosa Linux       <code>%prep</code> (  -   ).   ,   ,     ,  ,        ‚Äî   .          - (,    ,     ). <br></p><br><p>   <code>%files</code>    ,      RPM. ,     : <br></p><br><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz</code> </pre><br><br><p>         -.   , ,     <code>/usr/lib/rpm/macros</code> .  , <code>%{_bindir}</code>     , <code>%{_libdir}</code> ‚Äî   ,  <code>%{_mandir}</code> ‚Äî    man.   <code>%{name}</code>  <code>%{version}</code>    <code>Name:</code>  <code>Version:</code>   -. <br></p><br><p>     : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p> ‚Ä¶   2   1 .    <code>rpmlint</code> ,      .  ,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> Rpmlint Errors</a>  ,   : <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: incoherent-version-in-name (</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Error: </font><b><font style="vertical-align: inherit;">50) 1`</font></b><font style="vertical-align: inherit;"> Error: La versi√≥n en el nombre del paquete de la biblioteca no se ha especificado correctamente. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: ejecutable-en-paquete-biblioteca (Mal: 1) / usr / bin / xkb-switch`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Error: el paquete de biblioteca contiene un archivo ejecutable. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: W: devel-file-in-non-devel-package / usr / lib / libxkbswitch.so`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Advertencia de que </font><font style="vertical-align: inherit;">se encontr√≥ un </font><font style="vertical-align: inherit;">archivo de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paquete de desarrollo</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) en un paquete que no estaba destinado al desarrollo.</font></font><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬øEst√° todo claro? </font></font> No lo creo<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Echemos un vistazo m√°s de cerca a lo que est√° sucediendo aqu√≠. </font></font><br></p><br><br><a name="packing-rpmlint"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬øQu√© es rpmlint? </font></font></h3><br><p>     Rosa Linux  <code>rpmbuild</code>   <code>rpmlint</code> ,    .  <code>rpmlint</code>    ,   ,      .   ,     Rosa Linux (  ,     <code>rpmlint</code> )     . <br></p><br><p>     ,     ,      .       <code>~/rpmbuild/RPMS/_/</code>         <code>rpmlint -i __</code> . <br></p><br><p> ,      RPM   - ,  ,    ,  ,      Rosa Linux,      <code>rpmlint -i __</code> . <br></p><br><br><a name="packing-package_types"></a><br><h3>   RPM  Rosa Linux </h3><br><p>   Rosa Linux   6 .   ,          . <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paquete ejecutable</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es binario. Contiene solo un archivo binario o script destinado directamente a la ejecuci√≥n. Los archivos de estos paquetes se instalan con mayor frecuencia en una carpeta </font></font><code>/bin/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o en </font></font><code>/usr/bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tambi√©n puede contener enlaces, por la posibilidad de llamar al programa usando varios nombres diferentes. El nombre del paquete corresponde al nombre del programa. Dichos paquetes a menudo dependen de la biblioteca. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biblioteca</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contiene archivos compilados de </font><b><font style="vertical-align: inherit;">bibliotecas</font></b><font style="vertical-align: inherit;"> conectadas din√°micamente ("compartidas", "compartidas") utilizadas por los programas. Por lo general, este es el archivo de la biblioteca en s√≠, cuyo nombre termina con la versi√≥n, y un enlace a este archivo, cuyo nombre termina con el primer n√∫mero de versi√≥n. Por ejemplo, para una </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi√≥n de </font><font style="vertical-align: inherit;">biblioteca </font><font style="vertical-align: inherit;">1.0.2 ser√° un archivo </font></font><code>libxkbfile.so.1.0.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y un enlace a √©l,</font></font><code>libxkbfile.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. El mismo nombre del paquete de la biblioteca, por el cual se reconoce en el repositorio del instalador, termina con el primer n√∫mero de versi√≥n y comienza con el prefijo </font></font><code>lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. La biblioteca tiene el </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre correcto - </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Esto se debe al hecho de que, por lo general, el n√∫mero de la primera versi√≥n cambia solo con cambios de biblioteca incompatibles, por lo que ser√° posible instalar varios paquetes con una biblioteca de versiones diferentes si algunos programas usan la versi√≥n anterior de la biblioteca y otros usan una versi√≥n m√°s nueva. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paquete para desarrolladores</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Archivos necesarios para compilar programas que usan la biblioteca, pero innecesarios para el trabajo de programas listos. Para programas simples de </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , este es un enlace al archivo de la biblioteca, pero sin versiones en el nombre (por ejemplo,</font></font><code>libxkbfile.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), as√≠ como los archivos de encabezado (con la extensi√≥n </font></font><code>.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Nombre del paquete termina con </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por ejemplo: </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Durante la instalaci√≥n, siempre depende de la biblioteca adecuada. Por ejemplo, el paquete </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">depende de </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo fuente Los</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repositorios Rosa Linux tienen paquetes RPM que contienen el c√≥digo fuente de algunos programas, principalmente aquellos que </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente necesitan ser</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reconstruidos. Los nombres de estos paquetes terminan con </font></font><code>-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font><code>-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(por ejemplo, </font></font><code>apache-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">siempre crea dicho paquete autom√°ticamente y lo pone en </font></font><code>~/rpmbuild/SRPMS/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S√≠mbolos de depuraci√≥n</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta es informaci√≥n que se puede usar para depurar un programa terminado. </font><font style="vertical-align: inherit;">Asocia ubicaciones en archivos compilados con c√≥digo fuente. </font><font style="vertical-align: inherit;">Dichos paquetes son creados </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autom√°ticamente </font><font style="vertical-align: inherit;">por el equipo </font><font style="vertical-align: inherit;">, se asigna un final a su nombre </font></font><code>-debuginfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">No encontr√© dichos paquetes en los repositorios de Rosa Linux.</font></font><br><br>  <b>La documentaci√≥n</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los repositorios Rosa Linux tienen paquetes de documentaci√≥n para varios programas y bibliotecas. </font><font style="vertical-align: inherit;">Yo (por ahora) no conozco las caracter√≠sticas de construir tales paquetes. </font><font style="vertical-align: inherit;">Sus nombres suelen terminar en </font></font><code>doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, por ejemplo </font></font><code>libx11-doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>java-1.7.0-openjdk-javadoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Por cierto, casi todos est√°n hechos al estilo de los sitios web, y para verlos, es mejor abrir un navegador, ir a la direcci√≥n </font></font><code>file:///usr/share/doc/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y seleccionar la carpeta y el archivo deseados.</font></font><br><br><br><br><a name="packing-result"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nuestro resultado </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ahora todo se ha vuelto m√°s claro. </font></font><br></p><br><br><ul><li>    <code>xkb-switch</code>   <code>libxkbswitch.so</code> , ,  ,    <em>  </em> .   ,          : <code>xkb-switch.i586: W: devel-file-in-non-devel-package /usr/lib/libxkbswitch.so</code> . <br></li><li>     <em></em> ,      <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> .       ,       .  : <code>xkb-switch.i586: E: executable-in-library-package (Badness: 1) /usr/bin/xkb-switch</code> . <br></li><li>    ,          (1).   : <code>xkb-switch.i586: E: incoherent-version-in-name (Badness: 50) 1</code> . <br></li></ul><br><br><p> ,  <code>rpmlint</code> ,     .          .   <em>xkb-switch</em> ,      <code>libxkbswitch.so.1.6.0</code>       ,        <em>Vim</em> .            <em>xkb-switch</em> ,          <em>C</em>  <em>C++</em> .  RPM-    . <br></p><br><p>       -: <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-   xkb-switch</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Summary: Query and change XKB layout state Name: xkb-switch Version: 1.6.0 Release: 1 License: GPLv3+ Group: Development/X11 URL: https://github.com/ierton/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley. %files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="subpackaging"></a><br><h2>       </h2><br><p>        ‚Äî ,         .    ,  ,       <code>xkb-switch</code>  3 : <em></em> , <em></em>   <em></em> . : <br></p><br><br><ul><li>  <em></em>     <code>/usr/bin/xkb-switch</code>    <code>/usr/share/man/man1/xkb-switch.1.xz</code> , <br></li><li>  <em></em> ‚Äî  <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <em> </em> ‚Äî <code>/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       -.  ,   , <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  - Maximum RPM</a> .     <a href=""> -  libxkbfile</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   Rosa Linux</a> . <br></p><br><p>    . <br></p><br><br><a name="subpackaging-macros"></a><br><h3>    </h3><br><p>        ‚Äî   <a href="">-  libxkbfile</a> .     -  : <br></p><br><br><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch</code> </pre><br><br><p>    <code>%define</code>  .        ,    (     ) ‚Äî   ,       .     ,    <code>%{major}</code>   <code>1</code> ,      . <br></p><br><p>  <code>%mklibname</code>   ¬´lib¬ª,     ,      ‚Äî   (  ).     <code>%{libname}</code>  <em>¬´lib¬ª + ¬´xkbswitch¬ª + (  %{major}) =</em> <code>libxkbswitch1</code> ‚Äî   . <br></p><br><p>  <code>-d</code>  <code>%mklibname</code>   <code>-devel</code> .    <code>%{develname}</code>  <code>libxkbswitch-devel</code> ‚Äî    . <br></p><br><br><a name="subpackaging-change_header"></a><br><h3>    </h3><br><p>     <code>Version:</code>   <br></p><br><br><pre> <code class="plaintext hljs">Version: %{major}.6.0</code> </pre><br><br><p>  ,           -. <br></p><br><p>      -       .      .      : <br></p><br><pre> <code class="plaintext hljs">Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><a name="subpackaging-packages"></a><br><h3>    </h3><br><p>     <em>-</em>     . <em>-</em>   , -      (    <em>rpm</em> ).       <code>%package</code> .        -.     ,    -.          <code>Version</code> , <code>Summary</code> , <code>Group</code> .      <code>Provides</code>  <code>Requires</code>   <em></em>  <em></em> ,     .  <code>Name</code>   :    ,     <code>%package</code> . <br></p><br><p>      .     <code>%description</code>       ‚Äî   ,     <code>%package</code> . <br></p><br><p>  Rosa Linux   -   <code>%description</code>  -.    <code>libxkbswitch1</code> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'.</code> </pre><br><br><p>  <code>-n</code>    <code>%package</code>  <code>%description</code> ,       .    -        ,    <code>xkb-switch-libxkbswitch1</code> .       <code>libxkbswitch1</code> .           . <br></p><br><p>    <em> </em> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'.</code> </pre><br><br><a name="subpackaging-files"></a><br><h3>     </h3><br><p>   ,      .     <code>%files</code> . <br></p><br><p>      ,     ,    <code>%package</code> , <code>%description</code>  <code>%files</code> .  ,    <code>%description</code>  -    .   ,      ,    ‚Äî <code>xkb-switch</code> . <br></p><br><p>  -  Rosa Linux     <code>%files</code>   ,    <code>%prep</code> .       : <br></p><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_mandir}/%{name}.1.xz %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %files -n %{develname} %{_libdir}/libxkbswitch.so</code> </pre><br><br><p>    , : <br></p><br><br><ul><li>   <code>xkb-switch</code>   <code>~/usr/bin/xkb-switch</code>  <code>~/usr/share/man/man1/xkb-switch.1</code> , <br></li><li>   <code>libxkbswitch1</code>   <code>~/usr/lib/libxkbswitch.so.1</code>  <code>~/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <code>libxkbswitch-devel</code>   <code>~/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       <code>cleanup.sh</code>       <code>rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> .    3 : <br></p><br><br><pre> <code class="plaintext hljs">libxkbswitch1.i586: W: no-documentation libxkbswitch-devel.i586: W: no-documentation libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> </pre><br><br><p>   ,       .   ,     .     .  Tratemos de resolverlo. <br></p><br><br><a name="subpackaging-problems"></a><br><h3>    </h3><br><p> ,      ,  ,        <code>README.md</code> .     <code>%files</code>      ‚Äî    <code>%doc</code> : <br></p><br><br><pre> <code class="plaintext hljs">%doc README.md</code> </pre><br><br><p>      .    <code>%doc</code> ‚Äî    .        <code>~/rpmbuild/BUILD/xkb-switdh-master/README.md</code> . <br></p><br><p>       : <code>libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> .  ,    <code>libxkbswitch-devel</code>    <code>libxkbswitch</code>  . <br></p><br><p>    <code>rpm -qp  --</code>       .            : <br></p><br><pre> <code class="bash hljs">[user@pc ~] $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/RPMS/i586/ [user@pc ~/rpmbuild/RPMS/i586] $ ls libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-debuginfo-1.6.0-1-rosa2014.1.i586.rpm [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch.so.1 libxkbswitch1 = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libxkbswitch) libxkbswitch-devel = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libX11) devel(libgcc_s) devel(libstdc++) devel(libxkbfile) rpmlib(PayloadIsXz) &lt;= 5.2-1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libc.so.6 libc.so.6(GLIBC_2.0) libc.so.6(GLIBC_2.1.3) libgcc_s.so.1 libgcc_s.so.1(GCC_3.0) libstdc++.so.6 libstdc++.so.6(CXXABI_1.3) libstdc++.so.6(GLIBCXX_3.4) libstdc++.so.6(GLIBCXX_3.4.11) libstdc++.so.6(GLIBCXX_3.4.20) libstdc++.so.6(GLIBCXX_3.4.9) libxkbswitch.so.1 rpmlib(PayloadIsXz) &lt;= 5.2-1</code> </pre><br><br><p>  ,    <code>libxkbswitch1</code>   <code>libxkbswitch.so.1</code>  <code>libxkbswitch1</code> .  <code>xkb-switch</code>   <code>libxkbswitch.so.1</code> ,     <code>libxkbswitch-devel</code>    <code>libxkbswitch1</code> .   ,     <code>%package</code>  <code>libxkbswitch-devel</code> .      : <br></p><br><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version}</code> </pre><br><br><p>        , ‚Ä¶       .     <code>libxkbswitch-devel</code>  ,  ,    .     ,         ,  <code>rpmbuild</code>      . <br></p><br><p> -,     (  <code>README.md</code>    ), ‚Äî  : <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-    </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch # Main package. Automaticaly requires libxkbswitch and libxkbswitch-devel Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley. # libxkbswitch %package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'. # libxkbswitch-devel %package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version} %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'. # xkb-switch %files %{_bindir}/%{name} %{_mandir}/man1/%{name}.1.xz # libxkbswitch1 %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %doc README.md # libxkbswitch-devel %files -n %{develname} %{_libdir}/libxkbswitch.so %doc README.md #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="summary"></a><br><h2>  Conclusi√≥n </h2><br><p>  ,      RPM    <em>Rosa Linux</em> (       ).       ,   -. ,       ‚Äî ,   ,   <em>rpmrc</em> ,      <em>ABF</em>   , ‚Äî         . <br></p><br><p>        ‚Äî    ,      -,         - , ‚Äî     . <br></p><br><br><a name="commands"></a><br><h2>   </h2><br><br><a name="commands-build"></a><br><h3>     </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bp specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ejecutar </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preparaci√≥n</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% prep). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bc specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ejecutar </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compilaci√≥n</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (build%) y todas las acciones anteriores. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bi specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">psevdoustanovku</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% install) y todas las acciones anteriores. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -ba specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cree paquetes completamente.</font></font><br><br><br><br><a name="commands-package"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comprobando el paquete terminado </font></font></h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmlint -i nombre_archivo_paquete.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificaci√≥n general: qu√© tan bien se cre√≥ el paquete. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp --provides package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Compruebe qu√© "caracter√≠sticas" proporciona el paquete. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp - requiere paquete_nombre_archivo.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verifique de qu√© "capacidades" de otros paquetes depende este paquete. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpl nombre_archivo_paquete.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lista de archivos contenidos en el paquete. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpi package-file-name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informaci√≥n sobre el paquete (del "encabezado" del archivo de especificaciones o del bloque </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% package</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><br><br><p>          ,    <code>p</code> .    ,     Rosa Linux,   .     <code>urpmq</code> ,   <code>rpm -q</code> . , <code>urpmq -l _</code>    ,  <code>urpmq --requires _</code>   . <br></p><br><br><a name="links"></a><br><h2>   ( ) </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Building RPMs ‚Äî Quick Start</a> ‚Äî         RPM  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> RPM</a> ‚Äî    ,   ,       .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RPM:  spec </a> ‚Äî    -  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Maximum RPM</a> ‚Äî        <code>rpm</code>   RPM-  RedHat Linux.         ,      Rosa Linux.    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Template Spec Files</a> ‚Äî   <code>.spec</code> .  ,      -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Automatic Build Farm (ABF)</a> ‚Äî      Rosa Linux.             ,   ,     ,    <code>.spec</code> .     -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rpmlint Errors</a> ‚Äî    ,   <code>rpmlint</code> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Packaging Group</a> ‚Äî    Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   Rosa Linux</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Git ‚Äî </a> ‚Äî      <em>Git</em> . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/464993/">https://habr.com/ru/post/464993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../464981/index.html">Google proporciona argumentos para justificar el seguimiento de los usuarios: la empresa est√° acusada de falta de sinceridad y manipulaci√≥n</a></li>
<li><a href="../464985/index.html">Internet de las cosas (IoT) va a cambiar el mundo. Futuro de IoT</a></li>
<li><a href="../464987/index.html">Repositorios en Kubernetes: OpenEBS vs Rook (Ceph) vs Rancher Longhorn vs StorageOS vs Robin vs Portworx vs Linstor</a></li>
<li><a href="../464989/index.html">Contexto de extravagancia</a></li>
<li><a href="../464991/index.html">Proyectos que no despegaron</a></li>
<li><a href="../464995/index.html">Ajustar secuencias en Swift</a></li>
<li><a href="../464997/index.html">Sobre el desarrollo de las tecnolog√≠as de realidad virtual: d√≥nde lo usan, por qu√© los negocios de realidad virtual y qu√© dispositivos usan</a></li>
<li><a href="../464999/index.html">C√≥mo est√°n cambiando los detalles de trabajar con servidores de aplicaciones usando el ejemplo OpenLiberty</a></li>
<li><a href="../465001/index.html">Amazon Prime Day 2019 - Desarrollado por AWS</a></li>
<li><a href="../465003/index.html">Intereses para el g√©nero ARPG</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>