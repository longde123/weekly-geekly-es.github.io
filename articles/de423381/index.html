<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😍 😟 👩🏿‍🤝‍👩🏻 Ressourcensteuerung. Passen Sie SwiftGen an 🤽🏼 🖐🏽 👩🏿‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wahrscheinlich kann der Langlebige in jedem großen iOS-Projekt auf Symbole stoßen, die nirgendwo verwendet werden, oder auf Lokalisierungsschlüssel, d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ressourcensteuerung. Passen Sie SwiftGen an</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/423381/"><p>  Wahrscheinlich kann der Langlebige in jedem großen iOS-Projekt auf Symbole stoßen, die nirgendwo verwendet werden, oder auf Lokalisierungsschlüssel, die schon lange nicht mehr existieren.  Meistens entstehen solche Situationen durch Unaufmerksamkeit, und Automatisierung ist das beste Mittel gegen Unaufmerksamkeit. </p><br><p>  Im iOS-Team von HeadHunter legen wir großen Wert auf die Automatisierung der Routineaufgaben, denen Entwickler möglicherweise begegnen.  Mit diesem Artikel möchten wir einen Zyklus von Geschichten über jene Werkzeuge und Ansätze beginnen, die unsere tägliche Arbeit vereinfachen. </p><br><p>  Vor einiger Zeit ist es uns gelungen, die Kontrolle über Anwendungsressourcen mithilfe des Dienstprogramms SwiftGen zu übernehmen.  Wie man es konfiguriert, wie man damit lebt und wie dieses Dienstprogramm dabei hilft, die Überprüfung der Relevanz von Ressourcen auf die Schultern des Compilers zu verlagern, und wir werden über cat sprechen. </p><br><p><img src="https://habrastorage.org/webt/dl/sy/-c/dlsy-cocqhwmu02tsyr4aoukf-y.jpeg"></p><a name="habracut"></a><br><p>  SwiftGen ist ein Dienstprogramm, mit dem Sie Swift-Code für den Zugriff auf verschiedene Ressourcen eines Xcode-Projekts generieren können, darunter: </p><br><ul><li>  Schriftarten </li><li>  Farben </li><li>  Storyboards; </li><li>  Lokalisierungszeichenfolgen; </li><li>  Vermögenswerte. </li></ul><br><p>  Jeder kann einen ähnlichen Code schreiben, um Bilder oder Lokalisierungszeichenfolgen zu initialisieren: </p><br><pre><code class="swift hljs">logoImageView.image = <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(named: <span class="hljs-string"><span class="hljs-string">"Swift"</span></span>) nameLabel.text = <span class="hljs-type"><span class="hljs-type">String</span></span>( format: <span class="hljs-type"><span class="hljs-type">NSLocalizedString</span></span>(<span class="hljs-string"><span class="hljs-string">"languages.swift.name"</span></span>, comment: <span class="hljs-string"><span class="hljs-string">""</span></span>), locale: <span class="hljs-type"><span class="hljs-type">Locale</span></span>.current )</code> </pre> <br><p>  Um den Namen des Bildes oder des Lokalisierungsschlüssels anzugeben, verwenden wir Zeichenfolgenliterale.  Was zwischen doppelten Anführungszeichen geschrieben wird, wird vom Compiler oder der Entwicklungsumgebung (Xcode) nicht überprüft.  Darin liegen die folgenden Probleme: </p><br><ul><li>  Sie können einen Tippfehler machen; </li><li>  Möglicherweise vergessen Sie, die Verwendung im Code zu aktualisieren, nachdem Sie den Schlüssel / das Bild bearbeitet oder gelöscht haben. </li></ul><br><p>  Mal sehen, wie wir diesen Code mit SwiftGen verbessern können. </p><br><p>  Für unser Team war die Generierung nur für Zeichenfolgen und Assets relevant und wird im Artikel behandelt.  Die Generierung für andere Arten von Ressourcen ist ähnlich und kann, falls gewünscht, problemlos unabhängig gemeistert werden. </p><br><h2 id="vnedrenie-v-proekt">  Projektdurchführung </h2><br><p>  Zuerst müssen Sie SwiftGen installieren.  Wir haben uns für die Installation über CocoaPods entschieden, um das Dienstprogramm bequem auf alle Teammitglieder zu verteilen.  Dies kann jedoch auch auf andere Weise erfolgen, die in der <a href="">Dokumentation</a> ausführlich beschrieben werden.  In unserem Fall müssen Sie <code>pod 'SwiftGen'</code> den <code>pod 'SwiftGen'</code> hinzufügen und dann eine neue Build-Phase ( <code>Build Phase</code> ) hinzufügen, die SwiftGen vor dem Erstellen des Projekts startet. </p><br><pre> <code class="plaintext hljs">"$PODS_ROOT"/SwiftGen/bin/swiftgen</code> </pre> <br><p>  Es ist wichtig, SwiftGen vor dem Start der Phase " <code>Compile Sources</code> kompilieren" auszuführen, um Fehler beim Kompilieren des Projekts zu vermeiden. </p><br><p><img src="https://habrastorage.org/webt/gx/1t/xw/gx1txw1lfcxmghilpakndv_wnck.png"></p><br><p>  Jetzt können wir SwiftGen an unser Projekt anpassen. </p><br><h2 id="nastroyka-swiftgen">  Konfigurieren Sie SwiftGen </h2><br><p>  Zunächst müssen Sie die Vorlagen konfigurieren, mit denen der Code für den Zugriff auf die Ressourcen generiert wird.  Das Dienstprogramm enthält bereits eine Reihe von Vorlagen zum Generieren von Code. Sie können alle auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github angezeigt werden</a> und sind im Prinzip einsatzbereit.  Vorlagen sind in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schablonensprache</a> geschrieben. Sie sind möglicherweise damit vertraut, wenn Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sourcery verwendet</a> oder mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kitura gespielt haben</a> .  Auf Wunsch kann jede der Vorlagen an ihre eigenen Handbücher angepasst werden. <br>  Nehmen Sie beispielsweise die Vorlage, die <code>enum</code> generiert, um auf Lokalisierungszeichenfolgen zuzugreifen.  Es schien uns, dass im Standard zu viel überflüssig ist und es vereinfacht werden kann.  Ein vereinfachtes Beispiel mit erklärenden Kommentaren befindet sich unter dem Spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">Vorlagenbeispiel</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{#      #} {% set accessModifier %}{% if param.publicAccess %}public{% else %}internal{% endif %}{% endset %} {#    #} {% macro parametersBlock types %}{% filter removeNewlines:"leading" %} {% for type in types %} _ p{{forloop.counter}}: {{type}}{% if not forloop.last %}, {% endif %} {% endfor %} {% endfilter %}{% endmacro %} {% macro argumentsBlock types %}{% filter removeNewlines:"leading" %} {% for type in types %} p{{forloop.counter}}{% if not forloop.last %}, {% endif %} {% endfor %} {% endfilter %}{% endmacro %} {#       enum        #} {% macro recursiveBlock table item sp %} {{sp}}{% for string in item.strings %} {{sp}}{% if not param.noComments %} {{sp}}/// {{string.translation}} {{sp}}{% endif %} {{sp}}{% if string.types %} {{sp}}{{accessModifier}} static func {{string.name|swiftIdentifier:"pretty"|lowerFirstWord|escapeReservedKeywords}}({% call parametersBlock string.types %}) -&gt; String { {{sp}} return localize("{{string.key}}", {% call argumentsBlock string.types %}) {{sp}}} {{sp}}{% else %} {{sp}}{{accessModifier}} static let {{string.name|swiftIdentifier:"pretty"|lowerFirstWord|escapeReservedKeywords}} = localize("{{string.key}}") {{sp}}{% endif %} {{sp}}{% endfor %} {{sp}}{% for child in item.children %} {{sp}}{{accessModifier}} enum {{child.name|swiftIdentifier:"pretty"|escapeReservedKeywords}} { {{sp}}{% set sp2 %}{{sp}} {% endset %} {{sp}}{% call recursiveBlock table child sp2 %} {{sp}}} {{sp}}{% endfor %} {% endmacro %} import Foundation {#   enum #} {% set enumName %}{{param.enumName|default:"L10n"}}{% endset %} {{accessModifier}} enum {{enumName}} { {% if tables.count &gt; 1 %} {% for table in tables %} {{accessModifier}} enum {{table.name|swiftIdentifier:"pretty"|escapeReservedKeywords}} { {% call recursiveBlock table.name table.levels " " %} } {% endfor %} {% else %} {% call recursiveBlock tables.first.name tables.first.levels " " %} {% endif %} } {#  enum Localization         #} extension Localization { fileprivate static func localize(_ key: String, _ args: CVarArg...) -&gt; String { return String( format: NSLocalizedString(key, comment: ""), locale: Locale.current, arguments: args ) } }</code> </pre> </div></div><br><p>  Es ist praktisch, die Vorlagendatei selbst im Stammverzeichnis des Projekts zu speichern, z. B. im Ordner <code>SwiftGen/Templates</code> damit diese Vorlage allen Personen zur Verfügung steht, die am Projekt arbeiten. <br>  Das Dienstprogramm unterstützt die Konfiguration über die YAML-Datei <code>swiftgen.yml</code> , in der Sie die Pfade zu den Quelldateien, Vorlagen und zusätzlichen Parametern angeben können.  Erstellen Sie es im Stammverzeichnis des Projekts im <code>Swiftgen</code> Ordner und gruppieren Sie später andere Dateien, die sich auf das Skript beziehen, in demselben Ordner. <br>  Für unser Projekt könnte diese Datei folgendermaßen aussehen: </p><br><pre> <code class="plaintext hljs">xcassets: - paths: ../SwiftGenExample/Assets.xcassets templatePath: Templates/ImageAssets.stencil output: ../SwiftGenExample/Image.swift params: enumName: Image publicAccess: 1 noAllValues: 1 strings: - paths: ../SwiftGenExample/en.lproj/Localizable.strings templatePath: Templates/LocalizableStrings.stencil output: ../SwiftGenExample/Localization.swift params: enumName: Localization publicAccess: 1 noComments: 0</code> </pre> <br><p>  Tatsächlich werden dort die Pfade zu Dateien und Vorlagen sowie zusätzliche Parameter angegeben, die an den Vorlagenkontext übergeben werden. <br>  Da sich die Datei nicht im Stammverzeichnis des Projekts befindet, müssen Sie beim Starten von Swiftgen den Pfad dazu angeben.  Ändern Sie unser Startskript: </p><br><pre> <code class="plaintext hljs">"$PODS_ROOT"/SwiftGen/bin/swiftgen config run --config SwiftGen/swiftgen.yml</code> </pre> <br><p>  Jetzt kann unser Projekt zusammengestellt werden.  Nach dem Zusammenbau sollten zwei Dateien <code>Localization.swift</code> und <code>Image.swift</code> im Projektordner entlang der in <code>Image.swift</code> angegebenen Pfade <code>Image.swift</code> .  Sie müssen dem Xcode-Projekt hinzugefügt werden.  In unserem Fall enthalten die generierten Dateien Folgendes: </p><br><div class="spoiler">  <b class="spoiler_title">Für Saiten:</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Localization</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Languages</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObjectiveC</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/// General-purpose, object-oriented programming language that adds Smalltalk-style messaging to the C programming language public static let description = localize("languages.objective-c.description") /// https://en.wikipedia.org/wiki/Objective-C public static let link = localize("languages.objective-c.link") /// Objective-C public static let name = localize("languages.objective-c.name") } public enum Swift { /// General-purpose, multi-paradigm, compiled programming language developed by Apple Inc. for iOS, macOS, watchOS, tvOS, and Linux public static let description = localize("languages.swift.description") /// https://en.wikipedia.org/wiki/Swift_(programming_language) public static let link = localize("languages.swift.link") /// Swift public static let name = localize("languages.swift.name") } } public enum MainScreen { /// Language public static let title = localize("main-screen.title") public enum Button { /// View in Wikipedia public static let title = localize("main-screen.button.title") } } } extension Localization { fileprivate static func localize(_ key: String, _ args: CVarArg...) -&gt; String { return String( format: NSLocalizedString(key, comment: ""), locale: Locale.current, arguments: args ) } }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Für Bilder:</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Image</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Logos</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> objectiveC: <span class="hljs-type"><span class="hljs-type">UIImage</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image(named: <span class="hljs-string"><span class="hljs-string">"ObjectiveC"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> swift: <span class="hljs-type"><span class="hljs-type">UIImage</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image(named: <span class="hljs-string"><span class="hljs-string">"Swift"</span></span>) } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(named name: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIImage</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bundle = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: <span class="hljs-type"><span class="hljs-type">BundleToken</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> image = <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(named: name, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: bundle, compatibleWith: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"Unable to load image named \(name)."</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BundleToken</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> </div></div><br><p>  Jetzt können Sie alle Verwendungen von Lokalisierungs- und Initialisierungszeichenfolgen von Bildern der Form <code>UIImage(named: "")</code> durch das ersetzen, was wir generiert haben.  Dies erleichtert es uns, Änderungen an Lokalisierungszeichenfolgenschlüsseln zu verfolgen oder diese zu entfernen.  In jedem dieser Fälle wird das Projekt einfach erst zusammengestellt, wenn alle mit den Änderungen verbundenen Fehler behoben wurden. <br>  Nach den Änderungen sieht unser Code folgendermaßen aus: </p><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> logos = <span class="hljs-type"><span class="hljs-type">Image</span></span>.<span class="hljs-type"><span class="hljs-type">Logos</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> localization = <span class="hljs-type"><span class="hljs-type">Localization</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupWithLanguage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> language: ProgrammingLanguage)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> language { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .<span class="hljs-type"><span class="hljs-type">Swift</span></span>: logoImageView.image = logos.swift nameLabel.text = localization.<span class="hljs-type"><span class="hljs-type">Languages</span></span>.<span class="hljs-type"><span class="hljs-type">Swift</span></span>.name descriptionLabel.text = localization.<span class="hljs-type"><span class="hljs-type">Languages</span></span>.<span class="hljs-type"><span class="hljs-type">Swift</span></span>.description wikiUrl = localization.<span class="hljs-type"><span class="hljs-type">Languages</span></span>.<span class="hljs-type"><span class="hljs-type">Swift</span></span>.link.toURL() <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .<span class="hljs-type"><span class="hljs-type">ObjectiveC</span></span>: logoImageView.image = logos.objectiveC nameLabel.text = localization.<span class="hljs-type"><span class="hljs-type">Languages</span></span>.<span class="hljs-type"><span class="hljs-type">ObjectiveC</span></span>.name descriptionLabel.text = localization.<span class="hljs-type"><span class="hljs-type">Languages</span></span>.<span class="hljs-type"><span class="hljs-type">ObjectiveC</span></span>.description wikiUrl = localization.<span class="hljs-type"><span class="hljs-type">Languages</span></span>.<span class="hljs-type"><span class="hljs-type">ObjectiveC</span></span>.link.toURL() } }</code> </pre> <br><h2 id="nastroyka-proekta-v-xcode">  Einrichten eines Projekts in Xcode </h2><br><p>  Es gibt ein Problem mit den generierten Dateien: Sie können versehentlich manuell geändert werden, und da sie bei jeder Kompilierung von Grund auf neu überschrieben werden, können diese Änderungen verloren gehen.  Um dies zu vermeiden, können Sie Dateien zum Schreiben sperren, nachdem Sie <code>SwiftGen</code> Skript ausgeführt haben. <br>  Dies kann mit dem <code>chmod</code> erreicht werden.  Wir schreiben unsere <code>Build Phase</code> mit dem Start von SwiftGen wie folgt um: </p><br><pre> <code class="plaintext hljs">PODSROOT="$1" OUTPUT_FILES=() COUNTER=0 while [ $COUNTER -lt ${SCRIPT_OUTPUT_FILE_COUNT} ]; do tmp="SCRIPT_OUTPUT_FILE_$COUNTER" OUTPUT_FILES+=(${!tmp}) COUNTER=$[$COUNTER+1] done for file in "${OUTPUT_FILES[@]}" do if [ -f $file ] then chmod a=rw "$file" fi done $PODSROOT/SwiftGen/bin/swiftgen config run --config SwiftGen/swiftgen.yml for file in "${OUTPUT_FILES[@]}" do chmod a=r "$file" done</code> </pre> <br><p>  Das Skript ist ziemlich einfach.  Wenn die Dateien vorhanden sind, erteilen wir ihnen vor Beginn der Generierung Schreibberechtigungen.  Nach dem Ausführen des Skripts blockieren wir die Möglichkeit, Dateien zu ändern. <br>  Um das Bearbeiten zu vereinfachen und das Skript auf Überprüfung zu überprüfen, ist es praktisch, es in einer separaten Datei <code>runswiftgen.sh</code> .  Die endgültige Version des Skripts mit geringfügigen Änderungen finden Sie <a href="">hier</a> .  Jetzt sieht unsere <code>Build Phase</code> aus: Wir übergeben den Pfad zum Pods-Ordner an die Skripteingabe: </p><br><pre> <code class="plaintext hljs">"$SRCROOT"/SwiftGen/runswiftgen.sh "$PODS_ROOT"</code> </pre> <br><p>  Wir erstellen das Projekt neu. Wenn Sie nun versuchen, die generierte Datei manuell zu ändern, wird eine Warnung angezeigt: </p><br><p><img src="https://habrastorage.org/webt/-n/ly/km/-nlykmdjarer-97mhderydx5psq.png"></p><br><p>  Der Ordner mit Swiftgen enthält nun eine Konfigurationsdatei, ein Skript zum Sperren von Dateien und zum Starten von <code>Swiftgen</code> sowie einen Ordner mit benutzerdefinierten Vorlagen.  Es ist praktisch, es dem Projekt zur weiteren Bearbeitung hinzuzufügen, falls erforderlich. </p><br><p><img src="https://habrastorage.org/webt/yw/dk/kq/ywdkkqfdjws_a32syu94hscr4cm.png"></p><br><p>  Und da die <code>Image.swift</code> <code>Localization.swift</code> und <code>Image.swift</code> automatisch generiert werden, können Sie sie zu .gitignore hinzufügen, damit Sie Konflikte nach dem erneuten <code>git merge</code> nicht lösen müssen. </p><br><p>  Ich möchte auch auf die Notwendigkeit aufmerksam machen, Eingabe- / Ausgabedateien für den SwiftGen-Phasenaufbau anzugeben, wenn Ihr Projekt das Xcode New Build System verwendet (es ist das Standard-Build-System mit Xcode 10).  In der Liste Eingabedateien müssen Sie alle Dateien angeben, auf deren Grundlage der Code generiert wird.  In unserem Fall ist dies das Skript selbst, die Konfiguration, Vorlagen, .strings- und .xcassets-Dateien: </p><br><pre> <code class="plaintext hljs">$(SRCROOT)/SwiftGen/runswiftgen.sh $(SRCROOT)/SwiftGen/swiftgen.yml $(SRCROOT)/SwiftGen/Templates/ImageAssets.stencil $(SRCROOT)/SwiftGen/Templates/LocalizableStrings.stencil $(SRCROOT)/SwiftGenExample/en.lproj/Localizable.strings $(SRCROOT)/SwiftGenExample/Assets.xcassets</code> </pre> <br><p>  In die Ausgabedateien legen wir die Dateien ab, in denen SwiftGen den Code generiert: </p><br><pre> <code class="plaintext hljs">$(SRCROOT)/SwiftGenExample/Image.swift $(SRCROOT)/SwiftGenExample/Localization.swift</code> </pre> <br><p>  Die Angabe dieser Dateien ist erforderlich, damit das Build-System entscheiden kann, ob das Skript ausgeführt werden soll, je nachdem, ob Änderungen in den Dateien vorhanden sind oder nicht, und zu welchem ​​Zeitpunkt in der Assembly des Projekts dieses Skript ausgeführt werden soll. </p><br><h2 id="itogi">  Zusammenfassung </h2><br><p>  SwiftGen ist ein gutes Werkzeug zum Schutz vor Unachtsamkeit bei der Arbeit mit Projektressourcen.  Damit konnten wir automatisch Code generieren, um auf Anwendungsressourcen zuzugreifen und einen Teil der Arbeit auf die Überprüfung der Relevanz von Ressourcen für den Compiler zu verlagern, was bedeutet, unsere Arbeit ein wenig zu vereinfachen.  Darüber hinaus haben wir das Xcode-Projekt so eingerichtet, dass die weitere Arbeit mit dem Tool bequemer ist. </p><br><p>  <strong>Vorteile:</strong> </p><br><ol><li>  Einfachere Steuerung der Projektressourcen. </li><li>  Tippfehler werden reduziert, es wird möglich, die automatische Substitution zu verwenden. </li><li>  Fehler werden bei der Kompilierung überprüft. </li></ol><br><p>  <strong>Nachteile:</strong> </p><br><ol><li>  Keine Unterstützung für Localizable.stringsdict. </li><li>  Nicht verwendete Ressourcen werden nicht berücksichtigt. </li></ol><br><p>  Das vollständige Beispiel finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de423381/">https://habr.com/ru/post/de423381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de423371/index.html">Volvo führte einen autonomen Elektrofahrzeug ohne Kabine ein</a></li>
<li><a href="../de423373/index.html">Künstliches Denken ohne fatale Fehler ohne neuronale Netze</a></li>
<li><a href="../de423375/index.html">Koreanische Wissenschaftler haben einen Weg gefunden, um Schäden an den Wänden des Tokamaks aufgrund von Plasmainstabilität zu vermeiden</a></li>
<li><a href="../de423377/index.html">PgModeler-Baugruppe</a></li>
<li><a href="../de423379/index.html">Warum ein vollständiger Verzicht auf Bargeld für Entwicklungsländer zu teuer sein kann</a></li>
<li><a href="../de423383/index.html">Ajax js Modifikation für Ajax Asp .net mvc</a></li>
<li><a href="../de423385/index.html">Kurs "Grundlagen der Programmierung"</a></li>
<li><a href="../de423391/index.html">CLRium # 4: .Net Community Meeting</a></li>
<li><a href="../de423393/index.html">Regelbasierte neuronale Netze</a></li>
<li><a href="../de423395/index.html">Tesla stellte vierteljährlich einen Rekord für produzierte Elektroautos auf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>