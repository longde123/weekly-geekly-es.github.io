<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐃 🚞 ❔ 如何使用Python，Django和Webhook为VKontakte创建聊天机器人 🙅🏾 ☺️ ♎️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="为什么还要再写一篇有关创建聊天机器人的文章？ 
 也许我搜索不力，但是找不到关于使用Django框架和由俄罗斯公司托管的webhook方法创建python机器人的详细指南。 大多数材料都谈论使用Flask框架以及使用Heroku和PythonAnywhere的免费托管。 Habr社区的经验帮了我大忙...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何使用Python，Django和Webhook为VKontakte创建聊天机器人</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429628/"><h3> 为什么还要再写一篇有关创建聊天机器人的文章？ </h3><br> 也许我搜索不力，但是找不到关于使用Django框架和由俄罗斯公司托管的webhook方法创建python机器人的详细指南。 大多数材料都谈论使用Flask框架以及使用Heroku和PythonAnywhere的免费托管。  Habr社区的经验帮了我大忙，所以我决定抽出宝贵的时间写这篇文章。 我将描述获得的实践经验，以使对此感兴趣的每个人都可以节省时间，并更好地了解如何在使用webhook方法的主机上使用Django框架在Python中制作机器人。 <br><a name="habracut"></a><br><h3> 为什么要付费托管？ </h3><br> 我认为，可行的bot版本是它独立于您的本地计算机并且24/7可用。 为此，您需要一个主机，上面有一个主机：Web服务器，数据库管理系统（用于开发Bot的功能），域名注册，为此获取SSL证书以及对所有上述经济情况的技术支持。 这种服务要花钱。 我每月为托管138卢布支付托管费用，以维护该机器人的工作基础：支持Python + Django，25 GB的MySQL DBMS，支持SSH。 <br> 在大多数课程中，我看到个人计算机被用作服务器或免费主机，但工作时间受到限制等。在示例中，该机器人会定期轮询Messenger服务器，以查找来自用户的新消息。 这是Messenger服务器上的额外负载，因此可以在一段时间内“禁止”该漫游器。 我认为，所有这些对于生产性使用都不是至关重要的。 但是对于测试和培训是完全可能的。 <br><br><h3> 什么是网络挂钩，为什么？ </h3><br> 对于产品，我认为正确的决定是使用Webhook，即我们的机器人在这种方法中，期望机器人从Messenger服务器获取消息，而不用定期请求“锤击”消息：是否有新消息。 有了一个Webhook，将是这样的：用户编写了一条消息，Messenger服务器将其发送到您的机器人，他收到了该消息，对其进行了处理并进行了回答。 <br><br><h3> 为什么是Django </h3><br> 我决定用python做一个机器人，所以我在主机上连接了python支持。 但是我没有一个选择的框架-托管只有Django。 他们说它适用于Instagram，Pinterest，Bitbucket和Mozilla。 也许这就是为什么托管提供它的原因。 <br><br><h3> 为什么选择VKontakte，而不是Telegram或Viber？ </h3><br> 从简单到复杂，对我来说，找到一种最简单，最直观的方式来建立一个Webhook至关重要。 事实证明，对于我来说，VKontakte是最可理解的，因为在“管理-使用API​​”部分的社区控制面板中，连接Webhook的明确帮助和便捷性。 我将如何进一步配置和连接所有内容的描述。 将来，我想让我的机器人在Viber中可用。 而且Telegram不在路上，因为我的托管地点在俄罗斯，而Telegram被俄罗斯封锁了。 为避免Telegram出现问题，您可以在国外购买托管服务。 <br><br><h3> 如何为VK bot安装webhook？ </h3><br>  <strong>域名https：//</strong> 。 首先，您需要注册该站点的域名并为其获取ssl证书。 <br><br> 我不想使用聊天机器人的根域，因此在注册该域之后，我创建了一个子域并收到了ssl证书。 <br><br> 我用我的个人帐户在托管站点上进行了所有这些操作。 <br> 结果，我收到了网站mybot.mysite.ru的地址及其ssl证书。 <br><br>  <strong>我们获得了机器人的VK密钥（令牌）。</strong> 首先，我创建了一个封闭的组，然后在“使用API​​”部分中进入该组的“管理”。 在“访问密钥”选项卡中是令牌，在“回调API”选项卡中是Webhook设置。 <br><br><img src="https://habrastorage.org/webt/in/46/po/in46po1vy4iq3vcdnezwpp5okg8.png"><br><br>  <strong>安装和配置Django</strong> 。 也许您不需要Django来运行python脚本，但是我不知道如何做。 <br><br> 使用PuTTY，我通过SSH连接到服务器，配置并激活了虚拟环境。 <br><br>  SSH： <br><pre><code class="bash hljs">virtualenv-2.7 virtualenv/myEnv . virtualenv/myEnv/bin/activate</code> </pre> <br> 第一行中的命令创建一个虚拟环境，第二行中的命令将其激活（注意句点后的空格）。  2.7版由托管服务商决定，您的情况可能有所不同。 因此，请阅读托管帮助。 <br><br> 接下来安装Django <br>  SSH： <br><pre> <code class="bash hljs">pip install <span class="hljs-string"><span class="hljs-string">'django&lt;2'</span></span></code> </pre><br> 我安装的Django版本不早于第二个版本，因为在主机上使用了python 2.7，并且只有小于2的Django版本可以使用。 <br><br> 并安装了python模块以与VKontakte API配合使用 <br>  SSH： <br><pre> <code class="bash hljs">pip install vk</code> </pre><br><br>  FTP： <br> 在主机的根目录中为django-projects创建了一个文件夹。 他称她为django。 <br><br>  SSH： <br> 创建了一个新项目。 <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> django/ django-admin.py startproject mybot</code> </pre><br> 结果，将在/ django文件夹中创建一个带有项目名称的文件夹（在我们的示例中为“ mybot”）。 它将包含自动创建的初始项目文件： <br>  / django <br>  / mybot-项目文件夹 <br>  / mybot-具有我们项目设置的模块 <br>  __init__.py <br>  settings.py <br>  urls.py <br>  wsgi.py <br>  manage.py <br><br>  Django中的一个项目是一组应用程序。  Django中的应用程序是执行开发人员规定的操作的程序。 <br><br>  SSH： <br> 创建一个应用程序。 <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> mybot python manage.py startapp vk_bot</code> </pre><br> 我转到<i>/ django / mybot文件夹，</i>并创建了一个名为“ vk_bot”的新应用程序。 <br> 在项目文件夹中创建了一个包含应用程序名称的文件夹，其中包含自动创建的应用程序文件： <br><br>  / django <br>  / mybot-项目文件夹 <br>  / mybot-具有我们项目设置的模块 <br>  __init__.py <br>  settings.py <br>  urls.py <br>  wsgi.py <br>  manage.py <br>  / vk_bot-应用程序文件夹 <br>  __init__.py <br> 管理员 <br>  apps.py <br>  models.py <br>  tests.py <br>  views.py <br><br>  FTP： <br> 我将所有项目文件下载到笔记本电脑上以使用代码。 <br> 为了处理项目文件和编程，我使用了Atom应用程序。 <br><br> 原子： <br> 在文件<i>/django/mybot/mybot/settings.py中</i>编辑了项目设置 <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">... </span></span>DEBUG = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ... ALLOWED_HOSTS = [ <span class="hljs-string"><span class="hljs-string">u'mybot.mysite.ru'</span></span>, ] ...</code> </pre><br> 原子： <br> 在<i>/django/mybot/mybot/urls.py</i>文件中编辑的URL路由设置 <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">... </span></span>urlpatterns = [ url(<span class="hljs-string"><span class="hljs-string">r'^vk_bot/'</span></span>, include(<span class="hljs-string"><span class="hljs-string">'vk_bot.urls'</span></span>)), ] ...</code> </pre><br>  FTP： <br> 创建了一个文件<i>/django/mybot/vk_bot/urls.py，</i>内容<i>如下</i> ： <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.conf.urls <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> . <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> views app_name = <span class="hljs-string"><span class="hljs-string">'vk_bot'</span></span> urlpatterns = [ url(<span class="hljs-string"><span class="hljs-string">r'^$'</span></span>, views.index, name=<span class="hljs-string"><span class="hljs-string">'index'</span></span>), ]</code> </pre><br> 原子： <br> 编辑文件<i>/django/mybot/vk_bot/views.py-</i>向其中添加了一个名为index的函数，该函数将在浏览器中请求地址时执行 <br><pre>  https://mybot.mysite.ru/vk_bot/ </pre><br><br>  views.py <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- from __future__ import unicode_literals from django.views.decorators.csrf import csrf_exempt from django.shortcuts import render from django.http import HttpResponse from bot_config import * # import token, confirmation_token and over constants from bot_config.py import json, vk # vk is library from VK """ Using VK Callback API version 5.5 For more ditalies visit https://vk.com/dev/callback_api """ """ From Django documentation (https://docs.djangoproject.com/en/1.11/ref/request-response/) When a page is requested, Django automatically creates an HttpRequest object that contains metadata about the request. Then Django loads the appropriate view, passing the HttpRequest as the first argument to the view function. This argiment is &lt;request&gt; in def index(request): Decorator &lt;@csrf_exempt&gt; marks a view as being exempt from the protection ensured by the Django middleware. For cross site request protection will be used secret key from VK """ @csrf_exempt #exempt index() function from built-in Django protection def index(request): #url: https://mybot.mysite.ru/vk_bot/ if (request.method == "POST"): data = json.loads(request.body)# take POST request from auto-generated variable &lt;request.body&gt; in json format if (data['secret'] == secret_key):# if json request contain secret key and it's equal my secret key if (data['type'] == 'confirmation'):# if VK server request confirmation """ For confirmation my server (webhook) it must return confirmation token, whitch issuing in administration web-panel your public group in vk.com. Using &lt;content_type="text/plain"&gt; in HttpResponse function allows you response only plain text, without any format symbols. Parametr &lt;status=200&gt; response to VK server as VK want. """ # confirmation_token from bot_config.py return HttpResponse(confirmation_token, content_type="text/plain", status=200) if (data['type'] == 'message_new'):# if VK server send a message session = vk.Session() api = vk.API(session, v=5.5) user_id = data['object']['user_id'] # token from bot_config.py api.messages.send(access_token = token, user_id = str(user_id), message = "Hello, I'm bot!") return HttpResponse('ok', content_type="text/plain", status=200) else: return HttpResponse('see you :)')</span></span></code> </pre><br> 在<i>views.py</i>脚本的<i>index（request）</i>函数中，我必须禁用Django CSRF内置的保护，因为 我收到“ 403 Forbidden”错误。  CSRF-跨站点请求伪造保护-防止跨站点请求伪造。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">本文中</a>阅读CSRF的工作方式。 <br> 要禁用保护，我使用了<i>@csrf_exempt</i>装饰器。 但是为了提供相同的保护，但以一种更简单的方式，我使用了一个秘密密钥，该密钥已在VKontakte网站上的组管理部分中注册。 <br><br> 这段代码负责处理来自服务器的请求，服务器将发送该请求以连接我们的Webhook进行事件处理。 我们只是说一下“确认”。 <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data[<span class="hljs-string"><span class="hljs-string">'type'</span></span>] == <span class="hljs-string"><span class="hljs-string">'confirmation'</span></span>):<span class="hljs-comment"><span class="hljs-comment"># if VK server request confirmation """ For confirmation my server (webhook) it must return confirmation token, whitch issuing in administration web-panel your public group in vk.com. Using &lt;content_type="text/plain"&gt; in HttpResponse function allows you response only plain text, without any format symbols. Parametr &lt;status=200&gt; response to VK server as VK want. """ # confirmation_token from bot_config.py return HttpResponse(confirmation_token, content_type="text/plain", status=200)</span></span></code> </pre><br> 请注意，我将所有配置设置都保存在单独的bot配置文件<i>bot_config.py中</i> ，因此在脚本开头将其连接： <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> bot_config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-comment"><span class="hljs-comment"># import token, confirmation_token and over constants from bot_config.py</span></span></code> </pre><br>  bot_config.py <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- """ Configuration file for VK bot """ # token issued on the VK group web-administration page token = '...' # confirmation token issued on the VK group web-administration page in "Callback API" section confirmation_token = '...' # secret key for cross site request forgery protection. It will be in each VK server request secret_key = '...'</span></span></code> </pre><br> 在这段代码中，它处理用户消息： <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data[<span class="hljs-string"><span class="hljs-string">'type'</span></span>] == <span class="hljs-string"><span class="hljs-string">'message_new'</span></span>):<span class="hljs-comment"><span class="hljs-comment"># if VK server send a message session = vk.Session() api = vk.API(session, v=5.5) user_id = data['object']['user_id'] # token from bot_config.py api.messages.send(access_token = token, user_id = str(user_id), message = "Hello, I'm bot!") return HttpResponse('ok', content_type="text/plain", status=200)</span></span></code> </pre><br> 如果您似乎无法理解，则可以阅读<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关第一个Django设置</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> 。 <br><br>  <strong>Web服务器的魔力</strong> 。 为了配置对Web服务器的请求的寻址，我通过FTP客户端FileZilla进入具有域的文件夹中的服务器，并在其中创建了文件夹“ <i>mybot.mysite.ru</i> ”，在其中放置了三个文件，这些文件的内容来自托管服务商的帮助： <br><br>  .htaccess <br><pre> <code class="python hljs">AddHandler wsgi-script .wsgi RewriteEngine on RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^(.*)$ /django.wsgi/$<span class="hljs-number"><span class="hljs-number">1</span></span> [QSA,PT,L] RewriteCond %{HTTP:X-Forwarded-Protocol} !=https RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R=<span class="hljs-number"><span class="hljs-number">301</span></span>,L]</code> </pre><br>  django.wsgi <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os, sys virtual_env = os.path.expanduser(<span class="hljs-string"><span class="hljs-string">'~/virtualenv/myEnv'</span></span>) activate_this = os.path.join(virtual_env, <span class="hljs-string"><span class="hljs-string">'bin/activate_this.py'</span></span>) execfile(activate_this, dict(__file__=activate_this)) sys.path.insert(<span class="hljs-number"><span class="hljs-number">0</span></span>, os.path.join(os.path.expanduser(<span class="hljs-string"><span class="hljs-string">'~'</span></span>), <span class="hljs-string"><span class="hljs-string">'django/mybot'</span></span>)) os.environ[<span class="hljs-string"><span class="hljs-string">'DJANGO_SETTINGS_MODULE'</span></span>] = <span class="hljs-string"><span class="hljs-string">'mybot.settings'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.core.wsgi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> get_wsgi_application application = get_wsgi_application()</code> </pre><br> 这里的“ myEnv”是您创建的虚拟环境的名称，“ django”是主机上文件系统的根部分中的文件夹，“ mybot”是我们使用Django创建的项目的名称。 <br><br>  index.html <br><pre> <code class="python hljs">  </code> </pre><br>  <strong>将我们的Webhook“绑定”到创建的VKontakte组中的消息处理。</strong> <br> 为此，我们将返回到VKontakte网站上用于管理组的部分（请参见上面的屏幕截图）。 我们将在“地址”字段中输入Webhook地址 <pre>  https://mybot.mysite.ru/vk_bot/ </pre> 然后点击“确认”按钮。 如果我们在文件<i>/django/mybot/vk_bot/views.py中</i>编写的<i>索引（请求）</i>功能可以正常工作，也就是说，它不包含错别字和错误，则会出现一个绿色的选中标记，表示一切正常。 <br><br> 为了使我们的Webhook接收来自VKontakte服务器的有关新用户消息的消息，请在VKontakte网站上“管理我们的组”部分的“事件类型”选项卡中，选中“传入消息”框。 <br><br> 结果，我们的脚本将以<i>json</i>格式接收以下消息： <br><br><pre> <code class="python hljs">{<span class="hljs-string"><span class="hljs-string">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"message_new"</span></span>,<span class="hljs-string"><span class="hljs-string">"object"</span></span>:{<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">891</span></span>,<span class="hljs-string"><span class="hljs-string">"date"</span></span>:<span class="hljs-number"><span class="hljs-number">1541599508</span></span>,<span class="hljs-string"><span class="hljs-string">"out"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"user_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1.</span></span>.<span class="hljs-number"><span class="hljs-number">.1</span></span>,<span class="hljs-string"><span class="hljs-string">"read_state"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"body"</span></span>:<span class="hljs-string"><span class="hljs-string">"  "</span></span>},<span class="hljs-string"><span class="hljs-string">"group_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1.</span></span>.<span class="hljs-number"><span class="hljs-number">.4</span></span>,<span class="hljs-string"><span class="hljs-string">"secret"</span></span>:<span class="hljs-string"><span class="hljs-string">"uxSBw"</span></span>}</code> </pre><br> 请注意， <i>json</i>消息中有一个“秘密”字段。 这是我在VKontakte网站的组管理部分中注册的同一密钥，而不是我必须禁用的Django CSRF中内置的保护。 <br><br><h3> 如何使机器人更聪明更好？ </h3><br> 您可以创建一个包含用户答案的​​数据库，并让漫游器选择含义最接近用户问题的答案。 我将在另一篇文章中对此进行讨论。 <br> 可以这么说，对用户交互方案进行编程以保持对话是可能且必要的。 <br><br> 祝您创作愉快！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN429628/">https://habr.com/ru/post/zh-CN429628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN429618/index.html">电子游戏XO</a></li>
<li><a href="../zh-CN429620/index.html">如何为游戏创建大洲地图</a></li>
<li><a href="../zh-CN429622/index.html">机器人用20,000名工人取代了亚马逊</a></li>
<li><a href="../zh-CN429624/index.html">美国宇航局将如何使用机器人从火星土壤中制造火箭燃料</a></li>
<li><a href="../zh-CN429626/index.html">基因组破解者表明，不再有DNA将是匿名的</a></li>
<li><a href="../zh-CN429630/index.html">“游戏中的怪物或使恐惧多样化”</a></li>
<li><a href="../zh-CN429632/index.html">添加到目录时拒绝托管者的原因</a></li>
<li><a href="../zh-CN429634/index.html">这就是在反-窃中寻找贷款的方式</a></li>
<li><a href="../zh-CN429636/index.html">在Amazon Lightsail Cloud中安装3CX PBX</a></li>
<li><a href="../zh-CN429638/index.html">聊天，提取：复杂聊天机器人的体系结构</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>