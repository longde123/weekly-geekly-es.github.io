<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüë©‚Äçüëß‚Äçüëß üë©üèø‚Äçü§ù‚Äçüë©üèº ü§∞ Funktionales Denken. Teil 11: Finale üíû üßúüèª ü§µüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute beenden wir unsere Artikelserie zur funktionalen Programmierung. Es stellte sich heraus, 11 Teile. Ich glaube, das ist eine Leistung. In diesem ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Funktionales Denken. Teil 11: Finale</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/433412/"><p>  Heute beenden wir unsere Artikelserie zur funktionalen Programmierung.  Es stellte sich heraus, 11 Teile.  Ich glaube, das ist eine Leistung.  In diesem Artikel implementieren wir einen einfachen Stapelrechner (auch als "umgekehrte polnische Notation" bekannt).  Die Implementierung basiert fast vollst√§ndig auf Funktionen mit nur einem speziellen Typ und im Allgemeinen ohne Vergleich mit der Stichprobe. Dies ist daher ein hervorragendes Testfeld f√ºr die in unserer Serie behandelten Konzepte. </p><br><p><img src="https://habrastorage.org/webt/7j/cd/7x/7jcd7xzdvnhpyxuebjvbzb1uiqs.jpeg"></p><br><p>  Ich m√∂chte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>@kleidemos</em></a> separat danken.  Er war der Haupt√ºbersetzer und Manager der gesamten Artikelserie.  Vielen Dank! </p><br><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erster Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zweiter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dritter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vierter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F√ºnfter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sechster Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Siebter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Achter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Neunter Teil</a></strong> </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zehntens</a></strong> <a name="habracut"></a></li></ul><br><hr><br><p>  Wenn Sie mit einem solchen Taschenrechner nicht vertraut sind, funktioniert er wie folgt: Zahlen werden auf den Stapel geschoben, und Operationen wie Addition und Multiplikation w√§hlen Zahlen oben im Stapel aus und setzen das Ergebnis der Operation zur√ºck. </p><br><p>  Schema der einfachen Berechnung auf dem Stapel: </p><br><br><p>  Bevor Sie ein solches System entwerfen, sollten Sie √ºberlegen, wie es verwendet wird.  Nach einer Forth-√§hnlichen Syntax geben wir jeder Aktion eine entsprechende Bezeichnung, damit Sie im obigen Beispiel Folgendes schreiben k√∂nnen: </p><br><pre><code class="plaintext hljs">EMPTY ONE THREE ADD TWO MUL SHOW</code> </pre> <br><p>  Vielleicht ist es unm√∂glich, genau diese Syntax zu erhalten, aber versuchen wir, dem so nahe wie m√∂glich zu kommen. </p><br><h2>  Stapeldatentyp </h2><br><p>  Zun√§chst m√ºssen Sie die Datenstruktur f√ºr den Stapel definieren.  Der Einfachheit halber k√∂nnen Sie eine Liste von Gleitkommazahlen verwenden. </p><br><pre> <code class="plaintext hljs">type Stack = float list</code> </pre> <br><p>  Es ist jedoch besser, es in einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einzelnen Fall-Union-Typ</a> zu packen, um den Typ visueller zu gestalten: </p><br><pre> <code class="plaintext hljs">type Stack = StackContents of float list</code> </pre> <br><p>  Warum es besser ist, genau das zu tun, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> lesen. </p><br><p>  Erstellen Sie nun einen neuen Stapel mit <code>StackContents</code> als Konstruktor: </p><br><pre> <code class="plaintext hljs">let newStack = StackContents [1.0;2.0;3.0]</code> </pre> <br><p>  Verwenden Sie zum Extrahieren von Inhalten aus einem vorhandenen Stapel das Muster, das mit <code>StackContents</code> √ºbereinstimmt: </p><br><pre> <code class="plaintext hljs">let (StackContents contents) = newStack //  "contents"   // float list = [1.0; 2.0; 3.0]</code> </pre> <br><h2>  Push-Funktion </h2><br><p>  Als n√§chstes brauchen wir eine M√∂glichkeit, Zahlen auf diesen Stapel zu setzen.  F√ºgen Sie dazu einfach mit " <code>::</code> " einen neuen Wert am Anfang der Liste hinzu. </p><br><p>  Funktionsbeispiel: </p><br><pre> <code class="plaintext hljs">let push x aStack = let (StackContents contents) = aStack let newContents = x::contents StackContents newContents</code> </pre> <br><p>  Diese Funktion verf√ºgt √ºber eine Reihe von Funktionen, die es wert sind, besprochen zu werden. </p><br><p>  Zun√§chst sollten Sie darauf achten, dass die <code>list</code> unver√§nderlich ist. Dies bedeutet, dass die Funktion einen vorhandenen Stapel √ºbernehmen und einen neuen zur√ºckgeben muss.  Dies ist nicht nur eine √Ñnderung an einem vorhandenen Stapel.  Tats√§chlich haben alle Funktionen in diesem Beispiel ein √§hnliches Format: </p><br><pre> <code class="plaintext hljs">Input: Stack   -  Output:  Stack</code> </pre> <br><p>  Zweitens, warum gehen die Parameter in dieser Reihenfolge?  Warum sollte der Stapel zuerst oder zuletzt gehen?  Im Abschnitt √ºber das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwerfen von Funktionen mit Teilanwendung</a> wurde gesagt, dass der am h√§ufigsten ge√§nderte Parameter der letzte sein sollte.  Es wird bald m√∂glich sein zu √ºberpr√ºfen, ob diese Empfehlungen befolgt werden. </p><br><p>  Schlie√ülich kann die Funktion pr√§ziser gestaltet werden, indem sie mit dem Muster im Funktionsparameter selbst √ºbereinstimmt, anstatt den Funktionsk√∂rper einzulassen. </p><br><p>  Die umgeschriebene Version: </p><br><pre> <code class="plaintext hljs">let push x (StackContents contents) = StackContents (x::contents)</code> </pre> <br><p>  Viel besser! </p><br><p>  Schauen Sie sich √ºbrigens ihre anmutige Unterschrift an: </p><br><pre> <code class="plaintext hljs">val push : float -&gt; Stack -&gt; Stack</code> </pre> <br><p>  Wie bereits erw√§hnt, sagt uns die Unterschrift viel. <br>  In diesem Fall k√∂nnte ich nur anhand ihrer Signatur erraten, was diese Funktion tut, ohne zu wissen, dass sie "Push" hei√üt. <br>  Dies ist ein weiterer Grund, warum es eine gute Idee war, explizite Typnamen zu haben.  Wenn der Stapel nur eine Liste von Gleitkommazahlen w√§re, w√§re die Funktion nicht so selbstdokumentierend. </p><br><p>  √úberpr√ºfen Sie auf die eine oder andere Weise: </p><br><pre> <code class="plaintext hljs">let emptyStack = StackContents [] let stackWith1 = push 1.0 emptyStack let stackWith2 = push 2.0 stackWith1</code> </pre> <br><p>  Funktioniert super! </p><br><h2>  Stapel hochgestellt mit Push </h2><br><p>  Mit dieser einfachen Funktion k√∂nnen Sie leicht eine Operation definieren, die eine bestimmte Zahl auf den Stapel schiebt. </p><br><pre> <code class="plaintext hljs">let ONE stack = push 1.0 stack let TWO stack = push 2.0 stack</code> </pre> <br><p>  Aber warte eine Minute!  Sie sehen, dass der <code>stack</code> auf beiden Seiten des Ausdrucks erw√§hnt wird?  In der Tat ist es nicht notwendig, es zweimal zu erw√§hnen.  Stattdessen k√∂nnen Sie den Parameter weglassen und eine Funktion mit Teilanwendung schreiben: </p><br><pre> <code class="plaintext hljs">let ONE = push 1.0 let TWO = push 2.0 let THREE = push 3.0 let FOUR = push 4.0 let FIVE = push 5.0</code> </pre> <br><p>  Nun ist es offensichtlich, dass der <code>stack</code> zweimal erw√§hnt werden m√ºsste, wenn die <code>push</code> Funktion eine andere Reihenfolge von Parametern h√§tte. </p><br><p>  Es lohnt sich auch, eine Funktion zu definieren, die einen leeren Stapel erstellt: </p><br><pre> <code class="plaintext hljs">let EMPTY = StackContents []</code> </pre> <br><p>  √úberpr√ºfen Sie die empfangenen Funktionen: </p><br><pre> <code class="plaintext hljs">let stackWith1 = ONE EMPTY let stackWith2 = TWO stackWith1 let stackWith3 = THREE stackWith2</code> </pre> <br><p>  √Ñrgern diese Zwischenstapel?  Ist es m√∂glich, sie loszuwerden?  Nat√ºrlich!  Beachten Sie, dass die Funktionen ONE, TWO und THREE dieselbe Signatur haben: </p><br><pre> <code class="plaintext hljs">Stack -&gt; Stack</code> </pre> <br><p>  Sie sind also perfekt miteinander verbunden!  Die Ausgabe einer Funktion kann wie folgt eingegeben werden: </p><br><pre> <code class="plaintext hljs">let result123 = EMPTY |&gt; ONE |&gt; TWO |&gt; THREE let result312 = EMPTY |&gt; THREE |&gt; ONE |&gt; TWO</code> </pre> <br><h2>  Aus dem Stapel herausspringen </h2><br><p>  Mit der Hinzuf√ºgung zum Stapel herausgefunden, aber was ist mit der <code>pop</code> Funktion? </p><br><p>  Beim Abrufen vom Stapel ist es offensichtlich erforderlich, die Oberseite des Stapels zur√ºckzugeben, aber ist es nur das? </p><br><p>  In einem objektorientierten Stil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lautet</a> die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Antwort ja</a> .  Im Fall von OOP w√ºrde der Stapel jedoch hinter den Kulissen ge√§ndert, so dass das oberste Element entfernt w√ºrde. </p><br><p>  In einem funktionalen Stil ist der Stapel jedoch unver√§nderlich.  Es gibt nur eine M√∂glichkeit, das oberste Element zu entfernen: Erstellen Sie einen <em>neuen Stapel</em> ohne dieses Element.  Damit der Aufrufer Zugriff auf den neuen reduzierten Stapel hat, muss dieser zusammen mit dem obersten Element zur√ºckgegeben werden. </p><br><p>  Mit anderen Worten, die <code>pop</code> Funktion sollte <em>zwei</em> Werte zur√ºckgeben, das oberste Element und den neuen Stapel.  Der einfachste Weg, dies in F # zu tun, besteht darin, einfach ein Tupel zu verwenden. </p><br><p>  Implementierung: </p><br><pre> <code class="plaintext hljs">///     ///          let pop (StackContents contents) = match contents with | top::rest -&gt; let newStack = StackContents rest (top,newStack)</code> </pre> <br><p>  Die resultierende Funktion ist auch sehr einfach. </p><br><p>  Der <code>contents</code> wie vor direkt aus dem Parameter extrahiert. </p><br><p>  Anschlie√üend wird der Inhalt des <code>contents</code> mit dem Ausdruck <code>match..with</code> √ºberpr√ºft. </p><br><p>  Dann wird das oberste Element vom Rest der Liste getrennt, ein neuer Stapel wird basierend auf den verbleibenden Elementen erstellt, und schlie√ülich wird all dies als Tupelpaar zur√ºckgegeben. </p><br><p>  Versuchen Sie, diesen Code auszuf√ºhren, und sehen Sie, was passiert.  Sie erhalten einen Kompilierungsfehler! <br>  Der Compiler hat einen Fall festgestellt, der nicht bearbeitet wurde. Was passiert, wenn der Stapel leer ist? </p><br><p>  Sie m√ºssen entscheiden, wie Sie damit umgehen wollen. </p><br><ul><li>  Option 1: Geben Sie den Sonderstatus "Erfolg" oder "Fehler" zur√ºck, wie in dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beitrag aus der Serie "Warum F # verwenden?"</a>  . </li><li>  Option 2: Eine Ausnahme ausl√∂sen. </li></ul><br><p>  Normalerweise bevorzuge ich die Verwendung eines speziellen Status f√ºr den Fehler, aber in diesem speziellen Fall habe ich es vorgezogen, eine Ausnahme auszul√∂sen.  Behobene Version von <code>pop</code> mit leerer Fallbehandlung: </p><br><pre> <code class="plaintext hljs">let pop (StackContents contents) = match contents with | top::rest -&gt; let newStack = StackContents rest (top,newStack) | [] -&gt; failwith "Stack underflow"</code> </pre> <br><p>  √úberpr√ºfen Sie: </p><br><pre> <code class="plaintext hljs">let initialStack = EMPTY |&gt; ONE |&gt; TWO let popped1, poppedStack = pop initialStack let popped2, poppedStack2 = pop poppedStack</code> </pre> <br><p>  und Ausnahmetest: </p><br><pre> <code class="plaintext hljs">let _ = pop EMPTY</code> </pre> <br><h2>  Arithmetische Funktionen </h2><br><p>  Nachdem das Hinzuf√ºgen und L√∂schen abgeschlossen ist, k√∂nnen Sie mit den Funktionen "Hinzuf√ºgen" und "Multiplizieren" arbeiten: </p><br><pre> <code class="plaintext hljs">let ADD stack = let x,s = pop stack //   let y,s2 = pop s //    let result = x + y //   push result s2 //     let MUL stack = let x,s = pop stack //   let y,s2 = pop s //    let result = x * y //   push result s2 //    </code> </pre> <br><p>  Online-Tests: </p><br><pre> <code class="plaintext hljs">let add1and2 = EMPTY |&gt; ONE |&gt; TWO |&gt; ADD let add2and3 = EMPTY |&gt; TWO |&gt; THREE |&gt; ADD let mult2and3 = EMPTY |&gt; TWO |&gt; THREE |&gt; MUL</code> </pre> <br><p>  Es funktioniert! </p><br><h3>  Refactoring Zeit ... </h3><br><p>  Offensichtlich wird in diesen beiden Funktionen eine erhebliche Menge an Code dupliziert.  Wie k√∂nnen wir das beheben? </p><br><p>  Beide Funktionen extrahieren zwei Werte aus dem Stapel, wenden eine bestimmte Bin√§rfunktion auf sie an und schieben das Ergebnis dann zur√ºck auf den Stapel.  Sie k√∂nnen den allgemeinen Code an die Bin√§rfunktion ausgeben, die eine mathematische Funktion mit zwei Parametern √ºbernimmt: </p><br><pre> <code class="plaintext hljs">let binary mathFn stack = //    let y,stack' = pop stack //     let x,stack'' = pop stack' //  let z = mathFn xy //      push z stack''</code> </pre> <br><p>  <em>Beachten Sie, dass in dieser Implementierung verschiedene Versionen desselben Objekts mit einer unterschiedlichen Anzahl von Anf√ºhrungszeichen gekennzeichnet sind.</em>  <em>Dies liegt daran, dass numerische Suffixe leicht zu Verwirrung f√ºhren k√∂nnen.</em> </p><br><p>  Frage: Warum haben die Parameter genau diese Reihenfolge, anstatt dass <code>mathFn</code> nach dem <code>stack</code> ? </p><br><p>  Nachdem Sie eine <code>binary</code> , ist es viel einfacher, ADD und andere Funktionen zu definieren: </p><br><p>  Erster Versuch, ADD mit <code>binary</code> zu implementieren: </p><br><pre> <code class="plaintext hljs">let ADD aStack = binary (fun xy -&gt; x + y) aStack</code> </pre> <br><p>  Aber Sie k√∂nnen Lambda loswerden, weil  es repr√§sentiert die <em>genaue</em> Definition der eingebauten Funktion <code>+</code> : </p><br><pre> <code class="plaintext hljs">let ADD aStack = binary (+) aStack</code> </pre> <br><p>  Auch hier kann eine Teilanwendung verwendet werden, um den Stapelparameter auszublenden.  Endg√ºltige Definition: </p><br><pre> <code class="plaintext hljs">let ADD = binary (+)</code> </pre> <br><p>  Definition anderer mathematischer Funktionen: </p><br><pre> <code class="plaintext hljs">let SUB = binary (-) let MUL = binary (*) let DIV = binary (../)</code> </pre> <br><p>  Probieren Sie es online aus: </p><br><pre> <code class="plaintext hljs">let div2by3 = EMPTY |&gt; THREE|&gt; TWO |&gt; DIV let sub2from5 = EMPTY |&gt; TWO |&gt; FIVE |&gt; SUB let add1and2thenSub3 = EMPTY |&gt; ONE |&gt; TWO |&gt; ADD |&gt; THREE |&gt; SUB</code> </pre> <br><p>  Ebenso k√∂nnen Sie eine Hilfsfunktion f√ºr un√§re Operationen erstellen </p><br><pre> <code class="plaintext hljs">let unary f stack = let x,stack' = pop stack push (fx) stack'</code> </pre> <br><p>  Und definieren Sie einige un√§re Funktionen: </p><br><pre> <code class="plaintext hljs">let NEG = unary (fun x -&gt; -x) let SQUARE = unary (fun x -&gt; x * x)</code> </pre> <br><p>  Interaktiver Modus: </p><br><pre> <code class="plaintext hljs">let neg3 = EMPTY |&gt; THREE|&gt; NEG let square2 = EMPTY |&gt; TWO |&gt; SQUARE</code> </pre> <br><h2>  Alles zusammenf√ºgen |  Alles zusammenf√ºgen </h2><br><p>  In den anf√§nglichen Anforderungen wurde erw√§hnt, dass wir die Ergebnisse zeigen m√∂chten, daher lohnt es sich, die SHOW-Funktion zu definieren. </p><br><pre> <code class="plaintext hljs">let SHOW stack = let x,_ = pop stack printfn "The answer is %f" x stack //      </code> </pre> <br><p>  Bitte beachten Sie, dass in diesem Fall die neue Version des √ºber <code>pop</code> empfangenen Stacks ignoriert wird.  Das Endergebnis ist der urspr√ºngliche Stapel, als h√§tte er sich nie ge√§ndert. </p><br><p>  Schlie√ülich k√∂nnen Sie das folgende Beispiel aus den urspr√ºnglichen Anforderungen schreiben </p><br><pre> <code class="plaintext hljs">EMPTY |&gt; ONE |&gt; THREE |&gt; ADD |&gt; TWO |&gt; MUL |&gt; SHOW</code> </pre> <br><h3>  Mach weiter </h3><br><p>  Es macht Spa√ü, aber was k√∂nnen Sie noch tun? </p><br><p>  Sie k√∂nnen mehrere zus√§tzliche Funktionen definieren: </p><br><pre> <code class="plaintext hljs">///      let DUP stack = //    let x,_ = pop stack //      push x stack ///      let SWAP stack = let x,s = pop stack let y,s' = pop s push y (push x s') ///    let START = EMPTY</code> </pre> <br><p>  Mit diesen zus√§tzlichen Funktionen k√∂nnen Sie einige elegante Beispiele schreiben: </p><br><pre> <code class="plaintext hljs">START |&gt; ONE |&gt; TWO |&gt; SHOW START |&gt; ONE |&gt; TWO |&gt; ADD |&gt; SHOW |&gt; THREE |&gt; ADD |&gt; SHOW START |&gt; THREE |&gt; DUP |&gt; DUP |&gt; MUL |&gt; MUL // 27 START |&gt; ONE |&gt; TWO |&gt; ADD |&gt; SHOW // 3 |&gt; THREE |&gt; MUL |&gt; SHOW // 9 |&gt; TWO |&gt; SWAP |&gt; DIV |&gt; SHOW // 9 div 2 = 4.5</code> </pre> <br><h2>  Verwendung von Komposition anstelle von Pipelining </h2><br><p>  Das ist aber noch nicht alles.  Tats√§chlich gibt es eine andere interessante M√∂glichkeit, diese Funktionen darzustellen. </p><br><p>  Wie bereits erw√§hnt, haben alle dieselbe Signatur: </p><br><pre> <code class="plaintext hljs">Stack -&gt; Stack</code> </pre> <br><p>  Da Eingabe und Ausgabe vom gleichen Typ sind, k√∂nnen diese Funktionen auch mit dem Kompositionsoperator <code>&gt;&gt;</code> kombiniert werden, und zwar nicht nur √ºber Pipeline-Operatoren. </p><br><p>  Einige Beispiele: </p><br><pre> <code class="plaintext hljs">//    let ONE_TWO_ADD = ONE &gt;&gt; TWO &gt;&gt; ADD START |&gt; ONE_TWO_ADD |&gt; SHOW //    let SQUARE = DUP &gt;&gt; MUL START |&gt; TWO |&gt; SQUARE |&gt; SHOW //     let CUBE = DUP &gt;&gt; DUP &gt;&gt; MUL &gt;&gt; MUL START |&gt; THREE |&gt; CUBE |&gt; SHOW //   let SUM_NUMBERS_UPTO = DUP // n &gt;&gt; ONE &gt;&gt; ADD // n+1 &gt;&gt; MUL // n(n+1) &gt;&gt; TWO &gt;&gt; SWAP &gt;&gt; DIV // n(n+1) / 2 START |&gt; THREE |&gt; SQUARE |&gt; SUM_NUMBERS_UPTO |&gt; SHOW</code> </pre> <br><p>  In jedem dieser Beispiele wird eine neue Funktion unter Verwendung einer Zusammensetzung anderer Funktionen definiert.  Dies ist ein gutes Beispiel f√ºr einen ‚Äûkombinatorischen‚Äú Ansatz zur Erstellung von Funktionen. </p><br><h2>  F√∂rderer vs. Zusammensetzung </h2><br><p>  Wir haben zwei verschiedene M√∂glichkeiten gesehen, unser Modell zu verwenden.  unter Verwendung von F√∂rderb√§ndern und Zusammensetzung.  Aber was ist der Unterschied?  Und warum sollte einer dem anderen vorgezogen werden? </p><br><p>  Der Unterschied besteht darin, dass Pipelines in gewisser Weise eine "Echtzeit-Transformation" sind.  Zum Zeitpunkt der Verwendung der Pipeline werden Operationen sofort durch die √úbertragung eines bestimmten Stapels ausgef√ºhrt. </p><br><p>  Auf der anderen Seite ist Komposition so etwas wie ein ‚ÄûPlan‚Äú, den wir implementieren m√∂chten und der Funktionen aus einer Reihe von Komponenten ohne direkte Anwendung erstellt. </p><br><p>  Sie k√∂nnen beispielsweise einen ‚ÄûPlan‚Äú zum Berechnen des Quadrats einer Zahl durch eine Kombination kleiner Operationen erstellen: </p><br><pre> <code class="plaintext hljs">let COMPOSED_SQUARE = DUP &gt;&gt; MUL</code> </pre> <br><p>  Ich kann das √Ñquivalent nicht basierend auf Pipelines angeben. </p><br><pre> <code class="plaintext hljs">let PIPED_SQUARE = DUP |&gt; MUL</code> </pre> <br><p>  Dies f√ºhrt zu einem Kompilierungsfehler.  Ich ben√∂tige eine bestimmte Stapelinstanz, damit der Ausdruck funktioniert: </p><br><pre> <code class="plaintext hljs">let stackWith2 = EMPTY |&gt; TWO let twoSquared = stackWith2 |&gt; DUP |&gt; MUL</code> </pre> <br><p>  Und selbst in diesem Fall kann ich nur f√ºr diese bestimmte Eingabe eine Antwort erhalten und keinen allgemeinen Berechnungsplan, der auf einer Eingabe basiert, wie im Beispiel mit <code>COMPOSED_SQUARE</code> . </p><br><p>  Eine andere M√∂glichkeit, einen ‚ÄûPlan‚Äú zu erstellen, besteht darin, das Lambda explizit an primitivere Funktionen zu √ºbergeben: </p><br><pre> <code class="plaintext hljs">let LAMBDA_SQUARE = unary (fun x -&gt; x * x)</code> </pre> <br><p>  Dies ist ein expliziterer Weg (und h√∂chstwahrscheinlich schneller), aber alle Vorteile und die Klarheit des kompositorischen Ansatzes gehen verloren. </p><br><p>  Im Allgemeinen sollten Sie nach M√∂glichkeit einen kompositorischen Ansatz anstreben! </p><br><h2>  Vollst√§ndiger Code </h2><br><p>  Vollst√§ndiger Code f√ºr alle obigen Beispiele: </p><br><pre> <code class="plaintext hljs">// ============================================== //  // ============================================== type Stack = StackContents of float list // ============================================== //   // ============================================== ///     let push x (StackContents contents) = StackContents (x::contents) ///        ///       let pop (StackContents contents) = match contents with | top::rest -&gt; let newStack = StackContents rest (top,newStack) | [] -&gt; failwith "Stack underflow" // ============================================== //  () // ============================================== //     //      //     let binary mathFn stack = let y,stack' = pop stack let x,stack'' = pop stack' let z = mathFn xy push z stack'' //    //      //     let unary f stack = let x,stack' = pop stack push (fx) stack' // ============================================== //  () // ============================================== ///      let SHOW stack = let x,_ = pop stack printfn "The answer is %f" x stack //      ///    let DUP stack = let x,s = pop stack push x (push xs) ///      let SWAP stack = let x,s = pop stack let y,s' = pop s push y (push x s') ///    let DROP stack = let _,s = pop stack //   s //   // ============================================== // ,    // ============================================== //  // ------------------------------- let EMPTY = StackContents [] let START = EMPTY //  // ------------------------------- let ONE = push 1.0 let TWO = push 2.0 let THREE = push 3.0 let FOUR = push 4.0 let FIVE = push 5.0 //   // ------------------------------- let ADD = binary (+) let SUB = binary (-) let MUL = binary (*) let DIV = binary (../) let NEG = unary (fun x -&gt; -x) // ============================================== // ,     // ============================================== let SQUARE = DUP &gt;&gt; MUL let CUBE = DUP &gt;&gt; DUP &gt;&gt; MUL &gt;&gt; MUL let SUM_NUMBERS_UPTO = DUP // n &gt;&gt; ONE &gt;&gt; ADD // n+1 &gt;&gt; MUL // n(n+1) &gt;&gt; TWO &gt;&gt; SWAP &gt;&gt; DIV // n(n+1) / 2</code> </pre> <br><h2>  Fazit </h2><br><p>  Wir haben einen einfachen stapelbasierten Taschenrechner.  Wir haben gesehen, wie Sie mit einigen primitiven Operationen ( <code>push</code> , <code>pop</code> , <code>binary</code> , <code>unary</code> ) und anderen eine vollwertige DSL erstellen k√∂nnen, die einfach zu implementieren und zu verwenden ist. </p><br><p>  Wie Sie sich vorstellen k√∂nnen, basierte dieses Beispiel ziemlich stark auf der Forth-Sprache.  Ich empfehle das kostenlose Buch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Thinking Forth"</a> , das nicht nur die Forth-Sprache, sondern auch andere ( <em>nicht</em> objektorientierte!) Methoden zum Zerlegen von Aufgaben beschreibt, die f√ºr die funktionale Programmierung im Allgemeinen gleicherma√üen anwendbar sind. </p><br><p>  Die Idee zu diesem Artikel kam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mir</a> aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ashley Feniellos</a> wundersch√∂nem Blog.  Wenn Sie tiefer in die Emulation einer auf F # basierenden stapelbasierten Sprache eintauchen m√∂chten, beginnen Sie damit.  <em>Viel Spa√ü!</em> </p><br><h1>  Zus√§tzliche Ressourcen </h1><br><p>  Es gibt viele Tutorials f√ºr F #, einschlie√ülich Materialien f√ºr diejenigen, die mit C # oder Java-Erfahrung kommen.  Die folgenden Links k√∂nnen hilfreich sein, wenn Sie tiefer in F # einsteigen: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F # Anleitung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F # f√ºr Spa√ü und Profit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F # Wiki</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lerne X in Y Minuten: F #</a> </li></ul><br><p>  Es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> auch verschiedene andere M√∂glichkeiten beschrieben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">, um mit dem Lernen von F # zu beginnen</a> . </p><br><p>  Schlie√ülich ist die F # Community sehr anf√§ngerfreundlich.  Bei Slack gibt es einen sehr aktiven Chat, der von der F # Software Foundation unterst√ºtzt wird, mit Anf√§ngerr√§umen, an denen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">frei teilnehmen k√∂nnen</a> .  Wir empfehlen Ihnen dringend, dies zu tun! </p><br><p>  Vergessen Sie nicht, die Seite der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">russischsprachigen Community F #</a> zu besuchen!  Wenn Sie Fragen zum Erlernen einer Sprache haben, diskutieren wir diese gerne in Chatrooms: </p><br><ul><li>  Raum <code>#ru_general</code> im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Slack Chat</a> der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F # Software Foundation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im Telegramm chatten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">chatte in gitter</a> </li><li>  Raum #en_general im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Slack Chat</a> der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F # Software Foundation</a> </li></ul><br><h2>  √úber √úbersetzungsautoren </h2><br><p>  √úbersetzt von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>@kleidemos</em></a> <br><img src="https://habrastorage.org/getpro/habr/post_images/f95/c6d/92c/f95c6d92c5b1126b093792a43955aa43.png" width="56" height="56">  √úbersetzungs- und redaktionelle √Ñnderungen wurden durch die Bem√ºhungen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">russischsprachigen Community von F # -Entwicklern vorgenommen</a> .  Wir danken auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>@schvepsss</em></a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>@shwars</em></a> f√ºr die Vorbereitung dieses Artikels zur Ver√∂ffentlichung. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433412/">https://habr.com/ru/post/de433412/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433402/index.html">Funktionales Denken. Teil 8</a></li>
<li><a href="../de433404/index.html">React Tutorial Teil 3: Komponentendateien, Projektstruktur</a></li>
<li><a href="../de433406/index.html">Funktionales Denken. Teil 9</a></li>
<li><a href="../de433408/index.html">Effiziente Speicherbehandlung in Node.js.</a></li>
<li><a href="../de433410/index.html">Funktionales Denken. Teil 10</a></li>
<li><a href="../de433414/index.html">PRTG Network Monitor testen und mit Zabbix vergleichen</a></li>
<li><a href="../de433420/index.html">ZeroNights 2018 Ergebnisse</a></li>
<li><a href="../de433424/index.html">Ist es m√∂glich, ein unpassierbares Level in Super Mario Maker zu laden?</a></li>
<li><a href="../de433428/index.html">Woher kommt Kreativit√§t: Analyse der Alpha-Wellen-Aktivit√§t des Gehirns w√§hrend RAT-Tests</a></li>
<li><a href="../de433430/index.html">Android Box Mecool KM9 auf dem frischen SoC Amlogic S905X2 mit 4 GB RAM und Android TV 8.1 - verstehen und vergeben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>