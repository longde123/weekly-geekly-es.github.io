<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÄ üíÄ üë®üèø‚Äçüîß Architecture pragmatique pure. Remue-m√©ninges üôéüèΩ üë®üèª‚Äçüè´ üõÄüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'id√©e vous est-elle venue √† l'esprit pour r√©√©crire votre application d'entreprise audacieuse √† partir de z√©ro? Si √† partir de z√©ro, alors c'est wow. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Architecture pragmatique pure. Remue-m√©ninges</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/419179/">  L'id√©e vous est-elle venue √† l'esprit pour r√©√©crire votre application d'entreprise audacieuse √† partir de z√©ro?  Si √† partir de z√©ro, alors c'est wow.  Au moins deux fois moins de code, non?  Mais quelques ann√©es passeront, et elles grandiront √©galement, deviendront h√©ritage ... il n'y a pas beaucoup de temps et d'argent pour que la r√©√©criture fonctionne parfaitement. <br><br>  Calmez-vous, les autorit√©s ne permettront toujours pas de r√©√©crire quoi que ce soit.  Reste √† refactoriser.  Quelle est la meilleure fa√ßon de d√©penser vos petites ressources?  Comment refactoriser o√π nettoyer? <br><br>  Le titre de cet article comprend une r√©f√©rence au livre de l‚Äôoncle Bob <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Architecture propre¬ª</a> , et il a √©t√© fait sur la base d‚Äôun merveilleux rapport de Victor Rentea ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">twitter</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site Web</a> ) sur JPoint (sous le chat, il commencera √† parler √† la premi√®re personne, mais pour le moment lisez l‚Äôintroduction).  En lisant des livres intelligents, cet article ne remplace pas, mais pour une description aussi courte est tr√®s bien pr√©sent√©e. <br><br>  L'id√©e est que les choses populaires comme ¬´l'architecture propre¬ª sont vraiment utiles.  Surprise  Si vous devez r√©soudre un probl√®me tr√®s sp√©cifique, un code simple et √©l√©gant ne n√©cessite pas d'effort suppl√©mentaire ni de sur-ing√©nierie.  L'architecture pure indique que vous devez prot√©ger votre mod√®le de domaine contre les effets externes et vous indique exactement comment cela peut √™tre fait.  Une approche √©volutive pour augmenter le volume des microservices.  Des tests qui rendent le refactoring moins effrayant.  Vous savez d√©j√† tout √ßa?  Ou vous savez, mais vous avez m√™me peur d'y penser, car c'est une horreur que devrez-vous faire alors? <br><br>  Qui veut obtenir une pilule magique anti-procrastination qui aidera √† arr√™ter de trembler et √† commencer √† refactoriser - bienvenue dans le reportage vid√©o ou sous cat. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mBxpOvlbAow" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><a name="habracut"></a><br><br>  Je m'appelle Victor, je viens de Roumanie.  Formellement, je suis consultant, expert technique et architecte principal chez IBM roumain.  Mais si on me demandait de donner une d√©finition de mon activit√© moi-m√™me, alors je suis un √©vang√©liste du code pur.  J'adore cr√©er un code beau, propre et pris en charge - en r√®gle g√©n√©rale, j'en parle dans les rapports.  Plus encore, je suis inspir√© par l'enseignement: former les d√©veloppeurs dans les domaines de Java EE, Spring, Dojo, Test Driven Development, Java Performance, ainsi que dans le domaine de l'√©vang√©lisation mentionn√© - les principes des mod√®les de code propre et leur d√©veloppement. <br><br>  L'exp√©rience sur laquelle ma th√©orie est bas√©e est principalement le d√©veloppement d'applications d'entreprise pour le plus grand client IBM en Roumanie - le secteur bancaire. <br><br>  Le plan de cet article est le suivant: <br><br><ul><li>  Mod√©lisation des donn√©es: les structures de donn√©es ne doivent pas devenir nos ennemis; <br></li><li>  Organisation de la logique: le principe de "d√©composition du code, qui est trop"; <br></li><li>  ¬´Onion¬ª est l'architecture de philosophie Transaction Script la plus pure; <br></li><li>  Les tests comme moyen de g√©rer les craintes des d√©veloppeurs. <br></li></ul><br><br>  Mais d'abord, rappelons les grands principes dont nous, d√©veloppeurs, devons toujours nous souvenir. <br><br><h4>  Principe de responsabilit√© exclusive </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/353/dd0/cd5/353dd0cd58012749b70e379e37231265.jpg"><br><br>  En d'autres termes, quantit√© vs qualit√©.  En r√®gle g√©n√©rale, plus votre classe contient de fonctionnalit√©s, pire elle se r√©v√®le dans un sens qualitatif.  En d√©veloppant de grandes classes, le programmeur commence √† devenir confus, √† commettre des erreurs dans la construction des d√©pendances, et le code volumineux, entre autres, est plus difficile √† d√©boguer.  Il est pr√©f√©rable de diviser une telle classe en plusieurs classes plus petites, chacune √©tant responsable d'une sous-t√¢che.  Mieux vaut avoir quelques modules √©troitement coupl√©s qu'un seul - grand et lent.  La modularit√© permet √©galement la r√©utilisation de la logique. <br><br><h4>  Liaison de module faible </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f72/1c8/0f7/f721c80f7b3184be2218a01b66f7440a.jpg"><br><br>  Le degr√© de liaison est une mesure de la fa√ßon dont vos modules interagissent les uns avec les autres.  Il montre √† quel point l'effet des modifications que vous apportez √† un moment donn√© du syst√®me est en mesure de se propager.  Plus la liaison est √©lev√©e, plus il est difficile d'apporter des modifications: vous changez quelque chose dans un module, et l'effet s'√©tend loin et pas toujours de la mani√®re attendue.  Par cons√©quent, l'indicateur de liaison doit √™tre aussi bas que possible - cela fournira plus de contr√¥le sur le syst√®me en cours de modification. <br><br><h4>  Ne r√©p√©tez pas </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b9/9de/5c0/2b99de5c00257d6123553c7bfaed0519.jpg"><br><br>  Vos propres impl√©mentations peuvent √™tre bonnes aujourd'hui, mais pas si bonnes demain.  Ne vous autorisez pas √† copier vos propres bonnes pratiques et donc √† les diffuser dans une base de code.  Vous pouvez copier √† partir de StackOverflow, √† partir de livres - √† partir de toutes sources faisant autorit√© qui (comme vous le savez avec certitude) offrent une impl√©mentation id√©ale (ou proche de cela).  L'am√©lioration de votre propre impl√©mentation, qui se produit plus d'une fois, mais multipli√©e dans la base de code, peut √™tre tr√®s fatigante. <br><br><h4>  Simplicit√© et concision </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7d4/8d4/c85/7d48d4c85408c620ddcbe644c4acb6f9.jpg"><br><br>  √Ä mon avis, c'est le principe principal qui doit √™tre observ√© dans l'ing√©nierie et le d√©veloppement de logiciels.  "L'encapsulation pr√©matur√©e est la racine du mal", a d√©clar√© Adam Bien.  En d'autres termes, la racine du mal r√©side dans la ¬´r√©ing√©nierie¬ª.  L'auteur de la citation, Adam Bien, a √©t√© √† un moment donn√© engag√© dans des applications h√©rit√©es et, en r√©√©crivant compl√®tement leur code, a re√ßu une base de code 2-3 fois plus petite que celle d'origine.  D'o√π vient tant de code suppl√©mentaire?  Apr√®s tout, cela se pose pour une raison.  Ses craintes nous font na√Ætre.  Il nous semble qu'en empilant un grand nombre de mod√®les, g√©n√©rant indirects et abstractions, nous assurons √† notre code une protection - une protection contre les inconnues de demain et les exigences de demain.  Apr√®s tout, en fait, aujourd'hui, nous n'avons besoin de rien de tout cela, nous n'inventons tout cela que pour des ¬´besoins futurs¬ª.  Et il est possible que ces structures de donn√©es interf√®rent par la suite.  Pour √™tre honn√™te, lorsque certains de mes d√©veloppeurs viennent vers moi et disent qu'il a trouv√© quelque chose d'int√©ressant qui peut √™tre ajout√© au code de production, je r√©ponds toujours de la m√™me mani√®re: "Mon gar√ßon, cela ne vous sera pas utile." <br><br>  Il ne devrait pas y avoir beaucoup de code, et celui qui est devrait √™tre simple - la seule fa√ßon de travailler normalement avec lui.  C'est une pr√©occupation pour vos d√©veloppeurs.  Vous devez vous rappeler qu'ils sont les chiffres cl√©s de votre syst√®me.  Essayez de r√©duire leur consommation d'√©nergie, de r√©duire les risques avec lesquels ils devront travailler.  Cela ne signifie pas que vous devez cr√©er votre propre framework, d'ailleurs, je ne vous conseillerais pas de le faire: il y aura toujours des bugs dans votre framework, tout le monde devra l'√©tudier, etc.  Il vaut mieux utiliser les actifs existants, qui sont aujourd'hui massifs.  Ces solutions devraient √™tre simples.  Notez les gestionnaires d'erreurs globaux, appliquez la technologie d'aspect, les g√©n√©rateurs de code, les extensions Spring ou CDI, configurez les port√©es de demande / thread, utilisez la manipulation et la g√©n√©ration de bytecode √† la vol√©e, etc. Tout cela sera votre contribution √† la chose la plus importante - le confort de votre d√©veloppeur. <br><br>  En particulier, je voudrais vous d√©montrer l'application des zones Requ√™te / Thread.  J'ai vu √† plusieurs reprises comment cette chose a incroyablement simplifi√© les applications d'entreprise.  L'essentiel est qu'il vous donne la possibilit√©, en tant qu'utilisateur connect√©, d'enregistrer les donn√©es RequestContext.  Ainsi, RequestContext stockera les donn√©es utilisateur sous une forme compacte. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/341/6c5/474/3416c54740aca3b8f514696bf9cf7f3d.jpg"><br><br>  Comme vous pouvez le voir, l'impl√©mentation ne prend que quelques lignes de code.  Apr√®s avoir √©crit la demande dans l'annotation requise (il n'est pas difficile de le faire si vous utilisez Spring ou CDI), vous vous lib√©rerez de la n√©cessit√© de passer la connexion utilisateur aux m√©thodes et autres: les m√©tadonn√©es de la demande stock√©es dans le contexte navigueront de mani√®re transparente dans l'application.  Un proxy limit√© vous permettra d'acc√©der √† tout moment aux m√©tadonn√©es de la demande en cours. <br><br><h4>  Tests de r√©gression </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5c5/edf/d7a/5c5edfd7a14d760bc335d8e65f0d5666.jpg"><br><br>  Les d√©veloppeurs ont peur des exigences mises √† jour car ils ont peur des proc√©dures de refactoring (modifications de code).  Et le moyen le plus simple de les aider est de cr√©er une suite de tests fiable pour les tests de r√©gression.  Avec lui, le d√©veloppeur aura la possibilit√© √† tout moment de tester son temps de fonctionnement - pour s'assurer qu'il ne casse pas le syst√®me. <br><br>  Le d√©veloppeur ne devrait avoir peur de rien casser.  Vous devez tout faire pour que le refactoring soit per√ßu comme quelque chose de bien. <br>  Le refactoring est un aspect essentiel du d√©veloppement.  Rappelez-vous, exactement au moment o√π vos d√©veloppeurs ont peur de refactoriser, l'application peut √™tre consid√©r√©e comme devenue Legacy. <br><br><h2>  O√π impl√©menter la logique m√©tier? </h2><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fb/8a2/08d/4fb8a208dc6d89279a663747de74369f.jpg"><br><br>  √Ä partir de la mise en ≈ìuvre de tout syst√®me (ou composants du syst√®me), nous nous posons la question: o√π est-il pr√©f√©rable de mettre en ≈ìuvre la logique du domaine, c'est-√†-dire les aspects fonctionnels de notre application?  Il existe deux approches oppos√©es. <br>  Le premier est bas√© sur la philosophie <i>Transaction Script</i> .  Ici, la logique est impl√©ment√©e dans des proc√©dures qui fonctionnent avec des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">entit√©s an√©miques</a> (c'est-√†-dire avec des structures de donn√©es).  Une telle approche est bonne car au cours de sa mise en ≈ìuvre, il est possible de s'appuyer sur les t√¢ches m√©tier formul√©es.  Tout en travaillant sur des applications pour le secteur bancaire, j'ai observ√© √† plusieurs reprises le transfert de proc√©dures m√©tier vers des logiciels.  Je peux dire qu'il est vraiment tr√®s naturel de corr√©ler des sc√©narios avec des logiciels. <br><br>  Une autre approche consiste √† utiliser les principes de la <i>conception pilot√©e par domaine</i> .  Ici, vous devrez mettre en corr√©lation les sp√©cifications et les exigences avec une m√©thodologie orient√©e objet.  Il est important de bien consid√©rer les objets et d'assurer une bonne implication commerciale.  L'avantage des syst√®mes ainsi con√ßus est qu'√† l'avenir ils seront facilement entretenus.  Cependant, d'apr√®s mon exp√©rience, la ma√Ætrise de cette m√©thodologie est assez difficile: vous vous sentirez plus ou moins courageux au plus t√¥t apr√®s six mois d'√©tudes. <br><br>  Pour mes d√©veloppements, j'ai toujours choisi la premi√®re approche.  Je peux vous assurer que dans mon cas, cela a parfaitement fonctionn√©. <br><br><h2>  Mod√©lisation des donn√©es </h2><br><br><h4>  Entit√©s </h4><br><br>  Comment mod√©lisons-nous les donn√©es?  D√®s que l'application prend des tailles plus ou moins d√©centes, <i>des donn√©es persistantes</i> appara√Ætront n√©cessairement.  C'est le type de donn√©es que vous devez stocker plus longtemps que les autres - ce sont les <i>entit√©s de domaine de</i> votre syst√®me.  O√π les stocker - que ce soit dans la base de donn√©es, dans un fichier ou en g√©rant directement la m√©moire - n'a pas d'importance.  L'important est de <i>savoir comment</i> les stocker - dans quelles structures de donn√©es. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a8/56b/127/0a856b127ec938a8c17eb345610b0ee8.jpg"><br><br>  Ce choix vous est donn√© en tant que d√©veloppeur et ne d√©pend que de vous que ces structures de donn√©es fonctionneront pour vous ou contre vous lors de la mise en ≈ìuvre des exigences fonctionnelles √† l'avenir.  Pour que tout soit bon, vous devez impl√©menter des entit√©s en y d√©posant des grains de <i>logique de domaine r√©utilis√©e</i> .  Comment sp√©cifiquement?  Je vais d√©montrer plusieurs m√©thodes en utilisant un exemple. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c73/e56/7da/c73e567da2fb69ceb3d627fb408530cd.jpg"><br><br>  Voyons ce que j'ai fourni √† l'entit√© Client.  Tout d'abord, j'ai impl√©ment√© un <code>getFullName()</code> <i>synth√©tique</i> <code>getFullName()</code> qui me renverra la concat√©nation de firstName et lastName.  J'ai √©galement impl√©ment√© la m√©thode <code>activate()</code> - pour surveiller l'√©tat de mon entit√©, l'encapsulant ainsi.  Dans cette m√©thode, j'ai plac√©, d'une part, une <i>op√©ration de validation</i> , et, d'autre part, en <i>attribuant des valeurs aux champs</i> status et enabledBy, il n'y a donc pas besoin de setters pour eux.  J'ai √©galement ajout√© √† l'entit√© Client les <code>isActive()</code> et <code>canPlaceOrders()</code> , qui impl√©mentent la validation lambda en moi.  C'est ce qu'on appelle l'encapsulation des pr√©dicats.  Ces pr√©dicats sont utiles si vous utilisez des filtres Java 8: vous pouvez les passer comme arguments aux filtres.  Je vous conseille d'utiliser ces aides. <br><br>  Peut-√™tre que vous utilisez une sorte d'ORM comme Hibernate.  Supposons que vous ayez deux entit√©s avec une communication bidirectionnelle.  L'initialisation doit √™tre effectu√©e des deux c√¥t√©s, sinon, comme vous le comprenez, vous aurez des probl√®mes lors de l'acc√®s √† ces donn√©es √† l'avenir.  Mais les d√©veloppeurs oublient souvent d'initialiser un objet de l'une des parties.  Lors du d√©veloppement de ces entit√©s, vous pouvez fournir des m√©thodes sp√©ciales qui garantissent une initialisation bidirectionnelle.  Jetez un ≈ìil √† <code>addAddress()</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c55/7fe/273/c557fe273cc1f2658573f9e78a70ca1d.png"><br><br>  Comme vous pouvez le voir, c'est une entit√© tr√®s ordinaire.  Mais √† l'int√©rieur se trouve la logique du domaine.  Ces entit√©s ne doivent pas √™tre maigres et superficielles, mais ne doivent pas √™tre submerg√©es de logique.  Le d√©bordement de logique se produit plus souvent: si vous d√©cidez d'impl√©menter toute la logique du domaine, alors pour chaque cas d'utilisation, il sera tentant d'impl√©menter une m√©thode sp√©cifique.  En r√®gle g√©n√©rale, il existe de nombreux cas d'utilisation.  Vous ne recevrez pas une entit√©, mais une grande pile de toutes sortes de logiques.  Essayez d'observer la mesure ici: seule la <i>logique r√©utilis√©e</i> est plac√©e dans le domaine et seulement <i>en petite quantit√©.</i> <i><br><br></i> <h4>  <i>Objets de valeur</i> </h4> <i><br><br></i>  En plus des entit√©s, vous aurez probablement aussi besoin de valeurs d'objet.  Ce n'est rien d'autre qu'un moyen de regrouper les donn√©es de domaine afin de pouvoir les d√©placer ult√©rieurement dans le syst√®me ensemble. <br><br>  L'objet valeur doit √™tre: <br><br><ul><li>  <b>Petit</b> .  Pas de <code>float</code> pour les variables mon√©taires!  Soyez prudent lors du choix des types de donn√©es.  Plus votre objet est compact, plus il est facile pour un nouveau d√©veloppeur de le comprendre.  C'est la base d'une vie confortable. <br></li><li>  <b>Inchangeable</b> .  Si l'objet est vraiment immuable, alors le d√©veloppeur peut √™tre calme que votre objet ne changera pas sa valeur et ne se cassera pas apr√®s la cr√©ation.  Cela jette les bases d'un travail calme et confiant. <br></li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a0e/765/284/a0e76528432de8c55dc146805a8b286d.jpg"><br><br>  Et si vous ajoutez un appel de m√©thode <code>validate()</code> au constructeur, le d√©veloppeur sera en mesure de se calmer pour la validit√© de l'entit√© cr√©√©e (lors du passage, disons, d'une devise inexistante ou d'une somme d'argent n√©gative, le constructeur ne fonctionnera pas). <br><br><h4>  La diff√©rence entre une entit√© et un objet de valeur </h4><br><br>  Les objets de valeur diff√®rent des entit√©s en ce qu'ils n'ont pas d'ID fixe.  Les entit√©s auront toujours des champs associ√©s √† la cl√© √©trang√®re d'une table (ou d'un autre stockage).  Les objets de valeur n'ont pas de tels champs.  La question se pose: les proc√©dures de v√©rification de l'√©galit√© de deux objets valeur et de deux entit√©s sont-elles diff√©rentes?  √âtant donn√© que les objets de valeur n'ont pas de champ ID, pour conclure que deux de ces objets sont √©gaux, vous devez comparer les valeurs de tous leurs champs par paires (c'est-√†-dire examiner tout le contenu).  Lors de la comparaison d'entit√©s, il suffit de faire une seule comparaison - par ID de champ.  C'est dans la proc√©dure de comparaison que r√©side la principale diff√©rence entre les entit√©s et les objets de valeur. <br><br><h4>  Objets de transfert de donn√©es (DTO) </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/72a/d31/681/72ad31681509cdef20509d4514b02139.jpg"><br><br>  Quelle est l'interaction avec l'interface utilisateur (UI)?  Vous devez lui transmettre les <i>donn√©es √† afficher</i> .  Aurez-vous vraiment besoin d'une autre structure?  Il en est ainsi.  Et tout cela parce que l'interface utilisateur n'est pas du tout votre ami.  Il a ses propres demandes: il a besoin que les donn√©es soient stock√©es selon leur mode d'affichage.  C'est tellement merveilleux - que ce sont parfois les interfaces utilisateur et leurs d√©veloppeurs qui nous demandent.  Ensuite, ils doivent obtenir des donn√©es pour cinq lignes;  il leur vient alors √† l'esprit de cr√©er un <code>isDeletable</code> bool√©en <code>isDeletable</code> pour l'objet (l'objet peut-il avoir un tel champ en principe?) afin de savoir si le bouton Supprimer est actif ou non.  Mais il n'y a rien √† s'indigner.  Les interfaces utilisateur ont simplement des exigences diff√©rentes. <br><br>  La question est de savoir si nos entit√©s peuvent leur √™tre confi√©es pour utilisation?  Tr√®s probablement, ils vont les changer, et de la mani√®re la plus ind√©sirable pour nous.  Par cons√©quent, nous leur fournirons autre chose - <i>Data Transfer Objects</i> (DTO).  Ils seront sp√©cialement adapt√©s aux exigences externes et √† une logique diff√©rente de la n√¥tre.  Voici quelques exemples de structures DTO: Form / Request (provenant de l'interface utilisateur), View / Response (envoy√© √† l'interface utilisateur), SearchCriteria / SearchResult, etc. Vous pouvez, dans un sens, appeler cela un mod√®le d'API. <br><br>  Premier principe important: le DTO doit contenir un minimum de logique. <br>  Voici un exemple d'impl√©mentation de <code>CustomerDto</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ec/3bb/716/4ec3bb716c630f3b39ca82f8fe4c5e33.jpg"><br><br>  Contenu: champs <i>priv√©s</i> , getters <i>publics</i> et setters pour eux.  Tout semble super.  OOP dans toute sa splendeur.  Mais une chose est mauvaise: sous la forme de getters et setters, j'ai mis en ≈ìuvre trop de m√©thodes.  Dans DTO, il devrait y avoir aussi peu de logique que possible.  Et puis quelle est ma sortie?  Je rend les champs publics!  Vous direz que cela fonctionne mal avec les r√©f√©rences de m√©thode de Java 8, qu'il y aura des limitations, etc. Mais croyez-le ou non, j'ai fait tous mes projets (10-11 pi√®ces) avec de tels DTO.  Le fr√®re est vivant.  Maintenant, comme mes champs sont publics, je peux facilement d√©finir la valeur sur <code>dto.fullName</code> en mettant simplement un signe √©gal.  Quoi de plus beau et de plus simple? <br><br><h2>  Organisation logique </h2><br><br><h4>  Cartographie </h4><br><br>  Donc, nous avons une t√¢che: nous devons transformer nos entit√©s en DTO.  Nous mettons en ≈ìuvre la transformation comme suit: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/995/dfd/ca8/995dfdca8c1945fb92a64cee09851259.jpg"><br><br>  Comme vous pouvez le voir, en d√©clarant un DTO, nous passons aux op√©rations de mappage (attribution de valeur).  Dois-je √™tre un d√©veloppeur senior pour √©crire des affectations r√©guli√®res dans de tels nombres?  Pour certains, c'est tellement inhabituel qu'ils commencent √† changer de chaussures en cours de route: par exemple, copier des donn√©es en utilisant une sorte de cadre de cartographie en utilisant la r√©flexion.  Mais ils manquent l'essentiel - que t√¥t ou tard, l'interface utilisateur interagira avec le DTO, √† la suite de quoi l'entit√© et le DTO divergent dans leurs significations. <br><br>  On pourrait, par exemple, mettre des op√©rations de mappage dans le constructeur.  Mais cela n'est possible pour aucune cartographie;  en particulier, le concepteur ne peut pas acc√©der √† la base de donn√©es. <br><br>  Ainsi, nous sommes oblig√©s de laisser les op√©rations de mappage dans la logique m√©tier.  Et s'ils ont une apparence compacte, il n'y a rien √† craindre.  Si le mappage ne prend pas quelques lignes, mais plus, il est pr√©f√©rable de le placer dans le soi-disant <i>mappeur</i> .  Un mappeur est une classe sp√©cialement con√ßue pour copier des donn√©es.  Ceci, en g√©n√©ral, est chose ant√©diluvienne et passe-partout.  Mais derri√®re eux, vous pouvez masquer nos nombreuses t√¢ches - pour rendre le code plus propre et plus mince. <br><br>  N'oubliez pas: un <i>code devenu trop volumineux doit √™tre d√©plac√© vers une structure distincte</i> .  Dans notre cas, les op√©rations de mappage √©taient vraiment un peu nombreuses, nous les avons donc d√©plac√©es vers une classe distincte - le mappeur. <br><br>  Les mappeurs doivent-ils autoriser l'acc√®s √† la base de donn√©es?  Vous pouvez l'activer par d√©faut - cela est souvent fait pour des raisons de simplicit√© et de pragmatisme.  Mais cela vous expose √† certains risques. <br><br>  Je vais illustrer avec un exemple.  Sur la base du DTO existant, nous cr√©ons l'entit√© <code>Customer</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef3/9e8/b82/ef39e8b82a023a2fad6afe8e3c22b5ec.png"><br><br>  Pour la cartographie, nous devons obtenir un lien vers le groupe du client √† partir de la base de donn√©es.  <code>getReference()</code> m√©thode <code>getReference()</code> , et elle me renvoie une entit√©.  La demande ira tr√®s probablement √† la base de donn√©es (dans certains cas, cela ne se produit pas et la fonction de remplacement fonctionne). <br><br>  Mais le probl√®me ne nous attend pas ici, mais dans la m√©thode qui effectue l'op√©ration inverse - transformer l'entit√© en DTO. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6a/e27/7ff/e6ae277ff6b22588b5bc5aaffabf9d0e.png"><br><br>  √Ä l'aide d'une boucle, nous parcourons toutes les adresses associ√©es au client existant et les traduisons en adresses DTO.  Si vous utilisez ORM, alors, probablement, lorsque vous appelez la m√©thode <code>getAddresses()</code> , un chargement <code>getAddresses()</code> sera effectu√©.  Si vous n'utilisez pas ORM, ce sera une demande ouverte √† tous les enfants de ce parent.  Et l√†, vous courez le risque de plonger dans le ¬´probl√®me N + 1¬ª.  Pourquoi? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e54/001/2bb/e540012bbb4a242d84e55a2dffa5ca11.jpg"><br><br>  Vous avez un ensemble de parents dont chacun a des enfants.  Pour tout cela, vous devez cr√©er vos propres analogues √† l'int√©rieur du DTO.  Vous devrez effectuer une requ√™te <code>SELECT</code> pour parcourir N entit√©s parentes puis N requ√™tes <code>SELECT</code> pour contourner les enfants de chacune d'entre elles.  Total N + 1 demande.  Pour 1000 entit√©s <code>Customer</code> m√®res, une telle op√©ration prendra 5 √† 10 secondes, ce qui, bien s√ªr, prend beaucoup de temps. <br><br>  Supposons que, n√©anmoins, notre m√©thode <code>CustomerDto()</code> soit appel√©e √† l'int√©rieur de la boucle, convertissant la liste des objets Customer en liste CustomerDto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58c/9c3/2b3/58c9c32b3e8a01a96d500920dfe5ef07.jpg"><br><br>  Le probl√®me avec les requ√™tes N + 1 a des solutions standard simples: dans <i>JPQL,</i> vous pouvez utiliser <code>FETCH</code> by customer.addresses pour r√©cup√©rer des enfants, puis les connecter √† l'aide de <code>JOIN</code> , et dans SQL, vous pouvez utiliser le contournement <code>IN</code> et la <code>WHERE</code> . <br><br>  Mais je le ferais diff√©remment.  Vous pouvez savoir quelle est la longueur maximale de la liste des enfants (cela peut √™tre fait, par exemple, sur la base d'une recherche avec pagination).  Si la liste ne contient que 15 entit√©s, nous n'avons besoin que de 16 requ√™tes.  Au lieu de 5 ms, nous passerons √† tout, disons 15 ms - l'utilisateur ne remarquera pas la diff√©rence. <br><br><h4>  √Ä propos de l'optimisation </h4><br><br>  Je ne vous conseillerais pas de revenir sur les performances du syst√®me au stade initial de d√©veloppement.  Comme l'a dit Donald Knud: ¬´L'optimisation pr√©matur√©e est la racine du mal.¬ª  Vous ne pouvez pas optimiser d√®s le d√©part.  C'est exactement ce qui doit √™tre laiss√© pour plus tard.  Et ce qui est particuli√®rement important: <i>pas d'hypoth√®ses - uniquement des mesures et l'√©valuation des mesures!</i> <br><br>  Etes-vous s√ªr que vous √™tes comp√©tent que vous √™tes un vrai expert?  Soyez humble en vous √©valuant.  Ne pensez pas que vous comprenez la JVM avant d'avoir lu au moins quelques livres sur la compilation JIT.  Il arrive que les meilleurs programmeurs de notre √©quipe viennent me voir et disent <i>qu'ils pensent</i> avoir trouv√© une impl√©mentation plus efficace.  Il s'av√®re qu'ils ont √† nouveau invent√© quelque chose qui ne fait que compliquer le code.  Alors je r√©ponds encore et encore: YAGNI.  Nous n'en avons pas besoin. <br><br>  Souvent, pour les applications d'entreprise, aucune optimisation des algorithmes n'est n√©cessaire.  Le goulot d'√©tranglement pour eux, en r√®gle g√©n√©rale, n'est pas la compilation et pas en ce qui concerne le processeur, mais toutes sortes d'op√©rations d'entr√©e-sortie.  Par exemple, en lisant un million de lignes d'une base de donn√©es, des √©critures volumineuses dans un fichier, une interaction avec des sockets. <br><br>  Au fil du temps, vous commencez √† comprendre quels goulots d'√©tranglement le syst√®me contient et, en renfor√ßant le tout avec des mesures, vous commencerez √† optimiser progressivement.  Pour l'instant, gardez le code aussi propre que possible.  Vous constaterez qu'un tel code est beaucoup plus facile √† optimiser davantage. <br><br><h4>  Pr√©f√®re la composition √† l'h√©ritage </h4><br><br>  Retour √† notre DTO.  Supposons que nous d√©finissions un DTO comme ceci: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/180/39d/f91/18039df91fd1cc76a2413b7f373e7c0b.png"><br><br>  Nous pouvons en avoir besoin dans de nombreux workflows.  Mais ces flux sont diff√©rents et, tr√®s probablement, chaque cas d'utilisation supposera un degr√© diff√©rent de remplissage sur le terrain.  Par exemple, nous devrons √©videmment cr√©er un DTO plus t√¥t que lorsque nous disposons d'informations compl√®tes sur l'utilisateur.  Vous pouvez temporairement laisser les champs vides.  Mais plus vous ignorerez de champs, plus vous voudrez cr√©er un nouveau DTO plus strict pour ce cas d'utilisation. <br><br>  Vous pouvez √©galement cr√©er des copies d'un DTO trop volumineux (dans le nombre de cas d'utilisation disponibles), puis en supprimer des champs suppl√©mentaires pour chaque copie.  Mais pour de nombreux programmeurs, en raison de leur intelligence et de leur alphab√©tisation, cela fait vraiment mal d'appuyer sur Ctrl + V.  L'axiome dit que le copier-coller est mauvais. <br><br>  Vous pouvez recourir au principe d' <i>h√©ritage</i> connu dans la th√©orie de la POO: il suffit de d√©finir un DTO de base et de cr√©er un h√©ritier pour chaque cas d'utilisation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f7/069/77f/6f706977fec8625d720323b64fe87ad8.png"><br><br>  Un principe bien connu est: ¬´Pr√©f√©rez la composition √† l'h√©ritage¬ª.  Lisez ce qu'il dit: <i>¬´s'√©tend¬ª</i> .  Il semble que nous aurions d√ª ¬´√©largir¬ª la classe source.  Mais si vous y r√©fl√©chissez, alors ce que nous avons fait n'est pas du tout ¬´l'expansion¬ª.  C'est la vraie ¬´r√©p√©tition¬ª - le m√™me copier-coller, vue lat√©rale.  Par cons√©quent, nous n'utiliserons pas d'h√©ritage. <br><br>  Mais que devons-nous donc √™tre?  Comment aller √† la composition?  Faisons-le de cette fa√ßon: √©crivez un champ dans CustomerView qui pointera vers l'objet du DTO sous-jacent. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f2/d49/831/1f2d49831b9b286b8bc069c824ac2871.jpg"><br><br>  Ainsi, notre structure de base sera imbriqu√©e √† l'int√©rieur.  C'est ainsi que la vraie composition sort. <br><br>  Que nous utilisions l'h√©ritage ou r√©solvions le probl√®me par composition - ce sont toutes des particularit√©s, des subtilit√©s qui ont surgi profond√©ment au cours de notre mise en ≈ìuvre.  Ils sont tr√®s <i>fragiles</i> .  Que signifie fragile?  Jetez un ≈ìil √† ce code: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/921/eb1/ef2/921eb1ef20effd43b129ad5d28b88253.png"><br><br>  La plupart des d√©veloppeurs √† qui j'ai montr√© cela ont imm√©diatement laiss√© entendre que le nombre "2" √©tait r√©p√©t√©, il fallait donc le supprimer comme une constante.  Ils n'ont pas remarqu√© que le diable dans les trois cas a une signification compl√®tement diff√©rente (ou ¬´valeur commerciale¬ª) et que sa r√©p√©tition n'est rien de plus qu'une co√Øncidence.  Tirer un deux dans une constante est une d√©cision l√©gitime, mais tr√®s fragile.  Essayez de ne pas autoriser une logique fragile dans le domaine.  Ne travaillez jamais avec des structures de donn√©es externes, en particulier avec DTO. <br><br>  Alors, pourquoi le travail d'√©limination de l'h√©ritage et d'introduction de la composition est-il inutile?  Pr√©cis√©ment parce que nous cr√©ons du DTO non pas pour nous, mais pour un client externe.  Et comment l'application client analysera le DTO re√ßu de vous - vous ne pouvez que deviner.  Mais √©videmment, cela n'aura pas grand-chose √† voir avec votre impl√©mentation.  Les d√©veloppeurs, d'autre part, peuvent ne pas faire de distinction pour les DTO de base et non de base que vous avez soigneusement r√©fl√©chis;  ils utilisent probablement l'h√©ritage, et peut-√™tre b√™tement copier-coller c'est tout. <br><br><h4>  Fa√ßades </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/be7/31c/9e4/be731c9e4cfe002cb3b59c11a708f623.jpg"><br><br>  Revenons √† l'image globale de l'application.  Je vous conseille d'impl√©menter la logique du domaine via le <i>mod√®le de fa√ßade</i> , en √©tendant les fa√ßades avec des <i>services de domaine</i> si n√©cessaire.  Un service de domaine est cr√©√© lorsque trop de logique s'accumule dans la fa√ßade, et il est plus pratique de le placer dans une classe distincte. <br>  Vos services de domaine doivent n√©cessairement parler la langue de votre mod√®le de domaine (ses entit√©s et objets de valeur).  Ils ne doivent en aucun cas travailler avec DTO, car les DTO, comme vous vous en souvenez, sont des structures en constante √©volution c√¥t√© client, trop fragiles pour un domaine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ad/eb8/657/3adeb86570a92f804ba491836c99b9e8.jpg"><br><br>  √Ä quoi sert la fa√ßade? <br><br><ol><li>  Conversion de donn√©es.  Si nous avons des entit√©s d'un c√¥t√© et des DTO de l'autre, il faut effectuer des transformations de l'un √† l'autre.  Et c'est la premi√®re chose √† laquelle les fa√ßades sont destin√©es.  Si la proc√©dure de conversion a augment√© en volume - utilisez les classes de mappage. <br></li><li>  L'impl√©mentation de la logique.  Dans la fa√ßade, vous commencerez √† √©crire la logique principale de l'application.  D√®s que cela devient beaucoup - apportez des pi√®ces au service de domaine. <br></li><li>  Validation des donn√©es.  N'oubliez pas que toutes les donn√©es re√ßues de l'utilisateur sont, par d√©finition, incorrectes (contenant des erreurs).  La fa√ßade a la capacit√© de valider les donn√©es.  Ces proc√©dures, lorsque le volume est d√©pass√©, sont g√©n√©ralement transmises aux <i>valideurs</i> . <br></li><li>  Aspects  Vous pouvez aller plus loin et faire passer chaque cas d'utilisation par sa fa√ßade.  Ensuite, il s'av√©rera ajouter des choses telles que les transactions, la journalisation, les gestionnaires d'exceptions globales aux m√©thodes de fa√ßade. Je note qu'il est tr√®s important d'avoir des gestionnaires d'exceptions globales dans toute application qui d√©tectent toutes les erreurs non d√©tect√©es par d'autres gestionnaires.  Ils aideront grandement vos programmeurs - ils leur donneront la tranquillit√© d'esprit et la libert√© d'action. <br></li></ol><br><br><h4>  D√©composition de beaucoup de code </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/604/a9c/8e8/604a9c8e859ff1dc3fb38208d6bf836d.jpg"><br><br>  Encore quelques mots sur ce principe.  Si la classe a atteint une taille qui ne me convient pas (disons, 200 lignes), je devrais essayer de la diviser en morceaux.  Mais isoler une nouvelle classe d'une classe existante n'est pas toujours facile.  Nous devons trouver des moyens universels.  L'une de ces m√©thodes consiste √† rechercher des noms: vous essayez de trouver un nom pour un sous-ensemble des m√©thodes de votre classe.  D√®s que vous parvenez √† trouver un nom, n'h√©sitez pas √† cr√©er une nouvelle classe.  Mais ce n'est pas si simple.  En programmation, comme vous le savez, il n'y a que deux choses complexes: cela invalide le cache et invente des noms.  Dans ce cas, inventer un nom implique d'identifier une sous-t√¢che - se cacher et donc pas pr√©alablement identifi√© par quiconque. <br><br>  Un exemple: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/81f/fe3/82b/81ffe382b74f6bbd4a91626d83249a97.jpg"><br><br>  Dans la fa√ßade d'origine de <code>CustomerFacade</code> certaines des m√©thodes sont directement li√©es au client, et certaines sont li√©es aux pr√©f√©rences du client.  Sur cette base, je pourrai diviser la classe en deux lorsqu'elle atteindra des tailles critiques.  J'obtiens deux fa√ßades: <code>CustomerFacade</code> et <code>CustomerPreferencesFacade</code> .  La seule mauvaise chose est que ces deux fa√ßades appartiennent au m√™me niveau d'abstraction.  La s√©paration par niveaux d'abstraction implique quelque chose de diff√©rent. <br><br>  Un autre exemple: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ac/84e/788/2ac84e788af60fb038091aed273a390e.jpg"><br><br>  Supposons qu'il existe une classe <code>OrderService</code> dans notre syst√®me dans laquelle nous avons impl√©ment√© un m√©canisme de notification par e-mail.  Nous cr√©ons maintenant un <code>DeliveryService</code> et souhaitons utiliser le m√™me m√©canisme de notification ici.  Le copier-coller est exclu.  Faisons-le de cette fa√ßon: extrayez la fonctionnalit√© de notification dans la nouvelle classe <code>AlertService</code> et √©crivez-la en tant que d√©pendance pour les <code>OrderService</code> <code>DeliveryService</code> et <code>OrderService</code> .  Ici, contrairement √† l'exemple pr√©c√©dent, la s√©paration s'est produite pr√©cis√©ment aux niveaux d'abstraction. <code>DeliveryService</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plus abstrait que </font></font><code>AlertService</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, car il l'utilise </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dans le cadre de</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son flux de travail. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La s√©paration par niveaux d'abstraction suppose toujours que la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">classe extraite devient une d√©pendance</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et l' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extraction est effectu√©e pour √™tre r√©utilis√©e</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La t√¢che d'extraction n'est pas toujours facile. </font><font style="vertical-align: inherit;">Elle peut √©galement entra√Æner certaines difficult√©s et n√©cessiter une refactorisation des tests unitaires. </font><font style="vertical-align: inherit;">N√©anmoins, selon mes observations, il est encore plus difficile pour les d√©veloppeurs de rechercher des fonctionnalit√©s dans l'√©norme base de code monolithique de l'application.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Programmation par paire </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/625/5b2/346/6255b23467294d6224107235443379f1.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De nombreux consultants parleront de la programmation en bin√¥me, du fait qu'il s'agit d'une solution universelle √† tous les probl√®mes de d√©veloppement informatique d'aujourd'hui. Pendant ce temps, les programmeurs d√©veloppent leurs comp√©tences techniques et leurs connaissances fonctionnelles. De plus, le processus lui-m√™me est int√©ressant, il rassemble l'√©quipe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne parlant pas en tant que consultants, mais humainement, la chose la plus importante est la suivante: la programmation par paires am√©liore le ¬´facteur bus¬ª. L‚Äôessence du ¬´facteur bus¬ª est qu‚Äôil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devrait</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font><i><font style="vertical-align: inherit;">avoir autant de personnes qui connaissent la structure du syst√®me que possible</font></i><font style="vertical-align: inherit;"> . Perdre ces personnes signifie perdre les derniers indices de cette connaissance.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le refactoring de la programmation en bin√¥me est un art qui n√©cessite de l'exp√©rience et de la formation. Il est utile, par exemple, la pratique du refactoring agressif, de la r√©alisation de hackathons, de coupures, de codage de dojos, etc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La programmation par paire fonctionne bien dans les cas o√π vous devez r√©soudre des probl√®mes de grande complexit√©. Le processus de collaboration n'est pas toujours simple. Mais cela vous garantit que vous √©viterez la "r√©ing√©nierie" - au contraire, vous obtiendrez une impl√©mentation qui r√©pond aux exigences d√©finies avec une complexit√© minimale. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5a/5aa/666/a5a5aa666cb29c58dc9bb5b7d5bc6651.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'organisation d'un format de travail pratique est l'une de vos principales responsabilit√©s envers l'√©quipe. Vous devez constamment prendre soin des conditions de travail du d√©veloppeur - leur fournir un confort complet et une libert√© de cr√©ativit√©, surtout si elles sont n√©cessaires pour augmenter l'architecture de conception et sa complexit√©.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´Je suis architecte. </font><font style="vertical-align: inherit;">Par d√©finition, j'ai toujours raison. ¬ª</font></font></h4><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette stupidit√© s'exprime p√©riodiquement publiquement ou en coulisses. </font><font style="vertical-align: inherit;">Dans la pratique d'aujourd'hui, les architectes en tant que tels se retrouvent de moins en moins. </font><font style="vertical-align: inherit;">Avec l'av√®nement d'Agile, ce r√¥le est progressivement pass√© aux d√©veloppeurs seniors, car g√©n√©ralement tout le travail, d'une mani√®re ou d'une autre, est construit autour d'eux. </font><font style="vertical-align: inherit;">La taille de l'impl√©mentation augmente progressivement, et avec cela il y a un besoin de refactoring et de nouvelles fonctionnalit√©s sont en cours de d√©veloppement.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Architecture de l'oignon </font></font></h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oignon est la philosophie de script de transaction la plus pure. En le construisant, nous sommes guid√©s par l'objectif de prot√©ger le code que nous consid√©rons comme critique, et pour cela nous le d√©pla√ßons vers le module de domaine. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a45/bb4/94a/a45bb494a51b04ecfe92606b744c0857.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans notre application, les plus importants sont les services de domaine: ils mettent en ≈ìuvre les flux les plus critiques. D√©placez-les vers le module de domaine. Bien s√ªr, il vaut √©galement la peine de d√©placer tous vos objets de domaine ici - entit√©s et objets de valeur. Tout le reste que nous avons compil√© aujourd'hui - DTO, mappeurs, validateurs, etc. - devient, pour ainsi dire, la premi√®re ligne de d√©fense de l'utilisateur. Parce que l'utilisateur, h√©las, n'est pas notre ami, et il est n√©cessaire de prot√©ger le syst√®me contre lui. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention √† cette d√©pendance:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7d/273/6bd/c7d2736bdc016b732c5c431299bf32ea.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le module d'application d√©pendra du module de domaine, c'est-√†-dire pas l'inverse. En enregistrant une telle connexion, nous garantissons que le DTO ne p√©n√®trera jamais dans le territoire sacr√© du module de domaine: ils ne sont tout simplement pas visibles et inaccessibles depuis le module de domaine. Il s'av√®re que dans un sens, nous avons cl√¥tur√© le territoire du domaine - nous avons restreint l'acc√®s √† celui-ci par des √©trangers. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, le domaine peut avoir besoin d'interagir avec certains services externes. Avec des moyens ext√©rieurs peu amicaux, car il est √©quip√© de son DTO. Quelles sont nos options? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premi√®rement: √©vitez l'ennemi √† l'int√©rieur du module. </font></font><br><br><img src="https://habrastorage.org/webt/un/tn/hk/untnhkiksv5id_i-6c4qwdjxy1c.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âvidemment, c'est une mauvaise option: il est possible que demain le service externe ne passe pas √† la version 2.0, et nous devrons redessiner notre domaine. Ne laissez pas l'ennemi √† l'int√©rieur du domaine!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je propose une approche diff√©rente: nous allons cr√©er un </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptateur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sp√©cial pour l'interaction </font><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/123/8b1/09c/1238b109c54ac8f19524e6d41b32e85e.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'adaptateur recevra les donn√©es d'un service externe, extraira les donn√©es dont notre domaine a besoin et les convertira en types de structures requis. </font><font style="vertical-align: inherit;">Dans ce cas, tout ce qui nous est demand√© pendant le d√©veloppement est de corr√©ler les appels vers le syst√®me externe avec les exigences du domaine. </font><font style="vertical-align: inherit;">Consid√©rez-le comme un √©norme </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptateur</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comme celui-ci </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">J'appelle cette couche ¬´anti-corruption¬ª. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, nous pouvons avoir besoin d'ex√©cuter des requ√™tes LDAP √† partir d'un domaine. </font><font style="vertical-align: inherit;">Pour ce faire, nous mettons en ≈ìuvre le ¬´module anti-corruption¬ª </font></font><code>LDAPUserServiceAdapter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/520/fdc/84a/520fdc84a53641a26b957ac010a19c42.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans l'adaptateur, nous pouvons:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Masquer les appels d'API laids (dans notre cas, masquer la m√©thode qui prend le tableau Object); </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pack d'exceptions dans nos propres impl√©mentations; </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Convertir les structures de donn√©es des autres en leurs propres (dans nos objets de domaine); </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V√©rifiez la validit√© des donn√©es entrantes. </font></font><br></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est le but de l'adaptateur. </font><font style="vertical-align: inherit;">Bon, √† l'interface avec chaque syst√®me externe avec lequel vous devez interagir, votre adaptateur doit √™tre install√©. </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/b1a/663/9c5/b1a6639c58457537fb6a4d9c15e09eae.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, le domaine ne dirigera pas l'appel vers un service externe, mais vers l'adaptateur. </font><font style="vertical-align: inherit;">Pour ce faire, la d√©pendance correspondante doit √™tre enregistr√©e dans le domaine (depuis l'adaptateur ou depuis le module d'infrastructure dans lequel elle se trouve). </font><font style="vertical-align: inherit;">Mais cette d√©pendance est-elle s√ªre? </font><font style="vertical-align: inherit;">Si vous l'installez comme ceci, un DTO de service externe peut entrer dans notre domaine. </font><font style="vertical-align: inherit;">Nous ne devons pas permettre cela. </font><font style="vertical-align: inherit;">Par cons√©quent, je vous sugg√®re une autre fa√ßon de mod√©liser les d√©pendances.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Principe d'inversion de d√©pendance </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/058/4a1/f7c/0584a1f7c309505e4e5ea0c2b0b26c21.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cr√©ons une interface, √©crivons-y la signature des m√©thodes n√©cessaires et pla√ßons-la dans notre domaine. La t√¢che de l'adaptateur est d'impl√©menter cette interface. Il s'av√®re que l'interface est √† l'int√©rieur du domaine, et l'adaptateur est √† l'ext√©rieur, dans le module d'infrastructure qui importe l'interface. Ainsi, nous avons tourn√© la direction de la d√©pendance dans la direction oppos√©e. Au moment de l'ex√©cution, le syst√®me de domaine appellera n'importe quelle classe via des interfaces. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme vous pouvez le voir, rien qu'en introduisant des interfaces dans l'architecture, nous avons pu d√©ployer des d√©pendances et ainsi s√©curiser notre domaine contre les structures √©trang√®res et les API qui y tombent. Cette approche est appel√©e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">inversion de d√©pendance</font></font></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2c/cc2/cd0/c2ccc2cd0309a4c8f97b7521cfc63fb7.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En g√©n√©ral, l'inversion de d√©pendance suppose que vous placez les m√©thodes qui vous int√©ressent dans l'interface √† l'int√©rieur de votre module de haut niveau (dans le domaine), et impl√©mentez cette interface de l'ext√©rieur - dans l'un ou l'autre module laid de bas niveau (infrastructure). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'interface impl√©ment√©e √† l'int√©rieur du module de domaine doit parler la langue du domaine, c'est-√†-dire qu'elle fonctionnera sur ses entit√©s, ses param√®tres et ses types de retour. Au moment de l'ex√©cution, le domaine appellera n'importe quelle classe via un appel polymorphe √† l'interface. Les frameworks d'injection de d√©pendances (comme Spring et CDI) nous fournissent une instance concr√®te de la classe directement √† l'ex√©cution.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais l'essentiel est que pendant la compilation, le module de domaine ne verra pas le contenu du module externe. </font><font style="vertical-align: inherit;">Voil√† ce dont nous avons besoin. </font><font style="vertical-align: inherit;">Aucune entit√© externe ne doit tomber dans le domaine. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selon l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oncle Bob</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le principe de l'inversion de contr√¥le (ou, comme il l'appelle, ¬´architecture plug-in¬ª) est peut-√™tre le meilleur que le paradigme OOP offre en g√©n√©ral. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a96/3cf/e13/a963cfe13d030fb1d7ec2bf0f780fe43.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette strat√©gie peut √™tre utilis√©e pour l'int√©gration avec tous les syst√®mes, pour les appels et messages synchrones et asynchrones, pour l'envoi de fichiers, etc.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pr√©sentation de l'ampoule </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc3/64d/cdb/dc364dcdb589b35a0597b6e478aace46.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons donc d√©cid√© de prot√©ger le module de domaine. </font><font style="vertical-align: inherit;">√Ä l'int√©rieur, il y a un service de domaine, des entit√©s, des objets de valeur, et maintenant des interfaces pour les services externes, ainsi que des interfaces pour le r√©f√©rentiel (pour interagir avec la base de donn√©es). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La structure ressemble √† ceci: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/983/0c7/07e9830c76d3b263743f8514b13bf42a.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le module d'application, le module d'infrastructure (via l'inversion de d√©pendance), le module de r√©f√©rentiel (nous consid√©rons √©galement la base de donn√©es comme un syst√®me externe), le module batch et √©ventuellement certains autres modules sont des d√©pendances d√©clar√©es pour le domaine. </font><font style="vertical-align: inherit;">Cette architecture est appel√©e </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´oignon¬ª</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">il est √©galement appel√© ¬´propre¬ª, ¬´hexagonal¬ª et ¬´ports et adaptateurs¬ª.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Module de r√©f√©rentiel </font></font></h4><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je vais parler bri√®vement du module de r√©f√©rentiel. Que ce soit pour le retirer du domaine est une question. La t√¢che du r√©f√©rentiel est de rendre la logique plus propre, en nous cachant l'horreur de travailler avec des donn√©es persistantes. L'option pour les gars de la vieille √©cole est d'utiliser JDBC pour interagir avec la base de donn√©es: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ed/d70/44a/7edd7044a76373b2c513e246bf6eabaa.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez √©galement utiliser Spring et son JdbcTemplate: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/64b/d68/749/64bd68749f5b3de16591a23a8acda193.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou MyBatis DataMapper: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/423/31b/aa1/42331baa178ff3ad8f0ea8fb92704265.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais c'est tellement compliqu√© et laid que cela d√©courage tout d√©sir de faire quoi que ce soit d'autre. Par cons√©quent, je sugg√®re d'utiliser JPA / Hibernate ou Spring Data JPA. Ils nous donneront la possibilit√© d'envoyer des requ√™tes construites non pas sur le sch√©ma de la base de donn√©es, mais directement sur la base du mod√®le de nos entit√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Impl√©mentation pour JPA / Hibernate: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/110/ebf/ef7/110ebfef7dad2a2bb278c50668eecda9.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans le cas de Spring Data JPA:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/10b/e2a/0ff/10be2a0ff082a8c1ac962c4754ec55a8.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring Data JPA peut g√©n√©rer automatiquement des m√©thodes au moment de l'ex√©cution, telles que, par exemple, getById (), getByName (). Il vous permet √©galement d'ex√©cuter des requ√™tes JPQL si n√©cessaire - et non vers la base de donn√©es, mais vers votre propre mod√®le d'entit√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code Hibernate JPA et Spring Data JPA est vraiment tr√®s bon. Avons-nous besoin de l'extraire du domaine? √Ä mon avis, ce n'est pas ainsi et n√©cessaire. Tr√®s probablement, le code sera encore plus propre si vous laissez ce fragment √† l'int√©rieur du domaine. Alors agissez sur la situation.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/055/f04/37c/055f0437cf059c9f7001db6b3d231e70.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous cr√©ez n√©anmoins un module de r√©f√©rentiel, alors pour l'organisation des d√©pendances il vaut mieux utiliser le principe de l'inversion de contr√¥le de la m√™me mani√®re. </font><font style="vertical-align: inherit;">Pour ce faire, placez l'interface dans le domaine et impl√©mentez-la dans le module de r√©f√©rentiel. </font><font style="vertical-align: inherit;">Quant √† la logique du r√©f√©rentiel, il est pr√©f√©rable de la transf√©rer vers le domaine. </font><font style="vertical-align: inherit;">Cela rend le test pratique, car vous pouvez utiliser des objets Mock dans le domaine. </font><font style="vertical-align: inherit;">Ils vous permettront de tester la logique rapidement et √† plusieurs reprises. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traditionnellement, une seule entit√© est cr√©√©e pour un r√©f√©rentiel dans un domaine. </font><font style="vertical-align: inherit;">Ils ne le cassent en morceaux que lorsqu'il devient trop volumineux. </font><font style="vertical-align: inherit;">N'oubliez pas que les classes doivent √™tre compactes.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> API </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c8/9e1/7e7/1c89e17e784e4db6fe8d7c713bcf1ab6.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez cr√©er un module s√©par√©, placer l'interface extraite de la fa√ßade et les DTO qui en d√©pendent, puis l'emballer dans un JAR et le transf√©rer vers vos clients Java sous cette forme. </font><font style="vertical-align: inherit;">Ayant ce dossier, ils pourront envoyer des demandes aux fa√ßades.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ampoule pragmatique </font></font></h4><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En plus de ceux de nos ¬´ennemis¬ª √† qui nous livrons des fonctionnalit√©s, c'est-√†-dire des clients, nous avons √©galement des ennemis et, d'autre part, les modules dont nous d√©pendons nous-m√™mes. </font><font style="vertical-align: inherit;">Nous devons √©galement nous prot√©ger de ces modules. </font><font style="vertical-align: inherit;">Et pour cela, je vous propose un ¬´oignon¬ª l√©g√®rement modifi√© - en lui toute l'infrastructure est combin√©e en un module. </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/265/1f1/481/2651f1481062cfe6c18974df9a6dde9b.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'appelle cette architecture une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ampoule pragmatique¬ª</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ici, la s√©paration des composants s'effectue selon le principe du ¬´mien¬ª et du ¬´int√©grable¬ª: s√©par√©ment, cela concerne mon domaine, et s√©par√©ment, cela fait r√©f√©rence √† l'int√©gration avec des collaborateurs externes. Ainsi, seuls deux modules sont obtenus: le domaine et l'application. Une telle architecture est tr√®s bonne, mais uniquement lorsque le module d'application est petit. Sinon, vous feriez mieux de revenir √† l'oignon traditionnel.</font></font><br><br><h2>  Les tests </h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme je l'ai dit plus t√¥t, si tout le monde a peur de votre candidature, consid√©rez qu'elle a reconstitu√© les rangs de Legacy. </font></font><img src="https://habrastorage.org/getpro/habr/post_images/12a/508/d1b/12a508d1b9595239f6d9b9a8a72c9474.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais les tests sont bons. Ils nous donnent un sentiment de confiance qui nous permet de continuer le refactoring. Mais malheureusement, cette confiance peut facilement se r√©v√©ler injustifi√©e. Je vais vous expliquer pourquoi. TDD (d√©veloppement par le biais de tests) suppose que vous √™tes √† la fois l'auteur du code et l'auteur des cas de test: vous lisez les sp√©cifications, impl√©mentez la fonctionnalit√© et √©crivez imm√©diatement une suite de tests. Les tests, par exemple, r√©ussiront. Mais que faire si vous avez mal compris les exigences du cahier des charges? Ensuite, les tests ne v√©rifieront pas ce qui est n√©cessaire. Votre confiance est donc sans valeur. Et tout cela parce que vous avez √©crit du code et des tests seuls.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais essayez de fermer les yeux sur cela. </font><font style="vertical-align: inherit;">Des tests sont encore n√©cessaires, et en tout cas ils nous donnent confiance. </font><font style="vertical-align: inherit;">Surtout, bien s√ªr, nous aimons les tests fonctionnels: ils n'impliquent aucun effet secondaire, aucune d√©pendance - uniquement des donn√©es d'entr√©e et de sortie. </font><font style="vertical-align: inherit;">Pour tester un domaine, vous devez utiliser des objets fant√¥mes: ils vous permettront de tester des classes isol√©ment. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quant aux requ√™tes de base de donn√©es, les tester est d√©sagr√©able. </font><font style="vertical-align: inherit;">Ces tests sont fragiles, ils n√©cessitent que vous ajoutiez d'abord des donn√©es de test √† la base de donn√©es - et seulement apr√®s cela, vous pouvez proc√©der au test de la fonctionnalit√©. </font><font style="vertical-align: inherit;">Mais comme vous le comprenez, ces tests sont √©galement n√©cessaires, m√™me si vous utilisez JPA.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tests unitaires </font></font></h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8bd/332/6ec/8bd3326ec6ca9886c78b4239491dc936.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je dirais que la puissance des tests unitaires n'est pas dans la possibilit√© de les ex√©cuter, mais dans ce que le processus de leur √©criture englobe. Pendant que vous √©crivez un test, vous repensez et travaillez sur le code - r√©duisez la connectivit√©, divisez-le en classes - en un mot, effectuez le prochain refactoring. Le code test√© est du code pur; c'est plus simple, la connectivit√© y est r√©duite; en g√©n√©ral, il est √©galement document√© (un test unitaire bien √©crit d√©crit parfaitement le fonctionnement de la classe). Il n'est pas surprenant que l'√©criture des tests unitaires soit difficile, en particulier les premi√®res pi√®ces. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/116/be7/361/116be7361d4d6a2dc8cac91983808378.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au stade des premiers tests unitaires, beaucoup de gens ont vraiment peur des perspectives qu'ils </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doivent vraiment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tester quelque chose. Pourquoi sont-ils si durs? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parce que ces tests sont le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">premier fardeau pour votre classe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Il s'agit du premier coup port√© au syst√®me, qui montrera peut-√™tre qu'il est fragile et fragile. Mais vous devez comprendre que ces quelques tests sont les plus importants pour votre d√©veloppement. Ils sont, par essence, vos meilleurs amis, car ils diront tout car il s'agit de la qualit√© de votre code. Si vous avez peur de cette √©tape, vous n'irez pas loin. Vous devez ex√©cuter des tests pour votre syst√®me. Apr√®s cela, la complexit√© diminuera, les tests seront √©crits plus rapidement. En les ajoutant un par un, vous cr√©erez une </font><i><font style="vertical-align: inherit;">base de test de r√©gression</font></i><font style="vertical-align: inherit;"> fiable pour votre syst√®me</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Et cela est extr√™mement important pour le travail futur de vos d√©veloppeurs. </font><font style="vertical-align: inherit;">Il leur sera plus facile de refactoriser; </font><font style="vertical-align: inherit;">Ils comprendront que le syst√®me peut √™tre test√© en r√©gression √† tout moment, c'est pourquoi travailler avec la base de code est s√ªr. </font><font style="vertical-align: inherit;">Et, je vous assure, ils s'engageront beaucoup plus volontiers dans la refactorisation. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/eb5/3d7/cbd/eb53d7cbdc3b190b2b597d6427088b1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mon conseil: si vous sentez que vous avez beaucoup de force et d'√©nergie aujourd'hui, consacrez-vous √† la r√©daction de tests unitaires. </font><font style="vertical-align: inherit;">Et assurez-vous que chacun est propre, rapide, a son propre poids et ne r√©p√®te pas les autres.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Astuces </font></font></h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©sumant tout ce qui a √©t√© dit aujourd'hui, je voudrais vous avertir avec les conseils suivants: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Restez </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">simple</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aussi longtemps que possible (et quel qu'en soit le co√ªt) </font><font style="vertical-align: inherit;">: √©vitez la ¬´r√©ing√©nierie¬ª et l'optimisation tardive, ne surchargez pas l'application;</font></font><br></li><li> <i>   </i> ,        ,   ; <br></li><li>  ¬´¬ª           ‚Äî <i>     </i> ; <br></li><li>   ,        ‚Äî <i></i> :         ; <br></li><li>    ¬´¬ª,  ,     ‚Äî <i>           </i> ; <br></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'ayez pas peur des tests</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : donnez-leur la possibilit√© de faire tomber votre syst√®me, ressentez tous leurs avantages - au final, ce sont vos amis car ils sont capables de signaler honn√™tement les probl√®mes.</font></font><br></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En faisant ces choses, vous aiderez votre √©quipe et vous-m√™me. </font><font style="vertical-align: inherit;">Et puis, le jour de la livraison du produit, vous serez pr√™t.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Que lire </font></font></h2><br><br><img src="https://habrastorage.org/getpro/habr/post_images/852/a4c/37d/852a4c37d17677fa3fb1e7e021f29e4a.jpg"><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7 vertus d'un bon objet</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NULL est la pire erreur en informatique</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'architecture propre</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nouveau jargon de programmation</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qualit√© du code: WTF / minute</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pourquoi chaque √©l√©ment de SOLID est faux!</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un bon logiciel est √©crit 3 fois</font></font></a> <br></li></ul><br><br><blockquote>  .        <b>JPoint</b> ‚Äî  ,  19-20   -  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Joker 2018</a> ‚Äî    Java-.       .        . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419179/">https://habr.com/ru/post/fr419179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419165/index.html">Nous envoyons des SMS "anonymes" de la console au num√©ro souhait√© en utilisant le service bytehand et C ++</a></li>
<li><a href="../fr419169/index.html">"World of the Wild West" √† travers les yeux du d√©veloppeur</a></li>
<li><a href="../fr419171/index.html">D√©sactivation des v√©rifications de l'√©tat d'ex√©cution dans une application Android</a></li>
<li><a href="../fr419173/index.html">Architecture propre dans le contexte du d√©veloppement multiplateforme</a></li>
<li><a href="../fr419177/index.html">Amazon Light Patterns</a></li>
<li><a href="../fr419181/index.html">Programmation de la souris: comment nous nous √©loignons de la routine CRM</a></li>
<li><a href="../fr419183/index.html">Demopati √† Helsinki ¬´Assembl√©e 2018¬ª, reportage photo, premier jour</a></li>
<li><a href="../fr419185/index.html">Aper√ßu des protocoles actuels de recherche de consensus dans un environnement d√©centralis√©</a></li>
<li><a href="../fr419189/index.html">Pourquoi les forfaits formeront bient√¥t la base du commerce de d√©tail</a></li>
<li><a href="../fr419193/index.html">Nous traitons des objets en JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>