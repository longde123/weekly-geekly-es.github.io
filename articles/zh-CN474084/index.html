<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹️ 🧑 👩🏼‍⚕️ 朱莉娅和神经网络：助焊剂 💫 💅 💆🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="自MIT宣布发布高性能通用语言Julia以来，已经过去了一年多的时间。 从那时起，该语言就开始流行起来：它已在1,500多家大学中使用 （在某些国家被作为第一门教学语言使用），其应用领域涵盖了从医学诊断和太空任务计划到紧迫的问题，例如优化校车交通 。 


 不难猜测，许多项目的主要活动领域之一是机...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>朱莉娅和神经网络：助焊剂</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474084/"><p><img src="https://habrastorage.org/webt/s7/qj/er/s7qjerlqwjzu5gldu9ot_kikrhs.png"><br> 自<em>MIT</em>宣布发布高性能通用语言<strong>Julia</strong>以来，已经过去了一年多的时间。 从那时起，该语言就开始流行起来：它已在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">1,500多家大学中使用</a> （在某些国家被作为第一门教学语言使用），其应用领域涵盖了从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">医学诊断</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">太空任务计划</a>到紧迫的问题，例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">优化校车交通</a> 。 </p><br><p> 不难猜测，许多项目的主要活动领域之一是机器学习，为此Julia提供了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">许多强大的工具</a> ，并且最近发布了一个相当有趣的项目- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">通用概率编程系统“ GEN”</a> 。 </p><br><p> 顾名思义，今天我们将关注<em>Flux</em>软件包，它提供了神经网络的所有功能。 我们将尝试从处理和研究图像集到经过训练的神经网络，以获得完整的分类器！ </p><a name="habracut"></a><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">官方网站</a> </li><li>  <a href="" rel="nofollow">github上的来源</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">该文件</a> </li><li> 在这里您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">使用训练有素的模型</a> </li></ul><br><p><img src="https://habrastorage.org/webt/ry/70/dl/ry70dlspnig0ekeel3wf43oygr0.png"></p><br><h2 id="ustanovka"> 安装方式 </h2><br><p> 从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">官方站点</a>下载分发工具包，然后在计算机上安装Julia解释器（ <em>REPL</em> ）。 </p><br><p> 为了使程序包管理器正常工作， <em>Windows 7 / Windows Server 2012的</em>用户还必须安装： </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="方法2：Microsoft更新目录帮助我" rel="nofollow">TLS easy_fix有关</a>详细信息，请参见“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="都是非俄语的" rel="nofollow">话语线程”</a> 。 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Windows Management Framework 3.0或更高版本</a> 。 </li></ul><br><p> 在<em>REPL</em>中工作的过程如下所示： </p><br><p><img src="https://habrastorage.org/webt/gn/5u/wt/gn5uwtgsl9-jylmg8vx2--hljtk.png"></p><br><p> 真正的数据说学家和机器语言学家喜欢<em>Jupyter</em> 。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">在这里，您可以查看</a>安装情况，并找到俄语独立作业的互动课程，以进行独立学习（指向原始教程的链接和该语言的指南）。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">在这里，您可以了解</a>如何使用Jupyter Notebook。 </p><br><div class="spoiler">  <b class="spoiler_title">如果安装有问题</b> <div class="spoiler_text"><ul><li> 无法建立连接-检查您的访问权限（您是否有写C：\文件夹的限制，以admin身份登录或以管理员模式启动Julia），如果使用代理，请<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">确保</a>不仅为浏览器配置了该代理 </li><li> 有些软件包在文件路径中不喜欢西里尔字母，因此由于俄语中的用户名，我遇到了很多问题 </li><li> 如果<em>Interact</em>软件包不显示结果，则可能是<em>WebIO</em>安装不正确，可以修复此问题。 <br><pre><code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#]add WebIO using WebIO jup = WebIO.find_jupyter_cmd() WebIO.install_jupyter_nbextension( jup )</span></span></code> </pre> </li><li> 为了使某些软件包在Windows上正常工作，必须在环境变量中输入Julia和Jupyter的路径。 </li></ul><br><p><img src="https://habrastorage.org/webt/6f/do/c0/6fdoc0hwjk1dzyjle92qvbeallw.png"></p><br><p>  <em>计算机/系统属性/高级系统参数/环境变量/路径</em> （如果未创建，则创建）并将路径添加到<em>julia.exe</em> <br> 示例<em>C：\ Users \ User \ AppData \ Local \ Julia-1.2.0 \ bin</em> <br> 如果Path已经有值，则用分号将它们分开。 <br> 现在，如果您将<code>julia</code>驱动到命令控制台（ <em>cmd</em> ），解释器将启动。 </p></div></div><br><p> 安装完所需的一切后，您可以立即下载所需的软件包。 在<em>REPL</em>或<em>Jupyter中</em>输入命令 </p><br><div class="spoiler">  <b class="spoiler_title">代号</b> <div class="spoiler_text"><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Pkg pkgs = [<span class="hljs-string"><span class="hljs-string">"Plots"</span></span>, <span class="hljs-string"><span class="hljs-string">"TextParse"</span></span>, <span class="hljs-string"><span class="hljs-string">"CSV"</span></span>, <span class="hljs-string"><span class="hljs-string">"DataFrames"</span></span>, <span class="hljs-string"><span class="hljs-string">"ImageMagick"</span></span>, <span class="hljs-string"><span class="hljs-string">"Images"</span></span>, <span class="hljs-string"><span class="hljs-string">"Interact"</span></span>, <span class="hljs-string"><span class="hljs-string">"Flux"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pkgs Pkg.add(p) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pkgs Pkg.build(p) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </div></div><br><p> 学习了该语言的基础知识（使用数组，创建函数，下载程序包，绘制图表）之后，您可以继续阅读后续材料。 </p><br><h2 id="zagruzka-i-obrabotka-dannyh"> 数据加载与处理 </h2><br><p> 收集和组织数据是另一种艺术。 关于Julia，网络上有很多过时的资料，但是首先您可以尝试<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">上面的教程</a> ，并且要进行更彻底的研究，请阅读《 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">Julia的数据科学》</a> <em>（在公共领域）</em> </p><br><p> 今天，也许，我们将使用已经准备好的数据：来自大量不同角度的大量水果照片的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">数据集</a> -谁想要新鲜水果？ </p><br><p><img src="https://habrastorage.org/webt/he/o_/hd/heo_hdfdv1jiz0sntcoxqojspkm.gif"><img src="https://habrastorage.org/webt/w2/sw/x4/w2swx4kqoziruwltludlazpaqq0.gif"></p><br><p> 实际上这是任务-我们将教神经网络区分苹果和香蕉！ </p><br><p> 首先，上传一些测试图像： </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Images fnames = [ <span class="hljs-string"><span class="hljs-string">"data/10_100.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"data/107_100.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"data/yellow_apple_2.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"data/8_100.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"data/104_100.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"data/3_100.jpg"</span></span> ] <span class="hljs-comment"><span class="hljs-comment">#   fruits = [load(fname) for fname in fnames] hcat(fruits...) #    </span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/w9/x1/xf/w9x1xfa1ptnxaevprjptnj0zubs.png"></p><br><p> 图片中的对象之间有何不同？ 首先是形式，其次是颜色，然后是纹理和其他属性。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图像分析</a>本身<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">就是</a>一个有趣的话题，不仅可以通过神经元进行分类，而且还可以通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">小波进行分类</a> 。 我们将从最简单的符号-颜色开始。 </p><br><p> 如您所知，图像以阵列的形式存储在计算机内存中，在我们的例子中，这些矩阵是矩阵，每个单元包含三个数字，表示图像每个像素中红色，绿色和蓝色的数量。 让我们看看这些图像中每种颜色的平均数量： </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Statistics: mean M1 = [ mean(float.(c.(img))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c = [red,green,blue], img = fruits ] <span class="hljs-number"><span class="hljs-number">3</span></span>×<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float32</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">0.570278</span></span> <span class="hljs-number"><span class="hljs-number">0.652852</span></span> <span class="hljs-number"><span class="hljs-number">0.977111</span></span> <span class="hljs-number"><span class="hljs-number">0.835252</span></span> <span class="hljs-number"><span class="hljs-number">0.903998</span></span> <span class="hljs-number"><span class="hljs-number">0.842564</span></span> <span class="hljs-number"><span class="hljs-number">0.338118</span></span> <span class="hljs-number"><span class="hljs-number">0.468729</span></span> <span class="hljs-number"><span class="hljs-number">0.950773</span></span> <span class="hljs-number"><span class="hljs-number">0.806882</span></span> <span class="hljs-number"><span class="hljs-number">0.880692</span></span> <span class="hljs-number"><span class="hljs-number">0.755442</span></span> <span class="hljs-number"><span class="hljs-number">0.322406</span></span> <span class="hljs-number"><span class="hljs-number">0.379424</span></span> <span class="hljs-number"><span class="hljs-number">0.835212</span></span> <span class="hljs-number"><span class="hljs-number">0.707626</span></span> <span class="hljs-number"><span class="hljs-number">0.799643</span></span> <span class="hljs-number"><span class="hljs-number">0.761916</span></span></code> </pre> <br><p> 我们仔细看看第一行-麻烦您吗？ 黄色的苹果和香蕉比布雷本品种的苹果要红！ 怎么这样？！ 来吧，补个酸味矿山，也许是小学生正在阅读本教程，或者是芭蕾舞和拖拉机学院的年轻学生。 因此，我们将努力避免遗漏。 事实是每张图片的背景都是白色，并且以<em>RGB</em>表示法由值（1,1,1）表示。 而且，由于3个破折号图像中还有6个背景，加上香蕉的颜色和黄色的苹果也包含红色，因此可以看出前两张照片都变成了红色。 为了清楚起见，我们将图像分为基本颜色： </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> tweaking(img) R = colorview( RGB, red.(img),zeroarray,zeroarray ) G = colorview( RGB, zeroarray,green.(img),zeroarray ) B = colorview( RGB, zeroarray,zeroarray, blue.(img) ) [R; G; B] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> tweaking( hcat(fruits...) )</code> </pre> <br><p><img src="https://habrastorage.org/webt/00/yq/b4/00yqb4o9gdjnn8qlxu9-vfqvsxe.png"></p><br><p> 您听说过神秘的单词“ basis”吗？ 因此，可以说这些图像以<em>RGB为</em>基础进行布局。 越黑-某种颜色就越少，而且正如我们所期望的那样，背景及其丰富程度使得平均值计算很嘈杂。 删除它。 </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> remove_background(img) mtrx = copy( channelview(img) ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:size(mtrx, <span class="hljs-number"><span class="hljs-number">2</span></span>), j = <span class="hljs-number"><span class="hljs-number">1</span></span>:size(mtrx, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> reduce(&amp;, mtrx[:,i,j] .&gt; [<span class="hljs-number"><span class="hljs-number">0.8</span></span>, <span class="hljs-number"><span class="hljs-number">0.8</span></span>, <span class="hljs-number"><span class="hljs-number">0.8</span></span>]) <span class="hljs-comment"><span class="hljs-comment">#   -  mtrx[:,i,j] .= [0.5, 0.5, 0.5] end end colorview(RGB, mtrx) end greyfruits = remove_background.(fruits)</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/vh/o5/n5/vho5n5bm-zbwltfx2-t3x1yeqwy.png"></p><br><pre> <code class="julia hljs">M3 = [ mean(float.(c.(img))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c = [red,green,blue], img = greyfruits ] <span class="hljs-number"><span class="hljs-number">3</span></span>×<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">Float32</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>}: <span class="hljs-number"><span class="hljs-number">0.451008</span></span> <span class="hljs-number"><span class="hljs-number">0.532696</span></span> <span class="hljs-number"><span class="hljs-number">0.578967</span></span> <span class="hljs-number"><span class="hljs-number">0.527727</span></span> <span class="hljs-number"><span class="hljs-number">0.52849</span></span> <span class="hljs-number"><span class="hljs-number">0.500276</span></span> <span class="hljs-number"><span class="hljs-number">0.218805</span></span> <span class="hljs-number"><span class="hljs-number">0.348609</span></span> <span class="hljs-number"><span class="hljs-number">0.552679</span></span> <span class="hljs-number"><span class="hljs-number">0.499192</span></span> <span class="hljs-number"><span class="hljs-number">0.505136</span></span> <span class="hljs-number"><span class="hljs-number">0.412946</span></span> <span class="hljs-number"><span class="hljs-number">0.203528</span></span> <span class="hljs-number"><span class="hljs-number">0.260142</span></span> <span class="hljs-number"><span class="hljs-number">0.439354</span></span> <span class="hljs-number"><span class="hljs-number">0.400631</span></span> <span class="hljs-number"><span class="hljs-number">0.424784</span></span> <span class="hljs-number"><span class="hljs-number">0.419291</span></span></code> </pre> <br><p> 每个物体所占面积的差异仍在影响，但总的来说，可以得出结论，香蕉是绿色（ <em>和蓝色</em> ）苹果。 这将是评估标准，即-一个标志。 现在，让我们看一下其余的图片： </p><br><pre> <code class="julia hljs">pth = <span class="hljs-string"><span class="hljs-string">"C:\\Users\\User\\Desktop\\Banana"</span></span> <span class="hljs-comment"><span class="hljs-comment"># Apple Braeburn fnames = readdir(pth)[1:300] 300-element Array{String,1}: "0_100.jpg" "104_100.jpg" "107_100.jpg" "10_100.jpg" "112_100.jpg" "117_100.jpg" "118_100.jpg" "119_100.jpg" ...</span></span></code> </pre> <br><p> 对于每幅图像，我们中和背景的影响，找到每种颜色的平均数量，同时记住图像尺寸... </p><br><pre> <code class="julia hljs">dataz = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fname <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> fnames img_i = load(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pth</span></span></span><span class="hljs-string">\\</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$fname</span></span></span><span class="hljs-string">"</span></span>) gbimg = remove_background(img_i) colorz = [ mean(c.(gbimg)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c = [red,green,blue] ] inform = [size(gbimg, <span class="hljs-number"><span class="hljs-number">1</span></span>) size(gbimg, <span class="hljs-number"><span class="hljs-number">2</span></span>) colorz' ] push!(dataz, inform) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> dataz</code> </pre> <br><p>  ...然后您可以将我们的数据安排在便于工作的结构中-数据框： </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DataFrames, CSV banans = DataFrame( vcat(dataz...), [:height, :width, :red, :green, :blue] ) CSV.write(<span class="hljs-string"><span class="hljs-string">"data/bananas.csv"</span></span>, banans) <span class="hljs-comment"><span class="hljs-comment">#   </span></span></code> </pre> <br><pre> <code class="julia hljs">apples = CSV.read(<span class="hljs-string"><span class="hljs-string">"data/Apple_Braeburn.csv"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#    banans = CSV.read("data/bananas.csv")</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/jv/t0/r4/jvt0r4gof-zy59zx49uufd4mez8.png"></p><br><pre> <code class="julia hljs">Desc = describe(apples, :all) <span class="hljs-comment"><span class="hljs-comment">#     </span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/q4/rp/gn/q4rpgncqcaehm3wwbqktiltgd5c.png"></p><br><p> 尝试理解<code>describe()</code>函数提供的数据，并与类似的香蕉表进行比较。 那么，没有图形可以进行什么样的数据分析？ </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> plot2features(clr) x_apples = apples[:, :green] x_banans = banans[:, :green] y_apples = apples[:, clr] y_banans = banans[:, clr] scatter(x_apples, y_apples, lab = <span class="hljs-string"><span class="hljs-string">"apples"</span></span>, colour = :red) scatter!(x_banans, y_banans, lab = <span class="hljs-string"><span class="hljs-string">"bananas"</span></span>, legend = :topleft, colour = :yellow) hline!([mean(y_apples), mean(y_banans) ], lab = <span class="hljs-string"><span class="hljs-string">""</span></span> ) vline!([mean(x_apples), mean(x_banans) ], lab = <span class="hljs-string"><span class="hljs-string">""</span></span> ) xaxis!(<span class="hljs-string"><span class="hljs-string">"green"</span></span>) yaxis!(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$clr</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> plot2features(:red)</code> </pre> <br><p><img src="https://habrastorage.org/webt/uy/tj/1c/uytj1cqvwomelfrfh39cfkbyyxc.png"></p><br><pre> <code class="julia hljs">plot2features(:blue)</code> </pre> <br><p><img src="https://habrastorage.org/webt/yx/vg/md/yxvgmdgdk9yvynm5ehvdna9lr8s.png"></p><br><p> 香蕉中段红色的价值与苹果中段非常接近。 但是在第二张图表上，立即通过两种颜色特征更清楚地追溯了水果的分离。 可以通过正确的重新归一化来改善分离，例如，我们的绿色值从0.2变为0.55，并且如果执行转换， </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-5">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-7">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">c</span><span class="MJXp-mrow" id="MJXp-Span-12"><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-15" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">n</span><span class="MJXp-mrow" id="MJXp-Span-21"><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">x</span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mtext" id="MJXp-Span-27">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">x</span><span class="MJXp-mrow" id="MJXp-Span-31"><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">x</span><span class="MJXp-mrow" id="MJXp-Span-34"><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-37">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">n</span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">x</span><span class="MJXp-mrow" id="MJXp-Span-44"><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.555ex" height="2.78ex" viewBox="0 -780.1 20905.5 1197.1" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2032" x="809" y="445"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="809" y="-430"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3D" x="1194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-66" x="2500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-72" x="3051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="3502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-63" x="4032" y="0"></use><g transform="translate(4465,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2212" x="1139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="2389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="3268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6E" x="3613" y="0"></use><g transform="translate(4214,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="5044" y="0"></use><g transform="translate(5616,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g><g transform="translate(10912,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="1658" y="0"></use><g transform="translate(2230,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="3060" y="0"></use><g transform="translate(3632,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2212" x="4685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="5935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="6814" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6E" x="7159" y="0"></use><g transform="translate(7760,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="8590" y="0"></use><g transform="translate(9162,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> x_i'= \ frac {x_i-\ min（x）} {\ max（x）-\ min（x）} </script></p><br><p> 然后我们将数据重新缩放为[0,1]，这将增加这些之间的差距 <del> 堆 </del> 点簇。 </p><br><h2 id="perceptron"> 感知器 </h2><br><p> 分类任务包括定义模型和选择参数，针对这些参数，各种数据将唯一地接收对它们属于特定类别的评估。 简而言之，我们需要引入某个函数并设置其参数，以便将我们的苹果与香蕉分开。 </p><br><p><img src="https://habrastorage.org/webt/75/xv/pv/75xvpv74ihdpledw77bounqhgnu.gif"></p><br><p> 为此目的，最著名和最受欢迎的模型是1940年代初开发的McCulloch-Pitts人工神经元。 随后，弗兰克·罗森布拉特（Frank Rosenblatt）提出了<em>训练有素的</em>神经网络-感知器。 不难找到关于神经网络的全面解释，包括在此资源上（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，针对初学者</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的神经网络，在图像识别中使用神经网络</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">神经网络，基本操作原理，种类和拓扑结构</a> ） </p><br><p> 选择S型作为激活函数并根据其输出设置分类对象（水果）的输出 </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-46"><span class="MJXp-mtext" id="MJXp-Span-47">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">a</span><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">x</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">w</span><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">b</span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-63"><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-66">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">c</span><span class="MJXp-mrow" id="MJXp-Span-71"><span class="MJXp-mn" id="MJXp-Span-72">1</span></span><span class="MJXp-mrow" id="MJXp-Span-73"><span class="MJXp-mn" id="MJXp-Span-74">1</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-76">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">p</span><span class="MJXp-mrow" id="MJXp-Span-80"><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">x</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">b</span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.695ex" height="2.419ex" viewBox="0 -780.1 21827 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="2424" y="0"></use><g transform="translate(2953,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="3783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3B" x="4355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="4801" y="0"></use><g transform="translate(5517,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="6347" y="0"></use><g transform="translate(6777,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(7607,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">：</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3D" x="8714" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-66" x="10021" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-72" x="10571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="11023" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-63" x="11552" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-31" x="11986" y="0"></use><g transform="translate(12486,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2B" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-65" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="2439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-70" x="3012" y="0"></use><g transform="translate(3515,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2212" x="4568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="5568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="6285" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2B" x="7080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="8080" y="0"></use><g transform="translate(8510,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ sigma（x; w，b）：= \ frac {1} {1 + \ exp（-wx + b）} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">x</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-92">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">m</span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mrow" id="MJXp-Span-100"><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span><span class="MJXp-mrow" id="MJXp-Span-102"><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.278em; margin-right: 0.278em;">据</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.402ex" height="2.298ex" viewBox="0 -780.1 7492.5 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="2156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="3035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-74" x="3564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-68" x="3926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-72" x="4502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="4954" y="0"></use><g transform="translate(5832,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">数</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">据</text></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> x = \ mathrm {数据} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-104"><span class="MJXp-mtext" id="MJXp-Span-105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">a</span><span class="MJXp-mrow" id="MJXp-Span-111"><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">x</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">w</span><span class="MJXp-mrow" id="MJXp-Span-116"><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">b</span><span class="MJXp-mrow" id="MJXp-Span-119"><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-121" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-122"><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mn" id="MJXp-Span-124">0</span><span class="MJXp-mtext" id="MJXp-Span-125" style="color: red;">\暗</span><span class="MJXp-mrow" id="MJXp-Span-126"><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0.278em; margin-right: 0.278em;">含</span></span><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">m</span><span class="MJXp-mrow" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">e</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.33ex" height="2.66ex" viewBox="0 -832 18656.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="2424" y="0"></use><g transform="translate(2953,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="3783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3B" x="4355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="4801" y="0"></use><g transform="translate(5517,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="6347" y="0"></use><g transform="translate(6777,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g fill="red" stroke="red" transform="translate(7607,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">大</text></g></g><g transform="translate(8937,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">约</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-30" x="9767" y="0"></use><g fill="red" stroke="red" transform="translate(10268,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">暗</text></g></g><g transform="translate(11598,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">含</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="12678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="13557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-74" x="14086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-68" x="14448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-72" x="15024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="15476" y="0"></use><g transform="translate(16354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-70" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-70" x="1033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6C" x="1536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-65" x="1835" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ sigma（x; w，b）\大约0 \暗含\ mathrm {apple} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-141"><span class="MJXp-mtext" id="MJXp-Span-142">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">a</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">x</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">w</span><span class="MJXp-mrow" id="MJXp-Span-153"><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">b</span><span class="MJXp-mrow" id="MJXp-Span-156"><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-158" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mn" id="MJXp-Span-161">1</span><span class="MJXp-mtext" id="MJXp-Span-162" style="color: red;">\暗</span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.278em; margin-right: 0.278em;">含</span></span><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">m</span><span class="MJXp-mrow" id="MJXp-Span-172"><span class="MJXp-mrow" id="MJXp-Span-173"><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.278em; margin-right: 0.278em;">香</span></span><span class="MJXp-mrow" id="MJXp-Span-175"><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.278em; margin-right: 0.278em;">蕉</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.84ex" height="2.66ex" viewBox="0 -832 18014.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="2424" y="0"></use><g transform="translate(2953,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="3783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3B" x="4355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="4801" y="0"></use><g transform="translate(5517,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="6347" y="0"></use><g transform="translate(6777,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g fill="red" stroke="red" transform="translate(7607,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">大</text></g></g><g transform="translate(8937,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">约</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-31" x="9767" y="0"></use><g fill="red" stroke="red" transform="translate(10268,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">暗</text></g></g><g transform="translate(11598,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">含</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="12678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-61" x="13557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-74" x="14086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-68" x="14448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-72" x="15024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-6D" x="15476" y="0"></use><g transform="translate(16354,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">香</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">蕉</text></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ sigma（x; w，b）\大约1 \暗含\ mathrm {香蕉} </script></p><br><p> 选择这样的参数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.435ex" height="2.057ex" viewBox="0 -780.1 1048.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-57" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> W </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> b </script> 这样，接收到的数据的S形输出值便与上述符号相对应 </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Interact sigmo(x,w,b) = <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">1</span></span> + exp(-w*x+b)) r_apples, g_apples, b_apples = apples[:, :red], apples[:, :green], apples[:, :blue] r_banans, g_banans, b_banans = banans[:, :red], banans[:, :green], banans[:, :blue]; <span class="hljs-meta"><span class="hljs-meta">@manipulate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">60</span></span>, b <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> -<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span> plot(x-&gt;sigmo(x,w,b), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, label=<span class="hljs-string"><span class="hljs-string">"Model"</span></span>, legend = :topleft, lw=<span class="hljs-number"><span class="hljs-number">3</span></span>) scatter!(g_apples[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>], zeros(<span class="hljs-number"><span class="hljs-number">10</span></span>), label=<span class="hljs-string"><span class="hljs-string">"Apple"</span></span>, colour = :red) scatter!(g_banans[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>], ones(<span class="hljs-number"><span class="hljs-number">10</span></span>), label=<span class="hljs-string"><span class="hljs-string">"Banana"</span></span>, colour = :yellow) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/ut/dg/s7/utdgs7rtvik2vd5s18phrjfpfca.gif"></p><br><pre> <code class="julia hljs">foon(x) = sigmo(x,<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>) plot(foon, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, label=<span class="hljs-string"><span class="hljs-string">"Model"</span></span>, legend = :topleft, lw=<span class="hljs-number"><span class="hljs-number">3</span></span>) scatter!(foon, g_apples, label=<span class="hljs-string"><span class="hljs-string">"Apple"</span></span>, colour = :red) scatter!(foon, g_banans, label=<span class="hljs-string"><span class="hljs-string">"Banana"</span></span>, colour = :yellow) xaxis!(<span class="hljs-string"><span class="hljs-string">"green"</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/webt/60/0a/tm/600atmdpbbjlzfknf1mcgp8mx34.png"></p><br><p> 我们手动教了一个神经元，以绿色来区分苹果和香蕉。 </p><br><p> 自然，人们希望实现这一过程的自动化。 我们介绍<em>损失函数</em> </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">L</span><span class="MJXp-mrow" id="MJXp-Span-183"><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">w</span><span class="MJXp-mrow" id="MJXp-Span-186"><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">b</span><span class="MJXp-mrow" id="MJXp-Span-189"><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-192"><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-194">0</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-196"><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">σ</span></span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-202" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-203"><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">w</span><span class="MJXp-mrow" id="MJXp-Span-206"><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">b</span><span class="MJXp-mrow" id="MJXp-Span-209"><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mrow" id="MJXp-Span-212" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-214" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-216"><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-218">1</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-220"><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">σ</span></span><span class="MJXp-mrow" id="MJXp-Span-222"><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">w</span><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">b</span><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-235"><span class="MJXp-mrow" id="MJXp-Span-236" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-238" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.959ex" height="2.78ex" viewBox="0 -987.6 26676.8 1197.1" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-4C" x="0" y="0"></use><g transform="translate(681,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="1511" y="0"></use><g transform="translate(2227,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="3057" y="0"></use><g transform="translate(3487,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-3D" x="4595" y="0"></use><g transform="translate(5651,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-30" x="6481" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2212" x="7204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-3C3" x="8204" y="0"></use><g transform="translate(8776,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(9606,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-31" x="809" y="-213"></use></g><g transform="translate(10632,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="11462" y="0"></use><g transform="translate(12179,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="13009" y="0"></use><g transform="translate(13438,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(14268,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-32" x="1173" y="640"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2B" x="15774" y="0"></use><g transform="translate(16775,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-31" x="17605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-2212" x="18328" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-3C3" x="19329" y="0"></use><g transform="translate(19900,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(20730,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-32" x="809" y="-213"></use></g><g transform="translate(21756,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-77" x="22586" y="0"></use><g transform="translate(23303,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMATHI-62" x="24133" y="0"></use><g transform="translate(24562,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(25392,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/474084/&amp;usg=ALkJrhjwZSFyCFHi2LwJqJB20ov-wXJ9Sw#MJMAIN-32" x="1173" y="640"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> L（w，b）=（0-σ（x_1，w，b））^ 2 +（1-σ（x_2，w，b））^ 2 </script></p><br><p> 现在，学习过程将包括<em>最小化</em>此功能： </p><br><div class="spoiler">  <b class="spoiler_title">代号</b> <div class="spoiler_text"><pre> <code class="julia hljs">apples_mean_green = mean(g_apples) banans_mean_green = mean(g_banans) L(w, b) = (<span class="hljs-number"><span class="hljs-number">0</span></span> - sigmo(apples_mean_green,w,b))^<span class="hljs-number"><span class="hljs-number">2</span></span> + (<span class="hljs-number"><span class="hljs-number">1</span></span> - sigmo(banans_mean_green,w,b))^<span class="hljs-number"><span class="hljs-number">2</span></span> w_range = <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">0.5</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span> b_range = <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0.5</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span> L_values = [L(w,b) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> b_range, w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> w_range] <span class="hljs-meta"><span class="hljs-meta">@manipulate</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> w_range, b <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> b_range p1 = surface(w_range, b_range, L_values, xlabel=<span class="hljs-string"><span class="hljs-string">"b"</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">"w"</span></span>, cam=(<span class="hljs-number"><span class="hljs-number">80</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>), cbar=<span class="hljs-literal"><span class="hljs-literal">false</span></span>, leg=<span class="hljs-literal"><span class="hljs-literal">false</span></span>) scatter!(p1, [w], [b], [L(w,b)+<span class="hljs-number"><span class="hljs-number">1e-2</span></span>], markersize=<span class="hljs-number"><span class="hljs-number">5</span></span>, color = :blue) p2 = plot(x-&gt;sigmo(x,w,b), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, label=<span class="hljs-string"><span class="hljs-string">"Model"</span></span>, legend = :topleft, lw=<span class="hljs-number"><span class="hljs-number">3</span></span>) scatter!(p2, [apples_mean_green], [<span class="hljs-number"><span class="hljs-number">0.0</span></span>], label=<span class="hljs-string"><span class="hljs-string">"Apple"</span></span>, markersize=<span class="hljs-number"><span class="hljs-number">10</span></span>) scatter!(p2, [banans_mean_green], [<span class="hljs-number"><span class="hljs-number">1.0</span></span>], label=<span class="hljs-string"><span class="hljs-string">"Banana"</span></span>, markersize=<span class="hljs-number"><span class="hljs-number">10</span></span>, xlim=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>), ylim=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) plot(p1, p2, layout=(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/nw/vu/kd/nwvukdq6p3d9yg4n6mvud-ccaqo.gif"></p><br><p> 之前我们研究<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了Julia的软件包，</a>这些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">软件包</a>允许通过各种方法解决优化问题。 幸运的是，基本要素已经在Flux环境中！ </p><br><h3 id="flux"> 助焊剂 </h3><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Flux</code> </pre> <br><p> 首先，我们以易于理解的形式提供训练数据： </p><br><pre> <code class="julia hljs">Y = [zeros(length(g_apples)); ones(length(g_banans)) ] |&gt; permutedims X = [g_apples; g_banans] |&gt; permutedims; <span class="hljs-comment"><span class="hljs-comment">#   -   # dataz = repeated((X, Y), 20)</span></span></code> </pre> <br><p> 接下来的顺序： </p><br><ul><li> 我们通过将输入数据与有关这些数据分类的正确答案相结合来创建训练数据集 </li><li> 我们<em>通过</em>随机值矩阵设置参数<em>W</em>和<em>b</em> （输入处有一个符号，输出处有一个符号，所以矩阵的大小为<em>1 x 1</em> ） </li><li> 作为模型，我们设置一个<em>致密层</em> -具有S型激活功能的感知器 </li><li> 我们设置损失函数-平方差的总和（您仍然可以使用更流行的<code>Flux.crossentropy()</code> ） </li><li> 作为一种优化方法，我们选择<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">梯度下降</a> 。 它需要一个参数-下降速度 </li><li> 我们设置了一个评估函数，该函数将对模型输出的值进行取整并将它们与正确答案进行比较。 </li><li> 并打印我们未经训练的模型的参数 </li></ul><br><pre> <code class="julia hljs">dataz = [(X, Y)] W = param(rand(<span class="hljs-number"><span class="hljs-number">1</span></span>)) b = param(rand(<span class="hljs-number"><span class="hljs-number">1</span></span>)) model = Dense(W, b, σ) loss(x, y) = mse(model(x), y) opt = Descent(<span class="hljs-number"><span class="hljs-number">0.1</span></span>) accuracy(x, y) = mean( round.(model(x)) .== y ) params(model) Params([[<span class="hljs-number"><span class="hljs-number">0.3372841444115968</span></span>] (tracked), [<span class="hljs-number"><span class="hljs-number">0.8430399003786011</span></span>] (tracked)])</code> </pre> <br><p> 让我们看看损失函数对我们的数据的输出。 </p><br><pre> <code class="julia hljs">loss(X, Y) <span class="hljs-comment"><span class="hljs-comment">#  ,   0.310845210182773 (tracked)</span></span></code> </pre> <br><p> 并检查评估功能的结果 </p><br><pre> <code class="julia hljs">accuracy(X, Y) <span class="hljs-number"><span class="hljs-number">0.5</span></span></code> </pre> <br><p> 结果是很自然的-输出相当均匀地分布，并且一半的数据被正确分类： </p><br><div class="spoiler">  <b class="spoiler_title">代号</b> <div class="spoiler_text"><pre> <code class="julia hljs">modeldataz(x) = x |&gt; model |&gt; data |&gt; permutedims <span class="hljs-comment"><span class="hljs-comment"># modeldataz(x) = permutedims(data(model(x)))</span></span></code> </pre> <br><pre> <code class="julia hljs">modelX = modeldataz(X) modelapples = modeldataz(g_apples') modelbanans = modeldataz(g_banans') plot(modelX, legend = <span class="hljs-literal"><span class="hljs-literal">false</span></span>) hline!([<span class="hljs-number"><span class="hljs-number">0.5</span></span>]) p1 = yaxis!((<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) curv = [-<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">0.01</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>;]' |&gt; modeldataz plot( [-<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">0.01</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>;], curv, label=<span class="hljs-string"><span class="hljs-string">"Model"</span></span>, legend = :topleft, lw=<span class="hljs-number"><span class="hljs-number">3</span></span>) scatter!(g_apples, modelapples, label=<span class="hljs-string"><span class="hljs-string">"Apple"</span></span>, colour = :red) scatter!(g_banans, modelbanans, label=<span class="hljs-string"><span class="hljs-string">"Banana"</span></span>,colour = :yellow) hline!([<span class="hljs-number"><span class="hljs-number">0.5</span></span>], lab = <span class="hljs-string"><span class="hljs-string">""</span></span>, legend = :topleft) p2 = xaxis!(<span class="hljs-string"><span class="hljs-string">"green"</span></span>) plot(p1, p2)</code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/wp/c8/et/wpc8etwvnofdq2kxoieumwpfq6a.png"></p><br><p> 让我们开始吧：这很简单。 您只需要对神经网络大喊：“训练！”，同时指出要训练的内容和减少的内容，她将完成一个训练课程。 因此，我们将强迫她放弃一切，但不要狂热，以免<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">再培训。</a> </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">7000</span></span> train!(loss, params(model), dataz, opt) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> model.W, model.b ([<span class="hljs-number"><span class="hljs-number">9.578663260720564</span></span>] (tracked), [-<span class="hljs-number"><span class="hljs-number">3.7540362587506464</span></span>] (tracked))</code> </pre> <br><p> 损失变得更少了： </p><br><pre> <code class="julia hljs">loss(X, Y) <span class="hljs-number"><span class="hljs-number">0.09152783090457564</span></span> (tracked)</code> </pre> <br><p> 评分较好： </p><br><pre> <code class="julia hljs">accuracy(X, Y) <span class="hljs-number"><span class="hljs-number">1.0</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/bj/br/n3/bjbrn3lluxoj31k8xcmqxommwdc.png"></p><br><p> 数据被分割，进一步的训练将使模型的功能更加垂直。 在第一批水果上检查经过训练的模型： </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> classifier(img) gbimg = remove_background(img) greenmean = mean(float.(green.(gbimg))) answ = data( model( [ greenmean ]' ) )[<span class="hljs-number"><span class="hljs-number">1</span></span>] fr = answ &gt; <span class="hljs-number"><span class="hljs-number">0.5</span></span> ? <span class="hljs-string"><span class="hljs-string">"Banana"</span></span> : <span class="hljs-string"><span class="hljs-string">"Apple"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$fr</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$(round(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">200</span></span></span></span><span class="hljs-string"><span class="hljs-subst">abs(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">0.5</span></span></span></span><span class="hljs-string"><span class="hljs-subst">-answ)</span></span></span><span class="hljs-string">))%"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> hcat(fruits...)</code> </pre> <br><p><img src="https://habrastorage.org/webt/w9/x1/xf/w9x1xfa1ptnxaevprjptnj0zubs.png"></p><br><pre> <code class="julia hljs">classifier.(fruits) <span class="hljs-number"><span class="hljs-number">6</span></span>-element <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>}: <span class="hljs-string"><span class="hljs-string">"Apple 68.0%"</span></span> <span class="hljs-string"><span class="hljs-string">"Apple 20.0%"</span></span> <span class="hljs-string"><span class="hljs-string">"Banana 65.0%"</span></span> <span class="hljs-string"><span class="hljs-string">"Banana 47.0%"</span></span> <span class="hljs-string"><span class="hljs-string">"Banana 49.0%"</span></span> <span class="hljs-string"><span class="hljs-string">"Banana 10.0%"</span></span></code> </pre> <br><p> 当然，不能正确地识别出特制的黄色苹果，并且红色香蕉几乎没有进入其类别。 但是神经元从图片中只得到一个数字-平均绿色。 您可以添加另一个符号，例如蓝色，这将使模型更具适应性。 </p><br><p><img src="https://habrastorage.org/webt/qu/yd/xh/quydxhdullq7bho7iicmrraf5rk.png"></p><br><p> 或者，您不能使用RGB表示，而可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">HSV</a> （色相，饱和度，值），其中<em>色相</em>通道将包含有关图像颜色的信息。 </p><br><p> 神经网络的全部乐趣在于它们本身可以区分有时不是很明显的特征（颜色相关性，它们的分布，轮廓和曲线...），并且您可以借助特殊的启发式方法和技术来帮助它们，从而将神经网络的工作变成真实的艺术。 </p><br><p><img src="https://habrastorage.org/webt/ea/zz/g7/eazzg7inp28p1osmj25fc6e1mgo.jpeg"></p><br><p> 这样领导才能不会增长太多 <del> 并做了一系列太懒的文章 </del> 让我们还给出一个用手写数字对图片进行分类的示例，感兴趣的读者将自己将获得的知识概括为带有水果的图像，并创建自己的神经网络，该网络能够对静物中的物体进行标记！ </p><br><h3 id="mnist">  Mnist </h3><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Images <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Flux, Flux.Data.MNIST, Statistics <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Flux: onehotbatch, onecold, crossentropy, throttle <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Base.Iterators: repeated <span class="hljs-comment"><span class="hljs-comment"># using CuArrays # Classify MNIST digits with a simple multi-layer-perceptron imgs = MNIST.images() # Stack images into one large batch X = hcat(float.(reshape.(imgs, :))...); hcat(imgs[1:10]...)</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/0t/be/fn/0tbefnsogwh6gohw1ww-zg7csai.png"></p><br><p> 一个有趣的例子是已经有十个出口。 所谓的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">One-hot</a>向量在这里派上用场。 </p><br><pre> <code class="julia hljs">labels = MNIST.labels() <span class="hljs-comment"><span class="hljs-comment"># One-hot-encode the labels Y = onehotbatch(labels, 0:9)</span></span></code> </pre> <br><pre> <code class="julia hljs"><span class="hljs-number"><span class="hljs-number">10</span></span>×<span class="hljs-number"><span class="hljs-number">60000</span></span> Flux.OneHotMatrix{<span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>{Flux.OneHotVector,<span class="hljs-number"><span class="hljs-number">1</span></span>}}: <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> … <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> … <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p> 我们将神经元链定义为模型， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">交叉熵</a>将成为损失函数，而<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">亚当</a>作为优化方法： </p><br><pre> <code class="julia hljs">m = Chain( Dense(<span class="hljs-number"><span class="hljs-number">28</span></span>^<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, relu), Dense(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), softmax) loss(x, y) = crossentropy(m(x), y) accuracy(x, y) = mean(onecold(m(x)) .== onecold(y)) dataset = repeated((X, Y), <span class="hljs-number"><span class="hljs-number">20</span></span>) evalcb = () -&gt; <span class="hljs-meta"><span class="hljs-meta">@show</span></span>(loss(X, Y)) opt = ADAM()</code> </pre> <br><p> 以备用模式训练，但每10秒打印出一次损失： </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span> Flux.train!(loss, params(m), dataset, opt, cb = throttle(evalcb, <span class="hljs-number"><span class="hljs-number">10</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-comment"><span class="hljs-comment">#   ...</span></span></code> </pre> <br><pre> <code class="julia hljs">accuracy(X, Y) <span class="hljs-number"><span class="hljs-number">0.64545</span></span></code> </pre> <br><p> 并检查训练中未使用的数据 </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment"># Test set accuracy tX = hcat(float.(reshape.(MNIST.images(:test), :))...) tY = onehotbatch(MNIST.labels(:test), 0:9) accuracy(tX, tY) 0.6488</span></span></code> </pre> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">更多网络架构示例</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow">具有今天所有列表的Jupiter笔记本电脑</a> </li></ul><br><p>  Julia上的神经网络非常简单，令人兴奋！ 即使没有必要在您的活动领域和机器学习之间寻找联系，您至少也应该感到这种好奇心，它从各个角度都在大声喊叫，并且不会缺少任何工具！ </p><br><p> 所有CPU热量适中！ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN474084/">https://habr.com/ru/post/zh-CN474084/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN474068/index.html">VM还是Docker？</a></li>
<li><a href="../zh-CN474070/index.html">BYOD会议室设备</a></li>
<li><a href="../zh-CN474076/index.html">如何在利基市场上成为世界上最好的</a></li>
<li><a href="../zh-CN474080/index.html">电报bot显示了10种最受欢迎​​的世界期刊的头版</a></li>
<li><a href="../zh-CN474082/index.html">Phonocut-家用黑胶唱片机：关于起飞可能性的思考</a></li>
<li><a href="../zh-CN474088/index.html">我们会尽力保护Windows上的远程服务器</a></li>
<li><a href="../zh-CN474090/index.html">亚美尼亚的开发人员薪水</a></li>
<li><a href="../zh-CN474092/index.html">DUMP Kazan的后端部分：云应用程序架构，传出微服务，DDD等</a></li>
<li><a href="../zh-CN474094/index.html">框图编辑器-关于Vue.js和MxGraph之间的友谊</a></li>
<li><a href="../zh-CN474096/index.html">来自hh.ru用户的流行编程语言2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>