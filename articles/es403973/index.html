<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∑Ô∏è üôãüèΩ üòπ Hogar inteligente, c√≥mo llegu√© a esto. Parte 4 üëÉüèø üë®‚Äçüë®‚Äçüëß‚Äçüë¶ üò≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En las primeras tres partes cont√© c√≥mo tuve la idea (necesidad) de construir una "casa inteligente" y c√≥mo la puse en pr√°ctica. 

 En esta parte, le d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hogar inteligente, c√≥mo llegu√© a esto. Parte 4</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403973/"><img src="https://habrastorage.org/web/673/c21/49a/673c2149a8f545a489d87fdc79f93d38.png" align="right">  En las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primeras</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tres</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">partes</a> cont√© c√≥mo tuve la idea (necesidad) de construir una "casa inteligente" y c√≥mo la puse en pr√°ctica. <br><br>  En esta parte, le dir√© qu√© deficiencias se identificaron durante los cuatro a√±os de operaci√≥n del sistema y qu√© otras cosas √∫tiles logr√© implementar. <br><br>  Bueno, un peque√±o spoiler: debajo del corte habr√° una breve descripci√≥n de "otra artesan√≠a en esp8266 con preferencia y cortesanas". <br><a name="habracut"></a><br>  Han pasado cuatro a√±os (desde que los primeros m√≥dulos estuvieron en funcionamiento, seis en general). En general, el sistema funcion√≥ bien, pero surgieron dos deficiencias, sin embargo, eran bastante esperadas. <br><br>  <b>El primero</b> es la centralizaci√≥n.  S√≠, esto es malo, s√≠, lo sab√≠a, pero no hab√≠a experiencia en la producci√≥n de dispositivos aut√≥nomos finales, y el protocolo 1-Wire elegido como protocolo principal no brind√≥ esa oportunidad. <br><br>  En consecuencia, el servidor central se ha convertido en un cuello de botella.  Cinco veces debido a la falla de la "plancha", todo el sistema no funcion√≥ durante m√°s de un d√≠a (o incluso dos o tres) y tuvo que usar una copia de seguridad (encender las luces con los interruptores de cuchilla en el escudo, sin un piso calentado, ventilaci√≥n, recalibrar medidores de agua, etc. d.) <br><br>  Adem√°s, la casa se convirti√≥ en casos m√°s frecuentes de cortes de energ√≠a durante m√°s de una hora.  El UPS se estaba quedando sin energ√≠a y el servidor realiz√≥ un apagado de emergencia o, m√°s precisamente, se cort√≥ de manera muy brusca.  Despu√©s de eso, su ascenso no siempre fue fluido, principalmente porque a MySQL no le gusta una actitud tan grosera.  Restaurar tablas (y la historia completa de todos los sensores durante muchos a√±os) a veces tom√≥ horas y no siempre fue capaz de hacerlo sin interferencia externa.  S√≠, este problema, en teor√≠a, puede resolverse comprando un UPS m√°s inteligente, conect√°ndolo al servidor y ense√±√°ndole a apagarse correctamente cuando se pierde la energ√≠a.  Pero mi UPS actual todav√≠a es bastante viejo, y la placa base del servidor, por alguna raz√≥n, no quer√≠a funcionar normalmente en el modo, se encendi√≥ autom√°ticamente despu√©s de que se suministrara energ√≠a, si se hab√≠a apagado antes. <br><br>  <b>El segundo</b> es la restricci√≥n en la topolog√≠a del bus 1-Wire + mi inexperiencia. <br><br>  S√≠, le√≠ que deber√≠a haber un tronco central y solo peque√±as ramas, se ha escrito mucho sobre esto.  Pero el proyecto se expandi√≥ de manera bastante impredecible y, al mismo tiempo, todo parec√≠a funcionar.  Y luego, en un momento "maravilloso", dej√≥ de funcionar.  Es decir, apaga algunos de los dispositivos, todo est√° bien, enci√©ndalo nuevamente y la se√±al comienza a "flotar".  Reemplac√© parte de las l√≠neas principales por otras blindadas, ramas minimizadas, pero ya no hay ninguna posibilidad de hacer una sola llanta completa sin un golpe y un da√±o significativo en el acabado.  Como resultado, dividi√≥ la red en dos segmentos, la llev√≥ a dos controladores separados, pero, sin embargo, una vez cada dos meses hubo un problema nuevamente cuando los dispositivos comenzaron a caerse de la red.  Solo ayud√≥ a un apagado completo de todo el sistema con la posterior inclusi√≥n, y este procedimiento no es muy trivial, y sin m√≠ mi tarea no puede llevarlo a cabo. <br><br>  Mientras tanto, hace unos dos a√±os, me encontr√© con un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> y tuve la idea de hacerle una especie de regalo de cumplea√±os a mi padre.  Le gusta reproducir varias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">plantas ex√≥ticas</a> en la parcela y necesita un control constante de la temperatura en diferentes zonas clim√°ticas de su jard√≠n.  En realidad, antes de la introducci√≥n del sistema, esto se hac√≠a evitando los term√≥metros de alcohol anal√≥gicos completamente (tubo caliente :)) dos veces al d√≠a.  Cre√© esta idea durante varios meses, luego orden√© los componentes necesarios en una conocida tienda en l√≠nea china (entonces todav√≠a solo en c√≠rculos estrechos), hice un tablero y escrib√≠ el firmware.  En general, result√≥ de alguna manera as√≠: <br><br>  Todo el sistema est√° alojado en un conector telef√≥nico est√°ndar. <br><br><img src="https://habrastorage.org/web/23e/c8b/463/23ec8b463f9b422690f0450114e8f8bd.jpg"><br><br>  Cableado de cable telef√≥nico de cuatro hilos. <br><br><img src="https://habrastorage.org/web/867/69b/f6a/86769bf6a95c4874b79c0fcef21d21e2.jpg"><br><br>  El poder es pasivo.  Ped√≠ una versi√≥n a prueba de agua del sensor para la piscina. <br><br><img src="https://habrastorage.org/web/a02/cfb/1d2/a02cfb1d2afe484fb4152487770ddf49.jpg"><br><br>  Ahora pap√° est√° mirando la temperatura en la computadora. <br><br>  As√≠: <br><br><img src="https://habrastorage.org/web/bf8/cc2/ac2/bf8cc2ac299d46828efdde149450e16c.png"><br><br>  Bueno, con los gr√°ficos: <br><br><img src="https://habrastorage.org/web/e80/81a/b51/e8081ab518b642d981f137d36f8dd63c.png"><br><br><div class="spoiler">  <b class="spoiler_title">Diagrama del m√≥dulo</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/527/063/d86/527063d865224257a0972905e113a78e.png"></div></div><br>  En el proceso de desarrollo, me gust√≥ mucho este m√≥dulo y comenc√© a pensar en c√≥mo aplicarlo en mi sistema, y ‚Äã‚Äãluego los problemas descritos al principio del art√≠culo cayeron sobre m√≠.  Despu√©s de un par de experimentos con estos chips, comenc√© a desarrollar la placa que ahora ha reemplazado con √©xito el sistema anterior en las tres zonas de mi modesto hogar. <br><br>  Entonces, "esp07_4PIO_6S v2" se presenta a su atenci√≥n. <br><br>  Vista superior: <br><br><img src="https://habrastorage.org/web/bc6/355/f9e/bc6355f9e1d0428dbe96062bfc45255e.jpg"><br><br>  Vista inferior: <br><br><img src="https://habrastorage.org/web/994/af8/090/994af809019345c4825d343ae62f7bee.jpg"><br><br>  La √∫ltima vez que un gran problema fue la selecci√≥n del cuerpo, esta vez bail√© del cuerpo.  Como hubo casos de modelos antiguos del reproductor multimedia Dune, la elecci√≥n recay√≥ en ellos.  Despu√©s de finalizar con un archivo (las aberturas para las entradas y salidas del reproductor multimedia son ligeramente diferentes, no pude conectar 220v al conector HDMI :)) encajaba perfectamente.  Solo el sensor de temperatura ten√≠a que hacerse afuera, ya que adentro el relleno calienta el aire. <br><br>  220v entradas y salidas <br><br><img src="https://habrastorage.org/web/ff9/e7e/811/ff9e7e8111054a59b12bf901b3d55b00.jpg"><br><br>  Entradas y salidas en 5v y 12v <br><br><img src="https://habrastorage.org/web/58b/8a0/634/58b8a063416c4c31ab6032f6f04acdcc.jpg"><br><br>  ¬øQu√© puede hacer este m√≥dulo y por qu√© es mejor que el sistema anterior? <br><br><ul><li>  No se requieren cables adicionales para la instalaci√≥n.  Est√° alimentado desde la misma red que controla. </li><li>  Cuando el servidor central o Wi-Fi est√° desconectado o inaccesible, se desconecta y realiza el control de acuerdo con un script aut√≥nomo (el script para cada zona puede ser diferente) </li><li>  Toma datos sobre temperatura / humedad / iluminaci√≥n en la habitaci√≥n. </li><li>  Controla 4 dispositivos 220, lee datos de 6 sensores de contacto seco. </li><li>  Capaz de enviar datos de forma independiente a thingspeak.com y sistemas similares. </li><li>  Reacciona m√°s r√°pido que el sistema anterior (no es que esto fuera un problema, pero antes de que cada sensor fuera interrogado dos veces por segundo, lo que podr√≠a dar un retraso total de m√°s de un segundo).  Este sistema funciona por interrupci√≥n. </li><li>  Capaz de actualizar el firmware "por aire". </li></ul><br><div class="spoiler">  <b class="spoiler_title">Esquema</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/eb8/0e5/be6/eb80e5be61aa4ca48208f5a3d37d5ee5.png"></div></div><br>  No fue posible separar dicha placa en una capa, por lo que tuve que dominar una LUT de dos lados: <br><br><div class="spoiler">  <b class="spoiler_title">Tarifa</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/aca/fde/89f/acafde89f1d74d9bb695ee3b2bcc39f2.png"></div></div><br>  La experiencia operativa ha sido de m√°s de medio a√±o, se planea reemplazar todas las partes de control del sistema con este m√≥dulo, dejando solo el monitoreo en 1-Wire. <br><br>  Teniendo en cuenta los deseos de art√≠culos anteriores, los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esquemas</a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">c√≥digo</a> est√°n disponibles en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github</a> .  Los viejos tambi√©n est√°n all√≠, de repente son √∫tiles. <br><br>  Algo asi.  Dale Me gusta y suscr√≠bete a nuevos videos :) Es una broma, de todos modos un nuevo art√≠culo, si es as√≠, en un par de a√±os, el Chukchi no es un escritor: P <br><br>  Aunque, si tiene preguntas sobre el firmware y la arquitectura de esp07_4PIO_6S, escribir√© un art√≠culo detallado sobre este arte, hay, en mi opini√≥n, varias soluciones interesantes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es403973/">https://habr.com/ru/post/es403973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es403963/index.html">Impresi√≥n 4D: nuevos materiales que cambian las caracter√≠sticas y la forma.</a></li>
<li><a href="../es403965/index.html">Nada m√°s: una revisi√≥n del reproductor HiFiMan MegaMini</a></li>
<li><a href="../es403967/index.html">DataArt Flag sobre Elbrus</a></li>
<li><a href="../es403969/index.html">Nuevo taller pr√°ctico el 20 de mayo.</a></li>
<li><a href="../es403971/index.html">La conferencia internacional blockchain Genesis Moscow Conference se celebrar√° en Mosc√∫ el 26 de mayo</a></li>
<li><a href="../es403975/index.html">¬øEs cierto que el mundo se ha convertido en un lugar m√°s peligroso para los ni√±os que antes?</a></li>
<li><a href="../es403977/index.html">S√°tira con el cerebro: en Mosc√∫ por primera vez habr√° un festival de teor√≠as cient√≠ficas locas "Bueno, tambi√©n ciencia"</a></li>
<li><a href="../es403979/index.html">La impresi√≥n ov√°rica en 3D ayud√≥ a dar a luz a un rat√≥n est√©ril</a></li>
<li><a href="../es403981/index.html">Yogi Universal An√°lisis del transformador port√°til Lenovo Yoga 720</a></li>
<li><a href="../es403983/index.html">Bombillas LED Brawex</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>