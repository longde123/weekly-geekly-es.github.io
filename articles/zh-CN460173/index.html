<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜ ğŸ˜„ ğŸ© Dockerå¼€å‘ã€‚ å½“åœ°ç¯å¢ƒã€‚ ç¬¬2éƒ¨åˆ†-Nginx + PHP + MySql + phpMyAdmin ğŸ‚ ğŸ’ªğŸ¿ ğŸ‘”</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¸ºäº†æ›´å¥½åœ°ç†è§£ä»¥ä¸‹ææ–™ï¼Œå»ºè®®æ‚¨é¦–å…ˆé˜…è¯»ä¸Šä¸€ç¯‡æ–‡ç«  

 è€ƒè™‘ä¸€ä¸ªå¼€å‘ç”±ä¸€ç³»åˆ—Nginx + PHP + MySql + phpMyAdminç»„æˆçš„æœ¬åœ°ç¯å¢ƒçš„ç¤ºä¾‹ã€‚ è¯¥æ†ç»‘åŒ…éå¸¸å—æ¬¢è¿ï¼Œå¯ä»¥æ»¡è¶³æ™®é€šå¼€å‘äººå‘˜çš„è®¸å¤šæ ‡å‡†éœ€æ±‚ã€‚ 

 ä¸ä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œé‡ç‚¹å°†è½¬å‘docker-composeå®ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dockerå¼€å‘ã€‚ å½“åœ°ç¯å¢ƒã€‚ ç¬¬2éƒ¨åˆ†-Nginx + PHP + MySql + phpMyAdmin</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460173/">ä¸ºäº†æ›´å¥½åœ°ç†è§£ä»¥ä¸‹ææ–™ï¼Œå»ºè®®æ‚¨é¦–å…ˆé˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šä¸€ç¯‡æ–‡ç« </a> <br><br> è€ƒè™‘ä¸€ä¸ªå¼€å‘ç”±ä¸€ç³»åˆ—Nginx + PHP + MySql + phpMyAdminç»„æˆçš„æœ¬åœ°ç¯å¢ƒçš„ç¤ºä¾‹ã€‚ è¯¥æ†ç»‘åŒ…éå¸¸å—æ¬¢è¿ï¼Œå¯ä»¥æ»¡è¶³æ™®é€šå¼€å‘äººå‘˜çš„è®¸å¤šæ ‡å‡†éœ€æ±‚ã€‚ <br><br> ä¸ä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œé‡ç‚¹å°†è½¬å‘docker-composeå®ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯æœ€çº¯ç²¹å½¢å¼çš„dockerã€‚ <br><br> æ‰€ä»¥èµ°å§ï¼ <br><a name="habracut"></a><br> è®©æˆ‘ä»¬ä»docker-compose.ymlå¼€å§‹ï¼Œå®ƒåœ¨ä¸€ä¸ªå•ç‹¬çš„ä»£ç†æ–‡ä»¶å¤¹ä¸­ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ç”¨äºnginxä»£ç†çš„docker-compose.yml</b> <div class="spoiler_text"><pre><code class="plaintext hljs">version: '3.0' services: proxy: image: jwilder/nginx-proxy ports: - 80:80 volumes: - /var/run/docker.sock:/tmp/docker.sock:ro networks: - proxy networks: proxy: driver: bridge</code> </pre> <br></div></div><br> å‘ˆç°çš„æ–‡ä»¶æè¿°äº†åŸºäºä»¥ä¸‹<b>æ˜ åƒ</b>ä½¿ç”¨åç§°<b>ä»£ç†</b>åˆ›å»ºä¸€ä¸ªå®¹å™¨çš„é…ç½®<b>ï¼šjwilder / nginx-proxyæ˜ åƒ</b>å¹¶åˆ›å»ºå…·æœ‰ç›¸åŒåç§°çš„ç½‘ç»œã€‚  <b>networks</b>æŒ‡ä»¤æŒ‡ç¤ºå®¹å™¨è¿æ¥åˆ°å“ªä¸ªç½‘ç»œï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„ä»£ç†ç½‘ç»œã€‚ <br><br> åˆ›å»ºç½‘ç»œæ—¶ï¼Œå¯ä»¥çœç•¥driverï¼šbridgeæŒ‡ä»¤ã€‚ æ¡¥é©±åŠ¨ç¨‹åºæ˜¯é»˜è®¤é©±åŠ¨ç¨‹åºã€‚ è¯¥å®¹å™¨å°†é€šè¿‡ç½‘ç»œä¸å…¶ä»–å®¹å™¨é€šä¿¡ã€‚ <br><br>  jwilder / nginx-proxyå›¾åƒæ˜¯åŸºæœ¬å›¾åƒï¼Œå®ƒå·²è¢«ä½¿ç”¨ï¼Œå¹¶ä¸”<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker Hub</a>è¿˜æä¾›äº†ç›¸å½“å¹¿æ³›å’Œè¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ã€‚  nginx-proxyçš„æ“ä½œåŸç†éå¸¸ç®€å•ï¼šå®ƒé€šè¿‡è½¬å‘çš„dockerå¥—æ¥å­—è®¿é—®æœ‰å…³æ­£åœ¨è¿è¡Œçš„å®¹å™¨çš„ä¿¡æ¯ï¼Œåˆ†æåç§°ä¸ºVIRTUAL_HOSTçš„ç¯å¢ƒå˜é‡çš„å­˜åœ¨ï¼Œå¹¶å°†è¯·æ±‚ä»æŒ‡å®šä¸»æœºé‡å®šå‘åˆ°è®¾ç½®äº†ç»™å®šç¯å¢ƒå˜é‡çš„å®¹å™¨ã€‚ <br><br> æˆ‘ä»¬ä½¿ç”¨å·²çŸ¥çš„docker-compose up -då‘½ä»¤å¯åŠ¨ä»£ç†ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ä»¥ä¸‹è¾“å‡ºï¼š <br><br><pre> <code class="plaintext hljs">Creating network "proxy_proxy" with driver "bridge" Creating proxy_proxy_1 ... done</code> </pre><br> è¿™ä¸ªç»“è®ºå‘Šè¯‰æˆ‘ä»¬ï¼Œä¸€å¼€å§‹åˆ›å»ºäº†proxy_proxyç½‘ç»œï¼Œç„¶ååˆ›å»ºäº†proxy_proxy_1å®¹å™¨ã€‚ ç½‘ç»œåç§°æ˜¯ä»docker-compose.ymlæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹çš„åç§°è·å¾—çš„ï¼Œæˆ‘æœ‰ä¸€ä¸ªä»£ç†ï¼Œå¹¶ä¸”ç½‘ç»œåç§°ç›¸åŒã€‚ <br><br> å¦‚æœè¾“å…¥<b>docker network lså‘½ä»¤</b> ï¼Œæˆ‘ä»¬å°†åœ¨ç³»ç»Ÿä¸­çœ‹åˆ°ä¸€ä¸ªdockerç½‘ç»œåˆ—è¡¨ï¼Œå…¶ä¸­ä¸€ä¸ªåº”è¯¥æ˜¯proxy_proxyã€‚ <br><br> å®¹å™¨åç§°çš„å»ºç«‹ä¸æ–‡ä»¶å¤¹åç§°åŠ ä¸ŠæœåŠ¡åç§°å’Œç¼–å·çš„åŸåˆ™ç›¸åŒï¼Œè¿™ä½¿å¾—åç§°ç›¸ä¼¼çš„å®¹å™¨ä¸ä¼šé‡å¤ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨container_name</a>æŒ‡ä»¤ï¼Œå¯ä»¥æ˜¾å¼æŒ‡å®šå®¹å™¨çš„åç§°ï¼Œä½†æ˜¯æˆ‘å‘ç°è¿™æ˜¯ä¸€ä¸ªéå¸¸æ— ç”¨çš„åŠŸèƒ½ã€‚ åœ¨ä»¥ä¸‹æ–‡ç« ä¸­å°†å¯¹æ­¤è¿›è¡Œæ›´è¯¦ç»†çš„è®¨è®ºã€‚ <br><br> ä½¿ç”¨ä»¥ä¸‹å†…å®¹åˆ›å»ºç¬¬äºŒä¸ªdocker-compose.ymlï¼š <br><br><div class="spoiler">  <b class="spoiler_title">docker-compose.ymlç”¨äºå…¶ä»–æœåŠ¡</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: '3.0' services: nginx: image: nginx environment: - VIRTUAL_HOST=site.local depends_on: - php volumes: - ./docker/nginx/conf.d/default.nginx:/etc/nginx/conf.d/default.conf - ./html/:/var/www/html/ networks: - frontend - backend php: build: context: ./docker/php volumes: - ./docker/php/php.ini:/usr/local/etc/php/php.ini - ./html/:/var/www/html/ networks: - backend mysql: image: mysql:5.7 volumes: - ./docker/mysql/data:/var/lib/mysql environment: MYSQL_ROOT_PASSWORD: root networks: - backend phpmyadmin: image: phpmyadmin/phpmyadmin:latest environment: - VIRTUAL_HOST=phpmyadmin.local - PMA_HOST=mysql - PMA_USER=root - PMA_PASSWORD=root networks: - frontend - backend networks: frontend: external: name: proxy_proxy backend:</code> </pre><br></div></div><br> è¿™é‡Œå®£å¸ƒä»€ä¹ˆï¼Ÿ <br><br> åˆ—å‡ºäº†å››ä¸ªæœåŠ¡ï¼šnginxï¼Œphpï¼Œmysqlå’Œphpmyadminã€‚ å’Œä¸¤ä¸ªç½‘ç»œã€‚ ä¸€ä¸ªç§°ä¸ºå‰ç«¯çš„ä»£ç†ç½‘ç»œè¢«å…¬å‘Šä¸ºå¤–éƒ¨ç½‘ç»œå’Œæ–°çš„å†…éƒ¨åç«¯ç½‘ç»œã€‚ æ²¡æœ‰æŒ‡å®šå®ƒçš„é©±åŠ¨ç¨‹åºï¼Œå¦‚æˆ‘ä¹‹å‰æ‰€å†™ï¼Œå°†ä½¿ç”¨ç½‘æ¡¥ç±»å‹çš„é»˜è®¤é©±åŠ¨ç¨‹åºã€‚ <br><br><h4>  Nginxçš„ </h4><br> è¿™é‡Œçš„ä¸€åˆ‡éƒ½åº”è¯¥æ¸…æ¥šã€‚ æˆ‘ä»¬å°†åŸºæœ¬æ˜ åƒä¸docker hubä¸€èµ·ä½¿ç”¨ã€‚ ç¯å¢ƒå˜é‡æ˜¯ä»£ç†å·¥ä½œæ‰€å¿…éœ€çš„ï¼Œå¹¶å‘Šè¯‰å®ƒå®¹å™¨åº”å¯è®¿é—®çš„åœ°å€ã€‚  depends_oné€‰é¡¹æŒ‡ç¤ºæ­¤å®¹å™¨å¯¹phpå®¹å™¨çš„ä¾èµ–æ€§ã€‚ è¿™æ„å‘³ç€å°†å…ˆå¯åŠ¨phpå®¹å™¨ï¼Œç„¶åå†å¯åŠ¨ä¾èµ–å®ƒçš„nginxå®¹å™¨ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è½¬å‘nginxçš„é…ç½®ã€‚ å®ƒå°†é™ä½ä¸€ç‚¹å¹¶ä½¿ç”¨htmlæŒ‚è½½æ–‡ä»¶å¤¹ã€‚ æˆ‘ä»¬è¿˜æ³¨æ„åˆ°è¯¥å®¹å™¨å¯ä»¥ä¸€æ¬¡è®¿é—®ä¸¤ä¸ªç½‘ç»œã€‚ å®ƒå¿…é¡»åŒæ—¶é€šä¿¡æ¥è‡ªå‰ç«¯ç½‘ç»œçš„ä»£ç†å’Œæ¥è‡ªåç«¯ç½‘ç»œçš„phpã€‚ åŸåˆ™ä¸Šï¼Œå¯ä»¥å°†æ‰€æœ‰å®¹å™¨éƒ½æ¨å…¥ä¸€ä¸ªå‰ç«¯ï¼Œç„¶åå°†å…¶æ¨å…¥ä¸€ä¸ªç½‘ç»œï¼Œä½†æ˜¯æˆ‘åšæŒè®¤ä¸ºè¿™æ ·çš„åˆ†éš”æ›´ä¸ºæ­£ç¡®ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">default.nginx</b> <div class="spoiler_text"><pre> <code class="nginx hljs"><span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">server_name_in_redirect</span></span> <span class="hljs-literal"><span class="hljs-literal">off</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">access_log</span></span> /var/log/nginx/host.access.log main; <span class="hljs-attribute"><span class="hljs-attribute">root</span></span> /var/www/html/; <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">try_files</span></span> <span class="hljs-variable"><span class="hljs-variable">$uri</span></span> /index.php<span class="hljs-variable"><span class="hljs-variable">$is_args</span></span><span class="hljs-variable"><span class="hljs-variable">$args</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~ \.php$</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">try_files</span></span> <span class="hljs-variable"><span class="hljs-variable">$uri</span></span> =<span class="hljs-number"><span class="hljs-number">404</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">fastcgi_split_path_info</span></span><span class="hljs-regexp"><span class="hljs-regexp"> ^(.+\.php)(/.+)$</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">fastcgi_pass</span></span> php:<span class="hljs-number"><span class="hljs-number">9000</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">fastcgi_index</span></span> index.php; <span class="hljs-attribute"><span class="hljs-attribute">include</span></span> fastcgi_params; <span class="hljs-attribute"><span class="hljs-attribute">fastcgi_param</span></span> SCRIPT_FILENAME <span class="hljs-variable"><span class="hljs-variable">$document_root</span></span><span class="hljs-variable"><span class="hljs-variable">$fastcgi_script_name</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">fastcgi_param</span></span> PATH_INFO <span class="hljs-variable"><span class="hljs-variable">$fastcgi_path_info</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~ /\.ht</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">deny</span></span> all; } }</code> </pre><br></div></div><br>  default.nginxæ˜¯nginxçš„é…ç½®ï¼Œè½¬å‘åˆ°å®¹å™¨ã€‚ è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯<b>fastcgi_pass php</b>æŒ‡ä»¤<b>ï¼š9000</b> ã€‚ å®ƒè®¾ç½®FastCGIæœåŠ¡å™¨çš„åœ°å€ã€‚ è¯¥åœ°å€å¯ä»¥æŒ‡å®šä¸ºåŸŸåæˆ–IPåœ°å€å’Œç«¯å£ã€‚ <br><br>  <b>phpï¼š9000-</b>æœåŠ¡çš„åç§°æ˜¯FastCGIæœåŠ¡å™¨çš„åœ°å€ã€‚  Nginxè®¿é—®phpå°†è·å¾—è¿è¡Œphpçš„å®¹å™¨çš„IPåœ°å€ã€‚ ç«¯å£9000æ˜¯æ ‡å‡†ç«¯å£ï¼Œåœ¨åˆ›å»ºåŸºæœ¬å®¹å™¨æ—¶å£°æ˜ã€‚ è¯¥ç«¯å£å¯ç”¨äºç½‘ç»œä¸Šçš„nginxï¼Œä½†ç”±äºæœªè½¬å‘ï¼Œå› æ­¤åœ¨ä¸»æœºä¸Šä¸å¯ç”¨ã€‚ <br><br><h4> çš„PHP </h4><br> æ²¡æœ‰æ˜¾ç¤ºå›¾åƒæ˜¯ä¸å¯»å¸¸çš„ã€‚ ç›¸åï¼Œå®ƒç›´æ¥ä»æ’°å†™æ–‡ä»¶æ„å»ºè‡ªå·±çš„æ˜ åƒã€‚  contextæŒ‡ä»¤æŒ‡å‘Dockerfileæ‰€åœ¨çš„æ–‡ä»¶å¤¹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">Dockeræ–‡ä»¶</b> <div class="spoiler_text"><pre> <code class="php hljs">FROM php:<span class="hljs-number"><span class="hljs-number">7.3</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>-fpm RUN apt-get update &amp;&amp; apt-get install -y \ libzip-dev \ zip \ &amp;&amp; docker-php-ext-configure zip --with-libzip \ &amp;&amp; docker-php-ext-install zip \ &amp;&amp; docker-php-ext-install mysqli COPY --from=composer:latest /usr/bin/composer /usr/bin/composer WORKDIR /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/www/html</code> </pre><br></div></div><br>  Dockerfileå£°æ˜è¯¥æ„å»ºä½¿ç”¨åŸºæœ¬çš„phpæ˜ åƒï¼š7.3.2-fpmï¼Œç„¶åè¿è¡Œç”¨äºå®‰è£…phpæ‰©å±•çš„å‘½ä»¤ã€‚ æ¥ä¸‹æ¥ï¼Œä»å¦ä¸€ä¸ªåŸºæœ¬æ˜ åƒå¤åˆ¶composerï¼Œå¹¶è®¾ç½®é¡¹ç›®çš„å·¥ä½œç›®å½•ã€‚ æˆ‘å°†åœ¨å…¶ä»–å¸–å­ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºç»„è£…é—®é¢˜ã€‚ <br><br> åŒæ ·ï¼Œå¸¦æœ‰æˆ‘ä»¬é¡¹ç›®çš„php.iniæ–‡ä»¶å’Œhtmlæ–‡ä»¶å¤¹ä¹Ÿè¢«æŠ›å‡ºåˆ°å®¹å™¨å†…ã€‚ <br><br> è¯·æ³¨æ„ï¼Œphpä½äºåç«¯ç½‘ç»œä¸Šï¼Œä¾‹å¦‚ï¼Œä»£ç†æ— æ³•å†è®¿é—®å®ƒã€‚ <br><br><h4>  MySQLçš„ </h4><br> åŸºæœ¬mysqlæ˜ åƒæ˜¯ä½¿ç”¨5.7æ ‡è®°è·å–çš„ï¼Œè¯¥æ ‡è®°è´Ÿè´£mysqlç‰ˆæœ¬ã€‚  ./docker/mysql/dataæ–‡ä»¶å¤¹ç”¨äºå­˜å‚¨æ•°æ®åº“æ–‡ä»¶ï¼ˆæ‚¨ç”šè‡³ä¸éœ€è¦åˆ›å»ºå®ƒï¼Œå®ƒæ˜¯åœ¨å¯åŠ¨æ—¶åˆ›å»ºçš„ï¼‰ã€‚ å¹¶é€šè¿‡ç¯å¢ƒå˜é‡ä¸ºrootç”¨æˆ·ï¼ˆä¹Ÿä¸ºrootï¼‰è®¾ç½®å¯†ç ã€‚ <br><br> è¯¥æ•°æ®åº“ä½äºåç«¯ç½‘ç»œä¸Šï¼Œå› æ­¤å¯ä»¥ä¸phpä¿æŒè”ç³»ã€‚ åŸºæœ¬æ˜ åƒä½¿ç”¨æ ‡å‡†ç«¯å£3306ã€‚å®ƒåœ¨dockerç½‘ç»œä¸Šå¯ç”¨äºphpï¼Œä½†åœ¨ä¸»æœºä¸Šä¸å¯ç”¨ã€‚ å¦‚æœè½¬å‘è¯¥ç«¯å£ï¼Œåˆ™å¯ä»¥ä¾‹å¦‚ä»åŒä¸€PHPSTORMè¿æ¥åˆ°è¯¥ç«¯å£ã€‚ ä½†æ˜¯ï¼Œå¦‚æœphpmyadminç•Œé¢è¶³ä»¥æ»¡è¶³æ‚¨çš„éœ€æ±‚ï¼Œé‚£ä¹ˆæ‚¨å°†æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚ <br><br><h4>  phpmyadmin </h4><br>  phpmyadminçš„å®˜æ–¹å›¾ç‰‡ã€‚ ç¯å¢ƒå˜é‡ä½¿ç”¨VIRTUAL_HOSTä¸ä»£ç†è¿›è¡Œäº¤äº’ï¼Œç±»ä¼¼äºnginxã€‚  PMA_USERå’ŒPMA_PASSWORDè®¿é—®æ•°æ®åº“ã€‚ å’ŒPMA_HOSTä¸»æœºæ•°æ®åº“æœ¬èº«ã€‚ ä½†è¿™ä¸æ˜¯localhostï¼ˆé€šå¸¸æ˜¯è¿™æ ·ï¼‰ï¼Œè€Œæ˜¯mysqlã€‚ å³ ä¸æ•°æ®åº“çš„é€šä¿¡å¯é€šè¿‡å…¶æœåŠ¡åç§°è¿›è¡Œï¼Œå³  MySQLçš„ã€‚  phpmyadminå®¹å™¨å¯ä»¥ä¸æ•°æ®åº“é€šä¿¡ï¼Œå› ä¸ºå®ƒå…·æœ‰åˆ°å‰ç«¯ç½‘ç»œçš„è¿æ¥ã€‚ <br><br> æˆ‘ä»¬ä½¿ç”¨å¸¸ç”¨å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼šdocker-compose -dã€‚ <br><br> æˆ‘ä»¬çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æœåŠ¡å¯åŠ¨</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Creating network "lesson2_backend" with the default driver Building php Step 1/4 : FROM php:7.3.2-fpm ---&gt; 9343626a0f09 Step 2/4 : RUN apt-get update &amp;&amp; apt-get install -y libzip-dev zip &amp;&amp; docker-php-ext-configure zip --with-libzip &amp;&amp; docker-php-ext-install zip &amp;&amp; docker-php-ext-install mysqli ---&gt; Using cache ---&gt; 5e4687b5381f Step 3/4 : COPY --from=composer:latest /usr/bin/composer /usr/bin/composer ---&gt; Using cache ---&gt; 81b9c665be08 Step 4/4 : WORKDIR /var/www/html ---&gt; Using cache ---&gt; 3fe8397e92e6 Successfully built 3fe8397e92e6 Successfully tagged lesson2_php:latest Pulling mysql (mysql:5.7)... 5.7: Pulling from library/mysql fc7181108d40: Already exists 787a24c80112: Already exists a08cb039d3cd: Already exists 4f7d35eb5394: Already exists 5aa21f895d95: Already exists a742e211b7a2: Already exists 0163805ad937: Already exists 62d0ebcbfc71: Pull complete 559856d01c93: Pull complete c849d5f46e83: Pull complete f114c210789a: Pull complete Digest: sha256:c3594c6528b31c6222ba426d836600abd45f554d078ef661d3c882604c70ad0a Status: Downloaded newer image for mysql:5.7 Creating lesson2_php_1 ... done Creating lesson2_mysql_1 ... done Creating lesson2_phpmyadmin_1 ... done Creating lesson2_nginx_1 ... done</code> </pre><br></div></div><br> æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨å¼€å§‹æ—¶åˆ›å»ºäº†lesson2_backendç½‘ç»œï¼Œç„¶åç»„è£…äº†phpæ˜ åƒï¼Œç„¶åå¯ä»¥ä¸‹è½½ç³»ç»Ÿä¸­å°šæœªå­˜åœ¨çš„æ˜ åƒï¼ˆæ‹‰å‡ºï¼‰ï¼Œå¹¶ä¸”å®é™…ä¸Šå¯åŠ¨äº†æ‰€æè¿°çš„æœåŠ¡ã€‚ <br><br> æœ€åçš„ä¿®æ”¹ï¼Œä»¥ä¾¿ä¸€åˆ‡æ­£å¸¸ï¼Œæ­¤æ·»åŠ åˆ°ä¸»æœºæˆ–sites.localå’Œphpmyadmin.localåŸŸã€‚ <br><br>  index.phpçš„å†…å®¹å¯èƒ½å¦‚ä¸‹ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">index.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//phpinfo(); $link = mysqli_connect('mysql', 'root', 'root'); if (!$link) { die(' : ' . mysqli_error()); } echo ' '; mysqli_close($link);</span></span></code> </pre><br></div></div><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ£€æŸ¥phpæ‰©å±•å-mysqliï¼ˆåœ¨Dockerfileçš„æ±‡ç¼–è¿‡ç¨‹ä¸­æ·»åŠ ï¼‰çš„è¿æ¥æ˜¯å¦æ­£ç¡®ã€‚ <br><br> å¹¶æ³¨æ„ï¼Œå¯¹äºä¸å®¹å™¨çš„è¿æ¥ï¼Œå°†ä½¿ç”¨æœåŠ¡çš„åç§°-mysqlã€‚ <br><br> æ•´ä¸ªé¡¹ç›®çš„ç»“æ„å¦‚ä¸‹ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">é¡¹ç›®ç»“æ„</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">habr/lesson2$ tree . â”œâ”€â”€ docker â”‚ â”œâ”€â”€ mysql â”‚ â”‚ â””â”€â”€ data â”‚ â”œâ”€â”€ nginx â”‚ â”‚ â””â”€â”€ conf.d â”‚ â”‚ â””â”€â”€ default.nginx â”‚ â””â”€â”€ php â”‚ â”œâ”€â”€ Dockerfile â”‚ â””â”€â”€ php.ini â”œâ”€â”€ docker-compose.yml â”œâ”€â”€ html â”‚ â””â”€â”€ index.php â””â”€â”€ proxy â””â”€â”€ docker-compose.yml</code> </pre><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN460173/">https://habr.com/ru/post/zh-CN460173/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN460159/index.html">ç”¨æˆ·æ™ºèƒ½æ‰‹æœºç›‘æ§ä¿„ç½—æ–¯é“è·¯ç°çŠ¶çš„æ–¹æ³•</a></li>
<li><a href="../zh-CN460161/index.html">FusionPBXå’ŒACL</a></li>
<li><a href="../zh-CN460163/index.html">å¥½åƒ</a></li>
<li><a href="../zh-CN460165/index.html">èƒŒæ™¯ï¼šé‡å­æ‰‹æŒ‡å¯†ç å­¦</a></li>
<li><a href="../zh-CN460169/index.html">Ræ‰‹å†Œæœ€è¿‘æˆä¸ºå­¦æœ¯è®ºæ–‡ä¸­å¼•ç”¨æœ€å¤šçš„éå­¦æœ¯å‡ºç‰ˆç‰©ã€‚</a></li>
<li><a href="../zh-CN460175/index.html">å¸‚åœºè¥é”€ä¸­çš„ç¬¦å·å­¦ï¼šè¿™å¯¹æ‚¨çš„å“ç‰Œæ„å‘³ç€ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN460177/index.html">nRF52832ä¸Šçš„æ— çº¿æ¼æ°´ä¼ æ„Ÿå™¨ï¼ŒDIYé¡¹ç›®</a></li>
<li><a href="../zh-CN460179/index.html">LEAN + AGILE = AGILEANæˆ–æˆ‘ä»¬å°†æ•´ä¸ªé›¶ä»¶æ”¶é›†èµ·æ¥</a></li>
<li><a href="../zh-CN460181/index.html">é€šè¿‡è§£ææºä»£ç æ¥æé«˜æ‚¨çš„JavaScriptçŸ¥è¯†</a></li>
<li><a href="../zh-CN460185/index.html">åœ¨çº¿æœåŠ¡â€œé€šè¿‡è§†é¢‘å¯¹äº‹æ•…è¿›è¡Œé€Ÿåº¦åˆ†æâ€</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>