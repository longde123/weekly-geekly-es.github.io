<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§öüèΩ üöÜ üë©üèø Placa STM32 barata + IDE Arduino UPD 17/08/2017 üìª üëÑ üî∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Deseja atualizar seus projetos do Arduino? Fa√ßa com que eles trabalhem mais rapidamente, fa√ßa medi√ß√µes e ajustes mais precisos e adicione bugs (eles s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Placa STM32 barata + IDE Arduino UPD 17/08/2017</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395577/"><img src="https://habrastorage.org/files/c77/812/08e/c7781208e99a4b5ba071204b56d89691.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deseja atualizar seus projetos do Arduino? </font><font style="vertical-align: inherit;">Fa√ßa com que eles trabalhem mais rapidamente, fa√ßa medi√ß√µes e ajustes mais precisos e adicione bugs (eles s√£o inevit√°veis ‚Äã‚Äãcom novos dispositivos). </font><font style="vertical-align: inherit;">Ent√£o este artigo √© para voc√™. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O tema Arduino captura cada vez mais as mentes da humanidade, mas mais cedo ou mais tarde nos deparamos com o fato de que estamos perdendo algo, por exemplo, or√ßamento / tamanhos / </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pinos de</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> portas / capacidade de bits / desempenho ... Como uma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pessoa s√°bia disse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ‚ÄúQuem quiser, ele procura oportunidades quem n√£o quer est√° procurando por raz√µes. ‚Äù </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As pessoas boas entendem isso e lentamente come√ßam a anexar o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32 ao tema do arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , porque os microcontroladores AVR de oito bits, nos quais muitas placas de arduino s√£o baseadas, nem sempre conseguem lidar com as tarefas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um resumo deste artigo em formato de v√≠deo:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/878k4KqF7Xs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ok, menos letras e mais perto do t√≥pico. </font><font style="vertical-align: inherit;">Neste artigo, considerarei uma placa de depura√ß√£o barata, baseada no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">microcontrolador STM32F103C8T6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/files/b41/614/68c/b4161468c90142148c300aaa7e2f846e.JPG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, vamos comparar os principais par√¢metros da placa STM32 e seu pre√ßo an√°logo - Arduino Nano V3.0:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Freq√º√™ncia de opera√ß√£o 72 MHz, versus 16 para arduino;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A quantidade de mem√≥ria Flash √© de 64 Kbytes, contra 32;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM, √© RAM (onde as vari√°veis ‚Äã‚Äãest√£o armazenadas), o STM32 tem at√© 20 Kbytes, o arduinka tem apenas 2;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADC r√°pido de 12 bits, enquanto as placas Arduino que usam microcontroladores AVR (geralmente a maioria) usam 10 bits. </font><font style="vertical-align: inherit;">Isso significa que, no caso do STM32, a fun√ß√£o √© analogRead (*); </font><font style="vertical-align: inherit;">retornar√° 0..4095 versus 0..1023, o que no primeiro caso leva a medi√ß√µes mais precisas;</font></font></li>
<li>16-   ,  8-  Arduino ,  ,  <s>analogWrite(*);</s>pwmWrite(*);    0..65535,   0..255.       ,    ,     ;</li>
<li>   USB,       Arduino    2 ;</li>
<li>  ‚Äî  2  3.6(    2 AA ),  2.7...5   ;</li>
<li>     ‚Äî 1.9   1.8().</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, a placa de depura√ß√£o baseada no STM32 supera o Arduino Nano em todos os aspectos, exceto pelo pre√ßo, mas concorda que 10 centavos √© um bom pre√ßo para um √≥timo desempenho, mas sobre os perif√©ricos com os quais o STM32 est√° cheio, fico completamente em sil√™ncio quanto ao valor do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DMA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou rel√≥gios em tempo real integrados no microcontrolador. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2d1/1b1/c4c/2d11b1c4c96342dbb0b7fe9aeedd046c.JPG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo isso torna essa placa extremamente atraente em tudo, exceto em uma coisa - para um iniciante, como eu, o tema STM32 parece muito demorado, existem sites inteiros dedicados √† programa√ß√£o desses microcontroladores. Mas se voc√™ fizer o STM32 amigo do IDE do Arduino, o limite de entrada cair√° para um n√≠vel extremamente baixo. Embora, como se costuma dizer, "em cada barril de mel exista uma mosca na pomada", mas mais sobre isso abaixo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos come√ßar a preparar o quadro para trabalhar com o Arduino IDE. </font><font style="vertical-align: inherit;">A primeira coisa que precisa ser feita √© fazer o upload de um carregador de inicializa√ß√£o especial para o microcontrolador, o que permitir√° que voc√™ atualize a placa via USB de hardware e diretamente do ambiente de desenvolvimento. </font><font style="vertical-align: inherit;">Para fazer isso, mova o jumper superior (tamb√©m conhecido como "BOOT0"), para a posi√ß√£o "1":</font></font><br>
<br>
<img src="https://habrastorage.org/files/198/fd7/ed4/198fd7ed436d475d88bcf52498d474d6.JPG" alt="image"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para que servem os jumpers BOOT0 e BOOT1?</font></font></b><div class="spoiler_text">  ,   STM32   ,     (system memory),  ,        USB to UART ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ST-Link V2</a>.<br>
<br>
<img src="https://habrastorage.org/files/5a4/813/115/5a48131155d249a1b97e5619c133a0af.png" alt="image"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, precisamos de um adaptador de USB para UART. Vale lembrar que o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32 √© l√≥gico de 3,3V</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a compatibilidade com 5V n√£o √© garantida, por isso √© recomend√°vel usar o USB para UART, que tem a capacidade de selecionar modos de opera√ß√£o com l√≥gica de 3,3 / 5V. Usei um adaptador barato baseado no CH340G: </font></font><br>
<br>
<img src="https://habrastorage.org/files/85c/50b/0cb/85c50b0cbdf442daa01f436e37fd4b9b.jpg" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* como voc√™ pode ver, o fabricante n√£o se virou com uma lavagem de fluxo, √© claro, isso n√£o afeta o trabalho. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conectei a placa ao adaptador USB para UART da seguinte maneira: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
G &lt;-&gt; GND; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5V &lt;-&gt; 5V; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PA10 &lt;-&gt; TXD; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PA9 &lt;-&gt; RXD. </font></font><br>
<br>
<img src="https://habrastorage.org/files/fa1/7c6/356/fa17c635681842d6b94add76cf4b2beb.jpg" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* O PA10 / PA9 na placa √© simplesmente assinado como A10 / A9 - essas portas s√£o o primeiro hardware USART, h√° 3 delas na placa, tamb√©m existem 2 I2Cs de hardware e 2 SPIs.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por uma quest√£o de conveni√™ncia, liguei a placa de 5 V; para a alimenta√ß√£o de 3,3 V, h√° um pino "3,3" na placa. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aten√ß√£o, 5 V pode desativar facilmente o microcontrolador</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; portanto, preste a devida aten√ß√£o √† conex√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fa√ßa o download, instale e execute o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flash Loader Demonstrator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dispon√≠vel no arquivo do artigo): </font></font><br>
<br>
<img src="https://habrastorage.org/files/124/554/93b/12455493b0334429b4f975143717ef88.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
selecione o n√∫mero da porta COM do nosso adaptador, no meu caso √© COM43 e clique em "Avan√ßar": </font></font><br>
<br>
<img src="https://habrastorage.org/files/866/092/649/866092649ba24aaf9db036baa5aa29df.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
como tenho um novo microcontrolador, a </font><s><font style="vertical-align: inherit;">mosca</font></s><font style="vertical-align: inherit;"> ainda </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o parou</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ningu√©m escreveu nada para ele (√© claro, exceto o pr√≥prio fabricante); ent√£o, por padr√£o, h√° prote√ß√£o contra leitura, o programa nos avisa que se voc√™ clicar no bot√£o "Remover prote√ß√£o", a mem√≥ria Flash ser√° limpa, ou seja, se houver algum tipo de firmware - ela vai se aposentar. No meu caso, n√£o h√° nada √∫til l√°, ent√£o pressiono com ousadia. A seguir, vejo o seguinte: </font></font><br>
<br>
<img src="https://habrastorage.org/files/faf/937/62f/faf93762f79843ec8bb1989cc5ed2295.PNG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Clique em "OK": </font></font><br>
<br>
<img src="https://habrastorage.org/files/132/4ea/aa8/1324eaaa861144bca5619c2703a49b38.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como minha placa de depura√ß√£o √© baseada no microcontrolador STM32F103 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - h√° 64 Kbytes de mem√≥ria Flash, tamb√©m h√° um </font><font style="vertical-align: inherit;">microcontrolador </font><font style="vertical-align: inherit;">STM32F103 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , onde h√° o dobro de Flash. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois clique em ‚ÄúNext‚Äù: </font></font><br>
<br>
<img src="https://habrastorage.org/files/021/79d/9e9/02179d9e9acb48fd845b79364cf3765a.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Novamente, ‚ÄúNext‚Äù, e vemos a seguinte janela: </font></font><br>
<br>
<img src="https://habrastorage.org/files/eb8/373/a44/eb8373a444d2489ba2ac37077ebe9093.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selecione ‚ÄúDownload to device‚Äù e clique em ‚Äú...‚Äù:</font></font><br>
<br>
<img src="https://habrastorage.org/files/cd4/f1e/af6/cd4f1eaf6e4a4557befea62a0d5f91ee.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Altere o tipo de arquivo para * .bin e abra o arquivo "generic_boot20_pc13.bin" (tamb√©m presente no arquivo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">morto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), que pode ser obtido no projeto </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">STM32duino-bootloader</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, clicamos no bot√£o ‚ÄúNext‚Äù, ap√≥s o firmware do carregador de inicializa√ß√£o, vemos uma luz verde: </font></font><br>
<br>
<img src="https://habrastorage.org/files/694/7e2/a39/6947e2a39b0e4dd2995145f80ec1a1b8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
precisamos baixar, para o ambiente de desenvolvimento do Arduino IDE, um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kernel STM32</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> especial </font><font style="vertical-align: inherit;">(tamb√©m est√° no arquivo do artigo). </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° uma nuance aqui, no momento da reda√ß√£o deste artigo, o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kernel n√£o funciona em vers√µes do ambiente de desenvolvimento acima da 1.6.5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tenho o 1.6.5-r5 que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baixei aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></s> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
O kernel foi testado para funcionar no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino IDE vers√£o 1.6.9</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, descompacte o conte√∫do em Meus Documentos \ Arduino \ hardware:</font></font><br>
<br>
<img src="https://habrastorage.org/files/98b/ed2/7f9/98bed27f9cf3403d9518307b9d5a9b57.PNG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No meu caso, o caminho completo se parece com isso - "C: \ Usu√°rios \ RSK \ Documents \ Arduino \ hardware" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â claro que o sistema n√£o pode determinar o sistema do dispositivo, ent√£o voc√™ ainda precisa instalar os drivers na placa. Vamos para a pasta "Meus documentos \ Arduino \ hardware \ Arduino_STM32 \ drivers \ win" (ou "drivers \ win", no caso de um arquivo no artigo), e executamos o arquivo "install_drivers.bat" como administrador: </font></font><br>
<br>
<img src="https://habrastorage.org/files/99a/523/588/99a523588e134d478d0d72988d9b1e6a.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
depois disso, o jumper superior (que que ‚ÄúBOOT0‚Äù), coloque-o na posi√ß√£o ‚Äú0‚Äù e conecte a placa ao computador via cabo microUSB: </font></font><br>
<br>
<img src="https://habrastorage.org/files/be6/c72/ff8/be6c72ff836947a382a558c1e6323a60.JPG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
deve ser definido no gerenciador de dispositivos como ‚ÄúMaple DFU‚Äù ou ‚ÄúMaple Serial (COM *)‚Äù: </font></font><br>
<br>
<img src="https://habrastorage.org/files/97b/154/a3b/97b154a3b891400ca365af6e0c7ef922.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
n√£o est√° claro por que, ap√≥s a primeira conex√£o Como a placa √© definida de maneira diferente em computadores diferentes, mas n√£o √© o ponto, continuamos a configurar o Arduino IDE.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lan√ßamos o ambiente de desenvolvimento e, em seguida, Ferramentas -&gt; </font></font><br>
<br>
<img src="https://habrastorage.org/files/3c6/306/4e1/3c63064e14424feeba0dd583863de356.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Placa </font><font style="vertical-align: inherit;">-&gt; Gerenciador de placas: </font><font style="vertical-align: inherit;">Aqui voc√™ precisa instalar o kernel para a placa Arduino Due. Selecione a vers√£o mais recente e clique em ‚ÄúInstalar‚Äù: </font></font><br>
<br>
<img src="https://habrastorage.org/files/558/187/594/558187594cfb4bce944089a37d76d7f9.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ferramentas -&gt; Placa -&gt; ‚ÄúSTM32F103C gen√©rico‚Äù e depois Variante: ‚ÄúSTM32F103C8 (20k RAM. 64k Flash)‚Äù, M√©todo de Upload: ‚ÄúSTM32duino bootloader‚Äù, N√∫mero da porta COM da placa - porta , em geral, tudo √© como na captura de tela: </font></font><br>
<br>
<img src="https://habrastorage.org/files/3a3/2a2/ecd/3a32a2ecdfdf4ca2bb9164eeffa9050d.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo, a placa est√° pronta para firmware e programa√ß√£o no ambiente de desenvolvimento do Arduino IDE. Vamos costurar alguns esbo√ßos dos exemplos que s√£o "costurados" no kernel, v√° em Arquivo -&gt; Pasta com esbo√ßos -&gt; hardware -&gt; Arduino_STM32 -&gt; STM32F1 -&gt; bibliotecas -&gt; A_STM32_Examples -&gt; Digital -&gt; Blink: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fdb/7df/6fb/fdb7df6fb6b64ade9f6c23a031367e4b.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cl√°ssico "Hello World" no mundo dos microcontroladores. Mudamos PB1 para PC13, j√° que o LED na placaconectado a esta porta:</font></font><br>
<br>
<img src="https://habrastorage.org/files/a24/e91/2d9/a24e912d93fb42869921f9c9dd985bd5.JPG" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* A prop√≥sito, ele acende em um n√≠vel baixo na perna do PC13. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pressionamos o bot√£o ‚ÄúDownload‚Äù, ap√≥s o firmware, o ambiente de desenvolvimento exibir√° algo como: </font></font><br>
<br>
<img src="https://habrastorage.org/files/ae6/07b/674/ae607b6742f744088bd27b5388dbf31b.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚ÄúConclu√≠do! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Redefinindo o USB para retornar ao modo de tempo de execu√ß√£o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erro ao redefinir ap√≥s o download: usb_reset: n√£o foi poss√≠vel redefinir o dispositivo, erro de vit√≥ria: N√£o foi poss√≠vel encontrar o arquivo especificado. " </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas o firmware foi carregado com sucesso, embora nem sempre seja o caso, √†s vezes o IDE do Arduino envia outras mensagens.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o foi poss√≠vel encontrar o dispositivo DFU</font></font></b><div class="spoiler_text"> ,  :<br>
<br>
<img src="https://habrastorage.org/files/2f7/9b6/3c3/2f79b63c37dd44f6804f39c83d8ca14c.png" alt="image"><br>
<br>
¬´dfu-util ‚Äî ¬© 2007-2008 by OpenMoko Inc.<br>
Couldn't find the DFU device: [1EAF:0003]<br>
This program is Free Software and has ABSOLUTELY NO WARRANTY¬ª<br>
<br>
 ,     .<br>
</div></div><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procurando pelo dispositivo DFU [1EAF: 0003] ...</font></font></b><div class="spoiler_text">   :<br>
<br>
<img src="https://habrastorage.org/files/b2f/a3e/a09/b2fa3ea09c004c8caf3175f1053e9d39.png" alt="image"><br>
<br>
¬´Searching for DFU device [1EAF:0003]‚Ä¶<br>
Assuming the board is in perpetual bootloader mode and continuing to attempt dfu programming...¬ª<br>
<br>
    ,         .      Arduino Pro Mini.<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E agora sobre a "mosca na pomada", sobre a qual escrevi no come√ßo do artigo, por algum motivo, nem sempre √© poss√≠vel exibir a placa no ambiente de desenvolvimento, mais ainda, nem sempre √© determinado pelo computador. </font><font style="vertical-align: inherit;">Decidi isso da seguinte maneira: antes de baixar o firmware (antes de clicar no bot√£o "Download"), clique em "Redefinir" no quadro e, ap√≥s o firmware, reinicializo o quadro novamente. </font><font style="vertical-align: inherit;">Nesse caso, a porcentagem de probabilidade de que o conselho seja costurado √© de 99%. </font><font style="vertical-align: inherit;">N√£o est√° claro por que funciona dessa maneira, mas √© um fato. </font><font style="vertical-align: inherit;">Acho que mais cedo ou mais tarde esse batente ser√° corrigido e tudo ser√° reiniciado automaticamente conforme necess√°rio. </font><font style="vertical-align: inherit;">E, para corrigir isso mais rapidamente, √© necess√°rio que a comunidade dessa maravilhosa placa de depura√ß√£o do STM32 cres√ßa; portanto, compartilhe este artigo com amigos, especialmente amigos de programadores. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sobre a pinagem:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clic√°vel</font></font></b><div class="spoiler_text">    ,    (   ):<br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/4b0/def/711/4b0def711af2f6fc049dcb9c2c6c759e.png" alt="image"></a><br>
() <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.stm32duino.com/viewtopic.php?p=11137</a><br>
<br>
      , : <br>
<br>
<i>digitalWrite(PB0, LOW); <br>
<s>analogWrite(PA8, 65535);</s>pwmWrite(PA8, 65535); <br>
analogRead(PA0); <br>
LiquidCrystal lcd(PB0, PA7, PA6, PA5, PA4, PA3);</i><br>
<br>
     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">docs.leaflabs.com/docs.leaflabs.com/index.html</a>          Arduino IDE,    .<br>
<br>
    ,     :<br>
<i>Documents\Arduino\hardware\Arduino_STM32\STM32F1\variants\generic_stm32f103c\board.cpp</i><br>
<br>
   ,  :<br>
<ul>
<li>,    <s>analogWrite();</s>pwmWrite(); ‚Äî PB0, PA7, PA6, PA3, PA2, PA1, PA0, PB7, PB6, PA10, PA9, PA8,     ,     ;</li>
<li>,  analogRead(); ‚Äî PB0, PA7, PA6, PA5, PA4, PA3, PA2, PA1, PA0.</li>
</ul><br>
<br>
    .       ,   1.9 .<br>
<br>
 ,   PA12/PA11   D+/D- USB,       ,   ,    2-     ,    .<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A placa de circuito:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clic√°vel</font></font></b><div class="spoiler_text"><a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/133/e87/543/133e875430de3f6b647547475f8358af.jpg" alt="image"></a><br>
() <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.stm32duino.com/viewtopic.php?p=11464#p11464</a><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, por √∫ltimo:</font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/14b/562/9cb14b562e7f43b58a156618f171aa84.JPG" alt="image"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ol√° geektimes.ru</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//https://github.com/mk90/LiquidCrystalRus</span></span>

<span class="hljs-comment"><span class="hljs-comment">//STM32  !</span></span>

<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;LiquidCrystalRus.h&gt;</span></span></span></span>

<span class="hljs-function"><span class="hljs-function">LiquidCrystalRus </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lcd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PB9, PB8, PB7, PB6, PB5, PB4)</span></span></span></span>;

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  lcd.begin(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>);
  lcd.print(<span class="hljs-string"><span class="hljs-string">""</span></span>);
  lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);
  lcd.print(<span class="hljs-string"><span class="hljs-string">"geektimes.ru"</span></span>);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  lcd.setCursor(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);
  lcd.print(millis() / <span class="hljs-number"><span class="hljs-number">1000</span></span>);
}
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Links: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquivo para o artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portal de um amigo de Roger Clark dedicado a portar STM32</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , perguntas / sugest√µes / obrigado, tudo l√°; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/rogerclarkmelbourne/Arduino_STM32</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://docs.leaflabs.com/docs.leaflabs.com/index.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - foi esse projeto que Roger tomou como base, portanto, existem muitas coisas √∫teis, embora em ingl√™s; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A vers√£o 1.6.5-r5 do Arduino IDE pode ser baixada aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meu artigo, at√© certo ponto, cruza com o amigo " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32 vs Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RaJa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Folha de dados no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32F103C8T6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas as minhas publica√ß√µes sobre geektimes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD 15/07/2016</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O kernel foi testado para funcionar na vers√£o 1.6.9 do Arduino IDE: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geektimes.ru/post/277928/#comment_9532576</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que mais se esqueceu</font></font></b><div class="spoiler_text">       :<br>
<br>
<img src="https://habrastorage.org/files/08e/d64/4c5/08ed644c5daf40cb80ef5e2aa9442d51.JPG" alt="image"><br>
<br>
   ,      .<br>
<br>
   ,    microUSB :<br>
<br>
<img src="https://habrastorage.org/files/9fa/27c/f23/9fa27cf2394a446d8411f0b14f77f427.jpg" alt="image"><br>
<br>
      , ,   .<br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt395577/">https://habr.com/ru/post/pt395577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt395565/index.html">Ethereum bug fork software, revers√£o de resultados e crescimento de ondinha</a></li>
<li><a href="../pt395567/index.html">Teste da SSD Kingston UV400 de 480 GB - SSD de passa</a></li>
<li><a href="../pt395571/index.html">Pergunte a Ethan No. 66: Encontramos mat√©ria escura?</a></li>
<li><a href="../pt395573/index.html">Vendedores russos tocam o alarme: mercadorias s√£o mais baratas em lojas on-line estrangeiras</a></li>
<li><a href="../pt395575/index.html">SanDisk lan√ßa MicroSDXC de at√© 256 GB</a></li>
<li><a href="../pt395579/index.html">Qual deve ser o verdadeiro governo eletr√¥nico? A Est√¥nia mostra um exemplo</a></li>
<li><a href="../pt395581/index.html">Como a edi√ß√£o gen√¥mica mudar√° a agricultura. Se permitirmos ...</a></li>
<li><a href="../pt395583/index.html">O roaming substituir√° inova√ß√µes, n√£o leis</a></li>
<li><a href="../pt395587/index.html">Tanques reais no universo do jogo</a></li>
<li><a href="../pt395591/index.html">OnePlus 3: a novidade Android mais esperada do ver√£o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>