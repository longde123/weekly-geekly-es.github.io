<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçü§ù‚Äçüë®üèΩ üß§ üåò DevOps em desenvolvimento: automa√ß√£o de c√≥digo de aplicativo da web ‚òùüèæ üòµ üßîüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bom dia, querido Habrazhiteli! 

 Hoje, o DevOps est√° na onda de sucesso. Em quase todas as confer√™ncias dedicadas √† automa√ß√£o, voc√™ pode ouvir do ora...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DevOps em desenvolvimento: automa√ß√£o de c√≥digo de aplicativo da web</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456146/">  Bom dia, querido Habrazhiteli! <br><br>  Hoje, o DevOps est√° na onda de sucesso.  Em quase todas as confer√™ncias dedicadas √† automa√ß√£o, voc√™ pode ouvir do orador dizendo ‚Äúimplementamos o DevOps aqui e ali, aplicamos isso e aquilo, ficou muito mais f√°cil realizar projetos etc., etc.‚Äù.  E √© louv√°vel.  Mas, como regra, a implementa√ß√£o do DevOps em muitas empresas termina no est√°gio de automa√ß√£o das opera√ß√µes de TI, e poucas pessoas falam sobre a implementa√ß√£o do DevOps diretamente no pr√≥prio processo de desenvolvimento. <br><br>  Eu gostaria de corrigir esse pequeno mal-entendido.  O DevOps pode entrar em desenvolvimento atrav√©s da formaliza√ß√£o da base de c√≥digo, por exemplo, ao escrever uma GUI para a API REST. <br><br>  Neste artigo, gostaria de compartilhar com voc√™ a solu√ß√£o para o caso n√£o padr√£o que nossa empresa encontrou - fomos capazes de automatizar a forma√ß√£o da interface do aplicativo da web.  Vou falar sobre como chegamos a essa tarefa e o que costum√°vamos resolv√™-la.  N√£o acreditamos que nossa abordagem seja a √∫nica verdadeira, mas gostamos muito dela. <br><br>  Espero que este material seja interessante e √∫til para voc√™. <br><br>  Bem, vamos come√ßar! <br><a name="habracut"></a><br><h2>  Antecedentes </h2><br>  Essa hist√≥ria come√ßou h√° cerca de um ano: era um lindo dia de ver√£o e nosso departamento de desenvolvimento estava criando o pr√≥ximo aplicativo da web.  Na agenda estava a tarefa de introduzir um novo recurso no aplicativo - era necess√°rio adicionar a capacidade de criar ganchos personalizados. <br><br><img src="https://habrastorage.org/webt/qi/lf/ot/qilfotaamoa_fpuerti3np8chlm.png" alt="O processo de adicionar novos recursos √† arquitetura antiga"><br><br>  Naquela √©poca, a arquitetura do nosso aplicativo da Web era constru√≠da de tal maneira que, para implementar um novo recurso, precis√°vamos fazer o seguinte: <br><br><ol><li>  No back-end: crie um modelo para uma nova entidade (ganchos), descreva os campos desse modelo, descreva toda a l√≥gica das a√ß√µes que o modelo pode executar, etc. <br></li><li>  No front-end'e: crie uma classe de apresenta√ß√£o que corresponda ao novo modelo na API, descreva manualmente todos os campos que esse modelo possui, adicione todos os tipos de a√ß√µes que essa visualiza√ß√£o pode executar, etc. <br></li></ol><br>  Acontece que, simultaneamente, ao mesmo tempo em dois lugares, era necess√°rio fazer altera√ß√µes muito semelhantes no c√≥digo, de uma maneira ou de outra, "duplicando" uma √† outra.  E isso, como voc√™ sabe, n√£o √© bom, porque com outras altera√ß√µes, os desenvolvedores precisariam fazer corre√ß√µes da mesma maneira em dois locais ao mesmo tempo. <br><br>  Suponha que precisamos alterar o tipo do campo "nome" de "string" para "textarea".  Para fazer isso, precisaremos fazer essa edi√ß√£o no c√≥digo do modelo no servidor e, em seguida, fazer altera√ß√µes semelhantes ao c√≥digo de apresenta√ß√£o no cliente. <br><br>  Isso √© muito complicado? <br><br>  Anteriormente, defendemos esse fato, j√° que muitos aplicativos n√£o eram muito grandes e havia um lugar para "duplicar" o c√≥digo no servidor e no cliente.  Mas naquele mesmo dia de ver√£o, antes da introdu√ß√£o do novo recurso, algo clicou dentro de n√≥s e percebemos que n√£o pod√≠amos mais trabalhar dessa maneira.  A abordagem atual era muito irracional e exigia muito tempo e trabalho.  Al√©m disso, a ‚Äúduplica√ß√£o‚Äù de c√≥digo no back-end e no front-end pode levar a erros inesperados no futuro: os desenvolvedores podem fazer altera√ß√µes no servidor e esquecer de fazer altera√ß√µes semelhantes no cliente, e ent√£o tudo n√£o vai bem de acordo com o plano. <br><br><h2>  Como evitar a duplica√ß√£o de c√≥digo?  Procure uma solu√ß√£o </h2><br>  Come√ßamos a pensar em como otimizar o processo de introdu√ß√£o de novos recursos. <br><br>  Fizemos a n√≥s mesmos a pergunta: "Podemos evitar duplicar altera√ß√µes na representa√ß√£o do modelo no front-end'e, ap√≥s qualquer altera√ß√£o em sua estrutura no back-end'e?" <br><br>  Pensamos e respondemos: "N√£o, n√£o podemos". <br><br>  Ent√£o nos perguntamos outra pergunta: "OK, qual √© o motivo dessa duplica√ß√£o de c√≥digo?" <br><br>  E ent√£o ocorreu-nos: o problema, de fato, √© que nosso front-end n√£o recebe dados na estrutura atual da API.  O front-end n√£o sabe nada sobre os modelos que existem na API at√© que n√≥s mesmos o informemos. <br><br>  E ent√£o tivemos a ideia: e se construirmos a arquitetura do aplicativo de tal maneira que: <br><br><ul><li>  O front-end recebido da API n√£o apenas os dados do modelo, mas tamb√©m a estrutura desses modelos; </li><li>  Representa√ß√µes formadas dinamicamente de front-end com base na estrutura dos modelos; </li><li>  Qualquer altera√ß√£o na estrutura da API era exibida automaticamente no front-end. </li></ul><br>  A implementa√ß√£o de um novo recurso levar√° muito menos tempo, porque exigir√° altera√ß√µes apenas no lado de back-end, e o front-end coletar√° automaticamente tudo e o apresentar√° ao usu√°rio corretamente. <br><br><h2>  A versatilidade da nova arquitetura </h2><br>  E ent√£o decidimos pensar um pouco mais amplamente: a nova arquitetura √© adequada apenas para o nosso aplicativo atual ou podemos us√°-lo em outro lugar? <br><br><img src="https://habrastorage.org/webt/og/ay/ju/ogayjuenpbmvwxxlrxpm09banza.png" alt="Recursos comuns a muitos aplicativos da web"><br><br>  De fato, de um jeito ou de outro, quase todos os aplicativos t√™m parte de uma funcionalidade semelhante: <br><br><ul><li>  quase todos os aplicativos possuem usu√°rios e, nesse sentido, √© necess√°rio ter funcionalidades associadas ao registro e autoriza√ß√£o do usu√°rio; </li><li>  quase todos os aplicativos t√™m v√°rios tipos de visualiza√ß√µes: existe uma visualiza√ß√£o para exibir uma lista de objetos de um modelo, existe uma visualiza√ß√£o para exibir um registro detalhado de um √∫nico objeto de modelo individual; </li><li>  quase todos os modelos t√™m atributos semelhantes no tipo: dados de seq√º√™ncia, n√∫meros etc., e, nesse sentido, voc√™ precisa trabalhar com eles no back-end e no front-end. </li></ul><br>  E como nossa empresa geralmente realiza o desenvolvimento de aplicativos Web personalizados, pensamos: por que precisamos reinventar a roda todas as vezes e desenvolver funcionalidades semelhantes todas as vezes do zero, se voc√™ pode escrever uma estrutura uma vez que descreva tudo o b√°sico, comum para muitos aplicativos, coisas e, em seguida, criando um novo projeto, use desenvolvimentos prontos como depend√™ncias e, se necess√°rio, altere-os declarativamente em um novo projeto. <br><br>  Assim, durante uma longa discuss√£o, tivemos a ideia de criar VSTUtils - uma estrutura que: <br><br><ol><li>  Continha a funcionalidade b√°sica, mais semelhante √† maioria dos aplicativos; </li><li>  Permitido gerar front-end em tempo real, com base na estrutura da API. </li></ol><br><h2>  Como fazer amigos back-end e front-end? </h2><br>  Bem, ent√£o temos que fazer, pensamos.  J√° t√≠nhamos um back-end, um front-end tamb√©m, mas nem o servidor nem o cliente tinham uma ferramenta que pudesse relatar ou receber dados sobre a estrutura da API. <br><br>  Na busca de uma solu√ß√£o para esse problema, nossos olhos se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">voltaram para a</a> especifica√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenAPI</a> , que, com base na descri√ß√£o dos modelos e nos relacionamentos entre eles, gera um enorme JSON contendo todas essas informa√ß√µes. <br><br>  E pensamos que, em teoria, ao inicializar o aplicativo no cliente, o front-end pode receber esse JSON da API e criar todas as visualiza√ß√µes necess√°rias com base.  Resta apenas ensinar nosso front-end a fazer tudo isso. <br><br>  E depois de algum tempo n√≥s o ensinamos. <br><br><h2>  Vers√£o 1.0 - o que saiu dela </h2><br>  A arquitetura da estrutura VSTUtils das primeiras vers√µes consistia em 3 partes condicionais e era algo assim: <br><br><ol><li>  <b>Back end:</b> <br><ul><li>  <u>Django e Python</u> s√£o todos modelos relacionados √† l√≥gica.  Com base no modelo b√°sico do Django, criamos v√°rias classes de modelos principais do VSTUtils.  Todas as a√ß√µes que esses modelos podem executar foram implementadas usando Python; <br></li><li>  <u>Django REST Framework</u> - gera√ß√£o de API REST.  Com base na descri√ß√£o dos modelos, uma API REST √© formada, gra√ßas √† qual o servidor e o cliente se comunicam; <br></li></ul></li><li>  <b>Intercamada entre back-end e front-end:</b> <br><ul><li>  <u>Gera√ß√£o OpenAPI</u> - JSON com uma descri√ß√£o da estrutura da API.  Depois que todos os modelos foram descritos no backend, s√£o criadas visualiza√ß√µes para eles.  A adi√ß√£o de cada uma das visualiza√ß√µes introduz as informa√ß√µes necess√°rias no JSON resultante: <br><div class="spoiler">  <b class="spoiler_title">Exemplo JSON - Esquema OpenAPI</b> <div class="spoiler_text"><pre><code class="json hljs">{ // ,     (, ), //   -  , //  -     . definitions: { //    Hook. Hook: { // ,     (, ), //   -   , //  -       (,    ..). properties: { id: { title: <span class="hljs-string"><span class="hljs-string">"Id"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"integer"</span></span>, readOnly: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }, name: { title: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, minLength:<span class="hljs-number"><span class="hljs-number">1</span></span>, maxLength: <span class="hljs-number"><span class="hljs-number">512</span></span>, }, type: { title: <span class="hljs-string"><span class="hljs-string">"Type"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, enum: [<span class="hljs-string"><span class="hljs-string">"HTTP"</span></span>,<span class="hljs-string"><span class="hljs-string">"SCRIPT"</span></span>], }, when: { title: <span class="hljs-string"><span class="hljs-string">"When"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, enum: [<span class="hljs-string"><span class="hljs-string">"on_object_add"</span></span>,<span class="hljs-string"><span class="hljs-string">"on_object_upd"</span></span>,<span class="hljs-string"><span class="hljs-string">"on_object_del"</span></span>], }, enable: { title:<span class="hljs-string"><span class="hljs-string">"Enable"</span></span>, type:<span class="hljs-string"><span class="hljs-string">"boolean"</span></span>, }, recipients: { title: <span class="hljs-string"><span class="hljs-string">"Recipients"</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, minLength: <span class="hljs-number"><span class="hljs-number">1</span></span>, } }, // ,     ,    . required: [<span class="hljs-string"><span class="hljs-string">"type"</span></span>,<span class="hljs-string"><span class="hljs-string">"recipients"</span></span>], } }, // ,     (, ), //   -   ( URL), //  -     . paths: { //      '/hook/'. '/hook/': { //    get    /hook/. //  ,       Hook. get: { operationId: <span class="hljs-string"><span class="hljs-string">"hook_list"</span></span>, description: <span class="hljs-string"><span class="hljs-string">"Return all hooks."</span></span>, // ,       ,     . parameters: [ { name: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, in: <span class="hljs-string"><span class="hljs-string">"query"</span></span>, description: <span class="hljs-string"><span class="hljs-string">"A unique integer value (or comma separated list) identifying this instance."</span></span>, required: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, }, { name: <span class="hljs-string"><span class="hljs-string">"name"</span></span>, in: <span class="hljs-string"><span class="hljs-string">"query"</span></span>, description: <span class="hljs-string"><span class="hljs-string">"A name string value (or comma separated list) of instance."</span></span>, required: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, }, { name: <span class="hljs-string"><span class="hljs-string">"type"</span></span>, in: <span class="hljs-string"><span class="hljs-string">"query"</span></span>, description: <span class="hljs-string"><span class="hljs-string">"Instance type."</span></span>, required: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, type: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, }, ], // ,     (, ), //   -   ; //  -   . responses: { 200: { description: <span class="hljs-string"><span class="hljs-string">"Action accepted."</span></span>, schema: { properties: { results: { type: <span class="hljs-string"><span class="hljs-string">"array"</span></span>, items: { //   ,       . $ref: <span class="hljs-string"><span class="hljs-string">"#/definitions/Hook"</span></span>, }, }, }, }, }, 400: { description: <span class="hljs-string"><span class="hljs-string">"Validation error or some data error."</span></span>, schema: { $ref: <span class="hljs-string"><span class="hljs-string">"#/definitions/Error"</span></span>, }, }, 401: { // ... }, 403: { // ... }, 404: { // ... }, }, tags: [<span class="hljs-string"><span class="hljs-string">"hook"</span></span>], }, //    post    /hook/. //  ,       Hook. post: { operationId: <span class="hljs-string"><span class="hljs-string">"hook_add"</span></span>, description: <span class="hljs-string"><span class="hljs-string">"Create a new hook."</span></span>, parameters: [ { name: <span class="hljs-string"><span class="hljs-string">"data"</span></span>, in: <span class="hljs-string"><span class="hljs-string">"body"</span></span>, required: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, schema: { $ref: <span class="hljs-string"><span class="hljs-string">"#/definitions/Hook"</span></span>, }, }, ], responses: { 201: { description: <span class="hljs-string"><span class="hljs-string">"Action accepted."</span></span>, schema: { $ref: <span class="hljs-string"><span class="hljs-string">"#/definitions/Hook"</span></span>, }, }, 400: { description: <span class="hljs-string"><span class="hljs-string">"Validation error or some data error."</span></span>, schema: { $ref: <span class="hljs-string"><span class="hljs-string">"#/definitions/Error"</span></span>, }, }, 401: { // ... }, 403: { // ... }, 404: { // ... }, }, tags: [<span class="hljs-string"><span class="hljs-string">"hook"</span></span>], }, } } }</code> </pre> </div></div></li></ul></li><li>  <b>Front-end:</b> <br><ul><li>  <u>JavaScript</u> √© um mecanismo que analisa um esquema OpenAPI e gera visualiza√ß√µes.  Esse mecanismo √© iniciado uma vez, quando o aplicativo √© inicializado no cliente.  Ao enviar uma solicita√ß√£o para a API, ela recebe o JSON solicitado em resposta com uma descri√ß√£o da estrutura da API e, analisando-a, cria todos os objetos JS necess√°rios que cont√™m os par√¢metros das representa√ß√µes do modelo.  Como a solicita√ß√£o da API √© bastante pesada, n√≥s a armazenamos em cache e solicitamos novamente somente ao atualizar a vers√£o do aplicativo; </li><li>  <u>Bibliotecas JavaScript SPA</u> - exibindo visualiza√ß√µes e roteando entre elas.  Essas bibliotecas foram escritas por um de nossos desenvolvedores de front-end.  Quando um usu√°rio acessa uma p√°gina espec√≠fica, o mecanismo de renderiza√ß√£o desenha a p√°gina com base nos par√¢metros armazenados nos objetos de representa√ß√£o JS. </li></ul></li></ol><br>  Assim, o que temos: temos um back-end que descreve toda a l√≥gica associada aos modelos.  Em seguida, o OpenAPI entra no jogo, que, com base na descri√ß√£o do modelo, gera JSON com uma descri√ß√£o da estrutura da API.  Em seguida, o bast√£o √© transmitido ao cliente, que, analisando o OpenAPI JSON gerado, gera automaticamente uma interface da web. <br><br><h2>  Incorporando recursos no aplicativo √† nova arquitetura - como funciona </h2><br>  Lembre-se da tarefa de adicionar ganchos personalizados?  Veja como implement√°-lo em um aplicativo baseado em VSTUtils: <br><br><img src="https://habrastorage.org/webt/ud/yr/af/udyrafi5o5grqlzqovkat8ursko.png" alt="O processo de adicionar novos recursos √† nova arquitetura"><br><br>  Agora, gra√ßas ao VSTUtils, n√£o precisamos escrever nada do zero.  Aqui est√° o que fazemos para adicionar a capacidade de criar ganchos personalizados: <br><br><ol><li>  No back-end: pegamos e herdamos da classe mais adequada no VSTUtils, adicionamos novas funcionalidades espec√≠ficas ao novo modelo; </li><li>  No front-end: <br><ul><li>  se a visualiza√ß√£o deste modelo n√£o for diferente da visualiza√ß√£o b√°sica do VSTUtils, n√£o faremos nada, tudo ser√° automaticamente exibido corretamente; </li><li>  se voc√™ precisar, de alguma forma, alterar o comportamento da visualiza√ß√£o, usando o mecanismo de sinal, declaramos expandir ou alterar completamente o comportamento b√°sico da visualiza√ß√£o. <br></li></ul></li></ol><br>  Como resultado, obtivemos uma solu√ß√£o muito boa, alcan√ßamos nosso objetivo, nosso front-end foi gerado automaticamente.  O processo de introdu√ß√£o de novos recursos em projetos existentes acelerou-se notavelmente: lan√ßamentos come√ßaram a ser lan√ßados a cada 2 semanas, enquanto anteriormente lan√ß√°vamos lan√ßamentos a cada 2-3 meses com um n√∫mero muito menor de novos recursos.  Gostaria de observar que a equipe de desenvolvimento permaneceu a mesma, foi a nova arquitetura de aplicativos que nos deu os frutos. <br><br><h2>  Vers√£o 1.0 - nossos cora√ß√µes exigem mudan√ßa </h2><br>  Mas, como voc√™ sabe, n√£o h√° limite para a perfei√ß√£o, e o VSTUtils n√£o foi exce√ß√£o. <br><br>  Apesar de termos conseguido automatizar a forma√ß√£o do front-end, o resultado n√£o foi a solu√ß√£o direta que originalmente quer√≠amos. <br><br>  A arquitetura do aplicativo do lado do cliente n√£o foi totalmente pensada e acabou n√£o sendo t√£o flex√≠vel quanto poderia ser: <br><br><ul><li>  o processo de introdu√ß√£o de sobrecargas funcionais nem sempre foi conveniente; </li><li>  O mecanismo de an√°lise OpenAPI n√£o era o ideal; </li><li>  a renderiza√ß√£o de representa√ß√µes e o roteamento entre elas foram realizadas usando bibliotecas auto-escritas, o que tamb√©m n√£o nos convinha por v√°rias raz√µes: <br><ul><li>  Essas bibliotecas n√£o foram cobertas por testes; </li><li>  n√£o havia documenta√ß√£o para essas bibliotecas; </li><li>  eles n√£o tinham comunidade - no caso de detectar bugs ou sair do funcion√°rio que os escreveu, o suporte a esse c√≥digo seria muito dif√≠cil. </li></ul></li></ul><br>  E como em nossa empresa aderimos √† abordagem DevOps e tentamos padronizar e formalizar nosso c√≥digo o m√°ximo poss√≠vel, em fevereiro deste ano, decidimos realizar uma refatora√ß√£o global da estrutura de front-end do VSTUtils.  Tivemos v√°rias tarefas: <br><br><ul><li>  para formar n√£o apenas classes de apresenta√ß√£o no front-end, mas tamb√©m classes de modelo - percebemos que seria mais correto separar os dados (e sua estrutura) da apresenta√ß√£o.  Al√©m disso, a presen√ßa de v√°rias abstra√ß√µes na forma de uma representa√ß√£o e um modelo facilitaria bastante a adi√ß√£o de sobrecargas da funcionalidade b√°sica em projetos baseados em VSTUtils; </li><li>  use uma estrutura testada com uma grande comunidade (Angular, React, Vue) para renderiza√ß√£o e roteamento - isso nos permitir√° liberar toda a dor de cabe√ßa com suporte ao c√≥digo relacionado √† renderiza√ß√£o e roteamento dentro de nosso aplicativo. </li></ul><br><h2>  Refatora√ß√£o - escolha da estrutura JS </h2><br>  Entre os frameworks JS mais populares: Angular, React, Vue, nossa escolha ficou com o Vue porque: <br><br><ul><li>  A base de c√≥digo do Vue pesa menos que React e Angular; <br><br>  <i>Tabela de compara√ß√£o de tamanho de estrutura compactada com Gzip</i> <br><div class="scrollable-table"><table><tbody><tr><th>  Enquadramento </th><th>  Tamanho, kb </th></tr><tr><td>  Angular 2 </td><td>  111 </td></tr><tr><td>  Angular 2 + RX </td><td>  143 </td></tr><tr><td>  Angular 1.4.5 </td><td>  51 </td></tr><tr><td>  Reagir 0.14.5 + Reagir DOM </td><td>  40. </td></tr><tr><td>  Reagir 0.14.5 + Reagir DOM + Redux </td><td>  42. </td></tr><tr><td>  Reagir 15.3.0 + Reagir DOM </td><td>  43 </td></tr><tr><td>  Vue 2.4.2 </td><td>  21 </td></tr></tbody></table></div></li><li>  O processo de renderiza√ß√£o da p√°gina do Vue leva <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">menos</a> tempo que React e Angular; <br><img src="https://habrastorage.org/webt/lo/eu/6m/loeu6mow9u1qbcz3nbanmldjmwu.png" alt="comparando a velocidade de renderiza√ß√£o da p√°gina com diferentes estruturas javascript em rela√ß√£o ao javascript puro"></li><li>  O limite de entrada no Vue √© muito menor que no React e Angular; </li><li>  Sintaxe nativamente compreens√≠vel de modelos; </li><li>  Documenta√ß√£o elegante e detalhada dispon√≠vel em v√°rios idiomas, incluindo russo; </li><li>  Um ecossistema desenvolvido que fornece, al√©m da biblioteca principal do Vue, bibliotecas para roteamento e cria√ß√£o de um armaz√©m de dados reativo. </li></ul><br><h2>  Vers√£o 2.0 - o resultado da refatora√ß√£o de front-end </h2><br>  O processo de refatora√ß√£o global do front-end do VSTUtils levou cerca de 4 meses e foi assim que terminamos: <br><br><img src="https://habrastorage.org/webt/6a/wr/9k/6awr9kuruhmeq9gey-isefn_21u.png" alt="nova arquitetura VSTUtils fron-end"><br><br>  A estrutura front-end do VSTUtils ainda consiste em dois grandes blocos: o primeiro est√° envolvido na an√°lise do esquema OpenAPI, o segundo est√° renderizando visualiza√ß√µes e roteamento entre eles, mas esses dois blocos sofreram v√°rias altera√ß√µes significativas. <br><br>  O mecanismo que analisa o esquema OpenAPI foi completamente reescrito.  A abordagem para analisar esse esquema mudou.  Tentamos tornar a arquitetura front-end o mais semelhante poss√≠vel √† arquitetura back-end.  Agora, no lado do cliente, n√£o temos apenas uma √∫nica abstra√ß√£o na forma de representa√ß√µes, agora tamb√©m temos abstra√ß√µes na forma de modelos e QuerySets: <br><br><ul><li>  objetos da classe Model e seus descendentes s√£o objetos correspondentes √†s abstra√ß√µes do servidor do Django Models no lado do servidor.  Objetos desse tipo cont√™m dados sobre a estrutura do modelo (nome do modelo, campos do modelo etc.); </li><li>  objetos da classe QuerySet e seus descendentes s√£o objetos correspondentes √† abstra√ß√£o do Django QuerySets do servidor.  Objetos desse tipo cont√™m m√©todos que permitem executar solicita√ß√µes de API (adicionar, modificar, receber, excluir dados de objetos de modelo); </li><li>  objetos da classe View - objetos que armazenam dados sobre como representar o modelo em uma p√°gina espec√≠fica, qual modelo usar para "renderizar" a p√°gina, quais outras representa√ß√µes dos modelos aos quais esta p√°gina pode vincular etc. </li></ul><br>  A unidade respons√°vel pela renderiza√ß√£o e roteamento tamb√©m mudou significativamente.  Abandonamos as bibliotecas JS SPA auto-escritas em favor dos Vue.js.  Desenvolvemos nossos pr√≥prios componentes Vue que comp√µem todas as p√°ginas de nosso aplicativo da web.  O roteamento entre visualiza√ß√µes √© feito usando a biblioteca vue-router, e usamos vuex como o armazenamento reativo do estado do aplicativo. <br><br>  Tamb√©m gostaria de observar que, no front-end, a implementa√ß√£o das classes Model, QuerySet e View n√£o depende dos meios de renderiza√ß√£o e roteamento, ou seja, se queremos repentinamente mudar do Vue para outra estrutura, por exemplo, React ou algo novo, tudo o que precisamos fazer √© reescrever os componentes do Vue nos componentes da nova estrutura, reescrever o roteador, o reposit√≥rio e isso √© tudo - a estrutura do VSTUtils funcionar√° novamente.  A implementa√ß√£o das classes Model, QuerySet e View permanecer√° a mesma, pois n√£o depende do Vue.js.  Acreditamos que esta √© uma ajuda muito boa para poss√≠veis mudan√ßas futuras. <br><br><h2>  Resumir </h2><br>  Assim, a relut√¢ncia em escrever c√≥digo "duplicado" resultou na tarefa de automatizar a forma√ß√£o do front-end de um aplicativo da Web, resolvido com a cria√ß√£o da estrutura do VSTUtils.  Conseguimos construir a arquitetura do aplicativo da Web para que o back-end e o front-end se complementem harmoniosamente e qualquer altera√ß√£o na estrutura da API seja automaticamente captada e exibida corretamente no cliente. <br><br>  Os benef√≠cios que recebemos da formaliza√ß√£o da arquitetura do aplicativo Web: <br><br><ul><li>  As libera√ß√µes de aplicativos executados com base no VSTUtils come√ßaram a sair duas vezes mais frequentemente.  Isso se deve ao fato de que agora, para introduzir um novo recurso, geralmente precisamos adicionar c√≥digo apenas no back-end, o front-end ser√° gerado automaticamente - isso economiza tempo; </li><li>  Atualiza√ß√£o simplificada da funcionalidade b√°sica.  Como agora toda a funcionalidade b√°sica √© montada em uma estrutura, para atualizar algumas depend√™ncias importantes ou melhorar a funcionalidade b√°sica, precisamos fazer altera√ß√µes em apenas um local - na base de c√≥digo do VSTUtils.  Ao atualizar a vers√£o do VSTUtils em projetos filhos, todas as inova√ß√µes ser√£o selecionadas automaticamente; </li><li>  Encontrar novos funcion√°rios ficou mais f√°cil.  Concordo, √© muito mais f√°cil encontrar um desenvolvedor para uma pilha de tecnologia formalizada (Django, Vue) do que procurar uma pessoa que concorda em trabalhar com um gravador desconhecido.  Resultados de pesquisa para desenvolvedores que mencionaram Django ou Vue no HeadHunter em seus curr√≠culos (em todas as regi√µes): <br><ul><li>  Django - 3.454 curr√≠culos foram encontrados para 3.136 candidatos; </li><li>  Vue - 4.092 curr√≠culos foram encontrados para 3.747 candidatos a emprego. </li></ul></li></ul><br>  As desvantagens dessa formaliza√ß√£o da arquitetura de um aplicativo Web incluem o seguinte: <br><br><ul><li>  Devido √† an√°lise do esquema OpenAPI, a inicializa√ß√£o do aplicativo no cliente demora um pouco mais do que antes (cerca de 20 a 30 milissegundos a mais); </li><li>  Indexa√ß√£o de pesquisa sem import√¢ncia.  O fato √© que, no momento, n√£o estamos usando a renderiza√ß√£o do servidor na estrutura do VSTUtils, e todo o conte√∫do do aplicativo √© formado na forma final j√° existente no cliente.  Por√©m, para nossos projetos, geralmente n√£o s√£o necess√°rios resultados altos de pesquisa e, para n√≥s, isso n√£o √© t√£o cr√≠tico. </li></ul><br>  Nisto minha hist√≥ria chega ao fim, muito obrigado pela aten√ß√£o! <br><br><h2>  Links √∫teis </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Especifica√ß√£o OpenAPI</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Reposit√≥rio VSTUtils</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um projeto de exemplo criado com base no VSTUtils</a> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt456146/">https://habr.com/ru/post/pt456146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt456132/index.html">Sobre a grava√ß√£o de bugs ou Encontre um gato</a></li>
<li><a href="../pt456134/index.html">Confie, mas verifique! Como testar seu modelo usando a nuvem IBM (Watson OpenScale)</a></li>
<li><a href="../pt456136/index.html">Por que fazemos o Enterprise Service Mesh</a></li>
<li><a href="../pt456140/index.html">Conhe√ßa o Codeception 3.0</a></li>
<li><a href="../pt456144/index.html">KubeCon EU 2019: 10 principais conclus√µes</a></li>
<li><a href="../pt456148/index.html">Not√≠cias da semana: Facebook recusa Huawei em aplicativos, Aurora OS em vez de Android, multas por minera√ß√£o</a></li>
<li><a href="../pt456150/index.html">Petty little joy # 4: Radon - qualidade do c√≥digo medida em n√∫meros</a></li>
<li><a href="../pt456152/index.html">Padr√µes de Design de N√≠vel para Jogos 2D</a></li>
<li><a href="../pt456154/index.html">Recursos principais do UX e MVP ao criar um produto</a></li>
<li><a href="../pt456156/index.html">√â por isso que a √°lgebra escolar √© necess√°ria.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>