<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïâÔ∏è üôÖüèø ü¶Ä Tetera WiFi en casa, o c√≥mo hacer que una tetera normal sea realmente inteligente üëÉüèø üö± üóΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√≥logo
 
 Si ley√≥ mi art√≠culo anterior ( Running line on Arduino ), entonces probablemente ya sepa que tenemos la oportunidad de realizar proyectos d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tetera WiFi en casa, o c√≥mo hacer que una tetera normal sea realmente inteligente</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393785/"><img src="https://habrastorage.org/files/13e/789/ac5/13e789ac5ab64c99bb2243540c6188bc.jpg" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√≥logo</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si ley√≥ mi art√≠culo anterior ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Running line on Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), entonces probablemente ya sepa que tenemos la oportunidad de realizar proyectos de cursos de hardware en nuestra universidad. </font><font style="vertical-align: inherit;">Y yo, inspirado en mi trabajo anterior, decid√≠ intentar nuevamente hacer algo con mis propias manos. </font><font style="vertical-align: inherit;">Solo que ahora el tema deber√≠a haber sido m√°s serio. </font><font style="vertical-align: inherit;">Por cierto, comenc√© a pensar qu√© hacer durante las vacaciones de invierno, es decir, antes del semestre. </font><font style="vertical-align: inherit;">Quer√≠a hacer algo interesante y √∫til al mismo tiempo.</font></font><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Busca una idea</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez, en un par de Fundamentos de la protecci√≥n de la informaci√≥n, tuvimos un tema relacionado con la propiedad intelectual y las patentes. El profesor nos dio la tarea de emitir una patente para cualquier dispositivo de acuerdo con todos los requisitos y cit√≥ un hervidor wifi como ejemplo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âl dijo, y se olvid√≥. Y todos lo olvidaron, pero en mi cabeza este tema se mantuvo. Y cuando lleg√≥ el momento de pensar qu√© hacer como curso en el pr√≥ximo semestre, record√© sobre esta tetera. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo primero que decid√≠ ver es lo que ya se ha hecho. Y cu√°l fue mi sorpresa cuando vi que solo hay tres modelos de mu√±ecos con soporte de control WiFi a la venta, y luego dos de ellos pertenecen a la misma compa√±√≠a. Estos fueron Smarter iKettle 1.0 y 2.0 y el Russian Polaris PWK 1792CGL.</font></font><br>
<br>
<img src="https://psv4.vk.me/c615220/u9412861/docs/0ad68e7b3b82/imgonline-com-ua-twotoonefP6QyHRwpyGH.jpg?extra=DYIN0iLJbtamO0yymkG01568IjGjd-b5TPTlrxOGOg9GKUkRFG9qAbzX7whoNtLphkadbiiUq9AIz1X7jxfJ5trWX89OM_uDNpnwCw7j1tyXwPGFSsnL" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es interesante que casi todas las casas tengan hervidores el√©ctricos ordinarios, y hay muy pocos inteligentes. </font><font style="vertical-align: inherit;">Comparando las caracter√≠sticas ofrecidas por iKettle y Polaris, hice una lista de las m√°s necesarias. </font><font style="vertical-align: inherit;">Esto es lo que sucedi√≥:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encender / apagar desde un tel√©fono inteligente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ajuste de cualquier temperatura para calentar agua;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la capacidad de averiguar la temperatura actual;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seguimiento del volumen actual de agua en el hervidor de agua;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">advertencia y protecci√≥n contra el encendido con un peque√±o volumen de agua;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">establecer el tiempo de activaci√≥n autom√°tica;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aviso de disponibilidad;</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece real, es hora de ponerse manos a la obra.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Busque los componentes requeridos</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como no era posible hacer un hervidor completamente nuevo, se decidi√≥ modificar uno el√©ctrico ordinario ya hecho. Justo en casa hab√≠a una tetera hu√©rfana con un interruptor roto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entonces, la base ya est√° all√≠, pens√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora ten√≠a que empezar a buscar componentes para el hardware. Como ya hab√≠a poca experiencia trabajando con Arduino, decid√≠ implementar todo en √©l. Por otra parte, Arduin y sus m√≥dulos son econ√≥micos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como tuve que insertar toda la parte del control del hervidor dentro del hervidor, la elecci√≥n recay√≥ en el Arduino Nano. Es peque√±o y tiene una interfaz para conectar un cable, a diferencia del Pro Mini, que debe flashearse a trav√©s de UART.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/bd1/d8a/273/bd1d8a273b5189fb42cdd0834246dbc4.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El componente principal de un hervidor wifi es, por supuesto, un m√≥dulo wifi. Al buscar en Internet algo asequible y muchos tutoriales, me encontr√© con el ESP8266. A saber, en la versi√≥n 01. Parec√≠a que era econ√≥mico (alrededor de $ 2) y hab√≠a muchas instrucciones para conectarse. Detenido en eso. En cuanto al m√≥dulo en s√≠, la frase aqu√≠ es buena: barata y alegre. Pero m√°s sobre eso m√°s tarde. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a39/db0/0e5/a39db00e5e05bc51f4c727c9b75ee18a.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para controlar la temperatura, necesit√°bamos alg√∫n tipo de sensor de temperatura a prueba de agua. Encontr√© un termistor NTC a prueba de agua en aliexpress, que puede soportar temperaturas de m√°s de 100 grados. Tambi√©n encontr√© un ejemplo de trabajar con √©l, as√≠ que aqu√≠ decid√≠ r√°pidamente.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/205/649/1b9/2056491b9c4e3906446017711d069826.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Era necesario decidir c√≥mo encender el hervidor de agua en un punto dado en el tiempo, por supuesto, podr√≠a hacer que el programa registre en Arduino y encender el hervidor si el tiempo coincid√≠a, pero esto funcionar√≠a de manera inestable, y si el programa se reiniciara accidentalmente, todo saldr√≠a mal. Por lo tanto, un reloj en tiempo real vino al rescate aqu√≠. A saber DS1307. Tienen alimentaci√≥n independiente (de una bater√≠a de 3 V), y tambi√©n hab√≠a un chip de memoria EEPROM de 32K bits en el m√≥dulo en el que par√©, que us√© para guardar el tiempo de encendido. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f8b/6d4/3e1/f8b6d43e1e1ddcf1ab573ad49bec80f3.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ah, s√≠, dado que el hervidor ahora deber√≠a encenderse program√°ticamente, tambi√©n necesitaba un rel√© de 1 canal. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/be1/f74/46d/be1f7446d29e3cdcc3a226860e31d01d.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cuanto al sensor de nivel de l√≠quido, ten√≠a que hacerse manualmente. Detalles a continuaci√≥n.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Del resto, todav√≠a se necesitaban varias resistencias de diferentes denominaciones, una placa de pruebas, una placa de circuito para la instalaci√≥n real, el cableado, un soldador con fundente y soldadura, y la mayor parte de la paciencia.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicio del desarrollo</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dado que el proyecto es un hervidor wifi, lo primero que quer√≠a y necesitaba para lidiar con el m√≥dulo wifi. </font><font style="vertical-align: inherit;">Tan pronto como lleg√≥ el paquete, lo desempaqu√© inmediatamente y comenc√© a conectarme. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontr√© un mont√≥n de ejemplos en Internet. </font><font style="vertical-align: inherit;">Todo est√° como deber√≠a, regulador de voltaje de 3.3 V, divisores de voltaje para RX y TX. </font><font style="vertical-align: inherit;">Recopil√© todo con el ejemplo, lo conect√©, ¬°no vol√≥! </font><font style="vertical-align: inherit;">Se mostr√≥ un mont√≥n de texto en el monitor del puerto COM, ya que result√≥ que el m√≥dulo se reiniciaba constantemente. </font><font style="vertical-align: inherit;">No responde a los comandos AT enviados. </font><font style="vertical-align: inherit;">El autor del art√≠culo funciona, yo no.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cual es el problema Trat√© de buscar otros esquemas de conexi√≥n, y as√≠ sucesivamente, pero el m√≥dulo todav√≠a se restablece o no muestra nada. Y en todas partes est√° escrito en letra roja: "No aplique al m√≥dulo de 5 V, de lo contrario fallar√°". Entonces, la b√∫squeda de soluciones a veces duraba por las tardes, ya estaba pensando en comprar otro m√≥dulo, pero decid√≠ verificar el voltaje con un mult√≠metro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Result√≥ que cuando el m√≥dulo est√° conectado a 3.3 V, el voltaje cae por debajo de 3.2 V. Parece que, bueno, est√° bien, cae y cae. Decid√≠ alimentarlo desde otra fuente de alimentaci√≥n y result√≥ que el m√≥dulo funciona normalmente con un voltaje por encima de 3.2 V, y por debajo no es suficiente y se reinicia constantemente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, bajo mi propio riesgo y riesgo, lo conect√© a 5 V y todo funcion√≥ y a√∫n funciona bien. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d5d/17e/780/d5d17e7804c34c46a595c059100295e1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No hubo tales problemas con otros componentes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de descubrir el wifi, tuve que decidir qu√© hacer con el sensor de nivel de l√≠quido. Buscando en Google, encontr√© un art√≠culo en el que el autor hizo un sensor de humedad del suelo. Cuando el suelo se seca, la resistencia del sensor aumenta y el voltaje en el puerto anal√≥gico de Arduino aumenta. Al detectar un cambio en el voltaje, se puede detectar la apariencia de un l√≠quido. En lugar de dos contactos, se us√≥ 6 para determinar el nivel de l√≠quido en mi proyecto, uno de ellos est√° conectado a la salida de 5 V y el resto a las entradas anal√≥gicas y resistencias de 10 kŒ© a GND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ hay fotos de las pruebas. </font></font><br>
<br>
<img src="https://habrastorage.org/files/43c/536/5fd/43c5365fd8464326bf5b4eee5bfbe806.jpg"><br>
<img src="https://habrastorage.org/files/c99/d28/fee/c99d28fee740489a9b3893e4f9fdd418.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqu√≠ est√° el sensor de nivel que es el resultado.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b1e/2bb/10d/b1e2bb10db5f4e7ea647a746bc7e039c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo siguiente que prob√© es el reloj en tiempo real. </font><font style="vertical-align: inherit;">Pero trabajar con ellos es b√°sicamente simple. </font><font style="vertical-align: inherit;">Para establecer el tiempo y obtener informaci√≥n al respecto, utilic√© exclusivamente ejemplos que vienen con la biblioteca para trabajar con DS1307. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, cuando todo se ensambl√≥ en una placa de pruebas, obtuvimos ese cruce entre cables y m√≥dulos. </font><font style="vertical-align: inherit;">Por cierto, en estas fotos hay otro sensor de temperatura.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2f9/74d/288/2f974d288e8b43b0ab3612641a985f0e.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comenzando</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora todo esto ten√≠a que soldarse en la placa de circuito. </font><font style="vertical-align: inherit;">No hay nada especial para comentar, as√≠ que solo una foto. </font><font style="vertical-align: inherit;">Como puede ver, se agreg√≥ otro bot√≥n para que pueda encender el hervidor no solo desde un tel√©fono inteligente, sino tambi√©n de la manera habitual. </font></font><br>
<br>
<img src="https://habrastorage.org/files/98a/ad1/920/98aad19203204e46a644e52c9f905af0.jpg"><br>
<img src="https://habrastorage.org/files/995/592/45e/99559245edb048699172208c2584b689.jpg"><br>
<img src="https://habrastorage.org/files/2dd/594/23c/2dd59423cb0a447295593b52da781dd5.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A continuaci√≥n, debe colocar todo dentro de la tetera. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/50e/bf8/9cb50ebf8d05486babe76682ce68fddf.jpg"><br>
<img src="https://habrastorage.org/files/39d/b11/53b/39db1153b86c4592862b1b2f66531252.jpg"><br>
<img src="https://habrastorage.org/files/605/7db/1e6/6057db1e6ead493c81d399e164b399d4.jpg"><br>
<img src="https://habrastorage.org/files/853/6fc/00e/8536fc00ead6460ab5e581029bbdaf64.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se agreg√≥ un inserto de asbesto para proteger todos los interiores del sobrecalentamiento. </font></font><br>
<br>
<img src="https://habrastorage.org/files/027/99a/f36/02799af362264b6682b3355bae815b9c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es cierto que el caso tuvo que ser ligeramente elevado con un inserto de pl√°stico adicional.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ec3/06e/ab8/ec306eab83114666a94c62b33f9ce6f2.jpg"><br>
<img src="https://habrastorage.org/files/836/47b/9ac/83647b9ac23a43c7bd39ec57c4b2807c.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora ve a la parte m√≥vil.</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cuanto a la aplicaci√≥n, ya que se desarroll√≥ bajo el sistema operativo Android, originalmente se plane√≥ usar Android Studio. Pero para estudiar nuevas tecnolog√≠as, se decidi√≥ utilizar una plataforma preparada para desarrollar programas en el campo de Internet de las cosas. Como resultado, la elecci√≥n recay√≥ en el producto Evothings: Evothings Studio. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/74f/e14/7b1/74fe147b1a99d6a7fd6dd0b6a01ac2a2.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estas son sus principales ventajas: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Una gran cantidad de ejemplos est√°ndar sobre el trabajo con varios m√≥dulos (Wifi, Bluetooth); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - desarrollo de aplicaciones usando JS, HTML, CSS, que le permite escribir un c√≥digo que funcionar√° igualmente en Android e iOS, es decir desaparece el enlace a una sola plataforma;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - facilidad para probar la aplicaci√≥n: se instala una aplicaci√≥n en el tel√©fono inteligente para previsualizar su desarrollo, y todos los mensajes de prueba y mensajes de error se muestran en el programa en la computadora; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Una gran cantidad de informaci√≥n en Internet sobre el desarrollo utilizando JS, HTML, CSS; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este Estudio Evothings hubo un ejemplo de encender el LED transmitiendo una solicitud de encendido a trav√©s del ESP8266. Decid√≠ tomar este ejemplo como base, porque era lo m√°s valioso para m√≠: la comunicaci√≥n con el m√≥dulo WiFi a trav√©s del z√≥calo tcp. Y de manera similar a c√≥mo se transmiti√≥ la solicitud de encender el LED, solicit√© actualizar los sensores del hervidor, configurar el tiempo de encendido, configurar la temperatura, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego atornill√© las notificaciones de disponibilidad y una peque√±a cantidad de agua, el beneficio es que todo en nuestro tiempo se busca f√°cilmente en Google. </font><font style="vertical-align: inherit;">El resultado es una aplicaci√≥n de este tipo (lo bueno es hacer la interfaz de la aplicaci√≥n usando CSS):</font></font><br>
<br>
<img src="https://habrastorage.org/files/0b9/985/b2d/0b9985b2d0fb4c97bb36d4ebeb772ab6.jpg"><br>
<img src="https://habrastorage.org/files/431/aaa/445/431aaa44557d42de996527f587d8691f.jpg"><br>
<img src="https://habrastorage.org/files/e3a/f8d/fb1/e3af8dfb13764be2b2b9e9acbad28769.jpg"><br>
<img src="https://habrastorage.org/files/9c0/db4/c6e/9c0db4c6e1b44b0f86f725b5e75a265a.jpg"><br>
<img src="https://habrastorage.org/files/80a/7ff/90f/80a7ff90f43b46e197fdfc3594297e1a.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una breve descripci√≥n de la interacci√≥n del tel√©fono inteligente y el hervidor de agua.</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La comunicaci√≥n entre el servidor y el cliente se realiza mediante el m√≥dulo WiFi. Cuando enciende el m√≥dulo de control del hervidor, el m√≥dulo WiFi comienza a distribuir una red llamada artKettle. Esto se realiza mediante comandos AT en el lado del servidor. Entonces, por ejemplo, para poner el m√≥dulo en modo de punto de acceso, necesita enviar el comando AT + CWMODE = 2. Luego, con estos comandos, debe asignar par√°metros de red, permitir la conexi√≥n de varios dispositivos y obtener la direcci√≥n IP del wifi en s√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde el lado del cliente, la conexi√≥n se realiza a trav√©s de un puerto espec√≠fico y por la direcci√≥n IP del m√≥dulo wifi utilizando chrome.tcp.socket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de conectar el cliente al servidor, puede controlar el hervidor desde su tel√©fono inteligente. Considere el ejemplo de encender la tetera.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando hace clic en el bot√≥n de encendido en la aplicaci√≥n artKettle, se llama a la funci√≥n correspondiente de la inclusi√≥n de app.kettleOn (). </font><font style="vertical-align: inherit;">Dentro de esta funci√≥n, se transfieren dos l√≠neas al lado del servidor:</font></font><br>
<br>
<pre><code class="cpp hljs">app.sendString(<span class="hljs-string"><span class="hljs-string">'H'</span></span>);<font></font>
app.sendString(<span class="hljs-string"><span class="hljs-string">'U'</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente es el trabajo que ya est√° del lado de Arduino. </font><font style="vertical-align: inherit;">Despu√©s de que llega la primera l√≠nea con el car√°cter 'H', se ejecuta el siguiente c√≥digo:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(message.indexOf(<span class="hljs-string"><span class="hljs-string">"H"</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; waterDetected())  {<font></font>
      digitalWrite(POWER_PIN, LOW); <font></font>
      IS_ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"ON"</span></span>);<font></font>
      sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>); <font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero, verifica si hay agua en el hervidor llamando al m√©todo waterDetected (). </font><font style="vertical-align: inherit;">Considere la opci√≥n cuando haya agua en el hervidor de agua. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se aplica un nivel de bajo voltaje al pin de control del rel√©, que corresponde a su inclusi√≥n, es decir </font><font style="vertical-align: inherit;">circuito de alimentaci√≥n cierra:</font></font><br>
<pre><code class="cpp hljs">digitalWrite(POWER_PIN, LOW); 
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Luego, la bandera se establece para indicar que la tetera est√° encendida y se muestra un mensaje en la salida al monitor del puerto serie. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de eso, se llama a una funci√≥n que transmite un mensaje de respuesta al lado del cliente de que toda la inclusi√≥n fue exitosa:</font></font><br>
<br>
<pre><code class="cpp hljs">sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el lado del cliente, despu√©s de verificar el mensaje entrante, el bot√≥n de encendido se establece en el estado Encendido:</font></font><br>
<pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buf.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) == <span class="hljs-string"><span class="hljs-string">"ON"</span></span>) {<font></font>
	app.setButtonOn();<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de eso, el mensaje de texto se procesa con el car√°cter 'U' enviado desde el cliente al servidor. </font><font style="vertical-align: inherit;">Aqu√≠, de manera similar a la inclusi√≥n, se actualiza la informaci√≥n sobre la temperatura actual y el volumen de l√≠quido en el hervidor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, se organiza una comunicaci√≥n bidireccional entre el cliente y el servidor, de modo que cualquiera de ellos sepa sobre el estado del otro en un momento dado.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado del proyecto del curso, se desarroll√≥ una modificaci√≥n para un hervidor el√©ctrico convencional, que permite controlarlo desde un tel√©fono inteligente a trav√©s de wifi. Ahora esta tetera se puede atribuir a los representantes de Internet de las cosas. Logramos implementar completamente todas las funciones, por lo que ahora este hervidor de agua tiene las siguientes caracter√≠sticas: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - encendido / apagado desde un tel√©fono inteligente; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - ajuste de cualquier temperatura para calentar agua; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - la capacidad de averiguar la temperatura actual; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - seguimiento del volumen actual de agua en el hervidor de agua; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - advertencia y protecci√≥n contra el encendido con un peque√±o volumen de agua; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - establecer el tiempo para encender; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - notificaci√≥n de disponibilidad;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las ventajas del proyecto implementado son la accesibilidad de la base del elemento, porque todo lo que necesita se puede encontrar en las tiendas de componentes electr√≥nicos, la extensibilidad del proyecto. Dado que el hervidor de agua tiene todos los sensores necesarios instalados, puede modificarse mediante programaci√≥n y no ser peor que los an√°logos. Dada la versatilidad del m√≥dulo wifi utilizado, puede conectarlo a Internet y organizar el control del hervidor, estar en cualquier parte del mundo y usar el servicio en l√≠nea para procesar mensajes SMS, puede organizar la inclusi√≥n por SMS. Es decir el proyecto a√∫n es muy ampliable, hay oportunidades para esto, pero no se implementaron, ya que no formaban parte de los objetivos del proyecto que se estaba desarrollando.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, hay desventajas en el proyecto. </font><font style="vertical-align: inherit;">El primero es el funcionamiento inestable del m√≥dulo Wifi. </font><font style="vertical-align: inherit;">Un m√≥dulo a veces simplemente pierde su red, comienza a restablecer la configuraci√≥n o simplemente no procesa las se√±ales entrantes. </font><font style="vertical-align: inherit;">Adem√°s, estos son problemas populares entre los usuarios de este m√≥dulo. </font><font style="vertical-align: inherit;">El segundo inconveniente es la falta de apagado mec√°nico de la tetera. </font><font style="vertical-align: inherit;">El apagado se implementa en el software; cuando se alcanza el punto de ebullici√≥n, el circuito se rompe con la ayuda de un rel√©. </font><font style="vertical-align: inherit;">Si el programa se bloquea repentinamente, es posible que el hervidor no se apague. </font><font style="vertical-align: inherit;">El tercer inconveniente es el problema de controlar la temperatura de calentamiento. </font><font style="vertical-align: inherit;">Entonces, por ejemplo, si apaga el hervidor a una temperatura de 60 grados, la calefacci√≥n diez continuar√° emitiendo calor, y despu√©s de un tiempo la temperatura del agua ya ser√° de aproximadamente 70 grados. </font><font style="vertical-align: inherit;">Pero esto se corrige haciendo ajustes al programa.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es393785/">https://habr.com/ru/post/es393785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es393775/index.html">Los delfines descubrieron los rudimentos de la comunicaci√≥n ling√º√≠stica.</a></li>
<li><a href="../es393777/index.html">Paso de Mercurio en el Sol - foto y video</a></li>
<li><a href="../es393779/index.html">EAU planea crear una monta√±a artificial para aumentar las precipitaciones</a></li>
<li><a href="../es393781/index.html">Los cient√≠ficos de NUST "MISiS" demostraron el fracaso de la teor√≠a cl√°sica de la estructura de la Tierra</a></li>
<li><a href="../es393783/index.html">La base de los eclipses solares y lunares desde -1999 hasta +3000 a√±os.</a></li>
<li><a href="../es393787/index.html">C√≥mo reparar reactores nucleares</a></li>
<li><a href="../es393791/index.html">Ciudad suiza autorizada a pagar facturas de servicios p√∫blicos en bitcoins</a></li>
<li><a href="../es393795/index.html">Debido al calentamiento global, partes del Medio Oriente y √Åfrica del Norte ser√°n inhabitables</a></li>
<li><a href="../es393797/index.html">Los pedidos anticipados para la consola de juegos Pyra comenzaron</a></li>
<li><a href="../es393799/index.html">Usando Amazon Echo, el propietario de Tesla mostr√≥ lo f√°cil que es conseguir que un autom√≥vil salga del garaje.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>