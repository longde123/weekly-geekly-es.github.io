<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßïüèø ‚úäüèæ üîâ A hist√≥ria de como a chaleira do Autoplay Media Studio 8.5.3.0 quebrou üññ üéê üõÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como n√£o √© dif√≠cil adivinhar, o bule de ch√° sou eu. 

 No outro dia, eu queria examinar a fonte de um utilit√°rio, obviamente feito usando ferramentas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A hist√≥ria de como a chaleira do Autoplay Media Studio 8.5.3.0 quebrou</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451524/"><img src="https://habrastorage.org/webt/_j/hw/x7/_jhwx7ujb4v6_qha53qhum2ay-o.png" alt="imagem"><br><br>  Como n√£o √© dif√≠cil adivinhar, o bule de ch√° sou eu. <br><br>  No outro dia, eu queria examinar a fonte de um utilit√°rio, obviamente feito usando ferramentas AMS (arquivo .cdd ao lado de .exe e algumas lua * .dll).  H√° alguns anos, analisei detalhadamente um programa feito por meios semelhantes e a id√©ia de compactar .cdd, que √© um arquivo zip comum com uma senha, est√° dispon√≠vel.  Bem, sem hesitar, pressionei o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">AMSUnpacker</a> e recebi um erro de descompacta√ß√£o.  Bem, a partir deste momento a divers√£o come√ßou ... <a name="habracut"></a><br><br>  O primeiro pensamento que me ocorreu foi que o arquivo estava empacotado com algo diferente de UPX (que eu descompactei naturalmente).  Bem, eu n√£o chequei (DIE, Exeinfo PE, Nauz File Detector) e todo mundo me convence de que n√£o, n√£o est√° lotado.  Bem, acho que vou comparar o .exe banal usando o Total Commander com o programa anteriormente descompactado e este, e descobriu-se que .exe √© muito diferente (eu costumava comparar outros programas no AMS e a diferen√ßa era apenas em bytes simples, na verdade, em uma senha escrita em texto sem formata√ß√£o apenas em .exe e na parte do recurso).  Ficou claro que isso √© algum tipo de modifica√ß√£o e apenas uma nova vers√£o do AMS.  Acreditei no √∫ltimo com dificuldade, sabendo (bem, a princ√≠pio pensei que sabia) que os desenvolvedores haviam batido o programa por um longo tempo, mas n√£o come√ßaram a verificar se era isso ou n√£o, e dificilmente daria qualquer coisa. <br><br>  Comecei a me aprofundar em mais detalhes, de alguma forma em x64dbg, com o qual eu em "Voc√™", encontrei na vers√£o antiga do programa um lugar onde a senha √© "lida".  Tendo vasculhado o mesmo x64dbg na vers√£o "nova", descobriu-se que eles n√£o s√£o t√£o diferentes, mas h√° simplesmente mais fun√ß√µes nele do que na antiga.  Encontrei um lugar semelhante onde, em vez do <i>push &lt;endere√ßo</i> cobi√ßado, <i>onde a senha √© armazenada&gt; havia</i> algum tipo de <i>mov &lt;algo l√°&gt;</i> e v√°rias chamadas para algumas outras fun√ß√µes, e algumas linhas abaixo do c√≥digo s√£o semelhantes √†s da vers√£o antiga. <br><br><img src="https://habrastorage.org/webt/9x/37/z-/9x37z-40dldhrk3pkqufzjrjw24.png" alt="imagem"><br>  <i>(√† esquerda √© a vers√£o antiga, √† direita √© a nova)</i> <br><br>  E aqui fiquei triste, porque meu conhecimento sobre depurador claramente n√£o √© suficiente para entender tudo isso. <br>  Houve um pensamento - para encontrar outro programa semelhante n√£o compact√°vel e comparar o arquivo .exe.  Esse programa foi encontrado pelo mesmo autor que eu tentei descompactar.  E a compara√ß√£o de arquivos deu o resultado.  Al√©m de pequenas diferen√ßas, foi encontrado um bloco inteiro de v√°rios dados: <br><br><img src="https://habrastorage.org/webt/g1/-y/sw/g1-yswf_kppbniurspq2svqqfpq.png" alt="imagem"><br><br>  E a alegria que encontrei naquele lugar √∫nico onde aparentemente a senha estava contida e a decep√ß√£o por claramente n√£o ser uma senha, na forma como nas vers√µes anteriores. <br><br>  N√£o havia escolha a n√£o ser entender o depurador.  Todo o "problema" √© que eu conhe√ßo o montador no n√≠vel de v√°rios comandos, com uma representa√ß√£o muito superficial do que eles est√£o fazendo, e o pr√≥prio depurador est√° no n√≠vel de v√°rios v√≠deos assistidos no youtube e com pouca experi√™ncia em us√°-lo, principalmente pelo "m√©todo de pux√£o". <br><br>  Depois de uma hora executando o depurador e um n√∫mero incont√°vel de reinicializa√ß√µes, encontrei um local em que os bytes desejados s√£o lidos e, um pouco mais tarde, encontrei um peda√ßo de c√≥digo que manipula esses bytes: <br><br><img src="https://habrastorage.org/webt/zo/al/qe/zoalqevl6bovhetxr4-y8qiri3i.png" alt="imagem"><br><br>  Demorou muito tempo para entender o que estava sendo feito l√°. <br><br>  De alguma maneira, descobri que esse √© um tipo de teclado cifrado, onde h√° duas tabelas, uma √© uma senha criptografada, onde o caractere correspondente simplesmente indica a posi√ß√£o no segundo bloco de notas. <br><br><img src="https://habrastorage.org/webt/qi/c-/vz/qic-vztarwtuv3ngughmsez8e1o.png" alt="imagem"><br><br>  Em geral, substituindo os valores da tabela inferior pelos valores correspondentes da tabela superior, obtemos uma matriz de bytes: <i>7B 10 DD 5A 4D 26 72 EE B2 2A 04 2B 6E F7 14 E2 F9 14 F8 9E 8A 99 28 AE B8 4B C0 D7 42 DA AD</i> . <br><br>  Para quais outras matrizes exclusivas de bytes, antes e depois da senha necess√°ria para descriptografar, eu n√£o entendi, mas na verdade n√£o fui muito.  Eu suspeito que existem algumas somas de verifica√ß√£o ... <br><br>  E ent√£o cabe a voc√™ convert√™-lo em uma string e descompactar o arquivo .cdd com essa senha.  Um pequeno problema foi que a linha resultante n√£o p√¥de ser inserida no arquivador via Ctrl + C -&gt; Ctrl-V, porque  caracteres "quebrar" na √°rea de transfer√™ncia (especialmente n√£o mergulhar na ess√™ncia).  A descompacta√ß√£o √© poss√≠vel apenas programaticamente.  Felizmente, existe algum conhecimento de C # (cujo n√≠vel em geral n√£o √© muito diferente do n√≠vel de conhecimento do depurador) e pouca experi√™ncia no estudo do princ√≠pio de opera√ß√£o do AMSUnpacker mencionado anteriormente, que tamb√©m est√° escrito em C # e n√£o √© dif√≠cil ver o que est√° l√° e como. <br><br>  Quase no joelho, ele empilhou um utilit√°rio para verificar a operacionalidade do algoritmo estudado anteriormente, e pronto, ele funciona. <br><br>  Voc√™ pode baix√°-lo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">aqui</a> . <br><br><img src="https://habrastorage.org/webt/_4/bu/up/_4buupv1t1j33udxn5s5ixagyx8.png" alt="imagem"><br><br>  O programa, semelhante ao AMSUnpacker mencionado anteriormente, cria a pasta extract_cdd ao lado do .exe com o conte√∫do do arquivo .cdd. <br><br>  Ap√≥s descompactar com √™xito o arquivo .cdd, aprendi que esta √© a vers√£o ‚Äúnova‚Äù (do final de 2018) do AMS 8.5.3.0.  E no site eles leram sobre a nova vers√£o: <i>Recurso: aprimorada a seguran√ßa do arquivo de dados da vers√£o comercial.</i>  .  Bem, aparentemente n√£o deu muito certo ... <br><br>  Eu tenho uma pergunta para quem sabe, esse algoritmo para ocultar uma senha, faz parte de algum algoritmo de criptografia padr√£o (quero dizer, agora √© aplic√°vel em programas, e n√£o historicamente), ou √© mais prov√°vel que os desenvolvedores tenham pensado nisso? <br><br>  PS: Eu sei que √© mais f√°cil obter o c√≥digo fonte dos programas lua (que usa AMS) atrav√©s do lua * .dll corrigido, que navega na Internet e / ou o gancho externo da fun√ß√£o lua_load () na mesma lua * .dll.  Foi tudo o que fiz uma vez.  Nessa situa√ß√£o, era um interesse puramente esportivo descobrir como obter uma senha para .cdd.  E tamb√©m entendo perfeitamente bem que √© improv√°vel que algu√©m precise e n√£o tenha nenhum valor pr√°tico. <br><br>  Eu provavelmente exagerei em rela√ß√£o ao "bule", porque  h√° pouca experi√™ncia em programa√ß√£o e reverso, mas esse √© apenas um pequeno hobby "para mim" e n√£o h√° muito tempo ou desejo de aprofundar isso. <br><br>  PPS Este √© o meu primeiro artigo sobre Habr√©, como provavelmente o primeiro deste tipo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt451524/">https://habr.com/ru/post/pt451524/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt451514/index.html">CSS Subgrid News</a></li>
<li><a href="../pt451516/index.html">Padr√µes de design usados ‚Äã‚Äãno Spring Framework</a></li>
<li><a href="../pt451518/index.html">Nossos sites m√≥veis despojados</a></li>
<li><a href="../pt451520/index.html">VDI: barato e alegre</a></li>
<li><a href="../pt451522/index.html">Implementamos a automa√ß√£o em algumas horas: TypeScript, Transferidor, Jasmine</a></li>
<li><a href="../pt451528/index.html">"E assim vai": que os provedores de nuvem n√£o concordam com dados pessoais</a></li>
<li><a href="../pt451532/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 459 (30/04/2019 - 06/05/2019)</a></li>
<li><a href="../pt451534/index.html">12 princ√≠pios de anima√ß√£o no desenvolvimento de videogames</a></li>
<li><a href="../pt451538/index.html">Guia de redimensionamento paralelo do Amazon Redshift e resultados de testes</a></li>
<li><a href="../pt451540/index.html">Quantos desenvolvedores precisam criar servi√ßos como o Airbnb</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>