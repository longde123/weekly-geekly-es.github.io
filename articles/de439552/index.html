<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😔 👨🏿‍🤝‍👨🏽 📘 Schädliche Chrome-Erweiterungen 🛸 🛌🏼 ⛹🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Publikum der Klassenkameraden beträgt 71 Millionen pro Monat. Neben dem gesamten Internetpublikum sind unsere Benutzer allgemeinen Sicherheitsbedr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Schädliche Chrome-Erweiterungen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/439552/"><img src="https://habrastorage.org/webt/dz/ry/99/dzry99akp3bcnui_uqky91be_1s.jpeg"><br><br>  Das Publikum der Klassenkameraden beträgt 71 Millionen pro Monat.  Neben dem gesamten Internetpublikum sind unsere Benutzer allgemeinen Sicherheitsbedrohungen ausgesetzt: Phishing, Viren, Wiederverwendung von Passwörtern.  Der wirtschaftliche Motor für Angriffe auf Nutzer sozialer Netzwerke ist in der Regel die Verbreitung von Spam.  Und obwohl solche Angriffe nicht direkt auf die Sicherheitslücke von Odnoklassniki zurückzuführen sind, sind wir daran interessiert, ihnen entgegenzuwirken, und untersuchen dafür alle wichtigen Spam-Vorfälle. <br><br>  Eine typische Untersuchung eines neuen (erfolgreichen) Spam-Angriffs beginnt, nachdem wir bei Portalbenutzern abnormale Aktivitäten festgestellt haben.  Dies kann sich in einer erhöhten Belastung einzelner Dienste (z. B. einem Bild-Upload- oder Suchdienst), in der aktiven Verteilung derselben Art von Inhalten (z. B. Links zu ähnlichen Websites) oder sogar in einer Zunahme der Anzahl von Anrufen beim Support-Dienst äußern. <br><a name="habracut"></a><br>  Während der Untersuchung ist es für uns zunächst wichtig zu bestimmen, wie Spam innerhalb des sozialen Netzwerks verteilt wird.  Das Ergebnis einer solchen Untersuchung ist häufig der Nachweis einer Gruppe von Geräten, die mit Viren infiziert sind.  Manchmal finden wir unter den Spam-Mails, die sie verbreiten, Links zum Virus selbst.  So schaffen wir es, das Verteilungsschema wiederherzustellen und beteiligte Benutzer zu finden. <br><br>  Ein interessanter Sonderfall solcher Angriffe ist die Infektion mit böswilligen Browsererweiterungen.  Erweiterungen für Chrome können sowohl in Chrome selbst als auch in auf Chromium basierenden Browsern installiert werden, z. B. Opera und Yandex.Browser.  Das heißt, der Löwenanteil des Webs ist potenziell abgedeckt.  Schädliche Erweiterungen für andere Browser (Firefox, Safari) sind weitaus seltener.  Ich kann davon ausgehen, dass die Entwicklung von Viren in ihrem Fall aufgrund des relativ kleinen Publikums dieser Browser keine Vorteile bringt. <br><br>  Wir können sogar das Ausmaß der Verbreitung böswilliger Erweiterungen unter unseren Benutzern berechnen: <br><br><img src="https://habrastorage.org/webt/mb/7_/pt/mb7_ptag9bex0v2u56uvrkrplrq.png"><br><br>  Jeden Tag registrieren wir 100-200.000 infizierte Benutzer.  Insgesamt wurden im Jahr 2018 1,2 Millionen Benutzer mit einem infizierten Browser gesehen. <br><br>  Anfang 2017 haben wir beim OWASP Russia Meetup # 6 bereits über Odnoklassnikis Erfahrung im Kampf gegen die Verbreitung bösartiger Erweiterungen für Chrome gesprochen.  In fast zwei Jahren hat sich viel geändert.  Aber zuerst wollen wir herausfinden, wie die Erweiterungen funktionieren. <br><br>  Mit Chrome können Benutzer den Browser anpassen, indem sie Erweiterungen installieren. <br>  Erweiterungen werden mit einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Javascript-API</a> bereitgestellt, mit der sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Folgendes</a> können: <br><br><ul><li>  Abfangen und Ändern von HTTP-Anforderungen und -Antworten; </li><li>  Ändern Sie das DOM der angezeigten Seiten. </li><li>  Verwalten der Browser-Oberfläche (Öffnen und Schließen von Registerkarten, Hinzufügen von Elementen zum Kontextmenü); </li><li>  die Liste der Erweiterungen verwalten; </li><li>  Abonnieren Sie Systemereignisse beispielsweise über Maus und Tastatur. </li><li>  Lesen Sie den Browserverlauf und die Site-Daten. </li></ul><br>  Erweiterungen werden über den Chrome Web Store in Form eines Archivs mit Quellcode und Ressourcen (Bilder, Stile, HTML-Seiten) verteilt.  Die wichtigsten Komponenten der Erweiterung sind nachfolgend aufgeführt: <br><br><ul><li> <b>Das Manifest</b> ist JSON mit Erweiterungskonfiguration.  Das Manifest deklariert unter anderem die erforderlichen Berechtigungen und Domänen für die Daten, auf die die Erweiterung Zugriff erhält. </li><li>  <b>Hintergrundskripte</b> werden im Hintergrund in ihrem eigenen Kontext ausgeführt, isoliert vom Code von Webseiten.  Sie sind so konzipiert, dass sie eine Vielzahl von Ereignissen vom Browser empfangen und verarbeiten und vollen Zugriff auf die API haben. </li><li> <b>Inhaltsskripte</b> werden im Kontext der Webseite ausgeführt.  Javascript-Umgebungen der Seite selbst und der Erweiterung sind voneinander isoliert, die Erweiterung hat keinen Zugriff auf die Variablen und Funktionen der Seite und umgekehrt.  Skripte können mit <code>XMLHttpRequest</code> DOM-Seiten ändern und standortübergreifende Anforderungen ausführen.  Im Gegensatz zu regulären Seiten gelten dieselben Ursprungsrichtlinien und CORS-Serverrichtlinien nicht für Anforderungen von Erweiterungen, sondern sind nur durch die im Manifest angeforderten Zugriffe beschränkt. </li></ul><br>  Angenommen, jemand hat beschlossen, seinen eigenen Virus zu schreiben.  Was kann er realisieren? <br><br>  <b>Zugriff auf Benutzerdaten</b> <br>  Wie oben erwähnt, kann die Erweiterung Anforderungen und Antworten zwischen der Seite und dem Server abfangen.  Es ist klar, dass der universelle Mechanismus zum Schutz von Daten während der Übertragung - SSL - in diesem Fall nicht zum Schutz von Seitendaten beiträgt, da der Browser diese an die bereits entschlüsselte Erweiterung überträgt. <br><br>  <b>Seiteninhalt ändern</b> <br>  Die Erweiterung hat Zugriff auf das DOM, kann Elemente hinzufügen und entfernen und die Seitenoberfläche ändern.  Ein klassisches Beispiel ist das Ersetzen von Bannerwerbung. <br><br>  <b>Verfolgung der Benutzeraktivität</b> <br>  Die Erweiterung kann Ereignisse über Tastatur und Maus abonnieren und so Benutzeraktionen im Browser verfolgen und Passwörter, persönliche Daten und Bankkartennummern sammeln. <br><br>  <b>Aktionen für den Benutzer ausführen</b> <br>  Die Erweiterung kann Skripte im Kontext der Opferseite ausführen, die gegen dieselbe Ursprungsrichtlinie verstoßen.  Dies bedeutet, dass alle Aktionen, die der Benutzer auf der Site ausführen kann, auch von der Erweiterung initiiert werden können. <br><br>  <b>Umgehen Sie die Zwei-Faktor-Authentifizierung und andere Kontoschutzfunktionen</b> <br>  Der Benutzer übergibt die Authentifizierung und Autorisierung selbst im Browser. Daher erhält die Erweiterung dieselbe Sitzung wie ein legitimer Benutzer. <br><br>  <b>Perfektes Botnetz</b> <br>  Intelligente Captcha- und Hochwasserschutzsysteme beruhen in der Regel auf der Tatsache, dass der Verkehr von Bots durch IP, Fingerabdrücke und die Verteilung von Anforderungen über die Zeit vom Verkehr von guten Benutzern unterschieden werden kann.  Erweiterungsanforderungen können nicht von Anforderungen realer Benutzer getrennt werden. <br><br>  In diesem Jahr kündigte Google mehrere Innovationen an, mit denen die Verbreitung von Malware im App Store gestoppt werden soll.  Die Installation von Erweiterungen aus Quellen von Drittanbietern, die Inline-Installation wurde verboten, die Moderationsregeln wurden verschärft, die Verschleierung und die Ausführung von willkürlichem Code in Erweiterungen wurden verboten. <br><br>  Trotzdem werden weiterhin böswillige Erweiterungen verwendet, um Benutzer anzugreifen.  Typische Ziele sind Diebstahl von Konten ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel</a> ), personenbezogene Daten ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel</a> ), Spam oder Spoofing von Werbung ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel</a> ). <br><br>  Für einen erfolgreichen Angriff muss die Erweiterung mehrere Probleme lösen: <br><br><ul><li>  verstecke dich vor Mäßigung im Laden; </li><li>  ein Publikum finden und behalten; </li><li>  Geld verdienen. </li></ul><br>  Durch die strengere Moderation im Store suchten Virenautoren nach neuen Möglichkeiten, um Erweiterungen zu veröffentlichen.  Hier haben wir ein klassisches Bild der Anpassung von Spammern an Spamfilter beobachtet: Eine Erweiterung mit Hunderttausenden von Benutzern wurde zu zehn verschiedenen Erweiterungen von verschiedenen Autoren mit einer kleinen Anzahl von Benutzern, und diese Erweiterungen begannen später, beliebte Anwendungen mit einem guten Ruf nachzuahmen.  Erweiterungen werden jetzt in beliebten Cloud-Diensten mit ihrem Serverteil und dem „Kontrollzentrum“ gehostet, das das Verhalten infizierter Browser zu einem bestimmten Zeitpunkt definiert. <br><br>  Nach dem Entfernen aus dem Store können als bösartig erkannte Erweiterungen in den Browsern der Benutzer deaktiviert werden, die sie installiert haben.  Um eine infizierte Zielgruppe zu behalten und eine neue Erweiterung anstelle der Remote-Erweiterung installieren zu können, nehmen Virenschreiber Änderungen an den Browsereinstellungen vor, die nicht direkt mit der Erweiterung zusammenhängen: Registrieren Sie einen Servicemitarbeiter, abonnieren Sie Benachrichtigungen für den Benutzer, ersetzen Sie ihn durch die Startseite oder den Suchdienst.  Auf diese Weise können Sie einen Link an den Browser senden, um eine neue Version des Virus zu installieren. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27d/21d/6d7/27d21d6d742a084c44c46c73e52dd9ef.png"><br><br>  Für die von uns beobachteten Viren ist Spam die Haupteinnahmequelle.  Unter den vielen Möglichkeiten, Spam für Erweiterungen zu verteilen, sind die folgenden wahrscheinlich am bequemsten: <br><br><ul><li>  <b>Ersetzen Sie Anzeigen auf besuchten Seiten und fügen Sie sie hinzu</b> .  Wie oben erwähnt, können Erweiterungen willkürliche Änderungen am Inhalt der angezeigten Seiten vornehmen, einschließlich des Ersetzens legitimer Anzeigen auf Websites durch eigene oder der Anzeige zusätzlicher Anzeigen für Benutzer durch Öffnen von Popups, neuen Registerkarten oder Umleiten einiger Websites zur Werbung. <br><br>  Eine bemerkenswerte Form der Substitution von Erweiterungen durch Werbung ist die Verwendung von HTML5-Benachrichtigungen.  Während die Erweiterung im Browser installiert und aktiv ist, reicht es aus, das Opfer auf eine Seite zu locken, auf der der Servicemitarbeiter registriert und der Benutzer für Benachrichtigungen signiert wird.  Und da dieser Servicemitarbeiter auch nach dem Entfernen der Erweiterung aus dem Browser nicht direkt mit der Erweiterung verbunden ist, haben die Autoren weiterhin einen Kanal für die Kommunikation mit Benutzern in Form von Push-Benachrichtigungen. <br><br>  Ein ähnlicher Mechanismus wird auch in Verbindung mit Social Engineering verwendet, um das Opfer erneut zu infizieren, wenn die Erweiterung aus dem Geschäft entfernt wird: Der Benutzer erhält einen Push mit attraktiven Inhalten (z. B. "ok.ru Neue ungelesene Nachricht") und einem Link zum Installieren einer neuen Version des Virus anstelle der gelöschten. </li><li>  <b>Verwenden Sie das Konto des Opfers, um Spam in sozialen Netzwerken zu verbreiten</b> .  Die im Browser installierte Erweiterung kann Anforderungen im Namen des aktuellen Benutzers ausführen, einschließlich des Versendens von Spam unter dem Deckmantel des normalen Inhalts des Benutzers (Schreiben von Nachrichten an Freunde, Veröffentlichen von Notizen und öffentlichen Beiträgen, Hochladen von Fotos oder Videos). </li></ul><br>  Zusammenfassend können wir den Schluss ziehen, dass böswillige Browsererweiterungen immer noch eine erhebliche Bedrohung für Benutzer und Webanwendungen darstellen.  Erweiterungen bieten einen praktischen Mechanismus zum Verbreiten von Schadcode: Sie erfordern keine hohen Qualifikationen zum Erstellen, verursachen weniger Verdacht bei Benutzern während der Installation und werden seltener von Virenschutzprogrammen erkannt. <br><br>  Die Situation wird durch die Tatsache verschärft, dass Webseiten im Browser offensichtlich weniger Rechte als Erweiterungen haben und nichts zum Schutz ihrer Benutzer tun können.  Es ist zu hoffen, dass die von Google angekündigte Antiviren-Kampagne im Store erfolgreich sein wird.  Bis dies geschieht, arbeiten wir bei OK daran, die Verbreitung von Viren innerhalb des sozialen Netzwerks zu minimieren und die Nutzung des Dienstes so sicher wie möglich zu gestalten. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439552/">https://habr.com/ru/post/de439552/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439540/index.html">Etherblade.net - OpenSource-Projekt zum Erstellen eines Ethernet-Verkehrskapselers auf FPGA (Teil 1)</a></li>
<li><a href="../de439542/index.html">Nintendo macht deutlich, dass nur Piraterie die Geschichte von Videospielen retten kann</a></li>
<li><a href="../de439544/index.html">Kolonie. Kapitel 24: Abreise</a></li>
<li><a href="../de439546/index.html">Träumen Androiden von elektrischem Punk? Wie ich einem neuronalen Netzwerk das Schreiben von Musik beigebracht habe</a></li>
<li><a href="../de439550/index.html">Hackquest 2018. Ergebnisse & Zuschreibungen. Tag 1-3</a></li>
<li><a href="../de439556/index.html">TDMS Fairway. PMBOK-Methoden und russische Designorganisationen</a></li>
<li><a href="../de439558/index.html">Neues altes Telefon. Das PSTN-Telefon neu erfinden</a></li>
<li><a href="../de439560/index.html">Ethereum-Blockchain-Adapter für die IRIS-Datenplattform von InterSystems</a></li>
<li><a href="../de439562/index.html">Konfigurieren Sie den Kubernetes HA-Cluster auf Bare Metal mit kubeadm. Teil 1/3</a></li>
<li><a href="../de439564/index.html">Praktische Anwendung der AST-Baumtransformation am Beispiel von Putout</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>