<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö± üí™üèª üèØ SwiftUI: Connaissance üó®Ô∏è üßúüèΩ üëºüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans ce guide, nous allons apprendre √† planifier des applications d'interface utilisateur √† l'aide de View et √† utiliser des variables d'√©tat pour mod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SwiftUI: Connaissance</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471918/">  Dans ce guide, nous allons apprendre √† planifier des applications d'interface utilisateur √† l'aide de View et √† utiliser des <b>variables d'√©tat</b> pour modifier l'interface utilisateur. <br><br>  Temps de lecture estim√©: 25 minutes. <br><a name="habracut"></a><br>  SwiftUI nous permet d'oublier compl√®tement Interface Builder (IB) et les storyboards.  IB et Xcode √©taient des applications distinctes avant Xcode 4, mais la ¬´connexion¬ª entre elles est toujours visible lorsque nous modifions le nom IBAction ou IBOutlet et que notre application plante, donc IB ne sait rien des changements dans le code.  Ou lorsque nous d√©finissons des identificateurs pour les s√©quences ou pour les cellules du tableau, mais Xcode ne peut pas les v√©rifier, car ce sont des cha√Ænes. <br><br>  SwiftUI √† la rescousse!  Nous voyons imm√©diatement les changements dans la vue d√®s que nous entrons le code.  Les modifications d'un c√¥t√© entra√Ænent une mise √† jour de l'autre, elles sont donc toujours li√©es.  Il n'y a aucun identifiant de cha√Æne qui pourrait √™tre confondu.  Et c'est tout le code, mais il est beaucoup plus petit que si nous l'avons √©crit en utilisant UIKit, il est donc plus facile √† comprendre, √† modifier et √† d√©boguer.  Dites-moi, n'est-ce pas merveilleux? <br><br><h2>  On y va </h2><br>  Commen√ßons un nouveau projet dans le projet Xcode ( <b>Shift-Command-N</b> ), s√©lectionnez <b>iOS App Single View App</b> , appelons RGBullsEye et assurez-vous de choisir <b>SwiftUI</b> comme interface. <br><br>  Maintenant, <b>AppDelegate.swift est</b> divis√© en deux fichiers: <b>AppDelegate.swift et SceneDelegate.swift</b> , et SceneDelegate contient une fen√™tre: <br><br><img src="https://habrastorage.org/webt/jc/kw/b2/jckwb27k-lv_t6aiwlqhe_-upi0.png"><br><br>  <b>SceneDelegate n'est</b> presque pas li√© √† SwiftUI, √† l'exception de cette ligne: <br><br><pre><code class="swift hljs">window.rootViewController = <span class="hljs-type"><span class="hljs-type">UIHostingController</span></span>(rootView: <span class="hljs-type"><span class="hljs-type">ContentView</span></span>())</code> </pre> <br>  <b>UIHostingController</b> cr√©e un contr√¥leur de vue pour SwiftUI-view <b>ContentView</b> . <br><blockquote>  Remarque: <b>UIHostingController</b> nous permet d'int√©grer SwiftUI-view dans une application existante.  Ajoutez le Hosting View Controller √† notre storyboard et cr√©ez un encha√Ænement dessus depuis UIViewController.  Ensuite, nous utilisons Control-drag avec segue sur le code du contr√¥leur de vue pour cr√©er une <b>IBSegueAction</b> , o√π nous d√©finissons le contr√¥leur d'h√©bergement sur <b>rootView</b> - SwiftUI-view. </blockquote>  Lorsque l'application d√©marre, la fen√™tre affiche une instance de <b>ContentView</b> , qui est d√©finie dans le fichier <b>ContentView.swift</b> .  Il s'agit d'une <b>structure</b> conforme au protocole <b>View</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Hello World"</span></span>) } }</code> </pre> <br>  Il s'agit d'une d√©claration SwiftUI du contenu d'un ContentView ( <b>corps</b> ).  Il y a maintenant une vue texte avec le texte Hello World. <br><br>  Juste en dessous de ContentView_Previews renvoie une instance de ContentView. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView_Previews</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PreviewProvider</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> previews: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">ContentView</span></span>() } }</code> </pre> <br>  Ici, nous pouvons d√©finir les donn√©es de test pour l'aper√ßu.  Mais o√π est exactement cet aper√ßu? <br><br>  Imm√©diatement apr√®s le code est un grand espace vide avec ceci ci-dessus: <br><br><img src="https://habrastorage.org/webt/u3/iv/qu/u3ivquebtlhjhi0-vnbctvg49tw.png"><br><br>  Cliquez sur <b>Reprendre</b> , attendez un instant et ... <br><br><img src="https://habrastorage.org/webt/7x/hl/kh/7xhlkhixvhssyu34vjnvxdz7hkq.png"><br><br><h2>  Esquissez notre interface utilisateur </h2><br>  Quelque chose de familier n'est pas visible - il s'agit du fichier <b>Main.storyboard</b> .  Nous allons cr√©er notre interface utilisateur en utilisant SwiftUI, directement dans le code, en train de regarder l'aper√ßu: qu'est-ce que nous y arrivons?  Mais ne vous inqui√©tez pas, nous n'avons pas √† √©crire des centaines de lignes de code pour cr√©er nos vues. <br><br>  SwiftUI est d√©claratif: vous indiquez √† quoi devrait ressembler votre interface utilisateur, et SwiftUI convertit tout cela en un code efficace qui fait tout le travail.  Apple vous permet de cr√©er autant de vues que n√©cessaire afin que le code soit simple et direct.  Les vues r√©utilisables avec des param√®tres sont particuli√®rement recommand√©es - cela est similaire √† l'allocation de code dans une fonction distincte.  Vous le ferez vous-m√™me plus tard. <br><br>  Notre application aura beaucoup de vues, donc pour commencer, nous allons esquisser les vues de texte sous forme de talons. <br><br>  Remplacez Text ("Hello World") par ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Target Color Block"</span></span>)</code> </pre> <br>  Si n√©cessaire, cliquez sur <b>Reprendre</b> pour mettre √† jour l'aper√ßu. <br><br>  Maintenant, <b>Commandez-cliquez</b> sur cette vue dans l' <b>aper√ßu</b> , puis s√©lectionnez <b>Int√©grer dans HStack</b> : <br><br><img src="https://habrastorage.org/webt/s-/tm/dy/s-tmdyehpyekmyid1tdxsbfh_xy.png"><br><br>  Veuillez noter que votre code a √©galement chang√©: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Target Color Block"</span></span>) }</code> </pre> <br>  Copiez et collez l'op√©rateur Text et modifiez-le dans notre HStack.  Veuillez noter: nous ne s√©parons pas les op√©rateurs par une virgule, mais √©crivons chacun d'eux sur une nouvelle ligne: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Target Color Block"</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess Color Block"</span></span>) }</code> </pre><br>  Et donc cela ressemble √† l'aper√ßu: <br><br><img src="https://habrastorage.org/webt/pj/sp/n6/pjspn6qoeesvvhbvuhj59po64oe.png"><br><br>  Maintenant, pr√©parons un emplacement pour les talons de curseur en pla√ßant le <b>HStack</b> sur <b>VStack</b> .  Cette fois, nous allons faire un <b>clic de commande</b> sur le HStack <b>dans notre code</b> : <br><br><img src="https://habrastorage.org/webt/wa/bo/fn/wabofnratyjqvqaprm0nyali_zq.png"><br><br>  Choisissez <b>Int√©grer dans VStack</b> ;  un nouveau code appara√Ætra, mais l'aper√ßu ne changera pas.  Un peu plus tard, nous ajouterons la vue sous les futurs blocs de couleur. <br><br>  Ajoutez une nouvelle ligne imm√©diatement apr√®s le HStack, cliquez sur <b>+</b> dans la barre d'outils pour ouvrir la biblioth√®que et faites glisser <b>Vertical Stack</b> vers une nouvelle ligne: <br><br><img src="https://habrastorage.org/webt/rl/dd/pw/rlddpwk_2bjxsrmi7hudiymh3na.png"><br><br>  Comme pr√©vu, le code et l'aper√ßu ont chang√©: <br><br><img src="https://habrastorage.org/webt/f-/aq/w1/f-aqw1b3zp5aunz2cqysubhysug.png"><br><br>  Terminez le travail sur le projet d'interface utilisateur, de sorte que tout ressemble √† ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">VStack</span></span> { <span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Target Color Block"</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess Color Block"</span></span>) } <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Hit me button"</span></span>) <span class="hljs-type"><span class="hljs-type">VStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Red slider"</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Green slider"</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Blue slider"</span></span>) } }</code> </pre> <br>  Dans le nouveau VStack, trois curseurs appara√Ætront un peu plus tard, ainsi qu'un bouton entre les curseurs et les blocs de couleur. <br><br><h2>  Nous continuons √† travailler sur l'interface utilisateur </h2><br>  Maintenant, pratiquons dans SwiftUI pour remplir un HStack contenant des blocs color√©s: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Target color block VStack { Rectangle() Text("Match this color") } // Guess color block VStack { Rectangle() HStack { Text("R: xxx") Text("G: xxx") Text("B: xxx") } } }</span></span></code> </pre> <br>  Chaque bloc de couleur a un rectangle.  Le bloc de couleur cible (cible) a une vue Texte sous le rectangle et celui s√©lectionn√© (Devinez) a trois vues Texte.  Un peu plus tard, nous remplacerons ¬´xxx¬ª par les valeurs r√©elles des curseurs. <br><br><h2>  Utilisation des variables '@State' </h2><br>  Dans SwiftUI, nous pouvons utiliser des variables r√©guli√®res, mais si nous voulons que le changement de la variable affecte l'interface utilisateur, nous marquons des variables comme <b>'@State'</b> .  Dans notre application, nous s√©lectionnons la couleur, de sorte que toutes les variables qui affectent la couleur s√©lectionn√©e soient des variables '@State'. <br><br>  Ajoutez ces lignes √† l'int√©rieur de la <b>structure ContentView</b> , avant la d√©claration du <b>corps</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rTarget = <span class="hljs-type"><span class="hljs-type">Double</span></span>.random(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>..&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gTarget = <span class="hljs-type"><span class="hljs-type">Double</span></span>.random(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>..&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bTarget = <span class="hljs-type"><span class="hljs-type">Double</span></span>.random(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>..&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>) @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rGuess: <span class="hljs-type"><span class="hljs-type">Double</span></span> @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gGuess: <span class="hljs-type"><span class="hljs-type">Double</span></span> @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bGuess: <span class="hljs-type"><span class="hljs-type">Double</span></span></code> </pre> <br>  Les valeurs de R, G et B sont comprises entre 0 et 1. Nous initialisons les valeurs souhait√©es avec des valeurs al√©atoires.  Nous pourrions √©galement initialiser les valeurs s√©lectionn√©es √† 0,5, mais les laisser non initialis√©es pour l'instant pour montrer ce qui doit √™tre fait dans ce cas. <br><br>  Allons un peu plus bas dans la <b>structure ContentView_Previews</b> , qui initialise l'instance ContentView <b>pour l'aper√ßu</b> .  Maintenant, l'initialiseur a besoin des valeurs initiales des valeurs s√©lectionn√©es.  Modifiez <b>ContentView ()</b> comme ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ContentView</span></span>(rGuess: <span class="hljs-number"><span class="hljs-number">0.5</span></span>, gGuess: <span class="hljs-number"><span class="hljs-number">0.5</span></span>, bGuess: <span class="hljs-number"><span class="hljs-number">0.5</span></span>)</code> </pre> <br>  Lorsque nous faisons les curseurs, dans l'aper√ßu, leurs valeurs seront au milieu. <br><br>  Nous devons √©galement corriger l' <b>initialiseur</b> dans <b>SceneDelegate</b> , dans la fonction de <b>sc√®ne (_: willConnectTo: options :)</b> - remplacer <b>ContentView () par ce qui</b> suit: <br><br><pre> <code class="swift hljs">window.rootViewController = <span class="hljs-type"><span class="hljs-type">UIHostingController</span></span>(rootView: <span class="hljs-type"><span class="hljs-type">ContentView</span></span>(rGuess: <span class="hljs-number"><span class="hljs-number">0.5</span></span>, gGuess: <span class="hljs-number"><span class="hljs-number">0.5</span></span>, bGuess: <span class="hljs-number"><span class="hljs-number">0.5</span></span>))</code> </pre><br>  Lorsque l'application se charge, les pointeurs de curseur seront au centre. <br><br>  Ajoutez maintenant un modificateur de couleur au rectangle cible: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Rectangle</span></span>() .foregroundColor(<span class="hljs-type"><span class="hljs-type">Color</span></span>(red: rTarget, green: gTarget, blue: bTarget, opacity: <span class="hljs-number"><span class="hljs-number">1.0</span></span>))</code> </pre> <br>  Le modificateur <b>.foregroundColor</b> cr√©e une nouvelle vue Rectangle avec la couleur sp√©cifi√©e par les valeurs RVB g√©n√©r√©es al√©atoirement. <br><br>  De m√™me, modifiez le rectangle de devinettes: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Rectangle</span></span>() .foregroundColor(<span class="hljs-type"><span class="hljs-type">Color</span></span>(red: rGuess, green: gGuess, blue: bGuess, opacity: <span class="hljs-number"><span class="hljs-number">1.0</span></span>))</code> </pre> <br>  Avec des valeurs de R, G et B √† 0,5, nous obtenons une couleur grise. <br><br>  Cliquez sur Reprendre et attendez un instant. <br><br><img src="https://habrastorage.org/webt/yl/nr/d5/ylnrd5lgrnbg2zgnqwapyzuwrhm.png"><br><br><h2>  Rendre la vue r√©utilisable </h2><br>  Tout d'abord, nous ne penserons pas √† la r√©utilisation et ferons simplement un curseur pour le rouge.  Dans <b>VStack</b> for sliders, remplacez la fiche Texte ("Red slider") par cette <b>HStack</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"0"</span></span>) .foregroundColor(.red) <span class="hljs-type"><span class="hljs-type">Slider</span></span>(value: $rGuess) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"255"</span></span>) .foregroundColor(.red) }</code> </pre> <br>  Nous avons fait de la couleur du texte dans la vue texte rouge.  Et ils ont ajout√© Slider avec une valeur par d√©faut.  La plage par d√©faut du curseur est de 0 √† 1, c'est quelque chose qui nous convient parfaitement. <br><blockquote>  Remarque: Nous savons que le curseur passe de 0 √† 1, et l'√©tiquette de texte est ¬´255¬ª pour la commodit√© des utilisateurs qui sont habitu√©s √† repr√©senter des valeurs RVB dans la plage de 0 √† 255. </blockquote>  Mais quel type d'ic√¥ne <b>$</b> la variable poss√®de-t-elle?  Le savons-nous <b>?</b>  <b>et!</b>  lorsque vous travaillez avec des <b>options</b> , et maintenant aussi <b>$</b> ? <br><br>  Malgr√© le fait qu'il soit si petit et discret, il est tr√®s important.  <b>RGuess</b> lui-m√™me n'est qu'une valeur en <b>lecture</b> seule.  Mais <b>$ rGuess est une liaison</b> , nous en avons besoin pour mettre √† jour le rectangle de la couleur s√©lectionn√©e lorsque l'utilisateur d√©place le curseur. <br><br>  Pour comprendre la diff√©rence, d√©finissez les valeurs des trois vues de texte sous le rectangle pr√©visible: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"R: \(Int(rGuess * 255.0))"</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"G: \(Int(gGuess * 255.0))"</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"B: \(Int(bGuess * 255.0))"</span></span>) }</code> </pre> <br>  Ici, nous utilisons uniquement les valeurs, ne les modifions pas, nous n'avons donc pas besoin du pr√©fixe $. <br><br>  Attendez la mise √† jour de l'aper√ßu: <br><br><img src="https://habrastorage.org/webt/yf/fi/fx/yffifxnmxgba3ghsjg8hwptqces.png"><br><br>  Les rectangles color√©s ont l√©g√®rement r√©tr√©ci pour s'adapter au curseur.  Mais les √©tiquettes de texte du curseur semblent d√©sordonn√©es - elles sont trop press√©es contre les bords.  Ajoutons un autre modificateur √† HStack - padding: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">HStack</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"0"</span></span>) .foregroundColor(.red) <span class="hljs-type"><span class="hljs-type">Slider</span></span>(value: $rGuess) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"255"</span></span>) .foregroundColor(.red) } .padding()</code> </pre> <br>  Maintenant beaucoup mieux! <br><br><img src="https://habrastorage.org/webt/rw/4d/mj/rw4dmjkhddr768hvcgfg3-fljqk.png"><br><br>  <b>Cliquez</b> sur le curseur rouge HStack et s√©lectionnez <b>Extraire la sous-vue</b> : <br><br><img src="https://habrastorage.org/webt/vr/ln/-q/vrln-q4ebzp3m5aubyaysixuu0u.png"><br><br>  Cela fonctionne de la m√™me mani√®re que <b>Refactor ‚ñ∏ Extract to Function</b> , mais pour la vue SwiftUI. <br><br>  √Ä ce stade, plusieurs messages d'erreur appara√Ætront, ne vous inqui√©tez pas, nous allons maintenant le corriger. <br><br>  Nommez la vue r√©sultante <b>ColorSlider</b> et ajoutez ce code en haut, devant le corps de notre nouvelle vue: <br><br><pre> <code class="swift hljs">@<span class="hljs-type"><span class="hljs-type">Binding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value: <span class="hljs-type"><span class="hljs-type">Double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textColor: <span class="hljs-type"><span class="hljs-type">Color</span></span></code> </pre> <br>  Remplacez maintenant <b>$ rGuess par $ value et .red par textColor</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"0"</span></span>) .foregroundColor(textColor) <span class="hljs-type"><span class="hljs-type">Slider</span></span>(value: $value) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"255"</span></span>) .foregroundColor(textColor)</code> </pre> <br>  Revenons √† la d√©finition de ColorSlider () dans VStack et ajoutons nos param√®tres: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ColorSlider</span></span>(value: $rGuess, textColor: .red)</code> </pre> <br>  Assurez-vous que l'aper√ßu est OK avec le curseur rouge et remplacez les talons de texte par les curseurs vert et bleu.  N'oubliez pas d'y ins√©rer les param√®tres corrects: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ColorSlider</span></span>(value: $gGuess, textColor: .green) <span class="hljs-type"><span class="hljs-type">ColorSlider</span></span>(value: $bGuess, textColor: .blue)</code> </pre> <br>  Cliquez sur <b>Reprendre</b> pour mettre √† jour l'aper√ßu: <br><br><img src="https://habrastorage.org/webt/nx/4c/1z/nx4c1zblb3lkvi123ucqt6gte5e.png"><br><blockquote>  Remarque: vous avez peut-√™tre remarqu√© que vous devez souvent cliquer sur <b>Reprendre</b> .  Si vous aimez les raccourcis, vous adorerez probablement <b>Option-Command-P</b> . </blockquote>  Et maintenant quelque chose de sympa!  Dans le coin inf√©rieur droit de l'aper√ßu, cliquez sur le bouton d' <b>aper√ßu en direct</b> : <br><br><img src="https://habrastorage.org/webt/76/er/wu/76erwudgdom32-amjikoa6lfiya.png"><br><br>  L'aper√ßu en direct nous permet d'interagir avec l'aper√ßu comme si l'application s'ex√©cutait sur un simulateur! <br><br>  Essayez de d√©placer les curseurs: <br><br><img src="https://habrastorage.org/webt/9h/9e/pi/9h9epih_dde4yuduxpiu6lhdswg.png"><br><br>  Super!  Nous passons √† l'√©tape finale.  Apr√®s tout, nous voulons savoir dans quelle mesure nous avons choisi la couleur? <br><br><h2>  Afficher l'alerte </h2><br>  Apr√®s avoir r√©gl√© les curseurs aux positions souhait√©es, l'utilisateur appuie sur le bouton <b>Hit Me</b> , apr√®s quoi <b>Alert</b> appara√Æt avec une note. <br><br>  Tout d'abord, ajoutez une m√©thode √† ContentView pour calculer le score.  Entre les variables @State et <br>  corps ajouter cette m√©thode: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">computeScore</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rDiff = rGuess - rTarget <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gDiff = gGuess - gTarget <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bDiff = bGuess - bTarget <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> diff = sqrt(rDiff * rDiff + gDiff * gDiff + bDiff * bDiff) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Int</span></span>((<span class="hljs-number"><span class="hljs-number">1.0</span></span> - diff) * <span class="hljs-number"><span class="hljs-number">100.0</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) }</code> </pre> <br>  La valeur <b>diff</b> est simplement la distance entre deux points dans un espace tridimensionnel, c'est-√†-dire la valeur de l'erreur de l'utilisateur.  Pour obtenir une estimation, soustrayez diff de 1, puis r√©duisez sa valeur dans la plage 0 - 100. Plus la diff√©rence est petite, plus l'estimation est √©lev√©e. <br><br>  Remplacez ensuite le talon <b>Text ("Hit me button")</b> par ce code: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Button</span></span>(action: { }) { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Hit Me!"</span></span>) }</code> </pre> <br>  Le bouton a une action et une √©tiquette, comme UIButton.  Nous voulons que l'action d√©clenche une vue d'alerte.  Mais, si nous cr√©ons une alerte dans le bouton d'action, rien ne se passera. <br><br>  Au lieu de cela, nous int√©grerons Alert √† ContentView et ajouterons une variable '@State' de type Bool.  Ensuite, nous d√©finissons cette variable sur true, √† l'endroit o√π nous voulons que notre alerte apparaisse dans le bouton d'action.  La valeur sera r√©initialis√©e √† false - pour masquer l'alerte - lorsque l'utilisateur masque Alert. <br><br>  Ajoutez cette variable '@State': <br><br><pre> <code class="swift hljs">@<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> showAlert = <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  Ajoutez ensuite ce code comme bouton d'action: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.showAlert = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  l'auto est n√©cessaire pour nous, puisque showAlert est √† l'int√©rieur de la fermeture. <br><br>  Enfin, ajoutez le modificateur d'alerte au bouton, afin que notre bouton ressemble compl√®tement √† ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Button</span></span>(action: { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.showAlert = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }) { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Hit Me!"</span></span>) } .alert(isPresented: $showAlert) { <span class="hljs-type"><span class="hljs-type">Alert</span></span>(title: <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Your Score"</span></span>), message: <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"\(computeScore())"</span></span>)) }</code> </pre><br>  Nous passons $ showAlert en tant que liaison, car la valeur de cette variable changera au moment o√π l'utilisateur masque l'alerte, et cette modification entra√Ænera la mise √† jour de la vue. <br><br>  SwiftUI a un simple initialiseur pour la vue Alert.  Il a un bouton OK par d√©faut, nous n'avons donc m√™me pas besoin de le d√©finir comme param√®tre. <br><br>  Activez l'aper√ßu en direct, d√©placez les curseurs et appuyez sur le bouton Hit me.  Voila! <br><br><img src="https://habrastorage.org/webt/je/j2/lu/jej2lu5e6ookqthzdqvhz03lcqk.png"><br><br>  Maintenant, avec l'aper√ßu en direct, vous n'avez plus besoin d'un simulateur iOS.  Bien qu'avec elle, vous pouvez tester votre application horizontalement: <br><br><img src="https://habrastorage.org/webt/m2/xe/np/m2xenpxqc1hzub85tqronv9ykwe.png"><br><br><h2>  Conclusion </h2><br>  <a href="" rel="nofollow">Ici</a> vous pouvez t√©l√©charger le projet de publication termin√©. <br><br>  Ce didacticiel ne couvre que l√©g√®rement SwiftUI, mais vous avez maintenant une id√©e des nouvelles fonctionnalit√©s Xcode pour cr√©er des interfaces utilisateur et des aper√ßus, et comment utiliser les variables '@State' pour mettre √† jour votre interface utilisateur. <br><br>  Par souci de simplicit√©, nous n'avons pas cr√©√© de mod√®le de donn√©es pour RVB.  Mais la plupart des applications cr√©ent des mod√®les de leurs donn√©es √† l'aide de structures ou de classes.  Si vous souhaitez suivre les modifications du mod√®le dans SwiftUI, il doit se conformer au protocole <b>ObservableObject</b> et impl√©menter la propri√©t√© <b>willChange</b> , qui vous informe des modifications.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Consultez</a> les exemples Apple et en particulier le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">flux de donn√©es via SwiftUI</a> . <br><br>  Pour faciliter la compr√©hension de SwiftUI, vous pouvez ajouter une vue SwiftUI √† une application existante.  Consultez des exemples sur la fa√ßon de proc√©der rapidement et facilement. <br><br>  Voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ma publication</a> sur l'impl√©mentation des listes pliantes / d√©roulantes √† l'aide de SwiftUI. <br><br>  Enfin, √©tudiez la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">documentation de SwiftUI</a> , et il y a vraiment beaucoup de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">choses</a> utiles! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr471918/">https://habr.com/ru/post/fr471918/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr471904/index.html">Planificateur de ressources chez HPE InfoSight</a></li>
<li><a href="../fr471906/index.html">Les dangers des optimisations incorrectes</a></li>
<li><a href="../fr471908/index.html">La beaut√© inattendue des nombres premiers</a></li>
<li><a href="../fr471912/index.html">Apprendre l'anglais: 7 fa√ßons pratiques d'√©largir votre vocabulaire</a></li>
<li><a href="../fr471914/index.html">Fonctionnement du syst√®me graphique Sega Mega Drive: processeur d'affichage vid√©o</a></li>
<li><a href="../fr471924/index.html">Pr√©sentation des modules Sass</a></li>
<li><a href="../fr471928/index.html">Restaurer automatiquement la derni√®re configuration enregistr√©e dans les routeurs Mikrotik</a></li>
<li><a href="../fr471930/index.html">Mitap design atomique - lettres, couleurs, uniformes, √©quipe et argent</a></li>
<li><a href="../fr471938/index.html">Notes de mise en page: extensions Google Chrome utiles en 2019</a></li>
<li><a href="../fr471940/index.html">Comment r√©duire le risque de d√©faillance dans les r√®glements diff√©r√©s: l'affacturage pour les entreprises</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>