<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🤝‍👨🏼 👏🏽 🕓 4 trucos que nos ayudaron a optimizar la interfaz 🤯 👩‍💼 👨🏼‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las animaciones hermosas se han establecido durante mucho tiempo en las tendencias de diseño. Los diseñadores de UI hacen carruseles elaborados, desca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>4 trucos que nos ayudaron a optimizar la interfaz</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/epayments/blog/455700/"><p>  Las animaciones hermosas se han establecido durante mucho tiempo en las tendencias de diseño.  Los diseñadores de UI hacen carruseles elaborados, descargas, animaciones de menú y otras decoraciones, mientras que los desarrolladores frontend los traducen a código.  Pero el sitio no solo debería verse bien, sino también funcionar rápidamente. </p><br><p>  Una interfaz moderna debería optimizar su código.  Esto es especialmente cierto para los productos en los que la mayoría de la audiencia va al sitio desde dispositivos móviles.  Algunos métodos de animación se retrasan incluso en Chrome en las mejores computadoras, pero deberían funcionar sin problemas en un teléfono inteligente promedio. </p><br><p>  Nuestros desarrolladores utilizaron una gran cantidad de técnicas que ayudaron a optimizar el sitio y acelerar su trabajo.  Reuní 4 de los más interesantes de ellos.  Compartimos conocimientos que serán útiles para principiantes y profesionales, así como también proporcionamos enlaces a tutoriales útiles. </p><br><p><img src="https://habrastorage.org/webt/1e/2e/ic/1e2eic7lnnlwnm22gy1y2ah8zto.jpeg"></p><a name="habracut"></a><br><h2 id="1-animaciya-na-scss">  1. Animación en SCSS </h2><br><p>  <strong>El sitio tiene mucha animación.</strong>  <strong>Necesitamos que el navegador lo reproduzca con una velocidad de cuadro estable de 60 fps.</strong>  <strong>En CSS puro, esto es difícil de hacer, así que usamos SCSS.</strong> </p><br><p>  Para crear los controles deslizantes, utilizamos la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Swiper</a> .  Para un control deslizante horizontal, el uso de esta biblioteca está justificado, ya que necesitábamos proporcionar soporte para svayp por parte del usuario.  Pero para un carrusel sin fin vertical, Swiper no es necesario, no hay interacción del usuario.  Por lo tanto, queríamos repetir la misma funcionalidad usando solo funciones CSS. </p><br><p>  La primera y más importante condición cuando se trabaja con animación CSS es usar solo las propiedades de transformación y opacidad.  Los navegadores pueden optimizar de forma independiente la animación de estas propiedades y producir 60 fps estables.  Sin embargo, el uso de @keyframes solo no es posible escribir diferentes animaciones para diferentes elementos, y animar cada elemento individualmente en CSS puro lleva demasiado tiempo.  ¿Cómo escribir rápidamente la animación que necesitamos?  Elegimos SCSS, el dialecto SASS, una extensión CSS más funcional. </p><br><p>  Analicemos el uso de SCSS utilizando el ejemplo de nuestro control deslizante vertical. </p><br><p><img src="https://habrastorage.org/webt/bt/si/ia/btsiiagvb3utwdiuf4hasoszp7a.gif"></p><br><p>  A nuestra disposición hay un contenedor cuya altura es igual a la altura de los tres elementos del carrusel.  En su interior hay otro contenedor que contiene todos los elementos del carrusel. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper slider-items"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Eliminamos la visibilidad de los elementos del contenedor que irán más allá y establecemos la altura de los bloques. </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider { position: relative; overflow: hidden; height: $itemHeight * 3; .vertical-carousel-slider-item { height: $itemHeight; } }</code> </pre> <br><p>  El cálculo de la animación cambia solo si cambia el número de elementos en el carrusel.  A continuación, escribimos un mixin que toma un parámetro de entrada: <code>$itemCount</code> </p><br><pre> <code class="plaintext hljs">@mixin verticalSlideAnimation($itemCount) { }</code> </pre> <br><p>  En el mixin, genere un fotograma clave para cada elemento, establezca el estado inicial y use <code>:nth-child</code> determinar la animación para el elemento. </p><br><pre> <code class="plaintext hljs">for $i from * 1 through $itemCount { $animationName: carousel-item-#{$itemCount}-#{$i}; @keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } } .vertical-carousel-slider-item:nchild(#{$i}) { animation: $stepDuration * $itemCount $animation ease infinite; } }</code> </pre> <br><p>  Además, durante la animación, solo moveremos los elementos a lo largo del eje y y cambiaremos la escala del elemento en el centro. </p><br><p>  Estados del elemento carrusel: </p><br><ol><li>  Paz </li><li>  Desplazamiento Y </li><li>  Desplazamiento Y </li><li>  Y compensado con disminución </li></ol><br><p>  Cada elemento se moverá hacia arriba <code>$itemCount</code> veces, aumentará una vez y disminuirá una vez durante el movimiento.  Por lo tanto, generaremos y calcularemos la animación para cada uno de los movimientos ascendentes. </p><br><pre> <code class="plaintext hljs">@keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } @for $j from 0 through $itemCount { $isFocusedStep: $i == $j + 2; $isNotPrevStep: $i != $j + 1; $offset: 100% / $itemCount * ($animationTime / $stepDuration); @if ($isFocusedStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount, $offset)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount)} { transform: getTranslate($j + 1) scale(.95); } } @else if ($isNotPrevStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(.95); } } } }</code> </pre> <br><p>  Queda por definir algunas variables y funciones: </p><br><ul><li>  <code>$animationTime</code> - tiempo de interpolación de movimiento </li><li>  <code>$stepDuration</code> : tiempo total de ejecución de un paso de animación ( <code>$animationTime</code> + tiempo de descanso del carrusel) </li><li>  <code>getPercentForStep($step, $itemCount, $offset)</code> : una función que devuelve en porcentaje el punto extremo de uno de los estados. </li><li>  <code>getTranslate($step)</code> : devuelve la traducción según el paso de animación </li></ul><br><p>  Ejemplo de implementaciones de funciones: </p><br><pre> <code class="plaintext hljs">@function getPercentForStep($step, $count, $offset: 0) { @return 100% * $step / $count - $offset; } @function getTranslate($step) { @return translate3d(0, -100% * $step, 0); }</code> </pre> <br><p>  Tenemos un carrusel en funcionamiento con un elemento creciente en el medio.  Queda por hacer una sombra debajo de los elementos crecientes.  Inicialmente, cada elemento del carrusel tenía un pseudo-elemento: después, que a su vez tenía una sombra.  Para no animar la propiedad de sombra, utilizamos la propiedad de opacidad para ella, es decir  Solo mostró y escondió la sombra. </p><br><p>  Pero en la nueva implementación para tal solución, debe generar muchos fotogramas clave adicionales para cada pseudo-elemento.  Decidimos hacerlo más fácil: habrá un bloque con una sombra y ocupará espacio exactamente debajo del elemento central del carrusel. </p><br><p>  Agregue un div que sea responsable de la sombra. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-shadow"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Lo estilizamos y agregamos animaciones. </p><br><pre> <code class="plaintext hljs">@keyframes shadowAnimation { 0% { opacity: 1; } 80% { opacity: 1; } 90% { opacity: 0; } 100% { opacity: 1; } } .vertical-carousel-slider-shadow { top: $itemHeight; left: 0; right: 0; height: $itemHeight; animation: $stepDuration shadowAnimation ease infinite; }</code> </pre> <br><p>  En este caso, no necesita generar y pensar en una forma de animar la sombra debajo de cada elemento, solo animamos un bloque, tiene dos estados: es visible y está oculto </p><br><p>  Como resultado, tenemos un carrusel de CSS puro que anima solo con propiedades bien optimizadas.  Esto permite que el navegador use aceleración de hardware para renderizar.  De ahí el beneficio tangible en comparación con la animación JS: </p><br><ol><li>  Al desplazarse por páginas con animaciones en dispositivos débiles, los marcos se omitieron claramente en las animaciones JS, bajando FPS a 15-20.  Las animaciones CSS han mejorado claramente las cosas.  En estos dispositivos, esta cifra era de al menos 50-55 FPS. </li><li>  Nos deshicimos del trabajo de un módulo de terceros donde no era necesario. </li><li>  La animación se reproducirá incluso cuando JS esté desactivado </li></ol><br><p>  La animación JS debe usarse si se necesita un control estricto sobre cada cuadro: pausa, reproducción inversa, rebobinado, reacción a las acciones del usuario.  En otros casos, recomendamos usar CSS puro. </p><br><p>  <strong>Enlaces utiles</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Guía de animación de desenfoque</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Guía de propiedades CSS y tareas del navegador</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Guía de animación de sombras</a> </li></ul><br><h2 id="2-ispolzovanie-intersection-observer-api">  2. Usando la API de Intersection Observer </h2><br><p>  <strong>La animación que el visitante del sitio no ve se reproduce en algún lugar fuera de la vista y carga la CPU.</strong>  <strong>Usando el Intersection Observer, determinamos qué tipo de animación es visible en la pantalla en este momento, y solo la reproducimos.</strong> </p><br><p>  Todos los trucos del último párrafo se pueden combinar con el Intersection Observer.  Esta herramienta ayuda a no cargar el navegador con animación que el visitante del sitio no ve.  Anteriormente, los "oyentes" de los eventos con uso intensivo de recursos se usaban para comprender si un visitante estaba mirando un elemento animado y esto no producía un fuerte "escape".  La diferencia entre usar animación fuera de la ventana gráfica y usar oyentes fue mínima.  Intersection Observer API requiere menos recursos y ayuda a reproducir solo la animación que es visible para el visitante. </p><br><p>  En nuestro sitio, la animación se activa solo cuando aparece un elemento en la ventana gráfica.  Si no hiciéramos esto, las páginas se sobrecargarían con la ejecución constante de animaciones en bucle que no se veían.  Intersection Observer API le permite monitorear la intersección del elemento con el elemento primario o el alcance del documento. </p><br><p>  <strong>Ejemplo de implementación</strong> </p><br><p>  Como ejemplo, mostramos cómo optimizar la animación en JS.  La idea es simple: la animación se reproduce mientras el elemento animado está en la ventana gráfica.  Para la implementación, utilizamos la API Intersection Observer. </p><br><p>  Agregue manejo de clases <code>is-paused</code> a los estilos </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider.is-paused { .vertical-carousel-slider-wrapper { .vertical-carousel-slider-item { animation-play-state: paused; } } .vertical-carousel-slider-shadow { animation-play-state: paused; } }</code> </pre> <br><p>  Es decir  cuando aparezca esta clase, la animación se detendrá. </p><br><p>  Ahora describimos la lógica de agregar y eliminar esta clase </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.IntersectionObserver) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> el = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.b-vertical-carousel-slider'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntersectionObserver(intersectionObserverCallback); observer.observe(el); }</code> </pre> <br><p>  Aquí creamos una instancia de IntersectionObserver, especificamos la función <code>intersectionObserverCallback</code> , que funcionará cuando cambie la visibilidad. </p><br><p>  Ahora defina <code>intersectionObserverCallback</code> </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersectionObserverCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entries</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } helperDOM.toggleClass(el, <span class="hljs-string"><span class="hljs-string">'is-paused'</span></span>, entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); };</code> </pre> <br><p>  Ahora la animación se reproduce solo en aquellos elementos que son visibles.  Tan pronto como el elemento ha desaparecido del campo de visión, la animación se detiene.  Cuando el visitante vuelva a él, la reproducción continuará. </p><br><p>  <strong>Enlaces utiles</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Navegadores que admiten Intersection Observer</a> </li><li>  Para los navegadores que no lo admiten, debe usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">polyfil</a> </li></ul><br><h2 id="3-rendering-svg">  3. Representación SVG </h2><br><p>  <strong>Una gran cantidad de imágenes o el uso de sprites provoca frisos y retrasos en los primeros segundos después de la carga.</strong>  <strong>Incrustar SVG en el código de la página ayuda visualmente a facilitar la carga.</strong> </p><br><p>  Cuando seleccionamos métodos para trabajar con imágenes, teníamos 2 opciones de optimización: incrustar SVG en HTML o usar sprites.  Nos decidimos por la inclusión.  Incrustamos el código XML de cada imagen directamente en el código HTML de las páginas.  Esto aumenta ligeramente su tamaño, pero SVG se sirve en línea inmediatamente con el documento. </p><br><p>  Muchos desarrolladores continúan usando sprites SVG.  ¿Cuál es la esencia del método? Una colección de imágenes (por ejemplo, iconos) se recogen en un gran lienzo de imágenes, que se llama un sprite.  Cuando necesita mostrar un icono específico, se llama a un sprite, después de lo cual se proporcionan las coordenadas de la pieza específica en la que se encuentra.  Esto se ha hecho durante mucho tiempo, incluso en la primera versión de HTTP.  Sprites ayudó a almacenar el archivo en caché agresivamente y a reducir la cantidad de solicitudes del servidor.  Esto fue importante porque muchas solicitudes simultáneas ralentizaron el navegador.  El uso de sprites SVG es una muleta típica con la que descuida la lógica de trabajar en aras de ahorrar recursos.  Ahora, el número de solicitudes no es tan importante, por lo que recomendamos insertar. </p><br><p>  En primer lugar, afecta positivamente el rendimiento desde el punto de vista del visitante.  Él ve cómo los íconos se cargan instantáneamente y no sufre los primeros segundos después de cargar la página.  Cuando se usan imágenes sprite o PNG, la página que se está cargando se ralentiza un poco.  Esto se siente especialmente si el visitante se desplaza inmediatamente por la página cargada: FPS se reducirá a 5-15 en dispositivos que no sean los mejores.  Incrustar SVG en HTML ayuda a reducir la latencia de página (subjetiva, desde el punto de vista del cliente) y deshacerse de los frisos y saltos de fotogramas durante la carga. </p><br><h2 id="4-keshirovanie-s-ispolzovaniem-service-worker-i-http-cache">  4. Almacenamiento en caché con Service Worker y HTTP Cache </h2><br><p>  <strong>No tiene sentido volver a cargar una página que no ha cambiado y utilizar el tráfico de visitantes.</strong>  <strong>Hay muchas estrategias de almacenamiento en caché, nos decidimos por la combinación más eficiente.</strong> </p><br><p>  Vale la pena optimizar el uso no solo de la CPU / GPU, sino también de la red.  Los dispositivos móviles son una limitación no solo en términos de recursos, sino también en términos de velocidad y tráfico de Internet.  El almacenamiento en caché nos ayudó aquí.  Le permite guardar respuestas a solicitudes HTTP y usarlas sin recibir una respuesta del servidor nuevamente. </p><br><p>  Cuando consideramos una estrategia de almacenamiento en caché, elegimos usar Service Worker y HTTP Cache al mismo tiempo.  Comencemos con el primero y más avanzado.  Service Worker es un archivo js que puede controlar su página o archivo, interceptar y modificar solicitudes, así como solicitudes de memoria caché mediante programación.  Actúa como un proxy entre el sitio y el servidor y determina su comportamiento fuera de línea.  Todo esto se hace en el "frente", sin conectar un "back-end". </p><br><p>  Service Worker tiene una tremenda variabilidad.  Podemos programar el comportamiento como queramos.  Por ejemplo, sabemos que un visitante que fue a la página número 1, con una probabilidad del 90%, irá a la página número 2.  Le pedimos a SW que cargue la segunda página con el fondo cuando el visitante todavía está en la primera.  Cuando vaya a él, la página se cargará al instante.  Se puede usar para diferentes tareas: </p><br><ul><li>  Sincronización de datos en segundo plano </li><li>  Calculadoras fuera de línea </li><li>  Plantillas personalizadas </li><li>  Reacción a una hora y fecha específicas. </li></ul><br><p>  Los archivos de Service Worker se pueden hacer en diferentes servicios.  Recomendamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Workbox</a> .  Es bastante simple y le permite crear un conjunto de reglas mediante las cuales se realiza el almacenamiento en caché, por ejemplo, precache. </p><br><p>  Los trabajadores de servicio no son compatibles con todos los navegadores, como IE, Safari o Chrome anteriores a la versión 40.0.  Si el dispositivo no puede funcionar con él, sigue las reglas de almacenamiento en caché de HTTP Cache.  Agregamos los siguientes encabezados HTTP a las páginas: </p><br><pre> <code class="plaintext hljs">cache-control: no-cache last-modified: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  En este caso, el navegador agrega respuestas a las solicitudes al repositorio, pero con cada solicitud posterior envía un encabezado para verificar los cambios. </p><br><pre> <code class="plaintext hljs">if-modified-since: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  En caso de que no se produzcan cambios, el navegador recibe una respuesta con el código 304 No modificado y utiliza el contenido almacenado en la memoria caché.  Si se realizan cambios en el documento, la respuesta se devuelve con el código 200 y se escribe una nueva respuesta en el almacenamiento del navegador. </p><br><p>  Un poco más tarde, cambiamos el método de almacenamiento en caché y verificamos la cantidad hash en el nombre del archivo.  Asegura que el recurso seguirá siendo único.  Por lo tanto, podríamos almacenar agresivamente el contenido en caché.  El siguiente encabezado se agregó en respuesta: </p><br><pre> <code class="plaintext hljs">Cache-control:max-age=31536000, immutable</code> </pre> <br><p>  La edad máxima indica el tiempo máximo de almacenamiento en caché, en nuestro caso es de 1 año.  Un valor inmutable significa que dicha respuesta no necesita ser verificada por cambios. </p><br><p>  <strong>Enlaces utiles</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/">Manual de almacenamiento en caché de HTTP</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Guía de uso de API de Service Worker</a> </li></ul><br><p>  Estas no son todas las formas de optimizar el sitio.  Esto podría agregar un rechazo de bootstrap, reducir la cantidad de elementos DOM y eventos, y mucho más.  Pero estos son los consejos que nos ayudaron a hacer que el sitio sea rápido y receptivo, a pesar de la gran cantidad de animación. </p><br><h3 id="priglashaem-v-nashu-komandu">  Te invitamos a nuestro equipo </h3><br><p>  Siempre estamos buscando especialistas geniales en nuestra oficina en San Petersburgo para nuestras ambiciosas tareas: desarrolladores, evaluadores, diseñadores.  A continuación hay vacantes: únete a nosotros. </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollador frontend</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ingeniero de control de calidad</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ingeniero de desarrollo de software en prueba</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/455700/">https://habr.com/ru/post/455700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455686/index.html">¿Cómo elegir la mejor herramienta de gestión de proyectos si eres un milenio?</a></li>
<li><a href="../455692/index.html">ASZP: el restyling o el teatro comienzan con una percha</a></li>
<li><a href="../455694/index.html">Arquitectura de facturación de la próxima generación: transición a Tarantool</a></li>
<li><a href="../455696/index.html">El estado electrónico del futuro. Parte 2</a></li>
<li><a href="../455698/index.html">El libro "Cómo funciona JavaScript"</a></li>
<li><a href="../455702/index.html">Generación efectiva de números en un intervalo dado</a></li>
<li><a href="../455710/index.html">¿Por qué en Leroy Merlin necesitamos nuestro propio departamento de desarrollo ruso para 200 personas?</a></li>
<li><a href="../455714/index.html">Exporte automáticamente Google Forms a Notion usando IFTTT y Django</a></li>
<li><a href="../455716/index.html">15 mejores prácticas para implementar software de inteligencia empresarial</a></li>
<li><a href="../455720/index.html">Cómo construimos la interfaz de usuario para sistemas publicitarios</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>