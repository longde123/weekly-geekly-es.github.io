<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçü§ù‚Äçüë®üèº üëèüèΩ üïì 4 trucos que nos ayudaron a optimizar la interfaz ü§Ø üë©‚Äçüíº üë®üèº‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las animaciones hermosas se han establecido durante mucho tiempo en las tendencias de dise√±o. Los dise√±adores de UI hacen carruseles elaborados, desca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>4 trucos que nos ayudaron a optimizar la interfaz</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/epayments/blog/455700/"><p>  Las animaciones hermosas se han establecido durante mucho tiempo en las tendencias de dise√±o.  Los dise√±adores de UI hacen carruseles elaborados, descargas, animaciones de men√∫ y otras decoraciones, mientras que los desarrolladores frontend los traducen a c√≥digo.  Pero el sitio no solo deber√≠a verse bien, sino tambi√©n funcionar r√°pidamente. </p><br><p>  Una interfaz moderna deber√≠a optimizar su c√≥digo.  Esto es especialmente cierto para los productos en los que la mayor√≠a de la audiencia va al sitio desde dispositivos m√≥viles.  Algunos m√©todos de animaci√≥n se retrasan incluso en Chrome en las mejores computadoras, pero deber√≠an funcionar sin problemas en un tel√©fono inteligente promedio. </p><br><p>  Nuestros desarrolladores utilizaron una gran cantidad de t√©cnicas que ayudaron a optimizar el sitio y acelerar su trabajo.  Reun√≠ 4 de los m√°s interesantes de ellos.  Compartimos conocimientos que ser√°n √∫tiles para principiantes y profesionales, as√≠ como tambi√©n proporcionamos enlaces a tutoriales √∫tiles. </p><br><p><img src="https://habrastorage.org/webt/1e/2e/ic/1e2eic7lnnlwnm22gy1y2ah8zto.jpeg"></p><a name="habracut"></a><br><h2 id="1-animaciya-na-scss">  1. Animaci√≥n en SCSS </h2><br><p>  <strong>El sitio tiene mucha animaci√≥n.</strong>  <strong>Necesitamos que el navegador lo reproduzca con una velocidad de cuadro estable de 60 fps.</strong>  <strong>En CSS puro, esto es dif√≠cil de hacer, as√≠ que usamos SCSS.</strong> </p><br><p>  Para crear los controles deslizantes, utilizamos la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Swiper</a> .  Para un control deslizante horizontal, el uso de esta biblioteca est√° justificado, ya que necesit√°bamos proporcionar soporte para svayp por parte del usuario.  Pero para un carrusel sin fin vertical, Swiper no es necesario, no hay interacci√≥n del usuario.  Por lo tanto, quer√≠amos repetir la misma funcionalidad usando solo funciones CSS. </p><br><p>  La primera y m√°s importante condici√≥n cuando se trabaja con animaci√≥n CSS es usar solo las propiedades de transformaci√≥n y opacidad.  Los navegadores pueden optimizar de forma independiente la animaci√≥n de estas propiedades y producir 60 fps estables.  Sin embargo, el uso de @keyframes solo no es posible escribir diferentes animaciones para diferentes elementos, y animar cada elemento individualmente en CSS puro lleva demasiado tiempo.  ¬øC√≥mo escribir r√°pidamente la animaci√≥n que necesitamos?  Elegimos SCSS, el dialecto SASS, una extensi√≥n CSS m√°s funcional. </p><br><p>  Analicemos el uso de SCSS utilizando el ejemplo de nuestro control deslizante vertical. </p><br><p><img src="https://habrastorage.org/webt/bt/si/ia/btsiiagvb3utwdiuf4hasoszp7a.gif"></p><br><p>  A nuestra disposici√≥n hay un contenedor cuya altura es igual a la altura de los tres elementos del carrusel.  En su interior hay otro contenedor que contiene todos los elementos del carrusel. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper slider-items"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Eliminamos la visibilidad de los elementos del contenedor que ir√°n m√°s all√° y establecemos la altura de los bloques. </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider { position: relative; overflow: hidden; height: $itemHeight * 3; .vertical-carousel-slider-item { height: $itemHeight; } }</code> </pre> <br><p>  El c√°lculo de la animaci√≥n cambia solo si cambia el n√∫mero de elementos en el carrusel.  A continuaci√≥n, escribimos un mixin que toma un par√°metro de entrada: <code>$itemCount</code> </p><br><pre> <code class="plaintext hljs">@mixin verticalSlideAnimation($itemCount) { }</code> </pre> <br><p>  En el mixin, genere un fotograma clave para cada elemento, establezca el estado inicial y use <code>:nth-child</code> determinar la animaci√≥n para el elemento. </p><br><pre> <code class="plaintext hljs">for $i from * 1 through $itemCount { $animationName: carousel-item-#{$itemCount}-#{$i}; @keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } } .vertical-carousel-slider-item:nchild(#{$i}) { animation: $stepDuration * $itemCount $animation ease infinite; } }</code> </pre> <br><p>  Adem√°s, durante la animaci√≥n, solo moveremos los elementos a lo largo del eje y y cambiaremos la escala del elemento en el centro. </p><br><p>  Estados del elemento carrusel: </p><br><ol><li>  Paz </li><li>  Desplazamiento Y </li><li>  Desplazamiento Y </li><li>  Y compensado con disminuci√≥n </li></ol><br><p>  Cada elemento se mover√° hacia arriba <code>$itemCount</code> veces, aumentar√° una vez y disminuir√° una vez durante el movimiento.  Por lo tanto, generaremos y calcularemos la animaci√≥n para cada uno de los movimientos ascendentes. </p><br><pre> <code class="plaintext hljs">@keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } @for $j from 0 through $itemCount { $isFocusedStep: $i == $j + 2; $isNotPrevStep: $i != $j + 1; $offset: 100% / $itemCount * ($animationTime / $stepDuration); @if ($isFocusedStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount, $offset)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount)} { transform: getTranslate($j + 1) scale(.95); } } @else if ($isNotPrevStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(.95); } } } }</code> </pre> <br><p>  Queda por definir algunas variables y funciones: </p><br><ul><li>  <code>$animationTime</code> - tiempo de interpolaci√≥n de movimiento </li><li>  <code>$stepDuration</code> : tiempo total de ejecuci√≥n de un paso de animaci√≥n ( <code>$animationTime</code> + tiempo de descanso del carrusel) </li><li>  <code>getPercentForStep($step, $itemCount, $offset)</code> : una funci√≥n que devuelve en porcentaje el punto extremo de uno de los estados. </li><li>  <code>getTranslate($step)</code> : devuelve la traducci√≥n seg√∫n el paso de animaci√≥n </li></ul><br><p>  Ejemplo de implementaciones de funciones: </p><br><pre> <code class="plaintext hljs">@function getPercentForStep($step, $count, $offset: 0) { @return 100% * $step / $count - $offset; } @function getTranslate($step) { @return translate3d(0, -100% * $step, 0); }</code> </pre> <br><p>  Tenemos un carrusel en funcionamiento con un elemento creciente en el medio.  Queda por hacer una sombra debajo de los elementos crecientes.  Inicialmente, cada elemento del carrusel ten√≠a un pseudo-elemento: despu√©s, que a su vez ten√≠a una sombra.  Para no animar la propiedad de sombra, utilizamos la propiedad de opacidad para ella, es decir  Solo mostr√≥ y escondi√≥ la sombra. </p><br><p>  Pero en la nueva implementaci√≥n para tal soluci√≥n, debe generar muchos fotogramas clave adicionales para cada pseudo-elemento.  Decidimos hacerlo m√°s f√°cil: habr√° un bloque con una sombra y ocupar√° espacio exactamente debajo del elemento central del carrusel. </p><br><p>  Agregue un div que sea responsable de la sombra. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-shadow"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Lo estilizamos y agregamos animaciones. </p><br><pre> <code class="plaintext hljs">@keyframes shadowAnimation { 0% { opacity: 1; } 80% { opacity: 1; } 90% { opacity: 0; } 100% { opacity: 1; } } .vertical-carousel-slider-shadow { top: $itemHeight; left: 0; right: 0; height: $itemHeight; animation: $stepDuration shadowAnimation ease infinite; }</code> </pre> <br><p>  En este caso, no necesita generar y pensar en una forma de animar la sombra debajo de cada elemento, solo animamos un bloque, tiene dos estados: es visible y est√° oculto </p><br><p>  Como resultado, tenemos un carrusel de CSS puro que anima solo con propiedades bien optimizadas.  Esto permite que el navegador use aceleraci√≥n de hardware para renderizar.  De ah√≠ el beneficio tangible en comparaci√≥n con la animaci√≥n JS: </p><br><ol><li>  Al desplazarse por p√°ginas con animaciones en dispositivos d√©biles, los marcos se omitieron claramente en las animaciones JS, bajando FPS a 15-20.  Las animaciones CSS han mejorado claramente las cosas.  En estos dispositivos, esta cifra era de al menos 50-55 FPS. </li><li>  Nos deshicimos del trabajo de un m√≥dulo de terceros donde no era necesario. </li><li>  La animaci√≥n se reproducir√° incluso cuando JS est√© desactivado </li></ol><br><p>  La animaci√≥n JS debe usarse si se necesita un control estricto sobre cada cuadro: pausa, reproducci√≥n inversa, rebobinado, reacci√≥n a las acciones del usuario.  En otros casos, recomendamos usar CSS puro. </p><br><p>  <strong>Enlaces utiles</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gu√≠a de animaci√≥n de desenfoque</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gu√≠a de propiedades CSS y tareas del navegador</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gu√≠a de animaci√≥n de sombras</a> </li></ul><br><h2 id="2-ispolzovanie-intersection-observer-api">  2. Usando la API de Intersection Observer </h2><br><p>  <strong>La animaci√≥n que el visitante del sitio no ve se reproduce en alg√∫n lugar fuera de la vista y carga la CPU.</strong>  <strong>Usando el Intersection Observer, determinamos qu√© tipo de animaci√≥n es visible en la pantalla en este momento, y solo la reproducimos.</strong> </p><br><p>  Todos los trucos del √∫ltimo p√°rrafo se pueden combinar con el Intersection Observer.  Esta herramienta ayuda a no cargar el navegador con animaci√≥n que el visitante del sitio no ve.  Anteriormente, los "oyentes" de los eventos con uso intensivo de recursos se usaban para comprender si un visitante estaba mirando un elemento animado y esto no produc√≠a un fuerte "escape".  La diferencia entre usar animaci√≥n fuera de la ventana gr√°fica y usar oyentes fue m√≠nima.  Intersection Observer API requiere menos recursos y ayuda a reproducir solo la animaci√≥n que es visible para el visitante. </p><br><p>  En nuestro sitio, la animaci√≥n se activa solo cuando aparece un elemento en la ventana gr√°fica.  Si no hici√©ramos esto, las p√°ginas se sobrecargar√≠an con la ejecuci√≥n constante de animaciones en bucle que no se ve√≠an.  Intersection Observer API le permite monitorear la intersecci√≥n del elemento con el elemento primario o el alcance del documento. </p><br><p>  <strong>Ejemplo de implementaci√≥n</strong> </p><br><p>  Como ejemplo, mostramos c√≥mo optimizar la animaci√≥n en JS.  La idea es simple: la animaci√≥n se reproduce mientras el elemento animado est√° en la ventana gr√°fica.  Para la implementaci√≥n, utilizamos la API Intersection Observer. </p><br><p>  Agregue manejo de clases <code>is-paused</code> a los estilos </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider.is-paused { .vertical-carousel-slider-wrapper { .vertical-carousel-slider-item { animation-play-state: paused; } } .vertical-carousel-slider-shadow { animation-play-state: paused; } }</code> </pre> <br><p>  Es decir  cuando aparezca esta clase, la animaci√≥n se detendr√°. </p><br><p>  Ahora describimos la l√≥gica de agregar y eliminar esta clase </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.IntersectionObserver) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> el = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.b-vertical-carousel-slider'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntersectionObserver(intersectionObserverCallback); observer.observe(el); }</code> </pre> <br><p>  Aqu√≠ creamos una instancia de IntersectionObserver, especificamos la funci√≥n <code>intersectionObserverCallback</code> , que funcionar√° cuando cambie la visibilidad. </p><br><p>  Ahora defina <code>intersectionObserverCallback</code> </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersectionObserverCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entries</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } helperDOM.toggleClass(el, <span class="hljs-string"><span class="hljs-string">'is-paused'</span></span>, entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); };</code> </pre> <br><p>  Ahora la animaci√≥n se reproduce solo en aquellos elementos que son visibles.  Tan pronto como el elemento ha desaparecido del campo de visi√≥n, la animaci√≥n se detiene.  Cuando el visitante vuelva a √©l, la reproducci√≥n continuar√°. </p><br><p>  <strong>Enlaces utiles</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Navegadores que admiten Intersection Observer</a> </li><li>  Para los navegadores que no lo admiten, debe usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">polyfil</a> </li></ul><br><h2 id="3-rendering-svg">  3. Representaci√≥n SVG </h2><br><p>  <strong>Una gran cantidad de im√°genes o el uso de sprites provoca frisos y retrasos en los primeros segundos despu√©s de la carga.</strong>  <strong>Incrustar SVG en el c√≥digo de la p√°gina ayuda visualmente a facilitar la carga.</strong> </p><br><p>  Cuando seleccionamos m√©todos para trabajar con im√°genes, ten√≠amos 2 opciones de optimizaci√≥n: incrustar SVG en HTML o usar sprites.  Nos decidimos por la inclusi√≥n.  Incrustamos el c√≥digo XML de cada imagen directamente en el c√≥digo HTML de las p√°ginas.  Esto aumenta ligeramente su tama√±o, pero SVG se sirve en l√≠nea inmediatamente con el documento. </p><br><p>  Muchos desarrolladores contin√∫an usando sprites SVG.  ¬øCu√°l es la esencia del m√©todo? Una colecci√≥n de im√°genes (por ejemplo, iconos) se recogen en un gran lienzo de im√°genes, que se llama un sprite.  Cuando necesita mostrar un icono espec√≠fico, se llama a un sprite, despu√©s de lo cual se proporcionan las coordenadas de la pieza espec√≠fica en la que se encuentra.  Esto se ha hecho durante mucho tiempo, incluso en la primera versi√≥n de HTTP.  Sprites ayud√≥ a almacenar el archivo en cach√© agresivamente y a reducir la cantidad de solicitudes del servidor.  Esto fue importante porque muchas solicitudes simult√°neas ralentizaron el navegador.  El uso de sprites SVG es una muleta t√≠pica con la que descuida la l√≥gica de trabajar en aras de ahorrar recursos.  Ahora, el n√∫mero de solicitudes no es tan importante, por lo que recomendamos insertar. </p><br><p>  En primer lugar, afecta positivamente el rendimiento desde el punto de vista del visitante.  √âl ve c√≥mo los √≠conos se cargan instant√°neamente y no sufre los primeros segundos despu√©s de cargar la p√°gina.  Cuando se usan im√°genes sprite o PNG, la p√°gina que se est√° cargando se ralentiza un poco.  Esto se siente especialmente si el visitante se desplaza inmediatamente por la p√°gina cargada: FPS se reducir√° a 5-15 en dispositivos que no sean los mejores.  Incrustar SVG en HTML ayuda a reducir la latencia de p√°gina (subjetiva, desde el punto de vista del cliente) y deshacerse de los frisos y saltos de fotogramas durante la carga. </p><br><h2 id="4-keshirovanie-s-ispolzovaniem-service-worker-i-http-cache">  4. Almacenamiento en cach√© con Service Worker y HTTP Cache </h2><br><p>  <strong>No tiene sentido volver a cargar una p√°gina que no ha cambiado y utilizar el tr√°fico de visitantes.</strong>  <strong>Hay muchas estrategias de almacenamiento en cach√©, nos decidimos por la combinaci√≥n m√°s eficiente.</strong> </p><br><p>  Vale la pena optimizar el uso no solo de la CPU / GPU, sino tambi√©n de la red.  Los dispositivos m√≥viles son una limitaci√≥n no solo en t√©rminos de recursos, sino tambi√©n en t√©rminos de velocidad y tr√°fico de Internet.  El almacenamiento en cach√© nos ayud√≥ aqu√≠.  Le permite guardar respuestas a solicitudes HTTP y usarlas sin recibir una respuesta del servidor nuevamente. </p><br><p>  Cuando consideramos una estrategia de almacenamiento en cach√©, elegimos usar Service Worker y HTTP Cache al mismo tiempo.  Comencemos con el primero y m√°s avanzado.  Service Worker es un archivo js que puede controlar su p√°gina o archivo, interceptar y modificar solicitudes, as√≠ como solicitudes de memoria cach√© mediante programaci√≥n.  Act√∫a como un proxy entre el sitio y el servidor y determina su comportamiento fuera de l√≠nea.  Todo esto se hace en el "frente", sin conectar un "back-end". </p><br><p>  Service Worker tiene una tremenda variabilidad.  Podemos programar el comportamiento como queramos.  Por ejemplo, sabemos que un visitante que fue a la p√°gina n√∫mero 1, con una probabilidad del 90%, ir√° a la p√°gina n√∫mero 2.  Le pedimos a SW que cargue la segunda p√°gina con el fondo cuando el visitante todav√≠a est√° en la primera.  Cuando vaya a √©l, la p√°gina se cargar√° al instante.  Se puede usar para diferentes tareas: </p><br><ul><li>  Sincronizaci√≥n de datos en segundo plano </li><li>  Calculadoras fuera de l√≠nea </li><li>  Plantillas personalizadas </li><li>  Reacci√≥n a una hora y fecha espec√≠ficas. </li></ul><br><p>  Los archivos de Service Worker se pueden hacer en diferentes servicios.  Recomendamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Workbox</a> .  Es bastante simple y le permite crear un conjunto de reglas mediante las cuales se realiza el almacenamiento en cach√©, por ejemplo, precache. </p><br><p>  Los trabajadores de servicio no son compatibles con todos los navegadores, como IE, Safari o Chrome anteriores a la versi√≥n 40.0.  Si el dispositivo no puede funcionar con √©l, sigue las reglas de almacenamiento en cach√© de HTTP Cache.  Agregamos los siguientes encabezados HTTP a las p√°ginas: </p><br><pre> <code class="plaintext hljs">cache-control: no-cache last-modified: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  En este caso, el navegador agrega respuestas a las solicitudes al repositorio, pero con cada solicitud posterior env√≠a un encabezado para verificar los cambios. </p><br><pre> <code class="plaintext hljs">if-modified-since: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  En caso de que no se produzcan cambios, el navegador recibe una respuesta con el c√≥digo 304 No modificado y utiliza el contenido almacenado en la memoria cach√©.  Si se realizan cambios en el documento, la respuesta se devuelve con el c√≥digo 200 y se escribe una nueva respuesta en el almacenamiento del navegador. </p><br><p>  Un poco m√°s tarde, cambiamos el m√©todo de almacenamiento en cach√© y verificamos la cantidad hash en el nombre del archivo.  Asegura que el recurso seguir√° siendo √∫nico.  Por lo tanto, podr√≠amos almacenar agresivamente el contenido en cach√©.  El siguiente encabezado se agreg√≥ en respuesta: </p><br><pre> <code class="plaintext hljs">Cache-control:max-age=31536000, immutable</code> </pre> <br><p>  La edad m√°xima indica el tiempo m√°ximo de almacenamiento en cach√©, en nuestro caso es de 1 a√±o.  Un valor inmutable significa que dicha respuesta no necesita ser verificada por cambios. </p><br><p>  <strong>Enlaces utiles</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/">Manual de almacenamiento en cach√© de HTTP</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gu√≠a de uso de API de Service Worker</a> </li></ul><br><p>  Estas no son todas las formas de optimizar el sitio.  Esto podr√≠a agregar un rechazo de bootstrap, reducir la cantidad de elementos DOM y eventos, y mucho m√°s.  Pero estos son los consejos que nos ayudaron a hacer que el sitio sea r√°pido y receptivo, a pesar de la gran cantidad de animaci√≥n. </p><br><h3 id="priglashaem-v-nashu-komandu">  Te invitamos a nuestro equipo </h3><br><p>  Siempre estamos buscando especialistas geniales en nuestra oficina en San Petersburgo para nuestras ambiciosas tareas: desarrolladores, evaluadores, dise√±adores.  A continuaci√≥n hay vacantes: √∫nete a nosotros. </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Desarrollador frontend</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ingeniero de control de calidad</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ingeniero de desarrollo de software en prueba</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/455700/">https://habr.com/ru/post/455700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455686/index.html">¬øC√≥mo elegir la mejor herramienta de gesti√≥n de proyectos si eres un milenio?</a></li>
<li><a href="../455692/index.html">ASZP: el restyling o el teatro comienzan con una percha</a></li>
<li><a href="../455694/index.html">Arquitectura de facturaci√≥n de la pr√≥xima generaci√≥n: transici√≥n a Tarantool</a></li>
<li><a href="../455696/index.html">El estado electr√≥nico del futuro. Parte 2</a></li>
<li><a href="../455698/index.html">El libro "C√≥mo funciona JavaScript"</a></li>
<li><a href="../455702/index.html">Generaci√≥n efectiva de n√∫meros en un intervalo dado</a></li>
<li><a href="../455710/index.html">¬øPor qu√© en Leroy Merlin necesitamos nuestro propio departamento de desarrollo ruso para 200 personas?</a></li>
<li><a href="../455714/index.html">Exporte autom√°ticamente Google Forms a Notion usando IFTTT y Django</a></li>
<li><a href="../455716/index.html">15 mejores pr√°cticas para implementar software de inteligencia empresarial</a></li>
<li><a href="../455720/index.html">C√≥mo construimos la interfaz de usuario para sistemas publicitarios</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>