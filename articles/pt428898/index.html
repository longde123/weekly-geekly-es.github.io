<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê∫ üï¢ üö† Aspectos problem√°ticos da programa√ß√£o em C ++ üë®üèº‚Äç‚úàÔ∏è ‚úçüèº üë∑üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No C ++, existem alguns recursos que podem ser considerados potencialmente perigosos - com erros de c√°lculo no design ou codifica√ß√£o imprecisa, eles p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aspectos problem√°ticos da programa√ß√£o em C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428898/"><hr><p>  <i>No C ++, existem alguns recursos que podem ser considerados potencialmente perigosos - com erros de c√°lculo no design ou codifica√ß√£o imprecisa, eles podem facilmente levar a erros.</i>  <i>O artigo fornece uma sele√ß√£o desses recursos, fornece dicas sobre como reduzir seu impacto negativo.</i> <i><br></i> </p><hr><br><a name="habracut"></a><br><h1>  Sum√°rio </h1><br><div class="spoiler">  <b class="spoiler_title">Sum√°rio</b> <div class="spoiler_text"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Introdu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Tipos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instru√ß√µes condicionais e operadores</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Convers√µes impl√≠citas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2. Resolu√ß√£o de nomes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ocultando vari√°veis ‚Äã‚Äãem escopos aninhados</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sobrecarga de fun√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3. Construtores, destruidores, inicializa√ß√£o, exclus√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fun√ß√µes de membro de classe geradas pelo compilador</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vari√°veis ‚Äã‚Äãn√£o inicializadas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Procedimento de inicializa√ß√£o para classes base e membros n√£o est√°ticos da classe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.4</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Procedimento de inicializa√ß√£o para membros de classe est√°tica e vari√°veis ‚Äã‚Äãglobais</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.5</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Exce√ß√µes em destruidores</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.6</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Removendo objetos e matrizes din√¢micos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.7</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Excluindo quando a declara√ß√£o de classe est√° incompleta</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4. Operadores, express√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prioridade do Operador</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sobrecarga do operador</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O procedimento para calcular subexpress√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5. Fun√ß√µes virtuais</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.1 Substituindo fun√ß√µes virtuais</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.2 Sobrecarregando e usando par√¢metros padr√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.3 Chamando fun√ß√µes virtuais no construtor e destruidor</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.4 Destruidor virtual</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6. Trabalho direto com mem√≥ria</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.1 Transbordando o buffer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.2 Strings terminadas em Z</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.3 Fun√ß√µes com um n√∫mero vari√°vel de par√¢metros</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7. Sintaxe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7.1 An√∫ncios complicados</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7.2 Ambiguidade da sintaxe</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8. Diversos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.1 Palavra-chave embutida e ODR</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.2 Arquivos de cabe√ßalho</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Declara√ß√£o 8.3 switch</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.4 Passando par√¢metros por valor</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.5 Gerenciamento de recursos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.6 Links de propriedade e de n√£o posse</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.7 Compatibilidade bin√°ria</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8.8 Macros</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">9. Resumo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Refer√™ncias</a> <br></p><br></div></div><br><p>  <i>Praemonitus, praemunitus.</i> <i><br></i>  <i>Prevenido significa armado.</i>  <i>(lat.)</i> <br></p><br><a name="id-introdaction"></a><br><h1>  1. Introdu√ß√£o </h1><br><p>  No C ++, existem muitos recursos que podem ser considerados potencialmente perigosos - ao calcular mal no design ou na codifica√ß√£o imprecisa, eles podem facilmente levar a erros.  Alguns deles podem ser atribu√≠dos √† inf√¢ncia dif√≠cil, outros ao padr√£o C ++ 98 desatualizado, mas outros j√° est√£o associados aos recursos do C ++ moderno.  Considere os principais e tente dar conselhos sobre como reduzir seu impacto negativo. </p><br><a name="id-1"></a><br><h1>  1. Tipos </h1><br><a name="id-1-1"></a><br><h2>  1.1  Instru√ß√µes condicionais e operadores </h2><br><p> A necessidade de compatibilidade com C leva ao fato de que, na declara√ß√£o <code>if(...)</code> e similares, voc√™ pode substituir qualquer express√£o num√©rica ou ponteiro, e n√£o apenas express√µes como <code>bool</code> .  O problema √© agravado pela convers√£o impl√≠cita de <code>bool</code> para <code>int</code> em express√µes aritm√©ticas e a prioridade de alguns operadores.  Isso leva, por exemplo, aos seguintes erros: </p><br><p>  <code>if(a=b)</code> quando corretamente <code>if(a==b)</code> , <br>  <code>if(a&lt;x&lt;b)</code> , quando corretamente <code>if(a&lt;x &amp;&amp; x&lt;b)</code> , <br>  <code>if(a&amp;x==0)</code> , quando corretamente <code>if((a&amp;x)==0)</code> , <br>  <code>if(Foo)</code> quando corretamente <code>if(Foo())</code> , <br>  <code>if(arr)</code> quando corretamente <code>if(arr[0])</code> , <br>  <code>if(strcmp(s,r))</code> quando correto <code>if(strcmp(s,r)==0)</code> . </p><br><p>  Alguns desses erros causam um aviso do compilador, mas n√£o um erro.  √Äs vezes, os analisadores de c√≥digo tamb√©m podem ajudar.  Em C #, esses erros s√£o quase imposs√≠veis, a <code>if(...)</code> e similares exigem um tipo <code>bool</code> , voc√™ n√£o pode misturar tipos <code>bool</code> e num√©ricos em express√µes aritm√©ticas. </p><br><p>  Como lutar: </p><br><ul><li>  Programa sem avisos.  Infelizmente, isso nem sempre ajuda; alguns dos erros descritos acima n√£o d√£o avisos. </li><li>  Use analisadores de c√≥digo est√°tico. </li><li>  T√©cnica de recep√ß√£o antiquada: ao comparar com uma constante, coloque-a √† esquerda, por exemplo, <code>if(MAX_PATH==x)</code> .  Parece um condom√≠nio bonito (e at√© tem seu pr√≥prio nome - "nota√ß√£o Yoda") e ajuda em um pequeno n√∫mero de casos considerados. </li><li>  Use o qualificador <code>const</code> mais amplamente poss√≠vel.  Mais uma vez, nem sempre ajuda. </li><li>  Acostume-se a escrever as express√µes l√≥gicas corretas: <code>if(x!=0)</code> vez de <code>if(x)</code> .  (Embora voc√™ possa cair na armadilha das prioridades do operador aqui, veja o terceiro exemplo.) </li><li>  Seja extremamente atencioso. </li></ul><br><a name="id-1-2"></a><br><h2>  1.2  Convers√µes impl√≠citas </h2><br><p>  C ++ refere-se a linguagens fortemente tipadas, mas as convers√µes impl√≠citas de tipos s√£o amplamente usadas para tornar o c√≥digo mais curto.  Essas convers√µes impl√≠citas podem, em alguns casos, levar a erros. </p><br><p>  As convers√µes impl√≠citas mais irritantes s√£o convers√µes de um tipo num√©rico ou ponteiro para <code>bool</code> e de <code>bool</code> para <code>int</code> .  S√£o essas transforma√ß√µes (necess√°rias para compatibilidade com C) que causam os problemas descritos na se√ß√£o 1.1.  Convers√µes impl√≠citas que potencialmente causam uma perda na precis√£o dos dados num√©ricos (restringindo convers√µes), por exemplo, de <code>double</code> para <code>int</code> tamb√©m nem sempre s√£o adequadas.  Em muitos casos, o compilador gera um aviso (especialmente quando pode haver uma perda de precis√£o dos dados num√©ricos), mas um aviso n√£o √© um erro.  Em C #, convers√µes entre tipos num√©ricos e <code>bool</code> proibidas (mesmo expl√≠citas), e as convers√µes que potencialmente causam perda de precis√£o nos dados num√©ricos s√£o quase sempre um erro. </p><br><p>  O programador pode adicionar outras convers√µes impl√≠citas: (1) definir um construtor com um par√¢metro sem a palavra-chave <code>explicit</code> ;  (2) a defini√ß√£o de um operador de convers√£o de tipo.  Essas transforma√ß√µes quebram lacunas de seguran√ßa adicionais baseadas em fortes princ√≠pios de digita√ß√£o. </p><br><p>  Em C #, o n√∫mero de convers√µes impl√≠citas internas √© muito menor; as convers√µes impl√≠citas personalizadas devem ser declaradas usando a palavra-chave <code>implicit</code> . </p><br><p>  Como lutar: </p><br><ul><li>  Programa sem avisos. </li><li>  Tenha muito cuidado com os desenhos descritos acima, n√£o os use sem extrema necessidade. </li></ul><br><a name="id-2"></a><br><h1>  2. Resolu√ß√£o de nomes </h1><br><a name="id-2-1"></a><br><h2>  2.1  Ocultando vari√°veis ‚Äã‚Äãem escopos aninhados </h2><br><p>  No C ++, a regra a seguir se aplica.  Vamos </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   {    int x;    // ... //  ,       {        int x;        // ...    } }</span></span></code> </pre> <br><p>  De acordo com as regras do C ++, a vari√°vel <code></code> declarada em <code></code> oculta a vari√°vel <code></code> declarada em <code></code>  A primeira declara√ß√£o <code>x</code> n√£o precisa estar em um bloco: ela pode ser membro de uma classe ou vari√°vel global, apenas precisa estar vis√≠vel no bloco <code></code> </p><br><p>  Imagine agora a situa√ß√£o em que voc√™ precisa refatorar o c√≥digo a seguir </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   {    int x;    // ... //  ,       {    // -         } }</span></span></code> </pre> <br><p>  Por engano, s√£o feitas altera√ß√µes: </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   {    //  , :    int x;    // -         // ...    //  :    // -      }</span></span></code> </pre> <br><p>  E agora o c√≥digo ‚Äúalgo est√° sendo feito com <code></code> de <code></code> ‚Äù far√° algo com <code></code> de <code></code> !  √â claro que tudo n√£o funciona como antes, e encontrar o que geralmente √© muito dif√≠cil.  N√£o √© em v√£o que em C # √© proibido ocultar vari√°veis ‚Äã‚Äãlocais (embora os membros da classe possam).  Observe que o mecanismo de ocultar vari√°veis ‚Äã‚Äãde uma forma ou de outra √© usado em quase todas as linguagens de programa√ß√£o. </p><br><p>  Como lutar: </p><br><ul><li>  Declarar vari√°veis ‚Äã‚Äãno escopo mais estreito poss√≠vel. </li><li>  N√£o escreva blocos longos e profundamente aninhados. </li><li>  Use conven√ß√µes de codifica√ß√£o para distinguir visualmente identificadores de escopo diferente. </li><li>  Seja extremamente atencioso. </li></ul><br><a name="id-2-2"></a><br><h2>  2.2  Sobrecarga de fun√ß√£o </h2><br><p>  A sobrecarga de fun√ß√µes √© um recurso integrante de muitas linguagens de programa√ß√£o e o C ++ n√£o √© uma exce√ß√£o.  Mas essa oportunidade deve ser usada com cuidado, caso contr√°rio, voc√™ poder√° ter problemas.  Em alguns casos, por exemplo, quando o construtor est√° sobrecarregado, o programador n√£o tem escolha, mas em outros casos, a recusa em sobrecarregar pode ser justificada.  Considere os problemas que surgem ao usar fun√ß√µes sobrecarregadas. </p><br><p>  Se voc√™ tentar considerar todas as op√ß√µes poss√≠veis que possam surgir ao resolver uma sobrecarga, as regras para resolver uma sobrecarga ser√£o muito complicadas e, portanto, dif√≠ceis de prever.  A complexidade adicionada √© introduzida pelas fun√ß√µes do modelo e pela sobrecarga de operadores internos.  O C ++ 11 adicionou problemas com links rvalue e listas de inicializa√ß√£o. </p><br><p>  Os problemas podem ser criados pelo algoritmo de pesquisa para candidatos resolverem sobrecargas em √°reas de visibilidade aninhadas.  Se o compilador encontrou algum candidato no escopo atual, outras pesquisas ser√£o encerradas.  Se os candidatos encontrados n√£o forem adequados, conflitantes, exclu√≠dos ou inacess√≠veis, um erro ser√° gerado, mas nenhuma pesquisa adicional ser√° tentada.  E somente se n√£o houver candidatos no escopo atual, a pesquisa passar√° para o pr√≥ximo escopo mais amplo.  O mecanismo de oculta√ß√£o de nomes funciona, que √© quase o mesmo que discutido na se√ß√£o 2.1, consulte [Dewhurst]. </p><br><p>  As fun√ß√µes de sobrecarga podem reduzir a legibilidade do c√≥digo, o que significa provocar erros. </p><br><p>  Usar fun√ß√µes com par√¢metros padr√£o parece usar fun√ß√µes sobrecarregadas, embora, √© claro, haja menos problemas em potencial.  Mas o problema com baixa legibilidade e poss√≠veis erros permanece. </p><br><p>  Com extrema cautela, sobrecarga e par√¢metros padr√£o para fun√ß√µes virtuais devem ser usados, consulte a se√ß√£o 5.2. </p><br><p>  O C # tamb√©m suporta sobrecarga de fun√ß√£o, mas as regras para resolver sobrecargas s√£o um pouco diferentes. </p><br><p>  Como lutar: </p><br><ul><li>  N√£o abuse da sobrecarga de fun√ß√µes, nem projete fun√ß√µes com par√¢metros padr√£o. </li><li>  Se as fun√ß√µes estiverem sobrecarregadas, use assinaturas que n√£o est√£o em d√∫vida ao resolver sobrecargas. </li><li>  N√£o declare fun√ß√µes com o mesmo nome no escopo aninhado. </li><li>  N√£o esque√ßa que o mecanismo de fun√ß√µes remotas ( <code>=delete</code> ) que apareceu no C ++ 11 pode ser usado para banir certas op√ß√µes de sobrecarga. </li></ul><br><a name="id-3"></a><br><h1>  3. Construtores, destruidores, inicializa√ß√£o, exclus√£o </h1><br><a name="id-3-1"></a><br><h2>  3.1  Fun√ß√µes de membro de classe geradas pelo compilador </h2><br><p>  Se o programador n√£o definiu as fun√ß√µes de membro da classe da lista a seguir - construtor padr√£o, construtor de c√≥pias, operador de atribui√ß√£o de c√≥pias, destruidor -, o compilador pode fazer isso por ele.  O C ++ 11 adicionou um construtor de movimenta√ß√£o e um operador de atribui√ß√£o de movimenta√ß√£o a esta lista.  Essas fun√ß√µes de membro s√£o chamadas de fun√ß√µes de membro especiais.  Eles s√£o gerados apenas se forem usados ‚Äã‚Äãe condi√ß√µes adicionais espec√≠ficas para cada fun√ß√£o s√£o atendidas.  Chamamos a aten√ß√£o para o fato de que esse uso pode ser bastante oculto (por exemplo, ao implementar a heran√ßa).  Se a fun√ß√£o necess√°ria n√£o puder ser gerada, um erro ser√° gerado.  (Com exce√ß√£o das opera√ß√µes de realoca√ß√£o, elas s√£o substitu√≠das por opera√ß√µes de c√≥pia.) As fun√ß√µes de membro geradas pelo compilador s√£o p√∫blicas e incorpor√°veis.  Detalhes sobre fun√ß√µes-membro especiais podem ser encontrados em [Meyers2]. </p><br><p>  Em alguns casos, essa ajuda do compilador pode ser um "servi√ßo de suporte".  A aus√™ncia de fun√ß√µes-membro especiais personalizadas pode levar √† cria√ß√£o de um tipo trivial, e isso, por sua vez, causa o problema de vari√°veis ‚Äã‚Äãn√£o inicializadas, consulte a se√ß√£o 3.2.  As fun√ß√µes-membro geradas s√£o p√∫blicas e isso nem sempre √© consistente com o design das classes.  Nas classes base, o construtor deve ser protegido; √†s vezes, para um controle mais preciso do ciclo de vida do objeto, √© necess√°rio um destruidor protegido.  Se uma classe tiver um descritor de recursos brutos como membro e possuir esse recurso, o programador precisar√° implementar um construtor de c√≥pias, um operador de atribui√ß√£o de c√≥pias e um destruidor.  A chamada "regra das Tr√™s Grandes" √© bem conhecida, que afirma que se um programador define pelo menos uma das tr√™s opera√ß√µes - construtor de c√≥pias, operador de atribui√ß√£o de c√≥pias ou destruidor - ele deve definir as tr√™s opera√ß√µes.  O construtor de movimenta√ß√£o e o operador de atribui√ß√£o de movimenta√ß√£o gerados pelo compilador tamb√©m est√£o longe de ser sempre o que voc√™ precisa.  O destruidor gerado pelo compilador, em alguns casos, leva a problemas muito sutis, cujo resultado pode ser um vazamento de recurso, consulte a se√ß√£o 3.7. </p><br><p>  O programador pode proibir a gera√ß√£o de fun√ß√µes-membro especiais; em C ++ 11, √© necess√°rio usar a constru√ß√£o <code>"=delete"</code> ao declarar; em C ++ 98, declarar a fun√ß√£o de membro correspondente privada e n√£o definir. </p><br><p>  Se o programador estiver confort√°vel com as fun√ß√µes de membro geradas pelo compilador, no C ++ 11 ele poder√° indicar isso explicitamente, e n√£o apenas descartar a declara√ß√£o.  Para fazer isso, voc√™ deve usar a constru√ß√£o <code>"=default"</code> ao declarar, enquanto o c√≥digo √© melhor lido e recursos adicionais aparecem relacionados ao gerenciamento do n√≠vel de acesso. </p><br><p>  Em C #, o compilador pode gerar um construtor padr√£o, geralmente isso n√£o causa problemas. </p><br><p>  Como lutar: </p><br><ul><li>  Controlar o compilador gerando fun√ß√µes membro especiais.  Se necess√°rio, implemente-os ou pro√≠ba. </li></ul><br><a name="id-3-2"></a><br><h2>  3.2  Vari√°veis ‚Äã‚Äãn√£o inicializadas </h2><br><p>  Construtores e destruidores podem ser chamados de elementos-chave do modelo de objeto C ++.  Ao criar um objeto, o construtor deve ser chamado e, ao excluir, o destruidor √© chamado.  Mas os problemas de compatibilidade com C for√ßaram algumas exce√ß√µes, e essa exce√ß√£o √© chamada de tipos triviais.  Eles s√£o introduzidos para simular tipos sichny e ciclo de vida syshny de vari√°veis, sem a chamada obrigat√≥ria do construtor e destruidor.  O c√≥digo C, se compilado e executado em C ++, deve funcionar como em C. Os tipos triviais incluem tipos num√©ricos, ponteiros, enumera√ß√µes, bem como classes, estruturas, uni√µes e matrizes que consistem em tipos triviais.  Classes e estruturas devem satisfazer algumas condi√ß√µes adicionais: a aus√™ncia de um construtor personalizado, destruidor, c√≥pia, fun√ß√µes virtuais.  Para uma classe trivial, o compilador pode gerar um construtor padr√£o e um destruidor.  O construtor padr√£o zera o objeto, o destruidor n√£o faz nada.  Mas esse construtor ser√° gerado e usado apenas se for explicitamente chamado quando a vari√°vel for inicializada.  Uma vari√°vel de um tipo trivial n√£o ser√° inicializada se voc√™ n√£o usar alguma variante de inicializa√ß√£o expl√≠cita.  A sintaxe de inicializa√ß√£o depende do tipo e contexto da declara√ß√£o da vari√°vel.  Vari√°veis ‚Äã‚Äãest√°ticas e locais s√£o inicializadas quando declaradas.  Para uma classe, as classes base imediatas e os membros n√£o est√°ticos da classe s√£o inicializados na lista de inicializa√ß√£o do construtor.  (O C ++ 11 permite que voc√™ inicialize membros de classe n√£o est√°ticos ao declarar, consulte posteriormente.) Para objetos din√¢micos, a express√£o <code>new T()</code> cria um objeto inicializado pelo construtor padr√£o, mas o <code>new T</code> para tipos triviais cria um objeto n√£o inicializado.  Ao criar uma matriz din√¢mica de um tipo trivial, o <code>new T[N]</code> , seus elementos sempre ser√£o n√£o inicializados.  Se uma inst√¢ncia do <code>std::vector&lt;T&gt;</code> for criada ou estendida e os par√¢metros n√£o forem fornecidos para a inicializa√ß√£o expl√≠cita dos elementos, eles garantem a chamada do construtor padr√£o.  O C ++ 11 apresenta uma nova sintaxe de inicializa√ß√£o - usando chaves.  Um par de colchetes vazio significa inicializa√ß√£o usando o construtor padr√£o.  Essa inicializa√ß√£o √© poss√≠vel em qualquer lugar em que a inicializa√ß√£o tradicional √© usada, al√©m de ter sido poss√≠vel inicializar membros n√£o est√°ticos da classe ao declarar, o que substitui a inicializa√ß√£o na lista de inicializa√ß√£o do construtor. </p><br><p>  Uma vari√°vel n√£o inicializada √© estruturada da seguinte maneira: se for definida no escopo do <code>namespace</code> (globalmente), ter√° todos os bits zero, se for local ou dinamicamente criada, receber√° um conjunto aleat√≥rio de bits.  √â claro que o uso de tal vari√°vel pode levar a um comportamento imprevis√≠vel do programa. </p><br><p>  √â verdade que o progresso n√£o p√°ra, os compiladores modernos, em alguns casos, detectam vari√°veis ‚Äã‚Äãn√£o inicializadas e geram um erro.  Analisadores de c√≥digo n√£o inicializados detectam ainda melhor. </p><br><p>  A biblioteca padr√£o do C ++ 11 possui modelos chamados de propriedades de tipo (arquivo de cabe√ßalho <code>&lt;type_traits&gt;</code> ).  Um deles permite que voc√™ determine se o tipo √© trivial.  A express√£o <code>std::is_trivial&lt;&gt;::value</code> √© <code>true</code> se <code>T</code> tipo trivial e <code>false</code> caso contr√°rio. </p><br><p>  Estruturas sis√≠licas tamb√©m s√£o chamadas de Dados antigos simples (POD).  Podemos assumir que POD e o "tipo trivial" s√£o termos quase equivalentes. </p><br><p>  Em C #, vari√°veis ‚Äã‚Äãn√£o inicializadas causam um erro, que √© controlado pelo compilador.  Os campos de objetos de um tipo de refer√™ncia s√£o inicializados por padr√£o se a inicializa√ß√£o expl√≠cita n√£o for executada.  Os campos de objetos de um tipo significativo s√£o inicializados todos por padr√£o ou todos devem ser inicializados explicitamente. </p><br><p>  Como lutar: </p><br><ul><li>  Tenha o h√°bito de inicializar explicitamente uma vari√°vel.  Uma vari√°vel n√£o inicializada deve "cortar os olhos". </li><li>  Declarar vari√°veis ‚Äã‚Äãno escopo mais estreito poss√≠vel. </li><li>  Use analisadores de c√≥digo est√°tico. </li><li>  N√£o projete tipos triviais.  Para garantir que o tipo n√£o seja trivial, basta definir um construtor personalizado. </li></ul><br><a name="id-3-3"></a><br><h2>  3.3  Procedimento de inicializa√ß√£o para classes base e membros n√£o est√°ticos da classe </h2><br><p>  Ao implementar o construtor da classe, as classes base imediatas e os membros n√£o est√°ticos da classe s√£o inicializados.  A ordem de inicializa√ß√£o √© determinada pelo padr√£o: primeiro, as classes base na ordem em que s√£o declaradas na lista de classes base, depois membros n√£o est√°ticos da classe na ordem de declara√ß√£o.  Se necess√°rio, a inicializa√ß√£o expl√≠cita de classes base e membros n√£o est√°ticos usa a lista de inicializa√ß√£o do construtor.  Infelizmente, os itens desta lista n√£o precisam estar na ordem em que a inicializa√ß√£o ocorre.  Isso deve ser levado em considera√ß√£o se, durante a inicializa√ß√£o, os itens da lista usarem refer√™ncias a outros itens da lista.  Por erro, o link pode estar em um objeto que ainda n√£o foi inicializado.  O C ++ 11 permite que voc√™ inicialize membros de classe n√£o est√°ticos ao declarar (usando chaves).  Nesse caso, eles n√£o precisam ser inicializados na lista de inicializa√ß√£o do construtor e o problema √© parcialmente removido. </p><br><p>  Em C #, um objeto √© inicializado da seguinte maneira: primeiro os campos s√£o inicializados, do subobjeto base at√© a √∫ltima derivada, depois os construtores s√£o chamados na mesma ordem.  O problema descrito n√£o ocorre. </p><br><p>  Como lutar: </p><br><ul><li>  Mantenha a lista de inicializa√ß√£o do construtor em ordem de declara√ß√£o. </li><li>  Tente tornar a inicializa√ß√£o das classes base e dos membros independentes. </li><li>  Use a inicializa√ß√£o de membros n√£o est√°ticos ao declarar. </li></ul><br><a name="id-3-4"></a><br><h2>  3.4  Procedimento de inicializa√ß√£o para membros de classe est√°tica e vari√°veis ‚Äã‚Äãglobais </h2><br><p>  Membros de classe est√°tica, bem como vari√°veis ‚Äã‚Äãdefinidas no <code>namespace</code> do escopo (globalmente) em diferentes unidades de compila√ß√£o (arquivos), s√£o inicializados na ordem determinada pela implementa√ß√£o.  Isso deve ser levado em considera√ß√£o se, durante a inicializa√ß√£o, essas vari√°veis ‚Äã‚Äãusarem refer√™ncias entre si.  O link pode estar em uma vari√°vel n√£o inicializada. </p><br><p>  Como lutar: </p><br><ul><li>  Tome medidas especiais para evitar essa situa√ß√£o.  Por exemplo, use vari√°veis ‚Äã‚Äãest√°ticas locais (singleton), elas s√£o inicializadas no primeiro uso. </li></ul><br><a name="id-3-5"></a><br><h2>  3.5  Exce√ß√µes em destruidores </h2><br><p>  O destruidor n√£o deve lan√ßar exce√ß√µes.  Se voc√™ violar essa regra, poder√° obter um comportamento indefinido, com mais frequ√™ncia travando. </p><br><p>  Como lutar: </p><br><ul><li>  Evite lan√ßar exce√ß√µes no destruidor. </li></ul><br><a name="id-3-6"></a><br><h2>  3.6  Removendo objetos e matrizes din√¢micos </h2><br><p>  Se um objeto din√¢mico de algum tipo <code>T</code> </p><br><pre> <code class="cpp hljs">T* pt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> T(<span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>);</code> </pre> <br><p>  ent√£o ele √© exclu√≠do com o operador de <code>delete</code> </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> pt;</code> </pre> <br><p>  Se uma matriz din√¢mica for criada </p><br><pre> <code class="cpp hljs">T* pt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> T[N];</code> </pre> <br><p>  ent√£o ele √© exclu√≠do com o operador <code>delete[]</code> </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>[] pt;</code> </pre> <br><p>  Se voc√™ n√£o seguir esta regra, poder√° obter um comportamento indefinido, ou seja, tudo pode acontecer: vazamento de mem√≥ria, falha etc.  Veja [Meyers1] para detalhes. </p><br><p>  Como lutar: </p><br><ul><li>  Use o formul√°rio de <code>delete</code> correto. </li></ul><br><a name="id-3-7"></a><br><h2>  3.7  Excluindo quando a declara√ß√£o de classe est√° incompleta </h2><br><p>  A on√≠vora do operador de <code>delete</code> pode criar certos problemas; pode ser aplicada a um ponteiro do tipo <code>void*</code> ou a um ponteiro para uma classe que possui uma declara√ß√£o incompleta (preemptiva).  O operador de <code>delete</code> aplicado a um ponteiro para uma classe √© uma opera√ß√£o de duas fases: primeiro, o destruidor √© chamado e a mem√≥ria √© liberada.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se o operador for aplicado </font></font><code>delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a um ponteiro para uma classe com uma declara√ß√£o incompleta, nenhum erro ocorrer√°, o compilador simplesmente ignorar√° a chamada para o destruidor (embora um aviso seja emitido).</font></font> Considere um exemplo: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">//   X* CreateX(); void Foo() {    X* p = CreateX();    delete p; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esse c√≥digo compila mesmo se a </font></font><code>delete</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declara√ß√£o de classe completa n√£o estiver dispon√≠vel </font><font style="vertical-align: inherit;">no dial-peer </font></font><code>X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Visual Studio exibe o seguinte aviso:</font></font><br><p> <code>warning C4150: deletion of pointer to incomplete type 'X'; no destructor called</code> <br> </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se houver uma implementa√ß√£o </font></font><code>X</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>CreateX()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o c√≥digo for compilado, se </font></font><code>CreateX()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retornar um ponteiro para um objeto criado pelo operador </font></font><code>new</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, a chamada ser√° </font></font><code>Foo()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">executada com √™xito, o destruidor n√£o ser√° chamado. </font><font style="vertical-align: inherit;">√â claro que isso pode levar a uma drenagem de recursos, portanto, mais uma vez, sobre a necessidade de ter cuidado com os avisos.</font></font></p><br><p>    ,           -.      ,  .       ,      ,   ,   ,   .        [Meyers2]. </p><br><p>  : </p><br><ul><li>   . </li><li>            . </li><li>     . </li></ul><br><a name="id-4"></a><br><h1> 4. ,  </h1><br><a name="id-4-1"></a><br><h2>  4.1   </h2><br><p>   ++ ,     .      .       .   ,    1.1. </p><br><p>  Aqui est√° um exemplo: </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::out&lt;&lt;c?x:y;</code> </pre> <br><p>        </p><br><pre> <code class="cpp hljs">(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::out&lt;&lt;c)?x:y;</code> </pre> <br><p>   </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::out&lt;&lt;(c?x:y);</code> </pre> <br><p> ,  ,  . </p><br><p>         .            <code>&lt;&lt;</code>      <code>?:</code>      <code>std::out</code>  <code>void*</code> .  ++            ,     . -,          ,    .    <code>?:</code>      .       ,     (  ). </p><br><p>   :  <code>x&amp;f==0</code>    <code>x&amp;(f==0)</code> ,   <code>(x&amp;f)==0</code> , ,  ,  .     -  , ,     ,         ,   . </p><br><p>  . /          .  /    ,  /,    . ,     <code>x/4+1</code>  <code>x&gt;&gt;2+1</code> ,   <code>x&gt;&gt;(2+1)</code> ,   <code>(x&gt;&gt;2)+1</code> ,  . </p><br><p> C#      ,   C++,      ,    -      . </p><br><p>  : </p><br><ul><li>   ,     . , ,    . </li></ul><br><a name="id-4-2"></a><br><h2> 4.2.   </h2><br><p> ++     ,      .        .        ,          , .  4.1.    ‚Äî    <code>+</code>  <code>+=</code>   .     . ,   : <code>,</code> (), <code>&amp;&amp;</code> , <code>||</code>  .   ,         (-),            (short-circuit evaluation semantics),        ,        .      &amp; ( ).     &amp;    , ..       . </p><br><p>        ,  -    (-) ,  .      . </p><br><p>  -  ,    ,    .  . [Dewhurst]. </p><br><p> C#    ,     , ,   . </p><br><p>  : </p><br><ul><li>    . </li><li>       . </li></ul><br><a name="id-4-3"></a><br><h2> 4.3.    </h2><br><p>   ++           ,         . (   : <code>,</code> (), <code>&amp;&amp;</code> , <code>||</code> , <code>?:</code> .)     ,  ,   ,    .    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y=(++x*<span class="hljs-number"><span class="hljs-number">2</span></span>)+(++x*<span class="hljs-number"><span class="hljs-number">3</span></span>);</code> </pre> <br><p>  <code>y</code>     . </p><br><p>      ,        .  . </p><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Y</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;X&gt;, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;Y&gt;)</span></span></span></span>;</code> </pre> <br><p>  <code>Foo()</code>   : </p><br><pre> <code class="cpp hljs">Foo(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;X&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> X()), <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;Y&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Y()));</code> </pre> <br><p>     :  <code>X</code> ,  <code>Y</code> ,  <code>std::shared_ptr&lt;X&gt;</code> ,  <code>std::shared_ptr&lt;Y&gt;</code> .   <code>Y</code>  ,   <code>X</code>   . </p><br><p>     : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> p1 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;X&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> X()); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> p2 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;Y&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Y()); Foo(p1, p2);</code> </pre> <br><p>     <code>std::make_shared&lt;Y&gt;</code> (    ,     ): </p><br><pre> <code class="cpp hljs">Foo(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;X&gt;(), <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;Y&gt;());</code> </pre> <br><p>  . [Meyers2]. </p><br><p>  : </p><br><ul><li>    . </li></ul><br><a name="id-5"></a><br><h1> 5.   </h1><br><a name="id-5-1"></a><br><h2>  5.1    </h2><br><p>  ++98  ,           ( ), ,     (     ,    ).      <code>virtual</code> ,   ,    .   ( ),   ,   ,     . ,     ,  .  ,  ++11    <code>override</code> ,    ,    ,       .          . </p><br><p>  : </p><br><ul><li>    <code>override</code> . </li><li>    .    ,         . </li></ul><br><a name="id-5-2"></a><br><h2>  5.2       </h2><br><p>            .   ,              ,     .               .    . [Dewhurst]. </p><br><p>  : </p><br><ul><li>           . </li></ul><br><a name="id-5-3"></a><br><h2>  5.3        </h2><br><p> ,     ,          . , ,     post_construct  pre_destroy. ,      ‚Äî         .    .   ,        :     ( )   . (, ,      .)     ,           ( ),    ( ).  . [Dewhurst]. ,         ,  . </p><br><p>       ‚Äî  -         . </p><br><p> ,   C#  ,     ,   ,     .  C#    :   ,      ,       .  ,           ( ,    ). </p><br><p>  : </p><br><ul><li>        ,     ,   . </li></ul><br><a name="id-5-4"></a><br><h2>  5.4   </h2><br><p>     ,        ,           <code>delete</code>     .          , -    . </p><br><p>  : </p><br><ul><li>     . </li></ul><br><a name="id-6"></a><br><h1> 6.     </h1><br><p>        ‚Äî      C/C++,        .           .        .     ¬´  ¬ª. </p><br><p>  C#        unsafe mode,    . </p><br><a name="id-6-1"></a><br><h2> 6.1.     </h2><br><p>    /++  ,        : <code>strcpy()</code> , <code>strcat()</code> , <code>sprinf()</code> , etc.    ( <code>std::vector&lt;&gt;</code> , etc.)         ,    . (,         ,         ,     . . <strong>Checked Iterators</strong>  MSDN.)      ,      :   ,      ,     ;     ,      . </p><br><p>  C#,   unsafe mode,      . </p><br><p>  : </p><br><ul><li>    , . </li><li>     . </li><li>   z-terminated   ,    <code>_s</code> (.   ). </li></ul><br><a name="id-6-2"></a><br><h2> 6.2. Z-terminated  </h2><br><p>       ,  .    ,  : </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">strncpy</span></span>(dst,src,n);</code> </pre> <br><p>  <code>strlen(src)&gt;=n</code> ,  <code>dst</code>     (,      ).      ,       , .  .       ‚Äî       .   <code>if(*str)</code> ,  <code>if(strlen(str)&gt;0)</code> ,           .         [Spolsky]. </p><br><p>  C#  <code>string</code>      . </p><br><p>  : </p><br><ul><li>    . </li><li>     z-terminated   ,    <code>_s</code> (.   ). </li></ul><br><a name="id-6-3"></a><br><h2> 6.3.      </h2><br><p>    <code>...</code>    .      <code>printf</code> - ,     C.          , ,  ,     ,      .         ,       . </p><br><p>  C#    <code>printf</code> ,     . </p><br><p>  : </p><br><ul><li>     . ,  <code>printf</code> -    /. </li><li>   . </li></ul><br><a name="id-7"></a><br><h1> 7.  </h1><br><a name="id-7-1"></a><br><h2> 7.1.   </h2><br><p>  ++     , ,   ,        .  Aqui est√° um exemplo: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> N = <span class="hljs-number"><span class="hljs-number">4</span></span>, M = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x,                <span class="hljs-comment"><span class="hljs-comment">// 1    *px,              // 2    ax[N],            // 3    *apx[N],          // 4    F(char),          // 5    *G(char),          // 6    (*pF)(char),      // 7    (*apF[N])(char),  // 8    (*pax)[N],        // 9    (*apax[M])[N],    // 10    (*H(char))(long);  // 11</span></span></code> </pre> <br><p>        : </p><br><ol><li>   <code>int</code> ; </li><li>   <code>int</code> ; </li><li>   <code>N</code>   <code>int</code> ; </li><li>   <code>N</code>     <code>int</code> ; </li><li> ,  <code>char</code>   <code>int</code> ; </li><li> ,  <code>char</code>     <code>int</code> ; </li><li>   ,  <code>char</code>   <code>int</code> ; </li><li>   <code>N</code>     ,  <code>char</code>   <code>int</code> ; </li><li>     <code>N</code>   <code>int</code> ; </li><li>   <code>M</code>       <code>N</code>   <code>int</code> ; </li><li> ,  <code>char</code>     ,  <code>long</code>   <code>int</code> . </li></ol><br><p> ,             . (     .) </p><br><p>     <code>*</code>    <code>&amp;</code>     . (    .) </p><br><p>        <code>typedef</code> ( <code>using</code> -). ,       : </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">typedef</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*P)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; PH(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>);</code> </pre> <br><p>      ,     . </p><br><p>  C#    ,    . </p><br><p>  : </p><br><ul><li>   . </li></ul><br><a name="id-7-2"></a><br><h2> 7.2.   </h2><br><p>           .     </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    X(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> val = <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ... };</span></span></code> </pre> <br><p>     </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">X </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;</code> </pre> <br><p>    <code>x</code>  <code>X</code> ,   5.    </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">X </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>;</code> </pre> <br><p>    <code>x</code> ,    <code>X</code>    ,     <code>x</code>  <code>X</code> ,    .     <code>X</code> ,    ,     : </p><br><pre> <code class="cpp hljs">X x; X x = X(); X x{};    <span class="hljs-comment"><span class="hljs-comment">//   C++11</span></span></code> </pre> <br><p>   ,    ,          ,   .         [Sutter]. </p><br><p>  ,  ,   C++     (      ).         . (    C++  .) </p><br><p>  , ,      ,       ,         . </p><br><p>  C#   ,         ,      . </p><br><p>  : </p><br><ul><li>    . </li></ul><br><a name="id-8"></a><br><h1> 8.  </h1><br><a name="id-8-1"></a><br><h2> 8.1.   <code>inline</code>  ODR </h2><br><p>   ,    <code>inline</code> ‚Äî             .  ,     .   <code>inline</code>          (One Defenition Rule, ODR).  .            ,   .          ,  ODR.       <code>static</code> :    ,       ,   .   <code>static</code>  <code>inline</code> .      ,        ,  ODR,     . ,       .   - ,          -.         . </p><br><p>  : </p><br><ul><li>  ¬´¬ª <code>inline</code> .          <code>namespace</code> .      ,     . </li><li>        ‚Äî  <code>namespace</code> . </li></ul><br><a name="id-8-2"></a><br><h2> 8.2.   </h2><br><p>        .        .    ,    ,     ,   ,      . </p><br><p>  : </p><br><ul><li>     ,     . </li><li>  ,     :  () ,    -. </li><li>            <code>using</code> -: <code>using namespace <i></i></code> ,   <code>using</code> -. </li><li>           . </li></ul><br><a name="id-8-3"></a><br><h2> 8.3.  <code>switch</code> <br></h2><br><p>   ‚Äî  <code>break</code>    <code>case</code> . (  .)  C#     . </p><br><p>  : </p><br><ul><li>   . </li></ul><br><a name="id-8-4"></a><br><h2> 8.4.     </h2><br><p>  ++    ,      ‚Äî     , ‚Äî       .    (  <code>class</code>  <code>struct</code> )    ,         . (      ,      #  Java.)    ‚Äî   ,     . </p><br><ol><li>      ,   .           (  <code>std::string</code> , <code>std::vector</code> , etc.),    ,           . </li><li>    ,        ,     . </li><li>          ,      (slicing),      ,       . </li></ol><br><p>     ,      ,  ,     .      . ,       ,         . ,          .           .    ‚Äî     ( <code>=delete</code> ),   ‚Äî     <code>explicit</code> . </p><br><p>  C#      ,           . </p><br><p>  : </p><br><ul><li>   ,     . </li><li>       . </li></ul><br><a name="id-8-5"></a><br><h2> 8.5.  Gerenciamento de recursos </h2><br><p>  ++         .     ,     . -       (    ),   ++11   ,        ,   ,           . </p><br><p>      C++   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . </p><br><p>  C#   ,       .        ,     .        (using-)      Basic Dispose. </p><br><p>  : </p><br><ul><li>  -       . </li></ul><br><a name="id-8-6"></a><br><h2>  8.6     </h2><br><p>     ¬´¬ª     .     ,  , C++ , STL-   - . </p><br><p>       .         .     ,        .      .        ¬´¬ª,      .          COM-      . (,    .)      ,    C++   .      ‚Äî      .        .            .  ,      (¬´¬ª     )    ,      .        . </p><br><p>  #    ,     .     ‚Äî    . </p><br><p>  : </p><br><ul><li>   . </li><li>        . </li></ul><br><a name="id-8-7"></a><br><h2> 8.7.   </h2><br><p>  C++      ,     :   ,    ,   . (     !)      .        ,      .     ,   .     ,   ,     . (,           .) </p><br><p>      C (    ),   C++       C  (   <code>extern "C"</code> ).      C/C++ . </p><br><p>          -.   <code>#pragma</code> -    ,    ,   . </p><br><p>        , ,    ,    . </p><br><p>     , ,    COM. COM-,    ,   (     ,      ).  COM     ,   ,     . </p><br><p>  C#     . ,   ‚Äî    ,      C#,    C#  C/C++. </p><br><p>  : </p><br><ul><li>        . </li></ul><br><a name="id-8-8"></a><br><h2> 8.8.  </h2><br><p>        ,         .    ,       .  C++    .  Em vez disso </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> XXL 32</span></span></code> </pre> <br><p>   </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> XXL=<span class="hljs-number"><span class="hljs-number">32</span></span>;</code> </pre> <br><p>   .       <code>inline</code>   . </p><br><p>  #   (   ). </p><br><p>  : </p><br><ul><li>       . </li></ul><br><a name="id-conclusion"></a><br><h1> 9.  </h1><br><ol><li>      .       .   .      ,       . </li><li>    . </li><li>    .   ++      ‚Äî ++11/14/17. </li><li>   - ,  -   . </li><li>        . </li></ol><br><a name="id-refs"></a><br><h1>  Refer√™ncias </h1><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><p> [Dewhurst] <br> ,  .   C++.         .: .  . ‚Äî .:  , 2012. </p><br><p> [Meyers1] <br> , .   C++. 55        .: .  . ‚Äî .:  , 2014. </p><br><p> [Meyers2] <br> , .    C++: 42    C++11  C++14.: .  . ‚Äî .:  ¬´.. ¬ª, 2016. </p><br><p> [Sutter] <br> , .     C++.: .  . ‚Äî :  ¬´.. ¬ª, 2015. </p><br><p> [Spolsky] <br> , .   .: .  . ‚Äî .: -, 2008. </p><br></div></div><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt428898/">https://habr.com/ru/post/pt428898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt428888/index.html">qml: poder e simplicidade</a></li>
<li><a href="../pt428890/index.html">Toda a verdade sobre o RTOS. Artigo # 18 Grupos de Sinalizadores de Eventos: Servi√ßos Auxiliares e Estruturas de Dados</a></li>
<li><a href="../pt428892/index.html">Como criar uma IA de jogo: um guia para iniciantes</a></li>
<li><a href="../pt428894/index.html">IVA nas compras dom√©sticas</a></li>
<li><a href="../pt428896/index.html">Redes neurais de censura hentai</a></li>
<li><a href="../pt428900/index.html">Rob√¥s com rodas come√ßam a entregar mercadorias a residentes dos Estados Unidos e da Gr√£-Bretanha</a></li>
<li><a href="../pt428902/index.html">Tags sem fio NFC</a></li>
<li><a href="../pt428904/index.html">Fintech Digest: Rob√≥tica do Banco Central, Ethereum 2.0, controle de criptomoedas por monitoramento de rosfin e tend√™ncias em Fintech</a></li>
<li><a href="../pt428906/index.html">Criando jogos de quebra-cabe√ßa no Puzzle Script</a></li>
<li><a href="../pt428908/index.html">Frostpunk: desmontagem mec√¢nica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>