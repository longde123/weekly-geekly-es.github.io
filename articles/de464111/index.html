<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüè´ üï∫üèæ üóùÔ∏è Natas Web. Passage der CTF-Plattform zur Ausnutzung von Web-Schwachstellen üõí üéâ ü•ú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werden wir uns am Beispiel des Natas- Kriegsspiels mit der Funktionsweise einiger WEB-Identit√§ten befassen. Jede Ebene hat Zugriff a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Natas Web. Passage der CTF-Plattform zur Ausnutzung von Web-Schwachstellen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464111/"><img src="https://habrastorage.org/webt/_-/zf/_u/_-zf_uvvs6ypsybfrqslsnqwx8k.png" alt="Bild"><br><br>  In diesem Artikel werden wir uns am Beispiel des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Natas-</a> Kriegsspiels mit der Funktionsweise einiger WEB-Identit√§ten befassen.  Jede Ebene hat Zugriff auf das Passwort der n√§chsten Ebene.  Alle Passw√∂rter werden auch in den Dateien / etc / natas_webpass / gespeichert.  Beispielsweise wird das Kennwort f√ºr natas5 in der Datei / etc / natas_webpass / natas5 gespeichert und ist f√ºr die Benutzer natas4 und natas5 schreibgesch√ºtzt. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Organisationsinformationen</b> <div class="spoiler_text">  Speziell f√ºr diejenigen, die etwas Neues lernen und sich in einem der Bereiche Informations- und Computersicherheit entwickeln m√∂chten, werde ich √ºber die folgenden Kategorien schreiben und sprechen: <br><br><ul><li>  PWN; </li><li>  Kryptographie (Krypto); </li><li>  Netzwerktechnologien (Netzwerk); </li><li>  Reverse (Reverse Engineering); </li><li>  Steganographie (Stegano); </li><li>  Suche und Ausnutzung von WEB-Schwachstellen. </li></ul><br>  Dar√ºber hinaus werde ich meine Erfahrungen in den Bereichen Computerforensik, Analyse von Malware und Firmware, Angriffe auf drahtlose Netzwerke und lokale Netzwerke, Durchf√ºhrung von Pentests und Schreiben von Exploits teilen. <br><cut></cut><br>  Damit Sie sich √ºber neue Artikel, Software und andere Informationen informieren k√∂nnen, habe ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in Telegram</a> einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kanal</a> und eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gruppe eingerichtet, um alle Probleme</a> im Bereich ICD <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu diskutieren</a> .  Au√üerdem werde ich Ihre pers√∂nlichen Anfragen, Fragen, Vorschl√§ge und Empfehlungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pers√∂nlich</a> pr√ºfen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">und alle beantworten</a> . <br><cut></cut><br>  Alle Informationen werden nur zu Bildungszwecken bereitgestellt.  Der Autor dieses Dokuments √ºbernimmt keine Verantwortung f√ºr Sch√§den, die jemandem durch die Verwendung von Kenntnissen und Methoden entstehen, die durch das Studium dieses Dokuments erworben wurden. <br></div></div><br><h2>  Stufe 0 </h2><br>  Wir schauen uns den Quellcode der Seite an und √ºberpr√ºfen die Kommentare. <br><br><img src="https://habrastorage.org/webt/qw/gd/g4/qwgdg48m30y6p7sxyitwmlrhgpa.png" alt="Bild"><br><br>  Wir finden das Passwort. <br><blockquote>  Sehr oft kommentieren Entwickler bei der Entwicklung von Websites verschiedene Zusatzinformationen f√ºr sich selbst, einschlie√ülich Autorisierungsdaten. </blockquote><br><h2>  Stufe 1 </h2><br>  Wir sehen uns den Quellcode der Seite noch einmal an, aber einem Javascript-Ereignis wird ein Mausklick mit der rechten Maustaste zugewiesen, wodurch verhindert wird, dass das Kontextmen√º angezeigt wird. <br><br><img src="https://habrastorage.org/webt/sl/hv/ra/slhvra0ks1uxnbozw2ql_mzyaqi.png" alt="Bild"><br><br>  Zum Anzeigen der Seite k√∂nnen Sie die Browser-Hotkeys verwenden. Das Dr√ºcken der rechten Maustaste funktioniert dann nicht. <br><br><img src="https://habrastorage.org/webt/y0/20/c1/y020c1cvpu5g7aolpirovwa82b8.png" alt="Bild"><br><br>  Wir finden das Passwort. <br><blockquote>  Optional (manchmal vorrangig) k√∂nnen Sie einfach die gesamte Seite herunterladen und den Code anzeigen. <br><pre><code class="bash hljs">wget --http-user=natas1 --http-password=gtVrDuiDfck831PqWsLEZy5gyDz1clto http://natas1.natas.labs.overthewire.org</code> </pre> <br><img src="https://habrastorage.org/webt/y4/h6/xr/y4h6xrsii6evokjwefhqfeuymsg.png" alt="Bild"></blockquote><br><h2>  Stufe 2 </h2><br>  Wir sehen uns den Quellcode der Seite noch einmal an und stellen fest, dass das Bild auf die Seite geladen wird. <br><br><img src="https://habrastorage.org/webt/9p/bd/k6/9pbdk69l7dup7fo2djq7sbwqbua.png" alt="Bild"><br><br>  Gehen wir zu dem Verzeichnis, aus dem das Bild heruntergeladen wird.  Wir stellen fest, dass dieses Verzeichnis nicht indiziert und f√ºr Benutzer verf√ºgbar ist. <br><br><img src="https://habrastorage.org/webt/_i/fr/_c/_ifr_c2e0g45gdau24lhvqedv9y.png" alt="Bild"><br><br>  Wir nehmen das Passwort weg. <br><br><img src="https://habrastorage.org/webt/z8/ud/iv/z8udivf8j0tuzf3mvb-vatly8g8.png" alt="Bild"><br><blockquote>  Um zu vermeiden, dass Dateien im Verzeichnis angezeigt werden, sollten die Servereinstellungen (in diesem Fall /etc/apche2/httpd.conf) die Dateiindizierung verbieten.  Oder in diesem Verzeichnis sollte sich die Datei index.html befinden. </blockquote><br><h2>  Stufe 3 </h2><br>  Wir schauen uns noch einmal den Quellcode der Seite an, da gibt es nichts Interessantes.  Das zweite Element nach dem Anzeigen des Quellcodes ist das Scannen von Dateien und Verzeichnissen.  Geben Sie den Benutzer und das Kennwort f√ºr die http-Authentifizierung als Parameter des Dienstprogramms dirb an. <br><br><img src="https://habrastorage.org/webt/zr/fd/pe/zrfdpej8n_vayujdjblvzj3w0wk.png" alt="Bild"><br><br>  Die Datei robots.txt enth√§lt eine Liste von Verzeichnissen und Dateien, die von Suchmaschinenrobotern (z. B. Google und Yandex) nicht angezeigt werden d√ºrfen. <br><br><img src="https://habrastorage.org/webt/-v/uc/gx/-vucgxht4tdjf2vngqia_4yfcri.png" alt="Bild"><br><br>  Gehen wir in das versteckte Verzeichnis auf der Site, suchen die Datei und holen das Passwort ab. <br><br><img src="https://habrastorage.org/webt/1o/gk/jo/1ogkjopzltinoxm0wo7_xxwpjug.png" alt="Bild"><br><br><img src="https://habrastorage.org/webt/dp/sz/te/dpsztev2ki6yha9ffgckgo7msc4.png" alt="Bild"><br><blockquote>  Als Analog k√∂nnen Sie das Dienstprogramm dirsearch oder burpsuite verwenden. </blockquote><br><h2>  Stufe 4 </h2><br>  Der Server informiert, von welcher Seite sie gegangen sind, und sagt, zu welcher Seite sie gehen sollen.  Er kann diese Daten nur im HTTP-Protokoll-Header √ºberpr√ºfen. <br><br><img src="https://habrastorage.org/webt/2r/91/jy/2r91jyvgf0p-ovbk4lrmx2k3qji.png" alt="Bild"><br><br>  W√§hlen Sie im Browser die Symbolleiste ‚Üí Netzwerk ‚Üí Letzte Anfrage und ‚Äû√Ñndern und Senden‚Äú.  Sie sollten das Feld Referer √§ndern - es zeigt genau, woher wir kommen. <br><br><img src="https://habrastorage.org/webt/9v/jo/xw/9vjoxwswmdqktjevocn56o8f1ke.png" alt="Bild"><br><br>  Es bleibt das Passwort abzuholen. <br><br><img src="https://habrastorage.org/webt/w9/6q/gp/w96qgpd0t7pl7pvqdfeqa6f7aj0.png" alt="Bild"><br><blockquote>  Diese Aktion ist Burpsuite. <br><br>  Es muss st√§ndig √ºberpr√ºft werden, welche HTTP-Felder der Webserver anzeigt.  Dies sind die am seltensten gefilterten Benutzerdaten. </blockquote><br><h2>  Stufe 5 </h2><br>  Der Service meldet, dass wir nicht angemeldet sind.  Das hei√üt, es speichert die Daten unserer Autorisierung.  Der einzige Ort, an dem dies √ºbertragen werden kann, ist die Cookiesitzung. <br><br><img src="https://habrastorage.org/webt/ka/_b/pd/ka_bpdpju0covmmnjhztggpemhu.png" alt="Bild"><br><br>  Sehen wir uns die Cookies an (der Einfachheit halber ist es besser, Erweiterungen im Browser zu installieren) und √§ndern Sie den Wert des angemeldeten Parameters in 1. <br><br><img src="https://habrastorage.org/webt/-j/rw/qk/-jrwqkhib__4il8r8kg-pj3f5uo.png" alt="Bild"><br><br>  Laden Sie die Seite neu und sammeln Sie das Passwort. <br><br><img src="https://habrastorage.org/webt/zk/sw/e9/zkswe9c6f4a5punaovpkbiydewc.png" alt="Bild"><br><blockquote>  Diese Sicherheitsanf√§lligkeit wird als fehlerhafte Authentifizierung und Sitzungsverwaltung klassifiziert. </blockquote><br><h2>  Stufe 6 </h2><br>  Dieser Service stellt uns den Quellcode zur Analyse zur Verf√ºgung. <br><br><img src="https://habrastorage.org/webt/9j/no/bc/9jnobcxkukb1jzq7aoubjjmgu7y.png" alt="Bild"><br><br>  Das Geheimnis, das wir eingeben m√ºssen, ist enthalten (verbunden mit der Datei). <br><br><img src="https://habrastorage.org/webt/ft/94/p0/ft94p0fk8rm2tme76g2ve5pij0u.png" alt="Bild"><br><br>  Gehen Sie zur Adresse dieser Datei auf dem Server und holen Sie <br>  ein Geheimnis.  Da diese Dateien PHP-Code enthalten, sind sie <br>  wird nur angezeigt, wenn Sie sie herunterladen. <br><br><img src="https://habrastorage.org/webt/pc/57/gl/pc57gljj5j7q8nejsng_smtb8ni.png" alt="Bild"><br><br>  Senden Sie ein Geheimnis, erhalten Sie ein Passwort. <br><br><h2>  Stufe 7 </h2><br>  Wenn Sie auf beide Links klicken, stellen wir fest, wie sie geladen werden.  Der Dateiname auf dem Server wird auf den GET-Parameterseiten √ºbergeben. <br><br><img src="https://habrastorage.org/webt/yd/f4/5f/ydf45flpzzgkxsao6othbcpyzvo.png" alt="Bild"><br><br>  Versuchen wir, den Pfad zur Datei / etc / passwd als Parameter anzugeben. <br><br><img src="https://habrastorage.org/webt/nn/me/pp/nnmepppwspalsvs9mnbwyc73n4w.png" alt="Bild"><br><br>  Und sie sagen uns, wo wir das Passwort bekommen k√∂nnen. <br><br><img src="https://habrastorage.org/webt/ms/ki/ke/mskikeied698g7jyhmwwoornmxc.png" alt="Bild"><br><blockquote>  Die Sicherheitsanf√§lligkeit wird als LFI klassifiziert. </blockquote><br><h2>  Stufe 8 </h2><br>  Der Quellcode des Dienstes wird bereitgestellt.  Die codierte Zeichenfolge und die Codierungsmethode werden gespeichert. <br><br><img src="https://habrastorage.org/webt/u0/xj/wb/u0xjwbqwilif8dclzahhaw3qurc.png" alt="Bild"><br><br>  Es ist notwendig, in umgekehrter Reihenfolge zu dekodieren: <br><br><ol><li>  Konvertieren von Hex-Ansicht in Bin√§rdarstellung; </li><li>  drehe die Linie um; </li><li>  decodiere base64. </li></ol><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $secret = <span class="hljs-string"><span class="hljs-string">"3d3d516343746d4d6d6c315669563362"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> base64_decode(strrev(hex2bin($secret))).<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/dr/-k/bh/dr-kbhkinqau33fuzkgp-4onbfk.png" alt="Bild"><br><br>  Senden Sie ein Geheimnis und erhalten Sie ein Passwort. <br><br><img src="https://habrastorage.org/webt/jq/t8/js/jqt8js7i4l9p_sq6ntrpxkwt3k0.png" alt="Bild"><br><br><h2>  Stufe 9 </h2><br>  Aus der Analyse des Quellcodes wird deutlich, dass Benutzerdaten an die Befehlszeile √ºbertragen werden, um nach Daten in der Datei zu suchen. <br><br><img src="https://habrastorage.org/webt/dy/tw/we/dytwwehg9ql64vw7edwciwt4fyy.png" alt="Bild"><br><br>  Da die Daten nicht gefiltert werden, k√∂nnen Sie die Pipeline erfassen und andere Betriebssystembefehle ausf√ºhren.  Wenn Sie der Anforderung eine Zeichenfolge √ºbergeben, zum Beispiel: "||  ls # ", dann wird die vollst√§ndige Anfrage" grep -i ||  ls # dictionary.txt. "  Alles nach ||  - wird mit einem Fehler ausgef√ºhrt und nach # - wird es auskommentiert, dh wir erhalten nur die Ausgabe des Befehls ls. <br><br><img src="https://habrastorage.org/webt/us/xx/m5/usxxm5apwc3zmsqcc-guayale1y.png" alt="Bild"><br><br>  Daher lesen wir die Datei: ‚Äû||  cat / etc / natas_webpass / natas10 # ". <br><br><img src="https://habrastorage.org/webt/em/3k/ja/em3kjaq08obamvq9pm2mwq6gm_8.png" alt="Bild"><br><blockquote>  Die Sicherheitsanf√§lligkeit wird als OS Command Injection klassifiziert. </blockquote><br><h2>  Stufe 10 </h2><br>  Aus der Analyse des Quellcodes wird deutlich, dass Benutzerdaten an die Befehlszeile √ºbertragen werden, um nach Daten in der Datei zu suchen. <br><br><img src="https://habrastorage.org/webt/98/1g/bv/981gbvw8frvxlkbkq1ri9kzv5ty.png" alt="Bild"><br><br>  Die Aufgabe ist die gleiche wie auf Stufe 9, nur dass es jetzt einen Filter gibt.  T.O.  Zeichen verschwinden aus der Anfrage: ";", "|", "&amp;".  Sie k√∂nnen die Datei legitim lesen!  Angenommen, unser Passwort hat das Symbol "z": "z / etc / natas_webpass / natas11 #". <br><br><img src="https://habrastorage.org/webt/wt/3x/k7/wt3xk78hycdv475pj9fyk5nmf8k.png" alt="Bild"><br><br>  Fortsetzung folgt.  Sie k√∂nnen sich uns <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">per Telegramm anschlie√üen</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de464111/">https://habr.com/ru/post/de464111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de464099/index.html">VKScript-Sprachanalyse: JavaScript, oder?</a></li>
<li><a href="../de464103/index.html">OpenUNB-Entwurf eines nationalen IoT-Standards: kritische √úberpr√ºfung</a></li>
<li><a href="../de464105/index.html">Native Commento-Server mit Docker Compose</a></li>
<li><a href="../de464107/index.html">Digitale Veranstaltungen in Moskau vom 19. bis 25. August</a></li>
<li><a href="../de464109/index.html">Weltraum-√úberschallfallschirme</a></li>
<li><a href="../de464113/index.html">"CAD f√ºr alle, kostenlos, und lassen Sie niemanden los ..." oder die ersten Schritte bei der Programmierung von FreeCAD in Python</a></li>
<li><a href="../de464115/index.html">Wie man Freunde, Designer, Layouter und ‚ÄûFigma‚Äú mit einem Designsystem, einer Brechstange und einer Art Mutter ‚Ñ¢ zu Freunden macht</a></li>
<li><a href="../de464117/index.html">Besuch bei Vladimir Likhachev, dem Vater von Nikolai Likhachev, besser bekannt als Chris Kaspersky</a></li>
<li><a href="../de464119/index.html">Frontend Weekly Digest (12. - 18. August 2019)</a></li>
<li><a href="../de464121/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 376 (12. - 18. August 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>