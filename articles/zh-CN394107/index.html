<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐤 👨‍👨‍👧 💕 Arduino Uno平台上的Shadowplay LED手表 🍉 🔌 🍘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="而不是加入
 
 
 因此，我们的三人团队的任务是：在很短的时间内（最好是在Arduino平台上）组装一个小型硬件项目。值得一提的是，直到那一刻，我们在很大程度上还是从理论上熟悉电路。这意味着-既没有使用烙铁的经验（实际上），也没有特别的Arduino经验。
 
 突然，我们偶然发现了一篇文章致力于...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arduino Uno平台上的Shadowplay LED手表</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394107/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而不是加入</font></font></h3><br>
<img src="https://habrastorage.org/files/48b/451/4a6/48b4514a6fd144ba8e19798a1588bd87.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，我们的三人团队的任务是：在很短的时间内（最好是在Arduino平台上）组装一个小型硬件项目。</font><font style="vertical-align: inherit;">值得一提的是，直到那一刻，我们在很大程度上还是从理论上熟悉电路。</font><font style="vertical-align: inherit;">这意味着-既没有使用烙铁的经验（实际上），也没有特别的Arduino经验。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
突然，我们偶然发现</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了一篇文章</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">致力于Shadowplay Clock项目。</font><font style="vertical-align: inherit;">这是由维也纳设计师团队设计的挂钟，您可以通过将手指触摸到他们的中心来查看时间。</font><font style="vertical-align: inherit;">LED以某种方式点亮，以使中心的手指阴影显示时间。</font><font style="vertical-align: inherit;">决定在家里创建相同（或非常相似）的文件。</font><font style="vertical-align: inherit;">如您所见，以上文章没有包含该项目的详细描述。</font><font style="vertical-align: inherit;">因此，我们自己必须弄清楚该设备的工作原理并将其实现。</font><font style="vertical-align: inherit;">实际上，我们做了什么。</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用料</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
要创建手表，您需要：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 纤维板坯</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 60个LED二极管带</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arduino Uno</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RTC DS1307实时时钟模块</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 纽扣</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 面包板</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 移位寄存器74HC595（x2）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8位寄存器锁存器74HC573N（x8）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 解码器4-16 K155ID3 </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 开漏逆变器IN74HC05AN（x10）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 动力单元 </font></font></li>
</ul><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们开始吧</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，设备的算法为：</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通电时，LED以预定的组合点亮。</font><font style="vertical-align: inherit;">在最初的Shadowplay中，所有LED都点亮了，但在我们看来，启动某种组合作为屏保会更有趣。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当按下按钮时（是的，我们也离开了原稿，并在中间插入了一个小按钮），从RTC模块中读取了时间。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读取时间将转换为二进制代码（掩码），并输入到寄存器中。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">根据面罩，所需的二极管将被点亮。</font></font></li>
</ol><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">硬体</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当我们最终决定该项目的构想时，我们尝试的第一件事是从精神上勾勒出实施该方案的大概版本。主要问题是如何处理60个LED。实际上，这个问题的答案决定了构建几乎整个方案的方法。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我想到的第一个选择是使用解码器。编译电路是由四个解码器4-16和一个解码器2-4组成的级联，它们都具有解密使能输入。这样的级联允许寻址到64个输出，这足以连接60个LED。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
但是，随之而来的问题是如何使多个LED同时工作（地址）（毕竟，我们至少需要为时钟提供分针和时针）。此处显示了该方案的主要缺点-根据定义，解码器一次不能寻址多个输出。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
这个缺陷迫使我们放弃使用级联的解码器的想法。另外，现在我们对未来的电路还有另一个要求-支持同时运行不同数量的LED。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了满足此要求，我们认为可以使每个LED存储其状态。寄存器非常适合于此目的，其中每个单独的放电对应于一个LED的状态。我们决定使用8位寄存器，因为它们更通用，更实用。因此，在我们的电路中，我们将需要8个这样的寄存器来支持60个LED。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来，我们考虑了如何通过寄存器使用Arduino控制LED的状态。每个正常操作的寄存器应完整接收所有8位。当然，Arduino Uno提供足够的输出以一次传输多个位，但是这种方法并不合理。此外，该方案仅包含8个寄存器，这意味着您需要以某种方式对其进行寻址。为此，我们添加了一个解码器和两个串联连接到电路的8位移位寄存器。一个移位寄存器存储一个8位状态掩码，该状态掩码将被加载到8个常规寄存器之一中，其数量存储在第二个移位寄存器中。因此，解码器连接到第二移位寄存器。为此，一个3×8的解码器就足够了。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为了从所需数量的输出中消除反相，我们使用了两个KR1533LN1反相器电路。当然，这使方案有些复杂。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
另一个任务是LED的工作电压等于12伏，而逻辑电路为5伏。提出的解决方案是使用开漏逆变器。这种微电路起着按键的作用，该按键闭合（逻辑1）或断开（逻辑0）LED的接地触点之一，从而打开或关闭LED。该电路假设根据LED的工作电压在12伏特下工作，因此为了使逻辑电路获得5伏特，在电路中添加了带有两个电容器的KR142EN5A稳定器。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
某些微电路的某些输入在该输入处暗示一个恒定值，因此它们已接地或连接到电源。</font><font style="vertical-align: inherit;">在这种情况下，这些是以下输入：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两个移位寄存器中的MR反向输入通过负载寄存器连接至5伏稳定器输出。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两个移位寄存器中的反向OE输出使能输入直接接地。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反向解码器使能输入E0接地</font></font></li>
</ul><br>
<br>
<img src="https://habrastorage.org/files/994/7dc/3c6/9947dc3c61754b44b034f4670f846fbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
该电路由四个输入（E1，SH，ST，DS）控制。</font><font style="vertical-align: inherit;">它们的目的和信号电平将在下面详细讨论：</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
输入E1设计为启用解码器。在我们的情况下，最初在解码器上有两个控制输入E1，E0，并且它们都是相反的。一个出口将足够，因此第二个（E0）可以放到地面上。在向E1施加高信号电平之前，“默认”解码器状态是可操作的。为了进行相反的操作，我们将此输入连接到逆变器。否则，例如，在更新移位寄存器中的数据时，解码器会向寄存器提供错误的控制信号。如已经提到的，电路中可以使用3 x 8解码器，该解码器可以具有一个非反向控制输入，这将易于解决上述所有问题，而无需额外的导线和烙铁。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
当将单个信号电平施加到E1时，解码器解码位于相应移位寄存器中的寄存器地址，并将信号发送到所需的输出。此后，解码器通过向E1施加低电平信号再次关闭。解码器的这种开关在所需的输出处生成信号，该信号的边沿和衰减用作寄存器时钟脉冲，用于自身将存储在总线上的数据捕捉。</font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
接下来的三个输入已经用于控制移位寄存器。值得从最简单的事情开始-DS数据输入。顾名思义，此输入旨在用于数据传输。由于电路中的移位寄存器是级联的，所以DS代表其中之一的相应输出。第二个移位寄存器的输入连接到第一个寄存器的最后一位的输出。结果是一个用于16位的移位寄存器，其中仅使用了12位。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
输入SH是时钟输入。方波馈入此输入，该输入分别负责在每个寄存器中加载和移位数据，电路的此触点连接到两个寄存器的SHCP引脚。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
最后一个ST引脚用作寄存器输出上的数据锁存器。给该输入一个脉冲，但是，仅当移位寄存器中的数据最终装入并且需要将它们固定在寄存器的输出时才提供脉冲。仅在发出此信号后，在第一行触发器上的寄存器内下载的数据才会进入第二行触发器，并在总线上可用。 ST是连接到两个寄存器的STcp引脚的引脚。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
剩下的将解释移位寄存器MR和OE的两个引脚的接线。第一个输入（MR）负责将数据转储到寄存器中。在该电路中，不需要这样的机会，因此通过负载将高信号电平提供给该输出。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
第二寄存器输入（OE）负责使移位寄存器内的第二行触发器与总线断开，即使能输入。</font><font style="vertical-align: inherit;">也不需要此功能，因此，输出将缠绕在地上。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
上面未描述的另一种触点设计用于从手表中心的按钮上去除信号电平，该按钮电路是典型电路，代表负载和按键，具体取决于将低信号电平或高信号电平发送到Arduino的位置。</font><font style="vertical-align: inherit;">根据按钮的状态，手表可以在屏幕保护程序模式或时间显示模式下工作。</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与Arduino的连接没有特殊功能，只是SH引脚理想地连接到SCK数字引脚。</font><font style="vertical-align: inherit;">电路的其余输出可以连接到任何可用的通用数字输入。</font><font style="vertical-align: inherit;">在我们的例子中，连接具有以下形式：</font></font><br>
<br>
<ul>
<li>Arduino pin13 (SCK) –   SH</li>
<li>Arduino pin 11 –   ST Arduino pin 8 –   DS Arduino pin 5 –   E1 Arduino pin 3 –   Arduino pin GND –   (      )<br>
       ,      .<br>
<br>
    :   36  —   ;    36  ( ) \ 26  ( ) —  .   Shadowplay    72 ,     36.     ,    60  ( + ).     .   ,   ,     ,      .<br>
<br>
<img src="https://habrastorage.org/files/c46/3ff/f0b/c463fff0b95e402eaf9b4274301f04ba.jpg"><br>
<br>
  ,     .      ,    .   ,      .      ,  «»    50 — 60,        . , 60   .  :      —   .<br>
<br>
<img src="https://habrastorage.org/files/871/643/435/87164343503642ba802ead947d81ab6a.JPG"><br>
<br>
   ,  ,    ,  .      —     . ,         ,    .  ,   —  .<br>
<br>
<div class="spoiler"><b class="spoiler_title">      .</b><div class="spoiler_text"><img src="https://habrastorage.org/files/f95/9cc/f6d/f959ccf6d1c34b58ac31411eb3477a99.jpg"><br>
</div></div><br>
-,  .<br>
<br>
     Shadowplay.  ,       ,    . ,    ,       .      , ..     .        ,  ,       100% .    ,       .       .     ,         .  ,               .<br>
<br>
 ,      (       ),     ,    —    . ,  ,   !    .   ,  - -   . ,   ,    .             ,     ,           .   ,     ,    ,   .     .,     -         .    ,      ,   , ,   ,     . <br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.youtube.com/embed/uy-cLHOz-5M%3Ffeature%3Doembed&amp;usg=ALkJrhg0VlQDVHvgIw2QxElsWZoYragV1Q" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 ,     .         . ..   ,     , ( ,      ,         ),      . <br>
<br>
<h4> </h4><br>
,     ().      Arduino.  ,    RTC,   —    .      DS1307,   — I2C.       2100     .          .     RTC  Arduino,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>.         RTC.<br>
<br>
<img src="https://habrastorage.org/files/c76/129/084/c761290840164f52a699e8f7d0c23a50.jpg"><br>
<br>
     ,      RTC,         .<br>
<br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"> <pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Time.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DS1307RTC.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> REG [<span class="hljs-number"><span class="hljs-number">8</span></span>];<font></font>
tmElements_t te;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c,reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">13</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">11</span></span>, OUTPUT); <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">8</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">5</span></span>, OUTPUT);  <font></font>
  pinMode(<span class="hljs-number"><span class="hljs-number">3</span></span>, INPUT);   <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
  <font></font>
  <span class="hljs-comment"><span class="hljs-comment">//      RTC  </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Hour = 18;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Minute = 50;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Second = 0;</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Day = 20; //</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Month = 4; // </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//te.Year = CalendarYrToTm(2016); </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//RTC.write(te);</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{ 
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(digitalRead(<span class="hljs-number"><span class="hljs-number">3</span></span>))                    <span class="hljs-comment"><span class="hljs-comment">// ,     </span></span><font></font>
  {RTC.read(te);<font></font>
   SetShadowTime(te.Hour,te.Minute,te.Second,<span class="hljs-number"><span class="hljs-number">2</span></span>);        <span class="hljs-comment"><span class="hljs-comment">//         </span></span>
   delay(<span class="hljs-number"><span class="hljs-number">900</span></span>);<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>                                   <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span><font></font>
  {wait1();<font></font>
   reset=<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
  }<font></font>
                                         <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,<span class="hljs-number"><span class="hljs-number">0</span></span>); <font></font>
   <font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//======================================================================= </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUpLightByMask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RegNum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> LightMask)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//         </span></span></span><span class="hljs-function">
</span></span>{<font></font>
  <font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, LOW);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, LOW);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, MSBFIRST, LightMask);<font></font>
  shiftOut(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, LSBFIRST, RegNum);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">11</span></span>, HIGH);<font></font>
  digitalWrite(<span class="hljs-number"><span class="hljs-number">5</span></span>, HIGH);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digitalClockDisplay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{  <span class="hljs-comment"><span class="hljs-comment">//    RTC  ,    RTC  </span></span><font></font>
  RTC.read(te);<font></font>
  Serial.print(te.Hour);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" : "</span></span>);<font></font>
  Serial.print(te.Minute);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" :"</span></span>);<font></font>
  Serial.print(te.Second);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Day);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(te.Month);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">" "</span></span>);<font></font>
  Serial.print(tmYearToCalendar(te.Year));<font></font>
  Serial.println();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ,     , ,        :</span></span>
<span class="hljs-comment"><span class="hljs-comment">//0 -  ,1 -   , 2 -    </span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetShadowTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hours, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Minutes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Seconds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> param)</span></span></span></span>{   
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h,hshift,m,s;
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) REG[j] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Hours &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) Hours -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  h = Hours + <span class="hljs-number"><span class="hljs-number">6</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(h &gt;= <span class="hljs-number"><span class="hljs-number">12</span></span>) h -= <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
    <font></font>
  hshift = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Minutes / <span class="hljs-number"><span class="hljs-number">12</span></span>;<font></font>
  <font></font>
  REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(((h*<span class="hljs-number"><span class="hljs-number">5</span></span>)+hshift)%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
             <font></font>
   <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">1</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
   }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(param == <span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  {m = Minutes + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(m &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) m -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(m/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(m%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
     <font></font>
   s = Seconds + <span class="hljs-number"><span class="hljs-number">30</span></span>;
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(s &gt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) s -= <span class="hljs-number"><span class="hljs-number">60</span></span>;<font></font>
   REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] = REG[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(s/<span class="hljs-number"><span class="hljs-number">8</span></span>)] | <span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;(s%<span class="hljs-number"><span class="hljs-number">8</span></span>);<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">8</span></span> ; j++) SetUpLightByMask(j,REG[j]);<font></font>
  }<font></font>
  <font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wait1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    </span></span></span><span class="hljs-function">
</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">0</span></span>;
     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       c = c | <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);  <font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);   <font></font>
      }<font></font>
   }<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span>; a &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; a++)<font></font>
    {c=<span class="hljs-number"><span class="hljs-number">255</span></span>;
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b = <span class="hljs-number"><span class="hljs-number">0</span></span>; b &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; b++)<font></font>
      {c = c &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
       SetUpLightByMask(a, c);<font></font>
       delay(<span class="hljs-number"><span class="hljs-number">10</span></span>);     <font></font>
      }<font></font>
    }  <font></font>
}<font></font>
</code></pre> <br>
</div></div><br>
<h4></h4><br>
    .         .      (Arduino, RTC)     .      ,   .       ,    «- ».   —   .  :<br>
<br>
    .<br>
<br>
<div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.slideshare.net/slideshow/embed_code/61634811&amp;usg=ALkJrhg_rAGGlCp91e-00glU2DZYIu-isg" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br>
<br>
   ,       «»:<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.youtube.com/embed/KbbakER89U0%3Ffeature%3Doembed&amp;usg=ALkJrhgJkwLNp5CP3tBR1ZBsq5rZeuz7RQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
 , ,    :<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.youtube.com/embed/SIPI6ug_dls%3Ffeature%3Doembed&amp;usg=ALkJrhiZRqM9epblQISATyTo9y5hpCL3lQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
    ,  ,   ,   . <br>
<br>
 ,  ,     .   ,    ?      .     :         ( ,     ,  ..). ,   ,  ,         .        . ,     .<br>
<br>
<h4></h4><br>
  ?<br>
<br>
<ul>
<li>,    ,   .</li>
<li>       .</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">能够以编程方式轻松更改LED闪烁顺序的能力，从而提供了无限多种组合。</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
我们不主张我们的电路和软件解决方案的绝对正确性。</font><font style="vertical-align: inherit;">如前所述，负面经验也是经验。</font><font style="vertical-align: inherit;">也许这篇文章可以帮助某人避免我们的错误。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
感谢您的关注！</font></font></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN394107/">https://habr.com/ru/post/zh-CN394107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN394095/index.html">NASA的Hackathon学童如何逆向设计健身手链以控制无人机</a></li>
<li><a href="../zh-CN394097/index.html">[讨厌]痛苦。格式RusMARC</a></li>
<li><a href="../zh-CN394101/index.html">投票：您的操作系统使用哪种语言</a></li>
<li><a href="../zh-CN394103/index.html">火星上的风和冰</a></li>
<li><a href="../zh-CN394105/index.html">智能蓝牙拭子会告诉您何时该更换</a></li>
<li><a href="../zh-CN394111/index.html">在磁盘上快速存储信息的时间或位置</a></li>
<li><a href="../zh-CN394113/index.html">AOC和Jide在Remix OS上发布了多合一PC</a></li>
<li><a href="../zh-CN394115/index.html">你的主意是多少？</a></li>
<li><a href="../zh-CN394123/index.html">Minecraft Gameband-游戏手镯</a></li>
<li><a href="../zh-CN394125/index.html">Windows 7安装在智能手机LG G Watch上</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>