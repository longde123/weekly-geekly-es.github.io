<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí† üöã üó°Ô∏è Comment voir rapidement les avertissements int√©ressants g√©n√©r√©s par l'analyseur PVS-Studio pour le code C et C ++? üö´ üí∑ ü¶å</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De temps en temps, les programmeurs qui commencent √† se familiariser avec l'analyseur de code PVS-Studio demandent: "Existe-t-il une liste d'avertisse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment voir rapidement les avertissements int√©ressants g√©n√©r√©s par l'analyseur PVS-Studio pour le code C et C ++?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/457332/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df3/c29/8f2/df3c298f21cb71d0c7c699b7e27269d3.png"></div><br>  De temps en temps, les programmeurs qui commencent √† se familiariser avec l'analyseur de code PVS-Studio demandent: "Existe-t-il une liste d'avertissements qui indiquent avec pr√©cision les erreurs?"  Il n'y a pas une telle liste pour la raison que des avertissements (faux) sans int√©r√™t dans un projet et dans un autre s'av√®rent tr√®s importants et utiles.  Cependant, commencer √† se familiariser avec l'analyseur avec les avertissements les plus int√©ressants est tout √† fait possible.  Examinons de plus pr√®s ce sujet. <br><a name="habracut"></a><br>  L'ennui, c'est que lors des premiers lancements, le programmeur re√ßoit en r√®gle g√©n√©rale un grand nombre d'avertissements dans lesquels il ¬´se noie¬ª.  Naturellement, il a envie de se familiariser avec les avertissements les plus int√©ressants afin de comprendre s'il doit passer tout ce temps.  Tr√®s bien, voici trois √©tapes simples qui vous permettront de vous familiariser avec les points positifs les plus int√©ressants. <br><br><h2>  √âtape 1 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/648/436/d98/648436d98521380495f1c9f8ee384646.png"></div><br><br>  D√©sactivez tous les types d'alertes √† l'exception de g√©n√©ral (GA).  Une erreur courante: activez toutes sortes d'avertissements.  Pour les utilisateurs inexp√©riment√©s, il semble que plus vous l'allumez, mieux c'est.  Ce n'est pas le cas!  Il existe des ensembles de diagnostics, tels que les contr√¥les 64 bits et les r√®gles MISRA, qui ne doivent √™tre utilis√©s qu'avec une id√©e claire de ce que c'est et de la fa√ßon de les utiliser.  Par exemple, en activant les diagnostics MISRA pour un programme d'application ordinaire, vous vous noyerez dans des dizaines, des milliers ou des centaines de milliers de messages comme: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2506</a> .  Misra.  Une fonction doit avoir un seul point de sortie √† la fin. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2507</a> .  Misra.  Le corps d'une instruction loop \ conditional doit √™tre plac√© entre accolades. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2523</a> .  Misra.  Toutes les constantes enti√®res de type non sign√© doivent avoir le suffixe ¬´u¬ª ou ¬´U¬ª. </li></ul><br>  La plupart des avertissements MISRA n'indiquent pas d'erreurs, mais le code sent.  Naturellement, une personne commence √† poser des questions.  Comment trouver quelque chose d'int√©ressant dans la masse de tous ces avertissements?  Diagnostics sous quels num√©ros doit-il regarder?  Ce ne sont pas les bonnes questions.  Il vous suffit de d√©sactiver le kit MISRA.  Il s'agit de la norme pour √©crire du code de qualit√© pour les appareils int√©gr√©s.  L'essence de la norme: rendre le code extr√™mement simple et compr√©hensible.  N'essayez pas de l'appliquer l√† o√π il est inappropri√©. <br><br>  Remarque  Oui, il existe des r√®gles dans la norme MISRA visant √† identifier les erreurs r√©elles.  Exemple: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2538</a> - La valeur de la variable non initialis√©e ne doit pas √™tre utilis√©e.  Mais n'ayez pas peur de d√©sactiver la norme MISRA.  Vous ne perdrez rien.  De vraies erreurs seront toujours trouv√©es dans les diagnostics √† usage g√©n√©ral (GA).  Par exemple, une variable non initialis√©e sera trouv√©e gr√¢ce au diagnostic <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V614</a> . <br><br><h2>  √âtape 2 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f30/9c1/d2f/f309c1d2fed7a2736170dad987cd4460.png"></div><br><br>  Tout analyseur statique g√©n√®re des faux positifs lors des premiers d√©marrages et n√©cessite une certaine configuration.  Rien ne peut √™tre fait avec cela, mais ce n'est pas aussi effrayant que cela puisse para√Ætre.  M√™me une simple configuration rapide vous permet de supprimer la plupart des faux avertissements et de commencer √† vous familiariser avec un rapport d√©j√† tout √† fait ad√©quat.  Nous n'en parlerons pas plus en d√©tail, car j'en ai souvent parl√©, par exemple, dans cet article: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caract√©ristiques de l'analyseur PVS-Studio utilisant l'exemple EFL Core Libraries, 10 √† 15% de faux positifs</a> ." <br><br>  Passez un peu de temps √† d√©sactiver les avertissements explicitement non pertinents et √† combattre les faux positifs dus aux macros.  Les macros sont g√©n√©ralement la principale source de faux positifs, car un avertissement appara√Æt chaque fois qu'une macro d√©faillante est utilis√©e.  Pour supprimer les avertissements dans les macros, un type sp√©cial de commentaires peut √™tre plac√© √† c√¥t√© de leur d√©claration.  Le format de r√©daction des commentaires est d√©crit plus en d√©tail dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> . <br><br>  Oui, la configuration initiale prendra un peu de temps, mais am√©liorera consid√©rablement la perception du rapport en √©liminant le bruit g√™nant.  Prenez un peu de temps pour cela.  En cas de difficult√©s ou de questions, nous sommes toujours pr√™ts √† vous aider et √† sugg√©rer la meilleure fa√ßon de configurer l'analyseur.  N'h√©sitez pas √† nous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©crire</a> et √† nous poser des questions. <br><br><h2>  √âtape 3 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f87/0ec/c49/f870ecc49989743ae8caea3c745e602e.png"></div><br><br>  Commencez √† apprendre les avertissements √† partir du niveau 1.  Et alors seulement, regardez 2 et 3. Les niveaux d'avertissement ne sont rien de plus que la fiabilit√© de l'avertissement.  Les avertissements de niveau 1 sont plus susceptibles d'indiquer une v√©ritable erreur que 2. <br><br>  On peut dire qu'en choisissant ¬´regarder niveau 1¬ª, vous appuyez sur le bouton ¬´regarder les erreurs les plus int√©ressantes¬ª. <br><br>  La classification des alertes PVS-Studio par niveaux est d√©crite plus en d√©tail dans l'article ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment et pourquoi les analyseurs statiques traitent les faux positifs</a> ¬ª. <br><br><h2>  Alors pourquoi n'y a-t-il toujours pas de liste? </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df2/95f/70b/df295f70b19562c12916ec578022829f.png"></div><br><br>  Cependant, une id√©e avec une liste des avertissements les plus utiles peut encore sembler raisonnable.  Permettez-moi de montrer par un exemple pratique que l'utilit√© du diagnostic est relative et d√©pend du projet. <br><br>  Consid√©rez l'avertissement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V550</a> .  Un avertissement r√©v√®le une erreur potentielle due au fait que l'op√©rateur == ou! = Est utilis√© pour comparer les nombres √† virgule flottante. <br><br>  La plupart des d√©veloppeurs avec qui j'ai parl√© croient que ce diagnostic est de peu d'utilit√© et le d√©sactivent, car tous les points positifs de leur projet sont faux.  Et c'est pourquoi ce diagnostic est peu fiable et se situe au 3√®me niveau. <br><br>  En effet, dans la plupart des applications, les types float / double sont utilis√©s dans des algorithmes tr√®s simples.  Et souvent, une comparaison avec une constante est utilis√©e uniquement pour v√©rifier si une valeur par d√©faut est d√©finie ou si elle a chang√©.  Dans ce cas, une v√©rification pr√©cise est tout √† fait appropri√©e.  Je vais expliquer cela avec un pseudo-code. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsUserInputNewValue()) value = GetUserValue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-number"><span class="hljs-number">1.0f</span></span>) DefaultBehavior(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Foo(value);</code> </pre> <br>  Ici, la comparaison <i>(valeur == 1.0f) est</i> correcte et s√ªre. <br><br>  Est-ce √† dire que le V550 est un diagnostic sans int√©r√™t?  Non.  Tout d√©pend du projet.  Je citerai un fragment de l'article " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment nous avons test√© l'analyse statique sur notre projet de simulateur d'entra√Ænement √† la chirurgie endovasculaire</a> ", √©crit par l'un de nos utilisateurs. <br><br>  Donc, ce que l'analyseur statique attire notre attention ici: <br><br>  V550 Une comparaison √©trange et pr√©cise: t! = 0. Il est probablement pr√©f√©rable d'utiliser une comparaison avec une pr√©cision d√©finie: fabs (A - B)&gt; Epsilon.  objectextractpart.cpp 3401 <br><br><pre> <code class="cpp hljs">D3DXVECTOR3 N = VectorMultiplication( VectorMultiplication(V-VP, VN), VN); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Qsqrt(Scalar(N, N)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { N/=t; V = V - N * DistPointToSurface(V, VP, N); }</code> </pre> <br>  Des erreurs similaires sont r√©p√©t√©es assez souvent dans cette biblioth√®que.  Je ne dirai pas que cela m'a surpris.  D√©j√† auparavant, j'ai rencontr√© un travail incorrect avec des nombres √† virgule flottante dans ce projet.  Cependant, il n'y avait pas de ressources pour v√©rifier syst√©matiquement les sources pour cela.  Selon les r√©sultats de la v√©rification, il est devenu clair que vous devez donner au d√©veloppeur quelque chose √† lire pour √©largir ses horizons en termes de travail avec les nombres √† virgule flottante.  Je lui ai jet√© des liens vers quelques bons articles.  Regardons le r√©sultat.  Il est difficile de dire sans ambigu√Øt√© si cette erreur provoque de v√©ritables dysfonctionnements dans le programme.  La solution actuelle d√©finit un certain nombre d'exigences pour le r√©seau polygonal initial des art√®res, le long desquelles la propagation d'une substance radio-opaque est simul√©e.  Si les exigences ne sont pas remplies, le programme peut se bloquer ou, de toute √©vidence, fonctionner incorrectement.  Certaines de ces exigences sont obtenues analytiquement et d'autres empiriquement.  Il est possible que cette deuxi√®me partie des exigences se d√©veloppe simplement √† partir d'un travail incorrect avec des nombres √† virgule flottante.  Il convient de noter que tous les cas trouv√©s d'utilisation d'une comparaison exacte des nombres √† virgule flottante n'√©taient pas une erreur. <br><br>  Comme vous pouvez le voir, ce qui n'est pas int√©ressant dans certains projets int√©resse d'autres.  Il est donc impossible de cr√©er une liste des "plus int√©ressants". <br><br>  Remarque  Il est possible de d√©finir le niveau d'avertissement √† l'aide des param√®tres.  Par exemple, si vous pensez que les diagnostics du V550 m√©ritent une attention particuli√®re, vous pouvez le d√©placer du troisi√®me niveau au premier.  Ce type de param√®tres est d√©crit dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> (voir "Comment d√©finir votre niveau pour des diagnostics sp√©cifiques"). <br><br><h2>  Conclusion </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37d/d9e/ecd/37dd9eecd44e33d66c2993ad552e11f7.png"></div><br><br>  Vous savez maintenant comment commencer √† √©tudier les avertissements de l'analyseur, en consid√©rant les plus int√©ressants d'entre eux.  Et n'oubliez pas de consulter la documentation pour vous familiariser avec la description d√©taill√©e des avertissements.  Parfois, il arrive que derri√®re un manque de pr√©jug√©, √† premi√®re vue, l'avertissement est l'enfer.  Un exemple de tels diagnostics: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V597</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1026</a> .  Merci de votre attention. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Andrey Karpov.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment v√©rifier rapidement les avertissements int√©ressants donn√©s par l'analyseur PVS-Studio pour le code C et C ++?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457332/">https://habr.com/ru/post/fr457332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457316/index.html">Comment le jeu de r√¥le dans le monde r√©el est organis√© pour les invit√©s d'Arm√©nie avec des voyages dans la moiti√© du pays</a></li>
<li><a href="../fr457324/index.html">√âv√©nements num√©riques √† Moscou du 24 au 30 juin</a></li>
<li><a href="../fr457326/index.html">Cluster de basculement PostgreSQL + Patroni. Exp√©rience de mise en ≈ìuvre</a></li>
<li><a href="../fr457328/index.html">Cat√©gories au lieu de r√©pertoires, ou le syst√®me de fichiers s√©mantique pour Linux</a></li>
<li><a href="../fr457330/index.html">Comment v√©rifier rapidement les avertissements int√©ressants donn√©s par l'analyseur PVS-Studio pour le code C et C ++?</a></li>
<li><a href="../fr457334/index.html">TacacsGUI, Configuration Manager</a></li>
<li><a href="../fr457336/index.html">Les cons√©quences du retrait pr√©matur√© des dents de sagesse</a></li>
<li><a href="../fr457338/index.html">Blitz avec Ilya Krasinsky: comment tirer les mauvaises hypoth√®ses, pourquoi rejeter un produit et comment grandir pour un minimum d'action?</a></li>
<li><a href="../fr457340/index.html">10 plugins PostCSS qui vous feront gagner du temps de mise en page</a></li>
<li><a href="../fr457342/index.html">Signes d'en haut: comment nous avons sauv√© les cartographes du travail inutile et des yeux rouges</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>