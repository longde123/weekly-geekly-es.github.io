<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐫 📧 🚯 Dompet Apple Apa itu dan bagaimana mengintegrasikan kartu Anda ke dalamnya 🙇🏾 👃🏼 🔟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Secara umum diterima bahwa Wallet bukan layanan yang paling populer di CIS. Tetapi sudah dalam proyek kedua berturut-turut, pelanggan menetapkan tugas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dompet Apple Apa itu dan bagaimana mengintegrasikan kartu Anda ke dalamnya</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/agima/blog/428437/"><p>  Secara umum diterima bahwa Wallet bukan layanan yang paling populer di CIS.  Tetapi sudah dalam proyek kedua berturut-turut, pelanggan menetapkan tugas "Buat integrasi dengan Dompet."  Oleh karena itu, saya memutuskan untuk menulis artikel ini untuk membicarakan layanan ini secara keseluruhan dan menunjukkan bagaimana mengintegrasikan produk saya ke dalamnya. </p><br><p>  Apa itu dompet?  Ini memungkinkan Anda untuk menyimpan berbagai jenis kartu di telepon Anda (tiket, kartu diskon, dll.), Membuat hidup lebih mudah bagi pengguna produk.  Selain itu, dimungkinkan untuk memperbarui informasi tentang peta melalui pemberitahuan push, tetapi ini adalah topik untuk artikel terpisah.  Tetapi jika Anda memiliki kartu / tiket / berlangganan yang dapat diintegrasikan ke dalam ponsel, maka ada solusinya!  Bagaimana cara melakukannya - baca di bawah. </p><a name="habracut"></a><br><p> Sebagai aturan, server Anda bertanggung jawab untuk membuat peta.  Aplikasi menerima kartu dalam bentuk file .pkpass dan melalui aplikasi pengguna dapat menambahkan kartu ke Wallet. </p><br><h2 id="struktura-karty">  Struktur peta </h2><br><p>  Apa peta dari sudut pandang pengembang?  Peta adalah arsip dengan ekstensi .pkpass.  Ini berisi semua data yang diperlukan untuk tampilan dan pengoperasian kartu.  Isi arsip ada dalam tabel di bawah ini. </p><br><table><tbody><tr><th>  File </th><th>  Janji temu </th></tr><tr><td>  background.png </td><td>  Gambar latar belakang untuk kartu. </td></tr><tr><td>  footer.png </td><td>  Gambar di sebelah barcode </td></tr><tr><td>  icon.png </td><td>  Ikon untuk notifikasi dan surat </td></tr><tr><td>  logo.png </td><td>  Logo kartu.  Ditampilkan kiri atas </td></tr><tr><td>  manifes. json </td><td>  Registri semua file yang disertakan </td></tr><tr><td>  tanda tangan </td><td>  Tanda tangan PKCS7 </td></tr><tr><td>  pass.json </td><td>  Informasi tampilan dan peta </td></tr><tr><td>  strip.png </td><td>  Gambar terletak di belakang deskripsi utama kartu </td></tr><tr><td>  thumbnail.png </td><td>  Gambar tambahan (sebutkan) </td></tr></tbody></table><br><p>  Jenis kartu berikut tersedia: </p><br><ul><li>  <b>Tiket</b> naik <b>:</b> dengan pesawat atau kereta api.  Biasanya kupon berfungsi untuk satu perjalanan; </li><li>  <b>Kupon:</b> untuk kupon dan penawaran khusus; </li><li>  <b>Tiket acara:</b> bisa digunakan untuk satu acara dan untuk satu musim penuh; </li><li>  <b>Kartu diskon: kartu</b> loyalitas, kartu diskon atau kartu hadiah; </li><li>  <b>Kartu pandangan umum:</b> jika tidak ada yang di atas berlaku untuk kasus Anda: misalnya, kartu untuk bepergian dengan kereta bawah tanah atau kartu pas ke gym. </li></ul><br><p>  Pertimbangkan secara skematis penampilan kartu yang berbeda.  Gambar dinamai seperti yang ditunjukkan pada tabel di atas. </p><br><h3>  Boarding pass </h3><br><img src="https://habrastorage.org/webt/8m/s6/cy/8ms6cyz55rve1igxt_xfv2e034i.png"><br><h3>  Kupon </h3><br><img src="https://habrastorage.org/webt/-r/l-/dk/-rl-dknkbsqnkuim5-kqog6ceuu.png"><br><h3>  Tiket Acara </h3><br><img src="https://habrastorage.org/webt/rr/r9/jh/rrr9jh2ho29rfmht7xrf0z7pmes.png"><br><h3>  Kartu komunitas </h3><br><img src="https://habrastorage.org/webt/az/zc/hg/azzchgo25cvpj_gcu_oof1vh1k8.png"><br><h3>  Kartu diskon </h3><br><img src="https://habrastorage.org/webt/zl/zt/ft/zlztft7igalmerx8rhabnxorwfc.png"><br><h1 id="struktura-passjson">  Lulus. Struktur json </h1><br><p>  Bidang yang wajib diisi.  Berisi ID Jenis Pass, ID Tim, nama organisasi, dll. <br>  Kunci untuk aplikasi terkait.  Diperlukan untuk menampilkan aplikasi yang perlu "dikaitkan" dengan peta. <br>  Kartu kunci "tanggal kedaluwarsa". <br>  Kunci relevansi.  Misalnya, koordinat area tempat peta dapat digunakan, atau awal acara yang dimaksudkan. <br>  Kuncinya adalah gaya.  Di awal artikel, 5 jenis kartu untuk Dompet terdaftar.  Masing-masing dari mereka memiliki gayanya sendiri.  Kunci seperti itu harus benar-benar satu. <br>  Kunci untuk desain visual kartu.  Selain yang jelas, mereka berisi informasi tentang kode batang yang ditampilkan di peta. <br>  Kunci layanan web.  Anda dapat menggunakan layanan web untuk berinteraksi dengan peta, misalnya, memperbaruinya secara otomatis. <br>  Tombol NFC.  Berisi informasi tambahan untuk transaksi Apple Pay. </p><br><p>  Sekarang tentang semuanya dengan lebih detail. </p><br><h2>  Bidang yang wajib diisi </h2><br><table><tbody><tr><th>  <nobr>Masukkan JSON</nobr> </th><th>  <nobr>Tipe data</nobr> </th><th>  <nobr>Deskripsi</nobr> </th></tr><tr><td>  deskripsi </td><td>  Tali <br>  Dilokalkan </td><td>  Deskripsi singkat peta.  Dilokalkan. </td></tr><tr><td>  formatVersion </td><td>  Int </td><td>  Versi format file.  Nilai harus 1. </td></tr><tr><td>  <nobr>Nama organisasi</nobr> </td><td>  Tali <br>  Dilokalkan </td><td>  Nama organisasi yang mengeluarkan kartu. </td></tr><tr><td>  <nobr>passTypeIdentifier</nobr> </td><td>  Tali </td><td>  Lewati Jenis ID dan akun pengembang. </td></tr><tr><td>  <nobr>nomor seri</nobr> </td><td>  Tali </td><td>  Nomor Seri Kartu Tunggal </td></tr><tr><td>  <nobr>teamIdentifier</nobr> </td><td>  Tali </td><td>  ID Tim tim pengembangan </td></tr></tbody></table><br><h2>  Kunci untuk aplikasi terkait </h2><br><table><tbody><tr><th>  <nobr>Masukkan JSON</nobr> </th><th>  <nobr>Tipe data</nobr> </th><th>  <nobr>Deskripsi</nobr> </th></tr><tr><td>  <nobr>terkaitStoreIdentifiers</nobr> </td><td>  [Int] </td><td>  Opsional.  ID aplikasi yang terkait dengan kartu.  Yang pertama yang kompatibel dengan perangkat saat ini selalu diambil. </td></tr><tr><td>  <nobr>appLaunchURL</nobr> </td><td>  Tali </td><td>  URL yang diteruskan ke aplikasi saat dibuka </td></tr></tbody></table><br><h2>  Kunci gaya </h2><br><table><tbody><tr><th>  <nobr>Masukkan JSON</nobr> </th><th>  <nobr>Tipe data</nobr> </th><th>  <nobr>Deskripsi</nobr> </th></tr><tr><td>  <nobr>Hasil utama</nobr> </td><td>  [JSON] </td><td>  Informasi dasar tentang peta. </td></tr><tr><td>  <nobr>bidang sekunder</nobr> </td><td>  [JSON] </td><td>  Informasi Latar Belakang. </td></tr><tr><td>  <nobr>AuxiliaryFields</nobr> </td><td>  [JSON] </td><td>  Bidang untuk informasi tambahan.  Opsional </td></tr><tr><td>  <nobr>headerFields</nobr> </td><td>  [JSON] </td><td>  Judul peta.  Ini ditampilkan bahkan ketika kartu terlihat dalam daftar. </td></tr><tr><td>  <nobr>AuxiliaryFields</nobr> </td><td>  [JSON] </td><td>  Informasi dasar tentang peta. </td></tr><tr><td>  <nobr>transitType</nobr> </td><td>  Tali </td><td>  Jenis transportasi untuk kartu tiket.  Ini dapat mengambil nilai-nilai berikut: <br>  PKTransitTypeAir, <br>  PKTransitTypeBoat, <br>  PKTransitTypeBu`, <br>  PKTransitTypeGeneric, <br>  `PKTransitTypeTrain`. </td></tr><tr><td>  <nobr>backFields</nobr> </td><td>  [JSON] </td><td>  Array bidang yang bertanggung jawab untuk sisi belakang peta </td></tr></tbody></table><br><p>  JSON dalam hal ini memiliki bentuk sebagai berikut: </p><br><pre><code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"key"</span></span> : <span class="hljs-string"><span class="hljs-string">"value1"</span></span>, <span class="hljs-string"><span class="hljs-string">"label"</span></span> : <span class="hljs-string"><span class="hljs-string">"value2"</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span> : <span class="hljs-string"><span class="hljs-string">"value3"</span></span></code> </pre> <br><p>  Nilai dengan kunci nilai bisa berupa angka atau string.  Namun, currencyCode bersama dengan nilai string tidak dapat digunakan.  Adapun AuxiliaryFields dan secondaryFields, mungkin ada beberapa, dan Anda harus memantau panjang baris yang digunakan di dalamnya. </p><br><h2>  Kunci untuk Desain Visual </h2><br><table><tbody><tr><th>  <nobr>Masukkan JSON</nobr> </th><th>  <nobr>Tipe data</nobr> </th><th>  <nobr>Deskripsi</nobr> </th></tr><tr><td>  <nobr>barcode</nobr> </td><td>  [JSON] </td><td>  Informasi untuk barcode (lihat di bawah). </td></tr><tr><td>  <nobr>warna latar belakang</nobr> </td><td>  warna sebagai string </td><td>  Warna latar belakang (# Fa32e4) </td></tr><tr><td>  <nobr>foregroundColor</nobr> </td><td>  warna sebagai string </td><td>  Label warna dengan nilai </td></tr><tr><td>  <nobr>pengelompokan Identifier</nobr> </td><td>  Tali </td><td>  Opsional untuk tiket acara dan tiket transportasi.  Kartu dengan gaya yang sama - passTypeIdentifier dan groupingIdentifier - akan dikelompokkan </td></tr><tr><td>  <nobr>labelColor</nobr> </td><td>  warna sebagai string </td><td>  Beri label teks dengan nama bidang </td></tr><tr><td>  <nobr>logoText</nobr> </td><td>  String yang dapat dilokalisasi </td><td>  Teks ditampilkan di sebelah logo </td></tr></tbody></table><br><h2>  Kode batang </h2><br><p>  Bagian terpenting dari peta.  Nomor identifikasi kartu dijahit ke dalamnya (misalnya, nomor kartu fisik atau nomor tiket).  Penting agar pemindai atau alat lain dapat membaca kode dalam penyandian yang benar. </p><br><table><tbody><tr><th>  <nobr>Masukkan JSON</nobr> </th><th>  <nobr>Tipe data</nobr> </th><th>  <nobr>Deskripsi</nobr> </th></tr><tr><td>  <nobr>altText</nobr> </td><td>  Tali </td><td>  Teks opsional ditampilkan di sebelah barcode jika barcode tidak dibaca. </td></tr><tr><td>  <nobr>format</nobr> </td><td>  Tali </td><td>  Format barcode  Dapat mengambil nilai: PKBarcodeFormatQR, <br>  PKBarcodeFormatPDF417, <br>  PKBarcodeFormatAztec, <br>  PKBarcodeFormatCode128 </td></tr><tr><td>  <nobr>pesan</nobr> </td><td>  Tali </td><td>  Kode atau nomor kartu dienkripsi dalam barcode. </td></tr><tr><td>  <nobr>messageEncoding</nobr> </td><td>  Tali </td><td>  Pengkodean pesan.  Biasanya iso-8859-1 </td></tr></tbody></table><br><h2>  Lokasi </h2><br><p>  Kunci-kunci ini bertanggung jawab atas lokasi di mana kartu dapat digunakan. </p><br><table><tbody><tr><th>  <nobr>Masukkan JSON</nobr> </th><th>  <nobr>Tipe data</nobr> </th><th>  <nobr>Deskripsi</nobr> </th></tr><tr><td>  <nobr>altiture</nobr> </td><td>  Tali </td><td>  Teks opsional ditampilkan di sebelah barcode jika barcode tidak dibaca. </td></tr><tr><td>  <nobr>garis lintang</nobr> </td><td>  Bujur </td><td>  Lintang </td></tr><tr><td>  <nobr>longtitude</nobr> </td><td>  Dobel </td><td>  Lintang </td></tr><tr><td>  <nobr>relevanTeks</nobr> </td><td>  Tali </td><td>  Teks opsional yang muncul di layar kunci saat pengguna memasuki kisaran kartu. </td></tr></tbody></table><br><h2>  Sisi belakang </h2><br><p>  Informasi tambahan dapat ditempatkan pada bagian informasi terbalik: syarat penggunaan, kebijakan pembaruan otomatis, perincian kontak dan tautan ke aplikasi tempat kartu itu berada.  Gambar tersebut menunjukkan korespondensi bidang dalam pass.json dan penampilan sisi sebaliknya dari peta.  Jika ada tautan, nomor telepon, dll. Di bidang nilai, mereka akan disorot secara otomatis. </p><br><p><img src="https://habrastorage.org/webt/er/gx/ow/ergxowmbtn08dmjnv2lkrqlo3ku.png"></p><br><h1 id="sozdanie-karty-chast-2">  Buat peta.  Bagian 2 </h1><br><p>  Jadi, gambarnya sudah siap, pass.json sudah terbentuk, masih harus disatukan.  Untuk melakukan ini, isi manifest.json (lihat tabel 1), di mana Anda harus memasukkan semua gambar dan pass.json.  Ternyata sesuatu seperti ini: </p><br><pre> <code class="hljs go">. . . . . . <span class="hljs-string"><span class="hljs-string">"pass.json"</span></span> = <span class="hljs-number"><span class="hljs-number">303</span></span>c753abc39aa732ec74643d6db28348fe8a823; <span class="hljs-string"><span class="hljs-string">"strip.png"</span></span> = <span class="hljs-number"><span class="hljs-number">736d</span></span>01f84cb73d06e8a9932e43076d68f19461ff; <span class="hljs-string"><span class="hljs-string">"strip@2x.png"</span></span> = <span class="hljs-number"><span class="hljs-number">468f</span></span>a7bc93e6b55342b56fda09bdce7c829d7d46; . . . . . .</code> </pre> <br><p>  Mulai saat ini, tidak ada yang perlu diubah, karena SHA akan salah, jika terjadi perubahan, perlu untuk regenerasi SHA. </p><br><p>  Selanjutnya, Anda perlu membuat ID Jenis Lulus di kantor pengembang dan membuat sertifikat untuknya.  Prosedur harus lebih atau kurang familier jika Anda sebelumnya membuat, misalnya, profil Penyediaan. </p><br><img src="https://habrastorage.org/webt/2b/um/hu/2bumhu9wgoawlz1lt-qhieildna.png"><br><p>  Selanjutnya, pergi ke Keychain dan ekspor dari sana. Apple Worldwide Relation Certificate (WWDR) sebagai .pem. </p><br><p><img src="https://habrastorage.org/webt/jg/kk/sl/jgkksl_tfac4e23hz7bk1swxhtq.png"></p><br><p>  Dari sana, kami mengekspor ID Jenis Lulus yang dibuat sebagai .p12.  Pada titik ini, pembantu rumah tangga akan meminta Anda untuk memasukkan kata sandi untuk sertifikat.  Dalam hal ini, kata sandi adalah opsional. <br>  Harap dicatat bahwa semua tindakan lebih lanjut harus dilakukan dalam satu folder, di mana manifes.json, pass.json, dan gambar harus sudah berada. </p><br><p>  Sekarang Anda perlu membuat tanda tangan, yang akan kami tandatangani arsipnya.  Pertama, ekspor ID Jenis Lulus dan kunci sebagai .pem. </p><br><pre> <code class="hljs powershell">openssl pkcs12 <span class="hljs-operator"><span class="hljs-operator">-in</span></span> certificate.p12 <span class="hljs-literal"><span class="hljs-literal">-clcerts</span></span> <span class="hljs-literal"><span class="hljs-literal">-nokeys</span></span> <span class="hljs-literal"><span class="hljs-literal">-out</span></span> passcertificate.pem <span class="hljs-literal"><span class="hljs-literal">-passin</span></span> pass: your_password</code> </pre> <br><p>  dan </p><br><pre> <code class="hljs powershell">openssl pkcs12 <span class="hljs-operator"><span class="hljs-operator">-in</span></span> certificates.p12 <span class="hljs-literal"><span class="hljs-literal">-nocerts</span></span> <span class="hljs-literal"><span class="hljs-literal">-out</span></span> passkey.pem <span class="hljs-literal"><span class="hljs-literal">-passin</span></span> pass: <span class="hljs-literal"><span class="hljs-literal">-passout</span></span> pass:new_password</code> </pre> <br><p>  Sekarang kami siap membuat tanda tangan.  Mari kita buat itu perintah: </p><br><pre> <code class="hljs powershell">openssl smime <span class="hljs-literal"><span class="hljs-literal">-binary</span></span> <span class="hljs-literal"><span class="hljs-literal">-sign</span></span> <span class="hljs-literal"><span class="hljs-literal">-certfile</span></span> WWDR.pem <span class="hljs-literal"><span class="hljs-literal">-signer</span></span> passcertificate.pem <span class="hljs-literal"><span class="hljs-literal">-inkey</span></span> passkey.pem <span class="hljs-operator"><span class="hljs-operator">-in</span></span> manifest.json <span class="hljs-literal"><span class="hljs-literal">-out</span></span> signature <span class="hljs-literal"><span class="hljs-literal">-outform</span></span> DER <span class="hljs-literal"><span class="hljs-literal">-passin</span></span> pass:___</code> </pre> <br><p>  Jadi, semuanya sudah siap untuk kita, tinggal mengumpulkan arsip saja, kita lakukan ini dengan perintah: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">zip</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-r</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nameOfPass</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pkpass</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">manifest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.json</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pass</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.json</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">signature</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">logo</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">logo</span></span>@<span class="hljs-keyword"><span class="hljs-keyword">2x</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">png</span></span> logo@<span class="hljs-number"><span class="hljs-number">3</span></span>x.png icon.png icon@<span class="hljs-number"><span class="hljs-number">2</span></span>x.png icon@<span class="hljs-number"><span class="hljs-number">3</span></span>x.png</code> </pre> <br><p>  Saya menarik perhatian Anda pada kenyataan bahwa semua file yang ingin Anda sertakan arsip data untuk kartu (.pkpass) harus tercantum di sini. <br>  Akibatnya, kami mendapatkan file .pkpass yang dapat dibuka di komputer.  Kami akan melihat pratinjau kartu, yang penampilannya mungkin berbeda dari penampilan di telepon. <br>  Semua ini bisa dilakukan dengan sedikit lebih mudah.  Apple menyediakan utilitas <code>signpass</code> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sampel dompet Apple Wallet</a> ), yang menangani semua perhitungan SHA (file <code>manifest.json</code> dapat dibiarkan sendiri) dan pekerjaan membuat tanda tangan.  Untuk menggunakannya, Anda perlu membangun proyek dan meletakkan file <code>signpass</code> di folder dengan semua sumber daya yang diperlukan. </p><br><img src="https://habrastorage.org/webt/tj/jj/eo/tjjjeoqlhxzjumfr3nrg9ve8yhm.png"><br><p>  Secara umum, struktur akan terlihat seperti ini: </p><br><img src="https://habrastorage.org/webt/qc/pb/lr/qcpblrbdaw7piffxdehwa1whlpw.png"><br><p>  Selanjutnya, jalankan perintah: </p><br><pre> <code class="hljs powershell">./signpass <span class="hljs-literal"><span class="hljs-literal">-p</span></span> wallet</code> </pre> <br><p>  Dompet adalah nama folder tempat semua sumber daya berada.  Outputnya adalah wallet.pkpass.  Isinya dapat dilihat dengan membuka ritsleting wallet.pkpass. </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">unzip</span></span> wallet.pkpass</code> </pre> <br><p>  Ada kemungkinan bahwa pembuatan pkpass akan diserahkan ke backend, dalam hal ini akan diperlukan untuk mentransfer kepada pengembang WWDR sertifikat untuk Pass Type ID dalam bentuk .p12 dan kata sandi untuk itu. </p><br><h1 id="integraciya-s-prilozheniem">  Integrasi aplikasi </h1><br><p>  Agar aplikasi dapat menambahkan kartu ke Wallet, Anda harus mengaktifkan fitur ini di ID Aplikasi dan juga mengaktifkan fitur ini di Kemampuan dalam proyek. </p><br><img src="https://habrastorage.org/webt/yq/wo/py/yqwopyfu9nhk-_klilrcoczwe3m.png"><br><img src="https://habrastorage.org/webt/o-/se/ek/o-seekf9zbohe4jmwtcvnzfwes4.png"><br><p>  Ini diperlukan untuk pekerjaan yang sepenuhnya benar dengan Wallet.  Kalau tidak, tidak mungkin membaca kartu dari Wallet dan, misalnya, tidak akan mungkin untuk memahami apakah kartu kita ditambahkan atau tidak.  Penting juga untuk dicatat bahwa id tim dalam pass.json harus cocok dengan id tim, atau Anda harus menambahkannya secara manual ke kepemilikan dan ini dapat memperbaiki situasi, tetapi saya tidak memeriksanya. </p><br><p><img src="https://habrastorage.org/webt/82/ow/p9/82owp9rv4gyaldwm0si77b5nn8m.png"></p><br><h2 id="dobavlenie-karty">  Menambahkan Kartu </h2><br><p>  Menambahkan peta sangat sederhana: </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> passPath = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.path(forResource: <span class="hljs-string"><span class="hljs-string">"wallet"</span></span>, ofType: <span class="hljs-string"><span class="hljs-string">"pkpass"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> error: <span class="hljs-type"><span class="hljs-type">ErrorPointer</span></span> = <span class="hljs-type"><span class="hljs-type">ErrorPointer</span></span>(nilLiteral: ()) <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> passData = <span class="hljs-type"><span class="hljs-type">NSData</span></span>(contentsOfFile: passPath) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pass = <span class="hljs-type"><span class="hljs-type">PKPass</span></span>(data: passData <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-type"><span class="hljs-type">Data</span></span>, error: error) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> passLibrary = <span class="hljs-type"><span class="hljs-type">PKPassLibrary</span></span>() passLibrary.addPasses([pass]) { (status) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(passLibrary.containsPass(pass)) }</code> </pre> <br><p>  Namun, sekali lagi, file .pkpass yang lebih sering perlu diunduh dari server Anda. <br>  Perlu dicatat bahwa PassKit menghasilkan kesalahan yang cukup mudah dibaca, sehingga Anda dapat dengan mudah memahami apa yang sebenarnya dilakukan dengan salah. </p><br><h2 id="poluchenie-informacii-o-dobavlennyh-kartah">  Mengambil informasi tentang kartu yang ditambahkan </h2><br><p>  Untuk mendapatkan informasi tentang kartu yang tersedia di Wallet dan terkait dengan aplikasi Anda, Anda perlu membuka objek PKPassLibrary. </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> passLibrary = <span class="hljs-type"><span class="hljs-type">PKPassLibrary</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> passes = passLibrary.passes()</code> </pre> <br><p>  Dengan demikian, Anda dapat memahami apakah peta ditambahkan atau tidak, serta memperbarui antarmuka.  Selain itu, melalui peta PKPassLibrary dapat diperbarui dan dihapus.  Peta juga dapat diperbarui melalui layanan web, tetapi dalam artikel ini kami tidak akan mempertimbangkan opsi seperti itu. </p><br><h1 id="proverka-na-unikalnost">  Pemeriksaan keunikan </h1><br><p>  Karena dalam layanan Anda, sebagai suatu peraturan, kartu tersebut terikat pada suatu akun, dalam aplikasi kemungkinan besar Anda harus entah bagaimana menentukan apakah kartu tersebut milik pengguna saat ini.  Saya sarankan melakukan ini melalui <code>serialNumber</code> .  Misalnya, atur nomor <code>serialNumber</code> pengguna atau nomor kartu. </p><br><h1 id="testirovanie">  Pengujian </h1><br><p>  Apple memberikan contoh pkpass untuk berbagai jenis, Anda dapat fokus pada mereka. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sampel dompet Apple</a> <br>  Untuk melihat seperti apa peta itu, Anda dapat menambahkan pkpass ke proyek (lihat “Menambahkan peta”).  Proses penambahan / penghapusan sudah dibahas di atas, hanya perlu diingat bahwa aplikasi tidak akan melihat kartu yang sudah ditambahkan jika kartu untuk Dompet dibuat pada akun satu pengembang, dan pengembangan itu sendiri dilakukan dari akun lain (relevan untuk perusahaan outsourcing).  Dalam hal ini, Anda dapat menambahkan kartu tanpa masalah. <br>  Anda dapat memeriksa apakah informasi dalam barcode disandikan dengan benar menggunakan pemindai kode QR apa pun.  Dan sudah pasti perlu untuk memeriksa kebenaran pekerjaan dengan pemindai ini. </p><br><h1 id="zaklyuchenie">  Kesimpulan </h1><br><p>  Artikel tersebut meneliti proses membuat dan mendesain peta, serta proses integrasi dengan aplikasi dan masalah yang mungkin muncul.  Saya sengaja tidak membahas masalah integrasi dengan layanan web dan pembaruan peta, dan saya berharap dapat melakukan ini di artikel berikutnya. </p><br><h1 id="ispolzuemye-materialy">  Bahan yang digunakan: </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/PassKit_PG/Creating.html</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://developer.apple.com/library/archive/documentation/UserExperience/Reference/PassKit_Bundle/Chapters/TopLevel.html#//apple_ref/doc/uid/TP40012026-CH2-SW3</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://itechroof.wordpress.com/2015/11/30/apple-wallet-part-13/</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/PassKit_PG/Updating.html</a> </p><br><p>  Terima kasih khusus kepada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">mehdzor</a> untuk akun pengembang untuk pengujian. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id428437/">https://habr.com/ru/post/id428437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id428423/index.html">Bagaimana kesepakatan $ 34 miliar antara IBM dan Red Hat akan mengubah pasar TI: para ahli dan analis</a></li>
<li><a href="../id428429/index.html">GOST R 34.10 tanda tangan elektronik dari dokumen PDF di office suite LibreOffice</a></li>
<li><a href="../id428431/index.html">Lebih dari lapisan konsentris</a></li>
<li><a href="../id428433/index.html">Pengacara Pengujian Pribadi</a></li>
<li><a href="../id428435/index.html">Apa yang harus dibaca dalam PHP dalam bahasa Rusia?</a></li>
<li><a href="../id428439/index.html">Tanpa ansambel</a></li>
<li><a href="../id428441/index.html">Pembelian GitHub selesai. Apa yang akan terjadi selanjutnya?</a></li>
<li><a href="../id428443/index.html">Rekonsiliasi - memeriksa integritas data dalam sistem terdistribusi</a></li>
<li><a href="../id428445/index.html">Bagaimana kami melakukan hackathon di Helsinki dan kalah</a></li>
<li><a href="../id428447/index.html">Perlindungan Data Cloud: Panduan untuk Pengembang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>