<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëäüèæ üßöüèø üë©üèΩ‚Äçüíª Tuyaux et filtres. Exemple d'application et d'impl√©mentation √† l'aide de Spring ü§¨ üéä üí¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article explique l'utilisation du mod√®le Pipes & Filters. 


 Tout d'abord, nous analyserons un exemple de fonction, que nous r√©√©crirons plus tard...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tuyaux et filtres. Exemple d'application et d'impl√©mentation √† l'aide de Spring</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479464/"><p>  Cet article explique l'utilisation du mod√®le Pipes &amp; Filters. </p><br><p>  Tout d'abord, nous analyserons un exemple de fonction, que nous r√©√©crirons plus tard en utilisant le mod√®le mentionn√© ci-dessus.  Les changements dans le code se produiront progressivement et chaque fois que nous cr√©erons une version utilisable jusqu'√† ce que nous nous attardions sur la solution en utilisant DI (dans cet exemple Spring). </p><br><p>  Ainsi, nous cr√©erons plusieurs solutions, offrant la possibilit√© d'en utiliser une. <br>  Au final, nous comparons les impl√©mentations initiales et finales, examinons des exemples d'application dans des projets r√©els et r√©sumons. </p><a name="habracut"></a><br><h2 id="zadacha">  D√©fi </h2><br><p>  Supposons que nous ayons un tas de v√™tements que nous obtenons du s√©chage et que nous devons maintenant d√©placer dans le placard.  Il s'av√®re que les donn√©es (v√™tements) proviennent d'un service distinct et la t√¢che consiste √† fournir ces donn√©es au client sous la bonne forme (dans un placard √† partir duquel il peut obtenir des v√™tements). </p><br><p>  Dans la plupart des cas, vous ne pouvez pas utiliser les donn√©es re√ßues sous la forme dans laquelle elles nous parviennent.  Ces donn√©es doivent √™tre v√©rifi√©es, transform√©es, tri√©es, etc. <br>  Supposons qu'un client exige que les v√™tements soient repass√©s s'ils sont neufs. </p><br><p> Ensuite, pour la premi√®re fois, nous cr√©ons un <code>Modifier</code> , dans lequel nous prescrivons les changements: </p><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;&gt; modify(List&lt;&gt; ){ (); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> (List&lt;&gt; ) { .stream() .filter(::) .forEach(o -&gt; { <span class="hljs-comment"><span class="hljs-comment">// }); } }</span></span></code> </pre> <br><p>  √Ä ce stade, tout est simple et clair.  √âcrivons un test qui v√©rifie que tous les v√™tements froiss√©s ont √©t√© repass√©s. </p><br><p>  Mais au fil du temps, de nouvelles exigences apparaissent et chaque fois que la fonctionnalit√© de la classe <code>Modifier</code> d√©veloppe: </p><br><ul><li>  Ne mettez pas de linge sale dans le placard. </li><li>  Les chemises, vestes et pantalons doivent √™tre accroch√©s aux √©paules. </li><li>  Les chaussettes qui fuient doivent √™tre cousues en premier </li><li>  ... </li></ul><br><p>  La s√©quence des changements est √©galement importante.  Par exemple, vous ne pouvez pas d'abord suspendre des v√™tements sur leurs √©paules, puis repasser. </p><br><p>  Ainsi, √† un moment donn√©, <code>Modifier</code> peut prendre la forme suivante: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Predicate&lt;&gt; ___ = ((Predicate&lt;&gt;).class::isInstance) .or(.class::isInstance) .or(.class::isInstance) ; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;&gt; modify(List&lt;&gt; ){ (); (); (); (); <span class="hljs-comment"><span class="hljs-comment">//   return ; } private void (List&lt;&gt; ) { .stream() .filter(.class::isInstance) .map(.class::cast) .filter(::) .forEach(o -&gt; { // }); } private void (List&lt;&gt; ) { .stream() .filter(___) .forEach(o -&gt; { //   }); } private void (List&lt;&gt; ) { .removeIf(::); } private void (List&lt;&gt; ) { .stream() .filter(::) .forEach(o -&gt; { // }); } //  }</span></span></code> </pre> <br><p>  En cons√©quence, les tests sont devenus plus compliqu√©s, qui doivent maintenant au moins v√©rifier chaque √©tape individuellement. </p><br><p>  Et lorsqu'une nouvelle exigence arrive, en regardant le code, nous d√©cidons que le moment est venu pour la refactorisation. </p><br><h2 id="refactoring">  Refactoring </h2><br><p>  La premi√®re chose qui attire votre attention est la casse fr√©quente de tous les v√™tements.  Donc, la premi√®re √©tape, nous d√©pla√ßons tout en un cycle, et transf√©rons √©galement le contr√¥le de propret√© au d√©but du cycle: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Predicate&lt;&gt; ___ = ((Predicate&lt;&gt;).class::isInstance) .or(.class::isInstance) .or(.class::isInstance) ; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;&gt; modify(List&lt;&gt; ){ List&lt;&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> o : ){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(o.()){ <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } result.add(o); (o); (o); (o); <span class="hljs-comment"><span class="hljs-comment">//   } return result; } private void ( ) { if( instanceof ){ // ()  } } private void ( ) { if(___.test()){ //   } } private void ( ) { if(.()){ // } } //  }</span></span></code> </pre> <br><p>  Maintenant, le temps de traitement des v√™tements est r√©duit, mais le code est encore trop long pour une classe et pour le corps du cycle.  Essayons d'abord de raccourcir le corps du cycle. </p><br><ul><li><p>  Apr√®s avoir v√©rifi√© la propret√©, vous pouvez effectuer tous les appels dans une m√©thode de <code>modify( )</code> distincte <code>modify( )</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;&gt; modify(List&lt;&gt; ){ List&lt;&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> o : ){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(o.()){ <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } result.add(o); modify(o); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">modify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( o)</span></span></span><span class="hljs-function"> </span></span>{ (o); (o); (o); <span class="hljs-comment"><span class="hljs-comment">//   }</span></span></code> </pre> <br></li><li><p>  Vous pouvez combiner tous les appels en un seul <code>Consumer</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Consumer&lt;&gt; modification = ((Consumer&lt;&gt;) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::) .andThen(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::) .andThen(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::); <span class="hljs-comment"><span class="hljs-comment">//   public List&lt;&gt; modify(List&lt;&gt; ){ return .stream() .filter(o -&gt; !o.()) .peek(modification) .collect(Collectors.toList()); }</span></span></code> </pre> <br><blockquote>  Blunt: coup d'oeil <br>  J'ai utilis√© peek pour faire court.  Sonar dira qu'un tel code ne devrait pas √™tre fait, car  Javadoc indique √† Peek que la m√©thode existe principalement pour le d√©bogage.  Mais si vous le r√©√©crivez sur la carte: .map (o -&gt; {modification.accept (o); return o;}), alors IDEA dira qu'il vaut mieux utiliser peek </blockquote><br></li></ul><br><blockquote>  Tr√©buchement: Consommateur <br>  Un exemple avec Consumer (et suivant avec Function) est donn√© pour montrer les capacit√©s du langage. </blockquote><p>  Maintenant, le corps du cycle est devenu plus court, mais jusqu'√† pr√©sent, la classe elle-m√™me est encore trop grande et contient trop d'informations (connaissance de toutes les √©tapes). </p><br><p>  Essayons de r√©soudre ce probl√®me en utilisant des mod√®les de programmation d√©j√† √©tablis.  Dans ce cas, nous utiliserons des <code>Pipes &amp; Filters</code> . </p><br><h2 id="pipes--filters">  Tuyaux et filtres </h2><br><p>  <a href="https://docs.microsoft.com/ru-ru/azure/architecture/patterns/pipes-and-filters">Le mod√®le de canal et de filtre</a> <a href="https://medium.com/nuances-of-programming/%25D0%25BA%25D1%2580%25D0%25B0%25D1%2582%25D0%25BA%25D0%25B8%25D0%25B9-%25D0%25BE%25D0%25B1%25D0%25B7%25D0%25BE%25D1%2580-10-%25D0%25BF%25D0%25BE%25D0%25BF%25D1%2583%25D0%25BB%25D1%258F%25D1%2580%25D0%25BD%25D1%258B%25D1%2585-%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BA%25D1%2582%25D1%2583%25D1%2580%25D0%25BD%25D1%258B%25D1%2585-%25D1%2588%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BD%25D0%25BE%25D0%25B2-%25D0%25BF%25D1%2580%25D0%25B8%25D0%25BB%25D0%25BE%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9-81647be5c46f">d√©crit une approche</a> dans laquelle les donn√©es entrantes passent par plusieurs √©tapes de traitement. </p><br><p>  Essayons d'appliquer cette approche √† notre code. </p><br><h3 id="shag-1">  √âtape 1 </h3><br><p>  En fait, notre code est d√©j√† proche de ce mod√®le.  Les donn√©es obtenues passent par plusieurs √©tapes ind√©pendantes.  Jusqu'√† pr√©sent, chaque m√©thode est un filtre, et la <code>modify</code> elle-m√™me d√©crit le canal, filtrant d'abord tous les v√™tements sales. </p><br><p>  Maintenant, nous allons transf√©rer chaque √©tape dans une classe distincte et voir ce que nous obtenons: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span>  ; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span>  ; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span>  ; <span class="hljs-comment"><span class="hljs-comment">//  public Modifier( ,  ,   //  ) { this. = ; this. = ; this. = ; //  } public List&lt;&gt; modify(List&lt;&gt; ) { return .stream() .filter(o -&gt; !o.()) .peek(o -&gt; { .(o); .(o); .(o); //  }) .collect(Collectors.toList()); } }</span></span></code> </pre> <br><p>  Ainsi, nous avons plac√© le code dans des classes distinctes, simplifiant les tests de transformations individuelles (et cr√©ant la possibilit√© de r√©utiliser les √©tapes).  L'ordre des appels d√©termine la s√©quence des √©tapes. </p><br><p>  Mais la classe elle-m√™me conna√Æt toujours toutes les √©tapes individuelles, contr√¥le l'ordre et dispose ainsi d'une √©norme liste de d√©pendances.  En plus d'ajouter une nouvelle √©tape, nous serons oblig√©s non seulement d'√©crire une nouvelle classe, mais aussi de l'ajouter √† <code>Modfier</code> . </p><br><h3 id="shag-2">  √âtape 2 </h3><br><p>  Simplifiez le code √† l'aide de Spring. <br>  Cr√©ez d'abord une interface pour chaque √©tape: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modification</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">modify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( )</span></span></span></span>; }</code> </pre><br><p>  <code>Modifier</code> lui-m√™me sera d√©sormais beaucoup plus court: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> List&lt;Modification&gt; steps; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Modifier</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Modification&gt; steps)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.steps = steps; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;&gt; modify(List&lt;&gt; ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> .stream() .filter(o -&gt; !o.()) .peek(o -&gt; { steps.forEach(m -&gt; m.modify(o)); }) .collect(Collectors.toList()); } }</code> </pre> <br><p>  Maintenant, pour ajouter une nouvelle √©tape, il vous suffit d'√©crire une nouvelle classe qui impl√©mente l'interface de <code>Modification</code> et de mettre <code>@Component</code> au-dessus.  Spring le trouvera et l'ajoutera √† la liste. </p><br><p>  <code>Modifer</code> lui <code>Modifer</code> m√™me <code>Modifer</code> sait rien des √©tapes individuelles, ce qui cr√©e une ¬´connexion faible¬ª entre les composants. </p><br><p>  La seule difficult√© est de r√©gler la s√©quence.  Pour ce faire, Spring a une annotation <code>@Order</code> dans laquelle vous pouvez passer une valeur int.  La liste est tri√©e par ordre croissant. <br>  Ainsi, il peut arriver qu'en ajoutant une nouvelle √©tape au milieu de la liste, vous deviez modifier les valeurs de tri des √©tapes existantes. </p><br><blockquote>  Spring aurait pu √™tre supprim√© si toutes les impl√©mentations connues avaient √©t√© transmises manuellement au constructeur Modifier.  Cela aidera √† r√©soudre le probl√®me de tri, mais compliquera encore une fois l'ajout de nouvelles √©tapes. </blockquote><br><h3 id="shag-3">  √âtape 3 </h3><br><p>  Nous passons maintenant le test de propret√© dans une √©tape distincte.  Pour ce faire, nous r√©√©crivons notre interface afin qu'elle renvoie toujours une valeur: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modification</span></span></span><span class="hljs-class"> </span></span>{  modify( ); }</code> </pre> <br><p>  V√©rifiez la propret√©: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-meta"><span class="hljs-meta">@Order</span></span>(Ordered.HIGHEST_PRECEDENCE) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CleanFilter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modification</span></span></span><span class="hljs-class"> </span></span>{  modify( ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(.()){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ; } }</code> </pre> <br><p>  <code>Modifier.modify</code> - <code>Modifier.modify</code> : </p><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;&gt; modify(List&lt;&gt; ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> .stream() .map(o -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> modified = o; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> step : steps){ modified = step.modify(o); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(modified == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modified; }) .filter(Objects::nonNull) .collect(Collectors.toList()); }</code> </pre> <br><p>  Dans cette version, <code>Modifier</code> ne dispose d'aucune information sur les donn√©es.  Il les transmet simplement √† chaque √©tape connue et recueille les r√©sultats. </p><br><p>  Si l'une des √©tapes renvoie null, le traitement de ce v√™tement est interrompu. </p><br><p>  Un principe similaire est utilis√© dans Spring pour les HandlerInterceptors.  Avant et apr√®s l'appel du contr√¥leur, tous les intercepteurs appropri√©s pour cette URL sont appel√©s.  Dans le m√™me temps, il renvoie vrai ou faux dans la m√©thode preHandle pour indiquer si le traitement et l'appel des intercepteurs suivants peuvent continuer </p><br><h3 id="shag-n">  √âtape n </h3><br><p>  L'√©tape suivante consiste √† ajouter la m√©thode des <code>matches</code> √† l'interface de <code>Modification</code> , dans laquelle les √©tapes d'un attribut distinct des v√™tements sont v√©rifi√©es: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Modification</span></span></span><span class="hljs-class"> </span></span>{  modify( ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">matches</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( )</span></span></span><span class="hljs-function"> </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>;} }</code> </pre> <br><p>  Pour cette raison, vous pouvez l√©g√®rement simplifier la logique des m√©thodes de <code>modify</code> en d√©pla√ßant les v√©rifications des classes et des propri√©t√©s dans une m√©thode distincte. </p><br><p>  Une approche similaire est utilis√©e dans le filtre Spring (Request), mais la principale diff√©rence est que chaque filtre est un wrapper autour du suivant et appelle explicitement FilterChain.doFilter pour continuer le traitement. </p><br><h2 id="itogo">  Total </h2><br><p>  Le r√©sultat final est tr√®s diff√©rent de la version initiale.  En les comparant, nous pouvons tirer les conclusions suivantes: </p><br><ul><li>  L'impl√©mentation bas√©e sur Pipes &amp; Filters simplifie la classe <code>Modifier</code> elle-m√™me. </li><li>  Des responsabilit√©s mieux r√©parties et des connexions ¬´faibles¬ª entre les composants. </li><li>  Plus facile de tester des √©tapes individuelles. </li><li>  Ajoutez et supprimez des √©tapes plus facilement. </li><li>  Un peu plus difficile de tester toute une cha√Æne de filtres.  Nous avons d√©j√† besoin de IntegrationTests. </li><li>  Plus de cours </li></ul><br><p>  En fin de compte, une option plus pratique et flexible que l'original. </p><br><p>  De plus, vous pouvez simplement parall√©liser le traitement des donn√©es en utilisant le m√™me parallelStream. </p><br><h3 id="chto-ne-reshaet-dannyy-primer">  Ce que cet exemple ne r√©sout pas </h3><br><ol><li>  La description du mod√®le indique que les filtres individuels peuvent √™tre r√©utilis√©s en cr√©ant une autre cha√Æne de filtres (canal). <br><ul><li>  D'une part, cela est facile √† faire en utilisant <code>@Qualifier</code> . </li><li>  En revanche, d√©finir un ordre diff√©rent avec <code>@Order</code> √©chouera. </li></ul></li><li>  Pour des exemples plus complexes, vous devrez utiliser plusieurs cha√Ænes, utiliser des cha√Ænes imbriqu√©es et toujours modifier l'impl√©mentation existante. <br><ul><li>  Ainsi, par exemple, la t√¢che: "pour chaque chaussette, recherchez une paire et mettez-les dans une instance de &lt;? Extends Clothing&gt;" ne rentrera pas bien dans l'impl√©mentation d√©crite, car  Maintenant, pour chaque orteil, vous devez trier tout le linge et modifier la liste de donn√©es initiale. </li><li>  Pour r√©soudre ce probl√®me, vous pouvez √©crire une nouvelle interface qui accepte et renvoie une liste &lt;Clothing&gt; et transf√®re vers une nouvelle cha√Æne.  Mais vous devez faire attention √† la s√©quence des appels des cha√Ænes elles-m√™mes, si les chaussettes ne peuvent √™tre cousues que par l'h√¥tel. </li></ul></li></ol><br><h2 id="spasibo-za-vnimanie">  Merci de votre attention. </h2></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr479464/">https://habr.com/ru/post/fr479464/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr479450/index.html">AppCode 2019.3: fonctionne plus rapidement, comprend mieux Swift, conna√Æt Mac Catalyst et affiche facilement les messages d'assemblage</a></li>
<li><a href="../fr479452/index.html">Comment le syst√®me de noms de domaine s'est d√©velopp√©: l'√®re ARPANET</a></li>
<li><a href="../fr479458/index.html">Beaut√© ou praticit√© dans la salle des serveurs</a></li>
<li><a href="../fr479460/index.html">Un guide pour les voitures volantes</a></li>
<li><a href="../fr479462/index.html">S√©rialisation en C ++</a></li>
<li><a href="../fr479466/index.html">Habraiting 2019: statistiques et classement des meilleurs articles pour 2019</a></li>
<li><a href="../fr479468/index.html">Edge of Honesty et John Doe</a></li>
<li><a href="../fr479474/index.html">Pourquoi l'auto-organisation des √©quipes est-elle si importante dans Scrum et pourquoi il ne peut y avoir de managers</a></li>
<li><a href="../fr479478/index.html">Plug-in Java sans douleur</a></li>
<li><a href="../fr479480/index.html">SDK SARIF et ses erreurs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>